<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7658pt" height="46189pt"
 viewBox="0.00 0.00 7658.00 46189.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 46185.08)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-46185.08 7654,-46185.08 7654,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="4794" cy="-46144.31" rx="178.8" ry="36.54"/>
<text text-anchor="middle" x="4794" y="-46158.31" font-family="Arial" font-size="10.00">INPUT</text>
<text text-anchor="middle" x="4794" y="-46147.31" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="4794" y="-46136.31" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-46125.31" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer0_dense_mha -->
<g id="node2" class="node">
<title>layer0_dense_mha</title>
<polygon fill="lightblue" stroke="black" points="4924,-46071.54 4664,-46071.54 4664,-46019.54 4924,-46019.54 4924,-46071.54"/>
<text text-anchor="middle" x="4794" y="-46059.54" font-family="Arial" font-size="10.00">MHA L0</text>
<text text-anchor="middle" x="4794" y="-46048.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-46037.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4794" y="-46026.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- input&#45;&gt;layer0_dense_mha -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_dense_mha</title>
<path fill="none" stroke="black" d="M4794,-46107.53C4794,-46107.53 4794,-46081.56 4794,-46081.56"/>
<polygon fill="black" stroke="black" points="4797.5,-46081.56 4794,-46071.56 4790.5,-46081.56 4797.5,-46081.56"/>
</g>
<!-- layer0_dense_mlp -->
<g id="node3" class="node">
<title>layer0_dense_mlp</title>
<polygon fill="lightblue" stroke="black" points="4920.5,-45983.54 4667.5,-45983.54 4667.5,-45931.54 4920.5,-45931.54 4920.5,-45983.54"/>
<text text-anchor="middle" x="4794" y="-45971.54" font-family="Arial" font-size="10.00">MLP L0</text>
<text text-anchor="middle" x="4794" y="-45960.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45949.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-45938.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer0_dense_mha&#45;&gt;layer0_dense_mlp -->
<g id="edge2" class="edge">
<title>layer0_dense_mha&#45;&gt;layer0_dense_mlp</title>
<path fill="none" stroke="black" d="M4794,-46019.14C4794,-46019.14 4794,-45993.62 4794,-45993.62"/>
<polygon fill="black" stroke="black" points="4797.5,-45993.62 4794,-45983.62 4790.5,-45993.62 4797.5,-45993.62"/>
</g>
<!-- layer1_dense_mha -->
<g id="node4" class="node">
<title>layer1_dense_mha</title>
<polygon fill="lightblue" stroke="black" points="4924,-45895.54 4664,-45895.54 4664,-45843.54 4924,-45843.54 4924,-45895.54"/>
<text text-anchor="middle" x="4794" y="-45883.54" font-family="Arial" font-size="10.00">MHA L1</text>
<text text-anchor="middle" x="4794" y="-45872.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45861.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4794" y="-45850.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer0_dense_mlp&#45;&gt;layer1_dense_mha -->
<g id="edge3" class="edge">
<title>layer0_dense_mlp&#45;&gt;layer1_dense_mha</title>
<path fill="none" stroke="black" d="M4794,-45931.14C4794,-45931.14 4794,-45905.62 4794,-45905.62"/>
<polygon fill="black" stroke="black" points="4797.5,-45905.62 4794,-45895.62 4790.5,-45905.62 4797.5,-45905.62"/>
</g>
<!-- layer1_dense_mlp -->
<g id="node5" class="node">
<title>layer1_dense_mlp</title>
<polygon fill="lightblue" stroke="black" points="4920.5,-45807.54 4667.5,-45807.54 4667.5,-45755.54 4920.5,-45755.54 4920.5,-45807.54"/>
<text text-anchor="middle" x="4794" y="-45795.54" font-family="Arial" font-size="10.00">MLP L1</text>
<text text-anchor="middle" x="4794" y="-45784.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45773.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-45762.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer1_dense_mha&#45;&gt;layer1_dense_mlp -->
<g id="edge4" class="edge">
<title>layer1_dense_mha&#45;&gt;layer1_dense_mlp</title>
<path fill="none" stroke="black" d="M4794,-45843.14C4794,-45843.14 4794,-45817.62 4794,-45817.62"/>
<polygon fill="black" stroke="black" points="4797.5,-45817.62 4794,-45807.62 4790.5,-45817.62 4797.5,-45817.62"/>
</g>
<!-- layer2_dense_mha -->
<g id="node6" class="node">
<title>layer2_dense_mha</title>
<polygon fill="lightblue" stroke="black" points="4924,-45719.54 4664,-45719.54 4664,-45667.54 4924,-45667.54 4924,-45719.54"/>
<text text-anchor="middle" x="4794" y="-45707.54" font-family="Arial" font-size="10.00">MHA L2</text>
<text text-anchor="middle" x="4794" y="-45696.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45685.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4794" y="-45674.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer1_dense_mlp&#45;&gt;layer2_dense_mha -->
<g id="edge5" class="edge">
<title>layer1_dense_mlp&#45;&gt;layer2_dense_mha</title>
<path fill="none" stroke="black" d="M4794,-45755.14C4794,-45755.14 4794,-45729.62 4794,-45729.62"/>
<polygon fill="black" stroke="black" points="4797.5,-45729.62 4794,-45719.62 4790.5,-45729.62 4797.5,-45729.62"/>
</g>
<!-- layer2_dense_mlp -->
<g id="node7" class="node">
<title>layer2_dense_mlp</title>
<polygon fill="lightblue" stroke="black" points="4920.5,-45631.54 4667.5,-45631.54 4667.5,-45579.54 4920.5,-45579.54 4920.5,-45631.54"/>
<text text-anchor="middle" x="4794" y="-45619.54" font-family="Arial" font-size="10.00">MLP L2</text>
<text text-anchor="middle" x="4794" y="-45608.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45597.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-45586.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer2_dense_mha&#45;&gt;layer2_dense_mlp -->
<g id="edge6" class="edge">
<title>layer2_dense_mha&#45;&gt;layer2_dense_mlp</title>
<path fill="none" stroke="black" d="M4794,-45667.14C4794,-45667.14 4794,-45641.62 4794,-45641.62"/>
<polygon fill="black" stroke="black" points="4797.5,-45641.62 4794,-45631.62 4790.5,-45641.62 4797.5,-45641.62"/>
</g>
<!-- layer3_moe_mha -->
<g id="node8" class="node">
<title>layer3_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4924,-45543.54 4664,-45543.54 4664,-45491.54 4924,-45491.54 4924,-45543.54"/>
<text text-anchor="middle" x="4794" y="-45531.54" font-family="Arial" font-size="10.00">MHA L3</text>
<text text-anchor="middle" x="4794" y="-45520.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45509.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4794" y="-45498.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer2_dense_mlp&#45;&gt;layer3_moe_mha -->
<g id="edge71" class="edge">
<title>layer2_dense_mlp&#45;&gt;layer3_moe_mha</title>
<path fill="none" stroke="black" d="M4794,-45579.14C4794,-45579.14 4794,-45553.62 4794,-45553.62"/>
<polygon fill="black" stroke="black" points="4797.5,-45553.62 4794,-45543.62 4790.5,-45553.62 4797.5,-45553.62"/>
</g>
<!-- layer3_moe_gate -->
<g id="node9" class="node">
<title>layer3_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="5052.3,-45455.54 4641.4,-45455.54 4535.7,-45351.54 4946.6,-45351.54 5052.3,-45455.54"/>
<text text-anchor="middle" x="4794" y="-45417.54" font-family="Arial" font-size="10.00">GATE L3</text>
<text text-anchor="middle" x="4794" y="-45406.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45395.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-45384.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer3_moe_mha&#45;&gt;layer3_moe_gate -->
<g id="edge72" class="edge">
<title>layer3_moe_mha&#45;&gt;layer3_moe_gate</title>
<path fill="none" stroke="black" d="M4794,-45491.38C4794,-45491.38 4794,-45465.64 4794,-45465.64"/>
<polygon fill="black" stroke="black" points="4797.5,-45465.64 4794,-45455.64 4790.5,-45465.64 4797.5,-45465.64"/>
</g>
<!-- layer3_moe_split -->
<g id="node10" class="node">
<title>layer3_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="5048.01,-45315.54 4643.94,-45315.54 4539.99,-45211.54 4944.06,-45211.54 5048.01,-45315.54"/>
<text text-anchor="middle" x="4794" y="-45277.54" font-family="Arial" font-size="10.00">SPLIT TOKENS L3</text>
<text text-anchor="middle" x="4794" y="-45266.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-45255.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-45244.54" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer3_moe_gate&#45;&gt;layer3_moe_split -->
<g id="edge73" class="edge">
<title>layer3_moe_gate&#45;&gt;layer3_moe_split</title>
<path fill="none" stroke="black" d="M4794,-45351.41C4794,-45351.41 4794,-45325.71 4794,-45325.71"/>
<polygon fill="black" stroke="black" points="4797.5,-45325.71 4794,-45315.71 4790.5,-45325.71 4797.5,-45325.71"/>
</g>
<!-- layer3_moe_comm_to_expert0 -->
<g id="node12" class="node">
<title>layer3_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2402" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2402" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2402" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2402" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert0 -->
<g id="edge7" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4628.17,-45300C4086.23,-45300 2402,-45300 2402,-45300 2402,-45300 2402,-45185.77 2402,-45185.77"/>
<polygon fill="black" stroke="black" points="2405.5,-45185.77 2402,-45175.77 2398.5,-45185.77 2405.5,-45185.77"/>
</g>
<!-- layer3_moe_comm_to_expert1 -->
<g id="node14" class="node">
<title>layer3_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2748" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2748" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2748" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2748" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert1 -->
<g id="edge9" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4613.33,-45285C4113.33,-45285 2748,-45285 2748,-45285 2748,-45285 2748,-45185.57 2748,-45185.57"/>
<polygon fill="black" stroke="black" points="2751.5,-45185.57 2748,-45175.57 2744.5,-45185.57 2751.5,-45185.57"/>
</g>
<!-- layer3_moe_comm_to_expert2 -->
<g id="node16" class="node">
<title>layer3_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3020" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3020" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3020" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3020" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert2 -->
<g id="edge11" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4598.23,-45270C4136.86,-45270 3020,-45270 3020,-45270 3020,-45270 3020,-45185.8 3020,-45185.8"/>
<polygon fill="black" stroke="black" points="3023.5,-45185.8 3020,-45175.8 3016.5,-45185.8 3023.5,-45185.8"/>
</g>
<!-- layer3_moe_comm_to_expert3 -->
<g id="node18" class="node">
<title>layer3_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3348" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3348" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3348" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3348" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert3 -->
<g id="edge13" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4584.13,-45256C4183.23,-45256 3348,-45256 3348,-45256 3348,-45256 3348,-45185.59 3348,-45185.59"/>
<polygon fill="black" stroke="black" points="3351.5,-45185.59 3348,-45175.59 3344.5,-45185.59 3351.5,-45185.59"/>
</g>
<!-- layer3_moe_comm_to_expert4 -->
<g id="node20" class="node">
<title>layer3_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3841" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3841" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3841" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3841" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert4 -->
<g id="edge15" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4569.36,-45241C4287.61,-45241 3841,-45241 3841,-45241 3841,-45241 3841,-45185.66 3841,-45185.66"/>
<polygon fill="black" stroke="black" points="3844.5,-45185.66 3841,-45175.66 3837.5,-45185.66 3844.5,-45185.66"/>
</g>
<!-- layer3_moe_comm_to_expert5 -->
<g id="node22" class="node">
<title>layer3_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4187" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4187" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="4187" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="4187" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert5 -->
<g id="edge17" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4554.1,-45226C4384.43,-45226 4187,-45226 4187,-45226 4187,-45226 4187,-45185.68 4187,-45185.68"/>
<polygon fill="black" stroke="black" points="4190.5,-45185.68 4187,-45175.68 4183.5,-45185.68 4190.5,-45185.68"/>
</g>
<!-- layer3_moe_comm_to_expert6 -->
<g id="node24" class="node">
<title>layer3_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4459" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4459" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4459" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4459" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert6 -->
<g id="edge19" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4544.75,-45263.45C4544.75,-45263.45 4544.75,-45165.84 4544.75,-45165.84"/>
<polygon fill="black" stroke="black" points="4548.25,-45165.84 4544.75,-45155.84 4541.25,-45165.84 4548.25,-45165.84"/>
</g>
<!-- layer3_moe_comm_to_expert7 -->
<g id="node26" class="node">
<title>layer3_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4695" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4695" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4695" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4695" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert7 -->
<g id="edge21" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4695,-45211.2C4695,-45211.2 4695,-45185.76 4695,-45185.76"/>
<polygon fill="black" stroke="black" points="4698.5,-45185.76 4695,-45175.76 4691.5,-45185.76 4698.5,-45185.76"/>
</g>
<!-- layer3_moe_comm_to_expert8 -->
<g id="node28" class="node">
<title>layer3_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4967" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4967" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4967" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4967" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert8 -->
<g id="edge23" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4962.25,-45229.7C4962.25,-45229.7 4962.25,-45185.55 4962.25,-45185.55"/>
<polygon fill="black" stroke="black" points="4965.75,-45185.55 4962.25,-45175.55 4958.75,-45185.55 4965.75,-45185.55"/>
</g>
<!-- layer3_moe_comm_to_expert9 -->
<g id="node30" class="node">
<title>layer3_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5276" cy="-45146.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5276" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5276" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5276" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert9 -->
<g id="edge25" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4956.85,-45224C5096.73,-45224 5276,-45224 5276,-45224 5276,-45224 5276,-45185.83 5276,-45185.83"/>
<polygon fill="black" stroke="black" points="5279.5,-45185.83 5276,-45175.83 5272.5,-45185.83 5279.5,-45185.83"/>
</g>
<!-- layer3_moe_comm_to_expert10 -->
<g id="node32" class="node">
<title>layer3_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5608" cy="-45146.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5608" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5608" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5608" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert10 -->
<g id="edge27" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4969.62,-45237C5208.92,-45237 5608,-45237 5608,-45237 5608,-45237 5608,-45185.67 5608,-45185.67"/>
<polygon fill="black" stroke="black" points="5611.5,-45185.67 5608,-45175.67 5604.5,-45185.67 5611.5,-45185.67"/>
</g>
<!-- layer3_moe_comm_to_expert11 -->
<g id="node34" class="node">
<title>layer3_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5954" cy="-45146.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5954" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5954" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5954" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert11 -->
<g id="edge29" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4982.63,-45250C5311.23,-45250 5954,-45250 5954,-45250 5954,-45250 5954,-45185.64 5954,-45185.64"/>
<polygon fill="black" stroke="black" points="5957.5,-45185.64 5954,-45175.64 5950.5,-45185.64 5957.5,-45185.64"/>
</g>
<!-- layer3_moe_comm_to_expert12 -->
<g id="node36" class="node">
<title>layer3_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6305" cy="-45146.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6305" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6305" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6305" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert12 -->
<g id="edge31" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4995.82,-45263C5407.38,-45263 6305,-45263 6305,-45263 6305,-45263 6305,-45185.63 6305,-45185.63"/>
<polygon fill="black" stroke="black" points="6308.5,-45185.63 6305,-45175.63 6301.5,-45185.63 6308.5,-45185.63"/>
</g>
<!-- layer3_moe_comm_to_expert13 -->
<g id="node38" class="node">
<title>layer3_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6658" cy="-45146.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6658" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6658" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6658" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert13 -->
<g id="edge33" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5008.73,-45276C5498.87,-45276 6658,-45276 6658,-45276 6658,-45276 6658,-45185.6 6658,-45185.6"/>
<polygon fill="black" stroke="black" points="6661.5,-45185.6 6658,-45175.6 6654.5,-45185.6 6661.5,-45185.6"/>
</g>
<!-- layer3_moe_comm_to_expert14 -->
<g id="node40" class="node">
<title>layer3_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7013" cy="-45146.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7013" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="7013" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7013" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert14 -->
<g id="edge35" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5021.56,-45289C5587.46,-45289 7013,-45289 7013,-45289 7013,-45289 7013,-45185.72 7013,-45185.72"/>
<polygon fill="black" stroke="black" points="7016.5,-45185.72 7013,-45175.72 7009.5,-45185.72 7016.5,-45185.72"/>
</g>
<!-- layer3_moe_comm_to_expert15 -->
<g id="node42" class="node">
<title>layer3_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7368" cy="-45146.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7368" y="-45155.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7368" y="-45144.05" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7368" y="-45133.05" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert15 -->
<g id="edge37" class="edge">
<title>layer3_moe_split&#45;&gt;layer3_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5034.71,-45302C5674.37,-45302 7368,-45302 7368,-45302 7368,-45302 7368,-45185.79 7368,-45185.79"/>
<polygon fill="black" stroke="black" points="7371.5,-45185.79 7368,-45175.79 7364.5,-45185.79 7371.5,-45185.79"/>
</g>
<!-- layer3_moe_expert0 -->
<g id="node11" class="node">
<title>layer3_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2400,-45081.56 2072,-45081.56 2072,-45029.56 2400,-45029.56 2400,-45081.56"/>
<text text-anchor="middle" x="2236" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 0 L3</text>
<text text-anchor="middle" x="2236" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2236" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2236" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert0 -->
<g id="node44" class="node">
<title>layer3_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2332" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2332" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2332" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2332" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer3_moe_expert0&#45;&gt;layer3_moe_comm_from_expert0 -->
<g id="edge39" class="edge">
<title>layer3_moe_expert0&#45;&gt;layer3_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2320.75,-45029.24C2320.75,-45029.24 2320.75,-45003.37 2320.75,-45003.37"/>
<polygon fill="black" stroke="black" points="2324.25,-45003.37 2320.75,-44993.37 2317.25,-45003.37 2324.25,-45003.37"/>
</g>
<!-- layer3_moe_comm_to_expert0&#45;&gt;layer3_moe_expert0 -->
<g id="edge8" class="edge">
<title>layer3_moe_comm_to_expert0&#45;&gt;layer3_moe_expert0</title>
<path fill="none" stroke="black" d="M2355.75,-45121.2C2355.75,-45121.2 2355.75,-45091.72 2355.75,-45091.72"/>
<polygon fill="black" stroke="black" points="2359.25,-45091.72 2355.75,-45081.72 2352.25,-45091.72 2359.25,-45091.72"/>
</g>
<!-- layer3_moe_expert1 -->
<g id="node13" class="node">
<title>layer3_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2746,-45081.56 2418,-45081.56 2418,-45029.56 2746,-45029.56 2746,-45081.56"/>
<text text-anchor="middle" x="2582" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 1 L3</text>
<text text-anchor="middle" x="2582" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2582" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2582" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert1 -->
<g id="node45" class="node">
<title>layer3_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2898" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2898" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2898" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2898" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer3_moe_expert1&#45;&gt;layer3_moe_comm_from_expert1 -->
<g id="edge41" class="edge">
<title>layer3_moe_expert1&#45;&gt;layer3_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2685.17,-45029.07C2685.17,-45002.03 2685.17,-44964 2685.17,-44964 2685.17,-44964 2797.43,-44964 2797.43,-44964"/>
<polygon fill="black" stroke="black" points="2797.43,-44967.5 2807.43,-44964 2797.43,-44960.5 2797.43,-44967.5"/>
</g>
<!-- layer3_moe_comm_to_expert1&#45;&gt;layer3_moe_expert1 -->
<g id="edge10" class="edge">
<title>layer3_moe_comm_to_expert1&#45;&gt;layer3_moe_expert1</title>
<path fill="none" stroke="black" d="M2701.75,-45121.2C2701.75,-45121.2 2701.75,-45091.72 2701.75,-45091.72"/>
<polygon fill="black" stroke="black" points="2705.25,-45091.72 2701.75,-45081.72 2698.25,-45091.72 2705.25,-45091.72"/>
</g>
<!-- layer3_moe_expert2 -->
<g id="node15" class="node">
<title>layer3_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="3092,-45081.56 2764,-45081.56 2764,-45029.56 3092,-45029.56 3092,-45081.56"/>
<text text-anchor="middle" x="2928" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 2 L3</text>
<text text-anchor="middle" x="2928" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2928" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2928" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert2 -->
<g id="node46" class="node">
<title>layer3_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="3281" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3281" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="3281" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3281" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer3_moe_expert2&#45;&gt;layer3_moe_comm_from_expert2 -->
<g id="edge43" class="edge">
<title>layer3_moe_expert2&#45;&gt;layer3_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M3057.18,-45029.07C3057.18,-45002.03 3057.18,-44964 3057.18,-44964 3057.18,-44964 3180.29,-44964 3180.29,-44964"/>
<polygon fill="black" stroke="black" points="3180.29,-44967.5 3190.29,-44964 3180.28,-44960.5 3180.29,-44967.5"/>
</g>
<!-- layer3_moe_comm_to_expert2&#45;&gt;layer3_moe_expert2 -->
<g id="edge12" class="edge">
<title>layer3_moe_comm_to_expert2&#45;&gt;layer3_moe_expert2</title>
<path fill="none" stroke="black" d="M3010.75,-45117.51C3010.75,-45117.51 3010.75,-45091.86 3010.75,-45091.86"/>
<polygon fill="black" stroke="black" points="3014.25,-45091.86 3010.75,-45081.86 3007.25,-45091.86 3014.25,-45091.86"/>
</g>
<!-- layer3_moe_expert3 -->
<g id="node17" class="node">
<title>layer3_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3438,-45081.56 3110,-45081.56 3110,-45029.56 3438,-45029.56 3438,-45081.56"/>
<text text-anchor="middle" x="3274" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 3 L3</text>
<text text-anchor="middle" x="3274" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3274" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3274" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert3 -->
<g id="node47" class="node">
<title>layer3_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3572" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3572" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3572" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3572" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer3_moe_expert3&#45;&gt;layer3_moe_comm_from_expert3 -->
<g id="edge45" class="edge">
<title>layer3_moe_expert3&#45;&gt;layer3_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3404.75,-45029.07C3404.75,-45002.03 3404.75,-44964 3404.75,-44964 3404.75,-44964 3471.04,-44964 3471.04,-44964"/>
<polygon fill="black" stroke="black" points="3471.04,-44967.5 3481.04,-44964 3471.04,-44960.5 3471.04,-44967.5"/>
</g>
<!-- layer3_moe_comm_to_expert3&#45;&gt;layer3_moe_expert3 -->
<g id="edge14" class="edge">
<title>layer3_moe_comm_to_expert3&#45;&gt;layer3_moe_expert3</title>
<path fill="none" stroke="black" d="M3347.75,-45117.51C3347.75,-45117.51 3347.75,-45091.86 3347.75,-45091.86"/>
<polygon fill="black" stroke="black" points="3351.25,-45091.86 3347.75,-45081.86 3344.25,-45091.86 3351.25,-45091.86"/>
</g>
<!-- layer3_moe_expert4 -->
<g id="node19" class="node">
<title>layer3_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3784,-45081.56 3456,-45081.56 3456,-45029.56 3784,-45029.56 3784,-45081.56"/>
<text text-anchor="middle" x="3620" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 4 L3</text>
<text text-anchor="middle" x="3620" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3620" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3620" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert4 -->
<g id="node48" class="node">
<title>layer3_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3817" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3817" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3817" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3817" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer3_moe_expert4&#45;&gt;layer3_moe_comm_from_expert4 -->
<g id="edge47" class="edge">
<title>layer3_moe_expert4&#45;&gt;layer3_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3755.25,-45029.24C3755.25,-45029.24 3755.25,-44995.93 3755.25,-44995.93"/>
<polygon fill="black" stroke="black" points="3758.75,-44995.93 3755.25,-44985.93 3751.75,-44995.93 3758.75,-44995.93"/>
</g>
<!-- layer3_moe_comm_to_expert4&#45;&gt;layer3_moe_expert4 -->
<g id="edge16" class="edge">
<title>layer3_moe_comm_to_expert4&#45;&gt;layer3_moe_expert4</title>
<path fill="none" stroke="black" d="M3767.25,-45129.43C3767.25,-45129.43 3767.25,-45091.9 3767.25,-45091.9"/>
<polygon fill="black" stroke="black" points="3770.75,-45091.9 3767.25,-45081.9 3763.75,-45091.9 3770.75,-45091.9"/>
</g>
<!-- layer3_moe_expert5 -->
<g id="node21" class="node">
<title>layer3_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="4130,-45081.56 3802,-45081.56 3802,-45029.56 4130,-45029.56 4130,-45081.56"/>
<text text-anchor="middle" x="3966" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 5 L3</text>
<text text-anchor="middle" x="3966" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3966" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3966" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert5 -->
<g id="node49" class="node">
<title>layer3_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="4039" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4039" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="4039" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4039" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer3_moe_expert5&#45;&gt;layer3_moe_comm_from_expert5 -->
<g id="edge49" class="edge">
<title>layer3_moe_expert5&#45;&gt;layer3_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M4039,-45029.24C4039,-45029.24 4039,-45003.7 4039,-45003.7"/>
<polygon fill="black" stroke="black" points="4042.5,-45003.7 4039,-44993.7 4035.5,-45003.7 4042.5,-45003.7"/>
</g>
<!-- layer3_moe_comm_to_expert5&#45;&gt;layer3_moe_expert5 -->
<g id="edge18" class="edge">
<title>layer3_moe_comm_to_expert5&#45;&gt;layer3_moe_expert5</title>
<path fill="none" stroke="black" d="M4113.25,-45129.43C4113.25,-45129.43 4113.25,-45091.9 4113.25,-45091.9"/>
<polygon fill="black" stroke="black" points="4116.75,-45091.9 4113.25,-45081.9 4109.75,-45091.9 4116.75,-45091.9"/>
</g>
<!-- layer3_moe_expert6 -->
<g id="node23" class="node">
<title>layer3_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4476,-45081.56 4148,-45081.56 4148,-45029.56 4476,-45029.56 4476,-45081.56"/>
<text text-anchor="middle" x="4312" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 6 L3</text>
<text text-anchor="middle" x="4312" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4312" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4312" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert6 -->
<g id="node50" class="node">
<title>layer3_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4385" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4385" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4385" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4385" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer3_moe_expert6&#45;&gt;layer3_moe_comm_from_expert6 -->
<g id="edge51" class="edge">
<title>layer3_moe_expert6&#45;&gt;layer3_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4385,-45029.24C4385,-45029.24 4385,-45003.7 4385,-45003.7"/>
<polygon fill="black" stroke="black" points="4388.5,-45003.7 4385,-44993.7 4381.5,-45003.7 4388.5,-45003.7"/>
</g>
<!-- layer3_moe_comm_to_expert6&#45;&gt;layer3_moe_expert6 -->
<g id="edge20" class="edge">
<title>layer3_moe_comm_to_expert6&#45;&gt;layer3_moe_expert6</title>
<path fill="none" stroke="black" d="M4422.25,-45119.74C4422.25,-45119.74 4422.25,-45091.86 4422.25,-45091.86"/>
<polygon fill="black" stroke="black" points="4425.75,-45091.86 4422.25,-45081.86 4418.75,-45091.86 4425.75,-45091.86"/>
</g>
<!-- layer3_moe_expert7 -->
<g id="node25" class="node">
<title>layer3_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4822,-45081.56 4494,-45081.56 4494,-45029.56 4822,-45029.56 4822,-45081.56"/>
<text text-anchor="middle" x="4658" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 7 L3</text>
<text text-anchor="middle" x="4658" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4658" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4658" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert7 -->
<g id="node51" class="node">
<title>layer3_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4695" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4695" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4695" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4695" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer3_moe_expert7&#45;&gt;layer3_moe_comm_from_expert7 -->
<g id="edge53" class="edge">
<title>layer3_moe_expert7&#45;&gt;layer3_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4695,-45029.24C4695,-45029.24 4695,-45003.7 4695,-45003.7"/>
<polygon fill="black" stroke="black" points="4698.5,-45003.7 4695,-44993.7 4691.5,-45003.7 4698.5,-45003.7"/>
</g>
<!-- layer3_moe_comm_to_expert7&#45;&gt;layer3_moe_expert7 -->
<g id="edge22" class="edge">
<title>layer3_moe_comm_to_expert7&#45;&gt;layer3_moe_expert7</title>
<path fill="none" stroke="black" d="M4695,-45117.51C4695,-45117.51 4695,-45091.86 4695,-45091.86"/>
<polygon fill="black" stroke="black" points="4698.5,-45091.86 4695,-45081.86 4691.5,-45091.86 4698.5,-45091.86"/>
</g>
<!-- layer3_moe_expert8 -->
<g id="node27" class="node">
<title>layer3_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="5168,-45081.56 4840,-45081.56 4840,-45029.56 5168,-45029.56 5168,-45081.56"/>
<text text-anchor="middle" x="5004" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 8 L3</text>
<text text-anchor="middle" x="5004" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="5004" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="5004" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert8 -->
<g id="node52" class="node">
<title>layer3_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4967" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4967" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4967" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4967" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer3_moe_expert8&#45;&gt;layer3_moe_comm_from_expert8 -->
<g id="edge55" class="edge">
<title>layer3_moe_expert8&#45;&gt;layer3_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4967,-45029.24C4967,-45029.24 4967,-45003.7 4967,-45003.7"/>
<polygon fill="black" stroke="black" points="4970.5,-45003.7 4967,-44993.7 4963.5,-45003.7 4970.5,-45003.7"/>
</g>
<!-- layer3_moe_comm_to_expert8&#45;&gt;layer3_moe_expert8 -->
<g id="edge24" class="edge">
<title>layer3_moe_comm_to_expert8&#45;&gt;layer3_moe_expert8</title>
<path fill="none" stroke="black" d="M4967,-45117.51C4967,-45117.51 4967,-45091.86 4967,-45091.86"/>
<polygon fill="black" stroke="black" points="4970.5,-45091.86 4967,-45081.86 4963.5,-45091.86 4970.5,-45091.86"/>
</g>
<!-- layer3_moe_expert9 -->
<g id="node29" class="node">
<title>layer3_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5514,-45081.56 5186,-45081.56 5186,-45029.56 5514,-45029.56 5514,-45081.56"/>
<text text-anchor="middle" x="5350" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 9 L3</text>
<text text-anchor="middle" x="5350" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5350" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5350" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert9 -->
<g id="node53" class="node">
<title>layer3_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5276" cy="-44964.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5276" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5276" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5276" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer3_moe_expert9&#45;&gt;layer3_moe_comm_from_expert9 -->
<g id="edge57" class="edge">
<title>layer3_moe_expert9&#45;&gt;layer3_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5276.25,-45029.24C5276.25,-45029.24 5276.25,-45003.7 5276.25,-45003.7"/>
<polygon fill="black" stroke="black" points="5279.75,-45003.7 5276.25,-44993.7 5272.75,-45003.7 5279.75,-45003.7"/>
</g>
<!-- layer3_moe_comm_to_expert9&#45;&gt;layer3_moe_expert9 -->
<g id="edge26" class="edge">
<title>layer3_moe_comm_to_expert9&#45;&gt;layer3_moe_expert9</title>
<path fill="none" stroke="black" d="M5276.25,-45117.51C5276.25,-45117.51 5276.25,-45091.86 5276.25,-45091.86"/>
<polygon fill="black" stroke="black" points="5279.75,-45091.86 5276.25,-45081.86 5272.75,-45091.86 5279.75,-45091.86"/>
</g>
<!-- layer3_moe_expert10 -->
<g id="node31" class="node">
<title>layer3_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5870,-45081.56 5532,-45081.56 5532,-45029.56 5870,-45029.56 5870,-45081.56"/>
<text text-anchor="middle" x="5701" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 10 L3</text>
<text text-anchor="middle" x="5701" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5701" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5701" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert10 -->
<g id="node54" class="node">
<title>layer3_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5608" cy="-44964.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5608" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5608" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5608" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer3_moe_expert10&#45;&gt;layer3_moe_comm_from_expert10 -->
<g id="edge59" class="edge">
<title>layer3_moe_expert10&#45;&gt;layer3_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5617.38,-45029.24C5617.38,-45029.24 5617.38,-45003.7 5617.38,-45003.7"/>
<polygon fill="black" stroke="black" points="5620.88,-45003.7 5617.38,-44993.7 5613.88,-45003.7 5620.88,-45003.7"/>
</g>
<!-- layer3_moe_comm_to_expert10&#45;&gt;layer3_moe_expert10 -->
<g id="edge28" class="edge">
<title>layer3_moe_comm_to_expert10&#45;&gt;layer3_moe_expert10</title>
<path fill="none" stroke="black" d="M5617.02,-45117.51C5617.02,-45117.51 5617.02,-45091.86 5617.02,-45091.86"/>
<polygon fill="black" stroke="black" points="5620.52,-45091.86 5617.02,-45081.86 5613.52,-45091.86 5620.52,-45091.86"/>
</g>
<!-- layer3_moe_expert11 -->
<g id="node33" class="node">
<title>layer3_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6226,-45081.56 5888,-45081.56 5888,-45029.56 6226,-45029.56 6226,-45081.56"/>
<text text-anchor="middle" x="6057" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 11 L3</text>
<text text-anchor="middle" x="6057" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="6057" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="6057" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert11 -->
<g id="node55" class="node">
<title>layer3_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5955" cy="-44964.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5955" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5955" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5955" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer3_moe_expert11&#45;&gt;layer3_moe_comm_from_expert11 -->
<g id="edge61" class="edge">
<title>layer3_moe_expert11&#45;&gt;layer3_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5968.88,-45029.24C5968.88,-45029.24 5968.88,-45003.37 5968.88,-45003.37"/>
<polygon fill="black" stroke="black" points="5972.38,-45003.37 5968.88,-44993.37 5965.38,-45003.37 5972.38,-45003.37"/>
</g>
<!-- layer3_moe_comm_to_expert11&#45;&gt;layer3_moe_expert11 -->
<g id="edge30" class="edge">
<title>layer3_moe_comm_to_expert11&#45;&gt;layer3_moe_expert11</title>
<path fill="none" stroke="black" d="M5968.02,-45117.76C5968.02,-45117.76 5968.02,-45091.69 5968.02,-45091.69"/>
<polygon fill="black" stroke="black" points="5971.52,-45091.69 5968.02,-45081.69 5964.52,-45091.69 5971.52,-45091.69"/>
</g>
<!-- layer3_moe_expert12 -->
<g id="node35" class="node">
<title>layer3_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6582,-45081.56 6244,-45081.56 6244,-45029.56 6582,-45029.56 6582,-45081.56"/>
<text text-anchor="middle" x="6413" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 12 L3</text>
<text text-anchor="middle" x="6413" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6413" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6413" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert12 -->
<g id="node56" class="node">
<title>layer3_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6306" cy="-44964.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6306" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6306" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6306" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer3_moe_expert12&#45;&gt;layer3_moe_comm_from_expert12 -->
<g id="edge63" class="edge">
<title>layer3_moe_expert12&#45;&gt;layer3_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6322.38,-45029.24C6322.38,-45029.24 6322.38,-45003.37 6322.38,-45003.37"/>
<polygon fill="black" stroke="black" points="6325.88,-45003.37 6322.38,-44993.37 6318.88,-45003.37 6325.88,-45003.37"/>
</g>
<!-- layer3_moe_comm_to_expert12&#45;&gt;layer3_moe_expert12 -->
<g id="edge32" class="edge">
<title>layer3_moe_comm_to_expert12&#45;&gt;layer3_moe_expert12</title>
<path fill="none" stroke="black" d="M6321.52,-45117.76C6321.52,-45117.76 6321.52,-45091.69 6321.52,-45091.69"/>
<polygon fill="black" stroke="black" points="6325.02,-45091.69 6321.52,-45081.69 6318.02,-45091.69 6325.02,-45091.69"/>
</g>
<!-- layer3_moe_expert13 -->
<g id="node37" class="node">
<title>layer3_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6938,-45081.56 6600,-45081.56 6600,-45029.56 6938,-45029.56 6938,-45081.56"/>
<text text-anchor="middle" x="6769" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 13 L3</text>
<text text-anchor="middle" x="6769" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6769" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6769" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert13 -->
<g id="node57" class="node">
<title>layer3_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6660" cy="-44964.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6660" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6660" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6660" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer3_moe_expert13&#45;&gt;layer3_moe_comm_from_expert13 -->
<g id="edge65" class="edge">
<title>layer3_moe_expert13&#45;&gt;layer3_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6677.38,-45029.24C6677.38,-45029.24 6677.38,-45003.37 6677.38,-45003.37"/>
<polygon fill="black" stroke="black" points="6680.88,-45003.37 6677.38,-44993.37 6673.88,-45003.37 6680.88,-45003.37"/>
</g>
<!-- layer3_moe_comm_to_expert13&#45;&gt;layer3_moe_expert13 -->
<g id="edge34" class="edge">
<title>layer3_moe_comm_to_expert13&#45;&gt;layer3_moe_expert13</title>
<path fill="none" stroke="black" d="M6676.02,-45117.76C6676.02,-45117.76 6676.02,-45091.69 6676.02,-45091.69"/>
<polygon fill="black" stroke="black" points="6679.52,-45091.69 6676.02,-45081.69 6672.52,-45091.69 6679.52,-45091.69"/>
</g>
<!-- layer3_moe_expert14 -->
<g id="node39" class="node">
<title>layer3_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7294,-45081.56 6956,-45081.56 6956,-45029.56 7294,-45029.56 7294,-45081.56"/>
<text text-anchor="middle" x="7125" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 14 L3</text>
<text text-anchor="middle" x="7125" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7125" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="7125" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert14 -->
<g id="node58" class="node">
<title>layer3_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="7015" cy="-44964.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7015" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="7015" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7015" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer3_moe_expert14&#45;&gt;layer3_moe_comm_from_expert14 -->
<g id="edge67" class="edge">
<title>layer3_moe_expert14&#45;&gt;layer3_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M7032.88,-45029.24C7032.88,-45029.24 7032.88,-45003.05 7032.88,-45003.05"/>
<polygon fill="black" stroke="black" points="7036.38,-45003.05 7032.88,-44993.05 7029.38,-45003.05 7036.38,-45003.05"/>
</g>
<!-- layer3_moe_comm_to_expert14&#45;&gt;layer3_moe_expert14 -->
<g id="edge36" class="edge">
<title>layer3_moe_comm_to_expert14&#45;&gt;layer3_moe_expert14</title>
<path fill="none" stroke="black" d="M7031.52,-45117.76C7031.52,-45117.76 7031.52,-45091.69 7031.52,-45091.69"/>
<polygon fill="black" stroke="black" points="7035.02,-45091.69 7031.52,-45081.69 7028.02,-45091.69 7035.02,-45091.69"/>
</g>
<!-- layer3_moe_expert15 -->
<g id="node41" class="node">
<title>layer3_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7650,-45081.56 7312,-45081.56 7312,-45029.56 7650,-45029.56 7650,-45081.56"/>
<text text-anchor="middle" x="7481" y="-45069.56" font-family="Arial" font-size="10.00">EXPERT 15 L3</text>
<text text-anchor="middle" x="7481" y="-45058.56" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7481" y="-45047.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7481" y="-45036.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_comm_from_expert15 -->
<g id="node59" class="node">
<title>layer3_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7370" cy="-44964.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7370" y="-44973.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7370" y="-44962.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7370" y="-44951.06" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer3_moe_expert15&#45;&gt;layer3_moe_comm_from_expert15 -->
<g id="edge69" class="edge">
<title>layer3_moe_expert15&#45;&gt;layer3_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7388.38,-45029.24C7388.38,-45029.24 7388.38,-45003.05 7388.38,-45003.05"/>
<polygon fill="black" stroke="black" points="7391.88,-45003.05 7388.38,-44993.05 7384.88,-45003.05 7391.88,-45003.05"/>
</g>
<!-- layer3_moe_comm_to_expert15&#45;&gt;layer3_moe_expert15 -->
<g id="edge38" class="edge">
<title>layer3_moe_comm_to_expert15&#45;&gt;layer3_moe_expert15</title>
<path fill="none" stroke="black" d="M7387.02,-45117.76C7387.02,-45117.76 7387.02,-45091.69 7387.02,-45091.69"/>
<polygon fill="black" stroke="black" points="7390.52,-45091.69 7387.02,-45081.69 7383.52,-45091.69 7390.52,-45091.69"/>
</g>
<!-- layer3_moe_aggregate -->
<g id="node43" class="node">
<title>layer3_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="5093.1,-44899.57 4676.16,-44899.57 4568.9,-44795.57 4985.84,-44795.57 5093.1,-44899.57"/>
<text text-anchor="middle" x="4831" y="-44861.57" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L3</text>
<text text-anchor="middle" x="4831" y="-44850.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4831" y="-44839.57" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4831" y="-44828.57" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_mha -->
<g id="node60" class="node">
<title>layer4_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4961,-44759.57 4701,-44759.57 4701,-44707.57 4961,-44707.57 4961,-44759.57"/>
<text text-anchor="middle" x="4831" y="-44747.57" font-family="Arial" font-size="10.00">MHA L4</text>
<text text-anchor="middle" x="4831" y="-44736.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4831" y="-44725.57" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4831" y="-44714.57" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer3_moe_aggregate&#45;&gt;layer4_moe_mha -->
<g id="edge138" class="edge">
<title>layer3_moe_aggregate&#45;&gt;layer4_moe_mha</title>
<path fill="none" stroke="black" d="M4831,-44795.24C4831,-44795.24 4831,-44769.8 4831,-44769.8"/>
<polygon fill="black" stroke="black" points="4834.5,-44769.8 4831,-44759.8 4827.5,-44769.8 4834.5,-44769.8"/>
</g>
<!-- layer3_moe_comm_from_expert0&#45;&gt;layer3_moe_aggregate -->
<g id="edge40" class="edge">
<title>layer3_moe_comm_from_expert0&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M2357.5,-44936.57C2357.5,-44892.03 2357.5,-44810 2357.5,-44810 2357.5,-44810 4573.65,-44810 4573.65,-44810"/>
<polygon fill="black" stroke="black" points="4573.65,-44813.5 4583.65,-44810 4573.65,-44806.5 4573.65,-44813.5"/>
</g>
<!-- layer3_moe_comm_from_expert1&#45;&gt;layer3_moe_aggregate -->
<g id="edge42" class="edge">
<title>layer3_moe_comm_from_expert1&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M2949.5,-44940.57C2949.5,-44900.67 2949.5,-44825 2949.5,-44825 2949.5,-44825 4588.88,-44825 4588.88,-44825"/>
<polygon fill="black" stroke="black" points="4588.88,-44828.5 4598.88,-44825 4588.88,-44821.5 4588.88,-44828.5"/>
</g>
<!-- layer3_moe_comm_from_expert2&#45;&gt;layer3_moe_aggregate -->
<g id="edge44" class="edge">
<title>layer3_moe_comm_from_expert2&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M3328,-44939.66C3328,-44903.31 3328,-44840 3328,-44840 3328,-44840 4604.46,-44840 4604.46,-44840"/>
<polygon fill="black" stroke="black" points="4604.46,-44843.5 4614.46,-44840 4604.46,-44836.5 4604.46,-44843.5"/>
</g>
<!-- layer3_moe_comm_from_expert3&#45;&gt;layer3_moe_aggregate -->
<g id="edge46" class="edge">
<title>layer3_moe_comm_from_expert3&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M3642.5,-44945.98C3642.5,-44914.72 3642.5,-44855 3642.5,-44855 3642.5,-44855 4620.06,-44855 4620.06,-44855"/>
<polygon fill="black" stroke="black" points="4620.06,-44858.5 4630.06,-44855 4620.06,-44851.5 4620.06,-44858.5"/>
</g>
<!-- layer3_moe_comm_from_expert4&#45;&gt;layer3_moe_aggregate -->
<g id="edge48" class="edge">
<title>layer3_moe_comm_from_expert4&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M3855.51,-44938.2C3855.51,-44909.91 3855.51,-44869 3855.51,-44869 3855.51,-44869 4634.36,-44869 4634.36,-44869"/>
<polygon fill="black" stroke="black" points="4634.36,-44872.5 4644.36,-44869 4634.36,-44865.5 4634.36,-44872.5"/>
</g>
<!-- layer3_moe_comm_from_expert5&#45;&gt;layer3_moe_aggregate -->
<g id="edge50" class="edge">
<title>layer3_moe_comm_from_expert5&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M4085.5,-44939.52C4085.5,-44915.87 4085.5,-44884 4085.5,-44884 4085.5,-44884 4649.97,-44884 4649.97,-44884"/>
<polygon fill="black" stroke="black" points="4649.97,-44887.5 4659.97,-44884 4649.97,-44880.5 4649.97,-44887.5"/>
</g>
<!-- layer3_moe_comm_from_expert6&#45;&gt;layer3_moe_aggregate -->
<g id="edge52" class="edge">
<title>layer3_moe_comm_from_expert6&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M4475.77,-44964C4529.28,-44964 4586.6,-44964 4586.6,-44964 4586.6,-44964 4586.6,-44857.66 4586.6,-44857.66"/>
<polygon fill="black" stroke="black" points="4590.1,-44857.66 4586.6,-44847.66 4583.1,-44857.66 4590.1,-44857.66"/>
</g>
<!-- layer3_moe_comm_from_expert7&#45;&gt;layer3_moe_aggregate -->
<g id="edge54" class="edge">
<title>layer3_moe_comm_from_expert7&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M4695,-44935.34C4695,-44935.34 4695,-44909.63 4695,-44909.63"/>
<polygon fill="black" stroke="black" points="4698.5,-44909.63 4695,-44899.63 4691.5,-44909.63 4698.5,-44909.63"/>
</g>
<!-- layer3_moe_comm_from_expert8&#45;&gt;layer3_moe_aggregate -->
<g id="edge56" class="edge">
<title>layer3_moe_comm_from_expert8&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M4967,-44935.34C4967,-44935.34 4967,-44909.63 4967,-44909.63"/>
<polygon fill="black" stroke="black" points="4970.5,-44909.63 4967,-44899.63 4963.5,-44909.63 4970.5,-44909.63"/>
</g>
<!-- layer3_moe_comm_from_expert9&#45;&gt;layer3_moe_aggregate -->
<g id="edge58" class="edge">
<title>layer3_moe_comm_from_expert9&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M5185.39,-44964C5132.23,-44964 5075.4,-44964 5075.4,-44964 5075.4,-44964 5075.4,-44857.66 5075.4,-44857.66"/>
<polygon fill="black" stroke="black" points="5078.9,-44857.66 5075.4,-44847.66 5071.9,-44857.66 5078.9,-44857.66"/>
</g>
<!-- layer3_moe_comm_from_expert10&#45;&gt;layer3_moe_aggregate -->
<g id="edge60" class="edge">
<title>layer3_moe_comm_from_expert10&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M5639.35,-44936.84C5639.35,-44913.53 5639.35,-44884 5639.35,-44884 5639.35,-44884 5087.1,-44884 5087.1,-44884"/>
<polygon fill="black" stroke="black" points="5087.1,-44880.5 5077.1,-44884 5087.1,-44887.5 5087.1,-44880.5"/>
</g>
<!-- layer3_moe_comm_from_expert11&#45;&gt;layer3_moe_aggregate -->
<g id="edge62" class="edge">
<title>layer3_moe_comm_from_expert11&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M5922.85,-44937.18C5922.85,-44908.94 5922.85,-44869 5922.85,-44869 5922.85,-44869 5071.89,-44869 5071.89,-44869"/>
<polygon fill="black" stroke="black" points="5071.89,-44865.5 5061.89,-44869 5071.89,-44872.5 5071.89,-44865.5"/>
</g>
<!-- layer3_moe_comm_from_expert12&#45;&gt;layer3_moe_aggregate -->
<g id="edge64" class="edge">
<title>layer3_moe_comm_from_expert12&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M6273.85,-44937.2C6273.85,-44904.75 6273.85,-44855 6273.85,-44855 6273.85,-44855 5057.4,-44855 5057.4,-44855"/>
<polygon fill="black" stroke="black" points="5057.4,-44851.5 5047.4,-44855 5057.4,-44858.5 5057.4,-44851.5"/>
</g>
<!-- layer3_moe_comm_from_expert13&#45;&gt;layer3_moe_aggregate -->
<g id="edge66" class="edge">
<title>layer3_moe_comm_from_expert13&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M6627.51,-44937.23C6627.51,-44900.56 6627.51,-44840 6627.51,-44840 6627.51,-44840 5041.85,-44840 5041.85,-44840"/>
<polygon fill="black" stroke="black" points="5041.85,-44836.5 5031.85,-44840 5041.85,-44843.5 5041.85,-44836.5"/>
</g>
<!-- layer3_moe_comm_from_expert14&#45;&gt;layer3_moe_aggregate -->
<g id="edge68" class="edge">
<title>layer3_moe_comm_from_expert14&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M6982.51,-44937.32C6982.51,-44896.71 6982.51,-44825 6982.51,-44825 6982.51,-44825 5026.3,-44825 5026.3,-44825"/>
<polygon fill="black" stroke="black" points="5026.3,-44821.5 5016.3,-44825 5026.3,-44828.5 5026.3,-44821.5"/>
</g>
<!-- layer3_moe_comm_from_expert15&#45;&gt;layer3_moe_aggregate -->
<g id="edge70" class="edge">
<title>layer3_moe_comm_from_expert15&#45;&gt;layer3_moe_aggregate</title>
<path fill="none" stroke="black" d="M7337.51,-44937.29C7337.51,-44892.91 7337.51,-44810 7337.51,-44810 7337.51,-44810 5010.82,-44810 5010.82,-44810"/>
<polygon fill="black" stroke="black" points="5010.82,-44806.5 5000.82,-44810 5010.82,-44813.5 5010.82,-44806.5"/>
</g>
<!-- layer4_moe_gate -->
<g id="node61" class="node">
<title>layer4_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="5089.3,-44671.57 4678.4,-44671.57 4572.7,-44567.57 4983.6,-44567.57 5089.3,-44671.57"/>
<text text-anchor="middle" x="4831" y="-44633.57" font-family="Arial" font-size="10.00">GATE L4</text>
<text text-anchor="middle" x="4831" y="-44622.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4831" y="-44611.57" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4831" y="-44600.57" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer4_moe_mha&#45;&gt;layer4_moe_gate -->
<g id="edge139" class="edge">
<title>layer4_moe_mha&#45;&gt;layer4_moe_gate</title>
<path fill="none" stroke="black" d="M4831,-44707.42C4831,-44707.42 4831,-44681.67 4831,-44681.67"/>
<polygon fill="black" stroke="black" points="4834.5,-44681.67 4831,-44671.67 4827.5,-44681.67 4834.5,-44681.67"/>
</g>
<!-- layer4_moe_split -->
<g id="node62" class="node">
<title>layer4_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="5085.01,-44531.57 4680.94,-44531.57 4576.99,-44427.57 4981.06,-44427.57 5085.01,-44531.57"/>
<text text-anchor="middle" x="4831" y="-44493.57" font-family="Arial" font-size="10.00">SPLIT TOKENS L4</text>
<text text-anchor="middle" x="4831" y="-44482.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4831" y="-44471.57" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4831" y="-44460.57" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer4_moe_gate&#45;&gt;layer4_moe_split -->
<g id="edge140" class="edge">
<title>layer4_moe_gate&#45;&gt;layer4_moe_split</title>
<path fill="none" stroke="black" d="M4831,-44567.44C4831,-44567.44 4831,-44541.75 4831,-44541.75"/>
<polygon fill="black" stroke="black" points="4834.5,-44541.75 4831,-44531.75 4827.5,-44541.75 4834.5,-44541.75"/>
</g>
<!-- layer4_moe_comm_to_expert0 -->
<g id="node64" class="node">
<title>layer4_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2383" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2383" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2383" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2383" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert0 -->
<g id="edge74" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4665.32,-44516C4124.92,-44516 2448.01,-44516 2448.01,-44516 2448.01,-44516 2448.01,-44392.95 2448.01,-44392.95"/>
<polygon fill="black" stroke="black" points="2451.51,-44392.95 2448.01,-44382.95 2444.51,-44392.95 2451.51,-44392.95"/>
</g>
<!-- layer4_moe_comm_to_expert1 -->
<g id="node66" class="node">
<title>layer4_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2655" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2655" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2655" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2655" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert1 -->
<g id="edge76" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4649.99,-44501C4122.67,-44501 2624.83,-44501 2624.83,-44501 2624.83,-44501 2624.83,-44399.93 2624.83,-44399.93"/>
<polygon fill="black" stroke="black" points="2628.33,-44399.93 2624.83,-44389.93 2621.33,-44399.93 2628.33,-44399.93"/>
</g>
<!-- layer4_moe_comm_to_expert2 -->
<g id="node68" class="node">
<title>layer4_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3001" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3001" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3001" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3001" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert2 -->
<g id="edge78" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4636.21,-44487C4168.93,-44487 3022.84,-44487 3022.84,-44487 3022.84,-44487 3022.84,-44400.81 3022.84,-44400.81"/>
<polygon fill="black" stroke="black" points="3026.34,-44400.81 3022.84,-44390.81 3019.34,-44400.81 3026.34,-44400.81"/>
</g>
<!-- layer4_moe_comm_to_expert3 -->
<g id="node70" class="node">
<title>layer4_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3375" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3375" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3375" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3375" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert3 -->
<g id="edge80" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4621.02,-44472C4237.05,-44472 3460.75,-44472 3460.75,-44472 3460.75,-44472 3460.75,-44381.91 3460.75,-44381.91"/>
<polygon fill="black" stroke="black" points="3464.25,-44381.91 3460.75,-44371.91 3457.25,-44381.91 3464.25,-44381.91"/>
</g>
<!-- layer4_moe_comm_to_expert4 -->
<g id="node72" class="node">
<title>layer4_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3713" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3713" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3713" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3713" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert4 -->
<g id="edge82" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4606.23,-44457C4293.48,-44457 3765,-44457 3765,-44457 3765,-44457 3765,-44396.41 3765,-44396.41"/>
<polygon fill="black" stroke="black" points="3768.5,-44396.41 3765,-44386.41 3761.5,-44396.41 3768.5,-44396.41"/>
</g>
<!-- layer4_moe_comm_to_expert5 -->
<g id="node74" class="node">
<title>layer4_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4132" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4132" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="4132" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="4132" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert5 -->
<g id="edge84" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4591.01,-44442C4407.32,-44442 4185.25,-44442 4185.25,-44442 4185.25,-44442 4185.25,-44396.41 4185.25,-44396.41"/>
<polygon fill="black" stroke="black" points="4188.75,-44396.41 4185.25,-44386.41 4181.75,-44396.41 4188.75,-44396.41"/>
</g>
<!-- layer4_moe_comm_to_expert6 -->
<g id="node76" class="node">
<title>layer4_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4441" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4441" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4441" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4441" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert6 -->
<g id="edge86" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4590.74,-44479.49C4590.74,-44475.93 4590.74,-44362 4590.74,-44362 4590.74,-44362 4541.56,-44362 4541.56,-44362"/>
<polygon fill="black" stroke="black" points="4541.56,-44358.5 4531.56,-44362 4541.56,-44365.5 4541.56,-44358.5"/>
</g>
<!-- layer4_moe_comm_to_expert7 -->
<g id="node78" class="node">
<title>layer4_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4695" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4695" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4695" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4695" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert7 -->
<g id="edge88" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4695,-44427.24C4695,-44427.24 4695,-44401.79 4695,-44401.79"/>
<polygon fill="black" stroke="black" points="4698.5,-44401.79 4695,-44391.79 4691.5,-44401.79 4698.5,-44401.79"/>
</g>
<!-- layer4_moe_comm_to_expert8 -->
<g id="node80" class="node">
<title>layer4_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4967" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4967" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4967" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4967" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert8 -->
<g id="edge90" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4967,-44427.24C4967,-44427.24 4967,-44401.79 4967,-44401.79"/>
<polygon fill="black" stroke="black" points="4970.5,-44401.79 4967,-44391.79 4963.5,-44401.79 4970.5,-44401.79"/>
</g>
<!-- layer4_moe_comm_to_expert9 -->
<g id="node82" class="node">
<title>layer4_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5276" cy="-44362.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5276" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5276" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5276" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert9 -->
<g id="edge92" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5071.26,-44479.49C5071.26,-44475.93 5071.26,-44362 5071.26,-44362 5071.26,-44362 5175.3,-44362 5175.3,-44362"/>
<polygon fill="black" stroke="black" points="5175.3,-44365.5 5185.3,-44362 5175.3,-44358.5 5175.3,-44365.5"/>
</g>
<!-- layer4_moe_comm_to_expert10 -->
<g id="node84" class="node">
<title>layer4_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5608" cy="-44362.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5608" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5608" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5608" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert10 -->
<g id="edge94" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4995.56,-44442C5215.15,-44442 5576.65,-44442 5576.65,-44442 5576.65,-44442 5576.65,-44400.36 5576.65,-44400.36"/>
<polygon fill="black" stroke="black" points="5580.15,-44400.36 5576.65,-44390.36 5573.15,-44400.36 5580.15,-44400.36"/>
</g>
<!-- layer4_moe_comm_to_expert11 -->
<g id="node86" class="node">
<title>layer4_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5954" cy="-44362.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5954" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5954" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5954" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert11 -->
<g id="edge96" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5010.75,-44457C5335.22,-44457 5985.45,-44457 5985.45,-44457 5985.45,-44457 5985.45,-44400.15 5985.45,-44400.15"/>
<polygon fill="black" stroke="black" points="5988.95,-44400.15 5985.45,-44390.15 5981.95,-44400.15 5988.95,-44400.15"/>
</g>
<!-- layer4_moe_comm_to_expert12 -->
<g id="node88" class="node">
<title>layer4_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6305" cy="-44362.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6305" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6305" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6305" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert12 -->
<g id="edge98" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5025.5,-44472C5432.47,-44472 6336.45,-44472 6336.45,-44472 6336.45,-44472 6336.45,-44399.91 6336.45,-44399.91"/>
<polygon fill="black" stroke="black" points="6339.95,-44399.91 6336.45,-44389.91 6332.95,-44399.91 6339.95,-44399.91"/>
</g>
<!-- layer4_moe_comm_to_expert13 -->
<g id="node90" class="node">
<title>layer4_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6658" cy="-44362.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6658" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6658" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6658" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert13 -->
<g id="edge100" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5040.61,-44487C5526.73,-44487 6689.78,-44487 6689.78,-44487 6689.78,-44487 6689.78,-44399.89 6689.78,-44399.89"/>
<polygon fill="black" stroke="black" points="6693.28,-44399.89 6689.78,-44389.89 6686.28,-44399.89 6693.28,-44399.89"/>
</g>
<!-- layer4_moe_comm_to_expert14 -->
<g id="node92" class="node">
<title>layer4_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7013" cy="-44362.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7013" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="7013" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7013" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert14 -->
<g id="edge102" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5054.68,-44501C5616.96,-44501 7044.78,-44501 7044.78,-44501 7044.78,-44501 7044.78,-44399.93 7044.78,-44399.93"/>
<polygon fill="black" stroke="black" points="7048.28,-44399.93 7044.78,-44389.93 7041.28,-44399.93 7048.28,-44399.93"/>
</g>
<!-- layer4_moe_comm_to_expert15 -->
<g id="node94" class="node">
<title>layer4_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7368" cy="-44362.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7368" y="-44371.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7368" y="-44360.08" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7368" y="-44349.08" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert15 -->
<g id="edge104" class="edge">
<title>layer4_moe_split&#45;&gt;layer4_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5069.5,-44516C5706.53,-44516 7399.78,-44516 7399.78,-44516 7399.78,-44516 7399.78,-44400.01 7399.78,-44400.01"/>
<polygon fill="black" stroke="black" points="7403.28,-44400.01 7399.78,-44390.01 7396.28,-44400.01 7403.28,-44400.01"/>
</g>
<!-- layer4_moe_expert0 -->
<g id="node63" class="node">
<title>layer4_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2400,-44297.59 2072,-44297.59 2072,-44245.59 2400,-44245.59 2400,-44297.59"/>
<text text-anchor="middle" x="2236" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 0 L4</text>
<text text-anchor="middle" x="2236" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2236" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2236" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert0 -->
<g id="node96" class="node">
<title>layer4_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2309" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2309" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2309" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2309" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer4_moe_expert0&#45;&gt;layer4_moe_comm_from_expert0 -->
<g id="edge106" class="edge">
<title>layer4_moe_expert0&#45;&gt;layer4_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2309,-44245.27C2309,-44245.27 2309,-44219.73 2309,-44219.73"/>
<polygon fill="black" stroke="black" points="2312.5,-44219.73 2309,-44209.73 2305.5,-44219.73 2312.5,-44219.73"/>
</g>
<!-- layer4_moe_comm_to_expert0&#45;&gt;layer4_moe_expert0 -->
<g id="edge75" class="edge">
<title>layer4_moe_comm_to_expert0&#45;&gt;layer4_moe_expert0</title>
<path fill="none" stroke="black" d="M2346.25,-44335.77C2346.25,-44335.77 2346.25,-44307.89 2346.25,-44307.89"/>
<polygon fill="black" stroke="black" points="2349.75,-44307.89 2346.25,-44297.89 2342.75,-44307.89 2349.75,-44307.89"/>
</g>
<!-- layer4_moe_expert1 -->
<g id="node65" class="node">
<title>layer4_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2746,-44297.59 2418,-44297.59 2418,-44245.59 2746,-44245.59 2746,-44297.59"/>
<text text-anchor="middle" x="2582" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 1 L4</text>
<text text-anchor="middle" x="2582" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2582" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2582" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert1 -->
<g id="node97" class="node">
<title>layer4_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2692" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2692" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2692" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2692" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer4_moe_expert1&#45;&gt;layer4_moe_comm_from_expert1 -->
<g id="edge108" class="edge">
<title>layer4_moe_expert1&#45;&gt;layer4_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2673.75,-44245.27C2673.75,-44245.27 2673.75,-44219.09 2673.75,-44219.09"/>
<polygon fill="black" stroke="black" points="2677.25,-44219.09 2673.75,-44209.09 2670.25,-44219.09 2677.25,-44219.09"/>
</g>
<!-- layer4_moe_comm_to_expert1&#45;&gt;layer4_moe_expert1 -->
<g id="edge77" class="edge">
<title>layer4_moe_comm_to_expert1&#45;&gt;layer4_moe_expert1</title>
<path fill="none" stroke="black" d="M2655,-44333.54C2655,-44333.54 2655,-44307.89 2655,-44307.89"/>
<polygon fill="black" stroke="black" points="2658.5,-44307.89 2655,-44297.89 2651.5,-44307.89 2658.5,-44307.89"/>
</g>
<!-- layer4_moe_expert2 -->
<g id="node67" class="node">
<title>layer4_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="3092,-44297.59 2764,-44297.59 2764,-44245.59 3092,-44245.59 3092,-44297.59"/>
<text text-anchor="middle" x="2928" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 2 L4</text>
<text text-anchor="middle" x="2928" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2928" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2928" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert2 -->
<g id="node98" class="node">
<title>layer4_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="3112" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3112" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="3112" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3112" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer4_moe_expert2&#45;&gt;layer4_moe_comm_from_expert2 -->
<g id="edge110" class="edge">
<title>layer4_moe_expert2&#45;&gt;layer4_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M3056.75,-44245.27C3056.75,-44245.27 3056.75,-44213.76 3056.75,-44213.76"/>
<polygon fill="black" stroke="black" points="3060.25,-44213.76 3056.75,-44203.76 3053.25,-44213.76 3060.25,-44213.76"/>
</g>
<!-- layer4_moe_comm_to_expert2&#45;&gt;layer4_moe_expert2 -->
<g id="edge79" class="edge">
<title>layer4_moe_comm_to_expert2&#45;&gt;layer4_moe_expert2</title>
<path fill="none" stroke="black" d="M3001,-44333.54C3001,-44333.54 3001,-44307.89 3001,-44307.89"/>
<polygon fill="black" stroke="black" points="3004.5,-44307.89 3001,-44297.89 2997.5,-44307.89 3004.5,-44307.89"/>
</g>
<!-- layer4_moe_expert3 -->
<g id="node69" class="node">
<title>layer4_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3438,-44297.59 3110,-44297.59 3110,-44245.59 3438,-44245.59 3438,-44297.59"/>
<text text-anchor="middle" x="3274" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 3 L4</text>
<text text-anchor="middle" x="3274" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3274" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3274" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert3 -->
<g id="node99" class="node">
<title>layer4_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3458" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3458" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3458" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3458" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer4_moe_expert3&#45;&gt;layer4_moe_comm_from_expert3 -->
<g id="edge112" class="edge">
<title>layer4_moe_expert3&#45;&gt;layer4_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3402.75,-44245.27C3402.75,-44245.27 3402.75,-44213.76 3402.75,-44213.76"/>
<polygon fill="black" stroke="black" points="3406.25,-44213.76 3402.75,-44203.76 3399.25,-44213.76 3406.25,-44213.76"/>
</g>
<!-- layer4_moe_comm_to_expert3&#45;&gt;layer4_moe_expert3 -->
<g id="edge81" class="edge">
<title>layer4_moe_comm_to_expert3&#45;&gt;layer4_moe_expert3</title>
<path fill="none" stroke="black" d="M3361.25,-44333.79C3361.25,-44333.79 3361.25,-44307.73 3361.25,-44307.73"/>
<polygon fill="black" stroke="black" points="3364.75,-44307.73 3361.25,-44297.73 3357.75,-44307.73 3364.75,-44307.73"/>
</g>
<!-- layer4_moe_expert4 -->
<g id="node71" class="node">
<title>layer4_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3784,-44297.59 3456,-44297.59 3456,-44245.59 3784,-44245.59 3784,-44297.59"/>
<text text-anchor="middle" x="3620" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 4 L4</text>
<text text-anchor="middle" x="3620" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3620" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3620" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert4 -->
<g id="node100" class="node">
<title>layer4_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3730" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3730" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3730" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3730" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer4_moe_expert4&#45;&gt;layer4_moe_comm_from_expert4 -->
<g id="edge114" class="edge">
<title>layer4_moe_expert4&#45;&gt;layer4_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3711.75,-44245.27C3711.75,-44245.27 3711.75,-44219.09 3711.75,-44219.09"/>
<polygon fill="black" stroke="black" points="3715.25,-44219.09 3711.75,-44209.09 3708.25,-44219.09 3715.25,-44219.09"/>
</g>
<!-- layer4_moe_comm_to_expert4&#45;&gt;layer4_moe_expert4 -->
<g id="edge83" class="edge">
<title>layer4_moe_comm_to_expert4&#45;&gt;layer4_moe_expert4</title>
<path fill="none" stroke="black" d="M3703.25,-44333.54C3703.25,-44333.54 3703.25,-44307.89 3703.25,-44307.89"/>
<polygon fill="black" stroke="black" points="3706.75,-44307.89 3703.25,-44297.89 3699.75,-44307.89 3706.75,-44307.89"/>
</g>
<!-- layer4_moe_expert5 -->
<g id="node73" class="node">
<title>layer4_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="4130,-44297.59 3802,-44297.59 3802,-44245.59 4130,-44245.59 4130,-44297.59"/>
<text text-anchor="middle" x="3966" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 5 L4</text>
<text text-anchor="middle" x="3966" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3966" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3966" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert5 -->
<g id="node101" class="node">
<title>layer4_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="4077" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4077" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="4077" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4077" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer4_moe_expert5&#45;&gt;layer4_moe_comm_from_expert5 -->
<g id="edge116" class="edge">
<title>layer4_moe_expert5&#45;&gt;layer4_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M4058.25,-44245.27C4058.25,-44245.27 4058.25,-44219.09 4058.25,-44219.09"/>
<polygon fill="black" stroke="black" points="4061.75,-44219.09 4058.25,-44209.09 4054.75,-44219.09 4061.75,-44219.09"/>
</g>
<!-- layer4_moe_comm_to_expert5&#45;&gt;layer4_moe_expert5 -->
<g id="edge85" class="edge">
<title>layer4_moe_comm_to_expert5&#45;&gt;layer4_moe_expert5</title>
<path fill="none" stroke="black" d="M4085.75,-44337.24C4085.75,-44337.24 4085.75,-44307.75 4085.75,-44307.75"/>
<polygon fill="black" stroke="black" points="4089.25,-44307.75 4085.75,-44297.75 4082.25,-44307.75 4089.25,-44307.75"/>
</g>
<!-- layer4_moe_expert6 -->
<g id="node75" class="node">
<title>layer4_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4476,-44297.59 4148,-44297.59 4148,-44245.59 4476,-44245.59 4476,-44297.59"/>
<text text-anchor="middle" x="4312" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 6 L4</text>
<text text-anchor="middle" x="4312" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4312" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4312" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert6 -->
<g id="node102" class="node">
<title>layer4_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4423" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4423" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4423" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4423" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer4_moe_expert6&#45;&gt;layer4_moe_comm_from_expert6 -->
<g id="edge118" class="edge">
<title>layer4_moe_expert6&#45;&gt;layer4_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4404.25,-44245.27C4404.25,-44245.27 4404.25,-44219.09 4404.25,-44219.09"/>
<polygon fill="black" stroke="black" points="4407.75,-44219.09 4404.25,-44209.09 4400.75,-44219.09 4407.75,-44219.09"/>
</g>
<!-- layer4_moe_comm_to_expert6&#45;&gt;layer4_moe_expert6 -->
<g id="edge87" class="edge">
<title>layer4_moe_comm_to_expert6&#45;&gt;layer4_moe_expert6</title>
<path fill="none" stroke="black" d="M4413.25,-44334.79C4413.25,-44334.79 4413.25,-44307.66 4413.25,-44307.66"/>
<polygon fill="black" stroke="black" points="4416.75,-44307.66 4413.25,-44297.66 4409.75,-44307.66 4416.75,-44307.66"/>
</g>
<!-- layer4_moe_expert7 -->
<g id="node77" class="node">
<title>layer4_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4822,-44297.59 4494,-44297.59 4494,-44245.59 4822,-44245.59 4822,-44297.59"/>
<text text-anchor="middle" x="4658" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 7 L4</text>
<text text-anchor="middle" x="4658" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4658" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4658" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert7 -->
<g id="node103" class="node">
<title>layer4_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4695" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4695" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4695" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4695" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer4_moe_expert7&#45;&gt;layer4_moe_comm_from_expert7 -->
<g id="edge120" class="edge">
<title>layer4_moe_expert7&#45;&gt;layer4_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4695,-44245.27C4695,-44245.27 4695,-44219.73 4695,-44219.73"/>
<polygon fill="black" stroke="black" points="4698.5,-44219.73 4695,-44209.73 4691.5,-44219.73 4698.5,-44219.73"/>
</g>
<!-- layer4_moe_comm_to_expert7&#45;&gt;layer4_moe_expert7 -->
<g id="edge89" class="edge">
<title>layer4_moe_comm_to_expert7&#45;&gt;layer4_moe_expert7</title>
<path fill="none" stroke="black" d="M4695,-44333.54C4695,-44333.54 4695,-44307.89 4695,-44307.89"/>
<polygon fill="black" stroke="black" points="4698.5,-44307.89 4695,-44297.89 4691.5,-44307.89 4698.5,-44307.89"/>
</g>
<!-- layer4_moe_expert8 -->
<g id="node79" class="node">
<title>layer4_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="5168,-44297.59 4840,-44297.59 4840,-44245.59 5168,-44245.59 5168,-44297.59"/>
<text text-anchor="middle" x="5004" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 8 L4</text>
<text text-anchor="middle" x="5004" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="5004" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="5004" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert8 -->
<g id="node104" class="node">
<title>layer4_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4967" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4967" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4967" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4967" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer4_moe_expert8&#45;&gt;layer4_moe_comm_from_expert8 -->
<g id="edge122" class="edge">
<title>layer4_moe_expert8&#45;&gt;layer4_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4967,-44245.27C4967,-44245.27 4967,-44219.73 4967,-44219.73"/>
<polygon fill="black" stroke="black" points="4970.5,-44219.73 4967,-44209.73 4963.5,-44219.73 4970.5,-44219.73"/>
</g>
<!-- layer4_moe_comm_to_expert8&#45;&gt;layer4_moe_expert8 -->
<g id="edge91" class="edge">
<title>layer4_moe_comm_to_expert8&#45;&gt;layer4_moe_expert8</title>
<path fill="none" stroke="black" d="M4967,-44333.54C4967,-44333.54 4967,-44307.89 4967,-44307.89"/>
<polygon fill="black" stroke="black" points="4970.5,-44307.89 4967,-44297.89 4963.5,-44307.89 4970.5,-44307.89"/>
</g>
<!-- layer4_moe_expert9 -->
<g id="node81" class="node">
<title>layer4_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5514,-44297.59 5186,-44297.59 5186,-44245.59 5514,-44245.59 5514,-44297.59"/>
<text text-anchor="middle" x="5350" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 9 L4</text>
<text text-anchor="middle" x="5350" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5350" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5350" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert9 -->
<g id="node105" class="node">
<title>layer4_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5276" cy="-44180.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5276" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5276" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5276" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer4_moe_expert9&#45;&gt;layer4_moe_comm_from_expert9 -->
<g id="edge124" class="edge">
<title>layer4_moe_expert9&#45;&gt;layer4_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5276.25,-44245.27C5276.25,-44245.27 5276.25,-44219.73 5276.25,-44219.73"/>
<polygon fill="black" stroke="black" points="5279.75,-44219.73 5276.25,-44209.73 5272.75,-44219.73 5279.75,-44219.73"/>
</g>
<!-- layer4_moe_comm_to_expert9&#45;&gt;layer4_moe_expert9 -->
<g id="edge93" class="edge">
<title>layer4_moe_comm_to_expert9&#45;&gt;layer4_moe_expert9</title>
<path fill="none" stroke="black" d="M5276.25,-44333.54C5276.25,-44333.54 5276.25,-44307.89 5276.25,-44307.89"/>
<polygon fill="black" stroke="black" points="5279.75,-44307.89 5276.25,-44297.89 5272.75,-44307.89 5279.75,-44307.89"/>
</g>
<!-- layer4_moe_expert10 -->
<g id="node83" class="node">
<title>layer4_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5870,-44297.59 5532,-44297.59 5532,-44245.59 5870,-44245.59 5870,-44297.59"/>
<text text-anchor="middle" x="5701" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 10 L4</text>
<text text-anchor="middle" x="5701" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5701" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5701" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert10 -->
<g id="node106" class="node">
<title>layer4_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5608" cy="-44180.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5608" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5608" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5608" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer4_moe_expert10&#45;&gt;layer4_moe_comm_from_expert10 -->
<g id="edge126" class="edge">
<title>layer4_moe_expert10&#45;&gt;layer4_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5617.38,-44245.27C5617.38,-44245.27 5617.38,-44219.73 5617.38,-44219.73"/>
<polygon fill="black" stroke="black" points="5620.88,-44219.73 5617.38,-44209.73 5613.88,-44219.73 5620.88,-44219.73"/>
</g>
<!-- layer4_moe_comm_to_expert10&#45;&gt;layer4_moe_expert10 -->
<g id="edge95" class="edge">
<title>layer4_moe_comm_to_expert10&#45;&gt;layer4_moe_expert10</title>
<path fill="none" stroke="black" d="M5617.02,-44333.54C5617.02,-44333.54 5617.02,-44307.89 5617.02,-44307.89"/>
<polygon fill="black" stroke="black" points="5620.52,-44307.89 5617.02,-44297.89 5613.52,-44307.89 5620.52,-44307.89"/>
</g>
<!-- layer4_moe_expert11 -->
<g id="node85" class="node">
<title>layer4_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6226,-44297.59 5888,-44297.59 5888,-44245.59 6226,-44245.59 6226,-44297.59"/>
<text text-anchor="middle" x="6057" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 11 L4</text>
<text text-anchor="middle" x="6057" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="6057" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="6057" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert11 -->
<g id="node107" class="node">
<title>layer4_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5955" cy="-44180.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5955" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5955" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5955" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer4_moe_expert11&#45;&gt;layer4_moe_comm_from_expert11 -->
<g id="edge128" class="edge">
<title>layer4_moe_expert11&#45;&gt;layer4_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5968.88,-44245.27C5968.88,-44245.27 5968.88,-44219.41 5968.88,-44219.41"/>
<polygon fill="black" stroke="black" points="5972.38,-44219.41 5968.88,-44209.41 5965.38,-44219.41 5972.38,-44219.41"/>
</g>
<!-- layer4_moe_comm_to_expert11&#45;&gt;layer4_moe_expert11 -->
<g id="edge97" class="edge">
<title>layer4_moe_comm_to_expert11&#45;&gt;layer4_moe_expert11</title>
<path fill="none" stroke="black" d="M5968.02,-44333.79C5968.02,-44333.79 5968.02,-44307.73 5968.02,-44307.73"/>
<polygon fill="black" stroke="black" points="5971.52,-44307.73 5968.02,-44297.73 5964.52,-44307.73 5971.52,-44307.73"/>
</g>
<!-- layer4_moe_expert12 -->
<g id="node87" class="node">
<title>layer4_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6582,-44297.59 6244,-44297.59 6244,-44245.59 6582,-44245.59 6582,-44297.59"/>
<text text-anchor="middle" x="6413" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 12 L4</text>
<text text-anchor="middle" x="6413" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6413" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6413" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert12 -->
<g id="node108" class="node">
<title>layer4_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6306" cy="-44180.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6306" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6306" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6306" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer4_moe_expert12&#45;&gt;layer4_moe_comm_from_expert12 -->
<g id="edge130" class="edge">
<title>layer4_moe_expert12&#45;&gt;layer4_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6322.38,-44245.27C6322.38,-44245.27 6322.38,-44219.41 6322.38,-44219.41"/>
<polygon fill="black" stroke="black" points="6325.88,-44219.41 6322.38,-44209.41 6318.88,-44219.41 6325.88,-44219.41"/>
</g>
<!-- layer4_moe_comm_to_expert12&#45;&gt;layer4_moe_expert12 -->
<g id="edge99" class="edge">
<title>layer4_moe_comm_to_expert12&#45;&gt;layer4_moe_expert12</title>
<path fill="none" stroke="black" d="M6321.52,-44333.79C6321.52,-44333.79 6321.52,-44307.73 6321.52,-44307.73"/>
<polygon fill="black" stroke="black" points="6325.02,-44307.73 6321.52,-44297.73 6318.02,-44307.73 6325.02,-44307.73"/>
</g>
<!-- layer4_moe_expert13 -->
<g id="node89" class="node">
<title>layer4_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6938,-44297.59 6600,-44297.59 6600,-44245.59 6938,-44245.59 6938,-44297.59"/>
<text text-anchor="middle" x="6769" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 13 L4</text>
<text text-anchor="middle" x="6769" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6769" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6769" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert13 -->
<g id="node109" class="node">
<title>layer4_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6660" cy="-44180.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6660" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6660" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6660" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer4_moe_expert13&#45;&gt;layer4_moe_comm_from_expert13 -->
<g id="edge132" class="edge">
<title>layer4_moe_expert13&#45;&gt;layer4_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6677.38,-44245.27C6677.38,-44245.27 6677.38,-44219.41 6677.38,-44219.41"/>
<polygon fill="black" stroke="black" points="6680.88,-44219.41 6677.38,-44209.41 6673.88,-44219.41 6680.88,-44219.41"/>
</g>
<!-- layer4_moe_comm_to_expert13&#45;&gt;layer4_moe_expert13 -->
<g id="edge101" class="edge">
<title>layer4_moe_comm_to_expert13&#45;&gt;layer4_moe_expert13</title>
<path fill="none" stroke="black" d="M6676.02,-44333.79C6676.02,-44333.79 6676.02,-44307.73 6676.02,-44307.73"/>
<polygon fill="black" stroke="black" points="6679.52,-44307.73 6676.02,-44297.73 6672.52,-44307.73 6679.52,-44307.73"/>
</g>
<!-- layer4_moe_expert14 -->
<g id="node91" class="node">
<title>layer4_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7294,-44297.59 6956,-44297.59 6956,-44245.59 7294,-44245.59 7294,-44297.59"/>
<text text-anchor="middle" x="7125" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 14 L4</text>
<text text-anchor="middle" x="7125" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7125" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="7125" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert14 -->
<g id="node110" class="node">
<title>layer4_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="7015" cy="-44180.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7015" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="7015" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7015" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer4_moe_expert14&#45;&gt;layer4_moe_comm_from_expert14 -->
<g id="edge134" class="edge">
<title>layer4_moe_expert14&#45;&gt;layer4_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M7032.88,-44245.27C7032.88,-44245.27 7032.88,-44219.09 7032.88,-44219.09"/>
<polygon fill="black" stroke="black" points="7036.38,-44219.09 7032.88,-44209.09 7029.38,-44219.09 7036.38,-44219.09"/>
</g>
<!-- layer4_moe_comm_to_expert14&#45;&gt;layer4_moe_expert14 -->
<g id="edge103" class="edge">
<title>layer4_moe_comm_to_expert14&#45;&gt;layer4_moe_expert14</title>
<path fill="none" stroke="black" d="M7031.52,-44333.79C7031.52,-44333.79 7031.52,-44307.73 7031.52,-44307.73"/>
<polygon fill="black" stroke="black" points="7035.02,-44307.73 7031.52,-44297.73 7028.02,-44307.73 7035.02,-44307.73"/>
</g>
<!-- layer4_moe_expert15 -->
<g id="node93" class="node">
<title>layer4_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7650,-44297.59 7312,-44297.59 7312,-44245.59 7650,-44245.59 7650,-44297.59"/>
<text text-anchor="middle" x="7481" y="-44285.59" font-family="Arial" font-size="10.00">EXPERT 15 L4</text>
<text text-anchor="middle" x="7481" y="-44274.59" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7481" y="-44263.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7481" y="-44252.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_comm_from_expert15 -->
<g id="node111" class="node">
<title>layer4_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7370" cy="-44180.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7370" y="-44189.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7370" y="-44178.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7370" y="-44167.1" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer4_moe_expert15&#45;&gt;layer4_moe_comm_from_expert15 -->
<g id="edge136" class="edge">
<title>layer4_moe_expert15&#45;&gt;layer4_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7388.38,-44245.27C7388.38,-44245.27 7388.38,-44219.09 7388.38,-44219.09"/>
<polygon fill="black" stroke="black" points="7391.88,-44219.09 7388.38,-44209.09 7384.88,-44219.09 7391.88,-44219.09"/>
</g>
<!-- layer4_moe_comm_to_expert15&#45;&gt;layer4_moe_expert15 -->
<g id="edge105" class="edge">
<title>layer4_moe_comm_to_expert15&#45;&gt;layer4_moe_expert15</title>
<path fill="none" stroke="black" d="M7387.02,-44333.79C7387.02,-44333.79 7387.02,-44307.73 7387.02,-44307.73"/>
<polygon fill="black" stroke="black" points="7390.52,-44307.73 7387.02,-44297.73 7383.52,-44307.73 7390.52,-44307.73"/>
</g>
<!-- layer4_moe_aggregate -->
<g id="node95" class="node">
<title>layer4_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="5056.1,-44115.61 4639.16,-44115.61 4531.9,-44011.61 4948.84,-44011.61 5056.1,-44115.61"/>
<text text-anchor="middle" x="4794" y="-44077.61" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L4</text>
<text text-anchor="middle" x="4794" y="-44066.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-44055.61" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4794" y="-44044.61" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_mha -->
<g id="node112" class="node">
<title>layer5_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4924,-43975.61 4664,-43975.61 4664,-43923.61 4924,-43923.61 4924,-43975.61"/>
<text text-anchor="middle" x="4794" y="-43963.61" font-family="Arial" font-size="10.00">MHA L5</text>
<text text-anchor="middle" x="4794" y="-43952.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-43941.61" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4794" y="-43930.61" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer4_moe_aggregate&#45;&gt;layer5_moe_mha -->
<g id="edge205" class="edge">
<title>layer4_moe_aggregate&#45;&gt;layer5_moe_mha</title>
<path fill="none" stroke="black" d="M4794,-44011.28C4794,-44011.28 4794,-43985.84 4794,-43985.84"/>
<polygon fill="black" stroke="black" points="4797.5,-43985.84 4794,-43975.84 4790.5,-43985.84 4797.5,-43985.84"/>
</g>
<!-- layer4_moe_comm_from_expert0&#45;&gt;layer4_moe_aggregate -->
<g id="edge107" class="edge">
<title>layer4_moe_comm_from_expert0&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M2333.5,-44152.6C2333.5,-44108.05 2333.5,-44026 2333.5,-44026 2333.5,-44026 4536.53,-44026 4536.53,-44026"/>
<polygon fill="black" stroke="black" points="4536.53,-44029.5 4546.53,-44026 4536.53,-44022.5 4536.53,-44029.5"/>
</g>
<!-- layer4_moe_comm_from_expert1&#45;&gt;layer4_moe_aggregate -->
<g id="edge109" class="edge">
<title>layer4_moe_comm_from_expert1&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M2754.75,-44159.7C2754.75,-44120.76 2754.75,-44041 2754.75,-44041 2754.75,-44041 4552.06,-44041 4552.06,-44041"/>
<polygon fill="black" stroke="black" points="4552.06,-44044.5 4562.06,-44041 4552.06,-44037.5 4552.06,-44044.5"/>
</g>
<!-- layer4_moe_comm_from_expert2&#45;&gt;layer4_moe_aggregate -->
<g id="edge111" class="edge">
<title>layer4_moe_comm_from_expert2&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M3137.75,-44152.64C3137.75,-44115.9 3137.75,-44056 3137.75,-44056 3137.75,-44056 4567.47,-44056 4567.47,-44056"/>
<polygon fill="black" stroke="black" points="4567.47,-44059.5 4577.47,-44056 4567.47,-44052.5 4567.47,-44059.5"/>
</g>
<!-- layer4_moe_comm_from_expert3&#45;&gt;layer4_moe_aggregate -->
<g id="edge113" class="edge">
<title>layer4_moe_comm_from_expert3&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M3487.5,-44152.94C3487.5,-44120.47 3487.5,-44071 3487.5,-44071 3487.5,-44071 4583.08,-44071 4583.08,-44071"/>
<polygon fill="black" stroke="black" points="4583.08,-44074.5 4593.08,-44071 4583.08,-44067.5 4583.08,-44074.5"/>
</g>
<!-- layer4_moe_comm_from_expert4&#45;&gt;layer4_moe_aggregate -->
<g id="edge115" class="edge">
<title>layer4_moe_comm_from_expert4&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M3815,-44170.37C3815,-44145.71 3815,-44085 3815,-44085 3815,-44085 4597.55,-44085 4597.55,-44085"/>
<polygon fill="black" stroke="black" points="4597.55,-44088.5 4607.55,-44085 4597.55,-44081.5 4597.55,-44088.5"/>
</g>
<!-- layer4_moe_comm_from_expert5&#45;&gt;layer4_moe_aggregate -->
<g id="edge117" class="edge">
<title>layer4_moe_comm_from_expert5&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M4134,-44157.72C4134,-44133.89 4134,-44100 4134,-44100 4134,-44100 4612.75,-44100 4612.75,-44100"/>
<polygon fill="black" stroke="black" points="4612.75,-44103.5 4622.75,-44100 4612.75,-44096.5 4612.75,-44103.5"/>
</g>
<!-- layer4_moe_comm_from_expert6&#45;&gt;layer4_moe_aggregate -->
<g id="edge119" class="edge">
<title>layer4_moe_comm_from_expert6&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M4513.65,-44180C4542.98,-44180 4568.1,-44180 4568.1,-44180 4568.1,-44180 4568.1,-44073.69 4568.1,-44073.69"/>
<polygon fill="black" stroke="black" points="4571.6,-44073.69 4568.1,-44063.69 4564.6,-44073.69 4571.6,-44073.69"/>
</g>
<!-- layer4_moe_comm_from_expert7&#45;&gt;layer4_moe_aggregate -->
<g id="edge121" class="edge">
<title>layer4_moe_comm_from_expert7&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M4695,-44151.38C4695,-44151.38 4695,-44125.67 4695,-44125.67"/>
<polygon fill="black" stroke="black" points="4698.5,-44125.67 4695,-44115.67 4691.5,-44125.67 4698.5,-44125.67"/>
</g>
<!-- layer4_moe_comm_from_expert8&#45;&gt;layer4_moe_aggregate -->
<g id="edge123" class="edge">
<title>layer4_moe_comm_from_expert8&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M4966.39,-44151.38C4966.39,-44151.38 4966.39,-44125.67 4966.39,-44125.67"/>
<polygon fill="black" stroke="black" points="4969.89,-44125.67 4966.39,-44115.67 4962.89,-44125.67 4969.89,-44125.67"/>
</g>
<!-- layer4_moe_comm_from_expert9&#45;&gt;layer4_moe_aggregate -->
<g id="edge125" class="edge">
<title>layer4_moe_comm_from_expert9&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M5257.5,-44151.78C5257.5,-44129.35 5257.5,-44102 5257.5,-44102 5257.5,-44102 5052.37,-44102 5052.37,-44102"/>
<polygon fill="black" stroke="black" points="5052.37,-44098.5 5042.37,-44102 5052.37,-44105.5 5052.37,-44098.5"/>
</g>
<!-- layer4_moe_comm_from_expert10&#45;&gt;layer4_moe_aggregate -->
<g id="edge127" class="edge">
<title>layer4_moe_comm_from_expert10&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M5589.15,-44152.12C5589.15,-44125.23 5589.15,-44089 5589.15,-44089 5589.15,-44089 5038.81,-44089 5038.81,-44089"/>
<polygon fill="black" stroke="black" points="5038.81,-44085.5 5028.81,-44089 5038.81,-44092.5 5038.81,-44085.5"/>
</g>
<!-- layer4_moe_comm_from_expert11&#45;&gt;layer4_moe_aggregate -->
<g id="edge129" class="edge">
<title>layer4_moe_comm_from_expert11&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M5935.65,-44152.02C5935.65,-44121.05 5935.65,-44076 5935.65,-44076 5935.65,-44076 5025.47,-44076 5025.47,-44076"/>
<polygon fill="black" stroke="black" points="5025.47,-44072.5 5015.47,-44076 5025.47,-44079.5 5025.47,-44072.5"/>
</g>
<!-- layer4_moe_comm_from_expert12&#45;&gt;layer4_moe_aggregate -->
<g id="edge131" class="edge">
<title>layer4_moe_comm_from_expert12&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M6286.65,-44152.13C6286.65,-44117.33 6286.65,-44063 6286.65,-44063 6286.65,-44063 5011.94,-44063 5011.94,-44063"/>
<polygon fill="black" stroke="black" points="5011.94,-44059.5 5001.94,-44063 5011.94,-44066.5 5011.94,-44059.5"/>
</g>
<!-- layer4_moe_comm_from_expert13&#45;&gt;layer4_moe_aggregate -->
<g id="edge133" class="edge">
<title>layer4_moe_comm_from_expert13&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M6640.15,-44151.94C6640.15,-44113.49 6640.15,-44050 6640.15,-44050 6640.15,-44050 4998.52,-44050 4998.52,-44050"/>
<polygon fill="black" stroke="black" points="4998.52,-44046.5 4988.52,-44050 4998.52,-44053.5 4998.52,-44046.5"/>
</g>
<!-- layer4_moe_comm_from_expert14&#45;&gt;layer4_moe_aggregate -->
<g id="edge135" class="edge">
<title>layer4_moe_comm_from_expert14&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M6995.15,-44152.23C6995.15,-44110.38 6995.15,-44037 6995.15,-44037 6995.15,-44037 4985.06,-44037 4985.06,-44037"/>
<polygon fill="black" stroke="black" points="4985.06,-44033.5 4975.06,-44037 4985.06,-44040.5 4985.06,-44033.5"/>
</g>
<!-- layer4_moe_comm_from_expert15&#45;&gt;layer4_moe_aggregate -->
<g id="edge137" class="edge">
<title>layer4_moe_comm_from_expert15&#45;&gt;layer4_moe_aggregate</title>
<path fill="none" stroke="black" d="M7350.15,-44152.24C7350.15,-44107.11 7350.15,-44024 7350.15,-44024 7350.15,-44024 4971.72,-44024 4971.72,-44024"/>
<polygon fill="black" stroke="black" points="4971.72,-44020.5 4961.72,-44024 4971.72,-44027.5 4971.72,-44020.5"/>
</g>
<!-- layer5_moe_gate -->
<g id="node113" class="node">
<title>layer5_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="5052.3,-43887.61 4641.4,-43887.61 4535.7,-43783.61 4946.6,-43783.61 5052.3,-43887.61"/>
<text text-anchor="middle" x="4794" y="-43849.61" font-family="Arial" font-size="10.00">GATE L5</text>
<text text-anchor="middle" x="4794" y="-43838.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-43827.61" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-43816.61" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer5_moe_mha&#45;&gt;layer5_moe_gate -->
<g id="edge206" class="edge">
<title>layer5_moe_mha&#45;&gt;layer5_moe_gate</title>
<path fill="none" stroke="black" d="M4794,-43923.45C4794,-43923.45 4794,-43897.71 4794,-43897.71"/>
<polygon fill="black" stroke="black" points="4797.5,-43897.71 4794,-43887.71 4790.5,-43897.71 4797.5,-43897.71"/>
</g>
<!-- layer5_moe_split -->
<g id="node114" class="node">
<title>layer5_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="5048.01,-43747.61 4643.94,-43747.61 4539.99,-43643.61 4944.06,-43643.61 5048.01,-43747.61"/>
<text text-anchor="middle" x="4794" y="-43709.61" font-family="Arial" font-size="10.00">SPLIT TOKENS L5</text>
<text text-anchor="middle" x="4794" y="-43698.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-43687.61" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4794" y="-43676.61" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer5_moe_gate&#45;&gt;layer5_moe_split -->
<g id="edge207" class="edge">
<title>layer5_moe_gate&#45;&gt;layer5_moe_split</title>
<path fill="none" stroke="black" d="M4794,-43783.48C4794,-43783.48 4794,-43757.78 4794,-43757.78"/>
<polygon fill="black" stroke="black" points="4797.5,-43757.78 4794,-43747.78 4790.5,-43757.78 4797.5,-43757.78"/>
</g>
<!-- layer5_moe_comm_to_expert0 -->
<g id="node116" class="node">
<title>layer5_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2358" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2358" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2358" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2358" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert0 -->
<g id="edge141" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4628,-43732C4090.64,-43732 2433.25,-43732 2433.25,-43732 2433.25,-43732 2433.25,-43604.74 2433.25,-43604.74"/>
<polygon fill="black" stroke="black" points="2436.75,-43604.74 2433.25,-43594.74 2429.75,-43604.74 2436.75,-43604.74"/>
</g>
<!-- layer5_moe_comm_to_expert1 -->
<g id="node118" class="node">
<title>layer5_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2630" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2630" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2630" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2630" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert1 -->
<g id="edge143" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4613.06,-43717C4098.03,-43717 2661,-43717 2661,-43717 2661,-43717 2661,-43615.96 2661,-43615.96"/>
<polygon fill="black" stroke="black" points="2664.5,-43615.96 2661,-43605.96 2657.5,-43615.96 2664.5,-43615.96"/>
</g>
<!-- layer5_moe_comm_to_expert2 -->
<g id="node120" class="node">
<title>layer5_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2951" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2951" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2951" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2951" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert2 -->
<g id="edge145" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4599.07,-43703C4140.44,-43703 3031.5,-43703 3031.5,-43703 3031.5,-43703 3031.5,-43601.93 3031.5,-43601.93"/>
<polygon fill="black" stroke="black" points="3035,-43601.93 3031.5,-43591.93 3028,-43601.93 3035,-43601.93"/>
</g>
<!-- layer5_moe_comm_to_expert3 -->
<g id="node122" class="node">
<title>layer5_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3517" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3517" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3517" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3517" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert3 -->
<g id="edge147" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4584.27,-43688C4236.42,-43688 3578.01,-43688 3578.01,-43688 3578.01,-43688 3578.01,-43610.23 3578.01,-43610.23"/>
<polygon fill="black" stroke="black" points="3581.51,-43610.23 3578.01,-43600.23 3574.51,-43610.23 3581.51,-43610.23"/>
</g>
<!-- layer5_moe_comm_to_expert4 -->
<g id="node124" class="node">
<title>layer5_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3900" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3900" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3900" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3900" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert4 -->
<g id="edge149" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4569.29,-43673C4305.49,-43673 3903.5,-43673 3903.5,-43673 3903.5,-43673 3903.5,-43617.7 3903.5,-43617.7"/>
<polygon fill="black" stroke="black" points="3907,-43617.7 3903.5,-43607.7 3900,-43617.7 3907,-43617.7"/>
</g>
<!-- layer5_moe_comm_to_expert5 -->
<g id="node126" class="node">
<title>layer5_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4191" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4191" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="4191" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="4191" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert5 -->
<g id="edge151" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4554.14,-43658C4398.5,-43658 4224.51,-43658 4224.51,-43658 4224.51,-43658 4224.51,-43615.94 4224.51,-43615.94"/>
<polygon fill="black" stroke="black" points="4228.01,-43615.94 4224.51,-43605.94 4221.01,-43615.94 4228.01,-43615.94"/>
</g>
<!-- layer5_moe_comm_to_expert6 -->
<g id="node128" class="node">
<title>layer5_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4436" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4436" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4436" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4436" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert6 -->
<g id="edge153" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4553.74,-43695.52C4553.74,-43691.96 4553.74,-43578 4553.74,-43578 4553.74,-43578 4536.73,-43578 4536.73,-43578"/>
<polygon fill="black" stroke="black" points="4536.73,-43574.5 4526.73,-43578 4536.73,-43581.5 4536.73,-43574.5"/>
</g>
<!-- layer5_moe_comm_to_expert7 -->
<g id="node130" class="node">
<title>layer5_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4658" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4658" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4658" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4658" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert7 -->
<g id="edge155" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4658,-43643.27C4658,-43643.27 4658,-43617.83 4658,-43617.83"/>
<polygon fill="black" stroke="black" points="4661.5,-43617.83 4658,-43607.83 4654.5,-43617.83 4661.5,-43617.83"/>
</g>
<!-- layer5_moe_comm_to_expert8 -->
<g id="node132" class="node">
<title>layer5_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4930" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4930" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4930" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4930" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert8 -->
<g id="edge157" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4930,-43643.27C4930,-43643.27 4930,-43617.83 4930,-43617.83"/>
<polygon fill="black" stroke="black" points="4933.5,-43617.83 4930,-43607.83 4926.5,-43617.83 4933.5,-43617.83"/>
</g>
<!-- layer5_moe_comm_to_expert9 -->
<g id="node134" class="node">
<title>layer5_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5239" cy="-43578.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5239" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5239" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5239" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert9 -->
<g id="edge159" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5034.26,-43695.52C5034.26,-43691.96 5034.26,-43578 5034.26,-43578 5034.26,-43578 5138.3,-43578 5138.3,-43578"/>
<polygon fill="black" stroke="black" points="5138.3,-43581.5 5148.3,-43578 5138.3,-43574.5 5138.3,-43581.5"/>
</g>
<!-- layer5_moe_comm_to_expert10 -->
<g id="node136" class="node">
<title>layer5_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5571" cy="-43578.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5571" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5571" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5571" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert10 -->
<g id="edge161" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4958.82,-43658C5166.07,-43658 5495.1,-43658 5495.1,-43658 5495.1,-43658 5495.1,-43605.84 5495.1,-43605.84"/>
<polygon fill="black" stroke="black" points="5498.6,-43605.84 5495.1,-43595.84 5491.6,-43605.84 5498.6,-43605.84"/>
</g>
<!-- layer5_moe_comm_to_expert11 -->
<g id="node138" class="node">
<title>layer5_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5917" cy="-43578.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5917" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5917" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5917" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert11 -->
<g id="edge163" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.49,-43673C5272.86,-43673 5841.6,-43673 5841.6,-43673 5841.6,-43673 5841.6,-43606.37 5841.6,-43606.37"/>
<polygon fill="black" stroke="black" points="5845.1,-43606.37 5841.6,-43596.37 5838.1,-43606.37 5845.1,-43606.37"/>
</g>
<!-- layer5_moe_comm_to_expert12 -->
<g id="node140" class="node">
<title>layer5_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6268" cy="-43578.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6268" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6268" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6268" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert12 -->
<g id="edge165" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4988.47,-43688C5372.77,-43688 6192.6,-43688 6192.6,-43688 6192.6,-43688 6192.6,-43606.19 6192.6,-43606.19"/>
<polygon fill="black" stroke="black" points="6196.1,-43606.19 6192.6,-43596.19 6189.1,-43606.19 6196.1,-43606.19"/>
</g>
<!-- layer5_moe_comm_to_expert13 -->
<g id="node142" class="node">
<title>layer5_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6621" cy="-43578.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6621" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6621" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6621" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert13 -->
<g id="edge167" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5003.6,-43703C5468.67,-43703 6546.1,-43703 6546.1,-43703 6546.1,-43703 6546.1,-43606.17 6546.1,-43606.17"/>
<polygon fill="black" stroke="black" points="6549.6,-43606.17 6546.1,-43596.17 6542.6,-43606.17 6549.6,-43606.17"/>
</g>
<!-- layer5_moe_comm_to_expert14 -->
<g id="node144" class="node">
<title>layer5_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6976" cy="-43578.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6976" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6976" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6976" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert14 -->
<g id="edge169" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5017.5,-43717C5559.79,-43717 6901.1,-43717 6901.1,-43717 6901.1,-43717 6901.1,-43606.42 6901.1,-43606.42"/>
<polygon fill="black" stroke="black" points="6904.6,-43606.42 6901.1,-43596.42 6897.6,-43606.42 6904.6,-43606.42"/>
</g>
<!-- layer5_moe_comm_to_expert15 -->
<g id="node146" class="node">
<title>layer5_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7331" cy="-43578.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7331" y="-43587.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7331" y="-43576.12" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7331" y="-43565.12" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert15 -->
<g id="edge171" class="edge">
<title>layer5_moe_split&#45;&gt;layer5_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5032.59,-43732C5650.69,-43732 7256.1,-43732 7256.1,-43732 7256.1,-43732 7256.1,-43606.21 7256.1,-43606.21"/>
<polygon fill="black" stroke="black" points="7259.6,-43606.21 7256.1,-43596.21 7252.6,-43606.21 7259.6,-43606.21"/>
</g>
<!-- layer5_moe_expert0 -->
<g id="node115" class="node">
<title>layer5_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2363,-43513.63 2035,-43513.63 2035,-43461.63 2363,-43461.63 2363,-43513.63"/>
<text text-anchor="middle" x="2199" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 0 L5</text>
<text text-anchor="middle" x="2199" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2199" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2199" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert0 -->
<g id="node148" class="node">
<title>layer5_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2374" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2374" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2374" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2374" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer5_moe_expert0&#45;&gt;layer5_moe_comm_from_expert0 -->
<g id="edge173" class="edge">
<title>layer5_moe_expert0&#45;&gt;layer5_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2323.25,-43461.31C2323.25,-43461.31 2323.25,-43430.72 2323.25,-43430.72"/>
<polygon fill="black" stroke="black" points="2326.75,-43430.72 2323.25,-43420.72 2319.75,-43430.72 2326.75,-43430.72"/>
</g>
<!-- layer5_moe_comm_to_expert0&#45;&gt;layer5_moe_expert0 -->
<g id="edge142" class="edge">
<title>layer5_moe_comm_to_expert0&#45;&gt;layer5_moe_expert0</title>
<path fill="none" stroke="black" d="M2315.25,-43552.79C2315.25,-43552.79 2315.25,-43523.84 2315.25,-43523.84"/>
<polygon fill="black" stroke="black" points="2318.75,-43523.84 2315.25,-43513.84 2311.75,-43523.84 2318.75,-43523.84"/>
</g>
<!-- layer5_moe_expert1 -->
<g id="node117" class="node">
<title>layer5_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2709,-43513.63 2381,-43513.63 2381,-43461.63 2709,-43461.63 2709,-43513.63"/>
<text text-anchor="middle" x="2545" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 1 L5</text>
<text text-anchor="middle" x="2545" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2545" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2545" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert1 -->
<g id="node149" class="node">
<title>layer5_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2646" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2646" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2646" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2646" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer5_moe_expert1&#45;&gt;layer5_moe_comm_from_expert1 -->
<g id="edge175" class="edge">
<title>layer5_moe_expert1&#45;&gt;layer5_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2632.25,-43461.31C2632.25,-43461.31 2632.25,-43435.44 2632.25,-43435.44"/>
<polygon fill="black" stroke="black" points="2635.75,-43435.44 2632.25,-43425.44 2628.75,-43435.44 2635.75,-43435.44"/>
</g>
<!-- layer5_moe_comm_to_expert1&#45;&gt;layer5_moe_expert1 -->
<g id="edge144" class="edge">
<title>layer5_moe_comm_to_expert1&#45;&gt;layer5_moe_expert1</title>
<path fill="none" stroke="black" d="M2624.25,-43549.58C2624.25,-43549.58 2624.25,-43523.93 2624.25,-43523.93"/>
<polygon fill="black" stroke="black" points="2627.75,-43523.93 2624.25,-43513.93 2620.75,-43523.93 2627.75,-43523.93"/>
</g>
<!-- layer5_moe_expert2 -->
<g id="node119" class="node">
<title>layer5_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="3055,-43513.63 2727,-43513.63 2727,-43461.63 3055,-43461.63 3055,-43513.63"/>
<text text-anchor="middle" x="2891" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 2 L5</text>
<text text-anchor="middle" x="2891" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2891" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2891" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert2 -->
<g id="node150" class="node">
<title>layer5_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="3057" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3057" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="3057" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3057" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer5_moe_expert2&#45;&gt;layer5_moe_comm_from_expert2 -->
<g id="edge177" class="edge">
<title>layer5_moe_expert2&#45;&gt;layer5_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M3010.75,-43461.31C3010.75,-43461.31 3010.75,-43431.64 3010.75,-43431.64"/>
<polygon fill="black" stroke="black" points="3014.25,-43431.64 3010.75,-43421.64 3007.25,-43431.64 3014.25,-43431.64"/>
</g>
<!-- layer5_moe_comm_to_expert2&#45;&gt;layer5_moe_expert2 -->
<g id="edge146" class="edge">
<title>layer5_moe_comm_to_expert2&#45;&gt;layer5_moe_expert2</title>
<path fill="none" stroke="black" d="M2951,-43549.58C2951,-43549.58 2951,-43523.93 2951,-43523.93"/>
<polygon fill="black" stroke="black" points="2954.5,-43523.93 2951,-43513.93 2947.5,-43523.93 2954.5,-43523.93"/>
</g>
<!-- layer5_moe_expert3 -->
<g id="node121" class="node">
<title>layer5_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3401,-43513.63 3073,-43513.63 3073,-43461.63 3401,-43461.63 3401,-43513.63"/>
<text text-anchor="middle" x="3237" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 3 L5</text>
<text text-anchor="middle" x="3237" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3237" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3237" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert3 -->
<g id="node151" class="node">
<title>layer5_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3476" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3476" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3476" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3476" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer5_moe_expert3&#45;&gt;layer5_moe_comm_from_expert3 -->
<g id="edge179" class="edge">
<title>layer5_moe_expert3&#45;&gt;layer5_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3393.25,-43461.31C3393.25,-43461.31 3393.25,-43418.53 3393.25,-43418.53"/>
<polygon fill="black" stroke="black" points="3396.75,-43418.53 3393.25,-43408.53 3389.75,-43418.53 3396.75,-43418.53"/>
</g>
<!-- layer5_moe_comm_to_expert3&#45;&gt;layer5_moe_expert3 -->
<g id="edge148" class="edge">
<title>layer5_moe_comm_to_expert3&#45;&gt;layer5_moe_expert3</title>
<path fill="none" stroke="black" d="M3426.25,-43578C3402.91,-43578 3384.25,-43578 3384.25,-43578 3384.25,-43578 3384.25,-43523.77 3384.25,-43523.77"/>
<polygon fill="black" stroke="black" points="3387.75,-43523.77 3384.25,-43513.77 3380.75,-43523.77 3387.75,-43523.77"/>
</g>
<!-- layer5_moe_expert4 -->
<g id="node123" class="node">
<title>layer5_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3747,-43513.63 3419,-43513.63 3419,-43461.63 3747,-43461.63 3747,-43513.63"/>
<text text-anchor="middle" x="3583" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 4 L5</text>
<text text-anchor="middle" x="3583" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3583" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3583" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert4 -->
<g id="node152" class="node">
<title>layer5_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3785" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3785" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3785" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3785" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer5_moe_expert4&#45;&gt;layer5_moe_comm_from_expert4 -->
<g id="edge181" class="edge">
<title>layer5_moe_expert4&#45;&gt;layer5_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3720.75,-43461.31C3720.75,-43461.31 3720.75,-43427.11 3720.75,-43427.11"/>
<polygon fill="black" stroke="black" points="3724.25,-43427.11 3720.75,-43417.11 3717.25,-43427.11 3724.25,-43427.11"/>
</g>
<!-- layer5_moe_comm_to_expert4&#45;&gt;layer5_moe_expert4 -->
<g id="edge150" class="edge">
<title>layer5_moe_comm_to_expert4&#45;&gt;layer5_moe_expert4</title>
<path fill="none" stroke="black" d="M3809.31,-43578C3753.76,-43578 3693.25,-43578 3693.25,-43578 3693.25,-43578 3693.25,-43523.77 3693.25,-43523.77"/>
<polygon fill="black" stroke="black" points="3696.75,-43523.77 3693.25,-43513.77 3689.75,-43523.77 3696.75,-43523.77"/>
</g>
<!-- layer5_moe_expert5 -->
<g id="node125" class="node">
<title>layer5_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="4093,-43513.63 3765,-43513.63 3765,-43461.63 4093,-43461.63 4093,-43513.63"/>
<text text-anchor="middle" x="3929" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 5 L5</text>
<text text-anchor="middle" x="3929" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3929" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3929" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert5 -->
<g id="node153" class="node">
<title>layer5_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="4039" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4039" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="4039" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4039" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer5_moe_expert5&#45;&gt;layer5_moe_comm_from_expert5 -->
<g id="edge183" class="edge">
<title>layer5_moe_expert5&#45;&gt;layer5_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M4020.75,-43461.31C4020.75,-43461.31 4020.75,-43435.12 4020.75,-43435.12"/>
<polygon fill="black" stroke="black" points="4024.25,-43435.12 4020.75,-43425.12 4017.25,-43435.12 4024.25,-43435.12"/>
</g>
<!-- layer5_moe_comm_to_expert5&#45;&gt;layer5_moe_expert5 -->
<g id="edge152" class="edge">
<title>layer5_moe_comm_to_expert5&#45;&gt;layer5_moe_expert5</title>
<path fill="none" stroke="black" d="M4105.75,-43568.81C4105.75,-43545.18 4105.75,-43487 4105.75,-43487 4105.75,-43487 4103.03,-43487 4103.03,-43487"/>
<polygon fill="black" stroke="black" points="4103.03,-43483.5 4093.03,-43487 4103.03,-43490.5 4103.03,-43483.5"/>
</g>
<!-- layer5_moe_expert6 -->
<g id="node127" class="node">
<title>layer5_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4439,-43513.63 4111,-43513.63 4111,-43461.63 4439,-43461.63 4439,-43513.63"/>
<text text-anchor="middle" x="4275" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 6 L5</text>
<text text-anchor="middle" x="4275" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4275" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4275" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert6 -->
<g id="node154" class="node">
<title>layer5_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4386" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4386" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4386" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4386" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer5_moe_expert6&#45;&gt;layer5_moe_comm_from_expert6 -->
<g id="edge185" class="edge">
<title>layer5_moe_expert6&#45;&gt;layer5_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4367.25,-43461.31C4367.25,-43461.31 4367.25,-43435.12 4367.25,-43435.12"/>
<polygon fill="black" stroke="black" points="4370.75,-43435.12 4367.25,-43425.12 4363.75,-43435.12 4370.75,-43435.12"/>
</g>
<!-- layer5_moe_comm_to_expert6&#45;&gt;layer5_moe_expert6 -->
<g id="edge154" class="edge">
<title>layer5_moe_comm_to_expert6&#45;&gt;layer5_moe_expert6</title>
<path fill="none" stroke="black" d="M4392.25,-43552.79C4392.25,-43552.79 4392.25,-43523.84 4392.25,-43523.84"/>
<polygon fill="black" stroke="black" points="4395.75,-43523.84 4392.25,-43513.84 4388.75,-43523.84 4395.75,-43523.84"/>
</g>
<!-- layer5_moe_expert7 -->
<g id="node129" class="node">
<title>layer5_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4785,-43513.63 4457,-43513.63 4457,-43461.63 4785,-43461.63 4785,-43513.63"/>
<text text-anchor="middle" x="4621" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 7 L5</text>
<text text-anchor="middle" x="4621" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4621" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4621" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert7 -->
<g id="node155" class="node">
<title>layer5_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4658" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4658" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4658" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4658" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer5_moe_expert7&#45;&gt;layer5_moe_comm_from_expert7 -->
<g id="edge187" class="edge">
<title>layer5_moe_expert7&#45;&gt;layer5_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4658,-43461.31C4658,-43461.31 4658,-43435.76 4658,-43435.76"/>
<polygon fill="black" stroke="black" points="4661.5,-43435.76 4658,-43425.76 4654.5,-43435.76 4661.5,-43435.76"/>
</g>
<!-- layer5_moe_comm_to_expert7&#45;&gt;layer5_moe_expert7 -->
<g id="edge156" class="edge">
<title>layer5_moe_comm_to_expert7&#45;&gt;layer5_moe_expert7</title>
<path fill="none" stroke="black" d="M4658,-43549.58C4658,-43549.58 4658,-43523.93 4658,-43523.93"/>
<polygon fill="black" stroke="black" points="4661.5,-43523.93 4658,-43513.93 4654.5,-43523.93 4661.5,-43523.93"/>
</g>
<!-- layer5_moe_expert8 -->
<g id="node131" class="node">
<title>layer5_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="5131,-43513.63 4803,-43513.63 4803,-43461.63 5131,-43461.63 5131,-43513.63"/>
<text text-anchor="middle" x="4967" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 8 L5</text>
<text text-anchor="middle" x="4967" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4967" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4967" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert8 -->
<g id="node156" class="node">
<title>layer5_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4930" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4930" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4930" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4930" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer5_moe_expert8&#45;&gt;layer5_moe_comm_from_expert8 -->
<g id="edge189" class="edge">
<title>layer5_moe_expert8&#45;&gt;layer5_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4930,-43461.31C4930,-43461.31 4930,-43435.76 4930,-43435.76"/>
<polygon fill="black" stroke="black" points="4933.5,-43435.76 4930,-43425.76 4926.5,-43435.76 4933.5,-43435.76"/>
</g>
<!-- layer5_moe_comm_to_expert8&#45;&gt;layer5_moe_expert8 -->
<g id="edge158" class="edge">
<title>layer5_moe_comm_to_expert8&#45;&gt;layer5_moe_expert8</title>
<path fill="none" stroke="black" d="M4930,-43549.58C4930,-43549.58 4930,-43523.93 4930,-43523.93"/>
<polygon fill="black" stroke="black" points="4933.5,-43523.93 4930,-43513.93 4926.5,-43523.93 4933.5,-43523.93"/>
</g>
<!-- layer5_moe_expert9 -->
<g id="node133" class="node">
<title>layer5_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5477,-43513.63 5149,-43513.63 5149,-43461.63 5477,-43461.63 5477,-43513.63"/>
<text text-anchor="middle" x="5313" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 9 L5</text>
<text text-anchor="middle" x="5313" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5313" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5313" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert9 -->
<g id="node157" class="node">
<title>layer5_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5239" cy="-43396.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5239" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5239" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5239" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer5_moe_expert9&#45;&gt;layer5_moe_comm_from_expert9 -->
<g id="edge191" class="edge">
<title>layer5_moe_expert9&#45;&gt;layer5_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5239.25,-43461.31C5239.25,-43461.31 5239.25,-43435.76 5239.25,-43435.76"/>
<polygon fill="black" stroke="black" points="5242.75,-43435.76 5239.25,-43425.76 5235.75,-43435.76 5242.75,-43435.76"/>
</g>
<!-- layer5_moe_comm_to_expert9&#45;&gt;layer5_moe_expert9 -->
<g id="edge160" class="edge">
<title>layer5_moe_comm_to_expert9&#45;&gt;layer5_moe_expert9</title>
<path fill="none" stroke="black" d="M5239.25,-43549.58C5239.25,-43549.58 5239.25,-43523.93 5239.25,-43523.93"/>
<polygon fill="black" stroke="black" points="5242.75,-43523.93 5239.25,-43513.93 5235.75,-43523.93 5242.75,-43523.93"/>
</g>
<!-- layer5_moe_expert10 -->
<g id="node135" class="node">
<title>layer5_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5833,-43513.63 5495,-43513.63 5495,-43461.63 5833,-43461.63 5833,-43513.63"/>
<text text-anchor="middle" x="5664" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 10 L5</text>
<text text-anchor="middle" x="5664" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5664" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5664" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert10 -->
<g id="node158" class="node">
<title>layer5_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5571" cy="-43396.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5571" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5571" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5571" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer5_moe_expert10&#45;&gt;layer5_moe_comm_from_expert10 -->
<g id="edge193" class="edge">
<title>layer5_moe_expert10&#45;&gt;layer5_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5580.38,-43461.31C5580.38,-43461.31 5580.38,-43435.76 5580.38,-43435.76"/>
<polygon fill="black" stroke="black" points="5583.88,-43435.76 5580.38,-43425.76 5576.88,-43435.76 5583.88,-43435.76"/>
</g>
<!-- layer5_moe_comm_to_expert10&#45;&gt;layer5_moe_expert10 -->
<g id="edge162" class="edge">
<title>layer5_moe_comm_to_expert10&#45;&gt;layer5_moe_expert10</title>
<path fill="none" stroke="black" d="M5580.02,-43549.58C5580.02,-43549.58 5580.02,-43523.93 5580.02,-43523.93"/>
<polygon fill="black" stroke="black" points="5583.52,-43523.93 5580.02,-43513.93 5576.52,-43523.93 5583.52,-43523.93"/>
</g>
<!-- layer5_moe_expert11 -->
<g id="node137" class="node">
<title>layer5_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6189,-43513.63 5851,-43513.63 5851,-43461.63 6189,-43461.63 6189,-43513.63"/>
<text text-anchor="middle" x="6020" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 11 L5</text>
<text text-anchor="middle" x="6020" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="6020" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="6020" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert11 -->
<g id="node159" class="node">
<title>layer5_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5918" cy="-43396.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5918" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5918" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5918" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer5_moe_expert11&#45;&gt;layer5_moe_comm_from_expert11 -->
<g id="edge195" class="edge">
<title>layer5_moe_expert11&#45;&gt;layer5_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5931.88,-43461.31C5931.88,-43461.31 5931.88,-43435.44 5931.88,-43435.44"/>
<polygon fill="black" stroke="black" points="5935.38,-43435.44 5931.88,-43425.44 5928.38,-43435.44 5935.38,-43435.44"/>
</g>
<!-- layer5_moe_comm_to_expert11&#45;&gt;layer5_moe_expert11 -->
<g id="edge164" class="edge">
<title>layer5_moe_comm_to_expert11&#45;&gt;layer5_moe_expert11</title>
<path fill="none" stroke="black" d="M5931.02,-43549.83C5931.02,-43549.83 5931.02,-43523.76 5931.02,-43523.76"/>
<polygon fill="black" stroke="black" points="5934.52,-43523.76 5931.02,-43513.76 5927.52,-43523.76 5934.52,-43523.76"/>
</g>
<!-- layer5_moe_expert12 -->
<g id="node139" class="node">
<title>layer5_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6545,-43513.63 6207,-43513.63 6207,-43461.63 6545,-43461.63 6545,-43513.63"/>
<text text-anchor="middle" x="6376" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 12 L5</text>
<text text-anchor="middle" x="6376" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6376" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6376" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert12 -->
<g id="node160" class="node">
<title>layer5_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6269" cy="-43396.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6269" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6269" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6269" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer5_moe_expert12&#45;&gt;layer5_moe_comm_from_expert12 -->
<g id="edge197" class="edge">
<title>layer5_moe_expert12&#45;&gt;layer5_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6285.38,-43461.31C6285.38,-43461.31 6285.38,-43435.44 6285.38,-43435.44"/>
<polygon fill="black" stroke="black" points="6288.88,-43435.44 6285.38,-43425.44 6281.88,-43435.44 6288.88,-43435.44"/>
</g>
<!-- layer5_moe_comm_to_expert12&#45;&gt;layer5_moe_expert12 -->
<g id="edge166" class="edge">
<title>layer5_moe_comm_to_expert12&#45;&gt;layer5_moe_expert12</title>
<path fill="none" stroke="black" d="M6284.52,-43549.83C6284.52,-43549.83 6284.52,-43523.76 6284.52,-43523.76"/>
<polygon fill="black" stroke="black" points="6288.02,-43523.76 6284.52,-43513.76 6281.02,-43523.76 6288.02,-43523.76"/>
</g>
<!-- layer5_moe_expert13 -->
<g id="node141" class="node">
<title>layer5_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6901,-43513.63 6563,-43513.63 6563,-43461.63 6901,-43461.63 6901,-43513.63"/>
<text text-anchor="middle" x="6732" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 13 L5</text>
<text text-anchor="middle" x="6732" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6732" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6732" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert13 -->
<g id="node161" class="node">
<title>layer5_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6623" cy="-43396.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6623" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6623" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6623" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer5_moe_expert13&#45;&gt;layer5_moe_comm_from_expert13 -->
<g id="edge199" class="edge">
<title>layer5_moe_expert13&#45;&gt;layer5_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6640.38,-43461.31C6640.38,-43461.31 6640.38,-43435.44 6640.38,-43435.44"/>
<polygon fill="black" stroke="black" points="6643.88,-43435.44 6640.38,-43425.44 6636.88,-43435.44 6643.88,-43435.44"/>
</g>
<!-- layer5_moe_comm_to_expert13&#45;&gt;layer5_moe_expert13 -->
<g id="edge168" class="edge">
<title>layer5_moe_comm_to_expert13&#45;&gt;layer5_moe_expert13</title>
<path fill="none" stroke="black" d="M6639.02,-43549.83C6639.02,-43549.83 6639.02,-43523.76 6639.02,-43523.76"/>
<polygon fill="black" stroke="black" points="6642.52,-43523.76 6639.02,-43513.76 6635.52,-43523.76 6642.52,-43523.76"/>
</g>
<!-- layer5_moe_expert14 -->
<g id="node143" class="node">
<title>layer5_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7257,-43513.63 6919,-43513.63 6919,-43461.63 7257,-43461.63 7257,-43513.63"/>
<text text-anchor="middle" x="7088" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 14 L5</text>
<text text-anchor="middle" x="7088" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7088" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="7088" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert14 -->
<g id="node162" class="node">
<title>layer5_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6978" cy="-43396.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6978" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6978" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6978" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer5_moe_expert14&#45;&gt;layer5_moe_comm_from_expert14 -->
<g id="edge201" class="edge">
<title>layer5_moe_expert14&#45;&gt;layer5_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6995.88,-43461.31C6995.88,-43461.31 6995.88,-43435.12 6995.88,-43435.12"/>
<polygon fill="black" stroke="black" points="6999.38,-43435.12 6995.88,-43425.12 6992.38,-43435.12 6999.38,-43435.12"/>
</g>
<!-- layer5_moe_comm_to_expert14&#45;&gt;layer5_moe_expert14 -->
<g id="edge170" class="edge">
<title>layer5_moe_comm_to_expert14&#45;&gt;layer5_moe_expert14</title>
<path fill="none" stroke="black" d="M6994.52,-43549.83C6994.52,-43549.83 6994.52,-43523.76 6994.52,-43523.76"/>
<polygon fill="black" stroke="black" points="6998.02,-43523.76 6994.52,-43513.76 6991.02,-43523.76 6998.02,-43523.76"/>
</g>
<!-- layer5_moe_expert15 -->
<g id="node145" class="node">
<title>layer5_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7613,-43513.63 7275,-43513.63 7275,-43461.63 7613,-43461.63 7613,-43513.63"/>
<text text-anchor="middle" x="7444" y="-43501.63" font-family="Arial" font-size="10.00">EXPERT 15 L5</text>
<text text-anchor="middle" x="7444" y="-43490.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7444" y="-43479.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7444" y="-43468.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_comm_from_expert15 -->
<g id="node163" class="node">
<title>layer5_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7333" cy="-43396.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7333" y="-43405.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7333" y="-43394.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7333" y="-43383.13" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer5_moe_expert15&#45;&gt;layer5_moe_comm_from_expert15 -->
<g id="edge203" class="edge">
<title>layer5_moe_expert15&#45;&gt;layer5_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7351.38,-43461.31C7351.38,-43461.31 7351.38,-43435.12 7351.38,-43435.12"/>
<polygon fill="black" stroke="black" points="7354.88,-43435.12 7351.38,-43425.12 7347.88,-43435.12 7354.88,-43435.12"/>
</g>
<!-- layer5_moe_comm_to_expert15&#45;&gt;layer5_moe_expert15 -->
<g id="edge172" class="edge">
<title>layer5_moe_comm_to_expert15&#45;&gt;layer5_moe_expert15</title>
<path fill="none" stroke="black" d="M7350.02,-43549.83C7350.02,-43549.83 7350.02,-43523.76 7350.02,-43523.76"/>
<polygon fill="black" stroke="black" points="7353.52,-43523.76 7350.02,-43513.76 7346.52,-43523.76 7353.52,-43523.76"/>
</g>
<!-- layer5_moe_aggregate -->
<g id="node147" class="node">
<title>layer5_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="5019.1,-43331.64 4602.16,-43331.64 4494.9,-43227.64 4911.84,-43227.64 5019.1,-43331.64"/>
<text text-anchor="middle" x="4757" y="-43293.64" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L5</text>
<text text-anchor="middle" x="4757" y="-43282.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4757" y="-43271.64" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4757" y="-43260.64" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_mha -->
<g id="node164" class="node">
<title>layer6_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4887,-43191.64 4627,-43191.64 4627,-43139.64 4887,-43139.64 4887,-43191.64"/>
<text text-anchor="middle" x="4757" y="-43179.64" font-family="Arial" font-size="10.00">MHA L6</text>
<text text-anchor="middle" x="4757" y="-43168.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4757" y="-43157.64" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4757" y="-43146.64" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer5_moe_aggregate&#45;&gt;layer6_moe_mha -->
<g id="edge272" class="edge">
<title>layer5_moe_aggregate&#45;&gt;layer6_moe_mha</title>
<path fill="none" stroke="black" d="M4757,-43227.31C4757,-43227.31 4757,-43201.87 4757,-43201.87"/>
<polygon fill="black" stroke="black" points="4760.5,-43201.87 4757,-43191.87 4753.5,-43201.87 4760.5,-43201.87"/>
</g>
<!-- layer5_moe_comm_from_expert0&#45;&gt;layer5_moe_aggregate -->
<g id="edge174" class="edge">
<title>layer5_moe_comm_from_expert0&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M2450.51,-43380.96C2450.51,-43341.64 2450.51,-43242 2450.51,-43242 2450.51,-43242 4499.62,-43242 4499.62,-43242"/>
<polygon fill="black" stroke="black" points="4499.62,-43245.5 4509.62,-43242 4499.62,-43238.5 4499.62,-43245.5"/>
</g>
<!-- layer5_moe_comm_from_expert1&#45;&gt;layer5_moe_aggregate -->
<g id="edge176" class="edge">
<title>layer5_moe_comm_from_expert1&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M2722.51,-43380.89C2722.51,-43344.37 2722.51,-43257 2722.51,-43257 2722.51,-43257 4515.1,-43257 4515.1,-43257"/>
<polygon fill="black" stroke="black" points="4515.1,-43260.5 4525.1,-43257 4515.1,-43253.5 4515.1,-43260.5"/>
</g>
<!-- layer5_moe_comm_from_expert2&#45;&gt;layer5_moe_aggregate -->
<g id="edge178" class="edge">
<title>layer5_moe_comm_from_expert2&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M3138.01,-43383.3C3138.01,-43351.14 3138.01,-43272 3138.01,-43272 3138.01,-43272 4530.34,-43272 4530.34,-43272"/>
<polygon fill="black" stroke="black" points="4530.34,-43275.5 4540.34,-43272 4530.34,-43268.5 4530.34,-43275.5"/>
</g>
<!-- layer5_moe_comm_from_expert3&#45;&gt;layer5_moe_aggregate -->
<g id="edge180" class="edge">
<title>layer5_moe_comm_from_expert3&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M3483.51,-43367.54C3483.51,-43335.06 3483.51,-43287 3483.51,-43287 3483.51,-43287 4545.91,-43287 4545.91,-43287"/>
<polygon fill="black" stroke="black" points="4545.91,-43290.5 4555.91,-43287 4545.91,-43283.5 4545.91,-43290.5"/>
</g>
<!-- layer5_moe_comm_from_expert4&#45;&gt;layer5_moe_aggregate -->
<g id="edge182" class="edge">
<title>layer5_moe_comm_from_expert4&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M3829.51,-43371.26C3829.51,-43342.92 3829.51,-43301 3829.51,-43301 3829.51,-43301 4560.42,-43301 4560.42,-43301"/>
<polygon fill="black" stroke="black" points="4560.42,-43304.5 4570.42,-43301 4560.42,-43297.5 4560.42,-43304.5"/>
</g>
<!-- layer5_moe_comm_from_expert5&#45;&gt;layer5_moe_aggregate -->
<g id="edge184" class="edge">
<title>layer5_moe_comm_from_expert5&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M4069.17,-43368.88C4069.17,-43345.56 4069.17,-43316 4069.17,-43316 4069.17,-43316 4575.65,-43316 4575.65,-43316"/>
<polygon fill="black" stroke="black" points="4575.65,-43319.5 4585.65,-43316 4575.65,-43312.5 4575.65,-43319.5"/>
</g>
<!-- layer5_moe_comm_from_expert6&#45;&gt;layer5_moe_aggregate -->
<g id="edge186" class="edge">
<title>layer5_moe_comm_from_expert6&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M4476.65,-43396C4505.98,-43396 4531.1,-43396 4531.1,-43396 4531.1,-43396 4531.1,-43289.73 4531.1,-43289.73"/>
<polygon fill="black" stroke="black" points="4534.6,-43289.73 4531.1,-43279.73 4527.6,-43289.73 4534.6,-43289.73"/>
</g>
<!-- layer5_moe_comm_from_expert7&#45;&gt;layer5_moe_aggregate -->
<g id="edge188" class="edge">
<title>layer5_moe_comm_from_expert7&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M4658,-43367.41C4658,-43367.41 4658,-43341.7 4658,-43341.7"/>
<polygon fill="black" stroke="black" points="4661.5,-43341.7 4658,-43331.7 4654.5,-43341.7 4661.5,-43341.7"/>
</g>
<!-- layer5_moe_comm_from_expert8&#45;&gt;layer5_moe_aggregate -->
<g id="edge190" class="edge">
<title>layer5_moe_comm_from_expert8&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M4929.39,-43367.41C4929.39,-43367.41 4929.39,-43341.7 4929.39,-43341.7"/>
<polygon fill="black" stroke="black" points="4932.89,-43341.7 4929.39,-43331.7 4925.89,-43341.7 4932.89,-43341.7"/>
</g>
<!-- layer5_moe_comm_from_expert9&#45;&gt;layer5_moe_aggregate -->
<g id="edge192" class="edge">
<title>layer5_moe_comm_from_expert9&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M5220.5,-43368.25C5220.5,-43345.72 5220.5,-43318 5220.5,-43318 5220.5,-43318 5015.03,-43318 5015.03,-43318"/>
<polygon fill="black" stroke="black" points="5015.03,-43314.5 5005.03,-43318 5015.03,-43321.5 5015.03,-43314.5"/>
</g>
<!-- layer5_moe_comm_from_expert10&#45;&gt;layer5_moe_aggregate -->
<g id="edge194" class="edge">
<title>layer5_moe_comm_from_expert10&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M5552.15,-43368.14C5552.15,-43341.24 5552.15,-43305 5552.15,-43305 5552.15,-43305 5001.81,-43305 5001.81,-43305"/>
<polygon fill="black" stroke="black" points="5001.81,-43301.5 4991.81,-43305 5001.81,-43308.5 5001.81,-43301.5"/>
</g>
<!-- layer5_moe_comm_from_expert11&#45;&gt;layer5_moe_aggregate -->
<g id="edge196" class="edge">
<title>layer5_moe_comm_from_expert11&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M5898.65,-43368.04C5898.65,-43337.06 5898.65,-43292 5898.65,-43292 5898.65,-43292 4988.47,-43292 4988.47,-43292"/>
<polygon fill="black" stroke="black" points="4988.47,-43288.5 4978.47,-43292 4988.47,-43295.5 4988.47,-43288.5"/>
</g>
<!-- layer5_moe_comm_from_expert12&#45;&gt;layer5_moe_aggregate -->
<g id="edge198" class="edge">
<title>layer5_moe_comm_from_expert12&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M6249.65,-43368.16C6249.65,-43333.34 6249.65,-43279 6249.65,-43279 6249.65,-43279 4974.94,-43279 4974.94,-43279"/>
<polygon fill="black" stroke="black" points="4974.94,-43275.5 4964.94,-43279 4974.94,-43282.5 4974.94,-43275.5"/>
</g>
<!-- layer5_moe_comm_from_expert13&#45;&gt;layer5_moe_aggregate -->
<g id="edge200" class="edge">
<title>layer5_moe_comm_from_expert13&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M6603.15,-43367.97C6603.15,-43329.51 6603.15,-43266 6603.15,-43266 6603.15,-43266 4961.52,-43266 4961.52,-43266"/>
<polygon fill="black" stroke="black" points="4961.52,-43262.5 4951.52,-43266 4961.52,-43269.5 4961.52,-43262.5"/>
</g>
<!-- layer5_moe_comm_from_expert14&#45;&gt;layer5_moe_aggregate -->
<g id="edge202" class="edge">
<title>layer5_moe_comm_from_expert14&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M6958.15,-43368.26C6958.15,-43326.4 6958.15,-43253 6958.15,-43253 6958.15,-43253 4948.06,-43253 4948.06,-43253"/>
<polygon fill="black" stroke="black" points="4948.06,-43249.5 4938.06,-43253 4948.06,-43256.5 4948.06,-43249.5"/>
</g>
<!-- layer5_moe_comm_from_expert15&#45;&gt;layer5_moe_aggregate -->
<g id="edge204" class="edge">
<title>layer5_moe_comm_from_expert15&#45;&gt;layer5_moe_aggregate</title>
<path fill="none" stroke="black" d="M7313.15,-43368.27C7313.15,-43323.13 7313.15,-43240 7313.15,-43240 7313.15,-43240 4934.72,-43240 4934.72,-43240"/>
<polygon fill="black" stroke="black" points="4934.72,-43236.5 4924.72,-43240 4934.72,-43243.5 4934.72,-43236.5"/>
</g>
<!-- layer6_moe_gate -->
<g id="node165" class="node">
<title>layer6_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="5015.3,-43103.64 4604.4,-43103.64 4498.7,-42999.64 4909.6,-42999.64 5015.3,-43103.64"/>
<text text-anchor="middle" x="4757" y="-43065.64" font-family="Arial" font-size="10.00">GATE L6</text>
<text text-anchor="middle" x="4757" y="-43054.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4757" y="-43043.64" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4757" y="-43032.64" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer6_moe_mha&#45;&gt;layer6_moe_gate -->
<g id="edge273" class="edge">
<title>layer6_moe_mha&#45;&gt;layer6_moe_gate</title>
<path fill="none" stroke="black" d="M4757,-43139.49C4757,-43139.49 4757,-43113.74 4757,-43113.74"/>
<polygon fill="black" stroke="black" points="4760.5,-43113.74 4757,-43103.74 4753.5,-43113.74 4760.5,-43113.74"/>
</g>
<!-- layer6_moe_split -->
<g id="node166" class="node">
<title>layer6_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="5011.01,-42963.64 4606.94,-42963.64 4502.99,-42859.64 4907.06,-42859.64 5011.01,-42963.64"/>
<text text-anchor="middle" x="4757" y="-42925.64" font-family="Arial" font-size="10.00">SPLIT TOKENS L6</text>
<text text-anchor="middle" x="4757" y="-42914.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4757" y="-42903.64" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4757" y="-42892.64" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer6_moe_gate&#45;&gt;layer6_moe_split -->
<g id="edge274" class="edge">
<title>layer6_moe_gate&#45;&gt;layer6_moe_split</title>
<path fill="none" stroke="black" d="M4757,-42999.51C4757,-42999.51 4757,-42973.82 4757,-42973.82"/>
<polygon fill="black" stroke="black" points="4760.5,-42973.82 4757,-42963.82 4753.5,-42973.82 4760.5,-42973.82"/>
</g>
<!-- layer6_moe_comm_to_expert0 -->
<g id="node168" class="node">
<title>layer6_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2346" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2346" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2346" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2346" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert0 -->
<g id="edge208" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4591.3,-42948C4048.73,-42948 2360,-42948 2360,-42948 2360,-42948 2360,-42833.49 2360,-42833.49"/>
<polygon fill="black" stroke="black" points="2363.5,-42833.49 2360,-42823.49 2356.5,-42833.49 2363.5,-42833.49"/>
</g>
<!-- layer6_moe_comm_to_expert1 -->
<g id="node170" class="node">
<title>layer6_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2618" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2618" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2618" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2618" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert1 -->
<g id="edge210" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4576.28,-42933C4062.79,-42933 2632,-42933 2632,-42933 2632,-42933 2632,-42833.32 2632,-42833.32"/>
<polygon fill="black" stroke="black" points="2635.5,-42833.32 2632,-42823.32 2628.5,-42833.32 2635.5,-42833.32"/>
</g>
<!-- layer6_moe_comm_to_expert2 -->
<g id="node172" class="node">
<title>layer6_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3038" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3038" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3038" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3038" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert2 -->
<g id="edge212" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4562.15,-42919C4113.85,-42919 3047.5,-42919 3047.5,-42919 3047.5,-42919 3047.5,-42833.49 3047.5,-42833.49"/>
<polygon fill="black" stroke="black" points="3051,-42833.49 3047.5,-42823.49 3044,-42833.49 3051,-42833.49"/>
</g>
<!-- layer6_moe_comm_to_expert3 -->
<g id="node174" class="node">
<title>layer6_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3310" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3310" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3310" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3310" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert3 -->
<g id="edge214" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4547.24,-42904C4164.75,-42904 3393,-42904 3393,-42904 3393,-42904 3393,-42816.35 3393,-42816.35"/>
<polygon fill="black" stroke="black" points="3396.5,-42816.35 3393,-42806.35 3389.5,-42816.35 3396.5,-42816.35"/>
</g>
<!-- layer6_moe_comm_to_expert4 -->
<g id="node176" class="node">
<title>layer6_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3693" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3693" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3693" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3693" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert4 -->
<g id="edge216" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4532.02,-42889C4232.2,-42889 3739,-42889 3739,-42889 3739,-42889 3739,-42829.93 3739,-42829.93"/>
<polygon fill="black" stroke="black" points="3742.5,-42829.93 3739,-42819.93 3735.5,-42829.93 3742.5,-42829.93"/>
</g>
<!-- layer6_moe_comm_to_expert5 -->
<g id="node178" class="node">
<title>layer6_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4039" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4039" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="4039" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="4039" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert5 -->
<g id="edge218" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4517.19,-42874C4298.35,-42874 4008.83,-42874 4008.83,-42874 4008.83,-42874 4008.83,-42832.4 4008.83,-42832.4"/>
<polygon fill="black" stroke="black" points="4012.33,-42832.4 4008.83,-42822.4 4005.33,-42832.4 4012.33,-42832.4"/>
</g>
<!-- layer6_moe_comm_to_expert6 -->
<g id="node180" class="node">
<title>layer6_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4311" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4311" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4311" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4311" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert6 -->
<g id="edge220" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4516.74,-42911.56C4516.74,-42907.99 4516.74,-42794 4516.74,-42794 4516.74,-42794 4411.54,-42794 4411.54,-42794"/>
<polygon fill="black" stroke="black" points="4411.54,-42790.5 4401.54,-42794 4411.54,-42797.5 4411.54,-42790.5"/>
</g>
<!-- layer6_moe_comm_to_expert7 -->
<g id="node182" class="node">
<title>layer6_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4621" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4621" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4621" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4621" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert7 -->
<g id="edge222" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4621,-42859.31C4621,-42859.31 4621,-42833.86 4621,-42833.86"/>
<polygon fill="black" stroke="black" points="4624.5,-42833.86 4621,-42823.86 4617.5,-42833.86 4624.5,-42833.86"/>
</g>
<!-- layer6_moe_comm_to_expert8 -->
<g id="node184" class="node">
<title>layer6_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4893" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4893" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4893" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4893" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert8 -->
<g id="edge224" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4893,-42859.31C4893,-42859.31 4893,-42833.86 4893,-42833.86"/>
<polygon fill="black" stroke="black" points="4896.5,-42833.86 4893,-42823.86 4889.5,-42833.86 4896.5,-42833.86"/>
</g>
<!-- layer6_moe_comm_to_expert9 -->
<g id="node186" class="node">
<title>layer6_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5202" cy="-42794.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5202" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5202" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5202" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert9 -->
<g id="edge226" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4997.26,-42911.56C4997.26,-42907.99 4997.26,-42794 4997.26,-42794 4997.26,-42794 5101.3,-42794 5101.3,-42794"/>
<polygon fill="black" stroke="black" points="5101.3,-42797.5 5111.3,-42794 5101.3,-42790.5 5101.3,-42797.5"/>
</g>
<!-- layer6_moe_comm_to_expert10 -->
<g id="node188" class="node">
<title>layer6_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5534" cy="-42794.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5534" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5534" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5534" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert10 -->
<g id="edge228" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4921.82,-42874C5129.07,-42874 5458.1,-42874 5458.1,-42874 5458.1,-42874 5458.1,-42821.87 5458.1,-42821.87"/>
<polygon fill="black" stroke="black" points="5461.6,-42821.87 5458.1,-42811.87 5454.6,-42821.87 5461.6,-42821.87"/>
</g>
<!-- layer6_moe_comm_to_expert11 -->
<g id="node190" class="node">
<title>layer6_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5880" cy="-42794.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5880" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5880" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5880" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert11 -->
<g id="edge230" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4936.49,-42889C5235.86,-42889 5804.6,-42889 5804.6,-42889 5804.6,-42889 5804.6,-42822.4 5804.6,-42822.4"/>
<polygon fill="black" stroke="black" points="5808.1,-42822.4 5804.6,-42812.4 5801.1,-42822.4 5808.1,-42822.4"/>
</g>
<!-- layer6_moe_comm_to_expert12 -->
<g id="node192" class="node">
<title>layer6_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6231" cy="-42794.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6231" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6231" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6231" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert12 -->
<g id="edge232" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4951.47,-42904C5335.77,-42904 6155.6,-42904 6155.6,-42904 6155.6,-42904 6155.6,-42822.22 6155.6,-42822.22"/>
<polygon fill="black" stroke="black" points="6159.1,-42822.22 6155.6,-42812.22 6152.1,-42822.22 6159.1,-42822.22"/>
</g>
<!-- layer6_moe_comm_to_expert13 -->
<g id="node194" class="node">
<title>layer6_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6584" cy="-42794.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6584" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6584" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6584" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert13 -->
<g id="edge234" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4966.6,-42919C5431.67,-42919 6509.1,-42919 6509.1,-42919 6509.1,-42919 6509.1,-42822.2 6509.1,-42822.2"/>
<polygon fill="black" stroke="black" points="6512.6,-42822.2 6509.1,-42812.2 6505.6,-42822.2 6512.6,-42822.2"/>
</g>
<!-- layer6_moe_comm_to_expert14 -->
<g id="node196" class="node">
<title>layer6_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6939" cy="-42794.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6939" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6939" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6939" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert14 -->
<g id="edge236" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4980.5,-42933C5522.79,-42933 6864.1,-42933 6864.1,-42933 6864.1,-42933 6864.1,-42822.45 6864.1,-42822.45"/>
<polygon fill="black" stroke="black" points="6867.6,-42822.45 6864.1,-42812.45 6860.6,-42822.45 6867.6,-42822.45"/>
</g>
<!-- layer6_moe_comm_to_expert15 -->
<g id="node198" class="node">
<title>layer6_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7294" cy="-42794.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7294" y="-42803.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7294" y="-42792.15" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7294" y="-42781.15" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert15 -->
<g id="edge238" class="edge">
<title>layer6_moe_split&#45;&gt;layer6_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4995.59,-42948C5613.69,-42948 7219.1,-42948 7219.1,-42948 7219.1,-42948 7219.1,-42822.24 7219.1,-42822.24"/>
<polygon fill="black" stroke="black" points="7222.6,-42822.24 7219.1,-42812.24 7215.6,-42822.24 7222.6,-42822.24"/>
</g>
<!-- layer6_moe_expert0 -->
<g id="node167" class="node">
<title>layer6_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2326,-42729.66 1998,-42729.66 1998,-42677.66 2326,-42677.66 2326,-42729.66"/>
<text text-anchor="middle" x="2162" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 0 L6</text>
<text text-anchor="middle" x="2162" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2162" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2162" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert0 -->
<g id="node200" class="node">
<title>layer6_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2321" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2321" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2321" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2321" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer6_moe_expert0&#45;&gt;layer6_moe_comm_from_expert0 -->
<g id="edge240" class="edge">
<title>layer6_moe_expert0&#45;&gt;layer6_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2278.25,-42677.34C2278.25,-42677.34 2278.25,-42648.3 2278.25,-42648.3"/>
<polygon fill="black" stroke="black" points="2281.75,-42648.3 2278.25,-42638.3 2274.75,-42648.3 2281.75,-42648.3"/>
</g>
<!-- layer6_moe_comm_to_expert0&#45;&gt;layer6_moe_expert0 -->
<g id="edge209" class="edge">
<title>layer6_moe_comm_to_expert0&#45;&gt;layer6_moe_expert0</title>
<path fill="none" stroke="black" d="M2290.75,-42771.22C2290.75,-42771.22 2290.75,-42739.9 2290.75,-42739.9"/>
<polygon fill="black" stroke="black" points="2294.25,-42739.9 2290.75,-42729.9 2287.25,-42739.9 2294.25,-42739.9"/>
</g>
<!-- layer6_moe_expert1 -->
<g id="node169" class="node">
<title>layer6_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2672,-42729.66 2344,-42729.66 2344,-42677.66 2672,-42677.66 2672,-42729.66"/>
<text text-anchor="middle" x="2508" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 1 L6</text>
<text text-anchor="middle" x="2508" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2508" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2508" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert1 -->
<g id="node201" class="node">
<title>layer6_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2593" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2593" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2593" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2593" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer6_moe_expert1&#45;&gt;layer6_moe_comm_from_expert1 -->
<g id="edge242" class="edge">
<title>layer6_moe_expert1&#45;&gt;layer6_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2587.25,-42677.34C2587.25,-42677.34 2587.25,-42651.8 2587.25,-42651.8"/>
<polygon fill="black" stroke="black" points="2590.75,-42651.8 2587.25,-42641.8 2583.75,-42651.8 2590.75,-42651.8"/>
</g>
<!-- layer6_moe_comm_to_expert1&#45;&gt;layer6_moe_expert1 -->
<g id="edge211" class="edge">
<title>layer6_moe_comm_to_expert1&#45;&gt;layer6_moe_expert1</title>
<path fill="none" stroke="black" d="M2599.75,-42765.86C2599.75,-42765.86 2599.75,-42739.79 2599.75,-42739.79"/>
<polygon fill="black" stroke="black" points="2603.25,-42739.79 2599.75,-42729.79 2596.25,-42739.79 2603.25,-42739.79"/>
</g>
<!-- layer6_moe_expert2 -->
<g id="node171" class="node">
<title>layer6_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="3018,-42729.66 2690,-42729.66 2690,-42677.66 3018,-42677.66 3018,-42729.66"/>
<text text-anchor="middle" x="2854" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 2 L6</text>
<text text-anchor="middle" x="2854" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2854" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2854" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert2 -->
<g id="node202" class="node">
<title>layer6_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2914" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2914" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2914" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2914" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer6_moe_expert2&#45;&gt;layer6_moe_comm_from_expert2 -->
<g id="edge244" class="edge">
<title>layer6_moe_expert2&#45;&gt;layer6_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2914,-42677.34C2914,-42677.34 2914,-42651.8 2914,-42651.8"/>
<polygon fill="black" stroke="black" points="2917.5,-42651.8 2914,-42641.8 2910.5,-42651.8 2917.5,-42651.8"/>
</g>
<!-- layer6_moe_comm_to_expert2&#45;&gt;layer6_moe_expert2 -->
<g id="edge213" class="edge">
<title>layer6_moe_comm_to_expert2&#45;&gt;layer6_moe_expert2</title>
<path fill="none" stroke="black" d="M2982.75,-42771.22C2982.75,-42771.22 2982.75,-42739.9 2982.75,-42739.9"/>
<polygon fill="black" stroke="black" points="2986.25,-42739.9 2982.75,-42729.9 2979.25,-42739.9 2986.25,-42739.9"/>
</g>
<!-- layer6_moe_expert3 -->
<g id="node173" class="node">
<title>layer6_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3364,-42729.66 3036,-42729.66 3036,-42677.66 3364,-42677.66 3364,-42729.66"/>
<text text-anchor="middle" x="3200" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 3 L6</text>
<text text-anchor="middle" x="3200" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3200" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3200" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert3 -->
<g id="node203" class="node">
<title>layer6_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3480" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3480" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3480" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3480" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer6_moe_expert3&#45;&gt;layer6_moe_comm_from_expert3 -->
<g id="edge246" class="edge">
<title>layer6_moe_expert3&#45;&gt;layer6_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3310.25,-42677.64C3310.25,-42650.54 3310.25,-42612 3310.25,-42612 3310.25,-42612 3379.16,-42612 3379.16,-42612"/>
<polygon fill="black" stroke="black" points="3379.16,-42615.5 3389.16,-42612 3379.16,-42608.5 3379.16,-42615.5"/>
</g>
<!-- layer6_moe_comm_to_expert3&#45;&gt;layer6_moe_expert3 -->
<g id="edge215" class="edge">
<title>layer6_moe_comm_to_expert3&#45;&gt;layer6_moe_expert3</title>
<path fill="none" stroke="black" d="M3291.75,-42765.86C3291.75,-42765.86 3291.75,-42739.79 3291.75,-42739.79"/>
<polygon fill="black" stroke="black" points="3295.25,-42739.79 3291.75,-42729.79 3288.25,-42739.79 3295.25,-42739.79"/>
</g>
<!-- layer6_moe_expert4 -->
<g id="node175" class="node">
<title>layer6_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3710,-42729.66 3382,-42729.66 3382,-42677.66 3710,-42677.66 3710,-42729.66"/>
<text text-anchor="middle" x="3546" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 4 L6</text>
<text text-anchor="middle" x="3546" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3546" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3546" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert4 -->
<g id="node204" class="node">
<title>layer6_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3863" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3863" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3863" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3863" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer6_moe_expert4&#45;&gt;layer6_moe_comm_from_expert4 -->
<g id="edge248" class="edge">
<title>layer6_moe_expert4&#45;&gt;layer6_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3663.18,-42677.64C3663.18,-42650.54 3663.18,-42612 3663.18,-42612 3663.18,-42612 3762.44,-42612 3762.44,-42612"/>
<polygon fill="black" stroke="black" points="3762.44,-42615.5 3772.44,-42612 3762.44,-42608.5 3762.44,-42615.5"/>
</g>
<!-- layer6_moe_comm_to_expert4&#45;&gt;layer6_moe_expert4 -->
<g id="edge217" class="edge">
<title>layer6_moe_comm_to_expert4&#45;&gt;layer6_moe_expert4</title>
<path fill="none" stroke="black" d="M3656.25,-42767.84C3656.25,-42767.84 3656.25,-42739.96 3656.25,-42739.96"/>
<polygon fill="black" stroke="black" points="3659.75,-42739.96 3656.25,-42729.96 3652.75,-42739.96 3659.75,-42739.96"/>
</g>
<!-- layer6_moe_expert5 -->
<g id="node177" class="node">
<title>layer6_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="4056,-42729.66 3728,-42729.66 3728,-42677.66 4056,-42677.66 4056,-42729.66"/>
<text text-anchor="middle" x="3892" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 5 L6</text>
<text text-anchor="middle" x="3892" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3892" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3892" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert5 -->
<g id="node205" class="node">
<title>layer6_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="4154" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4154" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="4154" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4154" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer6_moe_expert5&#45;&gt;layer6_moe_comm_from_expert5 -->
<g id="edge250" class="edge">
<title>layer6_moe_expert5&#45;&gt;layer6_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M4056.03,-42703C4063.99,-42703 4068.75,-42703 4068.75,-42703 4068.75,-42703 4068.75,-42632.68 4068.75,-42632.68"/>
<polygon fill="black" stroke="black" points="4072.25,-42632.68 4068.75,-42622.68 4065.25,-42632.68 4072.25,-42632.68"/>
</g>
<!-- layer6_moe_comm_to_expert5&#45;&gt;layer6_moe_expert5 -->
<g id="edge219" class="edge">
<title>layer6_moe_comm_to_expert5&#45;&gt;layer6_moe_expert5</title>
<path fill="none" stroke="black" d="M4002.25,-42767.84C4002.25,-42767.84 4002.25,-42739.96 4002.25,-42739.96"/>
<polygon fill="black" stroke="black" points="4005.75,-42739.96 4002.25,-42729.96 3998.75,-42739.96 4005.75,-42739.96"/>
</g>
<!-- layer6_moe_expert6 -->
<g id="node179" class="node">
<title>layer6_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4402,-42729.66 4074,-42729.66 4074,-42677.66 4402,-42677.66 4402,-42729.66"/>
<text text-anchor="middle" x="4238" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 6 L6</text>
<text text-anchor="middle" x="4238" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4238" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4238" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert6 -->
<g id="node206" class="node">
<title>layer6_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4399" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4399" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4399" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4399" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer6_moe_expert6&#45;&gt;layer6_moe_comm_from_expert6 -->
<g id="edge252" class="edge">
<title>layer6_moe_expert6&#45;&gt;layer6_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4355.25,-42677.34C4355.25,-42677.34 4355.25,-42648.3 4355.25,-42648.3"/>
<polygon fill="black" stroke="black" points="4358.75,-42648.3 4355.25,-42638.3 4351.75,-42648.3 4358.75,-42648.3"/>
</g>
<!-- layer6_moe_comm_to_expert6&#45;&gt;layer6_moe_expert6 -->
<g id="edge221" class="edge">
<title>layer6_moe_comm_to_expert6&#45;&gt;layer6_moe_expert6</title>
<path fill="none" stroke="black" d="M4311,-42765.61C4311,-42765.61 4311,-42739.96 4311,-42739.96"/>
<polygon fill="black" stroke="black" points="4314.5,-42739.96 4311,-42729.96 4307.5,-42739.96 4314.5,-42739.96"/>
</g>
<!-- layer6_moe_expert7 -->
<g id="node181" class="node">
<title>layer6_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4748,-42729.66 4420,-42729.66 4420,-42677.66 4748,-42677.66 4748,-42729.66"/>
<text text-anchor="middle" x="4584" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 7 L6</text>
<text text-anchor="middle" x="4584" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4584" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4584" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert7 -->
<g id="node207" class="node">
<title>layer6_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4621" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4621" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4621" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4621" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer6_moe_expert7&#45;&gt;layer6_moe_comm_from_expert7 -->
<g id="edge254" class="edge">
<title>layer6_moe_expert7&#45;&gt;layer6_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4621,-42677.34C4621,-42677.34 4621,-42651.8 4621,-42651.8"/>
<polygon fill="black" stroke="black" points="4624.5,-42651.8 4621,-42641.8 4617.5,-42651.8 4624.5,-42651.8"/>
</g>
<!-- layer6_moe_comm_to_expert7&#45;&gt;layer6_moe_expert7 -->
<g id="edge223" class="edge">
<title>layer6_moe_comm_to_expert7&#45;&gt;layer6_moe_expert7</title>
<path fill="none" stroke="black" d="M4621,-42765.61C4621,-42765.61 4621,-42739.96 4621,-42739.96"/>
<polygon fill="black" stroke="black" points="4624.5,-42739.96 4621,-42729.96 4617.5,-42739.96 4624.5,-42739.96"/>
</g>
<!-- layer6_moe_expert8 -->
<g id="node183" class="node">
<title>layer6_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="5094,-42729.66 4766,-42729.66 4766,-42677.66 5094,-42677.66 5094,-42729.66"/>
<text text-anchor="middle" x="4930" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 8 L6</text>
<text text-anchor="middle" x="4930" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4930" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4930" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert8 -->
<g id="node208" class="node">
<title>layer6_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4893" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4893" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4893" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4893" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer6_moe_expert8&#45;&gt;layer6_moe_comm_from_expert8 -->
<g id="edge256" class="edge">
<title>layer6_moe_expert8&#45;&gt;layer6_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4893,-42677.34C4893,-42677.34 4893,-42651.8 4893,-42651.8"/>
<polygon fill="black" stroke="black" points="4896.5,-42651.8 4893,-42641.8 4889.5,-42651.8 4896.5,-42651.8"/>
</g>
<!-- layer6_moe_comm_to_expert8&#45;&gt;layer6_moe_expert8 -->
<g id="edge225" class="edge">
<title>layer6_moe_comm_to_expert8&#45;&gt;layer6_moe_expert8</title>
<path fill="none" stroke="black" d="M4893,-42765.61C4893,-42765.61 4893,-42739.96 4893,-42739.96"/>
<polygon fill="black" stroke="black" points="4896.5,-42739.96 4893,-42729.96 4889.5,-42739.96 4896.5,-42739.96"/>
</g>
<!-- layer6_moe_expert9 -->
<g id="node185" class="node">
<title>layer6_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5440,-42729.66 5112,-42729.66 5112,-42677.66 5440,-42677.66 5440,-42729.66"/>
<text text-anchor="middle" x="5276" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 9 L6</text>
<text text-anchor="middle" x="5276" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5276" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5276" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert9 -->
<g id="node209" class="node">
<title>layer6_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5202" cy="-42612.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5202" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5202" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5202" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer6_moe_expert9&#45;&gt;layer6_moe_comm_from_expert9 -->
<g id="edge258" class="edge">
<title>layer6_moe_expert9&#45;&gt;layer6_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5202.25,-42677.34C5202.25,-42677.34 5202.25,-42651.8 5202.25,-42651.8"/>
<polygon fill="black" stroke="black" points="5205.75,-42651.8 5202.25,-42641.8 5198.75,-42651.8 5205.75,-42651.8"/>
</g>
<!-- layer6_moe_comm_to_expert9&#45;&gt;layer6_moe_expert9 -->
<g id="edge227" class="edge">
<title>layer6_moe_comm_to_expert9&#45;&gt;layer6_moe_expert9</title>
<path fill="none" stroke="black" d="M5202.25,-42765.61C5202.25,-42765.61 5202.25,-42739.96 5202.25,-42739.96"/>
<polygon fill="black" stroke="black" points="5205.75,-42739.96 5202.25,-42729.96 5198.75,-42739.96 5205.75,-42739.96"/>
</g>
<!-- layer6_moe_expert10 -->
<g id="node187" class="node">
<title>layer6_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5796,-42729.66 5458,-42729.66 5458,-42677.66 5796,-42677.66 5796,-42729.66"/>
<text text-anchor="middle" x="5627" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 10 L6</text>
<text text-anchor="middle" x="5627" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5627" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5627" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert10 -->
<g id="node210" class="node">
<title>layer6_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5534" cy="-42612.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5534" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5534" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5534" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer6_moe_expert10&#45;&gt;layer6_moe_comm_from_expert10 -->
<g id="edge260" class="edge">
<title>layer6_moe_expert10&#45;&gt;layer6_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5543.38,-42677.34C5543.38,-42677.34 5543.38,-42651.8 5543.38,-42651.8"/>
<polygon fill="black" stroke="black" points="5546.88,-42651.8 5543.38,-42641.8 5539.88,-42651.8 5546.88,-42651.8"/>
</g>
<!-- layer6_moe_comm_to_expert10&#45;&gt;layer6_moe_expert10 -->
<g id="edge229" class="edge">
<title>layer6_moe_comm_to_expert10&#45;&gt;layer6_moe_expert10</title>
<path fill="none" stroke="black" d="M5543.02,-42765.61C5543.02,-42765.61 5543.02,-42739.96 5543.02,-42739.96"/>
<polygon fill="black" stroke="black" points="5546.52,-42739.96 5543.02,-42729.96 5539.52,-42739.96 5546.52,-42739.96"/>
</g>
<!-- layer6_moe_expert11 -->
<g id="node189" class="node">
<title>layer6_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6152,-42729.66 5814,-42729.66 5814,-42677.66 6152,-42677.66 6152,-42729.66"/>
<text text-anchor="middle" x="5983" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 11 L6</text>
<text text-anchor="middle" x="5983" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5983" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5983" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert11 -->
<g id="node211" class="node">
<title>layer6_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5881" cy="-42612.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5881" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5881" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5881" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer6_moe_expert11&#45;&gt;layer6_moe_comm_from_expert11 -->
<g id="edge262" class="edge">
<title>layer6_moe_expert11&#45;&gt;layer6_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5894.88,-42677.34C5894.88,-42677.34 5894.88,-42651.48 5894.88,-42651.48"/>
<polygon fill="black" stroke="black" points="5898.38,-42651.48 5894.88,-42641.48 5891.38,-42651.48 5898.38,-42651.48"/>
</g>
<!-- layer6_moe_comm_to_expert11&#45;&gt;layer6_moe_expert11 -->
<g id="edge231" class="edge">
<title>layer6_moe_comm_to_expert11&#45;&gt;layer6_moe_expert11</title>
<path fill="none" stroke="black" d="M5894.02,-42765.86C5894.02,-42765.86 5894.02,-42739.79 5894.02,-42739.79"/>
<polygon fill="black" stroke="black" points="5897.52,-42739.79 5894.02,-42729.79 5890.52,-42739.79 5897.52,-42739.79"/>
</g>
<!-- layer6_moe_expert12 -->
<g id="node191" class="node">
<title>layer6_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6508,-42729.66 6170,-42729.66 6170,-42677.66 6508,-42677.66 6508,-42729.66"/>
<text text-anchor="middle" x="6339" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 12 L6</text>
<text text-anchor="middle" x="6339" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6339" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6339" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert12 -->
<g id="node212" class="node">
<title>layer6_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6232" cy="-42612.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6232" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6232" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6232" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer6_moe_expert12&#45;&gt;layer6_moe_comm_from_expert12 -->
<g id="edge264" class="edge">
<title>layer6_moe_expert12&#45;&gt;layer6_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6248.38,-42677.34C6248.38,-42677.34 6248.38,-42651.48 6248.38,-42651.48"/>
<polygon fill="black" stroke="black" points="6251.88,-42651.48 6248.38,-42641.48 6244.88,-42651.48 6251.88,-42651.48"/>
</g>
<!-- layer6_moe_comm_to_expert12&#45;&gt;layer6_moe_expert12 -->
<g id="edge233" class="edge">
<title>layer6_moe_comm_to_expert12&#45;&gt;layer6_moe_expert12</title>
<path fill="none" stroke="black" d="M6247.52,-42765.86C6247.52,-42765.86 6247.52,-42739.79 6247.52,-42739.79"/>
<polygon fill="black" stroke="black" points="6251.02,-42739.79 6247.52,-42729.79 6244.02,-42739.79 6251.02,-42739.79"/>
</g>
<!-- layer6_moe_expert13 -->
<g id="node193" class="node">
<title>layer6_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6864,-42729.66 6526,-42729.66 6526,-42677.66 6864,-42677.66 6864,-42729.66"/>
<text text-anchor="middle" x="6695" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 13 L6</text>
<text text-anchor="middle" x="6695" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6695" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6695" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert13 -->
<g id="node213" class="node">
<title>layer6_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6586" cy="-42612.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6586" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6586" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6586" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer6_moe_expert13&#45;&gt;layer6_moe_comm_from_expert13 -->
<g id="edge266" class="edge">
<title>layer6_moe_expert13&#45;&gt;layer6_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6603.38,-42677.34C6603.38,-42677.34 6603.38,-42651.48 6603.38,-42651.48"/>
<polygon fill="black" stroke="black" points="6606.88,-42651.48 6603.38,-42641.48 6599.88,-42651.48 6606.88,-42651.48"/>
</g>
<!-- layer6_moe_comm_to_expert13&#45;&gt;layer6_moe_expert13 -->
<g id="edge235" class="edge">
<title>layer6_moe_comm_to_expert13&#45;&gt;layer6_moe_expert13</title>
<path fill="none" stroke="black" d="M6602.02,-42765.86C6602.02,-42765.86 6602.02,-42739.79 6602.02,-42739.79"/>
<polygon fill="black" stroke="black" points="6605.52,-42739.79 6602.02,-42729.79 6598.52,-42739.79 6605.52,-42739.79"/>
</g>
<!-- layer6_moe_expert14 -->
<g id="node195" class="node">
<title>layer6_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7220,-42729.66 6882,-42729.66 6882,-42677.66 7220,-42677.66 7220,-42729.66"/>
<text text-anchor="middle" x="7051" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 14 L6</text>
<text text-anchor="middle" x="7051" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7051" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="7051" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert14 -->
<g id="node214" class="node">
<title>layer6_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6941" cy="-42612.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6941" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6941" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6941" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer6_moe_expert14&#45;&gt;layer6_moe_comm_from_expert14 -->
<g id="edge268" class="edge">
<title>layer6_moe_expert14&#45;&gt;layer6_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6958.88,-42677.34C6958.88,-42677.34 6958.88,-42651.15 6958.88,-42651.15"/>
<polygon fill="black" stroke="black" points="6962.38,-42651.15 6958.88,-42641.15 6955.38,-42651.15 6962.38,-42651.15"/>
</g>
<!-- layer6_moe_comm_to_expert14&#45;&gt;layer6_moe_expert14 -->
<g id="edge237" class="edge">
<title>layer6_moe_comm_to_expert14&#45;&gt;layer6_moe_expert14</title>
<path fill="none" stroke="black" d="M6957.52,-42765.86C6957.52,-42765.86 6957.52,-42739.79 6957.52,-42739.79"/>
<polygon fill="black" stroke="black" points="6961.02,-42739.79 6957.52,-42729.79 6954.02,-42739.79 6961.02,-42739.79"/>
</g>
<!-- layer6_moe_expert15 -->
<g id="node197" class="node">
<title>layer6_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7576,-42729.66 7238,-42729.66 7238,-42677.66 7576,-42677.66 7576,-42729.66"/>
<text text-anchor="middle" x="7407" y="-42717.66" font-family="Arial" font-size="10.00">EXPERT 15 L6</text>
<text text-anchor="middle" x="7407" y="-42706.66" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7407" y="-42695.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7407" y="-42684.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_comm_from_expert15 -->
<g id="node215" class="node">
<title>layer6_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7296" cy="-42612.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7296" y="-42621.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7296" y="-42610.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7296" y="-42599.17" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer6_moe_expert15&#45;&gt;layer6_moe_comm_from_expert15 -->
<g id="edge270" class="edge">
<title>layer6_moe_expert15&#45;&gt;layer6_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7314.38,-42677.34C7314.38,-42677.34 7314.38,-42651.15 7314.38,-42651.15"/>
<polygon fill="black" stroke="black" points="7317.88,-42651.15 7314.38,-42641.15 7310.88,-42651.15 7317.88,-42651.15"/>
</g>
<!-- layer6_moe_comm_to_expert15&#45;&gt;layer6_moe_expert15 -->
<g id="edge239" class="edge">
<title>layer6_moe_comm_to_expert15&#45;&gt;layer6_moe_expert15</title>
<path fill="none" stroke="black" d="M7313.02,-42765.86C7313.02,-42765.86 7313.02,-42739.79 7313.02,-42739.79"/>
<polygon fill="black" stroke="black" points="7316.52,-42739.79 7313.02,-42729.79 7309.52,-42739.79 7316.52,-42739.79"/>
</g>
<!-- layer6_moe_aggregate -->
<g id="node199" class="node">
<title>layer6_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4982.1,-42547.68 4565.16,-42547.68 4457.9,-42443.68 4874.84,-42443.68 4982.1,-42547.68"/>
<text text-anchor="middle" x="4720" y="-42509.68" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L6</text>
<text text-anchor="middle" x="4720" y="-42498.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4720" y="-42487.68" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4720" y="-42476.68" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_mha -->
<g id="node216" class="node">
<title>layer7_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4850,-42407.68 4590,-42407.68 4590,-42355.68 4850,-42355.68 4850,-42407.68"/>
<text text-anchor="middle" x="4720" y="-42395.68" font-family="Arial" font-size="10.00">MHA L7</text>
<text text-anchor="middle" x="4720" y="-42384.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4720" y="-42373.68" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4720" y="-42362.68" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer6_moe_aggregate&#45;&gt;layer7_moe_mha -->
<g id="edge339" class="edge">
<title>layer6_moe_aggregate&#45;&gt;layer7_moe_mha</title>
<path fill="none" stroke="black" d="M4720,-42443.35C4720,-42443.35 4720,-42417.9 4720,-42417.9"/>
<polygon fill="black" stroke="black" points="4723.5,-42417.9 4720,-42407.9 4716.5,-42417.9 4723.5,-42417.9"/>
</g>
<!-- layer6_moe_comm_from_expert0&#45;&gt;layer6_moe_aggregate -->
<g id="edge241" class="edge">
<title>layer6_moe_comm_from_expert0&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M2387.01,-42592.76C2387.01,-42550.99 2387.01,-42458 2387.01,-42458 2387.01,-42458 4462.54,-42458 4462.54,-42458"/>
<polygon fill="black" stroke="black" points="4462.54,-42461.5 4472.54,-42458 4462.54,-42454.5 4462.54,-42461.5"/>
</g>
<!-- layer6_moe_comm_from_expert1&#45;&gt;layer6_moe_aggregate -->
<g id="edge243" class="edge">
<title>layer6_moe_comm_from_expert1&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M2668.25,-42596.37C2668.25,-42559.53 2668.25,-42473 2668.25,-42473 2668.25,-42473 4478.13,-42473 4478.13,-42473"/>
<polygon fill="black" stroke="black" points="4478.13,-42476.5 4488.13,-42473 4478.13,-42469.5 4478.13,-42476.5"/>
</g>
<!-- layer6_moe_comm_from_expert2&#45;&gt;layer6_moe_aggregate -->
<g id="edge245" class="edge">
<title>layer6_moe_comm_from_expert2&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M2920.5,-42583.44C2920.5,-42546.59 2920.5,-42488 2920.5,-42488 2920.5,-42488 4493.39,-42488 4493.39,-42488"/>
<polygon fill="black" stroke="black" points="4493.39,-42491.5 4503.39,-42488 4493.39,-42484.5 4493.39,-42491.5"/>
</g>
<!-- layer6_moe_comm_from_expert3&#45;&gt;layer6_moe_aggregate -->
<g id="edge247" class="edge">
<title>layer6_moe_comm_from_expert3&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M3549.5,-42594.06C3549.5,-42562.78 3549.5,-42503 3549.5,-42503 3549.5,-42503 4508.78,-42503 4508.78,-42503"/>
<polygon fill="black" stroke="black" points="4508.78,-42506.5 4518.78,-42503 4508.78,-42499.5 4508.78,-42506.5"/>
</g>
<!-- layer6_moe_comm_from_expert4&#45;&gt;layer6_moe_aggregate -->
<g id="edge249" class="edge">
<title>layer6_moe_comm_from_expert4&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M3932.5,-42593.77C3932.5,-42565.89 3932.5,-42517 3932.5,-42517 3932.5,-42517 4523.37,-42517 4523.37,-42517"/>
<polygon fill="black" stroke="black" points="4523.37,-42520.5 4533.37,-42517 4523.37,-42513.5 4523.37,-42520.5"/>
</g>
<!-- layer6_moe_comm_from_expert5&#45;&gt;layer6_moe_aggregate -->
<g id="edge251" class="edge">
<title>layer6_moe_comm_from_expert5&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M4214,-42590.63C4214,-42566.74 4214,-42532 4214,-42532 4214,-42532 4538.69,-42532 4538.69,-42532"/>
<polygon fill="black" stroke="black" points="4538.69,-42535.5 4548.69,-42532 4538.69,-42528.5 4538.69,-42535.5"/>
</g>
<!-- layer6_moe_comm_from_expert6&#45;&gt;layer6_moe_aggregate -->
<g id="edge253" class="edge">
<title>layer6_moe_comm_from_expert6&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M4473.61,-42596.15C4473.61,-42596.15 4473.61,-42505.73 4473.61,-42505.73"/>
<polygon fill="black" stroke="black" points="4477.11,-42505.73 4473.61,-42495.73 4470.11,-42505.73 4477.11,-42505.73"/>
</g>
<!-- layer6_moe_comm_from_expert7&#45;&gt;layer6_moe_aggregate -->
<g id="edge255" class="edge">
<title>layer6_moe_comm_from_expert7&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M4621,-42583.45C4621,-42583.45 4621,-42557.74 4621,-42557.74"/>
<polygon fill="black" stroke="black" points="4624.5,-42557.74 4621,-42547.74 4617.5,-42557.74 4624.5,-42557.74"/>
</g>
<!-- layer6_moe_comm_from_expert8&#45;&gt;layer6_moe_aggregate -->
<g id="edge257" class="edge">
<title>layer6_moe_comm_from_expert8&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M4892.39,-42583.45C4892.39,-42583.45 4892.39,-42557.74 4892.39,-42557.74"/>
<polygon fill="black" stroke="black" points="4895.89,-42557.74 4892.39,-42547.74 4888.89,-42557.74 4895.89,-42557.74"/>
</g>
<!-- layer6_moe_comm_from_expert9&#45;&gt;layer6_moe_aggregate -->
<g id="edge259" class="edge">
<title>layer6_moe_comm_from_expert9&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M5183.5,-42584.27C5183.5,-42561.73 5183.5,-42534 5183.5,-42534 5183.5,-42534 4978.03,-42534 4978.03,-42534"/>
<polygon fill="black" stroke="black" points="4978.03,-42530.5 4968.03,-42534 4978.03,-42537.5 4978.03,-42530.5"/>
</g>
<!-- layer6_moe_comm_from_expert10&#45;&gt;layer6_moe_aggregate -->
<g id="edge261" class="edge">
<title>layer6_moe_comm_from_expert10&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M5515.15,-42584.17C5515.15,-42557.26 5515.15,-42521 5515.15,-42521 5515.15,-42521 4964.81,-42521 4964.81,-42521"/>
<polygon fill="black" stroke="black" points="4964.81,-42517.5 4954.81,-42521 4964.81,-42524.5 4964.81,-42517.5"/>
</g>
<!-- layer6_moe_comm_from_expert11&#45;&gt;layer6_moe_aggregate -->
<g id="edge263" class="edge">
<title>layer6_moe_comm_from_expert11&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M5861.65,-42584.07C5861.65,-42553.08 5861.65,-42508 5861.65,-42508 5861.65,-42508 4951.47,-42508 4951.47,-42508"/>
<polygon fill="black" stroke="black" points="4951.47,-42504.5 4941.47,-42508 4951.47,-42511.5 4951.47,-42504.5"/>
</g>
<!-- layer6_moe_comm_from_expert12&#45;&gt;layer6_moe_aggregate -->
<g id="edge265" class="edge">
<title>layer6_moe_comm_from_expert12&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M6212.65,-42584.18C6212.65,-42549.36 6212.65,-42495 6212.65,-42495 6212.65,-42495 4937.94,-42495 4937.94,-42495"/>
<polygon fill="black" stroke="black" points="4937.94,-42491.5 4927.94,-42495 4937.94,-42498.5 4937.94,-42491.5"/>
</g>
<!-- layer6_moe_comm_from_expert13&#45;&gt;layer6_moe_aggregate -->
<g id="edge267" class="edge">
<title>layer6_moe_comm_from_expert13&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M6566.15,-42584.32C6566.15,-42545.88 6566.15,-42482 6566.15,-42482 6566.15,-42482 4924.52,-42482 4924.52,-42482"/>
<polygon fill="black" stroke="black" points="4924.52,-42478.5 4914.52,-42482 4924.52,-42485.5 4924.52,-42478.5"/>
</g>
<!-- layer6_moe_comm_from_expert14&#45;&gt;layer6_moe_aggregate -->
<g id="edge269" class="edge">
<title>layer6_moe_comm_from_expert14&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M6921.15,-42584.28C6921.15,-42542.41 6921.15,-42469 6921.15,-42469 6921.15,-42469 4911.06,-42469 4911.06,-42469"/>
<polygon fill="black" stroke="black" points="4911.06,-42465.5 4901.06,-42469 4911.06,-42472.5 4911.06,-42465.5"/>
</g>
<!-- layer6_moe_comm_from_expert15&#45;&gt;layer6_moe_aggregate -->
<g id="edge271" class="edge">
<title>layer6_moe_comm_from_expert15&#45;&gt;layer6_moe_aggregate</title>
<path fill="none" stroke="black" d="M7276.15,-42584.3C7276.15,-42539.15 7276.15,-42456 7276.15,-42456 7276.15,-42456 4897.72,-42456 4897.72,-42456"/>
<polygon fill="black" stroke="black" points="4897.72,-42452.5 4887.72,-42456 4897.72,-42459.5 4897.72,-42452.5"/>
</g>
<!-- layer7_moe_gate -->
<g id="node217" class="node">
<title>layer7_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4978.3,-42319.68 4567.4,-42319.68 4461.7,-42215.68 4872.6,-42215.68 4978.3,-42319.68"/>
<text text-anchor="middle" x="4720" y="-42281.68" font-family="Arial" font-size="10.00">GATE L7</text>
<text text-anchor="middle" x="4720" y="-42270.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4720" y="-42259.68" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4720" y="-42248.68" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer7_moe_mha&#45;&gt;layer7_moe_gate -->
<g id="edge340" class="edge">
<title>layer7_moe_mha&#45;&gt;layer7_moe_gate</title>
<path fill="none" stroke="black" d="M4720,-42355.52C4720,-42355.52 4720,-42329.78 4720,-42329.78"/>
<polygon fill="black" stroke="black" points="4723.5,-42329.78 4720,-42319.78 4716.5,-42329.78 4723.5,-42329.78"/>
</g>
<!-- layer7_moe_split -->
<g id="node218" class="node">
<title>layer7_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4974.01,-42179.68 4569.94,-42179.68 4465.99,-42075.68 4870.06,-42075.68 4974.01,-42179.68"/>
<text text-anchor="middle" x="4720" y="-42141.68" font-family="Arial" font-size="10.00">SPLIT TOKENS L7</text>
<text text-anchor="middle" x="4720" y="-42130.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4720" y="-42119.68" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4720" y="-42108.68" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer7_moe_gate&#45;&gt;layer7_moe_split -->
<g id="edge341" class="edge">
<title>layer7_moe_gate&#45;&gt;layer7_moe_split</title>
<path fill="none" stroke="black" d="M4720,-42215.55C4720,-42215.55 4720,-42189.85 4720,-42189.85"/>
<polygon fill="black" stroke="black" points="4723.5,-42189.85 4720,-42179.85 4716.5,-42189.85 4723.5,-42189.85"/>
</g>
<!-- layer7_moe_comm_to_expert0 -->
<g id="node220" class="node">
<title>layer7_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2272" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2272" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2272" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2272" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert0 -->
<g id="edge275" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4553.9,-42164C4006.88,-42164 2296.5,-42164 2296.5,-42164 2296.5,-42164 2296.5,-42048.81 2296.5,-42048.81"/>
<polygon fill="black" stroke="black" points="2300,-42048.81 2296.5,-42038.81 2293,-42048.81 2300,-42048.81"/>
</g>
<!-- layer7_moe_comm_to_expert1 -->
<g id="node222" class="node">
<title>layer7_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2544" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2544" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2544" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2544" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert1 -->
<g id="edge277" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4538.88,-42149C4020.58,-42149 2568.5,-42149 2568.5,-42149 2568.5,-42149 2568.5,-42048.68 2568.5,-42048.68"/>
<polygon fill="black" stroke="black" points="2572,-42048.68 2568.5,-42038.68 2565,-42048.68 2572,-42048.68"/>
</g>
<!-- layer7_moe_comm_to_expert2 -->
<g id="node224" class="node">
<title>layer7_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2927" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2927" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2927" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2927" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert2 -->
<g id="edge279" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4525.21,-42135C4077.04,-42135 3011.01,-42135 3011.01,-42135 3011.01,-42135 3011.01,-42031.72 3011.01,-42031.72"/>
<polygon fill="black" stroke="black" points="3014.51,-42031.72 3011.01,-42021.72 3007.51,-42031.72 3014.51,-42031.72"/>
</g>
<!-- layer7_moe_comm_to_expert3 -->
<g id="node226" class="node">
<title>layer7_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3347" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3347" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3347" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3347" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert3 -->
<g id="edge281" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4510.09,-42120C4140.77,-42120 3413.5,-42120 3413.5,-42120 3413.5,-42120 3413.5,-42040.48 3413.5,-42040.48"/>
<polygon fill="black" stroke="black" points="3417,-42040.48 3413.5,-42030.48 3410,-42040.48 3417,-42040.48"/>
</g>
<!-- layer7_moe_comm_to_expert4 -->
<g id="node228" class="node">
<title>layer7_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3619" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3619" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3619" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3619" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert4 -->
<g id="edge283" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4495.1,-42105C4172.5,-42105 3616.84,-42105 3616.84,-42105 3616.84,-42105 3616.84,-42049.75 3616.84,-42049.75"/>
<polygon fill="black" stroke="black" points="3620.34,-42049.75 3616.84,-42039.75 3613.34,-42049.75 3620.34,-42049.75"/>
</g>
<!-- layer7_moe_comm_to_expert5 -->
<g id="node230" class="node">
<title>layer7_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4002" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4002" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="4002" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="4002" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert5 -->
<g id="edge285" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4480.03,-42090C4297.68,-42090 4078,-42090 4078,-42090 4078,-42090 4078,-42036.74 4078,-42036.74"/>
<polygon fill="black" stroke="black" points="4081.5,-42036.74 4078,-42026.74 4074.5,-42036.74 4081.5,-42036.74"/>
</g>
<!-- layer7_moe_comm_to_expert6 -->
<g id="node232" class="node">
<title>layer7_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4274" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4274" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4274" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4274" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert6 -->
<g id="edge287" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4479.74,-42127.59C4479.74,-42124.03 4479.74,-42010 4479.74,-42010 4479.74,-42010 4374.54,-42010 4374.54,-42010"/>
<polygon fill="black" stroke="black" points="4374.54,-42006.5 4364.54,-42010 4374.54,-42013.5 4374.54,-42006.5"/>
</g>
<!-- layer7_moe_comm_to_expert7 -->
<g id="node234" class="node">
<title>layer7_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4584" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4584" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4584" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4584" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert7 -->
<g id="edge289" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4584,-42075.34C4584,-42075.34 4584,-42049.9 4584,-42049.9"/>
<polygon fill="black" stroke="black" points="4587.5,-42049.9 4584,-42039.9 4580.5,-42049.9 4587.5,-42049.9"/>
</g>
<!-- layer7_moe_comm_to_expert8 -->
<g id="node236" class="node">
<title>layer7_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4856" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4856" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4856" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4856" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert8 -->
<g id="edge291" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4856,-42075.34C4856,-42075.34 4856,-42049.9 4856,-42049.9"/>
<polygon fill="black" stroke="black" points="4859.5,-42049.9 4856,-42039.9 4852.5,-42049.9 4859.5,-42049.9"/>
</g>
<!-- layer7_moe_comm_to_expert9 -->
<g id="node238" class="node">
<title>layer7_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5165" cy="-42010.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5165" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5165" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5165" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert9 -->
<g id="edge293" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4960.26,-42127.59C4960.26,-42124.03 4960.26,-42010 4960.26,-42010 4960.26,-42010 5064.3,-42010 5064.3,-42010"/>
<polygon fill="black" stroke="black" points="5064.3,-42013.5 5074.3,-42010 5064.3,-42006.5 5064.3,-42013.5"/>
</g>
<!-- layer7_moe_comm_to_expert10 -->
<g id="node240" class="node">
<title>layer7_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5497" cy="-42010.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5497" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5497" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5497" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert10 -->
<g id="edge295" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4884.82,-42090C5092.07,-42090 5421.1,-42090 5421.1,-42090 5421.1,-42090 5421.1,-42037.9 5421.1,-42037.9"/>
<polygon fill="black" stroke="black" points="5424.6,-42037.9 5421.1,-42027.9 5417.6,-42037.9 5424.6,-42037.9"/>
</g>
<!-- layer7_moe_comm_to_expert11 -->
<g id="node242" class="node">
<title>layer7_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5843" cy="-42010.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5843" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5843" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5843" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert11 -->
<g id="edge297" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4899.49,-42105C5198.86,-42105 5767.6,-42105 5767.6,-42105 5767.6,-42105 5767.6,-42038.43 5767.6,-42038.43"/>
<polygon fill="black" stroke="black" points="5771.1,-42038.43 5767.6,-42028.43 5764.1,-42038.43 5771.1,-42038.43"/>
</g>
<!-- layer7_moe_comm_to_expert12 -->
<g id="node244" class="node">
<title>layer7_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6194" cy="-42010.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6194" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6194" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6194" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert12 -->
<g id="edge299" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4914.47,-42120C5298.77,-42120 6118.6,-42120 6118.6,-42120 6118.6,-42120 6118.6,-42038.25 6118.6,-42038.25"/>
<polygon fill="black" stroke="black" points="6122.1,-42038.25 6118.6,-42028.25 6115.1,-42038.25 6122.1,-42038.25"/>
</g>
<!-- layer7_moe_comm_to_expert13 -->
<g id="node246" class="node">
<title>layer7_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6547" cy="-42010.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6547" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6547" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6547" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert13 -->
<g id="edge301" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4929.6,-42135C5394.67,-42135 6472.1,-42135 6472.1,-42135 6472.1,-42135 6472.1,-42038.23 6472.1,-42038.23"/>
<polygon fill="black" stroke="black" points="6475.6,-42038.23 6472.1,-42028.23 6468.6,-42038.23 6475.6,-42038.23"/>
</g>
<!-- layer7_moe_comm_to_expert14 -->
<g id="node248" class="node">
<title>layer7_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6902" cy="-42010.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6902" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6902" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6902" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert14 -->
<g id="edge303" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4943.5,-42149C5485.79,-42149 6827.1,-42149 6827.1,-42149 6827.1,-42149 6827.1,-42038.48 6827.1,-42038.48"/>
<polygon fill="black" stroke="black" points="6830.6,-42038.48 6827.1,-42028.48 6823.6,-42038.48 6830.6,-42038.48"/>
</g>
<!-- layer7_moe_comm_to_expert15 -->
<g id="node250" class="node">
<title>layer7_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7257" cy="-42010.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7257" y="-42019.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7257" y="-42008.19" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7257" y="-41997.19" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert15 -->
<g id="edge305" class="edge">
<title>layer7_moe_split&#45;&gt;layer7_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4958.59,-42164C5576.69,-42164 7182.1,-42164 7182.1,-42164 7182.1,-42164 7182.1,-42038.27 7182.1,-42038.27"/>
<polygon fill="black" stroke="black" points="7185.6,-42038.27 7182.1,-42028.27 7178.6,-42038.27 7185.6,-42038.27"/>
</g>
<!-- layer7_moe_expert0 -->
<g id="node219" class="node">
<title>layer7_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2289,-41945.69 1961,-41945.69 1961,-41893.69 2289,-41893.69 2289,-41945.69"/>
<text text-anchor="middle" x="2125" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 0 L7</text>
<text text-anchor="middle" x="2125" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2125" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2125" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert0 -->
<g id="node252" class="node">
<title>layer7_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2198" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2198" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2198" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2198" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer7_moe_expert0&#45;&gt;layer7_moe_comm_from_expert0 -->
<g id="edge307" class="edge">
<title>layer7_moe_expert0&#45;&gt;layer7_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2198,-41893.38C2198,-41893.38 2198,-41867.83 2198,-41867.83"/>
<polygon fill="black" stroke="black" points="2201.5,-41867.83 2198,-41857.83 2194.5,-41867.83 2201.5,-41867.83"/>
</g>
<!-- layer7_moe_comm_to_expert0&#45;&gt;layer7_moe_expert0 -->
<g id="edge276" class="edge">
<title>layer7_moe_comm_to_expert0&#45;&gt;layer7_moe_expert0</title>
<path fill="none" stroke="black" d="M2235.25,-41983.88C2235.25,-41983.88 2235.25,-41956 2235.25,-41956"/>
<polygon fill="black" stroke="black" points="2238.75,-41956 2235.25,-41946 2231.75,-41956 2238.75,-41956"/>
</g>
<!-- layer7_moe_expert1 -->
<g id="node221" class="node">
<title>layer7_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2635,-41945.69 2307,-41945.69 2307,-41893.69 2635,-41893.69 2635,-41945.69"/>
<text text-anchor="middle" x="2471" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 1 L7</text>
<text text-anchor="middle" x="2471" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2471" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2471" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert1 -->
<g id="node253" class="node">
<title>layer7_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2581" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2581" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2581" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2581" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer7_moe_expert1&#45;&gt;layer7_moe_comm_from_expert1 -->
<g id="edge309" class="edge">
<title>layer7_moe_expert1&#45;&gt;layer7_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2562.75,-41893.38C2562.75,-41893.38 2562.75,-41867.19 2562.75,-41867.19"/>
<polygon fill="black" stroke="black" points="2566.25,-41867.19 2562.75,-41857.19 2559.25,-41867.19 2566.25,-41867.19"/>
</g>
<!-- layer7_moe_comm_to_expert1&#45;&gt;layer7_moe_expert1 -->
<g id="edge278" class="edge">
<title>layer7_moe_comm_to_expert1&#45;&gt;layer7_moe_expert1</title>
<path fill="none" stroke="black" d="M2544,-41981.64C2544,-41981.64 2544,-41956 2544,-41956"/>
<polygon fill="black" stroke="black" points="2547.5,-41956 2544,-41946 2540.5,-41956 2547.5,-41956"/>
</g>
<!-- layer7_moe_expert2 -->
<g id="node223" class="node">
<title>layer7_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2981,-41945.69 2653,-41945.69 2653,-41893.69 2981,-41893.69 2981,-41945.69"/>
<text text-anchor="middle" x="2817" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 2 L7</text>
<text text-anchor="middle" x="2817" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2817" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2817" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert2 -->
<g id="node254" class="node">
<title>layer7_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="3001" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3001" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="3001" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3001" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer7_moe_expert2&#45;&gt;layer7_moe_comm_from_expert2 -->
<g id="edge311" class="edge">
<title>layer7_moe_expert2&#45;&gt;layer7_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2945.75,-41893.38C2945.75,-41893.38 2945.75,-41861.87 2945.75,-41861.87"/>
<polygon fill="black" stroke="black" points="2949.25,-41861.87 2945.75,-41851.87 2942.25,-41861.87 2949.25,-41861.87"/>
</g>
<!-- layer7_moe_comm_to_expert2&#45;&gt;layer7_moe_expert2 -->
<g id="edge280" class="edge">
<title>layer7_moe_comm_to_expert2&#45;&gt;layer7_moe_expert2</title>
<path fill="none" stroke="black" d="M2908.75,-41981.9C2908.75,-41981.9 2908.75,-41955.83 2908.75,-41955.83"/>
<polygon fill="black" stroke="black" points="2912.25,-41955.83 2908.75,-41945.83 2905.25,-41955.83 2912.25,-41955.83"/>
</g>
<!-- layer7_moe_expert3 -->
<g id="node225" class="node">
<title>layer7_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3327,-41945.69 2999,-41945.69 2999,-41893.69 3327,-41893.69 3327,-41945.69"/>
<text text-anchor="middle" x="3163" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 3 L7</text>
<text text-anchor="middle" x="3163" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3163" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3163" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert3 -->
<g id="node255" class="node">
<title>layer7_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3347" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3347" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3347" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3347" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer7_moe_expert3&#45;&gt;layer7_moe_comm_from_expert3 -->
<g id="edge313" class="edge">
<title>layer7_moe_expert3&#45;&gt;layer7_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3291.75,-41893.38C3291.75,-41893.38 3291.75,-41861.87 3291.75,-41861.87"/>
<polygon fill="black" stroke="black" points="3295.25,-41861.87 3291.75,-41851.87 3288.25,-41861.87 3295.25,-41861.87"/>
</g>
<!-- layer7_moe_comm_to_expert3&#45;&gt;layer7_moe_expert3 -->
<g id="edge282" class="edge">
<title>layer7_moe_comm_to_expert3&#45;&gt;layer7_moe_expert3</title>
<path fill="none" stroke="black" d="M3291.75,-41987.25C3291.75,-41987.25 3291.75,-41955.94 3291.75,-41955.94"/>
<polygon fill="black" stroke="black" points="3295.25,-41955.94 3291.75,-41945.94 3288.25,-41955.94 3295.25,-41955.94"/>
</g>
<!-- layer7_moe_expert4 -->
<g id="node227" class="node">
<title>layer7_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3673,-41945.69 3345,-41945.69 3345,-41893.69 3673,-41893.69 3673,-41945.69"/>
<text text-anchor="middle" x="3509" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 4 L7</text>
<text text-anchor="middle" x="3509" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3509" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3509" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert4 -->
<g id="node256" class="node">
<title>layer7_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3619" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3619" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3619" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3619" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer7_moe_expert4&#45;&gt;layer7_moe_comm_from_expert4 -->
<g id="edge315" class="edge">
<title>layer7_moe_expert4&#45;&gt;layer7_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3600.75,-41893.38C3600.75,-41893.38 3600.75,-41867.19 3600.75,-41867.19"/>
<polygon fill="black" stroke="black" points="3604.25,-41867.19 3600.75,-41857.19 3597.25,-41867.19 3604.25,-41867.19"/>
</g>
<!-- layer7_moe_comm_to_expert4&#45;&gt;layer7_moe_expert4 -->
<g id="edge284" class="edge">
<title>layer7_moe_comm_to_expert4&#45;&gt;layer7_moe_expert4</title>
<path fill="none" stroke="black" d="M3600.75,-41981.9C3600.75,-41981.9 3600.75,-41955.83 3600.75,-41955.83"/>
<polygon fill="black" stroke="black" points="3604.25,-41955.83 3600.75,-41945.83 3597.25,-41955.83 3604.25,-41955.83"/>
</g>
<!-- layer7_moe_expert5 -->
<g id="node229" class="node">
<title>layer7_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="4019,-41945.69 3691,-41945.69 3691,-41893.69 4019,-41893.69 4019,-41945.69"/>
<text text-anchor="middle" x="3855" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 5 L7</text>
<text text-anchor="middle" x="3855" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3855" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3855" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert5 -->
<g id="node257" class="node">
<title>layer7_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3966" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3966" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3966" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3966" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer7_moe_expert5&#45;&gt;layer7_moe_comm_from_expert5 -->
<g id="edge317" class="edge">
<title>layer7_moe_expert5&#45;&gt;layer7_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3947.25,-41893.38C3947.25,-41893.38 3947.25,-41867.19 3947.25,-41867.19"/>
<polygon fill="black" stroke="black" points="3950.75,-41867.19 3947.25,-41857.19 3943.75,-41867.19 3950.75,-41867.19"/>
</g>
<!-- layer7_moe_comm_to_expert5&#45;&gt;layer7_moe_expert5 -->
<g id="edge286" class="edge">
<title>layer7_moe_comm_to_expert5&#45;&gt;layer7_moe_expert5</title>
<path fill="none" stroke="black" d="M3965.25,-41983.88C3965.25,-41983.88 3965.25,-41956 3965.25,-41956"/>
<polygon fill="black" stroke="black" points="3968.75,-41956 3965.25,-41946 3961.75,-41956 3968.75,-41956"/>
</g>
<!-- layer7_moe_expert6 -->
<g id="node231" class="node">
<title>layer7_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4365,-41945.69 4037,-41945.69 4037,-41893.69 4365,-41893.69 4365,-41945.69"/>
<text text-anchor="middle" x="4201" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 6 L7</text>
<text text-anchor="middle" x="4201" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4201" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4201" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert6 -->
<g id="node258" class="node">
<title>layer7_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4312" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4312" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4312" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4312" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer7_moe_expert6&#45;&gt;layer7_moe_comm_from_expert6 -->
<g id="edge319" class="edge">
<title>layer7_moe_expert6&#45;&gt;layer7_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4293.25,-41893.38C4293.25,-41893.38 4293.25,-41867.19 4293.25,-41867.19"/>
<polygon fill="black" stroke="black" points="4296.75,-41867.19 4293.25,-41857.19 4289.75,-41867.19 4296.75,-41867.19"/>
</g>
<!-- layer7_moe_comm_to_expert6&#45;&gt;layer7_moe_expert6 -->
<g id="edge288" class="edge">
<title>layer7_moe_comm_to_expert6&#45;&gt;layer7_moe_expert6</title>
<path fill="none" stroke="black" d="M4274,-41981.64C4274,-41981.64 4274,-41956 4274,-41956"/>
<polygon fill="black" stroke="black" points="4277.5,-41956 4274,-41946 4270.5,-41956 4277.5,-41956"/>
</g>
<!-- layer7_moe_expert7 -->
<g id="node233" class="node">
<title>layer7_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4711,-41945.69 4383,-41945.69 4383,-41893.69 4711,-41893.69 4711,-41945.69"/>
<text text-anchor="middle" x="4547" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 7 L7</text>
<text text-anchor="middle" x="4547" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4547" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4547" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert7 -->
<g id="node259" class="node">
<title>layer7_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4584" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4584" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4584" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4584" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer7_moe_expert7&#45;&gt;layer7_moe_comm_from_expert7 -->
<g id="edge321" class="edge">
<title>layer7_moe_expert7&#45;&gt;layer7_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4584,-41893.38C4584,-41893.38 4584,-41867.83 4584,-41867.83"/>
<polygon fill="black" stroke="black" points="4587.5,-41867.83 4584,-41857.83 4580.5,-41867.83 4587.5,-41867.83"/>
</g>
<!-- layer7_moe_comm_to_expert7&#45;&gt;layer7_moe_expert7 -->
<g id="edge290" class="edge">
<title>layer7_moe_comm_to_expert7&#45;&gt;layer7_moe_expert7</title>
<path fill="none" stroke="black" d="M4584,-41981.64C4584,-41981.64 4584,-41956 4584,-41956"/>
<polygon fill="black" stroke="black" points="4587.5,-41956 4584,-41946 4580.5,-41956 4587.5,-41956"/>
</g>
<!-- layer7_moe_expert8 -->
<g id="node235" class="node">
<title>layer7_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="5057,-41945.69 4729,-41945.69 4729,-41893.69 5057,-41893.69 5057,-41945.69"/>
<text text-anchor="middle" x="4893" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 8 L7</text>
<text text-anchor="middle" x="4893" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4893" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4893" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert8 -->
<g id="node260" class="node">
<title>layer7_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4856" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4856" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4856" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4856" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer7_moe_expert8&#45;&gt;layer7_moe_comm_from_expert8 -->
<g id="edge323" class="edge">
<title>layer7_moe_expert8&#45;&gt;layer7_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4856,-41893.38C4856,-41893.38 4856,-41867.83 4856,-41867.83"/>
<polygon fill="black" stroke="black" points="4859.5,-41867.83 4856,-41857.83 4852.5,-41867.83 4859.5,-41867.83"/>
</g>
<!-- layer7_moe_comm_to_expert8&#45;&gt;layer7_moe_expert8 -->
<g id="edge292" class="edge">
<title>layer7_moe_comm_to_expert8&#45;&gt;layer7_moe_expert8</title>
<path fill="none" stroke="black" d="M4856,-41981.64C4856,-41981.64 4856,-41956 4856,-41956"/>
<polygon fill="black" stroke="black" points="4859.5,-41956 4856,-41946 4852.5,-41956 4859.5,-41956"/>
</g>
<!-- layer7_moe_expert9 -->
<g id="node237" class="node">
<title>layer7_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5403,-41945.69 5075,-41945.69 5075,-41893.69 5403,-41893.69 5403,-41945.69"/>
<text text-anchor="middle" x="5239" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 9 L7</text>
<text text-anchor="middle" x="5239" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5239" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5239" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert9 -->
<g id="node261" class="node">
<title>layer7_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5165" cy="-41828.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5165" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5165" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5165" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer7_moe_expert9&#45;&gt;layer7_moe_comm_from_expert9 -->
<g id="edge325" class="edge">
<title>layer7_moe_expert9&#45;&gt;layer7_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5165.25,-41893.38C5165.25,-41893.38 5165.25,-41867.83 5165.25,-41867.83"/>
<polygon fill="black" stroke="black" points="5168.75,-41867.83 5165.25,-41857.83 5161.75,-41867.83 5168.75,-41867.83"/>
</g>
<!-- layer7_moe_comm_to_expert9&#45;&gt;layer7_moe_expert9 -->
<g id="edge294" class="edge">
<title>layer7_moe_comm_to_expert9&#45;&gt;layer7_moe_expert9</title>
<path fill="none" stroke="black" d="M5165.25,-41981.64C5165.25,-41981.64 5165.25,-41956 5165.25,-41956"/>
<polygon fill="black" stroke="black" points="5168.75,-41956 5165.25,-41946 5161.75,-41956 5168.75,-41956"/>
</g>
<!-- layer7_moe_expert10 -->
<g id="node239" class="node">
<title>layer7_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5759,-41945.69 5421,-41945.69 5421,-41893.69 5759,-41893.69 5759,-41945.69"/>
<text text-anchor="middle" x="5590" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 10 L7</text>
<text text-anchor="middle" x="5590" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5590" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5590" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert10 -->
<g id="node262" class="node">
<title>layer7_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5497" cy="-41828.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5497" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5497" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5497" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer7_moe_expert10&#45;&gt;layer7_moe_comm_from_expert10 -->
<g id="edge327" class="edge">
<title>layer7_moe_expert10&#45;&gt;layer7_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5506.38,-41893.38C5506.38,-41893.38 5506.38,-41867.83 5506.38,-41867.83"/>
<polygon fill="black" stroke="black" points="5509.88,-41867.83 5506.38,-41857.83 5502.88,-41867.83 5509.88,-41867.83"/>
</g>
<!-- layer7_moe_comm_to_expert10&#45;&gt;layer7_moe_expert10 -->
<g id="edge296" class="edge">
<title>layer7_moe_comm_to_expert10&#45;&gt;layer7_moe_expert10</title>
<path fill="none" stroke="black" d="M5506.02,-41981.64C5506.02,-41981.64 5506.02,-41956 5506.02,-41956"/>
<polygon fill="black" stroke="black" points="5509.52,-41956 5506.02,-41946 5502.52,-41956 5509.52,-41956"/>
</g>
<!-- layer7_moe_expert11 -->
<g id="node241" class="node">
<title>layer7_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6115,-41945.69 5777,-41945.69 5777,-41893.69 6115,-41893.69 6115,-41945.69"/>
<text text-anchor="middle" x="5946" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 11 L7</text>
<text text-anchor="middle" x="5946" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5946" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5946" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert11 -->
<g id="node263" class="node">
<title>layer7_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5844" cy="-41828.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5844" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5844" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5844" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer7_moe_expert11&#45;&gt;layer7_moe_comm_from_expert11 -->
<g id="edge329" class="edge">
<title>layer7_moe_expert11&#45;&gt;layer7_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5857.88,-41893.38C5857.88,-41893.38 5857.88,-41867.51 5857.88,-41867.51"/>
<polygon fill="black" stroke="black" points="5861.38,-41867.51 5857.88,-41857.51 5854.38,-41867.51 5861.38,-41867.51"/>
</g>
<!-- layer7_moe_comm_to_expert11&#45;&gt;layer7_moe_expert11 -->
<g id="edge298" class="edge">
<title>layer7_moe_comm_to_expert11&#45;&gt;layer7_moe_expert11</title>
<path fill="none" stroke="black" d="M5857.02,-41981.9C5857.02,-41981.9 5857.02,-41955.83 5857.02,-41955.83"/>
<polygon fill="black" stroke="black" points="5860.52,-41955.83 5857.02,-41945.83 5853.52,-41955.83 5860.52,-41955.83"/>
</g>
<!-- layer7_moe_expert12 -->
<g id="node243" class="node">
<title>layer7_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6471,-41945.69 6133,-41945.69 6133,-41893.69 6471,-41893.69 6471,-41945.69"/>
<text text-anchor="middle" x="6302" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 12 L7</text>
<text text-anchor="middle" x="6302" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6302" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6302" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert12 -->
<g id="node264" class="node">
<title>layer7_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6195" cy="-41828.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6195" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6195" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6195" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer7_moe_expert12&#45;&gt;layer7_moe_comm_from_expert12 -->
<g id="edge331" class="edge">
<title>layer7_moe_expert12&#45;&gt;layer7_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6211.38,-41893.38C6211.38,-41893.38 6211.38,-41867.51 6211.38,-41867.51"/>
<polygon fill="black" stroke="black" points="6214.88,-41867.51 6211.38,-41857.51 6207.88,-41867.51 6214.88,-41867.51"/>
</g>
<!-- layer7_moe_comm_to_expert12&#45;&gt;layer7_moe_expert12 -->
<g id="edge300" class="edge">
<title>layer7_moe_comm_to_expert12&#45;&gt;layer7_moe_expert12</title>
<path fill="none" stroke="black" d="M6210.52,-41981.9C6210.52,-41981.9 6210.52,-41955.83 6210.52,-41955.83"/>
<polygon fill="black" stroke="black" points="6214.02,-41955.83 6210.52,-41945.83 6207.02,-41955.83 6214.02,-41955.83"/>
</g>
<!-- layer7_moe_expert13 -->
<g id="node245" class="node">
<title>layer7_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6827,-41945.69 6489,-41945.69 6489,-41893.69 6827,-41893.69 6827,-41945.69"/>
<text text-anchor="middle" x="6658" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 13 L7</text>
<text text-anchor="middle" x="6658" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6658" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6658" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert13 -->
<g id="node265" class="node">
<title>layer7_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6549" cy="-41828.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6549" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6549" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6549" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer7_moe_expert13&#45;&gt;layer7_moe_comm_from_expert13 -->
<g id="edge333" class="edge">
<title>layer7_moe_expert13&#45;&gt;layer7_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6566.38,-41893.38C6566.38,-41893.38 6566.38,-41867.51 6566.38,-41867.51"/>
<polygon fill="black" stroke="black" points="6569.88,-41867.51 6566.38,-41857.51 6562.88,-41867.51 6569.88,-41867.51"/>
</g>
<!-- layer7_moe_comm_to_expert13&#45;&gt;layer7_moe_expert13 -->
<g id="edge302" class="edge">
<title>layer7_moe_comm_to_expert13&#45;&gt;layer7_moe_expert13</title>
<path fill="none" stroke="black" d="M6565.02,-41981.9C6565.02,-41981.9 6565.02,-41955.83 6565.02,-41955.83"/>
<polygon fill="black" stroke="black" points="6568.52,-41955.83 6565.02,-41945.83 6561.52,-41955.83 6568.52,-41955.83"/>
</g>
<!-- layer7_moe_expert14 -->
<g id="node247" class="node">
<title>layer7_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7183,-41945.69 6845,-41945.69 6845,-41893.69 7183,-41893.69 7183,-41945.69"/>
<text text-anchor="middle" x="7014" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 14 L7</text>
<text text-anchor="middle" x="7014" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="7014" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="7014" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert14 -->
<g id="node266" class="node">
<title>layer7_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6904" cy="-41828.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6904" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6904" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6904" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer7_moe_expert14&#45;&gt;layer7_moe_comm_from_expert14 -->
<g id="edge335" class="edge">
<title>layer7_moe_expert14&#45;&gt;layer7_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6921.88,-41893.38C6921.88,-41893.38 6921.88,-41867.19 6921.88,-41867.19"/>
<polygon fill="black" stroke="black" points="6925.38,-41867.19 6921.88,-41857.19 6918.38,-41867.19 6925.38,-41867.19"/>
</g>
<!-- layer7_moe_comm_to_expert14&#45;&gt;layer7_moe_expert14 -->
<g id="edge304" class="edge">
<title>layer7_moe_comm_to_expert14&#45;&gt;layer7_moe_expert14</title>
<path fill="none" stroke="black" d="M6920.52,-41981.9C6920.52,-41981.9 6920.52,-41955.83 6920.52,-41955.83"/>
<polygon fill="black" stroke="black" points="6924.02,-41955.83 6920.52,-41945.83 6917.02,-41955.83 6924.02,-41955.83"/>
</g>
<!-- layer7_moe_expert15 -->
<g id="node249" class="node">
<title>layer7_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7539,-41945.69 7201,-41945.69 7201,-41893.69 7539,-41893.69 7539,-41945.69"/>
<text text-anchor="middle" x="7370" y="-41933.69" font-family="Arial" font-size="10.00">EXPERT 15 L7</text>
<text text-anchor="middle" x="7370" y="-41922.69" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7370" y="-41911.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7370" y="-41900.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_comm_from_expert15 -->
<g id="node267" class="node">
<title>layer7_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7259" cy="-41828.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7259" y="-41837.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7259" y="-41826.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7259" y="-41815.2" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer7_moe_expert15&#45;&gt;layer7_moe_comm_from_expert15 -->
<g id="edge337" class="edge">
<title>layer7_moe_expert15&#45;&gt;layer7_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7277.38,-41893.38C7277.38,-41893.38 7277.38,-41867.19 7277.38,-41867.19"/>
<polygon fill="black" stroke="black" points="7280.88,-41867.19 7277.38,-41857.19 7273.88,-41867.19 7280.88,-41867.19"/>
</g>
<!-- layer7_moe_comm_to_expert15&#45;&gt;layer7_moe_expert15 -->
<g id="edge306" class="edge">
<title>layer7_moe_comm_to_expert15&#45;&gt;layer7_moe_expert15</title>
<path fill="none" stroke="black" d="M7276.02,-41981.9C7276.02,-41981.9 7276.02,-41955.83 7276.02,-41955.83"/>
<polygon fill="black" stroke="black" points="7279.52,-41955.83 7276.02,-41945.83 7272.52,-41955.83 7279.52,-41955.83"/>
</g>
<!-- layer7_moe_aggregate -->
<g id="node251" class="node">
<title>layer7_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4945.1,-41763.71 4528.16,-41763.71 4420.9,-41659.71 4837.84,-41659.71 4945.1,-41763.71"/>
<text text-anchor="middle" x="4683" y="-41725.71" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L7</text>
<text text-anchor="middle" x="4683" y="-41714.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4683" y="-41703.71" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4683" y="-41692.71" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_mha -->
<g id="node268" class="node">
<title>layer8_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4813,-41623.71 4553,-41623.71 4553,-41571.71 4813,-41571.71 4813,-41623.71"/>
<text text-anchor="middle" x="4683" y="-41611.71" font-family="Arial" font-size="10.00">MHA L8</text>
<text text-anchor="middle" x="4683" y="-41600.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4683" y="-41589.71" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4683" y="-41578.71" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer7_moe_aggregate&#45;&gt;layer8_moe_mha -->
<g id="edge406" class="edge">
<title>layer7_moe_aggregate&#45;&gt;layer8_moe_mha</title>
<path fill="none" stroke="black" d="M4683,-41659.38C4683,-41659.38 4683,-41633.94 4683,-41633.94"/>
<polygon fill="black" stroke="black" points="4686.5,-41633.94 4683,-41623.94 4679.5,-41633.94 4686.5,-41633.94"/>
</g>
<!-- layer7_moe_comm_from_expert0&#45;&gt;layer7_moe_aggregate -->
<g id="edge308" class="edge">
<title>layer7_moe_comm_from_expert0&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M2216.5,-41799.97C2216.5,-41755.23 2216.5,-41674 2216.5,-41674 2216.5,-41674 4425.49,-41674 4425.49,-41674"/>
<polygon fill="black" stroke="black" points="4425.49,-41677.5 4435.49,-41674 4425.49,-41670.5 4425.49,-41677.5"/>
</g>
<!-- layer7_moe_comm_from_expert1&#45;&gt;layer7_moe_aggregate -->
<g id="edge310" class="edge">
<title>layer7_moe_comm_from_expert1&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M2654.5,-41811.57C2654.5,-41774.27 2654.5,-41689 2654.5,-41689 2654.5,-41689 4440.8,-41689 4440.8,-41689"/>
<polygon fill="black" stroke="black" points="4440.8,-41692.5 4450.8,-41689 4440.8,-41685.5 4440.8,-41692.5"/>
</g>
<!-- layer7_moe_comm_from_expert2&#45;&gt;layer7_moe_aggregate -->
<g id="edge312" class="edge">
<title>layer7_moe_comm_from_expert2&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M3037.5,-41801.95C3037.5,-41765.31 3037.5,-41704 3037.5,-41704 3037.5,-41704 4456.19,-41704 4456.19,-41704"/>
<polygon fill="black" stroke="black" points="4456.19,-41707.5 4466.19,-41704 4456.19,-41700.5 4456.19,-41707.5"/>
</g>
<!-- layer7_moe_comm_from_expert3&#45;&gt;layer7_moe_aggregate -->
<g id="edge314" class="edge">
<title>layer7_moe_comm_from_expert3&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M3376.5,-41801.02C3376.5,-41768.52 3376.5,-41719 3376.5,-41719 3376.5,-41719 4471.72,-41719 4471.72,-41719"/>
<polygon fill="black" stroke="black" points="4471.72,-41722.5 4481.72,-41719 4471.72,-41715.5 4471.72,-41722.5"/>
</g>
<!-- layer7_moe_comm_from_expert4&#45;&gt;layer7_moe_aggregate -->
<g id="edge316" class="edge">
<title>layer7_moe_comm_from_expert4&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M3691.01,-41810.7C3691.01,-41782.98 3691.01,-41733 3691.01,-41733 3691.01,-41733 4486.41,-41733 4486.41,-41733"/>
<polygon fill="black" stroke="black" points="4486.41,-41736.5 4496.41,-41733 4486.41,-41729.5 4486.41,-41736.5"/>
</g>
<!-- layer7_moe_comm_from_expert5&#45;&gt;layer7_moe_aggregate -->
<g id="edge318" class="edge">
<title>layer7_moe_comm_from_expert5&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M4038.01,-41810.79C4038.01,-41787.02 4038.01,-41748 4038.01,-41748 4038.01,-41748 4501.85,-41748 4501.85,-41748"/>
<polygon fill="black" stroke="black" points="4501.85,-41751.5 4511.85,-41748 4501.85,-41744.5 4501.85,-41751.5"/>
</g>
<!-- layer7_moe_comm_from_expert6&#45;&gt;layer7_moe_aggregate -->
<g id="edge320" class="edge">
<title>layer7_moe_comm_from_expert6&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M4402.65,-41828C4431.98,-41828 4457.1,-41828 4457.1,-41828 4457.1,-41828 4457.1,-41721.8 4457.1,-41721.8"/>
<polygon fill="black" stroke="black" points="4460.6,-41721.8 4457.1,-41711.8 4453.6,-41721.8 4460.6,-41721.8"/>
</g>
<!-- layer7_moe_comm_from_expert7&#45;&gt;layer7_moe_aggregate -->
<g id="edge322" class="edge">
<title>layer7_moe_comm_from_expert7&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M4584,-41799.48C4584,-41799.48 4584,-41773.77 4584,-41773.77"/>
<polygon fill="black" stroke="black" points="4587.5,-41773.77 4584,-41763.77 4580.5,-41773.77 4587.5,-41773.77"/>
</g>
<!-- layer7_moe_comm_from_expert8&#45;&gt;layer7_moe_aggregate -->
<g id="edge324" class="edge">
<title>layer7_moe_comm_from_expert8&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M4855.39,-41799.48C4855.39,-41799.48 4855.39,-41773.77 4855.39,-41773.77"/>
<polygon fill="black" stroke="black" points="4858.89,-41773.77 4855.39,-41763.77 4851.89,-41773.77 4858.89,-41773.77"/>
</g>
<!-- layer7_moe_comm_from_expert9&#45;&gt;layer7_moe_aggregate -->
<g id="edge326" class="edge">
<title>layer7_moe_comm_from_expert9&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M5146.5,-41800.29C5146.5,-41777.75 5146.5,-41750 5146.5,-41750 5146.5,-41750 4941.03,-41750 4941.03,-41750"/>
<polygon fill="black" stroke="black" points="4941.03,-41746.5 4931.03,-41750 4941.03,-41753.5 4941.03,-41746.5"/>
</g>
<!-- layer7_moe_comm_from_expert10&#45;&gt;layer7_moe_aggregate -->
<g id="edge328" class="edge">
<title>layer7_moe_comm_from_expert10&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M5478.15,-41800.19C5478.15,-41773.27 5478.15,-41737 5478.15,-41737 5478.15,-41737 4927.81,-41737 4927.81,-41737"/>
<polygon fill="black" stroke="black" points="4927.81,-41733.5 4917.81,-41737 4927.81,-41740.5 4927.81,-41733.5"/>
</g>
<!-- layer7_moe_comm_from_expert11&#45;&gt;layer7_moe_aggregate -->
<g id="edge330" class="edge">
<title>layer7_moe_comm_from_expert11&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M5824.65,-41800.09C5824.65,-41769.09 5824.65,-41724 5824.65,-41724 5824.65,-41724 4914.47,-41724 4914.47,-41724"/>
<polygon fill="black" stroke="black" points="4914.47,-41720.5 4904.47,-41724 4914.47,-41727.5 4914.47,-41720.5"/>
</g>
<!-- layer7_moe_comm_from_expert12&#45;&gt;layer7_moe_aggregate -->
<g id="edge332" class="edge">
<title>layer7_moe_comm_from_expert12&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M6175.65,-41800.21C6175.65,-41765.38 6175.65,-41711 6175.65,-41711 6175.65,-41711 4900.94,-41711 4900.94,-41711"/>
<polygon fill="black" stroke="black" points="4900.94,-41707.5 4890.94,-41711 4900.94,-41714.5 4900.94,-41707.5"/>
</g>
<!-- layer7_moe_comm_from_expert13&#45;&gt;layer7_moe_aggregate -->
<g id="edge334" class="edge">
<title>layer7_moe_comm_from_expert13&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M6529.15,-41800.34C6529.15,-41761.9 6529.15,-41698 6529.15,-41698 6529.15,-41698 4887.52,-41698 4887.52,-41698"/>
<polygon fill="black" stroke="black" points="4887.52,-41694.5 4877.52,-41698 4887.52,-41701.5 4887.52,-41694.5"/>
</g>
<!-- layer7_moe_comm_from_expert14&#45;&gt;layer7_moe_aggregate -->
<g id="edge336" class="edge">
<title>layer7_moe_comm_from_expert14&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M6884.15,-41800.31C6884.15,-41758.43 6884.15,-41685 6884.15,-41685 6884.15,-41685 4874.06,-41685 4874.06,-41685"/>
<polygon fill="black" stroke="black" points="4874.06,-41681.5 4864.06,-41685 4874.06,-41688.5 4874.06,-41681.5"/>
</g>
<!-- layer7_moe_comm_from_expert15&#45;&gt;layer7_moe_aggregate -->
<g id="edge338" class="edge">
<title>layer7_moe_comm_from_expert15&#45;&gt;layer7_moe_aggregate</title>
<path fill="none" stroke="black" d="M7239.15,-41800.32C7239.15,-41755.17 7239.15,-41672 7239.15,-41672 7239.15,-41672 4860.72,-41672 4860.72,-41672"/>
<polygon fill="black" stroke="black" points="4860.72,-41668.5 4850.72,-41672 4860.72,-41675.5 4860.72,-41668.5"/>
</g>
<!-- layer8_moe_gate -->
<g id="node269" class="node">
<title>layer8_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4941.3,-41535.71 4530.4,-41535.71 4424.7,-41431.71 4835.6,-41431.71 4941.3,-41535.71"/>
<text text-anchor="middle" x="4683" y="-41497.71" font-family="Arial" font-size="10.00">GATE L8</text>
<text text-anchor="middle" x="4683" y="-41486.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4683" y="-41475.71" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4683" y="-41464.71" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer8_moe_mha&#45;&gt;layer8_moe_gate -->
<g id="edge407" class="edge">
<title>layer8_moe_mha&#45;&gt;layer8_moe_gate</title>
<path fill="none" stroke="black" d="M4683,-41571.56C4683,-41571.56 4683,-41545.81 4683,-41545.81"/>
<polygon fill="black" stroke="black" points="4686.5,-41545.81 4683,-41535.81 4679.5,-41545.81 4686.5,-41545.81"/>
</g>
<!-- layer8_moe_split -->
<g id="node270" class="node">
<title>layer8_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4937.01,-41395.71 4532.94,-41395.71 4428.99,-41291.71 4833.06,-41291.71 4937.01,-41395.71"/>
<text text-anchor="middle" x="4683" y="-41357.71" font-family="Arial" font-size="10.00">SPLIT TOKENS L8</text>
<text text-anchor="middle" x="4683" y="-41346.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4683" y="-41335.71" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4683" y="-41324.71" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer8_moe_gate&#45;&gt;layer8_moe_split -->
<g id="edge408" class="edge">
<title>layer8_moe_gate&#45;&gt;layer8_moe_split</title>
<path fill="none" stroke="black" d="M4683,-41431.58C4683,-41431.58 4683,-41405.89 4683,-41405.89"/>
<polygon fill="black" stroke="black" points="4686.5,-41405.89 4683,-41395.89 4679.5,-41405.89 4686.5,-41405.89"/>
</g>
<!-- layer8_moe_comm_to_expert0 -->
<g id="node272" class="node">
<title>layer8_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2235" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2235" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2235" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2235" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert0 -->
<g id="edge342" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4517.05,-41380C3978.82,-41380 2316.25,-41380 2316.25,-41380 2316.25,-41380 2316.25,-41249.52 2316.25,-41249.52"/>
<polygon fill="black" stroke="black" points="2319.75,-41249.52 2316.25,-41239.52 2312.75,-41249.52 2319.75,-41249.52"/>
</g>
<!-- layer8_moe_comm_to_expert1 -->
<g id="node274" class="node">
<title>layer8_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2728" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2728" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2728" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2728" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert1 -->
<g id="edge344" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4501.98,-41365C4020.54,-41365 2745.01,-41365 2745.01,-41365 2745.01,-41365 2745.01,-41265.37 2745.01,-41265.37"/>
<polygon fill="black" stroke="black" points="2748.51,-41265.37 2745.01,-41255.37 2741.51,-41265.37 2748.51,-41265.37"/>
</g>
<!-- layer8_moe_comm_to_expert2 -->
<g id="node276" class="node">
<title>layer8_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3074" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3074" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3074" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3074" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert2 -->
<g id="edge346" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4488.03,-41351C4070.59,-41351 3128.01,-41351 3128.01,-41351 3128.01,-41351 3128.01,-41260.1 3128.01,-41260.1"/>
<polygon fill="black" stroke="black" points="3131.51,-41260.1 3128.01,-41250.1 3124.51,-41260.1 3131.51,-41260.1"/>
</g>
<!-- layer8_moe_comm_to_expert3 -->
<g id="node278" class="node">
<title>layer8_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3346" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3346" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3346" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3346" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert3 -->
<g id="edge348" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4473.22,-41336C4090.17,-41336 3316.5,-41336 3316.5,-41336 3316.5,-41336 3316.5,-41264.3 3316.5,-41264.3"/>
<polygon fill="black" stroke="black" points="3320,-41264.3 3316.5,-41254.3 3313,-41264.3 3320,-41264.3"/>
</g>
<!-- layer8_moe_comm_to_expert4 -->
<g id="node280" class="node">
<title>layer8_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3582" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3582" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3582" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3582" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert4 -->
<g id="edge350" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4458.05,-41321C4140.89,-41321 3600.5,-41321 3600.5,-41321 3600.5,-41321 3600.5,-41265.26 3600.5,-41265.26"/>
<polygon fill="black" stroke="black" points="3604,-41265.26 3600.5,-41255.26 3597,-41265.26 3604,-41265.26"/>
</g>
<!-- layer8_moe_comm_to_expert5 -->
<g id="node282" class="node">
<title>layer8_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3929" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3929" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3929" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3929" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert5 -->
<g id="edge352" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4443.19,-41306C4228.55,-41306 3947.5,-41306 3947.5,-41306 3947.5,-41306 3947.5,-41265.34 3947.5,-41265.34"/>
<polygon fill="black" stroke="black" points="3951,-41265.34 3947.5,-41255.34 3944,-41265.34 3951,-41265.34"/>
</g>
<!-- layer8_moe_comm_to_expert6 -->
<g id="node284" class="node">
<title>layer8_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4275" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4275" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4275" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4275" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert6 -->
<g id="edge354" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4442.74,-41343.63C4442.74,-41340.06 4442.74,-41226 4442.74,-41226 4442.74,-41226 4375.74,-41226 4375.74,-41226"/>
<polygon fill="black" stroke="black" points="4375.74,-41222.5 4365.74,-41226 4375.74,-41229.5 4375.74,-41222.5"/>
</g>
<!-- layer8_moe_comm_to_expert7 -->
<g id="node286" class="node">
<title>layer8_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4547" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4547" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4547" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4547" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert7 -->
<g id="edge356" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4547,-41291.37C4547,-41291.37 4547,-41265.93 4547,-41265.93"/>
<polygon fill="black" stroke="black" points="4550.5,-41265.93 4547,-41255.93 4543.5,-41265.93 4550.5,-41265.93"/>
</g>
<!-- layer8_moe_comm_to_expert8 -->
<g id="node288" class="node">
<title>layer8_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4819" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4819" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4819" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4819" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert8 -->
<g id="edge358" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4819,-41291.37C4819,-41291.37 4819,-41265.93 4819,-41265.93"/>
<polygon fill="black" stroke="black" points="4822.5,-41265.93 4819,-41255.93 4815.5,-41265.93 4822.5,-41265.93"/>
</g>
<!-- layer8_moe_comm_to_expert9 -->
<g id="node290" class="node">
<title>layer8_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5128" cy="-41226.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5128" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5128" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5128" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert9 -->
<g id="edge360" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4923.26,-41343.63C4923.26,-41340.06 4923.26,-41226 4923.26,-41226 4923.26,-41226 5027.3,-41226 5027.3,-41226"/>
<polygon fill="black" stroke="black" points="5027.3,-41229.5 5037.3,-41226 5027.3,-41222.5 5027.3,-41229.5"/>
</g>
<!-- layer8_moe_comm_to_expert10 -->
<g id="node292" class="node">
<title>layer8_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5460" cy="-41226.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5460" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5460" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5460" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert10 -->
<g id="edge362" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.38,-41306C5054.6,-41306 5384.1,-41306 5384.1,-41306 5384.1,-41306 5384.1,-41253.92 5384.1,-41253.92"/>
<polygon fill="black" stroke="black" points="5387.6,-41253.92 5384.1,-41243.92 5380.6,-41253.92 5387.6,-41253.92"/>
</g>
<!-- layer8_moe_comm_to_expert11 -->
<g id="node294" class="node">
<title>layer8_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5806" cy="-41226.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5806" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5806" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5806" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert11 -->
<g id="edge364" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4862.49,-41321C5161.86,-41321 5730.6,-41321 5730.6,-41321 5730.6,-41321 5730.6,-41254.45 5730.6,-41254.45"/>
<polygon fill="black" stroke="black" points="5734.1,-41254.45 5730.6,-41244.45 5727.1,-41254.45 5734.1,-41254.45"/>
</g>
<!-- layer8_moe_comm_to_expert12 -->
<g id="node296" class="node">
<title>layer8_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6157" cy="-41226.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6157" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6157" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6157" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert12 -->
<g id="edge366" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4877.47,-41336C5261.77,-41336 6081.6,-41336 6081.6,-41336 6081.6,-41336 6081.6,-41254.28 6081.6,-41254.28"/>
<polygon fill="black" stroke="black" points="6085.1,-41254.28 6081.6,-41244.28 6078.1,-41254.28 6085.1,-41254.28"/>
</g>
<!-- layer8_moe_comm_to_expert13 -->
<g id="node298" class="node">
<title>layer8_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6510" cy="-41226.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6510" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6510" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6510" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert13 -->
<g id="edge368" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4892.6,-41351C5357.67,-41351 6435.1,-41351 6435.1,-41351 6435.1,-41351 6435.1,-41254.26 6435.1,-41254.26"/>
<polygon fill="black" stroke="black" points="6438.6,-41254.26 6435.1,-41244.26 6431.6,-41254.26 6438.6,-41254.26"/>
</g>
<!-- layer8_moe_comm_to_expert14 -->
<g id="node300" class="node">
<title>layer8_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6865" cy="-41226.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6865" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6865" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6865" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert14 -->
<g id="edge370" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4906.5,-41365C5448.79,-41365 6790.1,-41365 6790.1,-41365 6790.1,-41365 6790.1,-41254.51 6790.1,-41254.51"/>
<polygon fill="black" stroke="black" points="6793.6,-41254.51 6790.1,-41244.51 6786.6,-41254.51 6793.6,-41254.51"/>
</g>
<!-- layer8_moe_comm_to_expert15 -->
<g id="node302" class="node">
<title>layer8_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7220" cy="-41226.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7220" y="-41235.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7220" y="-41224.22" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7220" y="-41213.22" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert15 -->
<g id="edge372" class="edge">
<title>layer8_moe_split&#45;&gt;layer8_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4921.31,-41380C5539.21,-41380 7145.1,-41380 7145.1,-41380 7145.1,-41380 7145.1,-41254.3 7145.1,-41254.3"/>
<polygon fill="black" stroke="black" points="7148.6,-41254.3 7145.1,-41244.3 7141.6,-41254.3 7148.6,-41254.3"/>
</g>
<!-- layer8_moe_expert0 -->
<g id="node271" class="node">
<title>layer8_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2252,-41161.73 1924,-41161.73 1924,-41109.73 2252,-41109.73 2252,-41161.73"/>
<text text-anchor="middle" x="2088" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 0 L8</text>
<text text-anchor="middle" x="2088" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2088" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2088" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert0 -->
<g id="node304" class="node">
<title>layer8_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2235" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2235" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2235" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2235" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer8_moe_expert0&#45;&gt;layer8_moe_comm_from_expert0 -->
<g id="edge374" class="edge">
<title>layer8_moe_expert0&#45;&gt;layer8_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2198.25,-41109.41C2198.25,-41109.41 2198.25,-41081.31 2198.25,-41081.31"/>
<polygon fill="black" stroke="black" points="2201.75,-41081.31 2198.25,-41071.31 2194.75,-41081.31 2201.75,-41081.31"/>
</g>
<!-- layer8_moe_comm_to_expert0&#45;&gt;layer8_moe_expert0 -->
<g id="edge343" class="edge">
<title>layer8_moe_comm_to_expert0&#45;&gt;layer8_moe_expert0</title>
<path fill="none" stroke="black" d="M2198.25,-41199.91C2198.25,-41199.91 2198.25,-41172.03 2198.25,-41172.03"/>
<polygon fill="black" stroke="black" points="2201.75,-41172.03 2198.25,-41162.03 2194.75,-41172.03 2201.75,-41172.03"/>
</g>
<!-- layer8_moe_expert1 -->
<g id="node273" class="node">
<title>layer8_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2598,-41161.73 2270,-41161.73 2270,-41109.73 2598,-41109.73 2598,-41161.73"/>
<text text-anchor="middle" x="2434" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 1 L8</text>
<text text-anchor="middle" x="2434" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2434" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2434" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert1 -->
<g id="node305" class="node">
<title>layer8_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2728" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2728" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2728" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2728" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer8_moe_expert1&#45;&gt;layer8_moe_comm_from_expert1 -->
<g id="edge376" class="edge">
<title>layer8_moe_expert1&#45;&gt;layer8_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2588.5,-41109.69C2588.5,-41082.57 2588.5,-41044 2588.5,-41044 2588.5,-41044 2627.29,-41044 2627.29,-41044"/>
<polygon fill="black" stroke="black" points="2627.29,-41047.5 2637.29,-41044 2627.29,-41040.5 2627.29,-41047.5"/>
</g>
<!-- layer8_moe_comm_to_expert1&#45;&gt;layer8_moe_expert1 -->
<g id="edge345" class="edge">
<title>layer8_moe_comm_to_expert1&#45;&gt;layer8_moe_expert1</title>
<path fill="none" stroke="black" d="M2637.47,-41226C2591.09,-41226 2544.25,-41226 2544.25,-41226 2544.25,-41226 2544.25,-41171.84 2544.25,-41171.84"/>
<polygon fill="black" stroke="black" points="2547.75,-41171.84 2544.25,-41161.84 2540.75,-41171.84 2547.75,-41171.84"/>
</g>
<!-- layer8_moe_expert2 -->
<g id="node275" class="node">
<title>layer8_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2944,-41161.73 2616,-41161.73 2616,-41109.73 2944,-41109.73 2944,-41161.73"/>
<text text-anchor="middle" x="2780" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 2 L8</text>
<text text-anchor="middle" x="2780" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2780" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2780" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert2 -->
<g id="node306" class="node">
<title>layer8_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="3074" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3074" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="3074" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3074" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer8_moe_expert2&#45;&gt;layer8_moe_comm_from_expert2 -->
<g id="edge378" class="edge">
<title>layer8_moe_expert2&#45;&gt;layer8_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2934.5,-41109.69C2934.5,-41082.57 2934.5,-41044 2934.5,-41044 2934.5,-41044 2973.29,-41044 2973.29,-41044"/>
<polygon fill="black" stroke="black" points="2973.29,-41047.5 2983.29,-41044 2973.29,-41040.5 2973.29,-41047.5"/>
</g>
<!-- layer8_moe_comm_to_expert2&#45;&gt;layer8_moe_expert2 -->
<g id="edge347" class="edge">
<title>layer8_moe_comm_to_expert2&#45;&gt;layer8_moe_expert2</title>
<path fill="none" stroke="black" d="M2983.15,-41226C2953.12,-41226 2927.25,-41226 2927.25,-41226 2927.25,-41226 2927.25,-41171.84 2927.25,-41171.84"/>
<polygon fill="black" stroke="black" points="2930.75,-41171.84 2927.25,-41161.84 2923.75,-41171.84 2930.75,-41171.84"/>
</g>
<!-- layer8_moe_expert3 -->
<g id="node277" class="node">
<title>layer8_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3290,-41161.73 2962,-41161.73 2962,-41109.73 3290,-41109.73 3290,-41161.73"/>
<text text-anchor="middle" x="3126" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 3 L8</text>
<text text-anchor="middle" x="3126" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3126" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3126" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert3 -->
<g id="node307" class="node">
<title>layer8_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3346" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3346" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3346" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3346" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer8_moe_expert3&#45;&gt;layer8_moe_comm_from_expert3 -->
<g id="edge380" class="edge">
<title>layer8_moe_expert3&#45;&gt;layer8_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3272.75,-41109.41C3272.75,-41109.41 3272.75,-41071.81 3272.75,-41071.81"/>
<polygon fill="black" stroke="black" points="3276.25,-41071.81 3272.75,-41061.81 3269.25,-41071.81 3276.25,-41071.81"/>
</g>
<!-- layer8_moe_comm_to_expert3&#45;&gt;layer8_moe_expert3 -->
<g id="edge349" class="edge">
<title>layer8_moe_comm_to_expert3&#45;&gt;layer8_moe_expert3</title>
<path fill="none" stroke="black" d="M3272.75,-41209.61C3272.75,-41209.61 3272.75,-41172.07 3272.75,-41172.07"/>
<polygon fill="black" stroke="black" points="3276.25,-41172.07 3272.75,-41162.07 3269.25,-41172.07 3276.25,-41172.07"/>
</g>
<!-- layer8_moe_expert4 -->
<g id="node279" class="node">
<title>layer8_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3636,-41161.73 3308,-41161.73 3308,-41109.73 3636,-41109.73 3636,-41161.73"/>
<text text-anchor="middle" x="3472" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 4 L8</text>
<text text-anchor="middle" x="3472" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3472" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3472" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert4 -->
<g id="node308" class="node">
<title>layer8_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3582" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3582" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3582" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3582" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer8_moe_expert4&#45;&gt;layer8_moe_comm_from_expert4 -->
<g id="edge382" class="edge">
<title>layer8_moe_expert4&#45;&gt;layer8_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3563.75,-41109.41C3563.75,-41109.41 3563.75,-41083.22 3563.75,-41083.22"/>
<polygon fill="black" stroke="black" points="3567.25,-41083.22 3563.75,-41073.22 3560.25,-41083.22 3567.25,-41083.22"/>
</g>
<!-- layer8_moe_comm_to_expert4&#45;&gt;layer8_moe_expert4 -->
<g id="edge351" class="edge">
<title>layer8_moe_comm_to_expert4&#45;&gt;layer8_moe_expert4</title>
<path fill="none" stroke="black" d="M3563.75,-41197.93C3563.75,-41197.93 3563.75,-41171.86 3563.75,-41171.86"/>
<polygon fill="black" stroke="black" points="3567.25,-41171.86 3563.75,-41161.86 3560.25,-41171.86 3567.25,-41171.86"/>
</g>
<!-- layer8_moe_expert5 -->
<g id="node281" class="node">
<title>layer8_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3982,-41161.73 3654,-41161.73 3654,-41109.73 3982,-41109.73 3982,-41161.73"/>
<text text-anchor="middle" x="3818" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 5 L8</text>
<text text-anchor="middle" x="3818" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3818" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3818" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert5 -->
<g id="node309" class="node">
<title>layer8_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3965" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3965" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3965" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3965" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer8_moe_expert5&#45;&gt;layer8_moe_comm_from_expert5 -->
<g id="edge384" class="edge">
<title>layer8_moe_expert5&#45;&gt;layer8_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3928.25,-41109.41C3928.25,-41109.41 3928.25,-41081.31 3928.25,-41081.31"/>
<polygon fill="black" stroke="black" points="3931.75,-41081.31 3928.25,-41071.31 3924.75,-41081.31 3931.75,-41081.31"/>
</g>
<!-- layer8_moe_comm_to_expert5&#45;&gt;layer8_moe_expert5 -->
<g id="edge353" class="edge">
<title>layer8_moe_comm_to_expert5&#45;&gt;layer8_moe_expert5</title>
<path fill="none" stroke="black" d="M3910.25,-41197.93C3910.25,-41197.93 3910.25,-41171.86 3910.25,-41171.86"/>
<polygon fill="black" stroke="black" points="3913.75,-41171.86 3910.25,-41161.86 3906.75,-41171.86 3913.75,-41171.86"/>
</g>
<!-- layer8_moe_expert6 -->
<g id="node283" class="node">
<title>layer8_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4328,-41161.73 4000,-41161.73 4000,-41109.73 4328,-41109.73 4328,-41161.73"/>
<text text-anchor="middle" x="4164" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 6 L8</text>
<text text-anchor="middle" x="4164" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4164" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4164" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert6 -->
<g id="node310" class="node">
<title>layer8_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4237" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4237" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4237" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4237" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer8_moe_expert6&#45;&gt;layer8_moe_comm_from_expert6 -->
<g id="edge386" class="edge">
<title>layer8_moe_expert6&#45;&gt;layer8_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4237,-41109.41C4237,-41109.41 4237,-41083.87 4237,-41083.87"/>
<polygon fill="black" stroke="black" points="4240.5,-41083.87 4237,-41073.87 4233.5,-41083.87 4240.5,-41083.87"/>
</g>
<!-- layer8_moe_comm_to_expert6&#45;&gt;layer8_moe_expert6 -->
<g id="edge355" class="edge">
<title>layer8_moe_comm_to_expert6&#45;&gt;layer8_moe_expert6</title>
<path fill="none" stroke="black" d="M4256.25,-41197.93C4256.25,-41197.93 4256.25,-41171.86 4256.25,-41171.86"/>
<polygon fill="black" stroke="black" points="4259.75,-41171.86 4256.25,-41161.86 4252.75,-41171.86 4259.75,-41171.86"/>
</g>
<!-- layer8_moe_expert7 -->
<g id="node285" class="node">
<title>layer8_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4674,-41161.73 4346,-41161.73 4346,-41109.73 4674,-41109.73 4674,-41161.73"/>
<text text-anchor="middle" x="4510" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 7 L8</text>
<text text-anchor="middle" x="4510" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4510" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4510" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert7 -->
<g id="node311" class="node">
<title>layer8_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4547" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4547" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4547" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4547" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer8_moe_expert7&#45;&gt;layer8_moe_comm_from_expert7 -->
<g id="edge388" class="edge">
<title>layer8_moe_expert7&#45;&gt;layer8_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4547,-41109.41C4547,-41109.41 4547,-41083.87 4547,-41083.87"/>
<polygon fill="black" stroke="black" points="4550.5,-41083.87 4547,-41073.87 4543.5,-41083.87 4550.5,-41083.87"/>
</g>
<!-- layer8_moe_comm_to_expert7&#45;&gt;layer8_moe_expert7 -->
<g id="edge357" class="edge">
<title>layer8_moe_comm_to_expert7&#45;&gt;layer8_moe_expert7</title>
<path fill="none" stroke="black" d="M4547,-41197.68C4547,-41197.68 4547,-41172.03 4547,-41172.03"/>
<polygon fill="black" stroke="black" points="4550.5,-41172.03 4547,-41162.03 4543.5,-41172.03 4550.5,-41172.03"/>
</g>
<!-- layer8_moe_expert8 -->
<g id="node287" class="node">
<title>layer8_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="5020,-41161.73 4692,-41161.73 4692,-41109.73 5020,-41109.73 5020,-41161.73"/>
<text text-anchor="middle" x="4856" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 8 L8</text>
<text text-anchor="middle" x="4856" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4856" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4856" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert8 -->
<g id="node312" class="node">
<title>layer8_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4819" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4819" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4819" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4819" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer8_moe_expert8&#45;&gt;layer8_moe_comm_from_expert8 -->
<g id="edge390" class="edge">
<title>layer8_moe_expert8&#45;&gt;layer8_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4819,-41109.41C4819,-41109.41 4819,-41083.87 4819,-41083.87"/>
<polygon fill="black" stroke="black" points="4822.5,-41083.87 4819,-41073.87 4815.5,-41083.87 4822.5,-41083.87"/>
</g>
<!-- layer8_moe_comm_to_expert8&#45;&gt;layer8_moe_expert8 -->
<g id="edge359" class="edge">
<title>layer8_moe_comm_to_expert8&#45;&gt;layer8_moe_expert8</title>
<path fill="none" stroke="black" d="M4819,-41197.68C4819,-41197.68 4819,-41172.03 4819,-41172.03"/>
<polygon fill="black" stroke="black" points="4822.5,-41172.03 4819,-41162.03 4815.5,-41172.03 4822.5,-41172.03"/>
</g>
<!-- layer8_moe_expert9 -->
<g id="node289" class="node">
<title>layer8_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5366,-41161.73 5038,-41161.73 5038,-41109.73 5366,-41109.73 5366,-41161.73"/>
<text text-anchor="middle" x="5202" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 9 L8</text>
<text text-anchor="middle" x="5202" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5202" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5202" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert9 -->
<g id="node313" class="node">
<title>layer8_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5128" cy="-41044.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5128" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5128" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5128" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer8_moe_expert9&#45;&gt;layer8_moe_comm_from_expert9 -->
<g id="edge392" class="edge">
<title>layer8_moe_expert9&#45;&gt;layer8_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5128.25,-41109.41C5128.25,-41109.41 5128.25,-41083.87 5128.25,-41083.87"/>
<polygon fill="black" stroke="black" points="5131.75,-41083.87 5128.25,-41073.87 5124.75,-41083.87 5131.75,-41083.87"/>
</g>
<!-- layer8_moe_comm_to_expert9&#45;&gt;layer8_moe_expert9 -->
<g id="edge361" class="edge">
<title>layer8_moe_comm_to_expert9&#45;&gt;layer8_moe_expert9</title>
<path fill="none" stroke="black" d="M5128.25,-41197.68C5128.25,-41197.68 5128.25,-41172.03 5128.25,-41172.03"/>
<polygon fill="black" stroke="black" points="5131.75,-41172.03 5128.25,-41162.03 5124.75,-41172.03 5131.75,-41172.03"/>
</g>
<!-- layer8_moe_expert10 -->
<g id="node291" class="node">
<title>layer8_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5722,-41161.73 5384,-41161.73 5384,-41109.73 5722,-41109.73 5722,-41161.73"/>
<text text-anchor="middle" x="5553" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 10 L8</text>
<text text-anchor="middle" x="5553" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5553" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5553" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert10 -->
<g id="node314" class="node">
<title>layer8_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5460" cy="-41044.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5460" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5460" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5460" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer8_moe_expert10&#45;&gt;layer8_moe_comm_from_expert10 -->
<g id="edge394" class="edge">
<title>layer8_moe_expert10&#45;&gt;layer8_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5469.38,-41109.41C5469.38,-41109.41 5469.38,-41083.87 5469.38,-41083.87"/>
<polygon fill="black" stroke="black" points="5472.88,-41083.87 5469.38,-41073.87 5465.88,-41083.87 5472.88,-41083.87"/>
</g>
<!-- layer8_moe_comm_to_expert10&#45;&gt;layer8_moe_expert10 -->
<g id="edge363" class="edge">
<title>layer8_moe_comm_to_expert10&#45;&gt;layer8_moe_expert10</title>
<path fill="none" stroke="black" d="M5469.02,-41197.68C5469.02,-41197.68 5469.02,-41172.03 5469.02,-41172.03"/>
<polygon fill="black" stroke="black" points="5472.52,-41172.03 5469.02,-41162.03 5465.52,-41172.03 5472.52,-41172.03"/>
</g>
<!-- layer8_moe_expert11 -->
<g id="node293" class="node">
<title>layer8_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6078,-41161.73 5740,-41161.73 5740,-41109.73 6078,-41109.73 6078,-41161.73"/>
<text text-anchor="middle" x="5909" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 11 L8</text>
<text text-anchor="middle" x="5909" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5909" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5909" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert11 -->
<g id="node315" class="node">
<title>layer8_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5807" cy="-41044.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5807" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5807" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5807" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer8_moe_expert11&#45;&gt;layer8_moe_comm_from_expert11 -->
<g id="edge396" class="edge">
<title>layer8_moe_expert11&#45;&gt;layer8_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5820.88,-41109.41C5820.88,-41109.41 5820.88,-41083.54 5820.88,-41083.54"/>
<polygon fill="black" stroke="black" points="5824.38,-41083.54 5820.88,-41073.54 5817.38,-41083.54 5824.38,-41083.54"/>
</g>
<!-- layer8_moe_comm_to_expert11&#45;&gt;layer8_moe_expert11 -->
<g id="edge365" class="edge">
<title>layer8_moe_comm_to_expert11&#45;&gt;layer8_moe_expert11</title>
<path fill="none" stroke="black" d="M5820.02,-41197.93C5820.02,-41197.93 5820.02,-41171.86 5820.02,-41171.86"/>
<polygon fill="black" stroke="black" points="5823.52,-41171.86 5820.02,-41161.86 5816.52,-41171.86 5823.52,-41171.86"/>
</g>
<!-- layer8_moe_expert12 -->
<g id="node295" class="node">
<title>layer8_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6434,-41161.73 6096,-41161.73 6096,-41109.73 6434,-41109.73 6434,-41161.73"/>
<text text-anchor="middle" x="6265" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 12 L8</text>
<text text-anchor="middle" x="6265" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6265" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6265" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert12 -->
<g id="node316" class="node">
<title>layer8_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6158" cy="-41044.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6158" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6158" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6158" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer8_moe_expert12&#45;&gt;layer8_moe_comm_from_expert12 -->
<g id="edge398" class="edge">
<title>layer8_moe_expert12&#45;&gt;layer8_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6174.38,-41109.41C6174.38,-41109.41 6174.38,-41083.54 6174.38,-41083.54"/>
<polygon fill="black" stroke="black" points="6177.88,-41083.54 6174.38,-41073.54 6170.88,-41083.54 6177.88,-41083.54"/>
</g>
<!-- layer8_moe_comm_to_expert12&#45;&gt;layer8_moe_expert12 -->
<g id="edge367" class="edge">
<title>layer8_moe_comm_to_expert12&#45;&gt;layer8_moe_expert12</title>
<path fill="none" stroke="black" d="M6173.52,-41197.93C6173.52,-41197.93 6173.52,-41171.86 6173.52,-41171.86"/>
<polygon fill="black" stroke="black" points="6177.02,-41171.86 6173.52,-41161.86 6170.02,-41171.86 6177.02,-41171.86"/>
</g>
<!-- layer8_moe_expert13 -->
<g id="node297" class="node">
<title>layer8_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6790,-41161.73 6452,-41161.73 6452,-41109.73 6790,-41109.73 6790,-41161.73"/>
<text text-anchor="middle" x="6621" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 13 L8</text>
<text text-anchor="middle" x="6621" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6621" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6621" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert13 -->
<g id="node317" class="node">
<title>layer8_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6512" cy="-41044.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6512" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6512" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6512" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer8_moe_expert13&#45;&gt;layer8_moe_comm_from_expert13 -->
<g id="edge400" class="edge">
<title>layer8_moe_expert13&#45;&gt;layer8_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6529.38,-41109.41C6529.38,-41109.41 6529.38,-41083.54 6529.38,-41083.54"/>
<polygon fill="black" stroke="black" points="6532.88,-41083.54 6529.38,-41073.54 6525.88,-41083.54 6532.88,-41083.54"/>
</g>
<!-- layer8_moe_comm_to_expert13&#45;&gt;layer8_moe_expert13 -->
<g id="edge369" class="edge">
<title>layer8_moe_comm_to_expert13&#45;&gt;layer8_moe_expert13</title>
<path fill="none" stroke="black" d="M6528.02,-41197.93C6528.02,-41197.93 6528.02,-41171.86 6528.02,-41171.86"/>
<polygon fill="black" stroke="black" points="6531.52,-41171.86 6528.02,-41161.86 6524.52,-41171.86 6531.52,-41171.86"/>
</g>
<!-- layer8_moe_expert14 -->
<g id="node299" class="node">
<title>layer8_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7146,-41161.73 6808,-41161.73 6808,-41109.73 7146,-41109.73 7146,-41161.73"/>
<text text-anchor="middle" x="6977" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 14 L8</text>
<text text-anchor="middle" x="6977" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6977" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6977" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert14 -->
<g id="node318" class="node">
<title>layer8_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6867" cy="-41044.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6867" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6867" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6867" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer8_moe_expert14&#45;&gt;layer8_moe_comm_from_expert14 -->
<g id="edge402" class="edge">
<title>layer8_moe_expert14&#45;&gt;layer8_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6884.88,-41109.41C6884.88,-41109.41 6884.88,-41083.22 6884.88,-41083.22"/>
<polygon fill="black" stroke="black" points="6888.38,-41083.22 6884.88,-41073.22 6881.38,-41083.22 6888.38,-41083.22"/>
</g>
<!-- layer8_moe_comm_to_expert14&#45;&gt;layer8_moe_expert14 -->
<g id="edge371" class="edge">
<title>layer8_moe_comm_to_expert14&#45;&gt;layer8_moe_expert14</title>
<path fill="none" stroke="black" d="M6883.52,-41197.93C6883.52,-41197.93 6883.52,-41171.86 6883.52,-41171.86"/>
<polygon fill="black" stroke="black" points="6887.02,-41171.86 6883.52,-41161.86 6880.02,-41171.86 6887.02,-41171.86"/>
</g>
<!-- layer8_moe_expert15 -->
<g id="node301" class="node">
<title>layer8_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7502,-41161.73 7164,-41161.73 7164,-41109.73 7502,-41109.73 7502,-41161.73"/>
<text text-anchor="middle" x="7333" y="-41149.73" font-family="Arial" font-size="10.00">EXPERT 15 L8</text>
<text text-anchor="middle" x="7333" y="-41138.73" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7333" y="-41127.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7333" y="-41116.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_comm_from_expert15 -->
<g id="node319" class="node">
<title>layer8_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7222" cy="-41044.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7222" y="-41053.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7222" y="-41042.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7222" y="-41031.24" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer8_moe_expert15&#45;&gt;layer8_moe_comm_from_expert15 -->
<g id="edge404" class="edge">
<title>layer8_moe_expert15&#45;&gt;layer8_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7240.38,-41109.41C7240.38,-41109.41 7240.38,-41083.22 7240.38,-41083.22"/>
<polygon fill="black" stroke="black" points="7243.88,-41083.22 7240.38,-41073.22 7236.88,-41083.22 7243.88,-41083.22"/>
</g>
<!-- layer8_moe_comm_to_expert15&#45;&gt;layer8_moe_expert15 -->
<g id="edge373" class="edge">
<title>layer8_moe_comm_to_expert15&#45;&gt;layer8_moe_expert15</title>
<path fill="none" stroke="black" d="M7239.02,-41197.93C7239.02,-41197.93 7239.02,-41171.86 7239.02,-41171.86"/>
<polygon fill="black" stroke="black" points="7242.52,-41171.86 7239.02,-41161.86 7235.52,-41171.86 7242.52,-41171.86"/>
</g>
<!-- layer8_moe_aggregate -->
<g id="node303" class="node">
<title>layer8_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4908.1,-40979.75 4491.16,-40979.75 4383.9,-40875.75 4800.84,-40875.75 4908.1,-40979.75"/>
<text text-anchor="middle" x="4646" y="-40941.75" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L8</text>
<text text-anchor="middle" x="4646" y="-40930.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4646" y="-40919.75" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4646" y="-40908.75" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_mha -->
<g id="node320" class="node">
<title>layer9_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4776,-40839.75 4516,-40839.75 4516,-40787.75 4776,-40787.75 4776,-40839.75"/>
<text text-anchor="middle" x="4646" y="-40827.75" font-family="Arial" font-size="10.00">MHA L9</text>
<text text-anchor="middle" x="4646" y="-40816.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4646" y="-40805.75" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4646" y="-40794.75" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer8_moe_aggregate&#45;&gt;layer9_moe_mha -->
<g id="edge473" class="edge">
<title>layer8_moe_aggregate&#45;&gt;layer9_moe_mha</title>
<path fill="none" stroke="black" d="M4646,-40875.42C4646,-40875.42 4646,-40849.97 4646,-40849.97"/>
<polygon fill="black" stroke="black" points="4649.5,-40849.97 4646,-40839.97 4642.5,-40849.97 4649.5,-40849.97"/>
</g>
<!-- layer8_moe_comm_from_expert0&#45;&gt;layer8_moe_aggregate -->
<g id="edge375" class="edge">
<title>layer8_moe_comm_from_expert0&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M2307.01,-41026.99C2307.01,-40986.34 2307.01,-40890 2307.01,-40890 2307.01,-40890 4388.45,-40890 4388.45,-40890"/>
<polygon fill="black" stroke="black" points="4388.45,-40893.5 4398.45,-40890 4388.45,-40886.5 4388.45,-40893.5"/>
</g>
<!-- layer8_moe_comm_from_expert1&#45;&gt;layer8_moe_aggregate -->
<g id="edge377" class="edge">
<title>layer8_moe_comm_from_expert1&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M2800.01,-41027.04C2800.01,-40989.44 2800.01,-40905 2800.01,-40905 2800.01,-40905 4403.61,-40905 4403.61,-40905"/>
<polygon fill="black" stroke="black" points="4403.61,-40908.5 4413.61,-40905 4403.61,-40901.5 4403.61,-40908.5"/>
</g>
<!-- layer8_moe_comm_from_expert2&#45;&gt;layer8_moe_aggregate -->
<g id="edge379" class="edge">
<title>layer8_moe_comm_from_expert2&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M3146.01,-41027.13C3146.01,-40992.75 3146.01,-40920 3146.01,-40920 3146.01,-40920 4419.49,-40920 4419.49,-40920"/>
<polygon fill="black" stroke="black" points="4419.49,-40923.5 4429.49,-40920 4419.49,-40916.5 4419.49,-40923.5"/>
</g>
<!-- layer8_moe_comm_from_expert3&#45;&gt;layer8_moe_aggregate -->
<g id="edge381" class="edge">
<title>layer8_moe_comm_from_expert3&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M3418.01,-41027.11C3418.01,-40996.09 3418.01,-40935 3418.01,-40935 3418.01,-40935 4434.94,-40935 4434.94,-40935"/>
<polygon fill="black" stroke="black" points="4434.94,-40938.5 4444.94,-40935 4434.94,-40931.5 4434.94,-40938.5"/>
</g>
<!-- layer8_moe_comm_from_expert4&#45;&gt;layer8_moe_aggregate -->
<g id="edge383" class="edge">
<title>layer8_moe_comm_from_expert4&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M3654.01,-41026.92C3654.01,-40999.47 3654.01,-40950 3654.01,-40950 3654.01,-40950 4450.29,-40950 4450.29,-40950"/>
<polygon fill="black" stroke="black" points="4450.29,-40953.5 4460.29,-40950 4450.29,-40946.5 4450.29,-40953.5"/>
</g>
<!-- layer8_moe_comm_from_expert5&#45;&gt;layer8_moe_aggregate -->
<g id="edge385" class="edge">
<title>layer8_moe_comm_from_expert5&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M4019.01,-41021.38C4019.01,-40997.54 4019.01,-40964 4019.01,-40964 4019.01,-40964 4464.67,-40964 4464.67,-40964"/>
<polygon fill="black" stroke="black" points="4464.67,-40967.5 4474.67,-40964 4464.67,-40960.5 4464.67,-40967.5"/>
</g>
<!-- layer8_moe_comm_from_expert6&#45;&gt;layer8_moe_aggregate -->
<g id="edge387" class="edge">
<title>layer8_moe_comm_from_expert6&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M4327.74,-41044C4373.78,-41044 4420.1,-41044 4420.1,-41044 4420.1,-41044 4420.1,-40937.83 4420.1,-40937.83"/>
<polygon fill="black" stroke="black" points="4423.6,-40937.83 4420.1,-40927.83 4416.6,-40937.83 4423.6,-40937.83"/>
</g>
<!-- layer8_moe_comm_from_expert7&#45;&gt;layer8_moe_aggregate -->
<g id="edge389" class="edge">
<title>layer8_moe_comm_from_expert7&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M4547,-41015.52C4547,-41015.52 4547,-40989.81 4547,-40989.81"/>
<polygon fill="black" stroke="black" points="4550.5,-40989.81 4547,-40979.81 4543.5,-40989.81 4550.5,-40989.81"/>
</g>
<!-- layer8_moe_comm_from_expert8&#45;&gt;layer8_moe_aggregate -->
<g id="edge391" class="edge">
<title>layer8_moe_comm_from_expert8&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M4818.39,-41015.52C4818.39,-41015.52 4818.39,-40989.81 4818.39,-40989.81"/>
<polygon fill="black" stroke="black" points="4821.89,-40989.81 4818.39,-40979.81 4814.89,-40989.81 4821.89,-40989.81"/>
</g>
<!-- layer8_moe_comm_from_expert9&#45;&gt;layer8_moe_aggregate -->
<g id="edge393" class="edge">
<title>layer8_moe_comm_from_expert9&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M5109.5,-41016.31C5109.5,-40993.76 5109.5,-40966 5109.5,-40966 5109.5,-40966 4904.03,-40966 4904.03,-40966"/>
<polygon fill="black" stroke="black" points="4904.03,-40962.5 4894.03,-40966 4904.03,-40969.5 4904.03,-40962.5"/>
</g>
<!-- layer8_moe_comm_from_expert10&#45;&gt;layer8_moe_aggregate -->
<g id="edge395" class="edge">
<title>layer8_moe_comm_from_expert10&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M5441.15,-41016.21C5441.15,-40989.28 5441.15,-40953 5441.15,-40953 5441.15,-40953 4890.54,-40953 4890.54,-40953"/>
<polygon fill="black" stroke="black" points="4890.54,-40949.5 4880.54,-40953 4890.54,-40956.5 4890.54,-40949.5"/>
</g>
<!-- layer8_moe_comm_from_expert11&#45;&gt;layer8_moe_aggregate -->
<g id="edge397" class="edge">
<title>layer8_moe_comm_from_expert11&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M5787.65,-41016.12C5787.65,-40985.11 5787.65,-40940 5787.65,-40940 5787.65,-40940 4877.14,-40940 4877.14,-40940"/>
<polygon fill="black" stroke="black" points="4877.14,-40936.5 4867.14,-40940 4877.14,-40943.5 4877.14,-40936.5"/>
</g>
<!-- layer8_moe_comm_from_expert12&#45;&gt;layer8_moe_aggregate -->
<g id="edge399" class="edge">
<title>layer8_moe_comm_from_expert12&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M6138.65,-41016.24C6138.65,-40981.39 6138.65,-40927 6138.65,-40927 6138.65,-40927 4863.94,-40927 4863.94,-40927"/>
<polygon fill="black" stroke="black" points="4863.94,-40923.5 4853.94,-40927 4863.94,-40930.5 4863.94,-40923.5"/>
</g>
<!-- layer8_moe_comm_from_expert13&#45;&gt;layer8_moe_aggregate -->
<g id="edge401" class="edge">
<title>layer8_moe_comm_from_expert13&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M6492.15,-41016.37C6492.15,-40977.92 6492.15,-40914 6492.15,-40914 6492.15,-40914 4850.52,-40914 4850.52,-40914"/>
<polygon fill="black" stroke="black" points="4850.52,-40910.5 4840.52,-40914 4850.52,-40917.5 4850.52,-40910.5"/>
</g>
<!-- layer8_moe_comm_from_expert14&#45;&gt;layer8_moe_aggregate -->
<g id="edge403" class="edge">
<title>layer8_moe_comm_from_expert14&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M6847.15,-41016.34C6847.15,-40974.45 6847.15,-40901 6847.15,-40901 6847.15,-40901 4837.06,-40901 4837.06,-40901"/>
<polygon fill="black" stroke="black" points="4837.06,-40897.5 4827.06,-40901 4837.06,-40904.5 4837.06,-40897.5"/>
</g>
<!-- layer8_moe_comm_from_expert15&#45;&gt;layer8_moe_aggregate -->
<g id="edge405" class="edge">
<title>layer8_moe_comm_from_expert15&#45;&gt;layer8_moe_aggregate</title>
<path fill="none" stroke="black" d="M7202.15,-41016.35C7202.15,-40971.19 7202.15,-40888 7202.15,-40888 7202.15,-40888 4823.72,-40888 4823.72,-40888"/>
<polygon fill="black" stroke="black" points="4823.72,-40884.5 4813.72,-40888 4823.72,-40891.5 4823.72,-40884.5"/>
</g>
<!-- layer9_moe_gate -->
<g id="node321" class="node">
<title>layer9_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4904.3,-40751.75 4493.4,-40751.75 4387.7,-40647.75 4798.6,-40647.75 4904.3,-40751.75"/>
<text text-anchor="middle" x="4646" y="-40713.75" font-family="Arial" font-size="10.00">GATE L9</text>
<text text-anchor="middle" x="4646" y="-40702.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4646" y="-40691.75" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4646" y="-40680.75" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer9_moe_mha&#45;&gt;layer9_moe_gate -->
<g id="edge474" class="edge">
<title>layer9_moe_mha&#45;&gt;layer9_moe_gate</title>
<path fill="none" stroke="black" d="M4646,-40787.59C4646,-40787.59 4646,-40761.84 4646,-40761.84"/>
<polygon fill="black" stroke="black" points="4649.5,-40761.84 4646,-40751.84 4642.5,-40761.84 4649.5,-40761.84"/>
</g>
<!-- layer9_moe_split -->
<g id="node322" class="node">
<title>layer9_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4900.01,-40611.75 4495.94,-40611.75 4391.99,-40507.75 4796.06,-40507.75 4900.01,-40611.75"/>
<text text-anchor="middle" x="4646" y="-40573.75" font-family="Arial" font-size="10.00">SPLIT TOKENS L9</text>
<text text-anchor="middle" x="4646" y="-40562.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4646" y="-40551.75" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4646" y="-40540.75" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer9_moe_gate&#45;&gt;layer9_moe_split -->
<g id="edge475" class="edge">
<title>layer9_moe_gate&#45;&gt;layer9_moe_split</title>
<path fill="none" stroke="black" d="M4646,-40647.61C4646,-40647.61 4646,-40621.92 4646,-40621.92"/>
<polygon fill="black" stroke="black" points="4649.5,-40621.92 4646,-40611.92 4642.5,-40621.92 4649.5,-40621.92"/>
</g>
<!-- layer9_moe_comm_to_expert0 -->
<g id="node324" class="node">
<title>layer9_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2198" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2198" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2198" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2198" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert0 -->
<g id="edge409" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4479.97,-40596C3932.11,-40596 2216.5,-40596 2216.5,-40596 2216.5,-40596 2216.5,-40481.22 2216.5,-40481.22"/>
<polygon fill="black" stroke="black" points="2220,-40481.22 2216.5,-40471.22 2213,-40481.22 2220,-40481.22"/>
</g>
<!-- layer9_moe_comm_to_expert1 -->
<g id="node326" class="node">
<title>layer9_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2691" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2691" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2691" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2691" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert1 -->
<g id="edge411" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4465.99,-40582C3985.59,-40582 2709.5,-40582 2709.5,-40582 2709.5,-40582 2709.5,-40481.27 2709.5,-40481.27"/>
<polygon fill="black" stroke="black" points="2713,-40481.27 2709.5,-40471.27 2706,-40481.27 2713,-40481.27"/>
</g>
<!-- layer9_moe_comm_to_expert2 -->
<g id="node328" class="node">
<title>layer9_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3037" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3037" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3037" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3037" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert2 -->
<g id="edge413" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4450.97,-40567C4026.26,-40567 3055.5,-40567 3055.5,-40567 3055.5,-40567 3055.5,-40481.26 3055.5,-40481.26"/>
<polygon fill="black" stroke="black" points="3059,-40481.26 3055.5,-40471.26 3052,-40481.26 3059,-40481.26"/>
</g>
<!-- layer9_moe_comm_to_expert3 -->
<g id="node330" class="node">
<title>layer9_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3309" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3309" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3309" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3309" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert3 -->
<g id="edge415" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4435.99,-40552C4063.85,-40552 3327.5,-40552 3327.5,-40552 3327.5,-40552 3327.5,-40481.17 3327.5,-40481.17"/>
<polygon fill="black" stroke="black" points="3331,-40481.17 3327.5,-40471.17 3324,-40481.17 3331,-40481.17"/>
</g>
<!-- layer9_moe_comm_to_expert4 -->
<g id="node332" class="node">
<title>layer9_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3545" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3545" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3545" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3545" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert4 -->
<g id="edge417" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4421.05,-40537C4103.89,-40537 3563.5,-40537 3563.5,-40537 3563.5,-40537 3563.5,-40481.29 3563.5,-40481.29"/>
<polygon fill="black" stroke="black" points="3567,-40481.29 3563.5,-40471.29 3560,-40481.29 3567,-40481.29"/>
</g>
<!-- layer9_moe_comm_to_expert5 -->
<g id="node334" class="node">
<title>layer9_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3892" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3892" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3892" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3892" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert5 -->
<g id="edge419" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4406.09,-40522C4197.5,-40522 3928.5,-40522 3928.5,-40522 3928.5,-40522 3928.5,-40479.58 3928.5,-40479.58"/>
<polygon fill="black" stroke="black" points="3932,-40479.58 3928.5,-40469.58 3925,-40479.58 3932,-40479.58"/>
</g>
<!-- layer9_moe_comm_to_expert6 -->
<g id="node336" class="node">
<title>layer9_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4238" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4238" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4238" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4238" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert6 -->
<g id="edge421" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4405.74,-40559.66C4405.74,-40556.09 4405.74,-40442 4405.74,-40442 4405.74,-40442 4338.74,-40442 4338.74,-40442"/>
<polygon fill="black" stroke="black" points="4338.74,-40438.5 4328.74,-40442 4338.74,-40445.5 4338.74,-40438.5"/>
</g>
<!-- layer9_moe_comm_to_expert7 -->
<g id="node338" class="node">
<title>layer9_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4510" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4510" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4510" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4510" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert7 -->
<g id="edge423" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4510,-40507.41C4510,-40507.41 4510,-40481.97 4510,-40481.97"/>
<polygon fill="black" stroke="black" points="4513.5,-40481.96 4510,-40471.97 4506.5,-40481.97 4513.5,-40481.96"/>
</g>
<!-- layer9_moe_comm_to_expert8 -->
<g id="node340" class="node">
<title>layer9_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4782" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4782" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4782" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4782" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert8 -->
<g id="edge425" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4782,-40507.41C4782,-40507.41 4782,-40481.97 4782,-40481.97"/>
<polygon fill="black" stroke="black" points="4785.5,-40481.96 4782,-40471.97 4778.5,-40481.97 4785.5,-40481.96"/>
</g>
<!-- layer9_moe_comm_to_expert9 -->
<g id="node342" class="node">
<title>layer9_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5091" cy="-40442.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5091" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5091" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5091" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert9 -->
<g id="edge427" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4886.26,-40559.66C4886.26,-40556.09 4886.26,-40442 4886.26,-40442 4886.26,-40442 4990.3,-40442 4990.3,-40442"/>
<polygon fill="black" stroke="black" points="4990.3,-40445.5 5000.3,-40442 4990.3,-40438.5 4990.3,-40445.5"/>
</g>
<!-- layer9_moe_comm_to_expert10 -->
<g id="node344" class="node">
<title>layer9_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5423" cy="-40442.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5423" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5423" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5423" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert10 -->
<g id="edge429" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4810.38,-40522C5017.6,-40522 5347.1,-40522 5347.1,-40522 5347.1,-40522 5347.1,-40469.95 5347.1,-40469.95"/>
<polygon fill="black" stroke="black" points="5350.6,-40469.95 5347.1,-40459.95 5343.6,-40469.95 5350.6,-40469.95"/>
</g>
<!-- layer9_moe_comm_to_expert11 -->
<g id="node346" class="node">
<title>layer9_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5769" cy="-40442.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5769" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5769" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5769" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert11 -->
<g id="edge431" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4825.49,-40537C5124.86,-40537 5693.6,-40537 5693.6,-40537 5693.6,-40537 5693.6,-40470.48 5693.6,-40470.48"/>
<polygon fill="black" stroke="black" points="5697.1,-40470.48 5693.6,-40460.48 5690.1,-40470.48 5697.1,-40470.48"/>
</g>
<!-- layer9_moe_comm_to_expert12 -->
<g id="node348" class="node">
<title>layer9_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6120" cy="-40442.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6120" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6120" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6120" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert12 -->
<g id="edge433" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4840.47,-40552C5224.77,-40552 6044.6,-40552 6044.6,-40552 6044.6,-40552 6044.6,-40470.31 6044.6,-40470.31"/>
<polygon fill="black" stroke="black" points="6048.1,-40470.31 6044.6,-40460.31 6041.1,-40470.31 6048.1,-40470.31"/>
</g>
<!-- layer9_moe_comm_to_expert13 -->
<g id="node350" class="node">
<title>layer9_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6473" cy="-40442.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6473" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6473" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6473" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert13 -->
<g id="edge435" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4855.6,-40567C5320.67,-40567 6398.1,-40567 6398.1,-40567 6398.1,-40567 6398.1,-40470.29 6398.1,-40470.29"/>
<polygon fill="black" stroke="black" points="6401.6,-40470.29 6398.1,-40460.29 6394.6,-40470.29 6401.6,-40470.29"/>
</g>
<!-- layer9_moe_comm_to_expert14 -->
<g id="node352" class="node">
<title>layer9_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6828" cy="-40442.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6828" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6828" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6828" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert14 -->
<g id="edge437" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4870.5,-40582C5413.43,-40582 6753.1,-40582 6753.1,-40582 6753.1,-40582 6753.1,-40470.39 6753.1,-40470.39"/>
<polygon fill="black" stroke="black" points="6756.6,-40470.39 6753.1,-40460.39 6749.6,-40470.39 6756.6,-40470.39"/>
</g>
<!-- layer9_moe_comm_to_expert15 -->
<g id="node354" class="node">
<title>layer9_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7183" cy="-40442.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7183" y="-40451.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7183" y="-40440.25" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7183" y="-40429.25" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert15 -->
<g id="edge439" class="edge">
<title>layer9_moe_split&#45;&gt;layer9_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4884.31,-40596C5502.21,-40596 7108.1,-40596 7108.1,-40596 7108.1,-40596 7108.1,-40470.33 7108.1,-40470.33"/>
<polygon fill="black" stroke="black" points="7111.6,-40470.33 7108.1,-40460.33 7104.6,-40470.33 7111.6,-40470.33"/>
</g>
<!-- layer9_moe_expert0 -->
<g id="node323" class="node">
<title>layer9_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2215,-40377.76 1887,-40377.76 1887,-40325.76 2215,-40325.76 2215,-40377.76"/>
<text text-anchor="middle" x="2051" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 0 L9</text>
<text text-anchor="middle" x="2051" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2051" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2051" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert0 -->
<g id="node356" class="node">
<title>layer9_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2198" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2198" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2198" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2198" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer9_moe_expert0&#45;&gt;layer9_moe_comm_from_expert0 -->
<g id="edge441" class="edge">
<title>layer9_moe_expert0&#45;&gt;layer9_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2161.25,-40325.44C2161.25,-40325.44 2161.25,-40297.35 2161.25,-40297.35"/>
<polygon fill="black" stroke="black" points="2164.75,-40297.35 2161.25,-40287.35 2157.75,-40297.35 2164.75,-40297.35"/>
</g>
<!-- layer9_moe_comm_to_expert0&#45;&gt;layer9_moe_expert0 -->
<g id="edge410" class="edge">
<title>layer9_moe_comm_to_expert0&#45;&gt;layer9_moe_expert0</title>
<path fill="none" stroke="black" d="M2161.25,-40415.95C2161.25,-40415.95 2161.25,-40388.07 2161.25,-40388.07"/>
<polygon fill="black" stroke="black" points="2164.75,-40388.07 2161.25,-40378.07 2157.75,-40388.07 2164.75,-40388.07"/>
</g>
<!-- layer9_moe_expert1 -->
<g id="node325" class="node">
<title>layer9_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2561,-40377.76 2233,-40377.76 2233,-40325.76 2561,-40325.76 2561,-40377.76"/>
<text text-anchor="middle" x="2397" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 1 L9</text>
<text text-anchor="middle" x="2397" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2397" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2397" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert1 -->
<g id="node357" class="node">
<title>layer9_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2470" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2470" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2470" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2470" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer9_moe_expert1&#45;&gt;layer9_moe_comm_from_expert1 -->
<g id="edge443" class="edge">
<title>layer9_moe_expert1&#45;&gt;layer9_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2470,-40325.44C2470,-40325.44 2470,-40299.9 2470,-40299.9"/>
<polygon fill="black" stroke="black" points="2473.5,-40299.9 2470,-40289.9 2466.5,-40299.9 2473.5,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert1&#45;&gt;layer9_moe_expert1 -->
<g id="edge412" class="edge">
<title>layer9_moe_comm_to_expert1&#45;&gt;layer9_moe_expert1</title>
<path fill="none" stroke="black" d="M2600.51,-40442C2529.73,-40442 2443.25,-40442 2443.25,-40442 2443.25,-40442 2443.25,-40387.86 2443.25,-40387.86"/>
<polygon fill="black" stroke="black" points="2446.75,-40387.86 2443.25,-40377.86 2439.75,-40387.86 2446.75,-40387.86"/>
</g>
<!-- layer9_moe_expert2 -->
<g id="node327" class="node">
<title>layer9_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2907,-40377.76 2579,-40377.76 2579,-40325.76 2907,-40325.76 2907,-40377.76"/>
<text text-anchor="middle" x="2743" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 2 L9</text>
<text text-anchor="middle" x="2743" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2743" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2743" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert2 -->
<g id="node358" class="node">
<title>layer9_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2835" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2835" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2835" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2835" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer9_moe_expert2&#45;&gt;layer9_moe_comm_from_expert2 -->
<g id="edge445" class="edge">
<title>layer9_moe_expert2&#45;&gt;layer9_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2825.75,-40325.44C2825.75,-40325.44 2825.75,-40299.9 2825.75,-40299.9"/>
<polygon fill="black" stroke="black" points="2829.25,-40299.9 2825.75,-40289.9 2822.25,-40299.9 2829.25,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert2&#45;&gt;layer9_moe_expert2 -->
<g id="edge414" class="edge">
<title>layer9_moe_comm_to_expert2&#45;&gt;layer9_moe_expert2</title>
<path fill="none" stroke="black" d="M2946.3,-40442C2903.97,-40442 2862.75,-40442 2862.75,-40442 2862.75,-40442 2862.75,-40387.86 2862.75,-40387.86"/>
<polygon fill="black" stroke="black" points="2866.25,-40387.86 2862.75,-40377.86 2859.25,-40387.86 2866.25,-40387.86"/>
</g>
<!-- layer9_moe_expert3 -->
<g id="node329" class="node">
<title>layer9_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3253,-40377.76 2925,-40377.76 2925,-40325.76 3253,-40325.76 3253,-40377.76"/>
<text text-anchor="middle" x="3089" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 3 L9</text>
<text text-anchor="middle" x="3089" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3089" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3089" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert3 -->
<g id="node359" class="node">
<title>layer9_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3163" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3163" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3163" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3163" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer9_moe_expert3&#45;&gt;layer9_moe_comm_from_expert3 -->
<g id="edge447" class="edge">
<title>layer9_moe_expert3&#45;&gt;layer9_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3162.75,-40325.44C3162.75,-40325.44 3162.75,-40299.9 3162.75,-40299.9"/>
<polygon fill="black" stroke="black" points="3166.25,-40299.9 3162.75,-40289.9 3159.25,-40299.9 3166.25,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert3&#45;&gt;layer9_moe_expert3 -->
<g id="edge416" class="edge">
<title>layer9_moe_comm_to_expert3&#45;&gt;layer9_moe_expert3</title>
<path fill="none" stroke="black" d="M3235.75,-40425.64C3235.75,-40425.64 3235.75,-40388.11 3235.75,-40388.11"/>
<polygon fill="black" stroke="black" points="3239.25,-40388.11 3235.75,-40378.11 3232.25,-40388.11 3239.25,-40388.11"/>
</g>
<!-- layer9_moe_expert4 -->
<g id="node331" class="node">
<title>layer9_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3599,-40377.76 3271,-40377.76 3271,-40325.76 3599,-40325.76 3599,-40377.76"/>
<text text-anchor="middle" x="3435" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 4 L9</text>
<text text-anchor="middle" x="3435" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3435" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3435" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert4 -->
<g id="node360" class="node">
<title>layer9_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3656" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3656" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3656" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3656" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer9_moe_expert4&#45;&gt;layer9_moe_comm_from_expert4 -->
<g id="edge449" class="edge">
<title>layer9_moe_expert4&#45;&gt;layer9_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3582.25,-40325.44C3582.25,-40325.44 3582.25,-40287.84 3582.25,-40287.84"/>
<polygon fill="black" stroke="black" points="3585.75,-40287.84 3582.25,-40277.84 3578.75,-40287.84 3585.75,-40287.84"/>
</g>
<!-- layer9_moe_comm_to_expert4&#45;&gt;layer9_moe_expert4 -->
<g id="edge418" class="edge">
<title>layer9_moe_comm_to_expert4&#45;&gt;layer9_moe_expert4</title>
<path fill="none" stroke="black" d="M3526.75,-40413.96C3526.75,-40413.96 3526.75,-40387.9 3526.75,-40387.9"/>
<polygon fill="black" stroke="black" points="3530.25,-40387.9 3526.75,-40377.9 3523.25,-40387.9 3530.25,-40387.9"/>
</g>
<!-- layer9_moe_expert5 -->
<g id="node333" class="node">
<title>layer9_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3945,-40377.76 3617,-40377.76 3617,-40325.76 3945,-40325.76 3945,-40377.76"/>
<text text-anchor="middle" x="3781" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 5 L9</text>
<text text-anchor="middle" x="3781" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3781" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3781" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert5 -->
<g id="node361" class="node">
<title>layer9_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="4002" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4002" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="4002" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4002" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer9_moe_expert5&#45;&gt;layer9_moe_comm_from_expert5 -->
<g id="edge451" class="edge">
<title>layer9_moe_expert5&#45;&gt;layer9_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3928.25,-40325.44C3928.25,-40325.44 3928.25,-40287.84 3928.25,-40287.84"/>
<polygon fill="black" stroke="black" points="3931.75,-40287.84 3928.25,-40277.84 3924.75,-40287.84 3931.75,-40287.84"/>
</g>
<!-- layer9_moe_comm_to_expert5&#45;&gt;layer9_moe_expert5 -->
<g id="edge420" class="edge">
<title>layer9_moe_comm_to_expert5&#45;&gt;layer9_moe_expert5</title>
<path fill="none" stroke="black" d="M3873.25,-40413.96C3873.25,-40413.96 3873.25,-40387.9 3873.25,-40387.9"/>
<polygon fill="black" stroke="black" points="3876.75,-40387.9 3873.25,-40377.9 3869.75,-40387.9 3876.75,-40387.9"/>
</g>
<!-- layer9_moe_expert6 -->
<g id="node335" class="node">
<title>layer9_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4291,-40377.76 3963,-40377.76 3963,-40325.76 4291,-40325.76 4291,-40377.76"/>
<text text-anchor="middle" x="4127" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 6 L9</text>
<text text-anchor="middle" x="4127" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4127" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4127" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert6 -->
<g id="node362" class="node">
<title>layer9_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4274" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4274" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4274" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4274" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer9_moe_expert6&#45;&gt;layer9_moe_comm_from_expert6 -->
<g id="edge453" class="edge">
<title>layer9_moe_expert6&#45;&gt;layer9_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4237.25,-40325.44C4237.25,-40325.44 4237.25,-40297.35 4237.25,-40297.35"/>
<polygon fill="black" stroke="black" points="4240.75,-40297.35 4237.25,-40287.35 4233.75,-40297.35 4240.75,-40297.35"/>
</g>
<!-- layer9_moe_comm_to_expert6&#45;&gt;layer9_moe_expert6 -->
<g id="edge422" class="edge">
<title>layer9_moe_comm_to_expert6&#45;&gt;layer9_moe_expert6</title>
<path fill="none" stroke="black" d="M4219.25,-40413.96C4219.25,-40413.96 4219.25,-40387.9 4219.25,-40387.9"/>
<polygon fill="black" stroke="black" points="4222.75,-40387.9 4219.25,-40377.9 4215.75,-40387.9 4222.75,-40387.9"/>
</g>
<!-- layer9_moe_expert7 -->
<g id="node337" class="node">
<title>layer9_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4637,-40377.76 4309,-40377.76 4309,-40325.76 4637,-40325.76 4637,-40377.76"/>
<text text-anchor="middle" x="4473" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 7 L9</text>
<text text-anchor="middle" x="4473" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4473" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4473" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert7 -->
<g id="node363" class="node">
<title>layer9_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4510" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4510" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4510" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4510" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer9_moe_expert7&#45;&gt;layer9_moe_comm_from_expert7 -->
<g id="edge455" class="edge">
<title>layer9_moe_expert7&#45;&gt;layer9_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4510,-40325.44C4510,-40325.44 4510,-40299.9 4510,-40299.9"/>
<polygon fill="black" stroke="black" points="4513.5,-40299.9 4510,-40289.9 4506.5,-40299.9 4513.5,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert7&#45;&gt;layer9_moe_expert7 -->
<g id="edge424" class="edge">
<title>layer9_moe_comm_to_expert7&#45;&gt;layer9_moe_expert7</title>
<path fill="none" stroke="black" d="M4510,-40413.71C4510,-40413.71 4510,-40388.06 4510,-40388.06"/>
<polygon fill="black" stroke="black" points="4513.5,-40388.06 4510,-40378.06 4506.5,-40388.06 4513.5,-40388.06"/>
</g>
<!-- layer9_moe_expert8 -->
<g id="node339" class="node">
<title>layer9_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4983,-40377.76 4655,-40377.76 4655,-40325.76 4983,-40325.76 4983,-40377.76"/>
<text text-anchor="middle" x="4819" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 8 L9</text>
<text text-anchor="middle" x="4819" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4819" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4819" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert8 -->
<g id="node364" class="node">
<title>layer9_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4782" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4782" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4782" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4782" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer9_moe_expert8&#45;&gt;layer9_moe_comm_from_expert8 -->
<g id="edge457" class="edge">
<title>layer9_moe_expert8&#45;&gt;layer9_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4782,-40325.44C4782,-40325.44 4782,-40299.9 4782,-40299.9"/>
<polygon fill="black" stroke="black" points="4785.5,-40299.9 4782,-40289.9 4778.5,-40299.9 4785.5,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert8&#45;&gt;layer9_moe_expert8 -->
<g id="edge426" class="edge">
<title>layer9_moe_comm_to_expert8&#45;&gt;layer9_moe_expert8</title>
<path fill="none" stroke="black" d="M4782,-40413.71C4782,-40413.71 4782,-40388.06 4782,-40388.06"/>
<polygon fill="black" stroke="black" points="4785.5,-40388.06 4782,-40378.06 4778.5,-40388.06 4785.5,-40388.06"/>
</g>
<!-- layer9_moe_expert9 -->
<g id="node341" class="node">
<title>layer9_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5329,-40377.76 5001,-40377.76 5001,-40325.76 5329,-40325.76 5329,-40377.76"/>
<text text-anchor="middle" x="5165" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 9 L9</text>
<text text-anchor="middle" x="5165" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5165" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5165" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert9 -->
<g id="node365" class="node">
<title>layer9_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5091" cy="-40260.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5091" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5091" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5091" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer9_moe_expert9&#45;&gt;layer9_moe_comm_from_expert9 -->
<g id="edge459" class="edge">
<title>layer9_moe_expert9&#45;&gt;layer9_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5091.25,-40325.44C5091.25,-40325.44 5091.25,-40299.9 5091.25,-40299.9"/>
<polygon fill="black" stroke="black" points="5094.75,-40299.9 5091.25,-40289.9 5087.75,-40299.9 5094.75,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert9&#45;&gt;layer9_moe_expert9 -->
<g id="edge428" class="edge">
<title>layer9_moe_comm_to_expert9&#45;&gt;layer9_moe_expert9</title>
<path fill="none" stroke="black" d="M5091.25,-40413.71C5091.25,-40413.71 5091.25,-40388.06 5091.25,-40388.06"/>
<polygon fill="black" stroke="black" points="5094.75,-40388.06 5091.25,-40378.06 5087.75,-40388.06 5094.75,-40388.06"/>
</g>
<!-- layer9_moe_expert10 -->
<g id="node343" class="node">
<title>layer9_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5685,-40377.76 5347,-40377.76 5347,-40325.76 5685,-40325.76 5685,-40377.76"/>
<text text-anchor="middle" x="5516" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 10 L9</text>
<text text-anchor="middle" x="5516" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5516" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5516" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert10 -->
<g id="node366" class="node">
<title>layer9_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5423" cy="-40260.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5423" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5423" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5423" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer9_moe_expert10&#45;&gt;layer9_moe_comm_from_expert10 -->
<g id="edge461" class="edge">
<title>layer9_moe_expert10&#45;&gt;layer9_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5432.38,-40325.44C5432.38,-40325.44 5432.38,-40299.9 5432.38,-40299.9"/>
<polygon fill="black" stroke="black" points="5435.88,-40299.9 5432.38,-40289.9 5428.88,-40299.9 5435.88,-40299.9"/>
</g>
<!-- layer9_moe_comm_to_expert10&#45;&gt;layer9_moe_expert10 -->
<g id="edge430" class="edge">
<title>layer9_moe_comm_to_expert10&#45;&gt;layer9_moe_expert10</title>
<path fill="none" stroke="black" d="M5432.02,-40413.71C5432.02,-40413.71 5432.02,-40388.06 5432.02,-40388.06"/>
<polygon fill="black" stroke="black" points="5435.52,-40388.06 5432.02,-40378.06 5428.52,-40388.06 5435.52,-40388.06"/>
</g>
<!-- layer9_moe_expert11 -->
<g id="node345" class="node">
<title>layer9_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6041,-40377.76 5703,-40377.76 5703,-40325.76 6041,-40325.76 6041,-40377.76"/>
<text text-anchor="middle" x="5872" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 11 L9</text>
<text text-anchor="middle" x="5872" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5872" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5872" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert11 -->
<g id="node367" class="node">
<title>layer9_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5770" cy="-40260.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5770" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5770" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5770" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer9_moe_expert11&#45;&gt;layer9_moe_comm_from_expert11 -->
<g id="edge463" class="edge">
<title>layer9_moe_expert11&#45;&gt;layer9_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5783.88,-40325.44C5783.88,-40325.44 5783.88,-40299.58 5783.88,-40299.58"/>
<polygon fill="black" stroke="black" points="5787.38,-40299.58 5783.88,-40289.58 5780.38,-40299.58 5787.38,-40299.58"/>
</g>
<!-- layer9_moe_comm_to_expert11&#45;&gt;layer9_moe_expert11 -->
<g id="edge432" class="edge">
<title>layer9_moe_comm_to_expert11&#45;&gt;layer9_moe_expert11</title>
<path fill="none" stroke="black" d="M5783.02,-40413.96C5783.02,-40413.96 5783.02,-40387.9 5783.02,-40387.9"/>
<polygon fill="black" stroke="black" points="5786.52,-40387.9 5783.02,-40377.9 5779.52,-40387.9 5786.52,-40387.9"/>
</g>
<!-- layer9_moe_expert12 -->
<g id="node347" class="node">
<title>layer9_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6397,-40377.76 6059,-40377.76 6059,-40325.76 6397,-40325.76 6397,-40377.76"/>
<text text-anchor="middle" x="6228" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 12 L9</text>
<text text-anchor="middle" x="6228" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6228" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6228" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert12 -->
<g id="node368" class="node">
<title>layer9_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6121" cy="-40260.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6121" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6121" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6121" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer9_moe_expert12&#45;&gt;layer9_moe_comm_from_expert12 -->
<g id="edge465" class="edge">
<title>layer9_moe_expert12&#45;&gt;layer9_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6137.38,-40325.44C6137.38,-40325.44 6137.38,-40299.58 6137.38,-40299.58"/>
<polygon fill="black" stroke="black" points="6140.88,-40299.58 6137.38,-40289.58 6133.88,-40299.58 6140.88,-40299.58"/>
</g>
<!-- layer9_moe_comm_to_expert12&#45;&gt;layer9_moe_expert12 -->
<g id="edge434" class="edge">
<title>layer9_moe_comm_to_expert12&#45;&gt;layer9_moe_expert12</title>
<path fill="none" stroke="black" d="M6136.52,-40413.96C6136.52,-40413.96 6136.52,-40387.9 6136.52,-40387.9"/>
<polygon fill="black" stroke="black" points="6140.02,-40387.9 6136.52,-40377.9 6133.02,-40387.9 6140.02,-40387.9"/>
</g>
<!-- layer9_moe_expert13 -->
<g id="node349" class="node">
<title>layer9_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6753,-40377.76 6415,-40377.76 6415,-40325.76 6753,-40325.76 6753,-40377.76"/>
<text text-anchor="middle" x="6584" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 13 L9</text>
<text text-anchor="middle" x="6584" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6584" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6584" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert13 -->
<g id="node369" class="node">
<title>layer9_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6475" cy="-40260.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6475" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6475" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6475" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer9_moe_expert13&#45;&gt;layer9_moe_comm_from_expert13 -->
<g id="edge467" class="edge">
<title>layer9_moe_expert13&#45;&gt;layer9_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6492.38,-40325.44C6492.38,-40325.44 6492.38,-40299.58 6492.38,-40299.58"/>
<polygon fill="black" stroke="black" points="6495.88,-40299.58 6492.38,-40289.58 6488.88,-40299.58 6495.88,-40299.58"/>
</g>
<!-- layer9_moe_comm_to_expert13&#45;&gt;layer9_moe_expert13 -->
<g id="edge436" class="edge">
<title>layer9_moe_comm_to_expert13&#45;&gt;layer9_moe_expert13</title>
<path fill="none" stroke="black" d="M6491.02,-40413.96C6491.02,-40413.96 6491.02,-40387.9 6491.02,-40387.9"/>
<polygon fill="black" stroke="black" points="6494.52,-40387.9 6491.02,-40377.9 6487.52,-40387.9 6494.52,-40387.9"/>
</g>
<!-- layer9_moe_expert14 -->
<g id="node351" class="node">
<title>layer9_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7109,-40377.76 6771,-40377.76 6771,-40325.76 7109,-40325.76 7109,-40377.76"/>
<text text-anchor="middle" x="6940" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 14 L9</text>
<text text-anchor="middle" x="6940" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6940" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6940" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert14 -->
<g id="node370" class="node">
<title>layer9_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6830" cy="-40260.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6830" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6830" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6830" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer9_moe_expert14&#45;&gt;layer9_moe_comm_from_expert14 -->
<g id="edge469" class="edge">
<title>layer9_moe_expert14&#45;&gt;layer9_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6847.88,-40325.44C6847.88,-40325.44 6847.88,-40299.26 6847.88,-40299.26"/>
<polygon fill="black" stroke="black" points="6851.38,-40299.26 6847.88,-40289.26 6844.38,-40299.26 6851.38,-40299.26"/>
</g>
<!-- layer9_moe_comm_to_expert14&#45;&gt;layer9_moe_expert14 -->
<g id="edge438" class="edge">
<title>layer9_moe_comm_to_expert14&#45;&gt;layer9_moe_expert14</title>
<path fill="none" stroke="black" d="M6846.52,-40413.96C6846.52,-40413.96 6846.52,-40387.9 6846.52,-40387.9"/>
<polygon fill="black" stroke="black" points="6850.02,-40387.9 6846.52,-40377.9 6843.02,-40387.9 6850.02,-40387.9"/>
</g>
<!-- layer9_moe_expert15 -->
<g id="node353" class="node">
<title>layer9_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7465,-40377.76 7127,-40377.76 7127,-40325.76 7465,-40325.76 7465,-40377.76"/>
<text text-anchor="middle" x="7296" y="-40365.76" font-family="Arial" font-size="10.00">EXPERT 15 L9</text>
<text text-anchor="middle" x="7296" y="-40354.76" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7296" y="-40343.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7296" y="-40332.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_comm_from_expert15 -->
<g id="node371" class="node">
<title>layer9_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7185" cy="-40260.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7185" y="-40269.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7185" y="-40258.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7185" y="-40247.27" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer9_moe_expert15&#45;&gt;layer9_moe_comm_from_expert15 -->
<g id="edge471" class="edge">
<title>layer9_moe_expert15&#45;&gt;layer9_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7203.38,-40325.44C7203.38,-40325.44 7203.38,-40299.26 7203.38,-40299.26"/>
<polygon fill="black" stroke="black" points="7206.88,-40299.26 7203.38,-40289.26 7199.88,-40299.26 7206.88,-40299.26"/>
</g>
<!-- layer9_moe_comm_to_expert15&#45;&gt;layer9_moe_expert15 -->
<g id="edge440" class="edge">
<title>layer9_moe_comm_to_expert15&#45;&gt;layer9_moe_expert15</title>
<path fill="none" stroke="black" d="M7202.02,-40413.96C7202.02,-40413.96 7202.02,-40387.9 7202.02,-40387.9"/>
<polygon fill="black" stroke="black" points="7205.52,-40387.9 7202.02,-40377.9 7198.52,-40387.9 7205.52,-40387.9"/>
</g>
<!-- layer9_moe_aggregate -->
<g id="node355" class="node">
<title>layer9_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4871.1,-40195.78 4454.16,-40195.78 4346.9,-40091.78 4763.84,-40091.78 4871.1,-40195.78"/>
<text text-anchor="middle" x="4609" y="-40157.78" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L9</text>
<text text-anchor="middle" x="4609" y="-40146.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4609" y="-40135.78" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4609" y="-40124.78" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_mha -->
<g id="node372" class="node">
<title>layer10_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4739,-40055.78 4479,-40055.78 4479,-40003.78 4739,-40003.78 4739,-40055.78"/>
<text text-anchor="middle" x="4609" y="-40043.78" font-family="Arial" font-size="10.00">MHA L10</text>
<text text-anchor="middle" x="4609" y="-40032.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4609" y="-40021.78" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4609" y="-40010.78" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer9_moe_aggregate&#45;&gt;layer10_moe_mha -->
<g id="edge540" class="edge">
<title>layer9_moe_aggregate&#45;&gt;layer10_moe_mha</title>
<path fill="none" stroke="black" d="M4609,-40091.45C4609,-40091.45 4609,-40066.01 4609,-40066.01"/>
<polygon fill="black" stroke="black" points="4612.5,-40066.01 4609,-40056.01 4605.5,-40066.01 4612.5,-40066.01"/>
</g>
<!-- layer9_moe_comm_from_expert0&#45;&gt;layer9_moe_aggregate -->
<g id="edge442" class="edge">
<title>layer9_moe_comm_from_expert0&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M2279.51,-40248.11C2279.51,-40211.14 2279.51,-40106 2279.51,-40106 2279.51,-40106 4351.36,-40106 4351.36,-40106"/>
<polygon fill="black" stroke="black" points="4351.36,-40109.5 4361.36,-40106 4351.36,-40102.5 4351.36,-40109.5"/>
</g>
<!-- layer9_moe_comm_from_expert1&#45;&gt;layer9_moe_aggregate -->
<g id="edge444" class="edge">
<title>layer9_moe_comm_from_expert1&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M2551.51,-40247.87C2551.51,-40213.27 2551.51,-40121 2551.51,-40121 2551.51,-40121 4366.98,-40121 4366.98,-40121"/>
<polygon fill="black" stroke="black" points="4366.98,-40124.5 4376.98,-40121 4366.98,-40117.5 4366.98,-40124.5"/>
</g>
<!-- layer9_moe_comm_from_expert2&#45;&gt;layer9_moe_aggregate -->
<g id="edge446" class="edge">
<title>layer9_moe_comm_from_expert2&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M2916.01,-40247.42C2916.01,-40215.23 2916.01,-40136 2916.01,-40136 2916.01,-40136 4382.43,-40136 4382.43,-40136"/>
<polygon fill="black" stroke="black" points="4382.43,-40139.5 4392.43,-40136 4382.43,-40132.5 4382.43,-40139.5"/>
</g>
<!-- layer9_moe_comm_from_expert3&#45;&gt;layer9_moe_aggregate -->
<g id="edge448" class="edge">
<title>layer9_moe_comm_from_expert3&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M3236,-40243.62C3236,-40212.75 3236,-40151 3236,-40151 3236,-40151 4397.88,-40151 4397.88,-40151"/>
<polygon fill="black" stroke="black" points="4397.88,-40154.5 4407.88,-40151 4397.88,-40147.5 4397.88,-40154.5"/>
</g>
<!-- layer9_moe_comm_from_expert4&#45;&gt;layer9_moe_aggregate -->
<g id="edge450" class="edge">
<title>layer9_moe_comm_from_expert4&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M3685.5,-40233.36C3685.5,-40205.37 3685.5,-40166 3685.5,-40166 3685.5,-40166 4413.23,-40166 4413.23,-40166"/>
<polygon fill="black" stroke="black" points="4413.23,-40169.5 4423.23,-40166 4413.23,-40162.5 4413.23,-40169.5"/>
</g>
<!-- layer9_moe_comm_from_expert5&#45;&gt;layer9_moe_aggregate -->
<g id="edge452" class="edge">
<title>layer9_moe_comm_from_expert5&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M4082.5,-40247.43C4082.5,-40224.49 4082.5,-40180 4082.5,-40180 4082.5,-40180 4427.7,-40180 4427.7,-40180"/>
<polygon fill="black" stroke="black" points="4427.7,-40183.5 4437.7,-40180 4427.7,-40176.5 4427.7,-40183.5"/>
</g>
<!-- layer9_moe_comm_from_expert6&#45;&gt;layer9_moe_aggregate -->
<g id="edge454" class="edge">
<title>layer9_moe_comm_from_expert6&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M4355.61,-40247.8C4355.61,-40247.8 4355.61,-40153.83 4355.61,-40153.83"/>
<polygon fill="black" stroke="black" points="4359.11,-40153.83 4355.61,-40143.83 4352.11,-40153.83 4359.11,-40153.83"/>
</g>
<!-- layer9_moe_comm_from_expert7&#45;&gt;layer9_moe_aggregate -->
<g id="edge456" class="edge">
<title>layer9_moe_comm_from_expert7&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M4510,-40231.55C4510,-40231.55 4510,-40205.84 4510,-40205.84"/>
<polygon fill="black" stroke="black" points="4513.5,-40205.84 4510,-40195.84 4506.5,-40205.84 4513.5,-40205.84"/>
</g>
<!-- layer9_moe_comm_from_expert8&#45;&gt;layer9_moe_aggregate -->
<g id="edge458" class="edge">
<title>layer9_moe_comm_from_expert8&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M4781.39,-40231.55C4781.39,-40231.55 4781.39,-40205.84 4781.39,-40205.84"/>
<polygon fill="black" stroke="black" points="4784.89,-40205.84 4781.39,-40195.84 4777.89,-40205.84 4784.89,-40205.84"/>
</g>
<!-- layer9_moe_comm_from_expert9&#45;&gt;layer9_moe_aggregate -->
<g id="edge460" class="edge">
<title>layer9_moe_comm_from_expert9&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M5072.5,-40232.33C5072.5,-40209.77 5072.5,-40182 5072.5,-40182 5072.5,-40182 4867.03,-40182 4867.03,-40182"/>
<polygon fill="black" stroke="black" points="4867.03,-40178.5 4857.03,-40182 4867.03,-40185.5 4867.03,-40178.5"/>
</g>
<!-- layer9_moe_comm_from_expert10&#45;&gt;layer9_moe_aggregate -->
<g id="edge462" class="edge">
<title>layer9_moe_comm_from_expert10&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M5404.15,-40232.24C5404.15,-40205.3 5404.15,-40169 5404.15,-40169 5404.15,-40169 4853.54,-40169 4853.54,-40169"/>
<polygon fill="black" stroke="black" points="4853.54,-40165.5 4843.54,-40169 4853.54,-40172.5 4853.54,-40165.5"/>
</g>
<!-- layer9_moe_comm_from_expert11&#45;&gt;layer9_moe_aggregate -->
<g id="edge464" class="edge">
<title>layer9_moe_comm_from_expert11&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M5750.65,-40232.14C5750.65,-40201.12 5750.65,-40156 5750.65,-40156 5750.65,-40156 4840.14,-40156 4840.14,-40156"/>
<polygon fill="black" stroke="black" points="4840.14,-40152.5 4830.14,-40156 4840.14,-40159.5 4840.14,-40152.5"/>
</g>
<!-- layer9_moe_comm_from_expert12&#45;&gt;layer9_moe_aggregate -->
<g id="edge466" class="edge">
<title>layer9_moe_comm_from_expert12&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M6101.65,-40232.26C6101.65,-40197.41 6101.65,-40143 6101.65,-40143 6101.65,-40143 4826.94,-40143 4826.94,-40143"/>
<polygon fill="black" stroke="black" points="4826.94,-40139.5 4816.94,-40143 4826.94,-40146.5 4826.94,-40139.5"/>
</g>
<!-- layer9_moe_comm_from_expert13&#45;&gt;layer9_moe_aggregate -->
<g id="edge468" class="edge">
<title>layer9_moe_comm_from_expert13&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M6455.15,-40232.4C6455.15,-40193.94 6455.15,-40130 6455.15,-40130 6455.15,-40130 4813.52,-40130 4813.52,-40130"/>
<polygon fill="black" stroke="black" points="4813.52,-40126.5 4803.52,-40130 4813.52,-40133.5 4813.52,-40126.5"/>
</g>
<!-- layer9_moe_comm_from_expert14&#45;&gt;layer9_moe_aggregate -->
<g id="edge470" class="edge">
<title>layer9_moe_comm_from_expert14&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M6810.15,-40232.37C6810.15,-40190.47 6810.15,-40117 6810.15,-40117 6810.15,-40117 4800.06,-40117 4800.06,-40117"/>
<polygon fill="black" stroke="black" points="4800.06,-40113.5 4790.06,-40117 4800.06,-40120.5 4800.06,-40113.5"/>
</g>
<!-- layer9_moe_comm_from_expert15&#45;&gt;layer9_moe_aggregate -->
<g id="edge472" class="edge">
<title>layer9_moe_comm_from_expert15&#45;&gt;layer9_moe_aggregate</title>
<path fill="none" stroke="black" d="M7165.15,-40232.38C7165.15,-40187.2 7165.15,-40104 7165.15,-40104 7165.15,-40104 4786.72,-40104 4786.72,-40104"/>
<polygon fill="black" stroke="black" points="4786.72,-40100.5 4776.72,-40104 4786.72,-40107.5 4786.72,-40100.5"/>
</g>
<!-- layer10_moe_gate -->
<g id="node373" class="node">
<title>layer10_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4867.3,-39967.78 4456.4,-39967.78 4350.7,-39863.78 4761.6,-39863.78 4867.3,-39967.78"/>
<text text-anchor="middle" x="4609" y="-39929.78" font-family="Arial" font-size="10.00">GATE L10</text>
<text text-anchor="middle" x="4609" y="-39918.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4609" y="-39907.78" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4609" y="-39896.78" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer10_moe_mha&#45;&gt;layer10_moe_gate -->
<g id="edge541" class="edge">
<title>layer10_moe_mha&#45;&gt;layer10_moe_gate</title>
<path fill="none" stroke="black" d="M4609,-40003.63C4609,-40003.63 4609,-39977.88 4609,-39977.88"/>
<polygon fill="black" stroke="black" points="4612.5,-39977.88 4609,-39967.88 4605.5,-39977.88 4612.5,-39977.88"/>
</g>
<!-- layer10_moe_split -->
<g id="node374" class="node">
<title>layer10_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4863.01,-39827.78 4458.94,-39827.78 4354.99,-39723.78 4759.06,-39723.78 4863.01,-39827.78"/>
<text text-anchor="middle" x="4609" y="-39789.78" font-family="Arial" font-size="10.00">SPLIT TOKENS L10</text>
<text text-anchor="middle" x="4609" y="-39778.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4609" y="-39767.78" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4609" y="-39756.78" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer10_moe_gate&#45;&gt;layer10_moe_split -->
<g id="edge542" class="edge">
<title>layer10_moe_gate&#45;&gt;layer10_moe_split</title>
<path fill="none" stroke="black" d="M4609,-39863.65C4609,-39863.65 4609,-39837.95 4609,-39837.95"/>
<polygon fill="black" stroke="black" points="4612.5,-39837.95 4609,-39827.95 4605.5,-39837.95 4612.5,-39837.95"/>
</g>
<!-- layer10_moe_comm_to_expert0 -->
<g id="node376" class="node">
<title>layer10_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2180" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2180" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2180" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2180" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert0 -->
<g id="edge476" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4443.14,-39812C3896.91,-39812 2189,-39812 2189,-39812 2189,-39812 2189,-39697.97 2189,-39697.97"/>
<polygon fill="black" stroke="black" points="2192.5,-39697.97 2189,-39687.97 2185.5,-39697.97 2192.5,-39697.97"/>
</g>
<!-- layer10_moe_comm_to_expert1 -->
<g id="node378" class="node">
<title>layer10_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2452" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2452" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2452" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2452" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert1 -->
<g id="edge478" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4429.1,-39798C3912.45,-39798 2461,-39798 2461,-39798 2461,-39798 2461,-39697.97 2461,-39697.97"/>
<polygon fill="black" stroke="black" points="2464.5,-39697.97 2461,-39687.97 2457.5,-39697.97 2464.5,-39697.97"/>
</g>
<!-- layer10_moe_comm_to_expert2 -->
<g id="node380" class="node">
<title>layer10_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2816" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2816" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2816" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2816" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert2 -->
<g id="edge480" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4413.89,-39783C3951.11,-39783 2825.5,-39783 2825.5,-39783 2825.5,-39783 2825.5,-39697.91 2825.5,-39697.91"/>
<polygon fill="black" stroke="black" points="2829,-39697.91 2825.5,-39687.91 2822,-39697.91 2829,-39697.91"/>
</g>
<!-- layer10_moe_comm_to_expert3 -->
<g id="node382" class="node">
<title>layer10_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3309" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3309" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3309" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3309" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert3 -->
<g id="edge482" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4399.02,-39768C4037.35,-39768 3335.25,-39768 3335.25,-39768 3335.25,-39768 3335.25,-39696.63 3335.25,-39696.63"/>
<polygon fill="black" stroke="black" points="3338.75,-39696.63 3335.25,-39686.63 3331.75,-39696.63 3338.75,-39696.63"/>
</g>
<!-- layer10_moe_comm_to_expert4 -->
<g id="node384" class="node">
<title>layer10_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3655" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3655" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3655" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3655" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert4 -->
<g id="edge484" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4383.98,-39753C4093.66,-39753 3625.5,-39753 3625.5,-39753 3625.5,-39753 3625.5,-39696.29 3625.5,-39696.29"/>
<polygon fill="black" stroke="black" points="3629,-39696.29 3625.5,-39686.29 3622,-39696.29 3629,-39696.29"/>
</g>
<!-- layer10_moe_comm_to_expert5 -->
<g id="node386" class="node">
<title>layer10_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3927" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3927" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3927" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3927" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert5 -->
<g id="edge486" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4369.01,-39738C4185.77,-39738 3964.5,-39738 3964.5,-39738 3964.5,-39738 3964.5,-39695.61 3964.5,-39695.61"/>
<polygon fill="black" stroke="black" points="3968,-39695.61 3964.5,-39685.61 3961,-39695.61 3968,-39695.61"/>
</g>
<!-- layer10_moe_comm_to_expert6 -->
<g id="node388" class="node">
<title>layer10_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4163" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4163" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4163" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4163" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert6 -->
<g id="edge488" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4368.74,-39775.69C4368.74,-39772.13 4368.74,-39658 4368.74,-39658 4368.74,-39658 4263.54,-39658 4263.54,-39658"/>
<polygon fill="black" stroke="black" points="4263.54,-39654.5 4253.54,-39658 4263.54,-39661.5 4263.54,-39654.5"/>
</g>
<!-- layer10_moe_comm_to_expert7 -->
<g id="node390" class="node">
<title>layer10_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4473" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4473" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4473" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4473" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert7 -->
<g id="edge490" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4473,-39723.44C4473,-39723.44 4473,-39698 4473,-39698"/>
<polygon fill="black" stroke="black" points="4476.5,-39698 4473,-39688 4469.5,-39698 4476.5,-39698"/>
</g>
<!-- layer10_moe_comm_to_expert8 -->
<g id="node392" class="node">
<title>layer10_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4745" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4745" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4745" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4745" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert8 -->
<g id="edge492" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4745,-39723.44C4745,-39723.44 4745,-39698 4745,-39698"/>
<polygon fill="black" stroke="black" points="4748.5,-39698 4745,-39688 4741.5,-39698 4748.5,-39698"/>
</g>
<!-- layer10_moe_comm_to_expert9 -->
<g id="node394" class="node">
<title>layer10_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5054" cy="-39658.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5054" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5054" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5054" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert9 -->
<g id="edge494" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4849.26,-39775.69C4849.26,-39772.13 4849.26,-39658 4849.26,-39658 4849.26,-39658 4953.3,-39658 4953.3,-39658"/>
<polygon fill="black" stroke="black" points="4953.3,-39661.5 4963.3,-39658 4953.3,-39654.5 4953.3,-39661.5"/>
</g>
<!-- layer10_moe_comm_to_expert10 -->
<g id="node396" class="node">
<title>layer10_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5386" cy="-39658.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5386" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5386" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5386" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert10 -->
<g id="edge496" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4773.38,-39738C4980.6,-39738 5310.1,-39738 5310.1,-39738 5310.1,-39738 5310.1,-39685.98 5310.1,-39685.98"/>
<polygon fill="black" stroke="black" points="5313.6,-39685.98 5310.1,-39675.98 5306.6,-39685.98 5313.6,-39685.98"/>
</g>
<!-- layer10_moe_comm_to_expert11 -->
<g id="node398" class="node">
<title>layer10_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5732" cy="-39658.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5732" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5732" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5732" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert11 -->
<g id="edge498" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4788.49,-39753C5087.86,-39753 5656.6,-39753 5656.6,-39753 5656.6,-39753 5656.6,-39686.51 5656.6,-39686.51"/>
<polygon fill="black" stroke="black" points="5660.1,-39686.51 5656.6,-39676.51 5653.1,-39686.51 5660.1,-39686.51"/>
</g>
<!-- layer10_moe_comm_to_expert12 -->
<g id="node400" class="node">
<title>layer10_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6083" cy="-39658.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6083" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6083" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6083" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert12 -->
<g id="edge500" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4803.47,-39768C5187.77,-39768 6007.6,-39768 6007.6,-39768 6007.6,-39768 6007.6,-39686.34 6007.6,-39686.34"/>
<polygon fill="black" stroke="black" points="6011.1,-39686.34 6007.6,-39676.34 6004.1,-39686.34 6011.1,-39686.34"/>
</g>
<!-- layer10_moe_comm_to_expert13 -->
<g id="node402" class="node">
<title>layer10_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6436" cy="-39658.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6436" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6436" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6436" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert13 -->
<g id="edge502" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4818.6,-39783C5283.67,-39783 6361.1,-39783 6361.1,-39783 6361.1,-39783 6361.1,-39686.32 6361.1,-39686.32"/>
<polygon fill="black" stroke="black" points="6364.6,-39686.32 6361.1,-39676.32 6357.6,-39686.32 6364.6,-39686.32"/>
</g>
<!-- layer10_moe_comm_to_expert14 -->
<g id="node404" class="node">
<title>layer10_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6791" cy="-39658.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6791" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6791" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6791" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert14 -->
<g id="edge504" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4833.5,-39798C5376.43,-39798 6716.1,-39798 6716.1,-39798 6716.1,-39798 6716.1,-39686.42 6716.1,-39686.42"/>
<polygon fill="black" stroke="black" points="6719.6,-39686.42 6716.1,-39676.42 6712.6,-39686.42 6719.6,-39686.42"/>
</g>
<!-- layer10_moe_comm_to_expert15 -->
<g id="node406" class="node">
<title>layer10_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7146" cy="-39658.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7146" y="-39667.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7146" y="-39656.29" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7146" y="-39645.29" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert15 -->
<g id="edge506" class="edge">
<title>layer10_moe_split&#45;&gt;layer10_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.31,-39812C5465.21,-39812 7071.1,-39812 7071.1,-39812 7071.1,-39812 7071.1,-39686.36 7071.1,-39686.36"/>
<polygon fill="black" stroke="black" points="7074.6,-39686.36 7071.1,-39676.36 7067.6,-39686.36 7074.6,-39686.36"/>
</g>
<!-- layer10_moe_expert0 -->
<g id="node375" class="node">
<title>layer10_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2178,-39593.8 1850,-39593.8 1850,-39541.8 2178,-39541.8 2178,-39593.8"/>
<text text-anchor="middle" x="2014" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 0 L10</text>
<text text-anchor="middle" x="2014" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2014" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="2014" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert0 -->
<g id="node408" class="node">
<title>layer10_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2180" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2180" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2180" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2180" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer10_moe_expert0&#45;&gt;layer10_moe_comm_from_expert0 -->
<g id="edge508" class="edge">
<title>layer10_moe_expert0&#45;&gt;layer10_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2133.75,-39541.48C2133.75,-39541.48 2133.75,-39511.81 2133.75,-39511.81"/>
<polygon fill="black" stroke="black" points="2137.25,-39511.81 2133.75,-39501.81 2130.25,-39511.81 2137.25,-39511.81"/>
</g>
<!-- layer10_moe_comm_to_expert0&#45;&gt;layer10_moe_expert0 -->
<g id="edge477" class="edge">
<title>layer10_moe_comm_to_expert0&#45;&gt;layer10_moe_expert0</title>
<path fill="none" stroke="black" d="M2133.75,-39633.44C2133.75,-39633.44 2133.75,-39603.96 2133.75,-39603.96"/>
<polygon fill="black" stroke="black" points="2137.25,-39603.96 2133.75,-39593.96 2130.25,-39603.96 2137.25,-39603.96"/>
</g>
<!-- layer10_moe_expert1 -->
<g id="node377" class="node">
<title>layer10_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2524,-39593.8 2196,-39593.8 2196,-39541.8 2524,-39541.8 2524,-39593.8"/>
<text text-anchor="middle" x="2360" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 1 L10</text>
<text text-anchor="middle" x="2360" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2360" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2360" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert1 -->
<g id="node409" class="node">
<title>layer10_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2452" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2452" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2452" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2452" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer10_moe_expert1&#45;&gt;layer10_moe_comm_from_expert1 -->
<g id="edge510" class="edge">
<title>layer10_moe_expert1&#45;&gt;layer10_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2442.75,-39541.48C2442.75,-39541.48 2442.75,-39515.94 2442.75,-39515.94"/>
<polygon fill="black" stroke="black" points="2446.25,-39515.94 2442.75,-39505.94 2439.25,-39515.94 2446.25,-39515.94"/>
</g>
<!-- layer10_moe_comm_to_expert1&#45;&gt;layer10_moe_expert1 -->
<g id="edge479" class="edge">
<title>layer10_moe_comm_to_expert1&#45;&gt;layer10_moe_expert1</title>
<path fill="none" stroke="black" d="M2442.75,-39629.75C2442.75,-39629.75 2442.75,-39604.1 2442.75,-39604.1"/>
<polygon fill="black" stroke="black" points="2446.25,-39604.1 2442.75,-39594.1 2439.25,-39604.1 2446.25,-39604.1"/>
</g>
<!-- layer10_moe_expert2 -->
<g id="node379" class="node">
<title>layer10_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2870,-39593.8 2542,-39593.8 2542,-39541.8 2870,-39541.8 2870,-39593.8"/>
<text text-anchor="middle" x="2706" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 2 L10</text>
<text text-anchor="middle" x="2706" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2706" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2706" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert2 -->
<g id="node410" class="node">
<title>layer10_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2816" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2816" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2816" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2816" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer10_moe_expert2&#45;&gt;layer10_moe_comm_from_expert2 -->
<g id="edge512" class="edge">
<title>layer10_moe_expert2&#45;&gt;layer10_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2797.75,-39541.48C2797.75,-39541.48 2797.75,-39515.29 2797.75,-39515.29"/>
<polygon fill="black" stroke="black" points="2801.25,-39515.29 2797.75,-39505.29 2794.25,-39515.29 2801.25,-39515.29"/>
</g>
<!-- layer10_moe_comm_to_expert2&#45;&gt;layer10_moe_expert2 -->
<g id="edge481" class="edge">
<title>layer10_moe_comm_to_expert2&#45;&gt;layer10_moe_expert2</title>
<path fill="none" stroke="black" d="M2797.75,-39630C2797.75,-39630 2797.75,-39603.93 2797.75,-39603.93"/>
<polygon fill="black" stroke="black" points="2801.25,-39603.93 2797.75,-39593.93 2794.25,-39603.93 2801.25,-39603.93"/>
</g>
<!-- layer10_moe_expert3 -->
<g id="node381" class="node">
<title>layer10_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3216,-39593.8 2888,-39593.8 2888,-39541.8 3216,-39541.8 3216,-39593.8"/>
<text text-anchor="middle" x="3052" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 3 L10</text>
<text text-anchor="middle" x="3052" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3052" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3052" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert3 -->
<g id="node411" class="node">
<title>layer10_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3309" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3309" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3309" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3309" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer10_moe_expert3&#45;&gt;layer10_moe_comm_from_expert3 -->
<g id="edge514" class="edge">
<title>layer10_moe_expert3&#45;&gt;layer10_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3216.11,-39559C3224.07,-39559 3228.83,-39559 3228.83,-39559 3228.83,-39559 3228.83,-39500.38 3228.83,-39500.38"/>
<polygon fill="black" stroke="black" points="3232.33,-39500.38 3228.83,-39490.38 3225.33,-39500.38 3232.33,-39500.38"/>
</g>
<!-- layer10_moe_comm_to_expert3&#45;&gt;layer10_moe_expert3 -->
<g id="edge483" class="edge">
<title>layer10_moe_comm_to_expert3&#45;&gt;layer10_moe_expert3</title>
<path fill="none" stroke="black" d="M3223.66,-39648.97C3223.66,-39627.04 3223.66,-39576 3223.66,-39576 3223.66,-39576 3222.92,-39576 3222.92,-39576"/>
<polygon fill="black" stroke="black" points="3226.28,-39572.5 3216.28,-39576 3226.28,-39579.5 3226.28,-39572.5"/>
</g>
<!-- layer10_moe_expert4 -->
<g id="node383" class="node">
<title>layer10_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3562,-39593.8 3234,-39593.8 3234,-39541.8 3562,-39541.8 3562,-39593.8"/>
<text text-anchor="middle" x="3398" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 4 L10</text>
<text text-anchor="middle" x="3398" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3398" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3398" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert4 -->
<g id="node412" class="node">
<title>layer10_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3655" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3655" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3655" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3655" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer10_moe_expert4&#45;&gt;layer10_moe_comm_from_expert4 -->
<g id="edge516" class="edge">
<title>layer10_moe_expert4&#45;&gt;layer10_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3562.11,-39559C3570.07,-39559 3574.83,-39559 3574.83,-39559 3574.83,-39559 3574.83,-39500.38 3574.83,-39500.38"/>
<polygon fill="black" stroke="black" points="3578.33,-39500.38 3574.83,-39490.38 3571.33,-39500.38 3578.33,-39500.38"/>
</g>
<!-- layer10_moe_comm_to_expert4&#45;&gt;layer10_moe_expert4 -->
<g id="edge485" class="edge">
<title>layer10_moe_comm_to_expert4&#45;&gt;layer10_moe_expert4</title>
<path fill="none" stroke="black" d="M3569.66,-39648.97C3569.66,-39627.04 3569.66,-39576 3569.66,-39576 3569.66,-39576 3568.92,-39576 3568.92,-39576"/>
<polygon fill="black" stroke="black" points="3572.28,-39572.5 3562.28,-39576 3572.28,-39579.5 3572.28,-39572.5"/>
</g>
<!-- layer10_moe_expert5 -->
<g id="node385" class="node">
<title>layer10_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3908,-39593.8 3580,-39593.8 3580,-39541.8 3908,-39541.8 3908,-39593.8"/>
<text text-anchor="middle" x="3744" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 5 L10</text>
<text text-anchor="middle" x="3744" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3744" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3744" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert5 -->
<g id="node413" class="node">
<title>layer10_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3927" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3927" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3927" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3927" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer10_moe_expert5&#45;&gt;layer10_moe_comm_from_expert5 -->
<g id="edge518" class="edge">
<title>layer10_moe_expert5&#45;&gt;layer10_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3872.25,-39541.48C3872.25,-39541.48 3872.25,-39509.97 3872.25,-39509.97"/>
<polygon fill="black" stroke="black" points="3875.75,-39509.97 3872.25,-39499.97 3868.75,-39509.97 3875.75,-39509.97"/>
</g>
<!-- layer10_moe_comm_to_expert5&#45;&gt;layer10_moe_expert5 -->
<g id="edge487" class="edge">
<title>layer10_moe_comm_to_expert5&#45;&gt;layer10_moe_expert5</title>
<path fill="none" stroke="black" d="M3872.25,-39635.36C3872.25,-39635.36 3872.25,-39604.04 3872.25,-39604.04"/>
<polygon fill="black" stroke="black" points="3875.75,-39604.04 3872.25,-39594.04 3868.75,-39604.04 3875.75,-39604.04"/>
</g>
<!-- layer10_moe_expert6 -->
<g id="node387" class="node">
<title>layer10_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4254,-39593.8 3926,-39593.8 3926,-39541.8 4254,-39541.8 4254,-39593.8"/>
<text text-anchor="middle" x="4090" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 6 L10</text>
<text text-anchor="middle" x="4090" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4090" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4090" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert6 -->
<g id="node414" class="node">
<title>layer10_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4163" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4163" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4163" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4163" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer10_moe_expert6&#45;&gt;layer10_moe_comm_from_expert6 -->
<g id="edge520" class="edge">
<title>layer10_moe_expert6&#45;&gt;layer10_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4163,-39541.48C4163,-39541.48 4163,-39515.94 4163,-39515.94"/>
<polygon fill="black" stroke="black" points="4166.5,-39515.94 4163,-39505.94 4159.5,-39515.94 4166.5,-39515.94"/>
</g>
<!-- layer10_moe_comm_to_expert6&#45;&gt;layer10_moe_expert6 -->
<g id="edge489" class="edge">
<title>layer10_moe_comm_to_expert6&#45;&gt;layer10_moe_expert6</title>
<path fill="none" stroke="black" d="M4163,-39629.75C4163,-39629.75 4163,-39604.1 4163,-39604.1"/>
<polygon fill="black" stroke="black" points="4166.5,-39604.1 4163,-39594.1 4159.5,-39604.1 4166.5,-39604.1"/>
</g>
<!-- layer10_moe_expert7 -->
<g id="node389" class="node">
<title>layer10_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4600,-39593.8 4272,-39593.8 4272,-39541.8 4600,-39541.8 4600,-39593.8"/>
<text text-anchor="middle" x="4436" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 7 L10</text>
<text text-anchor="middle" x="4436" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4436" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4436" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert7 -->
<g id="node415" class="node">
<title>layer10_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4473" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4473" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4473" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4473" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer10_moe_expert7&#45;&gt;layer10_moe_comm_from_expert7 -->
<g id="edge522" class="edge">
<title>layer10_moe_expert7&#45;&gt;layer10_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4473,-39541.48C4473,-39541.48 4473,-39515.94 4473,-39515.94"/>
<polygon fill="black" stroke="black" points="4476.5,-39515.94 4473,-39505.94 4469.5,-39515.94 4476.5,-39515.94"/>
</g>
<!-- layer10_moe_comm_to_expert7&#45;&gt;layer10_moe_expert7 -->
<g id="edge491" class="edge">
<title>layer10_moe_comm_to_expert7&#45;&gt;layer10_moe_expert7</title>
<path fill="none" stroke="black" d="M4473,-39629.75C4473,-39629.75 4473,-39604.1 4473,-39604.1"/>
<polygon fill="black" stroke="black" points="4476.5,-39604.1 4473,-39594.1 4469.5,-39604.1 4476.5,-39604.1"/>
</g>
<!-- layer10_moe_expert8 -->
<g id="node391" class="node">
<title>layer10_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4946,-39593.8 4618,-39593.8 4618,-39541.8 4946,-39541.8 4946,-39593.8"/>
<text text-anchor="middle" x="4782" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 8 L10</text>
<text text-anchor="middle" x="4782" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4782" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4782" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert8 -->
<g id="node416" class="node">
<title>layer10_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4745" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4745" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4745" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4745" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer10_moe_expert8&#45;&gt;layer10_moe_comm_from_expert8 -->
<g id="edge524" class="edge">
<title>layer10_moe_expert8&#45;&gt;layer10_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4745,-39541.48C4745,-39541.48 4745,-39515.94 4745,-39515.94"/>
<polygon fill="black" stroke="black" points="4748.5,-39515.94 4745,-39505.94 4741.5,-39515.94 4748.5,-39515.94"/>
</g>
<!-- layer10_moe_comm_to_expert8&#45;&gt;layer10_moe_expert8 -->
<g id="edge493" class="edge">
<title>layer10_moe_comm_to_expert8&#45;&gt;layer10_moe_expert8</title>
<path fill="none" stroke="black" d="M4745,-39629.75C4745,-39629.75 4745,-39604.1 4745,-39604.1"/>
<polygon fill="black" stroke="black" points="4748.5,-39604.1 4745,-39594.1 4741.5,-39604.1 4748.5,-39604.1"/>
</g>
<!-- layer10_moe_expert9 -->
<g id="node393" class="node">
<title>layer10_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5292,-39593.8 4964,-39593.8 4964,-39541.8 5292,-39541.8 5292,-39593.8"/>
<text text-anchor="middle" x="5128" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 9 L10</text>
<text text-anchor="middle" x="5128" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5128" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5128" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert9 -->
<g id="node417" class="node">
<title>layer10_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5054" cy="-39476.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5054" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5054" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5054" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer10_moe_expert9&#45;&gt;layer10_moe_comm_from_expert9 -->
<g id="edge526" class="edge">
<title>layer10_moe_expert9&#45;&gt;layer10_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5054.25,-39541.48C5054.25,-39541.48 5054.25,-39515.94 5054.25,-39515.94"/>
<polygon fill="black" stroke="black" points="5057.75,-39515.94 5054.25,-39505.94 5050.75,-39515.94 5057.75,-39515.94"/>
</g>
<!-- layer10_moe_comm_to_expert9&#45;&gt;layer10_moe_expert9 -->
<g id="edge495" class="edge">
<title>layer10_moe_comm_to_expert9&#45;&gt;layer10_moe_expert9</title>
<path fill="none" stroke="black" d="M5054.25,-39629.75C5054.25,-39629.75 5054.25,-39604.1 5054.25,-39604.1"/>
<polygon fill="black" stroke="black" points="5057.75,-39604.1 5054.25,-39594.1 5050.75,-39604.1 5057.75,-39604.1"/>
</g>
<!-- layer10_moe_expert10 -->
<g id="node395" class="node">
<title>layer10_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5648,-39593.8 5310,-39593.8 5310,-39541.8 5648,-39541.8 5648,-39593.8"/>
<text text-anchor="middle" x="5479" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 10 L10</text>
<text text-anchor="middle" x="5479" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5479" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5479" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert10 -->
<g id="node418" class="node">
<title>layer10_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5386" cy="-39476.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5386" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5386" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5386" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer10_moe_expert10&#45;&gt;layer10_moe_comm_from_expert10 -->
<g id="edge528" class="edge">
<title>layer10_moe_expert10&#45;&gt;layer10_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5395.38,-39541.48C5395.38,-39541.48 5395.38,-39515.94 5395.38,-39515.94"/>
<polygon fill="black" stroke="black" points="5398.88,-39515.94 5395.38,-39505.94 5391.88,-39515.94 5398.88,-39515.94"/>
</g>
<!-- layer10_moe_comm_to_expert10&#45;&gt;layer10_moe_expert10 -->
<g id="edge497" class="edge">
<title>layer10_moe_comm_to_expert10&#45;&gt;layer10_moe_expert10</title>
<path fill="none" stroke="black" d="M5395.02,-39629.75C5395.02,-39629.75 5395.02,-39604.1 5395.02,-39604.1"/>
<polygon fill="black" stroke="black" points="5398.52,-39604.1 5395.02,-39594.1 5391.52,-39604.1 5398.52,-39604.1"/>
</g>
<!-- layer10_moe_expert11 -->
<g id="node397" class="node">
<title>layer10_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="6004,-39593.8 5666,-39593.8 5666,-39541.8 6004,-39541.8 6004,-39593.8"/>
<text text-anchor="middle" x="5835" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 11 L10</text>
<text text-anchor="middle" x="5835" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5835" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5835" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert11 -->
<g id="node419" class="node">
<title>layer10_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5733" cy="-39476.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5733" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5733" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5733" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer10_moe_expert11&#45;&gt;layer10_moe_comm_from_expert11 -->
<g id="edge530" class="edge">
<title>layer10_moe_expert11&#45;&gt;layer10_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5746.88,-39541.48C5746.88,-39541.48 5746.88,-39515.61 5746.88,-39515.61"/>
<polygon fill="black" stroke="black" points="5750.38,-39515.61 5746.88,-39505.61 5743.38,-39515.61 5750.38,-39515.61"/>
</g>
<!-- layer10_moe_comm_to_expert11&#45;&gt;layer10_moe_expert11 -->
<g id="edge499" class="edge">
<title>layer10_moe_comm_to_expert11&#45;&gt;layer10_moe_expert11</title>
<path fill="none" stroke="black" d="M5746.02,-39630C5746.02,-39630 5746.02,-39603.93 5746.02,-39603.93"/>
<polygon fill="black" stroke="black" points="5749.52,-39603.93 5746.02,-39593.93 5742.52,-39603.93 5749.52,-39603.93"/>
</g>
<!-- layer10_moe_expert12 -->
<g id="node399" class="node">
<title>layer10_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6360,-39593.8 6022,-39593.8 6022,-39541.8 6360,-39541.8 6360,-39593.8"/>
<text text-anchor="middle" x="6191" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 12 L10</text>
<text text-anchor="middle" x="6191" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6191" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6191" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert12 -->
<g id="node420" class="node">
<title>layer10_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6084" cy="-39476.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6084" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6084" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6084" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer10_moe_expert12&#45;&gt;layer10_moe_comm_from_expert12 -->
<g id="edge532" class="edge">
<title>layer10_moe_expert12&#45;&gt;layer10_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6100.38,-39541.48C6100.38,-39541.48 6100.38,-39515.61 6100.38,-39515.61"/>
<polygon fill="black" stroke="black" points="6103.88,-39515.61 6100.38,-39505.61 6096.88,-39515.61 6103.88,-39515.61"/>
</g>
<!-- layer10_moe_comm_to_expert12&#45;&gt;layer10_moe_expert12 -->
<g id="edge501" class="edge">
<title>layer10_moe_comm_to_expert12&#45;&gt;layer10_moe_expert12</title>
<path fill="none" stroke="black" d="M6099.52,-39630C6099.52,-39630 6099.52,-39603.93 6099.52,-39603.93"/>
<polygon fill="black" stroke="black" points="6103.02,-39603.93 6099.52,-39593.93 6096.02,-39603.93 6103.02,-39603.93"/>
</g>
<!-- layer10_moe_expert13 -->
<g id="node401" class="node">
<title>layer10_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6716,-39593.8 6378,-39593.8 6378,-39541.8 6716,-39541.8 6716,-39593.8"/>
<text text-anchor="middle" x="6547" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 13 L10</text>
<text text-anchor="middle" x="6547" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6547" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6547" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert13 -->
<g id="node421" class="node">
<title>layer10_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6438" cy="-39476.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6438" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6438" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6438" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer10_moe_expert13&#45;&gt;layer10_moe_comm_from_expert13 -->
<g id="edge534" class="edge">
<title>layer10_moe_expert13&#45;&gt;layer10_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6455.38,-39541.48C6455.38,-39541.48 6455.38,-39515.61 6455.38,-39515.61"/>
<polygon fill="black" stroke="black" points="6458.88,-39515.61 6455.38,-39505.61 6451.88,-39515.61 6458.88,-39515.61"/>
</g>
<!-- layer10_moe_comm_to_expert13&#45;&gt;layer10_moe_expert13 -->
<g id="edge503" class="edge">
<title>layer10_moe_comm_to_expert13&#45;&gt;layer10_moe_expert13</title>
<path fill="none" stroke="black" d="M6454.02,-39630C6454.02,-39630 6454.02,-39603.93 6454.02,-39603.93"/>
<polygon fill="black" stroke="black" points="6457.52,-39603.93 6454.02,-39593.93 6450.52,-39603.93 6457.52,-39603.93"/>
</g>
<!-- layer10_moe_expert14 -->
<g id="node403" class="node">
<title>layer10_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7072,-39593.8 6734,-39593.8 6734,-39541.8 7072,-39541.8 7072,-39593.8"/>
<text text-anchor="middle" x="6903" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 14 L10</text>
<text text-anchor="middle" x="6903" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6903" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6903" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert14 -->
<g id="node422" class="node">
<title>layer10_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6793" cy="-39476.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6793" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6793" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6793" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer10_moe_expert14&#45;&gt;layer10_moe_comm_from_expert14 -->
<g id="edge536" class="edge">
<title>layer10_moe_expert14&#45;&gt;layer10_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6810.88,-39541.48C6810.88,-39541.48 6810.88,-39515.29 6810.88,-39515.29"/>
<polygon fill="black" stroke="black" points="6814.38,-39515.29 6810.88,-39505.29 6807.38,-39515.29 6814.38,-39515.29"/>
</g>
<!-- layer10_moe_comm_to_expert14&#45;&gt;layer10_moe_expert14 -->
<g id="edge505" class="edge">
<title>layer10_moe_comm_to_expert14&#45;&gt;layer10_moe_expert14</title>
<path fill="none" stroke="black" d="M6809.52,-39630C6809.52,-39630 6809.52,-39603.93 6809.52,-39603.93"/>
<polygon fill="black" stroke="black" points="6813.02,-39603.93 6809.52,-39593.93 6806.02,-39603.93 6813.02,-39603.93"/>
</g>
<!-- layer10_moe_expert15 -->
<g id="node405" class="node">
<title>layer10_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7428,-39593.8 7090,-39593.8 7090,-39541.8 7428,-39541.8 7428,-39593.8"/>
<text text-anchor="middle" x="7259" y="-39581.8" font-family="Arial" font-size="10.00">EXPERT 15 L10</text>
<text text-anchor="middle" x="7259" y="-39570.8" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7259" y="-39559.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7259" y="-39548.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_comm_from_expert15 -->
<g id="node423" class="node">
<title>layer10_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7148" cy="-39476.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7148" y="-39485.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7148" y="-39474.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7148" y="-39463.31" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer10_moe_expert15&#45;&gt;layer10_moe_comm_from_expert15 -->
<g id="edge538" class="edge">
<title>layer10_moe_expert15&#45;&gt;layer10_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7166.38,-39541.48C7166.38,-39541.48 7166.38,-39515.29 7166.38,-39515.29"/>
<polygon fill="black" stroke="black" points="7169.88,-39515.29 7166.38,-39505.29 7162.88,-39515.29 7169.88,-39515.29"/>
</g>
<!-- layer10_moe_comm_to_expert15&#45;&gt;layer10_moe_expert15 -->
<g id="edge507" class="edge">
<title>layer10_moe_comm_to_expert15&#45;&gt;layer10_moe_expert15</title>
<path fill="none" stroke="black" d="M7165.02,-39630C7165.02,-39630 7165.02,-39603.93 7165.02,-39603.93"/>
<polygon fill="black" stroke="black" points="7168.52,-39603.93 7165.02,-39593.93 7161.52,-39603.93 7168.52,-39603.93"/>
</g>
<!-- layer10_moe_aggregate -->
<g id="node407" class="node">
<title>layer10_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4834.1,-39411.81 4417.16,-39411.81 4309.9,-39307.81 4726.84,-39307.81 4834.1,-39411.81"/>
<text text-anchor="middle" x="4572" y="-39373.81" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L10</text>
<text text-anchor="middle" x="4572" y="-39362.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4572" y="-39351.81" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4572" y="-39340.81" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_mha -->
<g id="node424" class="node">
<title>layer11_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4702,-39271.81 4442,-39271.81 4442,-39219.81 4702,-39219.81 4702,-39271.81"/>
<text text-anchor="middle" x="4572" y="-39259.81" font-family="Arial" font-size="10.00">MHA L11</text>
<text text-anchor="middle" x="4572" y="-39248.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4572" y="-39237.81" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4572" y="-39226.81" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer10_moe_aggregate&#45;&gt;layer11_moe_mha -->
<g id="edge607" class="edge">
<title>layer10_moe_aggregate&#45;&gt;layer11_moe_mha</title>
<path fill="none" stroke="black" d="M4572,-39307.49C4572,-39307.49 4572,-39282.04 4572,-39282.04"/>
<polygon fill="black" stroke="black" points="4575.5,-39282.04 4572,-39272.04 4568.5,-39282.04 4575.5,-39282.04"/>
</g>
<!-- layer10_moe_comm_from_expert0&#45;&gt;layer10_moe_aggregate -->
<g id="edge509" class="edge">
<title>layer10_moe_comm_from_expert0&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M2214.75,-39449.84C2214.75,-39405.49 2214.75,-39322 2214.75,-39322 2214.75,-39322 4314.47,-39322 4314.47,-39322"/>
<polygon fill="black" stroke="black" points="4314.47,-39325.5 4324.47,-39322 4314.47,-39318.5 4314.47,-39325.5"/>
</g>
<!-- layer10_moe_comm_from_expert1&#45;&gt;layer10_moe_aggregate -->
<g id="edge511" class="edge">
<title>layer10_moe_comm_from_expert1&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M2523.75,-39459.1C2523.75,-39421.48 2523.75,-39337 2523.75,-39337 2523.75,-39337 4329.53,-39337 4329.53,-39337"/>
<polygon fill="black" stroke="black" points="4329.53,-39340.5 4339.53,-39337 4329.53,-39333.5 4329.53,-39340.5"/>
</g>
<!-- layer10_moe_comm_from_expert2&#45;&gt;layer10_moe_aggregate -->
<g id="edge513" class="edge">
<title>layer10_moe_comm_from_expert2&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M2878.75,-39455.63C2878.75,-39420.03 2878.75,-39352 2878.75,-39352 2878.75,-39352 4345.4,-39352 4345.4,-39352"/>
<polygon fill="black" stroke="black" points="4345.4,-39355.5 4355.4,-39352 4345.4,-39348.5 4345.4,-39355.5"/>
</g>
<!-- layer10_moe_comm_from_expert3&#45;&gt;layer10_moe_aggregate -->
<g id="edge515" class="edge">
<title>layer10_moe_comm_from_expert3&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M3392.51,-39465.47C3392.51,-39437.41 3392.51,-39367 3392.51,-39367 3392.51,-39367 4360.91,-39367 4360.91,-39367"/>
<polygon fill="black" stroke="black" points="4360.91,-39370.5 4370.91,-39367 4360.91,-39363.5 4360.91,-39370.5"/>
</g>
<!-- layer10_moe_comm_from_expert4&#45;&gt;layer10_moe_aggregate -->
<g id="edge517" class="edge">
<title>layer10_moe_comm_from_expert4&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M3666.5,-39447.85C3666.5,-39419.97 3666.5,-39382 3666.5,-39382 3666.5,-39382 4376.3,-39382 4376.3,-39382"/>
<polygon fill="black" stroke="black" points="4376.3,-39385.5 4386.3,-39382 4376.3,-39378.5 4376.3,-39385.5"/>
</g>
<!-- layer10_moe_comm_from_expert5&#45;&gt;layer10_moe_aggregate -->
<g id="edge519" class="edge">
<title>layer10_moe_comm_from_expert5&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M3948,-39448.54C3948,-39425.24 3948,-39396 3948,-39396 3948,-39396 4390.66,-39396 4390.66,-39396"/>
<polygon fill="black" stroke="black" points="4390.66,-39399.5 4400.66,-39396 4390.66,-39392.5 4390.66,-39399.5"/>
</g>
<!-- layer10_moe_comm_from_expert6&#45;&gt;layer10_moe_aggregate -->
<g id="edge521" class="edge">
<title>layer10_moe_comm_from_expert6&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M4253.48,-39476C4299.6,-39476 4346.1,-39476 4346.1,-39476 4346.1,-39476 4346.1,-39369.9 4346.1,-39369.9"/>
<polygon fill="black" stroke="black" points="4349.6,-39369.9 4346.1,-39359.9 4342.6,-39369.9 4349.6,-39369.9"/>
</g>
<!-- layer10_moe_comm_from_expert7&#45;&gt;layer10_moe_aggregate -->
<g id="edge523" class="edge">
<title>layer10_moe_comm_from_expert7&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M4473,-39447.59C4473,-39447.59 4473,-39421.87 4473,-39421.87"/>
<polygon fill="black" stroke="black" points="4476.5,-39421.87 4473,-39411.87 4469.5,-39421.87 4476.5,-39421.87"/>
</g>
<!-- layer10_moe_comm_from_expert8&#45;&gt;layer10_moe_aggregate -->
<g id="edge525" class="edge">
<title>layer10_moe_comm_from_expert8&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M4744.39,-39447.59C4744.39,-39447.59 4744.39,-39421.87 4744.39,-39421.87"/>
<polygon fill="black" stroke="black" points="4747.89,-39421.87 4744.39,-39411.87 4740.89,-39421.87 4747.89,-39421.87"/>
</g>
<!-- layer10_moe_comm_from_expert9&#45;&gt;layer10_moe_aggregate -->
<g id="edge527" class="edge">
<title>layer10_moe_comm_from_expert9&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M5035.5,-39448.36C5035.5,-39425.78 5035.5,-39398 5035.5,-39398 5035.5,-39398 4830.03,-39398 4830.03,-39398"/>
<polygon fill="black" stroke="black" points="4830.03,-39394.5 4820.03,-39398 4830.03,-39401.5 4830.03,-39394.5"/>
</g>
<!-- layer10_moe_comm_from_expert10&#45;&gt;layer10_moe_aggregate -->
<g id="edge529" class="edge">
<title>layer10_moe_comm_from_expert10&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M5367.15,-39448.26C5367.15,-39421.31 5367.15,-39385 5367.15,-39385 5367.15,-39385 4816.54,-39385 4816.54,-39385"/>
<polygon fill="black" stroke="black" points="4816.54,-39381.5 4806.54,-39385 4816.54,-39388.5 4816.54,-39381.5"/>
</g>
<!-- layer10_moe_comm_from_expert11&#45;&gt;layer10_moe_aggregate -->
<g id="edge531" class="edge">
<title>layer10_moe_comm_from_expert11&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M5713.65,-39448.17C5713.65,-39417.14 5713.65,-39372 5713.65,-39372 5713.65,-39372 4803.14,-39372 4803.14,-39372"/>
<polygon fill="black" stroke="black" points="4803.14,-39368.5 4793.14,-39372 4803.14,-39375.5 4803.14,-39368.5"/>
</g>
<!-- layer10_moe_comm_from_expert12&#45;&gt;layer10_moe_aggregate -->
<g id="edge533" class="edge">
<title>layer10_moe_comm_from_expert12&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M6064.65,-39448.29C6064.65,-39413.42 6064.65,-39359 6064.65,-39359 6064.65,-39359 4789.94,-39359 4789.94,-39359"/>
<polygon fill="black" stroke="black" points="4789.94,-39355.5 4779.94,-39359 4789.94,-39362.5 4789.94,-39355.5"/>
</g>
<!-- layer10_moe_comm_from_expert13&#45;&gt;layer10_moe_aggregate -->
<g id="edge535" class="edge">
<title>layer10_moe_comm_from_expert13&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M6418.15,-39448.42C6418.15,-39409.95 6418.15,-39346 6418.15,-39346 6418.15,-39346 4776.52,-39346 4776.52,-39346"/>
<polygon fill="black" stroke="black" points="4776.52,-39342.5 4766.52,-39346 4776.52,-39349.5 4776.52,-39342.5"/>
</g>
<!-- layer10_moe_comm_from_expert14&#45;&gt;layer10_moe_aggregate -->
<g id="edge537" class="edge">
<title>layer10_moe_comm_from_expert14&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M6773.15,-39448.39C6773.15,-39406.49 6773.15,-39333 6773.15,-39333 6773.15,-39333 4763.06,-39333 4763.06,-39333"/>
<polygon fill="black" stroke="black" points="4763.06,-39329.5 4753.06,-39333 4763.06,-39336.5 4763.06,-39329.5"/>
</g>
<!-- layer10_moe_comm_from_expert15&#45;&gt;layer10_moe_aggregate -->
<g id="edge539" class="edge">
<title>layer10_moe_comm_from_expert15&#45;&gt;layer10_moe_aggregate</title>
<path fill="none" stroke="black" d="M7128.15,-39448.41C7128.15,-39403.22 7128.15,-39320 7128.15,-39320 7128.15,-39320 4749.72,-39320 4749.72,-39320"/>
<polygon fill="black" stroke="black" points="4749.72,-39316.5 4739.72,-39320 4749.72,-39323.5 4749.72,-39316.5"/>
</g>
<!-- layer11_moe_gate -->
<g id="node425" class="node">
<title>layer11_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4830.3,-39183.81 4419.4,-39183.81 4313.7,-39079.81 4724.6,-39079.81 4830.3,-39183.81"/>
<text text-anchor="middle" x="4572" y="-39145.81" font-family="Arial" font-size="10.00">GATE L11</text>
<text text-anchor="middle" x="4572" y="-39134.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4572" y="-39123.81" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4572" y="-39112.81" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer11_moe_mha&#45;&gt;layer11_moe_gate -->
<g id="edge608" class="edge">
<title>layer11_moe_mha&#45;&gt;layer11_moe_gate</title>
<path fill="none" stroke="black" d="M4572,-39219.66C4572,-39219.66 4572,-39193.91 4572,-39193.91"/>
<polygon fill="black" stroke="black" points="4575.5,-39193.91 4572,-39183.91 4568.5,-39193.91 4575.5,-39193.91"/>
</g>
<!-- layer11_moe_split -->
<g id="node426" class="node">
<title>layer11_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4826.01,-39043.81 4421.94,-39043.81 4317.99,-38939.81 4722.06,-38939.81 4826.01,-39043.81"/>
<text text-anchor="middle" x="4572" y="-39005.81" font-family="Arial" font-size="10.00">SPLIT TOKENS L11</text>
<text text-anchor="middle" x="4572" y="-38994.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4572" y="-38983.81" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4572" y="-38972.81" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer11_moe_gate&#45;&gt;layer11_moe_split -->
<g id="edge609" class="edge">
<title>layer11_moe_gate&#45;&gt;layer11_moe_split</title>
<path fill="none" stroke="black" d="M4572,-39079.68C4572,-39079.68 4572,-39053.99 4572,-39053.99"/>
<polygon fill="black" stroke="black" points="4575.5,-39053.99 4572,-39043.99 4568.5,-39053.99 4575.5,-39053.99"/>
</g>
<!-- layer11_moe_comm_to_expert0 -->
<g id="node428" class="node">
<title>layer11_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2050" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2050" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2050" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2050" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert0 -->
<g id="edge543" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4406.01,-39028C3854.06,-39028 2115,-39028 2115,-39028 2115,-39028 2115,-38905.16 2115,-38905.16"/>
<polygon fill="black" stroke="black" points="2118.5,-38905.16 2115,-38895.16 2111.5,-38905.16 2118.5,-38905.16"/>
</g>
<!-- layer11_moe_comm_to_expert1 -->
<g id="node430" class="node">
<title>layer11_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2408" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2408" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2408" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2408" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert1 -->
<g id="edge545" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4391.68,-39014C3875.67,-39014 2430,-39014 2430,-39014 2430,-39014 2430,-38912.99 2430,-38912.99"/>
<polygon fill="black" stroke="black" points="2433.5,-38912.99 2430,-38902.99 2426.5,-38912.99 2433.5,-38912.99"/>
</g>
<!-- layer11_moe_comm_to_expert2 -->
<g id="node432" class="node">
<title>layer11_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2729" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2729" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2729" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2729" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert2 -->
<g id="edge547" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4376.86,-38999C3911,-38999 2772.5,-38999 2772.5,-38999 2772.5,-38999 2772.5,-38910.25 2772.5,-38910.25"/>
<polygon fill="black" stroke="black" points="2776,-38910.25 2772.5,-38900.25 2769,-38910.25 2776,-38910.25"/>
</g>
<!-- layer11_moe_comm_to_expert3 -->
<g id="node434" class="node">
<title>layer11_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3295" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3295" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3295" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3295" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert3 -->
<g id="edge549" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4361.93,-38984C4001.11,-38984 3302,-38984 3302,-38984 3302,-38984 3302,-38913.79 3302,-38913.79"/>
<polygon fill="black" stroke="black" points="3305.5,-38913.79 3302,-38903.79 3298.5,-38913.79 3305.5,-38913.79"/>
</g>
<!-- layer11_moe_comm_to_expert4 -->
<g id="node436" class="node">
<title>layer11_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3678" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3678" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3678" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3678" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert4 -->
<g id="edge551" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4347.14,-38969C4105.91,-38969 3757.01,-38969 3757.01,-38969 3757.01,-38969 3757.01,-38899.13 3757.01,-38899.13"/>
<polygon fill="black" stroke="black" points="3760.51,-38899.13 3757.01,-38889.13 3753.51,-38899.13 3760.51,-38899.13"/>
</g>
<!-- layer11_moe_comm_to_expert5 -->
<g id="node438" class="node">
<title>layer11_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3969" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3969" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3969" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3969" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert5 -->
<g id="edge553" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4331.79,-38954C4190.18,-38954 4038.51,-38954 4038.51,-38954 4038.51,-38954 4038.51,-38903.59 4038.51,-38903.59"/>
<polygon fill="black" stroke="black" points="4042.01,-38903.59 4038.51,-38893.59 4035.01,-38903.59 4042.01,-38903.59"/>
</g>
<!-- layer11_moe_comm_to_expert6 -->
<g id="node440" class="node">
<title>layer11_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4214" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4214" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4214" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4214" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert6 -->
<g id="edge555" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4331.74,-38991.73C4331.74,-38988.16 4331.74,-38874 4331.74,-38874 4331.74,-38874 4314.73,-38874 4314.73,-38874"/>
<polygon fill="black" stroke="black" points="4314.73,-38870.5 4304.73,-38874 4314.73,-38877.5 4314.73,-38870.5"/>
</g>
<!-- layer11_moe_comm_to_expert7 -->
<g id="node442" class="node">
<title>layer11_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4436" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4436" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4436" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4436" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert7 -->
<g id="edge557" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4436,-38939.48C4436,-38939.48 4436,-38914.03 4436,-38914.03"/>
<polygon fill="black" stroke="black" points="4439.5,-38914.03 4436,-38904.03 4432.5,-38914.03 4439.5,-38914.03"/>
</g>
<!-- layer11_moe_comm_to_expert8 -->
<g id="node444" class="node">
<title>layer11_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4708" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4708" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4708" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4708" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert8 -->
<g id="edge559" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4708,-38939.48C4708,-38939.48 4708,-38914.03 4708,-38914.03"/>
<polygon fill="black" stroke="black" points="4711.5,-38914.03 4708,-38904.03 4704.5,-38914.03 4711.5,-38914.03"/>
</g>
<!-- layer11_moe_comm_to_expert9 -->
<g id="node446" class="node">
<title>layer11_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5017" cy="-38874.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5017" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="5017" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5017" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert9 -->
<g id="edge561" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4812.26,-38991.73C4812.26,-38988.16 4812.26,-38874 4812.26,-38874 4812.26,-38874 4916.3,-38874 4916.3,-38874"/>
<polygon fill="black" stroke="black" points="4916.3,-38877.5 4926.3,-38874 4916.3,-38870.5 4916.3,-38877.5"/>
</g>
<!-- layer11_moe_comm_to_expert10 -->
<g id="node448" class="node">
<title>layer11_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5349" cy="-38874.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5349" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5349" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5349" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert10 -->
<g id="edge563" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4736.38,-38954C4943.6,-38954 5273.1,-38954 5273.1,-38954 5273.1,-38954 5273.1,-38902 5273.1,-38902"/>
<polygon fill="black" stroke="black" points="5276.6,-38902 5273.1,-38892 5269.6,-38902 5276.6,-38902"/>
</g>
<!-- layer11_moe_comm_to_expert11 -->
<g id="node450" class="node">
<title>layer11_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5695" cy="-38874.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5695" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5695" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5695" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert11 -->
<g id="edge565" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4751.49,-38969C5050.86,-38969 5619.6,-38969 5619.6,-38969 5619.6,-38969 5619.6,-38902.54 5619.6,-38902.54"/>
<polygon fill="black" stroke="black" points="5623.1,-38902.54 5619.6,-38892.54 5616.1,-38902.54 5623.1,-38902.54"/>
</g>
<!-- layer11_moe_comm_to_expert12 -->
<g id="node452" class="node">
<title>layer11_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6046" cy="-38874.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6046" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6046" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6046" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert12 -->
<g id="edge567" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4766.47,-38984C5150.77,-38984 5970.6,-38984 5970.6,-38984 5970.6,-38984 5970.6,-38902.36 5970.6,-38902.36"/>
<polygon fill="black" stroke="black" points="5974.1,-38902.36 5970.6,-38892.36 5967.1,-38902.36 5974.1,-38902.36"/>
</g>
<!-- layer11_moe_comm_to_expert13 -->
<g id="node454" class="node">
<title>layer11_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6399" cy="-38874.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6399" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6399" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6399" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert13 -->
<g id="edge569" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4781.6,-38999C5246.67,-38999 6324.1,-38999 6324.1,-38999 6324.1,-38999 6324.1,-38902.61 6324.1,-38902.61"/>
<polygon fill="black" stroke="black" points="6327.6,-38902.61 6324.1,-38892.61 6320.6,-38902.61 6327.6,-38902.61"/>
</g>
<!-- layer11_moe_comm_to_expert14 -->
<g id="node456" class="node">
<title>layer11_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6754" cy="-38874.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6754" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6754" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6754" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert14 -->
<g id="edge571" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4796.5,-39014C5339.43,-39014 6679.1,-39014 6679.1,-39014 6679.1,-39014 6679.1,-38902.45 6679.1,-38902.45"/>
<polygon fill="black" stroke="black" points="6682.6,-38902.45 6679.1,-38892.45 6675.6,-38902.45 6682.6,-38902.45"/>
</g>
<!-- layer11_moe_comm_to_expert15 -->
<g id="node458" class="node">
<title>layer11_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7109" cy="-38874.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7109" y="-38883.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7109" y="-38872.32" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7109" y="-38861.32" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert15 -->
<g id="edge573" class="edge">
<title>layer11_moe_split&#45;&gt;layer11_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4810.31,-39028C5428.21,-39028 7034.1,-39028 7034.1,-39028 7034.1,-39028 7034.1,-38902.39 7034.1,-38902.39"/>
<polygon fill="black" stroke="black" points="7037.6,-38902.39 7034.1,-38892.39 7030.6,-38902.39 7037.6,-38902.39"/>
</g>
<!-- layer11_moe_expert0 -->
<g id="node427" class="node">
<title>layer11_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2141,-38809.83 1813,-38809.83 1813,-38757.83 2141,-38757.83 2141,-38809.83"/>
<text text-anchor="middle" x="1977" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 0 L11</text>
<text text-anchor="middle" x="1977" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1977" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1977" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert0 -->
<g id="node460" class="node">
<title>layer11_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2050" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2050" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2050" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2050" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer11_moe_expert0&#45;&gt;layer11_moe_comm_from_expert0 -->
<g id="edge575" class="edge">
<title>layer11_moe_expert0&#45;&gt;layer11_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2050,-38757.51C2050,-38757.51 2050,-38731.97 2050,-38731.97"/>
<polygon fill="black" stroke="black" points="2053.5,-38731.97 2050,-38721.97 2046.5,-38731.97 2053.5,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert0&#45;&gt;layer11_moe_expert0 -->
<g id="edge544" class="edge">
<title>layer11_moe_comm_to_expert0&#45;&gt;layer11_moe_expert0</title>
<path fill="none" stroke="black" d="M2050,-38845.78C2050,-38845.78 2050,-38820.13 2050,-38820.13"/>
<polygon fill="black" stroke="black" points="2053.5,-38820.13 2050,-38810.13 2046.5,-38820.13 2053.5,-38820.13"/>
</g>
<!-- layer11_moe_expert1 -->
<g id="node429" class="node">
<title>layer11_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2487,-38809.83 2159,-38809.83 2159,-38757.83 2487,-38757.83 2487,-38809.83"/>
<text text-anchor="middle" x="2323" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 1 L11</text>
<text text-anchor="middle" x="2323" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2323" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2323" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert1 -->
<g id="node461" class="node">
<title>layer11_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2408" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2408" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2408" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2408" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer11_moe_expert1&#45;&gt;layer11_moe_comm_from_expert1 -->
<g id="edge577" class="edge">
<title>layer11_moe_expert1&#45;&gt;layer11_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2402.25,-38757.51C2402.25,-38757.51 2402.25,-38731.97 2402.25,-38731.97"/>
<polygon fill="black" stroke="black" points="2405.75,-38731.97 2402.25,-38721.97 2398.75,-38731.97 2405.75,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert1&#45;&gt;layer11_moe_expert1 -->
<g id="edge546" class="edge">
<title>layer11_moe_comm_to_expert1&#45;&gt;layer11_moe_expert1</title>
<path fill="none" stroke="black" d="M2402.25,-38845.78C2402.25,-38845.78 2402.25,-38820.13 2402.25,-38820.13"/>
<polygon fill="black" stroke="black" points="2405.75,-38820.13 2402.25,-38810.13 2398.75,-38820.13 2405.75,-38820.13"/>
</g>
<!-- layer11_moe_expert2 -->
<g id="node431" class="node">
<title>layer11_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2833,-38809.83 2505,-38809.83 2505,-38757.83 2833,-38757.83 2833,-38809.83"/>
<text text-anchor="middle" x="2669" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 2 L11</text>
<text text-anchor="middle" x="2669" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2669" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2669" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert2 -->
<g id="node462" class="node">
<title>layer11_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2729" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2729" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2729" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2729" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer11_moe_expert2&#45;&gt;layer11_moe_comm_from_expert2 -->
<g id="edge579" class="edge">
<title>layer11_moe_expert2&#45;&gt;layer11_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2729,-38757.51C2729,-38757.51 2729,-38731.97 2729,-38731.97"/>
<polygon fill="black" stroke="black" points="2732.5,-38731.97 2729,-38721.97 2725.5,-38731.97 2732.5,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert2&#45;&gt;layer11_moe_expert2 -->
<g id="edge548" class="edge">
<title>layer11_moe_comm_to_expert2&#45;&gt;layer11_moe_expert2</title>
<path fill="none" stroke="black" d="M2729,-38845.78C2729,-38845.78 2729,-38820.13 2729,-38820.13"/>
<polygon fill="black" stroke="black" points="2732.5,-38820.13 2729,-38810.13 2725.5,-38820.13 2732.5,-38820.13"/>
</g>
<!-- layer11_moe_expert3 -->
<g id="node433" class="node">
<title>layer11_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3179,-38809.83 2851,-38809.83 2851,-38757.83 3179,-38757.83 3179,-38809.83"/>
<text text-anchor="middle" x="3015" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 3 L11</text>
<text text-anchor="middle" x="3015" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3015" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="3015" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert3 -->
<g id="node463" class="node">
<title>layer11_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3295" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3295" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3295" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3295" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer11_moe_expert3&#45;&gt;layer11_moe_comm_from_expert3 -->
<g id="edge581" class="edge">
<title>layer11_moe_expert3&#45;&gt;layer11_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3125.25,-38757.76C3125.25,-38730.61 3125.25,-38692 3125.25,-38692 3125.25,-38692 3194.16,-38692 3194.16,-38692"/>
<polygon fill="black" stroke="black" points="3194.16,-38695.5 3204.16,-38692 3194.16,-38688.5 3194.16,-38695.5"/>
</g>
<!-- layer11_moe_comm_to_expert3&#45;&gt;layer11_moe_expert3 -->
<g id="edge550" class="edge">
<title>layer11_moe_comm_to_expert3&#45;&gt;layer11_moe_expert3</title>
<path fill="none" stroke="black" d="M3204.29,-38874C3131.97,-38874 3042.75,-38874 3042.75,-38874 3042.75,-38874 3042.75,-38819.91 3042.75,-38819.91"/>
<polygon fill="black" stroke="black" points="3046.25,-38819.91 3042.75,-38809.91 3039.25,-38819.91 3046.25,-38819.91"/>
</g>
<!-- layer11_moe_expert4 -->
<g id="node435" class="node">
<title>layer11_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3525,-38809.83 3197,-38809.83 3197,-38757.83 3525,-38757.83 3525,-38809.83"/>
<text text-anchor="middle" x="3361" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 4 L11</text>
<text text-anchor="middle" x="3361" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3361" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3361" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert4 -->
<g id="node464" class="node">
<title>layer11_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3678" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3678" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3678" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3678" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer11_moe_expert4&#45;&gt;layer11_moe_comm_from_expert4 -->
<g id="edge583" class="edge">
<title>layer11_moe_expert4&#45;&gt;layer11_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3478.18,-38757.76C3478.18,-38730.61 3478.18,-38692 3478.18,-38692 3478.18,-38692 3577.44,-38692 3577.44,-38692"/>
<polygon fill="black" stroke="black" points="3577.44,-38695.5 3587.44,-38692 3577.44,-38688.5 3577.44,-38695.5"/>
</g>
<!-- layer11_moe_comm_to_expert4&#45;&gt;layer11_moe_expert4 -->
<g id="edge552" class="edge">
<title>layer11_moe_comm_to_expert4&#45;&gt;layer11_moe_expert4</title>
<path fill="none" stroke="black" d="M3587.44,-38874C3528.4,-38874 3462.25,-38874 3462.25,-38874 3462.25,-38874 3462.25,-38819.91 3462.25,-38819.91"/>
<polygon fill="black" stroke="black" points="3465.75,-38819.91 3462.25,-38809.91 3458.75,-38819.91 3465.75,-38819.91"/>
</g>
<!-- layer11_moe_expert5 -->
<g id="node437" class="node">
<title>layer11_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3871,-38809.83 3543,-38809.83 3543,-38757.83 3871,-38757.83 3871,-38809.83"/>
<text text-anchor="middle" x="3707" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 5 L11</text>
<text text-anchor="middle" x="3707" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3707" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3707" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert5 -->
<g id="node465" class="node">
<title>layer11_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3969" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3969" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3969" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3969" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer11_moe_expert5&#45;&gt;layer11_moe_comm_from_expert5 -->
<g id="edge585" class="edge">
<title>layer11_moe_expert5&#45;&gt;layer11_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3871.19,-38775C3880.1,-38775 3885.5,-38775 3885.5,-38775 3885.5,-38775 3885.5,-38714.26 3885.5,-38714.26"/>
<polygon fill="black" stroke="black" points="3889,-38714.26 3885.5,-38704.26 3882,-38714.26 3889,-38714.26"/>
</g>
<!-- layer11_moe_comm_to_expert5&#45;&gt;layer11_moe_expert5 -->
<g id="edge554" class="edge">
<title>layer11_moe_comm_to_expert5&#45;&gt;layer11_moe_expert5</title>
<path fill="none" stroke="black" d="M3881.99,-38866.58C3881.99,-38845.63 3881.99,-38792 3881.99,-38792 3881.99,-38792 3880.9,-38792 3880.9,-38792"/>
<polygon fill="black" stroke="black" points="3881.05,-38788.5 3871.05,-38792 3881.05,-38795.5 3881.05,-38788.5"/>
</g>
<!-- layer11_moe_expert6 -->
<g id="node439" class="node">
<title>layer11_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4217,-38809.83 3889,-38809.83 3889,-38757.83 4217,-38757.83 4217,-38809.83"/>
<text text-anchor="middle" x="4053" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 6 L11</text>
<text text-anchor="middle" x="4053" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4053" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4053" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert6 -->
<g id="node466" class="node">
<title>layer11_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4214" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4214" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4214" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4214" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer11_moe_expert6&#45;&gt;layer11_moe_comm_from_expert6 -->
<g id="edge587" class="edge">
<title>layer11_moe_expert6&#45;&gt;layer11_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4170.25,-38757.51C4170.25,-38757.51 4170.25,-38728.47 4170.25,-38728.47"/>
<polygon fill="black" stroke="black" points="4173.75,-38728.47 4170.25,-38718.47 4166.75,-38728.47 4173.75,-38728.47"/>
</g>
<!-- layer11_moe_comm_to_expert6&#45;&gt;layer11_moe_expert6 -->
<g id="edge556" class="edge">
<title>layer11_moe_comm_to_expert6&#45;&gt;layer11_moe_expert6</title>
<path fill="none" stroke="black" d="M4170.25,-38848.99C4170.25,-38848.99 4170.25,-38820.04 4170.25,-38820.04"/>
<polygon fill="black" stroke="black" points="4173.75,-38820.04 4170.25,-38810.04 4166.75,-38820.04 4173.75,-38820.04"/>
</g>
<!-- layer11_moe_expert7 -->
<g id="node441" class="node">
<title>layer11_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4563,-38809.83 4235,-38809.83 4235,-38757.83 4563,-38757.83 4563,-38809.83"/>
<text text-anchor="middle" x="4399" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 7 L11</text>
<text text-anchor="middle" x="4399" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4399" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4399" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert7 -->
<g id="node467" class="node">
<title>layer11_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4436" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4436" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4436" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4436" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer11_moe_expert7&#45;&gt;layer11_moe_comm_from_expert7 -->
<g id="edge589" class="edge">
<title>layer11_moe_expert7&#45;&gt;layer11_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4436,-38757.51C4436,-38757.51 4436,-38731.97 4436,-38731.97"/>
<polygon fill="black" stroke="black" points="4439.5,-38731.97 4436,-38721.97 4432.5,-38731.97 4439.5,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert7&#45;&gt;layer11_moe_expert7 -->
<g id="edge558" class="edge">
<title>layer11_moe_comm_to_expert7&#45;&gt;layer11_moe_expert7</title>
<path fill="none" stroke="black" d="M4436,-38845.78C4436,-38845.78 4436,-38820.13 4436,-38820.13"/>
<polygon fill="black" stroke="black" points="4439.5,-38820.13 4436,-38810.13 4432.5,-38820.13 4439.5,-38820.13"/>
</g>
<!-- layer11_moe_expert8 -->
<g id="node443" class="node">
<title>layer11_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4909,-38809.83 4581,-38809.83 4581,-38757.83 4909,-38757.83 4909,-38809.83"/>
<text text-anchor="middle" x="4745" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 8 L11</text>
<text text-anchor="middle" x="4745" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4745" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4745" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert8 -->
<g id="node468" class="node">
<title>layer11_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4708" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4708" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4708" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4708" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer11_moe_expert8&#45;&gt;layer11_moe_comm_from_expert8 -->
<g id="edge591" class="edge">
<title>layer11_moe_expert8&#45;&gt;layer11_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4708,-38757.51C4708,-38757.51 4708,-38731.97 4708,-38731.97"/>
<polygon fill="black" stroke="black" points="4711.5,-38731.97 4708,-38721.97 4704.5,-38731.97 4711.5,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert8&#45;&gt;layer11_moe_expert8 -->
<g id="edge560" class="edge">
<title>layer11_moe_comm_to_expert8&#45;&gt;layer11_moe_expert8</title>
<path fill="none" stroke="black" d="M4708,-38845.78C4708,-38845.78 4708,-38820.13 4708,-38820.13"/>
<polygon fill="black" stroke="black" points="4711.5,-38820.13 4708,-38810.13 4704.5,-38820.13 4711.5,-38820.13"/>
</g>
<!-- layer11_moe_expert9 -->
<g id="node445" class="node">
<title>layer11_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5255,-38809.83 4927,-38809.83 4927,-38757.83 5255,-38757.83 5255,-38809.83"/>
<text text-anchor="middle" x="5091" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 9 L11</text>
<text text-anchor="middle" x="5091" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5091" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5091" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert9 -->
<g id="node469" class="node">
<title>layer11_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="5017" cy="-38692.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="5017" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="5017" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5017" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer11_moe_expert9&#45;&gt;layer11_moe_comm_from_expert9 -->
<g id="edge593" class="edge">
<title>layer11_moe_expert9&#45;&gt;layer11_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M5017.25,-38757.51C5017.25,-38757.51 5017.25,-38731.97 5017.25,-38731.97"/>
<polygon fill="black" stroke="black" points="5020.75,-38731.97 5017.25,-38721.97 5013.75,-38731.97 5020.75,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert9&#45;&gt;layer11_moe_expert9 -->
<g id="edge562" class="edge">
<title>layer11_moe_comm_to_expert9&#45;&gt;layer11_moe_expert9</title>
<path fill="none" stroke="black" d="M5017.25,-38845.78C5017.25,-38845.78 5017.25,-38820.13 5017.25,-38820.13"/>
<polygon fill="black" stroke="black" points="5020.75,-38820.13 5017.25,-38810.13 5013.75,-38820.13 5020.75,-38820.13"/>
</g>
<!-- layer11_moe_expert10 -->
<g id="node447" class="node">
<title>layer11_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5611,-38809.83 5273,-38809.83 5273,-38757.83 5611,-38757.83 5611,-38809.83"/>
<text text-anchor="middle" x="5442" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 10 L11</text>
<text text-anchor="middle" x="5442" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5442" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5442" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert10 -->
<g id="node470" class="node">
<title>layer11_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5349" cy="-38692.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5349" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5349" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5349" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer11_moe_expert10&#45;&gt;layer11_moe_comm_from_expert10 -->
<g id="edge595" class="edge">
<title>layer11_moe_expert10&#45;&gt;layer11_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5358.38,-38757.51C5358.38,-38757.51 5358.38,-38731.97 5358.38,-38731.97"/>
<polygon fill="black" stroke="black" points="5361.88,-38731.97 5358.38,-38721.97 5354.88,-38731.97 5361.88,-38731.97"/>
</g>
<!-- layer11_moe_comm_to_expert10&#45;&gt;layer11_moe_expert10 -->
<g id="edge564" class="edge">
<title>layer11_moe_comm_to_expert10&#45;&gt;layer11_moe_expert10</title>
<path fill="none" stroke="black" d="M5358.02,-38845.78C5358.02,-38845.78 5358.02,-38820.13 5358.02,-38820.13"/>
<polygon fill="black" stroke="black" points="5361.52,-38820.13 5358.02,-38810.13 5354.52,-38820.13 5361.52,-38820.13"/>
</g>
<!-- layer11_moe_expert11 -->
<g id="node449" class="node">
<title>layer11_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5967,-38809.83 5629,-38809.83 5629,-38757.83 5967,-38757.83 5967,-38809.83"/>
<text text-anchor="middle" x="5798" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 11 L11</text>
<text text-anchor="middle" x="5798" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5798" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5798" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert11 -->
<g id="node471" class="node">
<title>layer11_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5696" cy="-38692.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5696" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5696" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5696" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer11_moe_expert11&#45;&gt;layer11_moe_comm_from_expert11 -->
<g id="edge597" class="edge">
<title>layer11_moe_expert11&#45;&gt;layer11_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5709.88,-38757.51C5709.88,-38757.51 5709.88,-38731.65 5709.88,-38731.65"/>
<polygon fill="black" stroke="black" points="5713.38,-38731.65 5709.88,-38721.65 5706.38,-38731.65 5713.38,-38731.65"/>
</g>
<!-- layer11_moe_comm_to_expert11&#45;&gt;layer11_moe_expert11 -->
<g id="edge566" class="edge">
<title>layer11_moe_comm_to_expert11&#45;&gt;layer11_moe_expert11</title>
<path fill="none" stroke="black" d="M5709.02,-38846.03C5709.02,-38846.03 5709.02,-38819.97 5709.02,-38819.97"/>
<polygon fill="black" stroke="black" points="5712.52,-38819.97 5709.02,-38809.97 5705.52,-38819.97 5712.52,-38819.97"/>
</g>
<!-- layer11_moe_expert12 -->
<g id="node451" class="node">
<title>layer11_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6323,-38809.83 5985,-38809.83 5985,-38757.83 6323,-38757.83 6323,-38809.83"/>
<text text-anchor="middle" x="6154" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 12 L11</text>
<text text-anchor="middle" x="6154" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6154" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6154" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert12 -->
<g id="node472" class="node">
<title>layer11_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6047" cy="-38692.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6047" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6047" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6047" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer11_moe_expert12&#45;&gt;layer11_moe_comm_from_expert12 -->
<g id="edge599" class="edge">
<title>layer11_moe_expert12&#45;&gt;layer11_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6063.38,-38757.51C6063.38,-38757.51 6063.38,-38731.65 6063.38,-38731.65"/>
<polygon fill="black" stroke="black" points="6066.88,-38731.65 6063.38,-38721.65 6059.88,-38731.65 6066.88,-38731.65"/>
</g>
<!-- layer11_moe_comm_to_expert12&#45;&gt;layer11_moe_expert12 -->
<g id="edge568" class="edge">
<title>layer11_moe_comm_to_expert12&#45;&gt;layer11_moe_expert12</title>
<path fill="none" stroke="black" d="M6062.52,-38846.03C6062.52,-38846.03 6062.52,-38819.97 6062.52,-38819.97"/>
<polygon fill="black" stroke="black" points="6066.02,-38819.97 6062.52,-38809.97 6059.02,-38819.97 6066.02,-38819.97"/>
</g>
<!-- layer11_moe_expert13 -->
<g id="node453" class="node">
<title>layer11_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6679,-38809.83 6341,-38809.83 6341,-38757.83 6679,-38757.83 6679,-38809.83"/>
<text text-anchor="middle" x="6510" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 13 L11</text>
<text text-anchor="middle" x="6510" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6510" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6510" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert13 -->
<g id="node473" class="node">
<title>layer11_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6401" cy="-38692.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6401" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6401" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6401" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer11_moe_expert13&#45;&gt;layer11_moe_comm_from_expert13 -->
<g id="edge601" class="edge">
<title>layer11_moe_expert13&#45;&gt;layer11_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6418.38,-38757.51C6418.38,-38757.51 6418.38,-38731.65 6418.38,-38731.65"/>
<polygon fill="black" stroke="black" points="6421.88,-38731.65 6418.38,-38721.65 6414.88,-38731.65 6421.88,-38731.65"/>
</g>
<!-- layer11_moe_comm_to_expert13&#45;&gt;layer11_moe_expert13 -->
<g id="edge570" class="edge">
<title>layer11_moe_comm_to_expert13&#45;&gt;layer11_moe_expert13</title>
<path fill="none" stroke="black" d="M6417.02,-38846.03C6417.02,-38846.03 6417.02,-38819.97 6417.02,-38819.97"/>
<polygon fill="black" stroke="black" points="6420.52,-38819.97 6417.02,-38809.97 6413.52,-38819.97 6420.52,-38819.97"/>
</g>
<!-- layer11_moe_expert14 -->
<g id="node455" class="node">
<title>layer11_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="7035,-38809.83 6697,-38809.83 6697,-38757.83 7035,-38757.83 7035,-38809.83"/>
<text text-anchor="middle" x="6866" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 14 L11</text>
<text text-anchor="middle" x="6866" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6866" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6866" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert14 -->
<g id="node474" class="node">
<title>layer11_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6756" cy="-38692.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6756" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6756" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6756" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer11_moe_expert14&#45;&gt;layer11_moe_comm_from_expert14 -->
<g id="edge603" class="edge">
<title>layer11_moe_expert14&#45;&gt;layer11_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6773.88,-38757.51C6773.88,-38757.51 6773.88,-38731.33 6773.88,-38731.33"/>
<polygon fill="black" stroke="black" points="6777.38,-38731.33 6773.88,-38721.33 6770.38,-38731.33 6777.38,-38731.33"/>
</g>
<!-- layer11_moe_comm_to_expert14&#45;&gt;layer11_moe_expert14 -->
<g id="edge572" class="edge">
<title>layer11_moe_comm_to_expert14&#45;&gt;layer11_moe_expert14</title>
<path fill="none" stroke="black" d="M6772.52,-38846.03C6772.52,-38846.03 6772.52,-38819.97 6772.52,-38819.97"/>
<polygon fill="black" stroke="black" points="6776.02,-38819.97 6772.52,-38809.97 6769.02,-38819.97 6776.02,-38819.97"/>
</g>
<!-- layer11_moe_expert15 -->
<g id="node457" class="node">
<title>layer11_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7391,-38809.83 7053,-38809.83 7053,-38757.83 7391,-38757.83 7391,-38809.83"/>
<text text-anchor="middle" x="7222" y="-38797.83" font-family="Arial" font-size="10.00">EXPERT 15 L11</text>
<text text-anchor="middle" x="7222" y="-38786.83" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7222" y="-38775.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7222" y="-38764.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_comm_from_expert15 -->
<g id="node475" class="node">
<title>layer11_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7111" cy="-38692.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7111" y="-38701.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7111" y="-38690.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7111" y="-38679.34" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer11_moe_expert15&#45;&gt;layer11_moe_comm_from_expert15 -->
<g id="edge605" class="edge">
<title>layer11_moe_expert15&#45;&gt;layer11_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7129.38,-38757.51C7129.38,-38757.51 7129.38,-38731.33 7129.38,-38731.33"/>
<polygon fill="black" stroke="black" points="7132.88,-38731.33 7129.38,-38721.33 7125.88,-38731.33 7132.88,-38731.33"/>
</g>
<!-- layer11_moe_comm_to_expert15&#45;&gt;layer11_moe_expert15 -->
<g id="edge574" class="edge">
<title>layer11_moe_comm_to_expert15&#45;&gt;layer11_moe_expert15</title>
<path fill="none" stroke="black" d="M7128.02,-38846.03C7128.02,-38846.03 7128.02,-38819.97 7128.02,-38819.97"/>
<polygon fill="black" stroke="black" points="7131.52,-38819.97 7128.02,-38809.97 7124.52,-38819.97 7131.52,-38819.97"/>
</g>
<!-- layer11_moe_aggregate -->
<g id="node459" class="node">
<title>layer11_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4797.1,-38627.85 4380.16,-38627.85 4272.9,-38523.85 4689.84,-38523.85 4797.1,-38627.85"/>
<text text-anchor="middle" x="4535" y="-38589.85" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L11</text>
<text text-anchor="middle" x="4535" y="-38578.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4535" y="-38567.85" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4535" y="-38556.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_mha -->
<g id="node476" class="node">
<title>layer12_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4665,-38487.85 4405,-38487.85 4405,-38435.85 4665,-38435.85 4665,-38487.85"/>
<text text-anchor="middle" x="4535" y="-38475.85" font-family="Arial" font-size="10.00">MHA L12</text>
<text text-anchor="middle" x="4535" y="-38464.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4535" y="-38453.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4535" y="-38442.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer11_moe_aggregate&#45;&gt;layer12_moe_mha -->
<g id="edge674" class="edge">
<title>layer11_moe_aggregate&#45;&gt;layer12_moe_mha</title>
<path fill="none" stroke="black" d="M4535,-38523.52C4535,-38523.52 4535,-38498.08 4535,-38498.08"/>
<polygon fill="black" stroke="black" points="4538.5,-38498.08 4535,-38488.08 4531.5,-38498.08 4538.5,-38498.08"/>
</g>
<!-- layer11_moe_comm_from_expert0&#45;&gt;layer11_moe_aggregate -->
<g id="edge576" class="edge">
<title>layer11_moe_comm_from_expert0&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M2087,-38666.22C2087,-38621.95 2087,-38538 2087,-38538 2087,-38538 4277.37,-38538 4277.37,-38538"/>
<polygon fill="black" stroke="black" points="4277.37,-38541.5 4287.37,-38538 4277.37,-38534.5 4277.37,-38541.5"/>
</g>
<!-- layer11_moe_comm_from_expert1&#45;&gt;layer11_moe_aggregate -->
<g id="edge578" class="edge">
<title>layer11_moe_comm_from_expert1&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M2439,-38665.55C2439,-38624.85 2439,-38553 2439,-38553 2439,-38553 4292.93,-38553 4292.93,-38553"/>
<polygon fill="black" stroke="black" points="4292.93,-38556.5 4302.93,-38553 4292.93,-38549.5 4292.93,-38556.5"/>
</g>
<!-- layer11_moe_comm_from_expert2&#45;&gt;layer11_moe_aggregate -->
<g id="edge580" class="edge">
<title>layer11_moe_comm_from_expert2&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M2735.5,-38663.89C2735.5,-38627.01 2735.5,-38568 2735.5,-38568 2735.5,-38568 4308.39,-38568 4308.39,-38568"/>
<polygon fill="black" stroke="black" points="4308.39,-38571.5 4318.39,-38568 4308.39,-38564.5 4308.39,-38571.5"/>
</g>
<!-- layer11_moe_comm_from_expert3&#45;&gt;layer11_moe_aggregate -->
<g id="edge582" class="edge">
<title>layer11_moe_comm_from_expert3&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M3364.5,-38674.21C3364.5,-38642.87 3364.5,-38583 3364.5,-38583 3364.5,-38583 4323.78,-38583 4323.78,-38583"/>
<polygon fill="black" stroke="black" points="4323.78,-38586.5 4333.78,-38583 4323.78,-38579.5 4323.78,-38586.5"/>
</g>
<!-- layer11_moe_comm_from_expert4&#45;&gt;layer11_moe_aggregate -->
<g id="edge584" class="edge">
<title>layer11_moe_comm_from_expert4&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M3729.5,-38668.91C3729.5,-38640.81 3729.5,-38598 3729.5,-38598 3729.5,-38598 4339.19,-38598 4339.19,-38598"/>
<polygon fill="black" stroke="black" points="4339.19,-38601.5 4349.19,-38598 4339.19,-38594.5 4339.19,-38601.5"/>
</g>
<!-- layer11_moe_comm_from_expert5&#45;&gt;layer11_moe_aggregate -->
<g id="edge586" class="edge">
<title>layer11_moe_comm_from_expert5&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M4048,-38678.39C4048,-38655.14 4048,-38612 4048,-38612 4048,-38612 4353.64,-38612 4353.64,-38612"/>
<polygon fill="black" stroke="black" points="4353.64,-38615.5 4363.64,-38612 4353.64,-38608.5 4353.64,-38615.5"/>
</g>
<!-- layer11_moe_comm_from_expert6&#45;&gt;layer11_moe_aggregate -->
<g id="edge588" class="edge">
<title>layer11_moe_comm_from_expert6&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M4288.61,-38676.33C4288.61,-38676.33 4288.61,-38585.9 4288.61,-38585.9"/>
<polygon fill="black" stroke="black" points="4292.11,-38585.9 4288.61,-38575.9 4285.11,-38585.9 4292.11,-38585.9"/>
</g>
<!-- layer11_moe_comm_from_expert7&#45;&gt;layer11_moe_aggregate -->
<g id="edge590" class="edge">
<title>layer11_moe_comm_from_expert7&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M4436,-38663.62C4436,-38663.62 4436,-38637.91 4436,-38637.91"/>
<polygon fill="black" stroke="black" points="4439.5,-38637.91 4436,-38627.91 4432.5,-38637.91 4439.5,-38637.91"/>
</g>
<!-- layer11_moe_comm_from_expert8&#45;&gt;layer11_moe_aggregate -->
<g id="edge592" class="edge">
<title>layer11_moe_comm_from_expert8&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M4707.39,-38663.62C4707.39,-38663.62 4707.39,-38637.91 4707.39,-38637.91"/>
<polygon fill="black" stroke="black" points="4710.89,-38637.91 4707.39,-38627.91 4703.89,-38637.91 4710.89,-38637.91"/>
</g>
<!-- layer11_moe_comm_from_expert9&#45;&gt;layer11_moe_aggregate -->
<g id="edge594" class="edge">
<title>layer11_moe_comm_from_expert9&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M4998.5,-38664.38C4998.5,-38641.79 4998.5,-38614 4998.5,-38614 4998.5,-38614 4793.03,-38614 4793.03,-38614"/>
<polygon fill="black" stroke="black" points="4793.03,-38610.5 4783.03,-38614 4793.03,-38617.5 4793.03,-38610.5"/>
</g>
<!-- layer11_moe_comm_from_expert10&#45;&gt;layer11_moe_aggregate -->
<g id="edge596" class="edge">
<title>layer11_moe_comm_from_expert10&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M5330.15,-38664.29C5330.15,-38637.33 5330.15,-38601 5330.15,-38601 5330.15,-38601 4779.54,-38601 4779.54,-38601"/>
<polygon fill="black" stroke="black" points="4779.54,-38597.5 4769.54,-38601 4779.54,-38604.5 4779.54,-38597.5"/>
</g>
<!-- layer11_moe_comm_from_expert11&#45;&gt;layer11_moe_aggregate -->
<g id="edge598" class="edge">
<title>layer11_moe_comm_from_expert11&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M5676.65,-38664.19C5676.65,-38633.15 5676.65,-38588 5676.65,-38588 5676.65,-38588 4766.14,-38588 4766.14,-38588"/>
<polygon fill="black" stroke="black" points="4766.14,-38584.5 4756.14,-38588 4766.14,-38591.5 4766.14,-38584.5"/>
</g>
<!-- layer11_moe_comm_from_expert12&#45;&gt;layer11_moe_aggregate -->
<g id="edge600" class="edge">
<title>layer11_moe_comm_from_expert12&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M6027.65,-38664.31C6027.65,-38629.44 6027.65,-38575 6027.65,-38575 6027.65,-38575 4752.94,-38575 4752.94,-38575"/>
<polygon fill="black" stroke="black" points="4752.94,-38571.5 4742.94,-38575 4752.94,-38578.5 4752.94,-38571.5"/>
</g>
<!-- layer11_moe_comm_from_expert13&#45;&gt;layer11_moe_aggregate -->
<g id="edge602" class="edge">
<title>layer11_moe_comm_from_expert13&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M6381.15,-38664.45C6381.15,-38625.97 6381.15,-38562 6381.15,-38562 6381.15,-38562 4739.52,-38562 4739.52,-38562"/>
<polygon fill="black" stroke="black" points="4739.52,-38558.5 4729.52,-38562 4739.52,-38565.5 4739.52,-38558.5"/>
</g>
<!-- layer11_moe_comm_from_expert14&#45;&gt;layer11_moe_aggregate -->
<g id="edge604" class="edge">
<title>layer11_moe_comm_from_expert14&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M6736.15,-38664.42C6736.15,-38622.5 6736.15,-38549 6736.15,-38549 6736.15,-38549 4726.06,-38549 4726.06,-38549"/>
<polygon fill="black" stroke="black" points="4726.06,-38545.5 4716.06,-38549 4726.06,-38552.5 4726.06,-38545.5"/>
</g>
<!-- layer11_moe_comm_from_expert15&#45;&gt;layer11_moe_aggregate -->
<g id="edge606" class="edge">
<title>layer11_moe_comm_from_expert15&#45;&gt;layer11_moe_aggregate</title>
<path fill="none" stroke="black" d="M7091.15,-38664.44C7091.15,-38619.24 7091.15,-38536 7091.15,-38536 7091.15,-38536 4712.72,-38536 4712.72,-38536"/>
<polygon fill="black" stroke="black" points="4712.72,-38532.5 4702.72,-38536 4712.72,-38539.5 4712.72,-38532.5"/>
</g>
<!-- layer12_moe_gate -->
<g id="node477" class="node">
<title>layer12_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4793.3,-38399.85 4382.4,-38399.85 4276.7,-38295.85 4687.6,-38295.85 4793.3,-38399.85"/>
<text text-anchor="middle" x="4535" y="-38361.85" font-family="Arial" font-size="10.00">GATE L12</text>
<text text-anchor="middle" x="4535" y="-38350.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4535" y="-38339.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4535" y="-38328.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer12_moe_mha&#45;&gt;layer12_moe_gate -->
<g id="edge675" class="edge">
<title>layer12_moe_mha&#45;&gt;layer12_moe_gate</title>
<path fill="none" stroke="black" d="M4535,-38435.7C4535,-38435.7 4535,-38409.95 4535,-38409.95"/>
<polygon fill="black" stroke="black" points="4538.5,-38409.95 4535,-38399.95 4531.5,-38409.95 4538.5,-38409.95"/>
</g>
<!-- layer12_moe_split -->
<g id="node478" class="node">
<title>layer12_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4789.01,-38259.85 4384.94,-38259.85 4280.99,-38155.85 4685.06,-38155.85 4789.01,-38259.85"/>
<text text-anchor="middle" x="4535" y="-38221.85" font-family="Arial" font-size="10.00">SPLIT TOKENS L12</text>
<text text-anchor="middle" x="4535" y="-38210.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4535" y="-38199.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4535" y="-38188.85" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer12_moe_gate&#45;&gt;layer12_moe_split -->
<g id="edge676" class="edge">
<title>layer12_moe_gate&#45;&gt;layer12_moe_split</title>
<path fill="none" stroke="black" d="M4535,-38295.72C4535,-38295.72 4535,-38270.02 4535,-38270.02"/>
<polygon fill="black" stroke="black" points="4538.5,-38270.02 4535,-38260.02 4531.5,-38270.02 4538.5,-38270.02"/>
</g>
<!-- layer12_moe_comm_to_expert0 -->
<g id="node480" class="node">
<title>layer12_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2124" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2124" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2124" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2124" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert0 -->
<g id="edge610" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4368.94,-38244C3833.44,-38244 2186.75,-38244 2186.75,-38244 2186.75,-38244 2186.75,-38121.83 2186.75,-38121.83"/>
<polygon fill="black" stroke="black" points="2190.25,-38121.83 2186.75,-38111.83 2183.25,-38121.83 2190.25,-38121.83"/>
</g>
<!-- layer12_moe_comm_to_expert1 -->
<g id="node482" class="node">
<title>layer12_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2470" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2470" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2470" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2470" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert1 -->
<g id="edge612" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4354.67,-38230C3862.5,-38230 2532.75,-38230 2532.75,-38230 2532.75,-38230 2532.75,-38121.99 2532.75,-38121.99"/>
<polygon fill="black" stroke="black" points="2536.25,-38121.99 2532.75,-38111.99 2529.25,-38121.99 2536.25,-38121.99"/>
</g>
<!-- layer12_moe_comm_to_expert2 -->
<g id="node484" class="node">
<title>layer12_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2742" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2742" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2742" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2742" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert2 -->
<g id="edge614" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4339.79,-38215C3891.38,-38215 2826.01,-38215 2826.01,-38215 2826.01,-38215 2826.01,-38111.87 2826.01,-38111.87"/>
<polygon fill="black" stroke="black" points="2829.51,-38111.87 2826.01,-38101.87 2822.51,-38111.87 2829.51,-38111.87"/>
</g>
<!-- layer12_moe_comm_to_expert3 -->
<g id="node486" class="node">
<title>layer12_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3162" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3162" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3162" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3162" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert3 -->
<g id="edge616" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4325.09,-38200C3955.77,-38200 3228.5,-38200 3228.5,-38200 3228.5,-38200 3228.5,-38120.62 3228.5,-38120.62"/>
<polygon fill="black" stroke="black" points="3232,-38120.62 3228.5,-38110.62 3225,-38120.62 3232,-38120.62"/>
</g>
<!-- layer12_moe_comm_to_expert4 -->
<g id="node488" class="node">
<title>layer12_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3434" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3434" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3434" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3434" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert4 -->
<g id="edge618" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4310.1,-38185C3987.5,-38185 3431.84,-38185 3431.84,-38185 3431.84,-38185 3431.84,-38129.87 3431.84,-38129.87"/>
<polygon fill="black" stroke="black" points="3435.34,-38129.87 3431.84,-38119.87 3428.34,-38129.87 3435.34,-38129.87"/>
</g>
<!-- layer12_moe_comm_to_expert5 -->
<g id="node490" class="node">
<title>layer12_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3781" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3781" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3781" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3781" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert5 -->
<g id="edge620" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4294.84,-38170C4087.06,-38170 3819.75,-38170 3819.75,-38170 3819.75,-38170 3819.75,-38127.21 3819.75,-38127.21"/>
<polygon fill="black" stroke="black" points="3823.25,-38127.21 3819.75,-38117.21 3816.25,-38127.21 3823.25,-38127.21"/>
</g>
<!-- layer12_moe_comm_to_expert6 -->
<g id="node492" class="node">
<title>layer12_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4127" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4127" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4127" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4127" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert6 -->
<g id="edge622" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4294.74,-38207.76C4294.74,-38204.2 4294.74,-38090 4294.74,-38090 4294.74,-38090 4227.74,-38090 4227.74,-38090"/>
<polygon fill="black" stroke="black" points="4227.74,-38086.5 4217.74,-38090 4227.74,-38093.5 4227.74,-38086.5"/>
</g>
<!-- layer12_moe_comm_to_expert7 -->
<g id="node494" class="node">
<title>layer12_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4399" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4399" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4399" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4399" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert7 -->
<g id="edge624" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4399,-38155.51C4399,-38155.51 4399,-38130.07 4399,-38130.07"/>
<polygon fill="black" stroke="black" points="4402.5,-38130.07 4399,-38120.07 4395.5,-38130.07 4402.5,-38130.07"/>
</g>
<!-- layer12_moe_comm_to_expert8 -->
<g id="node496" class="node">
<title>layer12_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4671" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4671" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4671" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4671" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert8 -->
<g id="edge626" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4671,-38155.51C4671,-38155.51 4671,-38130.07 4671,-38130.07"/>
<polygon fill="black" stroke="black" points="4674.5,-38130.07 4671,-38120.07 4667.5,-38130.07 4674.5,-38130.07"/>
</g>
<!-- layer12_moe_comm_to_expert9 -->
<g id="node498" class="node">
<title>layer12_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4980" cy="-38090.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4980" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4980" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4980" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert9 -->
<g id="edge628" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4775.26,-38207.76C4775.26,-38204.2 4775.26,-38090 4775.26,-38090 4775.26,-38090 4879.3,-38090 4879.3,-38090"/>
<polygon fill="black" stroke="black" points="4879.3,-38093.5 4889.3,-38090 4879.3,-38086.5 4879.3,-38093.5"/>
</g>
<!-- layer12_moe_comm_to_expert10 -->
<g id="node500" class="node">
<title>layer12_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5312" cy="-38090.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5312" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5312" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5312" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert10 -->
<g id="edge630" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4699.38,-38170C4906.6,-38170 5236.1,-38170 5236.1,-38170 5236.1,-38170 5236.1,-38118.03 5236.1,-38118.03"/>
<polygon fill="black" stroke="black" points="5239.6,-38118.03 5236.1,-38108.03 5232.6,-38118.03 5239.6,-38118.03"/>
</g>
<!-- layer12_moe_comm_to_expert11 -->
<g id="node502" class="node">
<title>layer12_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5658" cy="-38090.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5658" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5658" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5658" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert11 -->
<g id="edge632" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4714.49,-38185C5013.86,-38185 5582.6,-38185 5582.6,-38185 5582.6,-38185 5582.6,-38118.57 5582.6,-38118.57"/>
<polygon fill="black" stroke="black" points="5586.1,-38118.57 5582.6,-38108.57 5579.1,-38118.57 5586.1,-38118.57"/>
</g>
<!-- layer12_moe_comm_to_expert12 -->
<g id="node504" class="node">
<title>layer12_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6009" cy="-38090.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6009" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="6009" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6009" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert12 -->
<g id="edge634" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4729.47,-38200C5113.77,-38200 5933.6,-38200 5933.6,-38200 5933.6,-38200 5933.6,-38118.39 5933.6,-38118.39"/>
<polygon fill="black" stroke="black" points="5937.1,-38118.39 5933.6,-38108.39 5930.1,-38118.39 5937.1,-38118.39"/>
</g>
<!-- layer12_moe_comm_to_expert13 -->
<g id="node506" class="node">
<title>layer12_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6362" cy="-38090.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6362" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6362" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6362" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert13 -->
<g id="edge636" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4744.6,-38215C5209.67,-38215 6287.1,-38215 6287.1,-38215 6287.1,-38215 6287.1,-38118.64 6287.1,-38118.64"/>
<polygon fill="black" stroke="black" points="6290.6,-38118.64 6287.1,-38108.64 6283.6,-38118.64 6290.6,-38118.64"/>
</g>
<!-- layer12_moe_comm_to_expert14 -->
<g id="node508" class="node">
<title>layer12_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6717" cy="-38090.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6717" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6717" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6717" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert14 -->
<g id="edge638" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4759.5,-38230C5302.43,-38230 6642.1,-38230 6642.1,-38230 6642.1,-38230 6642.1,-38118.48 6642.1,-38118.48"/>
<polygon fill="black" stroke="black" points="6645.6,-38118.48 6642.1,-38108.48 6638.6,-38118.48 6645.6,-38118.48"/>
</g>
<!-- layer12_moe_comm_to_expert15 -->
<g id="node510" class="node">
<title>layer12_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7072" cy="-38090.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7072" y="-38099.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7072" y="-38088.36" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7072" y="-38077.36" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert15 -->
<g id="edge640" class="edge">
<title>layer12_moe_split&#45;&gt;layer12_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4773.31,-38244C5391.21,-38244 6997.1,-38244 6997.1,-38244 6997.1,-38244 6997.1,-38118.43 6997.1,-38118.43"/>
<polygon fill="black" stroke="black" points="7000.6,-38118.43 6997.1,-38108.43 6993.6,-38118.43 7000.6,-38118.43"/>
</g>
<!-- layer12_moe_expert0 -->
<g id="node479" class="node">
<title>layer12_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2104,-38025.87 1776,-38025.87 1776,-37973.87 2104,-37973.87 2104,-38025.87"/>
<text text-anchor="middle" x="1940" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 0 L12</text>
<text text-anchor="middle" x="1940" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1940" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1940" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert0 -->
<g id="node512" class="node">
<title>layer12_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1986" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1986" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1986" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1986" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer12_moe_expert0&#45;&gt;layer12_moe_comm_from_expert0 -->
<g id="edge642" class="edge">
<title>layer12_moe_expert0&#45;&gt;layer12_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1986,-37973.55C1986,-37973.55 1986,-37948.01 1986,-37948.01"/>
<polygon fill="black" stroke="black" points="1989.5,-37948.01 1986,-37938.01 1982.5,-37948.01 1989.5,-37948.01"/>
</g>
<!-- layer12_moe_comm_to_expert0&#45;&gt;layer12_moe_expert0 -->
<g id="edge611" class="edge">
<title>layer12_moe_comm_to_expert0&#45;&gt;layer12_moe_expert0</title>
<path fill="none" stroke="black" d="M2068.75,-38067.43C2068.75,-38067.43 2068.75,-38036.11 2068.75,-38036.11"/>
<polygon fill="black" stroke="black" points="2072.25,-38036.11 2068.75,-38026.11 2065.25,-38036.11 2072.25,-38036.11"/>
</g>
<!-- layer12_moe_expert1 -->
<g id="node481" class="node">
<title>layer12_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2450,-38025.87 2122,-38025.87 2122,-37973.87 2450,-37973.87 2450,-38025.87"/>
<text text-anchor="middle" x="2286" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 1 L12</text>
<text text-anchor="middle" x="2286" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2286" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2286" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert1 -->
<g id="node513" class="node">
<title>layer12_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2699" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2699" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2699" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2699" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer12_moe_expert1&#45;&gt;layer12_moe_comm_from_expert1 -->
<g id="edge644" class="edge">
<title>layer12_moe_expert1&#45;&gt;layer12_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2388.25,-37973.79C2388.25,-37946.63 2388.25,-37908 2388.25,-37908 2388.25,-37908 2598.28,-37908 2598.28,-37908"/>
<polygon fill="black" stroke="black" points="2598.28,-37911.5 2608.28,-37908 2598.28,-37904.5 2598.28,-37911.5"/>
</g>
<!-- layer12_moe_comm_to_expert1&#45;&gt;layer12_moe_expert1 -->
<g id="edge613" class="edge">
<title>layer12_moe_comm_to_expert1&#45;&gt;layer12_moe_expert1</title>
<path fill="none" stroke="black" d="M2414.75,-38067.43C2414.75,-38067.43 2414.75,-38036.11 2414.75,-38036.11"/>
<polygon fill="black" stroke="black" points="2418.25,-38036.11 2414.75,-38026.11 2411.25,-38036.11 2418.25,-38036.11"/>
</g>
<!-- layer12_moe_expert2 -->
<g id="node483" class="node">
<title>layer12_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2796,-38025.87 2468,-38025.87 2468,-37973.87 2796,-37973.87 2796,-38025.87"/>
<text text-anchor="middle" x="2632" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 2 L12</text>
<text text-anchor="middle" x="2632" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2632" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2632" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert2 -->
<g id="node514" class="node">
<title>layer12_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="3155" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3155" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="3155" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3155" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer12_moe_expert2&#45;&gt;layer12_moe_comm_from_expert2 -->
<g id="edge646" class="edge">
<title>layer12_moe_expert2&#45;&gt;layer12_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2796.18,-37999C2801.77,-37999 2805,-37999 2805,-37999 2805,-37999 2805,-37908 2805,-37908 2805,-37908 3054.41,-37908 3054.41,-37908"/>
<polygon fill="black" stroke="black" points="3054.41,-37911.5 3064.41,-37908 3054.41,-37904.5 3054.41,-37911.5"/>
</g>
<!-- layer12_moe_comm_to_expert2&#45;&gt;layer12_moe_expert2 -->
<g id="edge615" class="edge">
<title>layer12_moe_comm_to_expert2&#45;&gt;layer12_moe_expert2</title>
<path fill="none" stroke="black" d="M2723.75,-38062.07C2723.75,-38062.07 2723.75,-38036 2723.75,-38036"/>
<polygon fill="black" stroke="black" points="2727.25,-38036 2723.75,-38026 2720.25,-38036 2727.25,-38036"/>
</g>
<!-- layer12_moe_expert3 -->
<g id="node485" class="node">
<title>layer12_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3142,-38025.87 2814,-38025.87 2814,-37973.87 3142,-37973.87 3142,-38025.87"/>
<text text-anchor="middle" x="2978" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 3 L12</text>
<text text-anchor="middle" x="2978" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2978" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2978" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert3 -->
<g id="node515" class="node">
<title>layer12_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3483" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3483" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3483" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3483" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer12_moe_expert3&#45;&gt;layer12_moe_comm_from_expert3 -->
<g id="edge648" class="edge">
<title>layer12_moe_expert3&#45;&gt;layer12_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3103.25,-37973.84C3103.25,-37961.32 3103.25,-37949 3103.25,-37949 3103.25,-37949 3424.33,-37949 3424.33,-37949 3424.33,-37949 3424.33,-37941.28 3424.33,-37941.28"/>
<polygon fill="black" stroke="black" points="3427.83,-37941.28 3424.33,-37931.28 3420.83,-37941.28 3427.83,-37941.28"/>
</g>
<!-- layer12_moe_comm_to_expert3&#45;&gt;layer12_moe_expert3 -->
<g id="edge617" class="edge">
<title>layer12_moe_comm_to_expert3&#45;&gt;layer12_moe_expert3</title>
<path fill="none" stroke="black" d="M3106.75,-38067.43C3106.75,-38067.43 3106.75,-38036.11 3106.75,-38036.11"/>
<polygon fill="black" stroke="black" points="3110.25,-38036.11 3106.75,-38026.11 3103.25,-38036.11 3110.25,-38036.11"/>
</g>
<!-- layer12_moe_expert4 -->
<g id="node487" class="node">
<title>layer12_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3488,-38025.87 3160,-38025.87 3160,-37973.87 3488,-37973.87 3488,-38025.87"/>
<text text-anchor="middle" x="3324" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 4 L12</text>
<text text-anchor="middle" x="3324" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3324" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3324" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert4 -->
<g id="node516" class="node">
<title>layer12_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3746" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3746" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3746" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3746" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer12_moe_expert4&#45;&gt;layer12_moe_comm_from_expert4 -->
<g id="edge650" class="edge">
<title>layer12_moe_expert4&#45;&gt;layer12_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3456.16,-37973.73C3456.16,-37966.7 3456.16,-37961 3456.16,-37961 3456.16,-37961 3744.75,-37961 3744.75,-37961 3744.75,-37961 3744.75,-37947.99 3744.75,-37947.99"/>
<polygon fill="black" stroke="black" points="3748.25,-37947.99 3744.75,-37937.99 3741.25,-37947.99 3748.25,-37947.99"/>
</g>
<!-- layer12_moe_comm_to_expert4&#45;&gt;layer12_moe_expert4 -->
<g id="edge619" class="edge">
<title>layer12_moe_comm_to_expert4&#45;&gt;layer12_moe_expert4</title>
<path fill="none" stroke="black" d="M3415.75,-38062.07C3415.75,-38062.07 3415.75,-38036 3415.75,-38036"/>
<polygon fill="black" stroke="black" points="3419.25,-38036 3415.75,-38026 3412.25,-38036 3419.25,-38036"/>
</g>
<!-- layer12_moe_expert5 -->
<g id="node489" class="node">
<title>layer12_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3834,-38025.87 3506,-38025.87 3506,-37973.87 3834,-37973.87 3834,-38025.87"/>
<text text-anchor="middle" x="3670" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 5 L12</text>
<text text-anchor="middle" x="3670" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3670" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3670" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert5 -->
<g id="node517" class="node">
<title>layer12_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3977" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3977" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3977" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3977" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer12_moe_expert5&#45;&gt;layer12_moe_comm_from_expert5 -->
<g id="edge652" class="edge">
<title>layer12_moe_expert5&#45;&gt;layer12_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3834.18,-37999C3839.77,-37999 3843,-37999 3843,-37999 3843,-37999 3843,-37908 3843,-37908 3843,-37908 3876.51,-37908 3876.51,-37908"/>
<polygon fill="black" stroke="black" points="3876.51,-37911.5 3886.51,-37908 3876.51,-37904.5 3876.51,-37911.5"/>
</g>
<!-- layer12_moe_comm_to_expert5&#45;&gt;layer12_moe_expert5 -->
<g id="edge621" class="edge">
<title>layer12_moe_comm_to_expert5&#45;&gt;layer12_moe_expert5</title>
<path fill="none" stroke="black" d="M3762.25,-38062.07C3762.25,-38062.07 3762.25,-38036 3762.25,-38036"/>
<polygon fill="black" stroke="black" points="3765.75,-38036 3762.25,-38026 3758.75,-38036 3765.75,-38036"/>
</g>
<!-- layer12_moe_expert6 -->
<g id="node491" class="node">
<title>layer12_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4180,-38025.87 3852,-38025.87 3852,-37973.87 4180,-37973.87 4180,-38025.87"/>
<text text-anchor="middle" x="4016" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 6 L12</text>
<text text-anchor="middle" x="4016" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4016" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="4016" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert6 -->
<g id="node518" class="node">
<title>layer12_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4192" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4192" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4192" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4192" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer12_moe_expert6&#45;&gt;layer12_moe_comm_from_expert6 -->
<g id="edge654" class="edge">
<title>layer12_moe_expert6&#45;&gt;layer12_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4140.75,-37973.55C4140.75,-37973.55 4140.75,-37942.96 4140.75,-37942.96"/>
<polygon fill="black" stroke="black" points="4144.25,-37942.96 4140.75,-37932.96 4137.25,-37942.96 4144.25,-37942.96"/>
</g>
<!-- layer12_moe_comm_to_expert6&#45;&gt;layer12_moe_expert6 -->
<g id="edge623" class="edge">
<title>layer12_moe_comm_to_expert6&#45;&gt;layer12_moe_expert6</title>
<path fill="none" stroke="black" d="M4108.25,-38062.07C4108.25,-38062.07 4108.25,-38036 4108.25,-38036"/>
<polygon fill="black" stroke="black" points="4111.75,-38036 4108.25,-38026 4104.75,-38036 4111.75,-38036"/>
</g>
<!-- layer12_moe_expert7 -->
<g id="node493" class="node">
<title>layer12_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4526,-38025.87 4198,-38025.87 4198,-37973.87 4526,-37973.87 4526,-38025.87"/>
<text text-anchor="middle" x="4362" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 7 L12</text>
<text text-anchor="middle" x="4362" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4362" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4362" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert7 -->
<g id="node519" class="node">
<title>layer12_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4399" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4399" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4399" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4399" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer12_moe_expert7&#45;&gt;layer12_moe_comm_from_expert7 -->
<g id="edge656" class="edge">
<title>layer12_moe_expert7&#45;&gt;layer12_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4399,-37973.55C4399,-37973.55 4399,-37948.01 4399,-37948.01"/>
<polygon fill="black" stroke="black" points="4402.5,-37948.01 4399,-37938.01 4395.5,-37948.01 4402.5,-37948.01"/>
</g>
<!-- layer12_moe_comm_to_expert7&#45;&gt;layer12_moe_expert7 -->
<g id="edge625" class="edge">
<title>layer12_moe_comm_to_expert7&#45;&gt;layer12_moe_expert7</title>
<path fill="none" stroke="black" d="M4399,-38061.82C4399,-38061.82 4399,-38036.17 4399,-38036.17"/>
<polygon fill="black" stroke="black" points="4402.5,-38036.17 4399,-38026.17 4395.5,-38036.17 4402.5,-38036.17"/>
</g>
<!-- layer12_moe_expert8 -->
<g id="node495" class="node">
<title>layer12_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4872,-38025.87 4544,-38025.87 4544,-37973.87 4872,-37973.87 4872,-38025.87"/>
<text text-anchor="middle" x="4708" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 8 L12</text>
<text text-anchor="middle" x="4708" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4708" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4708" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert8 -->
<g id="node520" class="node">
<title>layer12_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4671" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4671" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4671" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4671" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer12_moe_expert8&#45;&gt;layer12_moe_comm_from_expert8 -->
<g id="edge658" class="edge">
<title>layer12_moe_expert8&#45;&gt;layer12_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4671,-37973.55C4671,-37973.55 4671,-37948.01 4671,-37948.01"/>
<polygon fill="black" stroke="black" points="4674.5,-37948.01 4671,-37938.01 4667.5,-37948.01 4674.5,-37948.01"/>
</g>
<!-- layer12_moe_comm_to_expert8&#45;&gt;layer12_moe_expert8 -->
<g id="edge627" class="edge">
<title>layer12_moe_comm_to_expert8&#45;&gt;layer12_moe_expert8</title>
<path fill="none" stroke="black" d="M4671,-38061.82C4671,-38061.82 4671,-38036.17 4671,-38036.17"/>
<polygon fill="black" stroke="black" points="4674.5,-38036.17 4671,-38026.17 4667.5,-38036.17 4674.5,-38036.17"/>
</g>
<!-- layer12_moe_expert9 -->
<g id="node497" class="node">
<title>layer12_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5218,-38025.87 4890,-38025.87 4890,-37973.87 5218,-37973.87 5218,-38025.87"/>
<text text-anchor="middle" x="5054" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 9 L12</text>
<text text-anchor="middle" x="5054" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5054" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5054" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert9 -->
<g id="node521" class="node">
<title>layer12_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4980" cy="-37908.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4980" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4980" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4980" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer12_moe_expert9&#45;&gt;layer12_moe_comm_from_expert9 -->
<g id="edge660" class="edge">
<title>layer12_moe_expert9&#45;&gt;layer12_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4980.25,-37973.55C4980.25,-37973.55 4980.25,-37948.01 4980.25,-37948.01"/>
<polygon fill="black" stroke="black" points="4983.75,-37948.01 4980.25,-37938.01 4976.75,-37948.01 4983.75,-37948.01"/>
</g>
<!-- layer12_moe_comm_to_expert9&#45;&gt;layer12_moe_expert9 -->
<g id="edge629" class="edge">
<title>layer12_moe_comm_to_expert9&#45;&gt;layer12_moe_expert9</title>
<path fill="none" stroke="black" d="M4980.25,-38061.82C4980.25,-38061.82 4980.25,-38036.17 4980.25,-38036.17"/>
<polygon fill="black" stroke="black" points="4983.75,-38036.17 4980.25,-38026.17 4976.75,-38036.17 4983.75,-38036.17"/>
</g>
<!-- layer12_moe_expert10 -->
<g id="node499" class="node">
<title>layer12_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5574,-38025.87 5236,-38025.87 5236,-37973.87 5574,-37973.87 5574,-38025.87"/>
<text text-anchor="middle" x="5405" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 10 L12</text>
<text text-anchor="middle" x="5405" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5405" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5405" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert10 -->
<g id="node522" class="node">
<title>layer12_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5312" cy="-37908.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5312" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5312" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5312" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer12_moe_expert10&#45;&gt;layer12_moe_comm_from_expert10 -->
<g id="edge662" class="edge">
<title>layer12_moe_expert10&#45;&gt;layer12_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5321.38,-37973.55C5321.38,-37973.55 5321.38,-37948.01 5321.38,-37948.01"/>
<polygon fill="black" stroke="black" points="5324.88,-37948.01 5321.38,-37938.01 5317.88,-37948.01 5324.88,-37948.01"/>
</g>
<!-- layer12_moe_comm_to_expert10&#45;&gt;layer12_moe_expert10 -->
<g id="edge631" class="edge">
<title>layer12_moe_comm_to_expert10&#45;&gt;layer12_moe_expert10</title>
<path fill="none" stroke="black" d="M5321.02,-38061.82C5321.02,-38061.82 5321.02,-38036.17 5321.02,-38036.17"/>
<polygon fill="black" stroke="black" points="5324.52,-38036.17 5321.02,-38026.17 5317.52,-38036.17 5324.52,-38036.17"/>
</g>
<!-- layer12_moe_expert11 -->
<g id="node501" class="node">
<title>layer12_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5930,-38025.87 5592,-38025.87 5592,-37973.87 5930,-37973.87 5930,-38025.87"/>
<text text-anchor="middle" x="5761" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 11 L12</text>
<text text-anchor="middle" x="5761" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5761" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5761" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert11 -->
<g id="node523" class="node">
<title>layer12_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5659" cy="-37908.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5659" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5659" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5659" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer12_moe_expert11&#45;&gt;layer12_moe_comm_from_expert11 -->
<g id="edge664" class="edge">
<title>layer12_moe_expert11&#45;&gt;layer12_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5672.88,-37973.55C5672.88,-37973.55 5672.88,-37947.68 5672.88,-37947.68"/>
<polygon fill="black" stroke="black" points="5676.38,-37947.68 5672.88,-37937.68 5669.38,-37947.68 5676.38,-37947.68"/>
</g>
<!-- layer12_moe_comm_to_expert11&#45;&gt;layer12_moe_expert11 -->
<g id="edge633" class="edge">
<title>layer12_moe_comm_to_expert11&#45;&gt;layer12_moe_expert11</title>
<path fill="none" stroke="black" d="M5672.02,-38062.07C5672.02,-38062.07 5672.02,-38036 5672.02,-38036"/>
<polygon fill="black" stroke="black" points="5675.52,-38036 5672.02,-38026 5668.52,-38036 5675.52,-38036"/>
</g>
<!-- layer12_moe_expert12 -->
<g id="node503" class="node">
<title>layer12_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6286,-38025.87 5948,-38025.87 5948,-37973.87 6286,-37973.87 6286,-38025.87"/>
<text text-anchor="middle" x="6117" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 12 L12</text>
<text text-anchor="middle" x="6117" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6117" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6117" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert12 -->
<g id="node524" class="node">
<title>layer12_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="6010" cy="-37908.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6010" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="6010" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6010" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer12_moe_expert12&#45;&gt;layer12_moe_comm_from_expert12 -->
<g id="edge666" class="edge">
<title>layer12_moe_expert12&#45;&gt;layer12_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M6026.38,-37973.55C6026.38,-37973.55 6026.38,-37947.68 6026.38,-37947.68"/>
<polygon fill="black" stroke="black" points="6029.88,-37947.68 6026.38,-37937.68 6022.88,-37947.68 6029.88,-37947.68"/>
</g>
<!-- layer12_moe_comm_to_expert12&#45;&gt;layer12_moe_expert12 -->
<g id="edge635" class="edge">
<title>layer12_moe_comm_to_expert12&#45;&gt;layer12_moe_expert12</title>
<path fill="none" stroke="black" d="M6025.52,-38062.07C6025.52,-38062.07 6025.52,-38036 6025.52,-38036"/>
<polygon fill="black" stroke="black" points="6029.02,-38036 6025.52,-38026 6022.02,-38036 6029.02,-38036"/>
</g>
<!-- layer12_moe_expert13 -->
<g id="node505" class="node">
<title>layer12_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6642,-38025.87 6304,-38025.87 6304,-37973.87 6642,-37973.87 6642,-38025.87"/>
<text text-anchor="middle" x="6473" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 13 L12</text>
<text text-anchor="middle" x="6473" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6473" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6473" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert13 -->
<g id="node525" class="node">
<title>layer12_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6364" cy="-37908.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6364" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6364" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6364" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer12_moe_expert13&#45;&gt;layer12_moe_comm_from_expert13 -->
<g id="edge668" class="edge">
<title>layer12_moe_expert13&#45;&gt;layer12_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6381.38,-37973.55C6381.38,-37973.55 6381.38,-37947.68 6381.38,-37947.68"/>
<polygon fill="black" stroke="black" points="6384.88,-37947.68 6381.38,-37937.68 6377.88,-37947.68 6384.88,-37947.68"/>
</g>
<!-- layer12_moe_comm_to_expert13&#45;&gt;layer12_moe_expert13 -->
<g id="edge637" class="edge">
<title>layer12_moe_comm_to_expert13&#45;&gt;layer12_moe_expert13</title>
<path fill="none" stroke="black" d="M6380.02,-38062.07C6380.02,-38062.07 6380.02,-38036 6380.02,-38036"/>
<polygon fill="black" stroke="black" points="6383.52,-38036 6380.02,-38026 6376.52,-38036 6383.52,-38036"/>
</g>
<!-- layer12_moe_expert14 -->
<g id="node507" class="node">
<title>layer12_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6998,-38025.87 6660,-38025.87 6660,-37973.87 6998,-37973.87 6998,-38025.87"/>
<text text-anchor="middle" x="6829" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 14 L12</text>
<text text-anchor="middle" x="6829" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6829" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6829" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert14 -->
<g id="node526" class="node">
<title>layer12_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6719" cy="-37908.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6719" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6719" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6719" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer12_moe_expert14&#45;&gt;layer12_moe_comm_from_expert14 -->
<g id="edge670" class="edge">
<title>layer12_moe_expert14&#45;&gt;layer12_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6736.88,-37973.55C6736.88,-37973.55 6736.88,-37947.36 6736.88,-37947.36"/>
<polygon fill="black" stroke="black" points="6740.38,-37947.36 6736.88,-37937.36 6733.38,-37947.36 6740.38,-37947.36"/>
</g>
<!-- layer12_moe_comm_to_expert14&#45;&gt;layer12_moe_expert14 -->
<g id="edge639" class="edge">
<title>layer12_moe_comm_to_expert14&#45;&gt;layer12_moe_expert14</title>
<path fill="none" stroke="black" d="M6735.52,-38062.07C6735.52,-38062.07 6735.52,-38036 6735.52,-38036"/>
<polygon fill="black" stroke="black" points="6739.02,-38036 6735.52,-38026 6732.02,-38036 6739.02,-38036"/>
</g>
<!-- layer12_moe_expert15 -->
<g id="node509" class="node">
<title>layer12_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7354,-38025.87 7016,-38025.87 7016,-37973.87 7354,-37973.87 7354,-38025.87"/>
<text text-anchor="middle" x="7185" y="-38013.87" font-family="Arial" font-size="10.00">EXPERT 15 L12</text>
<text text-anchor="middle" x="7185" y="-38002.87" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7185" y="-37991.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7185" y="-37980.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_comm_from_expert15 -->
<g id="node527" class="node">
<title>layer12_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7074" cy="-37908.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7074" y="-37917.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7074" y="-37906.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7074" y="-37895.38" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer12_moe_expert15&#45;&gt;layer12_moe_comm_from_expert15 -->
<g id="edge672" class="edge">
<title>layer12_moe_expert15&#45;&gt;layer12_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7092.38,-37973.55C7092.38,-37973.55 7092.38,-37947.36 7092.38,-37947.36"/>
<polygon fill="black" stroke="black" points="7095.88,-37947.36 7092.38,-37937.36 7088.88,-37947.36 7095.88,-37947.36"/>
</g>
<!-- layer12_moe_comm_to_expert15&#45;&gt;layer12_moe_expert15 -->
<g id="edge641" class="edge">
<title>layer12_moe_comm_to_expert15&#45;&gt;layer12_moe_expert15</title>
<path fill="none" stroke="black" d="M7091.02,-38062.07C7091.02,-38062.07 7091.02,-38036 7091.02,-38036"/>
<polygon fill="black" stroke="black" points="7094.52,-38036 7091.02,-38026 7087.52,-38036 7094.52,-38036"/>
</g>
<!-- layer12_moe_aggregate -->
<g id="node511" class="node">
<title>layer12_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4760.1,-37843.88 4343.16,-37843.88 4235.9,-37739.88 4652.84,-37739.88 4760.1,-37843.88"/>
<text text-anchor="middle" x="4498" y="-37805.88" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L12</text>
<text text-anchor="middle" x="4498" y="-37794.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4498" y="-37783.88" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4498" y="-37772.88" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_mha -->
<g id="node528" class="node">
<title>layer13_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4628,-37703.88 4368,-37703.88 4368,-37651.88 4628,-37651.88 4628,-37703.88"/>
<text text-anchor="middle" x="4498" y="-37691.88" font-family="Arial" font-size="10.00">MHA L13</text>
<text text-anchor="middle" x="4498" y="-37680.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4498" y="-37669.88" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4498" y="-37658.88" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer12_moe_aggregate&#45;&gt;layer13_moe_mha -->
<g id="edge741" class="edge">
<title>layer12_moe_aggregate&#45;&gt;layer13_moe_mha</title>
<path fill="none" stroke="black" d="M4498,-37739.55C4498,-37739.55 4498,-37714.11 4498,-37714.11"/>
<polygon fill="black" stroke="black" points="4501.5,-37714.11 4498,-37704.11 4494.5,-37714.11 4501.5,-37714.11"/>
</g>
<!-- layer12_moe_comm_from_expert0&#45;&gt;layer12_moe_aggregate -->
<g id="edge643" class="edge">
<title>layer12_moe_comm_from_expert0&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M2071.75,-37899.19C2071.75,-37865.28 2071.75,-37754 2071.75,-37754 2071.75,-37754 4240.32,-37754 4240.32,-37754"/>
<polygon fill="black" stroke="black" points="4240.32,-37757.5 4250.32,-37754 4240.32,-37750.5 4240.32,-37757.5"/>
</g>
<!-- layer12_moe_comm_from_expert1&#45;&gt;layer12_moe_aggregate -->
<g id="edge645" class="edge">
<title>layer12_moe_comm_from_expert1&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M2783.25,-37897.9C2783.25,-37864.93 2783.25,-37769 2783.25,-37769 2783.25,-37769 4255.85,-37769 4255.85,-37769"/>
<polygon fill="black" stroke="black" points="4255.85,-37772.5 4265.85,-37769 4255.85,-37765.5 4255.85,-37772.5"/>
</g>
<!-- layer12_moe_comm_from_expert2&#45;&gt;layer12_moe_aggregate -->
<g id="edge647" class="edge">
<title>layer12_moe_comm_from_expert2&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M3227.01,-37891.25C3227.01,-37856.83 3227.01,-37784 3227.01,-37784 3227.01,-37784 4271.31,-37784 4271.31,-37784"/>
<polygon fill="black" stroke="black" points="4271.31,-37787.5 4281.31,-37784 4271.31,-37780.5 4271.31,-37787.5"/>
</g>
<!-- layer12_moe_comm_from_expert3&#45;&gt;layer12_moe_aggregate -->
<g id="edge649" class="edge">
<title>layer12_moe_comm_from_expert3&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M3555.01,-37891.22C3555.01,-37860.16 3555.01,-37799 3555.01,-37799 3555.01,-37799 4286.86,-37799 4286.86,-37799"/>
<polygon fill="black" stroke="black" points="4286.86,-37802.5 4296.86,-37799 4286.86,-37795.5 4286.86,-37802.5"/>
</g>
<!-- layer12_moe_comm_from_expert4&#45;&gt;layer12_moe_aggregate -->
<g id="edge651" class="edge">
<title>layer12_moe_comm_from_expert4&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M3825.75,-37894.88C3825.75,-37868.48 3825.75,-37814 3825.75,-37814 3825.75,-37814 4302.08,-37814 4302.08,-37814"/>
<polygon fill="black" stroke="black" points="4302.08,-37817.5 4312.08,-37814 4302.08,-37810.5 4302.08,-37817.5"/>
</g>
<!-- layer12_moe_comm_from_expert5&#45;&gt;layer12_moe_aggregate -->
<g id="edge653" class="edge">
<title>layer12_moe_comm_from_expert5&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M4047.5,-37890.35C4047.5,-37866.75 4047.5,-37829 4047.5,-37829 4047.5,-37829 4317.69,-37829 4317.69,-37829"/>
<polygon fill="black" stroke="black" points="4317.69,-37832.5 4327.69,-37829 4317.69,-37825.5 4317.69,-37832.5"/>
</g>
<!-- layer12_moe_comm_from_expert6&#45;&gt;layer12_moe_aggregate -->
<g id="edge655" class="edge">
<title>layer12_moe_comm_from_expert6&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M4259.11,-37889.29C4259.11,-37889.29 4259.11,-37801.93 4259.11,-37801.93"/>
<polygon fill="black" stroke="black" points="4262.61,-37801.93 4259.11,-37791.93 4255.61,-37801.93 4262.61,-37801.93"/>
</g>
<!-- layer12_moe_comm_from_expert7&#45;&gt;layer12_moe_aggregate -->
<g id="edge657" class="edge">
<title>layer12_moe_comm_from_expert7&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M4399,-37879.65C4399,-37879.65 4399,-37853.94 4399,-37853.94"/>
<polygon fill="black" stroke="black" points="4402.5,-37853.94 4399,-37843.94 4395.5,-37853.94 4402.5,-37853.94"/>
</g>
<!-- layer12_moe_comm_from_expert8&#45;&gt;layer12_moe_aggregate -->
<g id="edge659" class="edge">
<title>layer12_moe_comm_from_expert8&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M4670.39,-37879.65C4670.39,-37879.65 4670.39,-37853.94 4670.39,-37853.94"/>
<polygon fill="black" stroke="black" points="4673.89,-37853.94 4670.39,-37843.94 4666.89,-37853.94 4673.89,-37853.94"/>
</g>
<!-- layer12_moe_comm_from_expert9&#45;&gt;layer12_moe_aggregate -->
<g id="edge661" class="edge">
<title>layer12_moe_comm_from_expert9&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M4961.5,-37880.4C4961.5,-37857.81 4961.5,-37830 4961.5,-37830 4961.5,-37830 4756.03,-37830 4756.03,-37830"/>
<polygon fill="black" stroke="black" points="4756.03,-37826.5 4746.03,-37830 4756.03,-37833.5 4756.03,-37826.5"/>
</g>
<!-- layer12_moe_comm_from_expert10&#45;&gt;layer12_moe_aggregate -->
<g id="edge663" class="edge">
<title>layer12_moe_comm_from_expert10&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M5293.15,-37880.31C5293.15,-37853.34 5293.15,-37817 5293.15,-37817 5293.15,-37817 4742.54,-37817 4742.54,-37817"/>
<polygon fill="black" stroke="black" points="4742.54,-37813.5 4732.54,-37817 4742.54,-37820.5 4742.54,-37813.5"/>
</g>
<!-- layer12_moe_comm_from_expert11&#45;&gt;layer12_moe_aggregate -->
<g id="edge665" class="edge">
<title>layer12_moe_comm_from_expert11&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M5639.65,-37880.49C5639.65,-37849.44 5639.65,-37804 5639.65,-37804 5639.65,-37804 4729.14,-37804 4729.14,-37804"/>
<polygon fill="black" stroke="black" points="4729.14,-37800.5 4719.14,-37804 4729.14,-37807.5 4729.14,-37800.5"/>
</g>
<!-- layer12_moe_comm_from_expert12&#45;&gt;layer12_moe_aggregate -->
<g id="edge667" class="edge">
<title>layer12_moe_comm_from_expert12&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M5990.65,-37880.34C5990.65,-37845.46 5990.65,-37791 5990.65,-37791 5990.65,-37791 4715.94,-37791 4715.94,-37791"/>
<polygon fill="black" stroke="black" points="4715.94,-37787.5 4705.94,-37791 4715.94,-37794.5 4715.94,-37787.5"/>
</g>
<!-- layer12_moe_comm_from_expert13&#45;&gt;layer12_moe_aggregate -->
<g id="edge669" class="edge">
<title>layer12_moe_comm_from_expert13&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M6344.15,-37880.48C6344.15,-37841.99 6344.15,-37778 6344.15,-37778 6344.15,-37778 4702.52,-37778 4702.52,-37778"/>
<polygon fill="black" stroke="black" points="4702.52,-37774.5 4692.52,-37778 4702.52,-37781.5 4702.52,-37774.5"/>
</g>
<!-- layer12_moe_comm_from_expert14&#45;&gt;layer12_moe_aggregate -->
<g id="edge671" class="edge">
<title>layer12_moe_comm_from_expert14&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M6699.15,-37880.45C6699.15,-37838.52 6699.15,-37765 6699.15,-37765 6699.15,-37765 4689.06,-37765 4689.06,-37765"/>
<polygon fill="black" stroke="black" points="4689.06,-37761.5 4679.06,-37765 4689.06,-37768.5 4689.06,-37761.5"/>
</g>
<!-- layer12_moe_comm_from_expert15&#45;&gt;layer12_moe_aggregate -->
<g id="edge673" class="edge">
<title>layer12_moe_comm_from_expert15&#45;&gt;layer12_moe_aggregate</title>
<path fill="none" stroke="black" d="M7054.15,-37880.47C7054.15,-37835.26 7054.15,-37752 7054.15,-37752 7054.15,-37752 4675.72,-37752 4675.72,-37752"/>
<polygon fill="black" stroke="black" points="4675.72,-37748.5 4665.72,-37752 4675.72,-37755.5 4675.72,-37748.5"/>
</g>
<!-- layer13_moe_gate -->
<g id="node529" class="node">
<title>layer13_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4756.3,-37615.88 4345.4,-37615.88 4239.7,-37511.88 4650.6,-37511.88 4756.3,-37615.88"/>
<text text-anchor="middle" x="4498" y="-37577.88" font-family="Arial" font-size="10.00">GATE L13</text>
<text text-anchor="middle" x="4498" y="-37566.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4498" y="-37555.88" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4498" y="-37544.88" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer13_moe_mha&#45;&gt;layer13_moe_gate -->
<g id="edge742" class="edge">
<title>layer13_moe_mha&#45;&gt;layer13_moe_gate</title>
<path fill="none" stroke="black" d="M4498,-37651.73C4498,-37651.73 4498,-37625.98 4498,-37625.98"/>
<polygon fill="black" stroke="black" points="4501.5,-37625.98 4498,-37615.98 4494.5,-37625.98 4501.5,-37625.98"/>
</g>
<!-- layer13_moe_split -->
<g id="node530" class="node">
<title>layer13_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4752.01,-37475.88 4347.94,-37475.88 4243.99,-37371.88 4648.06,-37371.88 4752.01,-37475.88"/>
<text text-anchor="middle" x="4498" y="-37437.88" font-family="Arial" font-size="10.00">SPLIT TOKENS L13</text>
<text text-anchor="middle" x="4498" y="-37426.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4498" y="-37415.88" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4498" y="-37404.88" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer13_moe_gate&#45;&gt;layer13_moe_split -->
<g id="edge743" class="edge">
<title>layer13_moe_gate&#45;&gt;layer13_moe_split</title>
<path fill="none" stroke="black" d="M4498,-37511.75C4498,-37511.75 4498,-37486.06 4498,-37486.06"/>
<polygon fill="black" stroke="black" points="4501.5,-37486.06 4498,-37476.06 4494.5,-37486.06 4501.5,-37486.06"/>
</g>
<!-- layer13_moe_comm_to_expert0 -->
<g id="node532" class="node">
<title>layer13_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2417" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2417" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2417" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2417" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert0 -->
<g id="edge677" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4332.64,-37461C3851.77,-37461 2487.75,-37461 2487.75,-37461 2487.75,-37461 2487.75,-37335.18 2487.75,-37335.18"/>
<polygon fill="black" stroke="black" points="2491.25,-37335.18 2487.75,-37325.18 2484.25,-37335.18 2491.25,-37335.18"/>
</g>
<!-- layer13_moe_comm_to_expert1 -->
<g id="node534" class="node">
<title>layer13_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2662" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2662" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2662" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2662" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert1 -->
<g id="edge679" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4317.92,-37446C3858.8,-37446 2680.5,-37446 2680.5,-37446 2680.5,-37446 2680.5,-37345.38 2680.5,-37345.38"/>
<polygon fill="black" stroke="black" points="2684,-37345.38 2680.5,-37335.38 2677,-37345.38 2684,-37345.38"/>
</g>
<!-- layer13_moe_comm_to_expert2 -->
<g id="node536" class="node">
<title>layer13_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3118" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3118" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3118" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3118" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert2 -->
<g id="edge681" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4302.93,-37431C3926.46,-37431 3136.5,-37431 3136.5,-37431 3136.5,-37431 3136.5,-37345.37 3136.5,-37345.37"/>
<polygon fill="black" stroke="black" points="3140,-37345.37 3136.5,-37335.37 3133,-37345.37 3140,-37345.37"/>
</g>
<!-- layer13_moe_comm_to_expert3 -->
<g id="node538" class="node">
<title>layer13_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3446" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3446" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3446" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3446" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert3 -->
<g id="edge683" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4287.92,-37416C3985.79,-37416 3464.5,-37416 3464.5,-37416 3464.5,-37416 3464.5,-37345.27 3464.5,-37345.27"/>
<polygon fill="black" stroke="black" points="3468,-37345.27 3464.5,-37335.27 3461,-37345.27 3468,-37345.27"/>
</g>
<!-- layer13_moe_comm_to_expert4 -->
<g id="node540" class="node">
<title>layer13_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3709" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3709" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3709" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3709" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert4 -->
<g id="edge685" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4273.07,-37401C4045.64,-37401 3727.5,-37401 3727.5,-37401 3727.5,-37401 3727.5,-37345.38 3727.5,-37345.38"/>
<polygon fill="black" stroke="black" points="3731,-37345.38 3727.5,-37335.38 3724,-37345.38 3731,-37345.38"/>
</g>
<!-- layer13_moe_comm_to_expert5 -->
<g id="node542" class="node">
<title>layer13_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3940" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3940" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3940" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3940" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert5 -->
<g id="edge687" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4257.83,-37386C4113.86,-37386 3958.5,-37386 3958.5,-37386 3958.5,-37386 3958.5,-37345.45 3958.5,-37345.45"/>
<polygon fill="black" stroke="black" points="3962,-37345.45 3958.5,-37335.45 3955,-37345.45 3962,-37345.45"/>
</g>
<!-- layer13_moe_comm_to_expert6 -->
<g id="node544" class="node">
<title>layer13_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4155" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4155" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4155" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4155" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert6 -->
<g id="edge689" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4258.5,-37423.8C4258.5,-37420.23 4258.5,-37306 4258.5,-37306 4258.5,-37306 4255.81,-37306 4255.81,-37306"/>
<polygon fill="black" stroke="black" points="4255.81,-37302.5 4245.81,-37306 4255.81,-37309.5 4255.81,-37302.5"/>
</g>
<!-- layer13_moe_comm_to_expert7 -->
<g id="node546" class="node">
<title>layer13_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4362" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4362" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4362" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4362" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert7 -->
<g id="edge691" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4362,-37371.55C4362,-37371.55 4362,-37346.1 4362,-37346.1"/>
<polygon fill="black" stroke="black" points="4365.5,-37346.1 4362,-37336.1 4358.5,-37346.1 4365.5,-37346.1"/>
</g>
<!-- layer13_moe_comm_to_expert8 -->
<g id="node548" class="node">
<title>layer13_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4634" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4634" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4634" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4634" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert8 -->
<g id="edge693" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4634,-37371.55C4634,-37371.55 4634,-37346.1 4634,-37346.1"/>
<polygon fill="black" stroke="black" points="4637.5,-37346.1 4634,-37336.1 4630.5,-37346.1 4637.5,-37346.1"/>
</g>
<!-- layer13_moe_comm_to_expert9 -->
<g id="node550" class="node">
<title>layer13_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4943" cy="-37306.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4943" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4943" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4943" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert9 -->
<g id="edge695" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4738.26,-37423.8C4738.26,-37420.23 4738.26,-37306 4738.26,-37306 4738.26,-37306 4842.3,-37306 4842.3,-37306"/>
<polygon fill="black" stroke="black" points="4842.3,-37309.5 4852.3,-37306 4842.3,-37302.5 4842.3,-37309.5"/>
</g>
<!-- layer13_moe_comm_to_expert10 -->
<g id="node552" class="node">
<title>layer13_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5275" cy="-37306.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5275" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5275" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5275" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert10 -->
<g id="edge697" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4662.38,-37386C4869.6,-37386 5199.1,-37386 5199.1,-37386 5199.1,-37386 5199.1,-37334.06 5199.1,-37334.06"/>
<polygon fill="black" stroke="black" points="5202.6,-37334.06 5199.1,-37324.06 5195.6,-37334.06 5202.6,-37334.06"/>
</g>
<!-- layer13_moe_comm_to_expert11 -->
<g id="node554" class="node">
<title>layer13_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5621" cy="-37306.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5621" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5621" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5621" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert11 -->
<g id="edge699" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4677.2,-37401C4976.48,-37401 5545.6,-37401 5545.6,-37401 5545.6,-37401 5545.6,-37334.59 5545.6,-37334.59"/>
<polygon fill="black" stroke="black" points="5549.1,-37334.59 5545.6,-37324.59 5542.1,-37334.59 5549.1,-37334.59"/>
</g>
<!-- layer13_moe_comm_to_expert12 -->
<g id="node556" class="node">
<title>layer13_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5972" cy="-37306.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5972" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5972" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5972" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert12 -->
<g id="edge701" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4692.47,-37416C5076.77,-37416 5896.6,-37416 5896.6,-37416 5896.6,-37416 5896.6,-37334.42 5896.6,-37334.42"/>
<polygon fill="black" stroke="black" points="5900.1,-37334.42 5896.6,-37324.42 5893.1,-37334.42 5900.1,-37334.42"/>
</g>
<!-- layer13_moe_comm_to_expert13 -->
<g id="node558" class="node">
<title>layer13_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6325" cy="-37306.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6325" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6325" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6325" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert13 -->
<g id="edge703" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4707.17,-37431C5172,-37431 6250.1,-37431 6250.1,-37431 6250.1,-37431 6250.1,-37334.67 6250.1,-37334.67"/>
<polygon fill="black" stroke="black" points="6253.6,-37334.67 6250.1,-37324.67 6246.6,-37334.67 6253.6,-37334.67"/>
</g>
<!-- layer13_moe_comm_to_expert14 -->
<g id="node560" class="node">
<title>layer13_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6680" cy="-37306.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6680" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6680" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6680" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert14 -->
<g id="edge705" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4722.5,-37446C5265.43,-37446 6605.1,-37446 6605.1,-37446 6605.1,-37446 6605.1,-37334.51 6605.1,-37334.51"/>
<polygon fill="black" stroke="black" points="6608.6,-37334.51 6605.1,-37324.51 6601.6,-37334.51 6608.6,-37334.51"/>
</g>
<!-- layer13_moe_comm_to_expert15 -->
<g id="node562" class="node">
<title>layer13_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="7035" cy="-37306.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="7035" y="-37315.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="7035" y="-37304.39" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7035" y="-37293.39" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert15 -->
<g id="edge707" class="edge">
<title>layer13_moe_split&#45;&gt;layer13_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4737.15,-37461C5355.66,-37461 6960.1,-37461 6960.1,-37461 6960.1,-37461 6960.1,-37334.57 6960.1,-37334.57"/>
<polygon fill="black" stroke="black" points="6963.6,-37334.57 6960.1,-37324.57 6956.6,-37334.57 6963.6,-37334.57"/>
</g>
<!-- layer13_moe_expert0 -->
<g id="node531" class="node">
<title>layer13_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2067,-37241.9 1739,-37241.9 1739,-37189.9 2067,-37189.9 2067,-37241.9"/>
<text text-anchor="middle" x="1903" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 0 L13</text>
<text text-anchor="middle" x="1903" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1903" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1903" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert0 -->
<g id="node564" class="node">
<title>layer13_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2069" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2069" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2069" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2069" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer13_moe_expert0&#45;&gt;layer13_moe_comm_from_expert0 -->
<g id="edge709" class="edge">
<title>layer13_moe_expert0&#45;&gt;layer13_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M2022.75,-37189.58C2022.75,-37189.58 2022.75,-37159.92 2022.75,-37159.92"/>
<polygon fill="black" stroke="black" points="2026.25,-37159.92 2022.75,-37149.92 2019.25,-37159.92 2026.25,-37159.92"/>
</g>
<!-- layer13_moe_comm_to_expert0&#45;&gt;layer13_moe_expert0 -->
<g id="edge678" class="edge">
<title>layer13_moe_comm_to_expert0&#45;&gt;layer13_moe_expert0</title>
<path fill="none" stroke="black" d="M2326.45,-37306C2198.78,-37306 1981.25,-37306 1981.25,-37306 1981.25,-37306 1981.25,-37251.96 1981.25,-37251.96"/>
<polygon fill="black" stroke="black" points="1984.75,-37251.96 1981.25,-37241.96 1977.75,-37251.96 1984.75,-37251.96"/>
</g>
<!-- layer13_moe_expert1 -->
<g id="node533" class="node">
<title>layer13_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2413,-37241.9 2085,-37241.9 2085,-37189.9 2413,-37189.9 2413,-37241.9"/>
<text text-anchor="middle" x="2249" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 1 L13</text>
<text text-anchor="middle" x="2249" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2249" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2249" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert1 -->
<g id="node565" class="node">
<title>layer13_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2415" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2415" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2415" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2415" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer13_moe_expert1&#45;&gt;layer13_moe_comm_from_expert1 -->
<g id="edge711" class="edge">
<title>layer13_moe_expert1&#45;&gt;layer13_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2368.75,-37189.58C2368.75,-37189.58 2368.75,-37159.92 2368.75,-37159.92"/>
<polygon fill="black" stroke="black" points="2372.25,-37159.92 2368.75,-37149.92 2365.25,-37159.92 2372.25,-37159.92"/>
</g>
<!-- layer13_moe_comm_to_expert1&#45;&gt;layer13_moe_expert1 -->
<g id="edge680" class="edge">
<title>layer13_moe_comm_to_expert1&#45;&gt;layer13_moe_expert1</title>
<path fill="none" stroke="black" d="M2662,-37277.78C2662,-37263.78 2662,-37250 2662,-37250 2662,-37250 2369.75,-37250 2369.75,-37250 2369.75,-37250 2369.75,-37249.21 2369.75,-37249.21"/>
<polygon fill="black" stroke="black" points="2373.25,-37252.09 2369.75,-37242.09 2366.25,-37252.09 2373.25,-37252.09"/>
</g>
<!-- layer13_moe_expert2 -->
<g id="node535" class="node">
<title>layer13_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2759,-37241.9 2431,-37241.9 2431,-37189.9 2759,-37189.9 2759,-37241.9"/>
<text text-anchor="middle" x="2595" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 2 L13</text>
<text text-anchor="middle" x="2595" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2595" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2595" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert2 -->
<g id="node566" class="node">
<title>layer13_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2687" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2687" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2687" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2687" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer13_moe_expert2&#45;&gt;layer13_moe_comm_from_expert2 -->
<g id="edge713" class="edge">
<title>layer13_moe_expert2&#45;&gt;layer13_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2677.75,-37189.58C2677.75,-37189.58 2677.75,-37164.04 2677.75,-37164.04"/>
<polygon fill="black" stroke="black" points="2681.25,-37164.04 2677.75,-37154.04 2674.25,-37164.04 2681.25,-37164.04"/>
</g>
<!-- layer13_moe_comm_to_expert2&#45;&gt;layer13_moe_expert2 -->
<g id="edge682" class="edge">
<title>layer13_moe_comm_to_expert2&#45;&gt;layer13_moe_expert2</title>
<path fill="none" stroke="black" d="M3027.41,-37306C2923.71,-37306 2768,-37306 2768,-37306 2768,-37306 2768,-37215 2768,-37215 2768,-37215 2767.12,-37215 2767.12,-37215"/>
<polygon fill="black" stroke="black" points="2769.18,-37211.5 2759.18,-37215 2769.18,-37218.5 2769.18,-37211.5"/>
</g>
<!-- layer13_moe_expert3 -->
<g id="node537" class="node">
<title>layer13_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3105,-37241.9 2777,-37241.9 2777,-37189.9 3105,-37189.9 3105,-37241.9"/>
<text text-anchor="middle" x="2941" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 3 L13</text>
<text text-anchor="middle" x="2941" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2941" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2941" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert3 -->
<g id="node567" class="node">
<title>layer13_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3015" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3015" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3015" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3015" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer13_moe_expert3&#45;&gt;layer13_moe_comm_from_expert3 -->
<g id="edge715" class="edge">
<title>layer13_moe_expert3&#45;&gt;layer13_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3014.75,-37189.58C3014.75,-37189.58 3014.75,-37164.04 3014.75,-37164.04"/>
<polygon fill="black" stroke="black" points="3018.25,-37164.04 3014.75,-37154.04 3011.25,-37164.04 3018.25,-37164.04"/>
</g>
<!-- layer13_moe_comm_to_expert3&#45;&gt;layer13_moe_expert3 -->
<g id="edge684" class="edge">
<title>layer13_moe_comm_to_expert3&#45;&gt;layer13_moe_expert3</title>
<path fill="none" stroke="black" d="M3387.33,-37284.72C3387.33,-37275.99 3387.33,-37268 3387.33,-37268 3387.33,-37268 3066.25,-37268 3066.25,-37268 3066.25,-37268 3066.25,-37251.95 3066.25,-37251.95"/>
<polygon fill="black" stroke="black" points="3069.75,-37251.95 3066.25,-37241.95 3062.75,-37251.95 3069.75,-37251.95"/>
</g>
<!-- layer13_moe_expert4 -->
<g id="node539" class="node">
<title>layer13_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3451,-37241.9 3123,-37241.9 3123,-37189.9 3451,-37189.9 3451,-37241.9"/>
<text text-anchor="middle" x="3287" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 4 L13</text>
<text text-anchor="middle" x="3287" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3287" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3287" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert4 -->
<g id="node568" class="node">
<title>layer13_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3508" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3508" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3508" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3508" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer13_moe_expert4&#45;&gt;layer13_moe_comm_from_expert4 -->
<g id="edge717" class="edge">
<title>layer13_moe_expert4&#45;&gt;layer13_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3434.25,-37189.58C3434.25,-37189.58 3434.25,-37151.98 3434.25,-37151.98"/>
<polygon fill="black" stroke="black" points="3437.75,-37151.98 3434.25,-37141.98 3430.75,-37151.98 3437.75,-37151.98"/>
</g>
<!-- layer13_moe_comm_to_expert4&#45;&gt;layer13_moe_expert4 -->
<g id="edge686" class="edge">
<title>layer13_moe_comm_to_expert4&#45;&gt;layer13_moe_expert4</title>
<path fill="none" stroke="black" d="M3707.75,-37277.65C3707.75,-37267.68 3707.75,-37259 3707.75,-37259 3707.75,-37259 3419.16,-37259 3419.16,-37259 3419.16,-37259 3419.16,-37251.97 3419.16,-37251.97"/>
<polygon fill="black" stroke="black" points="3422.66,-37251.97 3419.16,-37241.97 3415.66,-37251.97 3422.66,-37251.97"/>
</g>
<!-- layer13_moe_expert5 -->
<g id="node541" class="node">
<title>layer13_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3797,-37241.9 3469,-37241.9 3469,-37189.9 3797,-37189.9 3797,-37241.9"/>
<text text-anchor="middle" x="3633" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 5 L13</text>
<text text-anchor="middle" x="3633" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3633" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3633" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert5 -->
<g id="node569" class="node">
<title>layer13_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3854" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3854" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3854" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3854" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer13_moe_expert5&#45;&gt;layer13_moe_comm_from_expert5 -->
<g id="edge719" class="edge">
<title>layer13_moe_expert5&#45;&gt;layer13_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3780.25,-37189.58C3780.25,-37189.58 3780.25,-37151.98 3780.25,-37151.98"/>
<polygon fill="black" stroke="black" points="3783.75,-37151.98 3780.25,-37141.98 3776.75,-37151.98 3783.75,-37151.98"/>
</g>
<!-- layer13_moe_comm_to_expert5&#45;&gt;layer13_moe_expert5 -->
<g id="edge688" class="edge">
<title>layer13_moe_comm_to_expert5&#45;&gt;layer13_moe_expert5</title>
<path fill="none" stroke="black" d="M3849.26,-37306C3825.92,-37306 3807.25,-37306 3807.25,-37306 3807.25,-37306 3807.25,-37215 3807.25,-37215 3807.25,-37215 3806.24,-37215 3806.24,-37215"/>
<polygon fill="black" stroke="black" points="3807.13,-37211.5 3797.13,-37215 3807.13,-37218.5 3807.13,-37211.5"/>
</g>
<!-- layer13_moe_expert6 -->
<g id="node543" class="node">
<title>layer13_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4143,-37241.9 3815,-37241.9 3815,-37189.9 4143,-37189.9 4143,-37241.9"/>
<text text-anchor="middle" x="3979" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 6 L13</text>
<text text-anchor="middle" x="3979" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3979" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3979" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert6 -->
<g id="node570" class="node">
<title>layer13_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4126" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4126" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4126" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4126" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer13_moe_expert6&#45;&gt;layer13_moe_comm_from_expert6 -->
<g id="edge721" class="edge">
<title>layer13_moe_expert6&#45;&gt;layer13_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4089.25,-37189.58C4089.25,-37189.58 4089.25,-37161.48 4089.25,-37161.48"/>
<polygon fill="black" stroke="black" points="4092.75,-37161.48 4089.25,-37151.48 4085.75,-37161.48 4092.75,-37161.48"/>
</g>
<!-- layer13_moe_comm_to_expert6&#45;&gt;layer13_moe_expert6 -->
<g id="edge690" class="edge">
<title>layer13_moe_comm_to_expert6&#45;&gt;layer13_moe_expert6</title>
<path fill="none" stroke="black" d="M4103.75,-37282.99C4103.75,-37282.99 4103.75,-37252.21 4103.75,-37252.21"/>
<polygon fill="black" stroke="black" points="4107.25,-37252.21 4103.75,-37242.21 4100.25,-37252.21 4107.25,-37252.21"/>
</g>
<!-- layer13_moe_expert7 -->
<g id="node545" class="node">
<title>layer13_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4489,-37241.9 4161,-37241.9 4161,-37189.9 4489,-37189.9 4489,-37241.9"/>
<text text-anchor="middle" x="4325" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 7 L13</text>
<text text-anchor="middle" x="4325" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4325" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4325" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert7 -->
<g id="node571" class="node">
<title>layer13_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4362" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4362" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4362" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4362" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer13_moe_expert7&#45;&gt;layer13_moe_comm_from_expert7 -->
<g id="edge723" class="edge">
<title>layer13_moe_expert7&#45;&gt;layer13_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4362,-37189.58C4362,-37189.58 4362,-37164.04 4362,-37164.04"/>
<polygon fill="black" stroke="black" points="4365.5,-37164.04 4362,-37154.04 4358.5,-37164.04 4365.5,-37164.04"/>
</g>
<!-- layer13_moe_comm_to_expert7&#45;&gt;layer13_moe_expert7 -->
<g id="edge692" class="edge">
<title>layer13_moe_comm_to_expert7&#45;&gt;layer13_moe_expert7</title>
<path fill="none" stroke="black" d="M4362,-37277.85C4362,-37277.85 4362,-37252.2 4362,-37252.2"/>
<polygon fill="black" stroke="black" points="4365.5,-37252.2 4362,-37242.2 4358.5,-37252.2 4365.5,-37252.2"/>
</g>
<!-- layer13_moe_expert8 -->
<g id="node547" class="node">
<title>layer13_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4835,-37241.9 4507,-37241.9 4507,-37189.9 4835,-37189.9 4835,-37241.9"/>
<text text-anchor="middle" x="4671" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 8 L13</text>
<text text-anchor="middle" x="4671" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4671" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4671" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert8 -->
<g id="node572" class="node">
<title>layer13_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4634" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4634" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4634" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4634" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer13_moe_expert8&#45;&gt;layer13_moe_comm_from_expert8 -->
<g id="edge725" class="edge">
<title>layer13_moe_expert8&#45;&gt;layer13_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4634,-37189.58C4634,-37189.58 4634,-37164.04 4634,-37164.04"/>
<polygon fill="black" stroke="black" points="4637.5,-37164.04 4634,-37154.04 4630.5,-37164.04 4637.5,-37164.04"/>
</g>
<!-- layer13_moe_comm_to_expert8&#45;&gt;layer13_moe_expert8 -->
<g id="edge694" class="edge">
<title>layer13_moe_comm_to_expert8&#45;&gt;layer13_moe_expert8</title>
<path fill="none" stroke="black" d="M4634,-37277.85C4634,-37277.85 4634,-37252.2 4634,-37252.2"/>
<polygon fill="black" stroke="black" points="4637.5,-37252.2 4634,-37242.2 4630.5,-37252.2 4637.5,-37252.2"/>
</g>
<!-- layer13_moe_expert9 -->
<g id="node549" class="node">
<title>layer13_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5181,-37241.9 4853,-37241.9 4853,-37189.9 5181,-37189.9 5181,-37241.9"/>
<text text-anchor="middle" x="5017" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 9 L13</text>
<text text-anchor="middle" x="5017" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="5017" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="5017" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert9 -->
<g id="node573" class="node">
<title>layer13_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4943" cy="-37124.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4943" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4943" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4943" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer13_moe_expert9&#45;&gt;layer13_moe_comm_from_expert9 -->
<g id="edge727" class="edge">
<title>layer13_moe_expert9&#45;&gt;layer13_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4943.25,-37189.58C4943.25,-37189.58 4943.25,-37164.04 4943.25,-37164.04"/>
<polygon fill="black" stroke="black" points="4946.75,-37164.04 4943.25,-37154.04 4939.75,-37164.04 4946.75,-37164.04"/>
</g>
<!-- layer13_moe_comm_to_expert9&#45;&gt;layer13_moe_expert9 -->
<g id="edge696" class="edge">
<title>layer13_moe_comm_to_expert9&#45;&gt;layer13_moe_expert9</title>
<path fill="none" stroke="black" d="M4943.25,-37277.85C4943.25,-37277.85 4943.25,-37252.2 4943.25,-37252.2"/>
<polygon fill="black" stroke="black" points="4946.75,-37252.2 4943.25,-37242.2 4939.75,-37252.2 4946.75,-37252.2"/>
</g>
<!-- layer13_moe_expert10 -->
<g id="node551" class="node">
<title>layer13_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5537,-37241.9 5199,-37241.9 5199,-37189.9 5537,-37189.9 5537,-37241.9"/>
<text text-anchor="middle" x="5368" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 10 L13</text>
<text text-anchor="middle" x="5368" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5368" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5368" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert10 -->
<g id="node574" class="node">
<title>layer13_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5275" cy="-37124.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5275" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5275" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5275" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer13_moe_expert10&#45;&gt;layer13_moe_comm_from_expert10 -->
<g id="edge729" class="edge">
<title>layer13_moe_expert10&#45;&gt;layer13_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5284.38,-37189.58C5284.38,-37189.58 5284.38,-37164.04 5284.38,-37164.04"/>
<polygon fill="black" stroke="black" points="5287.88,-37164.04 5284.38,-37154.04 5280.88,-37164.04 5287.88,-37164.04"/>
</g>
<!-- layer13_moe_comm_to_expert10&#45;&gt;layer13_moe_expert10 -->
<g id="edge698" class="edge">
<title>layer13_moe_comm_to_expert10&#45;&gt;layer13_moe_expert10</title>
<path fill="none" stroke="black" d="M5284.02,-37277.85C5284.02,-37277.85 5284.02,-37252.2 5284.02,-37252.2"/>
<polygon fill="black" stroke="black" points="5287.52,-37252.2 5284.02,-37242.2 5280.52,-37252.2 5287.52,-37252.2"/>
</g>
<!-- layer13_moe_expert11 -->
<g id="node553" class="node">
<title>layer13_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5893,-37241.9 5555,-37241.9 5555,-37189.9 5893,-37189.9 5893,-37241.9"/>
<text text-anchor="middle" x="5724" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 11 L13</text>
<text text-anchor="middle" x="5724" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5724" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5724" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert11 -->
<g id="node575" class="node">
<title>layer13_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5622" cy="-37124.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5622" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5622" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5622" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer13_moe_expert11&#45;&gt;layer13_moe_comm_from_expert11 -->
<g id="edge731" class="edge">
<title>layer13_moe_expert11&#45;&gt;layer13_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5635.88,-37189.58C5635.88,-37189.58 5635.88,-37163.72 5635.88,-37163.72"/>
<polygon fill="black" stroke="black" points="5639.38,-37163.72 5635.88,-37153.72 5632.38,-37163.72 5639.38,-37163.72"/>
</g>
<!-- layer13_moe_comm_to_expert11&#45;&gt;layer13_moe_expert11 -->
<g id="edge700" class="edge">
<title>layer13_moe_comm_to_expert11&#45;&gt;layer13_moe_expert11</title>
<path fill="none" stroke="black" d="M5635.02,-37278.1C5635.02,-37278.1 5635.02,-37252.04 5635.02,-37252.04"/>
<polygon fill="black" stroke="black" points="5638.52,-37252.04 5635.02,-37242.04 5631.52,-37252.04 5638.52,-37252.04"/>
</g>
<!-- layer13_moe_expert12 -->
<g id="node555" class="node">
<title>layer13_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6249,-37241.9 5911,-37241.9 5911,-37189.9 6249,-37189.9 6249,-37241.9"/>
<text text-anchor="middle" x="6080" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 12 L13</text>
<text text-anchor="middle" x="6080" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6080" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6080" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert12 -->
<g id="node576" class="node">
<title>layer13_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5973" cy="-37124.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5973" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5973" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5973" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer13_moe_expert12&#45;&gt;layer13_moe_comm_from_expert12 -->
<g id="edge733" class="edge">
<title>layer13_moe_expert12&#45;&gt;layer13_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5989.38,-37189.58C5989.38,-37189.58 5989.38,-37163.72 5989.38,-37163.72"/>
<polygon fill="black" stroke="black" points="5992.88,-37163.72 5989.38,-37153.72 5985.88,-37163.72 5992.88,-37163.72"/>
</g>
<!-- layer13_moe_comm_to_expert12&#45;&gt;layer13_moe_expert12 -->
<g id="edge702" class="edge">
<title>layer13_moe_comm_to_expert12&#45;&gt;layer13_moe_expert12</title>
<path fill="none" stroke="black" d="M5988.52,-37278.1C5988.52,-37278.1 5988.52,-37252.04 5988.52,-37252.04"/>
<polygon fill="black" stroke="black" points="5992.02,-37252.04 5988.52,-37242.04 5985.02,-37252.04 5992.02,-37252.04"/>
</g>
<!-- layer13_moe_expert13 -->
<g id="node557" class="node">
<title>layer13_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6605,-37241.9 6267,-37241.9 6267,-37189.9 6605,-37189.9 6605,-37241.9"/>
<text text-anchor="middle" x="6436" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 13 L13</text>
<text text-anchor="middle" x="6436" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6436" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6436" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert13 -->
<g id="node577" class="node">
<title>layer13_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6327" cy="-37124.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6327" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6327" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6327" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer13_moe_expert13&#45;&gt;layer13_moe_comm_from_expert13 -->
<g id="edge735" class="edge">
<title>layer13_moe_expert13&#45;&gt;layer13_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6344.38,-37189.58C6344.38,-37189.58 6344.38,-37163.72 6344.38,-37163.72"/>
<polygon fill="black" stroke="black" points="6347.88,-37163.72 6344.38,-37153.72 6340.88,-37163.72 6347.88,-37163.72"/>
</g>
<!-- layer13_moe_comm_to_expert13&#45;&gt;layer13_moe_expert13 -->
<g id="edge704" class="edge">
<title>layer13_moe_comm_to_expert13&#45;&gt;layer13_moe_expert13</title>
<path fill="none" stroke="black" d="M6343.02,-37278.1C6343.02,-37278.1 6343.02,-37252.04 6343.02,-37252.04"/>
<polygon fill="black" stroke="black" points="6346.52,-37252.04 6343.02,-37242.04 6339.52,-37252.04 6346.52,-37252.04"/>
</g>
<!-- layer13_moe_expert14 -->
<g id="node559" class="node">
<title>layer13_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6961,-37241.9 6623,-37241.9 6623,-37189.9 6961,-37189.9 6961,-37241.9"/>
<text text-anchor="middle" x="6792" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 14 L13</text>
<text text-anchor="middle" x="6792" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6792" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6792" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert14 -->
<g id="node578" class="node">
<title>layer13_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6682" cy="-37124.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6682" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6682" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6682" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer13_moe_expert14&#45;&gt;layer13_moe_comm_from_expert14 -->
<g id="edge737" class="edge">
<title>layer13_moe_expert14&#45;&gt;layer13_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6699.88,-37189.58C6699.88,-37189.58 6699.88,-37163.4 6699.88,-37163.4"/>
<polygon fill="black" stroke="black" points="6703.38,-37163.4 6699.88,-37153.4 6696.38,-37163.4 6703.38,-37163.4"/>
</g>
<!-- layer13_moe_comm_to_expert14&#45;&gt;layer13_moe_expert14 -->
<g id="edge706" class="edge">
<title>layer13_moe_comm_to_expert14&#45;&gt;layer13_moe_expert14</title>
<path fill="none" stroke="black" d="M6698.52,-37278.1C6698.52,-37278.1 6698.52,-37252.04 6698.52,-37252.04"/>
<polygon fill="black" stroke="black" points="6702.02,-37252.04 6698.52,-37242.04 6695.02,-37252.04 6702.02,-37252.04"/>
</g>
<!-- layer13_moe_expert15 -->
<g id="node561" class="node">
<title>layer13_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7317,-37241.9 6979,-37241.9 6979,-37189.9 7317,-37189.9 7317,-37241.9"/>
<text text-anchor="middle" x="7148" y="-37229.9" font-family="Arial" font-size="10.00">EXPERT 15 L13</text>
<text text-anchor="middle" x="7148" y="-37218.9" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7148" y="-37207.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7148" y="-37196.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_comm_from_expert15 -->
<g id="node579" class="node">
<title>layer13_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7037" cy="-37124.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7037" y="-37133.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7037" y="-37122.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7037" y="-37111.41" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer13_moe_expert15&#45;&gt;layer13_moe_comm_from_expert15 -->
<g id="edge739" class="edge">
<title>layer13_moe_expert15&#45;&gt;layer13_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7055.38,-37189.58C7055.38,-37189.58 7055.38,-37163.4 7055.38,-37163.4"/>
<polygon fill="black" stroke="black" points="7058.88,-37163.4 7055.38,-37153.4 7051.88,-37163.4 7058.88,-37163.4"/>
</g>
<!-- layer13_moe_comm_to_expert15&#45;&gt;layer13_moe_expert15 -->
<g id="edge708" class="edge">
<title>layer13_moe_comm_to_expert15&#45;&gt;layer13_moe_expert15</title>
<path fill="none" stroke="black" d="M7054.02,-37278.1C7054.02,-37278.1 7054.02,-37252.04 7054.02,-37252.04"/>
<polygon fill="black" stroke="black" points="7057.52,-37252.04 7054.02,-37242.04 7050.52,-37252.04 7057.52,-37252.04"/>
</g>
<!-- layer13_moe_aggregate -->
<g id="node563" class="node">
<title>layer13_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4723.1,-37059.92 4306.16,-37059.92 4198.9,-36955.92 4615.84,-36955.92 4723.1,-37059.92"/>
<text text-anchor="middle" x="4461" y="-37021.92" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L13</text>
<text text-anchor="middle" x="4461" y="-37010.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4461" y="-36999.92" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4461" y="-36988.92" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_mha -->
<g id="node580" class="node">
<title>layer14_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4591,-36919.92 4331,-36919.92 4331,-36867.92 4591,-36867.92 4591,-36919.92"/>
<text text-anchor="middle" x="4461" y="-36907.92" font-family="Arial" font-size="10.00">MHA L14</text>
<text text-anchor="middle" x="4461" y="-36896.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4461" y="-36885.92" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4461" y="-36874.92" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer13_moe_aggregate&#45;&gt;layer14_moe_mha -->
<g id="edge808" class="edge">
<title>layer13_moe_aggregate&#45;&gt;layer14_moe_mha</title>
<path fill="none" stroke="black" d="M4461,-36955.59C4461,-36955.59 4461,-36930.15 4461,-36930.15"/>
<polygon fill="black" stroke="black" points="4464.5,-36930.15 4461,-36920.15 4457.5,-36930.15 4464.5,-36930.15"/>
</g>
<!-- layer13_moe_comm_from_expert0&#45;&gt;layer13_moe_aggregate -->
<g id="edge710" class="edge">
<title>layer13_moe_comm_from_expert0&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M2103.75,-37097.93C2103.75,-37053.54 2103.75,-36970 2103.75,-36970 2103.75,-36970 4203.19,-36970 4203.19,-36970"/>
<polygon fill="black" stroke="black" points="4203.19,-36973.5 4213.19,-36970 4203.19,-36966.5 4203.19,-36973.5"/>
</g>
<!-- layer13_moe_comm_from_expert1&#45;&gt;layer13_moe_aggregate -->
<g id="edge712" class="edge">
<title>layer13_moe_comm_from_expert1&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M2449.75,-37097.93C2449.75,-37057.28 2449.75,-36985 2449.75,-36985 2449.75,-36985 4218.81,-36985 4218.81,-36985"/>
<polygon fill="black" stroke="black" points="4218.81,-36988.5 4228.81,-36985 4218.81,-36981.5 4218.81,-36988.5"/>
</g>
<!-- layer13_moe_comm_from_expert2&#45;&gt;layer13_moe_aggregate -->
<g id="edge714" class="edge">
<title>layer13_moe_comm_from_expert2&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M2759.01,-37107.28C2759.01,-37072.85 2759.01,-37000 2759.01,-37000 2759.01,-37000 4234.15,-37000 4234.15,-37000"/>
<polygon fill="black" stroke="black" points="4234.15,-37003.5 4244.15,-37000 4234.15,-36996.5 4234.15,-37003.5"/>
</g>
<!-- layer13_moe_comm_from_expert3&#45;&gt;layer13_moe_aggregate -->
<g id="edge716" class="edge">
<title>layer13_moe_comm_from_expert3&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M3095.75,-37111.43C3095.75,-37082.08 3095.75,-37015 3095.75,-37015 3095.75,-37015 4249.55,-37015 4249.55,-37015"/>
<polygon fill="black" stroke="black" points="4249.55,-37018.5 4259.55,-37015 4249.55,-37011.5 4249.55,-37018.5"/>
</g>
<!-- layer13_moe_comm_from_expert4&#45;&gt;layer13_moe_aggregate -->
<g id="edge718" class="edge">
<title>layer13_moe_comm_from_expert4&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M3580.01,-37107.06C3580.01,-37079.56 3580.01,-37030 3580.01,-37030 3580.01,-37030 4265.24,-37030 4265.24,-37030"/>
<polygon fill="black" stroke="black" points="4265.24,-37033.5 4275.24,-37030 4265.24,-37026.5 4265.24,-37033.5"/>
</g>
<!-- layer13_moe_comm_from_expert5&#45;&gt;layer13_moe_aggregate -->
<g id="edge720" class="edge">
<title>layer13_moe_comm_from_expert5&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M3926.01,-37107.18C3926.01,-37083.63 3926.01,-37045 3926.01,-37045 3926.01,-37045 4280.62,-37045 4280.62,-37045"/>
<polygon fill="black" stroke="black" points="4280.62,-37048.5 4290.62,-37045 4280.62,-37041.5 4280.62,-37048.5"/>
</g>
<!-- layer13_moe_comm_from_expert6&#45;&gt;layer13_moe_aggregate -->
<g id="edge722" class="edge">
<title>layer13_moe_comm_from_expert6&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M4207.61,-37111.94C4207.61,-37111.94 4207.61,-37017.97 4207.61,-37017.97"/>
<polygon fill="black" stroke="black" points="4211.11,-37017.97 4207.61,-37007.97 4204.11,-37017.97 4211.11,-37017.97"/>
</g>
<!-- layer13_moe_comm_from_expert7&#45;&gt;layer13_moe_aggregate -->
<g id="edge724" class="edge">
<title>layer13_moe_comm_from_expert7&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M4362,-37095.69C4362,-37095.69 4362,-37069.98 4362,-37069.98"/>
<polygon fill="black" stroke="black" points="4365.5,-37069.98 4362,-37059.98 4358.5,-37069.98 4365.5,-37069.98"/>
</g>
<!-- layer13_moe_comm_from_expert8&#45;&gt;layer13_moe_aggregate -->
<g id="edge726" class="edge">
<title>layer13_moe_comm_from_expert8&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M4633.39,-37095.69C4633.39,-37095.69 4633.39,-37069.98 4633.39,-37069.98"/>
<polygon fill="black" stroke="black" points="4636.89,-37069.98 4633.39,-37059.98 4629.89,-37069.98 4636.89,-37069.98"/>
</g>
<!-- layer13_moe_comm_from_expert9&#45;&gt;layer13_moe_aggregate -->
<g id="edge728" class="edge">
<title>layer13_moe_comm_from_expert9&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M4924.5,-37096.42C4924.5,-37073.82 4924.5,-37046 4924.5,-37046 4924.5,-37046 4719.03,-37046 4719.03,-37046"/>
<polygon fill="black" stroke="black" points="4719.03,-37042.5 4709.03,-37046 4719.03,-37049.5 4719.03,-37042.5"/>
</g>
<!-- layer13_moe_comm_from_expert10&#45;&gt;layer13_moe_aggregate -->
<g id="edge730" class="edge">
<title>layer13_moe_comm_from_expert10&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M5256.15,-37096.33C5256.15,-37069.35 5256.15,-37033 5256.15,-37033 5256.15,-37033 4705.54,-37033 4705.54,-37033"/>
<polygon fill="black" stroke="black" points="4705.54,-37029.5 4695.54,-37033 4705.54,-37036.5 4705.54,-37029.5"/>
</g>
<!-- layer13_moe_comm_from_expert11&#45;&gt;layer13_moe_aggregate -->
<g id="edge732" class="edge">
<title>layer13_moe_comm_from_expert11&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M5602.65,-37096.52C5602.65,-37065.45 5602.65,-37020 5602.65,-37020 5602.65,-37020 4692.14,-37020 4692.14,-37020"/>
<polygon fill="black" stroke="black" points="4692.14,-37016.5 4682.14,-37020 4692.14,-37023.5 4692.14,-37016.5"/>
</g>
<!-- layer13_moe_comm_from_expert12&#45;&gt;layer13_moe_aggregate -->
<g id="edge734" class="edge">
<title>layer13_moe_comm_from_expert12&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M5953.65,-37096.37C5953.65,-37061.47 5953.65,-37007 5953.65,-37007 5953.65,-37007 4678.55,-37007 4678.55,-37007"/>
<polygon fill="black" stroke="black" points="4678.55,-37003.5 4668.55,-37007 4678.55,-37010.5 4678.55,-37003.5"/>
</g>
<!-- layer13_moe_comm_from_expert13&#45;&gt;layer13_moe_aggregate -->
<g id="edge736" class="edge">
<title>layer13_moe_comm_from_expert13&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M6307.15,-37096.5C6307.15,-37058 6307.15,-36994 6307.15,-36994 6307.15,-36994 4665.52,-36994 4665.52,-36994"/>
<polygon fill="black" stroke="black" points="4665.52,-36990.5 4655.52,-36994 4665.52,-36997.5 4665.52,-36990.5"/>
</g>
<!-- layer13_moe_comm_from_expert14&#45;&gt;layer13_moe_aggregate -->
<g id="edge738" class="edge">
<title>layer13_moe_comm_from_expert14&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M6662.15,-37096.48C6662.15,-37054.54 6662.15,-36981 6662.15,-36981 6662.15,-36981 4652.06,-36981 4652.06,-36981"/>
<polygon fill="black" stroke="black" points="4652.06,-36977.5 4642.06,-36981 4652.06,-36984.5 4652.06,-36977.5"/>
</g>
<!-- layer13_moe_comm_from_expert15&#45;&gt;layer13_moe_aggregate -->
<g id="edge740" class="edge">
<title>layer13_moe_comm_from_expert15&#45;&gt;layer13_moe_aggregate</title>
<path fill="none" stroke="black" d="M7017.15,-37096.49C7017.15,-37051.28 7017.15,-36968 7017.15,-36968 7017.15,-36968 4638.72,-36968 4638.72,-36968"/>
<polygon fill="black" stroke="black" points="4638.72,-36964.5 4628.72,-36968 4638.72,-36971.5 4638.72,-36964.5"/>
</g>
<!-- layer14_moe_gate -->
<g id="node581" class="node">
<title>layer14_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4719.3,-36831.92 4308.4,-36831.92 4202.7,-36727.92 4613.6,-36727.92 4719.3,-36831.92"/>
<text text-anchor="middle" x="4461" y="-36793.92" font-family="Arial" font-size="10.00">GATE L14</text>
<text text-anchor="middle" x="4461" y="-36782.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4461" y="-36771.92" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4461" y="-36760.92" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer14_moe_mha&#45;&gt;layer14_moe_gate -->
<g id="edge809" class="edge">
<title>layer14_moe_mha&#45;&gt;layer14_moe_gate</title>
<path fill="none" stroke="black" d="M4461,-36867.76C4461,-36867.76 4461,-36842.02 4461,-36842.02"/>
<polygon fill="black" stroke="black" points="4464.5,-36842.02 4461,-36832.02 4457.5,-36842.02 4464.5,-36842.02"/>
</g>
<!-- layer14_moe_split -->
<g id="node582" class="node">
<title>layer14_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4715.01,-36691.92 4310.94,-36691.92 4206.99,-36587.92 4611.06,-36587.92 4715.01,-36691.92"/>
<text text-anchor="middle" x="4461" y="-36653.92" font-family="Arial" font-size="10.00">SPLIT TOKENS L14</text>
<text text-anchor="middle" x="4461" y="-36642.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4461" y="-36631.92" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4461" y="-36620.92" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer14_moe_gate&#45;&gt;layer14_moe_split -->
<g id="edge810" class="edge">
<title>layer14_moe_gate&#45;&gt;layer14_moe_split</title>
<path fill="none" stroke="black" d="M4461,-36727.79C4461,-36727.79 4461,-36702.09 4461,-36702.09"/>
<polygon fill="black" stroke="black" points="4464.5,-36702.09 4461,-36692.09 4457.5,-36702.09 4464.5,-36702.09"/>
</g>
<!-- layer14_moe_comm_to_expert0 -->
<g id="node584" class="node">
<title>layer14_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1939" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1939" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1939" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1939" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert0 -->
<g id="edge744" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4295.97,-36677C3745.08,-36677 2004,-36677 2004,-36677 2004,-36677 2004,-36553.39 2004,-36553.39"/>
<polygon fill="black" stroke="black" points="2007.5,-36553.39 2004,-36543.39 2000.5,-36553.39 2007.5,-36553.39"/>
</g>
<!-- layer14_moe_comm_to_expert1 -->
<g id="node586" class="node">
<title>layer14_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2285" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2285" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2285" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2285" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert1 -->
<g id="edge746" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4281.02,-36662C3770.52,-36662 2350,-36662 2350,-36662 2350,-36662 2350,-36553.15 2350,-36553.15"/>
<polygon fill="black" stroke="black" points="2353.5,-36553.15 2350,-36543.15 2346.5,-36553.15 2353.5,-36553.15"/>
</g>
<!-- layer14_moe_comm_to_expert2 -->
<g id="node588" class="node">
<title>layer14_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2650" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2650" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2650" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2650" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert2 -->
<g id="edge748" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4265.76,-36647C3801.18,-36647 2668.5,-36647 2668.5,-36647 2668.5,-36647 2668.5,-36561.39 2668.5,-36561.39"/>
<polygon fill="black" stroke="black" points="2672,-36561.39 2668.5,-36551.39 2665,-36561.39 2672,-36561.39"/>
</g>
<!-- layer14_moe_comm_to_expert3 -->
<g id="node590" class="node">
<title>layer14_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2978" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2978" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2978" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2978" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert3 -->
<g id="edge750" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4250.78,-36632C3845.68,-36632 2996.5,-36632 2996.5,-36632 2996.5,-36632 2996.5,-36561.58 2996.5,-36561.58"/>
<polygon fill="black" stroke="black" points="3000,-36561.58 2996.5,-36551.58 2993,-36561.58 3000,-36561.58"/>
</g>
<!-- layer14_moe_comm_to_expert4 -->
<g id="node592" class="node">
<title>layer14_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3471" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3471" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3471" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3471" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert4 -->
<g id="edge752" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4235.98,-36617C3949.01,-36617 3489.5,-36617 3489.5,-36617 3489.5,-36617 3489.5,-36561.41 3489.5,-36561.41"/>
<polygon fill="black" stroke="black" points="3493,-36561.41 3489.5,-36551.41 3486,-36561.41 3493,-36561.41"/>
</g>
<!-- layer14_moe_comm_to_expert5 -->
<g id="node594" class="node">
<title>layer14_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3817" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3817" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3817" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3817" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert5 -->
<g id="edge754" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4220.95,-36602C4044.56,-36602 3835.5,-36602 3835.5,-36602 3835.5,-36602 3835.5,-36561.47 3835.5,-36561.47"/>
<polygon fill="black" stroke="black" points="3839,-36561.47 3835.5,-36551.47 3832,-36561.47 3839,-36561.47"/>
</g>
<!-- layer14_moe_comm_to_expert6 -->
<g id="node596" class="node">
<title>layer14_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4089" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4089" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4089" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4089" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert6 -->
<g id="edge756" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4220.74,-36639.83C4220.74,-36636.26 4220.74,-36522 4220.74,-36522 4220.74,-36522 4189.78,-36522 4189.78,-36522"/>
<polygon fill="black" stroke="black" points="4189.78,-36518.5 4179.78,-36522 4189.78,-36525.5 4189.78,-36518.5"/>
</g>
<!-- layer14_moe_comm_to_expert7 -->
<g id="node598" class="node">
<title>layer14_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4325" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4325" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4325" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4325" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert7 -->
<g id="edge758" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4325,-36587.58C4325,-36587.58 4325,-36562.14 4325,-36562.14"/>
<polygon fill="black" stroke="black" points="4328.5,-36562.14 4325,-36552.14 4321.5,-36562.14 4328.5,-36562.14"/>
</g>
<!-- layer14_moe_comm_to_expert8 -->
<g id="node600" class="node">
<title>layer14_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4597" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4597" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4597" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4597" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert8 -->
<g id="edge760" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4597,-36587.58C4597,-36587.58 4597,-36562.14 4597,-36562.14"/>
<polygon fill="black" stroke="black" points="4600.5,-36562.14 4597,-36552.14 4593.5,-36562.14 4600.5,-36562.14"/>
</g>
<!-- layer14_moe_comm_to_expert9 -->
<g id="node602" class="node">
<title>layer14_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4906" cy="-36522.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4906" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4906" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4906" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert9 -->
<g id="edge762" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4701.26,-36639.83C4701.26,-36636.26 4701.26,-36522 4701.26,-36522 4701.26,-36522 4805.3,-36522 4805.3,-36522"/>
<polygon fill="black" stroke="black" points="4805.3,-36525.5 4815.3,-36522 4805.3,-36518.5 4805.3,-36525.5"/>
</g>
<!-- layer14_moe_comm_to_expert10 -->
<g id="node604" class="node">
<title>layer14_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5238" cy="-36522.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5238" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5238" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5238" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert10 -->
<g id="edge764" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4625.38,-36602C4832.6,-36602 5162.1,-36602 5162.1,-36602 5162.1,-36602 5162.1,-36550.08 5162.1,-36550.08"/>
<polygon fill="black" stroke="black" points="5165.6,-36550.08 5162.1,-36540.08 5158.6,-36550.08 5165.6,-36550.08"/>
</g>
<!-- layer14_moe_comm_to_expert11 -->
<g id="node606" class="node">
<title>layer14_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5584" cy="-36522.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5584" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5584" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5584" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert11 -->
<g id="edge766" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4640.2,-36617C4939.48,-36617 5508.6,-36617 5508.6,-36617 5508.6,-36617 5508.6,-36550.62 5508.6,-36550.62"/>
<polygon fill="black" stroke="black" points="5512.1,-36550.62 5508.6,-36540.62 5505.1,-36550.62 5512.1,-36550.62"/>
</g>
<!-- layer14_moe_comm_to_expert12 -->
<g id="node608" class="node">
<title>layer14_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5935" cy="-36522.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5935" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5935" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5935" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert12 -->
<g id="edge768" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4655.47,-36632C5039.77,-36632 5859.6,-36632 5859.6,-36632 5859.6,-36632 5859.6,-36550.45 5859.6,-36550.45"/>
<polygon fill="black" stroke="black" points="5863.1,-36550.45 5859.6,-36540.45 5856.1,-36550.45 5863.1,-36550.45"/>
</g>
<!-- layer14_moe_comm_to_expert13 -->
<g id="node610" class="node">
<title>layer14_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6288" cy="-36522.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6288" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6288" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6288" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert13 -->
<g id="edge770" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4670.17,-36647C5135,-36647 6213.1,-36647 6213.1,-36647 6213.1,-36647 6213.1,-36550.7 6213.1,-36550.7"/>
<polygon fill="black" stroke="black" points="6216.6,-36550.7 6213.1,-36540.7 6209.6,-36550.7 6216.6,-36550.7"/>
</g>
<!-- layer14_moe_comm_to_expert14 -->
<g id="node612" class="node">
<title>layer14_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6643" cy="-36522.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6643" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6643" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6643" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert14 -->
<g id="edge772" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4685.5,-36662C5228.43,-36662 6568.1,-36662 6568.1,-36662 6568.1,-36662 6568.1,-36550.54 6568.1,-36550.54"/>
<polygon fill="black" stroke="black" points="6571.6,-36550.54 6568.1,-36540.54 6564.6,-36550.54 6571.6,-36550.54"/>
</g>
<!-- layer14_moe_comm_to_expert15 -->
<g id="node614" class="node">
<title>layer14_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6998" cy="-36522.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6998" y="-36531.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6998" y="-36520.43" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6998" y="-36509.43" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert15 -->
<g id="edge774" class="edge">
<title>layer14_moe_split&#45;&gt;layer14_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4700.15,-36677C5318.66,-36677 6923.1,-36677 6923.1,-36677 6923.1,-36677 6923.1,-36550.6 6923.1,-36550.6"/>
<polygon fill="black" stroke="black" points="6926.6,-36550.6 6923.1,-36540.6 6919.6,-36550.6 6926.6,-36550.6"/>
</g>
<!-- layer14_moe_expert0 -->
<g id="node583" class="node">
<title>layer14_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="2030,-36457.94 1702,-36457.94 1702,-36405.94 2030,-36405.94 2030,-36457.94"/>
<text text-anchor="middle" x="1866" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 0 L14</text>
<text text-anchor="middle" x="1866" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1866" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1866" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert0 -->
<g id="node616" class="node">
<title>layer14_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2025" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2025" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2025" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2025" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer14_moe_expert0&#45;&gt;layer14_moe_comm_from_expert0 -->
<g id="edge776" class="edge">
<title>layer14_moe_expert0&#45;&gt;layer14_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1982.25,-36405.62C1982.25,-36405.62 1982.25,-36376.58 1982.25,-36376.58"/>
<polygon fill="black" stroke="black" points="1985.75,-36376.58 1982.25,-36366.58 1978.75,-36376.58 1985.75,-36376.58"/>
</g>
<!-- layer14_moe_comm_to_expert0&#45;&gt;layer14_moe_expert0 -->
<g id="edge745" class="edge">
<title>layer14_moe_comm_to_expert0&#45;&gt;layer14_moe_expert0</title>
<path fill="none" stroke="black" d="M1939,-36493.89C1939,-36493.89 1939,-36468.24 1939,-36468.24"/>
<polygon fill="black" stroke="black" points="1942.5,-36468.24 1939,-36458.24 1935.5,-36468.24 1942.5,-36468.24"/>
</g>
<!-- layer14_moe_expert1 -->
<g id="node585" class="node">
<title>layer14_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2376,-36457.94 2048,-36457.94 2048,-36405.94 2376,-36405.94 2376,-36457.94"/>
<text text-anchor="middle" x="2212" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 1 L14</text>
<text text-anchor="middle" x="2212" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2212" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2212" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert1 -->
<g id="node617" class="node">
<title>layer14_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2297" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2297" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2297" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2297" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer14_moe_expert1&#45;&gt;layer14_moe_comm_from_expert1 -->
<g id="edge778" class="edge">
<title>layer14_moe_expert1&#45;&gt;layer14_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2291.25,-36405.62C2291.25,-36405.62 2291.25,-36380.07 2291.25,-36380.07"/>
<polygon fill="black" stroke="black" points="2294.75,-36380.07 2291.25,-36370.07 2287.75,-36380.07 2294.75,-36380.07"/>
</g>
<!-- layer14_moe_comm_to_expert1&#45;&gt;layer14_moe_expert1 -->
<g id="edge747" class="edge">
<title>layer14_moe_comm_to_expert1&#45;&gt;layer14_moe_expert1</title>
<path fill="none" stroke="black" d="M2285,-36493.89C2285,-36493.89 2285,-36468.24 2285,-36468.24"/>
<polygon fill="black" stroke="black" points="2288.5,-36468.24 2285,-36458.24 2281.5,-36468.24 2288.5,-36468.24"/>
</g>
<!-- layer14_moe_expert2 -->
<g id="node587" class="node">
<title>layer14_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2722,-36457.94 2394,-36457.94 2394,-36405.94 2722,-36405.94 2722,-36457.94"/>
<text text-anchor="middle" x="2558" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 2 L14</text>
<text text-anchor="middle" x="2558" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2558" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2558" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert2 -->
<g id="node618" class="node">
<title>layer14_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2618" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2618" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2618" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2618" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer14_moe_expert2&#45;&gt;layer14_moe_comm_from_expert2 -->
<g id="edge780" class="edge">
<title>layer14_moe_expert2&#45;&gt;layer14_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2618,-36405.62C2618,-36405.62 2618,-36380.07 2618,-36380.07"/>
<polygon fill="black" stroke="black" points="2621.5,-36380.07 2618,-36370.07 2614.5,-36380.07 2621.5,-36380.07"/>
</g>
<!-- layer14_moe_comm_to_expert2&#45;&gt;layer14_moe_expert2 -->
<g id="edge749" class="edge">
<title>layer14_moe_comm_to_expert2&#45;&gt;layer14_moe_expert2</title>
<path fill="none" stroke="black" d="M2640.75,-36493.89C2640.75,-36493.89 2640.75,-36468.24 2640.75,-36468.24"/>
<polygon fill="black" stroke="black" points="2644.25,-36468.24 2640.75,-36458.24 2637.25,-36468.24 2644.25,-36468.24"/>
</g>
<!-- layer14_moe_expert3 -->
<g id="node589" class="node">
<title>layer14_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3068,-36457.94 2740,-36457.94 2740,-36405.94 3068,-36405.94 3068,-36457.94"/>
<text text-anchor="middle" x="2904" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 3 L14</text>
<text text-anchor="middle" x="2904" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2904" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2904" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert3 -->
<g id="node619" class="node">
<title>layer14_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3184" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3184" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3184" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3184" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer14_moe_expert3&#45;&gt;layer14_moe_comm_from_expert3 -->
<g id="edge782" class="edge">
<title>layer14_moe_expert3&#45;&gt;layer14_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M3063.25,-36405.84C3063.25,-36378.66 3063.25,-36340 3063.25,-36340 3063.25,-36340 3083.41,-36340 3083.41,-36340"/>
<polygon fill="black" stroke="black" points="3083.41,-36343.5 3093.41,-36340 3083.41,-36336.5 3083.41,-36343.5"/>
</g>
<!-- layer14_moe_comm_to_expert3&#45;&gt;layer14_moe_expert3 -->
<g id="edge751" class="edge">
<title>layer14_moe_comm_to_expert3&#45;&gt;layer14_moe_expert3</title>
<path fill="none" stroke="black" d="M2977.75,-36493.89C2977.75,-36493.89 2977.75,-36468.24 2977.75,-36468.24"/>
<polygon fill="black" stroke="black" points="2981.25,-36468.24 2977.75,-36458.24 2974.25,-36468.24 2981.25,-36468.24"/>
</g>
<!-- layer14_moe_expert4 -->
<g id="node591" class="node">
<title>layer14_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3414,-36457.94 3086,-36457.94 3086,-36405.94 3414,-36405.94 3414,-36457.94"/>
<text text-anchor="middle" x="3250" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 4 L14</text>
<text text-anchor="middle" x="3250" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3250" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3250" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert4 -->
<g id="node620" class="node">
<title>layer14_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3567" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3567" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3567" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3567" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer14_moe_expert4&#45;&gt;layer14_moe_comm_from_expert4 -->
<g id="edge784" class="edge">
<title>layer14_moe_expert4&#45;&gt;layer14_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3405.25,-36405.84C3405.25,-36378.66 3405.25,-36340 3405.25,-36340 3405.25,-36340 3466.2,-36340 3466.2,-36340"/>
<polygon fill="black" stroke="black" points="3466.2,-36343.5 3476.2,-36340 3466.2,-36336.5 3466.2,-36343.5"/>
</g>
<!-- layer14_moe_comm_to_expert4&#45;&gt;layer14_moe_expert4 -->
<g id="edge753" class="edge">
<title>layer14_moe_comm_to_expert4&#45;&gt;layer14_moe_expert4</title>
<path fill="none" stroke="black" d="M3397.25,-36505.81C3397.25,-36505.81 3397.25,-36468.28 3397.25,-36468.28"/>
<polygon fill="black" stroke="black" points="3400.75,-36468.28 3397.25,-36458.28 3393.75,-36468.28 3400.75,-36468.28"/>
</g>
<!-- layer14_moe_expert5 -->
<g id="node593" class="node">
<title>layer14_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3760,-36457.94 3432,-36457.94 3432,-36405.94 3760,-36405.94 3760,-36457.94"/>
<text text-anchor="middle" x="3596" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 5 L14</text>
<text text-anchor="middle" x="3596" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3596" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3596" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert5 -->
<g id="node621" class="node">
<title>layer14_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3858" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3858" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3858" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3858" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer14_moe_expert5&#45;&gt;layer14_moe_comm_from_expert5 -->
<g id="edge786" class="edge">
<title>layer14_moe_expert5&#45;&gt;layer14_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3760.03,-36431C3767.99,-36431 3772.75,-36431 3772.75,-36431 3772.75,-36431 3772.75,-36360.93 3772.75,-36360.93"/>
<polygon fill="black" stroke="black" points="3776.25,-36360.93 3772.75,-36350.93 3769.25,-36360.93 3776.25,-36360.93"/>
</g>
<!-- layer14_moe_comm_to_expert5&#45;&gt;layer14_moe_expert5 -->
<g id="edge755" class="edge">
<title>layer14_moe_comm_to_expert5&#45;&gt;layer14_moe_expert5</title>
<path fill="none" stroke="black" d="M3743.25,-36505.81C3743.25,-36505.81 3743.25,-36468.28 3743.25,-36468.28"/>
<polygon fill="black" stroke="black" points="3746.75,-36468.28 3743.25,-36458.28 3739.75,-36468.28 3746.75,-36468.28"/>
</g>
<!-- layer14_moe_expert6 -->
<g id="node595" class="node">
<title>layer14_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4106,-36457.94 3778,-36457.94 3778,-36405.94 4106,-36405.94 4106,-36457.94"/>
<text text-anchor="middle" x="3942" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 6 L14</text>
<text text-anchor="middle" x="3942" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3942" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3942" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert6 -->
<g id="node622" class="node">
<title>layer14_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="4103" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4103" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="4103" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4103" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer14_moe_expert6&#45;&gt;layer14_moe_comm_from_expert6 -->
<g id="edge788" class="edge">
<title>layer14_moe_expert6&#45;&gt;layer14_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M4059.25,-36405.62C4059.25,-36405.62 4059.25,-36376.58 4059.25,-36376.58"/>
<polygon fill="black" stroke="black" points="4062.75,-36376.58 4059.25,-36366.58 4055.75,-36376.58 4062.75,-36376.58"/>
</g>
<!-- layer14_moe_comm_to_expert6&#45;&gt;layer14_moe_expert6 -->
<g id="edge757" class="edge">
<title>layer14_moe_comm_to_expert6&#45;&gt;layer14_moe_expert6</title>
<path fill="none" stroke="black" d="M4052.25,-36496.12C4052.25,-36496.12 4052.25,-36468.24 4052.25,-36468.24"/>
<polygon fill="black" stroke="black" points="4055.75,-36468.24 4052.25,-36458.24 4048.75,-36468.24 4055.75,-36468.24"/>
</g>
<!-- layer14_moe_expert7 -->
<g id="node597" class="node">
<title>layer14_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4452,-36457.94 4124,-36457.94 4124,-36405.94 4452,-36405.94 4452,-36457.94"/>
<text text-anchor="middle" x="4288" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 7 L14</text>
<text text-anchor="middle" x="4288" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4288" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4288" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert7 -->
<g id="node623" class="node">
<title>layer14_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4325" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4325" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4325" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4325" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer14_moe_expert7&#45;&gt;layer14_moe_comm_from_expert7 -->
<g id="edge790" class="edge">
<title>layer14_moe_expert7&#45;&gt;layer14_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4325,-36405.62C4325,-36405.62 4325,-36380.07 4325,-36380.07"/>
<polygon fill="black" stroke="black" points="4328.5,-36380.07 4325,-36370.07 4321.5,-36380.07 4328.5,-36380.07"/>
</g>
<!-- layer14_moe_comm_to_expert7&#45;&gt;layer14_moe_expert7 -->
<g id="edge759" class="edge">
<title>layer14_moe_comm_to_expert7&#45;&gt;layer14_moe_expert7</title>
<path fill="none" stroke="black" d="M4325,-36493.89C4325,-36493.89 4325,-36468.24 4325,-36468.24"/>
<polygon fill="black" stroke="black" points="4328.5,-36468.24 4325,-36458.24 4321.5,-36468.24 4328.5,-36468.24"/>
</g>
<!-- layer14_moe_expert8 -->
<g id="node599" class="node">
<title>layer14_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4798,-36457.94 4470,-36457.94 4470,-36405.94 4798,-36405.94 4798,-36457.94"/>
<text text-anchor="middle" x="4634" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 8 L14</text>
<text text-anchor="middle" x="4634" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4634" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4634" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert8 -->
<g id="node624" class="node">
<title>layer14_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4597" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4597" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4597" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4597" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer14_moe_expert8&#45;&gt;layer14_moe_comm_from_expert8 -->
<g id="edge792" class="edge">
<title>layer14_moe_expert8&#45;&gt;layer14_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4597,-36405.62C4597,-36405.62 4597,-36380.07 4597,-36380.07"/>
<polygon fill="black" stroke="black" points="4600.5,-36380.07 4597,-36370.07 4593.5,-36380.07 4600.5,-36380.07"/>
</g>
<!-- layer14_moe_comm_to_expert8&#45;&gt;layer14_moe_expert8 -->
<g id="edge761" class="edge">
<title>layer14_moe_comm_to_expert8&#45;&gt;layer14_moe_expert8</title>
<path fill="none" stroke="black" d="M4597,-36493.89C4597,-36493.89 4597,-36468.24 4597,-36468.24"/>
<polygon fill="black" stroke="black" points="4600.5,-36468.24 4597,-36458.24 4593.5,-36468.24 4600.5,-36468.24"/>
</g>
<!-- layer14_moe_expert9 -->
<g id="node601" class="node">
<title>layer14_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5144,-36457.94 4816,-36457.94 4816,-36405.94 5144,-36405.94 5144,-36457.94"/>
<text text-anchor="middle" x="4980" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 9 L14</text>
<text text-anchor="middle" x="4980" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4980" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4980" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert9 -->
<g id="node625" class="node">
<title>layer14_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4906" cy="-36340.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4906" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4906" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4906" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer14_moe_expert9&#45;&gt;layer14_moe_comm_from_expert9 -->
<g id="edge794" class="edge">
<title>layer14_moe_expert9&#45;&gt;layer14_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4906.25,-36405.62C4906.25,-36405.62 4906.25,-36380.07 4906.25,-36380.07"/>
<polygon fill="black" stroke="black" points="4909.75,-36380.07 4906.25,-36370.07 4902.75,-36380.07 4909.75,-36380.07"/>
</g>
<!-- layer14_moe_comm_to_expert9&#45;&gt;layer14_moe_expert9 -->
<g id="edge763" class="edge">
<title>layer14_moe_comm_to_expert9&#45;&gt;layer14_moe_expert9</title>
<path fill="none" stroke="black" d="M4906.25,-36493.89C4906.25,-36493.89 4906.25,-36468.24 4906.25,-36468.24"/>
<polygon fill="black" stroke="black" points="4909.75,-36468.24 4906.25,-36458.24 4902.75,-36468.24 4909.75,-36468.24"/>
</g>
<!-- layer14_moe_expert10 -->
<g id="node603" class="node">
<title>layer14_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5500,-36457.94 5162,-36457.94 5162,-36405.94 5500,-36405.94 5500,-36457.94"/>
<text text-anchor="middle" x="5331" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 10 L14</text>
<text text-anchor="middle" x="5331" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5331" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5331" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert10 -->
<g id="node626" class="node">
<title>layer14_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5238" cy="-36340.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5238" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5238" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5238" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer14_moe_expert10&#45;&gt;layer14_moe_comm_from_expert10 -->
<g id="edge796" class="edge">
<title>layer14_moe_expert10&#45;&gt;layer14_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5247.38,-36405.62C5247.38,-36405.62 5247.38,-36380.07 5247.38,-36380.07"/>
<polygon fill="black" stroke="black" points="5250.88,-36380.07 5247.38,-36370.07 5243.88,-36380.07 5250.88,-36380.07"/>
</g>
<!-- layer14_moe_comm_to_expert10&#45;&gt;layer14_moe_expert10 -->
<g id="edge765" class="edge">
<title>layer14_moe_comm_to_expert10&#45;&gt;layer14_moe_expert10</title>
<path fill="none" stroke="black" d="M5247.02,-36493.89C5247.02,-36493.89 5247.02,-36468.24 5247.02,-36468.24"/>
<polygon fill="black" stroke="black" points="5250.52,-36468.24 5247.02,-36458.24 5243.52,-36468.24 5250.52,-36468.24"/>
</g>
<!-- layer14_moe_expert11 -->
<g id="node605" class="node">
<title>layer14_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5856,-36457.94 5518,-36457.94 5518,-36405.94 5856,-36405.94 5856,-36457.94"/>
<text text-anchor="middle" x="5687" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 11 L14</text>
<text text-anchor="middle" x="5687" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5687" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5687" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert11 -->
<g id="node627" class="node">
<title>layer14_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5585" cy="-36340.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5585" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5585" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5585" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer14_moe_expert11&#45;&gt;layer14_moe_comm_from_expert11 -->
<g id="edge798" class="edge">
<title>layer14_moe_expert11&#45;&gt;layer14_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5598.88,-36405.62C5598.88,-36405.62 5598.88,-36379.75 5598.88,-36379.75"/>
<polygon fill="black" stroke="black" points="5602.38,-36379.75 5598.88,-36369.75 5595.38,-36379.75 5602.38,-36379.75"/>
</g>
<!-- layer14_moe_comm_to_expert11&#45;&gt;layer14_moe_expert11 -->
<g id="edge767" class="edge">
<title>layer14_moe_comm_to_expert11&#45;&gt;layer14_moe_expert11</title>
<path fill="none" stroke="black" d="M5598.02,-36494.14C5598.02,-36494.14 5598.02,-36468.07 5598.02,-36468.07"/>
<polygon fill="black" stroke="black" points="5601.52,-36468.07 5598.02,-36458.07 5594.52,-36468.07 5601.52,-36468.07"/>
</g>
<!-- layer14_moe_expert12 -->
<g id="node607" class="node">
<title>layer14_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6212,-36457.94 5874,-36457.94 5874,-36405.94 6212,-36405.94 6212,-36457.94"/>
<text text-anchor="middle" x="6043" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 12 L14</text>
<text text-anchor="middle" x="6043" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6043" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6043" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert12 -->
<g id="node628" class="node">
<title>layer14_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5936" cy="-36340.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5936" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5936" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5936" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer14_moe_expert12&#45;&gt;layer14_moe_comm_from_expert12 -->
<g id="edge800" class="edge">
<title>layer14_moe_expert12&#45;&gt;layer14_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5952.38,-36405.62C5952.38,-36405.62 5952.38,-36379.75 5952.38,-36379.75"/>
<polygon fill="black" stroke="black" points="5955.88,-36379.75 5952.38,-36369.75 5948.88,-36379.75 5955.88,-36379.75"/>
</g>
<!-- layer14_moe_comm_to_expert12&#45;&gt;layer14_moe_expert12 -->
<g id="edge769" class="edge">
<title>layer14_moe_comm_to_expert12&#45;&gt;layer14_moe_expert12</title>
<path fill="none" stroke="black" d="M5951.52,-36494.14C5951.52,-36494.14 5951.52,-36468.07 5951.52,-36468.07"/>
<polygon fill="black" stroke="black" points="5955.02,-36468.07 5951.52,-36458.07 5948.02,-36468.07 5955.02,-36468.07"/>
</g>
<!-- layer14_moe_expert13 -->
<g id="node609" class="node">
<title>layer14_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6568,-36457.94 6230,-36457.94 6230,-36405.94 6568,-36405.94 6568,-36457.94"/>
<text text-anchor="middle" x="6399" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 13 L14</text>
<text text-anchor="middle" x="6399" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6399" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6399" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert13 -->
<g id="node629" class="node">
<title>layer14_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6290" cy="-36340.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6290" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6290" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6290" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer14_moe_expert13&#45;&gt;layer14_moe_comm_from_expert13 -->
<g id="edge802" class="edge">
<title>layer14_moe_expert13&#45;&gt;layer14_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6307.38,-36405.62C6307.38,-36405.62 6307.38,-36379.75 6307.38,-36379.75"/>
<polygon fill="black" stroke="black" points="6310.88,-36379.75 6307.38,-36369.75 6303.88,-36379.75 6310.88,-36379.75"/>
</g>
<!-- layer14_moe_comm_to_expert13&#45;&gt;layer14_moe_expert13 -->
<g id="edge771" class="edge">
<title>layer14_moe_comm_to_expert13&#45;&gt;layer14_moe_expert13</title>
<path fill="none" stroke="black" d="M6306.02,-36494.14C6306.02,-36494.14 6306.02,-36468.07 6306.02,-36468.07"/>
<polygon fill="black" stroke="black" points="6309.52,-36468.07 6306.02,-36458.07 6302.52,-36468.07 6309.52,-36468.07"/>
</g>
<!-- layer14_moe_expert14 -->
<g id="node611" class="node">
<title>layer14_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6924,-36457.94 6586,-36457.94 6586,-36405.94 6924,-36405.94 6924,-36457.94"/>
<text text-anchor="middle" x="6755" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 14 L14</text>
<text text-anchor="middle" x="6755" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6755" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6755" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert14 -->
<g id="node630" class="node">
<title>layer14_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6645" cy="-36340.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6645" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6645" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6645" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer14_moe_expert14&#45;&gt;layer14_moe_comm_from_expert14 -->
<g id="edge804" class="edge">
<title>layer14_moe_expert14&#45;&gt;layer14_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6662.88,-36405.62C6662.88,-36405.62 6662.88,-36379.43 6662.88,-36379.43"/>
<polygon fill="black" stroke="black" points="6666.38,-36379.43 6662.88,-36369.43 6659.38,-36379.43 6666.38,-36379.43"/>
</g>
<!-- layer14_moe_comm_to_expert14&#45;&gt;layer14_moe_expert14 -->
<g id="edge773" class="edge">
<title>layer14_moe_comm_to_expert14&#45;&gt;layer14_moe_expert14</title>
<path fill="none" stroke="black" d="M6661.52,-36494.14C6661.52,-36494.14 6661.52,-36468.07 6661.52,-36468.07"/>
<polygon fill="black" stroke="black" points="6665.02,-36468.07 6661.52,-36458.07 6658.02,-36468.07 6665.02,-36468.07"/>
</g>
<!-- layer14_moe_expert15 -->
<g id="node613" class="node">
<title>layer14_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7280,-36457.94 6942,-36457.94 6942,-36405.94 7280,-36405.94 7280,-36457.94"/>
<text text-anchor="middle" x="7111" y="-36445.94" font-family="Arial" font-size="10.00">EXPERT 15 L14</text>
<text text-anchor="middle" x="7111" y="-36434.94" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7111" y="-36423.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7111" y="-36412.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_comm_from_expert15 -->
<g id="node631" class="node">
<title>layer14_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="7000" cy="-36340.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="7000" y="-36349.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="7000" y="-36338.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="7000" y="-36327.44" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer14_moe_expert15&#45;&gt;layer14_moe_comm_from_expert15 -->
<g id="edge806" class="edge">
<title>layer14_moe_expert15&#45;&gt;layer14_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M7018.38,-36405.62C7018.38,-36405.62 7018.38,-36379.43 7018.38,-36379.43"/>
<polygon fill="black" stroke="black" points="7021.88,-36379.43 7018.38,-36369.43 7014.88,-36379.43 7021.88,-36379.43"/>
</g>
<!-- layer14_moe_comm_to_expert15&#45;&gt;layer14_moe_expert15 -->
<g id="edge775" class="edge">
<title>layer14_moe_comm_to_expert15&#45;&gt;layer14_moe_expert15</title>
<path fill="none" stroke="black" d="M7017.02,-36494.14C7017.02,-36494.14 7017.02,-36468.07 7017.02,-36468.07"/>
<polygon fill="black" stroke="black" points="7020.52,-36468.07 7017.02,-36458.07 7013.52,-36468.07 7020.52,-36468.07"/>
</g>
<!-- layer14_moe_aggregate -->
<g id="node615" class="node">
<title>layer14_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4686.1,-36275.95 4269.16,-36275.95 4161.9,-36171.95 4578.84,-36171.95 4686.1,-36275.95"/>
<text text-anchor="middle" x="4424" y="-36237.95" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L14</text>
<text text-anchor="middle" x="4424" y="-36226.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4424" y="-36215.95" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4424" y="-36204.95" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_mha -->
<g id="node632" class="node">
<title>layer15_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4554,-36135.95 4294,-36135.95 4294,-36083.95 4554,-36083.95 4554,-36135.95"/>
<text text-anchor="middle" x="4424" y="-36123.95" font-family="Arial" font-size="10.00">MHA L15</text>
<text text-anchor="middle" x="4424" y="-36112.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4424" y="-36101.95" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4424" y="-36090.95" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer14_moe_aggregate&#45;&gt;layer15_moe_mha -->
<g id="edge875" class="edge">
<title>layer14_moe_aggregate&#45;&gt;layer15_moe_mha</title>
<path fill="none" stroke="black" d="M4424,-36171.62C4424,-36171.62 4424,-36146.18 4424,-36146.18"/>
<polygon fill="black" stroke="black" points="4427.5,-36146.18 4424,-36136.18 4420.5,-36146.18 4427.5,-36146.18"/>
</g>
<!-- layer14_moe_comm_from_expert0&#45;&gt;layer14_moe_aggregate -->
<g id="edge777" class="edge">
<title>layer14_moe_comm_from_expert0&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M2096.01,-36322.87C2096.01,-36281.99 2096.01,-36186 2096.01,-36186 2096.01,-36186 4166.24,-36186 4166.24,-36186"/>
<polygon fill="black" stroke="black" points="4166.24,-36189.5 4176.24,-36186 4166.24,-36182.5 4166.24,-36189.5"/>
</g>
<!-- layer14_moe_comm_from_expert1&#45;&gt;layer14_moe_aggregate -->
<g id="edge779" class="edge">
<title>layer14_moe_comm_from_expert1&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M2351,-36317.52C2351,-36277.68 2351,-36201 2351,-36201 2351,-36201 4181.73,-36201 4181.73,-36201"/>
<polygon fill="black" stroke="black" points="4181.73,-36204.5 4191.73,-36201 4181.73,-36197.5 4181.73,-36204.5"/>
</g>
<!-- layer14_moe_comm_from_expert2&#45;&gt;layer14_moe_aggregate -->
<g id="edge781" class="edge">
<title>layer14_moe_comm_from_expert2&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M2666,-36316.26C2666,-36279.85 2666,-36216 2666,-36216 2666,-36216 4197.11,-36216 4197.11,-36216"/>
<polygon fill="black" stroke="black" points="4197.11,-36219.5 4207.11,-36216 4197.11,-36212.5 4197.11,-36219.5"/>
</g>
<!-- layer14_moe_comm_from_expert3&#45;&gt;layer14_moe_aggregate -->
<g id="edge783" class="edge">
<title>layer14_moe_comm_from_expert3&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M3245,-36319.48C3245,-36287.49 3245,-36231 3245,-36231 3245,-36231 4212.66,-36231 4212.66,-36231"/>
<polygon fill="black" stroke="black" points="4212.66,-36234.5 4222.66,-36231 4212.66,-36227.5 4212.66,-36234.5"/>
</g>
<!-- layer14_moe_comm_from_expert4&#45;&gt;layer14_moe_aggregate -->
<g id="edge785" class="edge">
<title>layer14_moe_comm_from_expert4&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M3646,-36326.52C3646,-36299.96 3646,-36246 3646,-36246 3646,-36246 4228.14,-36246 4228.14,-36246"/>
<polygon fill="black" stroke="black" points="4228.14,-36249.5 4238.14,-36246 4228.14,-36242.5 4228.14,-36249.5"/>
</g>
<!-- layer14_moe_comm_from_expert5&#45;&gt;layer14_moe_aggregate -->
<g id="edge787" class="edge">
<title>layer14_moe_comm_from_expert5&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M3879.5,-36312.53C3879.5,-36289.56 3879.5,-36261 3879.5,-36261 3879.5,-36261 4243.58,-36261 4243.58,-36261"/>
<polygon fill="black" stroke="black" points="4243.58,-36264.5 4253.58,-36261 4243.58,-36257.5 4243.58,-36264.5"/>
</g>
<!-- layer14_moe_comm_from_expert6&#45;&gt;layer14_moe_aggregate -->
<g id="edge789" class="edge">
<title>layer14_moe_comm_from_expert6&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M4177.61,-36324.43C4177.61,-36324.43 4177.61,-36234 4177.61,-36234"/>
<polygon fill="black" stroke="black" points="4181.11,-36234 4177.61,-36224 4174.11,-36234 4181.11,-36234"/>
</g>
<!-- layer14_moe_comm_from_expert7&#45;&gt;layer14_moe_aggregate -->
<g id="edge791" class="edge">
<title>layer14_moe_comm_from_expert7&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M4325,-36311.72C4325,-36311.72 4325,-36286.01 4325,-36286.01"/>
<polygon fill="black" stroke="black" points="4328.5,-36286.01 4325,-36276.01 4321.5,-36286.01 4328.5,-36286.01"/>
</g>
<!-- layer14_moe_comm_from_expert8&#45;&gt;layer14_moe_aggregate -->
<g id="edge793" class="edge">
<title>layer14_moe_comm_from_expert8&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M4596.39,-36311.72C4596.39,-36311.72 4596.39,-36286.01 4596.39,-36286.01"/>
<polygon fill="black" stroke="black" points="4599.89,-36286.01 4596.39,-36276.01 4592.89,-36286.01 4599.89,-36286.01"/>
</g>
<!-- layer14_moe_comm_from_expert9&#45;&gt;layer14_moe_aggregate -->
<g id="edge795" class="edge">
<title>layer14_moe_comm_from_expert9&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M4887.5,-36312.44C4887.5,-36289.83 4887.5,-36262 4887.5,-36262 4887.5,-36262 4682.03,-36262 4682.03,-36262"/>
<polygon fill="black" stroke="black" points="4682.03,-36258.5 4672.03,-36262 4682.03,-36265.5 4682.03,-36258.5"/>
</g>
<!-- layer14_moe_comm_from_expert10&#45;&gt;layer14_moe_aggregate -->
<g id="edge797" class="edge">
<title>layer14_moe_comm_from_expert10&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M5219.15,-36312.36C5219.15,-36285.37 5219.15,-36249 5219.15,-36249 5219.15,-36249 4668.54,-36249 4668.54,-36249"/>
<polygon fill="black" stroke="black" points="4668.54,-36245.5 4658.54,-36249 4668.54,-36252.5 4668.54,-36245.5"/>
</g>
<!-- layer14_moe_comm_from_expert11&#45;&gt;layer14_moe_aggregate -->
<g id="edge799" class="edge">
<title>layer14_moe_comm_from_expert11&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M5565.65,-36312.54C5565.65,-36281.47 5565.65,-36236 5565.65,-36236 5565.65,-36236 4655.14,-36236 4655.14,-36236"/>
<polygon fill="black" stroke="black" points="4655.14,-36232.5 4645.14,-36236 4655.14,-36239.5 4655.14,-36232.5"/>
</g>
<!-- layer14_moe_comm_from_expert12&#45;&gt;layer14_moe_aggregate -->
<g id="edge801" class="edge">
<title>layer14_moe_comm_from_expert12&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M5916.65,-36312.39C5916.65,-36277.49 5916.65,-36223 5916.65,-36223 5916.65,-36223 4641.55,-36223 4641.55,-36223"/>
<polygon fill="black" stroke="black" points="4641.55,-36219.5 4631.55,-36223 4641.55,-36226.5 4641.55,-36219.5"/>
</g>
<!-- layer14_moe_comm_from_expert13&#45;&gt;layer14_moe_aggregate -->
<g id="edge803" class="edge">
<title>layer14_moe_comm_from_expert13&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M6270.15,-36312.53C6270.15,-36274.02 6270.15,-36210 6270.15,-36210 6270.15,-36210 4628.08,-36210 4628.08,-36210"/>
<polygon fill="black" stroke="black" points="4628.08,-36206.5 4618.08,-36210 4628.08,-36213.5 4628.08,-36206.5"/>
</g>
<!-- layer14_moe_comm_from_expert14&#45;&gt;layer14_moe_aggregate -->
<g id="edge805" class="edge">
<title>layer14_moe_comm_from_expert14&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M6625.15,-36312.51C6625.15,-36270.56 6625.15,-36197 6625.15,-36197 6625.15,-36197 4615.06,-36197 4615.06,-36197"/>
<polygon fill="black" stroke="black" points="4615.06,-36193.5 4605.06,-36197 4615.06,-36200.5 4615.06,-36193.5"/>
</g>
<!-- layer14_moe_comm_from_expert15&#45;&gt;layer14_moe_aggregate -->
<g id="edge807" class="edge">
<title>layer14_moe_comm_from_expert15&#45;&gt;layer14_moe_aggregate</title>
<path fill="none" stroke="black" d="M6980.15,-36312.52C6980.15,-36267.3 6980.15,-36184 6980.15,-36184 6980.15,-36184 4601.72,-36184 4601.72,-36184"/>
<polygon fill="black" stroke="black" points="4601.72,-36180.5 4591.72,-36184 4601.72,-36187.5 4601.72,-36180.5"/>
</g>
<!-- layer15_moe_gate -->
<g id="node633" class="node">
<title>layer15_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4682.3,-36047.95 4271.4,-36047.95 4165.7,-35943.95 4576.6,-35943.95 4682.3,-36047.95"/>
<text text-anchor="middle" x="4424" y="-36009.95" font-family="Arial" font-size="10.00">GATE L15</text>
<text text-anchor="middle" x="4424" y="-35998.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4424" y="-35987.95" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4424" y="-35976.95" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer15_moe_mha&#45;&gt;layer15_moe_gate -->
<g id="edge876" class="edge">
<title>layer15_moe_mha&#45;&gt;layer15_moe_gate</title>
<path fill="none" stroke="black" d="M4424,-36083.8C4424,-36083.8 4424,-36058.05 4424,-36058.05"/>
<polygon fill="black" stroke="black" points="4427.5,-36058.05 4424,-36048.05 4420.5,-36058.05 4427.5,-36058.05"/>
</g>
<!-- layer15_moe_split -->
<g id="node634" class="node">
<title>layer15_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4678.01,-35907.95 4273.94,-35907.95 4169.99,-35803.95 4574.06,-35803.95 4678.01,-35907.95"/>
<text text-anchor="middle" x="4424" y="-35869.95" font-family="Arial" font-size="10.00">SPLIT TOKENS L15</text>
<text text-anchor="middle" x="4424" y="-35858.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4424" y="-35847.95" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4424" y="-35836.95" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer15_moe_gate&#45;&gt;layer15_moe_split -->
<g id="edge877" class="edge">
<title>layer15_moe_gate&#45;&gt;layer15_moe_split</title>
<path fill="none" stroke="black" d="M4424,-35943.82C4424,-35943.82 4424,-35918.13 4424,-35918.13"/>
<polygon fill="black" stroke="black" points="4427.5,-35918.13 4424,-35908.13 4420.5,-35918.13 4427.5,-35918.13"/>
</g>
<!-- layer15_moe_comm_to_expert0 -->
<g id="node636" class="node">
<title>layer15_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1986" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1986" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1986" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1986" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert0 -->
<g id="edge811" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4258.72,-35893C3713.34,-35893 2005.5,-35893 2005.5,-35893 2005.5,-35893 2005.5,-35777.57 2005.5,-35777.57"/>
<polygon fill="black" stroke="black" points="2009,-35777.57 2005.5,-35767.57 2002,-35777.57 2009,-35777.57"/>
</g>
<!-- layer15_moe_comm_to_expert1 -->
<g id="node638" class="node">
<title>layer15_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2405" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2405" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2405" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2405" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert1 -->
<g id="edge813" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4243.99,-35878C3756.08,-35878 2444.75,-35878 2444.75,-35878 2444.75,-35878 2444.75,-35775.11 2444.75,-35775.11"/>
<polygon fill="black" stroke="black" points="2448.25,-35775.11 2444.75,-35765.11 2441.25,-35775.11 2448.25,-35775.11"/>
</g>
<!-- layer15_moe_comm_to_expert2 -->
<g id="node640" class="node">
<title>layer15_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2714" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2714" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2714" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2714" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert2 -->
<g id="edge815" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4228.85,-35863C3791.77,-35863 2772.25,-35863 2772.25,-35863 2772.25,-35863 2772.25,-35771.42 2772.25,-35771.42"/>
<polygon fill="black" stroke="black" points="2775.75,-35771.42 2772.25,-35761.42 2768.75,-35771.42 2775.75,-35771.42"/>
</g>
<!-- layer15_moe_comm_to_expert3 -->
<g id="node642" class="node">
<title>layer15_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2968" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2968" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2968" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2968" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert3 -->
<g id="edge817" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4213.84,-35848C3810.63,-35848 2968,-35848 2968,-35848 2968,-35848 2968,-35778.18 2968,-35778.18"/>
<polygon fill="black" stroke="black" points="2971.5,-35778.18 2968,-35768.18 2964.5,-35778.18 2971.5,-35778.18"/>
</g>
<!-- layer15_moe_comm_to_expert4 -->
<g id="node644" class="node">
<title>layer15_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3306" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3306" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3306" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3306" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert4 -->
<g id="edge819" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4198.79,-35833C3880.01,-35833 3335.51,-35833 3335.51,-35833 3335.51,-35833 3335.51,-35776.41 3335.51,-35776.41"/>
<polygon fill="black" stroke="black" points="3339.01,-35776.41 3335.51,-35766.41 3332.01,-35776.41 3339.01,-35776.41"/>
</g>
<!-- layer15_moe_comm_to_expert5 -->
<g id="node646" class="node">
<title>layer15_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3725" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3725" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3725" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3725" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert5 -->
<g id="edge821" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4183.98,-35818C4005.05,-35818 3791.5,-35818 3791.5,-35818 3791.5,-35818 3791.5,-35768.91 3791.5,-35768.91"/>
<polygon fill="black" stroke="black" points="3795,-35768.91 3791.5,-35758.91 3788,-35768.91 3795,-35768.91"/>
</g>
<!-- layer15_moe_comm_to_expert6 -->
<g id="node648" class="node">
<title>layer15_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4034" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4034" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4034" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4034" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert6 -->
<g id="edge823" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4183.74,-35855.87C4183.74,-35852.3 4183.74,-35738 4183.74,-35738 4183.74,-35738 4134.56,-35738 4134.56,-35738"/>
<polygon fill="black" stroke="black" points="4134.56,-35734.5 4124.56,-35738 4134.56,-35741.5 4134.56,-35734.5"/>
</g>
<!-- layer15_moe_comm_to_expert7 -->
<g id="node650" class="node">
<title>layer15_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4288" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4288" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4288" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4288" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert7 -->
<g id="edge825" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4288,-35803.62C4288,-35803.62 4288,-35778.17 4288,-35778.17"/>
<polygon fill="black" stroke="black" points="4291.5,-35778.17 4288,-35768.17 4284.5,-35778.17 4291.5,-35778.17"/>
</g>
<!-- layer15_moe_comm_to_expert8 -->
<g id="node652" class="node">
<title>layer15_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4560" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4560" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4560" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4560" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert8 -->
<g id="edge827" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4560,-35803.62C4560,-35803.62 4560,-35778.17 4560,-35778.17"/>
<polygon fill="black" stroke="black" points="4563.5,-35778.17 4560,-35768.17 4556.5,-35778.17 4563.5,-35778.17"/>
</g>
<!-- layer15_moe_comm_to_expert9 -->
<g id="node654" class="node">
<title>layer15_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4869" cy="-35738.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4869" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4869" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4869" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert9 -->
<g id="edge829" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4664.26,-35855.87C4664.26,-35852.3 4664.26,-35738 4664.26,-35738 4664.26,-35738 4768.3,-35738 4768.3,-35738"/>
<polygon fill="black" stroke="black" points="4768.3,-35741.5 4778.3,-35738 4768.3,-35734.5 4768.3,-35741.5"/>
</g>
<!-- layer15_moe_comm_to_expert10 -->
<g id="node656" class="node">
<title>layer15_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5201" cy="-35738.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5201" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5201" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5201" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert10 -->
<g id="edge831" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4588.38,-35818C4795.6,-35818 5125.1,-35818 5125.1,-35818 5125.1,-35818 5125.1,-35766.11 5125.1,-35766.11"/>
<polygon fill="black" stroke="black" points="5128.6,-35766.11 5125.1,-35756.11 5121.6,-35766.11 5128.6,-35766.11"/>
</g>
<!-- layer15_moe_comm_to_expert11 -->
<g id="node658" class="node">
<title>layer15_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5547" cy="-35738.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5547" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5547" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5547" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert11 -->
<g id="edge833" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4603.2,-35833C4902.48,-35833 5471.6,-35833 5471.6,-35833 5471.6,-35833 5471.6,-35766.65 5471.6,-35766.65"/>
<polygon fill="black" stroke="black" points="5475.1,-35766.65 5471.6,-35756.65 5468.1,-35766.65 5475.1,-35766.65"/>
</g>
<!-- layer15_moe_comm_to_expert12 -->
<g id="node660" class="node">
<title>layer15_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5898" cy="-35738.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5898" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5898" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5898" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert12 -->
<g id="edge835" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4618.1,-35848C5002.24,-35848 5822.6,-35848 5822.6,-35848 5822.6,-35848 5822.6,-35766.48 5822.6,-35766.48"/>
<polygon fill="black" stroke="black" points="5826.1,-35766.48 5822.6,-35756.48 5819.1,-35766.48 5826.1,-35766.48"/>
</g>
<!-- layer15_moe_comm_to_expert13 -->
<g id="node662" class="node">
<title>layer15_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6251" cy="-35738.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6251" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6251" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6251" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert13 -->
<g id="edge837" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4633.17,-35863C5098,-35863 6176.1,-35863 6176.1,-35863 6176.1,-35863 6176.1,-35766.73 6176.1,-35766.73"/>
<polygon fill="black" stroke="black" points="6179.6,-35766.73 6176.1,-35756.73 6172.6,-35766.73 6179.6,-35766.73"/>
</g>
<!-- layer15_moe_comm_to_expert14 -->
<g id="node664" class="node">
<title>layer15_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6606" cy="-35738.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6606" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6606" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6606" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert14 -->
<g id="edge839" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4648.5,-35878C5191.43,-35878 6531.1,-35878 6531.1,-35878 6531.1,-35878 6531.1,-35766.57 6531.1,-35766.57"/>
<polygon fill="black" stroke="black" points="6534.6,-35766.57 6531.1,-35756.57 6527.6,-35766.57 6534.6,-35766.57"/>
</g>
<!-- layer15_moe_comm_to_expert15 -->
<g id="node666" class="node">
<title>layer15_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6961" cy="-35738.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6961" y="-35747.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6961" y="-35736.46" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6961" y="-35725.46" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert15 -->
<g id="edge841" class="edge">
<title>layer15_moe_split&#45;&gt;layer15_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4663.15,-35893C5281.66,-35893 6886.1,-35893 6886.1,-35893 6886.1,-35893 6886.1,-35766.63 6886.1,-35766.63"/>
<polygon fill="black" stroke="black" points="6889.6,-35766.63 6886.1,-35756.63 6882.6,-35766.63 6889.6,-35766.63"/>
</g>
<!-- layer15_moe_expert0 -->
<g id="node635" class="node">
<title>layer15_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1993,-35673.97 1665,-35673.97 1665,-35621.97 1993,-35621.97 1993,-35673.97"/>
<text text-anchor="middle" x="1829" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 0 L15</text>
<text text-anchor="middle" x="1829" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1829" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1829" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert0 -->
<g id="node668" class="node">
<title>layer15_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1995" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1995" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1995" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1995" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer15_moe_expert0&#45;&gt;layer15_moe_comm_from_expert0 -->
<g id="edge843" class="edge">
<title>layer15_moe_expert0&#45;&gt;layer15_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1948.75,-35621.65C1948.75,-35621.65 1948.75,-35591.99 1948.75,-35591.99"/>
<polygon fill="black" stroke="black" points="1952.25,-35591.99 1948.75,-35581.99 1945.25,-35591.99 1952.25,-35591.99"/>
</g>
<!-- layer15_moe_comm_to_expert0&#45;&gt;layer15_moe_expert0 -->
<g id="edge812" class="edge">
<title>layer15_moe_comm_to_expert0&#45;&gt;layer15_moe_expert0</title>
<path fill="none" stroke="black" d="M1944.25,-35713.13C1944.25,-35713.13 1944.25,-35684.18 1944.25,-35684.18"/>
<polygon fill="black" stroke="black" points="1947.75,-35684.18 1944.25,-35674.18 1940.75,-35684.18 1947.75,-35684.18"/>
</g>
<!-- layer15_moe_expert1 -->
<g id="node637" class="node">
<title>layer15_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2339,-35673.97 2011,-35673.97 2011,-35621.97 2339,-35621.97 2339,-35673.97"/>
<text text-anchor="middle" x="2175" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 1 L15</text>
<text text-anchor="middle" x="2175" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2175" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2175" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert1 -->
<g id="node669" class="node">
<title>layer15_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2414" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2414" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2414" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2414" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer15_moe_expert1&#45;&gt;layer15_moe_comm_from_expert1 -->
<g id="edge845" class="edge">
<title>layer15_moe_expert1&#45;&gt;layer15_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2331.25,-35621.65C2331.25,-35621.65 2331.25,-35578.88 2331.25,-35578.88"/>
<polygon fill="black" stroke="black" points="2334.75,-35578.88 2331.25,-35568.88 2327.75,-35578.88 2334.75,-35578.88"/>
</g>
<!-- layer15_moe_comm_to_expert1&#45;&gt;layer15_moe_expert1 -->
<g id="edge814" class="edge">
<title>layer15_moe_comm_to_expert1&#45;&gt;layer15_moe_expert1</title>
<path fill="none" stroke="black" d="M2326.75,-35724.34C2326.75,-35724.34 2326.75,-35684.3 2326.75,-35684.3"/>
<polygon fill="black" stroke="black" points="2330.25,-35684.3 2326.75,-35674.3 2323.25,-35684.3 2330.25,-35684.3"/>
</g>
<!-- layer15_moe_expert2 -->
<g id="node639" class="node">
<title>layer15_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2685,-35673.97 2357,-35673.97 2357,-35621.97 2685,-35621.97 2685,-35673.97"/>
<text text-anchor="middle" x="2521" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 2 L15</text>
<text text-anchor="middle" x="2521" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2521" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2521" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert2 -->
<g id="node670" class="node">
<title>layer15_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2723" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2723" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2723" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2723" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer15_moe_expert2&#45;&gt;layer15_moe_comm_from_expert2 -->
<g id="edge847" class="edge">
<title>layer15_moe_expert2&#45;&gt;layer15_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2658.75,-35621.65C2658.75,-35621.65 2658.75,-35587.46 2658.75,-35587.46"/>
<polygon fill="black" stroke="black" points="2662.25,-35587.46 2658.75,-35577.46 2655.25,-35587.46 2662.25,-35587.46"/>
</g>
<!-- layer15_moe_comm_to_expert2&#45;&gt;layer15_moe_expert2 -->
<g id="edge816" class="edge">
<title>layer15_moe_comm_to_expert2&#45;&gt;layer15_moe_expert2</title>
<path fill="none" stroke="black" d="M2654.25,-35716.93C2654.25,-35716.93 2654.25,-35683.99 2654.25,-35683.99"/>
<polygon fill="black" stroke="black" points="2657.75,-35683.99 2654.25,-35673.99 2650.75,-35683.99 2657.75,-35683.99"/>
</g>
<!-- layer15_moe_expert3 -->
<g id="node641" class="node">
<title>layer15_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="3031,-35673.97 2703,-35673.97 2703,-35621.97 3031,-35621.97 3031,-35673.97"/>
<text text-anchor="middle" x="2867" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 3 L15</text>
<text text-anchor="middle" x="2867" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2867" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2867" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert3 -->
<g id="node671" class="node">
<title>layer15_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2977" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2977" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2977" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2977" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer15_moe_expert3&#45;&gt;layer15_moe_comm_from_expert3 -->
<g id="edge849" class="edge">
<title>layer15_moe_expert3&#45;&gt;layer15_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2958.75,-35621.65C2958.75,-35621.65 2958.75,-35595.46 2958.75,-35595.46"/>
<polygon fill="black" stroke="black" points="2962.25,-35595.46 2958.75,-35585.46 2955.25,-35595.46 2962.25,-35595.46"/>
</g>
<!-- layer15_moe_comm_to_expert3&#45;&gt;layer15_moe_expert3 -->
<g id="edge818" class="edge">
<title>layer15_moe_comm_to_expert3&#45;&gt;layer15_moe_expert3</title>
<path fill="none" stroke="black" d="M2954.25,-35710.17C2954.25,-35710.17 2954.25,-35684.11 2954.25,-35684.11"/>
<polygon fill="black" stroke="black" points="2957.75,-35684.11 2954.25,-35674.11 2950.75,-35684.11 2957.75,-35684.11"/>
</g>
<!-- layer15_moe_expert4 -->
<g id="node643" class="node">
<title>layer15_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3377,-35673.97 3049,-35673.97 3049,-35621.97 3377,-35621.97 3377,-35673.97"/>
<text text-anchor="middle" x="3213" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 4 L15</text>
<text text-anchor="middle" x="3213" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3213" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3213" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert4 -->
<g id="node672" class="node">
<title>layer15_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3360" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3360" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3360" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3360" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer15_moe_expert4&#45;&gt;layer15_moe_comm_from_expert4 -->
<g id="edge851" class="edge">
<title>layer15_moe_expert4&#45;&gt;layer15_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3323.25,-35621.65C3323.25,-35621.65 3323.25,-35593.55 3323.25,-35593.55"/>
<polygon fill="black" stroke="black" points="3326.75,-35593.55 3323.25,-35583.55 3319.75,-35593.55 3326.75,-35593.55"/>
</g>
<!-- layer15_moe_comm_to_expert4&#45;&gt;layer15_moe_expert4 -->
<g id="edge820" class="edge">
<title>layer15_moe_comm_to_expert4&#45;&gt;layer15_moe_expert4</title>
<path fill="none" stroke="black" d="M3296.25,-35709.92C3296.25,-35709.92 3296.25,-35684.27 3296.25,-35684.27"/>
<polygon fill="black" stroke="black" points="3299.75,-35684.27 3296.25,-35674.27 3292.75,-35684.27 3299.75,-35684.27"/>
</g>
<!-- layer15_moe_expert5 -->
<g id="node645" class="node">
<title>layer15_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3723,-35673.97 3395,-35673.97 3395,-35621.97 3723,-35621.97 3723,-35673.97"/>
<text text-anchor="middle" x="3559" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 5 L15</text>
<text text-anchor="middle" x="3559" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3559" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3559" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert5 -->
<g id="node673" class="node">
<title>layer15_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3706" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3706" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3706" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3706" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer15_moe_expert5&#45;&gt;layer15_moe_comm_from_expert5 -->
<g id="edge853" class="edge">
<title>layer15_moe_expert5&#45;&gt;layer15_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3669.25,-35621.65C3669.25,-35621.65 3669.25,-35593.55 3669.25,-35593.55"/>
<polygon fill="black" stroke="black" points="3672.75,-35593.55 3669.25,-35583.55 3665.75,-35593.55 3672.75,-35593.55"/>
</g>
<!-- layer15_moe_comm_to_expert5&#45;&gt;layer15_moe_expert5 -->
<g id="edge822" class="edge">
<title>layer15_moe_comm_to_expert5&#45;&gt;layer15_moe_expert5</title>
<path fill="none" stroke="black" d="M3678.75,-35713.62C3678.75,-35713.62 3678.75,-35684.13 3678.75,-35684.13"/>
<polygon fill="black" stroke="black" points="3682.25,-35684.13 3678.75,-35674.13 3675.25,-35684.13 3682.25,-35684.13"/>
</g>
<!-- layer15_moe_expert6 -->
<g id="node647" class="node">
<title>layer15_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4069,-35673.97 3741,-35673.97 3741,-35621.97 4069,-35621.97 4069,-35673.97"/>
<text text-anchor="middle" x="3905" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 6 L15</text>
<text text-anchor="middle" x="3905" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3905" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3905" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert6 -->
<g id="node674" class="node">
<title>layer15_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3978" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3978" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3978" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3978" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer15_moe_expert6&#45;&gt;layer15_moe_comm_from_expert6 -->
<g id="edge855" class="edge">
<title>layer15_moe_expert6&#45;&gt;layer15_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3978,-35621.65C3978,-35621.65 3978,-35596.11 3978,-35596.11"/>
<polygon fill="black" stroke="black" points="3981.5,-35596.11 3978,-35586.11 3974.5,-35596.11 3981.5,-35596.11"/>
</g>
<!-- layer15_moe_comm_to_expert6&#45;&gt;layer15_moe_expert6 -->
<g id="edge824" class="edge">
<title>layer15_moe_comm_to_expert6&#45;&gt;layer15_moe_expert6</title>
<path fill="none" stroke="black" d="M4006.25,-35711.17C4006.25,-35711.17 4006.25,-35684.04 4006.25,-35684.04"/>
<polygon fill="black" stroke="black" points="4009.75,-35684.04 4006.25,-35674.04 4002.75,-35684.04 4009.75,-35684.04"/>
</g>
<!-- layer15_moe_expert7 -->
<g id="node649" class="node">
<title>layer15_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4415,-35673.97 4087,-35673.97 4087,-35621.97 4415,-35621.97 4415,-35673.97"/>
<text text-anchor="middle" x="4251" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 7 L15</text>
<text text-anchor="middle" x="4251" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4251" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4251" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert7 -->
<g id="node675" class="node">
<title>layer15_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4288" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4288" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4288" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4288" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer15_moe_expert7&#45;&gt;layer15_moe_comm_from_expert7 -->
<g id="edge857" class="edge">
<title>layer15_moe_expert7&#45;&gt;layer15_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4288,-35621.65C4288,-35621.65 4288,-35596.11 4288,-35596.11"/>
<polygon fill="black" stroke="black" points="4291.5,-35596.11 4288,-35586.11 4284.5,-35596.11 4291.5,-35596.11"/>
</g>
<!-- layer15_moe_comm_to_expert7&#45;&gt;layer15_moe_expert7 -->
<g id="edge826" class="edge">
<title>layer15_moe_comm_to_expert7&#45;&gt;layer15_moe_expert7</title>
<path fill="none" stroke="black" d="M4288,-35709.92C4288,-35709.92 4288,-35684.27 4288,-35684.27"/>
<polygon fill="black" stroke="black" points="4291.5,-35684.27 4288,-35674.27 4284.5,-35684.27 4291.5,-35684.27"/>
</g>
<!-- layer15_moe_expert8 -->
<g id="node651" class="node">
<title>layer15_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4761,-35673.97 4433,-35673.97 4433,-35621.97 4761,-35621.97 4761,-35673.97"/>
<text text-anchor="middle" x="4597" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 8 L15</text>
<text text-anchor="middle" x="4597" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4597" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4597" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert8 -->
<g id="node676" class="node">
<title>layer15_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4560" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4560" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4560" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4560" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer15_moe_expert8&#45;&gt;layer15_moe_comm_from_expert8 -->
<g id="edge859" class="edge">
<title>layer15_moe_expert8&#45;&gt;layer15_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4560,-35621.65C4560,-35621.65 4560,-35596.11 4560,-35596.11"/>
<polygon fill="black" stroke="black" points="4563.5,-35596.11 4560,-35586.11 4556.5,-35596.11 4563.5,-35596.11"/>
</g>
<!-- layer15_moe_comm_to_expert8&#45;&gt;layer15_moe_expert8 -->
<g id="edge828" class="edge">
<title>layer15_moe_comm_to_expert8&#45;&gt;layer15_moe_expert8</title>
<path fill="none" stroke="black" d="M4560,-35709.92C4560,-35709.92 4560,-35684.27 4560,-35684.27"/>
<polygon fill="black" stroke="black" points="4563.5,-35684.27 4560,-35674.27 4556.5,-35684.27 4563.5,-35684.27"/>
</g>
<!-- layer15_moe_expert9 -->
<g id="node653" class="node">
<title>layer15_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5107,-35673.97 4779,-35673.97 4779,-35621.97 5107,-35621.97 5107,-35673.97"/>
<text text-anchor="middle" x="4943" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 9 L15</text>
<text text-anchor="middle" x="4943" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4943" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4943" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert9 -->
<g id="node677" class="node">
<title>layer15_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4869" cy="-35556.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4869" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4869" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4869" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer15_moe_expert9&#45;&gt;layer15_moe_comm_from_expert9 -->
<g id="edge861" class="edge">
<title>layer15_moe_expert9&#45;&gt;layer15_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4869.25,-35621.65C4869.25,-35621.65 4869.25,-35596.11 4869.25,-35596.11"/>
<polygon fill="black" stroke="black" points="4872.75,-35596.11 4869.25,-35586.11 4865.75,-35596.11 4872.75,-35596.11"/>
</g>
<!-- layer15_moe_comm_to_expert9&#45;&gt;layer15_moe_expert9 -->
<g id="edge830" class="edge">
<title>layer15_moe_comm_to_expert9&#45;&gt;layer15_moe_expert9</title>
<path fill="none" stroke="black" d="M4869.25,-35709.92C4869.25,-35709.92 4869.25,-35684.27 4869.25,-35684.27"/>
<polygon fill="black" stroke="black" points="4872.75,-35684.27 4869.25,-35674.27 4865.75,-35684.27 4872.75,-35684.27"/>
</g>
<!-- layer15_moe_expert10 -->
<g id="node655" class="node">
<title>layer15_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5463,-35673.97 5125,-35673.97 5125,-35621.97 5463,-35621.97 5463,-35673.97"/>
<text text-anchor="middle" x="5294" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 10 L15</text>
<text text-anchor="middle" x="5294" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5294" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5294" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert10 -->
<g id="node678" class="node">
<title>layer15_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5201" cy="-35556.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5201" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5201" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5201" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer15_moe_expert10&#45;&gt;layer15_moe_comm_from_expert10 -->
<g id="edge863" class="edge">
<title>layer15_moe_expert10&#45;&gt;layer15_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5210.38,-35621.65C5210.38,-35621.65 5210.38,-35596.11 5210.38,-35596.11"/>
<polygon fill="black" stroke="black" points="5213.88,-35596.11 5210.38,-35586.11 5206.88,-35596.11 5213.88,-35596.11"/>
</g>
<!-- layer15_moe_comm_to_expert10&#45;&gt;layer15_moe_expert10 -->
<g id="edge832" class="edge">
<title>layer15_moe_comm_to_expert10&#45;&gt;layer15_moe_expert10</title>
<path fill="none" stroke="black" d="M5210.02,-35709.92C5210.02,-35709.92 5210.02,-35684.27 5210.02,-35684.27"/>
<polygon fill="black" stroke="black" points="5213.52,-35684.27 5210.02,-35674.27 5206.52,-35684.27 5213.52,-35684.27"/>
</g>
<!-- layer15_moe_expert11 -->
<g id="node657" class="node">
<title>layer15_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5819,-35673.97 5481,-35673.97 5481,-35621.97 5819,-35621.97 5819,-35673.97"/>
<text text-anchor="middle" x="5650" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 11 L15</text>
<text text-anchor="middle" x="5650" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5650" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5650" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert11 -->
<g id="node679" class="node">
<title>layer15_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5548" cy="-35556.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5548" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5548" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5548" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer15_moe_expert11&#45;&gt;layer15_moe_comm_from_expert11 -->
<g id="edge865" class="edge">
<title>layer15_moe_expert11&#45;&gt;layer15_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5561.88,-35621.65C5561.88,-35621.65 5561.88,-35595.79 5561.88,-35595.79"/>
<polygon fill="black" stroke="black" points="5565.38,-35595.79 5561.88,-35585.79 5558.38,-35595.79 5565.38,-35595.79"/>
</g>
<!-- layer15_moe_comm_to_expert11&#45;&gt;layer15_moe_expert11 -->
<g id="edge834" class="edge">
<title>layer15_moe_comm_to_expert11&#45;&gt;layer15_moe_expert11</title>
<path fill="none" stroke="black" d="M5561.02,-35710.17C5561.02,-35710.17 5561.02,-35684.11 5561.02,-35684.11"/>
<polygon fill="black" stroke="black" points="5564.52,-35684.11 5561.02,-35674.11 5557.52,-35684.11 5564.52,-35684.11"/>
</g>
<!-- layer15_moe_expert12 -->
<g id="node659" class="node">
<title>layer15_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6175,-35673.97 5837,-35673.97 5837,-35621.97 6175,-35621.97 6175,-35673.97"/>
<text text-anchor="middle" x="6006" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 12 L15</text>
<text text-anchor="middle" x="6006" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="6006" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="6006" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert12 -->
<g id="node680" class="node">
<title>layer15_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5899" cy="-35556.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5899" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5899" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5899" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer15_moe_expert12&#45;&gt;layer15_moe_comm_from_expert12 -->
<g id="edge867" class="edge">
<title>layer15_moe_expert12&#45;&gt;layer15_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5915.38,-35621.65C5915.38,-35621.65 5915.38,-35595.79 5915.38,-35595.79"/>
<polygon fill="black" stroke="black" points="5918.88,-35595.79 5915.38,-35585.79 5911.88,-35595.79 5918.88,-35595.79"/>
</g>
<!-- layer15_moe_comm_to_expert12&#45;&gt;layer15_moe_expert12 -->
<g id="edge836" class="edge">
<title>layer15_moe_comm_to_expert12&#45;&gt;layer15_moe_expert12</title>
<path fill="none" stroke="black" d="M5914.52,-35710.17C5914.52,-35710.17 5914.52,-35684.11 5914.52,-35684.11"/>
<polygon fill="black" stroke="black" points="5918.02,-35684.11 5914.52,-35674.11 5911.02,-35684.11 5918.02,-35684.11"/>
</g>
<!-- layer15_moe_expert13 -->
<g id="node661" class="node">
<title>layer15_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6531,-35673.97 6193,-35673.97 6193,-35621.97 6531,-35621.97 6531,-35673.97"/>
<text text-anchor="middle" x="6362" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 13 L15</text>
<text text-anchor="middle" x="6362" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6362" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6362" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert13 -->
<g id="node681" class="node">
<title>layer15_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6253" cy="-35556.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6253" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6253" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6253" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer15_moe_expert13&#45;&gt;layer15_moe_comm_from_expert13 -->
<g id="edge869" class="edge">
<title>layer15_moe_expert13&#45;&gt;layer15_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6270.38,-35621.65C6270.38,-35621.65 6270.38,-35595.79 6270.38,-35595.79"/>
<polygon fill="black" stroke="black" points="6273.88,-35595.79 6270.38,-35585.79 6266.88,-35595.79 6273.88,-35595.79"/>
</g>
<!-- layer15_moe_comm_to_expert13&#45;&gt;layer15_moe_expert13 -->
<g id="edge838" class="edge">
<title>layer15_moe_comm_to_expert13&#45;&gt;layer15_moe_expert13</title>
<path fill="none" stroke="black" d="M6269.02,-35710.17C6269.02,-35710.17 6269.02,-35684.11 6269.02,-35684.11"/>
<polygon fill="black" stroke="black" points="6272.52,-35684.11 6269.02,-35674.11 6265.52,-35684.11 6272.52,-35684.11"/>
</g>
<!-- layer15_moe_expert14 -->
<g id="node663" class="node">
<title>layer15_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6887,-35673.97 6549,-35673.97 6549,-35621.97 6887,-35621.97 6887,-35673.97"/>
<text text-anchor="middle" x="6718" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 14 L15</text>
<text text-anchor="middle" x="6718" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6718" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6718" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert14 -->
<g id="node682" class="node">
<title>layer15_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6608" cy="-35556.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6608" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6608" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6608" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer15_moe_expert14&#45;&gt;layer15_moe_comm_from_expert14 -->
<g id="edge871" class="edge">
<title>layer15_moe_expert14&#45;&gt;layer15_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6625.88,-35621.65C6625.88,-35621.65 6625.88,-35595.46 6625.88,-35595.46"/>
<polygon fill="black" stroke="black" points="6629.38,-35595.46 6625.88,-35585.46 6622.38,-35595.46 6629.38,-35595.46"/>
</g>
<!-- layer15_moe_comm_to_expert14&#45;&gt;layer15_moe_expert14 -->
<g id="edge840" class="edge">
<title>layer15_moe_comm_to_expert14&#45;&gt;layer15_moe_expert14</title>
<path fill="none" stroke="black" d="M6624.52,-35710.17C6624.52,-35710.17 6624.52,-35684.11 6624.52,-35684.11"/>
<polygon fill="black" stroke="black" points="6628.02,-35684.11 6624.52,-35674.11 6621.02,-35684.11 6628.02,-35684.11"/>
</g>
<!-- layer15_moe_expert15 -->
<g id="node665" class="node">
<title>layer15_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7243,-35673.97 6905,-35673.97 6905,-35621.97 7243,-35621.97 7243,-35673.97"/>
<text text-anchor="middle" x="7074" y="-35661.97" font-family="Arial" font-size="10.00">EXPERT 15 L15</text>
<text text-anchor="middle" x="7074" y="-35650.97" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7074" y="-35639.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7074" y="-35628.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_comm_from_expert15 -->
<g id="node683" class="node">
<title>layer15_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6963" cy="-35556.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6963" y="-35565.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6963" y="-35554.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6963" y="-35543.48" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer15_moe_expert15&#45;&gt;layer15_moe_comm_from_expert15 -->
<g id="edge873" class="edge">
<title>layer15_moe_expert15&#45;&gt;layer15_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6981.38,-35621.65C6981.38,-35621.65 6981.38,-35595.46 6981.38,-35595.46"/>
<polygon fill="black" stroke="black" points="6984.88,-35595.46 6981.38,-35585.46 6977.88,-35595.46 6984.88,-35595.46"/>
</g>
<!-- layer15_moe_comm_to_expert15&#45;&gt;layer15_moe_expert15 -->
<g id="edge842" class="edge">
<title>layer15_moe_comm_to_expert15&#45;&gt;layer15_moe_expert15</title>
<path fill="none" stroke="black" d="M6980.02,-35710.17C6980.02,-35710.17 6980.02,-35684.11 6980.02,-35684.11"/>
<polygon fill="black" stroke="black" points="6983.52,-35684.11 6980.02,-35674.11 6976.52,-35684.11 6983.52,-35684.11"/>
</g>
<!-- layer15_moe_aggregate -->
<g id="node667" class="node">
<title>layer15_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4649.1,-35491.99 4232.16,-35491.99 4124.9,-35387.99 4541.84,-35387.99 4649.1,-35491.99"/>
<text text-anchor="middle" x="4387" y="-35453.99" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L15</text>
<text text-anchor="middle" x="4387" y="-35442.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4387" y="-35431.99" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4387" y="-35420.99" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_mha -->
<g id="node684" class="node">
<title>layer16_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4517,-35351.99 4257,-35351.99 4257,-35299.99 4517,-35299.99 4517,-35351.99"/>
<text text-anchor="middle" x="4387" y="-35339.99" font-family="Arial" font-size="10.00">MHA L16</text>
<text text-anchor="middle" x="4387" y="-35328.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4387" y="-35317.99" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-35306.99" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer15_moe_aggregate&#45;&gt;layer16_moe_mha -->
<g id="edge942" class="edge">
<title>layer15_moe_aggregate&#45;&gt;layer16_moe_mha</title>
<path fill="none" stroke="black" d="M4387,-35387.66C4387,-35387.66 4387,-35362.21 4387,-35362.21"/>
<polygon fill="black" stroke="black" points="4390.5,-35362.21 4387,-35352.21 4383.5,-35362.21 4390.5,-35362.21"/>
</g>
<!-- layer15_moe_comm_from_expert0&#45;&gt;layer15_moe_aggregate -->
<g id="edge844" class="edge">
<title>layer15_moe_comm_from_expert0&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M2029.75,-35529.98C2029.75,-35485.58 2029.75,-35402 2029.75,-35402 2029.75,-35402 4129.19,-35402 4129.19,-35402"/>
<polygon fill="black" stroke="black" points="4129.19,-35405.5 4139.19,-35402 4129.19,-35398.5 4129.19,-35405.5"/>
</g>
<!-- layer15_moe_comm_from_expert1&#45;&gt;layer15_moe_aggregate -->
<g id="edge846" class="edge">
<title>layer15_moe_comm_from_expert1&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M2482.5,-35537.81C2482.5,-35499.47 2482.5,-35417 2482.5,-35417 2482.5,-35417 4144.42,-35417 4144.42,-35417"/>
<polygon fill="black" stroke="black" points="4144.42,-35420.5 4154.42,-35417 4144.42,-35413.5 4144.42,-35420.5"/>
</g>
<!-- layer15_moe_comm_from_expert2&#45;&gt;layer15_moe_aggregate -->
<g id="edge848" class="edge">
<title>layer15_moe_comm_from_expert2&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M2739.75,-35528.31C2739.75,-35491.41 2739.75,-35432 2739.75,-35432 2739.75,-35432 4159.96,-35432 4159.96,-35432"/>
<polygon fill="black" stroke="black" points="4159.96,-35435.5 4169.96,-35432 4159.96,-35428.5 4159.96,-35435.5"/>
</g>
<!-- layer15_moe_comm_from_expert3&#45;&gt;layer15_moe_aggregate -->
<g id="edge850" class="edge">
<title>layer15_moe_comm_from_expert3&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M2992,-35528.37C2992,-35495.78 2992,-35447 2992,-35447 2992,-35447 4175.64,-35447 4175.64,-35447"/>
<polygon fill="black" stroke="black" points="4175.64,-35450.5 4185.64,-35447 4175.64,-35443.5 4175.64,-35450.5"/>
</g>
<!-- layer15_moe_comm_from_expert4&#45;&gt;layer15_moe_aggregate -->
<g id="edge852" class="edge">
<title>layer15_moe_comm_from_expert4&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M3438.01,-35542.14C3438.01,-35515.43 3438.01,-35462 3438.01,-35462 3438.01,-35462 4191.21,-35462 4191.21,-35462"/>
<polygon fill="black" stroke="black" points="4191.21,-35465.5 4201.21,-35462 4191.21,-35458.5 4191.21,-35465.5"/>
</g>
<!-- layer15_moe_comm_from_expert5&#45;&gt;layer15_moe_aggregate -->
<g id="edge854" class="edge">
<title>layer15_moe_comm_from_expert5&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M3767.5,-35535.55C3767.5,-35511.86 3767.5,-35477 3767.5,-35477 3767.5,-35477 4206.49,-35477 4206.49,-35477"/>
<polygon fill="black" stroke="black" points="4206.49,-35480.5 4216.49,-35477 4206.49,-35473.5 4206.49,-35480.5"/>
</g>
<!-- layer15_moe_comm_from_expert6&#45;&gt;layer15_moe_aggregate -->
<g id="edge856" class="edge">
<title>layer15_moe_comm_from_expert6&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M4068.48,-35556C4114.6,-35556 4161.1,-35556 4161.1,-35556 4161.1,-35556 4161.1,-35450.07 4161.1,-35450.07"/>
<polygon fill="black" stroke="black" points="4164.6,-35450.07 4161.1,-35440.07 4157.6,-35450.07 4164.6,-35450.07"/>
</g>
<!-- layer15_moe_comm_from_expert7&#45;&gt;layer15_moe_aggregate -->
<g id="edge858" class="edge">
<title>layer15_moe_comm_from_expert7&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M4288,-35527.76C4288,-35527.76 4288,-35502.05 4288,-35502.05"/>
<polygon fill="black" stroke="black" points="4291.5,-35502.05 4288,-35492.05 4284.5,-35502.05 4291.5,-35502.05"/>
</g>
<!-- layer15_moe_comm_from_expert8&#45;&gt;layer15_moe_aggregate -->
<g id="edge860" class="edge">
<title>layer15_moe_comm_from_expert8&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M4559.39,-35527.76C4559.39,-35527.76 4559.39,-35502.05 4559.39,-35502.05"/>
<polygon fill="black" stroke="black" points="4562.89,-35502.05 4559.39,-35492.05 4555.89,-35502.05 4562.89,-35502.05"/>
</g>
<!-- layer15_moe_comm_from_expert9&#45;&gt;layer15_moe_aggregate -->
<g id="edge862" class="edge">
<title>layer15_moe_comm_from_expert9&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M4850.5,-35528.47C4850.5,-35505.84 4850.5,-35478 4850.5,-35478 4850.5,-35478 4644.69,-35478 4644.69,-35478"/>
<polygon fill="black" stroke="black" points="4644.69,-35474.5 4634.69,-35478 4644.69,-35481.5 4644.69,-35474.5"/>
</g>
<!-- layer15_moe_comm_from_expert10&#45;&gt;layer15_moe_aggregate -->
<g id="edge864" class="edge">
<title>layer15_moe_comm_from_expert10&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M5182.15,-35528.38C5182.15,-35501.38 5182.15,-35465 5182.15,-35465 5182.15,-35465 4631.27,-35465 4631.27,-35465"/>
<polygon fill="black" stroke="black" points="4631.27,-35461.5 4621.27,-35465 4631.27,-35468.5 4631.27,-35461.5"/>
</g>
<!-- layer15_moe_comm_from_expert11&#45;&gt;layer15_moe_aggregate -->
<g id="edge866" class="edge">
<title>layer15_moe_comm_from_expert11&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M5528.65,-35528.57C5528.65,-35497.48 5528.65,-35452 5528.65,-35452 5528.65,-35452 4618.14,-35452 4618.14,-35452"/>
<polygon fill="black" stroke="black" points="4618.14,-35448.5 4608.14,-35452 4618.14,-35455.5 4618.14,-35448.5"/>
</g>
<!-- layer15_moe_comm_from_expert12&#45;&gt;layer15_moe_aggregate -->
<g id="edge868" class="edge">
<title>layer15_moe_comm_from_expert12&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M5879.65,-35528.42C5879.65,-35493.5 5879.65,-35439 5879.65,-35439 5879.65,-35439 4604.55,-35439 4604.55,-35439"/>
<polygon fill="black" stroke="black" points="4604.55,-35435.5 4594.55,-35439 4604.55,-35442.5 4604.55,-35435.5"/>
</g>
<!-- layer15_moe_comm_from_expert13&#45;&gt;layer15_moe_aggregate -->
<g id="edge870" class="edge">
<title>layer15_moe_comm_from_expert13&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M6233.15,-35528.56C6233.15,-35490.04 6233.15,-35426 6233.15,-35426 6233.15,-35426 4591.08,-35426 4591.08,-35426"/>
<polygon fill="black" stroke="black" points="4591.08,-35422.5 4581.08,-35426 4591.08,-35429.5 4591.08,-35422.5"/>
</g>
<!-- layer15_moe_comm_from_expert14&#45;&gt;layer15_moe_aggregate -->
<g id="edge872" class="edge">
<title>layer15_moe_comm_from_expert14&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M6588.15,-35528.53C6588.15,-35486.57 6588.15,-35413 6588.15,-35413 6588.15,-35413 4578.06,-35413 4578.06,-35413"/>
<polygon fill="black" stroke="black" points="4578.06,-35409.5 4568.06,-35413 4578.06,-35416.5 4578.06,-35409.5"/>
</g>
<!-- layer15_moe_comm_from_expert15&#45;&gt;layer15_moe_aggregate -->
<g id="edge874" class="edge">
<title>layer15_moe_comm_from_expert15&#45;&gt;layer15_moe_aggregate</title>
<path fill="none" stroke="black" d="M6943.15,-35528.55C6943.15,-35483.31 6943.15,-35400 6943.15,-35400 6943.15,-35400 4564.72,-35400 4564.72,-35400"/>
<polygon fill="black" stroke="black" points="4564.72,-35396.5 4554.72,-35400 4564.72,-35403.5 4564.72,-35396.5"/>
</g>
<!-- layer16_moe_gate -->
<g id="node685" class="node">
<title>layer16_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4645.3,-35263.99 4234.4,-35263.99 4128.7,-35159.99 4539.6,-35159.99 4645.3,-35263.99"/>
<text text-anchor="middle" x="4387" y="-35225.99" font-family="Arial" font-size="10.00">GATE L16</text>
<text text-anchor="middle" x="4387" y="-35214.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4387" y="-35203.99" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4387" y="-35192.99" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer16_moe_mha&#45;&gt;layer16_moe_gate -->
<g id="edge943" class="edge">
<title>layer16_moe_mha&#45;&gt;layer16_moe_gate</title>
<path fill="none" stroke="black" d="M4387,-35299.83C4387,-35299.83 4387,-35274.09 4387,-35274.09"/>
<polygon fill="black" stroke="black" points="4390.5,-35274.09 4387,-35264.09 4383.5,-35274.09 4390.5,-35274.09"/>
</g>
<!-- layer16_moe_split -->
<g id="node686" class="node">
<title>layer16_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4641.01,-35123.99 4236.94,-35123.99 4132.99,-35019.99 4537.06,-35019.99 4641.01,-35123.99"/>
<text text-anchor="middle" x="4387" y="-35085.99" font-family="Arial" font-size="10.00">SPLIT TOKENS L16</text>
<text text-anchor="middle" x="4387" y="-35074.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4387" y="-35063.99" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4387" y="-35052.99" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer16_moe_gate&#45;&gt;layer16_moe_split -->
<g id="edge944" class="edge">
<title>layer16_moe_gate&#45;&gt;layer16_moe_split</title>
<path fill="none" stroke="black" d="M4387,-35159.86C4387,-35159.86 4387,-35134.16 4387,-35134.16"/>
<polygon fill="black" stroke="black" points="4390.5,-35134.16 4387,-35124.16 4383.5,-35134.16 4390.5,-35134.16"/>
</g>
<!-- layer16_moe_comm_to_expert0 -->
<g id="node688" class="node">
<title>layer16_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2306" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2306" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2306" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2306" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert0 -->
<g id="edge878" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4221.55,-35109C3737.83,-35109 2360,-35109 2360,-35109 2360,-35109 2360,-34988.39 2360,-34988.39"/>
<polygon fill="black" stroke="black" points="2363.5,-34988.39 2360,-34978.39 2356.5,-34988.39 2363.5,-34988.39"/>
</g>
<!-- layer16_moe_comm_to_expert1 -->
<g id="node690" class="node">
<title>layer16_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2551" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2551" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2551" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2551" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert1 -->
<g id="edge880" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4206.72,-35094C3759.87,-35094 2637,-35094 2637,-35094 2637,-35094 2637,-34974.12 2637,-34974.12"/>
<polygon fill="black" stroke="black" points="2640.5,-34974.12 2637,-34964.12 2633.5,-34974.12 2640.5,-34974.12"/>
</g>
<!-- layer16_moe_comm_to_expert2 -->
<g id="node692" class="node">
<title>layer16_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3007" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3007" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="3007" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="3007" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert2 -->
<g id="edge882" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4191.7,-35079C3827.8,-35079 3082.51,-35079 3082.51,-35079 3082.51,-35079 3082.51,-34981.21 3082.51,-34981.21"/>
<polygon fill="black" stroke="black" points="3086.01,-34981.21 3082.51,-34971.21 3079.01,-34981.21 3086.01,-34981.21"/>
</g>
<!-- layer16_moe_comm_to_expert3 -->
<g id="node694" class="node">
<title>layer16_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3335" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3335" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3335" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3335" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert3 -->
<g id="edge884" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4176.95,-35064C3873.26,-35064 3347.5,-35064 3347.5,-35064 3347.5,-35064 3347.5,-34993.92 3347.5,-34993.92"/>
<polygon fill="black" stroke="black" points="3351,-34993.92 3347.5,-34983.92 3344,-34993.92 3351,-34993.92"/>
</g>
<!-- layer16_moe_comm_to_expert4 -->
<g id="node696" class="node">
<title>layer16_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3598" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3598" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3598" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3598" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert4 -->
<g id="edge886" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4161.98,-35049C3945.88,-35049 3652,-35049 3652,-35049 3652,-35049 3652,-34988.72 3652,-34988.72"/>
<polygon fill="black" stroke="black" points="3655.5,-34988.72 3652,-34978.72 3648.5,-34988.72 3655.5,-34988.72"/>
</g>
<!-- layer16_moe_comm_to_expert5 -->
<g id="node698" class="node">
<title>layer16_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3829" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3829" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3829" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3829" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert5 -->
<g id="edge888" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4146.67,-35034C4025.32,-35034 3903.5,-35034 3903.5,-35034 3903.5,-35034 3903.5,-34981.75 3903.5,-34981.75"/>
<polygon fill="black" stroke="black" points="3907,-34981.75 3903.5,-34971.75 3900,-34981.75 3907,-34981.75"/>
</g>
<!-- layer16_moe_comm_to_expert6 -->
<g id="node700" class="node">
<title>layer16_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4044" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4044" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="4044" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4044" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert6 -->
<g id="edge890" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4147.5,-35071.9C4147.5,-35068.33 4147.5,-34954 4147.5,-34954 4147.5,-34954 4144.81,-34954 4144.81,-34954"/>
<polygon fill="black" stroke="black" points="4144.81,-34950.5 4134.81,-34954 4144.81,-34957.5 4144.81,-34950.5"/>
</g>
<!-- layer16_moe_comm_to_expert7 -->
<g id="node702" class="node">
<title>layer16_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4251" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4251" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4251" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4251" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert7 -->
<g id="edge892" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4251,-35019.65C4251,-35019.65 4251,-34994.21 4251,-34994.21"/>
<polygon fill="black" stroke="black" points="4254.5,-34994.21 4251,-34984.21 4247.5,-34994.21 4254.5,-34994.21"/>
</g>
<!-- layer16_moe_comm_to_expert8 -->
<g id="node704" class="node">
<title>layer16_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4523" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4523" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4523" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4523" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert8 -->
<g id="edge894" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4523,-35019.65C4523,-35019.65 4523,-34994.21 4523,-34994.21"/>
<polygon fill="black" stroke="black" points="4526.5,-34994.21 4523,-34984.21 4519.5,-34994.21 4526.5,-34994.21"/>
</g>
<!-- layer16_moe_comm_to_expert9 -->
<g id="node706" class="node">
<title>layer16_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4832" cy="-34955" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4832" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4832" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4832" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert9 -->
<g id="edge896" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4627.26,-35071.9C4627.26,-35068.33 4627.26,-34954 4627.26,-34954 4627.26,-34954 4731.3,-34954 4731.3,-34954"/>
<polygon fill="black" stroke="black" points="4731.3,-34957.5 4741.3,-34954 4731.3,-34950.5 4731.3,-34957.5"/>
</g>
<!-- layer16_moe_comm_to_expert10 -->
<g id="node708" class="node">
<title>layer16_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5164" cy="-34955" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5164" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5164" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5164" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert10 -->
<g id="edge898" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4551.38,-35034C4758.6,-35034 5088.1,-35034 5088.1,-35034 5088.1,-35034 5088.1,-34982.14 5088.1,-34982.14"/>
<polygon fill="black" stroke="black" points="5091.6,-34982.14 5088.1,-34972.14 5084.6,-34982.14 5091.6,-34982.14"/>
</g>
<!-- layer16_moe_comm_to_expert11 -->
<g id="node710" class="node">
<title>layer16_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5510" cy="-34955" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5510" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5510" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5510" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert11 -->
<g id="edge900" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4566.2,-35049C4865.48,-35049 5434.6,-35049 5434.6,-35049 5434.6,-35049 5434.6,-34982.68 5434.6,-34982.68"/>
<polygon fill="black" stroke="black" points="5438.1,-34982.68 5434.6,-34972.68 5431.1,-34982.68 5438.1,-34982.68"/>
</g>
<!-- layer16_moe_comm_to_expert12 -->
<g id="node712" class="node">
<title>layer16_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5861" cy="-34955" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5861" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5861" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5861" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert12 -->
<g id="edge902" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4581.1,-35064C4965.24,-35064 5785.6,-35064 5785.6,-35064 5785.6,-35064 5785.6,-34982.51 5785.6,-34982.51"/>
<polygon fill="black" stroke="black" points="5789.1,-34982.51 5785.6,-34972.51 5782.1,-34982.51 5789.1,-34982.51"/>
</g>
<!-- layer16_moe_comm_to_expert13 -->
<g id="node714" class="node">
<title>layer16_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6214" cy="-34955" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6214" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6214" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6214" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert13 -->
<g id="edge904" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.17,-35079C5061,-35079 6139.1,-35079 6139.1,-35079 6139.1,-35079 6139.1,-34982.76 6139.1,-34982.76"/>
<polygon fill="black" stroke="black" points="6142.6,-34982.76 6139.1,-34972.76 6135.6,-34982.76 6142.6,-34982.76"/>
</g>
<!-- layer16_moe_comm_to_expert14 -->
<g id="node716" class="node">
<title>layer16_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6569" cy="-34955" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6569" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6569" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6569" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert14 -->
<g id="edge906" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4611.5,-35094C5154.43,-35094 6494.1,-35094 6494.1,-35094 6494.1,-35094 6494.1,-34982.6 6494.1,-34982.6"/>
<polygon fill="black" stroke="black" points="6497.6,-34982.6 6494.1,-34972.6 6490.6,-34982.6 6497.6,-34982.6"/>
</g>
<!-- layer16_moe_comm_to_expert15 -->
<g id="node718" class="node">
<title>layer16_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6924" cy="-34955" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6924" y="-34963.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6924" y="-34952.5" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6924" y="-34941.5" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert15 -->
<g id="edge908" class="edge">
<title>layer16_moe_split&#45;&gt;layer16_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4626.15,-35109C5244.66,-35109 6849.1,-35109 6849.1,-35109 6849.1,-35109 6849.1,-34982.66 6849.1,-34982.66"/>
<polygon fill="black" stroke="black" points="6852.6,-34982.66 6849.1,-34972.66 6845.6,-34982.66 6852.6,-34982.66"/>
</g>
<!-- layer16_moe_expert0 -->
<g id="node687" class="node">
<title>layer16_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1956,-34890 1628,-34890 1628,-34838 1956,-34838 1956,-34890"/>
<text text-anchor="middle" x="1792" y="-34878" font-family="Arial" font-size="10.00">EXPERT 0 L16</text>
<text text-anchor="middle" x="1792" y="-34867" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1792" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1792" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert0 -->
<g id="node720" class="node">
<title>layer16_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1939" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1939" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1939" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1939" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer16_moe_expert0&#45;&gt;layer16_moe_comm_from_expert0 -->
<g id="edge910" class="edge">
<title>layer16_moe_expert0&#45;&gt;layer16_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1902.25,-34837.69C1902.25,-34837.69 1902.25,-34809.59 1902.25,-34809.59"/>
<polygon fill="black" stroke="black" points="1905.75,-34809.59 1902.25,-34799.59 1898.75,-34809.59 1905.75,-34809.59"/>
</g>
<!-- layer16_moe_comm_to_expert0&#45;&gt;layer16_moe_expert0 -->
<g id="edge879" class="edge">
<title>layer16_moe_comm_to_expert0&#45;&gt;layer16_moe_expert0</title>
<path fill="none" stroke="black" d="M2215.52,-34954C2104.33,-34954 1930.25,-34954 1930.25,-34954 1930.25,-34954 1930.25,-34900.03 1930.25,-34900.03"/>
<polygon fill="black" stroke="black" points="1933.75,-34900.03 1930.25,-34890.03 1926.75,-34900.03 1933.75,-34900.03"/>
</g>
<!-- layer16_moe_expert1 -->
<g id="node689" class="node">
<title>layer16_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2302,-34890 1974,-34890 1974,-34838 2302,-34838 2302,-34890"/>
<text text-anchor="middle" x="2138" y="-34878" font-family="Arial" font-size="10.00">EXPERT 1 L16</text>
<text text-anchor="middle" x="2138" y="-34867" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2138" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2138" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert1 -->
<g id="node721" class="node">
<title>layer16_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2211" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2211" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2211" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2211" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer16_moe_expert1&#45;&gt;layer16_moe_comm_from_expert1 -->
<g id="edge912" class="edge">
<title>layer16_moe_expert1&#45;&gt;layer16_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2211,-34837.69C2211,-34837.69 2211,-34812.14 2211,-34812.14"/>
<polygon fill="black" stroke="black" points="2214.5,-34812.14 2211,-34802.14 2207.5,-34812.14 2214.5,-34812.14"/>
</g>
<!-- layer16_moe_comm_to_expert1&#45;&gt;layer16_moe_expert1 -->
<g id="edge881" class="edge">
<title>layer16_moe_comm_to_expert1&#45;&gt;layer16_moe_expert1</title>
<path fill="none" stroke="black" d="M2551,-34925.69C2551,-34912.14 2551,-34899 2551,-34899 2551,-34899 2258.75,-34899 2258.75,-34899 2258.75,-34899 2258.75,-34898.12 2258.75,-34898.12"/>
<polygon fill="black" stroke="black" points="2262.25,-34900.17 2258.75,-34890.17 2255.25,-34900.17 2262.25,-34900.17"/>
</g>
<!-- layer16_moe_expert2 -->
<g id="node691" class="node">
<title>layer16_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2648,-34890 2320,-34890 2320,-34838 2648,-34838 2648,-34890"/>
<text text-anchor="middle" x="2484" y="-34878" font-family="Arial" font-size="10.00">EXPERT 2 L16</text>
<text text-anchor="middle" x="2484" y="-34867" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2484" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2484" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert2 -->
<g id="node722" class="node">
<title>layer16_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2594" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2594" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2594" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2594" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer16_moe_expert2&#45;&gt;layer16_moe_comm_from_expert2 -->
<g id="edge914" class="edge">
<title>layer16_moe_expert2&#45;&gt;layer16_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2575.75,-34837.69C2575.75,-34837.69 2575.75,-34811.5 2575.75,-34811.5"/>
<polygon fill="black" stroke="black" points="2579.25,-34811.5 2575.75,-34801.5 2572.25,-34811.5 2579.25,-34811.5"/>
</g>
<!-- layer16_moe_comm_to_expert2&#45;&gt;layer16_moe_expert2 -->
<g id="edge883" class="edge">
<title>layer16_moe_comm_to_expert2&#45;&gt;layer16_moe_expert2</title>
<path fill="none" stroke="black" d="M2916.41,-34954C2812.71,-34954 2657,-34954 2657,-34954 2657,-34954 2657,-34864 2657,-34864 2657,-34864 2656.12,-34864 2656.12,-34864"/>
<polygon fill="black" stroke="black" points="2658.18,-34860.5 2648.18,-34864 2658.18,-34867.5 2658.18,-34860.5"/>
</g>
<!-- layer16_moe_expert3 -->
<g id="node693" class="node">
<title>layer16_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2994,-34890 2666,-34890 2666,-34838 2994,-34838 2994,-34890"/>
<text text-anchor="middle" x="2830" y="-34878" font-family="Arial" font-size="10.00">EXPERT 3 L16</text>
<text text-anchor="middle" x="2830" y="-34867" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2830" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2830" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert3 -->
<g id="node723" class="node">
<title>layer16_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3014" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3014" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3014" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3014" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer16_moe_expert3&#45;&gt;layer16_moe_comm_from_expert3 -->
<g id="edge916" class="edge">
<title>layer16_moe_expert3&#45;&gt;layer16_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2958.75,-34837.69C2958.75,-34837.69 2958.75,-34806.18 2958.75,-34806.18"/>
<polygon fill="black" stroke="black" points="2962.25,-34806.18 2958.75,-34796.18 2955.25,-34806.18 2962.25,-34806.18"/>
</g>
<!-- layer16_moe_comm_to_expert3&#45;&gt;layer16_moe_expert3 -->
<g id="edge885" class="edge">
<title>layer16_moe_comm_to_expert3&#45;&gt;layer16_moe_expert3</title>
<path fill="none" stroke="black" d="M3276.33,-34932.89C3276.33,-34924.53 3276.33,-34917 3276.33,-34917 3276.33,-34917 2955.25,-34917 2955.25,-34917 2955.25,-34917 2955.25,-34900.19 2955.25,-34900.19"/>
<polygon fill="black" stroke="black" points="2958.75,-34900.19 2955.25,-34890.19 2951.75,-34900.19 2958.75,-34900.19"/>
</g>
<!-- layer16_moe_expert4 -->
<g id="node695" class="node">
<title>layer16_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3340,-34890 3012,-34890 3012,-34838 3340,-34838 3340,-34890"/>
<text text-anchor="middle" x="3176" y="-34878" font-family="Arial" font-size="10.00">EXPERT 4 L16</text>
<text text-anchor="middle" x="3176" y="-34867" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3176" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3176" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert4 -->
<g id="node724" class="node">
<title>layer16_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3360" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3360" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3360" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3360" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer16_moe_expert4&#45;&gt;layer16_moe_comm_from_expert4 -->
<g id="edge918" class="edge">
<title>layer16_moe_expert4&#45;&gt;layer16_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3304.75,-34837.69C3304.75,-34837.69 3304.75,-34806.18 3304.75,-34806.18"/>
<polygon fill="black" stroke="black" points="3308.25,-34806.18 3304.75,-34796.18 3301.25,-34806.18 3308.25,-34806.18"/>
</g>
<!-- layer16_moe_comm_to_expert4&#45;&gt;layer16_moe_expert4 -->
<g id="edge887" class="edge">
<title>layer16_moe_comm_to_expert4&#45;&gt;layer16_moe_expert4</title>
<path fill="none" stroke="black" d="M3596.75,-34925.77C3596.75,-34916.21 3596.75,-34908 3596.75,-34908 3596.75,-34908 3308.16,-34908 3308.16,-34908 3308.16,-34908 3308.16,-34900.11 3308.16,-34900.11"/>
<polygon fill="black" stroke="black" points="3311.66,-34900.11 3308.16,-34890.11 3304.66,-34900.11 3311.66,-34900.11"/>
</g>
<!-- layer16_moe_expert5 -->
<g id="node697" class="node">
<title>layer16_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3686,-34890 3358,-34890 3358,-34838 3686,-34838 3686,-34890"/>
<text text-anchor="middle" x="3522" y="-34878" font-family="Arial" font-size="10.00">EXPERT 5 L16</text>
<text text-anchor="middle" x="3522" y="-34867" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3522" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3522" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert5 -->
<g id="node725" class="node">
<title>layer16_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3632" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3632" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3632" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3632" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer16_moe_expert5&#45;&gt;layer16_moe_comm_from_expert5 -->
<g id="edge920" class="edge">
<title>layer16_moe_expert5&#45;&gt;layer16_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3613.75,-34837.69C3613.75,-34837.69 3613.75,-34811.5 3613.75,-34811.5"/>
<polygon fill="black" stroke="black" points="3617.25,-34811.5 3613.75,-34801.5 3610.25,-34811.5 3617.25,-34811.5"/>
</g>
<!-- layer16_moe_comm_to_expert5&#45;&gt;layer16_moe_expert5 -->
<g id="edge889" class="edge">
<title>layer16_moe_comm_to_expert5&#45;&gt;layer16_moe_expert5</title>
<path fill="none" stroke="black" d="M3738.26,-34954C3714.92,-34954 3696.25,-34954 3696.25,-34954 3696.25,-34954 3696.25,-34864 3696.25,-34864 3696.25,-34864 3695.24,-34864 3695.24,-34864"/>
<polygon fill="black" stroke="black" points="3696.13,-34860.5 3686.13,-34864 3696.13,-34867.5 3696.13,-34860.5"/>
</g>
<!-- layer16_moe_expert6 -->
<g id="node699" class="node">
<title>layer16_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="4032,-34890 3704,-34890 3704,-34838 4032,-34838 4032,-34890"/>
<text text-anchor="middle" x="3868" y="-34878" font-family="Arial" font-size="10.00">EXPERT 6 L16</text>
<text text-anchor="middle" x="3868" y="-34867" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3868" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3868" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert6 -->
<g id="node726" class="node">
<title>layer16_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3979" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3979" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3979" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3979" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer16_moe_expert6&#45;&gt;layer16_moe_comm_from_expert6 -->
<g id="edge922" class="edge">
<title>layer16_moe_expert6&#45;&gt;layer16_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3960.25,-34837.69C3960.25,-34837.69 3960.25,-34811.5 3960.25,-34811.5"/>
<polygon fill="black" stroke="black" points="3963.75,-34811.5 3960.25,-34801.5 3956.75,-34811.5 3963.75,-34811.5"/>
</g>
<!-- layer16_moe_comm_to_expert6&#45;&gt;layer16_moe_expert6 -->
<g id="edge891" class="edge">
<title>layer16_moe_comm_to_expert6&#45;&gt;layer16_moe_expert6</title>
<path fill="none" stroke="black" d="M3992.75,-34931.09C3992.75,-34931.09 3992.75,-34900.31 3992.75,-34900.31"/>
<polygon fill="black" stroke="black" points="3996.25,-34900.31 3992.75,-34890.31 3989.25,-34900.31 3996.25,-34900.31"/>
</g>
<!-- layer16_moe_expert7 -->
<g id="node701" class="node">
<title>layer16_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4378,-34890 4050,-34890 4050,-34838 4378,-34838 4378,-34890"/>
<text text-anchor="middle" x="4214" y="-34878" font-family="Arial" font-size="10.00">EXPERT 7 L16</text>
<text text-anchor="middle" x="4214" y="-34867" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4214" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4214" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert7 -->
<g id="node727" class="node">
<title>layer16_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4251" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4251" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4251" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4251" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer16_moe_expert7&#45;&gt;layer16_moe_comm_from_expert7 -->
<g id="edge924" class="edge">
<title>layer16_moe_expert7&#45;&gt;layer16_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4251,-34837.69C4251,-34837.69 4251,-34812.14 4251,-34812.14"/>
<polygon fill="black" stroke="black" points="4254.5,-34812.14 4251,-34802.14 4247.5,-34812.14 4254.5,-34812.14"/>
</g>
<!-- layer16_moe_comm_to_expert7&#45;&gt;layer16_moe_expert7 -->
<g id="edge893" class="edge">
<title>layer16_moe_comm_to_expert7&#45;&gt;layer16_moe_expert7</title>
<path fill="none" stroke="black" d="M4251,-34925.96C4251,-34925.96 4251,-34900.31 4251,-34900.31"/>
<polygon fill="black" stroke="black" points="4254.5,-34900.31 4251,-34890.31 4247.5,-34900.31 4254.5,-34900.31"/>
</g>
<!-- layer16_moe_expert8 -->
<g id="node703" class="node">
<title>layer16_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4724,-34890 4396,-34890 4396,-34838 4724,-34838 4724,-34890"/>
<text text-anchor="middle" x="4560" y="-34878" font-family="Arial" font-size="10.00">EXPERT 8 L16</text>
<text text-anchor="middle" x="4560" y="-34867" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4560" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4560" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert8 -->
<g id="node728" class="node">
<title>layer16_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4523" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4523" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4523" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4523" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer16_moe_expert8&#45;&gt;layer16_moe_comm_from_expert8 -->
<g id="edge926" class="edge">
<title>layer16_moe_expert8&#45;&gt;layer16_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4523,-34837.69C4523,-34837.69 4523,-34812.14 4523,-34812.14"/>
<polygon fill="black" stroke="black" points="4526.5,-34812.14 4523,-34802.14 4519.5,-34812.14 4526.5,-34812.14"/>
</g>
<!-- layer16_moe_comm_to_expert8&#45;&gt;layer16_moe_expert8 -->
<g id="edge895" class="edge">
<title>layer16_moe_comm_to_expert8&#45;&gt;layer16_moe_expert8</title>
<path fill="none" stroke="black" d="M4523,-34925.96C4523,-34925.96 4523,-34900.31 4523,-34900.31"/>
<polygon fill="black" stroke="black" points="4526.5,-34900.31 4523,-34890.31 4519.5,-34900.31 4526.5,-34900.31"/>
</g>
<!-- layer16_moe_expert9 -->
<g id="node705" class="node">
<title>layer16_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5070,-34890 4742,-34890 4742,-34838 5070,-34838 5070,-34890"/>
<text text-anchor="middle" x="4906" y="-34878" font-family="Arial" font-size="10.00">EXPERT 9 L16</text>
<text text-anchor="middle" x="4906" y="-34867" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4906" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4906" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert9 -->
<g id="node729" class="node">
<title>layer16_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4832" cy="-34773.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4832" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4832" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4832" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer16_moe_expert9&#45;&gt;layer16_moe_comm_from_expert9 -->
<g id="edge928" class="edge">
<title>layer16_moe_expert9&#45;&gt;layer16_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4832.25,-34837.69C4832.25,-34837.69 4832.25,-34812.14 4832.25,-34812.14"/>
<polygon fill="black" stroke="black" points="4835.75,-34812.14 4832.25,-34802.14 4828.75,-34812.14 4835.75,-34812.14"/>
</g>
<!-- layer16_moe_comm_to_expert9&#45;&gt;layer16_moe_expert9 -->
<g id="edge897" class="edge">
<title>layer16_moe_comm_to_expert9&#45;&gt;layer16_moe_expert9</title>
<path fill="none" stroke="black" d="M4832.25,-34925.96C4832.25,-34925.96 4832.25,-34900.31 4832.25,-34900.31"/>
<polygon fill="black" stroke="black" points="4835.75,-34900.31 4832.25,-34890.31 4828.75,-34900.31 4835.75,-34900.31"/>
</g>
<!-- layer16_moe_expert10 -->
<g id="node707" class="node">
<title>layer16_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5426,-34890 5088,-34890 5088,-34838 5426,-34838 5426,-34890"/>
<text text-anchor="middle" x="5257" y="-34878" font-family="Arial" font-size="10.00">EXPERT 10 L16</text>
<text text-anchor="middle" x="5257" y="-34867" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5257" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5257" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert10 -->
<g id="node730" class="node">
<title>layer16_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5164" cy="-34773.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5164" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5164" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5164" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer16_moe_expert10&#45;&gt;layer16_moe_comm_from_expert10 -->
<g id="edge930" class="edge">
<title>layer16_moe_expert10&#45;&gt;layer16_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5173.38,-34837.69C5173.38,-34837.69 5173.38,-34812.14 5173.38,-34812.14"/>
<polygon fill="black" stroke="black" points="5176.88,-34812.14 5173.38,-34802.14 5169.88,-34812.14 5176.88,-34812.14"/>
</g>
<!-- layer16_moe_comm_to_expert10&#45;&gt;layer16_moe_expert10 -->
<g id="edge899" class="edge">
<title>layer16_moe_comm_to_expert10&#45;&gt;layer16_moe_expert10</title>
<path fill="none" stroke="black" d="M5173.02,-34925.96C5173.02,-34925.96 5173.02,-34900.31 5173.02,-34900.31"/>
<polygon fill="black" stroke="black" points="5176.52,-34900.31 5173.02,-34890.31 5169.52,-34900.31 5176.52,-34900.31"/>
</g>
<!-- layer16_moe_expert11 -->
<g id="node709" class="node">
<title>layer16_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5782,-34890 5444,-34890 5444,-34838 5782,-34838 5782,-34890"/>
<text text-anchor="middle" x="5613" y="-34878" font-family="Arial" font-size="10.00">EXPERT 11 L16</text>
<text text-anchor="middle" x="5613" y="-34867" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5613" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5613" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert11 -->
<g id="node731" class="node">
<title>layer16_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5511" cy="-34773.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5511" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5511" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5511" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer16_moe_expert11&#45;&gt;layer16_moe_comm_from_expert11 -->
<g id="edge932" class="edge">
<title>layer16_moe_expert11&#45;&gt;layer16_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5524.88,-34837.69C5524.88,-34837.69 5524.88,-34811.82 5524.88,-34811.82"/>
<polygon fill="black" stroke="black" points="5528.38,-34811.82 5524.88,-34801.82 5521.38,-34811.82 5528.38,-34811.82"/>
</g>
<!-- layer16_moe_comm_to_expert11&#45;&gt;layer16_moe_expert11 -->
<g id="edge901" class="edge">
<title>layer16_moe_comm_to_expert11&#45;&gt;layer16_moe_expert11</title>
<path fill="none" stroke="black" d="M5524.02,-34926.21C5524.02,-34926.21 5524.02,-34900.14 5524.02,-34900.14"/>
<polygon fill="black" stroke="black" points="5527.52,-34900.14 5524.02,-34890.14 5520.52,-34900.14 5527.52,-34900.14"/>
</g>
<!-- layer16_moe_expert12 -->
<g id="node711" class="node">
<title>layer16_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6138,-34890 5800,-34890 5800,-34838 6138,-34838 6138,-34890"/>
<text text-anchor="middle" x="5969" y="-34878" font-family="Arial" font-size="10.00">EXPERT 12 L16</text>
<text text-anchor="middle" x="5969" y="-34867" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5969" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5969" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert12 -->
<g id="node732" class="node">
<title>layer16_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5862" cy="-34773.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5862" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5862" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5862" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer16_moe_expert12&#45;&gt;layer16_moe_comm_from_expert12 -->
<g id="edge934" class="edge">
<title>layer16_moe_expert12&#45;&gt;layer16_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5878.38,-34837.69C5878.38,-34837.69 5878.38,-34811.82 5878.38,-34811.82"/>
<polygon fill="black" stroke="black" points="5881.88,-34811.82 5878.38,-34801.82 5874.88,-34811.82 5881.88,-34811.82"/>
</g>
<!-- layer16_moe_comm_to_expert12&#45;&gt;layer16_moe_expert12 -->
<g id="edge903" class="edge">
<title>layer16_moe_comm_to_expert12&#45;&gt;layer16_moe_expert12</title>
<path fill="none" stroke="black" d="M5877.52,-34926.21C5877.52,-34926.21 5877.52,-34900.14 5877.52,-34900.14"/>
<polygon fill="black" stroke="black" points="5881.02,-34900.14 5877.52,-34890.14 5874.02,-34900.14 5881.02,-34900.14"/>
</g>
<!-- layer16_moe_expert13 -->
<g id="node713" class="node">
<title>layer16_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6494,-34890 6156,-34890 6156,-34838 6494,-34838 6494,-34890"/>
<text text-anchor="middle" x="6325" y="-34878" font-family="Arial" font-size="10.00">EXPERT 13 L16</text>
<text text-anchor="middle" x="6325" y="-34867" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6325" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6325" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert13 -->
<g id="node733" class="node">
<title>layer16_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6216" cy="-34773.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6216" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6216" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6216" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer16_moe_expert13&#45;&gt;layer16_moe_comm_from_expert13 -->
<g id="edge936" class="edge">
<title>layer16_moe_expert13&#45;&gt;layer16_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6233.38,-34837.69C6233.38,-34837.69 6233.38,-34811.82 6233.38,-34811.82"/>
<polygon fill="black" stroke="black" points="6236.88,-34811.82 6233.38,-34801.82 6229.88,-34811.82 6236.88,-34811.82"/>
</g>
<!-- layer16_moe_comm_to_expert13&#45;&gt;layer16_moe_expert13 -->
<g id="edge905" class="edge">
<title>layer16_moe_comm_to_expert13&#45;&gt;layer16_moe_expert13</title>
<path fill="none" stroke="black" d="M6232.02,-34926.21C6232.02,-34926.21 6232.02,-34900.14 6232.02,-34900.14"/>
<polygon fill="black" stroke="black" points="6235.52,-34900.14 6232.02,-34890.14 6228.52,-34900.14 6235.52,-34900.14"/>
</g>
<!-- layer16_moe_expert14 -->
<g id="node715" class="node">
<title>layer16_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6850,-34890 6512,-34890 6512,-34838 6850,-34838 6850,-34890"/>
<text text-anchor="middle" x="6681" y="-34878" font-family="Arial" font-size="10.00">EXPERT 14 L16</text>
<text text-anchor="middle" x="6681" y="-34867" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6681" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6681" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert14 -->
<g id="node734" class="node">
<title>layer16_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6571" cy="-34773.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6571" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6571" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6571" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer16_moe_expert14&#45;&gt;layer16_moe_comm_from_expert14 -->
<g id="edge938" class="edge">
<title>layer16_moe_expert14&#45;&gt;layer16_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6588.88,-34837.69C6588.88,-34837.69 6588.88,-34811.5 6588.88,-34811.5"/>
<polygon fill="black" stroke="black" points="6592.38,-34811.5 6588.88,-34801.5 6585.38,-34811.5 6592.38,-34811.5"/>
</g>
<!-- layer16_moe_comm_to_expert14&#45;&gt;layer16_moe_expert14 -->
<g id="edge907" class="edge">
<title>layer16_moe_comm_to_expert14&#45;&gt;layer16_moe_expert14</title>
<path fill="none" stroke="black" d="M6587.52,-34926.21C6587.52,-34926.21 6587.52,-34900.14 6587.52,-34900.14"/>
<polygon fill="black" stroke="black" points="6591.02,-34900.14 6587.52,-34890.14 6584.02,-34900.14 6591.02,-34900.14"/>
</g>
<!-- layer16_moe_expert15 -->
<g id="node717" class="node">
<title>layer16_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7206,-34890 6868,-34890 6868,-34838 7206,-34838 7206,-34890"/>
<text text-anchor="middle" x="7037" y="-34878" font-family="Arial" font-size="10.00">EXPERT 15 L16</text>
<text text-anchor="middle" x="7037" y="-34867" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7037" y="-34856" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7037" y="-34845" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_comm_from_expert15 -->
<g id="node735" class="node">
<title>layer16_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6926" cy="-34773.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6926" y="-34781.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6926" y="-34770.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6926" y="-34759.51" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer16_moe_expert15&#45;&gt;layer16_moe_comm_from_expert15 -->
<g id="edge940" class="edge">
<title>layer16_moe_expert15&#45;&gt;layer16_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6944.38,-34837.69C6944.38,-34837.69 6944.38,-34811.5 6944.38,-34811.5"/>
<polygon fill="black" stroke="black" points="6947.88,-34811.5 6944.38,-34801.5 6940.88,-34811.5 6947.88,-34811.5"/>
</g>
<!-- layer16_moe_comm_to_expert15&#45;&gt;layer16_moe_expert15 -->
<g id="edge909" class="edge">
<title>layer16_moe_comm_to_expert15&#45;&gt;layer16_moe_expert15</title>
<path fill="none" stroke="black" d="M6943.02,-34926.21C6943.02,-34926.21 6943.02,-34900.14 6943.02,-34900.14"/>
<polygon fill="black" stroke="black" points="6946.52,-34900.14 6943.02,-34890.14 6939.52,-34900.14 6946.52,-34900.14"/>
</g>
<!-- layer16_moe_aggregate -->
<g id="node719" class="node">
<title>layer16_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4612.1,-34708.02 4195.16,-34708.02 4087.9,-34604.02 4504.84,-34604.02 4612.1,-34708.02"/>
<text text-anchor="middle" x="4350" y="-34670.02" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L16</text>
<text text-anchor="middle" x="4350" y="-34659.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4350" y="-34648.02" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4350" y="-34637.02" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_mha -->
<g id="node736" class="node">
<title>layer17_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4480,-34568.02 4220,-34568.02 4220,-34516.02 4480,-34516.02 4480,-34568.02"/>
<text text-anchor="middle" x="4350" y="-34556.02" font-family="Arial" font-size="10.00">MHA L17</text>
<text text-anchor="middle" x="4350" y="-34545.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4350" y="-34534.02" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4350" y="-34523.02" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer16_moe_aggregate&#45;&gt;layer17_moe_mha -->
<g id="edge1009" class="edge">
<title>layer16_moe_aggregate&#45;&gt;layer17_moe_mha</title>
<path fill="none" stroke="black" d="M4350,-34603.69C4350,-34603.69 4350,-34578.25 4350,-34578.25"/>
<polygon fill="black" stroke="black" points="4353.5,-34578.25 4350,-34568.25 4346.5,-34578.25 4353.5,-34578.25"/>
</g>
<!-- layer16_moe_comm_from_expert0&#45;&gt;layer16_moe_aggregate -->
<g id="edge911" class="edge">
<title>layer16_moe_comm_from_expert0&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M1983.25,-34747.42C1983.25,-34703.39 1983.25,-34618 1983.25,-34618 1983.25,-34618 4092.3,-34618 4092.3,-34618"/>
<polygon fill="black" stroke="black" points="4092.3,-34621.5 4102.3,-34618 4092.3,-34614.5 4092.3,-34621.5"/>
</g>
<!-- layer16_moe_comm_from_expert1&#45;&gt;layer16_moe_aggregate -->
<g id="edge913" class="edge">
<title>layer16_moe_comm_from_expert1&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M2294.01,-34761.08C2294.01,-34727.22 2294.01,-34633 2294.01,-34633 2294.01,-34633 4107.65,-34633 4107.65,-34633"/>
<polygon fill="black" stroke="black" points="4107.65,-34636.5 4117.65,-34633 4107.65,-34629.5 4107.65,-34636.5"/>
</g>
<!-- layer16_moe_comm_from_expert2&#45;&gt;layer16_moe_aggregate -->
<g id="edge915" class="edge">
<title>layer16_moe_comm_from_expert2&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M2656.75,-34752.09C2656.75,-34716.5 2656.75,-34648 2656.75,-34648 2656.75,-34648 4122.97,-34648 4122.97,-34648"/>
<polygon fill="black" stroke="black" points="4122.97,-34651.5 4132.97,-34648 4122.97,-34644.5 4122.97,-34651.5"/>
</g>
<!-- layer16_moe_comm_from_expert3&#45;&gt;layer16_moe_aggregate -->
<g id="edge917" class="edge">
<title>layer16_moe_comm_from_expert3&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M3048.01,-34746.1C3048.01,-34713.53 3048.01,-34663 3048.01,-34663 3048.01,-34663 4138.71,-34663 4138.71,-34663"/>
<polygon fill="black" stroke="black" points="4138.71,-34666.5 4148.71,-34663 4138.71,-34659.5 4138.71,-34666.5"/>
</g>
<!-- layer16_moe_comm_from_expert4&#45;&gt;layer16_moe_aggregate -->
<g id="edge919" class="edge">
<title>layer16_moe_comm_from_expert4&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M3412,-34749.04C3412,-34720.89 3412,-34678 3412,-34678 3412,-34678 4154.12,-34678 4154.12,-34678"/>
<polygon fill="black" stroke="black" points="4154.12,-34681.5 4164.12,-34678 4154.12,-34674.5 4154.12,-34681.5"/>
</g>
<!-- layer16_moe_comm_from_expert5&#45;&gt;layer16_moe_aggregate -->
<g id="edge921" class="edge">
<title>layer16_moe_comm_from_expert5&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M3661.5,-34745.48C3661.5,-34722.33 3661.5,-34693 3661.5,-34693 3661.5,-34693 4169.37,-34693 4169.37,-34693"/>
<polygon fill="black" stroke="black" points="4169.37,-34696.5 4179.37,-34693 4169.37,-34689.5 4169.37,-34696.5"/>
</g>
<!-- layer16_moe_comm_from_expert6&#45;&gt;layer16_moe_aggregate -->
<g id="edge923" class="edge">
<title>layer16_moe_comm_from_expert6&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M4069.65,-34773C4098.98,-34773 4124.1,-34773 4124.1,-34773 4124.1,-34773 4124.1,-34666.11 4124.1,-34666.11"/>
<polygon fill="black" stroke="black" points="4127.6,-34666.11 4124.1,-34656.11 4120.6,-34666.11 4127.6,-34666.11"/>
</g>
<!-- layer16_moe_comm_from_expert7&#45;&gt;layer16_moe_aggregate -->
<g id="edge925" class="edge">
<title>layer16_moe_comm_from_expert7&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M4251,-34743.79C4251,-34743.79 4251,-34718.08 4251,-34718.08"/>
<polygon fill="black" stroke="black" points="4254.5,-34718.08 4251,-34708.08 4247.5,-34718.08 4254.5,-34718.08"/>
</g>
<!-- layer16_moe_comm_from_expert8&#45;&gt;layer16_moe_aggregate -->
<g id="edge927" class="edge">
<title>layer16_moe_comm_from_expert8&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M4522.39,-34743.79C4522.39,-34743.79 4522.39,-34718.08 4522.39,-34718.08"/>
<polygon fill="black" stroke="black" points="4525.89,-34718.08 4522.39,-34708.08 4518.89,-34718.08 4525.89,-34718.08"/>
</g>
<!-- layer16_moe_comm_from_expert9&#45;&gt;layer16_moe_aggregate -->
<g id="edge929" class="edge">
<title>layer16_moe_comm_from_expert9&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M4813.5,-34744.41C4813.5,-34722.14 4813.5,-34695 4813.5,-34695 4813.5,-34695 4608.71,-34695 4608.71,-34695"/>
<polygon fill="black" stroke="black" points="4608.71,-34691.5 4598.71,-34695 4608.71,-34698.5 4608.71,-34691.5"/>
</g>
<!-- layer16_moe_comm_from_expert10&#45;&gt;layer16_moe_aggregate -->
<g id="edge931" class="edge">
<title>layer16_moe_comm_from_expert10&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M5145.15,-34744.22C5145.15,-34717.55 5145.15,-34682 5145.15,-34682 5145.15,-34682 4595.34,-34682 4595.34,-34682"/>
<polygon fill="black" stroke="black" points="4595.34,-34678.5 4585.34,-34682 4595.34,-34685.5 4595.34,-34678.5"/>
</g>
<!-- layer16_moe_comm_from_expert11&#45;&gt;layer16_moe_aggregate -->
<g id="edge933" class="edge">
<title>layer16_moe_comm_from_expert11&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M5491.65,-34744.59C5491.65,-34713.79 5491.65,-34669 5491.65,-34669 5491.65,-34669 4582.15,-34669 4582.15,-34669"/>
<polygon fill="black" stroke="black" points="4582.15,-34665.5 4572.15,-34669 4582.15,-34672.5 4582.15,-34665.5"/>
</g>
<!-- layer16_moe_comm_from_expert12&#45;&gt;layer16_moe_aggregate -->
<g id="edge935" class="edge">
<title>layer16_moe_comm_from_expert12&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M5842.65,-34744.39C5842.65,-34709.75 5842.65,-34656 5842.65,-34656 5842.65,-34656 4568.72,-34656 4568.72,-34656"/>
<polygon fill="black" stroke="black" points="4568.72,-34652.5 4558.72,-34656 4568.72,-34659.5 4568.72,-34652.5"/>
</g>
<!-- layer16_moe_comm_from_expert13&#45;&gt;layer16_moe_aggregate -->
<g id="edge937" class="edge">
<title>layer16_moe_comm_from_expert13&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M6196.15,-34744.48C6196.15,-34706.21 6196.15,-34643 6196.15,-34643 6196.15,-34643 4555.39,-34643 4555.39,-34643"/>
<polygon fill="black" stroke="black" points="4555.39,-34639.5 4545.39,-34643 4555.39,-34646.5 4555.39,-34639.5"/>
</g>
<!-- layer16_moe_comm_from_expert14&#45;&gt;layer16_moe_aggregate -->
<g id="edge939" class="edge">
<title>layer16_moe_comm_from_expert14&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M6551.15,-34744.42C6551.15,-34702.68 6551.15,-34630 6551.15,-34630 6551.15,-34630 4542,-34630 4542,-34630"/>
<polygon fill="black" stroke="black" points="4542,-34626.5 4532,-34630 4542,-34633.5 4542,-34626.5"/>
</g>
<!-- layer16_moe_comm_from_expert15&#45;&gt;layer16_moe_aggregate -->
<g id="edge941" class="edge">
<title>layer16_moe_comm_from_expert15&#45;&gt;layer16_moe_aggregate</title>
<path fill="none" stroke="black" d="M6906.15,-34744.4C6906.15,-34699.36 6906.15,-34617 6906.15,-34617 6906.15,-34617 4528.7,-34617 4528.7,-34617"/>
<polygon fill="black" stroke="black" points="4528.7,-34613.5 4518.7,-34617 4528.7,-34620.5 4528.7,-34613.5"/>
</g>
<!-- layer17_moe_gate -->
<g id="node737" class="node">
<title>layer17_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4608.3,-34480.02 4197.4,-34480.02 4091.7,-34376.02 4502.6,-34376.02 4608.3,-34480.02"/>
<text text-anchor="middle" x="4350" y="-34442.02" font-family="Arial" font-size="10.00">GATE L17</text>
<text text-anchor="middle" x="4350" y="-34431.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4350" y="-34420.02" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4350" y="-34409.02" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer17_moe_mha&#45;&gt;layer17_moe_gate -->
<g id="edge1010" class="edge">
<title>layer17_moe_mha&#45;&gt;layer17_moe_gate</title>
<path fill="none" stroke="black" d="M4350,-34515.87C4350,-34515.87 4350,-34490.12 4350,-34490.12"/>
<polygon fill="black" stroke="black" points="4353.5,-34490.12 4350,-34480.12 4346.5,-34490.12 4353.5,-34490.12"/>
</g>
<!-- layer17_moe_split -->
<g id="node738" class="node">
<title>layer17_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4604.01,-34340.02 4199.94,-34340.02 4095.99,-34236.02 4500.06,-34236.02 4604.01,-34340.02"/>
<text text-anchor="middle" x="4350" y="-34302.02" font-family="Arial" font-size="10.00">SPLIT TOKENS L17</text>
<text text-anchor="middle" x="4350" y="-34291.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4350" y="-34280.02" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4350" y="-34269.02" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer17_moe_gate&#45;&gt;layer17_moe_split -->
<g id="edge1011" class="edge">
<title>layer17_moe_gate&#45;&gt;layer17_moe_split</title>
<path fill="none" stroke="black" d="M4350,-34375.89C4350,-34375.89 4350,-34350.2 4350,-34350.2"/>
<polygon fill="black" stroke="black" points="4353.5,-34350.2 4350,-34340.2 4346.5,-34350.2 4353.5,-34350.2"/>
</g>
<!-- layer17_moe_comm_to_expert0 -->
<g id="node740" class="node">
<title>layer17_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2196" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2196" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2196" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2196" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert0 -->
<g id="edge945" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4184.69,-34325C3681.63,-34325 2203.5,-34325 2203.5,-34325 2203.5,-34325 2203.5,-34209.99 2203.5,-34209.99"/>
<polygon fill="black" stroke="black" points="2207,-34209.99 2203.5,-34199.99 2200,-34209.99 2207,-34209.99"/>
</g>
<!-- layer17_moe_comm_to_expert1 -->
<g id="node742" class="node">
<title>layer17_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2482" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2482" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2482" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2482" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert1 -->
<g id="edge947" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4169.63,-34310C3711.31,-34310 2538,-34310 2538,-34310 2538,-34310 2538,-34203.98 2538,-34203.98"/>
<polygon fill="black" stroke="black" points="2541.5,-34203.98 2538,-34193.98 2534.5,-34203.98 2541.5,-34203.98"/>
</g>
<!-- layer17_moe_comm_to_expert2 -->
<g id="node744" class="node">
<title>layer17_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2901" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2901" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2901" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2901" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert2 -->
<g id="edge949" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4154.91,-34295C3771.68,-34295 2957.5,-34295 2957.5,-34295 2957.5,-34295 2957.5,-34203.77 2957.5,-34203.77"/>
<polygon fill="black" stroke="black" points="2961,-34203.77 2957.5,-34193.77 2954,-34203.77 2961,-34203.77"/>
</g>
<!-- layer17_moe_comm_to_expert3 -->
<g id="node746" class="node">
<title>layer17_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3210" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3210" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3210" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3210" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert3 -->
<g id="edge951" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4139.91,-34280C3829.59,-34280 3285,-34280 3285,-34280 3285,-34280 3285,-34197.58 3285,-34197.58"/>
<polygon fill="black" stroke="black" points="3288.5,-34197.58 3285,-34187.58 3281.5,-34197.58 3288.5,-34197.58"/>
</g>
<!-- layer17_moe_comm_to_expert4 -->
<g id="node748" class="node">
<title>layer17_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3464" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3464" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3464" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3464" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert4 -->
<g id="edge953" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4124.73,-34265C3887.51,-34265 3548,-34265 3548,-34265 3548,-34265 3548,-34192.18 3548,-34192.18"/>
<polygon fill="black" stroke="black" points="3551.5,-34192.18 3548,-34182.18 3544.5,-34192.18 3551.5,-34192.18"/>
</g>
<!-- layer17_moe_comm_to_expert5 -->
<g id="node750" class="node">
<title>layer17_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3691" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3691" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3691" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3691" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert5 -->
<g id="edge955" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4109.79,-34250C3943.52,-34250 3752.01,-34250 3752.01,-34250 3752.01,-34250 3752.01,-34202.61 3752.01,-34202.61"/>
<polygon fill="black" stroke="black" points="3755.51,-34202.61 3752.01,-34192.61 3748.51,-34202.61 3755.51,-34202.61"/>
</g>
<!-- layer17_moe_comm_to_expert6 -->
<g id="node752" class="node">
<title>layer17_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3904" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3904" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3904" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3904" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert6 -->
<g id="edge957" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4109.74,-34287.94C4109.74,-34284.39 4109.74,-34171 4109.74,-34171 4109.74,-34171 4004.54,-34171 4004.54,-34171"/>
<polygon fill="black" stroke="black" points="4004.54,-34167.5 3994.54,-34171 4004.54,-34174.5 4004.54,-34167.5"/>
</g>
<!-- layer17_moe_comm_to_expert7 -->
<g id="node754" class="node">
<title>layer17_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4214" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4214" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4214" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4214" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert7 -->
<g id="edge959" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4214,-34235.69C4214,-34235.69 4214,-34210.24 4214,-34210.24"/>
<polygon fill="black" stroke="black" points="4217.5,-34210.24 4214,-34200.24 4210.5,-34210.24 4217.5,-34210.24"/>
</g>
<!-- layer17_moe_comm_to_expert8 -->
<g id="node756" class="node">
<title>layer17_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4486" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4486" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4486" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4486" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert8 -->
<g id="edge961" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4486,-34235.69C4486,-34235.69 4486,-34210.24 4486,-34210.24"/>
<polygon fill="black" stroke="black" points="4489.5,-34210.24 4486,-34200.24 4482.5,-34210.24 4489.5,-34210.24"/>
</g>
<!-- layer17_moe_comm_to_expert9 -->
<g id="node758" class="node">
<title>layer17_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4795" cy="-34171.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4795" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4795" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4795" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert9 -->
<g id="edge963" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4590.26,-34287.94C4590.26,-34284.39 4590.26,-34171 4590.26,-34171 4590.26,-34171 4694.3,-34171 4694.3,-34171"/>
<polygon fill="black" stroke="black" points="4694.3,-34174.5 4704.3,-34171 4694.3,-34167.5 4694.3,-34174.5"/>
</g>
<!-- layer17_moe_comm_to_expert10 -->
<g id="node760" class="node">
<title>layer17_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5127" cy="-34171.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5127" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5127" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5127" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert10 -->
<g id="edge965" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4514.38,-34250C4721.6,-34250 5051.1,-34250 5051.1,-34250 5051.1,-34250 5051.1,-34198.17 5051.1,-34198.17"/>
<polygon fill="black" stroke="black" points="5054.6,-34198.17 5051.1,-34188.17 5047.6,-34198.17 5054.6,-34198.17"/>
</g>
<!-- layer17_moe_comm_to_expert11 -->
<g id="node762" class="node">
<title>layer17_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5473" cy="-34171.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5473" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5473" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5473" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert11 -->
<g id="edge967" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4529.2,-34265C4828.48,-34265 5397.6,-34265 5397.6,-34265 5397.6,-34265 5397.6,-34198.71 5397.6,-34198.71"/>
<polygon fill="black" stroke="black" points="5401.1,-34198.71 5397.6,-34188.71 5394.1,-34198.71 5401.1,-34198.71"/>
</g>
<!-- layer17_moe_comm_to_expert12 -->
<g id="node764" class="node">
<title>layer17_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5824" cy="-34171.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5824" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5824" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5824" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert12 -->
<g id="edge969" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4544.1,-34280C4928.24,-34280 5748.6,-34280 5748.6,-34280 5748.6,-34280 5748.6,-34198.54 5748.6,-34198.54"/>
<polygon fill="black" stroke="black" points="5752.1,-34198.54 5748.6,-34188.54 5745.1,-34198.54 5752.1,-34198.54"/>
</g>
<!-- layer17_moe_comm_to_expert13 -->
<g id="node766" class="node">
<title>layer17_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6177" cy="-34171.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6177" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6177" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6177" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert13 -->
<g id="edge971" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4559.17,-34295C5024,-34295 6102.1,-34295 6102.1,-34295 6102.1,-34295 6102.1,-34198.79 6102.1,-34198.79"/>
<polygon fill="black" stroke="black" points="6105.6,-34198.79 6102.1,-34188.79 6098.6,-34198.79 6105.6,-34198.79"/>
</g>
<!-- layer17_moe_comm_to_expert14 -->
<g id="node768" class="node">
<title>layer17_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6532" cy="-34171.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6532" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6532" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6532" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert14 -->
<g id="edge973" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4574.5,-34310C5117.43,-34310 6457.1,-34310 6457.1,-34310 6457.1,-34310 6457.1,-34198.63 6457.1,-34198.63"/>
<polygon fill="black" stroke="black" points="6460.6,-34198.63 6457.1,-34188.63 6453.6,-34198.63 6460.6,-34198.63"/>
</g>
<!-- layer17_moe_comm_to_expert15 -->
<g id="node770" class="node">
<title>layer17_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6887" cy="-34171.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6887" y="-34179.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6887" y="-34168.53" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6887" y="-34157.53" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert15 -->
<g id="edge975" class="edge">
<title>layer17_moe_split&#45;&gt;layer17_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4589.15,-34325C5207.66,-34325 6812.1,-34325 6812.1,-34325 6812.1,-34325 6812.1,-34198.69 6812.1,-34198.69"/>
<polygon fill="black" stroke="black" points="6815.6,-34198.69 6812.1,-34188.69 6808.6,-34198.69 6815.6,-34198.69"/>
</g>
<!-- layer17_moe_expert0 -->
<g id="node739" class="node">
<title>layer17_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1919,-34106.04 1591,-34106.04 1591,-34054.04 1919,-34054.04 1919,-34106.04"/>
<text text-anchor="middle" x="1755" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 0 L17</text>
<text text-anchor="middle" x="1755" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1755" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1755" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert0 -->
<g id="node772" class="node">
<title>layer17_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1939" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1939" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1939" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1939" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer17_moe_expert0&#45;&gt;layer17_moe_comm_from_expert0 -->
<g id="edge977" class="edge">
<title>layer17_moe_expert0&#45;&gt;layer17_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1883.75,-34053.72C1883.75,-34053.72 1883.75,-34022.21 1883.75,-34022.21"/>
<polygon fill="black" stroke="black" points="1887.25,-34022.21 1883.75,-34012.21 1880.25,-34022.21 1887.25,-34022.21"/>
</g>
<!-- layer17_moe_comm_to_expert0&#45;&gt;layer17_moe_expert0 -->
<g id="edge946" class="edge">
<title>layer17_moe_comm_to_expert0&#45;&gt;layer17_moe_expert0</title>
<path fill="none" stroke="black" d="M2105.26,-34171C2013.07,-34171 1883.75,-34171 1883.75,-34171 1883.75,-34171 1883.75,-34116.35 1883.75,-34116.35"/>
<polygon fill="black" stroke="black" points="1887.25,-34116.35 1883.75,-34106.35 1880.25,-34116.35 1887.25,-34116.35"/>
</g>
<!-- layer17_moe_expert1 -->
<g id="node741" class="node">
<title>layer17_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2265,-34106.04 1937,-34106.04 1937,-34054.04 2265,-34054.04 2265,-34106.04"/>
<text text-anchor="middle" x="2101" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 1 L17</text>
<text text-anchor="middle" x="2101" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2101" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2101" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert1 -->
<g id="node773" class="node">
<title>layer17_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2211" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2211" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2211" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2211" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer17_moe_expert1&#45;&gt;layer17_moe_comm_from_expert1 -->
<g id="edge979" class="edge">
<title>layer17_moe_expert1&#45;&gt;layer17_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2192.75,-34053.72C2192.75,-34053.72 2192.75,-34027.53 2192.75,-34027.53"/>
<polygon fill="black" stroke="black" points="2196.25,-34027.53 2192.75,-34017.53 2189.25,-34027.53 2196.25,-34027.53"/>
</g>
<!-- layer17_moe_comm_to_expert1&#45;&gt;layer17_moe_expert1 -->
<g id="edge948" class="edge">
<title>layer17_moe_comm_to_expert1&#45;&gt;layer17_moe_expert1</title>
<path fill="none" stroke="black" d="M2482,-34142.03C2482,-34129.65 2482,-34118 2482,-34118 2482,-34118 2185.25,-34118 2185.25,-34118 2185.25,-34118 2185.25,-34116.4 2185.25,-34116.4"/>
<polygon fill="black" stroke="black" points="2188.75,-34116.4 2185.25,-34106.4 2181.75,-34116.4 2188.75,-34116.4"/>
</g>
<!-- layer17_moe_expert2 -->
<g id="node743" class="node">
<title>layer17_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2611,-34106.04 2283,-34106.04 2283,-34054.04 2611,-34054.04 2611,-34106.04"/>
<text text-anchor="middle" x="2447" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 2 L17</text>
<text text-anchor="middle" x="2447" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2447" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2447" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert2 -->
<g id="node774" class="node">
<title>layer17_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2622" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2622" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2622" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2622" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer17_moe_expert2&#45;&gt;layer17_moe_comm_from_expert2 -->
<g id="edge981" class="edge">
<title>layer17_moe_expert2&#45;&gt;layer17_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2571.25,-34053.72C2571.25,-34053.72 2571.25,-34023.13 2571.25,-34023.13"/>
<polygon fill="black" stroke="black" points="2574.75,-34023.13 2571.25,-34013.13 2567.75,-34023.13 2574.75,-34023.13"/>
</g>
<!-- layer17_moe_comm_to_expert2&#45;&gt;layer17_moe_expert2 -->
<g id="edge950" class="edge">
<title>layer17_moe_comm_to_expert2&#45;&gt;layer17_moe_expert2</title>
<path fill="none" stroke="black" d="M2810.31,-34171C2719.06,-34171 2591.75,-34171 2591.75,-34171 2591.75,-34171 2591.75,-34116.35 2591.75,-34116.35"/>
<polygon fill="black" stroke="black" points="2595.25,-34116.35 2591.75,-34106.35 2588.25,-34116.35 2595.25,-34116.35"/>
</g>
<!-- layer17_moe_expert3 -->
<g id="node745" class="node">
<title>layer17_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2957,-34106.04 2629,-34106.04 2629,-34054.04 2957,-34054.04 2957,-34106.04"/>
<text text-anchor="middle" x="2793" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 3 L17</text>
<text text-anchor="middle" x="2793" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2793" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2793" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert3 -->
<g id="node775" class="node">
<title>layer17_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2894" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2894" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2894" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2894" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer17_moe_expert3&#45;&gt;layer17_moe_comm_from_expert3 -->
<g id="edge983" class="edge">
<title>layer17_moe_expert3&#45;&gt;layer17_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2880.25,-34053.72C2880.25,-34053.72 2880.25,-34027.86 2880.25,-34027.86"/>
<polygon fill="black" stroke="black" points="2883.75,-34027.86 2880.25,-34017.86 2876.75,-34027.86 2883.75,-34027.86"/>
</g>
<!-- layer17_moe_comm_to_expert3&#45;&gt;layer17_moe_expert3 -->
<g id="edge952" class="edge">
<title>layer17_moe_comm_to_expert3&#45;&gt;layer17_moe_expert3</title>
<path fill="none" stroke="black" d="M3210,-34141.65C3210,-34135.07 3210,-34130 3210,-34130 3210,-34130 2883.75,-34130 2883.75,-34130 2883.75,-34130 2883.75,-34116.19 2883.75,-34116.19"/>
<polygon fill="black" stroke="black" points="2887.25,-34116.19 2883.75,-34106.19 2880.25,-34116.19 2887.25,-34116.19"/>
</g>
<!-- layer17_moe_expert4 -->
<g id="node747" class="node">
<title>layer17_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3303,-34106.04 2975,-34106.04 2975,-34054.04 3303,-34054.04 3303,-34106.04"/>
<text text-anchor="middle" x="3139" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 4 L17</text>
<text text-anchor="middle" x="3139" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3139" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3139" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert4 -->
<g id="node776" class="node">
<title>layer17_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3232" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3232" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3232" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3232" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer17_moe_expert4&#45;&gt;layer17_moe_comm_from_expert4 -->
<g id="edge985" class="edge">
<title>layer17_moe_expert4&#45;&gt;layer17_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3222.25,-34053.72C3222.25,-34053.72 3222.25,-34028.18 3222.25,-34028.18"/>
<polygon fill="black" stroke="black" points="3225.75,-34028.18 3222.25,-34018.18 3218.75,-34028.18 3225.75,-34028.18"/>
</g>
<!-- layer17_moe_comm_to_expert4&#45;&gt;layer17_moe_expert4 -->
<g id="edge954" class="edge">
<title>layer17_moe_comm_to_expert4&#45;&gt;layer17_moe_expert4</title>
<path fill="none" stroke="black" d="M3373.39,-34171C3340.83,-34171 3312,-34171 3312,-34171 3312,-34171 3312,-34080 3312,-34080 3312,-34080 3311.12,-34080 3311.12,-34080"/>
<polygon fill="black" stroke="black" points="3313.18,-34076.5 3303.18,-34080 3313.18,-34083.5 3313.18,-34076.5"/>
</g>
<!-- layer17_moe_expert5 -->
<g id="node749" class="node">
<title>layer17_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3649,-34106.04 3321,-34106.04 3321,-34054.04 3649,-34054.04 3649,-34106.04"/>
<text text-anchor="middle" x="3485" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 5 L17</text>
<text text-anchor="middle" x="3485" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3485" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3485" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert5 -->
<g id="node777" class="node">
<title>layer17_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3651" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3651" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3651" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3651" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer17_moe_expert5&#45;&gt;layer17_moe_comm_from_expert5 -->
<g id="edge987" class="edge">
<title>layer17_moe_expert5&#45;&gt;layer17_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3604.75,-34053.72C3604.75,-34053.72 3604.75,-34024.06 3604.75,-34024.06"/>
<polygon fill="black" stroke="black" points="3608.25,-34024.06 3604.75,-34014.06 3601.25,-34024.06 3608.25,-34024.06"/>
</g>
<!-- layer17_moe_comm_to_expert5&#45;&gt;layer17_moe_expert5 -->
<g id="edge956" class="edge">
<title>layer17_moe_comm_to_expert5&#45;&gt;layer17_moe_expert5</title>
<path fill="none" stroke="black" d="M3624.75,-34150.84C3624.75,-34150.84 3624.75,-34116.06 3624.75,-34116.06"/>
<polygon fill="black" stroke="black" points="3628.25,-34116.06 3624.75,-34106.06 3621.25,-34116.06 3628.25,-34116.06"/>
</g>
<!-- layer17_moe_expert6 -->
<g id="node751" class="node">
<title>layer17_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3995,-34106.04 3667,-34106.04 3667,-34054.04 3995,-34054.04 3995,-34106.04"/>
<text text-anchor="middle" x="3831" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 6 L17</text>
<text text-anchor="middle" x="3831" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3831" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3831" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert6 -->
<g id="node778" class="node">
<title>layer17_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3960" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3960" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3960" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3960" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer17_moe_expert6&#45;&gt;layer17_moe_comm_from_expert6 -->
<g id="edge989" class="edge">
<title>layer17_moe_expert6&#45;&gt;layer17_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3932.25,-34053.72C3932.25,-34053.72 3932.25,-34026.89 3932.25,-34026.89"/>
<polygon fill="black" stroke="black" points="3935.75,-34026.89 3932.25,-34016.89 3928.75,-34026.89 3935.75,-34026.89"/>
</g>
<!-- layer17_moe_comm_to_expert6&#45;&gt;layer17_moe_expert6 -->
<g id="edge958" class="edge">
<title>layer17_moe_comm_to_expert6&#45;&gt;layer17_moe_expert6</title>
<path fill="none" stroke="black" d="M3904,-34141.99C3904,-34141.99 3904,-34116.34 3904,-34116.34"/>
<polygon fill="black" stroke="black" points="3907.5,-34116.34 3904,-34106.34 3900.5,-34116.34 3907.5,-34116.34"/>
</g>
<!-- layer17_moe_expert7 -->
<g id="node753" class="node">
<title>layer17_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4341,-34106.04 4013,-34106.04 4013,-34054.04 4341,-34054.04 4341,-34106.04"/>
<text text-anchor="middle" x="4177" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 7 L17</text>
<text text-anchor="middle" x="4177" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4177" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4177" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert7 -->
<g id="node779" class="node">
<title>layer17_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4214" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4214" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4214" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4214" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer17_moe_expert7&#45;&gt;layer17_moe_comm_from_expert7 -->
<g id="edge991" class="edge">
<title>layer17_moe_expert7&#45;&gt;layer17_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4214,-34053.72C4214,-34053.72 4214,-34028.18 4214,-34028.18"/>
<polygon fill="black" stroke="black" points="4217.5,-34028.18 4214,-34018.18 4210.5,-34028.18 4217.5,-34028.18"/>
</g>
<!-- layer17_moe_comm_to_expert7&#45;&gt;layer17_moe_expert7 -->
<g id="edge960" class="edge">
<title>layer17_moe_comm_to_expert7&#45;&gt;layer17_moe_expert7</title>
<path fill="none" stroke="black" d="M4214,-34141.99C4214,-34141.99 4214,-34116.34 4214,-34116.34"/>
<polygon fill="black" stroke="black" points="4217.5,-34116.34 4214,-34106.34 4210.5,-34116.34 4217.5,-34116.34"/>
</g>
<!-- layer17_moe_expert8 -->
<g id="node755" class="node">
<title>layer17_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4687,-34106.04 4359,-34106.04 4359,-34054.04 4687,-34054.04 4687,-34106.04"/>
<text text-anchor="middle" x="4523" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 8 L17</text>
<text text-anchor="middle" x="4523" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4523" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4523" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert8 -->
<g id="node780" class="node">
<title>layer17_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4486" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4486" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4486" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4486" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer17_moe_expert8&#45;&gt;layer17_moe_comm_from_expert8 -->
<g id="edge993" class="edge">
<title>layer17_moe_expert8&#45;&gt;layer17_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4486,-34053.72C4486,-34053.72 4486,-34028.18 4486,-34028.18"/>
<polygon fill="black" stroke="black" points="4489.5,-34028.18 4486,-34018.18 4482.5,-34028.18 4489.5,-34028.18"/>
</g>
<!-- layer17_moe_comm_to_expert8&#45;&gt;layer17_moe_expert8 -->
<g id="edge962" class="edge">
<title>layer17_moe_comm_to_expert8&#45;&gt;layer17_moe_expert8</title>
<path fill="none" stroke="black" d="M4486,-34141.99C4486,-34141.99 4486,-34116.34 4486,-34116.34"/>
<polygon fill="black" stroke="black" points="4489.5,-34116.34 4486,-34106.34 4482.5,-34116.34 4489.5,-34116.34"/>
</g>
<!-- layer17_moe_expert9 -->
<g id="node757" class="node">
<title>layer17_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="5033,-34106.04 4705,-34106.04 4705,-34054.04 5033,-34054.04 5033,-34106.04"/>
<text text-anchor="middle" x="4869" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 9 L17</text>
<text text-anchor="middle" x="4869" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4869" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4869" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert9 -->
<g id="node781" class="node">
<title>layer17_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4795" cy="-33989.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4795" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4795" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4795" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer17_moe_expert9&#45;&gt;layer17_moe_comm_from_expert9 -->
<g id="edge995" class="edge">
<title>layer17_moe_expert9&#45;&gt;layer17_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4795.25,-34053.72C4795.25,-34053.72 4795.25,-34028.18 4795.25,-34028.18"/>
<polygon fill="black" stroke="black" points="4798.75,-34028.18 4795.25,-34018.18 4791.75,-34028.18 4798.75,-34028.18"/>
</g>
<!-- layer17_moe_comm_to_expert9&#45;&gt;layer17_moe_expert9 -->
<g id="edge964" class="edge">
<title>layer17_moe_comm_to_expert9&#45;&gt;layer17_moe_expert9</title>
<path fill="none" stroke="black" d="M4795.25,-34141.99C4795.25,-34141.99 4795.25,-34116.34 4795.25,-34116.34"/>
<polygon fill="black" stroke="black" points="4798.75,-34116.34 4795.25,-34106.34 4791.75,-34116.34 4798.75,-34116.34"/>
</g>
<!-- layer17_moe_expert10 -->
<g id="node759" class="node">
<title>layer17_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5389,-34106.04 5051,-34106.04 5051,-34054.04 5389,-34054.04 5389,-34106.04"/>
<text text-anchor="middle" x="5220" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 10 L17</text>
<text text-anchor="middle" x="5220" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5220" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5220" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert10 -->
<g id="node782" class="node">
<title>layer17_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5127" cy="-33989.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5127" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5127" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5127" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer17_moe_expert10&#45;&gt;layer17_moe_comm_from_expert10 -->
<g id="edge997" class="edge">
<title>layer17_moe_expert10&#45;&gt;layer17_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5136.38,-34053.72C5136.38,-34053.72 5136.38,-34028.18 5136.38,-34028.18"/>
<polygon fill="black" stroke="black" points="5139.88,-34028.18 5136.38,-34018.18 5132.88,-34028.18 5139.88,-34028.18"/>
</g>
<!-- layer17_moe_comm_to_expert10&#45;&gt;layer17_moe_expert10 -->
<g id="edge966" class="edge">
<title>layer17_moe_comm_to_expert10&#45;&gt;layer17_moe_expert10</title>
<path fill="none" stroke="black" d="M5136.02,-34141.99C5136.02,-34141.99 5136.02,-34116.34 5136.02,-34116.34"/>
<polygon fill="black" stroke="black" points="5139.52,-34116.34 5136.02,-34106.34 5132.52,-34116.34 5139.52,-34116.34"/>
</g>
<!-- layer17_moe_expert11 -->
<g id="node761" class="node">
<title>layer17_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5745,-34106.04 5407,-34106.04 5407,-34054.04 5745,-34054.04 5745,-34106.04"/>
<text text-anchor="middle" x="5576" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 11 L17</text>
<text text-anchor="middle" x="5576" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5576" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5576" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert11 -->
<g id="node783" class="node">
<title>layer17_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5474" cy="-33989.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5474" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5474" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5474" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer17_moe_expert11&#45;&gt;layer17_moe_comm_from_expert11 -->
<g id="edge999" class="edge">
<title>layer17_moe_expert11&#45;&gt;layer17_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5487.88,-34053.72C5487.88,-34053.72 5487.88,-34027.86 5487.88,-34027.86"/>
<polygon fill="black" stroke="black" points="5491.38,-34027.86 5487.88,-34017.86 5484.38,-34027.86 5491.38,-34027.86"/>
</g>
<!-- layer17_moe_comm_to_expert11&#45;&gt;layer17_moe_expert11 -->
<g id="edge968" class="edge">
<title>layer17_moe_comm_to_expert11&#45;&gt;layer17_moe_expert11</title>
<path fill="none" stroke="black" d="M5487.02,-34142.24C5487.02,-34142.24 5487.02,-34116.17 5487.02,-34116.17"/>
<polygon fill="black" stroke="black" points="5490.52,-34116.17 5487.02,-34106.17 5483.52,-34116.17 5490.52,-34116.17"/>
</g>
<!-- layer17_moe_expert12 -->
<g id="node763" class="node">
<title>layer17_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6101,-34106.04 5763,-34106.04 5763,-34054.04 6101,-34054.04 6101,-34106.04"/>
<text text-anchor="middle" x="5932" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 12 L17</text>
<text text-anchor="middle" x="5932" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5932" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5932" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert12 -->
<g id="node784" class="node">
<title>layer17_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5825" cy="-33989.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5825" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5825" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5825" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer17_moe_expert12&#45;&gt;layer17_moe_comm_from_expert12 -->
<g id="edge1001" class="edge">
<title>layer17_moe_expert12&#45;&gt;layer17_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5841.38,-34053.72C5841.38,-34053.72 5841.38,-34027.86 5841.38,-34027.86"/>
<polygon fill="black" stroke="black" points="5844.88,-34027.86 5841.38,-34017.86 5837.88,-34027.86 5844.88,-34027.86"/>
</g>
<!-- layer17_moe_comm_to_expert12&#45;&gt;layer17_moe_expert12 -->
<g id="edge970" class="edge">
<title>layer17_moe_comm_to_expert12&#45;&gt;layer17_moe_expert12</title>
<path fill="none" stroke="black" d="M5840.52,-34142.24C5840.52,-34142.24 5840.52,-34116.17 5840.52,-34116.17"/>
<polygon fill="black" stroke="black" points="5844.02,-34116.17 5840.52,-34106.17 5837.02,-34116.17 5844.02,-34116.17"/>
</g>
<!-- layer17_moe_expert13 -->
<g id="node765" class="node">
<title>layer17_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6457,-34106.04 6119,-34106.04 6119,-34054.04 6457,-34054.04 6457,-34106.04"/>
<text text-anchor="middle" x="6288" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 13 L17</text>
<text text-anchor="middle" x="6288" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6288" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6288" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert13 -->
<g id="node785" class="node">
<title>layer17_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6179" cy="-33989.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6179" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6179" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6179" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer17_moe_expert13&#45;&gt;layer17_moe_comm_from_expert13 -->
<g id="edge1003" class="edge">
<title>layer17_moe_expert13&#45;&gt;layer17_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6196.38,-34053.72C6196.38,-34053.72 6196.38,-34027.86 6196.38,-34027.86"/>
<polygon fill="black" stroke="black" points="6199.88,-34027.86 6196.38,-34017.86 6192.88,-34027.86 6199.88,-34027.86"/>
</g>
<!-- layer17_moe_comm_to_expert13&#45;&gt;layer17_moe_expert13 -->
<g id="edge972" class="edge">
<title>layer17_moe_comm_to_expert13&#45;&gt;layer17_moe_expert13</title>
<path fill="none" stroke="black" d="M6195.02,-34142.24C6195.02,-34142.24 6195.02,-34116.17 6195.02,-34116.17"/>
<polygon fill="black" stroke="black" points="6198.52,-34116.17 6195.02,-34106.17 6191.52,-34116.17 6198.52,-34116.17"/>
</g>
<!-- layer17_moe_expert14 -->
<g id="node767" class="node">
<title>layer17_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6813,-34106.04 6475,-34106.04 6475,-34054.04 6813,-34054.04 6813,-34106.04"/>
<text text-anchor="middle" x="6644" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 14 L17</text>
<text text-anchor="middle" x="6644" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6644" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6644" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert14 -->
<g id="node786" class="node">
<title>layer17_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6534" cy="-33989.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6534" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6534" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6534" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer17_moe_expert14&#45;&gt;layer17_moe_comm_from_expert14 -->
<g id="edge1005" class="edge">
<title>layer17_moe_expert14&#45;&gt;layer17_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6551.88,-34053.72C6551.88,-34053.72 6551.88,-34027.53 6551.88,-34027.53"/>
<polygon fill="black" stroke="black" points="6555.38,-34027.53 6551.88,-34017.53 6548.38,-34027.53 6555.38,-34027.53"/>
</g>
<!-- layer17_moe_comm_to_expert14&#45;&gt;layer17_moe_expert14 -->
<g id="edge974" class="edge">
<title>layer17_moe_comm_to_expert14&#45;&gt;layer17_moe_expert14</title>
<path fill="none" stroke="black" d="M6550.52,-34142.24C6550.52,-34142.24 6550.52,-34116.17 6550.52,-34116.17"/>
<polygon fill="black" stroke="black" points="6554.02,-34116.17 6550.52,-34106.17 6547.02,-34116.17 6554.02,-34116.17"/>
</g>
<!-- layer17_moe_expert15 -->
<g id="node769" class="node">
<title>layer17_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7169,-34106.04 6831,-34106.04 6831,-34054.04 7169,-34054.04 7169,-34106.04"/>
<text text-anchor="middle" x="7000" y="-34094.04" font-family="Arial" font-size="10.00">EXPERT 15 L17</text>
<text text-anchor="middle" x="7000" y="-34083.04" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="7000" y="-34072.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="7000" y="-34061.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_comm_from_expert15 -->
<g id="node787" class="node">
<title>layer17_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6889" cy="-33989.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6889" y="-33997.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6889" y="-33986.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6889" y="-33975.55" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer17_moe_expert15&#45;&gt;layer17_moe_comm_from_expert15 -->
<g id="edge1007" class="edge">
<title>layer17_moe_expert15&#45;&gt;layer17_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6907.38,-34053.72C6907.38,-34053.72 6907.38,-34027.53 6907.38,-34027.53"/>
<polygon fill="black" stroke="black" points="6910.88,-34027.53 6907.38,-34017.53 6903.88,-34027.53 6910.88,-34027.53"/>
</g>
<!-- layer17_moe_comm_to_expert15&#45;&gt;layer17_moe_expert15 -->
<g id="edge976" class="edge">
<title>layer17_moe_comm_to_expert15&#45;&gt;layer17_moe_expert15</title>
<path fill="none" stroke="black" d="M6906.02,-34142.24C6906.02,-34142.24 6906.02,-34116.17 6906.02,-34116.17"/>
<polygon fill="black" stroke="black" points="6909.52,-34116.17 6906.02,-34106.17 6902.52,-34116.17 6909.52,-34116.17"/>
</g>
<!-- layer17_moe_aggregate -->
<g id="node771" class="node">
<title>layer17_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4575.1,-33924.06 4158.16,-33924.06 4050.9,-33820.06 4467.84,-33820.06 4575.1,-33924.06"/>
<text text-anchor="middle" x="4313" y="-33886.06" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L17</text>
<text text-anchor="middle" x="4313" y="-33875.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4313" y="-33864.06" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4313" y="-33853.06" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_mha -->
<g id="node788" class="node">
<title>layer18_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4443,-33784.06 4183,-33784.06 4183,-33732.06 4443,-33732.06 4443,-33784.06"/>
<text text-anchor="middle" x="4313" y="-33772.06" font-family="Arial" font-size="10.00">MHA L18</text>
<text text-anchor="middle" x="4313" y="-33761.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4313" y="-33750.06" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4313" y="-33739.06" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer17_moe_aggregate&#45;&gt;layer18_moe_mha -->
<g id="edge1076" class="edge">
<title>layer17_moe_aggregate&#45;&gt;layer18_moe_mha</title>
<path fill="none" stroke="black" d="M4313,-33819.73C4313,-33819.73 4313,-33794.28 4313,-33794.28"/>
<polygon fill="black" stroke="black" points="4316.5,-33794.28 4313,-33784.28 4309.5,-33794.28 4316.5,-33794.28"/>
</g>
<!-- layer17_moe_comm_from_expert0&#45;&gt;layer17_moe_aggregate -->
<g id="edge978" class="edge">
<title>layer17_moe_comm_from_expert0&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M1964.75,-33960.97C1964.75,-33916.29 1964.75,-33834 1964.75,-33834 1964.75,-33834 4055.03,-33834 4055.03,-33834"/>
<polygon fill="black" stroke="black" points="4055.03,-33837.5 4065.03,-33834 4055.03,-33830.5 4055.03,-33837.5"/>
</g>
<!-- layer17_moe_comm_from_expert1&#45;&gt;layer17_moe_aggregate -->
<g id="edge980" class="edge">
<title>layer17_moe_comm_from_expert1&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M2273.75,-33968.08C2273.75,-33929.01 2273.75,-33849 2273.75,-33849 2273.75,-33849 4070.56,-33849 4070.56,-33849"/>
<polygon fill="black" stroke="black" points="4070.56,-33852.5 4080.56,-33849 4070.56,-33845.5 4070.56,-33852.5"/>
</g>
<!-- layer17_moe_comm_from_expert2&#45;&gt;layer17_moe_aggregate -->
<g id="edge982" class="edge">
<title>layer17_moe_comm_from_expert2&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M2652.25,-33961.61C2652.25,-33924.8 2652.25,-33864 2652.25,-33864 2652.25,-33864 4085.89,-33864 4085.89,-33864"/>
<polygon fill="black" stroke="black" points="4085.89,-33867.5 4095.89,-33864 4085.89,-33860.5 4085.89,-33867.5"/>
</g>
<!-- layer17_moe_comm_from_expert3&#45;&gt;layer17_moe_aggregate -->
<g id="edge984" class="edge">
<title>layer17_moe_comm_from_expert3&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M2913.5,-33960.71C2913.5,-33928.1 2913.5,-33879 2913.5,-33879 2913.5,-33879 4101.37,-33879 4101.37,-33879"/>
<polygon fill="black" stroke="black" points="4101.37,-33882.5 4111.37,-33879 4101.37,-33875.5 4101.37,-33882.5"/>
</g>
<!-- layer17_moe_comm_from_expert4&#45;&gt;layer17_moe_aggregate -->
<g id="edge986" class="edge">
<title>layer17_moe_comm_from_expert4&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M3246.5,-33960.27C3246.5,-33932.3 3246.5,-33894 3246.5,-33894 3246.5,-33894 4116.93,-33894 4116.93,-33894"/>
<polygon fill="black" stroke="black" points="4116.93,-33897.5 4126.93,-33894 4116.93,-33890.5 4116.93,-33897.5"/>
</g>
<!-- layer17_moe_comm_from_expert5&#45;&gt;layer17_moe_aggregate -->
<g id="edge988" class="edge">
<title>layer17_moe_comm_from_expert5&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M3703,-33965.03C3703,-33941.45 3703,-33909 3703,-33909 3703,-33909 4132.27,-33909 4132.27,-33909"/>
<polygon fill="black" stroke="black" points="4132.27,-33912.5 4142.27,-33909 4132.27,-33905.5 4132.27,-33912.5"/>
</g>
<!-- layer17_moe_comm_from_expert6&#45;&gt;layer17_moe_aggregate -->
<g id="edge990" class="edge">
<title>layer17_moe_comm_from_expert6&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M4050.68,-33989C4071.21,-33989 4087.1,-33989 4087.1,-33989 4087.1,-33989 4087.1,-33882.14 4087.1,-33882.14"/>
<polygon fill="black" stroke="black" points="4090.6,-33882.14 4087.1,-33872.14 4083.6,-33882.14 4090.6,-33882.14"/>
</g>
<!-- layer17_moe_comm_from_expert7&#45;&gt;layer17_moe_aggregate -->
<g id="edge992" class="edge">
<title>layer17_moe_comm_from_expert7&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M4214,-33959.83C4214,-33959.83 4214,-33934.12 4214,-33934.12"/>
<polygon fill="black" stroke="black" points="4217.5,-33934.12 4214,-33924.12 4210.5,-33934.12 4217.5,-33934.12"/>
</g>
<!-- layer17_moe_comm_from_expert8&#45;&gt;layer17_moe_aggregate -->
<g id="edge994" class="edge">
<title>layer17_moe_comm_from_expert8&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M4485.39,-33959.83C4485.39,-33959.83 4485.39,-33934.12 4485.39,-33934.12"/>
<polygon fill="black" stroke="black" points="4488.89,-33934.12 4485.39,-33924.12 4481.89,-33934.12 4488.89,-33934.12"/>
</g>
<!-- layer17_moe_comm_from_expert9&#45;&gt;layer17_moe_aggregate -->
<g id="edge996" class="edge">
<title>layer17_moe_comm_from_expert9&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M4776.5,-33960.43C4776.5,-33938.15 4776.5,-33911 4776.5,-33911 4776.5,-33911 4571.71,-33911 4571.71,-33911"/>
<polygon fill="black" stroke="black" points="4571.71,-33907.5 4561.71,-33911 4571.71,-33914.5 4571.71,-33907.5"/>
</g>
<!-- layer17_moe_comm_from_expert10&#45;&gt;layer17_moe_aggregate -->
<g id="edge998" class="edge">
<title>layer17_moe_comm_from_expert10&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M5108.15,-33960.24C5108.15,-33933.57 5108.15,-33898 5108.15,-33898 5108.15,-33898 4558.34,-33898 4558.34,-33898"/>
<polygon fill="black" stroke="black" points="4558.34,-33894.5 4548.34,-33898 4558.34,-33901.5 4558.34,-33894.5"/>
</g>
<!-- layer17_moe_comm_from_expert11&#45;&gt;layer17_moe_aggregate -->
<g id="edge1000" class="edge">
<title>layer17_moe_comm_from_expert11&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M5454.65,-33960.62C5454.65,-33929.81 5454.65,-33885 5454.65,-33885 5454.65,-33885 4545.15,-33885 4545.15,-33885"/>
<polygon fill="black" stroke="black" points="4545.15,-33881.5 4535.15,-33885 4545.15,-33888.5 4545.15,-33881.5"/>
</g>
<!-- layer17_moe_comm_from_expert12&#45;&gt;layer17_moe_aggregate -->
<g id="edge1002" class="edge">
<title>layer17_moe_comm_from_expert12&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M5805.65,-33960.41C5805.65,-33925.76 5805.65,-33872 5805.65,-33872 5805.65,-33872 4531.72,-33872 4531.72,-33872"/>
<polygon fill="black" stroke="black" points="4531.72,-33868.5 4521.72,-33872 4531.72,-33875.5 4531.72,-33868.5"/>
</g>
<!-- layer17_moe_comm_from_expert13&#45;&gt;layer17_moe_aggregate -->
<g id="edge1004" class="edge">
<title>layer17_moe_comm_from_expert13&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M6159.15,-33960.51C6159.15,-33922.23 6159.15,-33859 6159.15,-33859 6159.15,-33859 4518.39,-33859 4518.39,-33859"/>
<polygon fill="black" stroke="black" points="4518.39,-33855.5 4508.39,-33859 4518.39,-33862.5 4518.39,-33855.5"/>
</g>
<!-- layer17_moe_comm_from_expert14&#45;&gt;layer17_moe_aggregate -->
<g id="edge1006" class="edge">
<title>layer17_moe_comm_from_expert14&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M6514.15,-33960.44C6514.15,-33918.7 6514.15,-33846 6514.15,-33846 6514.15,-33846 4505,-33846 4505,-33846"/>
<polygon fill="black" stroke="black" points="4505,-33842.5 4495,-33846 4505,-33849.5 4505,-33842.5"/>
</g>
<!-- layer17_moe_comm_from_expert15&#45;&gt;layer17_moe_aggregate -->
<g id="edge1008" class="edge">
<title>layer17_moe_comm_from_expert15&#45;&gt;layer17_moe_aggregate</title>
<path fill="none" stroke="black" d="M6869.15,-33960.43C6869.15,-33915.38 6869.15,-33833 6869.15,-33833 6869.15,-33833 4491.21,-33833 4491.21,-33833"/>
<polygon fill="black" stroke="black" points="4491.21,-33829.5 4481.21,-33833 4491.21,-33836.5 4491.21,-33829.5"/>
</g>
<!-- layer18_moe_gate -->
<g id="node789" class="node">
<title>layer18_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4571.3,-33696.06 4160.4,-33696.06 4054.7,-33592.06 4465.6,-33592.06 4571.3,-33696.06"/>
<text text-anchor="middle" x="4313" y="-33658.06" font-family="Arial" font-size="10.00">GATE L18</text>
<text text-anchor="middle" x="4313" y="-33647.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4313" y="-33636.06" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4313" y="-33625.06" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer18_moe_mha&#45;&gt;layer18_moe_gate -->
<g id="edge1077" class="edge">
<title>layer18_moe_mha&#45;&gt;layer18_moe_gate</title>
<path fill="none" stroke="black" d="M4313,-33731.9C4313,-33731.9 4313,-33706.15 4313,-33706.15"/>
<polygon fill="black" stroke="black" points="4316.5,-33706.15 4313,-33696.15 4309.5,-33706.15 4316.5,-33706.15"/>
</g>
<!-- layer18_moe_split -->
<g id="node790" class="node">
<title>layer18_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4567.01,-33556.06 4162.94,-33556.06 4058.99,-33452.06 4463.06,-33452.06 4567.01,-33556.06"/>
<text text-anchor="middle" x="4313" y="-33518.06" font-family="Arial" font-size="10.00">SPLIT TOKENS L18</text>
<text text-anchor="middle" x="4313" y="-33507.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4313" y="-33496.06" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4313" y="-33485.06" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer18_moe_gate&#45;&gt;layer18_moe_split -->
<g id="edge1078" class="edge">
<title>layer18_moe_gate&#45;&gt;layer18_moe_split</title>
<path fill="none" stroke="black" d="M4313,-33591.93C4313,-33591.93 4313,-33566.23 4313,-33566.23"/>
<polygon fill="black" stroke="black" points="4316.5,-33566.23 4313,-33556.23 4309.5,-33566.23 4316.5,-33566.23"/>
</g>
<!-- layer18_moe_comm_to_expert0 -->
<g id="node792" class="node">
<title>layer18_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1764" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1764" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1764" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1764" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert0 -->
<g id="edge1012" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4147.52,-33541C3582.01,-33541 1760.99,-33541 1760.99,-33541 1760.99,-33541 1760.99,-33426.38 1760.99,-33426.38"/>
<polygon fill="black" stroke="black" points="1764.49,-33426.38 1760.99,-33416.38 1757.49,-33426.38 1764.49,-33426.38"/>
</g>
<!-- layer18_moe_comm_to_expert1 -->
<g id="node794" class="node">
<title>layer18_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2477" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2477" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2477" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2477" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert1 -->
<g id="edge1014" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4132.56,-33526C3683.11,-33526 2549.5,-33526 2549.5,-33526 2549.5,-33526 2549.5,-33414.66 2549.5,-33414.66"/>
<polygon fill="black" stroke="black" points="2553,-33414.66 2549.5,-33404.66 2546,-33414.66 2553,-33414.66"/>
</g>
<!-- layer18_moe_comm_to_expert2 -->
<g id="node796" class="node">
<title>layer18_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2933" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2933" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2933" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2933" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert2 -->
<g id="edge1016" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4117.74,-33511C3752.83,-33511 3004.01,-33511 3004.01,-33511 3004.01,-33511 3004.01,-33415.09 3004.01,-33415.09"/>
<polygon fill="black" stroke="black" points="3007.51,-33415.09 3004.01,-33405.09 3000.51,-33415.09 3007.51,-33415.09"/>
</g>
<!-- layer18_moe_comm_to_expert3 -->
<g id="node798" class="node">
<title>layer18_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3261" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3261" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3261" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3261" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert3 -->
<g id="edge1018" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4102.73,-33496C3815.85,-33496 3337.01,-33496 3337.01,-33496 3337.01,-33496 3337.01,-33413.14 3337.01,-33413.14"/>
<polygon fill="black" stroke="black" points="3340.51,-33413.14 3337.01,-33403.14 3333.51,-33413.14 3340.51,-33413.14"/>
</g>
<!-- layer18_moe_comm_to_expert4 -->
<g id="node800" class="node">
<title>layer18_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3524" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3524" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3524" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3524" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert4 -->
<g id="edge1020" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4087.42,-33481C3874.45,-33481 3587.5,-33481 3587.5,-33481 3587.5,-33481 3587.5,-33417.91 3587.5,-33417.91"/>
<polygon fill="black" stroke="black" points="3591,-33417.91 3587.5,-33407.91 3584,-33417.91 3591,-33417.91"/>
</g>
<!-- layer18_moe_comm_to_expert5 -->
<g id="node802" class="node">
<title>layer18_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3755" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3755" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3755" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3755" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert5 -->
<g id="edge1022" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4072.64,-33466C3936.64,-33466 3793.51,-33466 3793.51,-33466 3793.51,-33466 3793.51,-33423.35 3793.51,-33423.35"/>
<polygon fill="black" stroke="black" points="3797.01,-33423.35 3793.51,-33413.35 3790.01,-33423.35 3797.01,-33423.35"/>
</g>
<!-- layer18_moe_comm_to_expert6 -->
<g id="node804" class="node">
<title>layer18_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3970" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3970" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3970" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3970" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert6 -->
<g id="edge1024" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4073.5,-33503.97C4073.5,-33500.43 4073.5,-33387 4073.5,-33387 4073.5,-33387 4070.81,-33387 4070.81,-33387"/>
<polygon fill="black" stroke="black" points="4070.81,-33383.5 4060.81,-33387 4070.81,-33390.5 4070.81,-33383.5"/>
</g>
<!-- layer18_moe_comm_to_expert7 -->
<g id="node806" class="node">
<title>layer18_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4177" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4177" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4177" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4177" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert7 -->
<g id="edge1026" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4177,-33451.72C4177,-33451.72 4177,-33426.28 4177,-33426.28"/>
<polygon fill="black" stroke="black" points="4180.5,-33426.28 4177,-33416.28 4173.5,-33426.28 4180.5,-33426.28"/>
</g>
<!-- layer18_moe_comm_to_expert8 -->
<g id="node808" class="node">
<title>layer18_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4449" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4449" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4449" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4449" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert8 -->
<g id="edge1028" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4449,-33451.72C4449,-33451.72 4449,-33426.28 4449,-33426.28"/>
<polygon fill="black" stroke="black" points="4452.5,-33426.28 4449,-33416.28 4445.5,-33426.28 4452.5,-33426.28"/>
</g>
<!-- layer18_moe_comm_to_expert9 -->
<g id="node810" class="node">
<title>layer18_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4758" cy="-33387.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4758" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4758" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4758" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert9 -->
<g id="edge1030" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4553.26,-33503.97C4553.26,-33500.43 4553.26,-33387 4553.26,-33387 4553.26,-33387 4657.3,-33387 4657.3,-33387"/>
<polygon fill="black" stroke="black" points="4657.3,-33390.5 4667.3,-33387 4657.3,-33383.5 4657.3,-33390.5"/>
</g>
<!-- layer18_moe_comm_to_expert10 -->
<g id="node812" class="node">
<title>layer18_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5090" cy="-33387.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5090" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5090" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5090" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert10 -->
<g id="edge1032" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.38,-33466C4684.6,-33466 5014.1,-33466 5014.1,-33466 5014.1,-33466 5014.1,-33414.19 5014.1,-33414.19"/>
<polygon fill="black" stroke="black" points="5017.6,-33414.19 5014.1,-33404.19 5010.6,-33414.19 5017.6,-33414.19"/>
</g>
<!-- layer18_moe_comm_to_expert11 -->
<g id="node814" class="node">
<title>layer18_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5436" cy="-33387.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5436" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5436" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5436" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert11 -->
<g id="edge1034" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4492.2,-33481C4791.48,-33481 5360.6,-33481 5360.6,-33481 5360.6,-33481 5360.6,-33414.73 5360.6,-33414.73"/>
<polygon fill="black" stroke="black" points="5364.1,-33414.73 5360.6,-33404.73 5357.1,-33414.73 5364.1,-33414.73"/>
</g>
<!-- layer18_moe_comm_to_expert12 -->
<g id="node816" class="node">
<title>layer18_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5787" cy="-33387.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5787" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5787" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5787" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert12 -->
<g id="edge1036" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4507.1,-33496C4891.24,-33496 5711.6,-33496 5711.6,-33496 5711.6,-33496 5711.6,-33414.57 5711.6,-33414.57"/>
<polygon fill="black" stroke="black" points="5715.1,-33414.57 5711.6,-33404.57 5708.1,-33414.57 5715.1,-33414.57"/>
</g>
<!-- layer18_moe_comm_to_expert13 -->
<g id="node818" class="node">
<title>layer18_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6140" cy="-33387.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6140" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6140" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6140" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert13 -->
<g id="edge1038" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4522.17,-33511C4987,-33511 6065.1,-33511 6065.1,-33511 6065.1,-33511 6065.1,-33414.82 6065.1,-33414.82"/>
<polygon fill="black" stroke="black" points="6068.6,-33414.82 6065.1,-33404.82 6061.6,-33414.82 6068.6,-33414.82"/>
</g>
<!-- layer18_moe_comm_to_expert14 -->
<g id="node820" class="node">
<title>layer18_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6495" cy="-33387.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6495" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6495" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6495" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert14 -->
<g id="edge1040" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537,-33526C5079.61,-33526 6420.1,-33526 6420.1,-33526 6420.1,-33526 6420.1,-33414.66 6420.1,-33414.66"/>
<polygon fill="black" stroke="black" points="6423.6,-33414.66 6420.1,-33404.66 6416.6,-33414.66 6423.6,-33414.66"/>
</g>
<!-- layer18_moe_comm_to_expert15 -->
<g id="node822" class="node">
<title>layer18_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6850" cy="-33387.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6850" y="-33395.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6850" y="-33384.56" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6850" y="-33373.56" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert15 -->
<g id="edge1042" class="edge">
<title>layer18_moe_split&#45;&gt;layer18_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4552.15,-33541C5170.66,-33541 6775.1,-33541 6775.1,-33541 6775.1,-33541 6775.1,-33414.72 6775.1,-33414.72"/>
<polygon fill="black" stroke="black" points="6778.6,-33414.72 6775.1,-33404.72 6771.6,-33414.72 6778.6,-33414.72"/>
</g>
<!-- layer18_moe_expert0 -->
<g id="node791" class="node">
<title>layer18_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1882,-33322.07 1554,-33322.07 1554,-33270.07 1882,-33270.07 1882,-33322.07"/>
<text text-anchor="middle" x="1718" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 0 L18</text>
<text text-anchor="middle" x="1718" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1718" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1718" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert0 -->
<g id="node824" class="node">
<title>layer18_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1764" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1764" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1764" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1764" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer18_moe_expert0&#45;&gt;layer18_moe_comm_from_expert0 -->
<g id="edge1044" class="edge">
<title>layer18_moe_expert0&#45;&gt;layer18_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1764,-33269.75C1764,-33269.75 1764,-33244.21 1764,-33244.21"/>
<polygon fill="black" stroke="black" points="1767.5,-33244.21 1764,-33234.21 1760.5,-33244.21 1767.5,-33244.21"/>
</g>
<!-- layer18_moe_comm_to_expert0&#45;&gt;layer18_moe_expert0 -->
<g id="edge1013" class="edge">
<title>layer18_moe_comm_to_expert0&#45;&gt;layer18_moe_expert0</title>
<path fill="none" stroke="black" d="M1764,-33358.02C1764,-33358.02 1764,-33332.37 1764,-33332.37"/>
<polygon fill="black" stroke="black" points="1767.5,-33332.37 1764,-33322.37 1760.5,-33332.37 1767.5,-33332.37"/>
</g>
<!-- layer18_moe_expert1 -->
<g id="node793" class="node">
<title>layer18_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2228,-33322.07 1900,-33322.07 1900,-33270.07 2228,-33270.07 2228,-33322.07"/>
<text text-anchor="middle" x="2064" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 1 L18</text>
<text text-anchor="middle" x="2064" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2064" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2064" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert1 -->
<g id="node825" class="node">
<title>layer18_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2477" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2477" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2477" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2477" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer18_moe_expert1&#45;&gt;layer18_moe_comm_from_expert1 -->
<g id="edge1046" class="edge">
<title>layer18_moe_expert1&#45;&gt;layer18_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2166.25,-33269.73C2166.25,-33242.83 2166.25,-33205 2166.25,-33205 2166.25,-33205 2376.28,-33205 2376.28,-33205"/>
<polygon fill="black" stroke="black" points="2376.28,-33208.5 2386.28,-33205 2376.28,-33201.5 2376.28,-33208.5"/>
</g>
<!-- layer18_moe_comm_to_expert1&#45;&gt;layer18_moe_expert1 -->
<g id="edge1015" class="edge">
<title>layer18_moe_comm_to_expert1&#45;&gt;layer18_moe_expert1</title>
<path fill="none" stroke="black" d="M2386.16,-33387C2296.99,-33387 2174.25,-33387 2174.25,-33387 2174.25,-33387 2174.25,-33332.37 2174.25,-33332.37"/>
<polygon fill="black" stroke="black" points="2177.75,-33332.37 2174.25,-33322.37 2170.75,-33332.37 2177.75,-33332.37"/>
</g>
<!-- layer18_moe_expert2 -->
<g id="node795" class="node">
<title>layer18_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2574,-33322.07 2246,-33322.07 2246,-33270.07 2574,-33270.07 2574,-33322.07"/>
<text text-anchor="middle" x="2410" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 2 L18</text>
<text text-anchor="middle" x="2410" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2410" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2410" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert2 -->
<g id="node826" class="node">
<title>layer18_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2933" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2933" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2933" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2933" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer18_moe_expert2&#45;&gt;layer18_moe_comm_from_expert2 -->
<g id="edge1048" class="edge">
<title>layer18_moe_expert2&#45;&gt;layer18_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2574.18,-33287C2581.6,-33287 2586,-33287 2586,-33287 2586,-33287 2586,-33205 2586,-33205 2586,-33205 2832.28,-33205 2832.28,-33205"/>
<polygon fill="black" stroke="black" points="2832.28,-33208.5 2842.28,-33205 2832.28,-33201.5 2832.28,-33208.5"/>
</g>
<!-- layer18_moe_comm_to_expert2&#45;&gt;layer18_moe_expert2 -->
<g id="edge1017" class="edge">
<title>layer18_moe_comm_to_expert2&#45;&gt;layer18_moe_expert2</title>
<path fill="none" stroke="black" d="M2842.09,-33387C2737.5,-33387 2580,-33387 2580,-33387 2580,-33387 2580,-33304 2580,-33304 2580,-33304 2579.43,-33304 2579.43,-33304"/>
<polygon fill="black" stroke="black" points="2584.34,-33300.5 2574.34,-33304 2584.34,-33307.5 2584.34,-33300.5"/>
</g>
<!-- layer18_moe_expert3 -->
<g id="node797" class="node">
<title>layer18_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2920,-33322.07 2592,-33322.07 2592,-33270.07 2920,-33270.07 2920,-33322.07"/>
<text text-anchor="middle" x="2756" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 3 L18</text>
<text text-anchor="middle" x="2756" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2756" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2756" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert3 -->
<g id="node827" class="node">
<title>layer18_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3261" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3261" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3261" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3261" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer18_moe_expert3&#45;&gt;layer18_moe_comm_from_expert3 -->
<g id="edge1050" class="edge">
<title>layer18_moe_expert3&#45;&gt;layer18_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2881.25,-33269.86C2881.25,-33257.75 2881.25,-33246 2881.25,-33246 2881.25,-33246 3202.33,-33246 3202.33,-33246 3202.33,-33246 3202.33,-33237.46 3202.33,-33237.46"/>
<polygon fill="black" stroke="black" points="3205.83,-33237.46 3202.33,-33227.46 3198.83,-33237.46 3205.83,-33237.46"/>
</g>
<!-- layer18_moe_comm_to_expert3&#45;&gt;layer18_moe_expert3 -->
<g id="edge1019" class="edge">
<title>layer18_moe_comm_to_expert3&#45;&gt;layer18_moe_expert3</title>
<path fill="none" stroke="black" d="M3202.33,-33364.61C3202.33,-33355.02 3202.33,-33346 3202.33,-33346 3202.33,-33346 2881.25,-33346 2881.25,-33346 2881.25,-33346 2881.25,-33332.21 2881.25,-33332.21"/>
<polygon fill="black" stroke="black" points="2884.75,-33332.21 2881.25,-33322.21 2877.75,-33332.21 2884.75,-33332.21"/>
</g>
<!-- layer18_moe_expert4 -->
<g id="node799" class="node">
<title>layer18_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3266,-33322.07 2938,-33322.07 2938,-33270.07 3266,-33270.07 3266,-33322.07"/>
<text text-anchor="middle" x="3102" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 4 L18</text>
<text text-anchor="middle" x="3102" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3102" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3102" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert4 -->
<g id="node828" class="node">
<title>layer18_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3524" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3524" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3524" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3524" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer18_moe_expert4&#45;&gt;layer18_moe_comm_from_expert4 -->
<g id="edge1052" class="edge">
<title>layer18_moe_expert4&#45;&gt;layer18_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3234.16,-33270.05C3234.16,-33263.35 3234.16,-33258 3234.16,-33258 3234.16,-33258 3522.75,-33258 3522.75,-33258 3522.75,-33258 3522.75,-33244.33 3522.75,-33244.33"/>
<polygon fill="black" stroke="black" points="3526.25,-33244.33 3522.75,-33234.33 3519.25,-33244.33 3526.25,-33244.33"/>
</g>
<!-- layer18_moe_comm_to_expert4&#45;&gt;layer18_moe_expert4 -->
<g id="edge1021" class="edge">
<title>layer18_moe_comm_to_expert4&#45;&gt;layer18_moe_expert4</title>
<path fill="none" stroke="black" d="M3522.75,-33358.05C3522.75,-33345.66 3522.75,-33334 3522.75,-33334 3522.75,-33334 3234.16,-33334 3234.16,-33334 3234.16,-33334 3234.16,-33332.41 3234.16,-33332.41"/>
<polygon fill="black" stroke="black" points="3237.66,-33332.41 3234.16,-33322.41 3230.66,-33332.41 3237.66,-33332.41"/>
</g>
<!-- layer18_moe_expert5 -->
<g id="node801" class="node">
<title>layer18_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3612,-33322.07 3284,-33322.07 3284,-33270.07 3612,-33270.07 3612,-33322.07"/>
<text text-anchor="middle" x="3448" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 5 L18</text>
<text text-anchor="middle" x="3448" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3448" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3448" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert5 -->
<g id="node829" class="node">
<title>layer18_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3755" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3755" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3755" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3755" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer18_moe_expert5&#45;&gt;layer18_moe_comm_from_expert5 -->
<g id="edge1054" class="edge">
<title>layer18_moe_expert5&#45;&gt;layer18_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3612.21,-33287C3619.1,-33287 3623.16,-33287 3623.16,-33287 3623.16,-33287 3623.16,-33205 3623.16,-33205 3623.16,-33205 3654.15,-33205 3654.15,-33205"/>
<polygon fill="black" stroke="black" points="3654.15,-33208.5 3664.15,-33205 3654.15,-33201.5 3654.15,-33208.5"/>
</g>
<!-- layer18_moe_comm_to_expert5&#45;&gt;layer18_moe_expert5 -->
<g id="edge1023" class="edge">
<title>layer18_moe_comm_to_expert5&#45;&gt;layer18_moe_expert5</title>
<path fill="none" stroke="black" d="M3664.18,-33387C3639.2,-33387 3618.84,-33387 3618.84,-33387 3618.84,-33387 3618.84,-33304 3618.84,-33304 3618.84,-33304 3618.19,-33304 3618.19,-33304"/>
<polygon fill="black" stroke="black" points="3622.35,-33300.5 3612.35,-33304 3622.35,-33307.5 3622.35,-33300.5"/>
</g>
<!-- layer18_moe_expert6 -->
<g id="node803" class="node">
<title>layer18_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3958,-33322.07 3630,-33322.07 3630,-33270.07 3958,-33270.07 3958,-33322.07"/>
<text text-anchor="middle" x="3794" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 6 L18</text>
<text text-anchor="middle" x="3794" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3794" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3794" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert6 -->
<g id="node830" class="node">
<title>layer18_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3970" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3970" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3970" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3970" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer18_moe_expert6&#45;&gt;layer18_moe_comm_from_expert6 -->
<g id="edge1056" class="edge">
<title>layer18_moe_expert6&#45;&gt;layer18_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3918.75,-33269.75C3918.75,-33269.75 3918.75,-33239.16 3918.75,-33239.16"/>
<polygon fill="black" stroke="black" points="3922.25,-33239.16 3918.75,-33229.16 3915.25,-33239.16 3922.25,-33239.16"/>
</g>
<!-- layer18_moe_comm_to_expert6&#45;&gt;layer18_moe_expert6 -->
<g id="edge1025" class="edge">
<title>layer18_moe_comm_to_expert6&#45;&gt;layer18_moe_expert6</title>
<path fill="none" stroke="black" d="M3918.75,-33363.16C3918.75,-33363.16 3918.75,-33332.38 3918.75,-33332.38"/>
<polygon fill="black" stroke="black" points="3922.25,-33332.38 3918.75,-33322.38 3915.25,-33332.38 3922.25,-33332.38"/>
</g>
<!-- layer18_moe_expert7 -->
<g id="node805" class="node">
<title>layer18_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4304,-33322.07 3976,-33322.07 3976,-33270.07 4304,-33270.07 4304,-33322.07"/>
<text text-anchor="middle" x="4140" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 7 L18</text>
<text text-anchor="middle" x="4140" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4140" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4140" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert7 -->
<g id="node831" class="node">
<title>layer18_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4177" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4177" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4177" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4177" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer18_moe_expert7&#45;&gt;layer18_moe_comm_from_expert7 -->
<g id="edge1058" class="edge">
<title>layer18_moe_expert7&#45;&gt;layer18_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4177,-33269.75C4177,-33269.75 4177,-33244.21 4177,-33244.21"/>
<polygon fill="black" stroke="black" points="4180.5,-33244.21 4177,-33234.21 4173.5,-33244.21 4180.5,-33244.21"/>
</g>
<!-- layer18_moe_comm_to_expert7&#45;&gt;layer18_moe_expert7 -->
<g id="edge1027" class="edge">
<title>layer18_moe_comm_to_expert7&#45;&gt;layer18_moe_expert7</title>
<path fill="none" stroke="black" d="M4177,-33358.02C4177,-33358.02 4177,-33332.37 4177,-33332.37"/>
<polygon fill="black" stroke="black" points="4180.5,-33332.37 4177,-33322.37 4173.5,-33332.37 4180.5,-33332.37"/>
</g>
<!-- layer18_moe_expert8 -->
<g id="node807" class="node">
<title>layer18_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4650,-33322.07 4322,-33322.07 4322,-33270.07 4650,-33270.07 4650,-33322.07"/>
<text text-anchor="middle" x="4486" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 8 L18</text>
<text text-anchor="middle" x="4486" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4486" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4486" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert8 -->
<g id="node832" class="node">
<title>layer18_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4449" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4449" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4449" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4449" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer18_moe_expert8&#45;&gt;layer18_moe_comm_from_expert8 -->
<g id="edge1060" class="edge">
<title>layer18_moe_expert8&#45;&gt;layer18_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4449,-33269.75C4449,-33269.75 4449,-33244.21 4449,-33244.21"/>
<polygon fill="black" stroke="black" points="4452.5,-33244.21 4449,-33234.21 4445.5,-33244.21 4452.5,-33244.21"/>
</g>
<!-- layer18_moe_comm_to_expert8&#45;&gt;layer18_moe_expert8 -->
<g id="edge1029" class="edge">
<title>layer18_moe_comm_to_expert8&#45;&gt;layer18_moe_expert8</title>
<path fill="none" stroke="black" d="M4449,-33358.02C4449,-33358.02 4449,-33332.37 4449,-33332.37"/>
<polygon fill="black" stroke="black" points="4452.5,-33332.37 4449,-33322.37 4445.5,-33332.37 4452.5,-33332.37"/>
</g>
<!-- layer18_moe_expert9 -->
<g id="node809" class="node">
<title>layer18_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4996,-33322.07 4668,-33322.07 4668,-33270.07 4996,-33270.07 4996,-33322.07"/>
<text text-anchor="middle" x="4832" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 9 L18</text>
<text text-anchor="middle" x="4832" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4832" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4832" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert9 -->
<g id="node833" class="node">
<title>layer18_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4758" cy="-33205.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4758" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4758" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4758" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer18_moe_expert9&#45;&gt;layer18_moe_comm_from_expert9 -->
<g id="edge1062" class="edge">
<title>layer18_moe_expert9&#45;&gt;layer18_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4758.25,-33269.75C4758.25,-33269.75 4758.25,-33244.21 4758.25,-33244.21"/>
<polygon fill="black" stroke="black" points="4761.75,-33244.21 4758.25,-33234.21 4754.75,-33244.21 4761.75,-33244.21"/>
</g>
<!-- layer18_moe_comm_to_expert9&#45;&gt;layer18_moe_expert9 -->
<g id="edge1031" class="edge">
<title>layer18_moe_comm_to_expert9&#45;&gt;layer18_moe_expert9</title>
<path fill="none" stroke="black" d="M4758.25,-33358.02C4758.25,-33358.02 4758.25,-33332.37 4758.25,-33332.37"/>
<polygon fill="black" stroke="black" points="4761.75,-33332.37 4758.25,-33322.37 4754.75,-33332.37 4761.75,-33332.37"/>
</g>
<!-- layer18_moe_expert10 -->
<g id="node811" class="node">
<title>layer18_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5352,-33322.07 5014,-33322.07 5014,-33270.07 5352,-33270.07 5352,-33322.07"/>
<text text-anchor="middle" x="5183" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 10 L18</text>
<text text-anchor="middle" x="5183" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5183" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5183" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert10 -->
<g id="node834" class="node">
<title>layer18_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5090" cy="-33205.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5090" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5090" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5090" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer18_moe_expert10&#45;&gt;layer18_moe_comm_from_expert10 -->
<g id="edge1064" class="edge">
<title>layer18_moe_expert10&#45;&gt;layer18_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5099.38,-33269.75C5099.38,-33269.75 5099.38,-33244.21 5099.38,-33244.21"/>
<polygon fill="black" stroke="black" points="5102.88,-33244.21 5099.38,-33234.21 5095.88,-33244.21 5102.88,-33244.21"/>
</g>
<!-- layer18_moe_comm_to_expert10&#45;&gt;layer18_moe_expert10 -->
<g id="edge1033" class="edge">
<title>layer18_moe_comm_to_expert10&#45;&gt;layer18_moe_expert10</title>
<path fill="none" stroke="black" d="M5099.02,-33358.02C5099.02,-33358.02 5099.02,-33332.37 5099.02,-33332.37"/>
<polygon fill="black" stroke="black" points="5102.52,-33332.37 5099.02,-33322.37 5095.52,-33332.37 5102.52,-33332.37"/>
</g>
<!-- layer18_moe_expert11 -->
<g id="node813" class="node">
<title>layer18_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5708,-33322.07 5370,-33322.07 5370,-33270.07 5708,-33270.07 5708,-33322.07"/>
<text text-anchor="middle" x="5539" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 11 L18</text>
<text text-anchor="middle" x="5539" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5539" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5539" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert11 -->
<g id="node835" class="node">
<title>layer18_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5437" cy="-33205.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5437" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5437" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5437" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer18_moe_expert11&#45;&gt;layer18_moe_comm_from_expert11 -->
<g id="edge1066" class="edge">
<title>layer18_moe_expert11&#45;&gt;layer18_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5450.88,-33269.75C5450.88,-33269.75 5450.88,-33243.89 5450.88,-33243.89"/>
<polygon fill="black" stroke="black" points="5454.38,-33243.89 5450.88,-33233.89 5447.38,-33243.89 5454.38,-33243.89"/>
</g>
<!-- layer18_moe_comm_to_expert11&#45;&gt;layer18_moe_expert11 -->
<g id="edge1035" class="edge">
<title>layer18_moe_comm_to_expert11&#45;&gt;layer18_moe_expert11</title>
<path fill="none" stroke="black" d="M5450.02,-33358.27C5450.02,-33358.27 5450.02,-33332.21 5450.02,-33332.21"/>
<polygon fill="black" stroke="black" points="5453.52,-33332.21 5450.02,-33322.21 5446.52,-33332.21 5453.52,-33332.21"/>
</g>
<!-- layer18_moe_expert12 -->
<g id="node815" class="node">
<title>layer18_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6064,-33322.07 5726,-33322.07 5726,-33270.07 6064,-33270.07 6064,-33322.07"/>
<text text-anchor="middle" x="5895" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 12 L18</text>
<text text-anchor="middle" x="5895" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5895" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5895" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert12 -->
<g id="node836" class="node">
<title>layer18_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5788" cy="-33205.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5788" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5788" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5788" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer18_moe_expert12&#45;&gt;layer18_moe_comm_from_expert12 -->
<g id="edge1068" class="edge">
<title>layer18_moe_expert12&#45;&gt;layer18_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5804.38,-33269.75C5804.38,-33269.75 5804.38,-33243.89 5804.38,-33243.89"/>
<polygon fill="black" stroke="black" points="5807.88,-33243.89 5804.38,-33233.89 5800.88,-33243.89 5807.88,-33243.89"/>
</g>
<!-- layer18_moe_comm_to_expert12&#45;&gt;layer18_moe_expert12 -->
<g id="edge1037" class="edge">
<title>layer18_moe_comm_to_expert12&#45;&gt;layer18_moe_expert12</title>
<path fill="none" stroke="black" d="M5803.52,-33358.27C5803.52,-33358.27 5803.52,-33332.21 5803.52,-33332.21"/>
<polygon fill="black" stroke="black" points="5807.02,-33332.21 5803.52,-33322.21 5800.02,-33332.21 5807.02,-33332.21"/>
</g>
<!-- layer18_moe_expert13 -->
<g id="node817" class="node">
<title>layer18_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6420,-33322.07 6082,-33322.07 6082,-33270.07 6420,-33270.07 6420,-33322.07"/>
<text text-anchor="middle" x="6251" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 13 L18</text>
<text text-anchor="middle" x="6251" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6251" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6251" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert13 -->
<g id="node837" class="node">
<title>layer18_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6142" cy="-33205.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6142" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6142" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6142" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer18_moe_expert13&#45;&gt;layer18_moe_comm_from_expert13 -->
<g id="edge1070" class="edge">
<title>layer18_moe_expert13&#45;&gt;layer18_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6159.38,-33269.75C6159.38,-33269.75 6159.38,-33243.89 6159.38,-33243.89"/>
<polygon fill="black" stroke="black" points="6162.88,-33243.89 6159.38,-33233.89 6155.88,-33243.89 6162.88,-33243.89"/>
</g>
<!-- layer18_moe_comm_to_expert13&#45;&gt;layer18_moe_expert13 -->
<g id="edge1039" class="edge">
<title>layer18_moe_comm_to_expert13&#45;&gt;layer18_moe_expert13</title>
<path fill="none" stroke="black" d="M6158.02,-33358.27C6158.02,-33358.27 6158.02,-33332.21 6158.02,-33332.21"/>
<polygon fill="black" stroke="black" points="6161.52,-33332.21 6158.02,-33322.21 6154.52,-33332.21 6161.52,-33332.21"/>
</g>
<!-- layer18_moe_expert14 -->
<g id="node819" class="node">
<title>layer18_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6776,-33322.07 6438,-33322.07 6438,-33270.07 6776,-33270.07 6776,-33322.07"/>
<text text-anchor="middle" x="6607" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 14 L18</text>
<text text-anchor="middle" x="6607" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6607" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6607" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert14 -->
<g id="node838" class="node">
<title>layer18_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6497" cy="-33205.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6497" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6497" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6497" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer18_moe_expert14&#45;&gt;layer18_moe_comm_from_expert14 -->
<g id="edge1072" class="edge">
<title>layer18_moe_expert14&#45;&gt;layer18_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6514.88,-33269.75C6514.88,-33269.75 6514.88,-33243.57 6514.88,-33243.57"/>
<polygon fill="black" stroke="black" points="6518.38,-33243.57 6514.88,-33233.57 6511.38,-33243.57 6518.38,-33243.57"/>
</g>
<!-- layer18_moe_comm_to_expert14&#45;&gt;layer18_moe_expert14 -->
<g id="edge1041" class="edge">
<title>layer18_moe_comm_to_expert14&#45;&gt;layer18_moe_expert14</title>
<path fill="none" stroke="black" d="M6513.52,-33358.27C6513.52,-33358.27 6513.52,-33332.21 6513.52,-33332.21"/>
<polygon fill="black" stroke="black" points="6517.02,-33332.21 6513.52,-33322.21 6510.02,-33332.21 6517.02,-33332.21"/>
</g>
<!-- layer18_moe_expert15 -->
<g id="node821" class="node">
<title>layer18_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7132,-33322.07 6794,-33322.07 6794,-33270.07 7132,-33270.07 7132,-33322.07"/>
<text text-anchor="middle" x="6963" y="-33310.07" font-family="Arial" font-size="10.00">EXPERT 15 L18</text>
<text text-anchor="middle" x="6963" y="-33299.07" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6963" y="-33288.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6963" y="-33277.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_comm_from_expert15 -->
<g id="node839" class="node">
<title>layer18_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6852" cy="-33205.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6852" y="-33213.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6852" y="-33202.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6852" y="-33191.58" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer18_moe_expert15&#45;&gt;layer18_moe_comm_from_expert15 -->
<g id="edge1074" class="edge">
<title>layer18_moe_expert15&#45;&gt;layer18_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6870.38,-33269.75C6870.38,-33269.75 6870.38,-33243.57 6870.38,-33243.57"/>
<polygon fill="black" stroke="black" points="6873.88,-33243.57 6870.38,-33233.57 6866.88,-33243.57 6873.88,-33243.57"/>
</g>
<!-- layer18_moe_comm_to_expert15&#45;&gt;layer18_moe_expert15 -->
<g id="edge1043" class="edge">
<title>layer18_moe_comm_to_expert15&#45;&gt;layer18_moe_expert15</title>
<path fill="none" stroke="black" d="M6869.02,-33358.27C6869.02,-33358.27 6869.02,-33332.21 6869.02,-33332.21"/>
<polygon fill="black" stroke="black" points="6872.52,-33332.21 6869.02,-33322.21 6865.52,-33332.21 6872.52,-33332.21"/>
</g>
<!-- layer18_moe_aggregate -->
<g id="node823" class="node">
<title>layer18_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4538.1,-33140.09 4121.16,-33140.09 4013.9,-33036.09 4430.84,-33036.09 4538.1,-33140.09"/>
<text text-anchor="middle" x="4276" y="-33102.09" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L18</text>
<text text-anchor="middle" x="4276" y="-33091.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4276" y="-33080.09" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4276" y="-33069.09" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_mha -->
<g id="node840" class="node">
<title>layer19_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4406,-33000.09 4146,-33000.09 4146,-32948.09 4406,-32948.09 4406,-33000.09"/>
<text text-anchor="middle" x="4276" y="-32988.09" font-family="Arial" font-size="10.00">MHA L19</text>
<text text-anchor="middle" x="4276" y="-32977.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4276" y="-32966.09" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4276" y="-32955.09" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer18_moe_aggregate&#45;&gt;layer19_moe_mha -->
<g id="edge1143" class="edge">
<title>layer18_moe_aggregate&#45;&gt;layer19_moe_mha</title>
<path fill="none" stroke="black" d="M4276,-33035.76C4276,-33035.76 4276,-33010.32 4276,-33010.32"/>
<polygon fill="black" stroke="black" points="4279.5,-33010.32 4276,-33000.32 4272.5,-33010.32 4279.5,-33010.32"/>
</g>
<!-- layer18_moe_comm_from_expert0&#45;&gt;layer18_moe_aggregate -->
<g id="edge1045" class="edge">
<title>layer18_moe_comm_from_expert0&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M1849.75,-33195.38C1849.75,-33161.43 1849.75,-33050 1849.75,-33050 1849.75,-33050 4018.03,-33050 4018.03,-33050"/>
<polygon fill="black" stroke="black" points="4018.03,-33053.5 4028.03,-33050 4018.03,-33046.5 4018.03,-33053.5"/>
</g>
<!-- layer18_moe_comm_from_expert1&#45;&gt;layer18_moe_aggregate -->
<g id="edge1047" class="edge">
<title>layer18_moe_comm_from_expert1&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M2561.25,-33194.09C2561.25,-33161.07 2561.25,-33065 2561.25,-33065 2561.25,-33065 4033.4,-33065 4033.4,-33065"/>
<polygon fill="black" stroke="black" points="4033.4,-33068.5 4043.4,-33065 4033.4,-33061.5 4033.4,-33068.5"/>
</g>
<!-- layer18_moe_comm_from_expert2&#45;&gt;layer18_moe_aggregate -->
<g id="edge1049" class="edge">
<title>layer18_moe_comm_from_expert2&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M3005.01,-33187.43C3005.01,-33152.95 3005.01,-33080 3005.01,-33080 3005.01,-33080 4048.95,-33080 4048.95,-33080"/>
<polygon fill="black" stroke="black" points="4048.95,-33083.5 4058.95,-33080 4048.95,-33076.5 4048.95,-33083.5"/>
</g>
<!-- layer18_moe_comm_from_expert3&#45;&gt;layer18_moe_aggregate -->
<g id="edge1051" class="edge">
<title>layer18_moe_comm_from_expert3&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M3333.01,-33187.4C3333.01,-33156.28 3333.01,-33095 3333.01,-33095 3333.01,-33095 4064.57,-33095 4064.57,-33095"/>
<polygon fill="black" stroke="black" points="4064.57,-33098.5 4074.57,-33095 4064.57,-33091.5 4064.57,-33098.5"/>
</g>
<!-- layer18_moe_comm_from_expert4&#45;&gt;layer18_moe_aggregate -->
<g id="edge1053" class="edge">
<title>layer18_moe_comm_from_expert4&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M3603.75,-33191.05C3603.75,-33164.6 3603.75,-33110 3603.75,-33110 3603.75,-33110 4080.08,-33110 4080.08,-33110"/>
<polygon fill="black" stroke="black" points="4080.08,-33113.5 4090.08,-33110 4080.08,-33106.5 4080.08,-33113.5"/>
</g>
<!-- layer18_moe_comm_from_expert5&#45;&gt;layer18_moe_aggregate -->
<g id="edge1055" class="edge">
<title>layer18_moe_comm_from_expert5&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M3825.5,-33186.51C3825.5,-33162.85 3825.5,-33125 3825.5,-33125 3825.5,-33125 4095.36,-33125 4095.36,-33125"/>
<polygon fill="black" stroke="black" points="4095.36,-33128.5 4105.36,-33125 4095.36,-33121.5 4095.36,-33128.5"/>
</g>
<!-- layer18_moe_comm_from_expert6&#45;&gt;layer18_moe_aggregate -->
<g id="edge1057" class="edge">
<title>layer18_moe_comm_from_expert6&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M4037.11,-33185.5C4037.11,-33185.5 4037.11,-33098.14 4037.11,-33098.14"/>
<polygon fill="black" stroke="black" points="4040.61,-33098.14 4037.11,-33088.14 4033.61,-33098.14 4040.61,-33098.14"/>
</g>
<!-- layer18_moe_comm_from_expert7&#45;&gt;layer18_moe_aggregate -->
<g id="edge1059" class="edge">
<title>layer18_moe_comm_from_expert7&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M4177,-33175.86C4177,-33175.86 4177,-33150.15 4177,-33150.15"/>
<polygon fill="black" stroke="black" points="4180.5,-33150.15 4177,-33140.15 4173.5,-33150.15 4180.5,-33150.15"/>
</g>
<!-- layer18_moe_comm_from_expert8&#45;&gt;layer18_moe_aggregate -->
<g id="edge1061" class="edge">
<title>layer18_moe_comm_from_expert8&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M4448.39,-33175.86C4448.39,-33175.86 4448.39,-33150.15 4448.39,-33150.15"/>
<polygon fill="black" stroke="black" points="4451.89,-33150.15 4448.39,-33140.15 4444.89,-33150.15 4451.89,-33150.15"/>
</g>
<!-- layer18_moe_comm_from_expert9&#45;&gt;layer18_moe_aggregate -->
<g id="edge1063" class="edge">
<title>layer18_moe_comm_from_expert9&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M4739.5,-33176.45C4739.5,-33154.17 4739.5,-33127 4739.5,-33127 4739.5,-33127 4534.71,-33127 4534.71,-33127"/>
<polygon fill="black" stroke="black" points="4534.71,-33123.5 4524.71,-33127 4534.71,-33130.5 4534.71,-33123.5"/>
</g>
<!-- layer18_moe_comm_from_expert10&#45;&gt;layer18_moe_aggregate -->
<g id="edge1065" class="edge">
<title>layer18_moe_comm_from_expert10&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M5071.15,-33176.26C5071.15,-33149.58 5071.15,-33114 5071.15,-33114 5071.15,-33114 4521.34,-33114 4521.34,-33114"/>
<polygon fill="black" stroke="black" points="4521.34,-33110.5 4511.34,-33114 4521.34,-33117.5 4521.34,-33110.5"/>
</g>
<!-- layer18_moe_comm_from_expert11&#45;&gt;layer18_moe_aggregate -->
<g id="edge1067" class="edge">
<title>layer18_moe_comm_from_expert11&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M5417.65,-33176.64C5417.65,-33145.82 5417.65,-33101 5417.65,-33101 5417.65,-33101 4507.81,-33101 4507.81,-33101"/>
<polygon fill="black" stroke="black" points="4507.81,-33097.5 4497.81,-33101 4507.81,-33104.5 4507.81,-33097.5"/>
</g>
<!-- layer18_moe_comm_from_expert12&#45;&gt;layer18_moe_aggregate -->
<g id="edge1069" class="edge">
<title>layer18_moe_comm_from_expert12&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M5768.65,-33176.44C5768.65,-33141.78 5768.65,-33088 5768.65,-33088 5768.65,-33088 4494.72,-33088 4494.72,-33088"/>
<polygon fill="black" stroke="black" points="4494.72,-33084.5 4484.72,-33088 4494.72,-33091.5 4494.72,-33084.5"/>
</g>
<!-- layer18_moe_comm_from_expert13&#45;&gt;layer18_moe_aggregate -->
<g id="edge1071" class="edge">
<title>layer18_moe_comm_from_expert13&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M6122.15,-33176.53C6122.15,-33138.24 6122.15,-33075 6122.15,-33075 6122.15,-33075 4481.39,-33075 4481.39,-33075"/>
<polygon fill="black" stroke="black" points="4481.39,-33071.5 4471.39,-33075 4481.39,-33078.5 4481.39,-33071.5"/>
</g>
<!-- layer18_moe_comm_from_expert14&#45;&gt;layer18_moe_aggregate -->
<g id="edge1073" class="edge">
<title>layer18_moe_comm_from_expert14&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M6477.15,-33176.47C6477.15,-33134.72 6477.15,-33062 6477.15,-33062 6477.15,-33062 4468,-33062 4468,-33062"/>
<polygon fill="black" stroke="black" points="4468,-33058.5 4458,-33062 4468,-33065.5 4468,-33058.5"/>
</g>
<!-- layer18_moe_comm_from_expert15&#45;&gt;layer18_moe_aggregate -->
<g id="edge1075" class="edge">
<title>layer18_moe_comm_from_expert15&#45;&gt;layer18_moe_aggregate</title>
<path fill="none" stroke="black" d="M6832.15,-33176.45C6832.15,-33131.39 6832.15,-33049 6832.15,-33049 6832.15,-33049 4454.21,-33049 4454.21,-33049"/>
<polygon fill="black" stroke="black" points="4454.21,-33045.5 4444.21,-33049 4454.21,-33052.5 4454.21,-33045.5"/>
</g>
<!-- layer19_moe_gate -->
<g id="node841" class="node">
<title>layer19_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4534.3,-32912.09 4123.4,-32912.09 4017.7,-32808.09 4428.6,-32808.09 4534.3,-32912.09"/>
<text text-anchor="middle" x="4276" y="-32874.09" font-family="Arial" font-size="10.00">GATE L19</text>
<text text-anchor="middle" x="4276" y="-32863.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4276" y="-32852.09" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4276" y="-32841.09" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer19_moe_mha&#45;&gt;layer19_moe_gate -->
<g id="edge1144" class="edge">
<title>layer19_moe_mha&#45;&gt;layer19_moe_gate</title>
<path fill="none" stroke="black" d="M4276,-32947.94C4276,-32947.94 4276,-32922.19 4276,-32922.19"/>
<polygon fill="black" stroke="black" points="4279.5,-32922.19 4276,-32912.19 4272.5,-32922.19 4279.5,-32922.19"/>
</g>
<!-- layer19_moe_split -->
<g id="node842" class="node">
<title>layer19_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4530.01,-32772.09 4125.94,-32772.09 4021.99,-32668.09 4426.06,-32668.09 4530.01,-32772.09"/>
<text text-anchor="middle" x="4276" y="-32734.09" font-family="Arial" font-size="10.00">SPLIT TOKENS L19</text>
<text text-anchor="middle" x="4276" y="-32723.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4276" y="-32712.09" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4276" y="-32701.09" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer19_moe_gate&#45;&gt;layer19_moe_split -->
<g id="edge1145" class="edge">
<title>layer19_moe_gate&#45;&gt;layer19_moe_split</title>
<path fill="none" stroke="black" d="M4276,-32807.96C4276,-32807.96 4276,-32782.26 4276,-32782.26"/>
<polygon fill="black" stroke="black" points="4279.5,-32782.26 4276,-32772.26 4272.5,-32782.27 4279.5,-32782.26"/>
</g>
<!-- layer19_moe_comm_to_expert0 -->
<g id="node844" class="node">
<title>layer19_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2195" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2195" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2195" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2195" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert0 -->
<g id="edge1079" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4110.64,-32757C3629.77,-32757 2265.75,-32757 2265.75,-32757 2265.75,-32757 2265.75,-32631.36 2265.75,-32631.36"/>
<polygon fill="black" stroke="black" points="2269.25,-32631.36 2265.75,-32621.36 2262.25,-32631.36 2269.25,-32631.36"/>
</g>
<!-- layer19_moe_comm_to_expert1 -->
<g id="node846" class="node">
<title>layer19_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2440" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2440" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2440" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2440" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert1 -->
<g id="edge1081" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4095.5,-32742C3636.09,-32742 2458.5,-32742 2458.5,-32742 2458.5,-32742 2458.5,-32641.54 2458.5,-32641.54"/>
<polygon fill="black" stroke="black" points="2462,-32641.54 2458.5,-32631.54 2455,-32641.54 2462,-32641.54"/>
</g>
<!-- layer19_moe_comm_to_expert2 -->
<g id="node848" class="node">
<title>layer19_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2896" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2896" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2896" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2896" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert2 -->
<g id="edge1083" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4080.57,-32727C3703.96,-32727 2914.5,-32727 2914.5,-32727 2914.5,-32727 2914.5,-32641.52 2914.5,-32641.52"/>
<polygon fill="black" stroke="black" points="2918,-32641.52 2914.5,-32631.52 2911,-32641.52 2918,-32641.52"/>
</g>
<!-- layer19_moe_comm_to_expert3 -->
<g id="node850" class="node">
<title>layer19_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3224" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3224" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3224" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3224" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert3 -->
<g id="edge1085" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4065.61,-32712C3763.43,-32712 3242.5,-32712 3242.5,-32712 3242.5,-32712 3242.5,-32641.71 3242.5,-32641.71"/>
<polygon fill="black" stroke="black" points="3246,-32641.71 3242.5,-32631.71 3239,-32641.71 3246,-32641.71"/>
</g>
<!-- layer19_moe_comm_to_expert4 -->
<g id="node852" class="node">
<title>layer19_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3487" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3487" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3487" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3487" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert4 -->
<g id="edge1087" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.81,-32697C3823.4,-32697 3505.5,-32697 3505.5,-32697 3505.5,-32697 3505.5,-32641.53 3505.5,-32641.53"/>
<polygon fill="black" stroke="black" points="3509,-32641.53 3505.5,-32631.53 3502,-32641.53 3509,-32641.53"/>
</g>
<!-- layer19_moe_comm_to_expert5 -->
<g id="node854" class="node">
<title>layer19_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3718" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3718" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3718" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3718" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert5 -->
<g id="edge1089" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4035.83,-32682C3891.86,-32682 3736.5,-32682 3736.5,-32682 3736.5,-32682 3736.5,-32641.58 3736.5,-32641.58"/>
<polygon fill="black" stroke="black" points="3740,-32641.58 3736.5,-32631.58 3733,-32641.58 3740,-32641.58"/>
</g>
<!-- layer19_moe_comm_to_expert6 -->
<g id="node856" class="node">
<title>layer19_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3933" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3933" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3933" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3933" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert6 -->
<g id="edge1091" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4036.5,-32720.01C4036.5,-32716.46 4036.5,-32603 4036.5,-32603 4036.5,-32603 4033.81,-32603 4033.81,-32603"/>
<polygon fill="black" stroke="black" points="4033.81,-32599.5 4023.81,-32603 4033.81,-32606.5 4033.81,-32599.5"/>
</g>
<!-- layer19_moe_comm_to_expert7 -->
<g id="node858" class="node">
<title>layer19_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4140" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4140" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4140" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4140" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert7 -->
<g id="edge1093" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4140,-32667.75C4140,-32667.75 4140,-32642.31 4140,-32642.31"/>
<polygon fill="black" stroke="black" points="4143.5,-32642.31 4140,-32632.31 4136.5,-32642.31 4143.5,-32642.31"/>
</g>
<!-- layer19_moe_comm_to_expert8 -->
<g id="node860" class="node">
<title>layer19_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4412" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4412" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4412" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4412" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert8 -->
<g id="edge1095" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4412,-32667.75C4412,-32667.75 4412,-32642.31 4412,-32642.31"/>
<polygon fill="black" stroke="black" points="4415.5,-32642.31 4412,-32632.31 4408.5,-32642.31 4415.5,-32642.31"/>
</g>
<!-- layer19_moe_comm_to_expert9 -->
<g id="node862" class="node">
<title>layer19_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4721" cy="-32603.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4721" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4721" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4721" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert9 -->
<g id="edge1097" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4516.26,-32720.01C4516.26,-32716.46 4516.26,-32603 4516.26,-32603 4516.26,-32603 4620.3,-32603 4620.3,-32603"/>
<polygon fill="black" stroke="black" points="4620.3,-32606.5 4630.3,-32603 4620.3,-32599.5 4620.3,-32606.5"/>
</g>
<!-- layer19_moe_comm_to_expert10 -->
<g id="node864" class="node">
<title>layer19_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5053" cy="-32603.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5053" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5053" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5053" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert10 -->
<g id="edge1099" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4440.38,-32682C4647.6,-32682 4977.1,-32682 4977.1,-32682 4977.1,-32682 4977.1,-32630.22 4977.1,-32630.22"/>
<polygon fill="black" stroke="black" points="4980.6,-32630.22 4977.1,-32620.22 4973.6,-32630.22 4980.6,-32630.22"/>
</g>
<!-- layer19_moe_comm_to_expert11 -->
<g id="node866" class="node">
<title>layer19_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5399" cy="-32603.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5399" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5399" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5399" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert11 -->
<g id="edge1101" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4455.2,-32697C4754.48,-32697 5323.6,-32697 5323.6,-32697 5323.6,-32697 5323.6,-32630.76 5323.6,-32630.76"/>
<polygon fill="black" stroke="black" points="5327.1,-32630.76 5323.6,-32620.76 5320.1,-32630.76 5327.1,-32630.76"/>
</g>
<!-- layer19_moe_comm_to_expert12 -->
<g id="node868" class="node">
<title>layer19_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5750" cy="-32603.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5750" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5750" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5750" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert12 -->
<g id="edge1103" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4470.1,-32712C4854.24,-32712 5674.6,-32712 5674.6,-32712 5674.6,-32712 5674.6,-32630.6 5674.6,-32630.6"/>
<polygon fill="black" stroke="black" points="5678.1,-32630.6 5674.6,-32620.6 5671.1,-32630.6 5678.1,-32630.6"/>
</g>
<!-- layer19_moe_comm_to_expert13 -->
<g id="node870" class="node">
<title>layer19_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6103" cy="-32603.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6103" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6103" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6103" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert13 -->
<g id="edge1105" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4485.17,-32727C4950,-32727 6028.1,-32727 6028.1,-32727 6028.1,-32727 6028.1,-32630.85 6028.1,-32630.85"/>
<polygon fill="black" stroke="black" points="6031.6,-32630.85 6028.1,-32620.85 6024.6,-32630.85 6031.6,-32630.85"/>
</g>
<!-- layer19_moe_comm_to_expert14 -->
<g id="node872" class="node">
<title>layer19_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6458" cy="-32603.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6458" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6458" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6458" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert14 -->
<g id="edge1107" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4500,-32742C5042.61,-32742 6383.1,-32742 6383.1,-32742 6383.1,-32742 6383.1,-32630.69 6383.1,-32630.69"/>
<polygon fill="black" stroke="black" points="6386.6,-32630.69 6383.1,-32620.69 6379.6,-32630.69 6386.6,-32630.69"/>
</g>
<!-- layer19_moe_comm_to_expert15 -->
<g id="node874" class="node">
<title>layer19_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6813" cy="-32603.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6813" y="-32611.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6813" y="-32600.6" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6813" y="-32589.6" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert15 -->
<g id="edge1109" class="edge">
<title>layer19_moe_split&#45;&gt;layer19_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4515.15,-32757C5133.66,-32757 6738.1,-32757 6738.1,-32757 6738.1,-32757 6738.1,-32630.75 6738.1,-32630.75"/>
<polygon fill="black" stroke="black" points="6741.6,-32630.75 6738.1,-32620.75 6734.6,-32630.75 6741.6,-32630.75"/>
</g>
<!-- layer19_moe_expert0 -->
<g id="node843" class="node">
<title>layer19_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1845,-32538.11 1517,-32538.11 1517,-32486.11 1845,-32486.11 1845,-32538.11"/>
<text text-anchor="middle" x="1681" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 0 L19</text>
<text text-anchor="middle" x="1681" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1681" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1681" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert0 -->
<g id="node876" class="node">
<title>layer19_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1727" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1727" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1727" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1727" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer19_moe_expert0&#45;&gt;layer19_moe_comm_from_expert0 -->
<g id="edge1111" class="edge">
<title>layer19_moe_expert0&#45;&gt;layer19_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1727,-32485.79C1727,-32485.79 1727,-32460.25 1727,-32460.25"/>
<polygon fill="black" stroke="black" points="1730.5,-32460.25 1727,-32450.25 1723.5,-32460.25 1730.5,-32460.25"/>
</g>
<!-- layer19_moe_comm_to_expert0&#45;&gt;layer19_moe_expert0 -->
<g id="edge1080" class="edge">
<title>layer19_moe_comm_to_expert0&#45;&gt;layer19_moe_expert0</title>
<path fill="none" stroke="black" d="M2104.45,-32603C1976.78,-32603 1759.25,-32603 1759.25,-32603 1759.25,-32603 1759.25,-32548.4 1759.25,-32548.4"/>
<polygon fill="black" stroke="black" points="1762.75,-32548.4 1759.25,-32538.4 1755.75,-32548.4 1762.75,-32548.4"/>
</g>
<!-- layer19_moe_expert1 -->
<g id="node845" class="node">
<title>layer19_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2191,-32538.11 1863,-32538.11 1863,-32486.11 2191,-32486.11 2191,-32538.11"/>
<text text-anchor="middle" x="2027" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 1 L19</text>
<text text-anchor="middle" x="2027" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2027" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="2027" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert1 -->
<g id="node877" class="node">
<title>layer19_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2440" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2440" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2440" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2440" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer19_moe_expert1&#45;&gt;layer19_moe_comm_from_expert1 -->
<g id="edge1113" class="edge">
<title>layer19_moe_expert1&#45;&gt;layer19_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2181.5,-32485.76C2181.5,-32458.85 2181.5,-32421 2181.5,-32421 2181.5,-32421 2339.23,-32421 2339.23,-32421"/>
<polygon fill="black" stroke="black" points="2339.23,-32424.5 2349.23,-32421 2339.23,-32417.5 2339.23,-32424.5"/>
</g>
<!-- layer19_moe_comm_to_expert1&#45;&gt;layer19_moe_expert1 -->
<g id="edge1082" class="edge">
<title>layer19_moe_comm_to_expert1&#45;&gt;layer19_moe_expert1</title>
<path fill="none" stroke="black" d="M2440,-32574.06C2440,-32560.38 2440,-32547 2440,-32547 2440,-32547 2147.75,-32547 2147.75,-32547 2147.75,-32547 2147.75,-32546.12 2147.75,-32546.12"/>
<polygon fill="black" stroke="black" points="2151.25,-32548.2 2147.75,-32538.2 2144.25,-32548.2 2151.25,-32548.2"/>
</g>
<!-- layer19_moe_expert2 -->
<g id="node847" class="node">
<title>layer19_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2537,-32538.11 2209,-32538.11 2209,-32486.11 2537,-32486.11 2537,-32538.11"/>
<text text-anchor="middle" x="2373" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 2 L19</text>
<text text-anchor="middle" x="2373" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2373" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2373" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert2 -->
<g id="node878" class="node">
<title>layer19_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2896" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2896" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2896" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2896" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer19_moe_expert2&#45;&gt;layer19_moe_comm_from_expert2 -->
<g id="edge1115" class="edge">
<title>layer19_moe_expert2&#45;&gt;layer19_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2537.18,-32503C2544.6,-32503 2549,-32503 2549,-32503 2549,-32503 2549,-32421 2549,-32421 2549,-32421 2795.28,-32421 2795.28,-32421"/>
<polygon fill="black" stroke="black" points="2795.28,-32424.5 2805.28,-32421 2795.28,-32417.5 2795.28,-32424.5"/>
</g>
<!-- layer19_moe_comm_to_expert2&#45;&gt;layer19_moe_expert2 -->
<g id="edge1084" class="edge">
<title>layer19_moe_comm_to_expert2&#45;&gt;layer19_moe_expert2</title>
<path fill="none" stroke="black" d="M2805.09,-32603C2700.5,-32603 2543,-32603 2543,-32603 2543,-32603 2543,-32520 2543,-32520 2543,-32520 2542.43,-32520 2542.43,-32520"/>
<polygon fill="black" stroke="black" points="2547.34,-32516.5 2537.34,-32520 2547.34,-32523.5 2547.34,-32516.5"/>
</g>
<!-- layer19_moe_expert3 -->
<g id="node849" class="node">
<title>layer19_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2883,-32538.11 2555,-32538.11 2555,-32486.11 2883,-32486.11 2883,-32538.11"/>
<text text-anchor="middle" x="2719" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 3 L19</text>
<text text-anchor="middle" x="2719" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2719" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2719" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert3 -->
<g id="node879" class="node">
<title>layer19_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3224" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3224" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3224" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3224" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer19_moe_expert3&#45;&gt;layer19_moe_comm_from_expert3 -->
<g id="edge1117" class="edge">
<title>layer19_moe_expert3&#45;&gt;layer19_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2844.25,-32485.88C2844.25,-32473.76 2844.25,-32462 2844.25,-32462 2844.25,-32462 3165.33,-32462 3165.33,-32462 3165.33,-32462 3165.33,-32453.47 3165.33,-32453.47"/>
<polygon fill="black" stroke="black" points="3168.83,-32453.47 3165.33,-32443.47 3161.83,-32453.47 3168.83,-32453.47"/>
</g>
<!-- layer19_moe_comm_to_expert3&#45;&gt;layer19_moe_expert3 -->
<g id="edge1086" class="edge">
<title>layer19_moe_comm_to_expert3&#45;&gt;layer19_moe_expert3</title>
<path fill="none" stroke="black" d="M3165.33,-32580.94C3165.33,-32572.56 3165.33,-32565 3165.33,-32565 3165.33,-32565 2844.25,-32565 2844.25,-32565 2844.25,-32565 2844.25,-32548.24 2844.25,-32548.24"/>
<polygon fill="black" stroke="black" points="2847.75,-32548.24 2844.25,-32538.24 2840.75,-32548.24 2847.75,-32548.24"/>
</g>
<!-- layer19_moe_expert4 -->
<g id="node851" class="node">
<title>layer19_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3229,-32538.11 2901,-32538.11 2901,-32486.11 3229,-32486.11 3229,-32538.11"/>
<text text-anchor="middle" x="3065" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 4 L19</text>
<text text-anchor="middle" x="3065" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3065" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3065" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert4 -->
<g id="node880" class="node">
<title>layer19_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3487" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3487" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3487" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3487" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer19_moe_expert4&#45;&gt;layer19_moe_comm_from_expert4 -->
<g id="edge1119" class="edge">
<title>layer19_moe_expert4&#45;&gt;layer19_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3197.16,-32486.06C3197.16,-32479.36 3197.16,-32474 3197.16,-32474 3197.16,-32474 3485.75,-32474 3485.75,-32474 3485.75,-32474 3485.75,-32460.34 3485.75,-32460.34"/>
<polygon fill="black" stroke="black" points="3489.25,-32460.34 3485.75,-32450.34 3482.25,-32460.34 3489.25,-32460.34"/>
</g>
<!-- layer19_moe_comm_to_expert4&#45;&gt;layer19_moe_expert4 -->
<g id="edge1088" class="edge">
<title>layer19_moe_comm_to_expert4&#45;&gt;layer19_moe_expert4</title>
<path fill="none" stroke="black" d="M3485.75,-32574.08C3485.75,-32564.38 3485.75,-32556 3485.75,-32556 3485.75,-32556 3197.16,-32556 3197.16,-32556 3197.16,-32556 3197.16,-32548.15 3197.16,-32548.15"/>
<polygon fill="black" stroke="black" points="3200.66,-32548.15 3197.16,-32538.15 3193.66,-32548.15 3200.66,-32548.15"/>
</g>
<!-- layer19_moe_expert5 -->
<g id="node853" class="node">
<title>layer19_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3575,-32538.11 3247,-32538.11 3247,-32486.11 3575,-32486.11 3575,-32538.11"/>
<text text-anchor="middle" x="3411" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 5 L19</text>
<text text-anchor="middle" x="3411" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3411" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3411" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert5 -->
<g id="node881" class="node">
<title>layer19_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3718" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3718" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3718" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3718" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer19_moe_expert5&#45;&gt;layer19_moe_comm_from_expert5 -->
<g id="edge1121" class="edge">
<title>layer19_moe_expert5&#45;&gt;layer19_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3575.21,-32503C3582.1,-32503 3586.16,-32503 3586.16,-32503 3586.16,-32503 3586.16,-32421 3586.16,-32421 3586.16,-32421 3617.15,-32421 3617.15,-32421"/>
<polygon fill="black" stroke="black" points="3617.15,-32424.5 3627.15,-32421 3617.15,-32417.5 3617.15,-32424.5"/>
</g>
<!-- layer19_moe_comm_to_expert5&#45;&gt;layer19_moe_expert5 -->
<g id="edge1090" class="edge">
<title>layer19_moe_comm_to_expert5&#45;&gt;layer19_moe_expert5</title>
<path fill="none" stroke="black" d="M3627.18,-32603C3602.2,-32603 3581.84,-32603 3581.84,-32603 3581.84,-32603 3581.84,-32520 3581.84,-32520 3581.84,-32520 3581.19,-32520 3581.19,-32520"/>
<polygon fill="black" stroke="black" points="3585.35,-32516.5 3575.35,-32520 3585.35,-32523.5 3585.35,-32516.5"/>
</g>
<!-- layer19_moe_expert6 -->
<g id="node855" class="node">
<title>layer19_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3921,-32538.11 3593,-32538.11 3593,-32486.11 3921,-32486.11 3921,-32538.11"/>
<text text-anchor="middle" x="3757" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 6 L19</text>
<text text-anchor="middle" x="3757" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3757" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3757" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert6 -->
<g id="node882" class="node">
<title>layer19_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3933" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3933" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3933" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3933" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer19_moe_expert6&#45;&gt;layer19_moe_comm_from_expert6 -->
<g id="edge1123" class="edge">
<title>layer19_moe_expert6&#45;&gt;layer19_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3881.75,-32485.79C3881.75,-32485.79 3881.75,-32455.2 3881.75,-32455.2"/>
<polygon fill="black" stroke="black" points="3885.25,-32455.2 3881.75,-32445.2 3878.25,-32455.2 3885.25,-32455.2"/>
</g>
<!-- layer19_moe_comm_to_expert6&#45;&gt;layer19_moe_expert6 -->
<g id="edge1092" class="edge">
<title>layer19_moe_comm_to_expert6&#45;&gt;layer19_moe_expert6</title>
<path fill="none" stroke="black" d="M3881.75,-32579.19C3881.75,-32579.19 3881.75,-32548.41 3881.75,-32548.41"/>
<polygon fill="black" stroke="black" points="3885.25,-32548.41 3881.75,-32538.41 3878.25,-32548.41 3885.25,-32548.41"/>
</g>
<!-- layer19_moe_expert7 -->
<g id="node857" class="node">
<title>layer19_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4267,-32538.11 3939,-32538.11 3939,-32486.11 4267,-32486.11 4267,-32538.11"/>
<text text-anchor="middle" x="4103" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 7 L19</text>
<text text-anchor="middle" x="4103" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4103" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4103" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert7 -->
<g id="node883" class="node">
<title>layer19_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4140" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4140" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4140" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4140" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer19_moe_expert7&#45;&gt;layer19_moe_comm_from_expert7 -->
<g id="edge1125" class="edge">
<title>layer19_moe_expert7&#45;&gt;layer19_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4140,-32485.79C4140,-32485.79 4140,-32460.25 4140,-32460.25"/>
<polygon fill="black" stroke="black" points="4143.5,-32460.25 4140,-32450.25 4136.5,-32460.25 4143.5,-32460.25"/>
</g>
<!-- layer19_moe_comm_to_expert7&#45;&gt;layer19_moe_expert7 -->
<g id="edge1094" class="edge">
<title>layer19_moe_comm_to_expert7&#45;&gt;layer19_moe_expert7</title>
<path fill="none" stroke="black" d="M4140,-32574.06C4140,-32574.06 4140,-32548.41 4140,-32548.41"/>
<polygon fill="black" stroke="black" points="4143.5,-32548.41 4140,-32538.41 4136.5,-32548.41 4143.5,-32548.41"/>
</g>
<!-- layer19_moe_expert8 -->
<g id="node859" class="node">
<title>layer19_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4613,-32538.11 4285,-32538.11 4285,-32486.11 4613,-32486.11 4613,-32538.11"/>
<text text-anchor="middle" x="4449" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 8 L19</text>
<text text-anchor="middle" x="4449" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4449" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4449" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert8 -->
<g id="node884" class="node">
<title>layer19_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4412" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4412" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4412" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4412" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer19_moe_expert8&#45;&gt;layer19_moe_comm_from_expert8 -->
<g id="edge1127" class="edge">
<title>layer19_moe_expert8&#45;&gt;layer19_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4412,-32485.79C4412,-32485.79 4412,-32460.25 4412,-32460.25"/>
<polygon fill="black" stroke="black" points="4415.5,-32460.25 4412,-32450.25 4408.5,-32460.25 4415.5,-32460.25"/>
</g>
<!-- layer19_moe_comm_to_expert8&#45;&gt;layer19_moe_expert8 -->
<g id="edge1096" class="edge">
<title>layer19_moe_comm_to_expert8&#45;&gt;layer19_moe_expert8</title>
<path fill="none" stroke="black" d="M4412,-32574.06C4412,-32574.06 4412,-32548.41 4412,-32548.41"/>
<polygon fill="black" stroke="black" points="4415.5,-32548.41 4412,-32538.41 4408.5,-32548.41 4415.5,-32548.41"/>
</g>
<!-- layer19_moe_expert9 -->
<g id="node861" class="node">
<title>layer19_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4959,-32538.11 4631,-32538.11 4631,-32486.11 4959,-32486.11 4959,-32538.11"/>
<text text-anchor="middle" x="4795" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 9 L19</text>
<text text-anchor="middle" x="4795" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4795" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4795" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert9 -->
<g id="node885" class="node">
<title>layer19_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4721" cy="-32421.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4721" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4721" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4721" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer19_moe_expert9&#45;&gt;layer19_moe_comm_from_expert9 -->
<g id="edge1129" class="edge">
<title>layer19_moe_expert9&#45;&gt;layer19_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4721.25,-32485.79C4721.25,-32485.79 4721.25,-32460.25 4721.25,-32460.25"/>
<polygon fill="black" stroke="black" points="4724.75,-32460.25 4721.25,-32450.25 4717.75,-32460.25 4724.75,-32460.25"/>
</g>
<!-- layer19_moe_comm_to_expert9&#45;&gt;layer19_moe_expert9 -->
<g id="edge1098" class="edge">
<title>layer19_moe_comm_to_expert9&#45;&gt;layer19_moe_expert9</title>
<path fill="none" stroke="black" d="M4721.25,-32574.06C4721.25,-32574.06 4721.25,-32548.41 4721.25,-32548.41"/>
<polygon fill="black" stroke="black" points="4724.75,-32548.41 4721.25,-32538.41 4717.75,-32548.41 4724.75,-32548.41"/>
</g>
<!-- layer19_moe_expert10 -->
<g id="node863" class="node">
<title>layer19_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5315,-32538.11 4977,-32538.11 4977,-32486.11 5315,-32486.11 5315,-32538.11"/>
<text text-anchor="middle" x="5146" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 10 L19</text>
<text text-anchor="middle" x="5146" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5146" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5146" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert10 -->
<g id="node886" class="node">
<title>layer19_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5053" cy="-32421.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5053" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5053" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5053" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer19_moe_expert10&#45;&gt;layer19_moe_comm_from_expert10 -->
<g id="edge1131" class="edge">
<title>layer19_moe_expert10&#45;&gt;layer19_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5062.38,-32485.79C5062.38,-32485.79 5062.38,-32460.25 5062.38,-32460.25"/>
<polygon fill="black" stroke="black" points="5065.88,-32460.25 5062.38,-32450.25 5058.88,-32460.25 5065.88,-32460.25"/>
</g>
<!-- layer19_moe_comm_to_expert10&#45;&gt;layer19_moe_expert10 -->
<g id="edge1100" class="edge">
<title>layer19_moe_comm_to_expert10&#45;&gt;layer19_moe_expert10</title>
<path fill="none" stroke="black" d="M5062.02,-32574.06C5062.02,-32574.06 5062.02,-32548.41 5062.02,-32548.41"/>
<polygon fill="black" stroke="black" points="5065.52,-32548.41 5062.02,-32538.41 5058.52,-32548.41 5065.52,-32548.41"/>
</g>
<!-- layer19_moe_expert11 -->
<g id="node865" class="node">
<title>layer19_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5671,-32538.11 5333,-32538.11 5333,-32486.11 5671,-32486.11 5671,-32538.11"/>
<text text-anchor="middle" x="5502" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 11 L19</text>
<text text-anchor="middle" x="5502" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5502" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5502" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert11 -->
<g id="node887" class="node">
<title>layer19_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5400" cy="-32421.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5400" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5400" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5400" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer19_moe_expert11&#45;&gt;layer19_moe_comm_from_expert11 -->
<g id="edge1133" class="edge">
<title>layer19_moe_expert11&#45;&gt;layer19_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5413.88,-32485.79C5413.88,-32485.79 5413.88,-32459.92 5413.88,-32459.92"/>
<polygon fill="black" stroke="black" points="5417.38,-32459.92 5413.88,-32449.92 5410.38,-32459.92 5417.38,-32459.92"/>
</g>
<!-- layer19_moe_comm_to_expert11&#45;&gt;layer19_moe_expert11 -->
<g id="edge1102" class="edge">
<title>layer19_moe_comm_to_expert11&#45;&gt;layer19_moe_expert11</title>
<path fill="none" stroke="black" d="M5413.02,-32574.31C5413.02,-32574.31 5413.02,-32548.24 5413.02,-32548.24"/>
<polygon fill="black" stroke="black" points="5416.52,-32548.24 5413.02,-32538.24 5409.52,-32548.24 5416.52,-32548.24"/>
</g>
<!-- layer19_moe_expert12 -->
<g id="node867" class="node">
<title>layer19_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="6027,-32538.11 5689,-32538.11 5689,-32486.11 6027,-32486.11 6027,-32538.11"/>
<text text-anchor="middle" x="5858" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 12 L19</text>
<text text-anchor="middle" x="5858" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5858" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5858" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert12 -->
<g id="node888" class="node">
<title>layer19_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5751" cy="-32421.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5751" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5751" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5751" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer19_moe_expert12&#45;&gt;layer19_moe_comm_from_expert12 -->
<g id="edge1135" class="edge">
<title>layer19_moe_expert12&#45;&gt;layer19_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5767.38,-32485.79C5767.38,-32485.79 5767.38,-32459.92 5767.38,-32459.92"/>
<polygon fill="black" stroke="black" points="5770.88,-32459.92 5767.38,-32449.92 5763.88,-32459.92 5770.88,-32459.92"/>
</g>
<!-- layer19_moe_comm_to_expert12&#45;&gt;layer19_moe_expert12 -->
<g id="edge1104" class="edge">
<title>layer19_moe_comm_to_expert12&#45;&gt;layer19_moe_expert12</title>
<path fill="none" stroke="black" d="M5766.52,-32574.31C5766.52,-32574.31 5766.52,-32548.24 5766.52,-32548.24"/>
<polygon fill="black" stroke="black" points="5770.02,-32548.24 5766.52,-32538.24 5763.02,-32548.24 5770.02,-32548.24"/>
</g>
<!-- layer19_moe_expert13 -->
<g id="node869" class="node">
<title>layer19_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6383,-32538.11 6045,-32538.11 6045,-32486.11 6383,-32486.11 6383,-32538.11"/>
<text text-anchor="middle" x="6214" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 13 L19</text>
<text text-anchor="middle" x="6214" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6214" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6214" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert13 -->
<g id="node889" class="node">
<title>layer19_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6105" cy="-32421.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6105" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6105" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6105" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer19_moe_expert13&#45;&gt;layer19_moe_comm_from_expert13 -->
<g id="edge1137" class="edge">
<title>layer19_moe_expert13&#45;&gt;layer19_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6122.38,-32485.79C6122.38,-32485.79 6122.38,-32459.92 6122.38,-32459.92"/>
<polygon fill="black" stroke="black" points="6125.88,-32459.92 6122.38,-32449.92 6118.88,-32459.92 6125.88,-32459.92"/>
</g>
<!-- layer19_moe_comm_to_expert13&#45;&gt;layer19_moe_expert13 -->
<g id="edge1106" class="edge">
<title>layer19_moe_comm_to_expert13&#45;&gt;layer19_moe_expert13</title>
<path fill="none" stroke="black" d="M6121.02,-32574.31C6121.02,-32574.31 6121.02,-32548.24 6121.02,-32548.24"/>
<polygon fill="black" stroke="black" points="6124.52,-32548.24 6121.02,-32538.24 6117.52,-32548.24 6124.52,-32548.24"/>
</g>
<!-- layer19_moe_expert14 -->
<g id="node871" class="node">
<title>layer19_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6739,-32538.11 6401,-32538.11 6401,-32486.11 6739,-32486.11 6739,-32538.11"/>
<text text-anchor="middle" x="6570" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 14 L19</text>
<text text-anchor="middle" x="6570" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6570" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6570" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert14 -->
<g id="node890" class="node">
<title>layer19_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6460" cy="-32421.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6460" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6460" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6460" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer19_moe_expert14&#45;&gt;layer19_moe_comm_from_expert14 -->
<g id="edge1139" class="edge">
<title>layer19_moe_expert14&#45;&gt;layer19_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6477.88,-32485.79C6477.88,-32485.79 6477.88,-32459.6 6477.88,-32459.6"/>
<polygon fill="black" stroke="black" points="6481.38,-32459.6 6477.88,-32449.6 6474.38,-32459.6 6481.38,-32459.6"/>
</g>
<!-- layer19_moe_comm_to_expert14&#45;&gt;layer19_moe_expert14 -->
<g id="edge1108" class="edge">
<title>layer19_moe_comm_to_expert14&#45;&gt;layer19_moe_expert14</title>
<path fill="none" stroke="black" d="M6476.52,-32574.31C6476.52,-32574.31 6476.52,-32548.24 6476.52,-32548.24"/>
<polygon fill="black" stroke="black" points="6480.02,-32548.24 6476.52,-32538.24 6473.02,-32548.24 6480.02,-32548.24"/>
</g>
<!-- layer19_moe_expert15 -->
<g id="node873" class="node">
<title>layer19_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7095,-32538.11 6757,-32538.11 6757,-32486.11 7095,-32486.11 7095,-32538.11"/>
<text text-anchor="middle" x="6926" y="-32526.11" font-family="Arial" font-size="10.00">EXPERT 15 L19</text>
<text text-anchor="middle" x="6926" y="-32515.11" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6926" y="-32504.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6926" y="-32493.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_comm_from_expert15 -->
<g id="node891" class="node">
<title>layer19_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6815" cy="-32421.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6815" y="-32429.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6815" y="-32418.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6815" y="-32407.62" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer19_moe_expert15&#45;&gt;layer19_moe_comm_from_expert15 -->
<g id="edge1141" class="edge">
<title>layer19_moe_expert15&#45;&gt;layer19_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6833.38,-32485.79C6833.38,-32485.79 6833.38,-32459.6 6833.38,-32459.6"/>
<polygon fill="black" stroke="black" points="6836.88,-32459.6 6833.38,-32449.6 6829.88,-32459.6 6836.88,-32459.6"/>
</g>
<!-- layer19_moe_comm_to_expert15&#45;&gt;layer19_moe_expert15 -->
<g id="edge1110" class="edge">
<title>layer19_moe_comm_to_expert15&#45;&gt;layer19_moe_expert15</title>
<path fill="none" stroke="black" d="M6832.02,-32574.31C6832.02,-32574.31 6832.02,-32548.24 6832.02,-32548.24"/>
<polygon fill="black" stroke="black" points="6835.52,-32548.24 6832.02,-32538.24 6828.52,-32548.24 6835.52,-32548.24"/>
</g>
<!-- layer19_moe_aggregate -->
<g id="node875" class="node">
<title>layer19_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4501.1,-32356.13 4084.16,-32356.13 3976.9,-32252.13 4393.84,-32252.13 4501.1,-32356.13"/>
<text text-anchor="middle" x="4239" y="-32318.13" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L19</text>
<text text-anchor="middle" x="4239" y="-32307.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4239" y="-32296.13" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4239" y="-32285.13" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_mha -->
<g id="node892" class="node">
<title>layer20_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4369,-32216.13 4109,-32216.13 4109,-32164.13 4369,-32164.13 4369,-32216.13"/>
<text text-anchor="middle" x="4239" y="-32204.13" font-family="Arial" font-size="10.00">MHA L20</text>
<text text-anchor="middle" x="4239" y="-32193.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4239" y="-32182.13" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4239" y="-32171.13" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer19_moe_aggregate&#45;&gt;layer20_moe_mha -->
<g id="edge1210" class="edge">
<title>layer19_moe_aggregate&#45;&gt;layer20_moe_mha</title>
<path fill="none" stroke="black" d="M4239,-32251.8C4239,-32251.8 4239,-32226.35 4239,-32226.35"/>
<polygon fill="black" stroke="black" points="4242.5,-32226.35 4239,-32216.35 4235.5,-32226.35 4242.5,-32226.35"/>
</g>
<!-- layer19_moe_comm_from_expert0&#45;&gt;layer19_moe_aggregate -->
<g id="edge1112" class="edge">
<title>layer19_moe_comm_from_expert0&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M1812.75,-32411.41C1812.75,-32377.45 1812.75,-32266 1812.75,-32266 1812.75,-32266 3981.03,-32266 3981.03,-32266"/>
<polygon fill="black" stroke="black" points="3981.03,-32269.5 3991.03,-32266 3981.03,-32262.5 3981.03,-32269.5"/>
</g>
<!-- layer19_moe_comm_from_expert1&#45;&gt;layer19_moe_aggregate -->
<g id="edge1114" class="edge">
<title>layer19_moe_comm_from_expert1&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M2524.25,-32410.12C2524.25,-32377.09 2524.25,-32281 2524.25,-32281 2524.25,-32281 3996.4,-32281 3996.4,-32281"/>
<polygon fill="black" stroke="black" points="3996.4,-32284.5 4006.4,-32281 3996.4,-32277.5 3996.4,-32284.5"/>
</g>
<!-- layer19_moe_comm_from_expert2&#45;&gt;layer19_moe_aggregate -->
<g id="edge1116" class="edge">
<title>layer19_moe_comm_from_expert2&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M2968.01,-32403.46C2968.01,-32368.97 2968.01,-32296 2968.01,-32296 2968.01,-32296 4011.95,-32296 4011.95,-32296"/>
<polygon fill="black" stroke="black" points="4011.95,-32299.5 4021.95,-32296 4011.95,-32292.5 4011.95,-32299.5"/>
</g>
<!-- layer19_moe_comm_from_expert3&#45;&gt;layer19_moe_aggregate -->
<g id="edge1118" class="edge">
<title>layer19_moe_comm_from_expert3&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M3296.01,-32403.42C3296.01,-32372.3 3296.01,-32311 3296.01,-32311 3296.01,-32311 4027.57,-32311 4027.57,-32311"/>
<polygon fill="black" stroke="black" points="4027.57,-32314.5 4037.57,-32311 4027.57,-32307.5 4027.57,-32314.5"/>
</g>
<!-- layer19_moe_comm_from_expert4&#45;&gt;layer19_moe_aggregate -->
<g id="edge1120" class="edge">
<title>layer19_moe_comm_from_expert4&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M3566.75,-32407.08C3566.75,-32380.62 3566.75,-32326 3566.75,-32326 3566.75,-32326 4043.08,-32326 4043.08,-32326"/>
<polygon fill="black" stroke="black" points="4043.08,-32329.5 4053.08,-32326 4043.08,-32322.5 4043.08,-32329.5"/>
</g>
<!-- layer19_moe_comm_from_expert5&#45;&gt;layer19_moe_aggregate -->
<g id="edge1122" class="edge">
<title>layer19_moe_comm_from_expert5&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M3788.5,-32402.53C3788.5,-32378.87 3788.5,-32341 3788.5,-32341 3788.5,-32341 4058.36,-32341 4058.36,-32341"/>
<polygon fill="black" stroke="black" points="4058.36,-32344.5 4068.36,-32341 4058.36,-32337.5 4058.36,-32344.5"/>
</g>
<!-- layer19_moe_comm_from_expert6&#45;&gt;layer19_moe_aggregate -->
<g id="edge1124" class="edge">
<title>layer19_moe_comm_from_expert6&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M4000.11,-32401.53C4000.11,-32401.53 4000.11,-32314.17 4000.11,-32314.17"/>
<polygon fill="black" stroke="black" points="4003.61,-32314.17 4000.11,-32304.17 3996.61,-32314.17 4003.61,-32314.17"/>
</g>
<!-- layer19_moe_comm_from_expert7&#45;&gt;layer19_moe_aggregate -->
<g id="edge1126" class="edge">
<title>layer19_moe_comm_from_expert7&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M4140,-32391.9C4140,-32391.9 4140,-32366.18 4140,-32366.18"/>
<polygon fill="black" stroke="black" points="4143.5,-32366.18 4140,-32356.18 4136.5,-32366.18 4143.5,-32366.18"/>
</g>
<!-- layer19_moe_comm_from_expert8&#45;&gt;layer19_moe_aggregate -->
<g id="edge1128" class="edge">
<title>layer19_moe_comm_from_expert8&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M4411.39,-32391.9C4411.39,-32391.9 4411.39,-32366.18 4411.39,-32366.18"/>
<polygon fill="black" stroke="black" points="4414.89,-32366.18 4411.39,-32356.18 4407.89,-32366.18 4414.89,-32366.18"/>
</g>
<!-- layer19_moe_comm_from_expert9&#45;&gt;layer19_moe_aggregate -->
<g id="edge1130" class="edge">
<title>layer19_moe_comm_from_expert9&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M4702.5,-32392.47C4702.5,-32370.18 4702.5,-32343 4702.5,-32343 4702.5,-32343 4497.71,-32343 4497.71,-32343"/>
<polygon fill="black" stroke="black" points="4497.71,-32339.5 4487.71,-32343 4497.71,-32346.5 4497.71,-32339.5"/>
</g>
<!-- layer19_moe_comm_from_expert10&#45;&gt;layer19_moe_aggregate -->
<g id="edge1132" class="edge">
<title>layer19_moe_comm_from_expert10&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M5034.15,-32392.29C5034.15,-32365.59 5034.15,-32330 5034.15,-32330 5034.15,-32330 4484.34,-32330 4484.34,-32330"/>
<polygon fill="black" stroke="black" points="4484.34,-32326.5 4474.34,-32330 4484.34,-32333.5 4484.34,-32326.5"/>
</g>
<!-- layer19_moe_comm_from_expert11&#45;&gt;layer19_moe_aggregate -->
<g id="edge1134" class="edge">
<title>layer19_moe_comm_from_expert11&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M5380.65,-32392.67C5380.65,-32361.84 5380.65,-32317 5380.65,-32317 5380.65,-32317 4470.81,-32317 4470.81,-32317"/>
<polygon fill="black" stroke="black" points="4470.81,-32313.5 4460.81,-32317 4470.81,-32320.5 4470.81,-32313.5"/>
</g>
<!-- layer19_moe_comm_from_expert12&#45;&gt;layer19_moe_aggregate -->
<g id="edge1136" class="edge">
<title>layer19_moe_comm_from_expert12&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M5731.65,-32392.47C5731.65,-32357.79 5731.65,-32304 5731.65,-32304 5731.65,-32304 4457.72,-32304 4457.72,-32304"/>
<polygon fill="black" stroke="black" points="4457.72,-32300.5 4447.72,-32304 4457.72,-32307.5 4457.72,-32300.5"/>
</g>
<!-- layer19_moe_comm_from_expert13&#45;&gt;layer19_moe_aggregate -->
<g id="edge1138" class="edge">
<title>layer19_moe_comm_from_expert13&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M6085.15,-32392.56C6085.15,-32354.26 6085.15,-32291 6085.15,-32291 6085.15,-32291 4443.95,-32291 4443.95,-32291"/>
<polygon fill="black" stroke="black" points="4443.95,-32287.5 4433.95,-32291 4443.95,-32294.5 4443.95,-32287.5"/>
</g>
<!-- layer19_moe_comm_from_expert14&#45;&gt;layer19_moe_aggregate -->
<g id="edge1140" class="edge">
<title>layer19_moe_comm_from_expert14&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M6440.15,-32392.5C6440.15,-32350.73 6440.15,-32278 6440.15,-32278 6440.15,-32278 4430.53,-32278 4430.53,-32278"/>
<polygon fill="black" stroke="black" points="4430.53,-32274.5 4420.53,-32278 4430.53,-32281.5 4430.53,-32274.5"/>
</g>
<!-- layer19_moe_comm_from_expert15&#45;&gt;layer19_moe_aggregate -->
<g id="edge1142" class="edge">
<title>layer19_moe_comm_from_expert15&#45;&gt;layer19_moe_aggregate</title>
<path fill="none" stroke="black" d="M6795.15,-32392.48C6795.15,-32347.41 6795.15,-32265 6795.15,-32265 6795.15,-32265 4417.21,-32265 4417.21,-32265"/>
<polygon fill="black" stroke="black" points="4417.21,-32261.5 4407.21,-32265 4417.21,-32268.5 4417.21,-32261.5"/>
</g>
<!-- layer20_moe_gate -->
<g id="node893" class="node">
<title>layer20_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4497.3,-32128.13 4086.4,-32128.13 3980.7,-32024.13 4391.6,-32024.13 4497.3,-32128.13"/>
<text text-anchor="middle" x="4239" y="-32090.13" font-family="Arial" font-size="10.00">GATE L20</text>
<text text-anchor="middle" x="4239" y="-32079.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4239" y="-32068.13" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4239" y="-32057.13" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer20_moe_mha&#45;&gt;layer20_moe_gate -->
<g id="edge1211" class="edge">
<title>layer20_moe_mha&#45;&gt;layer20_moe_gate</title>
<path fill="none" stroke="black" d="M4239,-32163.97C4239,-32163.97 4239,-32138.22 4239,-32138.22"/>
<polygon fill="black" stroke="black" points="4242.5,-32138.22 4239,-32128.22 4235.5,-32138.22 4242.5,-32138.22"/>
</g>
<!-- layer20_moe_split -->
<g id="node894" class="node">
<title>layer20_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4493.01,-31988.13 4088.94,-31988.13 3984.99,-31884.13 4389.06,-31884.13 4493.01,-31988.13"/>
<text text-anchor="middle" x="4239" y="-31950.13" font-family="Arial" font-size="10.00">SPLIT TOKENS L20</text>
<text text-anchor="middle" x="4239" y="-31939.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4239" y="-31928.13" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4239" y="-31917.13" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer20_moe_gate&#45;&gt;layer20_moe_split -->
<g id="edge1212" class="edge">
<title>layer20_moe_gate&#45;&gt;layer20_moe_split</title>
<path fill="none" stroke="black" d="M4239,-32023.99C4239,-32023.99 4239,-31998.3 4239,-31998.3"/>
<polygon fill="black" stroke="black" points="4242.5,-31998.3 4239,-31988.3 4235.5,-31998.3 4242.5,-31998.3"/>
</g>
<!-- layer20_moe_comm_to_expert0 -->
<g id="node896" class="node">
<title>layer20_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1690" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1690" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1690" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1690" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert0 -->
<g id="edge1146" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4073.46,-31973C3511.04,-31973 1708.5,-31973 1708.5,-31973 1708.5,-31973 1708.5,-31857.71 1708.5,-31857.71"/>
<polygon fill="black" stroke="black" points="1712,-31857.71 1708.5,-31847.71 1705,-31857.71 1712,-31857.71"/>
</g>
<!-- layer20_moe_comm_to_expert1 -->
<g id="node898" class="node">
<title>layer20_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2403" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2403" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2403" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2403" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert1 -->
<g id="edge1148" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4058.5,-31958C3599.09,-31958 2421.5,-31958 2421.5,-31958 2421.5,-31958 2421.5,-31857.57 2421.5,-31857.57"/>
<polygon fill="black" stroke="black" points="2425,-31857.57 2421.5,-31847.57 2418,-31857.57 2425,-31857.57"/>
</g>
<!-- layer20_moe_comm_to_expert2 -->
<g id="node900" class="node">
<title>layer20_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2859" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2859" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2859" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2859" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert2 -->
<g id="edge1150" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4043.57,-31943C3666.96,-31943 2877.5,-31943 2877.5,-31943 2877.5,-31943 2877.5,-31857.55 2877.5,-31857.55"/>
<polygon fill="black" stroke="black" points="2881,-31857.55 2877.5,-31847.55 2874,-31857.55 2881,-31857.55"/>
</g>
<!-- layer20_moe_comm_to_expert3 -->
<g id="node902" class="node">
<title>layer20_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3187" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3187" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3187" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3187" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert3 -->
<g id="edge1152" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4028.61,-31928C3726.43,-31928 3205.5,-31928 3205.5,-31928 3205.5,-31928 3205.5,-31857.74 3205.5,-31857.74"/>
<polygon fill="black" stroke="black" points="3209,-31857.74 3205.5,-31847.74 3202,-31857.74 3209,-31857.74"/>
</g>
<!-- layer20_moe_comm_to_expert4 -->
<g id="node904" class="node">
<title>layer20_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3450" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3450" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3450" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3450" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert4 -->
<g id="edge1154" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4013.81,-31913C3786.4,-31913 3468.5,-31913 3468.5,-31913 3468.5,-31913 3468.5,-31857.55 3468.5,-31857.55"/>
<polygon fill="black" stroke="black" points="3472,-31857.55 3468.5,-31847.55 3465,-31857.55 3472,-31857.55"/>
</g>
<!-- layer20_moe_comm_to_expert5 -->
<g id="node906" class="node">
<title>layer20_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3681" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3681" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3681" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3681" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert5 -->
<g id="edge1156" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3998.83,-31898C3854.86,-31898 3699.5,-31898 3699.5,-31898 3699.5,-31898 3699.5,-31857.61 3699.5,-31857.61"/>
<polygon fill="black" stroke="black" points="3703,-31857.61 3699.5,-31847.61 3696,-31857.61 3703,-31857.61"/>
</g>
<!-- layer20_moe_comm_to_expert6 -->
<g id="node908" class="node">
<title>layer20_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3896" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3896" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3896" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3896" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert6 -->
<g id="edge1158" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3999.5,-31936.04C3999.5,-31932.49 3999.5,-31819 3999.5,-31819 3999.5,-31819 3996.81,-31819 3996.81,-31819"/>
<polygon fill="black" stroke="black" points="3996.81,-31815.5 3986.81,-31819 3996.81,-31822.5 3996.81,-31815.5"/>
</g>
<!-- layer20_moe_comm_to_expert7 -->
<g id="node910" class="node">
<title>layer20_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4103" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4103" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4103" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4103" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert7 -->
<g id="edge1160" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4103,-31883.79C4103,-31883.79 4103,-31858.34 4103,-31858.34"/>
<polygon fill="black" stroke="black" points="4106.5,-31858.34 4103,-31848.34 4099.5,-31858.34 4106.5,-31858.34"/>
</g>
<!-- layer20_moe_comm_to_expert8 -->
<g id="node912" class="node">
<title>layer20_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4375" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4375" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4375" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4375" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert8 -->
<g id="edge1162" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4375,-31883.79C4375,-31883.79 4375,-31858.34 4375,-31858.34"/>
<polygon fill="black" stroke="black" points="4378.5,-31858.34 4375,-31848.34 4371.5,-31858.34 4378.5,-31858.34"/>
</g>
<!-- layer20_moe_comm_to_expert9 -->
<g id="node914" class="node">
<title>layer20_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4684" cy="-31819.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4684" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4684" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4684" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert9 -->
<g id="edge1164" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4479.26,-31936.04C4479.26,-31932.49 4479.26,-31819 4479.26,-31819 4479.26,-31819 4583.3,-31819 4583.3,-31819"/>
<polygon fill="black" stroke="black" points="4583.3,-31822.5 4593.3,-31819 4583.3,-31815.5 4583.3,-31822.5"/>
</g>
<!-- layer20_moe_comm_to_expert10 -->
<g id="node916" class="node">
<title>layer20_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5016" cy="-31819.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5016" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="5016" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5016" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert10 -->
<g id="edge1166" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4402.93,-31898C4610.13,-31898 4940.1,-31898 4940.1,-31898 4940.1,-31898 4940.1,-31846.64 4940.1,-31846.64"/>
<polygon fill="black" stroke="black" points="4943.6,-31846.64 4940.1,-31836.64 4936.6,-31846.64 4943.6,-31846.64"/>
</g>
<!-- layer20_moe_comm_to_expert11 -->
<g id="node918" class="node">
<title>layer20_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5362" cy="-31819.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5362" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5362" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5362" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert11 -->
<g id="edge1168" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4418.2,-31913C4717.48,-31913 5286.6,-31913 5286.6,-31913 5286.6,-31913 5286.6,-31846.79 5286.6,-31846.79"/>
<polygon fill="black" stroke="black" points="5290.1,-31846.79 5286.6,-31836.79 5283.1,-31846.79 5290.1,-31846.79"/>
</g>
<!-- layer20_moe_comm_to_expert12 -->
<g id="node920" class="node">
<title>layer20_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5713" cy="-31819.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5713" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5713" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5713" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert12 -->
<g id="edge1170" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4433.1,-31928C4817.24,-31928 5637.6,-31928 5637.6,-31928 5637.6,-31928 5637.6,-31846.62 5637.6,-31846.62"/>
<polygon fill="black" stroke="black" points="5641.1,-31846.62 5637.6,-31836.62 5634.1,-31846.63 5641.1,-31846.62"/>
</g>
<!-- layer20_moe_comm_to_expert13 -->
<g id="node922" class="node">
<title>layer20_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6066" cy="-31819.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6066" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6066" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6066" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert13 -->
<g id="edge1172" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4448.17,-31943C4913,-31943 5991.1,-31943 5991.1,-31943 5991.1,-31943 5991.1,-31846.88 5991.1,-31846.88"/>
<polygon fill="black" stroke="black" points="5994.6,-31846.88 5991.1,-31836.88 5987.6,-31846.88 5994.6,-31846.88"/>
</g>
<!-- layer20_moe_comm_to_expert14 -->
<g id="node924" class="node">
<title>layer20_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6421" cy="-31819.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6421" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6421" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6421" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert14 -->
<g id="edge1174" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4463,-31958C5005.61,-31958 6346.1,-31958 6346.1,-31958 6346.1,-31958 6346.1,-31846.72 6346.1,-31846.72"/>
<polygon fill="black" stroke="black" points="6349.6,-31846.72 6346.1,-31836.72 6342.6,-31846.72 6349.6,-31846.72"/>
</g>
<!-- layer20_moe_comm_to_expert15 -->
<g id="node926" class="node">
<title>layer20_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6776" cy="-31819.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6776" y="-31827.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6776" y="-31816.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6776" y="-31805.63" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert15 -->
<g id="edge1176" class="edge">
<title>layer20_moe_split&#45;&gt;layer20_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4478.15,-31973C5096.66,-31973 6701.1,-31973 6701.1,-31973 6701.1,-31973 6701.1,-31846.78 6701.1,-31846.78"/>
<polygon fill="black" stroke="black" points="6704.6,-31846.78 6701.1,-31836.78 6697.6,-31846.78 6704.6,-31846.78"/>
</g>
<!-- layer20_moe_expert0 -->
<g id="node895" class="node">
<title>layer20_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1808,-31754.14 1480,-31754.14 1480,-31702.14 1808,-31702.14 1808,-31754.14"/>
<text text-anchor="middle" x="1644" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 0 L20</text>
<text text-anchor="middle" x="1644" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1644" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1644" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert0 -->
<g id="node928" class="node">
<title>layer20_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1810" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1810" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1810" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1810" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer20_moe_expert0&#45;&gt;layer20_moe_comm_from_expert0 -->
<g id="edge1178" class="edge">
<title>layer20_moe_expert0&#45;&gt;layer20_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1763.75,-31701.82C1763.75,-31701.82 1763.75,-31672.16 1763.75,-31672.16"/>
<polygon fill="black" stroke="black" points="1767.25,-31672.16 1763.75,-31662.16 1760.25,-31672.16 1767.25,-31672.16"/>
</g>
<!-- layer20_moe_comm_to_expert0&#45;&gt;layer20_moe_expert0 -->
<g id="edge1147" class="edge">
<title>layer20_moe_comm_to_expert0&#45;&gt;layer20_moe_expert0</title>
<path fill="none" stroke="black" d="M1690,-31790.09C1690,-31790.09 1690,-31764.44 1690,-31764.44"/>
<polygon fill="black" stroke="black" points="1693.5,-31764.44 1690,-31754.44 1686.5,-31764.44 1693.5,-31764.44"/>
</g>
<!-- layer20_moe_expert1 -->
<g id="node897" class="node">
<title>layer20_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2154,-31754.14 1826,-31754.14 1826,-31702.14 2154,-31702.14 2154,-31754.14"/>
<text text-anchor="middle" x="1990" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 1 L20</text>
<text text-anchor="middle" x="1990" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1990" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1990" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert1 -->
<g id="node929" class="node">
<title>layer20_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2156" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2156" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2156" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2156" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer20_moe_expert1&#45;&gt;layer20_moe_comm_from_expert1 -->
<g id="edge1180" class="edge">
<title>layer20_moe_expert1&#45;&gt;layer20_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2109.75,-31701.82C2109.75,-31701.82 2109.75,-31672.16 2109.75,-31672.16"/>
<polygon fill="black" stroke="black" points="2113.25,-31672.16 2109.75,-31662.16 2106.25,-31672.16 2113.25,-31672.16"/>
</g>
<!-- layer20_moe_comm_to_expert1&#45;&gt;layer20_moe_expert1 -->
<g id="edge1149" class="edge">
<title>layer20_moe_comm_to_expert1&#45;&gt;layer20_moe_expert1</title>
<path fill="none" stroke="black" d="M2312,-31819C2195.49,-31819 2008.5,-31819 2008.5,-31819 2008.5,-31819 2008.5,-31764.42 2008.5,-31764.42"/>
<polygon fill="black" stroke="black" points="2012,-31764.42 2008.5,-31754.42 2005,-31764.42 2012,-31764.42"/>
</g>
<!-- layer20_moe_expert2 -->
<g id="node899" class="node">
<title>layer20_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2500,-31754.14 2172,-31754.14 2172,-31702.14 2500,-31702.14 2500,-31754.14"/>
<text text-anchor="middle" x="2336" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 2 L20</text>
<text text-anchor="middle" x="2336" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2336" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2336" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert2 -->
<g id="node930" class="node">
<title>layer20_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2428" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2428" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2428" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2428" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer20_moe_expert2&#45;&gt;layer20_moe_comm_from_expert2 -->
<g id="edge1182" class="edge">
<title>layer20_moe_expert2&#45;&gt;layer20_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2418.75,-31701.82C2418.75,-31701.82 2418.75,-31676.28 2418.75,-31676.28"/>
<polygon fill="black" stroke="black" points="2422.25,-31676.28 2418.75,-31666.28 2415.25,-31676.28 2422.25,-31676.28"/>
</g>
<!-- layer20_moe_comm_to_expert2&#45;&gt;layer20_moe_expert2 -->
<g id="edge1151" class="edge">
<title>layer20_moe_comm_to_expert2&#45;&gt;layer20_moe_expert2</title>
<path fill="none" stroke="black" d="M2768.41,-31819C2664.71,-31819 2509,-31819 2509,-31819 2509,-31819 2509,-31728 2509,-31728 2509,-31728 2508.12,-31728 2508.12,-31728"/>
<polygon fill="black" stroke="black" points="2510.18,-31724.5 2500.18,-31728 2510.18,-31731.5 2510.18,-31724.5"/>
</g>
<!-- layer20_moe_expert3 -->
<g id="node901" class="node">
<title>layer20_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2846,-31754.14 2518,-31754.14 2518,-31702.14 2846,-31702.14 2846,-31754.14"/>
<text text-anchor="middle" x="2682" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 3 L20</text>
<text text-anchor="middle" x="2682" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2682" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2682" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert3 -->
<g id="node931" class="node">
<title>layer20_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2756" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2756" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2756" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2756" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer20_moe_expert3&#45;&gt;layer20_moe_comm_from_expert3 -->
<g id="edge1184" class="edge">
<title>layer20_moe_expert3&#45;&gt;layer20_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2755.75,-31701.82C2755.75,-31701.82 2755.75,-31676.28 2755.75,-31676.28"/>
<polygon fill="black" stroke="black" points="2759.25,-31676.28 2755.75,-31666.28 2752.25,-31676.28 2759.25,-31676.28"/>
</g>
<!-- layer20_moe_comm_to_expert3&#45;&gt;layer20_moe_expert3 -->
<g id="edge1153" class="edge">
<title>layer20_moe_comm_to_expert3&#45;&gt;layer20_moe_expert3</title>
<path fill="none" stroke="black" d="M3128.33,-31796.64C3128.33,-31787.04 3128.33,-31778 3128.33,-31778 3128.33,-31778 2807.25,-31778 2807.25,-31778 2807.25,-31778 2807.25,-31764.24 2807.25,-31764.24"/>
<polygon fill="black" stroke="black" points="2810.75,-31764.24 2807.25,-31754.24 2803.75,-31764.24 2810.75,-31764.24"/>
</g>
<!-- layer20_moe_expert4 -->
<g id="node903" class="node">
<title>layer20_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3192,-31754.14 2864,-31754.14 2864,-31702.14 3192,-31702.14 3192,-31754.14"/>
<text text-anchor="middle" x="3028" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 4 L20</text>
<text text-anchor="middle" x="3028" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3028" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="3028" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert4 -->
<g id="node932" class="node">
<title>layer20_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3249" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3249" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3249" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3249" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer20_moe_expert4&#45;&gt;layer20_moe_comm_from_expert4 -->
<g id="edge1186" class="edge">
<title>layer20_moe_expert4&#45;&gt;layer20_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3175.25,-31701.82C3175.25,-31701.82 3175.25,-31664.22 3175.25,-31664.22"/>
<polygon fill="black" stroke="black" points="3178.75,-31664.22 3175.25,-31654.22 3171.75,-31664.22 3178.75,-31664.22"/>
</g>
<!-- layer20_moe_comm_to_expert4&#45;&gt;layer20_moe_expert4 -->
<g id="edge1155" class="edge">
<title>layer20_moe_comm_to_expert4&#45;&gt;layer20_moe_expert4</title>
<path fill="none" stroke="black" d="M3448.75,-31790.08C3448.75,-31777.67 3448.75,-31766 3448.75,-31766 3448.75,-31766 3160.16,-31766 3160.16,-31766 3160.16,-31766 3160.16,-31764.44 3160.16,-31764.44"/>
<polygon fill="black" stroke="black" points="3163.66,-31764.44 3160.16,-31754.44 3156.66,-31764.44 3163.66,-31764.44"/>
</g>
<!-- layer20_moe_expert5 -->
<g id="node905" class="node">
<title>layer20_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3538,-31754.14 3210,-31754.14 3210,-31702.14 3538,-31702.14 3538,-31754.14"/>
<text text-anchor="middle" x="3374" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 5 L20</text>
<text text-anchor="middle" x="3374" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3374" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3374" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert5 -->
<g id="node933" class="node">
<title>layer20_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3595" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3595" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3595" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3595" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer20_moe_expert5&#45;&gt;layer20_moe_comm_from_expert5 -->
<g id="edge1188" class="edge">
<title>layer20_moe_expert5&#45;&gt;layer20_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3521.25,-31701.82C3521.25,-31701.82 3521.25,-31664.22 3521.25,-31664.22"/>
<polygon fill="black" stroke="black" points="3524.75,-31664.22 3521.25,-31654.22 3517.75,-31664.22 3524.75,-31664.22"/>
</g>
<!-- layer20_moe_comm_to_expert5&#45;&gt;layer20_moe_expert5 -->
<g id="edge1157" class="edge">
<title>layer20_moe_comm_to_expert5&#45;&gt;layer20_moe_expert5</title>
<path fill="none" stroke="black" d="M3590.26,-31819C3566.92,-31819 3548.25,-31819 3548.25,-31819 3548.25,-31819 3548.25,-31728 3548.25,-31728 3548.25,-31728 3547.24,-31728 3547.24,-31728"/>
<polygon fill="black" stroke="black" points="3548.13,-31724.5 3538.13,-31728 3548.13,-31731.5 3548.13,-31724.5"/>
</g>
<!-- layer20_moe_expert6 -->
<g id="node907" class="node">
<title>layer20_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3884,-31754.14 3556,-31754.14 3556,-31702.14 3884,-31702.14 3884,-31754.14"/>
<text text-anchor="middle" x="3720" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 6 L20</text>
<text text-anchor="middle" x="3720" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3720" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3720" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert6 -->
<g id="node934" class="node">
<title>layer20_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3867" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3867" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3867" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3867" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer20_moe_expert6&#45;&gt;layer20_moe_comm_from_expert6 -->
<g id="edge1190" class="edge">
<title>layer20_moe_expert6&#45;&gt;layer20_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3830.25,-31701.82C3830.25,-31701.82 3830.25,-31673.73 3830.25,-31673.73"/>
<polygon fill="black" stroke="black" points="3833.75,-31673.73 3830.25,-31663.73 3826.75,-31673.73 3833.75,-31673.73"/>
</g>
<!-- layer20_moe_comm_to_expert6&#45;&gt;layer20_moe_expert6 -->
<g id="edge1159" class="edge">
<title>layer20_moe_comm_to_expert6&#45;&gt;layer20_moe_expert6</title>
<path fill="none" stroke="black" d="M3844.75,-31795.23C3844.75,-31795.23 3844.75,-31764.45 3844.75,-31764.45"/>
<polygon fill="black" stroke="black" points="3848.25,-31764.45 3844.75,-31754.45 3841.25,-31764.45 3848.25,-31764.45"/>
</g>
<!-- layer20_moe_expert7 -->
<g id="node909" class="node">
<title>layer20_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4230,-31754.14 3902,-31754.14 3902,-31702.14 4230,-31702.14 4230,-31754.14"/>
<text text-anchor="middle" x="4066" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 7 L20</text>
<text text-anchor="middle" x="4066" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4066" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4066" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert7 -->
<g id="node935" class="node">
<title>layer20_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4103" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4103" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4103" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4103" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer20_moe_expert7&#45;&gt;layer20_moe_comm_from_expert7 -->
<g id="edge1192" class="edge">
<title>layer20_moe_expert7&#45;&gt;layer20_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4103,-31701.82C4103,-31701.82 4103,-31676.28 4103,-31676.28"/>
<polygon fill="black" stroke="black" points="4106.5,-31676.28 4103,-31666.28 4099.5,-31676.28 4106.5,-31676.28"/>
</g>
<!-- layer20_moe_comm_to_expert7&#45;&gt;layer20_moe_expert7 -->
<g id="edge1161" class="edge">
<title>layer20_moe_comm_to_expert7&#45;&gt;layer20_moe_expert7</title>
<path fill="none" stroke="black" d="M4103,-31790.09C4103,-31790.09 4103,-31764.44 4103,-31764.44"/>
<polygon fill="black" stroke="black" points="4106.5,-31764.44 4103,-31754.44 4099.5,-31764.44 4106.5,-31764.44"/>
</g>
<!-- layer20_moe_expert8 -->
<g id="node911" class="node">
<title>layer20_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4576,-31754.14 4248,-31754.14 4248,-31702.14 4576,-31702.14 4576,-31754.14"/>
<text text-anchor="middle" x="4412" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 8 L20</text>
<text text-anchor="middle" x="4412" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4412" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4412" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert8 -->
<g id="node936" class="node">
<title>layer20_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4375" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4375" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4375" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4375" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer20_moe_expert8&#45;&gt;layer20_moe_comm_from_expert8 -->
<g id="edge1194" class="edge">
<title>layer20_moe_expert8&#45;&gt;layer20_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4375,-31701.82C4375,-31701.82 4375,-31676.28 4375,-31676.28"/>
<polygon fill="black" stroke="black" points="4378.5,-31676.28 4375,-31666.28 4371.5,-31676.28 4378.5,-31676.28"/>
</g>
<!-- layer20_moe_comm_to_expert8&#45;&gt;layer20_moe_expert8 -->
<g id="edge1163" class="edge">
<title>layer20_moe_comm_to_expert8&#45;&gt;layer20_moe_expert8</title>
<path fill="none" stroke="black" d="M4375,-31790.09C4375,-31790.09 4375,-31764.44 4375,-31764.44"/>
<polygon fill="black" stroke="black" points="4378.5,-31764.44 4375,-31754.44 4371.5,-31764.44 4378.5,-31764.44"/>
</g>
<!-- layer20_moe_expert9 -->
<g id="node913" class="node">
<title>layer20_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4922,-31754.14 4594,-31754.14 4594,-31702.14 4922,-31702.14 4922,-31754.14"/>
<text text-anchor="middle" x="4758" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 9 L20</text>
<text text-anchor="middle" x="4758" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4758" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4758" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert9 -->
<g id="node937" class="node">
<title>layer20_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4684" cy="-31637.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4684" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4684" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4684" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer20_moe_expert9&#45;&gt;layer20_moe_comm_from_expert9 -->
<g id="edge1196" class="edge">
<title>layer20_moe_expert9&#45;&gt;layer20_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4684.25,-31701.82C4684.25,-31701.82 4684.25,-31676.28 4684.25,-31676.28"/>
<polygon fill="black" stroke="black" points="4687.75,-31676.28 4684.25,-31666.28 4680.75,-31676.28 4687.75,-31676.28"/>
</g>
<!-- layer20_moe_comm_to_expert9&#45;&gt;layer20_moe_expert9 -->
<g id="edge1165" class="edge">
<title>layer20_moe_comm_to_expert9&#45;&gt;layer20_moe_expert9</title>
<path fill="none" stroke="black" d="M4684.25,-31790.09C4684.25,-31790.09 4684.25,-31764.44 4684.25,-31764.44"/>
<polygon fill="black" stroke="black" points="4687.75,-31764.44 4684.25,-31754.44 4680.75,-31764.44 4687.75,-31764.44"/>
</g>
<!-- layer20_moe_expert10 -->
<g id="node915" class="node">
<title>layer20_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5278,-31754.14 4940,-31754.14 4940,-31702.14 5278,-31702.14 5278,-31754.14"/>
<text text-anchor="middle" x="5109" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 10 L20</text>
<text text-anchor="middle" x="5109" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5109" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5109" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert10 -->
<g id="node938" class="node">
<title>layer20_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="5016" cy="-31637.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5016" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="5016" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5016" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer20_moe_expert10&#45;&gt;layer20_moe_comm_from_expert10 -->
<g id="edge1198" class="edge">
<title>layer20_moe_expert10&#45;&gt;layer20_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M5025.38,-31701.82C5025.38,-31701.82 5025.38,-31676.28 5025.38,-31676.28"/>
<polygon fill="black" stroke="black" points="5028.88,-31676.28 5025.38,-31666.28 5021.88,-31676.28 5028.88,-31676.28"/>
</g>
<!-- layer20_moe_comm_to_expert10&#45;&gt;layer20_moe_expert10 -->
<g id="edge1167" class="edge">
<title>layer20_moe_comm_to_expert10&#45;&gt;layer20_moe_expert10</title>
<path fill="none" stroke="black" d="M5025.02,-31790.09C5025.02,-31790.09 5025.02,-31764.44 5025.02,-31764.44"/>
<polygon fill="black" stroke="black" points="5028.52,-31764.44 5025.02,-31754.44 5021.52,-31764.44 5028.52,-31764.44"/>
</g>
<!-- layer20_moe_expert11 -->
<g id="node917" class="node">
<title>layer20_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5634,-31754.14 5296,-31754.14 5296,-31702.14 5634,-31702.14 5634,-31754.14"/>
<text text-anchor="middle" x="5465" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 11 L20</text>
<text text-anchor="middle" x="5465" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5465" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5465" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert11 -->
<g id="node939" class="node">
<title>layer20_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5363" cy="-31637.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5363" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5363" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5363" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer20_moe_expert11&#45;&gt;layer20_moe_comm_from_expert11 -->
<g id="edge1200" class="edge">
<title>layer20_moe_expert11&#45;&gt;layer20_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5376.88,-31701.82C5376.88,-31701.82 5376.88,-31675.96 5376.88,-31675.96"/>
<polygon fill="black" stroke="black" points="5380.38,-31675.96 5376.88,-31665.96 5373.38,-31675.96 5380.38,-31675.96"/>
</g>
<!-- layer20_moe_comm_to_expert11&#45;&gt;layer20_moe_expert11 -->
<g id="edge1169" class="edge">
<title>layer20_moe_comm_to_expert11&#45;&gt;layer20_moe_expert11</title>
<path fill="none" stroke="black" d="M5376.02,-31790.34C5376.02,-31790.34 5376.02,-31764.28 5376.02,-31764.28"/>
<polygon fill="black" stroke="black" points="5379.52,-31764.28 5376.02,-31754.28 5372.52,-31764.28 5379.52,-31764.28"/>
</g>
<!-- layer20_moe_expert12 -->
<g id="node919" class="node">
<title>layer20_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5990,-31754.14 5652,-31754.14 5652,-31702.14 5990,-31702.14 5990,-31754.14"/>
<text text-anchor="middle" x="5821" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 12 L20</text>
<text text-anchor="middle" x="5821" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5821" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5821" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert12 -->
<g id="node940" class="node">
<title>layer20_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5714" cy="-31637.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5714" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5714" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5714" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer20_moe_expert12&#45;&gt;layer20_moe_comm_from_expert12 -->
<g id="edge1202" class="edge">
<title>layer20_moe_expert12&#45;&gt;layer20_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5730.38,-31701.82C5730.38,-31701.82 5730.38,-31675.96 5730.38,-31675.96"/>
<polygon fill="black" stroke="black" points="5733.88,-31675.96 5730.38,-31665.96 5726.88,-31675.96 5733.88,-31675.96"/>
</g>
<!-- layer20_moe_comm_to_expert12&#45;&gt;layer20_moe_expert12 -->
<g id="edge1171" class="edge">
<title>layer20_moe_comm_to_expert12&#45;&gt;layer20_moe_expert12</title>
<path fill="none" stroke="black" d="M5729.52,-31790.34C5729.52,-31790.34 5729.52,-31764.28 5729.52,-31764.28"/>
<polygon fill="black" stroke="black" points="5733.02,-31764.28 5729.52,-31754.28 5726.02,-31764.28 5733.02,-31764.28"/>
</g>
<!-- layer20_moe_expert13 -->
<g id="node921" class="node">
<title>layer20_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6346,-31754.14 6008,-31754.14 6008,-31702.14 6346,-31702.14 6346,-31754.14"/>
<text text-anchor="middle" x="6177" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 13 L20</text>
<text text-anchor="middle" x="6177" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6177" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6177" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert13 -->
<g id="node941" class="node">
<title>layer20_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6068" cy="-31637.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6068" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6068" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6068" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer20_moe_expert13&#45;&gt;layer20_moe_comm_from_expert13 -->
<g id="edge1204" class="edge">
<title>layer20_moe_expert13&#45;&gt;layer20_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6085.38,-31701.82C6085.38,-31701.82 6085.38,-31675.96 6085.38,-31675.96"/>
<polygon fill="black" stroke="black" points="6088.88,-31675.96 6085.38,-31665.96 6081.88,-31675.96 6088.88,-31675.96"/>
</g>
<!-- layer20_moe_comm_to_expert13&#45;&gt;layer20_moe_expert13 -->
<g id="edge1173" class="edge">
<title>layer20_moe_comm_to_expert13&#45;&gt;layer20_moe_expert13</title>
<path fill="none" stroke="black" d="M6084.02,-31790.34C6084.02,-31790.34 6084.02,-31764.28 6084.02,-31764.28"/>
<polygon fill="black" stroke="black" points="6087.52,-31764.28 6084.02,-31754.28 6080.52,-31764.28 6087.52,-31764.28"/>
</g>
<!-- layer20_moe_expert14 -->
<g id="node923" class="node">
<title>layer20_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6702,-31754.14 6364,-31754.14 6364,-31702.14 6702,-31702.14 6702,-31754.14"/>
<text text-anchor="middle" x="6533" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 14 L20</text>
<text text-anchor="middle" x="6533" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6533" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6533" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert14 -->
<g id="node942" class="node">
<title>layer20_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6423" cy="-31637.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6423" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6423" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6423" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer20_moe_expert14&#45;&gt;layer20_moe_comm_from_expert14 -->
<g id="edge1206" class="edge">
<title>layer20_moe_expert14&#45;&gt;layer20_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6440.88,-31701.82C6440.88,-31701.82 6440.88,-31675.64 6440.88,-31675.64"/>
<polygon fill="black" stroke="black" points="6444.38,-31675.64 6440.88,-31665.64 6437.38,-31675.64 6444.38,-31675.64"/>
</g>
<!-- layer20_moe_comm_to_expert14&#45;&gt;layer20_moe_expert14 -->
<g id="edge1175" class="edge">
<title>layer20_moe_comm_to_expert14&#45;&gt;layer20_moe_expert14</title>
<path fill="none" stroke="black" d="M6439.52,-31790.34C6439.52,-31790.34 6439.52,-31764.28 6439.52,-31764.28"/>
<polygon fill="black" stroke="black" points="6443.02,-31764.28 6439.52,-31754.28 6436.02,-31764.28 6443.02,-31764.28"/>
</g>
<!-- layer20_moe_expert15 -->
<g id="node925" class="node">
<title>layer20_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7058,-31754.14 6720,-31754.14 6720,-31702.14 7058,-31702.14 7058,-31754.14"/>
<text text-anchor="middle" x="6889" y="-31742.14" font-family="Arial" font-size="10.00">EXPERT 15 L20</text>
<text text-anchor="middle" x="6889" y="-31731.14" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6889" y="-31720.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6889" y="-31709.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_comm_from_expert15 -->
<g id="node943" class="node">
<title>layer20_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6778" cy="-31637.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6778" y="-31645.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6778" y="-31634.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6778" y="-31623.65" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer20_moe_expert15&#45;&gt;layer20_moe_comm_from_expert15 -->
<g id="edge1208" class="edge">
<title>layer20_moe_expert15&#45;&gt;layer20_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6796.38,-31701.82C6796.38,-31701.82 6796.38,-31675.64 6796.38,-31675.64"/>
<polygon fill="black" stroke="black" points="6799.88,-31675.64 6796.38,-31665.64 6792.88,-31675.64 6799.88,-31675.64"/>
</g>
<!-- layer20_moe_comm_to_expert15&#45;&gt;layer20_moe_expert15 -->
<g id="edge1177" class="edge">
<title>layer20_moe_comm_to_expert15&#45;&gt;layer20_moe_expert15</title>
<path fill="none" stroke="black" d="M6795.02,-31790.34C6795.02,-31790.34 6795.02,-31764.28 6795.02,-31764.28"/>
<polygon fill="black" stroke="black" points="6798.52,-31764.28 6795.02,-31754.28 6791.52,-31764.28 6798.52,-31764.28"/>
</g>
<!-- layer20_moe_aggregate -->
<g id="node927" class="node">
<title>layer20_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4464.1,-31572.16 4047.16,-31572.16 3939.9,-31468.16 4356.84,-31468.16 4464.1,-31572.16"/>
<text text-anchor="middle" x="4202" y="-31534.16" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L20</text>
<text text-anchor="middle" x="4202" y="-31523.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4202" y="-31512.16" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4202" y="-31501.16" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_mha -->
<g id="node944" class="node">
<title>layer21_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4332,-31432.16 4072,-31432.16 4072,-31380.16 4332,-31380.16 4332,-31432.16"/>
<text text-anchor="middle" x="4202" y="-31420.16" font-family="Arial" font-size="10.00">MHA L21</text>
<text text-anchor="middle" x="4202" y="-31409.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4202" y="-31398.16" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4202" y="-31387.16" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer20_moe_aggregate&#45;&gt;layer21_moe_mha -->
<g id="edge1277" class="edge">
<title>layer20_moe_aggregate&#45;&gt;layer21_moe_mha</title>
<path fill="none" stroke="black" d="M4202,-31467.83C4202,-31467.83 4202,-31442.39 4202,-31442.39"/>
<polygon fill="black" stroke="black" points="4205.5,-31442.39 4202,-31432.39 4198.5,-31442.39 4205.5,-31442.39"/>
</g>
<!-- layer20_moe_comm_from_expert0&#45;&gt;layer20_moe_aggregate -->
<g id="edge1179" class="edge">
<title>layer20_moe_comm_from_expert0&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M1844.75,-31610.3C1844.75,-31566.13 1844.75,-31483 1844.75,-31483 1844.75,-31483 3945.02,-31483 3945.02,-31483"/>
<polygon fill="black" stroke="black" points="3945.02,-31486.5 3955.02,-31483 3945.02,-31479.5 3945.02,-31486.5"/>
</g>
<!-- layer20_moe_comm_from_expert1&#45;&gt;layer20_moe_aggregate -->
<g id="edge1181" class="edge">
<title>layer20_moe_comm_from_expert1&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M2229.01,-31619.97C2229.01,-31582.54 2229.01,-31497 2229.01,-31497 2229.01,-31497 3959.39,-31497 3959.39,-31497"/>
<polygon fill="black" stroke="black" points="3959.39,-31500.5 3969.39,-31497 3959.39,-31493.5 3959.39,-31500.5"/>
</g>
<!-- layer20_moe_comm_from_expert2&#45;&gt;layer20_moe_aggregate -->
<g id="edge1183" class="edge">
<title>layer20_moe_comm_from_expert2&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M2499.75,-31619.22C2499.75,-31584.61 2499.75,-31512 2499.75,-31512 2499.75,-31512 3975.11,-31512 3975.11,-31512"/>
<polygon fill="black" stroke="black" points="3975.11,-31515.5 3985.11,-31512 3975.11,-31508.5 3975.11,-31515.5"/>
</g>
<!-- layer20_moe_comm_from_expert3&#45;&gt;layer20_moe_aggregate -->
<g id="edge1185" class="edge">
<title>layer20_moe_comm_from_expert3&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M2789,-31609.92C2789,-31577.3 2789,-31527 2789,-31527 2789,-31527 3990.3,-31527 3990.3,-31527"/>
<polygon fill="black" stroke="black" points="3990.3,-31530.5 4000.3,-31527 3990.3,-31523.5 3990.3,-31530.5"/>
</g>
<!-- layer20_moe_comm_from_expert4&#45;&gt;layer20_moe_aggregate -->
<g id="edge1187" class="edge">
<title>layer20_moe_comm_from_expert4&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M3331,-31624.71C3331,-31598.92 3331,-31542 3331,-31542 3331,-31542 4005.95,-31542 4005.95,-31542"/>
<polygon fill="black" stroke="black" points="4005.95,-31545.5 4015.95,-31542 4005.95,-31538.5 4005.95,-31545.5"/>
</g>
<!-- layer20_moe_comm_from_expert5&#45;&gt;layer20_moe_aggregate -->
<g id="edge1189" class="edge">
<title>layer20_moe_comm_from_expert5&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M3619.5,-31609.12C3619.5,-31586 3619.5,-31557 3619.5,-31557 3619.5,-31557 4021.17,-31557 4021.17,-31557"/>
<polygon fill="black" stroke="black" points="4021.17,-31560.5 4031.17,-31557 4021.17,-31553.5 4021.17,-31560.5"/>
</g>
<!-- layer20_moe_comm_from_expert6&#45;&gt;layer20_moe_aggregate -->
<g id="edge1191" class="edge">
<title>layer20_moe_comm_from_expert6&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M3948.61,-31624.18C3948.61,-31624.18 3948.61,-31530.21 3948.61,-31530.21"/>
<polygon fill="black" stroke="black" points="3952.11,-31530.21 3948.61,-31520.21 3945.11,-31530.21 3952.11,-31530.21"/>
</g>
<!-- layer20_moe_comm_from_expert7&#45;&gt;layer20_moe_aggregate -->
<g id="edge1193" class="edge">
<title>layer20_moe_comm_from_expert7&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M4103,-31607.93C4103,-31607.93 4103,-31582.22 4103,-31582.22"/>
<polygon fill="black" stroke="black" points="4106.5,-31582.22 4103,-31572.22 4099.5,-31582.22 4106.5,-31582.22"/>
</g>
<!-- layer20_moe_comm_from_expert8&#45;&gt;layer20_moe_aggregate -->
<g id="edge1195" class="edge">
<title>layer20_moe_comm_from_expert8&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M4374.39,-31607.93C4374.39,-31607.93 4374.39,-31582.22 4374.39,-31582.22"/>
<polygon fill="black" stroke="black" points="4377.89,-31582.22 4374.39,-31572.22 4370.89,-31582.22 4377.89,-31582.22"/>
</g>
<!-- layer20_moe_comm_from_expert9&#45;&gt;layer20_moe_aggregate -->
<g id="edge1197" class="edge">
<title>layer20_moe_comm_from_expert9&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M4665.5,-31608.49C4665.5,-31586.19 4665.5,-31559 4665.5,-31559 4665.5,-31559 4460.71,-31559 4460.71,-31559"/>
<polygon fill="black" stroke="black" points="4460.71,-31555.5 4450.71,-31559 4460.71,-31562.5 4460.71,-31555.5"/>
</g>
<!-- layer20_moe_comm_from_expert10&#45;&gt;layer20_moe_aggregate -->
<g id="edge1199" class="edge">
<title>layer20_moe_comm_from_expert10&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M4997.15,-31608.31C4997.15,-31581.61 4997.15,-31546 4997.15,-31546 4997.15,-31546 4447.34,-31546 4447.34,-31546"/>
<polygon fill="black" stroke="black" points="4447.34,-31542.5 4437.34,-31546 4447.34,-31549.5 4447.34,-31542.5"/>
</g>
<!-- layer20_moe_comm_from_expert11&#45;&gt;layer20_moe_aggregate -->
<g id="edge1201" class="edge">
<title>layer20_moe_comm_from_expert11&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M5343.65,-31608.69C5343.65,-31577.85 5343.65,-31533 5343.65,-31533 5343.65,-31533 4433.81,-31533 4433.81,-31533"/>
<polygon fill="black" stroke="black" points="4433.81,-31529.5 4423.81,-31533 4433.81,-31536.5 4433.81,-31529.5"/>
</g>
<!-- layer20_moe_comm_from_expert12&#45;&gt;layer20_moe_aggregate -->
<g id="edge1203" class="edge">
<title>layer20_moe_comm_from_expert12&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M5694.65,-31608.49C5694.65,-31573.81 5694.65,-31520 5694.65,-31520 5694.65,-31520 4420.33,-31520 4420.33,-31520"/>
<polygon fill="black" stroke="black" points="4420.33,-31516.5 4410.33,-31520 4420.33,-31523.5 4420.33,-31516.5"/>
</g>
<!-- layer20_moe_comm_from_expert13&#45;&gt;layer20_moe_aggregate -->
<g id="edge1205" class="edge">
<title>layer20_moe_comm_from_expert13&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M6048.15,-31608.59C6048.15,-31570.28 6048.15,-31507 6048.15,-31507 6048.15,-31507 4406.95,-31507 4406.95,-31507"/>
<polygon fill="black" stroke="black" points="4406.95,-31503.5 4396.95,-31507 4406.95,-31510.5 4406.95,-31503.5"/>
</g>
<!-- layer20_moe_comm_from_expert14&#45;&gt;layer20_moe_aggregate -->
<g id="edge1207" class="edge">
<title>layer20_moe_comm_from_expert14&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M6403.15,-31608.53C6403.15,-31566.75 6403.15,-31494 6403.15,-31494 6403.15,-31494 4393.53,-31494 4393.53,-31494"/>
<polygon fill="black" stroke="black" points="4393.53,-31490.5 4383.53,-31494 4393.53,-31497.5 4393.53,-31490.5"/>
</g>
<!-- layer20_moe_comm_from_expert15&#45;&gt;layer20_moe_aggregate -->
<g id="edge1209" class="edge">
<title>layer20_moe_comm_from_expert15&#45;&gt;layer20_moe_aggregate</title>
<path fill="none" stroke="black" d="M6758.15,-31608.51C6758.15,-31563.43 6758.15,-31481 6758.15,-31481 6758.15,-31481 4380.21,-31481 4380.21,-31481"/>
<polygon fill="black" stroke="black" points="4380.21,-31477.5 4370.21,-31481 4380.21,-31484.5 4380.21,-31477.5"/>
</g>
<!-- layer21_moe_gate -->
<g id="node945" class="node">
<title>layer21_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4460.3,-31344.16 4049.4,-31344.16 3943.7,-31240.16 4354.6,-31240.16 4460.3,-31344.16"/>
<text text-anchor="middle" x="4202" y="-31306.16" font-family="Arial" font-size="10.00">GATE L21</text>
<text text-anchor="middle" x="4202" y="-31295.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4202" y="-31284.16" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4202" y="-31273.16" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer21_moe_mha&#45;&gt;layer21_moe_gate -->
<g id="edge1278" class="edge">
<title>layer21_moe_mha&#45;&gt;layer21_moe_gate</title>
<path fill="none" stroke="black" d="M4202,-31380.01C4202,-31380.01 4202,-31354.26 4202,-31354.26"/>
<polygon fill="black" stroke="black" points="4205.5,-31354.26 4202,-31344.26 4198.5,-31354.26 4205.5,-31354.26"/>
</g>
<!-- layer21_moe_split -->
<g id="node946" class="node">
<title>layer21_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4456.01,-31204.16 4051.94,-31204.16 3947.99,-31100.16 4352.06,-31100.16 4456.01,-31204.16"/>
<text text-anchor="middle" x="4202" y="-31166.16" font-family="Arial" font-size="10.00">SPLIT TOKENS L21</text>
<text text-anchor="middle" x="4202" y="-31155.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4202" y="-31144.16" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4202" y="-31133.16" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer21_moe_gate&#45;&gt;layer21_moe_split -->
<g id="edge1279" class="edge">
<title>layer21_moe_gate&#45;&gt;layer21_moe_split</title>
<path fill="none" stroke="black" d="M4202,-31240.03C4202,-31240.03 4202,-31214.33 4202,-31214.33"/>
<polygon fill="black" stroke="black" points="4205.5,-31214.33 4202,-31204.33 4198.5,-31214.33 4205.5,-31214.33"/>
</g>
<!-- layer21_moe_comm_to_expert0 -->
<g id="node948" class="node">
<title>layer21_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2121" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2121" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2121" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2121" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert0 -->
<g id="edge1213" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4036.62,-31189C3546.96,-31189 2138.5,-31189 2138.5,-31189 2138.5,-31189 2138.5,-31073.74 2138.5,-31073.74"/>
<polygon fill="black" stroke="black" points="2142,-31073.74 2138.5,-31063.74 2135,-31073.74 2142,-31073.74"/>
</g>
<!-- layer21_moe_comm_to_expert1 -->
<g id="node950" class="node">
<title>layer21_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2366" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2366" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2366" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2366" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert1 -->
<g id="edge1215" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4021.5,-31174C3564.36,-31174 2397,-31174 2397,-31174 2397,-31174 2397,-31072.6 2397,-31072.6"/>
<polygon fill="black" stroke="black" points="2400.5,-31072.6 2397,-31062.6 2393.5,-31072.6 2400.5,-31072.6"/>
</g>
<!-- layer21_moe_comm_to_expert2 -->
<g id="node952" class="node">
<title>layer21_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2822" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2822" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2822" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2822" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert2 -->
<g id="edge1217" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4006.74,-31159C3640.77,-31159 2888.25,-31159 2888.25,-31159 2888.25,-31159 2888.25,-31065.06 2888.25,-31065.06"/>
<polygon fill="black" stroke="black" points="2891.75,-31065.06 2888.25,-31055.06 2884.75,-31065.06 2891.75,-31065.06"/>
</g>
<!-- layer21_moe_comm_to_expert3 -->
<g id="node954" class="node">
<title>layer21_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3150" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3150" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3150" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3150" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert3 -->
<g id="edge1219" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3991.54,-31144C3697.53,-31144 3199.5,-31144 3199.5,-31144 3199.5,-31144 3199.5,-31069.59 3199.5,-31069.59"/>
<polygon fill="black" stroke="black" points="3203,-31069.59 3199.5,-31059.59 3196,-31069.59 3203,-31069.59"/>
</g>
<!-- layer21_moe_comm_to_expert4 -->
<g id="node956" class="node">
<title>layer21_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3413" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3413" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3413" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3413" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert4 -->
<g id="edge1221" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3976.77,-31129C3746.23,-31129 3421.51,-31129 3421.51,-31129 3421.51,-31129 3421.51,-31074.09 3421.51,-31074.09"/>
<polygon fill="black" stroke="black" points="3425.01,-31074.09 3421.51,-31064.09 3418.01,-31074.09 3425.01,-31074.09"/>
</g>
<!-- layer21_moe_comm_to_expert5 -->
<g id="node958" class="node">
<title>layer21_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3644" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3644" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3644" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3644" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert5 -->
<g id="edge1223" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3962.49,-31115C3837.37,-31115 3710.01,-31115 3710.01,-31115 3710.01,-31115 3710.01,-31065.31 3710.01,-31065.31"/>
<polygon fill="black" stroke="black" points="3713.51,-31065.31 3710.01,-31055.31 3706.51,-31065.31 3713.51,-31065.31"/>
</g>
<!-- layer21_moe_comm_to_expert6 -->
<g id="node960" class="node">
<title>layer21_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3859" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3859" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3859" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3859" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert6 -->
<g id="edge1225" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3962.5,-31152.07C3962.5,-31148.53 3962.5,-31035 3962.5,-31035 3962.5,-31035 3959.81,-31035 3959.81,-31035"/>
<polygon fill="black" stroke="black" points="3959.81,-31031.5 3949.81,-31035 3959.81,-31038.5 3959.81,-31031.5"/>
</g>
<!-- layer21_moe_comm_to_expert7 -->
<g id="node962" class="node">
<title>layer21_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4066" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4066" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4066" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4066" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert7 -->
<g id="edge1227" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4066,-31099.82C4066,-31099.82 4066,-31074.38 4066,-31074.38"/>
<polygon fill="black" stroke="black" points="4069.5,-31074.38 4066,-31064.38 4062.5,-31074.38 4069.5,-31074.38"/>
</g>
<!-- layer21_moe_comm_to_expert8 -->
<g id="node964" class="node">
<title>layer21_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4338" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4338" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4338" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4338" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert8 -->
<g id="edge1229" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4338,-31099.82C4338,-31099.82 4338,-31074.38 4338,-31074.38"/>
<polygon fill="black" stroke="black" points="4341.5,-31074.38 4338,-31064.38 4334.5,-31074.38 4341.5,-31074.38"/>
</g>
<!-- layer21_moe_comm_to_expert9 -->
<g id="node966" class="node">
<title>layer21_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4647" cy="-31035.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4647" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4647" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4647" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert9 -->
<g id="edge1231" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4442.26,-31152.07C4442.26,-31148.53 4442.26,-31035 4442.26,-31035 4442.26,-31035 4546.3,-31035 4546.3,-31035"/>
<polygon fill="black" stroke="black" points="4546.3,-31038.5 4556.3,-31035 4546.3,-31031.5 4546.3,-31038.5"/>
</g>
<!-- layer21_moe_comm_to_expert10 -->
<g id="node968" class="node">
<title>layer21_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4979" cy="-31035.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4979" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4979" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4979" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert10 -->
<g id="edge1233" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4367.26,-31115C4574.54,-31115 4903.1,-31115 4903.1,-31115 4903.1,-31115 4903.1,-31062.49 4903.1,-31062.49"/>
<polygon fill="black" stroke="black" points="4906.6,-31062.49 4903.1,-31052.49 4899.6,-31062.49 4906.6,-31062.49"/>
</g>
<!-- layer21_moe_comm_to_expert11 -->
<g id="node970" class="node">
<title>layer21_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5325" cy="-31035.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5325" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5325" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5325" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert11 -->
<g id="edge1235" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4380.9,-31129C4680.11,-31129 5249.6,-31129 5249.6,-31129 5249.6,-31129 5249.6,-31062.82 5249.6,-31062.82"/>
<polygon fill="black" stroke="black" points="5253.1,-31062.82 5249.6,-31052.82 5246.1,-31062.82 5253.1,-31062.82"/>
</g>
<!-- layer21_moe_comm_to_expert12 -->
<g id="node972" class="node">
<title>layer21_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5676" cy="-31035.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5676" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5676" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5676" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert12 -->
<g id="edge1237" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4396.1,-31144C4780.24,-31144 5600.6,-31144 5600.6,-31144 5600.6,-31144 5600.6,-31062.65 5600.6,-31062.65"/>
<polygon fill="black" stroke="black" points="5604.1,-31062.65 5600.6,-31052.65 5597.1,-31062.65 5604.1,-31062.65"/>
</g>
<!-- layer21_moe_comm_to_expert13 -->
<g id="node974" class="node">
<title>layer21_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6029" cy="-31035.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6029" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="6029" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6029" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert13 -->
<g id="edge1239" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4411.17,-31159C4876,-31159 5954.1,-31159 5954.1,-31159 5954.1,-31159 5954.1,-31062.91 5954.1,-31062.91"/>
<polygon fill="black" stroke="black" points="5957.6,-31062.91 5954.1,-31052.91 5950.6,-31062.91 5957.6,-31062.91"/>
</g>
<!-- layer21_moe_comm_to_expert14 -->
<g id="node976" class="node">
<title>layer21_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6384" cy="-31035.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6384" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6384" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6384" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert14 -->
<g id="edge1241" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4426,-31174C4968.61,-31174 6309.1,-31174 6309.1,-31174 6309.1,-31174 6309.1,-31062.75 6309.1,-31062.75"/>
<polygon fill="black" stroke="black" points="6312.6,-31062.75 6309.1,-31052.75 6305.6,-31062.75 6312.6,-31062.75"/>
</g>
<!-- layer21_moe_comm_to_expert15 -->
<g id="node978" class="node">
<title>layer21_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6739" cy="-31035.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6739" y="-31043.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6739" y="-31032.67" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6739" y="-31021.67" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert15 -->
<g id="edge1243" class="edge">
<title>layer21_moe_split&#45;&gt;layer21_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4440.87,-31189C5059.18,-31189 6664.1,-31189 6664.1,-31189 6664.1,-31189 6664.1,-31062.81 6664.1,-31062.81"/>
<polygon fill="black" stroke="black" points="6667.6,-31062.81 6664.1,-31052.81 6660.6,-31062.81 6667.6,-31062.81"/>
</g>
<!-- layer21_moe_expert0 -->
<g id="node947" class="node">
<title>layer21_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1771,-30970.18 1443,-30970.18 1443,-30918.18 1771,-30918.18 1771,-30970.18"/>
<text text-anchor="middle" x="1607" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 0 L21</text>
<text text-anchor="middle" x="1607" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1607" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1607" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert0 -->
<g id="node980" class="node">
<title>layer21_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2121" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2121" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2121" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2121" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer21_moe_expert0&#45;&gt;layer21_moe_comm_from_expert0 -->
<g id="edge1245" class="edge">
<title>layer21_moe_expert0&#45;&gt;layer21_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1761.5,-30917.8C1761.5,-30890.88 1761.5,-30853 1761.5,-30853 1761.5,-30853 2020.28,-30853 2020.28,-30853"/>
<polygon fill="black" stroke="black" points="2020.28,-30856.5 2030.28,-30853 2020.28,-30849.5 2020.28,-30856.5"/>
</g>
<!-- layer21_moe_comm_to_expert0&#45;&gt;layer21_moe_expert0 -->
<g id="edge1214" class="edge">
<title>layer21_moe_comm_to_expert0&#45;&gt;layer21_moe_expert0</title>
<path fill="none" stroke="black" d="M2030.04,-31035C1918.83,-31035 1745.25,-31035 1745.25,-31035 1745.25,-31035 1745.25,-30980.45 1745.25,-30980.45"/>
<polygon fill="black" stroke="black" points="1748.75,-30980.45 1745.25,-30970.45 1741.75,-30980.45 1748.75,-30980.45"/>
</g>
<!-- layer21_moe_expert1 -->
<g id="node949" class="node">
<title>layer21_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2117,-30970.18 1789,-30970.18 1789,-30918.18 2117,-30918.18 2117,-30970.18"/>
<text text-anchor="middle" x="1953" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 1 L21</text>
<text text-anchor="middle" x="1953" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1953" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1953" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert1 -->
<g id="node981" class="node">
<title>layer21_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2366" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2366" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2366" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2366" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer21_moe_expert1&#45;&gt;layer21_moe_comm_from_expert1 -->
<g id="edge1247" class="edge">
<title>layer21_moe_expert1&#45;&gt;layer21_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2073.75,-30917.9C2073.75,-30904.5 2073.75,-30891 2073.75,-30891 2073.75,-30891 2366,-30891 2366,-30891 2366,-30891 2366,-30890.12 2366,-30890.12"/>
<polygon fill="black" stroke="black" points="2369.5,-30892.23 2366,-30882.23 2362.5,-30892.23 2369.5,-30892.23"/>
</g>
<!-- layer21_moe_comm_to_expert1&#45;&gt;layer21_moe_expert1 -->
<g id="edge1216" class="edge">
<title>layer21_moe_comm_to_expert1&#45;&gt;layer21_moe_expert1</title>
<path fill="none" stroke="black" d="M2366,-31006.1C2366,-30992.39 2366,-30979 2366,-30979 2366,-30979 2073.75,-30979 2073.75,-30979 2073.75,-30979 2073.75,-30978.12 2073.75,-30978.12"/>
<polygon fill="black" stroke="black" points="2077.25,-30980.21 2073.75,-30970.21 2070.25,-30980.21 2077.25,-30980.21"/>
</g>
<!-- layer21_moe_expert2 -->
<g id="node951" class="node">
<title>layer21_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2463,-30970.18 2135,-30970.18 2135,-30918.18 2463,-30918.18 2463,-30970.18"/>
<text text-anchor="middle" x="2299" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 2 L21</text>
<text text-anchor="middle" x="2299" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2299" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2299" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert2 -->
<g id="node982" class="node">
<title>layer21_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2822" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2822" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2822" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2822" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer21_moe_expert2&#45;&gt;layer21_moe_comm_from_expert2 -->
<g id="edge1249" class="edge">
<title>layer21_moe_expert2&#45;&gt;layer21_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2463.18,-30935C2470.6,-30935 2475,-30935 2475,-30935 2475,-30935 2475,-30853 2475,-30853 2475,-30853 2721.28,-30853 2721.28,-30853"/>
<polygon fill="black" stroke="black" points="2721.28,-30856.5 2731.28,-30853 2721.28,-30849.5 2721.28,-30856.5"/>
</g>
<!-- layer21_moe_comm_to_expert2&#45;&gt;layer21_moe_expert2 -->
<g id="edge1218" class="edge">
<title>layer21_moe_comm_to_expert2&#45;&gt;layer21_moe_expert2</title>
<path fill="none" stroke="black" d="M2731.09,-31035C2626.5,-31035 2469,-31035 2469,-31035 2469,-31035 2469,-30952 2469,-30952 2469,-30952 2468.43,-30952 2468.43,-30952"/>
<polygon fill="black" stroke="black" points="2473.34,-30948.5 2463.34,-30952 2473.34,-30955.5 2473.34,-30948.5"/>
</g>
<!-- layer21_moe_expert3 -->
<g id="node953" class="node">
<title>layer21_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2809,-30970.18 2481,-30970.18 2481,-30918.18 2809,-30918.18 2809,-30970.18"/>
<text text-anchor="middle" x="2645" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 3 L21</text>
<text text-anchor="middle" x="2645" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2645" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2645" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert3 -->
<g id="node983" class="node">
<title>layer21_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3150" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3150" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3150" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3150" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer21_moe_expert3&#45;&gt;layer21_moe_comm_from_expert3 -->
<g id="edge1251" class="edge">
<title>layer21_moe_expert3&#45;&gt;layer21_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2770.25,-30917.97C2770.25,-30908.46 2770.25,-30900 2770.25,-30900 2770.25,-30900 3091.33,-30900 3091.33,-30900 3091.33,-30900 3091.33,-30885.5 3091.33,-30885.5"/>
<polygon fill="black" stroke="black" points="3094.83,-30885.5 3091.33,-30875.5 3087.83,-30885.5 3094.83,-30885.5"/>
</g>
<!-- layer21_moe_comm_to_expert3&#45;&gt;layer21_moe_expert3 -->
<g id="edge1220" class="edge">
<title>layer21_moe_comm_to_expert3&#45;&gt;layer21_moe_expert3</title>
<path fill="none" stroke="black" d="M3091.33,-31012.97C3091.33,-31004.57 3091.33,-30997 3091.33,-30997 3091.33,-30997 2770.25,-30997 2770.25,-30997 2770.25,-30997 2770.25,-30980.28 2770.25,-30980.28"/>
<polygon fill="black" stroke="black" points="2773.75,-30980.28 2770.25,-30970.28 2766.75,-30980.28 2773.75,-30980.28"/>
</g>
<!-- layer21_moe_expert4 -->
<g id="node955" class="node">
<title>layer21_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3155,-30970.18 2827,-30970.18 2827,-30918.18 3155,-30918.18 3155,-30970.18"/>
<text text-anchor="middle" x="2991" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 4 L21</text>
<text text-anchor="middle" x="2991" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2991" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2991" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert4 -->
<g id="node984" class="node">
<title>layer21_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3413" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3413" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3413" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3413" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer21_moe_expert4&#45;&gt;layer21_moe_comm_from_expert4 -->
<g id="edge1253" class="edge">
<title>layer21_moe_expert4&#45;&gt;layer21_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3123.16,-30917.88C3123.16,-30912.79 3123.16,-30909 3123.16,-30909 3123.16,-30909 3411.75,-30909 3411.75,-30909 3411.75,-30909 3411.75,-30892.4 3411.75,-30892.4"/>
<polygon fill="black" stroke="black" points="3415.25,-30892.4 3411.75,-30882.4 3408.25,-30892.4 3415.25,-30892.4"/>
</g>
<!-- layer21_moe_comm_to_expert4&#45;&gt;layer21_moe_expert4 -->
<g id="edge1222" class="edge">
<title>layer21_moe_comm_to_expert4&#45;&gt;layer21_moe_expert4</title>
<path fill="none" stroke="black" d="M3411.75,-31006.1C3411.75,-30996.39 3411.75,-30988 3411.75,-30988 3411.75,-30988 3123.16,-30988 3123.16,-30988 3123.16,-30988 3123.16,-30980.43 3123.16,-30980.43"/>
<polygon fill="black" stroke="black" points="3126.66,-30980.43 3123.16,-30970.43 3119.66,-30980.43 3126.66,-30980.43"/>
</g>
<!-- layer21_moe_expert5 -->
<g id="node957" class="node">
<title>layer21_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3501,-30970.18 3173,-30970.18 3173,-30918.18 3501,-30918.18 3501,-30970.18"/>
<text text-anchor="middle" x="3337" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 5 L21</text>
<text text-anchor="middle" x="3337" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3337" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3337" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert5 -->
<g id="node985" class="node">
<title>layer21_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3644" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3644" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3644" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3644" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer21_moe_expert5&#45;&gt;layer21_moe_comm_from_expert5 -->
<g id="edge1255" class="edge">
<title>layer21_moe_expert5&#45;&gt;layer21_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3501.14,-30935C3509.28,-30935 3514.16,-30935 3514.16,-30935 3514.16,-30935 3514.16,-30853 3514.16,-30853 3514.16,-30853 3543.47,-30853 3543.47,-30853"/>
<polygon fill="black" stroke="black" points="3543.47,-30856.5 3553.47,-30853 3543.47,-30849.5 3543.47,-30856.5"/>
</g>
<!-- layer21_moe_comm_to_expert5&#45;&gt;layer21_moe_expert5 -->
<g id="edge1224" class="edge">
<title>layer21_moe_comm_to_expert5&#45;&gt;layer21_moe_expert5</title>
<path fill="none" stroke="black" d="M3553.42,-31035C3529.06,-31035 3509.33,-31035 3509.33,-31035 3509.33,-31035 3509.33,-30952 3509.33,-30952 3509.33,-30952 3508.5,-30952 3508.5,-30952"/>
<polygon fill="black" stroke="black" points="3511.02,-30948.5 3501.02,-30952 3511.02,-30955.5 3511.02,-30948.5"/>
</g>
<!-- layer21_moe_expert6 -->
<g id="node959" class="node">
<title>layer21_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3847,-30970.18 3519,-30970.18 3519,-30918.18 3847,-30918.18 3847,-30970.18"/>
<text text-anchor="middle" x="3683" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 6 L21</text>
<text text-anchor="middle" x="3683" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3683" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3683" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert6 -->
<g id="node986" class="node">
<title>layer21_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3859" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3859" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3859" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3859" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer21_moe_expert6&#45;&gt;layer21_moe_comm_from_expert6 -->
<g id="edge1257" class="edge">
<title>layer21_moe_expert6&#45;&gt;layer21_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3807.75,-30917.86C3807.75,-30917.86 3807.75,-30887.27 3807.75,-30887.27"/>
<polygon fill="black" stroke="black" points="3811.25,-30887.27 3807.75,-30877.27 3804.25,-30887.27 3811.25,-30887.27"/>
</g>
<!-- layer21_moe_comm_to_expert6&#45;&gt;layer21_moe_expert6 -->
<g id="edge1226" class="edge">
<title>layer21_moe_comm_to_expert6&#45;&gt;layer21_moe_expert6</title>
<path fill="none" stroke="black" d="M3807.75,-31011.26C3807.75,-31011.26 3807.75,-30980.48 3807.75,-30980.48"/>
<polygon fill="black" stroke="black" points="3811.25,-30980.48 3807.75,-30970.48 3804.25,-30980.48 3811.25,-30980.48"/>
</g>
<!-- layer21_moe_expert7 -->
<g id="node961" class="node">
<title>layer21_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4193,-30970.18 3865,-30970.18 3865,-30918.18 4193,-30918.18 4193,-30970.18"/>
<text text-anchor="middle" x="4029" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 7 L21</text>
<text text-anchor="middle" x="4029" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4029" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="4029" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert7 -->
<g id="node987" class="node">
<title>layer21_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4066" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4066" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4066" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4066" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer21_moe_expert7&#45;&gt;layer21_moe_comm_from_expert7 -->
<g id="edge1259" class="edge">
<title>layer21_moe_expert7&#45;&gt;layer21_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4066,-30917.86C4066,-30917.86 4066,-30892.32 4066,-30892.32"/>
<polygon fill="black" stroke="black" points="4069.5,-30892.32 4066,-30882.32 4062.5,-30892.32 4069.5,-30892.32"/>
</g>
<!-- layer21_moe_comm_to_expert7&#45;&gt;layer21_moe_expert7 -->
<g id="edge1228" class="edge">
<title>layer21_moe_comm_to_expert7&#45;&gt;layer21_moe_expert7</title>
<path fill="none" stroke="black" d="M4066,-31006.13C4066,-31006.13 4066,-30980.48 4066,-30980.48"/>
<polygon fill="black" stroke="black" points="4069.5,-30980.48 4066,-30970.48 4062.5,-30980.48 4069.5,-30980.48"/>
</g>
<!-- layer21_moe_expert8 -->
<g id="node963" class="node">
<title>layer21_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4539,-30970.18 4211,-30970.18 4211,-30918.18 4539,-30918.18 4539,-30970.18"/>
<text text-anchor="middle" x="4375" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 8 L21</text>
<text text-anchor="middle" x="4375" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4375" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4375" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert8 -->
<g id="node988" class="node">
<title>layer21_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4338" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4338" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4338" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4338" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer21_moe_expert8&#45;&gt;layer21_moe_comm_from_expert8 -->
<g id="edge1261" class="edge">
<title>layer21_moe_expert8&#45;&gt;layer21_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4338,-30917.86C4338,-30917.86 4338,-30892.32 4338,-30892.32"/>
<polygon fill="black" stroke="black" points="4341.5,-30892.32 4338,-30882.32 4334.5,-30892.32 4341.5,-30892.32"/>
</g>
<!-- layer21_moe_comm_to_expert8&#45;&gt;layer21_moe_expert8 -->
<g id="edge1230" class="edge">
<title>layer21_moe_comm_to_expert8&#45;&gt;layer21_moe_expert8</title>
<path fill="none" stroke="black" d="M4338,-31006.13C4338,-31006.13 4338,-30980.48 4338,-30980.48"/>
<polygon fill="black" stroke="black" points="4341.5,-30980.48 4338,-30970.48 4334.5,-30980.48 4341.5,-30980.48"/>
</g>
<!-- layer21_moe_expert9 -->
<g id="node965" class="node">
<title>layer21_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4885,-30970.18 4557,-30970.18 4557,-30918.18 4885,-30918.18 4885,-30970.18"/>
<text text-anchor="middle" x="4721" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 9 L21</text>
<text text-anchor="middle" x="4721" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4721" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4721" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert9 -->
<g id="node989" class="node">
<title>layer21_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4647" cy="-30853.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4647" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4647" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4647" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer21_moe_expert9&#45;&gt;layer21_moe_comm_from_expert9 -->
<g id="edge1263" class="edge">
<title>layer21_moe_expert9&#45;&gt;layer21_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4647.25,-30917.86C4647.25,-30917.86 4647.25,-30892.32 4647.25,-30892.32"/>
<polygon fill="black" stroke="black" points="4650.75,-30892.32 4647.25,-30882.32 4643.75,-30892.32 4650.75,-30892.32"/>
</g>
<!-- layer21_moe_comm_to_expert9&#45;&gt;layer21_moe_expert9 -->
<g id="edge1232" class="edge">
<title>layer21_moe_comm_to_expert9&#45;&gt;layer21_moe_expert9</title>
<path fill="none" stroke="black" d="M4647.25,-31006.13C4647.25,-31006.13 4647.25,-30980.48 4647.25,-30980.48"/>
<polygon fill="black" stroke="black" points="4650.75,-30980.48 4647.25,-30970.48 4643.75,-30980.48 4650.75,-30980.48"/>
</g>
<!-- layer21_moe_expert10 -->
<g id="node967" class="node">
<title>layer21_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5241,-30970.18 4903,-30970.18 4903,-30918.18 5241,-30918.18 5241,-30970.18"/>
<text text-anchor="middle" x="5072" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 10 L21</text>
<text text-anchor="middle" x="5072" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5072" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5072" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert10 -->
<g id="node990" class="node">
<title>layer21_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4979" cy="-30853.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4979" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4979" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4979" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer21_moe_expert10&#45;&gt;layer21_moe_comm_from_expert10 -->
<g id="edge1265" class="edge">
<title>layer21_moe_expert10&#45;&gt;layer21_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4988.38,-30917.86C4988.38,-30917.86 4988.38,-30892.32 4988.38,-30892.32"/>
<polygon fill="black" stroke="black" points="4991.88,-30892.32 4988.38,-30882.32 4984.88,-30892.32 4991.88,-30892.32"/>
</g>
<!-- layer21_moe_comm_to_expert10&#45;&gt;layer21_moe_expert10 -->
<g id="edge1234" class="edge">
<title>layer21_moe_comm_to_expert10&#45;&gt;layer21_moe_expert10</title>
<path fill="none" stroke="black" d="M4988.02,-31006.13C4988.02,-31006.13 4988.02,-30980.48 4988.02,-30980.48"/>
<polygon fill="black" stroke="black" points="4991.52,-30980.48 4988.02,-30970.48 4984.52,-30980.48 4991.52,-30980.48"/>
</g>
<!-- layer21_moe_expert11 -->
<g id="node969" class="node">
<title>layer21_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5597,-30970.18 5259,-30970.18 5259,-30918.18 5597,-30918.18 5597,-30970.18"/>
<text text-anchor="middle" x="5428" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 11 L21</text>
<text text-anchor="middle" x="5428" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5428" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5428" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert11 -->
<g id="node991" class="node">
<title>layer21_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5326" cy="-30853.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5326" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5326" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5326" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer21_moe_expert11&#45;&gt;layer21_moe_comm_from_expert11 -->
<g id="edge1267" class="edge">
<title>layer21_moe_expert11&#45;&gt;layer21_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5339.88,-30917.86C5339.88,-30917.86 5339.88,-30891.99 5339.88,-30891.99"/>
<polygon fill="black" stroke="black" points="5343.38,-30891.99 5339.88,-30881.99 5336.38,-30891.99 5343.38,-30891.99"/>
</g>
<!-- layer21_moe_comm_to_expert11&#45;&gt;layer21_moe_expert11 -->
<g id="edge1236" class="edge">
<title>layer21_moe_comm_to_expert11&#45;&gt;layer21_moe_expert11</title>
<path fill="none" stroke="black" d="M5339.02,-31006.38C5339.02,-31006.38 5339.02,-30980.31 5339.02,-30980.31"/>
<polygon fill="black" stroke="black" points="5342.52,-30980.31 5339.02,-30970.31 5335.52,-30980.31 5342.52,-30980.31"/>
</g>
<!-- layer21_moe_expert12 -->
<g id="node971" class="node">
<title>layer21_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5953,-30970.18 5615,-30970.18 5615,-30918.18 5953,-30918.18 5953,-30970.18"/>
<text text-anchor="middle" x="5784" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 12 L21</text>
<text text-anchor="middle" x="5784" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5784" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5784" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert12 -->
<g id="node992" class="node">
<title>layer21_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5677" cy="-30853.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5677" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5677" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5677" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer21_moe_expert12&#45;&gt;layer21_moe_comm_from_expert12 -->
<g id="edge1269" class="edge">
<title>layer21_moe_expert12&#45;&gt;layer21_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5693.38,-30917.86C5693.38,-30917.86 5693.38,-30891.99 5693.38,-30891.99"/>
<polygon fill="black" stroke="black" points="5696.88,-30891.99 5693.38,-30881.99 5689.88,-30891.99 5696.88,-30891.99"/>
</g>
<!-- layer21_moe_comm_to_expert12&#45;&gt;layer21_moe_expert12 -->
<g id="edge1238" class="edge">
<title>layer21_moe_comm_to_expert12&#45;&gt;layer21_moe_expert12</title>
<path fill="none" stroke="black" d="M5692.52,-31006.38C5692.52,-31006.38 5692.52,-30980.31 5692.52,-30980.31"/>
<polygon fill="black" stroke="black" points="5696.02,-30980.31 5692.52,-30970.31 5689.02,-30980.31 5696.02,-30980.31"/>
</g>
<!-- layer21_moe_expert13 -->
<g id="node973" class="node">
<title>layer21_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6309,-30970.18 5971,-30970.18 5971,-30918.18 6309,-30918.18 6309,-30970.18"/>
<text text-anchor="middle" x="6140" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 13 L21</text>
<text text-anchor="middle" x="6140" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6140" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6140" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert13 -->
<g id="node993" class="node">
<title>layer21_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="6031" cy="-30853.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6031" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="6031" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6031" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer21_moe_expert13&#45;&gt;layer21_moe_comm_from_expert13 -->
<g id="edge1271" class="edge">
<title>layer21_moe_expert13&#45;&gt;layer21_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6048.38,-30917.86C6048.38,-30917.86 6048.38,-30891.99 6048.38,-30891.99"/>
<polygon fill="black" stroke="black" points="6051.88,-30891.99 6048.38,-30881.99 6044.88,-30891.99 6051.88,-30891.99"/>
</g>
<!-- layer21_moe_comm_to_expert13&#45;&gt;layer21_moe_expert13 -->
<g id="edge1240" class="edge">
<title>layer21_moe_comm_to_expert13&#45;&gt;layer21_moe_expert13</title>
<path fill="none" stroke="black" d="M6047.02,-31006.38C6047.02,-31006.38 6047.02,-30980.31 6047.02,-30980.31"/>
<polygon fill="black" stroke="black" points="6050.52,-30980.31 6047.02,-30970.31 6043.52,-30980.31 6050.52,-30980.31"/>
</g>
<!-- layer21_moe_expert14 -->
<g id="node975" class="node">
<title>layer21_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6665,-30970.18 6327,-30970.18 6327,-30918.18 6665,-30918.18 6665,-30970.18"/>
<text text-anchor="middle" x="6496" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 14 L21</text>
<text text-anchor="middle" x="6496" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6496" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6496" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert14 -->
<g id="node994" class="node">
<title>layer21_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6386" cy="-30853.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6386" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6386" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6386" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer21_moe_expert14&#45;&gt;layer21_moe_comm_from_expert14 -->
<g id="edge1273" class="edge">
<title>layer21_moe_expert14&#45;&gt;layer21_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6403.88,-30917.86C6403.88,-30917.86 6403.88,-30891.67 6403.88,-30891.67"/>
<polygon fill="black" stroke="black" points="6407.38,-30891.67 6403.88,-30881.67 6400.38,-30891.67 6407.38,-30891.67"/>
</g>
<!-- layer21_moe_comm_to_expert14&#45;&gt;layer21_moe_expert14 -->
<g id="edge1242" class="edge">
<title>layer21_moe_comm_to_expert14&#45;&gt;layer21_moe_expert14</title>
<path fill="none" stroke="black" d="M6402.52,-31006.38C6402.52,-31006.38 6402.52,-30980.31 6402.52,-30980.31"/>
<polygon fill="black" stroke="black" points="6406.02,-30980.31 6402.52,-30970.31 6399.02,-30980.31 6406.02,-30980.31"/>
</g>
<!-- layer21_moe_expert15 -->
<g id="node977" class="node">
<title>layer21_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="7021,-30970.18 6683,-30970.18 6683,-30918.18 7021,-30918.18 7021,-30970.18"/>
<text text-anchor="middle" x="6852" y="-30958.18" font-family="Arial" font-size="10.00">EXPERT 15 L21</text>
<text text-anchor="middle" x="6852" y="-30947.18" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6852" y="-30936.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6852" y="-30925.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_comm_from_expert15 -->
<g id="node995" class="node">
<title>layer21_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6741" cy="-30853.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6741" y="-30861.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6741" y="-30850.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6741" y="-30839.69" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer21_moe_expert15&#45;&gt;layer21_moe_comm_from_expert15 -->
<g id="edge1275" class="edge">
<title>layer21_moe_expert15&#45;&gt;layer21_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6759.38,-30917.86C6759.38,-30917.86 6759.38,-30891.67 6759.38,-30891.67"/>
<polygon fill="black" stroke="black" points="6762.88,-30891.67 6759.38,-30881.67 6755.88,-30891.67 6762.88,-30891.67"/>
</g>
<!-- layer21_moe_comm_to_expert15&#45;&gt;layer21_moe_expert15 -->
<g id="edge1244" class="edge">
<title>layer21_moe_comm_to_expert15&#45;&gt;layer21_moe_expert15</title>
<path fill="none" stroke="black" d="M6758.02,-31006.38C6758.02,-31006.38 6758.02,-30980.31 6758.02,-30980.31"/>
<polygon fill="black" stroke="black" points="6761.52,-30980.31 6758.02,-30970.31 6754.52,-30980.31 6761.52,-30980.31"/>
</g>
<!-- layer21_moe_aggregate -->
<g id="node979" class="node">
<title>layer21_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4427.1,-30788.19 4010.16,-30788.19 3902.9,-30684.19 4319.84,-30684.19 4427.1,-30788.19"/>
<text text-anchor="middle" x="4165" y="-30750.19" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L21</text>
<text text-anchor="middle" x="4165" y="-30739.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4165" y="-30728.19" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4165" y="-30717.19" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_mha -->
<g id="node996" class="node">
<title>layer22_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4295,-30648.19 4035,-30648.19 4035,-30596.19 4295,-30596.19 4295,-30648.19"/>
<text text-anchor="middle" x="4165" y="-30636.19" font-family="Arial" font-size="10.00">MHA L22</text>
<text text-anchor="middle" x="4165" y="-30625.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4165" y="-30614.19" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4165" y="-30603.19" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer21_moe_aggregate&#45;&gt;layer22_moe_mha -->
<g id="edge1344" class="edge">
<title>layer21_moe_aggregate&#45;&gt;layer22_moe_mha</title>
<path fill="none" stroke="black" d="M4165,-30683.87C4165,-30683.87 4165,-30658.42 4165,-30658.42"/>
<polygon fill="black" stroke="black" points="4168.5,-30658.42 4165,-30648.42 4161.5,-30658.42 4168.5,-30658.42"/>
</g>
<!-- layer21_moe_comm_from_expert0&#45;&gt;layer21_moe_aggregate -->
<g id="edge1246" class="edge">
<title>layer21_moe_comm_from_expert0&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M2154.75,-30825.98C2154.75,-30781.71 2154.75,-30699 2154.75,-30699 2154.75,-30699 3908,-30699 3908,-30699"/>
<polygon fill="black" stroke="black" points="3908,-30702.5 3918,-30699 3908,-30695.5 3908,-30702.5"/>
</g>
<!-- layer21_moe_comm_from_expert1&#45;&gt;layer21_moe_aggregate -->
<g id="edge1248" class="edge">
<title>layer21_moe_comm_from_expert1&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M2450.25,-30842.19C2450.25,-30809.14 2450.25,-30713 2450.25,-30713 2450.25,-30713 3922.4,-30713 3922.4,-30713"/>
<polygon fill="black" stroke="black" points="3922.4,-30716.5 3932.4,-30713 3922.4,-30709.5 3922.4,-30716.5"/>
</g>
<!-- layer21_moe_comm_from_expert2&#45;&gt;layer21_moe_aggregate -->
<g id="edge1250" class="edge">
<title>layer21_moe_comm_from_expert2&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M2855,-30826.02C2855,-30789.2 2855,-30728 2855,-30728 2855,-30728 3937.95,-30728 3937.95,-30728"/>
<polygon fill="black" stroke="black" points="3937.95,-30731.5 3947.95,-30728 3937.95,-30724.5 3937.95,-30731.5"/>
</g>
<!-- layer21_moe_comm_from_expert3&#45;&gt;layer21_moe_aggregate -->
<g id="edge1252" class="edge">
<title>layer21_moe_comm_from_expert3&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M3210.5,-30831.42C3210.5,-30799.3 3210.5,-30743 3210.5,-30743 3210.5,-30743 3953.45,-30743 3953.45,-30743"/>
<polygon fill="black" stroke="black" points="3953.45,-30746.5 3963.45,-30743 3953.45,-30739.5 3953.45,-30746.5"/>
</g>
<!-- layer21_moe_comm_from_expert4&#45;&gt;layer21_moe_aggregate -->
<g id="edge1254" class="edge">
<title>layer21_moe_comm_from_expert4&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M3487.5,-30836.61C3487.5,-30809.33 3487.5,-30758 3487.5,-30758 3487.5,-30758 3968.97,-30758 3968.97,-30758"/>
<polygon fill="black" stroke="black" points="3968.97,-30761.5 3978.97,-30758 3968.97,-30754.5 3968.97,-30761.5"/>
</g>
<!-- layer21_moe_comm_from_expert5&#45;&gt;layer21_moe_aggregate -->
<g id="edge1256" class="edge">
<title>layer21_moe_comm_from_expert5&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M3725.5,-30840.3C3725.5,-30817.64 3725.5,-30773 3725.5,-30773 3725.5,-30773 3984.45,-30773 3984.45,-30773"/>
<polygon fill="black" stroke="black" points="3984.45,-30776.5 3994.45,-30773 3984.45,-30769.5 3984.45,-30776.5"/>
</g>
<!-- layer21_moe_comm_from_expert6&#45;&gt;layer21_moe_aggregate -->
<g id="edge1258" class="edge">
<title>layer21_moe_comm_from_expert6&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M3926.11,-30833.6C3926.11,-30833.6 3926.11,-30746.24 3926.11,-30746.24"/>
<polygon fill="black" stroke="black" points="3929.61,-30746.24 3926.11,-30736.24 3922.61,-30746.24 3929.61,-30746.24"/>
</g>
<!-- layer21_moe_comm_from_expert7&#45;&gt;layer21_moe_aggregate -->
<g id="edge1260" class="edge">
<title>layer21_moe_comm_from_expert7&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M4066,-30823.97C4066,-30823.97 4066,-30798.25 4066,-30798.25"/>
<polygon fill="black" stroke="black" points="4069.5,-30798.25 4066,-30788.25 4062.5,-30798.25 4069.5,-30798.25"/>
</g>
<!-- layer21_moe_comm_from_expert8&#45;&gt;layer21_moe_aggregate -->
<g id="edge1262" class="edge">
<title>layer21_moe_comm_from_expert8&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M4337.39,-30823.97C4337.39,-30823.97 4337.39,-30798.25 4337.39,-30798.25"/>
<polygon fill="black" stroke="black" points="4340.89,-30798.25 4337.39,-30788.25 4333.89,-30798.25 4340.89,-30798.25"/>
</g>
<!-- layer21_moe_comm_from_expert9&#45;&gt;layer21_moe_aggregate -->
<g id="edge1264" class="edge">
<title>layer21_moe_comm_from_expert9&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M4628.5,-30824.52C4628.5,-30802.2 4628.5,-30775 4628.5,-30775 4628.5,-30775 4423.71,-30775 4423.71,-30775"/>
<polygon fill="black" stroke="black" points="4423.71,-30771.5 4413.71,-30775 4423.71,-30778.5 4423.71,-30771.5"/>
</g>
<!-- layer21_moe_comm_from_expert10&#45;&gt;layer21_moe_aggregate -->
<g id="edge1266" class="edge">
<title>layer21_moe_comm_from_expert10&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M4960.15,-30824.33C4960.15,-30797.62 4960.15,-30762 4960.15,-30762 4960.15,-30762 4410.34,-30762 4410.34,-30762"/>
<polygon fill="black" stroke="black" points="4410.34,-30758.5 4400.34,-30762 4410.34,-30765.5 4410.34,-30758.5"/>
</g>
<!-- layer21_moe_comm_from_expert11&#45;&gt;layer21_moe_aggregate -->
<g id="edge1268" class="edge">
<title>layer21_moe_comm_from_expert11&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M5306.65,-30824.72C5306.65,-30793.87 5306.65,-30749 5306.65,-30749 5306.65,-30749 4396.81,-30749 4396.81,-30749"/>
<polygon fill="black" stroke="black" points="4396.81,-30745.5 4386.81,-30749 4396.81,-30752.5 4396.81,-30745.5"/>
</g>
<!-- layer21_moe_comm_from_expert12&#45;&gt;layer21_moe_aggregate -->
<g id="edge1270" class="edge">
<title>layer21_moe_comm_from_expert12&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M5657.65,-30824.52C5657.65,-30789.83 5657.65,-30736 5657.65,-30736 5657.65,-30736 4383.33,-30736 4383.33,-30736"/>
<polygon fill="black" stroke="black" points="4383.33,-30732.5 4373.33,-30736 4383.33,-30739.5 4383.33,-30732.5"/>
</g>
<!-- layer21_moe_comm_from_expert13&#45;&gt;layer21_moe_aggregate -->
<g id="edge1272" class="edge">
<title>layer21_moe_comm_from_expert13&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M6011.15,-30824.62C6011.15,-30786.29 6011.15,-30723 6011.15,-30723 6011.15,-30723 4369.95,-30723 4369.95,-30723"/>
<polygon fill="black" stroke="black" points="4369.95,-30719.5 4359.95,-30723 4369.95,-30726.5 4369.95,-30719.5"/>
</g>
<!-- layer21_moe_comm_from_expert14&#45;&gt;layer21_moe_aggregate -->
<g id="edge1274" class="edge">
<title>layer21_moe_comm_from_expert14&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M6366.15,-30824.55C6366.15,-30782.77 6366.15,-30710 6366.15,-30710 6366.15,-30710 4356.53,-30710 4356.53,-30710"/>
<polygon fill="black" stroke="black" points="4356.53,-30706.5 4346.53,-30710 4356.53,-30713.5 4356.53,-30706.5"/>
</g>
<!-- layer21_moe_comm_from_expert15&#45;&gt;layer21_moe_aggregate -->
<g id="edge1276" class="edge">
<title>layer21_moe_comm_from_expert15&#45;&gt;layer21_moe_aggregate</title>
<path fill="none" stroke="black" d="M6721.15,-30824.54C6721.15,-30779.45 6721.15,-30697 6721.15,-30697 6721.15,-30697 4343.21,-30697 4343.21,-30697"/>
<polygon fill="black" stroke="black" points="4343.21,-30693.5 4333.21,-30697 4343.21,-30700.5 4343.21,-30693.5"/>
</g>
<!-- layer22_moe_gate -->
<g id="node997" class="node">
<title>layer22_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4423.3,-30560.19 4012.4,-30560.19 3906.7,-30456.19 4317.6,-30456.19 4423.3,-30560.19"/>
<text text-anchor="middle" x="4165" y="-30522.19" font-family="Arial" font-size="10.00">GATE L22</text>
<text text-anchor="middle" x="4165" y="-30511.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4165" y="-30500.19" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4165" y="-30489.19" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer22_moe_mha&#45;&gt;layer22_moe_gate -->
<g id="edge1345" class="edge">
<title>layer22_moe_mha&#45;&gt;layer22_moe_gate</title>
<path fill="none" stroke="black" d="M4165,-30596.04C4165,-30596.04 4165,-30570.29 4165,-30570.29"/>
<polygon fill="black" stroke="black" points="4168.5,-30570.29 4165,-30560.29 4161.5,-30570.29 4168.5,-30570.29"/>
</g>
<!-- layer22_moe_split -->
<g id="node998" class="node">
<title>layer22_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4419.01,-30420.19 4014.94,-30420.19 3910.99,-30316.19 4315.06,-30316.19 4419.01,-30420.19"/>
<text text-anchor="middle" x="4165" y="-30382.19" font-family="Arial" font-size="10.00">SPLIT TOKENS L22</text>
<text text-anchor="middle" x="4165" y="-30371.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4165" y="-30360.19" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4165" y="-30349.19" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer22_moe_gate&#45;&gt;layer22_moe_split -->
<g id="edge1346" class="edge">
<title>layer22_moe_gate&#45;&gt;layer22_moe_split</title>
<path fill="none" stroke="black" d="M4165,-30456.06C4165,-30456.06 4165,-30430.37 4165,-30430.37"/>
<polygon fill="black" stroke="black" points="4168.5,-30430.37 4165,-30420.37 4161.5,-30430.37 4168.5,-30430.37"/>
</g>
<!-- layer22_moe_comm_to_expert0 -->
<g id="node1000" class="node">
<title>layer22_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1643" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1643" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1643" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1643" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert0 -->
<g id="edge1280" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3999.52,-30405C3438.45,-30405 1643,-30405 1643,-30405 1643,-30405 1643,-30290.49 1643,-30290.49"/>
<polygon fill="black" stroke="black" points="1646.5,-30290.49 1643,-30280.49 1639.5,-30290.49 1646.5,-30290.49"/>
</g>
<!-- layer22_moe_comm_to_expert1 -->
<g id="node1002" class="node">
<title>layer22_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2001" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2001" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2001" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2001" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert1 -->
<g id="edge1282" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3984.7,-30390C3475.12,-30390 2061,-30390 2061,-30390 2061,-30390 2061,-30283.2 2061,-30283.2"/>
<polygon fill="black" stroke="black" points="2064.5,-30283.2 2061,-30273.2 2057.5,-30283.2 2064.5,-30283.2"/>
</g>
<!-- layer22_moe_comm_to_expert2 -->
<g id="node1004" class="node">
<title>layer22_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2322" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2322" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2322" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2322" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert2 -->
<g id="edge1284" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3969.69,-30375C3499.64,-30375 2344,-30375 2344,-30375 2344,-30375 2344,-30289.6 2344,-30289.6"/>
<polygon fill="black" stroke="black" points="2347.5,-30289.6 2344,-30279.6 2340.5,-30289.6 2347.5,-30289.6"/>
</g>
<!-- layer22_moe_comm_to_expert3 -->
<g id="node1006" class="node">
<title>layer22_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2888" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2888" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2888" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2888" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert3 -->
<g id="edge1286" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3954.67,-30360C3605.82,-30360 2945.51,-30360 2945.51,-30360 2945.51,-30360 2945.51,-30283.75 2945.51,-30283.75"/>
<polygon fill="black" stroke="black" points="2949.01,-30283.75 2945.51,-30273.75 2942.01,-30283.75 2949.01,-30283.75"/>
</g>
<!-- layer22_moe_comm_to_expert4 -->
<g id="node1008" class="node">
<title>layer22_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3271" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3271" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3271" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3271" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert4 -->
<g id="edge1288" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3939.57,-30345C3695.91,-30345 3342,-30345 3342,-30345 3342,-30345 3342,-30279.29 3342,-30279.29"/>
<polygon fill="black" stroke="black" points="3345.5,-30279.29 3342,-30269.29 3338.5,-30279.29 3345.5,-30279.29"/>
</g>
<!-- layer22_moe_comm_to_expert5 -->
<g id="node1010" class="node">
<title>layer22_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3562" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3562" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3562" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3562" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert5 -->
<g id="edge1290" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3925.44,-30331C3772.58,-30331 3603,-30331 3603,-30331 3603,-30331 3603,-30287.33 3603,-30287.33"/>
<polygon fill="black" stroke="black" points="3606.5,-30287.33 3603,-30277.33 3599.5,-30287.33 3606.5,-30287.33"/>
</g>
<!-- layer22_moe_comm_to_expert6 -->
<g id="node1012" class="node">
<title>layer22_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3807" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3807" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3807" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3807" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert6 -->
<g id="edge1292" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3924.74,-30368.11C3924.74,-30364.56 3924.74,-30251 3924.74,-30251 3924.74,-30251 3907.73,-30251 3907.73,-30251"/>
<polygon fill="black" stroke="black" points="3907.73,-30247.5 3897.73,-30251 3907.73,-30254.5 3907.73,-30247.5"/>
</g>
<!-- layer22_moe_comm_to_expert7 -->
<g id="node1014" class="node">
<title>layer22_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4029" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4029" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="4029" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4029" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert7 -->
<g id="edge1294" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4029,-30315.86C4029,-30315.86 4029,-30290.41 4029,-30290.41"/>
<polygon fill="black" stroke="black" points="4032.5,-30290.41 4029,-30280.41 4025.5,-30290.41 4032.5,-30290.41"/>
</g>
<!-- layer22_moe_comm_to_expert8 -->
<g id="node1016" class="node">
<title>layer22_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4301" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4301" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4301" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4301" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert8 -->
<g id="edge1296" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4301,-30315.86C4301,-30315.86 4301,-30290.41 4301,-30290.41"/>
<polygon fill="black" stroke="black" points="4304.5,-30290.41 4301,-30280.41 4297.5,-30290.41 4304.5,-30290.41"/>
</g>
<!-- layer22_moe_comm_to_expert9 -->
<g id="node1018" class="node">
<title>layer22_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4610" cy="-30251.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4610" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4610" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4610" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert9 -->
<g id="edge1298" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4405.26,-30368.11C4405.26,-30364.56 4405.26,-30251 4405.26,-30251 4405.26,-30251 4509.3,-30251 4509.3,-30251"/>
<polygon fill="black" stroke="black" points="4509.3,-30254.5 4519.3,-30251 4509.3,-30247.5 4509.3,-30254.5"/>
</g>
<!-- layer22_moe_comm_to_expert10 -->
<g id="node1020" class="node">
<title>layer22_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4942" cy="-30251.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4942" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4942" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4942" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert10 -->
<g id="edge1300" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4330.26,-30331C4537.54,-30331 4866.1,-30331 4866.1,-30331 4866.1,-30331 4866.1,-30278.52 4866.1,-30278.52"/>
<polygon fill="black" stroke="black" points="4869.6,-30278.52 4866.1,-30268.52 4862.6,-30278.52 4869.6,-30278.52"/>
</g>
<!-- layer22_moe_comm_to_expert11 -->
<g id="node1022" class="node">
<title>layer22_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5288" cy="-30251.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5288" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5288" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5288" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert11 -->
<g id="edge1302" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4343.9,-30345C4643.11,-30345 5212.6,-30345 5212.6,-30345 5212.6,-30345 5212.6,-30278.85 5212.6,-30278.85"/>
<polygon fill="black" stroke="black" points="5216.1,-30278.85 5212.6,-30268.85 5209.1,-30278.85 5216.1,-30278.85"/>
</g>
<!-- layer22_moe_comm_to_expert12 -->
<g id="node1024" class="node">
<title>layer22_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5639" cy="-30251.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5639" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5639" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5639" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert12 -->
<g id="edge1304" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4359.1,-30360C4743.24,-30360 5563.6,-30360 5563.6,-30360 5563.6,-30360 5563.6,-30278.68 5563.6,-30278.68"/>
<polygon fill="black" stroke="black" points="5567.1,-30278.68 5563.6,-30268.68 5560.1,-30278.68 5567.1,-30278.68"/>
</g>
<!-- layer22_moe_comm_to_expert13 -->
<g id="node1026" class="node">
<title>layer22_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5992" cy="-30251.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5992" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5992" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5992" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert13 -->
<g id="edge1306" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4374.17,-30375C4839,-30375 5917.1,-30375 5917.1,-30375 5917.1,-30375 5917.1,-30278.94 5917.1,-30278.94"/>
<polygon fill="black" stroke="black" points="5920.6,-30278.94 5917.1,-30268.94 5913.6,-30278.94 5920.6,-30278.94"/>
</g>
<!-- layer22_moe_comm_to_expert14 -->
<g id="node1028" class="node">
<title>layer22_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6347" cy="-30251.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6347" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6347" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6347" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert14 -->
<g id="edge1308" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4389,-30390C4931.61,-30390 6272.1,-30390 6272.1,-30390 6272.1,-30390 6272.1,-30278.78 6272.1,-30278.78"/>
<polygon fill="black" stroke="black" points="6275.6,-30278.78 6272.1,-30268.78 6268.6,-30278.78 6275.6,-30278.78"/>
</g>
<!-- layer22_moe_comm_to_expert15 -->
<g id="node1030" class="node">
<title>layer22_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6702" cy="-30251.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6702" y="-30259.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6702" y="-30248.7" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6702" y="-30237.7" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert15 -->
<g id="edge1310" class="edge">
<title>layer22_moe_split&#45;&gt;layer22_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4403.87,-30405C5022.18,-30405 6627.1,-30405 6627.1,-30405 6627.1,-30405 6627.1,-30278.85 6627.1,-30278.85"/>
<polygon fill="black" stroke="black" points="6630.6,-30278.85 6627.1,-30268.85 6623.6,-30278.85 6630.6,-30278.85"/>
</g>
<!-- layer22_moe_expert0 -->
<g id="node999" class="node">
<title>layer22_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1734,-30186.21 1406,-30186.21 1406,-30134.21 1734,-30134.21 1734,-30186.21"/>
<text text-anchor="middle" x="1570" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 0 L22</text>
<text text-anchor="middle" x="1570" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1570" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1570" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert0 -->
<g id="node1032" class="node">
<title>layer22_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1616" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1616" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1616" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1616" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer22_moe_expert0&#45;&gt;layer22_moe_comm_from_expert0 -->
<g id="edge1312" class="edge">
<title>layer22_moe_expert0&#45;&gt;layer22_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1616,-30133.89C1616,-30133.89 1616,-30108.35 1616,-30108.35"/>
<polygon fill="black" stroke="black" points="1619.5,-30108.35 1616,-30098.35 1612.5,-30108.35 1619.5,-30108.35"/>
</g>
<!-- layer22_moe_comm_to_expert0&#45;&gt;layer22_moe_expert0 -->
<g id="edge1281" class="edge">
<title>layer22_moe_comm_to_expert0&#45;&gt;layer22_moe_expert0</title>
<path fill="none" stroke="black" d="M1643,-30222.16C1643,-30222.16 1643,-30196.51 1643,-30196.51"/>
<polygon fill="black" stroke="black" points="1646.5,-30196.51 1643,-30186.51 1639.5,-30196.51 1646.5,-30196.51"/>
</g>
<!-- layer22_moe_expert1 -->
<g id="node1001" class="node">
<title>layer22_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2080,-30186.21 1752,-30186.21 1752,-30134.21 2080,-30134.21 2080,-30186.21"/>
<text text-anchor="middle" x="1916" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 1 L22</text>
<text text-anchor="middle" x="1916" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1916" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1916" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert1 -->
<g id="node1033" class="node">
<title>layer22_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2329" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2329" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2329" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2329" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer22_moe_expert1&#45;&gt;layer22_moe_comm_from_expert1 -->
<g id="edge1314" class="edge">
<title>layer22_moe_expert1&#45;&gt;layer22_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M2018.25,-30133.83C2018.25,-30106.89 2018.25,-30069 2018.25,-30069 2018.25,-30069 2228.28,-30069 2228.28,-30069"/>
<polygon fill="black" stroke="black" points="2228.28,-30072.5 2238.28,-30069 2228.28,-30065.5 2228.28,-30072.5"/>
</g>
<!-- layer22_moe_comm_to_expert1&#45;&gt;layer22_moe_expert1 -->
<g id="edge1283" class="edge">
<title>layer22_moe_comm_to_expert1&#45;&gt;layer22_moe_expert1</title>
<path fill="none" stroke="black" d="M1995.25,-30222.16C1995.25,-30222.16 1995.25,-30196.51 1995.25,-30196.51"/>
<polygon fill="black" stroke="black" points="1998.75,-30196.51 1995.25,-30186.51 1991.75,-30196.51 1998.75,-30196.51"/>
</g>
<!-- layer22_moe_expert2 -->
<g id="node1003" class="node">
<title>layer22_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2426,-30186.21 2098,-30186.21 2098,-30134.21 2426,-30134.21 2426,-30186.21"/>
<text text-anchor="middle" x="2262" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 2 L22</text>
<text text-anchor="middle" x="2262" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2262" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2262" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert2 -->
<g id="node1034" class="node">
<title>layer22_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2785" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2785" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2785" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2785" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer22_moe_expert2&#45;&gt;layer22_moe_comm_from_expert2 -->
<g id="edge1316" class="edge">
<title>layer22_moe_expert2&#45;&gt;layer22_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2426.18,-30160C2431.77,-30160 2435,-30160 2435,-30160 2435,-30160 2435,-30069 2435,-30069 2435,-30069 2684.41,-30069 2684.41,-30069"/>
<polygon fill="black" stroke="black" points="2684.41,-30072.5 2694.41,-30069 2684.41,-30065.5 2684.41,-30072.5"/>
</g>
<!-- layer22_moe_comm_to_expert2&#45;&gt;layer22_moe_expert2 -->
<g id="edge1285" class="edge">
<title>layer22_moe_comm_to_expert2&#45;&gt;layer22_moe_expert2</title>
<path fill="none" stroke="black" d="M2322,-30222.16C2322,-30222.16 2322,-30196.51 2322,-30196.51"/>
<polygon fill="black" stroke="black" points="2325.5,-30196.51 2322,-30186.51 2318.5,-30196.51 2325.5,-30196.51"/>
</g>
<!-- layer22_moe_expert3 -->
<g id="node1005" class="node">
<title>layer22_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2772,-30186.21 2444,-30186.21 2444,-30134.21 2772,-30134.21 2772,-30186.21"/>
<text text-anchor="middle" x="2608" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 3 L22</text>
<text text-anchor="middle" x="2608" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2608" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2608" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert3 -->
<g id="node1035" class="node">
<title>layer22_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3113" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3113" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3113" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3113" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer22_moe_expert3&#45;&gt;layer22_moe_comm_from_expert3 -->
<g id="edge1318" class="edge">
<title>layer22_moe_expert3&#45;&gt;layer22_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2733.25,-30133.93C2733.25,-30121.78 2733.25,-30110 2733.25,-30110 2733.25,-30110 3054.33,-30110 3054.33,-30110 3054.33,-30110 3054.33,-30101.52 3054.33,-30101.52"/>
<polygon fill="black" stroke="black" points="3057.83,-30101.52 3054.33,-30091.52 3050.83,-30101.52 3057.83,-30101.52"/>
</g>
<!-- layer22_moe_comm_to_expert3&#45;&gt;layer22_moe_expert3 -->
<g id="edge1287" class="edge">
<title>layer22_moe_comm_to_expert3&#45;&gt;layer22_moe_expert3</title>
<path fill="none" stroke="black" d="M2797.12,-30251C2772.12,-30251 2751.75,-30251 2751.75,-30251 2751.75,-30251 2751.75,-30196.47 2751.75,-30196.47"/>
<polygon fill="black" stroke="black" points="2755.25,-30196.47 2751.75,-30186.47 2748.25,-30196.47 2755.25,-30196.47"/>
</g>
<!-- layer22_moe_expert4 -->
<g id="node1007" class="node">
<title>layer22_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3118,-30186.21 2790,-30186.21 2790,-30134.21 3118,-30134.21 3118,-30186.21"/>
<text text-anchor="middle" x="2954" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 4 L22</text>
<text text-anchor="middle" x="2954" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2954" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2954" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert4 -->
<g id="node1036" class="node">
<title>layer22_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3376" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3376" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3376" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3376" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer22_moe_expert4&#45;&gt;layer22_moe_comm_from_expert4 -->
<g id="edge1320" class="edge">
<title>layer22_moe_expert4&#45;&gt;layer22_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3086.16,-30134.09C3086.16,-30127.37 3086.16,-30122 3086.16,-30122 3086.16,-30122 3374.75,-30122 3374.75,-30122 3374.75,-30122 3374.75,-30108.39 3374.75,-30108.39"/>
<polygon fill="black" stroke="black" points="3378.25,-30108.39 3374.75,-30098.39 3371.25,-30108.39 3378.25,-30108.39"/>
</g>
<!-- layer22_moe_comm_to_expert4&#45;&gt;layer22_moe_expert4 -->
<g id="edge1289" class="edge">
<title>layer22_moe_comm_to_expert4&#45;&gt;layer22_moe_expert4</title>
<path fill="none" stroke="black" d="M3180.41,-30251C3134.67,-30251 3088.75,-30251 3088.75,-30251 3088.75,-30251 3088.75,-30196.47 3088.75,-30196.47"/>
<polygon fill="black" stroke="black" points="3092.25,-30196.47 3088.75,-30186.47 3085.25,-30196.47 3092.25,-30196.47"/>
</g>
<!-- layer22_moe_expert5 -->
<g id="node1009" class="node">
<title>layer22_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3464,-30186.21 3136,-30186.21 3136,-30134.21 3464,-30134.21 3464,-30186.21"/>
<text text-anchor="middle" x="3300" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 5 L22</text>
<text text-anchor="middle" x="3300" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3300" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3300" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert5 -->
<g id="node1037" class="node">
<title>layer22_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3607" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3607" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3607" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3607" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer22_moe_expert5&#45;&gt;layer22_moe_comm_from_expert5 -->
<g id="edge1322" class="edge">
<title>layer22_moe_expert5&#45;&gt;layer22_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3464.04,-30151C3470.42,-30151 3474.16,-30151 3474.16,-30151 3474.16,-30151 3474.16,-30069 3474.16,-30069 3474.16,-30069 3506.19,-30069 3506.19,-30069"/>
<polygon fill="black" stroke="black" points="3506.19,-30072.5 3516.19,-30069 3506.19,-30065.5 3506.19,-30072.5"/>
</g>
<!-- layer22_moe_comm_to_expert5&#45;&gt;layer22_moe_expert5 -->
<g id="edge1291" class="edge">
<title>layer22_moe_comm_to_expert5&#45;&gt;layer22_moe_expert5</title>
<path fill="none" stroke="black" d="M3476.82,-30241.33C3476.82,-30219.29 3476.82,-30168 3476.82,-30168 3476.82,-30168 3474.11,-30168 3474.11,-30168"/>
<polygon fill="black" stroke="black" points="3474.11,-30164.5 3464.11,-30168 3474.11,-30171.5 3474.11,-30164.5"/>
</g>
<!-- layer22_moe_expert6 -->
<g id="node1011" class="node">
<title>layer22_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3810,-30186.21 3482,-30186.21 3482,-30134.21 3810,-30134.21 3810,-30186.21"/>
<text text-anchor="middle" x="3646" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 6 L22</text>
<text text-anchor="middle" x="3646" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3646" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3646" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert6 -->
<g id="node1038" class="node">
<title>layer22_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3822" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3822" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3822" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3822" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer22_moe_expert6&#45;&gt;layer22_moe_comm_from_expert6 -->
<g id="edge1324" class="edge">
<title>layer22_moe_expert6&#45;&gt;layer22_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3770.75,-30133.89C3770.75,-30133.89 3770.75,-30103.3 3770.75,-30103.3"/>
<polygon fill="black" stroke="black" points="3774.25,-30103.3 3770.75,-30093.3 3767.25,-30103.3 3774.25,-30103.3"/>
</g>
<!-- layer22_moe_comm_to_expert6&#45;&gt;layer22_moe_expert6 -->
<g id="edge1293" class="edge">
<title>layer22_moe_comm_to_expert6&#45;&gt;layer22_moe_expert6</title>
<path fill="none" stroke="black" d="M3763.25,-30225.37C3763.25,-30225.37 3763.25,-30196.42 3763.25,-30196.42"/>
<polygon fill="black" stroke="black" points="3766.75,-30196.42 3763.25,-30186.42 3759.75,-30196.42 3766.75,-30196.42"/>
</g>
<!-- layer22_moe_expert7 -->
<g id="node1013" class="node">
<title>layer22_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4156,-30186.21 3828,-30186.21 3828,-30134.21 4156,-30134.21 4156,-30186.21"/>
<text text-anchor="middle" x="3992" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 7 L22</text>
<text text-anchor="middle" x="3992" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3992" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3992" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert7 -->
<g id="node1039" class="node">
<title>layer22_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="4029" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4029" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="4029" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4029" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer22_moe_expert7&#45;&gt;layer22_moe_comm_from_expert7 -->
<g id="edge1326" class="edge">
<title>layer22_moe_expert7&#45;&gt;layer22_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M4029,-30133.89C4029,-30133.89 4029,-30108.35 4029,-30108.35"/>
<polygon fill="black" stroke="black" points="4032.5,-30108.35 4029,-30098.35 4025.5,-30108.35 4032.5,-30108.35"/>
</g>
<!-- layer22_moe_comm_to_expert7&#45;&gt;layer22_moe_expert7 -->
<g id="edge1295" class="edge">
<title>layer22_moe_comm_to_expert7&#45;&gt;layer22_moe_expert7</title>
<path fill="none" stroke="black" d="M4029,-30222.16C4029,-30222.16 4029,-30196.51 4029,-30196.51"/>
<polygon fill="black" stroke="black" points="4032.5,-30196.51 4029,-30186.51 4025.5,-30196.51 4032.5,-30196.51"/>
</g>
<!-- layer22_moe_expert8 -->
<g id="node1015" class="node">
<title>layer22_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4502,-30186.21 4174,-30186.21 4174,-30134.21 4502,-30134.21 4502,-30186.21"/>
<text text-anchor="middle" x="4338" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 8 L22</text>
<text text-anchor="middle" x="4338" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4338" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4338" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert8 -->
<g id="node1040" class="node">
<title>layer22_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4301" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4301" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4301" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4301" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer22_moe_expert8&#45;&gt;layer22_moe_comm_from_expert8 -->
<g id="edge1328" class="edge">
<title>layer22_moe_expert8&#45;&gt;layer22_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4301,-30133.89C4301,-30133.89 4301,-30108.35 4301,-30108.35"/>
<polygon fill="black" stroke="black" points="4304.5,-30108.35 4301,-30098.35 4297.5,-30108.35 4304.5,-30108.35"/>
</g>
<!-- layer22_moe_comm_to_expert8&#45;&gt;layer22_moe_expert8 -->
<g id="edge1297" class="edge">
<title>layer22_moe_comm_to_expert8&#45;&gt;layer22_moe_expert8</title>
<path fill="none" stroke="black" d="M4301,-30222.16C4301,-30222.16 4301,-30196.51 4301,-30196.51"/>
<polygon fill="black" stroke="black" points="4304.5,-30196.51 4301,-30186.51 4297.5,-30196.51 4304.5,-30196.51"/>
</g>
<!-- layer22_moe_expert9 -->
<g id="node1017" class="node">
<title>layer22_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4848,-30186.21 4520,-30186.21 4520,-30134.21 4848,-30134.21 4848,-30186.21"/>
<text text-anchor="middle" x="4684" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 9 L22</text>
<text text-anchor="middle" x="4684" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4684" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4684" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert9 -->
<g id="node1041" class="node">
<title>layer22_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4610" cy="-30069.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4610" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4610" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4610" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer22_moe_expert9&#45;&gt;layer22_moe_comm_from_expert9 -->
<g id="edge1330" class="edge">
<title>layer22_moe_expert9&#45;&gt;layer22_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4610.25,-30133.89C4610.25,-30133.89 4610.25,-30108.35 4610.25,-30108.35"/>
<polygon fill="black" stroke="black" points="4613.75,-30108.35 4610.25,-30098.35 4606.75,-30108.35 4613.75,-30108.35"/>
</g>
<!-- layer22_moe_comm_to_expert9&#45;&gt;layer22_moe_expert9 -->
<g id="edge1299" class="edge">
<title>layer22_moe_comm_to_expert9&#45;&gt;layer22_moe_expert9</title>
<path fill="none" stroke="black" d="M4610.25,-30222.16C4610.25,-30222.16 4610.25,-30196.51 4610.25,-30196.51"/>
<polygon fill="black" stroke="black" points="4613.75,-30196.51 4610.25,-30186.51 4606.75,-30196.51 4613.75,-30196.51"/>
</g>
<!-- layer22_moe_expert10 -->
<g id="node1019" class="node">
<title>layer22_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5204,-30186.21 4866,-30186.21 4866,-30134.21 5204,-30134.21 5204,-30186.21"/>
<text text-anchor="middle" x="5035" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 10 L22</text>
<text text-anchor="middle" x="5035" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="5035" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="5035" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert10 -->
<g id="node1042" class="node">
<title>layer22_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4942" cy="-30069.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4942" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4942" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4942" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer22_moe_expert10&#45;&gt;layer22_moe_comm_from_expert10 -->
<g id="edge1332" class="edge">
<title>layer22_moe_expert10&#45;&gt;layer22_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4951.38,-30133.89C4951.38,-30133.89 4951.38,-30108.35 4951.38,-30108.35"/>
<polygon fill="black" stroke="black" points="4954.88,-30108.35 4951.38,-30098.35 4947.88,-30108.35 4954.88,-30108.35"/>
</g>
<!-- layer22_moe_comm_to_expert10&#45;&gt;layer22_moe_expert10 -->
<g id="edge1301" class="edge">
<title>layer22_moe_comm_to_expert10&#45;&gt;layer22_moe_expert10</title>
<path fill="none" stroke="black" d="M4951.02,-30222.16C4951.02,-30222.16 4951.02,-30196.51 4951.02,-30196.51"/>
<polygon fill="black" stroke="black" points="4954.52,-30196.51 4951.02,-30186.51 4947.52,-30196.51 4954.52,-30196.51"/>
</g>
<!-- layer22_moe_expert11 -->
<g id="node1021" class="node">
<title>layer22_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5560,-30186.21 5222,-30186.21 5222,-30134.21 5560,-30134.21 5560,-30186.21"/>
<text text-anchor="middle" x="5391" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 11 L22</text>
<text text-anchor="middle" x="5391" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5391" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5391" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert11 -->
<g id="node1043" class="node">
<title>layer22_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5289" cy="-30069.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5289" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5289" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5289" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer22_moe_expert11&#45;&gt;layer22_moe_comm_from_expert11 -->
<g id="edge1334" class="edge">
<title>layer22_moe_expert11&#45;&gt;layer22_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5302.88,-30133.89C5302.88,-30133.89 5302.88,-30108.03 5302.88,-30108.03"/>
<polygon fill="black" stroke="black" points="5306.38,-30108.03 5302.88,-30098.03 5299.38,-30108.03 5306.38,-30108.03"/>
</g>
<!-- layer22_moe_comm_to_expert11&#45;&gt;layer22_moe_expert11 -->
<g id="edge1303" class="edge">
<title>layer22_moe_comm_to_expert11&#45;&gt;layer22_moe_expert11</title>
<path fill="none" stroke="black" d="M5302.02,-30222.41C5302.02,-30222.41 5302.02,-30196.35 5302.02,-30196.35"/>
<polygon fill="black" stroke="black" points="5305.52,-30196.35 5302.02,-30186.35 5298.52,-30196.35 5305.52,-30196.35"/>
</g>
<!-- layer22_moe_expert12 -->
<g id="node1023" class="node">
<title>layer22_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5916,-30186.21 5578,-30186.21 5578,-30134.21 5916,-30134.21 5916,-30186.21"/>
<text text-anchor="middle" x="5747" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 12 L22</text>
<text text-anchor="middle" x="5747" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5747" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5747" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert12 -->
<g id="node1044" class="node">
<title>layer22_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5640" cy="-30069.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5640" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5640" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5640" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer22_moe_expert12&#45;&gt;layer22_moe_comm_from_expert12 -->
<g id="edge1336" class="edge">
<title>layer22_moe_expert12&#45;&gt;layer22_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5656.38,-30133.89C5656.38,-30133.89 5656.38,-30108.03 5656.38,-30108.03"/>
<polygon fill="black" stroke="black" points="5659.88,-30108.03 5656.38,-30098.03 5652.88,-30108.03 5659.88,-30108.03"/>
</g>
<!-- layer22_moe_comm_to_expert12&#45;&gt;layer22_moe_expert12 -->
<g id="edge1305" class="edge">
<title>layer22_moe_comm_to_expert12&#45;&gt;layer22_moe_expert12</title>
<path fill="none" stroke="black" d="M5655.52,-30222.41C5655.52,-30222.41 5655.52,-30196.35 5655.52,-30196.35"/>
<polygon fill="black" stroke="black" points="5659.02,-30196.35 5655.52,-30186.35 5652.02,-30196.35 5659.02,-30196.35"/>
</g>
<!-- layer22_moe_expert13 -->
<g id="node1025" class="node">
<title>layer22_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6272,-30186.21 5934,-30186.21 5934,-30134.21 6272,-30134.21 6272,-30186.21"/>
<text text-anchor="middle" x="6103" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 13 L22</text>
<text text-anchor="middle" x="6103" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6103" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6103" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert13 -->
<g id="node1045" class="node">
<title>layer22_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5994" cy="-30069.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5994" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5994" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5994" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer22_moe_expert13&#45;&gt;layer22_moe_comm_from_expert13 -->
<g id="edge1338" class="edge">
<title>layer22_moe_expert13&#45;&gt;layer22_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M6011.38,-30133.89C6011.38,-30133.89 6011.38,-30108.03 6011.38,-30108.03"/>
<polygon fill="black" stroke="black" points="6014.88,-30108.03 6011.38,-30098.03 6007.88,-30108.03 6014.88,-30108.03"/>
</g>
<!-- layer22_moe_comm_to_expert13&#45;&gt;layer22_moe_expert13 -->
<g id="edge1307" class="edge">
<title>layer22_moe_comm_to_expert13&#45;&gt;layer22_moe_expert13</title>
<path fill="none" stroke="black" d="M6010.02,-30222.41C6010.02,-30222.41 6010.02,-30196.35 6010.02,-30196.35"/>
<polygon fill="black" stroke="black" points="6013.52,-30196.35 6010.02,-30186.35 6006.52,-30196.35 6013.52,-30196.35"/>
</g>
<!-- layer22_moe_expert14 -->
<g id="node1027" class="node">
<title>layer22_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6628,-30186.21 6290,-30186.21 6290,-30134.21 6628,-30134.21 6628,-30186.21"/>
<text text-anchor="middle" x="6459" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 14 L22</text>
<text text-anchor="middle" x="6459" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6459" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6459" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert14 -->
<g id="node1046" class="node">
<title>layer22_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6349" cy="-30069.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6349" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6349" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6349" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer22_moe_expert14&#45;&gt;layer22_moe_comm_from_expert14 -->
<g id="edge1340" class="edge">
<title>layer22_moe_expert14&#45;&gt;layer22_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6366.88,-30133.89C6366.88,-30133.89 6366.88,-30107.71 6366.88,-30107.71"/>
<polygon fill="black" stroke="black" points="6370.38,-30107.71 6366.88,-30097.71 6363.38,-30107.71 6370.38,-30107.71"/>
</g>
<!-- layer22_moe_comm_to_expert14&#45;&gt;layer22_moe_expert14 -->
<g id="edge1309" class="edge">
<title>layer22_moe_comm_to_expert14&#45;&gt;layer22_moe_expert14</title>
<path fill="none" stroke="black" d="M6365.52,-30222.41C6365.52,-30222.41 6365.52,-30196.35 6365.52,-30196.35"/>
<polygon fill="black" stroke="black" points="6369.02,-30196.35 6365.52,-30186.35 6362.02,-30196.35 6369.02,-30196.35"/>
</g>
<!-- layer22_moe_expert15 -->
<g id="node1029" class="node">
<title>layer22_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6984,-30186.21 6646,-30186.21 6646,-30134.21 6984,-30134.21 6984,-30186.21"/>
<text text-anchor="middle" x="6815" y="-30174.21" font-family="Arial" font-size="10.00">EXPERT 15 L22</text>
<text text-anchor="middle" x="6815" y="-30163.21" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6815" y="-30152.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6815" y="-30141.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_comm_from_expert15 -->
<g id="node1047" class="node">
<title>layer22_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6704" cy="-30069.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6704" y="-30077.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6704" y="-30066.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6704" y="-30055.72" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer22_moe_expert15&#45;&gt;layer22_moe_comm_from_expert15 -->
<g id="edge1342" class="edge">
<title>layer22_moe_expert15&#45;&gt;layer22_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6722.38,-30133.89C6722.38,-30133.89 6722.38,-30107.71 6722.38,-30107.71"/>
<polygon fill="black" stroke="black" points="6725.88,-30107.71 6722.38,-30097.71 6718.88,-30107.71 6725.88,-30107.71"/>
</g>
<!-- layer22_moe_comm_to_expert15&#45;&gt;layer22_moe_expert15 -->
<g id="edge1311" class="edge">
<title>layer22_moe_comm_to_expert15&#45;&gt;layer22_moe_expert15</title>
<path fill="none" stroke="black" d="M6721.02,-30222.41C6721.02,-30222.41 6721.02,-30196.35 6721.02,-30196.35"/>
<polygon fill="black" stroke="black" points="6724.52,-30196.35 6721.02,-30186.35 6717.52,-30196.35 6724.52,-30196.35"/>
</g>
<!-- layer22_moe_aggregate -->
<g id="node1031" class="node">
<title>layer22_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4390.1,-30004.23 3973.16,-30004.23 3865.9,-29900.23 4282.84,-29900.23 4390.1,-30004.23"/>
<text text-anchor="middle" x="4128" y="-29966.23" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L22</text>
<text text-anchor="middle" x="4128" y="-29955.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4128" y="-29944.23" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4128" y="-29933.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_mha -->
<g id="node1048" class="node">
<title>layer23_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4258,-29864.23 3998,-29864.23 3998,-29812.23 4258,-29812.23 4258,-29864.23"/>
<text text-anchor="middle" x="4128" y="-29852.23" font-family="Arial" font-size="10.00">MHA L23</text>
<text text-anchor="middle" x="4128" y="-29841.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4128" y="-29830.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4128" y="-29819.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer22_moe_aggregate&#45;&gt;layer23_moe_mha -->
<g id="edge1411" class="edge">
<title>layer22_moe_aggregate&#45;&gt;layer23_moe_mha</title>
<path fill="none" stroke="black" d="M4128,-29899.9C4128,-29899.9 4128,-29874.46 4128,-29874.46"/>
<polygon fill="black" stroke="black" points="4131.5,-29874.46 4128,-29864.46 4124.5,-29874.46 4131.5,-29874.46"/>
</g>
<!-- layer22_moe_comm_from_expert0&#45;&gt;layer22_moe_aggregate -->
<g id="edge1313" class="edge">
<title>layer22_moe_comm_from_expert0&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M1701.75,-30059.57C1701.75,-30025.81 1701.75,-29915 1701.75,-29915 1701.75,-29915 3870.88,-29915 3870.88,-29915"/>
<polygon fill="black" stroke="black" points="3870.88,-29918.5 3880.88,-29915 3870.88,-29911.5 3870.88,-29918.5"/>
</g>
<!-- layer22_moe_comm_from_expert1&#45;&gt;layer22_moe_aggregate -->
<g id="edge1315" class="edge">
<title>layer22_moe_comm_from_expert1&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M2413.25,-30058.22C2413.25,-30025.16 2413.25,-29929 2413.25,-29929 2413.25,-29929 3885.4,-29929 3885.4,-29929"/>
<polygon fill="black" stroke="black" points="3885.4,-29932.5 3895.4,-29929 3885.4,-29925.5 3885.4,-29932.5"/>
</g>
<!-- layer22_moe_comm_from_expert2&#45;&gt;layer22_moe_aggregate -->
<g id="edge1317" class="edge">
<title>layer22_moe_comm_from_expert2&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M2857.01,-30051.54C2857.01,-30017.03 2857.01,-29944 2857.01,-29944 2857.01,-29944 3900.95,-29944 3900.95,-29944"/>
<polygon fill="black" stroke="black" points="3900.95,-29947.5 3910.95,-29944 3900.95,-29940.5 3900.95,-29947.5"/>
</g>
<!-- layer22_moe_comm_from_expert3&#45;&gt;layer22_moe_aggregate -->
<g id="edge1319" class="edge">
<title>layer22_moe_comm_from_expert3&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M3185.01,-30051.51C3185.01,-30020.35 3185.01,-29959 3185.01,-29959 3185.01,-29959 3916.28,-29959 3916.28,-29959"/>
<polygon fill="black" stroke="black" points="3916.28,-29962.5 3926.28,-29959 3916.28,-29955.5 3916.28,-29962.5"/>
</g>
<!-- layer22_moe_comm_from_expert4&#45;&gt;layer22_moe_aggregate -->
<g id="edge1321" class="edge">
<title>layer22_moe_comm_from_expert4&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M3455.75,-30055.17C3455.75,-30028.68 3455.75,-29974 3455.75,-29974 3455.75,-29974 3931.63,-29974 3931.63,-29974"/>
<polygon fill="black" stroke="black" points="3931.64,-29977.5 3941.63,-29974 3931.63,-29970.5 3931.64,-29977.5"/>
</g>
<!-- layer22_moe_comm_from_expert5&#45;&gt;layer22_moe_aggregate -->
<g id="edge1323" class="edge">
<title>layer22_moe_comm_from_expert5&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M3677.5,-30051.02C3677.5,-30027.35 3677.5,-29989 3677.5,-29989 3677.5,-29989 3947.36,-29989 3947.36,-29989"/>
<polygon fill="black" stroke="black" points="3947.36,-29992.5 3957.36,-29989 3947.36,-29985.5 3947.36,-29992.5"/>
</g>
<!-- layer22_moe_comm_from_expert6&#45;&gt;layer22_moe_aggregate -->
<g id="edge1325" class="edge">
<title>layer22_moe_comm_from_expert6&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M3889.11,-30049.64C3889.11,-30049.64 3889.11,-29962.28 3889.11,-29962.28"/>
<polygon fill="black" stroke="black" points="3892.61,-29962.28 3889.11,-29952.28 3885.61,-29962.28 3892.61,-29962.28"/>
</g>
<!-- layer22_moe_comm_from_expert7&#45;&gt;layer22_moe_aggregate -->
<g id="edge1327" class="edge">
<title>layer22_moe_comm_from_expert7&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M4029,-30040C4029,-30040 4029,-30014.29 4029,-30014.29"/>
<polygon fill="black" stroke="black" points="4032.5,-30014.29 4029,-30004.29 4025.5,-30014.29 4032.5,-30014.29"/>
</g>
<!-- layer22_moe_comm_from_expert8&#45;&gt;layer22_moe_aggregate -->
<g id="edge1329" class="edge">
<title>layer22_moe_comm_from_expert8&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M4300.39,-30040C4300.39,-30040 4300.39,-30014.29 4300.39,-30014.29"/>
<polygon fill="black" stroke="black" points="4303.89,-30014.29 4300.39,-30004.29 4296.89,-30014.29 4303.89,-30014.29"/>
</g>
<!-- layer22_moe_comm_from_expert9&#45;&gt;layer22_moe_aggregate -->
<g id="edge1331" class="edge">
<title>layer22_moe_comm_from_expert9&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M4591.5,-30040.54C4591.5,-30018.21 4591.5,-29991 4591.5,-29991 4591.5,-29991 4386.71,-29991 4386.71,-29991"/>
<polygon fill="black" stroke="black" points="4386.71,-29987.5 4376.71,-29991 4386.71,-29994.5 4386.71,-29987.5"/>
</g>
<!-- layer22_moe_comm_from_expert10&#45;&gt;layer22_moe_aggregate -->
<g id="edge1333" class="edge">
<title>layer22_moe_comm_from_expert10&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M4923.15,-30040.36C4923.15,-30013.63 4923.15,-29978 4923.15,-29978 4923.15,-29978 4373.07,-29978 4373.07,-29978"/>
<polygon fill="black" stroke="black" points="4373.07,-29974.5 4363.07,-29978 4373.07,-29981.5 4373.07,-29974.5"/>
</g>
<!-- layer22_moe_comm_from_expert11&#45;&gt;layer22_moe_aggregate -->
<g id="edge1335" class="edge">
<title>layer22_moe_comm_from_expert11&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M5269.65,-30040.74C5269.65,-30009.88 5269.65,-29965 5269.65,-29965 5269.65,-29965 4359.81,-29965 4359.81,-29965"/>
<polygon fill="black" stroke="black" points="4359.81,-29961.5 4349.81,-29965 4359.81,-29968.5 4359.81,-29961.5"/>
</g>
<!-- layer22_moe_comm_from_expert12&#45;&gt;layer22_moe_aggregate -->
<g id="edge1337" class="edge">
<title>layer22_moe_comm_from_expert12&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M5620.65,-30040.54C5620.65,-30005.84 5620.65,-29952 5620.65,-29952 5620.65,-29952 4346.33,-29952 4346.33,-29952"/>
<polygon fill="black" stroke="black" points="4346.33,-29948.5 4336.33,-29952 4346.33,-29955.5 4346.33,-29948.5"/>
</g>
<!-- layer22_moe_comm_from_expert13&#45;&gt;layer22_moe_aggregate -->
<g id="edge1339" class="edge">
<title>layer22_moe_comm_from_expert13&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M5974.15,-30040.64C5974.15,-30002.31 5974.15,-29939 5974.15,-29939 5974.15,-29939 4332.95,-29939 4332.95,-29939"/>
<polygon fill="black" stroke="black" points="4332.95,-29935.5 4322.95,-29939 4332.95,-29942.5 4332.95,-29935.5"/>
</g>
<!-- layer22_moe_comm_from_expert14&#45;&gt;layer22_moe_aggregate -->
<g id="edge1341" class="edge">
<title>layer22_moe_comm_from_expert14&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M6329.15,-30040.58C6329.15,-29998.79 6329.15,-29926 6329.15,-29926 6329.15,-29926 4319.53,-29926 4319.53,-29926"/>
<polygon fill="black" stroke="black" points="4319.53,-29922.5 4309.53,-29926 4319.53,-29929.5 4319.53,-29922.5"/>
</g>
<!-- layer22_moe_comm_from_expert15&#45;&gt;layer22_moe_aggregate -->
<g id="edge1343" class="edge">
<title>layer22_moe_comm_from_expert15&#45;&gt;layer22_moe_aggregate</title>
<path fill="none" stroke="black" d="M6684.15,-30040.57C6684.15,-29995.47 6684.15,-29913 6684.15,-29913 6684.15,-29913 4306.21,-29913 4306.21,-29913"/>
<polygon fill="black" stroke="black" points="4306.21,-29909.5 4296.21,-29913 4306.21,-29916.5 4306.21,-29909.5"/>
</g>
<!-- layer23_moe_gate -->
<g id="node1049" class="node">
<title>layer23_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4386.3,-29776.23 3975.4,-29776.23 3869.7,-29672.23 4280.6,-29672.23 4386.3,-29776.23"/>
<text text-anchor="middle" x="4128" y="-29738.23" font-family="Arial" font-size="10.00">GATE L23</text>
<text text-anchor="middle" x="4128" y="-29727.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4128" y="-29716.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4128" y="-29705.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer23_moe_mha&#45;&gt;layer23_moe_gate -->
<g id="edge1412" class="edge">
<title>layer23_moe_mha&#45;&gt;layer23_moe_gate</title>
<path fill="none" stroke="black" d="M4128,-29812.07C4128,-29812.07 4128,-29786.33 4128,-29786.33"/>
<polygon fill="black" stroke="black" points="4131.5,-29786.33 4128,-29776.33 4124.5,-29786.33 4131.5,-29786.33"/>
</g>
<!-- layer23_moe_split -->
<g id="node1050" class="node">
<title>layer23_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4382.01,-29636.23 3977.94,-29636.23 3873.99,-29532.23 4278.06,-29532.23 4382.01,-29636.23"/>
<text text-anchor="middle" x="4128" y="-29598.23" font-family="Arial" font-size="10.00">SPLIT TOKENS L23</text>
<text text-anchor="middle" x="4128" y="-29587.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4128" y="-29576.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4128" y="-29565.23" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer23_moe_gate&#45;&gt;layer23_moe_split -->
<g id="edge1413" class="edge">
<title>layer23_moe_gate&#45;&gt;layer23_moe_split</title>
<path fill="none" stroke="black" d="M4128,-29672.1C4128,-29672.1 4128,-29646.4 4128,-29646.4"/>
<polygon fill="black" stroke="black" points="4131.5,-29646.4 4128,-29636.4 4124.5,-29646.4 4131.5,-29646.4"/>
</g>
<!-- layer23_moe_comm_to_expert0 -->
<g id="node1052" class="node">
<title>layer23_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2047" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2047" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2047" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2047" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert0 -->
<g id="edge1347" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3962.64,-29621C3481.77,-29621 2117.75,-29621 2117.75,-29621 2117.75,-29621 2117.75,-29495.48 2117.75,-29495.48"/>
<polygon fill="black" stroke="black" points="2121.25,-29495.48 2117.75,-29485.48 2114.25,-29495.48 2121.25,-29495.48"/>
</g>
<!-- layer23_moe_comm_to_expert1 -->
<g id="node1054" class="node">
<title>layer23_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2292" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2292" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2292" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2292" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert1 -->
<g id="edge1349" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3947.5,-29606C3488.09,-29606 2310.5,-29606 2310.5,-29606 2310.5,-29606 2310.5,-29505.65 2310.5,-29505.65"/>
<polygon fill="black" stroke="black" points="2314,-29505.65 2310.5,-29495.65 2307,-29505.65 2314,-29505.65"/>
</g>
<!-- layer23_moe_comm_to_expert2 -->
<g id="node1056" class="node">
<title>layer23_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2748" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2748" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2748" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2748" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert2 -->
<g id="edge1351" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3932.57,-29591C3555.96,-29591 2766.5,-29591 2766.5,-29591 2766.5,-29591 2766.5,-29505.63 2766.5,-29505.63"/>
<polygon fill="black" stroke="black" points="2770,-29505.63 2766.5,-29495.63 2763,-29505.63 2770,-29505.63"/>
</g>
<!-- layer23_moe_comm_to_expert3 -->
<g id="node1058" class="node">
<title>layer23_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3076" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3076" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3076" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3076" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert3 -->
<g id="edge1353" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3917.61,-29576C3615.43,-29576 3094.5,-29576 3094.5,-29576 3094.5,-29576 3094.5,-29505.81 3094.5,-29505.81"/>
<polygon fill="black" stroke="black" points="3098,-29505.81 3094.5,-29495.81 3091,-29505.81 3098,-29505.81"/>
</g>
<!-- layer23_moe_comm_to_expert4 -->
<g id="node1060" class="node">
<title>layer23_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3339" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3339" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3339" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3339" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert4 -->
<g id="edge1355" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3902.55,-29561C3675.16,-29561 3357.5,-29561 3357.5,-29561 3357.5,-29561 3357.5,-29505.62 3357.5,-29505.62"/>
<polygon fill="black" stroke="black" points="3361,-29505.62 3357.5,-29495.62 3354,-29505.62 3361,-29505.62"/>
</g>
<!-- layer23_moe_comm_to_expert5 -->
<g id="node1062" class="node">
<title>layer23_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3570" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3570" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3570" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3570" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert5 -->
<g id="edge1357" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3888.62,-29547C3744.42,-29547 3588.5,-29547 3588.5,-29547 3588.5,-29547 3588.5,-29506.03 3588.5,-29506.03"/>
<polygon fill="black" stroke="black" points="3592,-29506.03 3588.5,-29496.03 3585,-29506.03 3592,-29506.03"/>
</g>
<!-- layer23_moe_comm_to_expert6 -->
<g id="node1064" class="node">
<title>layer23_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3785" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3785" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3785" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3785" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert6 -->
<g id="edge1359" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3888.5,-29584.14C3888.5,-29580.59 3888.5,-29467 3888.5,-29467 3888.5,-29467 3885.81,-29467 3885.81,-29467"/>
<polygon fill="black" stroke="black" points="3885.81,-29463.5 3875.81,-29467 3885.81,-29470.5 3885.81,-29463.5"/>
</g>
<!-- layer23_moe_comm_to_expert7 -->
<g id="node1066" class="node">
<title>layer23_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3992" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3992" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3992" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3992" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert7 -->
<g id="edge1361" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3992,-29531.89C3992,-29531.89 3992,-29506.45 3992,-29506.45"/>
<polygon fill="black" stroke="black" points="3995.5,-29506.45 3992,-29496.45 3988.5,-29506.45 3995.5,-29506.45"/>
</g>
<!-- layer23_moe_comm_to_expert8 -->
<g id="node1068" class="node">
<title>layer23_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4264" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4264" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4264" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4264" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert8 -->
<g id="edge1363" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4264,-29531.89C4264,-29531.89 4264,-29506.45 4264,-29506.45"/>
<polygon fill="black" stroke="black" points="4267.5,-29506.45 4264,-29496.45 4260.5,-29506.45 4267.5,-29506.45"/>
</g>
<!-- layer23_moe_comm_to_expert9 -->
<g id="node1070" class="node">
<title>layer23_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4573" cy="-29467.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4573" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4573" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4573" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert9 -->
<g id="edge1365" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4368.26,-29584.14C4368.26,-29580.59 4368.26,-29467 4368.26,-29467 4368.26,-29467 4472.3,-29467 4472.3,-29467"/>
<polygon fill="black" stroke="black" points="4472.3,-29470.5 4482.3,-29467 4472.3,-29463.5 4472.3,-29470.5"/>
</g>
<!-- layer23_moe_comm_to_expert10 -->
<g id="node1072" class="node">
<title>layer23_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4905" cy="-29467.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4905" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4905" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4905" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert10 -->
<g id="edge1367" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4293.26,-29547C4500.54,-29547 4829.1,-29547 4829.1,-29547 4829.1,-29547 4829.1,-29494.54 4829.1,-29494.54"/>
<polygon fill="black" stroke="black" points="4832.6,-29494.54 4829.1,-29484.54 4825.6,-29494.54 4832.6,-29494.54"/>
</g>
<!-- layer23_moe_comm_to_expert11 -->
<g id="node1074" class="node">
<title>layer23_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5251" cy="-29467.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5251" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5251" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5251" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert11 -->
<g id="edge1369" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4306.9,-29561C4606.11,-29561 5175.6,-29561 5175.6,-29561 5175.6,-29561 5175.6,-29494.87 5175.6,-29494.87"/>
<polygon fill="black" stroke="black" points="5179.1,-29494.87 5175.6,-29484.87 5172.1,-29494.87 5179.1,-29494.87"/>
</g>
<!-- layer23_moe_comm_to_expert12 -->
<g id="node1076" class="node">
<title>layer23_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5602" cy="-29467.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5602" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5602" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5602" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert12 -->
<g id="edge1371" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4322.1,-29576C4706.24,-29576 5526.6,-29576 5526.6,-29576 5526.6,-29576 5526.6,-29494.71 5526.6,-29494.71"/>
<polygon fill="black" stroke="black" points="5530.1,-29494.71 5526.6,-29484.71 5523.1,-29494.71 5530.1,-29494.71"/>
</g>
<!-- layer23_moe_comm_to_expert13 -->
<g id="node1078" class="node">
<title>layer23_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5955" cy="-29467.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5955" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5955" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5955" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert13 -->
<g id="edge1373" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4337.17,-29591C4802,-29591 5880.1,-29591 5880.1,-29591 5880.1,-29591 5880.1,-29494.97 5880.1,-29494.97"/>
<polygon fill="black" stroke="black" points="5883.6,-29494.97 5880.1,-29484.97 5876.6,-29494.97 5883.6,-29494.97"/>
</g>
<!-- layer23_moe_comm_to_expert14 -->
<g id="node1080" class="node">
<title>layer23_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6310" cy="-29467.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6310" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6310" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6310" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert14 -->
<g id="edge1375" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352,-29606C4894.61,-29606 6235.1,-29606 6235.1,-29606 6235.1,-29606 6235.1,-29494.81 6235.1,-29494.81"/>
<polygon fill="black" stroke="black" points="6238.6,-29494.81 6235.1,-29484.81 6231.6,-29494.81 6238.6,-29494.81"/>
</g>
<!-- layer23_moe_comm_to_expert15 -->
<g id="node1082" class="node">
<title>layer23_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6665" cy="-29467.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6665" y="-29475.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6665" y="-29464.74" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6665" y="-29453.74" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert15 -->
<g id="edge1377" class="edge">
<title>layer23_moe_split&#45;&gt;layer23_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4366.87,-29621C4985.18,-29621 6590.1,-29621 6590.1,-29621 6590.1,-29621 6590.1,-29494.88 6590.1,-29494.88"/>
<polygon fill="black" stroke="black" points="6593.6,-29494.88 6590.1,-29484.88 6586.6,-29494.88 6593.6,-29494.88"/>
</g>
<!-- layer23_moe_expert0 -->
<g id="node1051" class="node">
<title>layer23_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1697,-29402.25 1369,-29402.25 1369,-29350.25 1697,-29350.25 1697,-29402.25"/>
<text text-anchor="middle" x="1533" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 0 L23</text>
<text text-anchor="middle" x="1533" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1533" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1533" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert0 -->
<g id="node1084" class="node">
<title>layer23_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1680" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1680" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1680" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1680" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer23_moe_expert0&#45;&gt;layer23_moe_comm_from_expert0 -->
<g id="edge1379" class="edge">
<title>layer23_moe_expert0&#45;&gt;layer23_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1643.25,-29349.93C1643.25,-29349.93 1643.25,-29321.83 1643.25,-29321.83"/>
<polygon fill="black" stroke="black" points="1646.75,-29321.83 1643.25,-29311.83 1639.75,-29321.83 1646.75,-29321.83"/>
</g>
<!-- layer23_moe_comm_to_expert0&#45;&gt;layer23_moe_expert0 -->
<g id="edge1348" class="edge">
<title>layer23_moe_comm_to_expert0&#45;&gt;layer23_moe_expert0</title>
<path fill="none" stroke="black" d="M1956.45,-29467C1828.78,-29467 1611.25,-29467 1611.25,-29467 1611.25,-29467 1611.25,-29412.5 1611.25,-29412.5"/>
<polygon fill="black" stroke="black" points="1614.75,-29412.5 1611.25,-29402.5 1607.75,-29412.5 1614.75,-29412.5"/>
</g>
<!-- layer23_moe_expert1 -->
<g id="node1053" class="node">
<title>layer23_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2043,-29402.25 1715,-29402.25 1715,-29350.25 2043,-29350.25 2043,-29402.25"/>
<text text-anchor="middle" x="1879" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 1 L23</text>
<text text-anchor="middle" x="1879" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1879" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1879" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert1 -->
<g id="node1085" class="node">
<title>layer23_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2173" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2173" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2173" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2173" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer23_moe_expert1&#45;&gt;layer23_moe_comm_from_expert1 -->
<g id="edge1381" class="edge">
<title>layer23_moe_expert1&#45;&gt;layer23_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1981.25,-29349.85C1981.25,-29322.91 1981.25,-29285 1981.25,-29285 1981.25,-29285 2072.46,-29285 2072.46,-29285"/>
<polygon fill="black" stroke="black" points="2072.46,-29288.5 2082.46,-29285 2072.46,-29281.5 2072.46,-29288.5"/>
</g>
<!-- layer23_moe_comm_to_expert1&#45;&gt;layer23_moe_expert1 -->
<g id="edge1350" class="edge">
<title>layer23_moe_comm_to_expert1&#45;&gt;layer23_moe_expert1</title>
<path fill="none" stroke="black" d="M2292,-29438.13C2292,-29424.41 2292,-29411 2292,-29411 2292,-29411 1999.75,-29411 1999.75,-29411 1999.75,-29411 1999.75,-29410.16 1999.75,-29410.16"/>
<polygon fill="black" stroke="black" points="2003.25,-29412.59 1999.75,-29402.59 1996.25,-29412.59 2003.25,-29412.59"/>
</g>
<!-- layer23_moe_expert2 -->
<g id="node1055" class="node">
<title>layer23_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2389,-29402.25 2061,-29402.25 2061,-29350.25 2389,-29350.25 2389,-29402.25"/>
<text text-anchor="middle" x="2225" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 2 L23</text>
<text text-anchor="middle" x="2225" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2225" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2225" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert2 -->
<g id="node1086" class="node">
<title>layer23_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2519" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2519" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2519" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2519" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer23_moe_expert2&#45;&gt;layer23_moe_comm_from_expert2 -->
<g id="edge1383" class="edge">
<title>layer23_moe_expert2&#45;&gt;layer23_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2379.5,-29349.85C2379.5,-29322.91 2379.5,-29285 2379.5,-29285 2379.5,-29285 2418.29,-29285 2418.29,-29285"/>
<polygon fill="black" stroke="black" points="2418.29,-29288.5 2428.29,-29285 2418.29,-29281.5 2418.29,-29288.5"/>
</g>
<!-- layer23_moe_comm_to_expert2&#45;&gt;layer23_moe_expert2 -->
<g id="edge1352" class="edge">
<title>layer23_moe_comm_to_expert2&#45;&gt;layer23_moe_expert2</title>
<path fill="none" stroke="black" d="M2657.41,-29467C2553.71,-29467 2398,-29467 2398,-29467 2398,-29467 2398,-29376 2398,-29376 2398,-29376 2397.12,-29376 2397.12,-29376"/>
<polygon fill="black" stroke="black" points="2399.18,-29372.5 2389.18,-29376 2399.18,-29379.5 2399.18,-29372.5"/>
</g>
<!-- layer23_moe_expert3 -->
<g id="node1057" class="node">
<title>layer23_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2735,-29402.25 2407,-29402.25 2407,-29350.25 2735,-29350.25 2735,-29402.25"/>
<text text-anchor="middle" x="2571" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 3 L23</text>
<text text-anchor="middle" x="2571" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2571" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2571" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert3 -->
<g id="node1087" class="node">
<title>layer23_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2791" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2791" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2791" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2791" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer23_moe_expert3&#45;&gt;layer23_moe_comm_from_expert3 -->
<g id="edge1385" class="edge">
<title>layer23_moe_expert3&#45;&gt;layer23_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2717.75,-29349.93C2717.75,-29349.93 2717.75,-29312.33 2717.75,-29312.33"/>
<polygon fill="black" stroke="black" points="2721.25,-29312.33 2717.75,-29302.33 2714.25,-29312.33 2721.25,-29312.33"/>
</g>
<!-- layer23_moe_comm_to_expert3&#45;&gt;layer23_moe_expert3 -->
<g id="edge1354" class="edge">
<title>layer23_moe_comm_to_expert3&#45;&gt;layer23_moe_expert3</title>
<path fill="none" stroke="black" d="M3017.33,-29444.99C3017.33,-29436.58 3017.33,-29429 3017.33,-29429 3017.33,-29429 2696.25,-29429 2696.25,-29429 2696.25,-29429 2696.25,-29412.31 2696.25,-29412.31"/>
<polygon fill="black" stroke="black" points="2699.75,-29412.31 2696.25,-29402.31 2692.75,-29412.31 2699.75,-29412.31"/>
</g>
<!-- layer23_moe_expert4 -->
<g id="node1059" class="node">
<title>layer23_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3081,-29402.25 2753,-29402.25 2753,-29350.25 3081,-29350.25 3081,-29402.25"/>
<text text-anchor="middle" x="2917" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 4 L23</text>
<text text-anchor="middle" x="2917" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2917" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2917" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert4 -->
<g id="node1088" class="node">
<title>layer23_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3027" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3027" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3027" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3027" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer23_moe_expert4&#45;&gt;layer23_moe_comm_from_expert4 -->
<g id="edge1387" class="edge">
<title>layer23_moe_expert4&#45;&gt;layer23_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3008.75,-29349.93C3008.75,-29349.93 3008.75,-29323.74 3008.75,-29323.74"/>
<polygon fill="black" stroke="black" points="3012.25,-29323.74 3008.75,-29313.74 3005.25,-29323.74 3012.25,-29323.74"/>
</g>
<!-- layer23_moe_comm_to_expert4&#45;&gt;layer23_moe_expert4 -->
<g id="edge1356" class="edge">
<title>layer23_moe_comm_to_expert4&#45;&gt;layer23_moe_expert4</title>
<path fill="none" stroke="black" d="M3337.75,-29438.13C3337.75,-29428.41 3337.75,-29420 3337.75,-29420 3337.75,-29420 3049.16,-29420 3049.16,-29420 3049.16,-29420 3049.16,-29412.46 3049.16,-29412.46"/>
<polygon fill="black" stroke="black" points="3052.66,-29412.46 3049.16,-29402.46 3045.66,-29412.46 3052.66,-29412.46"/>
</g>
<!-- layer23_moe_expert5 -->
<g id="node1061" class="node">
<title>layer23_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3427,-29402.25 3099,-29402.25 3099,-29350.25 3427,-29350.25 3427,-29402.25"/>
<text text-anchor="middle" x="3263" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 5 L23</text>
<text text-anchor="middle" x="3263" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3263" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3263" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert5 -->
<g id="node1089" class="node">
<title>layer23_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3374" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3374" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3374" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3374" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer23_moe_expert5&#45;&gt;layer23_moe_comm_from_expert5 -->
<g id="edge1389" class="edge">
<title>layer23_moe_expert5&#45;&gt;layer23_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3355.25,-29349.93C3355.25,-29349.93 3355.25,-29323.74 3355.25,-29323.74"/>
<polygon fill="black" stroke="black" points="3358.75,-29323.74 3355.25,-29313.74 3351.75,-29323.74 3358.75,-29323.74"/>
</g>
<!-- layer23_moe_comm_to_expert5&#45;&gt;layer23_moe_expert5 -->
<g id="edge1358" class="edge">
<title>layer23_moe_comm_to_expert5&#45;&gt;layer23_moe_expert5</title>
<path fill="none" stroke="black" d="M3479.26,-29467C3455.92,-29467 3437.25,-29467 3437.25,-29467 3437.25,-29467 3437.25,-29376 3437.25,-29376 3437.25,-29376 3436.24,-29376 3436.24,-29376"/>
<polygon fill="black" stroke="black" points="3437.13,-29372.5 3427.13,-29376 3437.13,-29379.5 3437.13,-29372.5"/>
</g>
<!-- layer23_moe_expert6 -->
<g id="node1063" class="node">
<title>layer23_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3773,-29402.25 3445,-29402.25 3445,-29350.25 3773,-29350.25 3773,-29402.25"/>
<text text-anchor="middle" x="3609" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 6 L23</text>
<text text-anchor="middle" x="3609" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3609" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3609" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert6 -->
<g id="node1090" class="node">
<title>layer23_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3720" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3720" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3720" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3720" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer23_moe_expert6&#45;&gt;layer23_moe_comm_from_expert6 -->
<g id="edge1391" class="edge">
<title>layer23_moe_expert6&#45;&gt;layer23_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3701.25,-29349.93C3701.25,-29349.93 3701.25,-29323.74 3701.25,-29323.74"/>
<polygon fill="black" stroke="black" points="3704.75,-29323.74 3701.25,-29313.74 3697.75,-29323.74 3704.75,-29323.74"/>
</g>
<!-- layer23_moe_comm_to_expert6&#45;&gt;layer23_moe_expert6 -->
<g id="edge1360" class="edge">
<title>layer23_moe_comm_to_expert6&#45;&gt;layer23_moe_expert6</title>
<path fill="none" stroke="black" d="M3733.75,-29443.33C3733.75,-29443.33 3733.75,-29412.55 3733.75,-29412.55"/>
<polygon fill="black" stroke="black" points="3737.25,-29412.55 3733.75,-29402.55 3730.25,-29412.55 3737.25,-29412.55"/>
</g>
<!-- layer23_moe_expert7 -->
<g id="node1065" class="node">
<title>layer23_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4119,-29402.25 3791,-29402.25 3791,-29350.25 4119,-29350.25 4119,-29402.25"/>
<text text-anchor="middle" x="3955" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 7 L23</text>
<text text-anchor="middle" x="3955" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3955" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3955" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert7 -->
<g id="node1091" class="node">
<title>layer23_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3992" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3992" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3992" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3992" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer23_moe_expert7&#45;&gt;layer23_moe_comm_from_expert7 -->
<g id="edge1393" class="edge">
<title>layer23_moe_expert7&#45;&gt;layer23_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3992,-29349.93C3992,-29349.93 3992,-29324.38 3992,-29324.38"/>
<polygon fill="black" stroke="black" points="3995.5,-29324.38 3992,-29314.38 3988.5,-29324.38 3995.5,-29324.38"/>
</g>
<!-- layer23_moe_comm_to_expert7&#45;&gt;layer23_moe_expert7 -->
<g id="edge1362" class="edge">
<title>layer23_moe_comm_to_expert7&#45;&gt;layer23_moe_expert7</title>
<path fill="none" stroke="black" d="M3992,-29438.2C3992,-29438.2 3992,-29412.55 3992,-29412.55"/>
<polygon fill="black" stroke="black" points="3995.5,-29412.55 3992,-29402.55 3988.5,-29412.55 3995.5,-29412.55"/>
</g>
<!-- layer23_moe_expert8 -->
<g id="node1067" class="node">
<title>layer23_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4465,-29402.25 4137,-29402.25 4137,-29350.25 4465,-29350.25 4465,-29402.25"/>
<text text-anchor="middle" x="4301" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 8 L23</text>
<text text-anchor="middle" x="4301" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4301" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4301" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert8 -->
<g id="node1092" class="node">
<title>layer23_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4264" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4264" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4264" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4264" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer23_moe_expert8&#45;&gt;layer23_moe_comm_from_expert8 -->
<g id="edge1395" class="edge">
<title>layer23_moe_expert8&#45;&gt;layer23_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4264,-29349.93C4264,-29349.93 4264,-29324.38 4264,-29324.38"/>
<polygon fill="black" stroke="black" points="4267.5,-29324.38 4264,-29314.38 4260.5,-29324.38 4267.5,-29324.38"/>
</g>
<!-- layer23_moe_comm_to_expert8&#45;&gt;layer23_moe_expert8 -->
<g id="edge1364" class="edge">
<title>layer23_moe_comm_to_expert8&#45;&gt;layer23_moe_expert8</title>
<path fill="none" stroke="black" d="M4264,-29438.2C4264,-29438.2 4264,-29412.55 4264,-29412.55"/>
<polygon fill="black" stroke="black" points="4267.5,-29412.55 4264,-29402.55 4260.5,-29412.55 4267.5,-29412.55"/>
</g>
<!-- layer23_moe_expert9 -->
<g id="node1069" class="node">
<title>layer23_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4811,-29402.25 4483,-29402.25 4483,-29350.25 4811,-29350.25 4811,-29402.25"/>
<text text-anchor="middle" x="4647" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 9 L23</text>
<text text-anchor="middle" x="4647" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4647" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4647" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert9 -->
<g id="node1093" class="node">
<title>layer23_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4573" cy="-29285.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4573" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4573" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4573" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer23_moe_expert9&#45;&gt;layer23_moe_comm_from_expert9 -->
<g id="edge1397" class="edge">
<title>layer23_moe_expert9&#45;&gt;layer23_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4573.25,-29349.93C4573.25,-29349.93 4573.25,-29324.38 4573.25,-29324.38"/>
<polygon fill="black" stroke="black" points="4576.75,-29324.38 4573.25,-29314.38 4569.75,-29324.38 4576.75,-29324.38"/>
</g>
<!-- layer23_moe_comm_to_expert9&#45;&gt;layer23_moe_expert9 -->
<g id="edge1366" class="edge">
<title>layer23_moe_comm_to_expert9&#45;&gt;layer23_moe_expert9</title>
<path fill="none" stroke="black" d="M4573.25,-29438.2C4573.25,-29438.2 4573.25,-29412.55 4573.25,-29412.55"/>
<polygon fill="black" stroke="black" points="4576.75,-29412.55 4573.25,-29402.55 4569.75,-29412.55 4576.75,-29412.55"/>
</g>
<!-- layer23_moe_expert10 -->
<g id="node1071" class="node">
<title>layer23_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5167,-29402.25 4829,-29402.25 4829,-29350.25 5167,-29350.25 5167,-29402.25"/>
<text text-anchor="middle" x="4998" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 10 L23</text>
<text text-anchor="middle" x="4998" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4998" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4998" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert10 -->
<g id="node1094" class="node">
<title>layer23_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4905" cy="-29285.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4905" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4905" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4905" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer23_moe_expert10&#45;&gt;layer23_moe_comm_from_expert10 -->
<g id="edge1399" class="edge">
<title>layer23_moe_expert10&#45;&gt;layer23_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4914.38,-29349.93C4914.38,-29349.93 4914.38,-29324.38 4914.38,-29324.38"/>
<polygon fill="black" stroke="black" points="4917.88,-29324.38 4914.38,-29314.38 4910.88,-29324.38 4917.88,-29324.38"/>
</g>
<!-- layer23_moe_comm_to_expert10&#45;&gt;layer23_moe_expert10 -->
<g id="edge1368" class="edge">
<title>layer23_moe_comm_to_expert10&#45;&gt;layer23_moe_expert10</title>
<path fill="none" stroke="black" d="M4914.02,-29438.2C4914.02,-29438.2 4914.02,-29412.55 4914.02,-29412.55"/>
<polygon fill="black" stroke="black" points="4917.52,-29412.55 4914.02,-29402.55 4910.52,-29412.55 4917.52,-29412.55"/>
</g>
<!-- layer23_moe_expert11 -->
<g id="node1073" class="node">
<title>layer23_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5523,-29402.25 5185,-29402.25 5185,-29350.25 5523,-29350.25 5523,-29402.25"/>
<text text-anchor="middle" x="5354" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 11 L23</text>
<text text-anchor="middle" x="5354" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5354" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5354" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert11 -->
<g id="node1095" class="node">
<title>layer23_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5252" cy="-29285.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5252" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5252" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5252" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer23_moe_expert11&#45;&gt;layer23_moe_comm_from_expert11 -->
<g id="edge1401" class="edge">
<title>layer23_moe_expert11&#45;&gt;layer23_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5265.88,-29349.93C5265.88,-29349.93 5265.88,-29324.06 5265.88,-29324.06"/>
<polygon fill="black" stroke="black" points="5269.38,-29324.06 5265.88,-29314.06 5262.38,-29324.06 5269.38,-29324.06"/>
</g>
<!-- layer23_moe_comm_to_expert11&#45;&gt;layer23_moe_expert11 -->
<g id="edge1370" class="edge">
<title>layer23_moe_comm_to_expert11&#45;&gt;layer23_moe_expert11</title>
<path fill="none" stroke="black" d="M5265.02,-29438.45C5265.02,-29438.45 5265.02,-29412.38 5265.02,-29412.38"/>
<polygon fill="black" stroke="black" points="5268.52,-29412.38 5265.02,-29402.38 5261.52,-29412.38 5268.52,-29412.38"/>
</g>
<!-- layer23_moe_expert12 -->
<g id="node1075" class="node">
<title>layer23_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5879,-29402.25 5541,-29402.25 5541,-29350.25 5879,-29350.25 5879,-29402.25"/>
<text text-anchor="middle" x="5710" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 12 L23</text>
<text text-anchor="middle" x="5710" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5710" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5710" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert12 -->
<g id="node1096" class="node">
<title>layer23_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5603" cy="-29285.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5603" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5603" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5603" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer23_moe_expert12&#45;&gt;layer23_moe_comm_from_expert12 -->
<g id="edge1403" class="edge">
<title>layer23_moe_expert12&#45;&gt;layer23_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5619.38,-29349.93C5619.38,-29349.93 5619.38,-29324.06 5619.38,-29324.06"/>
<polygon fill="black" stroke="black" points="5622.88,-29324.06 5619.38,-29314.06 5615.88,-29324.06 5622.88,-29324.06"/>
</g>
<!-- layer23_moe_comm_to_expert12&#45;&gt;layer23_moe_expert12 -->
<g id="edge1372" class="edge">
<title>layer23_moe_comm_to_expert12&#45;&gt;layer23_moe_expert12</title>
<path fill="none" stroke="black" d="M5618.52,-29438.45C5618.52,-29438.45 5618.52,-29412.38 5618.52,-29412.38"/>
<polygon fill="black" stroke="black" points="5622.02,-29412.38 5618.52,-29402.38 5615.02,-29412.38 5622.02,-29412.38"/>
</g>
<!-- layer23_moe_expert13 -->
<g id="node1077" class="node">
<title>layer23_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6235,-29402.25 5897,-29402.25 5897,-29350.25 6235,-29350.25 6235,-29402.25"/>
<text text-anchor="middle" x="6066" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 13 L23</text>
<text text-anchor="middle" x="6066" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6066" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6066" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert13 -->
<g id="node1097" class="node">
<title>layer23_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5957" cy="-29285.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5957" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5957" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5957" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer23_moe_expert13&#45;&gt;layer23_moe_comm_from_expert13 -->
<g id="edge1405" class="edge">
<title>layer23_moe_expert13&#45;&gt;layer23_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5974.38,-29349.93C5974.38,-29349.93 5974.38,-29324.06 5974.38,-29324.06"/>
<polygon fill="black" stroke="black" points="5977.88,-29324.06 5974.38,-29314.06 5970.88,-29324.06 5977.88,-29324.06"/>
</g>
<!-- layer23_moe_comm_to_expert13&#45;&gt;layer23_moe_expert13 -->
<g id="edge1374" class="edge">
<title>layer23_moe_comm_to_expert13&#45;&gt;layer23_moe_expert13</title>
<path fill="none" stroke="black" d="M5973.02,-29438.45C5973.02,-29438.45 5973.02,-29412.38 5973.02,-29412.38"/>
<polygon fill="black" stroke="black" points="5976.52,-29412.38 5973.02,-29402.38 5969.52,-29412.38 5976.52,-29412.38"/>
</g>
<!-- layer23_moe_expert14 -->
<g id="node1079" class="node">
<title>layer23_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6591,-29402.25 6253,-29402.25 6253,-29350.25 6591,-29350.25 6591,-29402.25"/>
<text text-anchor="middle" x="6422" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 14 L23</text>
<text text-anchor="middle" x="6422" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6422" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6422" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert14 -->
<g id="node1098" class="node">
<title>layer23_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6312" cy="-29285.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6312" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6312" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6312" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer23_moe_expert14&#45;&gt;layer23_moe_comm_from_expert14 -->
<g id="edge1407" class="edge">
<title>layer23_moe_expert14&#45;&gt;layer23_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6329.88,-29349.93C6329.88,-29349.93 6329.88,-29323.74 6329.88,-29323.74"/>
<polygon fill="black" stroke="black" points="6333.38,-29323.74 6329.88,-29313.74 6326.38,-29323.74 6333.38,-29323.74"/>
</g>
<!-- layer23_moe_comm_to_expert14&#45;&gt;layer23_moe_expert14 -->
<g id="edge1376" class="edge">
<title>layer23_moe_comm_to_expert14&#45;&gt;layer23_moe_expert14</title>
<path fill="none" stroke="black" d="M6328.52,-29438.45C6328.52,-29438.45 6328.52,-29412.38 6328.52,-29412.38"/>
<polygon fill="black" stroke="black" points="6332.02,-29412.38 6328.52,-29402.38 6325.02,-29412.38 6332.02,-29412.38"/>
</g>
<!-- layer23_moe_expert15 -->
<g id="node1081" class="node">
<title>layer23_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6947,-29402.25 6609,-29402.25 6609,-29350.25 6947,-29350.25 6947,-29402.25"/>
<text text-anchor="middle" x="6778" y="-29390.25" font-family="Arial" font-size="10.00">EXPERT 15 L23</text>
<text text-anchor="middle" x="6778" y="-29379.25" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6778" y="-29368.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6778" y="-29357.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_comm_from_expert15 -->
<g id="node1099" class="node">
<title>layer23_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6667" cy="-29285.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6667" y="-29293.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6667" y="-29282.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6667" y="-29271.75" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer23_moe_expert15&#45;&gt;layer23_moe_comm_from_expert15 -->
<g id="edge1409" class="edge">
<title>layer23_moe_expert15&#45;&gt;layer23_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6685.38,-29349.93C6685.38,-29349.93 6685.38,-29323.74 6685.38,-29323.74"/>
<polygon fill="black" stroke="black" points="6688.88,-29323.74 6685.38,-29313.74 6681.88,-29323.74 6688.88,-29323.74"/>
</g>
<!-- layer23_moe_comm_to_expert15&#45;&gt;layer23_moe_expert15 -->
<g id="edge1378" class="edge">
<title>layer23_moe_comm_to_expert15&#45;&gt;layer23_moe_expert15</title>
<path fill="none" stroke="black" d="M6684.02,-29438.45C6684.02,-29438.45 6684.02,-29412.38 6684.02,-29412.38"/>
<polygon fill="black" stroke="black" points="6687.52,-29412.38 6684.02,-29402.38 6680.52,-29412.38 6687.52,-29412.38"/>
</g>
<!-- layer23_moe_aggregate -->
<g id="node1083" class="node">
<title>layer23_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4353.1,-29220.26 3936.16,-29220.26 3828.9,-29116.26 4245.84,-29116.26 4353.1,-29220.26"/>
<text text-anchor="middle" x="4091" y="-29182.26" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L23</text>
<text text-anchor="middle" x="4091" y="-29171.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4091" y="-29160.26" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4091" y="-29149.26" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_mha -->
<g id="node1100" class="node">
<title>layer24_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4221,-29080.26 3961,-29080.26 3961,-29028.26 4221,-29028.26 4221,-29080.26"/>
<text text-anchor="middle" x="4091" y="-29068.26" font-family="Arial" font-size="10.00">MHA L24</text>
<text text-anchor="middle" x="4091" y="-29057.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4091" y="-29046.26" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4091" y="-29035.26" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer23_moe_aggregate&#45;&gt;layer24_moe_mha -->
<g id="edge1478" class="edge">
<title>layer23_moe_aggregate&#45;&gt;layer24_moe_mha</title>
<path fill="none" stroke="black" d="M4091,-29115.93C4091,-29115.93 4091,-29090.49 4091,-29090.49"/>
<polygon fill="black" stroke="black" points="4094.5,-29090.49 4091,-29080.49 4087.5,-29090.49 4094.5,-29090.49"/>
</g>
<!-- layer23_moe_comm_from_expert0&#45;&gt;layer23_moe_aggregate -->
<g id="edge1380" class="edge">
<title>layer23_moe_comm_from_expert0&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M1724.25,-29259.78C1724.25,-29215.97 1724.25,-29131 1724.25,-29131 1724.25,-29131 3833.86,-29131 3833.86,-29131"/>
<polygon fill="black" stroke="black" points="3833.86,-29134.5 3843.86,-29131 3833.86,-29127.5 3833.86,-29134.5"/>
</g>
<!-- layer23_moe_comm_from_expert1&#45;&gt;layer23_moe_aggregate -->
<g id="edge1382" class="edge">
<title>layer23_moe_comm_from_expert1&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M2214,-29259.2C2214,-29218.64 2214,-29145 2214,-29145 2214,-29145 3848.49,-29145 3848.49,-29145"/>
<polygon fill="black" stroke="black" points="3848.49,-29148.5 3858.49,-29145 3848.49,-29141.5 3848.49,-29148.5"/>
</g>
<!-- layer23_moe_comm_from_expert2&#45;&gt;layer23_moe_aggregate -->
<g id="edge1384" class="edge">
<title>layer23_moe_comm_from_expert2&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M2519,-29256.2C2519,-29219.2 2519,-29160 2519,-29160 2519,-29160 3863.66,-29160 3863.66,-29160"/>
<polygon fill="black" stroke="black" points="3863.66,-29163.5 3873.66,-29160 3863.66,-29156.5 3863.66,-29163.5"/>
</g>
<!-- layer23_moe_comm_from_expert3&#45;&gt;layer23_moe_aggregate -->
<g id="edge1386" class="edge">
<title>layer23_moe_comm_from_expert3&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M2841.51,-29261.06C2841.51,-29228.6 2841.51,-29175 2841.51,-29175 2841.51,-29175 3879.21,-29175 3879.21,-29175"/>
<polygon fill="black" stroke="black" points="3879.21,-29178.5 3889.21,-29175 3879.21,-29171.5 3879.21,-29178.5"/>
</g>
<!-- layer23_moe_comm_from_expert4&#45;&gt;layer23_moe_aggregate -->
<g id="edge1388" class="edge">
<title>layer23_moe_comm_from_expert4&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M3033,-29256.16C3033,-29228.14 3033,-29190 3033,-29190 3033,-29190 3894.89,-29190 3894.89,-29190"/>
<polygon fill="black" stroke="black" points="3894.89,-29193.5 3904.89,-29190 3894.89,-29186.5 3894.89,-29193.5"/>
</g>
<!-- layer23_moe_comm_from_expert5&#45;&gt;layer23_moe_aggregate -->
<g id="edge1390" class="edge">
<title>layer23_moe_comm_from_expert5&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M3453.5,-29271.28C3453.5,-29248.28 3453.5,-29205 3453.5,-29205 3453.5,-29205 3910.16,-29205 3910.16,-29205"/>
<polygon fill="black" stroke="black" points="3910.16,-29208.5 3920.16,-29205 3910.16,-29201.5 3910.16,-29208.5"/>
</g>
<!-- layer23_moe_comm_from_expert6&#45;&gt;layer23_moe_aggregate -->
<g id="edge1392" class="edge">
<title>layer23_moe_comm_from_expert6&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M3810.65,-29285C3839.98,-29285 3865.1,-29285 3865.1,-29285 3865.1,-29285 3865.1,-29178.35 3865.1,-29178.35"/>
<polygon fill="black" stroke="black" points="3868.6,-29178.35 3865.1,-29168.35 3861.6,-29178.35 3868.6,-29178.35"/>
</g>
<!-- layer23_moe_comm_from_expert7&#45;&gt;layer23_moe_aggregate -->
<g id="edge1394" class="edge">
<title>layer23_moe_comm_from_expert7&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M3992,-29256.03C3992,-29256.03 3992,-29230.32 3992,-29230.32"/>
<polygon fill="black" stroke="black" points="3995.5,-29230.32 3992,-29220.32 3988.5,-29230.32 3995.5,-29230.32"/>
</g>
<!-- layer23_moe_comm_from_expert8&#45;&gt;layer23_moe_aggregate -->
<g id="edge1396" class="edge">
<title>layer23_moe_comm_from_expert8&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M4263.39,-29256.03C4263.39,-29256.03 4263.39,-29230.32 4263.39,-29230.32"/>
<polygon fill="black" stroke="black" points="4266.89,-29230.32 4263.39,-29220.32 4259.89,-29230.32 4266.89,-29230.32"/>
</g>
<!-- layer23_moe_comm_from_expert9&#45;&gt;layer23_moe_aggregate -->
<g id="edge1398" class="edge">
<title>layer23_moe_comm_from_expert9&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M4554.5,-29256.56C4554.5,-29234.23 4554.5,-29207 4554.5,-29207 4554.5,-29207 4349.71,-29207 4349.71,-29207"/>
<polygon fill="black" stroke="black" points="4349.71,-29203.5 4339.71,-29207 4349.71,-29210.5 4349.71,-29203.5"/>
</g>
<!-- layer23_moe_comm_from_expert10&#45;&gt;layer23_moe_aggregate -->
<g id="edge1400" class="edge">
<title>layer23_moe_comm_from_expert10&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M4886.15,-29256.38C4886.15,-29229.65 4886.15,-29194 4886.15,-29194 4886.15,-29194 4336.07,-29194 4336.07,-29194"/>
<polygon fill="black" stroke="black" points="4336.07,-29190.5 4326.07,-29194 4336.07,-29197.5 4336.07,-29190.5"/>
</g>
<!-- layer23_moe_comm_from_expert11&#45;&gt;layer23_moe_aggregate -->
<g id="edge1402" class="edge">
<title>layer23_moe_comm_from_expert11&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M5232.65,-29256.77C5232.65,-29225.9 5232.65,-29181 5232.65,-29181 5232.65,-29181 4322.81,-29181 4322.81,-29181"/>
<polygon fill="black" stroke="black" points="4322.81,-29177.5 4312.81,-29181 4322.81,-29184.5 4322.81,-29177.5"/>
</g>
<!-- layer23_moe_comm_from_expert12&#45;&gt;layer23_moe_aggregate -->
<g id="edge1404" class="edge">
<title>layer23_moe_comm_from_expert12&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M5583.65,-29256.87C5583.65,-29222.17 5583.65,-29168 5583.65,-29168 5583.65,-29168 4309.33,-29168 4309.33,-29168"/>
<polygon fill="black" stroke="black" points="4309.33,-29164.5 4299.33,-29168 4309.33,-29171.5 4309.33,-29164.5"/>
</g>
<!-- layer23_moe_comm_from_expert13&#45;&gt;layer23_moe_aggregate -->
<g id="edge1406" class="edge">
<title>layer23_moe_comm_from_expert13&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M5937.15,-29256.67C5937.15,-29218.33 5937.15,-29155 5937.15,-29155 5937.15,-29155 4295.95,-29155 4295.95,-29155"/>
<polygon fill="black" stroke="black" points="4295.95,-29151.5 4285.95,-29155 4295.95,-29158.5 4295.95,-29151.5"/>
</g>
<!-- layer23_moe_comm_from_expert14&#45;&gt;layer23_moe_aggregate -->
<g id="edge1408" class="edge">
<title>layer23_moe_comm_from_expert14&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M6292.15,-29256.61C6292.15,-29214.8 6292.15,-29142 6292.15,-29142 6292.15,-29142 4282.53,-29142 4282.53,-29142"/>
<polygon fill="black" stroke="black" points="4282.53,-29138.5 4272.53,-29142 4282.53,-29145.5 4282.53,-29138.5"/>
</g>
<!-- layer23_moe_comm_from_expert15&#45;&gt;layer23_moe_aggregate -->
<g id="edge1410" class="edge">
<title>layer23_moe_comm_from_expert15&#45;&gt;layer23_moe_aggregate</title>
<path fill="none" stroke="black" d="M6647.15,-29256.59C6647.15,-29211.49 6647.15,-29129 6647.15,-29129 6647.15,-29129 4269.21,-29129 4269.21,-29129"/>
<polygon fill="black" stroke="black" points="4269.21,-29125.5 4259.21,-29129 4269.21,-29132.5 4269.21,-29125.5"/>
</g>
<!-- layer24_moe_gate -->
<g id="node1101" class="node">
<title>layer24_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4349.3,-28992.26 3938.4,-28992.26 3832.7,-28888.26 4243.6,-28888.26 4349.3,-28992.26"/>
<text text-anchor="middle" x="4091" y="-28954.26" font-family="Arial" font-size="10.00">GATE L24</text>
<text text-anchor="middle" x="4091" y="-28943.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4091" y="-28932.26" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4091" y="-28921.26" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer24_moe_mha&#45;&gt;layer24_moe_gate -->
<g id="edge1479" class="edge">
<title>layer24_moe_mha&#45;&gt;layer24_moe_gate</title>
<path fill="none" stroke="black" d="M4091,-29028.11C4091,-29028.11 4091,-29002.36 4091,-29002.36"/>
<polygon fill="black" stroke="black" points="4094.5,-29002.36 4091,-28992.36 4087.5,-29002.36 4094.5,-29002.36"/>
</g>
<!-- layer24_moe_split -->
<g id="node1102" class="node">
<title>layer24_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4345.01,-28852.26 3940.94,-28852.26 3836.99,-28748.26 4241.06,-28748.26 4345.01,-28852.26"/>
<text text-anchor="middle" x="4091" y="-28814.26" font-family="Arial" font-size="10.00">SPLIT TOKENS L24</text>
<text text-anchor="middle" x="4091" y="-28803.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4091" y="-28792.26" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4091" y="-28781.26" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer24_moe_gate&#45;&gt;layer24_moe_split -->
<g id="edge1480" class="edge">
<title>layer24_moe_gate&#45;&gt;layer24_moe_split</title>
<path fill="none" stroke="black" d="M4091,-28888.13C4091,-28888.13 4091,-28862.44 4091,-28862.44"/>
<polygon fill="black" stroke="black" points="4094.5,-28862.44 4091,-28852.44 4087.5,-28862.44 4094.5,-28862.44"/>
</g>
<!-- layer24_moe_comm_to_expert0 -->
<g id="node1104" class="node">
<title>layer24_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2010" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2010" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="2010" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2010" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert0 -->
<g id="edge1414" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3925.67,-28837C3446.62,-28837 2091.5,-28837 2091.5,-28837 2091.5,-28837 2091.5,-28706.11 2091.5,-28706.11"/>
<polygon fill="black" stroke="black" points="2095,-28706.11 2091.5,-28696.11 2088,-28706.11 2095,-28706.11"/>
</g>
<!-- layer24_moe_comm_to_expert1 -->
<g id="node1106" class="node">
<title>layer24_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2255" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2255" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2255" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2255" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert1 -->
<g id="edge1416" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3910.28,-28822C3456.39,-28822 2304.51,-28822 2304.51,-28822 2304.51,-28822 2304.51,-28717.75 2304.51,-28717.75"/>
<polygon fill="black" stroke="black" points="2308.01,-28717.75 2304.51,-28707.75 2301.01,-28717.75 2308.01,-28717.75"/>
</g>
<!-- layer24_moe_comm_to_expert2 -->
<g id="node1108" class="node">
<title>layer24_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2711" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2711" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2711" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2711" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert2 -->
<g id="edge1418" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3895.44,-28807C3523.51,-28807 2751,-28807 2751,-28807 2751,-28807 2751,-28719.51 2751,-28719.51"/>
<polygon fill="black" stroke="black" points="2754.5,-28719.51 2751,-28709.51 2747.5,-28719.51 2754.5,-28719.51"/>
</g>
<!-- layer24_moe_comm_to_expert3 -->
<g id="node1110" class="node">
<title>layer24_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3039" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3039" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="3039" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="3039" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert3 -->
<g id="edge1420" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3880.47,-28792C3595.86,-28792 3123.51,-28792 3123.51,-28792 3123.51,-28792 3123.51,-28703.7 3123.51,-28703.7"/>
<polygon fill="black" stroke="black" points="3127.01,-28703.7 3123.51,-28693.7 3120.01,-28703.7 3127.01,-28703.7"/>
</g>
<!-- layer24_moe_comm_to_expert4 -->
<g id="node1112" class="node">
<title>layer24_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3302" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3302" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3302" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3302" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert4 -->
<g id="edge1422" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3865.59,-28777C3643.74,-28777 3338,-28777 3338,-28777 3338,-28777 3338,-28719.88 3338,-28719.88"/>
<polygon fill="black" stroke="black" points="3341.5,-28719.88 3338,-28709.88 3334.5,-28719.88 3341.5,-28719.88"/>
</g>
<!-- layer24_moe_comm_to_expert5 -->
<g id="node1114" class="node">
<title>layer24_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3533" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3533" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3533" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3533" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert5 -->
<g id="edge1424" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3851.48,-28763C3704.4,-28763 3544.01,-28763 3544.01,-28763 3544.01,-28763 3544.01,-28722.06 3544.01,-28722.06"/>
<polygon fill="black" stroke="black" points="3547.51,-28722.06 3544.01,-28712.06 3540.51,-28722.06 3547.51,-28722.06"/>
</g>
<!-- layer24_moe_comm_to_expert6 -->
<g id="node1116" class="node">
<title>layer24_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3748" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3748" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3748" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3748" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert6 -->
<g id="edge1426" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3851.5,-28800.18C3851.5,-28796.63 3851.5,-28683 3851.5,-28683 3851.5,-28683 3848.81,-28683 3848.81,-28683"/>
<polygon fill="black" stroke="black" points="3848.81,-28679.5 3838.81,-28683 3848.81,-28686.5 3848.81,-28679.5"/>
</g>
<!-- layer24_moe_comm_to_expert7 -->
<g id="node1118" class="node">
<title>layer24_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3955" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3955" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3955" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3955" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert7 -->
<g id="edge1428" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3955,-28747.93C3955,-28747.93 3955,-28722.48 3955,-28722.48"/>
<polygon fill="black" stroke="black" points="3958.5,-28722.48 3955,-28712.48 3951.5,-28722.48 3958.5,-28722.48"/>
</g>
<!-- layer24_moe_comm_to_expert8 -->
<g id="node1120" class="node">
<title>layer24_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4227" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4227" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4227" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4227" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert8 -->
<g id="edge1430" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4227,-28747.93C4227,-28747.93 4227,-28722.48 4227,-28722.48"/>
<polygon fill="black" stroke="black" points="4230.5,-28722.48 4227,-28712.48 4223.5,-28722.48 4230.5,-28722.48"/>
</g>
<!-- layer24_moe_comm_to_expert9 -->
<g id="node1122" class="node">
<title>layer24_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4536" cy="-28683.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4536" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4536" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4536" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert9 -->
<g id="edge1432" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4331.26,-28800.18C4331.26,-28796.63 4331.26,-28683 4331.26,-28683 4331.26,-28683 4435.3,-28683 4435.3,-28683"/>
<polygon fill="black" stroke="black" points="4435.3,-28686.5 4445.3,-28683 4435.3,-28679.5 4435.3,-28686.5"/>
</g>
<!-- layer24_moe_comm_to_expert10 -->
<g id="node1124" class="node">
<title>layer24_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4868" cy="-28683.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4868" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4868" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4868" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert10 -->
<g id="edge1434" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4255.82,-28763C4463.07,-28763 4792.1,-28763 4792.1,-28763 4792.1,-28763 4792.1,-28710.57 4792.1,-28710.57"/>
<polygon fill="black" stroke="black" points="4795.6,-28710.57 4792.1,-28700.57 4788.6,-28710.57 4795.6,-28710.57"/>
</g>
<!-- layer24_moe_comm_to_expert11 -->
<g id="node1126" class="node">
<title>layer24_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5214" cy="-28683.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5214" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5214" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5214" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert11 -->
<g id="edge1436" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4269.9,-28777C4569.11,-28777 5138.6,-28777 5138.6,-28777 5138.6,-28777 5138.6,-28710.9 5138.6,-28710.9"/>
<polygon fill="black" stroke="black" points="5142.1,-28710.9 5138.6,-28700.9 5135.1,-28710.9 5142.1,-28710.9"/>
</g>
<!-- layer24_moe_comm_to_expert12 -->
<g id="node1128" class="node">
<title>layer24_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5565" cy="-28683.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5565" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5565" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5565" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert12 -->
<g id="edge1438" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4285.1,-28792C4669.24,-28792 5489.6,-28792 5489.6,-28792 5489.6,-28792 5489.6,-28710.74 5489.6,-28710.74"/>
<polygon fill="black" stroke="black" points="5493.1,-28710.74 5489.6,-28700.74 5486.1,-28710.74 5493.1,-28710.74"/>
</g>
<!-- layer24_moe_comm_to_expert13 -->
<g id="node1130" class="node">
<title>layer24_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5918" cy="-28683.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5918" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5918" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5918" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert13 -->
<g id="edge1440" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4300.17,-28807C4765,-28807 5843.1,-28807 5843.1,-28807 5843.1,-28807 5843.1,-28711 5843.1,-28711"/>
<polygon fill="black" stroke="black" points="5846.6,-28711 5843.1,-28701 5839.6,-28711 5846.6,-28711"/>
</g>
<!-- layer24_moe_comm_to_expert14 -->
<g id="node1132" class="node">
<title>layer24_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6273" cy="-28683.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6273" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6273" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6273" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert14 -->
<g id="edge1442" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4315,-28822C4857.61,-28822 6198.1,-28822 6198.1,-28822 6198.1,-28822 6198.1,-28710.84 6198.1,-28710.84"/>
<polygon fill="black" stroke="black" points="6201.6,-28710.84 6198.1,-28700.84 6194.6,-28710.84 6201.6,-28710.84"/>
</g>
<!-- layer24_moe_comm_to_expert15 -->
<g id="node1134" class="node">
<title>layer24_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6628" cy="-28683.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6628" y="-28691.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6628" y="-28680.77" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6628" y="-28669.77" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert15 -->
<g id="edge1444" class="edge">
<title>layer24_moe_split&#45;&gt;layer24_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4329.87,-28837C4948.18,-28837 6553.1,-28837 6553.1,-28837 6553.1,-28837 6553.1,-28710.91 6553.1,-28710.91"/>
<polygon fill="black" stroke="black" points="6556.6,-28710.91 6553.1,-28700.91 6549.6,-28710.91 6556.6,-28710.91"/>
</g>
<!-- layer24_moe_expert0 -->
<g id="node1103" class="node">
<title>layer24_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1660,-28618.28 1332,-28618.28 1332,-28566.28 1660,-28566.28 1660,-28618.28"/>
<text text-anchor="middle" x="1496" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 0 L24</text>
<text text-anchor="middle" x="1496" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1496" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1496" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert0 -->
<g id="node1136" class="node">
<title>layer24_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="2010" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2010" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="2010" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2010" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer24_moe_expert0&#45;&gt;layer24_moe_comm_from_expert0 -->
<g id="edge1446" class="edge">
<title>layer24_moe_expert0&#45;&gt;layer24_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1593.75,-28565.88C1593.75,-28538.92 1593.75,-28501 1593.75,-28501 1593.75,-28501 1909.42,-28501 1909.42,-28501"/>
<polygon fill="black" stroke="black" points="1909.42,-28504.5 1919.42,-28501 1909.42,-28497.5 1909.42,-28504.5"/>
</g>
<!-- layer24_moe_comm_to_expert0&#45;&gt;layer24_moe_expert0 -->
<g id="edge1415" class="edge">
<title>layer24_moe_comm_to_expert0&#45;&gt;layer24_moe_expert0</title>
<path fill="none" stroke="black" d="M1919.19,-28683C1805.29,-28683 1624.75,-28683 1624.75,-28683 1624.75,-28683 1624.75,-28628.52 1624.75,-28628.52"/>
<polygon fill="black" stroke="black" points="1628.25,-28628.52 1624.75,-28618.52 1621.25,-28628.52 1628.25,-28628.52"/>
</g>
<!-- layer24_moe_expert1 -->
<g id="node1105" class="node">
<title>layer24_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="2006,-28618.28 1678,-28618.28 1678,-28566.28 2006,-28566.28 2006,-28618.28"/>
<text text-anchor="middle" x="1842" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 1 L24</text>
<text text-anchor="middle" x="1842" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1842" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1842" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert1 -->
<g id="node1137" class="node">
<title>layer24_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2255" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2255" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2255" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2255" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer24_moe_expert1&#45;&gt;layer24_moe_comm_from_expert1 -->
<g id="edge1448" class="edge">
<title>layer24_moe_expert1&#45;&gt;layer24_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1962.75,-28566.26C1962.75,-28552.74 1962.75,-28539 1962.75,-28539 1962.75,-28539 2255,-28539 2255,-28539 2255,-28539 2255,-28538.16 2255,-28538.16"/>
<polygon fill="black" stroke="black" points="2258.5,-28540.63 2255,-28530.63 2251.5,-28540.63 2258.5,-28540.63"/>
</g>
<!-- layer24_moe_comm_to_expert1&#45;&gt;layer24_moe_expert1 -->
<g id="edge1417" class="edge">
<title>layer24_moe_comm_to_expert1&#45;&gt;layer24_moe_expert1</title>
<path fill="none" stroke="black" d="M2255,-28654.15C2255,-28640.42 2255,-28627 2255,-28627 2255,-28627 1962.75,-28627 1962.75,-28627 1962.75,-28627 1962.75,-28626.16 1962.75,-28626.16"/>
<polygon fill="black" stroke="black" points="1966.25,-28628.6 1962.75,-28618.6 1959.25,-28628.6 1966.25,-28628.6"/>
</g>
<!-- layer24_moe_expert2 -->
<g id="node1107" class="node">
<title>layer24_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2352,-28618.28 2024,-28618.28 2024,-28566.28 2352,-28566.28 2352,-28618.28"/>
<text text-anchor="middle" x="2188" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 2 L24</text>
<text text-anchor="middle" x="2188" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2188" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2188" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert2 -->
<g id="node1138" class="node">
<title>layer24_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2711" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2711" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2711" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2711" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer24_moe_expert2&#45;&gt;layer24_moe_comm_from_expert2 -->
<g id="edge1450" class="edge">
<title>layer24_moe_expert2&#45;&gt;layer24_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2352.18,-28583C2359.6,-28583 2364,-28583 2364,-28583 2364,-28583 2364,-28501 2364,-28501 2364,-28501 2610.28,-28501 2610.28,-28501"/>
<polygon fill="black" stroke="black" points="2610.28,-28504.5 2620.28,-28501 2610.28,-28497.5 2610.28,-28504.5"/>
</g>
<!-- layer24_moe_comm_to_expert2&#45;&gt;layer24_moe_expert2 -->
<g id="edge1419" class="edge">
<title>layer24_moe_comm_to_expert2&#45;&gt;layer24_moe_expert2</title>
<path fill="none" stroke="black" d="M2620.09,-28683C2515.5,-28683 2358,-28683 2358,-28683 2358,-28683 2358,-28600 2358,-28600 2358,-28600 2357.43,-28600 2357.43,-28600"/>
<polygon fill="black" stroke="black" points="2362.34,-28596.5 2352.34,-28600 2362.34,-28603.5 2362.34,-28596.5"/>
</g>
<!-- layer24_moe_expert3 -->
<g id="node1109" class="node">
<title>layer24_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2698,-28618.28 2370,-28618.28 2370,-28566.28 2698,-28566.28 2698,-28618.28"/>
<text text-anchor="middle" x="2534" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 3 L24</text>
<text text-anchor="middle" x="2534" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2534" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2534" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert3 -->
<g id="node1139" class="node">
<title>layer24_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3039" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3039" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3039" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3039" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer24_moe_expert3&#45;&gt;layer24_moe_comm_from_expert3 -->
<g id="edge1452" class="edge">
<title>layer24_moe_expert3&#45;&gt;layer24_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2659.25,-28566.27C2659.25,-28556.63 2659.25,-28548 2659.25,-28548 2659.25,-28548 2980.33,-28548 2980.33,-28548 2980.33,-28548 2980.33,-28533.55 2980.33,-28533.55"/>
<polygon fill="black" stroke="black" points="2983.83,-28533.55 2980.33,-28523.55 2976.83,-28533.55 2983.83,-28533.55"/>
</g>
<!-- layer24_moe_comm_to_expert3&#45;&gt;layer24_moe_expert3 -->
<g id="edge1421" class="edge">
<title>layer24_moe_comm_to_expert3&#45;&gt;layer24_moe_expert3</title>
<path fill="none" stroke="black" d="M2980.33,-28661.01C2980.33,-28652.59 2980.33,-28645 2980.33,-28645 2980.33,-28645 2659.25,-28645 2659.25,-28645 2659.25,-28645 2659.25,-28628.33 2659.25,-28628.33"/>
<polygon fill="black" stroke="black" points="2662.75,-28628.33 2659.25,-28618.33 2655.75,-28628.33 2662.75,-28628.33"/>
</g>
<!-- layer24_moe_expert4 -->
<g id="node1111" class="node">
<title>layer24_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3044,-28618.28 2716,-28618.28 2716,-28566.28 3044,-28566.28 3044,-28618.28"/>
<text text-anchor="middle" x="2880" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 4 L24</text>
<text text-anchor="middle" x="2880" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2880" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2880" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert4 -->
<g id="node1140" class="node">
<title>layer24_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3302" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3302" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3302" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3302" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer24_moe_expert4&#45;&gt;layer24_moe_comm_from_expert4 -->
<g id="edge1454" class="edge">
<title>layer24_moe_expert4&#45;&gt;layer24_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M3012.16,-28566.27C3012.16,-28560.98 3012.16,-28557 3012.16,-28557 3012.16,-28557 3300.75,-28557 3300.75,-28557 3300.75,-28557 3300.75,-28540.45 3300.75,-28540.45"/>
<polygon fill="black" stroke="black" points="3304.25,-28540.45 3300.75,-28530.45 3297.25,-28540.45 3304.25,-28540.45"/>
</g>
<!-- layer24_moe_comm_to_expert4&#45;&gt;layer24_moe_expert4 -->
<g id="edge1423" class="edge">
<title>layer24_moe_comm_to_expert4&#45;&gt;layer24_moe_expert4</title>
<path fill="none" stroke="black" d="M3300.75,-28654.14C3300.75,-28644.41 3300.75,-28636 3300.75,-28636 3300.75,-28636 3012.16,-28636 3012.16,-28636 3012.16,-28636 3012.16,-28628.47 3012.16,-28628.47"/>
<polygon fill="black" stroke="black" points="3015.66,-28628.47 3012.16,-28618.47 3008.66,-28628.47 3015.66,-28628.47"/>
</g>
<!-- layer24_moe_expert5 -->
<g id="node1113" class="node">
<title>layer24_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3390,-28618.28 3062,-28618.28 3062,-28566.28 3390,-28566.28 3390,-28618.28"/>
<text text-anchor="middle" x="3226" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 5 L24</text>
<text text-anchor="middle" x="3226" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3226" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3226" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert5 -->
<g id="node1141" class="node">
<title>layer24_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3533" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3533" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3533" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3533" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer24_moe_expert5&#45;&gt;layer24_moe_comm_from_expert5 -->
<g id="edge1456" class="edge">
<title>layer24_moe_expert5&#45;&gt;layer24_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3390.12,-28583C3398.08,-28583 3402.84,-28583 3402.84,-28583 3402.84,-28583 3402.84,-28501 3402.84,-28501 3402.84,-28501 3432.24,-28501 3432.24,-28501"/>
<polygon fill="black" stroke="black" points="3432.24,-28504.5 3442.24,-28501 3432.24,-28497.5 3432.24,-28504.5"/>
</g>
<!-- layer24_moe_comm_to_expert5&#45;&gt;layer24_moe_expert5 -->
<g id="edge1425" class="edge">
<title>layer24_moe_comm_to_expert5&#45;&gt;layer24_moe_expert5</title>
<path fill="none" stroke="black" d="M3442.36,-28683C3417.71,-28683 3397.67,-28683 3397.67,-28683 3397.67,-28683 3397.67,-28600 3397.67,-28600 3397.67,-28600 3396.94,-28600 3396.94,-28600"/>
<polygon fill="black" stroke="black" points="3400.3,-28596.5 3390.3,-28600 3400.3,-28603.5 3400.3,-28596.5"/>
</g>
<!-- layer24_moe_expert6 -->
<g id="node1115" class="node">
<title>layer24_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3736,-28618.28 3408,-28618.28 3408,-28566.28 3736,-28566.28 3736,-28618.28"/>
<text text-anchor="middle" x="3572" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 6 L24</text>
<text text-anchor="middle" x="3572" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3572" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3572" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert6 -->
<g id="node1142" class="node">
<title>layer24_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3748" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3748" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3748" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3748" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer24_moe_expert6&#45;&gt;layer24_moe_comm_from_expert6 -->
<g id="edge1458" class="edge">
<title>layer24_moe_expert6&#45;&gt;layer24_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3696.75,-28565.96C3696.75,-28565.96 3696.75,-28535.37 3696.75,-28535.37"/>
<polygon fill="black" stroke="black" points="3700.25,-28535.37 3696.75,-28525.37 3693.25,-28535.37 3700.25,-28535.37"/>
</g>
<!-- layer24_moe_comm_to_expert6&#45;&gt;layer24_moe_expert6 -->
<g id="edge1427" class="edge">
<title>layer24_moe_comm_to_expert6&#45;&gt;layer24_moe_expert6</title>
<path fill="none" stroke="black" d="M3696.75,-28659.36C3696.75,-28659.36 3696.75,-28628.59 3696.75,-28628.59"/>
<polygon fill="black" stroke="black" points="3700.25,-28628.59 3696.75,-28618.59 3693.25,-28628.59 3700.25,-28628.59"/>
</g>
<!-- layer24_moe_expert7 -->
<g id="node1117" class="node">
<title>layer24_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4082,-28618.28 3754,-28618.28 3754,-28566.28 4082,-28566.28 4082,-28618.28"/>
<text text-anchor="middle" x="3918" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 7 L24</text>
<text text-anchor="middle" x="3918" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3918" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3918" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert7 -->
<g id="node1143" class="node">
<title>layer24_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3955" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3955" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3955" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3955" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer24_moe_expert7&#45;&gt;layer24_moe_comm_from_expert7 -->
<g id="edge1460" class="edge">
<title>layer24_moe_expert7&#45;&gt;layer24_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3955,-28565.96C3955,-28565.96 3955,-28540.42 3955,-28540.42"/>
<polygon fill="black" stroke="black" points="3958.5,-28540.42 3955,-28530.42 3951.5,-28540.42 3958.5,-28540.42"/>
</g>
<!-- layer24_moe_comm_to_expert7&#45;&gt;layer24_moe_expert7 -->
<g id="edge1429" class="edge">
<title>layer24_moe_comm_to_expert7&#45;&gt;layer24_moe_expert7</title>
<path fill="none" stroke="black" d="M3955,-28654.23C3955,-28654.23 3955,-28628.58 3955,-28628.58"/>
<polygon fill="black" stroke="black" points="3958.5,-28628.58 3955,-28618.58 3951.5,-28628.58 3958.5,-28628.58"/>
</g>
<!-- layer24_moe_expert8 -->
<g id="node1119" class="node">
<title>layer24_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4428,-28618.28 4100,-28618.28 4100,-28566.28 4428,-28566.28 4428,-28618.28"/>
<text text-anchor="middle" x="4264" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 8 L24</text>
<text text-anchor="middle" x="4264" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4264" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4264" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert8 -->
<g id="node1144" class="node">
<title>layer24_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4227" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4227" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4227" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4227" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer24_moe_expert8&#45;&gt;layer24_moe_comm_from_expert8 -->
<g id="edge1462" class="edge">
<title>layer24_moe_expert8&#45;&gt;layer24_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4227,-28565.96C4227,-28565.96 4227,-28540.42 4227,-28540.42"/>
<polygon fill="black" stroke="black" points="4230.5,-28540.42 4227,-28530.42 4223.5,-28540.42 4230.5,-28540.42"/>
</g>
<!-- layer24_moe_comm_to_expert8&#45;&gt;layer24_moe_expert8 -->
<g id="edge1431" class="edge">
<title>layer24_moe_comm_to_expert8&#45;&gt;layer24_moe_expert8</title>
<path fill="none" stroke="black" d="M4227,-28654.23C4227,-28654.23 4227,-28628.58 4227,-28628.58"/>
<polygon fill="black" stroke="black" points="4230.5,-28628.58 4227,-28618.58 4223.5,-28628.58 4230.5,-28628.58"/>
</g>
<!-- layer24_moe_expert9 -->
<g id="node1121" class="node">
<title>layer24_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4774,-28618.28 4446,-28618.28 4446,-28566.28 4774,-28566.28 4774,-28618.28"/>
<text text-anchor="middle" x="4610" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 9 L24</text>
<text text-anchor="middle" x="4610" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4610" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4610" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert9 -->
<g id="node1145" class="node">
<title>layer24_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4536" cy="-28501.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4536" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4536" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4536" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer24_moe_expert9&#45;&gt;layer24_moe_comm_from_expert9 -->
<g id="edge1464" class="edge">
<title>layer24_moe_expert9&#45;&gt;layer24_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4536.25,-28565.96C4536.25,-28565.96 4536.25,-28540.42 4536.25,-28540.42"/>
<polygon fill="black" stroke="black" points="4539.75,-28540.42 4536.25,-28530.42 4532.75,-28540.42 4539.75,-28540.42"/>
</g>
<!-- layer24_moe_comm_to_expert9&#45;&gt;layer24_moe_expert9 -->
<g id="edge1433" class="edge">
<title>layer24_moe_comm_to_expert9&#45;&gt;layer24_moe_expert9</title>
<path fill="none" stroke="black" d="M4536.25,-28654.23C4536.25,-28654.23 4536.25,-28628.58 4536.25,-28628.58"/>
<polygon fill="black" stroke="black" points="4539.75,-28628.58 4536.25,-28618.58 4532.75,-28628.58 4539.75,-28628.58"/>
</g>
<!-- layer24_moe_expert10 -->
<g id="node1123" class="node">
<title>layer24_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5130,-28618.28 4792,-28618.28 4792,-28566.28 5130,-28566.28 5130,-28618.28"/>
<text text-anchor="middle" x="4961" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 10 L24</text>
<text text-anchor="middle" x="4961" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4961" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4961" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert10 -->
<g id="node1146" class="node">
<title>layer24_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4868" cy="-28501.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4868" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4868" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4868" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer24_moe_expert10&#45;&gt;layer24_moe_comm_from_expert10 -->
<g id="edge1466" class="edge">
<title>layer24_moe_expert10&#45;&gt;layer24_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4877.38,-28565.96C4877.38,-28565.96 4877.38,-28540.42 4877.38,-28540.42"/>
<polygon fill="black" stroke="black" points="4880.88,-28540.42 4877.38,-28530.42 4873.88,-28540.42 4880.88,-28540.42"/>
</g>
<!-- layer24_moe_comm_to_expert10&#45;&gt;layer24_moe_expert10 -->
<g id="edge1435" class="edge">
<title>layer24_moe_comm_to_expert10&#45;&gt;layer24_moe_expert10</title>
<path fill="none" stroke="black" d="M4877.02,-28654.23C4877.02,-28654.23 4877.02,-28628.58 4877.02,-28628.58"/>
<polygon fill="black" stroke="black" points="4880.52,-28628.58 4877.02,-28618.58 4873.52,-28628.58 4880.52,-28628.58"/>
</g>
<!-- layer24_moe_expert11 -->
<g id="node1125" class="node">
<title>layer24_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5486,-28618.28 5148,-28618.28 5148,-28566.28 5486,-28566.28 5486,-28618.28"/>
<text text-anchor="middle" x="5317" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 11 L24</text>
<text text-anchor="middle" x="5317" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5317" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5317" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert11 -->
<g id="node1147" class="node">
<title>layer24_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5215" cy="-28501.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5215" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5215" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5215" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer24_moe_expert11&#45;&gt;layer24_moe_comm_from_expert11 -->
<g id="edge1468" class="edge">
<title>layer24_moe_expert11&#45;&gt;layer24_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5228.88,-28565.96C5228.88,-28565.96 5228.88,-28540.1 5228.88,-28540.1"/>
<polygon fill="black" stroke="black" points="5232.38,-28540.1 5228.88,-28530.1 5225.38,-28540.1 5232.38,-28540.1"/>
</g>
<!-- layer24_moe_comm_to_expert11&#45;&gt;layer24_moe_expert11 -->
<g id="edge1437" class="edge">
<title>layer24_moe_comm_to_expert11&#45;&gt;layer24_moe_expert11</title>
<path fill="none" stroke="black" d="M5228.02,-28654.48C5228.02,-28654.48 5228.02,-28628.42 5228.02,-28628.42"/>
<polygon fill="black" stroke="black" points="5231.52,-28628.42 5228.02,-28618.42 5224.52,-28628.42 5231.52,-28628.42"/>
</g>
<!-- layer24_moe_expert12 -->
<g id="node1127" class="node">
<title>layer24_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5842,-28618.28 5504,-28618.28 5504,-28566.28 5842,-28566.28 5842,-28618.28"/>
<text text-anchor="middle" x="5673" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 12 L24</text>
<text text-anchor="middle" x="5673" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5673" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5673" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert12 -->
<g id="node1148" class="node">
<title>layer24_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5566" cy="-28501.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5566" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5566" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5566" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer24_moe_expert12&#45;&gt;layer24_moe_comm_from_expert12 -->
<g id="edge1470" class="edge">
<title>layer24_moe_expert12&#45;&gt;layer24_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5582.38,-28565.96C5582.38,-28565.96 5582.38,-28540.1 5582.38,-28540.1"/>
<polygon fill="black" stroke="black" points="5585.88,-28540.1 5582.38,-28530.1 5578.88,-28540.1 5585.88,-28540.1"/>
</g>
<!-- layer24_moe_comm_to_expert12&#45;&gt;layer24_moe_expert12 -->
<g id="edge1439" class="edge">
<title>layer24_moe_comm_to_expert12&#45;&gt;layer24_moe_expert12</title>
<path fill="none" stroke="black" d="M5581.52,-28654.48C5581.52,-28654.48 5581.52,-28628.42 5581.52,-28628.42"/>
<polygon fill="black" stroke="black" points="5585.02,-28628.42 5581.52,-28618.42 5578.02,-28628.42 5585.02,-28628.42"/>
</g>
<!-- layer24_moe_expert13 -->
<g id="node1129" class="node">
<title>layer24_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6198,-28618.28 5860,-28618.28 5860,-28566.28 6198,-28566.28 6198,-28618.28"/>
<text text-anchor="middle" x="6029" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 13 L24</text>
<text text-anchor="middle" x="6029" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="6029" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="6029" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert13 -->
<g id="node1149" class="node">
<title>layer24_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5920" cy="-28501.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5920" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5920" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5920" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer24_moe_expert13&#45;&gt;layer24_moe_comm_from_expert13 -->
<g id="edge1472" class="edge">
<title>layer24_moe_expert13&#45;&gt;layer24_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5937.38,-28565.96C5937.38,-28565.96 5937.38,-28540.1 5937.38,-28540.1"/>
<polygon fill="black" stroke="black" points="5940.88,-28540.1 5937.38,-28530.1 5933.88,-28540.1 5940.88,-28540.1"/>
</g>
<!-- layer24_moe_comm_to_expert13&#45;&gt;layer24_moe_expert13 -->
<g id="edge1441" class="edge">
<title>layer24_moe_comm_to_expert13&#45;&gt;layer24_moe_expert13</title>
<path fill="none" stroke="black" d="M5936.02,-28654.48C5936.02,-28654.48 5936.02,-28628.42 5936.02,-28628.42"/>
<polygon fill="black" stroke="black" points="5939.52,-28628.42 5936.02,-28618.42 5932.52,-28628.42 5939.52,-28628.42"/>
</g>
<!-- layer24_moe_expert14 -->
<g id="node1131" class="node">
<title>layer24_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6554,-28618.28 6216,-28618.28 6216,-28566.28 6554,-28566.28 6554,-28618.28"/>
<text text-anchor="middle" x="6385" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 14 L24</text>
<text text-anchor="middle" x="6385" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6385" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6385" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert14 -->
<g id="node1150" class="node">
<title>layer24_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6275" cy="-28501.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6275" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6275" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6275" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer24_moe_expert14&#45;&gt;layer24_moe_comm_from_expert14 -->
<g id="edge1474" class="edge">
<title>layer24_moe_expert14&#45;&gt;layer24_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6292.88,-28565.96C6292.88,-28565.96 6292.88,-28539.77 6292.88,-28539.77"/>
<polygon fill="black" stroke="black" points="6296.38,-28539.77 6292.88,-28529.77 6289.38,-28539.77 6296.38,-28539.77"/>
</g>
<!-- layer24_moe_comm_to_expert14&#45;&gt;layer24_moe_expert14 -->
<g id="edge1443" class="edge">
<title>layer24_moe_comm_to_expert14&#45;&gt;layer24_moe_expert14</title>
<path fill="none" stroke="black" d="M6291.52,-28654.48C6291.52,-28654.48 6291.52,-28628.42 6291.52,-28628.42"/>
<polygon fill="black" stroke="black" points="6295.02,-28628.42 6291.52,-28618.42 6288.02,-28628.42 6295.02,-28628.42"/>
</g>
<!-- layer24_moe_expert15 -->
<g id="node1133" class="node">
<title>layer24_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6910,-28618.28 6572,-28618.28 6572,-28566.28 6910,-28566.28 6910,-28618.28"/>
<text text-anchor="middle" x="6741" y="-28606.28" font-family="Arial" font-size="10.00">EXPERT 15 L24</text>
<text text-anchor="middle" x="6741" y="-28595.28" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6741" y="-28584.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6741" y="-28573.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_comm_from_expert15 -->
<g id="node1151" class="node">
<title>layer24_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6630" cy="-28501.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6630" y="-28509.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6630" y="-28498.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6630" y="-28487.79" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer24_moe_expert15&#45;&gt;layer24_moe_comm_from_expert15 -->
<g id="edge1476" class="edge">
<title>layer24_moe_expert15&#45;&gt;layer24_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6648.38,-28565.96C6648.38,-28565.96 6648.38,-28539.77 6648.38,-28539.77"/>
<polygon fill="black" stroke="black" points="6651.88,-28539.77 6648.38,-28529.77 6644.88,-28539.77 6651.88,-28539.77"/>
</g>
<!-- layer24_moe_comm_to_expert15&#45;&gt;layer24_moe_expert15 -->
<g id="edge1445" class="edge">
<title>layer24_moe_comm_to_expert15&#45;&gt;layer24_moe_expert15</title>
<path fill="none" stroke="black" d="M6647.02,-28654.48C6647.02,-28654.48 6647.02,-28628.42 6647.02,-28628.42"/>
<polygon fill="black" stroke="black" points="6650.52,-28628.42 6647.02,-28618.42 6643.52,-28628.42 6650.52,-28628.42"/>
</g>
<!-- layer24_moe_aggregate -->
<g id="node1135" class="node">
<title>layer24_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4316.1,-28436.3 3899.16,-28436.3 3791.9,-28332.3 4208.84,-28332.3 4316.1,-28436.3"/>
<text text-anchor="middle" x="4054" y="-28398.3" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L24</text>
<text text-anchor="middle" x="4054" y="-28387.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4054" y="-28376.3" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4054" y="-28365.3" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_mha -->
<g id="node1152" class="node">
<title>layer25_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4184,-28296.3 3924,-28296.3 3924,-28244.3 4184,-28244.3 4184,-28296.3"/>
<text text-anchor="middle" x="4054" y="-28284.3" font-family="Arial" font-size="10.00">MHA L25</text>
<text text-anchor="middle" x="4054" y="-28273.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4054" y="-28262.3" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4054" y="-28251.3" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer24_moe_aggregate&#45;&gt;layer25_moe_mha -->
<g id="edge1545" class="edge">
<title>layer24_moe_aggregate&#45;&gt;layer25_moe_mha</title>
<path fill="none" stroke="black" d="M4054,-28331.97C4054,-28331.97 4054,-28306.53 4054,-28306.53"/>
<polygon fill="black" stroke="black" points="4057.5,-28306.53 4054,-28296.53 4050.5,-28306.53 4057.5,-28306.53"/>
</g>
<!-- layer24_moe_comm_from_expert0&#45;&gt;layer24_moe_aggregate -->
<g id="edge1447" class="edge">
<title>layer24_moe_comm_from_expert0&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M2043.75,-28474.06C2043.75,-28429.77 2043.75,-28347 2043.75,-28347 2043.75,-28347 3797,-28347 3797,-28347"/>
<polygon fill="black" stroke="black" points="3797,-28350.5 3807,-28347 3797,-28343.5 3797,-28350.5"/>
</g>
<!-- layer24_moe_comm_from_expert1&#45;&gt;layer24_moe_aggregate -->
<g id="edge1449" class="edge">
<title>layer24_moe_comm_from_expert1&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M2339.25,-28490.36C2339.25,-28457.52 2339.25,-28362 2339.25,-28362 2339.25,-28362 3812.3,-28362 3812.3,-28362"/>
<polygon fill="black" stroke="black" points="3812.3,-28365.5 3822.3,-28362 3812.3,-28358.5 3812.3,-28365.5"/>
</g>
<!-- layer24_moe_comm_from_expert2&#45;&gt;layer24_moe_aggregate -->
<g id="edge1451" class="edge">
<title>layer24_moe_comm_from_expert2&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M2744,-28474.1C2744,-28437.25 2744,-28376 2744,-28376 2744,-28376 3826.95,-28376 3826.95,-28376"/>
<polygon fill="black" stroke="black" points="3826.95,-28379.5 3836.95,-28376 3826.95,-28372.5 3826.95,-28379.5"/>
</g>
<!-- layer24_moe_comm_from_expert3&#45;&gt;layer24_moe_aggregate -->
<g id="edge1453" class="edge">
<title>layer24_moe_comm_from_expert3&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M3099.5,-28479.5C3099.5,-28447.36 3099.5,-28391 3099.5,-28391 3099.5,-28391 3842.16,-28391 3842.16,-28391"/>
<polygon fill="black" stroke="black" points="3842.16,-28394.5 3852.16,-28391 3842.16,-28387.5 3842.16,-28394.5"/>
</g>
<!-- layer24_moe_comm_from_expert4&#45;&gt;layer24_moe_aggregate -->
<g id="edge1455" class="edge">
<title>layer24_moe_comm_from_expert4&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M3376.5,-28484.69C3376.5,-28457.39 3376.5,-28406 3376.5,-28406 3376.5,-28406 3857.53,-28406 3857.53,-28406"/>
<polygon fill="black" stroke="black" points="3857.53,-28409.5 3867.53,-28406 3857.53,-28402.5 3857.53,-28409.5"/>
</g>
<!-- layer24_moe_comm_from_expert5&#45;&gt;layer24_moe_aggregate -->
<g id="edge1457" class="edge">
<title>layer24_moe_comm_from_expert5&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M3614.5,-28488.39C3614.5,-28465.69 3614.5,-28421 3614.5,-28421 3614.5,-28421 3873.13,-28421 3873.13,-28421"/>
<polygon fill="black" stroke="black" points="3873.13,-28424.5 3883.13,-28421 3873.13,-28417.5 3873.13,-28424.5"/>
</g>
<!-- layer24_moe_comm_from_expert6&#45;&gt;layer24_moe_aggregate -->
<g id="edge1459" class="edge">
<title>layer24_moe_comm_from_expert6&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M3815.11,-28481.71C3815.11,-28481.71 3815.11,-28394.34 3815.11,-28394.34"/>
<polygon fill="black" stroke="black" points="3818.61,-28394.34 3815.11,-28384.34 3811.61,-28394.34 3818.61,-28394.34"/>
</g>
<!-- layer24_moe_comm_from_expert7&#45;&gt;layer24_moe_aggregate -->
<g id="edge1461" class="edge">
<title>layer24_moe_comm_from_expert7&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M3955,-28472.07C3955,-28472.07 3955,-28446.36 3955,-28446.36"/>
<polygon fill="black" stroke="black" points="3958.5,-28446.36 3955,-28436.36 3951.5,-28446.36 3958.5,-28446.36"/>
</g>
<!-- layer24_moe_comm_from_expert8&#45;&gt;layer24_moe_aggregate -->
<g id="edge1463" class="edge">
<title>layer24_moe_comm_from_expert8&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M4226.39,-28472.07C4226.39,-28472.07 4226.39,-28446.36 4226.39,-28446.36"/>
<polygon fill="black" stroke="black" points="4229.89,-28446.36 4226.39,-28436.36 4222.89,-28446.36 4229.89,-28446.36"/>
</g>
<!-- layer24_moe_comm_from_expert9&#45;&gt;layer24_moe_aggregate -->
<g id="edge1465" class="edge">
<title>layer24_moe_comm_from_expert9&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M4517.5,-28472.58C4517.5,-28450.24 4517.5,-28423 4517.5,-28423 4517.5,-28423 4312.71,-28423 4312.71,-28423"/>
<polygon fill="black" stroke="black" points="4312.71,-28419.5 4302.71,-28423 4312.71,-28426.5 4312.71,-28419.5"/>
</g>
<!-- layer24_moe_comm_from_expert10&#45;&gt;layer24_moe_aggregate -->
<g id="edge1467" class="edge">
<title>layer24_moe_comm_from_expert10&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M4849.15,-28472.4C4849.15,-28445.66 4849.15,-28410 4849.15,-28410 4849.15,-28410 4299.07,-28410 4299.07,-28410"/>
<polygon fill="black" stroke="black" points="4299.07,-28406.5 4289.07,-28410 4299.07,-28413.5 4299.07,-28406.5"/>
</g>
<!-- layer24_moe_comm_from_expert11&#45;&gt;layer24_moe_aggregate -->
<g id="edge1469" class="edge">
<title>layer24_moe_comm_from_expert11&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M5195.65,-28472.79C5195.65,-28441.91 5195.65,-28397 5195.65,-28397 5195.65,-28397 4285.81,-28397 4285.81,-28397"/>
<polygon fill="black" stroke="black" points="4285.81,-28393.5 4275.81,-28397 4285.81,-28400.5 4285.81,-28393.5"/>
</g>
<!-- layer24_moe_comm_from_expert12&#45;&gt;layer24_moe_aggregate -->
<g id="edge1471" class="edge">
<title>layer24_moe_comm_from_expert12&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M5546.65,-28472.9C5546.65,-28438.18 5546.65,-28384 5546.65,-28384 5546.65,-28384 4272.33,-28384 4272.33,-28384"/>
<polygon fill="black" stroke="black" points="4272.33,-28380.5 4262.33,-28384 4272.33,-28387.5 4272.33,-28380.5"/>
</g>
<!-- layer24_moe_comm_from_expert13&#45;&gt;layer24_moe_aggregate -->
<g id="edge1473" class="edge">
<title>layer24_moe_comm_from_expert13&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M5900.15,-28472.7C5900.15,-28434.34 5900.15,-28371 5900.15,-28371 5900.15,-28371 4258.95,-28371 4258.95,-28371"/>
<polygon fill="black" stroke="black" points="4258.95,-28367.5 4248.95,-28371 4258.95,-28374.5 4258.95,-28367.5"/>
</g>
<!-- layer24_moe_comm_from_expert14&#45;&gt;layer24_moe_aggregate -->
<g id="edge1475" class="edge">
<title>layer24_moe_comm_from_expert14&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M6255.15,-28472.64C6255.15,-28430.82 6255.15,-28358 6255.15,-28358 6255.15,-28358 4245.53,-28358 4245.53,-28358"/>
<polygon fill="black" stroke="black" points="4245.53,-28354.5 4235.53,-28358 4245.53,-28361.5 4245.53,-28354.5"/>
</g>
<!-- layer24_moe_comm_from_expert15&#45;&gt;layer24_moe_aggregate -->
<g id="edge1477" class="edge">
<title>layer24_moe_comm_from_expert15&#45;&gt;layer24_moe_aggregate</title>
<path fill="none" stroke="black" d="M6610.15,-28472.62C6610.15,-28427.5 6610.15,-28345 6610.15,-28345 6610.15,-28345 4232.21,-28345 4232.21,-28345"/>
<polygon fill="black" stroke="black" points="4232.21,-28341.5 4222.21,-28345 4232.21,-28348.5 4232.21,-28341.5"/>
</g>
<!-- layer25_moe_gate -->
<g id="node1153" class="node">
<title>layer25_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4312.3,-28208.3 3901.4,-28208.3 3795.7,-28104.3 4206.6,-28104.3 4312.3,-28208.3"/>
<text text-anchor="middle" x="4054" y="-28170.3" font-family="Arial" font-size="10.00">GATE L25</text>
<text text-anchor="middle" x="4054" y="-28159.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4054" y="-28148.3" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4054" y="-28137.3" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer25_moe_mha&#45;&gt;layer25_moe_gate -->
<g id="edge1546" class="edge">
<title>layer25_moe_mha&#45;&gt;layer25_moe_gate</title>
<path fill="none" stroke="black" d="M4054,-28244.14C4054,-28244.14 4054,-28218.4 4054,-28218.4"/>
<polygon fill="black" stroke="black" points="4057.5,-28218.4 4054,-28208.4 4050.5,-28218.4 4057.5,-28218.4"/>
</g>
<!-- layer25_moe_split -->
<g id="node1154" class="node">
<title>layer25_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4308.01,-28068.3 3903.94,-28068.3 3799.99,-27964.3 4204.06,-27964.3 4308.01,-28068.3"/>
<text text-anchor="middle" x="4054" y="-28030.3" font-family="Arial" font-size="10.00">SPLIT TOKENS L25</text>
<text text-anchor="middle" x="4054" y="-28019.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4054" y="-28008.3" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4054" y="-27997.3" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer25_moe_gate&#45;&gt;layer25_moe_split -->
<g id="edge1547" class="edge">
<title>layer25_moe_gate&#45;&gt;layer25_moe_split</title>
<path fill="none" stroke="black" d="M4054,-28104.17C4054,-28104.17 4054,-28078.47 4054,-28078.47"/>
<polygon fill="black" stroke="black" points="4057.5,-28078.47 4054,-28068.47 4050.5,-28078.47 4057.5,-28078.47"/>
</g>
<!-- layer25_moe_comm_to_expert0 -->
<g id="node1156" class="node">
<title>layer25_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1618" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1618" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1618" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1618" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert0 -->
<g id="edge1481" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3888.47,-28053C3351.61,-28053 1693.25,-28053 1693.25,-28053 1693.25,-28053 1693.25,-27925.46 1693.25,-27925.46"/>
<polygon fill="black" stroke="black" points="1696.75,-27925.46 1693.25,-27915.46 1689.75,-27925.46 1696.75,-27925.46"/>
</g>
<!-- layer25_moe_comm_to_expert1 -->
<g id="node1158" class="node">
<title>layer25_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1890" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1890" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1890" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1890" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert1 -->
<g id="edge1483" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3873.25,-28038C3363.28,-28038 1950,-28038 1950,-28038 1950,-28038 1950,-27931.28 1950,-27931.28"/>
<polygon fill="black" stroke="black" points="1953.5,-27931.28 1950,-27921.28 1946.5,-27931.28 1953.5,-27931.28"/>
</g>
<!-- layer25_moe_comm_to_expert2 -->
<g id="node1160" class="node">
<title>layer25_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2211" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2211" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2211" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2211" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert2 -->
<g id="edge1485" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3858.26,-28023C3387.94,-28023 2233,-28023 2233,-28023 2233,-28023 2233,-27937.68 2233,-27937.68"/>
<polygon fill="black" stroke="black" points="2236.5,-27937.68 2233,-27927.68 2229.5,-27937.68 2236.5,-27937.68"/>
</g>
<!-- layer25_moe_comm_to_expert3 -->
<g id="node1162" class="node">
<title>layer25_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2777" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2777" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2777" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2777" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert3 -->
<g id="edge1487" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3843.67,-28008C3494.82,-28008 2834.51,-28008 2834.51,-28008 2834.51,-28008 2834.51,-27931.83 2834.51,-27931.83"/>
<polygon fill="black" stroke="black" points="2838.01,-27931.83 2834.51,-27921.83 2831.01,-27931.83 2838.01,-27931.83"/>
</g>
<!-- layer25_moe_comm_to_expert4 -->
<g id="node1164" class="node">
<title>layer25_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3160" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3160" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3160" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3160" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert4 -->
<g id="edge1489" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3829.66,-27994C3585.96,-27994 3231,-27994 3231,-27994 3231,-27994 3231,-27927.56 3231,-27927.56"/>
<polygon fill="black" stroke="black" points="3234.5,-27927.56 3231,-27917.56 3227.5,-27927.56 3234.5,-27927.56"/>
</g>
<!-- layer25_moe_comm_to_expert5 -->
<g id="node1166" class="node">
<title>layer25_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3451" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3451" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3451" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3451" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert5 -->
<g id="edge1491" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3814.44,-27979C3661.58,-27979 3492,-27979 3492,-27979 3492,-27979 3492,-27935.4 3492,-27935.4"/>
<polygon fill="black" stroke="black" points="3495.5,-27935.4 3492,-27925.4 3488.5,-27935.4 3495.5,-27935.4"/>
</g>
<!-- layer25_moe_comm_to_expert6 -->
<g id="node1168" class="node">
<title>layer25_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3696" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3696" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3696" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3696" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert6 -->
<g id="edge1493" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3813.74,-28016.21C3813.74,-28012.66 3813.74,-27899 3813.74,-27899 3813.74,-27899 3796.73,-27899 3796.73,-27899"/>
<polygon fill="black" stroke="black" points="3796.73,-27895.5 3786.73,-27899 3796.73,-27902.5 3796.73,-27895.5"/>
</g>
<!-- layer25_moe_comm_to_expert7 -->
<g id="node1170" class="node">
<title>layer25_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3918" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3918" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3918" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3918" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert7 -->
<g id="edge1495" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3918,-27963.96C3918,-27963.96 3918,-27938.52 3918,-27938.52"/>
<polygon fill="black" stroke="black" points="3921.5,-27938.52 3918,-27928.52 3914.5,-27938.52 3921.5,-27938.52"/>
</g>
<!-- layer25_moe_comm_to_expert8 -->
<g id="node1172" class="node">
<title>layer25_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4190" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4190" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4190" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4190" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert8 -->
<g id="edge1497" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4190,-27963.96C4190,-27963.96 4190,-27938.52 4190,-27938.52"/>
<polygon fill="black" stroke="black" points="4193.5,-27938.52 4190,-27928.52 4186.5,-27938.52 4193.5,-27938.52"/>
</g>
<!-- layer25_moe_comm_to_expert9 -->
<g id="node1174" class="node">
<title>layer25_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4499" cy="-27899.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4499" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4499" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4499" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert9 -->
<g id="edge1499" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4294.26,-28016.21C4294.26,-28012.66 4294.26,-27899 4294.26,-27899 4294.26,-27899 4398.3,-27899 4398.3,-27899"/>
<polygon fill="black" stroke="black" points="4398.3,-27902.5 4408.3,-27899 4398.3,-27895.5 4398.3,-27902.5"/>
</g>
<!-- layer25_moe_comm_to_expert10 -->
<g id="node1176" class="node">
<title>layer25_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4831" cy="-27899.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4831" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4831" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4831" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert10 -->
<g id="edge1501" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4218.82,-27979C4426.07,-27979 4755.1,-27979 4755.1,-27979 4755.1,-27979 4755.1,-27926.6 4755.1,-27926.6"/>
<polygon fill="black" stroke="black" points="4758.6,-27926.6 4755.1,-27916.6 4751.6,-27926.6 4758.6,-27926.6"/>
</g>
<!-- layer25_moe_comm_to_expert11 -->
<g id="node1178" class="node">
<title>layer25_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5177" cy="-27899.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5177" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5177" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5177" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert11 -->
<g id="edge1503" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4233.79,-27994C4533.24,-27994 5101.6,-27994 5101.6,-27994 5101.6,-27994 5101.6,-27926.67 5101.6,-27926.67"/>
<polygon fill="black" stroke="black" points="5105.1,-27926.67 5101.6,-27916.67 5098.1,-27926.67 5105.1,-27926.67"/>
</g>
<!-- layer25_moe_comm_to_expert12 -->
<g id="node1180" class="node">
<title>layer25_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5528" cy="-27899.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5528" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5528" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5528" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert12 -->
<g id="edge1505" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4248.1,-28008C4632.24,-28008 5452.6,-28008 5452.6,-28008 5452.6,-28008 5452.6,-27926.77 5452.6,-27926.77"/>
<polygon fill="black" stroke="black" points="5456.1,-27926.77 5452.6,-27916.77 5449.1,-27926.77 5456.1,-27926.77"/>
</g>
<!-- layer25_moe_comm_to_expert13 -->
<g id="node1182" class="node">
<title>layer25_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5881" cy="-27899.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5881" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5881" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5881" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert13 -->
<g id="edge1507" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4262.74,-28023C4727.33,-28023 5806.1,-28023 5806.1,-28023 5806.1,-28023 5806.1,-27927.03 5806.1,-27927.03"/>
<polygon fill="black" stroke="black" points="5809.6,-27927.03 5806.1,-27917.03 5802.6,-27927.03 5809.6,-27927.03"/>
</g>
<!-- layer25_moe_comm_to_expert14 -->
<g id="node1184" class="node">
<title>layer25_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6236" cy="-27899.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6236" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6236" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6236" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert14 -->
<g id="edge1509" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4278,-28038C4820.61,-28038 6161.1,-28038 6161.1,-28038 6161.1,-28038 6161.1,-27926.87 6161.1,-27926.87"/>
<polygon fill="black" stroke="black" points="6164.6,-27926.87 6161.1,-27916.87 6157.6,-27926.87 6164.6,-27926.87"/>
</g>
<!-- layer25_moe_comm_to_expert15 -->
<g id="node1186" class="node">
<title>layer25_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6591" cy="-27899.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6591" y="-27907.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6591" y="-27896.81" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6591" y="-27885.81" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert15 -->
<g id="edge1511" class="edge">
<title>layer25_moe_split&#45;&gt;layer25_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4292.87,-28053C4911.18,-28053 6516.1,-28053 6516.1,-28053 6516.1,-28053 6516.1,-27926.94 6516.1,-27926.94"/>
<polygon fill="black" stroke="black" points="6519.6,-27926.94 6516.1,-27916.94 6512.6,-27926.94 6519.6,-27926.94"/>
</g>
<!-- layer25_moe_expert0 -->
<g id="node1155" class="node">
<title>layer25_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1623,-27834.31 1295,-27834.31 1295,-27782.31 1623,-27782.31 1623,-27834.31"/>
<text text-anchor="middle" x="1459" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 0 L25</text>
<text text-anchor="middle" x="1459" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1459" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1459" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert0 -->
<g id="node1188" class="node">
<title>layer25_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1505" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1505" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1505" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1505" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer25_moe_expert0&#45;&gt;layer25_moe_comm_from_expert0 -->
<g id="edge1513" class="edge">
<title>layer25_moe_expert0&#45;&gt;layer25_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1505,-27782C1505,-27782 1505,-27756.45 1505,-27756.45"/>
<polygon fill="black" stroke="black" points="1508.5,-27756.45 1505,-27746.45 1501.5,-27756.45 1508.5,-27756.45"/>
</g>
<!-- layer25_moe_comm_to_expert0&#45;&gt;layer25_moe_expert0 -->
<g id="edge1482" class="edge">
<title>layer25_moe_comm_to_expert0&#45;&gt;layer25_moe_expert0</title>
<path fill="none" stroke="black" d="M1575.25,-27873.48C1575.25,-27873.48 1575.25,-27844.53 1575.25,-27844.53"/>
<polygon fill="black" stroke="black" points="1578.75,-27844.53 1575.25,-27834.53 1571.75,-27844.53 1578.75,-27844.53"/>
</g>
<!-- layer25_moe_expert1 -->
<g id="node1157" class="node">
<title>layer25_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1969,-27834.31 1641,-27834.31 1641,-27782.31 1969,-27782.31 1969,-27834.31"/>
<text text-anchor="middle" x="1805" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 1 L25</text>
<text text-anchor="middle" x="1805" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1805" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1805" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert1 -->
<g id="node1189" class="node">
<title>layer25_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2218" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2218" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2218" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2218" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer25_moe_expert1&#45;&gt;layer25_moe_comm_from_expert1 -->
<g id="edge1515" class="edge">
<title>layer25_moe_expert1&#45;&gt;layer25_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1959.5,-27781.9C1959.5,-27754.93 1959.5,-27717 1959.5,-27717 1959.5,-27717 2117.23,-27717 2117.23,-27717"/>
<polygon fill="black" stroke="black" points="2117.23,-27720.5 2127.23,-27717 2117.23,-27713.5 2117.23,-27720.5"/>
</g>
<!-- layer25_moe_comm_to_expert1&#45;&gt;layer25_moe_expert1 -->
<g id="edge1484" class="edge">
<title>layer25_moe_comm_to_expert1&#45;&gt;layer25_moe_expert1</title>
<path fill="none" stroke="black" d="M1884.25,-27870.27C1884.25,-27870.27 1884.25,-27844.62 1884.25,-27844.62"/>
<polygon fill="black" stroke="black" points="1887.75,-27844.62 1884.25,-27834.62 1880.75,-27844.62 1887.75,-27844.62"/>
</g>
<!-- layer25_moe_expert2 -->
<g id="node1159" class="node">
<title>layer25_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2315,-27834.31 1987,-27834.31 1987,-27782.31 2315,-27782.31 2315,-27834.31"/>
<text text-anchor="middle" x="2151" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 2 L25</text>
<text text-anchor="middle" x="2151" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2151" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2151" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert2 -->
<g id="node1190" class="node">
<title>layer25_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2674" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2674" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2674" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2674" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer25_moe_expert2&#45;&gt;layer25_moe_comm_from_expert2 -->
<g id="edge1517" class="edge">
<title>layer25_moe_expert2&#45;&gt;layer25_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2315.18,-27808C2320.77,-27808 2324,-27808 2324,-27808 2324,-27808 2324,-27717 2324,-27717 2324,-27717 2573.41,-27717 2573.41,-27717"/>
<polygon fill="black" stroke="black" points="2573.41,-27720.5 2583.41,-27717 2573.41,-27713.5 2573.41,-27720.5"/>
</g>
<!-- layer25_moe_comm_to_expert2&#45;&gt;layer25_moe_expert2 -->
<g id="edge1486" class="edge">
<title>layer25_moe_comm_to_expert2&#45;&gt;layer25_moe_expert2</title>
<path fill="none" stroke="black" d="M2211,-27870.27C2211,-27870.27 2211,-27844.62 2211,-27844.62"/>
<polygon fill="black" stroke="black" points="2214.5,-27844.62 2211,-27834.62 2207.5,-27844.62 2214.5,-27844.62"/>
</g>
<!-- layer25_moe_expert3 -->
<g id="node1161" class="node">
<title>layer25_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2661,-27834.31 2333,-27834.31 2333,-27782.31 2661,-27782.31 2661,-27834.31"/>
<text text-anchor="middle" x="2497" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 3 L25</text>
<text text-anchor="middle" x="2497" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2497" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2497" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert3 -->
<g id="node1191" class="node">
<title>layer25_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="3002" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3002" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="3002" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3002" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer25_moe_expert3&#45;&gt;layer25_moe_comm_from_expert3 -->
<g id="edge1519" class="edge">
<title>layer25_moe_expert3&#45;&gt;layer25_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2622.25,-27782.27C2622.25,-27770 2622.25,-27758 2622.25,-27758 2622.25,-27758 2943.33,-27758 2943.33,-27758 2943.33,-27758 2943.33,-27749.57 2943.33,-27749.57"/>
<polygon fill="black" stroke="black" points="2946.83,-27749.57 2943.33,-27739.57 2939.83,-27749.57 2946.83,-27749.57"/>
</g>
<!-- layer25_moe_comm_to_expert3&#45;&gt;layer25_moe_expert3 -->
<g id="edge1488" class="edge">
<title>layer25_moe_comm_to_expert3&#45;&gt;layer25_moe_expert3</title>
<path fill="none" stroke="black" d="M2686.5,-27899C2661.33,-27899 2640.75,-27899 2640.75,-27899 2640.75,-27899 2640.75,-27844.54 2640.75,-27844.54"/>
<polygon fill="black" stroke="black" points="2644.25,-27844.54 2640.75,-27834.54 2637.25,-27844.54 2644.25,-27844.54"/>
</g>
<!-- layer25_moe_expert4 -->
<g id="node1163" class="node">
<title>layer25_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="3007,-27834.31 2679,-27834.31 2679,-27782.31 3007,-27782.31 3007,-27834.31"/>
<text text-anchor="middle" x="2843" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 4 L25</text>
<text text-anchor="middle" x="2843" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2843" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2843" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert4 -->
<g id="node1192" class="node">
<title>layer25_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3265" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3265" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3265" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3265" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer25_moe_expert4&#45;&gt;layer25_moe_comm_from_expert4 -->
<g id="edge1521" class="edge">
<title>layer25_moe_expert4&#45;&gt;layer25_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2975.16,-27782.12C2975.16,-27775.39 2975.16,-27770 2975.16,-27770 2975.16,-27770 3263.75,-27770 3263.75,-27770 3263.75,-27770 3263.75,-27756.43 3263.75,-27756.43"/>
<polygon fill="black" stroke="black" points="3267.25,-27756.43 3263.75,-27746.43 3260.25,-27756.44 3267.25,-27756.43"/>
</g>
<!-- layer25_moe_comm_to_expert4&#45;&gt;layer25_moe_expert4 -->
<g id="edge1490" class="edge">
<title>layer25_moe_comm_to_expert4&#45;&gt;layer25_moe_expert4</title>
<path fill="none" stroke="black" d="M3069.41,-27899C3023.67,-27899 2977.75,-27899 2977.75,-27899 2977.75,-27899 2977.75,-27844.54 2977.75,-27844.54"/>
<polygon fill="black" stroke="black" points="2981.25,-27844.54 2977.75,-27834.54 2974.25,-27844.54 2981.25,-27844.54"/>
</g>
<!-- layer25_moe_expert5 -->
<g id="node1165" class="node">
<title>layer25_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3353,-27834.31 3025,-27834.31 3025,-27782.31 3353,-27782.31 3353,-27834.31"/>
<text text-anchor="middle" x="3189" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 5 L25</text>
<text text-anchor="middle" x="3189" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3189" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3189" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert5 -->
<g id="node1193" class="node">
<title>layer25_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3496" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3496" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3496" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3496" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer25_moe_expert5&#45;&gt;layer25_moe_comm_from_expert5 -->
<g id="edge1523" class="edge">
<title>layer25_moe_expert5&#45;&gt;layer25_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3353.04,-27799C3359.42,-27799 3363.16,-27799 3363.16,-27799 3363.16,-27799 3363.16,-27717 3363.16,-27717 3363.16,-27717 3395.19,-27717 3395.19,-27717"/>
<polygon fill="black" stroke="black" points="3395.19,-27720.5 3405.19,-27717 3395.19,-27713.5 3395.19,-27720.5"/>
</g>
<!-- layer25_moe_comm_to_expert5&#45;&gt;layer25_moe_expert5 -->
<g id="edge1492" class="edge">
<title>layer25_moe_comm_to_expert5&#45;&gt;layer25_moe_expert5</title>
<path fill="none" stroke="black" d="M3365.82,-27889.42C3365.82,-27867.36 3365.82,-27816 3365.82,-27816 3365.82,-27816 3363.11,-27816 3363.11,-27816"/>
<polygon fill="black" stroke="black" points="3363.11,-27812.5 3353.11,-27816 3363.11,-27819.5 3363.11,-27812.5"/>
</g>
<!-- layer25_moe_expert6 -->
<g id="node1167" class="node">
<title>layer25_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3699,-27834.31 3371,-27834.31 3371,-27782.31 3699,-27782.31 3699,-27834.31"/>
<text text-anchor="middle" x="3535" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 6 L25</text>
<text text-anchor="middle" x="3535" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3535" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3535" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert6 -->
<g id="node1194" class="node">
<title>layer25_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3711" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3711" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3711" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3711" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer25_moe_expert6&#45;&gt;layer25_moe_comm_from_expert6 -->
<g id="edge1525" class="edge">
<title>layer25_moe_expert6&#45;&gt;layer25_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3659.75,-27782C3659.75,-27782 3659.75,-27751.41 3659.75,-27751.41"/>
<polygon fill="black" stroke="black" points="3663.25,-27751.41 3659.75,-27741.41 3656.25,-27751.41 3663.25,-27751.41"/>
</g>
<!-- layer25_moe_comm_to_expert6&#45;&gt;layer25_moe_expert6 -->
<g id="edge1494" class="edge">
<title>layer25_moe_comm_to_expert6&#45;&gt;layer25_moe_expert6</title>
<path fill="none" stroke="black" d="M3652.25,-27873.48C3652.25,-27873.48 3652.25,-27844.53 3652.25,-27844.53"/>
<polygon fill="black" stroke="black" points="3655.75,-27844.53 3652.25,-27834.53 3648.75,-27844.53 3655.75,-27844.53"/>
</g>
<!-- layer25_moe_expert7 -->
<g id="node1169" class="node">
<title>layer25_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4045,-27834.31 3717,-27834.31 3717,-27782.31 4045,-27782.31 4045,-27834.31"/>
<text text-anchor="middle" x="3881" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 7 L25</text>
<text text-anchor="middle" x="3881" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3881" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3881" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert7 -->
<g id="node1195" class="node">
<title>layer25_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3918" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3918" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3918" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3918" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer25_moe_expert7&#45;&gt;layer25_moe_comm_from_expert7 -->
<g id="edge1527" class="edge">
<title>layer25_moe_expert7&#45;&gt;layer25_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3918,-27782C3918,-27782 3918,-27756.45 3918,-27756.45"/>
<polygon fill="black" stroke="black" points="3921.5,-27756.45 3918,-27746.45 3914.5,-27756.45 3921.5,-27756.45"/>
</g>
<!-- layer25_moe_comm_to_expert7&#45;&gt;layer25_moe_expert7 -->
<g id="edge1496" class="edge">
<title>layer25_moe_comm_to_expert7&#45;&gt;layer25_moe_expert7</title>
<path fill="none" stroke="black" d="M3918,-27870.27C3918,-27870.27 3918,-27844.62 3918,-27844.62"/>
<polygon fill="black" stroke="black" points="3921.5,-27844.62 3918,-27834.62 3914.5,-27844.62 3921.5,-27844.62"/>
</g>
<!-- layer25_moe_expert8 -->
<g id="node1171" class="node">
<title>layer25_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4391,-27834.31 4063,-27834.31 4063,-27782.31 4391,-27782.31 4391,-27834.31"/>
<text text-anchor="middle" x="4227" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 8 L25</text>
<text text-anchor="middle" x="4227" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4227" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4227" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert8 -->
<g id="node1196" class="node">
<title>layer25_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4190" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4190" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4190" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4190" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer25_moe_expert8&#45;&gt;layer25_moe_comm_from_expert8 -->
<g id="edge1529" class="edge">
<title>layer25_moe_expert8&#45;&gt;layer25_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4190,-27782C4190,-27782 4190,-27756.45 4190,-27756.45"/>
<polygon fill="black" stroke="black" points="4193.5,-27756.45 4190,-27746.45 4186.5,-27756.45 4193.5,-27756.45"/>
</g>
<!-- layer25_moe_comm_to_expert8&#45;&gt;layer25_moe_expert8 -->
<g id="edge1498" class="edge">
<title>layer25_moe_comm_to_expert8&#45;&gt;layer25_moe_expert8</title>
<path fill="none" stroke="black" d="M4190,-27870.27C4190,-27870.27 4190,-27844.62 4190,-27844.62"/>
<polygon fill="black" stroke="black" points="4193.5,-27844.62 4190,-27834.62 4186.5,-27844.62 4193.5,-27844.62"/>
</g>
<!-- layer25_moe_expert9 -->
<g id="node1173" class="node">
<title>layer25_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4737,-27834.31 4409,-27834.31 4409,-27782.31 4737,-27782.31 4737,-27834.31"/>
<text text-anchor="middle" x="4573" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 9 L25</text>
<text text-anchor="middle" x="4573" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4573" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4573" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert9 -->
<g id="node1197" class="node">
<title>layer25_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4499" cy="-27717.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4499" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4499" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4499" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer25_moe_expert9&#45;&gt;layer25_moe_comm_from_expert9 -->
<g id="edge1531" class="edge">
<title>layer25_moe_expert9&#45;&gt;layer25_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4499.25,-27782C4499.25,-27782 4499.25,-27756.45 4499.25,-27756.45"/>
<polygon fill="black" stroke="black" points="4502.75,-27756.45 4499.25,-27746.45 4495.75,-27756.45 4502.75,-27756.45"/>
</g>
<!-- layer25_moe_comm_to_expert9&#45;&gt;layer25_moe_expert9 -->
<g id="edge1500" class="edge">
<title>layer25_moe_comm_to_expert9&#45;&gt;layer25_moe_expert9</title>
<path fill="none" stroke="black" d="M4499.25,-27870.27C4499.25,-27870.27 4499.25,-27844.62 4499.25,-27844.62"/>
<polygon fill="black" stroke="black" points="4502.75,-27844.62 4499.25,-27834.62 4495.75,-27844.62 4502.75,-27844.62"/>
</g>
<!-- layer25_moe_expert10 -->
<g id="node1175" class="node">
<title>layer25_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5093,-27834.31 4755,-27834.31 4755,-27782.31 5093,-27782.31 5093,-27834.31"/>
<text text-anchor="middle" x="4924" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 10 L25</text>
<text text-anchor="middle" x="4924" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4924" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4924" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert10 -->
<g id="node1198" class="node">
<title>layer25_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4831" cy="-27717.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4831" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4831" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4831" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer25_moe_expert10&#45;&gt;layer25_moe_comm_from_expert10 -->
<g id="edge1533" class="edge">
<title>layer25_moe_expert10&#45;&gt;layer25_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4840.38,-27782C4840.38,-27782 4840.38,-27756.45 4840.38,-27756.45"/>
<polygon fill="black" stroke="black" points="4843.88,-27756.45 4840.38,-27746.45 4836.88,-27756.45 4843.88,-27756.45"/>
</g>
<!-- layer25_moe_comm_to_expert10&#45;&gt;layer25_moe_expert10 -->
<g id="edge1502" class="edge">
<title>layer25_moe_comm_to_expert10&#45;&gt;layer25_moe_expert10</title>
<path fill="none" stroke="black" d="M4840.02,-27870.27C4840.02,-27870.27 4840.02,-27844.62 4840.02,-27844.62"/>
<polygon fill="black" stroke="black" points="4843.52,-27844.62 4840.02,-27834.62 4836.52,-27844.62 4843.52,-27844.62"/>
</g>
<!-- layer25_moe_expert11 -->
<g id="node1177" class="node">
<title>layer25_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5449,-27834.31 5111,-27834.31 5111,-27782.31 5449,-27782.31 5449,-27834.31"/>
<text text-anchor="middle" x="5280" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 11 L25</text>
<text text-anchor="middle" x="5280" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5280" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5280" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert11 -->
<g id="node1199" class="node">
<title>layer25_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5178" cy="-27717.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5178" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5178" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5178" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer25_moe_expert11&#45;&gt;layer25_moe_comm_from_expert11 -->
<g id="edge1535" class="edge">
<title>layer25_moe_expert11&#45;&gt;layer25_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5191.88,-27782C5191.88,-27782 5191.88,-27756.13 5191.88,-27756.13"/>
<polygon fill="black" stroke="black" points="5195.38,-27756.13 5191.88,-27746.13 5188.38,-27756.13 5195.38,-27756.13"/>
</g>
<!-- layer25_moe_comm_to_expert11&#45;&gt;layer25_moe_expert11 -->
<g id="edge1504" class="edge">
<title>layer25_moe_comm_to_expert11&#45;&gt;layer25_moe_expert11</title>
<path fill="none" stroke="black" d="M5191.02,-27870.52C5191.02,-27870.52 5191.02,-27844.45 5191.02,-27844.45"/>
<polygon fill="black" stroke="black" points="5194.52,-27844.45 5191.02,-27834.45 5187.52,-27844.45 5194.52,-27844.45"/>
</g>
<!-- layer25_moe_expert12 -->
<g id="node1179" class="node">
<title>layer25_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5805,-27834.31 5467,-27834.31 5467,-27782.31 5805,-27782.31 5805,-27834.31"/>
<text text-anchor="middle" x="5636" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 12 L25</text>
<text text-anchor="middle" x="5636" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5636" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5636" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert12 -->
<g id="node1200" class="node">
<title>layer25_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5529" cy="-27717.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5529" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5529" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5529" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer25_moe_expert12&#45;&gt;layer25_moe_comm_from_expert12 -->
<g id="edge1537" class="edge">
<title>layer25_moe_expert12&#45;&gt;layer25_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5545.38,-27782C5545.38,-27782 5545.38,-27756.13 5545.38,-27756.13"/>
<polygon fill="black" stroke="black" points="5548.88,-27756.13 5545.38,-27746.13 5541.88,-27756.13 5548.88,-27756.13"/>
</g>
<!-- layer25_moe_comm_to_expert12&#45;&gt;layer25_moe_expert12 -->
<g id="edge1506" class="edge">
<title>layer25_moe_comm_to_expert12&#45;&gt;layer25_moe_expert12</title>
<path fill="none" stroke="black" d="M5544.52,-27870.52C5544.52,-27870.52 5544.52,-27844.45 5544.52,-27844.45"/>
<polygon fill="black" stroke="black" points="5548.02,-27844.45 5544.52,-27834.45 5541.02,-27844.45 5548.02,-27844.45"/>
</g>
<!-- layer25_moe_expert13 -->
<g id="node1181" class="node">
<title>layer25_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6161,-27834.31 5823,-27834.31 5823,-27782.31 6161,-27782.31 6161,-27834.31"/>
<text text-anchor="middle" x="5992" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 13 L25</text>
<text text-anchor="middle" x="5992" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5992" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5992" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert13 -->
<g id="node1201" class="node">
<title>layer25_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5883" cy="-27717.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5883" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5883" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5883" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer25_moe_expert13&#45;&gt;layer25_moe_comm_from_expert13 -->
<g id="edge1539" class="edge">
<title>layer25_moe_expert13&#45;&gt;layer25_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5900.38,-27782C5900.38,-27782 5900.38,-27756.13 5900.38,-27756.13"/>
<polygon fill="black" stroke="black" points="5903.88,-27756.13 5900.38,-27746.13 5896.88,-27756.13 5903.88,-27756.13"/>
</g>
<!-- layer25_moe_comm_to_expert13&#45;&gt;layer25_moe_expert13 -->
<g id="edge1508" class="edge">
<title>layer25_moe_comm_to_expert13&#45;&gt;layer25_moe_expert13</title>
<path fill="none" stroke="black" d="M5899.02,-27870.52C5899.02,-27870.52 5899.02,-27844.45 5899.02,-27844.45"/>
<polygon fill="black" stroke="black" points="5902.52,-27844.45 5899.02,-27834.45 5895.52,-27844.45 5902.52,-27844.45"/>
</g>
<!-- layer25_moe_expert14 -->
<g id="node1183" class="node">
<title>layer25_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6517,-27834.31 6179,-27834.31 6179,-27782.31 6517,-27782.31 6517,-27834.31"/>
<text text-anchor="middle" x="6348" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 14 L25</text>
<text text-anchor="middle" x="6348" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6348" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6348" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert14 -->
<g id="node1202" class="node">
<title>layer25_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6238" cy="-27717.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6238" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6238" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6238" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer25_moe_expert14&#45;&gt;layer25_moe_comm_from_expert14 -->
<g id="edge1541" class="edge">
<title>layer25_moe_expert14&#45;&gt;layer25_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6255.88,-27782C6255.88,-27782 6255.88,-27755.81 6255.88,-27755.81"/>
<polygon fill="black" stroke="black" points="6259.38,-27755.81 6255.88,-27745.81 6252.38,-27755.81 6259.38,-27755.81"/>
</g>
<!-- layer25_moe_comm_to_expert14&#45;&gt;layer25_moe_expert14 -->
<g id="edge1510" class="edge">
<title>layer25_moe_comm_to_expert14&#45;&gt;layer25_moe_expert14</title>
<path fill="none" stroke="black" d="M6254.52,-27870.52C6254.52,-27870.52 6254.52,-27844.45 6254.52,-27844.45"/>
<polygon fill="black" stroke="black" points="6258.02,-27844.45 6254.52,-27834.45 6251.02,-27844.45 6258.02,-27844.45"/>
</g>
<!-- layer25_moe_expert15 -->
<g id="node1185" class="node">
<title>layer25_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6873,-27834.31 6535,-27834.31 6535,-27782.31 6873,-27782.31 6873,-27834.31"/>
<text text-anchor="middle" x="6704" y="-27822.31" font-family="Arial" font-size="10.00">EXPERT 15 L25</text>
<text text-anchor="middle" x="6704" y="-27811.31" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6704" y="-27800.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6704" y="-27789.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_comm_from_expert15 -->
<g id="node1203" class="node">
<title>layer25_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6593" cy="-27717.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6593" y="-27725.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6593" y="-27714.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6593" y="-27703.82" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer25_moe_expert15&#45;&gt;layer25_moe_comm_from_expert15 -->
<g id="edge1543" class="edge">
<title>layer25_moe_expert15&#45;&gt;layer25_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6611.38,-27782C6611.38,-27782 6611.38,-27755.81 6611.38,-27755.81"/>
<polygon fill="black" stroke="black" points="6614.88,-27755.81 6611.38,-27745.81 6607.88,-27755.81 6614.88,-27755.81"/>
</g>
<!-- layer25_moe_comm_to_expert15&#45;&gt;layer25_moe_expert15 -->
<g id="edge1512" class="edge">
<title>layer25_moe_comm_to_expert15&#45;&gt;layer25_moe_expert15</title>
<path fill="none" stroke="black" d="M6610.02,-27870.52C6610.02,-27870.52 6610.02,-27844.45 6610.02,-27844.45"/>
<polygon fill="black" stroke="black" points="6613.52,-27844.45 6610.02,-27834.45 6606.52,-27844.45 6613.52,-27844.45"/>
</g>
<!-- layer25_moe_aggregate -->
<g id="node1187" class="node">
<title>layer25_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4279.1,-27652.33 3862.16,-27652.33 3754.9,-27548.33 4171.84,-27548.33 4279.1,-27652.33"/>
<text text-anchor="middle" x="4017" y="-27614.33" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L25</text>
<text text-anchor="middle" x="4017" y="-27603.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4017" y="-27592.33" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="4017" y="-27581.33" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_mha -->
<g id="node1204" class="node">
<title>layer26_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4147,-27512.33 3887,-27512.33 3887,-27460.33 4147,-27460.33 4147,-27512.33"/>
<text text-anchor="middle" x="4017" y="-27500.33" font-family="Arial" font-size="10.00">MHA L26</text>
<text text-anchor="middle" x="4017" y="-27489.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4017" y="-27478.33" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4017" y="-27467.33" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer25_moe_aggregate&#45;&gt;layer26_moe_mha -->
<g id="edge1612" class="edge">
<title>layer25_moe_aggregate&#45;&gt;layer26_moe_mha</title>
<path fill="none" stroke="black" d="M4017,-27548C4017,-27548 4017,-27522.56 4017,-27522.56"/>
<polygon fill="black" stroke="black" points="4020.5,-27522.56 4017,-27512.56 4013.5,-27522.56 4020.5,-27522.56"/>
</g>
<!-- layer25_moe_comm_from_expert0&#45;&gt;layer25_moe_aggregate -->
<g id="edge1514" class="edge">
<title>layer25_moe_comm_from_expert0&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M1590.75,-27707.67C1590.75,-27673.88 1590.75,-27563 1590.75,-27563 1590.75,-27563 3759.88,-27563 3759.88,-27563"/>
<polygon fill="black" stroke="black" points="3759.88,-27566.5 3769.88,-27563 3759.88,-27559.5 3759.88,-27566.5"/>
</g>
<!-- layer25_moe_comm_from_expert1&#45;&gt;layer25_moe_aggregate -->
<g id="edge1516" class="edge">
<title>layer25_moe_comm_from_expert1&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M2302.25,-27706.39C2302.25,-27673.55 2302.25,-27578 2302.25,-27578 2302.25,-27578 3775.3,-27578 3775.3,-27578"/>
<polygon fill="black" stroke="black" points="3775.3,-27581.5 3785.3,-27578 3775.3,-27574.5 3775.3,-27581.5"/>
</g>
<!-- layer25_moe_comm_from_expert2&#45;&gt;layer25_moe_aggregate -->
<g id="edge1518" class="edge">
<title>layer25_moe_comm_from_expert2&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M2746.01,-27699.63C2746.01,-27665.09 2746.01,-27592 2746.01,-27592 2746.01,-27592 3789.59,-27592 3789.59,-27592"/>
<polygon fill="black" stroke="black" points="3789.59,-27595.5 3799.59,-27592 3789.59,-27588.5 3789.59,-27595.5"/>
</g>
<!-- layer25_moe_comm_from_expert3&#45;&gt;layer25_moe_aggregate -->
<g id="edge1520" class="edge">
<title>layer25_moe_comm_from_expert3&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M3074.01,-27699.6C3074.01,-27668.41 3074.01,-27607 3074.01,-27607 3074.01,-27607 3805.28,-27607 3805.28,-27607"/>
<polygon fill="black" stroke="black" points="3805.28,-27610.5 3815.28,-27607 3805.28,-27603.5 3805.28,-27610.5"/>
</g>
<!-- layer25_moe_comm_from_expert4&#45;&gt;layer25_moe_aggregate -->
<g id="edge1522" class="edge">
<title>layer25_moe_comm_from_expert4&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M3344.75,-27703.26C3344.75,-27676.74 3344.75,-27622 3344.75,-27622 3344.75,-27622 3820.63,-27622 3820.63,-27622"/>
<polygon fill="black" stroke="black" points="3820.64,-27625.5 3830.63,-27622 3820.63,-27618.5 3820.64,-27625.5"/>
</g>
<!-- layer25_moe_comm_from_expert5&#45;&gt;layer25_moe_aggregate -->
<g id="edge1524" class="edge">
<title>layer25_moe_comm_from_expert5&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M3566.5,-27699.1C3566.5,-27675.4 3566.5,-27637 3566.5,-27637 3566.5,-27637 3836.04,-27637 3836.04,-27637"/>
<polygon fill="black" stroke="black" points="3836.04,-27640.5 3846.04,-27637 3836.04,-27633.5 3836.04,-27640.5"/>
</g>
<!-- layer25_moe_comm_from_expert6&#45;&gt;layer25_moe_aggregate -->
<g id="edge1526" class="edge">
<title>layer25_moe_comm_from_expert6&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M3778.11,-27697.74C3778.11,-27697.74 3778.11,-27610.38 3778.11,-27610.38"/>
<polygon fill="black" stroke="black" points="3781.61,-27610.38 3778.11,-27600.38 3774.61,-27610.38 3781.61,-27610.38"/>
</g>
<!-- layer25_moe_comm_from_expert7&#45;&gt;layer25_moe_aggregate -->
<g id="edge1528" class="edge">
<title>layer25_moe_comm_from_expert7&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M3918,-27688.1C3918,-27688.1 3918,-27662.39 3918,-27662.39"/>
<polygon fill="black" stroke="black" points="3921.5,-27662.39 3918,-27652.39 3914.5,-27662.39 3921.5,-27662.39"/>
</g>
<!-- layer25_moe_comm_from_expert8&#45;&gt;layer25_moe_aggregate -->
<g id="edge1530" class="edge">
<title>layer25_moe_comm_from_expert8&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M4189.39,-27688.1C4189.39,-27688.1 4189.39,-27662.39 4189.39,-27662.39"/>
<polygon fill="black" stroke="black" points="4192.89,-27662.39 4189.39,-27652.39 4185.89,-27662.39 4192.89,-27662.39"/>
</g>
<!-- layer25_moe_comm_from_expert9&#45;&gt;layer25_moe_aggregate -->
<g id="edge1532" class="edge">
<title>layer25_moe_comm_from_expert9&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M4480.5,-27688.6C4480.5,-27666.25 4480.5,-27639 4480.5,-27639 4480.5,-27639 4275.37,-27639 4275.37,-27639"/>
<polygon fill="black" stroke="black" points="4275.37,-27635.5 4265.37,-27639 4275.37,-27642.5 4275.37,-27635.5"/>
</g>
<!-- layer25_moe_comm_from_expert10&#45;&gt;layer25_moe_aggregate -->
<g id="edge1534" class="edge">
<title>layer25_moe_comm_from_expert10&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M4812.15,-27688.43C4812.15,-27661.67 4812.15,-27626 4812.15,-27626 4812.15,-27626 4262.07,-27626 4262.07,-27626"/>
<polygon fill="black" stroke="black" points="4262.07,-27622.5 4252.07,-27626 4262.07,-27629.5 4262.07,-27622.5"/>
</g>
<!-- layer25_moe_comm_from_expert11&#45;&gt;layer25_moe_aggregate -->
<g id="edge1536" class="edge">
<title>layer25_moe_comm_from_expert11&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M5158.65,-27688.82C5158.65,-27657.93 5158.65,-27613 5158.65,-27613 5158.65,-27613 4248.81,-27613 4248.81,-27613"/>
<polygon fill="black" stroke="black" points="4248.81,-27609.5 4238.81,-27613 4248.81,-27616.5 4248.81,-27609.5"/>
</g>
<!-- layer25_moe_comm_from_expert12&#45;&gt;layer25_moe_aggregate -->
<g id="edge1538" class="edge">
<title>layer25_moe_comm_from_expert12&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M5509.65,-27688.92C5509.65,-27654.2 5509.65,-27600 5509.65,-27600 5509.65,-27600 4235.33,-27600 4235.33,-27600"/>
<polygon fill="black" stroke="black" points="4235.33,-27596.5 4225.33,-27600 4235.33,-27603.5 4235.33,-27596.5"/>
</g>
<!-- layer25_moe_comm_from_expert13&#45;&gt;layer25_moe_aggregate -->
<g id="edge1540" class="edge">
<title>layer25_moe_comm_from_expert13&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M5863.15,-27688.72C5863.15,-27650.36 5863.15,-27587 5863.15,-27587 5863.15,-27587 4221.95,-27587 4221.95,-27587"/>
<polygon fill="black" stroke="black" points="4221.95,-27583.5 4211.95,-27587 4221.95,-27590.5 4221.95,-27583.5"/>
</g>
<!-- layer25_moe_comm_from_expert14&#45;&gt;layer25_moe_aggregate -->
<g id="edge1542" class="edge">
<title>layer25_moe_comm_from_expert14&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M6218.15,-27688.66C6218.15,-27646.84 6218.15,-27574 6218.15,-27574 6218.15,-27574 4208.53,-27574 4208.53,-27574"/>
<polygon fill="black" stroke="black" points="4208.53,-27570.5 4198.53,-27574 4208.53,-27577.5 4208.53,-27570.5"/>
</g>
<!-- layer25_moe_comm_from_expert15&#45;&gt;layer25_moe_aggregate -->
<g id="edge1544" class="edge">
<title>layer25_moe_comm_from_expert15&#45;&gt;layer25_moe_aggregate</title>
<path fill="none" stroke="black" d="M6573.15,-27688.65C6573.15,-27643.52 6573.15,-27561 6573.15,-27561 6573.15,-27561 4195.21,-27561 4195.21,-27561"/>
<polygon fill="black" stroke="black" points="4195.21,-27557.5 4185.21,-27561 4195.21,-27564.5 4195.21,-27557.5"/>
</g>
<!-- layer26_moe_gate -->
<g id="node1205" class="node">
<title>layer26_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4275.3,-27424.33 3864.4,-27424.33 3758.7,-27320.33 4169.6,-27320.33 4275.3,-27424.33"/>
<text text-anchor="middle" x="4017" y="-27386.33" font-family="Arial" font-size="10.00">GATE L26</text>
<text text-anchor="middle" x="4017" y="-27375.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4017" y="-27364.33" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4017" y="-27353.33" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer26_moe_mha&#45;&gt;layer26_moe_gate -->
<g id="edge1613" class="edge">
<title>layer26_moe_mha&#45;&gt;layer26_moe_gate</title>
<path fill="none" stroke="black" d="M4017,-27460.18C4017,-27460.18 4017,-27434.43 4017,-27434.43"/>
<polygon fill="black" stroke="black" points="4020.5,-27434.43 4017,-27424.43 4013.5,-27434.43 4020.5,-27434.43"/>
</g>
<!-- layer26_moe_split -->
<g id="node1206" class="node">
<title>layer26_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4271.01,-27284.33 3866.94,-27284.33 3762.99,-27180.33 4167.06,-27180.33 4271.01,-27284.33"/>
<text text-anchor="middle" x="4017" y="-27246.33" font-family="Arial" font-size="10.00">SPLIT TOKENS L26</text>
<text text-anchor="middle" x="4017" y="-27235.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4017" y="-27224.33" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="4017" y="-27213.33" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer26_moe_gate&#45;&gt;layer26_moe_split -->
<g id="edge1614" class="edge">
<title>layer26_moe_gate&#45;&gt;layer26_moe_split</title>
<path fill="none" stroke="black" d="M4017,-27320.2C4017,-27320.2 4017,-27294.51 4017,-27294.51"/>
<polygon fill="black" stroke="black" points="4020.5,-27294.51 4017,-27284.51 4013.5,-27294.51 4020.5,-27294.51"/>
</g>
<!-- layer26_moe_comm_to_expert0 -->
<g id="node1208" class="node">
<title>layer26_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1468" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1468" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1468" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1468" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert0 -->
<g id="edge1548" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3851.46,-27269C3289.04,-27269 1486.5,-27269 1486.5,-27269 1486.5,-27269 1486.5,-27153.88 1486.5,-27153.88"/>
<polygon fill="black" stroke="black" points="1490,-27153.88 1486.5,-27143.88 1483,-27153.88 1490,-27153.88"/>
</g>
<!-- layer26_moe_comm_to_expert1 -->
<g id="node1210" class="node">
<title>layer26_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2181" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2181" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2181" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2181" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert1 -->
<g id="edge1550" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3836.5,-27254C3377.09,-27254 2199.5,-27254 2199.5,-27254 2199.5,-27254 2199.5,-27153.74 2199.5,-27153.74"/>
<polygon fill="black" stroke="black" points="2203,-27153.74 2199.5,-27143.74 2196,-27153.74 2203,-27153.74"/>
</g>
<!-- layer26_moe_comm_to_expert2 -->
<g id="node1212" class="node">
<title>layer26_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2637" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2637" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2637" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2637" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert2 -->
<g id="edge1552" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3821.57,-27239C3444.96,-27239 2655.5,-27239 2655.5,-27239 2655.5,-27239 2655.5,-27154.02 2655.5,-27154.02"/>
<polygon fill="black" stroke="black" points="2659,-27154.02 2655.5,-27144.02 2652,-27154.02 2659,-27154.02"/>
</g>
<!-- layer26_moe_comm_to_expert3 -->
<g id="node1214" class="node">
<title>layer26_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2965" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2965" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2965" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2965" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert3 -->
<g id="edge1554" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3806.61,-27224C3504.43,-27224 2983.5,-27224 2983.5,-27224 2983.5,-27224 2983.5,-27153.89 2983.5,-27153.89"/>
<polygon fill="black" stroke="black" points="2987,-27153.89 2983.5,-27143.89 2980,-27153.89 2987,-27153.89"/>
</g>
<!-- layer26_moe_comm_to_expert4 -->
<g id="node1216" class="node">
<title>layer26_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3228" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3228" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3228" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3228" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert4 -->
<g id="edge1556" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3792.59,-27210C3565.13,-27210 3246.5,-27210 3246.5,-27210 3246.5,-27210 3246.5,-27153.74 3246.5,-27153.74"/>
<polygon fill="black" stroke="black" points="3250,-27153.74 3246.5,-27143.74 3243,-27153.74 3250,-27153.74"/>
</g>
<!-- layer26_moe_comm_to_expert5 -->
<g id="node1218" class="node">
<title>layer26_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3459" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3459" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3459" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3459" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert5 -->
<g id="edge1558" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3777.62,-27195C3633.42,-27195 3477.5,-27195 3477.5,-27195 3477.5,-27195 3477.5,-27154.1 3477.5,-27154.1"/>
<polygon fill="black" stroke="black" points="3481,-27154.1 3477.5,-27144.1 3474,-27154.1 3481,-27154.1"/>
</g>
<!-- layer26_moe_comm_to_expert6 -->
<g id="node1220" class="node">
<title>layer26_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3674" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3674" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3674" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3674" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert6 -->
<g id="edge1560" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3777.5,-27232.25C3777.5,-27228.69 3777.5,-27115 3777.5,-27115 3777.5,-27115 3774.81,-27115 3774.81,-27115"/>
<polygon fill="black" stroke="black" points="3774.81,-27111.5 3764.81,-27115 3774.81,-27118.5 3774.81,-27111.5"/>
</g>
<!-- layer26_moe_comm_to_expert7 -->
<g id="node1222" class="node">
<title>layer26_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3881" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3881" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3881" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3881" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert7 -->
<g id="edge1562" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3881,-27180C3881,-27180 3881,-27154.55 3881,-27154.55"/>
<polygon fill="black" stroke="black" points="3884.5,-27154.55 3881,-27144.55 3877.5,-27154.55 3884.5,-27154.55"/>
</g>
<!-- layer26_moe_comm_to_expert8 -->
<g id="node1224" class="node">
<title>layer26_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4153" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4153" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4153" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4153" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert8 -->
<g id="edge1564" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4153,-27180C4153,-27180 4153,-27154.55 4153,-27154.55"/>
<polygon fill="black" stroke="black" points="4156.5,-27154.55 4153,-27144.55 4149.5,-27154.55 4156.5,-27154.55"/>
</g>
<!-- layer26_moe_comm_to_expert9 -->
<g id="node1226" class="node">
<title>layer26_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4462" cy="-27115.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4462" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4462" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4462" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert9 -->
<g id="edge1566" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4257.26,-27232.25C4257.26,-27228.69 4257.26,-27115 4257.26,-27115 4257.26,-27115 4361.3,-27115 4361.3,-27115"/>
<polygon fill="black" stroke="black" points="4361.3,-27118.5 4371.3,-27115 4361.3,-27111.5 4361.3,-27118.5"/>
</g>
<!-- layer26_moe_comm_to_expert10 -->
<g id="node1228" class="node">
<title>layer26_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4794" cy="-27115.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4794" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4794" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4794" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert10 -->
<g id="edge1568" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4181.82,-27195C4389.07,-27195 4718.1,-27195 4718.1,-27195 4718.1,-27195 4718.1,-27142.63 4718.1,-27142.63"/>
<polygon fill="black" stroke="black" points="4721.6,-27142.63 4718.1,-27132.63 4714.6,-27142.63 4721.6,-27142.63"/>
</g>
<!-- layer26_moe_comm_to_expert11 -->
<g id="node1230" class="node">
<title>layer26_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5140" cy="-27115.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5140" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5140" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5140" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert11 -->
<g id="edge1570" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4196.79,-27210C4496.24,-27210 5064.6,-27210 5064.6,-27210 5064.6,-27210 5064.6,-27142.7 5064.6,-27142.7"/>
<polygon fill="black" stroke="black" points="5068.1,-27142.7 5064.6,-27132.7 5061.1,-27142.7 5068.1,-27142.7"/>
</g>
<!-- layer26_moe_comm_to_expert12 -->
<g id="node1232" class="node">
<title>layer26_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5491" cy="-27115.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5491" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5491" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5491" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert12 -->
<g id="edge1572" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4210.73,-27224C4594.72,-27224 5415.6,-27224 5415.6,-27224 5415.6,-27224 5415.6,-27142.8 5415.6,-27142.8"/>
<polygon fill="black" stroke="black" points="5419.1,-27142.8 5415.6,-27132.8 5412.1,-27142.8 5419.1,-27142.8"/>
</g>
<!-- layer26_moe_comm_to_expert13 -->
<g id="node1234" class="node">
<title>layer26_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5844" cy="-27115.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5844" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5844" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5844" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert13 -->
<g id="edge1574" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4225.74,-27239C4690.33,-27239 5769.1,-27239 5769.1,-27239 5769.1,-27239 5769.1,-27143.06 5769.1,-27143.06"/>
<polygon fill="black" stroke="black" points="5772.6,-27143.06 5769.1,-27133.06 5765.6,-27143.06 5772.6,-27143.06"/>
</g>
<!-- layer26_moe_comm_to_expert14 -->
<g id="node1236" class="node">
<title>layer26_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6199" cy="-27115.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6199" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6199" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6199" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert14 -->
<g id="edge1576" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4241,-27254C4783.61,-27254 6124.1,-27254 6124.1,-27254 6124.1,-27254 6124.1,-27142.9 6124.1,-27142.9"/>
<polygon fill="black" stroke="black" points="6127.6,-27142.9 6124.1,-27132.9 6120.6,-27142.9 6127.6,-27142.9"/>
</g>
<!-- layer26_moe_comm_to_expert15 -->
<g id="node1238" class="node">
<title>layer26_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6554" cy="-27115.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6554" y="-27123.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6554" y="-27112.84" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6554" y="-27101.84" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert15 -->
<g id="edge1578" class="edge">
<title>layer26_moe_split&#45;&gt;layer26_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4255.87,-27269C4874.18,-27269 6479.1,-27269 6479.1,-27269 6479.1,-27269 6479.1,-27142.97 6479.1,-27142.97"/>
<polygon fill="black" stroke="black" points="6482.6,-27142.97 6479.1,-27132.97 6475.6,-27142.97 6482.6,-27142.97"/>
</g>
<!-- layer26_moe_expert0 -->
<g id="node1207" class="node">
<title>layer26_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1586,-27050.35 1258,-27050.35 1258,-26998.35 1586,-26998.35 1586,-27050.35"/>
<text text-anchor="middle" x="1422" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 0 L26</text>
<text text-anchor="middle" x="1422" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1422" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1422" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert0 -->
<g id="node1240" class="node">
<title>layer26_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1468" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1468" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1468" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1468" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer26_moe_expert0&#45;&gt;layer26_moe_comm_from_expert0 -->
<g id="edge1580" class="edge">
<title>layer26_moe_expert0&#45;&gt;layer26_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1468,-26998.03C1468,-26998.03 1468,-26972.49 1468,-26972.49"/>
<polygon fill="black" stroke="black" points="1471.5,-26972.49 1468,-26962.49 1464.5,-26972.49 1471.5,-26972.49"/>
</g>
<!-- layer26_moe_comm_to_expert0&#45;&gt;layer26_moe_expert0 -->
<g id="edge1549" class="edge">
<title>layer26_moe_comm_to_expert0&#45;&gt;layer26_moe_expert0</title>
<path fill="none" stroke="black" d="M1468,-27086.3C1468,-27086.3 1468,-27060.65 1468,-27060.65"/>
<polygon fill="black" stroke="black" points="1471.5,-27060.65 1468,-27050.65 1464.5,-27060.65 1471.5,-27060.65"/>
</g>
<!-- layer26_moe_expert1 -->
<g id="node1209" class="node">
<title>layer26_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1932,-27050.35 1604,-27050.35 1604,-26998.35 1932,-26998.35 1932,-27050.35"/>
<text text-anchor="middle" x="1768" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 1 L26</text>
<text text-anchor="middle" x="1768" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1768" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1768" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert1 -->
<g id="node1241" class="node">
<title>layer26_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2181" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2181" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2181" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2181" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer26_moe_expert1&#45;&gt;layer26_moe_comm_from_expert1 -->
<g id="edge1582" class="edge">
<title>layer26_moe_expert1&#45;&gt;layer26_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1922.5,-26997.93C1922.5,-26970.95 1922.5,-26933 1922.5,-26933 1922.5,-26933 2080.23,-26933 2080.23,-26933"/>
<polygon fill="black" stroke="black" points="2080.23,-26936.5 2090.23,-26933 2080.23,-26929.5 2080.23,-26936.5"/>
</g>
<!-- layer26_moe_comm_to_expert1&#45;&gt;layer26_moe_expert1 -->
<g id="edge1551" class="edge">
<title>layer26_moe_comm_to_expert1&#45;&gt;layer26_moe_expert1</title>
<path fill="none" stroke="black" d="M2090.49,-27115C1974.02,-27115 1786.5,-27115 1786.5,-27115 1786.5,-27115 1786.5,-27060.57 1786.5,-27060.57"/>
<polygon fill="black" stroke="black" points="1790,-27060.57 1786.5,-27050.57 1783,-27060.57 1790,-27060.57"/>
</g>
<!-- layer26_moe_expert2 -->
<g id="node1211" class="node">
<title>layer26_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2278,-27050.35 1950,-27050.35 1950,-26998.35 2278,-26998.35 2278,-27050.35"/>
<text text-anchor="middle" x="2114" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 2 L26</text>
<text text-anchor="middle" x="2114" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2114" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2114" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert2 -->
<g id="node1242" class="node">
<title>layer26_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2637" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2637" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2637" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2637" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer26_moe_expert2&#45;&gt;layer26_moe_comm_from_expert2 -->
<g id="edge1584" class="edge">
<title>layer26_moe_expert2&#45;&gt;layer26_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2278.18,-27015C2285.6,-27015 2290,-27015 2290,-27015 2290,-27015 2290,-26933 2290,-26933 2290,-26933 2536.28,-26933 2536.28,-26933"/>
<polygon fill="black" stroke="black" points="2536.28,-26936.5 2546.28,-26933 2536.28,-26929.5 2536.28,-26936.5"/>
</g>
<!-- layer26_moe_comm_to_expert2&#45;&gt;layer26_moe_expert2 -->
<g id="edge1553" class="edge">
<title>layer26_moe_comm_to_expert2&#45;&gt;layer26_moe_expert2</title>
<path fill="none" stroke="black" d="M2546.09,-27115C2441.5,-27115 2284,-27115 2284,-27115 2284,-27115 2284,-27033 2284,-27033 2284,-27033 2283.43,-27033 2283.43,-27033"/>
<polygon fill="black" stroke="black" points="2288.34,-27029.5 2278.34,-27033 2288.34,-27036.5 2288.34,-27029.5"/>
</g>
<!-- layer26_moe_expert3 -->
<g id="node1213" class="node">
<title>layer26_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2624,-27050.35 2296,-27050.35 2296,-26998.35 2624,-26998.35 2624,-27050.35"/>
<text text-anchor="middle" x="2460" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 3 L26</text>
<text text-anchor="middle" x="2460" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2460" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2460" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert3 -->
<g id="node1243" class="node">
<title>layer26_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2965" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2965" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2965" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2965" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer26_moe_expert3&#45;&gt;layer26_moe_comm_from_expert3 -->
<g id="edge1586" class="edge">
<title>layer26_moe_expert3&#45;&gt;layer26_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2585.25,-26998.29C2585.25,-26986 2585.25,-26974 2585.25,-26974 2585.25,-26974 2906.33,-26974 2906.33,-26974 2906.33,-26974 2906.33,-26965.58 2906.33,-26965.58"/>
<polygon fill="black" stroke="black" points="2909.83,-26965.58 2906.33,-26955.58 2902.83,-26965.58 2909.83,-26965.58"/>
</g>
<!-- layer26_moe_comm_to_expert3&#45;&gt;layer26_moe_expert3 -->
<g id="edge1555" class="edge">
<title>layer26_moe_comm_to_expert3&#45;&gt;layer26_moe_expert3</title>
<path fill="none" stroke="black" d="M2906.33,-27093.22C2906.33,-27083.39 2906.33,-27074 2906.33,-27074 2906.33,-27074 2585.25,-27074 2585.25,-27074 2585.25,-27074 2585.25,-27060.63 2585.25,-27060.63"/>
<polygon fill="black" stroke="black" points="2588.75,-27060.63 2585.25,-27050.63 2581.75,-27060.63 2588.75,-27060.63"/>
</g>
<!-- layer26_moe_expert4 -->
<g id="node1215" class="node">
<title>layer26_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2970,-27050.35 2642,-27050.35 2642,-26998.35 2970,-26998.35 2970,-27050.35"/>
<text text-anchor="middle" x="2806" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 4 L26</text>
<text text-anchor="middle" x="2806" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2806" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2806" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert4 -->
<g id="node1244" class="node">
<title>layer26_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3228" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3228" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3228" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3228" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer26_moe_expert4&#45;&gt;layer26_moe_comm_from_expert4 -->
<g id="edge1588" class="edge">
<title>layer26_moe_expert4&#45;&gt;layer26_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2938.16,-26998.13C2938.16,-26991.39 2938.16,-26986 2938.16,-26986 2938.16,-26986 3226.75,-26986 3226.75,-26986 3226.75,-26986 3226.75,-26972.45 3226.75,-26972.45"/>
<polygon fill="black" stroke="black" points="3230.25,-26972.45 3226.75,-26962.45 3223.25,-26972.45 3230.25,-26972.45"/>
</g>
<!-- layer26_moe_comm_to_expert4&#45;&gt;layer26_moe_expert4 -->
<g id="edge1557" class="edge">
<title>layer26_moe_comm_to_expert4&#45;&gt;layer26_moe_expert4</title>
<path fill="none" stroke="black" d="M3226.75,-27086.17C3226.75,-27073.72 3226.75,-27062 3226.75,-27062 3226.75,-27062 2938.16,-27062 2938.16,-27062 2938.16,-27062 2938.16,-27060.5 2938.16,-27060.5"/>
<polygon fill="black" stroke="black" points="2941.66,-27060.5 2938.16,-27050.5 2934.66,-27060.5 2941.66,-27060.5"/>
</g>
<!-- layer26_moe_expert5 -->
<g id="node1217" class="node">
<title>layer26_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3316,-27050.35 2988,-27050.35 2988,-26998.35 3316,-26998.35 3316,-27050.35"/>
<text text-anchor="middle" x="3152" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 5 L26</text>
<text text-anchor="middle" x="3152" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3152" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3152" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert5 -->
<g id="node1245" class="node">
<title>layer26_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3459" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3459" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3459" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3459" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer26_moe_expert5&#45;&gt;layer26_moe_comm_from_expert5 -->
<g id="edge1590" class="edge">
<title>layer26_moe_expert5&#45;&gt;layer26_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3316.12,-27015C3324.08,-27015 3328.84,-27015 3328.84,-27015 3328.84,-27015 3328.84,-26933 3328.84,-26933 3328.84,-26933 3358.24,-26933 3358.24,-26933"/>
<polygon fill="black" stroke="black" points="3358.24,-26936.5 3368.24,-26933 3358.24,-26929.5 3358.24,-26936.5"/>
</g>
<!-- layer26_moe_comm_to_expert5&#45;&gt;layer26_moe_expert5 -->
<g id="edge1559" class="edge">
<title>layer26_moe_comm_to_expert5&#45;&gt;layer26_moe_expert5</title>
<path fill="none" stroke="black" d="M3368.36,-27115C3343.71,-27115 3323.67,-27115 3323.67,-27115 3323.67,-27115 3323.67,-27033 3323.67,-27033 3323.67,-27033 3322.94,-27033 3322.94,-27033"/>
<polygon fill="black" stroke="black" points="3326.3,-27029.5 3316.3,-27033 3326.3,-27036.5 3326.3,-27029.5"/>
</g>
<!-- layer26_moe_expert6 -->
<g id="node1219" class="node">
<title>layer26_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3662,-27050.35 3334,-27050.35 3334,-26998.35 3662,-26998.35 3662,-27050.35"/>
<text text-anchor="middle" x="3498" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 6 L26</text>
<text text-anchor="middle" x="3498" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3498" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3498" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert6 -->
<g id="node1246" class="node">
<title>layer26_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3674" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3674" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3674" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3674" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer26_moe_expert6&#45;&gt;layer26_moe_comm_from_expert6 -->
<g id="edge1592" class="edge">
<title>layer26_moe_expert6&#45;&gt;layer26_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3622.75,-26998.03C3622.75,-26998.03 3622.75,-26967.44 3622.75,-26967.44"/>
<polygon fill="black" stroke="black" points="3626.25,-26967.44 3622.75,-26957.44 3619.25,-26967.44 3626.25,-26967.44"/>
</g>
<!-- layer26_moe_comm_to_expert6&#45;&gt;layer26_moe_expert6 -->
<g id="edge1561" class="edge">
<title>layer26_moe_comm_to_expert6&#45;&gt;layer26_moe_expert6</title>
<path fill="none" stroke="black" d="M3622.75,-27091.43C3622.75,-27091.43 3622.75,-27060.66 3622.75,-27060.66"/>
<polygon fill="black" stroke="black" points="3626.25,-27060.66 3622.75,-27050.66 3619.25,-27060.66 3626.25,-27060.66"/>
</g>
<!-- layer26_moe_expert7 -->
<g id="node1221" class="node">
<title>layer26_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="4008,-27050.35 3680,-27050.35 3680,-26998.35 4008,-26998.35 4008,-27050.35"/>
<text text-anchor="middle" x="3844" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 7 L26</text>
<text text-anchor="middle" x="3844" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3844" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3844" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert7 -->
<g id="node1247" class="node">
<title>layer26_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3881" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3881" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3881" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3881" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer26_moe_expert7&#45;&gt;layer26_moe_comm_from_expert7 -->
<g id="edge1594" class="edge">
<title>layer26_moe_expert7&#45;&gt;layer26_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3881,-26998.03C3881,-26998.03 3881,-26972.49 3881,-26972.49"/>
<polygon fill="black" stroke="black" points="3884.5,-26972.49 3881,-26962.49 3877.5,-26972.49 3884.5,-26972.49"/>
</g>
<!-- layer26_moe_comm_to_expert7&#45;&gt;layer26_moe_expert7 -->
<g id="edge1563" class="edge">
<title>layer26_moe_comm_to_expert7&#45;&gt;layer26_moe_expert7</title>
<path fill="none" stroke="black" d="M3881,-27086.3C3881,-27086.3 3881,-27060.65 3881,-27060.65"/>
<polygon fill="black" stroke="black" points="3884.5,-27060.65 3881,-27050.65 3877.5,-27060.65 3884.5,-27060.65"/>
</g>
<!-- layer26_moe_expert8 -->
<g id="node1223" class="node">
<title>layer26_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4354,-27050.35 4026,-27050.35 4026,-26998.35 4354,-26998.35 4354,-27050.35"/>
<text text-anchor="middle" x="4190" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 8 L26</text>
<text text-anchor="middle" x="4190" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4190" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4190" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert8 -->
<g id="node1248" class="node">
<title>layer26_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4153" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4153" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4153" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4153" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer26_moe_expert8&#45;&gt;layer26_moe_comm_from_expert8 -->
<g id="edge1596" class="edge">
<title>layer26_moe_expert8&#45;&gt;layer26_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4153,-26998.03C4153,-26998.03 4153,-26972.49 4153,-26972.49"/>
<polygon fill="black" stroke="black" points="4156.5,-26972.49 4153,-26962.49 4149.5,-26972.49 4156.5,-26972.49"/>
</g>
<!-- layer26_moe_comm_to_expert8&#45;&gt;layer26_moe_expert8 -->
<g id="edge1565" class="edge">
<title>layer26_moe_comm_to_expert8&#45;&gt;layer26_moe_expert8</title>
<path fill="none" stroke="black" d="M4153,-27086.3C4153,-27086.3 4153,-27060.65 4153,-27060.65"/>
<polygon fill="black" stroke="black" points="4156.5,-27060.65 4153,-27050.65 4149.5,-27060.65 4156.5,-27060.65"/>
</g>
<!-- layer26_moe_expert9 -->
<g id="node1225" class="node">
<title>layer26_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4700,-27050.35 4372,-27050.35 4372,-26998.35 4700,-26998.35 4700,-27050.35"/>
<text text-anchor="middle" x="4536" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 9 L26</text>
<text text-anchor="middle" x="4536" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4536" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4536" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert9 -->
<g id="node1249" class="node">
<title>layer26_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4462" cy="-26933.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4462" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4462" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4462" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer26_moe_expert9&#45;&gt;layer26_moe_comm_from_expert9 -->
<g id="edge1598" class="edge">
<title>layer26_moe_expert9&#45;&gt;layer26_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4462.25,-26998.03C4462.25,-26998.03 4462.25,-26972.49 4462.25,-26972.49"/>
<polygon fill="black" stroke="black" points="4465.75,-26972.49 4462.25,-26962.49 4458.75,-26972.49 4465.75,-26972.49"/>
</g>
<!-- layer26_moe_comm_to_expert9&#45;&gt;layer26_moe_expert9 -->
<g id="edge1567" class="edge">
<title>layer26_moe_comm_to_expert9&#45;&gt;layer26_moe_expert9</title>
<path fill="none" stroke="black" d="M4462.25,-27086.3C4462.25,-27086.3 4462.25,-27060.65 4462.25,-27060.65"/>
<polygon fill="black" stroke="black" points="4465.75,-27060.65 4462.25,-27050.65 4458.75,-27060.65 4465.75,-27060.65"/>
</g>
<!-- layer26_moe_expert10 -->
<g id="node1227" class="node">
<title>layer26_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5056,-27050.35 4718,-27050.35 4718,-26998.35 5056,-26998.35 5056,-27050.35"/>
<text text-anchor="middle" x="4887" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 10 L26</text>
<text text-anchor="middle" x="4887" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4887" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4887" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert10 -->
<g id="node1250" class="node">
<title>layer26_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4794" cy="-26933.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4794" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4794" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4794" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer26_moe_expert10&#45;&gt;layer26_moe_comm_from_expert10 -->
<g id="edge1600" class="edge">
<title>layer26_moe_expert10&#45;&gt;layer26_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4803.38,-26998.03C4803.38,-26998.03 4803.38,-26972.49 4803.38,-26972.49"/>
<polygon fill="black" stroke="black" points="4806.88,-26972.49 4803.38,-26962.49 4799.88,-26972.49 4806.88,-26972.49"/>
</g>
<!-- layer26_moe_comm_to_expert10&#45;&gt;layer26_moe_expert10 -->
<g id="edge1569" class="edge">
<title>layer26_moe_comm_to_expert10&#45;&gt;layer26_moe_expert10</title>
<path fill="none" stroke="black" d="M4803.02,-27086.3C4803.02,-27086.3 4803.02,-27060.65 4803.02,-27060.65"/>
<polygon fill="black" stroke="black" points="4806.52,-27060.65 4803.02,-27050.65 4799.52,-27060.65 4806.52,-27060.65"/>
</g>
<!-- layer26_moe_expert11 -->
<g id="node1229" class="node">
<title>layer26_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5412,-27050.35 5074,-27050.35 5074,-26998.35 5412,-26998.35 5412,-27050.35"/>
<text text-anchor="middle" x="5243" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 11 L26</text>
<text text-anchor="middle" x="5243" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5243" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5243" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert11 -->
<g id="node1251" class="node">
<title>layer26_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5141" cy="-26933.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5141" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5141" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5141" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer26_moe_expert11&#45;&gt;layer26_moe_comm_from_expert11 -->
<g id="edge1602" class="edge">
<title>layer26_moe_expert11&#45;&gt;layer26_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5154.88,-26998.03C5154.88,-26998.03 5154.88,-26972.17 5154.88,-26972.17"/>
<polygon fill="black" stroke="black" points="5158.38,-26972.17 5154.88,-26962.17 5151.38,-26972.17 5158.38,-26972.17"/>
</g>
<!-- layer26_moe_comm_to_expert11&#45;&gt;layer26_moe_expert11 -->
<g id="edge1571" class="edge">
<title>layer26_moe_comm_to_expert11&#45;&gt;layer26_moe_expert11</title>
<path fill="none" stroke="black" d="M5154.02,-27086.55C5154.02,-27086.55 5154.02,-27060.48 5154.02,-27060.48"/>
<polygon fill="black" stroke="black" points="5157.52,-27060.48 5154.02,-27050.48 5150.52,-27060.48 5157.52,-27060.48"/>
</g>
<!-- layer26_moe_expert12 -->
<g id="node1231" class="node">
<title>layer26_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5768,-27050.35 5430,-27050.35 5430,-26998.35 5768,-26998.35 5768,-27050.35"/>
<text text-anchor="middle" x="5599" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 12 L26</text>
<text text-anchor="middle" x="5599" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5599" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5599" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert12 -->
<g id="node1252" class="node">
<title>layer26_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5492" cy="-26933.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5492" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5492" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5492" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer26_moe_expert12&#45;&gt;layer26_moe_comm_from_expert12 -->
<g id="edge1604" class="edge">
<title>layer26_moe_expert12&#45;&gt;layer26_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5508.38,-26998.03C5508.38,-26998.03 5508.38,-26972.17 5508.38,-26972.17"/>
<polygon fill="black" stroke="black" points="5511.88,-26972.17 5508.38,-26962.17 5504.88,-26972.17 5511.88,-26972.17"/>
</g>
<!-- layer26_moe_comm_to_expert12&#45;&gt;layer26_moe_expert12 -->
<g id="edge1573" class="edge">
<title>layer26_moe_comm_to_expert12&#45;&gt;layer26_moe_expert12</title>
<path fill="none" stroke="black" d="M5507.52,-27086.55C5507.52,-27086.55 5507.52,-27060.48 5507.52,-27060.48"/>
<polygon fill="black" stroke="black" points="5511.02,-27060.48 5507.52,-27050.48 5504.02,-27060.48 5511.02,-27060.48"/>
</g>
<!-- layer26_moe_expert13 -->
<g id="node1233" class="node">
<title>layer26_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6124,-27050.35 5786,-27050.35 5786,-26998.35 6124,-26998.35 6124,-27050.35"/>
<text text-anchor="middle" x="5955" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 13 L26</text>
<text text-anchor="middle" x="5955" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5955" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5955" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert13 -->
<g id="node1253" class="node">
<title>layer26_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5846" cy="-26933.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5846" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5846" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5846" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer26_moe_expert13&#45;&gt;layer26_moe_comm_from_expert13 -->
<g id="edge1606" class="edge">
<title>layer26_moe_expert13&#45;&gt;layer26_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5863.38,-26998.03C5863.38,-26998.03 5863.38,-26972.17 5863.38,-26972.17"/>
<polygon fill="black" stroke="black" points="5866.88,-26972.17 5863.38,-26962.17 5859.88,-26972.17 5866.88,-26972.17"/>
</g>
<!-- layer26_moe_comm_to_expert13&#45;&gt;layer26_moe_expert13 -->
<g id="edge1575" class="edge">
<title>layer26_moe_comm_to_expert13&#45;&gt;layer26_moe_expert13</title>
<path fill="none" stroke="black" d="M5862.02,-27086.55C5862.02,-27086.55 5862.02,-27060.48 5862.02,-27060.48"/>
<polygon fill="black" stroke="black" points="5865.52,-27060.48 5862.02,-27050.48 5858.52,-27060.48 5865.52,-27060.48"/>
</g>
<!-- layer26_moe_expert14 -->
<g id="node1235" class="node">
<title>layer26_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6480,-27050.35 6142,-27050.35 6142,-26998.35 6480,-26998.35 6480,-27050.35"/>
<text text-anchor="middle" x="6311" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 14 L26</text>
<text text-anchor="middle" x="6311" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6311" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6311" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert14 -->
<g id="node1254" class="node">
<title>layer26_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6201" cy="-26933.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6201" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6201" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6201" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer26_moe_expert14&#45;&gt;layer26_moe_comm_from_expert14 -->
<g id="edge1608" class="edge">
<title>layer26_moe_expert14&#45;&gt;layer26_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6218.88,-26998.03C6218.88,-26998.03 6218.88,-26971.84 6218.88,-26971.84"/>
<polygon fill="black" stroke="black" points="6222.38,-26971.84 6218.88,-26961.84 6215.38,-26971.84 6222.38,-26971.84"/>
</g>
<!-- layer26_moe_comm_to_expert14&#45;&gt;layer26_moe_expert14 -->
<g id="edge1577" class="edge">
<title>layer26_moe_comm_to_expert14&#45;&gt;layer26_moe_expert14</title>
<path fill="none" stroke="black" d="M6217.52,-27086.55C6217.52,-27086.55 6217.52,-27060.48 6217.52,-27060.48"/>
<polygon fill="black" stroke="black" points="6221.02,-27060.48 6217.52,-27050.48 6214.02,-27060.48 6221.02,-27060.48"/>
</g>
<!-- layer26_moe_expert15 -->
<g id="node1237" class="node">
<title>layer26_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6836,-27050.35 6498,-27050.35 6498,-26998.35 6836,-26998.35 6836,-27050.35"/>
<text text-anchor="middle" x="6667" y="-27038.35" font-family="Arial" font-size="10.00">EXPERT 15 L26</text>
<text text-anchor="middle" x="6667" y="-27027.35" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6667" y="-27016.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6667" y="-27005.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_comm_from_expert15 -->
<g id="node1255" class="node">
<title>layer26_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6556" cy="-26933.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6556" y="-26941.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6556" y="-26930.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6556" y="-26919.86" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer26_moe_expert15&#45;&gt;layer26_moe_comm_from_expert15 -->
<g id="edge1610" class="edge">
<title>layer26_moe_expert15&#45;&gt;layer26_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6574.38,-26998.03C6574.38,-26998.03 6574.38,-26971.84 6574.38,-26971.84"/>
<polygon fill="black" stroke="black" points="6577.88,-26971.84 6574.38,-26961.84 6570.88,-26971.84 6577.88,-26971.84"/>
</g>
<!-- layer26_moe_comm_to_expert15&#45;&gt;layer26_moe_expert15 -->
<g id="edge1579" class="edge">
<title>layer26_moe_comm_to_expert15&#45;&gt;layer26_moe_expert15</title>
<path fill="none" stroke="black" d="M6573.02,-27086.55C6573.02,-27086.55 6573.02,-27060.48 6573.02,-27060.48"/>
<polygon fill="black" stroke="black" points="6576.52,-27060.48 6573.02,-27050.48 6569.52,-27060.48 6576.52,-27060.48"/>
</g>
<!-- layer26_moe_aggregate -->
<g id="node1239" class="node">
<title>layer26_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4242.1,-26868.37 3825.16,-26868.37 3717.9,-26764.37 4134.84,-26764.37 4242.1,-26868.37"/>
<text text-anchor="middle" x="3980" y="-26830.37" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L26</text>
<text text-anchor="middle" x="3980" y="-26819.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3980" y="-26808.37" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3980" y="-26797.37" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_mha -->
<g id="node1256" class="node">
<title>layer27_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4110,-26728.37 3850,-26728.37 3850,-26676.37 4110,-26676.37 4110,-26728.37"/>
<text text-anchor="middle" x="3980" y="-26716.37" font-family="Arial" font-size="10.00">MHA L27</text>
<text text-anchor="middle" x="3980" y="-26705.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3980" y="-26694.37" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3980" y="-26683.37" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer26_moe_aggregate&#45;&gt;layer27_moe_mha -->
<g id="edge1679" class="edge">
<title>layer26_moe_aggregate&#45;&gt;layer27_moe_mha</title>
<path fill="none" stroke="black" d="M3980,-26764.04C3980,-26764.04 3980,-26738.59 3980,-26738.59"/>
<polygon fill="black" stroke="black" points="3983.5,-26738.59 3980,-26728.59 3976.5,-26738.59 3983.5,-26738.59"/>
</g>
<!-- layer26_moe_comm_from_expert0&#45;&gt;layer26_moe_aggregate -->
<g id="edge1581" class="edge">
<title>layer26_moe_comm_from_expert0&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M1440.5,-26905.4C1440.5,-26860.92 1440.5,-26779 1440.5,-26779 1440.5,-26779 3722.75,-26779 3722.75,-26779"/>
<polygon fill="black" stroke="black" points="3722.75,-26782.5 3732.75,-26779 3722.75,-26775.5 3722.75,-26782.5"/>
</g>
<!-- layer26_moe_comm_from_expert1&#45;&gt;layer26_moe_aggregate -->
<g id="edge1583" class="edge">
<title>layer26_moe_comm_from_expert1&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M2265.25,-26922.42C2265.25,-26889.57 2265.25,-26794 2265.25,-26794 2265.25,-26794 3738.3,-26794 3738.3,-26794"/>
<polygon fill="black" stroke="black" points="3738.3,-26797.5 3748.3,-26794 3738.3,-26790.5 3738.3,-26797.5"/>
</g>
<!-- layer26_moe_comm_from_expert2&#45;&gt;layer26_moe_aggregate -->
<g id="edge1585" class="edge">
<title>layer26_moe_comm_from_expert2&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M2674.51,-26906.77C2674.51,-26869.98 2674.51,-26808 2674.51,-26808 2674.51,-26808 3752.59,-26808 3752.59,-26808"/>
<polygon fill="black" stroke="black" points="3752.59,-26811.5 3762.59,-26808 3752.59,-26804.5 3752.59,-26811.5"/>
</g>
<!-- layer26_moe_comm_from_expert3&#45;&gt;layer26_moe_aggregate -->
<g id="edge1587" class="edge">
<title>layer26_moe_comm_from_expert3&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M3029.5,-26912.86C3029.5,-26880.94 3029.5,-26823 3029.5,-26823 3029.5,-26823 3768.13,-26823 3768.13,-26823"/>
<polygon fill="black" stroke="black" points="3768.13,-26826.5 3778.13,-26823 3768.13,-26819.5 3768.13,-26826.5"/>
</g>
<!-- layer26_moe_comm_from_expert4&#45;&gt;layer26_moe_aggregate -->
<g id="edge1589" class="edge">
<title>layer26_moe_comm_from_expert4&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M3274.5,-26908.3C3274.5,-26880.05 3274.5,-26838 3274.5,-26838 3274.5,-26838 3783.72,-26838 3783.72,-26838"/>
<polygon fill="black" stroke="black" points="3783.72,-26841.5 3793.72,-26838 3783.72,-26834.5 3783.72,-26841.5"/>
</g>
<!-- layer26_moe_comm_from_expert5&#45;&gt;layer26_moe_aggregate -->
<g id="edge1591" class="edge">
<title>layer26_moe_comm_from_expert5&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M3496.5,-26906.6C3496.5,-26883.22 3496.5,-26853 3496.5,-26853 3496.5,-26853 3799.2,-26853 3799.2,-26853"/>
<polygon fill="black" stroke="black" points="3799.2,-26856.5 3809.2,-26853 3799.2,-26849.5 3799.2,-26856.5"/>
</g>
<!-- layer26_moe_comm_from_expert6&#45;&gt;layer26_moe_aggregate -->
<g id="edge1593" class="edge">
<title>layer26_moe_comm_from_expert6&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M3741.11,-26913.78C3741.11,-26913.78 3741.11,-26826.41 3741.11,-26826.41"/>
<polygon fill="black" stroke="black" points="3744.61,-26826.41 3741.11,-26816.41 3737.61,-26826.41 3744.61,-26826.41"/>
</g>
<!-- layer26_moe_comm_from_expert7&#45;&gt;layer26_moe_aggregate -->
<g id="edge1595" class="edge">
<title>layer26_moe_comm_from_expert7&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M3881,-26904.14C3881,-26904.14 3881,-26878.43 3881,-26878.43"/>
<polygon fill="black" stroke="black" points="3884.5,-26878.43 3881,-26868.43 3877.5,-26878.43 3884.5,-26878.43"/>
</g>
<!-- layer26_moe_comm_from_expert8&#45;&gt;layer26_moe_aggregate -->
<g id="edge1597" class="edge">
<title>layer26_moe_comm_from_expert8&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M4152.39,-26904.14C4152.39,-26904.14 4152.39,-26878.43 4152.39,-26878.43"/>
<polygon fill="black" stroke="black" points="4155.89,-26878.43 4152.39,-26868.43 4148.89,-26878.43 4155.89,-26878.43"/>
</g>
<!-- layer26_moe_comm_from_expert9&#45;&gt;layer26_moe_aggregate -->
<g id="edge1599" class="edge">
<title>layer26_moe_comm_from_expert9&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M4443.5,-26904.63C4443.5,-26882.26 4443.5,-26855 4443.5,-26855 4443.5,-26855 4238.37,-26855 4238.37,-26855"/>
<polygon fill="black" stroke="black" points="4238.37,-26851.5 4228.37,-26855 4238.37,-26858.5 4238.37,-26851.5"/>
</g>
<!-- layer26_moe_comm_from_expert10&#45;&gt;layer26_moe_aggregate -->
<g id="edge1601" class="edge">
<title>layer26_moe_comm_from_expert10&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M4775.15,-26904.45C4775.15,-26877.69 4775.15,-26842 4775.15,-26842 4775.15,-26842 4225.07,-26842 4225.07,-26842"/>
<polygon fill="black" stroke="black" points="4225.07,-26838.5 4215.07,-26842 4225.07,-26845.5 4225.07,-26838.5"/>
</g>
<!-- layer26_moe_comm_from_expert11&#45;&gt;layer26_moe_aggregate -->
<g id="edge1603" class="edge">
<title>layer26_moe_comm_from_expert11&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M5121.65,-26904.84C5121.65,-26873.94 5121.65,-26829 5121.65,-26829 5121.65,-26829 4211.81,-26829 4211.81,-26829"/>
<polygon fill="black" stroke="black" points="4211.81,-26825.5 4201.81,-26829 4211.81,-26832.5 4211.81,-26825.5"/>
</g>
<!-- layer26_moe_comm_from_expert12&#45;&gt;layer26_moe_aggregate -->
<g id="edge1605" class="edge">
<title>layer26_moe_comm_from_expert12&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M5472.65,-26904.95C5472.65,-26870.22 5472.65,-26816 5472.65,-26816 5472.65,-26816 4198.33,-26816 4198.33,-26816"/>
<polygon fill="black" stroke="black" points="4198.33,-26812.5 4188.33,-26816 4198.33,-26819.5 4198.33,-26812.5"/>
</g>
<!-- layer26_moe_comm_from_expert13&#45;&gt;layer26_moe_aggregate -->
<g id="edge1607" class="edge">
<title>layer26_moe_comm_from_expert13&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M5826.15,-26904.75C5826.15,-26866.38 5826.15,-26803 5826.15,-26803 5826.15,-26803 4184.95,-26803 4184.95,-26803"/>
<polygon fill="black" stroke="black" points="4184.95,-26799.5 4174.95,-26803 4184.95,-26806.5 4184.95,-26799.5"/>
</g>
<!-- layer26_moe_comm_from_expert14&#45;&gt;layer26_moe_aggregate -->
<g id="edge1609" class="edge">
<title>layer26_moe_comm_from_expert14&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M6181.15,-26904.69C6181.15,-26862.86 6181.15,-26790 6181.15,-26790 6181.15,-26790 4171.53,-26790 4171.53,-26790"/>
<polygon fill="black" stroke="black" points="4171.53,-26786.5 4161.53,-26790 4171.53,-26793.5 4171.53,-26786.5"/>
</g>
<!-- layer26_moe_comm_from_expert15&#45;&gt;layer26_moe_aggregate -->
<g id="edge1611" class="edge">
<title>layer26_moe_comm_from_expert15&#45;&gt;layer26_moe_aggregate</title>
<path fill="none" stroke="black" d="M6536.15,-26904.68C6536.15,-26859.54 6536.15,-26777 6536.15,-26777 6536.15,-26777 4158.21,-26777 4158.21,-26777"/>
<polygon fill="black" stroke="black" points="4158.21,-26773.5 4148.21,-26777 4158.21,-26780.5 4158.21,-26773.5"/>
</g>
<!-- layer27_moe_gate -->
<g id="node1257" class="node">
<title>layer27_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4238.3,-26640.37 3827.4,-26640.37 3721.7,-26536.37 4132.6,-26536.37 4238.3,-26640.37"/>
<text text-anchor="middle" x="3980" y="-26602.37" font-family="Arial" font-size="10.00">GATE L27</text>
<text text-anchor="middle" x="3980" y="-26591.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3980" y="-26580.37" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3980" y="-26569.37" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer27_moe_mha&#45;&gt;layer27_moe_gate -->
<g id="edge1680" class="edge">
<title>layer27_moe_mha&#45;&gt;layer27_moe_gate</title>
<path fill="none" stroke="black" d="M3980,-26676.21C3980,-26676.21 3980,-26650.47 3980,-26650.47"/>
<polygon fill="black" stroke="black" points="3983.5,-26650.47 3980,-26640.47 3976.5,-26650.47 3983.5,-26650.47"/>
</g>
<!-- layer27_moe_split -->
<g id="node1258" class="node">
<title>layer27_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4234.01,-26500.37 3829.94,-26500.37 3725.99,-26396.37 4130.06,-26396.37 4234.01,-26500.37"/>
<text text-anchor="middle" x="3980" y="-26462.37" font-family="Arial" font-size="10.00">SPLIT TOKENS L27</text>
<text text-anchor="middle" x="3980" y="-26451.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3980" y="-26440.37" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3980" y="-26429.37" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer27_moe_gate&#45;&gt;layer27_moe_split -->
<g id="edge1681" class="edge">
<title>layer27_moe_gate&#45;&gt;layer27_moe_split</title>
<path fill="none" stroke="black" d="M3980,-26536.24C3980,-26536.24 3980,-26510.54 3980,-26510.54"/>
<polygon fill="black" stroke="black" points="3983.5,-26510.54 3980,-26500.54 3976.5,-26510.54 3983.5,-26510.54"/>
</g>
<!-- layer27_moe_comm_to_expert0 -->
<g id="node1260" class="node">
<title>layer27_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1472" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1472" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1472" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1472" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert0 -->
<g id="edge1615" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3814.36,-26485C3259.28,-26485 1499.5,-26485 1499.5,-26485 1499.5,-26485 1499.5,-26369.2 1499.5,-26369.2"/>
<polygon fill="black" stroke="black" points="1503,-26369.2 1499.5,-26359.2 1496,-26369.2 1503,-26369.2"/>
</g>
<!-- layer27_moe_comm_to_expert1 -->
<g id="node1262" class="node">
<title>layer27_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2112" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2112" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2112" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2112" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert1 -->
<g id="edge1617" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3799.18,-26470C3336.61,-26470 2146.5,-26470 2146.5,-26470 2146.5,-26470 2146.5,-26368.43 2146.5,-26368.43"/>
<polygon fill="black" stroke="black" points="2150,-26368.43 2146.5,-26358.43 2143,-26368.43 2150,-26368.43"/>
</g>
<!-- layer27_moe_comm_to_expert2 -->
<g id="node1264" class="node">
<title>layer27_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2531" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2531" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2531" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2531" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert2 -->
<g id="edge1619" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3784.42,-26455C3400.22,-26455 2584,-26455 2584,-26455 2584,-26455 2584,-26364.92 2584,-26364.92"/>
<polygon fill="black" stroke="black" points="2587.5,-26364.92 2584,-26354.92 2580.5,-26364.92 2587.5,-26364.92"/>
</g>
<!-- layer27_moe_comm_to_expert3 -->
<g id="node1266" class="node">
<title>layer27_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2840" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2840" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2840" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2840" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert3 -->
<g id="edge1621" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3769.37,-26440C3455.74,-26440 2902.5,-26440 2902.5,-26440 2902.5,-26440 2902.5,-26362.58 2902.5,-26362.58"/>
<polygon fill="black" stroke="black" points="2906,-26362.58 2902.5,-26352.58 2899,-26362.58 2906,-26362.58"/>
</g>
<!-- layer27_moe_comm_to_expert4 -->
<g id="node1268" class="node">
<title>layer27_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3094" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3094" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3094" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3094" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert4 -->
<g id="edge1623" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3755.39,-26426C3512.93,-26426 3161,-26426 3161,-26426 3161,-26426 3161,-26360.98 3161,-26360.98"/>
<polygon fill="black" stroke="black" points="3164.5,-26360.98 3161,-26350.98 3157.5,-26360.98 3164.5,-26360.98"/>
</g>
<!-- layer27_moe_comm_to_expert5 -->
<g id="node1270" class="node">
<title>layer27_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3321" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3321" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3321" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3321" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert5 -->
<g id="edge1625" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3740.45,-26411C3577,-26411 3390,-26411 3390,-26411 3390,-26411 3390,-26360.25 3390,-26360.25"/>
<polygon fill="black" stroke="black" points="3393.5,-26360.25 3390,-26350.25 3386.5,-26360.25 3393.5,-26360.25"/>
</g>
<!-- layer27_moe_comm_to_expert6 -->
<g id="node1272" class="node">
<title>layer27_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3534" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3534" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3534" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3534" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert6 -->
<g id="edge1627" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3739.74,-26448.28C3739.74,-26444.73 3739.74,-26331 3739.74,-26331 3739.74,-26331 3634.54,-26331 3634.54,-26331"/>
<polygon fill="black" stroke="black" points="3634.54,-26327.5 3624.54,-26331 3634.54,-26334.5 3634.54,-26327.5"/>
</g>
<!-- layer27_moe_comm_to_expert7 -->
<g id="node1274" class="node">
<title>layer27_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3844" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3844" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3844" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3844" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert7 -->
<g id="edge1629" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3844,-26396.03C3844,-26396.03 3844,-26370.59 3844,-26370.59"/>
<polygon fill="black" stroke="black" points="3847.5,-26370.59 3844,-26360.59 3840.5,-26370.59 3847.5,-26370.59"/>
</g>
<!-- layer27_moe_comm_to_expert8 -->
<g id="node1276" class="node">
<title>layer27_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4116" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4116" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4116" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4116" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert8 -->
<g id="edge1631" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4116,-26396.03C4116,-26396.03 4116,-26370.59 4116,-26370.59"/>
<polygon fill="black" stroke="black" points="4119.5,-26370.59 4116,-26360.59 4112.5,-26370.59 4119.5,-26370.59"/>
</g>
<!-- layer27_moe_comm_to_expert9 -->
<g id="node1278" class="node">
<title>layer27_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4425" cy="-26331.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4425" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4425" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4425" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert9 -->
<g id="edge1633" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4220.26,-26448.28C4220.26,-26444.73 4220.26,-26331 4220.26,-26331 4220.26,-26331 4324.3,-26331 4324.3,-26331"/>
<polygon fill="black" stroke="black" points="4324.3,-26334.5 4334.3,-26331 4324.3,-26327.5 4324.3,-26334.5"/>
</g>
<!-- layer27_moe_comm_to_expert10 -->
<g id="node1280" class="node">
<title>layer27_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4757" cy="-26331.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4757" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4757" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4757" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert10 -->
<g id="edge1635" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4144.82,-26411C4352.07,-26411 4681.1,-26411 4681.1,-26411 4681.1,-26411 4681.1,-26358.65 4681.1,-26358.65"/>
<polygon fill="black" stroke="black" points="4684.6,-26358.65 4681.1,-26348.65 4677.6,-26358.65 4684.6,-26358.65"/>
</g>
<!-- layer27_moe_comm_to_expert11 -->
<g id="node1282" class="node">
<title>layer27_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5103" cy="-26331.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5103" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5103" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5103" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert11 -->
<g id="edge1637" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4159.79,-26426C4459.24,-26426 5027.6,-26426 5027.6,-26426 5027.6,-26426 5027.6,-26358.73 5027.6,-26358.73"/>
<polygon fill="black" stroke="black" points="5031.1,-26358.73 5027.6,-26348.73 5024.1,-26358.73 5031.1,-26358.73"/>
</g>
<!-- layer27_moe_comm_to_expert12 -->
<g id="node1284" class="node">
<title>layer27_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5454" cy="-26331.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5454" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5454" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5454" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert12 -->
<g id="edge1639" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4173.73,-26440C4557.72,-26440 5378.6,-26440 5378.6,-26440 5378.6,-26440 5378.6,-26358.83 5378.6,-26358.83"/>
<polygon fill="black" stroke="black" points="5382.1,-26358.83 5378.6,-26348.83 5375.1,-26358.83 5382.1,-26358.83"/>
</g>
<!-- layer27_moe_comm_to_expert13 -->
<g id="node1286" class="node">
<title>layer27_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5807" cy="-26331.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5807" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5807" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5807" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert13 -->
<g id="edge1641" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4188.74,-26455C4653.33,-26455 5732.1,-26455 5732.1,-26455 5732.1,-26455 5732.1,-26359.09 5732.1,-26359.09"/>
<polygon fill="black" stroke="black" points="5735.6,-26359.09 5732.1,-26349.09 5728.6,-26359.09 5735.6,-26359.09"/>
</g>
<!-- layer27_moe_comm_to_expert14 -->
<g id="node1288" class="node">
<title>layer27_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6162" cy="-26331.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6162" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6162" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6162" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert14 -->
<g id="edge1643" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4204,-26470C4746.61,-26470 6087.1,-26470 6087.1,-26470 6087.1,-26470 6087.1,-26358.93 6087.1,-26358.93"/>
<polygon fill="black" stroke="black" points="6090.6,-26358.93 6087.1,-26348.93 6083.6,-26358.93 6090.6,-26358.93"/>
</g>
<!-- layer27_moe_comm_to_expert15 -->
<g id="node1290" class="node">
<title>layer27_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6517" cy="-26331.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6517" y="-26339.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6517" y="-26328.88" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6517" y="-26317.88" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert15 -->
<g id="edge1645" class="edge">
<title>layer27_moe_split&#45;&gt;layer27_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4218.87,-26485C4837.18,-26485 6442.1,-26485 6442.1,-26485 6442.1,-26485 6442.1,-26359 6442.1,-26359"/>
<polygon fill="black" stroke="black" points="6445.6,-26359 6442.1,-26349 6438.6,-26359 6445.6,-26359"/>
</g>
<!-- layer27_moe_expert0 -->
<g id="node1259" class="node">
<title>layer27_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1549,-26266.38 1221,-26266.38 1221,-26214.38 1549,-26214.38 1549,-26266.38"/>
<text text-anchor="middle" x="1385" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 0 L27</text>
<text text-anchor="middle" x="1385" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1385" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1385" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert0 -->
<g id="node1292" class="node">
<title>layer27_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1431" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1431" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1431" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1431" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer27_moe_expert0&#45;&gt;layer27_moe_comm_from_expert0 -->
<g id="edge1647" class="edge">
<title>layer27_moe_expert0&#45;&gt;layer27_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1431,-26214.07C1431,-26214.07 1431,-26188.52 1431,-26188.52"/>
<polygon fill="black" stroke="black" points="1434.5,-26188.52 1431,-26178.52 1427.5,-26188.52 1434.5,-26188.52"/>
</g>
<!-- layer27_moe_comm_to_expert0&#45;&gt;layer27_moe_expert0 -->
<g id="edge1616" class="edge">
<title>layer27_moe_comm_to_expert0&#45;&gt;layer27_moe_expert0</title>
<path fill="none" stroke="black" d="M1465.25,-26302.33C1465.25,-26302.33 1465.25,-26276.69 1465.25,-26276.69"/>
<polygon fill="black" stroke="black" points="1468.75,-26276.69 1465.25,-26266.69 1461.75,-26276.69 1468.75,-26276.69"/>
</g>
<!-- layer27_moe_expert1 -->
<g id="node1261" class="node">
<title>layer27_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1895,-26266.38 1567,-26266.38 1567,-26214.38 1895,-26214.38 1895,-26266.38"/>
<text text-anchor="middle" x="1731" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 1 L27</text>
<text text-anchor="middle" x="1731" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1731" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1731" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert1 -->
<g id="node1293" class="node">
<title>layer27_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2144" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2144" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2144" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2144" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer27_moe_expert1&#45;&gt;layer27_moe_comm_from_expert1 -->
<g id="edge1649" class="edge">
<title>layer27_moe_expert1&#45;&gt;layer27_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1885.5,-26213.95C1885.5,-26186.96 1885.5,-26149 1885.5,-26149 1885.5,-26149 2043.23,-26149 2043.23,-26149"/>
<polygon fill="black" stroke="black" points="2043.23,-26152.5 2053.23,-26149 2043.23,-26145.5 2043.23,-26152.5"/>
</g>
<!-- layer27_moe_comm_to_expert1&#45;&gt;layer27_moe_expert1 -->
<g id="edge1618" class="edge">
<title>layer27_moe_comm_to_expert1&#45;&gt;layer27_moe_expert1</title>
<path fill="none" stroke="black" d="M2021.46,-26331C1914.09,-26331 1749.5,-26331 1749.5,-26331 1749.5,-26331 1749.5,-26276.59 1749.5,-26276.59"/>
<polygon fill="black" stroke="black" points="1753,-26276.59 1749.5,-26266.59 1746,-26276.59 1753,-26276.59"/>
</g>
<!-- layer27_moe_expert2 -->
<g id="node1263" class="node">
<title>layer27_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2241,-26266.38 1913,-26266.38 1913,-26214.38 2241,-26214.38 2241,-26266.38"/>
<text text-anchor="middle" x="2077" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 2 L27</text>
<text text-anchor="middle" x="2077" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2077" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2077" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert2 -->
<g id="node1294" class="node">
<title>layer27_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2600" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2600" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2600" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2600" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer27_moe_expert2&#45;&gt;layer27_moe_comm_from_expert2 -->
<g id="edge1651" class="edge">
<title>layer27_moe_expert2&#45;&gt;layer27_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2241.18,-26240C2246.77,-26240 2250,-26240 2250,-26240 2250,-26240 2250,-26149 2250,-26149 2250,-26149 2499.41,-26149 2499.41,-26149"/>
<polygon fill="black" stroke="black" points="2499.41,-26152.5 2509.41,-26149 2499.41,-26145.5 2499.41,-26152.5"/>
</g>
<!-- layer27_moe_comm_to_expert2&#45;&gt;layer27_moe_expert2 -->
<g id="edge1620" class="edge">
<title>layer27_moe_comm_to_expert2&#45;&gt;layer27_moe_expert2</title>
<path fill="none" stroke="black" d="M2440.31,-26331C2349.06,-26331 2221.75,-26331 2221.75,-26331 2221.75,-26331 2221.75,-26276.59 2221.75,-26276.59"/>
<polygon fill="black" stroke="black" points="2225.25,-26276.59 2221.75,-26266.59 2218.25,-26276.59 2225.25,-26276.59"/>
</g>
<!-- layer27_moe_expert3 -->
<g id="node1265" class="node">
<title>layer27_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2587,-26266.38 2259,-26266.38 2259,-26214.38 2587,-26214.38 2587,-26266.38"/>
<text text-anchor="middle" x="2423" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 3 L27</text>
<text text-anchor="middle" x="2423" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2423" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2423" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert3 -->
<g id="node1295" class="node">
<title>layer27_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2928" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2928" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2928" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2928" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer27_moe_expert3&#45;&gt;layer27_moe_comm_from_expert3 -->
<g id="edge1653" class="edge">
<title>layer27_moe_expert3&#45;&gt;layer27_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2548.25,-26214.31C2548.25,-26202.01 2548.25,-26190 2548.25,-26190 2548.25,-26190 2869.33,-26190 2869.33,-26190 2869.33,-26190 2869.33,-26181.6 2869.33,-26181.6"/>
<polygon fill="black" stroke="black" points="2872.83,-26181.6 2869.33,-26171.6 2865.83,-26181.6 2872.83,-26181.6"/>
</g>
<!-- layer27_moe_comm_to_expert3&#45;&gt;layer27_moe_expert3 -->
<g id="edge1622" class="edge">
<title>layer27_moe_comm_to_expert3&#45;&gt;layer27_moe_expert3</title>
<path fill="none" stroke="black" d="M2840,-26302.18C2840,-26292.43 2840,-26284 2840,-26284 2840,-26284 2513.75,-26284 2513.75,-26284 2513.75,-26284 2513.75,-26276.76 2513.75,-26276.76"/>
<polygon fill="black" stroke="black" points="2517.25,-26276.76 2513.75,-26266.76 2510.25,-26276.76 2517.25,-26276.76"/>
</g>
<!-- layer27_moe_expert4 -->
<g id="node1267" class="node">
<title>layer27_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2933,-26266.38 2605,-26266.38 2605,-26214.38 2933,-26214.38 2933,-26266.38"/>
<text text-anchor="middle" x="2769" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 4 L27</text>
<text text-anchor="middle" x="2769" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2769" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2769" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert4 -->
<g id="node1296" class="node">
<title>layer27_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3191" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3191" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3191" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3191" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer27_moe_expert4&#45;&gt;layer27_moe_comm_from_expert4 -->
<g id="edge1655" class="edge">
<title>layer27_moe_expert4&#45;&gt;layer27_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2901.16,-26214.14C2901.16,-26207.4 2901.16,-26202 2901.16,-26202 2901.16,-26202 3189.75,-26202 3189.75,-26202 3189.75,-26202 3189.75,-26188.47 3189.75,-26188.47"/>
<polygon fill="black" stroke="black" points="3193.25,-26188.47 3189.75,-26178.47 3186.25,-26188.47 3193.25,-26188.47"/>
</g>
<!-- layer27_moe_comm_to_expert4&#45;&gt;layer27_moe_expert4 -->
<g id="edge1624" class="edge">
<title>layer27_moe_comm_to_expert4&#45;&gt;layer27_moe_expert4</title>
<path fill="none" stroke="black" d="M3003.39,-26331C2970.83,-26331 2942,-26331 2942,-26331 2942,-26331 2942,-26240 2942,-26240 2942,-26240 2941.12,-26240 2941.12,-26240"/>
<polygon fill="black" stroke="black" points="2943.18,-26236.5 2933.18,-26240 2943.18,-26243.5 2943.18,-26236.5"/>
</g>
<!-- layer27_moe_expert5 -->
<g id="node1269" class="node">
<title>layer27_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3279,-26266.38 2951,-26266.38 2951,-26214.38 3279,-26214.38 3279,-26266.38"/>
<text text-anchor="middle" x="3115" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 5 L27</text>
<text text-anchor="middle" x="3115" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3115" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3115" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert5 -->
<g id="node1297" class="node">
<title>layer27_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3422" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3422" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3422" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3422" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer27_moe_expert5&#45;&gt;layer27_moe_comm_from_expert5 -->
<g id="edge1657" class="edge">
<title>layer27_moe_expert5&#45;&gt;layer27_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3279.18,-26240C3284.77,-26240 3288,-26240 3288,-26240 3288,-26240 3288,-26149 3288,-26149 3288,-26149 3321.14,-26149 3321.14,-26149"/>
<polygon fill="black" stroke="black" points="3321.14,-26152.5 3331.14,-26149 3321.14,-26145.5 3321.14,-26152.5"/>
</g>
<!-- layer27_moe_comm_to_expert5&#45;&gt;layer27_moe_expert5 -->
<g id="edge1626" class="edge">
<title>layer27_moe_comm_to_expert5&#45;&gt;layer27_moe_expert5</title>
<path fill="none" stroke="black" d="M3254.75,-26311.18C3254.75,-26311.18 3254.75,-26276.4 3254.75,-26276.4"/>
<polygon fill="black" stroke="black" points="3258.25,-26276.4 3254.75,-26266.4 3251.25,-26276.4 3258.25,-26276.4"/>
</g>
<!-- layer27_moe_expert6 -->
<g id="node1271" class="node">
<title>layer27_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3625,-26266.38 3297,-26266.38 3297,-26214.38 3625,-26214.38 3625,-26266.38"/>
<text text-anchor="middle" x="3461" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 6 L27</text>
<text text-anchor="middle" x="3461" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3461" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3461" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert6 -->
<g id="node1298" class="node">
<title>layer27_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3637" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3637" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3637" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3637" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer27_moe_expert6&#45;&gt;layer27_moe_comm_from_expert6 -->
<g id="edge1659" class="edge">
<title>layer27_moe_expert6&#45;&gt;layer27_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3585.75,-26214.07C3585.75,-26214.07 3585.75,-26183.47 3585.75,-26183.47"/>
<polygon fill="black" stroke="black" points="3589.25,-26183.47 3585.75,-26173.47 3582.25,-26183.47 3589.25,-26183.47"/>
</g>
<!-- layer27_moe_comm_to_expert6&#45;&gt;layer27_moe_expert6 -->
<g id="edge1628" class="edge">
<title>layer27_moe_comm_to_expert6&#45;&gt;layer27_moe_expert6</title>
<path fill="none" stroke="black" d="M3534,-26302.33C3534,-26302.33 3534,-26276.69 3534,-26276.69"/>
<polygon fill="black" stroke="black" points="3537.5,-26276.69 3534,-26266.69 3530.5,-26276.69 3537.5,-26276.69"/>
</g>
<!-- layer27_moe_expert7 -->
<g id="node1273" class="node">
<title>layer27_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3971,-26266.38 3643,-26266.38 3643,-26214.38 3971,-26214.38 3971,-26266.38"/>
<text text-anchor="middle" x="3807" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 7 L27</text>
<text text-anchor="middle" x="3807" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3807" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3807" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert7 -->
<g id="node1299" class="node">
<title>layer27_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3844" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3844" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3844" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3844" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer27_moe_expert7&#45;&gt;layer27_moe_comm_from_expert7 -->
<g id="edge1661" class="edge">
<title>layer27_moe_expert7&#45;&gt;layer27_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3844,-26214.07C3844,-26214.07 3844,-26188.52 3844,-26188.52"/>
<polygon fill="black" stroke="black" points="3847.5,-26188.52 3844,-26178.52 3840.5,-26188.52 3847.5,-26188.52"/>
</g>
<!-- layer27_moe_comm_to_expert7&#45;&gt;layer27_moe_expert7 -->
<g id="edge1630" class="edge">
<title>layer27_moe_comm_to_expert7&#45;&gt;layer27_moe_expert7</title>
<path fill="none" stroke="black" d="M3844,-26302.33C3844,-26302.33 3844,-26276.69 3844,-26276.69"/>
<polygon fill="black" stroke="black" points="3847.5,-26276.69 3844,-26266.69 3840.5,-26276.69 3847.5,-26276.69"/>
</g>
<!-- layer27_moe_expert8 -->
<g id="node1275" class="node">
<title>layer27_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4317,-26266.38 3989,-26266.38 3989,-26214.38 4317,-26214.38 4317,-26266.38"/>
<text text-anchor="middle" x="4153" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 8 L27</text>
<text text-anchor="middle" x="4153" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4153" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4153" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert8 -->
<g id="node1300" class="node">
<title>layer27_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4116" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4116" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4116" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4116" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer27_moe_expert8&#45;&gt;layer27_moe_comm_from_expert8 -->
<g id="edge1663" class="edge">
<title>layer27_moe_expert8&#45;&gt;layer27_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4116,-26214.07C4116,-26214.07 4116,-26188.52 4116,-26188.52"/>
<polygon fill="black" stroke="black" points="4119.5,-26188.52 4116,-26178.52 4112.5,-26188.52 4119.5,-26188.52"/>
</g>
<!-- layer27_moe_comm_to_expert8&#45;&gt;layer27_moe_expert8 -->
<g id="edge1632" class="edge">
<title>layer27_moe_comm_to_expert8&#45;&gt;layer27_moe_expert8</title>
<path fill="none" stroke="black" d="M4116,-26302.33C4116,-26302.33 4116,-26276.69 4116,-26276.69"/>
<polygon fill="black" stroke="black" points="4119.5,-26276.69 4116,-26266.69 4112.5,-26276.69 4119.5,-26276.69"/>
</g>
<!-- layer27_moe_expert9 -->
<g id="node1277" class="node">
<title>layer27_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4663,-26266.38 4335,-26266.38 4335,-26214.38 4663,-26214.38 4663,-26266.38"/>
<text text-anchor="middle" x="4499" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 9 L27</text>
<text text-anchor="middle" x="4499" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4499" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4499" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert9 -->
<g id="node1301" class="node">
<title>layer27_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4425" cy="-26149.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4425" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4425" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4425" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer27_moe_expert9&#45;&gt;layer27_moe_comm_from_expert9 -->
<g id="edge1665" class="edge">
<title>layer27_moe_expert9&#45;&gt;layer27_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4425.25,-26214.07C4425.25,-26214.07 4425.25,-26188.52 4425.25,-26188.52"/>
<polygon fill="black" stroke="black" points="4428.75,-26188.52 4425.25,-26178.52 4421.75,-26188.52 4428.75,-26188.52"/>
</g>
<!-- layer27_moe_comm_to_expert9&#45;&gt;layer27_moe_expert9 -->
<g id="edge1634" class="edge">
<title>layer27_moe_comm_to_expert9&#45;&gt;layer27_moe_expert9</title>
<path fill="none" stroke="black" d="M4425.25,-26302.33C4425.25,-26302.33 4425.25,-26276.69 4425.25,-26276.69"/>
<polygon fill="black" stroke="black" points="4428.75,-26276.69 4425.25,-26266.69 4421.75,-26276.69 4428.75,-26276.69"/>
</g>
<!-- layer27_moe_expert10 -->
<g id="node1279" class="node">
<title>layer27_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="5019,-26266.38 4681,-26266.38 4681,-26214.38 5019,-26214.38 5019,-26266.38"/>
<text text-anchor="middle" x="4850" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 10 L27</text>
<text text-anchor="middle" x="4850" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4850" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4850" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert10 -->
<g id="node1302" class="node">
<title>layer27_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4757" cy="-26149.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4757" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4757" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4757" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer27_moe_expert10&#45;&gt;layer27_moe_comm_from_expert10 -->
<g id="edge1667" class="edge">
<title>layer27_moe_expert10&#45;&gt;layer27_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4766.38,-26214.07C4766.38,-26214.07 4766.38,-26188.52 4766.38,-26188.52"/>
<polygon fill="black" stroke="black" points="4769.88,-26188.52 4766.38,-26178.52 4762.88,-26188.52 4769.88,-26188.52"/>
</g>
<!-- layer27_moe_comm_to_expert10&#45;&gt;layer27_moe_expert10 -->
<g id="edge1636" class="edge">
<title>layer27_moe_comm_to_expert10&#45;&gt;layer27_moe_expert10</title>
<path fill="none" stroke="black" d="M4766.02,-26302.33C4766.02,-26302.33 4766.02,-26276.69 4766.02,-26276.69"/>
<polygon fill="black" stroke="black" points="4769.52,-26276.69 4766.02,-26266.69 4762.52,-26276.69 4769.52,-26276.69"/>
</g>
<!-- layer27_moe_expert11 -->
<g id="node1281" class="node">
<title>layer27_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5375,-26266.38 5037,-26266.38 5037,-26214.38 5375,-26214.38 5375,-26266.38"/>
<text text-anchor="middle" x="5206" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 11 L27</text>
<text text-anchor="middle" x="5206" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5206" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5206" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert11 -->
<g id="node1303" class="node">
<title>layer27_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5104" cy="-26149.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5104" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5104" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5104" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer27_moe_expert11&#45;&gt;layer27_moe_comm_from_expert11 -->
<g id="edge1669" class="edge">
<title>layer27_moe_expert11&#45;&gt;layer27_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5117.88,-26214.07C5117.88,-26214.07 5117.88,-26188.2 5117.88,-26188.2"/>
<polygon fill="black" stroke="black" points="5121.38,-26188.2 5117.88,-26178.2 5114.38,-26188.2 5121.38,-26188.2"/>
</g>
<!-- layer27_moe_comm_to_expert11&#45;&gt;layer27_moe_expert11 -->
<g id="edge1638" class="edge">
<title>layer27_moe_comm_to_expert11&#45;&gt;layer27_moe_expert11</title>
<path fill="none" stroke="black" d="M5117.02,-26302.58C5117.02,-26302.58 5117.02,-26276.52 5117.02,-26276.52"/>
<polygon fill="black" stroke="black" points="5120.52,-26276.52 5117.02,-26266.52 5113.52,-26276.52 5120.52,-26276.52"/>
</g>
<!-- layer27_moe_expert12 -->
<g id="node1283" class="node">
<title>layer27_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5731,-26266.38 5393,-26266.38 5393,-26214.38 5731,-26214.38 5731,-26266.38"/>
<text text-anchor="middle" x="5562" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 12 L27</text>
<text text-anchor="middle" x="5562" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5562" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5562" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert12 -->
<g id="node1304" class="node">
<title>layer27_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5455" cy="-26149.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5455" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5455" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5455" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer27_moe_expert12&#45;&gt;layer27_moe_comm_from_expert12 -->
<g id="edge1671" class="edge">
<title>layer27_moe_expert12&#45;&gt;layer27_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5471.38,-26214.07C5471.38,-26214.07 5471.38,-26188.2 5471.38,-26188.2"/>
<polygon fill="black" stroke="black" points="5474.88,-26188.2 5471.38,-26178.2 5467.88,-26188.2 5474.88,-26188.2"/>
</g>
<!-- layer27_moe_comm_to_expert12&#45;&gt;layer27_moe_expert12 -->
<g id="edge1640" class="edge">
<title>layer27_moe_comm_to_expert12&#45;&gt;layer27_moe_expert12</title>
<path fill="none" stroke="black" d="M5470.52,-26302.58C5470.52,-26302.58 5470.52,-26276.52 5470.52,-26276.52"/>
<polygon fill="black" stroke="black" points="5474.02,-26276.52 5470.52,-26266.52 5467.02,-26276.52 5474.02,-26276.52"/>
</g>
<!-- layer27_moe_expert13 -->
<g id="node1285" class="node">
<title>layer27_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6087,-26266.38 5749,-26266.38 5749,-26214.38 6087,-26214.38 6087,-26266.38"/>
<text text-anchor="middle" x="5918" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 13 L27</text>
<text text-anchor="middle" x="5918" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5918" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5918" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert13 -->
<g id="node1305" class="node">
<title>layer27_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5809" cy="-26149.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5809" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5809" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5809" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer27_moe_expert13&#45;&gt;layer27_moe_comm_from_expert13 -->
<g id="edge1673" class="edge">
<title>layer27_moe_expert13&#45;&gt;layer27_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5826.38,-26214.07C5826.38,-26214.07 5826.38,-26188.2 5826.38,-26188.2"/>
<polygon fill="black" stroke="black" points="5829.88,-26188.2 5826.38,-26178.2 5822.88,-26188.2 5829.88,-26188.2"/>
</g>
<!-- layer27_moe_comm_to_expert13&#45;&gt;layer27_moe_expert13 -->
<g id="edge1642" class="edge">
<title>layer27_moe_comm_to_expert13&#45;&gt;layer27_moe_expert13</title>
<path fill="none" stroke="black" d="M5825.02,-26302.58C5825.02,-26302.58 5825.02,-26276.52 5825.02,-26276.52"/>
<polygon fill="black" stroke="black" points="5828.52,-26276.52 5825.02,-26266.52 5821.52,-26276.52 5828.52,-26276.52"/>
</g>
<!-- layer27_moe_expert14 -->
<g id="node1287" class="node">
<title>layer27_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6443,-26266.38 6105,-26266.38 6105,-26214.38 6443,-26214.38 6443,-26266.38"/>
<text text-anchor="middle" x="6274" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 14 L27</text>
<text text-anchor="middle" x="6274" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6274" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6274" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert14 -->
<g id="node1306" class="node">
<title>layer27_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6164" cy="-26149.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6164" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6164" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6164" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer27_moe_expert14&#45;&gt;layer27_moe_comm_from_expert14 -->
<g id="edge1675" class="edge">
<title>layer27_moe_expert14&#45;&gt;layer27_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6181.88,-26214.07C6181.88,-26214.07 6181.88,-26187.88 6181.88,-26187.88"/>
<polygon fill="black" stroke="black" points="6185.38,-26187.88 6181.88,-26177.88 6178.38,-26187.88 6185.38,-26187.88"/>
</g>
<!-- layer27_moe_comm_to_expert14&#45;&gt;layer27_moe_expert14 -->
<g id="edge1644" class="edge">
<title>layer27_moe_comm_to_expert14&#45;&gt;layer27_moe_expert14</title>
<path fill="none" stroke="black" d="M6180.52,-26302.58C6180.52,-26302.58 6180.52,-26276.52 6180.52,-26276.52"/>
<polygon fill="black" stroke="black" points="6184.02,-26276.52 6180.52,-26266.52 6177.02,-26276.52 6184.02,-26276.52"/>
</g>
<!-- layer27_moe_expert15 -->
<g id="node1289" class="node">
<title>layer27_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6799,-26266.38 6461,-26266.38 6461,-26214.38 6799,-26214.38 6799,-26266.38"/>
<text text-anchor="middle" x="6630" y="-26254.38" font-family="Arial" font-size="10.00">EXPERT 15 L27</text>
<text text-anchor="middle" x="6630" y="-26243.38" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6630" y="-26232.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6630" y="-26221.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_comm_from_expert15 -->
<g id="node1307" class="node">
<title>layer27_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6519" cy="-26149.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6519" y="-26157.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6519" y="-26146.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6519" y="-26135.89" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer27_moe_expert15&#45;&gt;layer27_moe_comm_from_expert15 -->
<g id="edge1677" class="edge">
<title>layer27_moe_expert15&#45;&gt;layer27_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6537.38,-26214.07C6537.38,-26214.07 6537.38,-26187.88 6537.38,-26187.88"/>
<polygon fill="black" stroke="black" points="6540.88,-26187.88 6537.38,-26177.88 6533.88,-26187.88 6540.88,-26187.88"/>
</g>
<!-- layer27_moe_comm_to_expert15&#45;&gt;layer27_moe_expert15 -->
<g id="edge1646" class="edge">
<title>layer27_moe_comm_to_expert15&#45;&gt;layer27_moe_expert15</title>
<path fill="none" stroke="black" d="M6536.02,-26302.58C6536.02,-26302.58 6536.02,-26276.52 6536.02,-26276.52"/>
<polygon fill="black" stroke="black" points="6539.52,-26276.52 6536.02,-26266.52 6532.52,-26276.52 6539.52,-26276.52"/>
</g>
<!-- layer27_moe_aggregate -->
<g id="node1291" class="node">
<title>layer27_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4205.1,-26084.4 3788.16,-26084.4 3680.9,-25980.4 4097.84,-25980.4 4205.1,-26084.4"/>
<text text-anchor="middle" x="3943" y="-26046.4" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L27</text>
<text text-anchor="middle" x="3943" y="-26035.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3943" y="-26024.4" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3943" y="-26013.4" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_mha -->
<g id="node1308" class="node">
<title>layer28_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4073,-25944.4 3813,-25944.4 3813,-25892.4 4073,-25892.4 4073,-25944.4"/>
<text text-anchor="middle" x="3943" y="-25932.4" font-family="Arial" font-size="10.00">MHA L28</text>
<text text-anchor="middle" x="3943" y="-25921.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3943" y="-25910.4" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3943" y="-25899.4" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer27_moe_aggregate&#45;&gt;layer28_moe_mha -->
<g id="edge1746" class="edge">
<title>layer27_moe_aggregate&#45;&gt;layer28_moe_mha</title>
<path fill="none" stroke="black" d="M3943,-25980.07C3943,-25980.07 3943,-25954.63 3943,-25954.63"/>
<polygon fill="black" stroke="black" points="3946.5,-25954.63 3943,-25944.63 3939.5,-25954.63 3946.5,-25954.63"/>
</g>
<!-- layer27_moe_comm_from_expert0&#45;&gt;layer27_moe_aggregate -->
<g id="edge1648" class="edge">
<title>layer27_moe_comm_from_expert0&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M1516.75,-26139.73C1516.75,-26105.93 1516.75,-25995 1516.75,-25995 1516.75,-25995 3685.88,-25995 3685.88,-25995"/>
<polygon fill="black" stroke="black" points="3685.88,-25998.5 3695.88,-25995 3685.88,-25991.5 3685.88,-25998.5"/>
</g>
<!-- layer27_moe_comm_from_expert1&#45;&gt;layer27_moe_aggregate -->
<g id="edge1650" class="edge">
<title>layer27_moe_comm_from_expert1&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M2228.25,-26138.45C2228.25,-26105.59 2228.25,-26010 2228.25,-26010 2228.25,-26010 3701.3,-26010 3701.3,-26010"/>
<polygon fill="black" stroke="black" points="3701.3,-26013.5 3711.3,-26010 3701.3,-26006.5 3701.3,-26013.5"/>
</g>
<!-- layer27_moe_comm_from_expert2&#45;&gt;layer27_moe_aggregate -->
<g id="edge1652" class="edge">
<title>layer27_moe_comm_from_expert2&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M2672.01,-26131.69C2672.01,-26097.13 2672.01,-26024 2672.01,-26024 2672.01,-26024 3715.59,-26024 3715.59,-26024"/>
<polygon fill="black" stroke="black" points="3715.59,-26027.5 3725.59,-26024 3715.59,-26020.5 3715.59,-26027.5"/>
</g>
<!-- layer27_moe_comm_from_expert3&#45;&gt;layer27_moe_aggregate -->
<g id="edge1654" class="edge">
<title>layer27_moe_comm_from_expert3&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M3000.01,-26131.66C3000.01,-26100.45 3000.01,-26039 3000.01,-26039 3000.01,-26039 3731.28,-26039 3731.28,-26039"/>
<polygon fill="black" stroke="black" points="3731.28,-26042.5 3741.28,-26039 3731.28,-26035.5 3731.28,-26042.5"/>
</g>
<!-- layer27_moe_comm_from_expert4&#45;&gt;layer27_moe_aggregate -->
<g id="edge1656" class="edge">
<title>layer27_moe_comm_from_expert4&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M3270.75,-26135.32C3270.75,-26108.78 3270.75,-26054 3270.75,-26054 3270.75,-26054 3746.63,-26054 3746.63,-26054"/>
<polygon fill="black" stroke="black" points="3746.64,-26057.5 3756.63,-26054 3746.63,-26050.5 3746.64,-26057.5"/>
</g>
<!-- layer27_moe_comm_from_expert5&#45;&gt;layer27_moe_aggregate -->
<g id="edge1658" class="edge">
<title>layer27_moe_comm_from_expert5&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M3492.5,-26131.15C3492.5,-26107.43 3492.5,-26069 3492.5,-26069 3492.5,-26069 3762.04,-26069 3762.04,-26069"/>
<polygon fill="black" stroke="black" points="3762.04,-26072.5 3772.04,-26069 3762.04,-26065.5 3762.04,-26072.5"/>
</g>
<!-- layer27_moe_comm_from_expert6&#45;&gt;layer27_moe_aggregate -->
<g id="edge1660" class="edge">
<title>layer27_moe_comm_from_expert6&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M3704.11,-26129.81C3704.11,-26129.81 3704.11,-26042.45 3704.11,-26042.45"/>
<polygon fill="black" stroke="black" points="3707.61,-26042.45 3704.11,-26032.45 3700.61,-26042.45 3707.61,-26042.45"/>
</g>
<!-- layer27_moe_comm_from_expert7&#45;&gt;layer27_moe_aggregate -->
<g id="edge1662" class="edge">
<title>layer27_moe_comm_from_expert7&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M3844,-26120.17C3844,-26120.17 3844,-26094.46 3844,-26094.46"/>
<polygon fill="black" stroke="black" points="3847.5,-26094.46 3844,-26084.46 3840.5,-26094.46 3847.5,-26094.46"/>
</g>
<!-- layer27_moe_comm_from_expert8&#45;&gt;layer27_moe_aggregate -->
<g id="edge1664" class="edge">
<title>layer27_moe_comm_from_expert8&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M4115.39,-26120.17C4115.39,-26120.17 4115.39,-26094.46 4115.39,-26094.46"/>
<polygon fill="black" stroke="black" points="4118.89,-26094.46 4115.39,-26084.46 4111.89,-26094.46 4118.89,-26094.46"/>
</g>
<!-- layer27_moe_comm_from_expert9&#45;&gt;layer27_moe_aggregate -->
<g id="edge1666" class="edge">
<title>layer27_moe_comm_from_expert9&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M4406.5,-26120.65C4406.5,-26098.27 4406.5,-26071 4406.5,-26071 4406.5,-26071 4201.37,-26071 4201.37,-26071"/>
<polygon fill="black" stroke="black" points="4201.37,-26067.5 4191.37,-26071 4201.37,-26074.5 4201.37,-26067.5"/>
</g>
<!-- layer27_moe_comm_from_expert10&#45;&gt;layer27_moe_aggregate -->
<g id="edge1668" class="edge">
<title>layer27_moe_comm_from_expert10&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M4738.15,-26120.98C4738.15,-26094.15 4738.15,-26058 4738.15,-26058 4738.15,-26058 4188.07,-26058 4188.07,-26058"/>
<polygon fill="black" stroke="black" points="4188.07,-26054.5 4178.07,-26058 4188.07,-26061.5 4188.07,-26054.5"/>
</g>
<!-- layer27_moe_comm_from_expert11&#45;&gt;layer27_moe_aggregate -->
<g id="edge1670" class="edge">
<title>layer27_moe_comm_from_expert11&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M5084.65,-26120.87C5084.65,-26089.96 5084.65,-26045 5084.65,-26045 5084.65,-26045 4174.47,-26045 4174.47,-26045"/>
<polygon fill="black" stroke="black" points="4174.47,-26041.5 4164.47,-26045 4174.47,-26048.5 4174.47,-26041.5"/>
</g>
<!-- layer27_moe_comm_from_expert12&#45;&gt;layer27_moe_aggregate -->
<g id="edge1672" class="edge">
<title>layer27_moe_comm_from_expert12&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M5435.65,-26120.97C5435.65,-26086.23 5435.65,-26032 5435.65,-26032 5435.65,-26032 4161.33,-26032 4161.33,-26032"/>
<polygon fill="black" stroke="black" points="4161.33,-26028.5 4151.33,-26032 4161.33,-26035.5 4161.33,-26028.5"/>
</g>
<!-- layer27_moe_comm_from_expert13&#45;&gt;layer27_moe_aggregate -->
<g id="edge1674" class="edge">
<title>layer27_moe_comm_from_expert13&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M5789.15,-26120.78C5789.15,-26082.39 5789.15,-26019 5789.15,-26019 5789.15,-26019 4147.95,-26019 4147.95,-26019"/>
<polygon fill="black" stroke="black" points="4147.95,-26015.5 4137.95,-26019 4147.95,-26022.5 4147.95,-26015.5"/>
</g>
<!-- layer27_moe_comm_from_expert14&#45;&gt;layer27_moe_aggregate -->
<g id="edge1676" class="edge">
<title>layer27_moe_comm_from_expert14&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M6144.15,-26120.72C6144.15,-26078.87 6144.15,-26006 6144.15,-26006 6144.15,-26006 4134.53,-26006 4134.53,-26006"/>
<polygon fill="black" stroke="black" points="4134.53,-26002.5 4124.53,-26006 4134.53,-26009.5 4134.53,-26002.5"/>
</g>
<!-- layer27_moe_comm_from_expert15&#45;&gt;layer27_moe_aggregate -->
<g id="edge1678" class="edge">
<title>layer27_moe_comm_from_expert15&#45;&gt;layer27_moe_aggregate</title>
<path fill="none" stroke="black" d="M6499.15,-26120.71C6499.15,-26075.56 6499.15,-25993 6499.15,-25993 6499.15,-25993 4121.21,-25993 4121.21,-25993"/>
<polygon fill="black" stroke="black" points="4121.21,-25989.5 4111.21,-25993 4121.21,-25996.5 4121.21,-25989.5"/>
</g>
<!-- layer28_moe_gate -->
<g id="node1309" class="node">
<title>layer28_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4201.3,-25856.4 3790.4,-25856.4 3684.7,-25752.4 4095.6,-25752.4 4201.3,-25856.4"/>
<text text-anchor="middle" x="3943" y="-25818.4" font-family="Arial" font-size="10.00">GATE L28</text>
<text text-anchor="middle" x="3943" y="-25807.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3943" y="-25796.4" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3943" y="-25785.4" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer28_moe_mha&#45;&gt;layer28_moe_gate -->
<g id="edge1747" class="edge">
<title>layer28_moe_mha&#45;&gt;layer28_moe_gate</title>
<path fill="none" stroke="black" d="M3943,-25892.25C3943,-25892.25 3943,-25866.5 3943,-25866.5"/>
<polygon fill="black" stroke="black" points="3946.5,-25866.5 3943,-25856.5 3939.5,-25866.5 3946.5,-25866.5"/>
</g>
<!-- layer28_moe_split -->
<g id="node1310" class="node">
<title>layer28_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4197.01,-25716.4 3792.94,-25716.4 3688.99,-25612.4 4093.06,-25612.4 4197.01,-25716.4"/>
<text text-anchor="middle" x="3943" y="-25678.4" font-family="Arial" font-size="10.00">SPLIT TOKENS L28</text>
<text text-anchor="middle" x="3943" y="-25667.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3943" y="-25656.4" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3943" y="-25645.4" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer28_moe_gate&#45;&gt;layer28_moe_split -->
<g id="edge1748" class="edge">
<title>layer28_moe_gate&#45;&gt;layer28_moe_split</title>
<path fill="none" stroke="black" d="M3943,-25752.27C3943,-25752.27 3943,-25726.58 3943,-25726.58"/>
<polygon fill="black" stroke="black" points="3946.5,-25726.58 3943,-25716.58 3939.5,-25726.58 3946.5,-25726.58"/>
</g>
<!-- layer28_moe_comm_to_expert0 -->
<g id="node1312" class="node">
<title>layer28_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1394" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1394" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1394" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1394" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert0 -->
<g id="edge1682" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3777.46,-25701C3215.04,-25701 1412.5,-25701 1412.5,-25701 1412.5,-25701 1412.5,-25585.94 1412.5,-25585.94"/>
<polygon fill="black" stroke="black" points="1416,-25585.94 1412.5,-25575.94 1409,-25585.94 1416,-25585.94"/>
</g>
<!-- layer28_moe_comm_to_expert1 -->
<g id="node1314" class="node">
<title>layer28_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2107" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2107" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2107" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2107" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert1 -->
<g id="edge1684" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3762.5,-25686C3303.09,-25686 2125.5,-25686 2125.5,-25686 2125.5,-25686 2125.5,-25585.79 2125.5,-25585.79"/>
<polygon fill="black" stroke="black" points="2129,-25585.79 2125.5,-25575.79 2122,-25585.79 2129,-25585.79"/>
</g>
<!-- layer28_moe_comm_to_expert2 -->
<g id="node1316" class="node">
<title>layer28_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2563" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2563" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2563" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2563" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert2 -->
<g id="edge1686" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3747.21,-25671C3370.45,-25671 2581.5,-25671 2581.5,-25671 2581.5,-25671 2581.5,-25586.07 2581.5,-25586.07"/>
<polygon fill="black" stroke="black" points="2585,-25586.07 2581.5,-25576.07 2578,-25586.07 2585,-25586.07"/>
</g>
<!-- layer28_moe_comm_to_expert3 -->
<g id="node1318" class="node">
<title>layer28_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2891" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2891" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2891" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2891" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert3 -->
<g id="edge1688" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3732.3,-25656C3430.07,-25656 2909.5,-25656 2909.5,-25656 2909.5,-25656 2909.5,-25585.94 2909.5,-25585.94"/>
<polygon fill="black" stroke="black" points="2913,-25585.94 2909.5,-25575.94 2906,-25585.94 2913,-25585.94"/>
</g>
<!-- layer28_moe_comm_to_expert4 -->
<g id="node1320" class="node">
<title>layer28_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3154" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3154" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3154" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3154" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert4 -->
<g id="edge1690" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3718.33,-25642C3490.89,-25642 3172.5,-25642 3172.5,-25642 3172.5,-25642 3172.5,-25585.79 3172.5,-25585.79"/>
<polygon fill="black" stroke="black" points="3176,-25585.79 3172.5,-25575.79 3169,-25585.79 3176,-25585.79"/>
</g>
<!-- layer28_moe_comm_to_expert5 -->
<g id="node1322" class="node">
<title>layer28_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3385" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3385" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3385" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3385" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert5 -->
<g id="edge1692" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3703.23,-25627C3559.14,-25627 3403.5,-25627 3403.5,-25627 3403.5,-25627 3403.5,-25586.14 3403.5,-25586.14"/>
<polygon fill="black" stroke="black" points="3407,-25586.14 3403.5,-25576.14 3400,-25586.14 3407,-25586.14"/>
</g>
<!-- layer28_moe_comm_to_expert6 -->
<g id="node1324" class="node">
<title>layer28_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3600" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3600" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3600" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3600" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert6 -->
<g id="edge1694" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3703.5,-25664.32C3703.5,-25660.76 3703.5,-25547 3703.5,-25547 3703.5,-25547 3700.81,-25547 3700.81,-25547"/>
<polygon fill="black" stroke="black" points="3700.81,-25543.5 3690.81,-25547 3700.81,-25550.5 3700.81,-25543.5"/>
</g>
<!-- layer28_moe_comm_to_expert7 -->
<g id="node1326" class="node">
<title>layer28_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3807" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3807" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3807" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3807" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert7 -->
<g id="edge1696" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3807,-25612.06C3807,-25612.06 3807,-25586.62 3807,-25586.62"/>
<polygon fill="black" stroke="black" points="3810.5,-25586.62 3807,-25576.62 3803.5,-25586.62 3810.5,-25586.62"/>
</g>
<!-- layer28_moe_comm_to_expert8 -->
<g id="node1328" class="node">
<title>layer28_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4079" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4079" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4079" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4079" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert8 -->
<g id="edge1698" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4079,-25612.06C4079,-25612.06 4079,-25586.62 4079,-25586.62"/>
<polygon fill="black" stroke="black" points="4082.5,-25586.62 4079,-25576.62 4075.5,-25586.62 4082.5,-25586.62"/>
</g>
<!-- layer28_moe_comm_to_expert9 -->
<g id="node1330" class="node">
<title>layer28_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4388" cy="-25547.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4388" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4388" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4388" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert9 -->
<g id="edge1700" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4183.26,-25664.32C4183.26,-25660.76 4183.26,-25547 4183.26,-25547 4183.26,-25547 4287.3,-25547 4287.3,-25547"/>
<polygon fill="black" stroke="black" points="4287.3,-25550.5 4297.3,-25547 4287.3,-25543.5 4287.3,-25550.5"/>
</g>
<!-- layer28_moe_comm_to_expert10 -->
<g id="node1332" class="node">
<title>layer28_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4720" cy="-25547.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4720" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4720" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4720" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert10 -->
<g id="edge1702" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4107.82,-25627C4315.07,-25627 4644.1,-25627 4644.1,-25627 4644.1,-25627 4644.1,-25574.68 4644.1,-25574.68"/>
<polygon fill="black" stroke="black" points="4647.6,-25574.68 4644.1,-25564.68 4640.6,-25574.68 4647.6,-25574.68"/>
</g>
<!-- layer28_moe_comm_to_expert11 -->
<g id="node1334" class="node">
<title>layer28_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5066" cy="-25547.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5066" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5066" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5066" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert11 -->
<g id="edge1704" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4122.79,-25642C4422.24,-25642 4990.6,-25642 4990.6,-25642 4990.6,-25642 4990.6,-25574.76 4990.6,-25574.76"/>
<polygon fill="black" stroke="black" points="4994.1,-25574.76 4990.6,-25564.76 4987.1,-25574.76 4994.1,-25574.76"/>
</g>
<!-- layer28_moe_comm_to_expert12 -->
<g id="node1336" class="node">
<title>layer28_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5417" cy="-25547.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5417" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5417" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5417" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert12 -->
<g id="edge1706" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4136.73,-25656C4520.72,-25656 5341.6,-25656 5341.6,-25656 5341.6,-25656 5341.6,-25574.86 5341.6,-25574.86"/>
<polygon fill="black" stroke="black" points="5345.1,-25574.86 5341.6,-25564.86 5338.1,-25574.86 5345.1,-25574.86"/>
</g>
<!-- layer28_moe_comm_to_expert13 -->
<g id="node1338" class="node">
<title>layer28_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5770" cy="-25547.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5770" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5770" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5770" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert13 -->
<g id="edge1708" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4151.74,-25671C4616.33,-25671 5695.1,-25671 5695.1,-25671 5695.1,-25671 5695.1,-25575.12 5695.1,-25575.12"/>
<polygon fill="black" stroke="black" points="5698.6,-25575.12 5695.1,-25565.12 5691.6,-25575.12 5698.6,-25575.12"/>
</g>
<!-- layer28_moe_comm_to_expert14 -->
<g id="node1340" class="node">
<title>layer28_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6125" cy="-25547.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6125" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6125" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6125" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert14 -->
<g id="edge1710" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4167,-25686C4709.61,-25686 6050.1,-25686 6050.1,-25686 6050.1,-25686 6050.1,-25574.96 6050.1,-25574.96"/>
<polygon fill="black" stroke="black" points="6053.6,-25574.96 6050.1,-25564.96 6046.6,-25574.96 6053.6,-25574.96"/>
</g>
<!-- layer28_moe_comm_to_expert15 -->
<g id="node1342" class="node">
<title>layer28_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6480" cy="-25547.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6480" y="-25555.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6480" y="-25544.91" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6480" y="-25533.91" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert15 -->
<g id="edge1712" class="edge">
<title>layer28_moe_split&#45;&gt;layer28_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4181.87,-25701C4800.18,-25701 6405.1,-25701 6405.1,-25701 6405.1,-25701 6405.1,-25575.03 6405.1,-25575.03"/>
<polygon fill="black" stroke="black" points="6408.6,-25575.03 6405.1,-25565.03 6401.6,-25575.03 6408.6,-25575.03"/>
</g>
<!-- layer28_moe_expert0 -->
<g id="node1311" class="node">
<title>layer28_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1512,-25482.42 1184,-25482.42 1184,-25430.42 1512,-25430.42 1512,-25482.42"/>
<text text-anchor="middle" x="1348" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 0 L28</text>
<text text-anchor="middle" x="1348" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1348" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1348" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert0 -->
<g id="node1344" class="node">
<title>layer28_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1394" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1394" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1394" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1394" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer28_moe_expert0&#45;&gt;layer28_moe_comm_from_expert0 -->
<g id="edge1714" class="edge">
<title>layer28_moe_expert0&#45;&gt;layer28_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1394,-25430.1C1394,-25430.1 1394,-25404.56 1394,-25404.56"/>
<polygon fill="black" stroke="black" points="1397.5,-25404.56 1394,-25394.56 1390.5,-25404.56 1397.5,-25404.56"/>
</g>
<!-- layer28_moe_comm_to_expert0&#45;&gt;layer28_moe_expert0 -->
<g id="edge1683" class="edge">
<title>layer28_moe_comm_to_expert0&#45;&gt;layer28_moe_expert0</title>
<path fill="none" stroke="black" d="M1394,-25518.37C1394,-25518.37 1394,-25492.72 1394,-25492.72"/>
<polygon fill="black" stroke="black" points="1397.5,-25492.72 1394,-25482.72 1390.5,-25492.72 1397.5,-25492.72"/>
</g>
<!-- layer28_moe_expert1 -->
<g id="node1313" class="node">
<title>layer28_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1858,-25482.42 1530,-25482.42 1530,-25430.42 1858,-25430.42 1858,-25482.42"/>
<text text-anchor="middle" x="1694" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 1 L28</text>
<text text-anchor="middle" x="1694" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1694" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1694" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert1 -->
<g id="node1345" class="node">
<title>layer28_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="2107" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2107" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="2107" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2107" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer28_moe_expert1&#45;&gt;layer28_moe_comm_from_expert1 -->
<g id="edge1716" class="edge">
<title>layer28_moe_expert1&#45;&gt;layer28_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1850.25,-25429.98C1850.25,-25402.98 1850.25,-25365 1850.25,-25365 1850.25,-25365 2006.48,-25365 2006.48,-25365"/>
<polygon fill="black" stroke="black" points="2006.48,-25368.5 2016.48,-25365 2006.48,-25361.5 2006.48,-25368.5"/>
</g>
<!-- layer28_moe_comm_to_expert1&#45;&gt;layer28_moe_expert1 -->
<g id="edge1685" class="edge">
<title>layer28_moe_comm_to_expert1&#45;&gt;layer28_moe_expert1</title>
<path fill="none" stroke="black" d="M2016.49,-25547C1900.02,-25547 1712.5,-25547 1712.5,-25547 1712.5,-25547 1712.5,-25492.62 1712.5,-25492.62"/>
<polygon fill="black" stroke="black" points="1716,-25492.62 1712.5,-25482.62 1709,-25492.62 1716,-25492.62"/>
</g>
<!-- layer28_moe_expert2 -->
<g id="node1315" class="node">
<title>layer28_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2204,-25482.42 1876,-25482.42 1876,-25430.42 2204,-25430.42 2204,-25482.42"/>
<text text-anchor="middle" x="2040" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 2 L28</text>
<text text-anchor="middle" x="2040" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2040" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2040" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert2 -->
<g id="node1346" class="node">
<title>layer28_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2563" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2563" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2563" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2563" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer28_moe_expert2&#45;&gt;layer28_moe_comm_from_expert2 -->
<g id="edge1718" class="edge">
<title>layer28_moe_expert2&#45;&gt;layer28_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2204.18,-25447C2211.6,-25447 2216,-25447 2216,-25447 2216,-25447 2216,-25365 2216,-25365 2216,-25365 2462.28,-25365 2462.28,-25365"/>
<polygon fill="black" stroke="black" points="2462.28,-25368.5 2472.28,-25365 2462.28,-25361.5 2462.28,-25368.5"/>
</g>
<!-- layer28_moe_comm_to_expert2&#45;&gt;layer28_moe_expert2 -->
<g id="edge1687" class="edge">
<title>layer28_moe_comm_to_expert2&#45;&gt;layer28_moe_expert2</title>
<path fill="none" stroke="black" d="M2472.09,-25547C2367.5,-25547 2210,-25547 2210,-25547 2210,-25547 2210,-25465 2210,-25465 2210,-25465 2209.43,-25465 2209.43,-25465"/>
<polygon fill="black" stroke="black" points="2214.34,-25461.5 2204.34,-25465 2214.34,-25468.5 2214.34,-25461.5"/>
</g>
<!-- layer28_moe_expert3 -->
<g id="node1317" class="node">
<title>layer28_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2550,-25482.42 2222,-25482.42 2222,-25430.42 2550,-25430.42 2550,-25482.42"/>
<text text-anchor="middle" x="2386" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 3 L28</text>
<text text-anchor="middle" x="2386" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2386" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2386" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert3 -->
<g id="node1347" class="node">
<title>layer28_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2891" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2891" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2891" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2891" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer28_moe_expert3&#45;&gt;layer28_moe_comm_from_expert3 -->
<g id="edge1720" class="edge">
<title>layer28_moe_expert3&#45;&gt;layer28_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2511.25,-25430.32C2511.25,-25418.02 2511.25,-25406 2511.25,-25406 2511.25,-25406 2832.33,-25406 2832.33,-25406 2832.33,-25406 2832.33,-25397.61 2832.33,-25397.61"/>
<polygon fill="black" stroke="black" points="2835.83,-25397.61 2832.33,-25387.61 2828.83,-25397.61 2835.83,-25397.61"/>
</g>
<!-- layer28_moe_comm_to_expert3&#45;&gt;layer28_moe_expert3 -->
<g id="edge1689" class="edge">
<title>layer28_moe_comm_to_expert3&#45;&gt;layer28_moe_expert3</title>
<path fill="none" stroke="black" d="M2832.33,-25525.25C2832.33,-25515.4 2832.33,-25506 2832.33,-25506 2832.33,-25506 2511.25,-25506 2511.25,-25506 2511.25,-25506 2511.25,-25492.66 2511.25,-25492.66"/>
<polygon fill="black" stroke="black" points="2514.75,-25492.66 2511.25,-25482.66 2507.75,-25492.66 2514.75,-25492.66"/>
</g>
<!-- layer28_moe_expert4 -->
<g id="node1319" class="node">
<title>layer28_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2896,-25482.42 2568,-25482.42 2568,-25430.42 2896,-25430.42 2896,-25482.42"/>
<text text-anchor="middle" x="2732" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 4 L28</text>
<text text-anchor="middle" x="2732" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2732" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2732" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert4 -->
<g id="node1348" class="node">
<title>layer28_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3154" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3154" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3154" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3154" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer28_moe_expert4&#45;&gt;layer28_moe_comm_from_expert4 -->
<g id="edge1722" class="edge">
<title>layer28_moe_expert4&#45;&gt;layer28_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2864.16,-25430.16C2864.16,-25423.4 2864.16,-25418 2864.16,-25418 2864.16,-25418 3152.75,-25418 3152.75,-25418 3152.75,-25418 3152.75,-25404.48 3152.75,-25404.48"/>
<polygon fill="black" stroke="black" points="3156.25,-25404.48 3152.75,-25394.48 3149.25,-25404.48 3156.25,-25404.48"/>
</g>
<!-- layer28_moe_comm_to_expert4&#45;&gt;layer28_moe_expert4 -->
<g id="edge1691" class="edge">
<title>layer28_moe_comm_to_expert4&#45;&gt;layer28_moe_expert4</title>
<path fill="none" stroke="black" d="M3152.75,-25518.2C3152.75,-25505.74 3152.75,-25494 3152.75,-25494 3152.75,-25494 2864.16,-25494 2864.16,-25494 2864.16,-25494 2864.16,-25492.52 2864.16,-25492.52"/>
<polygon fill="black" stroke="black" points="2867.66,-25492.52 2864.16,-25482.52 2860.66,-25492.52 2867.66,-25492.52"/>
</g>
<!-- layer28_moe_expert5 -->
<g id="node1321" class="node">
<title>layer28_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3242,-25482.42 2914,-25482.42 2914,-25430.42 3242,-25430.42 3242,-25482.42"/>
<text text-anchor="middle" x="3078" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 5 L28</text>
<text text-anchor="middle" x="3078" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3078" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3078" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert5 -->
<g id="node1349" class="node">
<title>layer28_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3385" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3385" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3385" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3385" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer28_moe_expert5&#45;&gt;layer28_moe_comm_from_expert5 -->
<g id="edge1724" class="edge">
<title>layer28_moe_expert5&#45;&gt;layer28_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3242.12,-25447C3250.08,-25447 3254.84,-25447 3254.84,-25447 3254.84,-25447 3254.84,-25365 3254.84,-25365 3254.84,-25365 3284.24,-25365 3284.24,-25365"/>
<polygon fill="black" stroke="black" points="3284.24,-25368.5 3294.24,-25365 3284.24,-25361.5 3284.24,-25368.5"/>
</g>
<!-- layer28_moe_comm_to_expert5&#45;&gt;layer28_moe_expert5 -->
<g id="edge1693" class="edge">
<title>layer28_moe_comm_to_expert5&#45;&gt;layer28_moe_expert5</title>
<path fill="none" stroke="black" d="M3294.36,-25547C3269.71,-25547 3249.67,-25547 3249.67,-25547 3249.67,-25547 3249.67,-25465 3249.67,-25465 3249.67,-25465 3248.94,-25465 3248.94,-25465"/>
<polygon fill="black" stroke="black" points="3252.3,-25461.5 3242.3,-25465 3252.3,-25468.5 3252.3,-25461.5"/>
</g>
<!-- layer28_moe_expert6 -->
<g id="node1323" class="node">
<title>layer28_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3588,-25482.42 3260,-25482.42 3260,-25430.42 3588,-25430.42 3588,-25482.42"/>
<text text-anchor="middle" x="3424" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 6 L28</text>
<text text-anchor="middle" x="3424" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3424" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3424" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert6 -->
<g id="node1350" class="node">
<title>layer28_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3600" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3600" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3600" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3600" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer28_moe_expert6&#45;&gt;layer28_moe_comm_from_expert6 -->
<g id="edge1726" class="edge">
<title>layer28_moe_expert6&#45;&gt;layer28_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3548.75,-25430.1C3548.75,-25430.1 3548.75,-25399.51 3548.75,-25399.51"/>
<polygon fill="black" stroke="black" points="3552.25,-25399.51 3548.75,-25389.51 3545.25,-25399.51 3552.25,-25399.51"/>
</g>
<!-- layer28_moe_comm_to_expert6&#45;&gt;layer28_moe_expert6 -->
<g id="edge1695" class="edge">
<title>layer28_moe_comm_to_expert6&#45;&gt;layer28_moe_expert6</title>
<path fill="none" stroke="black" d="M3548.75,-25523.5C3548.75,-25523.5 3548.75,-25492.73 3548.75,-25492.73"/>
<polygon fill="black" stroke="black" points="3552.25,-25492.73 3548.75,-25482.73 3545.25,-25492.73 3552.25,-25492.73"/>
</g>
<!-- layer28_moe_expert7 -->
<g id="node1325" class="node">
<title>layer28_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3934,-25482.42 3606,-25482.42 3606,-25430.42 3934,-25430.42 3934,-25482.42"/>
<text text-anchor="middle" x="3770" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 7 L28</text>
<text text-anchor="middle" x="3770" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3770" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3770" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert7 -->
<g id="node1351" class="node">
<title>layer28_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3807" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3807" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3807" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3807" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer28_moe_expert7&#45;&gt;layer28_moe_comm_from_expert7 -->
<g id="edge1728" class="edge">
<title>layer28_moe_expert7&#45;&gt;layer28_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3807,-25430.1C3807,-25430.1 3807,-25404.56 3807,-25404.56"/>
<polygon fill="black" stroke="black" points="3810.5,-25404.56 3807,-25394.56 3803.5,-25404.56 3810.5,-25404.56"/>
</g>
<!-- layer28_moe_comm_to_expert7&#45;&gt;layer28_moe_expert7 -->
<g id="edge1697" class="edge">
<title>layer28_moe_comm_to_expert7&#45;&gt;layer28_moe_expert7</title>
<path fill="none" stroke="black" d="M3807,-25518.37C3807,-25518.37 3807,-25492.72 3807,-25492.72"/>
<polygon fill="black" stroke="black" points="3810.5,-25492.72 3807,-25482.72 3803.5,-25492.72 3810.5,-25492.72"/>
</g>
<!-- layer28_moe_expert8 -->
<g id="node1327" class="node">
<title>layer28_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4280,-25482.42 3952,-25482.42 3952,-25430.42 4280,-25430.42 4280,-25482.42"/>
<text text-anchor="middle" x="4116" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 8 L28</text>
<text text-anchor="middle" x="4116" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4116" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4116" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert8 -->
<g id="node1352" class="node">
<title>layer28_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4079" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4079" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4079" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4079" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer28_moe_expert8&#45;&gt;layer28_moe_comm_from_expert8 -->
<g id="edge1730" class="edge">
<title>layer28_moe_expert8&#45;&gt;layer28_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4079,-25430.1C4079,-25430.1 4079,-25404.56 4079,-25404.56"/>
<polygon fill="black" stroke="black" points="4082.5,-25404.56 4079,-25394.56 4075.5,-25404.56 4082.5,-25404.56"/>
</g>
<!-- layer28_moe_comm_to_expert8&#45;&gt;layer28_moe_expert8 -->
<g id="edge1699" class="edge">
<title>layer28_moe_comm_to_expert8&#45;&gt;layer28_moe_expert8</title>
<path fill="none" stroke="black" d="M4079,-25518.37C4079,-25518.37 4079,-25492.72 4079,-25492.72"/>
<polygon fill="black" stroke="black" points="4082.5,-25492.72 4079,-25482.72 4075.5,-25492.72 4082.5,-25492.72"/>
</g>
<!-- layer28_moe_expert9 -->
<g id="node1329" class="node">
<title>layer28_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4626,-25482.42 4298,-25482.42 4298,-25430.42 4626,-25430.42 4626,-25482.42"/>
<text text-anchor="middle" x="4462" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 9 L28</text>
<text text-anchor="middle" x="4462" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4462" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4462" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert9 -->
<g id="node1353" class="node">
<title>layer28_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4388" cy="-25365.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4388" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4388" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4388" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer28_moe_expert9&#45;&gt;layer28_moe_comm_from_expert9 -->
<g id="edge1732" class="edge">
<title>layer28_moe_expert9&#45;&gt;layer28_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4388.25,-25430.1C4388.25,-25430.1 4388.25,-25404.56 4388.25,-25404.56"/>
<polygon fill="black" stroke="black" points="4391.75,-25404.56 4388.25,-25394.56 4384.75,-25404.56 4391.75,-25404.56"/>
</g>
<!-- layer28_moe_comm_to_expert9&#45;&gt;layer28_moe_expert9 -->
<g id="edge1701" class="edge">
<title>layer28_moe_comm_to_expert9&#45;&gt;layer28_moe_expert9</title>
<path fill="none" stroke="black" d="M4388.25,-25518.37C4388.25,-25518.37 4388.25,-25492.72 4388.25,-25492.72"/>
<polygon fill="black" stroke="black" points="4391.75,-25492.72 4388.25,-25482.72 4384.75,-25492.72 4391.75,-25492.72"/>
</g>
<!-- layer28_moe_expert10 -->
<g id="node1331" class="node">
<title>layer28_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4982,-25482.42 4644,-25482.42 4644,-25430.42 4982,-25430.42 4982,-25482.42"/>
<text text-anchor="middle" x="4813" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 10 L28</text>
<text text-anchor="middle" x="4813" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4813" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4813" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert10 -->
<g id="node1354" class="node">
<title>layer28_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4720" cy="-25365.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4720" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4720" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4720" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer28_moe_expert10&#45;&gt;layer28_moe_comm_from_expert10 -->
<g id="edge1734" class="edge">
<title>layer28_moe_expert10&#45;&gt;layer28_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4729.38,-25430.1C4729.38,-25430.1 4729.38,-25404.56 4729.38,-25404.56"/>
<polygon fill="black" stroke="black" points="4732.88,-25404.56 4729.38,-25394.56 4725.88,-25404.56 4732.88,-25404.56"/>
</g>
<!-- layer28_moe_comm_to_expert10&#45;&gt;layer28_moe_expert10 -->
<g id="edge1703" class="edge">
<title>layer28_moe_comm_to_expert10&#45;&gt;layer28_moe_expert10</title>
<path fill="none" stroke="black" d="M4729.02,-25518.37C4729.02,-25518.37 4729.02,-25492.72 4729.02,-25492.72"/>
<polygon fill="black" stroke="black" points="4732.52,-25492.72 4729.02,-25482.72 4725.52,-25492.72 4732.52,-25492.72"/>
</g>
<!-- layer28_moe_expert11 -->
<g id="node1333" class="node">
<title>layer28_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5338,-25482.42 5000,-25482.42 5000,-25430.42 5338,-25430.42 5338,-25482.42"/>
<text text-anchor="middle" x="5169" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 11 L28</text>
<text text-anchor="middle" x="5169" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5169" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5169" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert11 -->
<g id="node1355" class="node">
<title>layer28_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5067" cy="-25365.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5067" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5067" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5067" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer28_moe_expert11&#45;&gt;layer28_moe_comm_from_expert11 -->
<g id="edge1736" class="edge">
<title>layer28_moe_expert11&#45;&gt;layer28_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5080.88,-25430.1C5080.88,-25430.1 5080.88,-25404.23 5080.88,-25404.23"/>
<polygon fill="black" stroke="black" points="5084.38,-25404.23 5080.88,-25394.23 5077.38,-25404.23 5084.38,-25404.23"/>
</g>
<!-- layer28_moe_comm_to_expert11&#45;&gt;layer28_moe_expert11 -->
<g id="edge1705" class="edge">
<title>layer28_moe_comm_to_expert11&#45;&gt;layer28_moe_expert11</title>
<path fill="none" stroke="black" d="M5080.02,-25518.62C5080.02,-25518.62 5080.02,-25492.55 5080.02,-25492.55"/>
<polygon fill="black" stroke="black" points="5083.52,-25492.55 5080.02,-25482.55 5076.52,-25492.55 5083.52,-25492.55"/>
</g>
<!-- layer28_moe_expert12 -->
<g id="node1335" class="node">
<title>layer28_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5694,-25482.42 5356,-25482.42 5356,-25430.42 5694,-25430.42 5694,-25482.42"/>
<text text-anchor="middle" x="5525" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 12 L28</text>
<text text-anchor="middle" x="5525" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5525" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5525" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert12 -->
<g id="node1356" class="node">
<title>layer28_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5418" cy="-25365.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5418" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5418" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5418" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer28_moe_expert12&#45;&gt;layer28_moe_comm_from_expert12 -->
<g id="edge1738" class="edge">
<title>layer28_moe_expert12&#45;&gt;layer28_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5434.38,-25430.1C5434.38,-25430.1 5434.38,-25404.23 5434.38,-25404.23"/>
<polygon fill="black" stroke="black" points="5437.88,-25404.23 5434.38,-25394.23 5430.88,-25404.23 5437.88,-25404.23"/>
</g>
<!-- layer28_moe_comm_to_expert12&#45;&gt;layer28_moe_expert12 -->
<g id="edge1707" class="edge">
<title>layer28_moe_comm_to_expert12&#45;&gt;layer28_moe_expert12</title>
<path fill="none" stroke="black" d="M5433.52,-25518.62C5433.52,-25518.62 5433.52,-25492.55 5433.52,-25492.55"/>
<polygon fill="black" stroke="black" points="5437.02,-25492.55 5433.52,-25482.55 5430.02,-25492.55 5437.02,-25492.55"/>
</g>
<!-- layer28_moe_expert13 -->
<g id="node1337" class="node">
<title>layer28_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6050,-25482.42 5712,-25482.42 5712,-25430.42 6050,-25430.42 6050,-25482.42"/>
<text text-anchor="middle" x="5881" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 13 L28</text>
<text text-anchor="middle" x="5881" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5881" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5881" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert13 -->
<g id="node1357" class="node">
<title>layer28_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5772" cy="-25365.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5772" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5772" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5772" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer28_moe_expert13&#45;&gt;layer28_moe_comm_from_expert13 -->
<g id="edge1740" class="edge">
<title>layer28_moe_expert13&#45;&gt;layer28_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5789.38,-25430.1C5789.38,-25430.1 5789.38,-25404.23 5789.38,-25404.23"/>
<polygon fill="black" stroke="black" points="5792.88,-25404.23 5789.38,-25394.23 5785.88,-25404.23 5792.88,-25404.23"/>
</g>
<!-- layer28_moe_comm_to_expert13&#45;&gt;layer28_moe_expert13 -->
<g id="edge1709" class="edge">
<title>layer28_moe_comm_to_expert13&#45;&gt;layer28_moe_expert13</title>
<path fill="none" stroke="black" d="M5788.02,-25518.62C5788.02,-25518.62 5788.02,-25492.55 5788.02,-25492.55"/>
<polygon fill="black" stroke="black" points="5791.52,-25492.55 5788.02,-25482.55 5784.52,-25492.55 5791.52,-25492.55"/>
</g>
<!-- layer28_moe_expert14 -->
<g id="node1339" class="node">
<title>layer28_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6406,-25482.42 6068,-25482.42 6068,-25430.42 6406,-25430.42 6406,-25482.42"/>
<text text-anchor="middle" x="6237" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 14 L28</text>
<text text-anchor="middle" x="6237" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6237" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6237" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert14 -->
<g id="node1358" class="node">
<title>layer28_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6127" cy="-25365.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6127" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6127" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6127" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer28_moe_expert14&#45;&gt;layer28_moe_comm_from_expert14 -->
<g id="edge1742" class="edge">
<title>layer28_moe_expert14&#45;&gt;layer28_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6144.88,-25430.1C6144.88,-25430.1 6144.88,-25403.91 6144.88,-25403.91"/>
<polygon fill="black" stroke="black" points="6148.38,-25403.91 6144.88,-25393.91 6141.38,-25403.91 6148.38,-25403.91"/>
</g>
<!-- layer28_moe_comm_to_expert14&#45;&gt;layer28_moe_expert14 -->
<g id="edge1711" class="edge">
<title>layer28_moe_comm_to_expert14&#45;&gt;layer28_moe_expert14</title>
<path fill="none" stroke="black" d="M6143.52,-25518.62C6143.52,-25518.62 6143.52,-25492.55 6143.52,-25492.55"/>
<polygon fill="black" stroke="black" points="6147.02,-25492.55 6143.52,-25482.55 6140.02,-25492.55 6147.02,-25492.55"/>
</g>
<!-- layer28_moe_expert15 -->
<g id="node1341" class="node">
<title>layer28_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6762,-25482.42 6424,-25482.42 6424,-25430.42 6762,-25430.42 6762,-25482.42"/>
<text text-anchor="middle" x="6593" y="-25470.42" font-family="Arial" font-size="10.00">EXPERT 15 L28</text>
<text text-anchor="middle" x="6593" y="-25459.42" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6593" y="-25448.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6593" y="-25437.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_comm_from_expert15 -->
<g id="node1359" class="node">
<title>layer28_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6482" cy="-25365.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6482" y="-25373.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6482" y="-25362.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6482" y="-25351.93" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer28_moe_expert15&#45;&gt;layer28_moe_comm_from_expert15 -->
<g id="edge1744" class="edge">
<title>layer28_moe_expert15&#45;&gt;layer28_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6500.38,-25430.1C6500.38,-25430.1 6500.38,-25403.91 6500.38,-25403.91"/>
<polygon fill="black" stroke="black" points="6503.88,-25403.91 6500.38,-25393.91 6496.88,-25403.91 6503.88,-25403.91"/>
</g>
<!-- layer28_moe_comm_to_expert15&#45;&gt;layer28_moe_expert15 -->
<g id="edge1713" class="edge">
<title>layer28_moe_comm_to_expert15&#45;&gt;layer28_moe_expert15</title>
<path fill="none" stroke="black" d="M6499.02,-25518.62C6499.02,-25518.62 6499.02,-25492.55 6499.02,-25492.55"/>
<polygon fill="black" stroke="black" points="6502.52,-25492.55 6499.02,-25482.55 6495.52,-25492.55 6502.52,-25492.55"/>
</g>
<!-- layer28_moe_aggregate -->
<g id="node1343" class="node">
<title>layer28_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4168.1,-25300.44 3751.16,-25300.44 3643.9,-25196.44 4060.84,-25196.44 4168.1,-25300.44"/>
<text text-anchor="middle" x="3906" y="-25262.44" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L28</text>
<text text-anchor="middle" x="3906" y="-25251.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3906" y="-25240.44" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3906" y="-25229.44" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_mha -->
<g id="node1360" class="node">
<title>layer29_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="4036,-25160.44 3776,-25160.44 3776,-25108.44 4036,-25108.44 4036,-25160.44"/>
<text text-anchor="middle" x="3906" y="-25148.44" font-family="Arial" font-size="10.00">MHA L29</text>
<text text-anchor="middle" x="3906" y="-25137.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3906" y="-25126.44" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3906" y="-25115.44" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer28_moe_aggregate&#45;&gt;layer29_moe_mha -->
<g id="edge1813" class="edge">
<title>layer28_moe_aggregate&#45;&gt;layer29_moe_mha</title>
<path fill="none" stroke="black" d="M3906,-25196.11C3906,-25196.11 3906,-25170.66 3906,-25170.66"/>
<polygon fill="black" stroke="black" points="3909.5,-25170.66 3906,-25160.66 3902.5,-25170.66 3909.5,-25170.66"/>
</g>
<!-- layer28_moe_comm_from_expert0&#45;&gt;layer28_moe_aggregate -->
<g id="edge1715" class="edge">
<title>layer28_moe_comm_from_expert0&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M1479.75,-25355.77C1479.75,-25321.96 1479.75,-25211 1479.75,-25211 1479.75,-25211 3648.88,-25211 3648.88,-25211"/>
<polygon fill="black" stroke="black" points="3648.88,-25214.5 3658.88,-25211 3648.88,-25207.5 3648.88,-25214.5"/>
</g>
<!-- layer28_moe_comm_from_expert1&#45;&gt;layer28_moe_aggregate -->
<g id="edge1717" class="edge">
<title>layer28_moe_comm_from_expert1&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M2191.25,-25354.49C2191.25,-25321.62 2191.25,-25226 2191.25,-25226 2191.25,-25226 3664.3,-25226 3664.3,-25226"/>
<polygon fill="black" stroke="black" points="3664.3,-25229.5 3674.3,-25226 3664.3,-25222.5 3664.3,-25229.5"/>
</g>
<!-- layer28_moe_comm_from_expert2&#45;&gt;layer28_moe_aggregate -->
<g id="edge1719" class="edge">
<title>layer28_moe_comm_from_expert2&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M2600.51,-25339.04C2600.51,-25302.51 2600.51,-25241 2600.51,-25241 2600.51,-25241 3679.69,-25241 3679.69,-25241"/>
<polygon fill="black" stroke="black" points="3679.69,-25244.5 3689.69,-25241 3679.69,-25237.5 3679.69,-25244.5"/>
</g>
<!-- layer28_moe_comm_from_expert3&#45;&gt;layer28_moe_aggregate -->
<g id="edge1721" class="edge">
<title>layer28_moe_comm_from_expert3&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M2955.5,-25344.92C2955.5,-25312.98 2955.5,-25255 2955.5,-25255 2955.5,-25255 3694.13,-25255 3694.13,-25255"/>
<polygon fill="black" stroke="black" points="3694.13,-25258.5 3704.13,-25255 3694.13,-25251.5 3694.13,-25258.5"/>
</g>
<!-- layer28_moe_comm_from_expert4&#45;&gt;layer28_moe_aggregate -->
<g id="edge1723" class="edge">
<title>layer28_moe_comm_from_expert4&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M3200.5,-25340.35C3200.5,-25312.08 3200.5,-25270 3200.5,-25270 3200.5,-25270 3709.72,-25270 3709.72,-25270"/>
<polygon fill="black" stroke="black" points="3709.72,-25273.5 3719.72,-25270 3709.72,-25266.5 3709.72,-25273.5"/>
</g>
<!-- layer28_moe_comm_from_expert5&#45;&gt;layer28_moe_aggregate -->
<g id="edge1725" class="edge">
<title>layer28_moe_comm_from_expert5&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M3422.5,-25338.65C3422.5,-25315.25 3422.5,-25285 3422.5,-25285 3422.5,-25285 3725.2,-25285 3725.2,-25285"/>
<polygon fill="black" stroke="black" points="3725.2,-25288.5 3735.2,-25285 3725.2,-25281.5 3725.2,-25288.5"/>
</g>
<!-- layer28_moe_comm_from_expert6&#45;&gt;layer28_moe_aggregate -->
<g id="edge1727" class="edge">
<title>layer28_moe_comm_from_expert6&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M3667.11,-25345.85C3667.11,-25345.85 3667.11,-25258.48 3667.11,-25258.48"/>
<polygon fill="black" stroke="black" points="3670.61,-25258.48 3667.11,-25248.48 3663.61,-25258.48 3670.61,-25258.48"/>
</g>
<!-- layer28_moe_comm_from_expert7&#45;&gt;layer28_moe_aggregate -->
<g id="edge1729" class="edge">
<title>layer28_moe_comm_from_expert7&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M3807,-25336.21C3807,-25336.21 3807,-25310.49 3807,-25310.49"/>
<polygon fill="black" stroke="black" points="3810.5,-25310.49 3807,-25300.49 3803.5,-25310.49 3810.5,-25310.49"/>
</g>
<!-- layer28_moe_comm_from_expert8&#45;&gt;layer28_moe_aggregate -->
<g id="edge1731" class="edge">
<title>layer28_moe_comm_from_expert8&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M4078.39,-25336.21C4078.39,-25336.21 4078.39,-25310.49 4078.39,-25310.49"/>
<polygon fill="black" stroke="black" points="4081.89,-25310.49 4078.39,-25300.49 4074.89,-25310.49 4081.89,-25310.49"/>
</g>
<!-- layer28_moe_comm_from_expert9&#45;&gt;layer28_moe_aggregate -->
<g id="edge1733" class="edge">
<title>layer28_moe_comm_from_expert9&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M4369.5,-25336.67C4369.5,-25314.29 4369.5,-25287 4369.5,-25287 4369.5,-25287 4164.37,-25287 4164.37,-25287"/>
<polygon fill="black" stroke="black" points="4164.37,-25283.5 4154.37,-25287 4164.37,-25290.5 4164.37,-25283.5"/>
</g>
<!-- layer28_moe_comm_from_expert10&#45;&gt;layer28_moe_aggregate -->
<g id="edge1735" class="edge">
<title>layer28_moe_comm_from_expert10&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M4701.15,-25337C4701.15,-25310.16 4701.15,-25274 4701.15,-25274 4701.15,-25274 4151.07,-25274 4151.07,-25274"/>
<polygon fill="black" stroke="black" points="4151.07,-25270.5 4141.07,-25274 4151.07,-25277.5 4151.07,-25270.5"/>
</g>
<!-- layer28_moe_comm_from_expert11&#45;&gt;layer28_moe_aggregate -->
<g id="edge1737" class="edge">
<title>layer28_moe_comm_from_expert11&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M5047.65,-25336.89C5047.65,-25305.97 5047.65,-25261 5047.65,-25261 5047.65,-25261 4137.47,-25261 4137.47,-25261"/>
<polygon fill="black" stroke="black" points="4137.47,-25257.5 4127.47,-25261 4137.47,-25264.5 4137.47,-25257.5"/>
</g>
<!-- layer28_moe_comm_from_expert12&#45;&gt;layer28_moe_aggregate -->
<g id="edge1739" class="edge">
<title>layer28_moe_comm_from_expert12&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M5398.65,-25337C5398.65,-25302.25 5398.65,-25248 5398.65,-25248 5398.65,-25248 4124.33,-25248 4124.33,-25248"/>
<polygon fill="black" stroke="black" points="4124.33,-25244.5 4114.33,-25248 4124.33,-25251.5 4124.33,-25244.5"/>
</g>
<!-- layer28_moe_comm_from_expert13&#45;&gt;layer28_moe_aggregate -->
<g id="edge1741" class="edge">
<title>layer28_moe_comm_from_expert13&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M5752.15,-25336.8C5752.15,-25298.41 5752.15,-25235 5752.15,-25235 5752.15,-25235 4110.95,-25235 4110.95,-25235"/>
<polygon fill="black" stroke="black" points="4110.95,-25231.5 4100.95,-25235 4110.95,-25238.5 4110.95,-25231.5"/>
</g>
<!-- layer28_moe_comm_from_expert14&#45;&gt;layer28_moe_aggregate -->
<g id="edge1743" class="edge">
<title>layer28_moe_comm_from_expert14&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M6107.15,-25336.75C6107.15,-25294.89 6107.15,-25222 6107.15,-25222 6107.15,-25222 4097.53,-25222 4097.53,-25222"/>
<polygon fill="black" stroke="black" points="4097.53,-25218.5 4087.53,-25222 4097.53,-25225.5 4097.53,-25218.5"/>
</g>
<!-- layer28_moe_comm_from_expert15&#45;&gt;layer28_moe_aggregate -->
<g id="edge1745" class="edge">
<title>layer28_moe_comm_from_expert15&#45;&gt;layer28_moe_aggregate</title>
<path fill="none" stroke="black" d="M6462.15,-25336.74C6462.15,-25291.58 6462.15,-25209 6462.15,-25209 6462.15,-25209 4084.21,-25209 4084.21,-25209"/>
<polygon fill="black" stroke="black" points="4084.21,-25205.5 4074.21,-25209 4084.21,-25212.5 4084.21,-25205.5"/>
</g>
<!-- layer29_moe_gate -->
<g id="node1361" class="node">
<title>layer29_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4164.3,-25072.44 3753.4,-25072.44 3647.7,-24968.44 4058.6,-24968.44 4164.3,-25072.44"/>
<text text-anchor="middle" x="3906" y="-25034.44" font-family="Arial" font-size="10.00">GATE L29</text>
<text text-anchor="middle" x="3906" y="-25023.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3906" y="-25012.44" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3906" y="-25001.44" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer29_moe_mha&#45;&gt;layer29_moe_gate -->
<g id="edge1814" class="edge">
<title>layer29_moe_mha&#45;&gt;layer29_moe_gate</title>
<path fill="none" stroke="black" d="M3906,-25108.28C3906,-25108.28 3906,-25082.53 3906,-25082.53"/>
<polygon fill="black" stroke="black" points="3909.5,-25082.53 3906,-25072.53 3902.5,-25082.53 3909.5,-25082.53"/>
</g>
<!-- layer29_moe_split -->
<g id="node1362" class="node">
<title>layer29_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4160.01,-24932.44 3755.94,-24932.44 3651.99,-24828.44 4056.06,-24828.44 4160.01,-24932.44"/>
<text text-anchor="middle" x="3906" y="-24894.44" font-family="Arial" font-size="10.00">SPLIT TOKENS L29</text>
<text text-anchor="middle" x="3906" y="-24883.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3906" y="-24872.44" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3906" y="-24861.44" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer29_moe_gate&#45;&gt;layer29_moe_split -->
<g id="edge1815" class="edge">
<title>layer29_moe_gate&#45;&gt;layer29_moe_split</title>
<path fill="none" stroke="black" d="M3906,-24968.3C3906,-24968.3 3906,-24942.61 3906,-24942.61"/>
<polygon fill="black" stroke="black" points="3909.5,-24942.61 3906,-24932.61 3902.5,-24942.61 3909.5,-24942.61"/>
</g>
<!-- layer29_moe_comm_to_expert0 -->
<g id="node1364" class="node">
<title>layer29_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1752" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1752" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1752" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1752" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert0 -->
<g id="edge1749" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3740.11,-24917C3235.3,-24917 1752,-24917 1752,-24917 1752,-24917 1752,-24802.69 1752,-24802.69"/>
<polygon fill="black" stroke="black" points="1755.5,-24802.69 1752,-24792.69 1748.5,-24802.69 1755.5,-24802.69"/>
</g>
<!-- layer29_moe_comm_to_expert1 -->
<g id="node1366" class="node">
<title>layer29_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2038" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2038" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2038" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2038" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert1 -->
<g id="edge1751" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3725.18,-24902C3262.61,-24902 2072.5,-24902 2072.5,-24902 2072.5,-24902 2072.5,-24800.49 2072.5,-24800.49"/>
<polygon fill="black" stroke="black" points="2076,-24800.49 2072.5,-24790.49 2069,-24800.49 2076,-24800.49"/>
</g>
<!-- layer29_moe_comm_to_expert2 -->
<g id="node1368" class="node">
<title>layer29_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2457" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2457" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2457" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2457" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert2 -->
<g id="edge1753" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.42,-24887C3326.22,-24887 2510,-24887 2510,-24887 2510,-24887 2510,-24796.97 2510,-24796.97"/>
<polygon fill="black" stroke="black" points="2513.5,-24796.97 2510,-24786.97 2506.5,-24796.97 2513.5,-24796.97"/>
</g>
<!-- layer29_moe_comm_to_expert3 -->
<g id="node1370" class="node">
<title>layer29_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2766" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2766" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2766" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2766" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert3 -->
<g id="edge1755" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3696.33,-24873C3382.87,-24873 2828.5,-24873 2828.5,-24873 2828.5,-24873 2828.5,-24794.57 2828.5,-24794.57"/>
<polygon fill="black" stroke="black" points="2832,-24794.57 2828.5,-24784.57 2825,-24794.57 2832,-24794.57"/>
</g>
<!-- layer29_moe_comm_to_expert4 -->
<g id="node1372" class="node">
<title>layer29_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3020" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3020" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3020" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3020" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert4 -->
<g id="edge1757" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3681.39,-24858C3438.93,-24858 3087,-24858 3087,-24858 3087,-24858 3087,-24793.04 3087,-24793.04"/>
<polygon fill="black" stroke="black" points="3090.5,-24793.04 3087,-24783.04 3083.5,-24793.04 3090.5,-24793.04"/>
</g>
<!-- layer29_moe_comm_to_expert5 -->
<g id="node1374" class="node">
<title>layer29_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3247" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3247" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3247" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3247" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert5 -->
<g id="edge1759" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3666.45,-24843C3503,-24843 3316,-24843 3316,-24843 3316,-24843 3316,-24792.3 3316,-24792.3"/>
<polygon fill="black" stroke="black" points="3319.5,-24792.3 3316,-24782.3 3312.5,-24792.3 3319.5,-24792.3"/>
</g>
<!-- layer29_moe_comm_to_expert6 -->
<g id="node1376" class="node">
<title>layer29_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3460" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3460" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3460" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3460" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert6 -->
<g id="edge1761" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3665.74,-24880.35C3665.74,-24876.79 3665.74,-24763 3665.74,-24763 3665.74,-24763 3560.54,-24763 3560.54,-24763"/>
<polygon fill="black" stroke="black" points="3560.54,-24759.5 3550.54,-24763 3560.54,-24766.5 3560.54,-24759.5"/>
</g>
<!-- layer29_moe_comm_to_expert7 -->
<g id="node1378" class="node">
<title>layer29_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3770" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3770" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3770" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3770" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert7 -->
<g id="edge1763" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3770,-24828.1C3770,-24828.1 3770,-24802.65 3770,-24802.65"/>
<polygon fill="black" stroke="black" points="3773.5,-24802.65 3770,-24792.65 3766.5,-24802.65 3773.5,-24802.65"/>
</g>
<!-- layer29_moe_comm_to_expert8 -->
<g id="node1380" class="node">
<title>layer29_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4042" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4042" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4042" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4042" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert8 -->
<g id="edge1765" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4042,-24828.1C4042,-24828.1 4042,-24802.65 4042,-24802.65"/>
<polygon fill="black" stroke="black" points="4045.5,-24802.65 4042,-24792.65 4038.5,-24802.65 4045.5,-24802.65"/>
</g>
<!-- layer29_moe_comm_to_expert9 -->
<g id="node1382" class="node">
<title>layer29_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4351" cy="-24763.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4351" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4351" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4351" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert9 -->
<g id="edge1767" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4146.26,-24880.35C4146.26,-24876.79 4146.26,-24763 4146.26,-24763 4146.26,-24763 4250.3,-24763 4250.3,-24763"/>
<polygon fill="black" stroke="black" points="4250.3,-24766.5 4260.3,-24763 4250.3,-24759.5 4250.3,-24766.5"/>
</g>
<!-- layer29_moe_comm_to_expert10 -->
<g id="node1384" class="node">
<title>layer29_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4683" cy="-24763.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4683" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4683" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4683" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert10 -->
<g id="edge1769" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4070.82,-24843C4278.07,-24843 4607.1,-24843 4607.1,-24843 4607.1,-24843 4607.1,-24790.71 4607.1,-24790.71"/>
<polygon fill="black" stroke="black" points="4610.6,-24790.71 4607.1,-24780.71 4603.6,-24790.71 4610.6,-24790.71"/>
</g>
<!-- layer29_moe_comm_to_expert11 -->
<g id="node1386" class="node">
<title>layer29_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5029" cy="-24763.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5029" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="5029" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5029" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert11 -->
<g id="edge1771" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4085.79,-24858C4385.24,-24858 4953.6,-24858 4953.6,-24858 4953.6,-24858 4953.6,-24790.79 4953.6,-24790.79"/>
<polygon fill="black" stroke="black" points="4957.1,-24790.79 4953.6,-24780.79 4950.1,-24790.79 4957.1,-24790.79"/>
</g>
<!-- layer29_moe_comm_to_expert12 -->
<g id="node1388" class="node">
<title>layer29_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5380" cy="-24763.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5380" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5380" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5380" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert12 -->
<g id="edge1773" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4100.84,-24873C4485.29,-24873 5304.6,-24873 5304.6,-24873 5304.6,-24873 5304.6,-24791.05 5304.6,-24791.05"/>
<polygon fill="black" stroke="black" points="5308.1,-24791.05 5304.6,-24781.05 5301.1,-24791.05 5308.1,-24791.05"/>
</g>
<!-- layer29_moe_comm_to_expert13 -->
<g id="node1390" class="node">
<title>layer29_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5733" cy="-24763.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5733" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5733" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5733" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert13 -->
<g id="edge1775" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4114.74,-24887C4579.33,-24887 5658.1,-24887 5658.1,-24887 5658.1,-24887 5658.1,-24791.15 5658.1,-24791.15"/>
<polygon fill="black" stroke="black" points="5661.6,-24791.15 5658.1,-24781.15 5654.6,-24791.15 5661.6,-24791.15"/>
</g>
<!-- layer29_moe_comm_to_expert14 -->
<g id="node1392" class="node">
<title>layer29_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6088" cy="-24763.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6088" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6088" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6088" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert14 -->
<g id="edge1777" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4130,-24902C4672.61,-24902 6013.1,-24902 6013.1,-24902 6013.1,-24902 6013.1,-24790.99 6013.1,-24790.99"/>
<polygon fill="black" stroke="black" points="6016.6,-24790.99 6013.1,-24780.99 6009.6,-24790.99 6016.6,-24790.99"/>
</g>
<!-- layer29_moe_comm_to_expert15 -->
<g id="node1394" class="node">
<title>layer29_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6443" cy="-24763.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6443" y="-24771.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6443" y="-24760.94" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6443" y="-24749.94" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert15 -->
<g id="edge1779" class="edge">
<title>layer29_moe_split&#45;&gt;layer29_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4144.59,-24917C4762.69,-24917 6368.1,-24917 6368.1,-24917 6368.1,-24917 6368.1,-24791.06 6368.1,-24791.06"/>
<polygon fill="black" stroke="black" points="6371.6,-24791.06 6368.1,-24781.06 6364.6,-24791.06 6371.6,-24791.06"/>
</g>
<!-- layer29_moe_expert0 -->
<g id="node1363" class="node">
<title>layer29_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1475,-24698.45 1147,-24698.45 1147,-24646.45 1475,-24646.45 1475,-24698.45"/>
<text text-anchor="middle" x="1311" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 0 L29</text>
<text text-anchor="middle" x="1311" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1311" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1311" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert0 -->
<g id="node1396" class="node">
<title>layer29_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1470" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1470" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1470" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1470" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer29_moe_expert0&#45;&gt;layer29_moe_comm_from_expert0 -->
<g id="edge1781" class="edge">
<title>layer29_moe_expert0&#45;&gt;layer29_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1427.25,-24646.13C1427.25,-24646.13 1427.25,-24617.09 1427.25,-24617.09"/>
<polygon fill="black" stroke="black" points="1430.75,-24617.09 1427.25,-24607.09 1423.75,-24617.09 1430.75,-24617.09"/>
</g>
<!-- layer29_moe_comm_to_expert0&#45;&gt;layer29_moe_expert0 -->
<g id="edge1750" class="edge">
<title>layer29_moe_comm_to_expert0&#45;&gt;layer29_moe_expert0</title>
<path fill="none" stroke="black" d="M1661.4,-24763C1553.95,-24763 1389.25,-24763 1389.25,-24763 1389.25,-24763 1389.25,-24708.64 1389.25,-24708.64"/>
<polygon fill="black" stroke="black" points="1392.75,-24708.64 1389.25,-24698.64 1385.75,-24708.64 1392.75,-24708.64"/>
</g>
<!-- layer29_moe_expert1 -->
<g id="node1365" class="node">
<title>layer29_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1821,-24698.45 1493,-24698.45 1493,-24646.45 1821,-24646.45 1821,-24698.45"/>
<text text-anchor="middle" x="1657" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 1 L29</text>
<text text-anchor="middle" x="1657" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1657" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1657" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert1 -->
<g id="node1397" class="node">
<title>layer29_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1742" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1742" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1742" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1742" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer29_moe_expert1&#45;&gt;layer29_moe_comm_from_expert1 -->
<g id="edge1783" class="edge">
<title>layer29_moe_expert1&#45;&gt;layer29_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1736.25,-24646.13C1736.25,-24646.13 1736.25,-24620.59 1736.25,-24620.59"/>
<polygon fill="black" stroke="black" points="1739.75,-24620.59 1736.25,-24610.59 1732.75,-24620.59 1739.75,-24620.59"/>
</g>
<!-- layer29_moe_comm_to_expert1&#45;&gt;layer29_moe_expert1 -->
<g id="edge1752" class="edge">
<title>layer29_moe_comm_to_expert1&#45;&gt;layer29_moe_expert1</title>
<path fill="none" stroke="black" d="M2038,-24734.22C2038,-24721.74 2038,-24710 2038,-24710 2038,-24710 1741.25,-24710 1741.25,-24710 1741.25,-24710 1741.25,-24708.53 1741.25,-24708.53"/>
<polygon fill="black" stroke="black" points="1744.75,-24708.53 1741.25,-24698.53 1737.75,-24708.53 1744.75,-24708.53"/>
</g>
<!-- layer29_moe_expert2 -->
<g id="node1367" class="node">
<title>layer29_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2167,-24698.45 1839,-24698.45 1839,-24646.45 2167,-24646.45 2167,-24698.45"/>
<text text-anchor="middle" x="2003" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 2 L29</text>
<text text-anchor="middle" x="2003" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2003" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="2003" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert2 -->
<g id="node1398" class="node">
<title>layer29_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2063" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2063" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2063" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2063" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer29_moe_expert2&#45;&gt;layer29_moe_comm_from_expert2 -->
<g id="edge1785" class="edge">
<title>layer29_moe_expert2&#45;&gt;layer29_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2063,-24646.13C2063,-24646.13 2063,-24620.59 2063,-24620.59"/>
<polygon fill="black" stroke="black" points="2066.5,-24620.59 2063,-24610.59 2059.5,-24620.59 2066.5,-24620.59"/>
</g>
<!-- layer29_moe_comm_to_expert2&#45;&gt;layer29_moe_expert2 -->
<g id="edge1754" class="edge">
<title>layer29_moe_comm_to_expert2&#45;&gt;layer29_moe_expert2</title>
<path fill="none" stroke="black" d="M2366.31,-24763C2275.06,-24763 2147.75,-24763 2147.75,-24763 2147.75,-24763 2147.75,-24708.64 2147.75,-24708.64"/>
<polygon fill="black" stroke="black" points="2151.25,-24708.64 2147.75,-24698.64 2144.25,-24708.64 2151.25,-24708.64"/>
</g>
<!-- layer29_moe_expert3 -->
<g id="node1369" class="node">
<title>layer29_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2513,-24698.45 2185,-24698.45 2185,-24646.45 2513,-24646.45 2513,-24698.45"/>
<text text-anchor="middle" x="2349" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 3 L29</text>
<text text-anchor="middle" x="2349" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2349" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2349" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert3 -->
<g id="node1399" class="node">
<title>layer29_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2629" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2629" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2629" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2629" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer29_moe_expert3&#45;&gt;layer29_moe_comm_from_expert3 -->
<g id="edge1787" class="edge">
<title>layer29_moe_expert3&#45;&gt;layer29_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2455.75,-24646C2455.75,-24618.99 2455.75,-24581 2455.75,-24581 2455.75,-24581 2528.31,-24581 2528.31,-24581"/>
<polygon fill="black" stroke="black" points="2528.31,-24584.5 2538.31,-24581 2528.31,-24577.5 2528.31,-24584.5"/>
</g>
<!-- layer29_moe_comm_to_expert3&#45;&gt;layer29_moe_expert3 -->
<g id="edge1756" class="edge">
<title>layer29_moe_comm_to_expert3&#45;&gt;layer29_moe_expert3</title>
<path fill="none" stroke="black" d="M2766,-24734.21C2766,-24727.35 2766,-24722 2766,-24722 2766,-24722 2439.75,-24722 2439.75,-24722 2439.75,-24722 2439.75,-24708.68 2439.75,-24708.68"/>
<polygon fill="black" stroke="black" points="2443.25,-24708.68 2439.75,-24698.68 2436.25,-24708.68 2443.25,-24708.68"/>
</g>
<!-- layer29_moe_expert4 -->
<g id="node1371" class="node">
<title>layer29_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2859,-24698.45 2531,-24698.45 2531,-24646.45 2859,-24646.45 2859,-24698.45"/>
<text text-anchor="middle" x="2695" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 4 L29</text>
<text text-anchor="middle" x="2695" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2695" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2695" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert4 -->
<g id="node1400" class="node">
<title>layer29_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3012" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3012" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3012" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3012" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer29_moe_expert4&#45;&gt;layer29_moe_comm_from_expert4 -->
<g id="edge1789" class="edge">
<title>layer29_moe_expert4&#45;&gt;layer29_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2792.75,-24646C2792.75,-24618.99 2792.75,-24581 2792.75,-24581 2792.75,-24581 2911.24,-24581 2911.24,-24581"/>
<polygon fill="black" stroke="black" points="2911.24,-24584.5 2921.24,-24581 2911.24,-24577.5 2911.24,-24584.5"/>
</g>
<!-- layer29_moe_comm_to_expert4&#45;&gt;layer29_moe_expert4 -->
<g id="edge1758" class="edge">
<title>layer29_moe_comm_to_expert4&#45;&gt;layer29_moe_expert4</title>
<path fill="none" stroke="black" d="M2929.39,-24763C2896.83,-24763 2868,-24763 2868,-24763 2868,-24763 2868,-24672 2868,-24672 2868,-24672 2867.12,-24672 2867.12,-24672"/>
<polygon fill="black" stroke="black" points="2869.18,-24668.5 2859.18,-24672 2869.18,-24675.5 2869.18,-24668.5"/>
</g>
<!-- layer29_moe_expert5 -->
<g id="node1373" class="node">
<title>layer29_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3205,-24698.45 2877,-24698.45 2877,-24646.45 3205,-24646.45 3205,-24698.45"/>
<text text-anchor="middle" x="3041" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 5 L29</text>
<text text-anchor="middle" x="3041" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3041" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3041" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert5 -->
<g id="node1401" class="node">
<title>layer29_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3303" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3303" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3303" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3303" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer29_moe_expert5&#45;&gt;layer29_moe_comm_from_expert5 -->
<g id="edge1791" class="edge">
<title>layer29_moe_expert5&#45;&gt;layer29_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3205.03,-24672C3212.99,-24672 3217.75,-24672 3217.75,-24672 3217.75,-24672 3217.75,-24601.5 3217.75,-24601.5"/>
<polygon fill="black" stroke="black" points="3221.25,-24601.5 3217.75,-24591.5 3214.25,-24601.5 3221.25,-24601.5"/>
</g>
<!-- layer29_moe_comm_to_expert5&#45;&gt;layer29_moe_expert5 -->
<g id="edge1760" class="edge">
<title>layer29_moe_comm_to_expert5&#45;&gt;layer29_moe_expert5</title>
<path fill="none" stroke="black" d="M3180.75,-24743.25C3180.75,-24743.25 3180.75,-24708.47 3180.75,-24708.47"/>
<polygon fill="black" stroke="black" points="3184.25,-24708.47 3180.75,-24698.47 3177.25,-24708.47 3184.25,-24708.47"/>
</g>
<!-- layer29_moe_expert6 -->
<g id="node1375" class="node">
<title>layer29_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3551,-24698.45 3223,-24698.45 3223,-24646.45 3551,-24646.45 3551,-24698.45"/>
<text text-anchor="middle" x="3387" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 6 L29</text>
<text text-anchor="middle" x="3387" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3387" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3387" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert6 -->
<g id="node1402" class="node">
<title>layer29_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3548" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3548" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3548" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3548" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer29_moe_expert6&#45;&gt;layer29_moe_comm_from_expert6 -->
<g id="edge1793" class="edge">
<title>layer29_moe_expert6&#45;&gt;layer29_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3504.25,-24646.13C3504.25,-24646.13 3504.25,-24617.09 3504.25,-24617.09"/>
<polygon fill="black" stroke="black" points="3507.75,-24617.09 3504.25,-24607.09 3500.75,-24617.09 3507.75,-24617.09"/>
</g>
<!-- layer29_moe_comm_to_expert6&#45;&gt;layer29_moe_expert6 -->
<g id="edge1762" class="edge">
<title>layer29_moe_comm_to_expert6&#45;&gt;layer29_moe_expert6</title>
<path fill="none" stroke="black" d="M3460,-24734.4C3460,-24734.4 3460,-24708.75 3460,-24708.75"/>
<polygon fill="black" stroke="black" points="3463.5,-24708.75 3460,-24698.75 3456.5,-24708.75 3463.5,-24708.75"/>
</g>
<!-- layer29_moe_expert7 -->
<g id="node1377" class="node">
<title>layer29_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3897,-24698.45 3569,-24698.45 3569,-24646.45 3897,-24646.45 3897,-24698.45"/>
<text text-anchor="middle" x="3733" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 7 L29</text>
<text text-anchor="middle" x="3733" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3733" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3733" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert7 -->
<g id="node1403" class="node">
<title>layer29_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3770" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3770" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3770" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3770" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer29_moe_expert7&#45;&gt;layer29_moe_comm_from_expert7 -->
<g id="edge1795" class="edge">
<title>layer29_moe_expert7&#45;&gt;layer29_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3770,-24646.13C3770,-24646.13 3770,-24620.59 3770,-24620.59"/>
<polygon fill="black" stroke="black" points="3773.5,-24620.59 3770,-24610.59 3766.5,-24620.59 3773.5,-24620.59"/>
</g>
<!-- layer29_moe_comm_to_expert7&#45;&gt;layer29_moe_expert7 -->
<g id="edge1764" class="edge">
<title>layer29_moe_comm_to_expert7&#45;&gt;layer29_moe_expert7</title>
<path fill="none" stroke="black" d="M3770,-24734.4C3770,-24734.4 3770,-24708.75 3770,-24708.75"/>
<polygon fill="black" stroke="black" points="3773.5,-24708.75 3770,-24698.75 3766.5,-24708.75 3773.5,-24708.75"/>
</g>
<!-- layer29_moe_expert8 -->
<g id="node1379" class="node">
<title>layer29_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4243,-24698.45 3915,-24698.45 3915,-24646.45 4243,-24646.45 4243,-24698.45"/>
<text text-anchor="middle" x="4079" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 8 L29</text>
<text text-anchor="middle" x="4079" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4079" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4079" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert8 -->
<g id="node1404" class="node">
<title>layer29_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4042" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4042" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4042" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4042" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer29_moe_expert8&#45;&gt;layer29_moe_comm_from_expert8 -->
<g id="edge1797" class="edge">
<title>layer29_moe_expert8&#45;&gt;layer29_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4042,-24646.13C4042,-24646.13 4042,-24620.59 4042,-24620.59"/>
<polygon fill="black" stroke="black" points="4045.5,-24620.59 4042,-24610.59 4038.5,-24620.59 4045.5,-24620.59"/>
</g>
<!-- layer29_moe_comm_to_expert8&#45;&gt;layer29_moe_expert8 -->
<g id="edge1766" class="edge">
<title>layer29_moe_comm_to_expert8&#45;&gt;layer29_moe_expert8</title>
<path fill="none" stroke="black" d="M4042,-24734.4C4042,-24734.4 4042,-24708.75 4042,-24708.75"/>
<polygon fill="black" stroke="black" points="4045.5,-24708.75 4042,-24698.75 4038.5,-24708.75 4045.5,-24708.75"/>
</g>
<!-- layer29_moe_expert9 -->
<g id="node1381" class="node">
<title>layer29_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4589,-24698.45 4261,-24698.45 4261,-24646.45 4589,-24646.45 4589,-24698.45"/>
<text text-anchor="middle" x="4425" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 9 L29</text>
<text text-anchor="middle" x="4425" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4425" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4425" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert9 -->
<g id="node1405" class="node">
<title>layer29_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4351" cy="-24581.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4351" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4351" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4351" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer29_moe_expert9&#45;&gt;layer29_moe_comm_from_expert9 -->
<g id="edge1799" class="edge">
<title>layer29_moe_expert9&#45;&gt;layer29_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4351.25,-24646.13C4351.25,-24646.13 4351.25,-24620.59 4351.25,-24620.59"/>
<polygon fill="black" stroke="black" points="4354.75,-24620.59 4351.25,-24610.59 4347.75,-24620.59 4354.75,-24620.59"/>
</g>
<!-- layer29_moe_comm_to_expert9&#45;&gt;layer29_moe_expert9 -->
<g id="edge1768" class="edge">
<title>layer29_moe_comm_to_expert9&#45;&gt;layer29_moe_expert9</title>
<path fill="none" stroke="black" d="M4351.25,-24734.4C4351.25,-24734.4 4351.25,-24708.75 4351.25,-24708.75"/>
<polygon fill="black" stroke="black" points="4354.75,-24708.75 4351.25,-24698.75 4347.75,-24708.75 4354.75,-24708.75"/>
</g>
<!-- layer29_moe_expert10 -->
<g id="node1383" class="node">
<title>layer29_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4945,-24698.45 4607,-24698.45 4607,-24646.45 4945,-24646.45 4945,-24698.45"/>
<text text-anchor="middle" x="4776" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 10 L29</text>
<text text-anchor="middle" x="4776" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4776" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4776" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert10 -->
<g id="node1406" class="node">
<title>layer29_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4683" cy="-24581.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4683" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4683" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4683" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer29_moe_expert10&#45;&gt;layer29_moe_comm_from_expert10 -->
<g id="edge1801" class="edge">
<title>layer29_moe_expert10&#45;&gt;layer29_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4692.38,-24646.13C4692.38,-24646.13 4692.38,-24620.59 4692.38,-24620.59"/>
<polygon fill="black" stroke="black" points="4695.88,-24620.59 4692.38,-24610.59 4688.88,-24620.59 4695.88,-24620.59"/>
</g>
<!-- layer29_moe_comm_to_expert10&#45;&gt;layer29_moe_expert10 -->
<g id="edge1770" class="edge">
<title>layer29_moe_comm_to_expert10&#45;&gt;layer29_moe_expert10</title>
<path fill="none" stroke="black" d="M4692.02,-24734.4C4692.02,-24734.4 4692.02,-24708.75 4692.02,-24708.75"/>
<polygon fill="black" stroke="black" points="4695.52,-24708.75 4692.02,-24698.75 4688.52,-24708.75 4695.52,-24708.75"/>
</g>
<!-- layer29_moe_expert11 -->
<g id="node1385" class="node">
<title>layer29_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5301,-24698.45 4963,-24698.45 4963,-24646.45 5301,-24646.45 5301,-24698.45"/>
<text text-anchor="middle" x="5132" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 11 L29</text>
<text text-anchor="middle" x="5132" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5132" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5132" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert11 -->
<g id="node1407" class="node">
<title>layer29_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="5030" cy="-24581.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5030" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="5030" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5030" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer29_moe_expert11&#45;&gt;layer29_moe_comm_from_expert11 -->
<g id="edge1803" class="edge">
<title>layer29_moe_expert11&#45;&gt;layer29_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5043.88,-24646.13C5043.88,-24646.13 5043.88,-24620.27 5043.88,-24620.27"/>
<polygon fill="black" stroke="black" points="5047.38,-24620.27 5043.88,-24610.27 5040.38,-24620.27 5047.38,-24620.27"/>
</g>
<!-- layer29_moe_comm_to_expert11&#45;&gt;layer29_moe_expert11 -->
<g id="edge1772" class="edge">
<title>layer29_moe_comm_to_expert11&#45;&gt;layer29_moe_expert11</title>
<path fill="none" stroke="black" d="M5043.02,-24734.65C5043.02,-24734.65 5043.02,-24708.59 5043.02,-24708.59"/>
<polygon fill="black" stroke="black" points="5046.52,-24708.59 5043.02,-24698.59 5039.52,-24708.59 5046.52,-24708.59"/>
</g>
<!-- layer29_moe_expert12 -->
<g id="node1387" class="node">
<title>layer29_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5657,-24698.45 5319,-24698.45 5319,-24646.45 5657,-24646.45 5657,-24698.45"/>
<text text-anchor="middle" x="5488" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 12 L29</text>
<text text-anchor="middle" x="5488" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5488" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5488" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert12 -->
<g id="node1408" class="node">
<title>layer29_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5381" cy="-24581.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5381" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5381" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5381" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer29_moe_expert12&#45;&gt;layer29_moe_comm_from_expert12 -->
<g id="edge1805" class="edge">
<title>layer29_moe_expert12&#45;&gt;layer29_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5397.38,-24646.13C5397.38,-24646.13 5397.38,-24620.27 5397.38,-24620.27"/>
<polygon fill="black" stroke="black" points="5400.88,-24620.27 5397.38,-24610.27 5393.88,-24620.27 5400.88,-24620.27"/>
</g>
<!-- layer29_moe_comm_to_expert12&#45;&gt;layer29_moe_expert12 -->
<g id="edge1774" class="edge">
<title>layer29_moe_comm_to_expert12&#45;&gt;layer29_moe_expert12</title>
<path fill="none" stroke="black" d="M5396.52,-24734.65C5396.52,-24734.65 5396.52,-24708.59 5396.52,-24708.59"/>
<polygon fill="black" stroke="black" points="5400.02,-24708.59 5396.52,-24698.59 5393.02,-24708.59 5400.02,-24708.59"/>
</g>
<!-- layer29_moe_expert13 -->
<g id="node1389" class="node">
<title>layer29_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="6013,-24698.45 5675,-24698.45 5675,-24646.45 6013,-24646.45 6013,-24698.45"/>
<text text-anchor="middle" x="5844" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 13 L29</text>
<text text-anchor="middle" x="5844" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5844" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5844" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert13 -->
<g id="node1409" class="node">
<title>layer29_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5735" cy="-24581.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5735" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5735" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5735" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer29_moe_expert13&#45;&gt;layer29_moe_comm_from_expert13 -->
<g id="edge1807" class="edge">
<title>layer29_moe_expert13&#45;&gt;layer29_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5752.38,-24646.13C5752.38,-24646.13 5752.38,-24620.27 5752.38,-24620.27"/>
<polygon fill="black" stroke="black" points="5755.88,-24620.27 5752.38,-24610.27 5748.88,-24620.27 5755.88,-24620.27"/>
</g>
<!-- layer29_moe_comm_to_expert13&#45;&gt;layer29_moe_expert13 -->
<g id="edge1776" class="edge">
<title>layer29_moe_comm_to_expert13&#45;&gt;layer29_moe_expert13</title>
<path fill="none" stroke="black" d="M5751.02,-24734.65C5751.02,-24734.65 5751.02,-24708.59 5751.02,-24708.59"/>
<polygon fill="black" stroke="black" points="5754.52,-24708.59 5751.02,-24698.59 5747.52,-24708.59 5754.52,-24708.59"/>
</g>
<!-- layer29_moe_expert14 -->
<g id="node1391" class="node">
<title>layer29_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6369,-24698.45 6031,-24698.45 6031,-24646.45 6369,-24646.45 6369,-24698.45"/>
<text text-anchor="middle" x="6200" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 14 L29</text>
<text text-anchor="middle" x="6200" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6200" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6200" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert14 -->
<g id="node1410" class="node">
<title>layer29_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6090" cy="-24581.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6090" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6090" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6090" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer29_moe_expert14&#45;&gt;layer29_moe_comm_from_expert14 -->
<g id="edge1809" class="edge">
<title>layer29_moe_expert14&#45;&gt;layer29_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6107.88,-24646.13C6107.88,-24646.13 6107.88,-24619.95 6107.88,-24619.95"/>
<polygon fill="black" stroke="black" points="6111.38,-24619.95 6107.88,-24609.95 6104.38,-24619.95 6111.38,-24619.95"/>
</g>
<!-- layer29_moe_comm_to_expert14&#45;&gt;layer29_moe_expert14 -->
<g id="edge1778" class="edge">
<title>layer29_moe_comm_to_expert14&#45;&gt;layer29_moe_expert14</title>
<path fill="none" stroke="black" d="M6106.52,-24734.65C6106.52,-24734.65 6106.52,-24708.59 6106.52,-24708.59"/>
<polygon fill="black" stroke="black" points="6110.02,-24708.59 6106.52,-24698.59 6103.02,-24708.59 6110.02,-24708.59"/>
</g>
<!-- layer29_moe_expert15 -->
<g id="node1393" class="node">
<title>layer29_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6725,-24698.45 6387,-24698.45 6387,-24646.45 6725,-24646.45 6725,-24698.45"/>
<text text-anchor="middle" x="6556" y="-24686.45" font-family="Arial" font-size="10.00">EXPERT 15 L29</text>
<text text-anchor="middle" x="6556" y="-24675.45" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6556" y="-24664.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6556" y="-24653.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_comm_from_expert15 -->
<g id="node1411" class="node">
<title>layer29_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6445" cy="-24581.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6445" y="-24589.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6445" y="-24578.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6445" y="-24567.96" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer29_moe_expert15&#45;&gt;layer29_moe_comm_from_expert15 -->
<g id="edge1811" class="edge">
<title>layer29_moe_expert15&#45;&gt;layer29_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6463.38,-24646.13C6463.38,-24646.13 6463.38,-24619.95 6463.38,-24619.95"/>
<polygon fill="black" stroke="black" points="6466.88,-24619.95 6463.38,-24609.95 6459.88,-24619.95 6466.88,-24619.95"/>
</g>
<!-- layer29_moe_comm_to_expert15&#45;&gt;layer29_moe_expert15 -->
<g id="edge1780" class="edge">
<title>layer29_moe_comm_to_expert15&#45;&gt;layer29_moe_expert15</title>
<path fill="none" stroke="black" d="M6462.02,-24734.65C6462.02,-24734.65 6462.02,-24708.59 6462.02,-24708.59"/>
<polygon fill="black" stroke="black" points="6465.52,-24708.59 6462.02,-24698.59 6458.52,-24708.59 6465.52,-24708.59"/>
</g>
<!-- layer29_moe_aggregate -->
<g id="node1395" class="node">
<title>layer29_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4131.1,-24516.47 3714.16,-24516.47 3606.9,-24412.47 4023.84,-24412.47 4131.1,-24516.47"/>
<text text-anchor="middle" x="3869" y="-24478.47" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L29</text>
<text text-anchor="middle" x="3869" y="-24467.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3869" y="-24456.47" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3869" y="-24445.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_mha -->
<g id="node1412" class="node">
<title>layer30_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3999,-24376.47 3739,-24376.47 3739,-24324.47 3999,-24324.47 3999,-24376.47"/>
<text text-anchor="middle" x="3869" y="-24364.47" font-family="Arial" font-size="10.00">MHA L30</text>
<text text-anchor="middle" x="3869" y="-24353.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3869" y="-24342.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3869" y="-24331.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer29_moe_aggregate&#45;&gt;layer30_moe_mha -->
<g id="edge1880" class="edge">
<title>layer29_moe_aggregate&#45;&gt;layer30_moe_mha</title>
<path fill="none" stroke="black" d="M3869,-24412.14C3869,-24412.14 3869,-24386.7 3869,-24386.7"/>
<polygon fill="black" stroke="black" points="3872.5,-24386.7 3869,-24376.7 3865.5,-24386.7 3872.5,-24386.7"/>
</g>
<!-- layer29_moe_comm_from_expert0&#45;&gt;layer29_moe_aggregate -->
<g id="edge1782" class="edge">
<title>layer29_moe_comm_from_expert0&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M1508.25,-24554.91C1508.25,-24510.75 1508.25,-24427 1508.25,-24427 1508.25,-24427 3611.65,-24427 3611.65,-24427"/>
<polygon fill="black" stroke="black" points="3611.65,-24430.5 3621.65,-24427 3611.65,-24423.5 3611.65,-24430.5"/>
</g>
<!-- layer29_moe_comm_from_expert1&#45;&gt;layer29_moe_aggregate -->
<g id="edge1784" class="edge">
<title>layer29_moe_comm_from_expert1&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M1817.25,-24565.19C1817.25,-24528.4 1817.25,-24442 1817.25,-24442 1817.25,-24442 3627.13,-24442 3627.13,-24442"/>
<polygon fill="black" stroke="black" points="3627.13,-24445.5 3637.13,-24442 3627.13,-24438.5 3627.13,-24445.5"/>
</g>
<!-- layer29_moe_comm_from_expert2&#45;&gt;layer29_moe_aggregate -->
<g id="edge1786" class="edge">
<title>layer29_moe_comm_from_expert2&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M2136,-24564.16C2136,-24529.96 2136,-24457 2136,-24457 2136,-24457 3642.58,-24457 3642.58,-24457"/>
<polygon fill="black" stroke="black" points="3642.58,-24460.5 3652.58,-24457 3642.58,-24453.5 3642.58,-24460.5"/>
</g>
<!-- layer29_moe_comm_from_expert3&#45;&gt;layer29_moe_aggregate -->
<g id="edge1788" class="edge">
<title>layer29_moe_comm_from_expert3&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M2649.51,-24553.01C2649.51,-24520.29 2649.51,-24471 2649.51,-24471 2649.51,-24471 3656.94,-24471 3656.94,-24471"/>
<polygon fill="black" stroke="black" points="3656.94,-24474.5 3666.94,-24471 3656.94,-24467.5 3656.94,-24474.5"/>
</g>
<!-- layer29_moe_comm_from_expert4&#45;&gt;layer29_moe_aggregate -->
<g id="edge1790" class="edge">
<title>layer29_moe_comm_from_expert4&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M3046,-24554.36C3046,-24526.14 3046,-24486 3046,-24486 3046,-24486 3672.51,-24486 3672.51,-24486"/>
<polygon fill="black" stroke="black" points="3672.51,-24489.5 3682.51,-24486 3672.51,-24482.5 3672.51,-24489.5"/>
</g>
<!-- layer29_moe_comm_from_expert5&#45;&gt;layer29_moe_aggregate -->
<g id="edge1792" class="edge">
<title>layer29_moe_comm_from_expert5&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M3307,-24552.41C3307,-24529.37 3307,-24501 3307,-24501 3307,-24501 3688.09,-24501 3688.09,-24501"/>
<polygon fill="black" stroke="black" points="3688.09,-24504.5 3698.09,-24501 3688.09,-24497.5 3688.09,-24504.5"/>
</g>
<!-- layer29_moe_comm_from_expert6&#45;&gt;layer29_moe_aggregate -->
<g id="edge1794" class="edge">
<title>layer29_moe_comm_from_expert6&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M3622.61,-24564.95C3622.61,-24564.95 3622.61,-24474.52 3622.61,-24474.52"/>
<polygon fill="black" stroke="black" points="3626.11,-24474.52 3622.61,-24464.52 3619.11,-24474.52 3626.11,-24474.52"/>
</g>
<!-- layer29_moe_comm_from_expert7&#45;&gt;layer29_moe_aggregate -->
<g id="edge1796" class="edge">
<title>layer29_moe_comm_from_expert7&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M3770,-24552.24C3770,-24552.24 3770,-24526.53 3770,-24526.53"/>
<polygon fill="black" stroke="black" points="3773.5,-24526.53 3770,-24516.53 3766.5,-24526.53 3773.5,-24526.53"/>
</g>
<!-- layer29_moe_comm_from_expert8&#45;&gt;layer29_moe_aggregate -->
<g id="edge1798" class="edge">
<title>layer29_moe_comm_from_expert8&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M4041.39,-24552.24C4041.39,-24552.24 4041.39,-24526.53 4041.39,-24526.53"/>
<polygon fill="black" stroke="black" points="4044.89,-24526.53 4041.39,-24516.53 4037.89,-24526.53 4044.89,-24526.53"/>
</g>
<!-- layer29_moe_comm_from_expert9&#45;&gt;layer29_moe_aggregate -->
<g id="edge1800" class="edge">
<title>layer29_moe_comm_from_expert9&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M4332.5,-24552.69C4332.5,-24530.3 4332.5,-24503 4332.5,-24503 4332.5,-24503 4127.37,-24503 4127.37,-24503"/>
<polygon fill="black" stroke="black" points="4127.37,-24499.5 4117.37,-24503 4127.37,-24506.5 4127.37,-24499.5"/>
</g>
<!-- layer29_moe_comm_from_expert10&#45;&gt;layer29_moe_aggregate -->
<g id="edge1802" class="edge">
<title>layer29_moe_comm_from_expert10&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M4664.15,-24553.02C4664.15,-24526.18 4664.15,-24490 4664.15,-24490 4664.15,-24490 4113.81,-24490 4113.81,-24490"/>
<polygon fill="black" stroke="black" points="4113.81,-24486.5 4103.81,-24490 4113.81,-24493.5 4113.81,-24486.5"/>
</g>
<!-- layer29_moe_comm_from_expert11&#45;&gt;layer29_moe_aggregate -->
<g id="edge1804" class="edge">
<title>layer29_moe_comm_from_expert11&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M5010.65,-24552.92C5010.65,-24521.99 5010.65,-24477 5010.65,-24477 5010.65,-24477 4100.47,-24477 4100.47,-24477"/>
<polygon fill="black" stroke="black" points="4100.47,-24473.5 4090.47,-24477 4100.47,-24480.5 4100.47,-24473.5"/>
</g>
<!-- layer29_moe_comm_from_expert12&#45;&gt;layer29_moe_aggregate -->
<g id="edge1806" class="edge">
<title>layer29_moe_comm_from_expert12&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M5361.65,-24553.03C5361.65,-24518.26 5361.65,-24464 5361.65,-24464 5361.65,-24464 4087.33,-24464 4087.33,-24464"/>
<polygon fill="black" stroke="black" points="4087.33,-24460.5 4077.33,-24464 4087.33,-24467.5 4087.33,-24460.5"/>
</g>
<!-- layer29_moe_comm_from_expert13&#45;&gt;layer29_moe_aggregate -->
<g id="edge1808" class="edge">
<title>layer29_moe_comm_from_expert13&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M5715.15,-24552.83C5715.15,-24514.43 5715.15,-24451 5715.15,-24451 5715.15,-24451 4073.95,-24451 4073.95,-24451"/>
<polygon fill="black" stroke="black" points="4073.95,-24447.5 4063.95,-24451 4073.95,-24454.5 4073.95,-24447.5"/>
</g>
<!-- layer29_moe_comm_from_expert14&#45;&gt;layer29_moe_aggregate -->
<g id="edge1810" class="edge">
<title>layer29_moe_comm_from_expert14&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M6070.15,-24552.77C6070.15,-24510.91 6070.15,-24438 6070.15,-24438 6070.15,-24438 4060.53,-24438 4060.53,-24438"/>
<polygon fill="black" stroke="black" points="4060.53,-24434.5 4050.53,-24438 4060.53,-24441.5 4060.53,-24434.5"/>
</g>
<!-- layer29_moe_comm_from_expert15&#45;&gt;layer29_moe_aggregate -->
<g id="edge1812" class="edge">
<title>layer29_moe_comm_from_expert15&#45;&gt;layer29_moe_aggregate</title>
<path fill="none" stroke="black" d="M6425.15,-24552.76C6425.15,-24507.59 6425.15,-24425 6425.15,-24425 6425.15,-24425 4047.21,-24425 4047.21,-24425"/>
<polygon fill="black" stroke="black" points="4047.21,-24421.5 4037.21,-24425 4047.21,-24428.5 4047.21,-24421.5"/>
</g>
<!-- layer30_moe_gate -->
<g id="node1413" class="node">
<title>layer30_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4127.3,-24288.47 3716.4,-24288.47 3610.7,-24184.47 4021.6,-24184.47 4127.3,-24288.47"/>
<text text-anchor="middle" x="3869" y="-24250.47" font-family="Arial" font-size="10.00">GATE L30</text>
<text text-anchor="middle" x="3869" y="-24239.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3869" y="-24228.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3869" y="-24217.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer30_moe_mha&#45;&gt;layer30_moe_gate -->
<g id="edge1881" class="edge">
<title>layer30_moe_mha&#45;&gt;layer30_moe_gate</title>
<path fill="none" stroke="black" d="M3869,-24324.32C3869,-24324.32 3869,-24298.57 3869,-24298.57"/>
<polygon fill="black" stroke="black" points="3872.5,-24298.57 3869,-24288.57 3865.5,-24298.57 3872.5,-24298.57"/>
</g>
<!-- layer30_moe_split -->
<g id="node1414" class="node">
<title>layer30_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4123.01,-24148.47 3718.94,-24148.47 3614.99,-24044.47 4019.06,-24044.47 4123.01,-24148.47"/>
<text text-anchor="middle" x="3869" y="-24110.47" font-family="Arial" font-size="10.00">SPLIT TOKENS L30</text>
<text text-anchor="middle" x="3869" y="-24099.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3869" y="-24088.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3869" y="-24077.47" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer30_moe_gate&#45;&gt;layer30_moe_split -->
<g id="edge1882" class="edge">
<title>layer30_moe_gate&#45;&gt;layer30_moe_split</title>
<path fill="none" stroke="black" d="M3869,-24184.34C3869,-24184.34 3869,-24158.64 3869,-24158.64"/>
<polygon fill="black" stroke="black" points="3872.5,-24158.64 3869,-24148.64 3865.5,-24158.64 3872.5,-24158.64"/>
</g>
<!-- layer30_moe_comm_to_expert0 -->
<g id="node1416" class="node">
<title>layer30_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1320" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1320" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1320" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1320" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert0 -->
<g id="edge1816" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3703.31,-24133C3149.15,-24133 1395,-24133 1395,-24133 1395,-24133 1395,-24005.91 1395,-24005.91"/>
<polygon fill="black" stroke="black" points="1398.5,-24005.91 1395,-23995.91 1391.5,-24005.91 1398.5,-24005.91"/>
</g>
<!-- layer30_moe_comm_to_expert1 -->
<g id="node1418" class="node">
<title>layer30_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2033" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2033" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="2033" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2033" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert1 -->
<g id="edge1818" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3688.16,-24118C3227.85,-24118 2048,-24118 2048,-24118 2048,-24118 2048,-24018.18 2048,-24018.18"/>
<polygon fill="black" stroke="black" points="2051.5,-24018.18 2048,-24008.18 2044.5,-24018.18 2051.5,-24018.18"/>
</g>
<!-- layer30_moe_comm_to_expert2 -->
<g id="node1420" class="node">
<title>layer30_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2489" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2489" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2489" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2489" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert2 -->
<g id="edge1820" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3673.23,-24103C3307.92,-24103 2559,-24103 2559,-24103 2559,-24103 2559,-24007.97 2559,-24007.97"/>
<polygon fill="black" stroke="black" points="2562.5,-24007.97 2559,-23997.97 2555.5,-24007.97 2562.5,-24007.97"/>
</g>
<!-- layer30_moe_comm_to_expert3 -->
<g id="node1422" class="node">
<title>layer30_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2817" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2817" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2817" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2817" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert3 -->
<g id="edge1822" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3659.46,-24089C3372.46,-24089 2892.25,-24089 2892.25,-24089 2892.25,-24089 2892.25,-24005.64 2892.25,-24005.64"/>
<polygon fill="black" stroke="black" points="2895.75,-24005.64 2892.25,-23995.64 2888.75,-24005.64 2895.75,-24005.64"/>
</g>
<!-- layer30_moe_comm_to_expert4 -->
<g id="node1424" class="node">
<title>layer30_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3080" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3080" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="3080" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3080" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert4 -->
<g id="edge1824" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3644.25,-24074C3428.93,-24074 3136.51,-24074 3136.51,-24074 3136.51,-24074 3136.51,-24012.36 3136.51,-24012.36"/>
<polygon fill="black" stroke="black" points="3140.01,-24012.36 3136.51,-24002.36 3133.01,-24012.36 3140.01,-24012.36"/>
</g>
<!-- layer30_moe_comm_to_expert5 -->
<g id="node1426" class="node">
<title>layer30_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3311" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3311" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3311" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3311" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert5 -->
<g id="edge1826" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3629.46,-24059C3512.86,-24059 3397.51,-24059 3397.51,-24059 3397.51,-24059 3397.51,-23998.29 3397.51,-23998.29"/>
<polygon fill="black" stroke="black" points="3401.01,-23998.29 3397.51,-23988.29 3394.01,-23998.29 3401.01,-23998.29"/>
</g>
<!-- layer30_moe_comm_to_expert6 -->
<g id="node1428" class="node">
<title>layer30_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3526" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3526" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3526" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3526" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert6 -->
<g id="edge1828" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3629.5,-24096.38C3629.5,-24092.83 3629.5,-23979 3629.5,-23979 3629.5,-23979 3626.81,-23979 3626.81,-23979"/>
<polygon fill="black" stroke="black" points="3626.81,-23975.5 3616.81,-23979 3626.81,-23982.5 3626.81,-23975.5"/>
</g>
<!-- layer30_moe_comm_to_expert7 -->
<g id="node1430" class="node">
<title>layer30_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3733" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3733" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3733" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3733" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert7 -->
<g id="edge1830" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3733,-24044.13C3733,-24044.13 3733,-24018.69 3733,-24018.69"/>
<polygon fill="black" stroke="black" points="3736.5,-24018.69 3733,-24008.69 3729.5,-24018.69 3736.5,-24018.69"/>
</g>
<!-- layer30_moe_comm_to_expert8 -->
<g id="node1432" class="node">
<title>layer30_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4005" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4005" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="4005" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4005" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert8 -->
<g id="edge1832" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4005,-24044.13C4005,-24044.13 4005,-24018.69 4005,-24018.69"/>
<polygon fill="black" stroke="black" points="4008.5,-24018.69 4005,-24008.69 4001.5,-24018.69 4008.5,-24018.69"/>
</g>
<!-- layer30_moe_comm_to_expert9 -->
<g id="node1434" class="node">
<title>layer30_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4314" cy="-23979.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4314" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4314" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4314" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert9 -->
<g id="edge1834" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4109.26,-24096.38C4109.26,-24092.83 4109.26,-23979 4109.26,-23979 4109.26,-23979 4213.3,-23979 4213.3,-23979"/>
<polygon fill="black" stroke="black" points="4213.3,-23982.5 4223.3,-23979 4213.3,-23975.5 4213.3,-23982.5"/>
</g>
<!-- layer30_moe_comm_to_expert10 -->
<g id="node1436" class="node">
<title>layer30_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4646" cy="-23979.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4646" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4646" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4646" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert10 -->
<g id="edge1836" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4033.82,-24059C4241.07,-24059 4570.1,-24059 4570.1,-24059 4570.1,-24059 4570.1,-24006.73 4570.1,-24006.73"/>
<polygon fill="black" stroke="black" points="4573.6,-24006.73 4570.1,-23996.73 4566.6,-24006.73 4573.6,-24006.73"/>
</g>
<!-- layer30_moe_comm_to_expert11 -->
<g id="node1438" class="node">
<title>layer30_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4992" cy="-23979.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4992" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4992" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4992" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert11 -->
<g id="edge1838" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4048.79,-24074C4348.24,-24074 4916.6,-24074 4916.6,-24074 4916.6,-24074 4916.6,-24006.82 4916.6,-24006.82"/>
<polygon fill="black" stroke="black" points="4920.1,-24006.82 4916.6,-23996.82 4913.1,-24006.82 4920.1,-24006.82"/>
</g>
<!-- layer30_moe_comm_to_expert12 -->
<g id="node1440" class="node">
<title>layer30_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5343" cy="-23979.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5343" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5343" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5343" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert12 -->
<g id="edge1840" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4063.84,-24089C4448.29,-24089 5267.6,-24089 5267.6,-24089 5267.6,-24089 5267.6,-24007.08 5267.6,-24007.08"/>
<polygon fill="black" stroke="black" points="5271.1,-24007.08 5267.6,-23997.08 5264.1,-24007.08 5271.1,-24007.08"/>
</g>
<!-- layer30_moe_comm_to_expert13 -->
<g id="node1442" class="node">
<title>layer30_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5696" cy="-23979.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5696" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5696" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5696" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert13 -->
<g id="edge1842" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4077.74,-24103C4542.33,-24103 5621.1,-24103 5621.1,-24103 5621.1,-24103 5621.1,-24007.18 5621.1,-24007.18"/>
<polygon fill="black" stroke="black" points="5624.6,-24007.18 5621.1,-23997.18 5617.6,-24007.18 5624.6,-24007.18"/>
</g>
<!-- layer30_moe_comm_to_expert14 -->
<g id="node1444" class="node">
<title>layer30_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6051" cy="-23979.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6051" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6051" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6051" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert14 -->
<g id="edge1844" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4093,-24118C4635.61,-24118 5976.1,-24118 5976.1,-24118 5976.1,-24118 5976.1,-24007.02 5976.1,-24007.02"/>
<polygon fill="black" stroke="black" points="5979.6,-24007.02 5976.1,-23997.02 5972.6,-24007.02 5979.6,-24007.02"/>
</g>
<!-- layer30_moe_comm_to_expert15 -->
<g id="node1446" class="node">
<title>layer30_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6406" cy="-23979.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6406" y="-23987.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6406" y="-23976.98" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6406" y="-23965.98" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert15 -->
<g id="edge1846" class="edge">
<title>layer30_moe_split&#45;&gt;layer30_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4107.59,-24133C4725.69,-24133 6331.1,-24133 6331.1,-24133 6331.1,-24133 6331.1,-24007.09 6331.1,-24007.09"/>
<polygon fill="black" stroke="black" points="6334.6,-24007.09 6331.1,-23997.09 6327.6,-24007.09 6334.6,-24007.09"/>
</g>
<!-- layer30_moe_expert0 -->
<g id="node1415" class="node">
<title>layer30_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1438,-23914.49 1110,-23914.49 1110,-23862.49 1438,-23862.49 1438,-23914.49"/>
<text text-anchor="middle" x="1274" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 0 L30</text>
<text text-anchor="middle" x="1274" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1274" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1274" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert0 -->
<g id="node1448" class="node">
<title>layer30_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1431" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1431" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1431" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1431" y="-23784" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer30_moe_expert0&#45;&gt;layer30_moe_comm_from_expert0 -->
<g id="edge1848" class="edge">
<title>layer30_moe_expert0&#45;&gt;layer30_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1389.25,-23862.17C1389.25,-23862.17 1389.25,-23833.44 1389.25,-23833.44"/>
<polygon fill="black" stroke="black" points="1392.75,-23833.44 1389.25,-23823.44 1385.75,-23833.44 1392.75,-23833.44"/>
</g>
<!-- layer30_moe_comm_to_expert0&#45;&gt;layer30_moe_expert0 -->
<g id="edge1817" class="edge">
<title>layer30_moe_comm_to_expert0&#45;&gt;layer30_moe_expert0</title>
<path fill="none" stroke="black" d="M1320,-23950.44C1320,-23950.44 1320,-23924.79 1320,-23924.79"/>
<polygon fill="black" stroke="black" points="1323.5,-23924.79 1320,-23914.79 1316.5,-23924.79 1323.5,-23924.79"/>
</g>
<!-- layer30_moe_expert1 -->
<g id="node1417" class="node">
<title>layer30_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1784,-23914.49 1456,-23914.49 1456,-23862.49 1784,-23862.49 1784,-23914.49"/>
<text text-anchor="middle" x="1620" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 1 L30</text>
<text text-anchor="middle" x="1620" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1620" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1620" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert1 -->
<g id="node1449" class="node">
<title>layer30_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1850" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1850" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1850" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1850" y="-23784" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer30_moe_expert1&#45;&gt;layer30_moe_comm_from_expert1 -->
<g id="edge1850" class="edge">
<title>layer30_moe_expert1&#45;&gt;layer30_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1771.75,-23862.17C1771.75,-23862.17 1771.75,-23822.15 1771.75,-23822.15"/>
<polygon fill="black" stroke="black" points="1775.25,-23822.15 1771.75,-23812.15 1768.25,-23822.15 1775.25,-23822.15"/>
</g>
<!-- layer30_moe_comm_to_expert1&#45;&gt;layer30_moe_expert1 -->
<g id="edge1819" class="edge">
<title>layer30_moe_comm_to_expert1&#45;&gt;layer30_moe_expert1</title>
<path fill="none" stroke="black" d="M1942.24,-23979C1849.11,-23979 1717.75,-23979 1717.75,-23979 1717.75,-23979 1717.75,-23924.67 1717.75,-23924.67"/>
<polygon fill="black" stroke="black" points="1721.25,-23924.67 1717.75,-23914.67 1714.25,-23924.67 1721.25,-23924.67"/>
</g>
<!-- layer30_moe_expert2 -->
<g id="node1419" class="node">
<title>layer30_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2130,-23914.49 1802,-23914.49 1802,-23862.49 2130,-23862.49 2130,-23914.49"/>
<text text-anchor="middle" x="1966" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 2 L30</text>
<text text-anchor="middle" x="1966" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1966" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1966" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert2 -->
<g id="node1450" class="node">
<title>layer30_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2159" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2159" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2159" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2159" y="-23784" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer30_moe_expert2&#45;&gt;layer30_moe_comm_from_expert2 -->
<g id="edge1852" class="edge">
<title>layer30_moe_expert2&#45;&gt;layer30_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2099.25,-23862.17C2099.25,-23862.17 2099.25,-23829.46 2099.25,-23829.46"/>
<polygon fill="black" stroke="black" points="2102.75,-23829.46 2099.25,-23819.46 2095.75,-23829.46 2102.75,-23829.46"/>
</g>
<!-- layer30_moe_comm_to_expert2&#45;&gt;layer30_moe_expert2 -->
<g id="edge1821" class="edge">
<title>layer30_moe_comm_to_expert2&#45;&gt;layer30_moe_expert2</title>
<path fill="none" stroke="black" d="M2398.28,-23979C2295.47,-23979 2142,-23979 2142,-23979 2142,-23979 2142,-23888 2142,-23888 2142,-23888 2140.18,-23888 2140.18,-23888"/>
<polygon fill="black" stroke="black" points="2140.18,-23884.5 2130.18,-23888 2140.18,-23891.5 2140.18,-23884.5"/>
</g>
<!-- layer30_moe_expert3 -->
<g id="node1421" class="node">
<title>layer30_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2476,-23914.49 2148,-23914.49 2148,-23862.49 2476,-23862.49 2476,-23914.49"/>
<text text-anchor="middle" x="2312" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 3 L30</text>
<text text-anchor="middle" x="2312" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2312" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2312" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert3 -->
<g id="node1451" class="node">
<title>layer30_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2413" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2413" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2413" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2413" y="-23784" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer30_moe_expert3&#45;&gt;layer30_moe_comm_from_expert3 -->
<g id="edge1854" class="edge">
<title>layer30_moe_expert3&#45;&gt;layer30_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2399.25,-23862.17C2399.25,-23862.17 2399.25,-23836.3 2399.25,-23836.3"/>
<polygon fill="black" stroke="black" points="2402.75,-23836.3 2399.25,-23826.3 2395.75,-23836.3 2402.75,-23836.3"/>
</g>
<!-- layer30_moe_comm_to_expert3&#45;&gt;layer30_moe_expert3 -->
<g id="edge1823" class="edge">
<title>layer30_moe_comm_to_expert3&#45;&gt;layer30_moe_expert3</title>
<path fill="none" stroke="black" d="M2758.33,-23957.28C2758.33,-23947.42 2758.33,-23938 2758.33,-23938 2758.33,-23938 2437.25,-23938 2437.25,-23938 2437.25,-23938 2437.25,-23924.69 2437.25,-23924.69"/>
<polygon fill="black" stroke="black" points="2440.75,-23924.69 2437.25,-23914.69 2433.75,-23924.69 2440.75,-23924.69"/>
</g>
<!-- layer30_moe_expert4 -->
<g id="node1423" class="node">
<title>layer30_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2822,-23914.49 2494,-23914.49 2494,-23862.49 2822,-23862.49 2822,-23914.49"/>
<text text-anchor="middle" x="2658" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 4 L30</text>
<text text-anchor="middle" x="2658" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2658" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2658" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert4 -->
<g id="node1452" class="node">
<title>layer30_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2751" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2751" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2751" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2751" y="-23784" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer30_moe_expert4&#45;&gt;layer30_moe_comm_from_expert4 -->
<g id="edge1856" class="edge">
<title>layer30_moe_expert4&#45;&gt;layer30_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2741.25,-23862.17C2741.25,-23862.17 2741.25,-23836.63 2741.25,-23836.63"/>
<polygon fill="black" stroke="black" points="2744.75,-23836.63 2741.25,-23826.63 2737.75,-23836.63 2744.75,-23836.63"/>
</g>
<!-- layer30_moe_comm_to_expert4&#45;&gt;layer30_moe_expert4 -->
<g id="edge1825" class="edge">
<title>layer30_moe_comm_to_expert4&#45;&gt;layer30_moe_expert4</title>
<path fill="none" stroke="black" d="M3078.75,-23950.24C3078.75,-23937.75 3078.75,-23926 3078.75,-23926 3078.75,-23926 2790.16,-23926 2790.16,-23926 2790.16,-23926 2790.16,-23924.54 2790.16,-23924.54"/>
<polygon fill="black" stroke="black" points="2793.66,-23924.54 2790.16,-23914.54 2786.66,-23924.54 2793.66,-23924.54"/>
</g>
<!-- layer30_moe_expert5 -->
<g id="node1425" class="node">
<title>layer30_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3168,-23914.49 2840,-23914.49 2840,-23862.49 3168,-23862.49 3168,-23914.49"/>
<text text-anchor="middle" x="3004" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 5 L30</text>
<text text-anchor="middle" x="3004" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3004" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="3004" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert5 -->
<g id="node1453" class="node">
<title>layer30_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3170" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3170" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3170" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3170" y="-23784" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer30_moe_expert5&#45;&gt;layer30_moe_comm_from_expert5 -->
<g id="edge1858" class="edge">
<title>layer30_moe_expert5&#45;&gt;layer30_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3123.75,-23862.17C3123.75,-23862.17 3123.75,-23832.5 3123.75,-23832.5"/>
<polygon fill="black" stroke="black" points="3127.25,-23832.5 3123.75,-23822.5 3120.25,-23832.5 3127.25,-23832.5"/>
</g>
<!-- layer30_moe_comm_to_expert5&#45;&gt;layer30_moe_expert5 -->
<g id="edge1827" class="edge">
<title>layer30_moe_comm_to_expert5&#45;&gt;layer30_moe_expert5</title>
<path fill="none" stroke="black" d="M3220.26,-23979C3196.92,-23979 3178.25,-23979 3178.25,-23979 3178.25,-23979 3178.25,-23888 3178.25,-23888 3178.25,-23888 3177.24,-23888 3177.24,-23888"/>
<polygon fill="black" stroke="black" points="3178.13,-23884.5 3168.13,-23888 3178.13,-23891.5 3178.13,-23884.5"/>
</g>
<!-- layer30_moe_expert6 -->
<g id="node1427" class="node">
<title>layer30_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3514,-23914.49 3186,-23914.49 3186,-23862.49 3514,-23862.49 3514,-23914.49"/>
<text text-anchor="middle" x="3350" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 6 L30</text>
<text text-anchor="middle" x="3350" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3350" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3350" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert6 -->
<g id="node1454" class="node">
<title>layer30_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3479" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3479" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3479" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3479" y="-23784" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer30_moe_expert6&#45;&gt;layer30_moe_comm_from_expert6 -->
<g id="edge1860" class="edge">
<title>layer30_moe_expert6&#45;&gt;layer30_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3451.25,-23862.17C3451.25,-23862.17 3451.25,-23835.34 3451.25,-23835.34"/>
<polygon fill="black" stroke="black" points="3454.75,-23835.34 3451.25,-23825.34 3447.75,-23835.34 3454.75,-23835.34"/>
</g>
<!-- layer30_moe_comm_to_expert6&#45;&gt;layer30_moe_expert6 -->
<g id="edge1829" class="edge">
<title>layer30_moe_comm_to_expert6&#45;&gt;layer30_moe_expert6</title>
<path fill="none" stroke="black" d="M3474.75,-23955.57C3474.75,-23955.57 3474.75,-23924.79 3474.75,-23924.79"/>
<polygon fill="black" stroke="black" points="3478.25,-23924.79 3474.75,-23914.79 3471.25,-23924.79 3478.25,-23924.79"/>
</g>
<!-- layer30_moe_expert7 -->
<g id="node1429" class="node">
<title>layer30_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3860,-23914.49 3532,-23914.49 3532,-23862.49 3860,-23862.49 3860,-23914.49"/>
<text text-anchor="middle" x="3696" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 7 L30</text>
<text text-anchor="middle" x="3696" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3696" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3696" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert7 -->
<g id="node1455" class="node">
<title>layer30_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3733" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3733" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3733" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3733" y="-23784" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer30_moe_expert7&#45;&gt;layer30_moe_comm_from_expert7 -->
<g id="edge1862" class="edge">
<title>layer30_moe_expert7&#45;&gt;layer30_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3733,-23862.17C3733,-23862.17 3733,-23836.63 3733,-23836.63"/>
<polygon fill="black" stroke="black" points="3736.5,-23836.63 3733,-23826.63 3729.5,-23836.63 3736.5,-23836.63"/>
</g>
<!-- layer30_moe_comm_to_expert7&#45;&gt;layer30_moe_expert7 -->
<g id="edge1831" class="edge">
<title>layer30_moe_comm_to_expert7&#45;&gt;layer30_moe_expert7</title>
<path fill="none" stroke="black" d="M3733,-23950.44C3733,-23950.44 3733,-23924.79 3733,-23924.79"/>
<polygon fill="black" stroke="black" points="3736.5,-23924.79 3733,-23914.79 3729.5,-23924.79 3736.5,-23924.79"/>
</g>
<!-- layer30_moe_expert8 -->
<g id="node1431" class="node">
<title>layer30_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4206,-23914.49 3878,-23914.49 3878,-23862.49 4206,-23862.49 4206,-23914.49"/>
<text text-anchor="middle" x="4042" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 8 L30</text>
<text text-anchor="middle" x="4042" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4042" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4042" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert8 -->
<g id="node1456" class="node">
<title>layer30_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="4005" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4005" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="4005" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4005" y="-23784" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer30_moe_expert8&#45;&gt;layer30_moe_comm_from_expert8 -->
<g id="edge1864" class="edge">
<title>layer30_moe_expert8&#45;&gt;layer30_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M4005,-23862.17C4005,-23862.17 4005,-23836.63 4005,-23836.63"/>
<polygon fill="black" stroke="black" points="4008.5,-23836.63 4005,-23826.63 4001.5,-23836.63 4008.5,-23836.63"/>
</g>
<!-- layer30_moe_comm_to_expert8&#45;&gt;layer30_moe_expert8 -->
<g id="edge1833" class="edge">
<title>layer30_moe_comm_to_expert8&#45;&gt;layer30_moe_expert8</title>
<path fill="none" stroke="black" d="M4005,-23950.44C4005,-23950.44 4005,-23924.79 4005,-23924.79"/>
<polygon fill="black" stroke="black" points="4008.5,-23924.79 4005,-23914.79 4001.5,-23924.79 4008.5,-23924.79"/>
</g>
<!-- layer30_moe_expert9 -->
<g id="node1433" class="node">
<title>layer30_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4552,-23914.49 4224,-23914.49 4224,-23862.49 4552,-23862.49 4552,-23914.49"/>
<text text-anchor="middle" x="4388" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 9 L30</text>
<text text-anchor="middle" x="4388" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4388" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4388" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert9 -->
<g id="node1457" class="node">
<title>layer30_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4314" cy="-23797.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4314" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4314" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4314" y="-23784" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer30_moe_expert9&#45;&gt;layer30_moe_comm_from_expert9 -->
<g id="edge1866" class="edge">
<title>layer30_moe_expert9&#45;&gt;layer30_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4314.25,-23862.17C4314.25,-23862.17 4314.25,-23836.63 4314.25,-23836.63"/>
<polygon fill="black" stroke="black" points="4317.75,-23836.63 4314.25,-23826.63 4310.75,-23836.63 4317.75,-23836.63"/>
</g>
<!-- layer30_moe_comm_to_expert9&#45;&gt;layer30_moe_expert9 -->
<g id="edge1835" class="edge">
<title>layer30_moe_comm_to_expert9&#45;&gt;layer30_moe_expert9</title>
<path fill="none" stroke="black" d="M4314.25,-23950.44C4314.25,-23950.44 4314.25,-23924.79 4314.25,-23924.79"/>
<polygon fill="black" stroke="black" points="4317.75,-23924.79 4314.25,-23914.79 4310.75,-23924.79 4317.75,-23924.79"/>
</g>
<!-- layer30_moe_expert10 -->
<g id="node1435" class="node">
<title>layer30_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4908,-23914.49 4570,-23914.49 4570,-23862.49 4908,-23862.49 4908,-23914.49"/>
<text text-anchor="middle" x="4739" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 10 L30</text>
<text text-anchor="middle" x="4739" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4739" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4739" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert10 -->
<g id="node1458" class="node">
<title>layer30_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4646" cy="-23797.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4646" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4646" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4646" y="-23784" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer30_moe_expert10&#45;&gt;layer30_moe_comm_from_expert10 -->
<g id="edge1868" class="edge">
<title>layer30_moe_expert10&#45;&gt;layer30_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4655.38,-23862.17C4655.38,-23862.17 4655.38,-23836.63 4655.38,-23836.63"/>
<polygon fill="black" stroke="black" points="4658.88,-23836.63 4655.38,-23826.63 4651.88,-23836.63 4658.88,-23836.63"/>
</g>
<!-- layer30_moe_comm_to_expert10&#45;&gt;layer30_moe_expert10 -->
<g id="edge1837" class="edge">
<title>layer30_moe_comm_to_expert10&#45;&gt;layer30_moe_expert10</title>
<path fill="none" stroke="black" d="M4655.02,-23950.44C4655.02,-23950.44 4655.02,-23924.79 4655.02,-23924.79"/>
<polygon fill="black" stroke="black" points="4658.52,-23924.79 4655.02,-23914.79 4651.52,-23924.79 4658.52,-23924.79"/>
</g>
<!-- layer30_moe_expert11 -->
<g id="node1437" class="node">
<title>layer30_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5264,-23914.49 4926,-23914.49 4926,-23862.49 5264,-23862.49 5264,-23914.49"/>
<text text-anchor="middle" x="5095" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 11 L30</text>
<text text-anchor="middle" x="5095" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5095" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5095" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert11 -->
<g id="node1459" class="node">
<title>layer30_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4993" cy="-23797.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4993" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4993" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4993" y="-23784" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer30_moe_expert11&#45;&gt;layer30_moe_comm_from_expert11 -->
<g id="edge1870" class="edge">
<title>layer30_moe_expert11&#45;&gt;layer30_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M5006.88,-23862.17C5006.88,-23862.17 5006.88,-23836.3 5006.88,-23836.3"/>
<polygon fill="black" stroke="black" points="5010.38,-23836.3 5006.88,-23826.3 5003.38,-23836.3 5010.38,-23836.3"/>
</g>
<!-- layer30_moe_comm_to_expert11&#45;&gt;layer30_moe_expert11 -->
<g id="edge1839" class="edge">
<title>layer30_moe_comm_to_expert11&#45;&gt;layer30_moe_expert11</title>
<path fill="none" stroke="black" d="M5006.02,-23950.69C5006.02,-23950.69 5006.02,-23924.62 5006.02,-23924.62"/>
<polygon fill="black" stroke="black" points="5009.52,-23924.62 5006.02,-23914.62 5002.52,-23924.62 5009.52,-23924.62"/>
</g>
<!-- layer30_moe_expert12 -->
<g id="node1439" class="node">
<title>layer30_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5620,-23914.49 5282,-23914.49 5282,-23862.49 5620,-23862.49 5620,-23914.49"/>
<text text-anchor="middle" x="5451" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 12 L30</text>
<text text-anchor="middle" x="5451" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5451" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5451" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert12 -->
<g id="node1460" class="node">
<title>layer30_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5344" cy="-23797.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5344" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5344" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5344" y="-23784" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer30_moe_expert12&#45;&gt;layer30_moe_comm_from_expert12 -->
<g id="edge1872" class="edge">
<title>layer30_moe_expert12&#45;&gt;layer30_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5360.38,-23862.17C5360.38,-23862.17 5360.38,-23836.3 5360.38,-23836.3"/>
<polygon fill="black" stroke="black" points="5363.88,-23836.3 5360.38,-23826.3 5356.88,-23836.3 5363.88,-23836.3"/>
</g>
<!-- layer30_moe_comm_to_expert12&#45;&gt;layer30_moe_expert12 -->
<g id="edge1841" class="edge">
<title>layer30_moe_comm_to_expert12&#45;&gt;layer30_moe_expert12</title>
<path fill="none" stroke="black" d="M5359.52,-23950.69C5359.52,-23950.69 5359.52,-23924.62 5359.52,-23924.62"/>
<polygon fill="black" stroke="black" points="5363.02,-23924.62 5359.52,-23914.62 5356.02,-23924.62 5363.02,-23924.62"/>
</g>
<!-- layer30_moe_expert13 -->
<g id="node1441" class="node">
<title>layer30_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5976,-23914.49 5638,-23914.49 5638,-23862.49 5976,-23862.49 5976,-23914.49"/>
<text text-anchor="middle" x="5807" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 13 L30</text>
<text text-anchor="middle" x="5807" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5807" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5807" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert13 -->
<g id="node1461" class="node">
<title>layer30_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5698" cy="-23797.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5698" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5698" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5698" y="-23784" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer30_moe_expert13&#45;&gt;layer30_moe_comm_from_expert13 -->
<g id="edge1874" class="edge">
<title>layer30_moe_expert13&#45;&gt;layer30_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5715.38,-23862.17C5715.38,-23862.17 5715.38,-23836.3 5715.38,-23836.3"/>
<polygon fill="black" stroke="black" points="5718.88,-23836.3 5715.38,-23826.3 5711.88,-23836.3 5718.88,-23836.3"/>
</g>
<!-- layer30_moe_comm_to_expert13&#45;&gt;layer30_moe_expert13 -->
<g id="edge1843" class="edge">
<title>layer30_moe_comm_to_expert13&#45;&gt;layer30_moe_expert13</title>
<path fill="none" stroke="black" d="M5714.02,-23950.69C5714.02,-23950.69 5714.02,-23924.62 5714.02,-23924.62"/>
<polygon fill="black" stroke="black" points="5717.52,-23924.62 5714.02,-23914.62 5710.52,-23924.62 5717.52,-23924.62"/>
</g>
<!-- layer30_moe_expert14 -->
<g id="node1443" class="node">
<title>layer30_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6332,-23914.49 5994,-23914.49 5994,-23862.49 6332,-23862.49 6332,-23914.49"/>
<text text-anchor="middle" x="6163" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 14 L30</text>
<text text-anchor="middle" x="6163" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6163" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6163" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert14 -->
<g id="node1462" class="node">
<title>layer30_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6053" cy="-23797.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6053" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6053" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6053" y="-23784" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer30_moe_expert14&#45;&gt;layer30_moe_comm_from_expert14 -->
<g id="edge1876" class="edge">
<title>layer30_moe_expert14&#45;&gt;layer30_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6070.88,-23862.17C6070.88,-23862.17 6070.88,-23835.98 6070.88,-23835.98"/>
<polygon fill="black" stroke="black" points="6074.38,-23835.98 6070.88,-23825.98 6067.38,-23835.98 6074.38,-23835.98"/>
</g>
<!-- layer30_moe_comm_to_expert14&#45;&gt;layer30_moe_expert14 -->
<g id="edge1845" class="edge">
<title>layer30_moe_comm_to_expert14&#45;&gt;layer30_moe_expert14</title>
<path fill="none" stroke="black" d="M6069.52,-23950.69C6069.52,-23950.69 6069.52,-23924.62 6069.52,-23924.62"/>
<polygon fill="black" stroke="black" points="6073.02,-23924.62 6069.52,-23914.62 6066.02,-23924.62 6073.02,-23924.62"/>
</g>
<!-- layer30_moe_expert15 -->
<g id="node1445" class="node">
<title>layer30_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6688,-23914.49 6350,-23914.49 6350,-23862.49 6688,-23862.49 6688,-23914.49"/>
<text text-anchor="middle" x="6519" y="-23902.49" font-family="Arial" font-size="10.00">EXPERT 15 L30</text>
<text text-anchor="middle" x="6519" y="-23891.49" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6519" y="-23880.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6519" y="-23869.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_comm_from_expert15 -->
<g id="node1463" class="node">
<title>layer30_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6408" cy="-23797.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6408" y="-23806" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6408" y="-23795" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6408" y="-23784" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer30_moe_expert15&#45;&gt;layer30_moe_comm_from_expert15 -->
<g id="edge1878" class="edge">
<title>layer30_moe_expert15&#45;&gt;layer30_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6426.38,-23862.17C6426.38,-23862.17 6426.38,-23835.98 6426.38,-23835.98"/>
<polygon fill="black" stroke="black" points="6429.88,-23835.98 6426.38,-23825.98 6422.88,-23835.98 6429.88,-23835.98"/>
</g>
<!-- layer30_moe_comm_to_expert15&#45;&gt;layer30_moe_expert15 -->
<g id="edge1847" class="edge">
<title>layer30_moe_comm_to_expert15&#45;&gt;layer30_moe_expert15</title>
<path fill="none" stroke="black" d="M6425.02,-23950.69C6425.02,-23950.69 6425.02,-23924.62 6425.02,-23924.62"/>
<polygon fill="black" stroke="black" points="6428.52,-23924.62 6425.02,-23914.62 6421.52,-23924.62 6428.52,-23924.62"/>
</g>
<!-- layer30_moe_aggregate -->
<g id="node1447" class="node">
<title>layer30_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4094.1,-23732.5 3677.16,-23732.5 3569.9,-23628.5 3986.84,-23628.5 4094.1,-23732.5"/>
<text text-anchor="middle" x="3832" y="-23694.5" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L30</text>
<text text-anchor="middle" x="3832" y="-23683.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3832" y="-23672.5" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3832" y="-23661.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_mha -->
<g id="node1464" class="node">
<title>layer31_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3962,-23592.5 3702,-23592.5 3702,-23540.5 3962,-23540.5 3962,-23592.5"/>
<text text-anchor="middle" x="3832" y="-23580.5" font-family="Arial" font-size="10.00">MHA L31</text>
<text text-anchor="middle" x="3832" y="-23569.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3832" y="-23558.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3832" y="-23547.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer30_moe_aggregate&#45;&gt;layer31_moe_mha -->
<g id="edge1947" class="edge">
<title>layer30_moe_aggregate&#45;&gt;layer31_moe_mha</title>
<path fill="none" stroke="black" d="M3832,-23628.18C3832,-23628.18 3832,-23602.73 3832,-23602.73"/>
<polygon fill="black" stroke="black" points="3835.5,-23602.73 3832,-23592.73 3828.5,-23602.73 3835.5,-23602.73"/>
</g>
<!-- layer30_moe_comm_from_expert0&#45;&gt;layer30_moe_aggregate -->
<g id="edge1849" class="edge">
<title>layer30_moe_comm_from_expert0&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M1470.25,-23771.29C1470.25,-23727.21 1470.25,-23643 1470.25,-23643 1470.25,-23643 3574.83,-23643 3574.83,-23643"/>
<polygon fill="black" stroke="black" points="3574.83,-23646.5 3584.83,-23643 3574.83,-23639.5 3574.83,-23646.5"/>
</g>
<!-- layer30_moe_comm_from_expert1&#45;&gt;layer30_moe_aggregate -->
<g id="edge1851" class="edge">
<title>layer30_moe_comm_from_expert1&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M1907,-23774.77C1907,-23735.25 1907,-23658 1907,-23658 1907,-23658 3590.28,-23658 3590.28,-23658"/>
<polygon fill="black" stroke="black" points="3590.28,-23661.5 3600.28,-23658 3590.28,-23654.5 3590.28,-23661.5"/>
</g>
<!-- layer30_moe_comm_from_expert2&#45;&gt;layer30_moe_aggregate -->
<g id="edge1853" class="edge">
<title>layer30_moe_comm_from_expert2&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M2180.25,-23769.25C2180.25,-23732.51 2180.25,-23673 2180.25,-23673 2180.25,-23673 3605.64,-23673 3605.64,-23673"/>
<polygon fill="black" stroke="black" points="3605.64,-23676.5 3615.64,-23673 3605.64,-23669.5 3605.64,-23676.5"/>
</g>
<!-- layer30_moe_comm_from_expert3&#45;&gt;layer30_moe_aggregate -->
<g id="edge1855" class="edge">
<title>layer30_moe_comm_from_expert3&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M2488.51,-23781.19C2488.51,-23750.46 2488.51,-23687 2488.51,-23687 2488.51,-23687 3620.14,-23687 3620.14,-23687"/>
<polygon fill="black" stroke="black" points="3620.14,-23690.5 3630.14,-23687 3620.14,-23683.5 3620.14,-23690.5"/>
</g>
<!-- layer30_moe_comm_from_expert4&#45;&gt;layer30_moe_aggregate -->
<g id="edge1857" class="edge">
<title>layer30_moe_comm_from_expert4&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M2822.25,-23779.53C2822.25,-23751.87 2822.25,-23702 2822.25,-23702 2822.25,-23702 3635.62,-23702 3635.62,-23702"/>
<polygon fill="black" stroke="black" points="3635.62,-23705.5 3645.62,-23702 3635.62,-23698.5 3635.62,-23705.5"/>
</g>
<!-- layer30_moe_comm_from_expert5&#45;&gt;layer30_moe_aggregate -->
<g id="edge1859" class="edge">
<title>layer30_moe_comm_from_expert5&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M3141.83,-23769.79C3141.83,-23746.51 3141.83,-23717 3141.83,-23717 3141.83,-23717 3650.95,-23717 3650.95,-23717"/>
<polygon fill="black" stroke="black" points="3650.95,-23720.5 3660.95,-23717 3650.95,-23713.5 3650.95,-23720.5"/>
</g>
<!-- layer30_moe_comm_from_expert6&#45;&gt;layer30_moe_aggregate -->
<g id="edge1861" class="edge">
<title>layer30_moe_comm_from_expert6&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M3569.68,-23797C3590.21,-23797 3606.1,-23797 3606.1,-23797 3606.1,-23797 3606.1,-23690.59 3606.1,-23690.59"/>
<polygon fill="black" stroke="black" points="3609.6,-23690.59 3606.1,-23680.59 3602.6,-23690.59 3609.6,-23690.59"/>
</g>
<!-- layer30_moe_comm_from_expert7&#45;&gt;layer30_moe_aggregate -->
<g id="edge1863" class="edge">
<title>layer30_moe_comm_from_expert7&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M3733,-23768.28C3733,-23768.28 3733,-23742.56 3733,-23742.56"/>
<polygon fill="black" stroke="black" points="3736.5,-23742.56 3733,-23732.56 3729.5,-23742.56 3736.5,-23742.56"/>
</g>
<!-- layer30_moe_comm_from_expert8&#45;&gt;layer30_moe_aggregate -->
<g id="edge1865" class="edge">
<title>layer30_moe_comm_from_expert8&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M4004.39,-23768.28C4004.39,-23768.28 4004.39,-23742.56 4004.39,-23742.56"/>
<polygon fill="black" stroke="black" points="4007.89,-23742.56 4004.39,-23732.56 4000.89,-23742.56 4007.89,-23742.56"/>
</g>
<!-- layer30_moe_comm_from_expert9&#45;&gt;layer30_moe_aggregate -->
<g id="edge1867" class="edge">
<title>layer30_moe_comm_from_expert9&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M4295.5,-23768.71C4295.5,-23746.31 4295.5,-23719 4295.5,-23719 4295.5,-23719 4090.37,-23719 4090.37,-23719"/>
<polygon fill="black" stroke="black" points="4090.37,-23715.5 4080.37,-23719 4090.37,-23722.5 4090.37,-23715.5"/>
</g>
<!-- layer30_moe_comm_from_expert10&#45;&gt;layer30_moe_aggregate -->
<g id="edge1869" class="edge">
<title>layer30_moe_comm_from_expert10&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M4627.15,-23769.05C4627.15,-23742.19 4627.15,-23706 4627.15,-23706 4627.15,-23706 4076.81,-23706 4076.81,-23706"/>
<polygon fill="black" stroke="black" points="4076.81,-23702.5 4066.81,-23706 4076.81,-23709.5 4076.81,-23702.5"/>
</g>
<!-- layer30_moe_comm_from_expert11&#45;&gt;layer30_moe_aggregate -->
<g id="edge1871" class="edge">
<title>layer30_moe_comm_from_expert11&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M4973.65,-23768.94C4973.65,-23738 4973.65,-23693 4973.65,-23693 4973.65,-23693 4063.47,-23693 4063.47,-23693"/>
<polygon fill="black" stroke="black" points="4063.47,-23689.5 4053.47,-23693 4063.47,-23696.5 4063.47,-23689.5"/>
</g>
<!-- layer30_moe_comm_from_expert12&#45;&gt;layer30_moe_aggregate -->
<g id="edge1873" class="edge">
<title>layer30_moe_comm_from_expert12&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M5324.65,-23769.05C5324.65,-23734.28 5324.65,-23680 5324.65,-23680 5324.65,-23680 4050.33,-23680 4050.33,-23680"/>
<polygon fill="black" stroke="black" points="4050.33,-23676.5 4040.33,-23680 4050.33,-23683.5 4050.33,-23676.5"/>
</g>
<!-- layer30_moe_comm_from_expert13&#45;&gt;layer30_moe_aggregate -->
<g id="edge1875" class="edge">
<title>layer30_moe_comm_from_expert13&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M5678.15,-23768.86C5678.15,-23730.44 5678.15,-23667 5678.15,-23667 5678.15,-23667 4036.95,-23667 4036.95,-23667"/>
<polygon fill="black" stroke="black" points="4036.95,-23663.5 4026.95,-23667 4036.95,-23670.5 4036.95,-23663.5"/>
</g>
<!-- layer30_moe_comm_from_expert14&#45;&gt;layer30_moe_aggregate -->
<g id="edge1877" class="edge">
<title>layer30_moe_comm_from_expert14&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M6033.15,-23769.15C6033.15,-23727.33 6033.15,-23654 6033.15,-23654 6033.15,-23654 4023.53,-23654 4023.53,-23654"/>
<polygon fill="black" stroke="black" points="4023.53,-23650.5 4013.53,-23654 4023.53,-23657.5 4023.53,-23650.5"/>
</g>
<!-- layer30_moe_comm_from_expert15&#45;&gt;layer30_moe_aggregate -->
<g id="edge1879" class="edge">
<title>layer30_moe_comm_from_expert15&#45;&gt;layer30_moe_aggregate</title>
<path fill="none" stroke="black" d="M6388.15,-23768.79C6388.15,-23723.61 6388.15,-23641 6388.15,-23641 6388.15,-23641 4010.21,-23641 4010.21,-23641"/>
<polygon fill="black" stroke="black" points="4010.21,-23637.5 4000.21,-23641 4010.21,-23644.5 4010.21,-23637.5"/>
</g>
<!-- layer31_moe_gate -->
<g id="node1465" class="node">
<title>layer31_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4090.3,-23504.5 3679.4,-23504.5 3573.7,-23400.5 3984.6,-23400.5 4090.3,-23504.5"/>
<text text-anchor="middle" x="3832" y="-23466.5" font-family="Arial" font-size="10.00">GATE L31</text>
<text text-anchor="middle" x="3832" y="-23455.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3832" y="-23444.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3832" y="-23433.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer31_moe_mha&#45;&gt;layer31_moe_gate -->
<g id="edge1948" class="edge">
<title>layer31_moe_mha&#45;&gt;layer31_moe_gate</title>
<path fill="none" stroke="black" d="M3832,-23540.35C3832,-23540.35 3832,-23514.6 3832,-23514.6"/>
<polygon fill="black" stroke="black" points="3835.5,-23514.6 3832,-23504.6 3828.5,-23514.6 3835.5,-23514.6"/>
</g>
<!-- layer31_moe_split -->
<g id="node1466" class="node">
<title>layer31_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4086.01,-23364.5 3681.94,-23364.5 3577.99,-23260.5 3982.06,-23260.5 4086.01,-23364.5"/>
<text text-anchor="middle" x="3832" y="-23326.5" font-family="Arial" font-size="10.00">SPLIT TOKENS L31</text>
<text text-anchor="middle" x="3832" y="-23315.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3832" y="-23304.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3832" y="-23293.5" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer31_moe_gate&#45;&gt;layer31_moe_split -->
<g id="edge1949" class="edge">
<title>layer31_moe_gate&#45;&gt;layer31_moe_split</title>
<path fill="none" stroke="black" d="M3832,-23400.37C3832,-23400.37 3832,-23374.68 3832,-23374.68"/>
<polygon fill="black" stroke="black" points="3835.5,-23374.68 3832,-23364.68 3828.5,-23374.68 3835.5,-23374.68"/>
</g>
<!-- layer31_moe_comm_to_expert0 -->
<g id="node1468" class="node">
<title>layer31_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1678" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1678" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1678" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1678" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert0 -->
<g id="edge1883" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3666.26,-23349C3175.53,-23349 1764,-23349 1764,-23349 1764,-23349 1764,-23214.65 1764,-23214.65"/>
<polygon fill="black" stroke="black" points="1767.5,-23214.65 1764,-23204.65 1760.5,-23214.65 1767.5,-23214.65"/>
</g>
<!-- layer31_moe_comm_to_expert1 -->
<g id="node1470" class="node">
<title>layer31_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1964" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1964" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1964" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1964" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert1 -->
<g id="edge1885" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3651.08,-23334C3188.27,-23334 1997.51,-23334 1997.51,-23334 1997.51,-23334 1997.51,-23232.54 1997.51,-23232.54"/>
<polygon fill="black" stroke="black" points="2001.01,-23232.54 1997.51,-23222.54 1994.01,-23232.54 2001.01,-23232.54"/>
</g>
<!-- layer31_moe_comm_to_expert2 -->
<g id="node1472" class="node">
<title>layer31_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2383" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2383" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2383" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2383" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert2 -->
<g id="edge1887" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3636.36,-23319C3243.95,-23319 2398,-23319 2398,-23319 2398,-23319 2398,-23234.15 2398,-23234.15"/>
<polygon fill="black" stroke="black" points="2401.5,-23234.15 2398,-23224.15 2394.5,-23234.15 2401.5,-23234.15"/>
</g>
<!-- layer31_moe_comm_to_expert3 -->
<g id="node1474" class="node">
<title>layer31_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2692" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2692" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2692" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2692" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert3 -->
<g id="edge1889" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3622.14,-23305C3300.26,-23305 2721.5,-23305 2721.5,-23305 2721.5,-23305 2721.5,-23233.14 2721.5,-23233.14"/>
<polygon fill="black" stroke="black" points="2725,-23233.14 2721.5,-23223.14 2718,-23233.14 2725,-23233.14"/>
</g>
<!-- layer31_moe_comm_to_expert4 -->
<g id="node1476" class="node">
<title>layer31_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2946" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2946" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2946" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2946" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert4 -->
<g id="edge1891" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3607.28,-23290C3344.79,-23290 2946,-23290 2946,-23290 2946,-23290 2946,-23234.63 2946,-23234.63"/>
<polygon fill="black" stroke="black" points="2949.5,-23234.63 2946,-23224.63 2942.5,-23234.63 2949.5,-23234.63"/>
</g>
<!-- layer31_moe_comm_to_expert5 -->
<g id="node1478" class="node">
<title>layer31_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3173" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3173" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3173" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3173" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert5 -->
<g id="edge1893" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3592.16,-23275C3413.8,-23275 3201.17,-23275 3201.17,-23275 3201.17,-23275 3201.17,-23233.31 3201.17,-23233.31"/>
<polygon fill="black" stroke="black" points="3204.67,-23233.31 3201.17,-23223.31 3197.67,-23233.31 3204.67,-23233.31"/>
</g>
<!-- layer31_moe_comm_to_expert6 -->
<g id="node1480" class="node">
<title>layer31_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3386" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3386" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3386" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3386" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert6 -->
<g id="edge1895" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3591.74,-23312.42C3591.74,-23308.86 3591.74,-23195 3591.74,-23195 3591.74,-23195 3486.54,-23195 3486.54,-23195"/>
<polygon fill="black" stroke="black" points="3486.54,-23191.5 3476.54,-23195 3486.54,-23198.5 3486.54,-23191.5"/>
</g>
<!-- layer31_moe_comm_to_expert7 -->
<g id="node1482" class="node">
<title>layer31_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3696" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3696" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3696" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3696" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert7 -->
<g id="edge1897" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3696,-23260.17C3696,-23260.17 3696,-23234.72 3696,-23234.72"/>
<polygon fill="black" stroke="black" points="3699.5,-23234.72 3696,-23224.72 3692.5,-23234.72 3699.5,-23234.72"/>
</g>
<!-- layer31_moe_comm_to_expert8 -->
<g id="node1484" class="node">
<title>layer31_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3968" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3968" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3968" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3968" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert8 -->
<g id="edge1899" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3968,-23260.17C3968,-23260.17 3968,-23234.72 3968,-23234.72"/>
<polygon fill="black" stroke="black" points="3971.5,-23234.72 3968,-23224.72 3964.5,-23234.72 3971.5,-23234.72"/>
</g>
<!-- layer31_moe_comm_to_expert9 -->
<g id="node1486" class="node">
<title>layer31_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4277" cy="-23195.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4277" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4277" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4277" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert9 -->
<g id="edge1901" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4072.26,-23312.42C4072.26,-23308.86 4072.26,-23195 4072.26,-23195 4072.26,-23195 4176.3,-23195 4176.3,-23195"/>
<polygon fill="black" stroke="black" points="4176.3,-23198.5 4186.3,-23195 4176.3,-23191.5 4176.3,-23198.5"/>
</g>
<!-- layer31_moe_comm_to_expert10 -->
<g id="node1488" class="node">
<title>layer31_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4609" cy="-23195.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4609" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4609" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4609" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert10 -->
<g id="edge1903" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3996.82,-23275C4204.07,-23275 4533.1,-23275 4533.1,-23275 4533.1,-23275 4533.1,-23222.76 4533.1,-23222.76"/>
<polygon fill="black" stroke="black" points="4536.6,-23222.76 4533.1,-23212.76 4529.6,-23222.76 4536.6,-23222.76"/>
</g>
<!-- layer31_moe_comm_to_expert11 -->
<g id="node1490" class="node">
<title>layer31_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4955" cy="-23195.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4955" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4955" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4955" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert11 -->
<g id="edge1905" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4011.79,-23290C4311.24,-23290 4879.6,-23290 4879.6,-23290 4879.6,-23290 4879.6,-23222.84 4879.6,-23222.84"/>
<polygon fill="black" stroke="black" points="4883.1,-23222.84 4879.6,-23212.84 4876.1,-23222.84 4883.1,-23222.84"/>
</g>
<!-- layer31_moe_comm_to_expert12 -->
<g id="node1492" class="node">
<title>layer31_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5306" cy="-23195.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5306" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5306" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5306" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert12 -->
<g id="edge1907" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4026.84,-23305C4411.29,-23305 5230.6,-23305 5230.6,-23305 5230.6,-23305 5230.6,-23223.1 5230.6,-23223.1"/>
<polygon fill="black" stroke="black" points="5234.1,-23223.1 5230.6,-23213.1 5227.1,-23223.1 5234.1,-23223.1"/>
</g>
<!-- layer31_moe_comm_to_expert13 -->
<g id="node1494" class="node">
<title>layer31_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5659" cy="-23195.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5659" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5659" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5659" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert13 -->
<g id="edge1909" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4040.74,-23319C4505.33,-23319 5584.1,-23319 5584.1,-23319 5584.1,-23319 5584.1,-23223.21 5584.1,-23223.21"/>
<polygon fill="black" stroke="black" points="5587.6,-23223.21 5584.1,-23213.21 5580.6,-23223.21 5587.6,-23223.21"/>
</g>
<!-- layer31_moe_comm_to_expert14 -->
<g id="node1496" class="node">
<title>layer31_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6014" cy="-23195.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6014" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="6014" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6014" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert14 -->
<g id="edge1911" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4056,-23334C4598.61,-23334 5939.1,-23334 5939.1,-23334 5939.1,-23334 5939.1,-23223.05 5939.1,-23223.05"/>
<polygon fill="black" stroke="black" points="5942.6,-23223.05 5939.1,-23213.05 5935.6,-23223.05 5942.6,-23223.05"/>
</g>
<!-- layer31_moe_comm_to_expert15 -->
<g id="node1498" class="node">
<title>layer31_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6369" cy="-23195.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6369" y="-23204.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6369" y="-23193.01" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6369" y="-23182.01" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert15 -->
<g id="edge1913" class="edge">
<title>layer31_moe_split&#45;&gt;layer31_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4070.59,-23349C4688.69,-23349 6294.1,-23349 6294.1,-23349 6294.1,-23349 6294.1,-23223.12 6294.1,-23223.12"/>
<polygon fill="black" stroke="black" points="6297.6,-23223.12 6294.1,-23213.12 6290.6,-23223.12 6297.6,-23223.12"/>
</g>
<!-- layer31_moe_expert0 -->
<g id="node1467" class="node">
<title>layer31_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1401,-23130.52 1073,-23130.52 1073,-23078.52 1401,-23078.52 1401,-23130.52"/>
<text text-anchor="middle" x="1237" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 0 L31</text>
<text text-anchor="middle" x="1237" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1237" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1237" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert0 -->
<g id="node1500" class="node">
<title>layer31_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1324" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1324" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1324" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1324" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer31_moe_expert0&#45;&gt;layer31_moe_comm_from_expert0 -->
<g id="edge1915" class="edge">
<title>layer31_moe_expert0&#45;&gt;layer31_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1317.25,-23078.2C1317.25,-23078.2 1317.25,-23052.66 1317.25,-23052.66"/>
<polygon fill="black" stroke="black" points="1320.75,-23052.66 1317.25,-23042.66 1313.75,-23052.66 1320.75,-23052.66"/>
</g>
<!-- layer31_moe_comm_to_expert0&#45;&gt;layer31_moe_expert0 -->
<g id="edge1884" class="edge">
<title>layer31_moe_comm_to_expert0&#45;&gt;layer31_moe_expert0</title>
<path fill="none" stroke="black" d="M1587.48,-23195C1496.84,-23195 1370.75,-23195 1370.75,-23195 1370.75,-23195 1370.75,-23140.69 1370.75,-23140.69"/>
<polygon fill="black" stroke="black" points="1374.25,-23140.69 1370.75,-23130.69 1367.25,-23140.69 1374.25,-23140.69"/>
</g>
<!-- layer31_moe_expert1 -->
<g id="node1469" class="node">
<title>layer31_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1747,-23130.52 1419,-23130.52 1419,-23078.52 1747,-23078.52 1747,-23130.52"/>
<text text-anchor="middle" x="1583" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 1 L31</text>
<text text-anchor="middle" x="1583" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1583" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1583" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert1 -->
<g id="node1501" class="node">
<title>layer31_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1964" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1964" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1964" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1964" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer31_moe_expert1&#45;&gt;layer31_moe_comm_from_expert1 -->
<g id="edge1917" class="edge">
<title>layer31_moe_expert1&#45;&gt;layer31_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1716.25,-23078.05C1716.25,-23051.02 1716.25,-23013 1716.25,-23013 1716.25,-23013 1863.5,-23013 1863.5,-23013"/>
<polygon fill="black" stroke="black" points="1863.5,-23016.5 1873.5,-23013 1863.5,-23009.5 1863.5,-23016.5"/>
</g>
<!-- layer31_moe_comm_to_expert1&#45;&gt;layer31_moe_expert1 -->
<g id="edge1886" class="edge">
<title>layer31_moe_comm_to_expert1&#45;&gt;layer31_moe_expert1</title>
<path fill="none" stroke="black" d="M1964,-23166.25C1964,-23153.76 1964,-23142 1964,-23142 1964,-23142 1667.25,-23142 1667.25,-23142 1667.25,-23142 1667.25,-23140.55 1667.25,-23140.55"/>
<polygon fill="black" stroke="black" points="1670.75,-23140.55 1667.25,-23130.55 1663.75,-23140.55 1670.75,-23140.55"/>
</g>
<!-- layer31_moe_expert2 -->
<g id="node1471" class="node">
<title>layer31_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2093,-23130.52 1765,-23130.52 1765,-23078.52 2093,-23078.52 2093,-23130.52"/>
<text text-anchor="middle" x="1929" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 2 L31</text>
<text text-anchor="middle" x="1929" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1929" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1929" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert2 -->
<g id="node1502" class="node">
<title>layer31_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2383" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2383" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2383" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2383" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer31_moe_expert2&#45;&gt;layer31_moe_comm_from_expert2 -->
<g id="edge1919" class="edge">
<title>layer31_moe_expert2&#45;&gt;layer31_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2073.75,-23078.05C2073.75,-23051.02 2073.75,-23013 2073.75,-23013 2073.75,-23013 2282.31,-23013 2282.31,-23013"/>
<polygon fill="black" stroke="black" points="2282.31,-23016.5 2292.31,-23013 2282.31,-23009.5 2282.31,-23016.5"/>
</g>
<!-- layer31_moe_comm_to_expert2&#45;&gt;layer31_moe_expert2 -->
<g id="edge1888" class="edge">
<title>layer31_moe_comm_to_expert2&#45;&gt;layer31_moe_expert2</title>
<path fill="none" stroke="black" d="M2292.31,-23195C2203.28,-23195 2080.75,-23195 2080.75,-23195 2080.75,-23195 2080.75,-23140.69 2080.75,-23140.69"/>
<polygon fill="black" stroke="black" points="2084.25,-23140.69 2080.75,-23130.69 2077.25,-23140.69 2084.25,-23140.69"/>
</g>
<!-- layer31_moe_expert3 -->
<g id="node1473" class="node">
<title>layer31_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2439,-23130.52 2111,-23130.52 2111,-23078.52 2439,-23078.52 2439,-23130.52"/>
<text text-anchor="middle" x="2275" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 3 L31</text>
<text text-anchor="middle" x="2275" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2275" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2275" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert3 -->
<g id="node1503" class="node">
<title>layer31_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2692" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2692" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2692" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2692" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer31_moe_expert3&#45;&gt;layer31_moe_comm_from_expert3 -->
<g id="edge1921" class="edge">
<title>layer31_moe_expert3&#45;&gt;layer31_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2365.75,-23078.37C2365.75,-23068.67 2365.75,-23060 2365.75,-23060 2365.75,-23060 2692,-23060 2692,-23060 2692,-23060 2692,-23052.7 2692,-23052.7"/>
<polygon fill="black" stroke="black" points="2695.5,-23052.7 2692,-23042.7 2688.5,-23052.7 2695.5,-23052.7"/>
</g>
<!-- layer31_moe_comm_to_expert3&#45;&gt;layer31_moe_expert3 -->
<g id="edge1890" class="edge">
<title>layer31_moe_comm_to_expert3&#45;&gt;layer31_moe_expert3</title>
<path fill="none" stroke="black" d="M2692,-23166.23C2692,-23159.36 2692,-23154 2692,-23154 2692,-23154 2365.75,-23154 2365.75,-23154 2365.75,-23154 2365.75,-23140.71 2365.75,-23140.71"/>
<polygon fill="black" stroke="black" points="2369.25,-23140.71 2365.75,-23130.71 2362.25,-23140.71 2369.25,-23140.71"/>
</g>
<!-- layer31_moe_expert4 -->
<g id="node1475" class="node">
<title>layer31_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2785,-23130.52 2457,-23130.52 2457,-23078.52 2785,-23078.52 2785,-23130.52"/>
<text text-anchor="middle" x="2621" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 4 L31</text>
<text text-anchor="middle" x="2621" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2621" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2621" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert4 -->
<g id="node1504" class="node">
<title>layer31_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2946" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2946" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2946" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2946" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer31_moe_expert4&#45;&gt;layer31_moe_comm_from_expert4 -->
<g id="edge1923" class="edge">
<title>layer31_moe_expert4&#45;&gt;layer31_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2785.18,-23095C2792.6,-23095 2797,-23095 2797,-23095 2797,-23095 2797,-23013 2797,-23013 2797,-23013 2845.46,-23013 2845.46,-23013"/>
<polygon fill="black" stroke="black" points="2845.46,-23016.5 2855.46,-23013 2845.46,-23009.5 2845.46,-23016.5"/>
</g>
<!-- layer31_moe_comm_to_expert4&#45;&gt;layer31_moe_expert4 -->
<g id="edge1892" class="edge">
<title>layer31_moe_comm_to_expert4&#45;&gt;layer31_moe_expert4</title>
<path fill="none" stroke="black" d="M2855.39,-23195C2821.47,-23195 2791,-23195 2791,-23195 2791,-23195 2791,-23113 2791,-23113 2791,-23113 2790.43,-23113 2790.43,-23113"/>
<polygon fill="black" stroke="black" points="2795.34,-23109.5 2785.34,-23113 2795.34,-23116.5 2795.34,-23109.5"/>
</g>
<!-- layer31_moe_expert5 -->
<g id="node1477" class="node">
<title>layer31_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3131,-23130.52 2803,-23130.52 2803,-23078.52 3131,-23078.52 3131,-23130.52"/>
<text text-anchor="middle" x="2967" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 5 L31</text>
<text text-anchor="middle" x="2967" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2967" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2967" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert5 -->
<g id="node1505" class="node">
<title>layer31_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3173" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3173" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3173" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3173" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer31_moe_expert5&#45;&gt;layer31_moe_comm_from_expert5 -->
<g id="edge1925" class="edge">
<title>layer31_moe_expert5&#45;&gt;layer31_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3106.75,-23078.2C3106.75,-23078.2 3106.75,-23043.43 3106.75,-23043.43"/>
<polygon fill="black" stroke="black" points="3110.25,-23043.43 3106.75,-23033.43 3103.25,-23043.43 3110.25,-23043.43"/>
</g>
<!-- layer31_moe_comm_to_expert5&#45;&gt;layer31_moe_expert5 -->
<g id="edge1894" class="edge">
<title>layer31_moe_comm_to_expert5&#45;&gt;layer31_moe_expert5</title>
<path fill="none" stroke="black" d="M3106.75,-23175.32C3106.75,-23175.32 3106.75,-23140.54 3106.75,-23140.54"/>
<polygon fill="black" stroke="black" points="3110.25,-23140.54 3106.75,-23130.54 3103.25,-23140.54 3110.25,-23140.54"/>
</g>
<!-- layer31_moe_expert6 -->
<g id="node1479" class="node">
<title>layer31_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3477,-23130.52 3149,-23130.52 3149,-23078.52 3477,-23078.52 3477,-23130.52"/>
<text text-anchor="middle" x="3313" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 6 L31</text>
<text text-anchor="middle" x="3313" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3313" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3313" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert6 -->
<g id="node1506" class="node">
<title>layer31_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3386" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3386" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3386" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3386" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer31_moe_expert6&#45;&gt;layer31_moe_comm_from_expert6 -->
<g id="edge1927" class="edge">
<title>layer31_moe_expert6&#45;&gt;layer31_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3386,-23078.2C3386,-23078.2 3386,-23052.66 3386,-23052.66"/>
<polygon fill="black" stroke="black" points="3389.5,-23052.66 3386,-23042.66 3382.5,-23052.66 3389.5,-23052.66"/>
</g>
<!-- layer31_moe_comm_to_expert6&#45;&gt;layer31_moe_expert6 -->
<g id="edge1896" class="edge">
<title>layer31_moe_comm_to_expert6&#45;&gt;layer31_moe_expert6</title>
<path fill="none" stroke="black" d="M3386,-23166.47C3386,-23166.47 3386,-23140.82 3386,-23140.82"/>
<polygon fill="black" stroke="black" points="3389.5,-23140.82 3386,-23130.82 3382.5,-23140.82 3389.5,-23140.82"/>
</g>
<!-- layer31_moe_expert7 -->
<g id="node1481" class="node">
<title>layer31_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3823,-23130.52 3495,-23130.52 3495,-23078.52 3823,-23078.52 3823,-23130.52"/>
<text text-anchor="middle" x="3659" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 7 L31</text>
<text text-anchor="middle" x="3659" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3659" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3659" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert7 -->
<g id="node1507" class="node">
<title>layer31_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3696" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3696" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3696" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3696" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer31_moe_expert7&#45;&gt;layer31_moe_comm_from_expert7 -->
<g id="edge1929" class="edge">
<title>layer31_moe_expert7&#45;&gt;layer31_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3696,-23078.2C3696,-23078.2 3696,-23052.66 3696,-23052.66"/>
<polygon fill="black" stroke="black" points="3699.5,-23052.66 3696,-23042.66 3692.5,-23052.66 3699.5,-23052.66"/>
</g>
<!-- layer31_moe_comm_to_expert7&#45;&gt;layer31_moe_expert7 -->
<g id="edge1898" class="edge">
<title>layer31_moe_comm_to_expert7&#45;&gt;layer31_moe_expert7</title>
<path fill="none" stroke="black" d="M3696,-23166.47C3696,-23166.47 3696,-23140.82 3696,-23140.82"/>
<polygon fill="black" stroke="black" points="3699.5,-23140.82 3696,-23130.82 3692.5,-23140.82 3699.5,-23140.82"/>
</g>
<!-- layer31_moe_expert8 -->
<g id="node1483" class="node">
<title>layer31_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4169,-23130.52 3841,-23130.52 3841,-23078.52 4169,-23078.52 4169,-23130.52"/>
<text text-anchor="middle" x="4005" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 8 L31</text>
<text text-anchor="middle" x="4005" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4005" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="4005" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert8 -->
<g id="node1508" class="node">
<title>layer31_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3968" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3968" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3968" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3968" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer31_moe_expert8&#45;&gt;layer31_moe_comm_from_expert8 -->
<g id="edge1931" class="edge">
<title>layer31_moe_expert8&#45;&gt;layer31_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3968,-23078.2C3968,-23078.2 3968,-23052.66 3968,-23052.66"/>
<polygon fill="black" stroke="black" points="3971.5,-23052.66 3968,-23042.66 3964.5,-23052.66 3971.5,-23052.66"/>
</g>
<!-- layer31_moe_comm_to_expert8&#45;&gt;layer31_moe_expert8 -->
<g id="edge1900" class="edge">
<title>layer31_moe_comm_to_expert8&#45;&gt;layer31_moe_expert8</title>
<path fill="none" stroke="black" d="M3968,-23166.47C3968,-23166.47 3968,-23140.82 3968,-23140.82"/>
<polygon fill="black" stroke="black" points="3971.5,-23140.82 3968,-23130.82 3964.5,-23140.82 3971.5,-23140.82"/>
</g>
<!-- layer31_moe_expert9 -->
<g id="node1485" class="node">
<title>layer31_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4515,-23130.52 4187,-23130.52 4187,-23078.52 4515,-23078.52 4515,-23130.52"/>
<text text-anchor="middle" x="4351" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 9 L31</text>
<text text-anchor="middle" x="4351" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4351" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4351" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert9 -->
<g id="node1509" class="node">
<title>layer31_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4277" cy="-23013.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4277" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4277" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4277" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer31_moe_expert9&#45;&gt;layer31_moe_comm_from_expert9 -->
<g id="edge1933" class="edge">
<title>layer31_moe_expert9&#45;&gt;layer31_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4277.25,-23078.2C4277.25,-23078.2 4277.25,-23052.66 4277.25,-23052.66"/>
<polygon fill="black" stroke="black" points="4280.75,-23052.66 4277.25,-23042.66 4273.75,-23052.66 4280.75,-23052.66"/>
</g>
<!-- layer31_moe_comm_to_expert9&#45;&gt;layer31_moe_expert9 -->
<g id="edge1902" class="edge">
<title>layer31_moe_comm_to_expert9&#45;&gt;layer31_moe_expert9</title>
<path fill="none" stroke="black" d="M4277.25,-23166.47C4277.25,-23166.47 4277.25,-23140.82 4277.25,-23140.82"/>
<polygon fill="black" stroke="black" points="4280.75,-23140.82 4277.25,-23130.82 4273.75,-23140.82 4280.75,-23140.82"/>
</g>
<!-- layer31_moe_expert10 -->
<g id="node1487" class="node">
<title>layer31_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4871,-23130.52 4533,-23130.52 4533,-23078.52 4871,-23078.52 4871,-23130.52"/>
<text text-anchor="middle" x="4702" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 10 L31</text>
<text text-anchor="middle" x="4702" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4702" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4702" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert10 -->
<g id="node1510" class="node">
<title>layer31_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4609" cy="-23013.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4609" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4609" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4609" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer31_moe_expert10&#45;&gt;layer31_moe_comm_from_expert10 -->
<g id="edge1935" class="edge">
<title>layer31_moe_expert10&#45;&gt;layer31_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4618.38,-23078.2C4618.38,-23078.2 4618.38,-23052.66 4618.38,-23052.66"/>
<polygon fill="black" stroke="black" points="4621.88,-23052.66 4618.38,-23042.66 4614.88,-23052.66 4621.88,-23052.66"/>
</g>
<!-- layer31_moe_comm_to_expert10&#45;&gt;layer31_moe_expert10 -->
<g id="edge1904" class="edge">
<title>layer31_moe_comm_to_expert10&#45;&gt;layer31_moe_expert10</title>
<path fill="none" stroke="black" d="M4618.02,-23166.47C4618.02,-23166.47 4618.02,-23140.82 4618.02,-23140.82"/>
<polygon fill="black" stroke="black" points="4621.52,-23140.82 4618.02,-23130.82 4614.52,-23140.82 4621.52,-23140.82"/>
</g>
<!-- layer31_moe_expert11 -->
<g id="node1489" class="node">
<title>layer31_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5227,-23130.52 4889,-23130.52 4889,-23078.52 5227,-23078.52 5227,-23130.52"/>
<text text-anchor="middle" x="5058" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 11 L31</text>
<text text-anchor="middle" x="5058" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5058" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5058" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert11 -->
<g id="node1511" class="node">
<title>layer31_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4956" cy="-23013.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4956" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4956" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4956" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer31_moe_expert11&#45;&gt;layer31_moe_comm_from_expert11 -->
<g id="edge1937" class="edge">
<title>layer31_moe_expert11&#45;&gt;layer31_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4969.88,-23078.2C4969.88,-23078.2 4969.88,-23052.34 4969.88,-23052.34"/>
<polygon fill="black" stroke="black" points="4973.38,-23052.34 4969.88,-23042.34 4966.38,-23052.34 4973.38,-23052.34"/>
</g>
<!-- layer31_moe_comm_to_expert11&#45;&gt;layer31_moe_expert11 -->
<g id="edge1906" class="edge">
<title>layer31_moe_comm_to_expert11&#45;&gt;layer31_moe_expert11</title>
<path fill="none" stroke="black" d="M4969.02,-23166.72C4969.02,-23166.72 4969.02,-23140.66 4969.02,-23140.66"/>
<polygon fill="black" stroke="black" points="4972.52,-23140.66 4969.02,-23130.66 4965.52,-23140.66 4972.52,-23140.66"/>
</g>
<!-- layer31_moe_expert12 -->
<g id="node1491" class="node">
<title>layer31_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5583,-23130.52 5245,-23130.52 5245,-23078.52 5583,-23078.52 5583,-23130.52"/>
<text text-anchor="middle" x="5414" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 12 L31</text>
<text text-anchor="middle" x="5414" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5414" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5414" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert12 -->
<g id="node1512" class="node">
<title>layer31_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5307" cy="-23013.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5307" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5307" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5307" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer31_moe_expert12&#45;&gt;layer31_moe_comm_from_expert12 -->
<g id="edge1939" class="edge">
<title>layer31_moe_expert12&#45;&gt;layer31_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5323.38,-23078.2C5323.38,-23078.2 5323.38,-23052.34 5323.38,-23052.34"/>
<polygon fill="black" stroke="black" points="5326.88,-23052.34 5323.38,-23042.34 5319.88,-23052.34 5326.88,-23052.34"/>
</g>
<!-- layer31_moe_comm_to_expert12&#45;&gt;layer31_moe_expert12 -->
<g id="edge1908" class="edge">
<title>layer31_moe_comm_to_expert12&#45;&gt;layer31_moe_expert12</title>
<path fill="none" stroke="black" d="M5322.52,-23166.72C5322.52,-23166.72 5322.52,-23140.66 5322.52,-23140.66"/>
<polygon fill="black" stroke="black" points="5326.02,-23140.66 5322.52,-23130.66 5319.02,-23140.66 5326.02,-23140.66"/>
</g>
<!-- layer31_moe_expert13 -->
<g id="node1493" class="node">
<title>layer31_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5939,-23130.52 5601,-23130.52 5601,-23078.52 5939,-23078.52 5939,-23130.52"/>
<text text-anchor="middle" x="5770" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 13 L31</text>
<text text-anchor="middle" x="5770" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5770" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5770" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert13 -->
<g id="node1513" class="node">
<title>layer31_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5661" cy="-23013.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5661" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5661" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5661" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer31_moe_expert13&#45;&gt;layer31_moe_comm_from_expert13 -->
<g id="edge1941" class="edge">
<title>layer31_moe_expert13&#45;&gt;layer31_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5678.38,-23078.2C5678.38,-23078.2 5678.38,-23052.34 5678.38,-23052.34"/>
<polygon fill="black" stroke="black" points="5681.88,-23052.34 5678.38,-23042.34 5674.88,-23052.34 5681.88,-23052.34"/>
</g>
<!-- layer31_moe_comm_to_expert13&#45;&gt;layer31_moe_expert13 -->
<g id="edge1910" class="edge">
<title>layer31_moe_comm_to_expert13&#45;&gt;layer31_moe_expert13</title>
<path fill="none" stroke="black" d="M5677.02,-23166.72C5677.02,-23166.72 5677.02,-23140.66 5677.02,-23140.66"/>
<polygon fill="black" stroke="black" points="5680.52,-23140.66 5677.02,-23130.66 5673.52,-23140.66 5680.52,-23140.66"/>
</g>
<!-- layer31_moe_expert14 -->
<g id="node1495" class="node">
<title>layer31_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6295,-23130.52 5957,-23130.52 5957,-23078.52 6295,-23078.52 6295,-23130.52"/>
<text text-anchor="middle" x="6126" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 14 L31</text>
<text text-anchor="middle" x="6126" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6126" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6126" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert14 -->
<g id="node1514" class="node">
<title>layer31_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="6016" cy="-23013.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6016" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="6016" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6016" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer31_moe_expert14&#45;&gt;layer31_moe_comm_from_expert14 -->
<g id="edge1943" class="edge">
<title>layer31_moe_expert14&#45;&gt;layer31_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M6033.88,-23078.2C6033.88,-23078.2 6033.88,-23052.02 6033.88,-23052.02"/>
<polygon fill="black" stroke="black" points="6037.38,-23052.02 6033.88,-23042.02 6030.38,-23052.02 6037.38,-23052.02"/>
</g>
<!-- layer31_moe_comm_to_expert14&#45;&gt;layer31_moe_expert14 -->
<g id="edge1912" class="edge">
<title>layer31_moe_comm_to_expert14&#45;&gt;layer31_moe_expert14</title>
<path fill="none" stroke="black" d="M6032.52,-23166.72C6032.52,-23166.72 6032.52,-23140.66 6032.52,-23140.66"/>
<polygon fill="black" stroke="black" points="6036.02,-23140.66 6032.52,-23130.66 6029.02,-23140.66 6036.02,-23140.66"/>
</g>
<!-- layer31_moe_expert15 -->
<g id="node1497" class="node">
<title>layer31_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6651,-23130.52 6313,-23130.52 6313,-23078.52 6651,-23078.52 6651,-23130.52"/>
<text text-anchor="middle" x="6482" y="-23118.52" font-family="Arial" font-size="10.00">EXPERT 15 L31</text>
<text text-anchor="middle" x="6482" y="-23107.52" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6482" y="-23096.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6482" y="-23085.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_comm_from_expert15 -->
<g id="node1515" class="node">
<title>layer31_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6371" cy="-23013.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6371" y="-23022.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6371" y="-23011.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6371" y="-23000.03" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer31_moe_expert15&#45;&gt;layer31_moe_comm_from_expert15 -->
<g id="edge1945" class="edge">
<title>layer31_moe_expert15&#45;&gt;layer31_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6389.38,-23078.2C6389.38,-23078.2 6389.38,-23052.02 6389.38,-23052.02"/>
<polygon fill="black" stroke="black" points="6392.88,-23052.02 6389.38,-23042.02 6385.88,-23052.02 6392.88,-23052.02"/>
</g>
<!-- layer31_moe_comm_to_expert15&#45;&gt;layer31_moe_expert15 -->
<g id="edge1914" class="edge">
<title>layer31_moe_comm_to_expert15&#45;&gt;layer31_moe_expert15</title>
<path fill="none" stroke="black" d="M6388.02,-23166.72C6388.02,-23166.72 6388.02,-23140.66 6388.02,-23140.66"/>
<polygon fill="black" stroke="black" points="6391.52,-23140.66 6388.02,-23130.66 6384.52,-23140.66 6391.52,-23140.66"/>
</g>
<!-- layer31_moe_aggregate -->
<g id="node1499" class="node">
<title>layer31_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4057.1,-22948.54 3640.16,-22948.54 3532.9,-22844.54 3949.84,-22844.54 4057.1,-22948.54"/>
<text text-anchor="middle" x="3795" y="-22910.54" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L31</text>
<text text-anchor="middle" x="3795" y="-22899.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3795" y="-22888.54" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3795" y="-22877.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_mha -->
<g id="node1516" class="node">
<title>layer32_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3925,-22808.54 3665,-22808.54 3665,-22756.54 3925,-22756.54 3925,-22808.54"/>
<text text-anchor="middle" x="3795" y="-22796.54" font-family="Arial" font-size="10.00">MHA L32</text>
<text text-anchor="middle" x="3795" y="-22785.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3795" y="-22774.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3795" y="-22763.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer31_moe_aggregate&#45;&gt;layer32_moe_mha -->
<g id="edge2014" class="edge">
<title>layer31_moe_aggregate&#45;&gt;layer32_moe_mha</title>
<path fill="none" stroke="black" d="M3795,-22844.21C3795,-22844.21 3795,-22818.77 3795,-22818.77"/>
<polygon fill="black" stroke="black" points="3798.5,-22818.77 3795,-22808.77 3791.5,-22818.77 3798.5,-22818.77"/>
</g>
<!-- layer31_moe_comm_from_expert0&#45;&gt;layer31_moe_aggregate -->
<g id="edge1916" class="edge">
<title>layer31_moe_comm_from_expert0&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M1372,-22988.7C1372,-22945.02 1372,-22859 1372,-22859 1372,-22859 3537.65,-22859 3537.65,-22859"/>
<polygon fill="black" stroke="black" points="3537.65,-22862.5 3547.65,-22859 3537.65,-22855.5 3537.65,-22862.5"/>
</g>
<!-- layer31_moe_comm_from_expert1&#45;&gt;layer31_moe_aggregate -->
<g id="edge1918" class="edge">
<title>layer31_moe_comm_from_expert1&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M2024.5,-22991.73C2024.5,-22952.49 2024.5,-22874 2024.5,-22874 2024.5,-22874 3553.08,-22874 3553.08,-22874"/>
<polygon fill="black" stroke="black" points="3553.08,-22877.5 3563.08,-22874 3553.08,-22870.5 3553.08,-22877.5"/>
</g>
<!-- layer31_moe_comm_from_expert2&#45;&gt;layer31_moe_aggregate -->
<g id="edge1920" class="edge">
<title>layer31_moe_comm_from_expert2&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M2451.51,-22994.35C2451.51,-22959.41 2451.51,-22889 2451.51,-22889 2451.51,-22889 3568.4,-22889 3568.4,-22889"/>
<polygon fill="black" stroke="black" points="3568.4,-22892.5 3578.4,-22889 3568.4,-22885.5 3568.4,-22892.5"/>
</g>
<!-- layer31_moe_comm_from_expert3&#45;&gt;layer31_moe_aggregate -->
<g id="edge1922" class="edge">
<title>layer31_moe_comm_from_expert3&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M2775.01,-23001.7C2775.01,-22973.19 2775.01,-22903 2775.01,-22903 2775.01,-22903 3583.18,-22903 3583.18,-22903"/>
<polygon fill="black" stroke="black" points="3583.18,-22906.5 3593.18,-22903 3583.18,-22899.5 3583.18,-22906.5"/>
</g>
<!-- layer31_moe_comm_from_expert4&#45;&gt;layer31_moe_aggregate -->
<g id="edge1924" class="edge">
<title>layer31_moe_comm_from_expert4&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M3021,-22996.89C3021,-22969.52 3021,-22918 3021,-22918 3021,-22918 3598.62,-22918 3598.62,-22918"/>
<polygon fill="black" stroke="black" points="3598.62,-22921.5 3608.62,-22918 3598.62,-22914.5 3598.62,-22921.5"/>
</g>
<!-- layer31_moe_comm_from_expert5&#45;&gt;layer31_moe_aggregate -->
<g id="edge1926" class="edge">
<title>layer31_moe_comm_from_expert5&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M3225.01,-22989.37C3225.01,-22965.65 3225.01,-22933 3225.01,-22933 3225.01,-22933 3613.98,-22933 3613.98,-22933"/>
<polygon fill="black" stroke="black" points="3613.98,-22936.5 3623.98,-22933 3613.98,-22929.5 3613.98,-22936.5"/>
</g>
<!-- layer31_moe_comm_from_expert6&#45;&gt;layer31_moe_aggregate -->
<g id="edge1928" class="edge">
<title>layer31_moe_comm_from_expert6&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M3476.74,-23013C3522.78,-23013 3569.1,-23013 3569.1,-23013 3569.1,-23013 3569.1,-22906.62 3569.1,-22906.62"/>
<polygon fill="black" stroke="black" points="3572.6,-22906.62 3569.1,-22896.62 3565.6,-22906.62 3572.6,-22906.62"/>
</g>
<!-- layer31_moe_comm_from_expert7&#45;&gt;layer31_moe_aggregate -->
<g id="edge1930" class="edge">
<title>layer31_moe_comm_from_expert7&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M3696,-22984.31C3696,-22984.31 3696,-22958.6 3696,-22958.6"/>
<polygon fill="black" stroke="black" points="3699.5,-22958.6 3696,-22948.6 3692.5,-22958.6 3699.5,-22958.6"/>
</g>
<!-- layer31_moe_comm_from_expert8&#45;&gt;layer31_moe_aggregate -->
<g id="edge1932" class="edge">
<title>layer31_moe_comm_from_expert8&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M3967.39,-22984.31C3967.39,-22984.31 3967.39,-22958.6 3967.39,-22958.6"/>
<polygon fill="black" stroke="black" points="3970.89,-22958.6 3967.39,-22948.6 3963.89,-22958.6 3970.89,-22958.6"/>
</g>
<!-- layer31_moe_comm_from_expert9&#45;&gt;layer31_moe_aggregate -->
<g id="edge1934" class="edge">
<title>layer31_moe_comm_from_expert9&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M4258.5,-22984.73C4258.5,-22962.32 4258.5,-22935 4258.5,-22935 4258.5,-22935 4053.37,-22935 4053.37,-22935"/>
<polygon fill="black" stroke="black" points="4053.37,-22931.5 4043.37,-22935 4053.37,-22938.5 4053.37,-22931.5"/>
</g>
<!-- layer31_moe_comm_from_expert10&#45;&gt;layer31_moe_aggregate -->
<g id="edge1936" class="edge">
<title>layer31_moe_comm_from_expert10&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M4590.15,-22985.07C4590.15,-22958.2 4590.15,-22922 4590.15,-22922 4590.15,-22922 4039.81,-22922 4039.81,-22922"/>
<polygon fill="black" stroke="black" points="4039.81,-22918.5 4029.81,-22922 4039.81,-22925.5 4039.81,-22918.5"/>
</g>
<!-- layer31_moe_comm_from_expert11&#45;&gt;layer31_moe_aggregate -->
<g id="edge1938" class="edge">
<title>layer31_moe_comm_from_expert11&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M4936.65,-22984.97C4936.65,-22954.02 4936.65,-22909 4936.65,-22909 4936.65,-22909 4026.47,-22909 4026.47,-22909"/>
<polygon fill="black" stroke="black" points="4026.47,-22905.5 4016.47,-22909 4026.47,-22912.5 4026.47,-22905.5"/>
</g>
<!-- layer31_moe_comm_from_expert12&#45;&gt;layer31_moe_aggregate -->
<g id="edge1940" class="edge">
<title>layer31_moe_comm_from_expert12&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M5287.65,-22985.08C5287.65,-22950.3 5287.65,-22896 5287.65,-22896 5287.65,-22896 4012.94,-22896 4012.94,-22896"/>
<polygon fill="black" stroke="black" points="4012.94,-22892.5 4002.94,-22896 4012.94,-22899.5 4012.94,-22892.5"/>
</g>
<!-- layer31_moe_comm_from_expert13&#45;&gt;layer31_moe_aggregate -->
<g id="edge1942" class="edge">
<title>layer31_moe_comm_from_expert13&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M5641.15,-22984.88C5641.15,-22946.46 5641.15,-22883 5641.15,-22883 5641.15,-22883 3999.52,-22883 3999.52,-22883"/>
<polygon fill="black" stroke="black" points="3999.52,-22879.5 3989.52,-22883 3999.52,-22886.5 3999.52,-22879.5"/>
</g>
<!-- layer31_moe_comm_from_expert14&#45;&gt;layer31_moe_aggregate -->
<g id="edge1944" class="edge">
<title>layer31_moe_comm_from_expert14&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M5996.15,-22985.17C5996.15,-22943.34 5996.15,-22870 5996.15,-22870 5996.15,-22870 3986.53,-22870 3986.53,-22870"/>
<polygon fill="black" stroke="black" points="3986.53,-22866.5 3976.53,-22870 3986.53,-22873.5 3986.53,-22866.5"/>
</g>
<!-- layer31_moe_comm_from_expert15&#45;&gt;layer31_moe_aggregate -->
<g id="edge1946" class="edge">
<title>layer31_moe_comm_from_expert15&#45;&gt;layer31_moe_aggregate</title>
<path fill="none" stroke="black" d="M6351.15,-22984.82C6351.15,-22939.63 6351.15,-22857 6351.15,-22857 6351.15,-22857 3972.72,-22857 3972.72,-22857"/>
<polygon fill="black" stroke="black" points="3972.72,-22853.5 3962.72,-22857 3972.72,-22860.5 3972.72,-22853.5"/>
</g>
<!-- layer32_moe_gate -->
<g id="node1517" class="node">
<title>layer32_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4053.3,-22720.54 3642.4,-22720.54 3536.7,-22616.54 3947.6,-22616.54 4053.3,-22720.54"/>
<text text-anchor="middle" x="3795" y="-22682.54" font-family="Arial" font-size="10.00">GATE L32</text>
<text text-anchor="middle" x="3795" y="-22671.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3795" y="-22660.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3795" y="-22649.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer32_moe_mha&#45;&gt;layer32_moe_gate -->
<g id="edge2015" class="edge">
<title>layer32_moe_mha&#45;&gt;layer32_moe_gate</title>
<path fill="none" stroke="black" d="M3795,-22756.39C3795,-22756.39 3795,-22730.64 3795,-22730.64"/>
<polygon fill="black" stroke="black" points="3798.5,-22730.64 3795,-22720.64 3791.5,-22730.64 3798.5,-22730.64"/>
</g>
<!-- layer32_moe_split -->
<g id="node1518" class="node">
<title>layer32_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4049.01,-22580.54 3644.94,-22580.54 3540.99,-22476.54 3945.06,-22476.54 4049.01,-22580.54"/>
<text text-anchor="middle" x="3795" y="-22542.54" font-family="Arial" font-size="10.00">SPLIT TOKENS L32</text>
<text text-anchor="middle" x="3795" y="-22531.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3795" y="-22520.54" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3795" y="-22509.54" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer32_moe_gate&#45;&gt;layer32_moe_split -->
<g id="edge2016" class="edge">
<title>layer32_moe_gate&#45;&gt;layer32_moe_split</title>
<path fill="none" stroke="black" d="M3795,-22616.41C3795,-22616.41 3795,-22590.71 3795,-22590.71"/>
<polygon fill="black" stroke="black" points="3798.5,-22590.71 3795,-22580.71 3791.5,-22590.71 3798.5,-22590.71"/>
</g>
<!-- layer32_moe_comm_to_expert0 -->
<g id="node1520" class="node">
<title>layer32_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1420" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1420" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1420" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1420" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert0 -->
<g id="edge1950" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3629.28,-22565C3096.92,-22565 1464.75,-22565 1464.75,-22565 1464.75,-22565 1464.75,-22446.89 1464.75,-22446.89"/>
<polygon fill="black" stroke="black" points="1468.25,-22446.89 1464.75,-22436.89 1461.25,-22446.89 1468.25,-22446.89"/>
</g>
<!-- layer32_moe_comm_to_expert1 -->
<g id="node1522" class="node">
<title>layer32_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1776" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1776" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1776" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1776" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert1 -->
<g id="edge1952" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3614.11,-22550C3125.51,-22550 1815.75,-22550 1815.75,-22550 1815.75,-22550 1815.75,-22447.92 1815.75,-22447.92"/>
<polygon fill="black" stroke="black" points="1819.25,-22447.92 1815.75,-22437.92 1812.25,-22447.92 1819.25,-22447.92"/>
</g>
<!-- layer32_moe_comm_to_expert2 -->
<g id="node1524" class="node">
<title>layer32_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2085" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2085" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2085" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2085" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert2 -->
<g id="edge1954" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3599.04,-22535C3161.51,-22535 2143.25,-22535 2143.25,-22535 2143.25,-22535 2143.25,-22443.9 2143.25,-22443.9"/>
<polygon fill="black" stroke="black" points="2146.75,-22443.9 2143.25,-22433.9 2139.75,-22443.9 2146.75,-22443.9"/>
</g>
<!-- layer32_moe_comm_to_expert3 -->
<g id="node1526" class="node">
<title>layer32_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2339" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2339" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2339" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2339" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert3 -->
<g id="edge1956" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3585.33,-22521C3187.17,-22521 2361,-22521 2361,-22521 2361,-22521 2361,-22449.73 2361,-22449.73"/>
<polygon fill="black" stroke="black" points="2364.5,-22449.73 2361,-22439.73 2357.5,-22449.73 2364.5,-22449.73"/>
</g>
<!-- layer32_moe_comm_to_expert4 -->
<g id="node1528" class="node">
<title>layer32_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2677" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2677" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2677" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2677" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert4 -->
<g id="edge1958" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3570.27,-22506C3245.78,-22506 2684.5,-22506 2684.5,-22506 2684.5,-22506 2684.5,-22450.66 2684.5,-22450.66"/>
<polygon fill="black" stroke="black" points="2688,-22450.66 2684.5,-22440.66 2681,-22450.66 2688,-22450.66"/>
</g>
<!-- layer32_moe_comm_to_expert5 -->
<g id="node1530" class="node">
<title>layer32_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3096" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3096" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3096" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3096" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert5 -->
<g id="edge1960" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3555.14,-22491C3366.2,-22491 3134.5,-22491 3134.5,-22491 3134.5,-22491 3134.5,-22448 3134.5,-22448"/>
<polygon fill="black" stroke="black" points="3138,-22448 3134.5,-22438 3131,-22448 3138,-22448"/>
</g>
<!-- layer32_moe_comm_to_expert6 -->
<g id="node1532" class="node">
<title>layer32_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3405" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3405" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3405" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3405" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert6 -->
<g id="edge1962" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3554.74,-22528.45C3554.74,-22524.89 3554.74,-22411 3554.74,-22411 3554.74,-22411 3505.56,-22411 3505.56,-22411"/>
<polygon fill="black" stroke="black" points="3505.56,-22407.5 3495.56,-22411 3505.56,-22414.5 3505.56,-22407.5"/>
</g>
<!-- layer32_moe_comm_to_expert7 -->
<g id="node1534" class="node">
<title>layer32_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3659" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3659" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3659" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3659" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert7 -->
<g id="edge1964" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3659,-22476.2C3659,-22476.2 3659,-22450.76 3659,-22450.76"/>
<polygon fill="black" stroke="black" points="3662.5,-22450.76 3659,-22440.76 3655.5,-22450.76 3662.5,-22450.76"/>
</g>
<!-- layer32_moe_comm_to_expert8 -->
<g id="node1536" class="node">
<title>layer32_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3931" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3931" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3931" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3931" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert8 -->
<g id="edge1966" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3931,-22476.2C3931,-22476.2 3931,-22450.76 3931,-22450.76"/>
<polygon fill="black" stroke="black" points="3934.5,-22450.76 3931,-22440.76 3927.5,-22450.76 3934.5,-22450.76"/>
</g>
<!-- layer32_moe_comm_to_expert9 -->
<g id="node1538" class="node">
<title>layer32_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4240" cy="-22411.55" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4240" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4240" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4240" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert9 -->
<g id="edge1968" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4035.26,-22528.45C4035.26,-22524.89 4035.26,-22411 4035.26,-22411 4035.26,-22411 4139.3,-22411 4139.3,-22411"/>
<polygon fill="black" stroke="black" points="4139.3,-22414.5 4149.3,-22411 4139.3,-22407.5 4139.3,-22414.5"/>
</g>
<!-- layer32_moe_comm_to_expert10 -->
<g id="node1540" class="node">
<title>layer32_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4572" cy="-22411.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4572" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4572" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4572" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert10 -->
<g id="edge1970" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3959.82,-22491C4167.07,-22491 4496.1,-22491 4496.1,-22491 4496.1,-22491 4496.1,-22438.79 4496.1,-22438.79"/>
<polygon fill="black" stroke="black" points="4499.6,-22438.79 4496.1,-22428.79 4492.6,-22438.79 4499.6,-22438.79"/>
</g>
<!-- layer32_moe_comm_to_expert11 -->
<g id="node1542" class="node">
<title>layer32_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4918" cy="-22411.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4918" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4918" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4918" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert11 -->
<g id="edge1972" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3974.79,-22506C4274.24,-22506 4842.6,-22506 4842.6,-22506 4842.6,-22506 4842.6,-22439.31 4842.6,-22439.31"/>
<polygon fill="black" stroke="black" points="4846.1,-22439.31 4842.6,-22429.31 4839.1,-22439.31 4846.1,-22439.31"/>
</g>
<!-- layer32_moe_comm_to_expert12 -->
<g id="node1544" class="node">
<title>layer32_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5269" cy="-22411.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5269" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5269" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5269" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert12 -->
<g id="edge1974" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3989.84,-22521C4374.29,-22521 5193.6,-22521 5193.6,-22521 5193.6,-22521 5193.6,-22439.13 5193.6,-22439.13"/>
<polygon fill="black" stroke="black" points="5197.1,-22439.13 5193.6,-22429.13 5190.1,-22439.13 5197.1,-22439.13"/>
</g>
<!-- layer32_moe_comm_to_expert13 -->
<g id="node1546" class="node">
<title>layer32_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5622" cy="-22411.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5622" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5622" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5622" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert13 -->
<g id="edge1976" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4003.74,-22535C4468.33,-22535 5547.1,-22535 5547.1,-22535 5547.1,-22535 5547.1,-22439.24 5547.1,-22439.24"/>
<polygon fill="black" stroke="black" points="5550.6,-22439.24 5547.1,-22429.24 5543.6,-22439.24 5550.6,-22439.24"/>
</g>
<!-- layer32_moe_comm_to_expert14 -->
<g id="node1548" class="node">
<title>layer32_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5977" cy="-22411.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5977" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5977" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5977" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert14 -->
<g id="edge1978" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4018.5,-22550C4560.79,-22550 5902.1,-22550 5902.1,-22550 5902.1,-22550 5902.1,-22439.08 5902.1,-22439.08"/>
<polygon fill="black" stroke="black" points="5905.6,-22439.08 5902.1,-22429.08 5898.6,-22439.08 5905.6,-22439.08"/>
</g>
<!-- layer32_moe_comm_to_expert15 -->
<g id="node1550" class="node">
<title>layer32_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6332" cy="-22411.55" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6332" y="-22420.05" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6332" y="-22409.05" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6332" y="-22398.05" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert15 -->
<g id="edge1980" class="edge">
<title>layer32_moe_split&#45;&gt;layer32_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4033.59,-22565C4651.69,-22565 6257.1,-22565 6257.1,-22565 6257.1,-22565 6257.1,-22439.15 6257.1,-22439.15"/>
<polygon fill="black" stroke="black" points="6260.6,-22439.15 6257.1,-22429.15 6253.6,-22439.15 6260.6,-22439.15"/>
</g>
<!-- layer32_moe_expert0 -->
<g id="node1519" class="node">
<title>layer32_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1364,-22346.56 1036,-22346.56 1036,-22294.56 1364,-22294.56 1364,-22346.56"/>
<text text-anchor="middle" x="1200" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 0 L32</text>
<text text-anchor="middle" x="1200" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1200" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1200" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert0 -->
<g id="node1552" class="node">
<title>layer32_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1246" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1246" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1246" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1246" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer32_moe_expert0&#45;&gt;layer32_moe_comm_from_expert0 -->
<g id="edge1982" class="edge">
<title>layer32_moe_expert0&#45;&gt;layer32_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1246,-22294.24C1246,-22294.24 1246,-22268.7 1246,-22268.7"/>
<polygon fill="black" stroke="black" points="1249.5,-22268.7 1246,-22258.7 1242.5,-22268.7 1249.5,-22268.7"/>
</g>
<!-- layer32_moe_comm_to_expert0&#45;&gt;layer32_moe_expert0 -->
<g id="edge1951" class="edge">
<title>layer32_moe_comm_to_expert0&#45;&gt;layer32_moe_expert0</title>
<path fill="none" stroke="black" d="M1346.75,-22394.43C1346.75,-22394.43 1346.75,-22356.9 1346.75,-22356.9"/>
<polygon fill="black" stroke="black" points="1350.25,-22356.9 1346.75,-22346.9 1343.25,-22356.9 1350.25,-22356.9"/>
</g>
<!-- layer32_moe_expert1 -->
<g id="node1521" class="node">
<title>layer32_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1710,-22346.56 1382,-22346.56 1382,-22294.56 1710,-22294.56 1710,-22346.56"/>
<text text-anchor="middle" x="1546" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 1 L32</text>
<text text-anchor="middle" x="1546" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1546" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1546" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert1 -->
<g id="node1553" class="node">
<title>layer32_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1959" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1959" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1959" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1959" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer32_moe_expert1&#45;&gt;layer32_moe_comm_from_expert1 -->
<g id="edge1984" class="edge">
<title>layer32_moe_expert1&#45;&gt;layer32_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1648.25,-22294.07C1648.25,-22267.03 1648.25,-22229 1648.25,-22229 1648.25,-22229 1858.28,-22229 1858.28,-22229"/>
<polygon fill="black" stroke="black" points="1858.28,-22232.5 1868.28,-22229 1858.28,-22225.5 1858.28,-22232.5"/>
</g>
<!-- layer32_moe_comm_to_expert1&#45;&gt;layer32_moe_expert1 -->
<g id="edge1953" class="edge">
<title>layer32_moe_comm_to_expert1&#45;&gt;layer32_moe_expert1</title>
<path fill="none" stroke="black" d="M1697.75,-22396.93C1697.75,-22396.93 1697.75,-22356.89 1697.75,-22356.89"/>
<polygon fill="black" stroke="black" points="1701.25,-22356.89 1697.75,-22346.89 1694.25,-22356.89 1701.25,-22356.89"/>
</g>
<!-- layer32_moe_expert2 -->
<g id="node1523" class="node">
<title>layer32_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2056,-22346.56 1728,-22346.56 1728,-22294.56 2056,-22294.56 2056,-22346.56"/>
<text text-anchor="middle" x="1892" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 2 L32</text>
<text text-anchor="middle" x="1892" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1892" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1892" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert2 -->
<g id="node1554" class="node">
<title>layer32_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2415" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2415" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2415" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2415" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer32_moe_expert2&#45;&gt;layer32_moe_comm_from_expert2 -->
<g id="edge1986" class="edge">
<title>layer32_moe_expert2&#45;&gt;layer32_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2056.18,-22320C2061.77,-22320 2065,-22320 2065,-22320 2065,-22320 2065,-22229 2065,-22229 2065,-22229 2314.41,-22229 2314.41,-22229"/>
<polygon fill="black" stroke="black" points="2314.41,-22232.5 2324.41,-22229 2314.41,-22225.5 2314.41,-22232.5"/>
</g>
<!-- layer32_moe_comm_to_expert2&#45;&gt;layer32_moe_expert2 -->
<g id="edge1955" class="edge">
<title>layer32_moe_comm_to_expert2&#45;&gt;layer32_moe_expert2</title>
<path fill="none" stroke="black" d="M2025.25,-22389.52C2025.25,-22389.52 2025.25,-22356.58 2025.25,-22356.58"/>
<polygon fill="black" stroke="black" points="2028.75,-22356.58 2025.25,-22346.58 2021.75,-22356.58 2028.75,-22356.58"/>
</g>
<!-- layer32_moe_expert3 -->
<g id="node1525" class="node">
<title>layer32_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2402,-22346.56 2074,-22346.56 2074,-22294.56 2402,-22294.56 2402,-22346.56"/>
<text text-anchor="middle" x="2238" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 3 L32</text>
<text text-anchor="middle" x="2238" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2238" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2238" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert3 -->
<g id="node1555" class="node">
<title>layer32_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2743" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2743" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2743" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2743" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer32_moe_expert3&#45;&gt;layer32_moe_comm_from_expert3 -->
<g id="edge1988" class="edge">
<title>layer32_moe_expert3&#45;&gt;layer32_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2363.25,-22294.39C2363.25,-22282.05 2363.25,-22270 2363.25,-22270 2363.25,-22270 2684.33,-22270 2684.33,-22270 2684.33,-22270 2684.33,-22261.68 2684.33,-22261.68"/>
<polygon fill="black" stroke="black" points="2687.83,-22261.68 2684.33,-22251.68 2680.83,-22261.68 2687.83,-22261.68"/>
</g>
<!-- layer32_moe_comm_to_expert3&#45;&gt;layer32_moe_expert3 -->
<g id="edge1957" class="edge">
<title>layer32_moe_comm_to_expert3&#45;&gt;layer32_moe_expert3</title>
<path fill="none" stroke="black" d="M2325.25,-22382.76C2325.25,-22382.76 2325.25,-22356.69 2325.25,-22356.69"/>
<polygon fill="black" stroke="black" points="2328.75,-22356.69 2325.25,-22346.69 2321.75,-22356.69 2328.75,-22356.69"/>
</g>
<!-- layer32_moe_expert4 -->
<g id="node1527" class="node">
<title>layer32_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2748,-22346.56 2420,-22346.56 2420,-22294.56 2748,-22294.56 2748,-22346.56"/>
<text text-anchor="middle" x="2584" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 4 L32</text>
<text text-anchor="middle" x="2584" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2584" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2584" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert4 -->
<g id="node1556" class="node">
<title>layer32_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="3006" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3006" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="3006" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3006" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer32_moe_expert4&#45;&gt;layer32_moe_comm_from_expert4 -->
<g id="edge1990" class="edge">
<title>layer32_moe_expert4&#45;&gt;layer32_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2716.16,-22294.2C2716.16,-22287.42 2716.16,-22282 2716.16,-22282 2716.16,-22282 3004.75,-22282 3004.75,-22282 3004.75,-22282 3004.75,-22268.85 3004.75,-22268.85"/>
<polygon fill="black" stroke="black" points="3008.25,-22268.85 3004.75,-22258.85 3001.25,-22268.85 3008.25,-22268.85"/>
</g>
<!-- layer32_moe_comm_to_expert4&#45;&gt;layer32_moe_expert4 -->
<g id="edge1959" class="edge">
<title>layer32_moe_comm_to_expert4&#45;&gt;layer32_moe_expert4</title>
<path fill="none" stroke="black" d="M2667.25,-22382.51C2667.25,-22382.51 2667.25,-22356.86 2667.25,-22356.86"/>
<polygon fill="black" stroke="black" points="2670.75,-22356.86 2667.25,-22346.86 2663.75,-22356.86 2670.75,-22356.86"/>
</g>
<!-- layer32_moe_expert5 -->
<g id="node1529" class="node">
<title>layer32_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3094,-22346.56 2766,-22346.56 2766,-22294.56 3094,-22294.56 3094,-22346.56"/>
<text text-anchor="middle" x="2930" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 5 L32</text>
<text text-anchor="middle" x="2930" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2930" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2930" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert5 -->
<g id="node1557" class="node">
<title>layer32_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3237" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3237" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3237" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3237" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer32_moe_expert5&#45;&gt;layer32_moe_comm_from_expert5 -->
<g id="edge1992" class="edge">
<title>layer32_moe_expert5&#45;&gt;layer32_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3094.18,-22320C3099.77,-22320 3103,-22320 3103,-22320 3103,-22320 3103,-22229 3103,-22229 3103,-22229 3136.51,-22229 3136.51,-22229"/>
<polygon fill="black" stroke="black" points="3136.51,-22232.5 3146.51,-22229 3136.51,-22225.5 3136.51,-22232.5"/>
</g>
<!-- layer32_moe_comm_to_expert5&#45;&gt;layer32_moe_expert5 -->
<g id="edge1961" class="edge">
<title>layer32_moe_comm_to_expert5&#45;&gt;layer32_moe_expert5</title>
<path fill="none" stroke="black" d="M3049.75,-22386.2C3049.75,-22386.2 3049.75,-22356.72 3049.75,-22356.72"/>
<polygon fill="black" stroke="black" points="3053.25,-22356.72 3049.75,-22346.72 3046.25,-22356.72 3053.25,-22356.72"/>
</g>
<!-- layer32_moe_expert6 -->
<g id="node1531" class="node">
<title>layer32_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3440,-22346.56 3112,-22346.56 3112,-22294.56 3440,-22294.56 3440,-22346.56"/>
<text text-anchor="middle" x="3276" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 6 L32</text>
<text text-anchor="middle" x="3276" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3276" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3276" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert6 -->
<g id="node1558" class="node">
<title>layer32_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3452" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3452" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3452" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3452" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer32_moe_expert6&#45;&gt;layer32_moe_comm_from_expert6 -->
<g id="edge1994" class="edge">
<title>layer32_moe_expert6&#45;&gt;layer32_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3400.75,-22294.24C3400.75,-22294.24 3400.75,-22263.65 3400.75,-22263.65"/>
<polygon fill="black" stroke="black" points="3404.25,-22263.65 3400.75,-22253.65 3397.25,-22263.65 3404.25,-22263.65"/>
</g>
<!-- layer32_moe_comm_to_expert6&#45;&gt;layer32_moe_expert6 -->
<g id="edge1963" class="edge">
<title>layer32_moe_comm_to_expert6&#45;&gt;layer32_moe_expert6</title>
<path fill="none" stroke="black" d="M3377.25,-22383.75C3377.25,-22383.75 3377.25,-22356.63 3377.25,-22356.63"/>
<polygon fill="black" stroke="black" points="3380.75,-22356.63 3377.25,-22346.63 3373.75,-22356.63 3380.75,-22356.63"/>
</g>
<!-- layer32_moe_expert7 -->
<g id="node1533" class="node">
<title>layer32_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3786,-22346.56 3458,-22346.56 3458,-22294.56 3786,-22294.56 3786,-22346.56"/>
<text text-anchor="middle" x="3622" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 7 L32</text>
<text text-anchor="middle" x="3622" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3622" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3622" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert7 -->
<g id="node1559" class="node">
<title>layer32_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3659" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3659" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3659" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3659" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer32_moe_expert7&#45;&gt;layer32_moe_comm_from_expert7 -->
<g id="edge1996" class="edge">
<title>layer32_moe_expert7&#45;&gt;layer32_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3659,-22294.24C3659,-22294.24 3659,-22268.7 3659,-22268.7"/>
<polygon fill="black" stroke="black" points="3662.5,-22268.7 3659,-22258.7 3655.5,-22268.7 3662.5,-22268.7"/>
</g>
<!-- layer32_moe_comm_to_expert7&#45;&gt;layer32_moe_expert7 -->
<g id="edge1965" class="edge">
<title>layer32_moe_comm_to_expert7&#45;&gt;layer32_moe_expert7</title>
<path fill="none" stroke="black" d="M3659,-22382.51C3659,-22382.51 3659,-22356.86 3659,-22356.86"/>
<polygon fill="black" stroke="black" points="3662.5,-22356.86 3659,-22346.86 3655.5,-22356.86 3662.5,-22356.86"/>
</g>
<!-- layer32_moe_expert8 -->
<g id="node1535" class="node">
<title>layer32_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4132,-22346.56 3804,-22346.56 3804,-22294.56 4132,-22294.56 4132,-22346.56"/>
<text text-anchor="middle" x="3968" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 8 L32</text>
<text text-anchor="middle" x="3968" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3968" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3968" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert8 -->
<g id="node1560" class="node">
<title>layer32_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3931" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3931" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3931" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3931" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer32_moe_expert8&#45;&gt;layer32_moe_comm_from_expert8 -->
<g id="edge1998" class="edge">
<title>layer32_moe_expert8&#45;&gt;layer32_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3931,-22294.24C3931,-22294.24 3931,-22268.7 3931,-22268.7"/>
<polygon fill="black" stroke="black" points="3934.5,-22268.7 3931,-22258.7 3927.5,-22268.7 3934.5,-22268.7"/>
</g>
<!-- layer32_moe_comm_to_expert8&#45;&gt;layer32_moe_expert8 -->
<g id="edge1967" class="edge">
<title>layer32_moe_comm_to_expert8&#45;&gt;layer32_moe_expert8</title>
<path fill="none" stroke="black" d="M3931,-22382.51C3931,-22382.51 3931,-22356.86 3931,-22356.86"/>
<polygon fill="black" stroke="black" points="3934.5,-22356.86 3931,-22346.86 3927.5,-22356.86 3934.5,-22356.86"/>
</g>
<!-- layer32_moe_expert9 -->
<g id="node1537" class="node">
<title>layer32_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4478,-22346.56 4150,-22346.56 4150,-22294.56 4478,-22294.56 4478,-22346.56"/>
<text text-anchor="middle" x="4314" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 9 L32</text>
<text text-anchor="middle" x="4314" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4314" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4314" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert9 -->
<g id="node1561" class="node">
<title>layer32_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4240" cy="-22229.56" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4240" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4240" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4240" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer32_moe_expert9&#45;&gt;layer32_moe_comm_from_expert9 -->
<g id="edge2000" class="edge">
<title>layer32_moe_expert9&#45;&gt;layer32_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4240.25,-22294.24C4240.25,-22294.24 4240.25,-22268.7 4240.25,-22268.7"/>
<polygon fill="black" stroke="black" points="4243.75,-22268.7 4240.25,-22258.7 4236.75,-22268.7 4243.75,-22268.7"/>
</g>
<!-- layer32_moe_comm_to_expert9&#45;&gt;layer32_moe_expert9 -->
<g id="edge1969" class="edge">
<title>layer32_moe_comm_to_expert9&#45;&gt;layer32_moe_expert9</title>
<path fill="none" stroke="black" d="M4240.25,-22382.51C4240.25,-22382.51 4240.25,-22356.86 4240.25,-22356.86"/>
<polygon fill="black" stroke="black" points="4243.75,-22356.86 4240.25,-22346.86 4236.75,-22356.86 4243.75,-22356.86"/>
</g>
<!-- layer32_moe_expert10 -->
<g id="node1539" class="node">
<title>layer32_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4834,-22346.56 4496,-22346.56 4496,-22294.56 4834,-22294.56 4834,-22346.56"/>
<text text-anchor="middle" x="4665" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 10 L32</text>
<text text-anchor="middle" x="4665" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4665" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4665" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert10 -->
<g id="node1562" class="node">
<title>layer32_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4572" cy="-22229.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4572" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4572" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4572" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer32_moe_expert10&#45;&gt;layer32_moe_comm_from_expert10 -->
<g id="edge2002" class="edge">
<title>layer32_moe_expert10&#45;&gt;layer32_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4581.38,-22294.24C4581.38,-22294.24 4581.38,-22268.7 4581.38,-22268.7"/>
<polygon fill="black" stroke="black" points="4584.88,-22268.7 4581.38,-22258.7 4577.88,-22268.7 4584.88,-22268.7"/>
</g>
<!-- layer32_moe_comm_to_expert10&#45;&gt;layer32_moe_expert10 -->
<g id="edge1971" class="edge">
<title>layer32_moe_comm_to_expert10&#45;&gt;layer32_moe_expert10</title>
<path fill="none" stroke="black" d="M4581.02,-22382.51C4581.02,-22382.51 4581.02,-22356.86 4581.02,-22356.86"/>
<polygon fill="black" stroke="black" points="4584.52,-22356.86 4581.02,-22346.86 4577.52,-22356.86 4584.52,-22356.86"/>
</g>
<!-- layer32_moe_expert11 -->
<g id="node1541" class="node">
<title>layer32_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5190,-22346.56 4852,-22346.56 4852,-22294.56 5190,-22294.56 5190,-22346.56"/>
<text text-anchor="middle" x="5021" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 11 L32</text>
<text text-anchor="middle" x="5021" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5021" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="5021" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert11 -->
<g id="node1563" class="node">
<title>layer32_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4919" cy="-22229.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4919" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4919" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4919" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer32_moe_expert11&#45;&gt;layer32_moe_comm_from_expert11 -->
<g id="edge2004" class="edge">
<title>layer32_moe_expert11&#45;&gt;layer32_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4932.88,-22294.24C4932.88,-22294.24 4932.88,-22268.37 4932.88,-22268.37"/>
<polygon fill="black" stroke="black" points="4936.38,-22268.37 4932.88,-22258.37 4929.38,-22268.37 4936.38,-22268.37"/>
</g>
<!-- layer32_moe_comm_to_expert11&#45;&gt;layer32_moe_expert11 -->
<g id="edge1973" class="edge">
<title>layer32_moe_comm_to_expert11&#45;&gt;layer32_moe_expert11</title>
<path fill="none" stroke="black" d="M4932.02,-22382.76C4932.02,-22382.76 4932.02,-22356.69 4932.02,-22356.69"/>
<polygon fill="black" stroke="black" points="4935.52,-22356.69 4932.02,-22346.69 4928.52,-22356.69 4935.52,-22356.69"/>
</g>
<!-- layer32_moe_expert12 -->
<g id="node1543" class="node">
<title>layer32_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5546,-22346.56 5208,-22346.56 5208,-22294.56 5546,-22294.56 5546,-22346.56"/>
<text text-anchor="middle" x="5377" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 12 L32</text>
<text text-anchor="middle" x="5377" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5377" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5377" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert12 -->
<g id="node1564" class="node">
<title>layer32_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5270" cy="-22229.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5270" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5270" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5270" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer32_moe_expert12&#45;&gt;layer32_moe_comm_from_expert12 -->
<g id="edge2006" class="edge">
<title>layer32_moe_expert12&#45;&gt;layer32_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5286.38,-22294.24C5286.38,-22294.24 5286.38,-22268.37 5286.38,-22268.37"/>
<polygon fill="black" stroke="black" points="5289.88,-22268.37 5286.38,-22258.37 5282.88,-22268.37 5289.88,-22268.37"/>
</g>
<!-- layer32_moe_comm_to_expert12&#45;&gt;layer32_moe_expert12 -->
<g id="edge1975" class="edge">
<title>layer32_moe_comm_to_expert12&#45;&gt;layer32_moe_expert12</title>
<path fill="none" stroke="black" d="M5285.52,-22382.76C5285.52,-22382.76 5285.52,-22356.69 5285.52,-22356.69"/>
<polygon fill="black" stroke="black" points="5289.02,-22356.69 5285.52,-22346.69 5282.02,-22356.69 5289.02,-22356.69"/>
</g>
<!-- layer32_moe_expert13 -->
<g id="node1545" class="node">
<title>layer32_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5902,-22346.56 5564,-22346.56 5564,-22294.56 5902,-22294.56 5902,-22346.56"/>
<text text-anchor="middle" x="5733" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 13 L32</text>
<text text-anchor="middle" x="5733" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5733" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5733" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert13 -->
<g id="node1565" class="node">
<title>layer32_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5624" cy="-22229.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5624" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5624" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5624" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer32_moe_expert13&#45;&gt;layer32_moe_comm_from_expert13 -->
<g id="edge2008" class="edge">
<title>layer32_moe_expert13&#45;&gt;layer32_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5641.38,-22294.24C5641.38,-22294.24 5641.38,-22268.37 5641.38,-22268.37"/>
<polygon fill="black" stroke="black" points="5644.88,-22268.37 5641.38,-22258.37 5637.88,-22268.37 5644.88,-22268.37"/>
</g>
<!-- layer32_moe_comm_to_expert13&#45;&gt;layer32_moe_expert13 -->
<g id="edge1977" class="edge">
<title>layer32_moe_comm_to_expert13&#45;&gt;layer32_moe_expert13</title>
<path fill="none" stroke="black" d="M5640.02,-22382.76C5640.02,-22382.76 5640.02,-22356.69 5640.02,-22356.69"/>
<polygon fill="black" stroke="black" points="5643.52,-22356.69 5640.02,-22346.69 5636.52,-22356.69 5643.52,-22356.69"/>
</g>
<!-- layer32_moe_expert14 -->
<g id="node1547" class="node">
<title>layer32_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6258,-22346.56 5920,-22346.56 5920,-22294.56 6258,-22294.56 6258,-22346.56"/>
<text text-anchor="middle" x="6089" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 14 L32</text>
<text text-anchor="middle" x="6089" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6089" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6089" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert14 -->
<g id="node1566" class="node">
<title>layer32_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5979" cy="-22229.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5979" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5979" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5979" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer32_moe_expert14&#45;&gt;layer32_moe_comm_from_expert14 -->
<g id="edge2010" class="edge">
<title>layer32_moe_expert14&#45;&gt;layer32_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5996.88,-22294.24C5996.88,-22294.24 5996.88,-22268.05 5996.88,-22268.05"/>
<polygon fill="black" stroke="black" points="6000.38,-22268.05 5996.88,-22258.05 5993.38,-22268.05 6000.38,-22268.05"/>
</g>
<!-- layer32_moe_comm_to_expert14&#45;&gt;layer32_moe_expert14 -->
<g id="edge1979" class="edge">
<title>layer32_moe_comm_to_expert14&#45;&gt;layer32_moe_expert14</title>
<path fill="none" stroke="black" d="M5995.52,-22382.76C5995.52,-22382.76 5995.52,-22356.69 5995.52,-22356.69"/>
<polygon fill="black" stroke="black" points="5999.02,-22356.69 5995.52,-22346.69 5992.02,-22356.69 5999.02,-22356.69"/>
</g>
<!-- layer32_moe_expert15 -->
<g id="node1549" class="node">
<title>layer32_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6614,-22346.56 6276,-22346.56 6276,-22294.56 6614,-22294.56 6614,-22346.56"/>
<text text-anchor="middle" x="6445" y="-22334.56" font-family="Arial" font-size="10.00">EXPERT 15 L32</text>
<text text-anchor="middle" x="6445" y="-22323.56" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6445" y="-22312.56" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6445" y="-22301.56" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_comm_from_expert15 -->
<g id="node1567" class="node">
<title>layer32_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6334" cy="-22229.56" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6334" y="-22238.06" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6334" y="-22227.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6334" y="-22216.06" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer32_moe_expert15&#45;&gt;layer32_moe_comm_from_expert15 -->
<g id="edge2012" class="edge">
<title>layer32_moe_expert15&#45;&gt;layer32_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6352.38,-22294.24C6352.38,-22294.24 6352.38,-22268.05 6352.38,-22268.05"/>
<polygon fill="black" stroke="black" points="6355.88,-22268.05 6352.38,-22258.05 6348.88,-22268.05 6355.88,-22268.05"/>
</g>
<!-- layer32_moe_comm_to_expert15&#45;&gt;layer32_moe_expert15 -->
<g id="edge1981" class="edge">
<title>layer32_moe_comm_to_expert15&#45;&gt;layer32_moe_expert15</title>
<path fill="none" stroke="black" d="M6351.02,-22382.76C6351.02,-22382.76 6351.02,-22356.69 6351.02,-22356.69"/>
<polygon fill="black" stroke="black" points="6354.52,-22356.69 6351.02,-22346.69 6347.52,-22356.69 6354.52,-22356.69"/>
</g>
<!-- layer32_moe_aggregate -->
<g id="node1551" class="node">
<title>layer32_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="4020.1,-22164.57 3603.16,-22164.57 3495.9,-22060.57 3912.84,-22060.57 4020.1,-22164.57"/>
<text text-anchor="middle" x="3758" y="-22126.57" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L32</text>
<text text-anchor="middle" x="3758" y="-22115.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3758" y="-22104.57" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3758" y="-22093.57" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_mha -->
<g id="node1568" class="node">
<title>layer33_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3888,-22024.57 3628,-22024.57 3628,-21972.57 3888,-21972.57 3888,-22024.57"/>
<text text-anchor="middle" x="3758" y="-22012.57" font-family="Arial" font-size="10.00">MHA L33</text>
<text text-anchor="middle" x="3758" y="-22001.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3758" y="-21990.57" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3758" y="-21979.57" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer32_moe_aggregate&#45;&gt;layer33_moe_mha -->
<g id="edge2081" class="edge">
<title>layer32_moe_aggregate&#45;&gt;layer33_moe_mha</title>
<path fill="none" stroke="black" d="M3758,-22060.24C3758,-22060.24 3758,-22034.8 3758,-22034.8"/>
<polygon fill="black" stroke="black" points="3761.5,-22034.8 3758,-22024.8 3754.5,-22034.8 3761.5,-22034.8"/>
</g>
<!-- layer32_moe_comm_from_expert0&#45;&gt;layer32_moe_aggregate -->
<g id="edge1983" class="edge">
<title>layer32_moe_comm_from_expert0&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M1331.75,-22219.9C1331.75,-22186.06 1331.75,-22075 1331.75,-22075 1331.75,-22075 3500.6,-22075 3500.6,-22075"/>
<polygon fill="black" stroke="black" points="3500.6,-22078.5 3510.6,-22075 3500.6,-22071.5 3500.6,-22078.5"/>
</g>
<!-- layer32_moe_comm_from_expert1&#45;&gt;layer32_moe_aggregate -->
<g id="edge1985" class="edge">
<title>layer32_moe_comm_from_expert1&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M2043.25,-22218.61C2043.25,-22185.71 2043.25,-22090 2043.25,-22090 2043.25,-22090 3515.85,-22090 3515.85,-22090"/>
<polygon fill="black" stroke="black" points="3515.85,-22093.5 3525.85,-22090 3515.85,-22086.5 3515.85,-22093.5"/>
</g>
<!-- layer32_moe_comm_from_expert2&#45;&gt;layer32_moe_aggregate -->
<g id="edge1987" class="edge">
<title>layer32_moe_comm_from_expert2&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M2487.01,-22211.98C2487.01,-22177.65 2487.01,-22105 2487.01,-22105 2487.01,-22105 3531.67,-22105 3531.67,-22105"/>
<polygon fill="black" stroke="black" points="3531.67,-22108.5 3541.67,-22105 3531.67,-22101.5 3531.67,-22108.5"/>
</g>
<!-- layer32_moe_comm_from_expert3&#45;&gt;layer32_moe_aggregate -->
<g id="edge1989" class="edge">
<title>layer32_moe_comm_from_expert3&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M2815.01,-22211.96C2815.01,-22180.99 2815.01,-22120 2815.01,-22120 2815.01,-22120 3547.15,-22120 3547.15,-22120"/>
<polygon fill="black" stroke="black" points="3547.15,-22123.5 3557.15,-22120 3547.15,-22116.5 3547.15,-22123.5"/>
</g>
<!-- layer32_moe_comm_from_expert4&#45;&gt;layer32_moe_aggregate -->
<g id="edge1991" class="edge">
<title>layer32_moe_comm_from_expert4&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M3085.75,-22215.46C3085.75,-22188.88 3085.75,-22134 3085.75,-22134 3085.75,-22134 3561.19,-22134 3561.19,-22134"/>
<polygon fill="black" stroke="black" points="3561.19,-22137.5 3571.19,-22134 3561.19,-22130.5 3561.19,-22137.5"/>
</g>
<!-- layer32_moe_comm_from_expert5&#45;&gt;layer32_moe_aggregate -->
<g id="edge1993" class="edge">
<title>layer32_moe_comm_from_expert5&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M3307.5,-22211.28C3307.5,-22187.51 3307.5,-22149 3307.5,-22149 3307.5,-22149 3577.04,-22149 3577.04,-22149"/>
<polygon fill="black" stroke="black" points="3577.04,-22152.5 3587.04,-22149 3577.04,-22145.5 3577.04,-22152.5"/>
</g>
<!-- layer32_moe_comm_from_expert6&#45;&gt;layer32_moe_aggregate -->
<g id="edge1995" class="edge">
<title>layer32_moe_comm_from_expert6&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M3519.11,-22209.98C3519.11,-22209.98 3519.11,-22122.62 3519.11,-22122.62"/>
<polygon fill="black" stroke="black" points="3522.61,-22122.62 3519.11,-22112.62 3515.61,-22122.62 3522.61,-22122.62"/>
</g>
<!-- layer32_moe_comm_from_expert7&#45;&gt;layer32_moe_aggregate -->
<g id="edge1997" class="edge">
<title>layer32_moe_comm_from_expert7&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M3659,-22200.34C3659,-22200.34 3659,-22174.63 3659,-22174.63"/>
<polygon fill="black" stroke="black" points="3662.5,-22174.63 3659,-22164.63 3655.5,-22174.63 3662.5,-22174.63"/>
</g>
<!-- layer32_moe_comm_from_expert8&#45;&gt;layer32_moe_aggregate -->
<g id="edge1999" class="edge">
<title>layer32_moe_comm_from_expert8&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M3930.39,-22200.34C3930.39,-22200.34 3930.39,-22174.63 3930.39,-22174.63"/>
<polygon fill="black" stroke="black" points="3933.89,-22174.63 3930.39,-22164.63 3926.89,-22174.63 3933.89,-22174.63"/>
</g>
<!-- layer32_moe_comm_from_expert9&#45;&gt;layer32_moe_aggregate -->
<g id="edge2001" class="edge">
<title>layer32_moe_comm_from_expert9&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M4221.5,-22200.76C4221.5,-22178.33 4221.5,-22151 4221.5,-22151 4221.5,-22151 4016.37,-22151 4016.37,-22151"/>
<polygon fill="black" stroke="black" points="4016.37,-22147.5 4006.37,-22151 4016.37,-22154.5 4016.37,-22147.5"/>
</g>
<!-- layer32_moe_comm_from_expert10&#45;&gt;layer32_moe_aggregate -->
<g id="edge2003" class="edge">
<title>layer32_moe_comm_from_expert10&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M4553.15,-22201.1C4553.15,-22174.22 4553.15,-22138 4553.15,-22138 4553.15,-22138 4002.81,-22138 4002.81,-22138"/>
<polygon fill="black" stroke="black" points="4002.81,-22134.5 3992.81,-22138 4002.81,-22141.5 4002.81,-22134.5"/>
</g>
<!-- layer32_moe_comm_from_expert11&#45;&gt;layer32_moe_aggregate -->
<g id="edge2005" class="edge">
<title>layer32_moe_comm_from_expert11&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M4899.65,-22200.99C4899.65,-22170.03 4899.65,-22125 4899.65,-22125 4899.65,-22125 3989.47,-22125 3989.47,-22125"/>
<polygon fill="black" stroke="black" points="3989.47,-22121.5 3979.47,-22125 3989.47,-22128.5 3989.47,-22121.5"/>
</g>
<!-- layer32_moe_comm_from_expert12&#45;&gt;layer32_moe_aggregate -->
<g id="edge2007" class="edge">
<title>layer32_moe_comm_from_expert12&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M5250.65,-22201.11C5250.65,-22166.31 5250.65,-22112 5250.65,-22112 5250.65,-22112 3975.94,-22112 3975.94,-22112"/>
<polygon fill="black" stroke="black" points="3975.94,-22108.5 3965.94,-22112 3975.94,-22115.5 3975.94,-22108.5"/>
</g>
<!-- layer32_moe_comm_from_expert13&#45;&gt;layer32_moe_aggregate -->
<g id="edge2009" class="edge">
<title>layer32_moe_comm_from_expert13&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M5604.15,-22200.91C5604.15,-22162.48 5604.15,-22099 5604.15,-22099 5604.15,-22099 3962.52,-22099 3962.52,-22099"/>
<polygon fill="black" stroke="black" points="3962.52,-22095.5 3952.52,-22099 3962.52,-22102.5 3962.52,-22095.5"/>
</g>
<!-- layer32_moe_comm_from_expert14&#45;&gt;layer32_moe_aggregate -->
<g id="edge2011" class="edge">
<title>layer32_moe_comm_from_expert14&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M5959.15,-22201.2C5959.15,-22159.36 5959.15,-22086 5959.15,-22086 5959.15,-22086 3949.06,-22086 3949.06,-22086"/>
<polygon fill="black" stroke="black" points="3949.06,-22082.5 3939.06,-22086 3949.06,-22089.5 3949.06,-22082.5"/>
</g>
<!-- layer32_moe_comm_from_expert15&#45;&gt;layer32_moe_aggregate -->
<g id="edge2013" class="edge">
<title>layer32_moe_comm_from_expert15&#45;&gt;layer32_moe_aggregate</title>
<path fill="none" stroke="black" d="M6314.15,-22201.21C6314.15,-22156.09 6314.15,-22073 6314.15,-22073 6314.15,-22073 3935.72,-22073 3935.72,-22073"/>
<polygon fill="black" stroke="black" points="3935.72,-22069.5 3925.72,-22073 3935.72,-22076.5 3935.72,-22069.5"/>
</g>
<!-- layer33_moe_gate -->
<g id="node1569" class="node">
<title>layer33_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="4016.3,-21936.57 3605.4,-21936.57 3499.7,-21832.57 3910.6,-21832.57 4016.3,-21936.57"/>
<text text-anchor="middle" x="3758" y="-21898.57" font-family="Arial" font-size="10.00">GATE L33</text>
<text text-anchor="middle" x="3758" y="-21887.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3758" y="-21876.57" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3758" y="-21865.57" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer33_moe_mha&#45;&gt;layer33_moe_gate -->
<g id="edge2082" class="edge">
<title>layer33_moe_mha&#45;&gt;layer33_moe_gate</title>
<path fill="none" stroke="black" d="M3758,-21972.42C3758,-21972.42 3758,-21946.67 3758,-21946.67"/>
<polygon fill="black" stroke="black" points="3761.5,-21946.67 3758,-21936.67 3754.5,-21946.67 3761.5,-21946.67"/>
</g>
<!-- layer33_moe_split -->
<g id="node1570" class="node">
<title>layer33_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="4012.01,-21796.57 3607.94,-21796.57 3503.99,-21692.57 3908.06,-21692.57 4012.01,-21796.57"/>
<text text-anchor="middle" x="3758" y="-21758.57" font-family="Arial" font-size="10.00">SPLIT TOKENS L33</text>
<text text-anchor="middle" x="3758" y="-21747.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3758" y="-21736.57" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3758" y="-21725.57" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer33_moe_gate&#45;&gt;layer33_moe_split -->
<g id="edge2083" class="edge">
<title>layer33_moe_gate&#45;&gt;layer33_moe_split</title>
<path fill="none" stroke="black" d="M3758,-21832.44C3758,-21832.44 3758,-21806.75 3758,-21806.75"/>
<polygon fill="black" stroke="black" points="3761.5,-21806.75 3758,-21796.75 3754.5,-21806.75 3761.5,-21806.75"/>
</g>
<!-- layer33_moe_comm_to_expert0 -->
<g id="node1572" class="node">
<title>layer33_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1677" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1677" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1677" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1677" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert0 -->
<g id="edge2017" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3592.21,-21781C3110.96,-21781 1747.75,-21781 1747.75,-21781 1747.75,-21781 1747.75,-21655.78 1747.75,-21655.78"/>
<polygon fill="black" stroke="black" points="1751.25,-21655.78 1747.75,-21645.78 1744.25,-21655.78 1751.25,-21655.78"/>
</g>
<!-- layer33_moe_comm_to_expert1 -->
<g id="node1574" class="node">
<title>layer33_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1922" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1922" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1922" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1922" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert1 -->
<g id="edge2019" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3577.09,-21766C3117.37,-21766 1940.5,-21766 1940.5,-21766 1940.5,-21766 1940.5,-21666.26 1940.5,-21666.26"/>
<polygon fill="black" stroke="black" points="1944,-21666.26 1940.5,-21656.26 1937,-21666.26 1944,-21666.26"/>
</g>
<!-- layer33_moe_comm_to_expert2 -->
<g id="node1576" class="node">
<title>layer33_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2378" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2378" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2378" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2378" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert2 -->
<g id="edge2021" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3563.29,-21752C3186.97,-21752 2396.5,-21752 2396.5,-21752 2396.5,-21752 2396.5,-21666.13 2396.5,-21666.13"/>
<polygon fill="black" stroke="black" points="2400,-21666.13 2396.5,-21656.13 2393,-21666.13 2400,-21666.13"/>
</g>
<!-- layer33_moe_comm_to_expert3 -->
<g id="node1578" class="node">
<title>layer33_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2706" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2706" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2706" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2706" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert3 -->
<g id="edge2023" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3548.23,-21737C3246.15,-21737 2724.5,-21737 2724.5,-21737 2724.5,-21737 2724.5,-21666.04 2724.5,-21666.04"/>
<polygon fill="black" stroke="black" points="2728,-21666.04 2724.5,-21656.04 2721,-21666.04 2728,-21666.04"/>
</g>
<!-- layer33_moe_comm_to_expert4 -->
<g id="node1580" class="node">
<title>layer33_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2969" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2969" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2969" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2969" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert4 -->
<g id="edge2025" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3533.33,-21722C3305.89,-21722 2987.5,-21722 2987.5,-21722 2987.5,-21722 2987.5,-21666.17 2987.5,-21666.17"/>
<polygon fill="black" stroke="black" points="2991,-21666.17 2987.5,-21656.17 2984,-21666.17 2991,-21666.17"/>
</g>
<!-- layer33_moe_comm_to_expert5 -->
<g id="node1582" class="node">
<title>layer33_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3200" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3200" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3200" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3200" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert5 -->
<g id="edge2027" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3518.23,-21707C3374.14,-21707 3218.5,-21707 3218.5,-21707 3218.5,-21707 3218.5,-21666.25 3218.5,-21666.25"/>
<polygon fill="black" stroke="black" points="3222,-21666.25 3218.5,-21656.25 3215,-21666.25 3222,-21666.25"/>
</g>
<!-- layer33_moe_comm_to_expert6 -->
<g id="node1584" class="node">
<title>layer33_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3415" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3415" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3415" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3415" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert6 -->
<g id="edge2029" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3518.5,-21744.49C3518.5,-21740.93 3518.5,-21627 3518.5,-21627 3518.5,-21627 3515.81,-21627 3515.81,-21627"/>
<polygon fill="black" stroke="black" points="3515.81,-21623.5 3505.81,-21627 3515.81,-21630.5 3515.81,-21623.5"/>
</g>
<!-- layer33_moe_comm_to_expert7 -->
<g id="node1586" class="node">
<title>layer33_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3622" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3622" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3622" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3622" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert7 -->
<g id="edge2031" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3622,-21692.24C3622,-21692.24 3622,-21666.79 3622,-21666.79"/>
<polygon fill="black" stroke="black" points="3625.5,-21666.79 3622,-21656.79 3618.5,-21666.79 3625.5,-21666.79"/>
</g>
<!-- layer33_moe_comm_to_expert8 -->
<g id="node1588" class="node">
<title>layer33_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3894" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3894" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3894" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3894" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert8 -->
<g id="edge2033" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3894,-21692.24C3894,-21692.24 3894,-21666.79 3894,-21666.79"/>
<polygon fill="black" stroke="black" points="3897.5,-21666.79 3894,-21656.79 3890.5,-21666.79 3897.5,-21666.79"/>
</g>
<!-- layer33_moe_comm_to_expert9 -->
<g id="node1590" class="node">
<title>layer33_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4203" cy="-21627.58" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4203" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4203" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4203" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert9 -->
<g id="edge2035" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3998.26,-21744.49C3998.26,-21740.93 3998.26,-21627 3998.26,-21627 3998.26,-21627 4102.3,-21627 4102.3,-21627"/>
<polygon fill="black" stroke="black" points="4102.3,-21630.5 4112.3,-21627 4102.3,-21623.5 4102.3,-21630.5"/>
</g>
<!-- layer33_moe_comm_to_expert10 -->
<g id="node1592" class="node">
<title>layer33_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4535" cy="-21627.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4535" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4535" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4535" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert10 -->
<g id="edge2037" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3922.82,-21707C4130.07,-21707 4459.1,-21707 4459.1,-21707 4459.1,-21707 4459.1,-21654.81 4459.1,-21654.81"/>
<polygon fill="black" stroke="black" points="4462.6,-21654.81 4459.1,-21644.81 4455.6,-21654.81 4462.6,-21654.81"/>
</g>
<!-- layer33_moe_comm_to_expert11 -->
<g id="node1594" class="node">
<title>layer33_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4881" cy="-21627.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4881" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4881" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4881" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert11 -->
<g id="edge2039" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3937.49,-21722C4236.86,-21722 4805.6,-21722 4805.6,-21722 4805.6,-21722 4805.6,-21655.34 4805.6,-21655.34"/>
<polygon fill="black" stroke="black" points="4809.1,-21655.34 4805.6,-21645.34 4802.1,-21655.34 4809.1,-21655.34"/>
</g>
<!-- layer33_moe_comm_to_expert12 -->
<g id="node1596" class="node">
<title>layer33_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5232" cy="-21627.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5232" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5232" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5232" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert12 -->
<g id="edge2041" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3952.47,-21737C4336.77,-21737 5156.6,-21737 5156.6,-21737 5156.6,-21737 5156.6,-21655.16 5156.6,-21655.16"/>
<polygon fill="black" stroke="black" points="5160.1,-21655.16 5156.6,-21645.16 5153.1,-21655.16 5160.1,-21655.16"/>
</g>
<!-- layer33_moe_comm_to_expert13 -->
<g id="node1598" class="node">
<title>layer33_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5585" cy="-21627.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5585" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5585" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5585" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert13 -->
<g id="edge2043" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3967.6,-21752C4432.67,-21752 5510.1,-21752 5510.1,-21752 5510.1,-21752 5510.1,-21655.14 5510.1,-21655.14"/>
<polygon fill="black" stroke="black" points="5513.6,-21655.14 5510.1,-21645.14 5506.6,-21655.14 5513.6,-21655.14"/>
</g>
<!-- layer33_moe_comm_to_expert14 -->
<g id="node1600" class="node">
<title>layer33_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5940" cy="-21627.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5940" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5940" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5940" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert14 -->
<g id="edge2045" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3981.5,-21766C4523.79,-21766 5865.1,-21766 5865.1,-21766 5865.1,-21766 5865.1,-21655.39 5865.1,-21655.39"/>
<polygon fill="black" stroke="black" points="5868.6,-21655.39 5865.1,-21645.39 5861.6,-21655.39 5868.6,-21655.39"/>
</g>
<!-- layer33_moe_comm_to_expert15 -->
<g id="node1602" class="node">
<title>layer33_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6295" cy="-21627.58" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6295" y="-21636.08" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6295" y="-21625.08" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6295" y="-21614.08" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert15 -->
<g id="edge2047" class="edge">
<title>layer33_moe_split&#45;&gt;layer33_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3996.59,-21781C4614.69,-21781 6220.1,-21781 6220.1,-21781 6220.1,-21781 6220.1,-21655.18 6220.1,-21655.18"/>
<polygon fill="black" stroke="black" points="6223.6,-21655.18 6220.1,-21645.18 6216.6,-21655.18 6223.6,-21655.18"/>
</g>
<!-- layer33_moe_expert0 -->
<g id="node1571" class="node">
<title>layer33_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1327,-21562.59 999,-21562.59 999,-21510.59 1327,-21510.59 1327,-21562.59"/>
<text text-anchor="middle" x="1163" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 0 L33</text>
<text text-anchor="middle" x="1163" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1163" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1163" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert0 -->
<g id="node1604" class="node">
<title>layer33_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1209" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1209" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1209" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1209" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer33_moe_expert0&#45;&gt;layer33_moe_comm_from_expert0 -->
<g id="edge2049" class="edge">
<title>layer33_moe_expert0&#45;&gt;layer33_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1209,-21510.27C1209,-21510.27 1209,-21484.73 1209,-21484.73"/>
<polygon fill="black" stroke="black" points="1212.5,-21484.73 1209,-21474.73 1205.5,-21484.73 1212.5,-21484.73"/>
</g>
<!-- layer33_moe_comm_to_expert0&#45;&gt;layer33_moe_expert0 -->
<g id="edge2018" class="edge">
<title>layer33_moe_comm_to_expert0&#45;&gt;layer33_moe_expert0</title>
<path fill="none" stroke="black" d="M1586.45,-21627C1458.78,-21627 1241.25,-21627 1241.25,-21627 1241.25,-21627 1241.25,-21572.74 1241.25,-21572.74"/>
<polygon fill="black" stroke="black" points="1244.75,-21572.74 1241.25,-21562.74 1237.75,-21572.74 1244.75,-21572.74"/>
</g>
<!-- layer33_moe_expert1 -->
<g id="node1573" class="node">
<title>layer33_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1673,-21562.59 1345,-21562.59 1345,-21510.59 1673,-21510.59 1673,-21562.59"/>
<text text-anchor="middle" x="1509" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 1 L33</text>
<text text-anchor="middle" x="1509" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1509" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1509" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert1 -->
<g id="node1605" class="node">
<title>layer33_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1922" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1922" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1922" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1922" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer33_moe_expert1&#45;&gt;layer33_moe_comm_from_expert1 -->
<g id="edge2051" class="edge">
<title>layer33_moe_expert1&#45;&gt;layer33_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1663.5,-21510.59C1663.5,-21483.51 1663.5,-21445 1663.5,-21445 1663.5,-21445 1821.23,-21445 1821.23,-21445"/>
<polygon fill="black" stroke="black" points="1821.23,-21448.5 1831.23,-21445 1821.23,-21441.5 1821.23,-21448.5"/>
</g>
<!-- layer33_moe_comm_to_expert1&#45;&gt;layer33_moe_expert1 -->
<g id="edge2020" class="edge">
<title>layer33_moe_comm_to_expert1&#45;&gt;layer33_moe_expert1</title>
<path fill="none" stroke="black" d="M1922,-21598.3C1922,-21584.49 1922,-21571 1922,-21571 1922,-21571 1629.75,-21571 1629.75,-21571 1629.75,-21571 1629.75,-21570.17 1629.75,-21570.17"/>
<polygon fill="black" stroke="black" points="1633.25,-21572.67 1629.75,-21562.67 1626.25,-21572.67 1633.25,-21572.67"/>
</g>
<!-- layer33_moe_expert2 -->
<g id="node1575" class="node">
<title>layer33_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="2019,-21562.59 1691,-21562.59 1691,-21510.59 2019,-21510.59 2019,-21562.59"/>
<text text-anchor="middle" x="1855" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 2 L33</text>
<text text-anchor="middle" x="1855" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1855" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1855" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert2 -->
<g id="node1606" class="node">
<title>layer33_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2378" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2378" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2378" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2378" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer33_moe_expert2&#45;&gt;layer33_moe_comm_from_expert2 -->
<g id="edge2053" class="edge">
<title>layer33_moe_expert2&#45;&gt;layer33_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M2019.18,-21527C2026.6,-21527 2031,-21527 2031,-21527 2031,-21527 2031,-21445 2031,-21445 2031,-21445 2277.28,-21445 2277.28,-21445"/>
<polygon fill="black" stroke="black" points="2277.28,-21448.5 2287.28,-21445 2277.28,-21441.5 2277.28,-21448.5"/>
</g>
<!-- layer33_moe_comm_to_expert2&#45;&gt;layer33_moe_expert2 -->
<g id="edge2022" class="edge">
<title>layer33_moe_comm_to_expert2&#45;&gt;layer33_moe_expert2</title>
<path fill="none" stroke="black" d="M2287.09,-21627C2182.5,-21627 2025,-21627 2025,-21627 2025,-21627 2025,-21545 2025,-21545 2025,-21545 2024.43,-21545 2024.43,-21545"/>
<polygon fill="black" stroke="black" points="2029.34,-21541.5 2019.34,-21545 2029.34,-21548.5 2029.34,-21541.5"/>
</g>
<!-- layer33_moe_expert3 -->
<g id="node1577" class="node">
<title>layer33_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2365,-21562.59 2037,-21562.59 2037,-21510.59 2365,-21510.59 2365,-21562.59"/>
<text text-anchor="middle" x="2201" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 3 L33</text>
<text text-anchor="middle" x="2201" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2201" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2201" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert3 -->
<g id="node1607" class="node">
<title>layer33_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2706" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2706" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2706" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2706" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer33_moe_expert3&#45;&gt;layer33_moe_comm_from_expert3 -->
<g id="edge2055" class="edge">
<title>layer33_moe_expert3&#45;&gt;layer33_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2326.25,-21510.41C2326.25,-21498.06 2326.25,-21486 2326.25,-21486 2326.25,-21486 2647.33,-21486 2647.33,-21486 2647.33,-21486 2647.33,-21477.69 2647.33,-21477.69"/>
<polygon fill="black" stroke="black" points="2650.83,-21477.69 2647.33,-21467.69 2643.83,-21477.69 2650.83,-21477.69"/>
</g>
<!-- layer33_moe_comm_to_expert3&#45;&gt;layer33_moe_expert3 -->
<g id="edge2024" class="edge">
<title>layer33_moe_comm_to_expert3&#45;&gt;layer33_moe_expert3</title>
<path fill="none" stroke="black" d="M2647.33,-21605.14C2647.33,-21596.65 2647.33,-21589 2647.33,-21589 2647.33,-21589 2326.25,-21589 2326.25,-21589 2326.25,-21589 2326.25,-21572.8 2326.25,-21572.8"/>
<polygon fill="black" stroke="black" points="2329.75,-21572.8 2326.25,-21562.8 2322.75,-21572.8 2329.75,-21572.8"/>
</g>
<!-- layer33_moe_expert4 -->
<g id="node1579" class="node">
<title>layer33_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2711,-21562.59 2383,-21562.59 2383,-21510.59 2711,-21510.59 2711,-21562.59"/>
<text text-anchor="middle" x="2547" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 4 L33</text>
<text text-anchor="middle" x="2547" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2547" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2547" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert4 -->
<g id="node1608" class="node">
<title>layer33_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2969" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2969" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2969" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2969" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer33_moe_expert4&#45;&gt;layer33_moe_comm_from_expert4 -->
<g id="edge2057" class="edge">
<title>layer33_moe_expert4&#45;&gt;layer33_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2679.16,-21510.21C2679.16,-21503.43 2679.16,-21498 2679.16,-21498 2679.16,-21498 2967.75,-21498 2967.75,-21498 2967.75,-21498 2967.75,-21484.86 2967.75,-21484.86"/>
<polygon fill="black" stroke="black" points="2971.25,-21484.86 2967.75,-21474.86 2964.25,-21484.86 2971.25,-21484.86"/>
</g>
<!-- layer33_moe_comm_to_expert4&#45;&gt;layer33_moe_expert4 -->
<g id="edge2026" class="edge">
<title>layer33_moe_comm_to_expert4&#45;&gt;layer33_moe_expert4</title>
<path fill="none" stroke="black" d="M2967.75,-21598.53C2967.75,-21588.63 2967.75,-21580 2967.75,-21580 2967.75,-21580 2679.16,-21580 2679.16,-21580 2679.16,-21580 2679.16,-21572.84 2679.16,-21572.84"/>
<polygon fill="black" stroke="black" points="2682.66,-21572.84 2679.16,-21562.84 2675.66,-21572.84 2682.66,-21572.84"/>
</g>
<!-- layer33_moe_expert5 -->
<g id="node1581" class="node">
<title>layer33_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3057,-21562.59 2729,-21562.59 2729,-21510.59 3057,-21510.59 3057,-21562.59"/>
<text text-anchor="middle" x="2893" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 5 L33</text>
<text text-anchor="middle" x="2893" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2893" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2893" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert5 -->
<g id="node1609" class="node">
<title>layer33_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3200" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3200" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3200" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3200" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer33_moe_expert5&#45;&gt;layer33_moe_comm_from_expert5 -->
<g id="edge2059" class="edge">
<title>layer33_moe_expert5&#45;&gt;layer33_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3057.21,-21527C3064.1,-21527 3068.16,-21527 3068.16,-21527 3068.16,-21527 3068.16,-21445 3068.16,-21445 3068.16,-21445 3099.15,-21445 3099.15,-21445"/>
<polygon fill="black" stroke="black" points="3099.15,-21448.5 3109.15,-21445 3099.15,-21441.5 3099.15,-21448.5"/>
</g>
<!-- layer33_moe_comm_to_expert5&#45;&gt;layer33_moe_expert5 -->
<g id="edge2028" class="edge">
<title>layer33_moe_comm_to_expert5&#45;&gt;layer33_moe_expert5</title>
<path fill="none" stroke="black" d="M3109.18,-21627C3084.2,-21627 3063.84,-21627 3063.84,-21627 3063.84,-21627 3063.84,-21545 3063.84,-21545 3063.84,-21545 3063.19,-21545 3063.19,-21545"/>
<polygon fill="black" stroke="black" points="3067.35,-21541.5 3057.35,-21545 3067.35,-21548.5 3067.35,-21541.5"/>
</g>
<!-- layer33_moe_expert6 -->
<g id="node1583" class="node">
<title>layer33_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3403,-21562.59 3075,-21562.59 3075,-21510.59 3403,-21510.59 3403,-21562.59"/>
<text text-anchor="middle" x="3239" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 6 L33</text>
<text text-anchor="middle" x="3239" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3239" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3239" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert6 -->
<g id="node1610" class="node">
<title>layer33_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3415" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3415" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3415" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3415" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer33_moe_expert6&#45;&gt;layer33_moe_comm_from_expert6 -->
<g id="edge2061" class="edge">
<title>layer33_moe_expert6&#45;&gt;layer33_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3363.75,-21510.27C3363.75,-21510.27 3363.75,-21479.68 3363.75,-21479.68"/>
<polygon fill="black" stroke="black" points="3367.25,-21479.68 3363.75,-21469.68 3360.25,-21479.68 3367.25,-21479.68"/>
</g>
<!-- layer33_moe_comm_to_expert6&#45;&gt;layer33_moe_expert6 -->
<g id="edge2030" class="edge">
<title>layer33_moe_comm_to_expert6&#45;&gt;layer33_moe_expert6</title>
<path fill="none" stroke="black" d="M3363.75,-21603.68C3363.75,-21603.68 3363.75,-21572.9 3363.75,-21572.9"/>
<polygon fill="black" stroke="black" points="3367.25,-21572.9 3363.75,-21562.9 3360.25,-21572.9 3367.25,-21572.9"/>
</g>
<!-- layer33_moe_expert7 -->
<g id="node1585" class="node">
<title>layer33_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3749,-21562.59 3421,-21562.59 3421,-21510.59 3749,-21510.59 3749,-21562.59"/>
<text text-anchor="middle" x="3585" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 7 L33</text>
<text text-anchor="middle" x="3585" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3585" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3585" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert7 -->
<g id="node1611" class="node">
<title>layer33_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3622" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3622" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3622" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3622" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer33_moe_expert7&#45;&gt;layer33_moe_comm_from_expert7 -->
<g id="edge2063" class="edge">
<title>layer33_moe_expert7&#45;&gt;layer33_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3622,-21510.27C3622,-21510.27 3622,-21484.73 3622,-21484.73"/>
<polygon fill="black" stroke="black" points="3625.5,-21484.73 3622,-21474.73 3618.5,-21484.73 3625.5,-21484.73"/>
</g>
<!-- layer33_moe_comm_to_expert7&#45;&gt;layer33_moe_expert7 -->
<g id="edge2032" class="edge">
<title>layer33_moe_comm_to_expert7&#45;&gt;layer33_moe_expert7</title>
<path fill="none" stroke="black" d="M3622,-21598.54C3622,-21598.54 3622,-21572.89 3622,-21572.89"/>
<polygon fill="black" stroke="black" points="3625.5,-21572.89 3622,-21562.89 3618.5,-21572.89 3625.5,-21572.89"/>
</g>
<!-- layer33_moe_expert8 -->
<g id="node1587" class="node">
<title>layer33_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4095,-21562.59 3767,-21562.59 3767,-21510.59 4095,-21510.59 4095,-21562.59"/>
<text text-anchor="middle" x="3931" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 8 L33</text>
<text text-anchor="middle" x="3931" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3931" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3931" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert8 -->
<g id="node1612" class="node">
<title>layer33_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3894" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3894" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3894" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3894" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer33_moe_expert8&#45;&gt;layer33_moe_comm_from_expert8 -->
<g id="edge2065" class="edge">
<title>layer33_moe_expert8&#45;&gt;layer33_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3894,-21510.27C3894,-21510.27 3894,-21484.73 3894,-21484.73"/>
<polygon fill="black" stroke="black" points="3897.5,-21484.73 3894,-21474.73 3890.5,-21484.73 3897.5,-21484.73"/>
</g>
<!-- layer33_moe_comm_to_expert8&#45;&gt;layer33_moe_expert8 -->
<g id="edge2034" class="edge">
<title>layer33_moe_comm_to_expert8&#45;&gt;layer33_moe_expert8</title>
<path fill="none" stroke="black" d="M3894,-21598.54C3894,-21598.54 3894,-21572.89 3894,-21572.89"/>
<polygon fill="black" stroke="black" points="3897.5,-21572.89 3894,-21562.89 3890.5,-21572.89 3897.5,-21572.89"/>
</g>
<!-- layer33_moe_expert9 -->
<g id="node1589" class="node">
<title>layer33_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4441,-21562.59 4113,-21562.59 4113,-21510.59 4441,-21510.59 4441,-21562.59"/>
<text text-anchor="middle" x="4277" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 9 L33</text>
<text text-anchor="middle" x="4277" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4277" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4277" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert9 -->
<g id="node1613" class="node">
<title>layer33_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4203" cy="-21445.6" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4203" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4203" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4203" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer33_moe_expert9&#45;&gt;layer33_moe_comm_from_expert9 -->
<g id="edge2067" class="edge">
<title>layer33_moe_expert9&#45;&gt;layer33_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4203.25,-21510.27C4203.25,-21510.27 4203.25,-21484.73 4203.25,-21484.73"/>
<polygon fill="black" stroke="black" points="4206.75,-21484.73 4203.25,-21474.73 4199.75,-21484.73 4206.75,-21484.73"/>
</g>
<!-- layer33_moe_comm_to_expert9&#45;&gt;layer33_moe_expert9 -->
<g id="edge2036" class="edge">
<title>layer33_moe_comm_to_expert9&#45;&gt;layer33_moe_expert9</title>
<path fill="none" stroke="black" d="M4203.25,-21598.54C4203.25,-21598.54 4203.25,-21572.89 4203.25,-21572.89"/>
<polygon fill="black" stroke="black" points="4206.75,-21572.89 4203.25,-21562.89 4199.75,-21572.89 4206.75,-21572.89"/>
</g>
<!-- layer33_moe_expert10 -->
<g id="node1591" class="node">
<title>layer33_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4797,-21562.59 4459,-21562.59 4459,-21510.59 4797,-21510.59 4797,-21562.59"/>
<text text-anchor="middle" x="4628" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 10 L33</text>
<text text-anchor="middle" x="4628" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4628" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4628" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert10 -->
<g id="node1614" class="node">
<title>layer33_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4535" cy="-21445.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4535" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4535" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4535" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer33_moe_expert10&#45;&gt;layer33_moe_comm_from_expert10 -->
<g id="edge2069" class="edge">
<title>layer33_moe_expert10&#45;&gt;layer33_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4544.38,-21510.27C4544.38,-21510.27 4544.38,-21484.73 4544.38,-21484.73"/>
<polygon fill="black" stroke="black" points="4547.88,-21484.73 4544.38,-21474.73 4540.88,-21484.73 4547.88,-21484.73"/>
</g>
<!-- layer33_moe_comm_to_expert10&#45;&gt;layer33_moe_expert10 -->
<g id="edge2038" class="edge">
<title>layer33_moe_comm_to_expert10&#45;&gt;layer33_moe_expert10</title>
<path fill="none" stroke="black" d="M4544.02,-21598.54C4544.02,-21598.54 4544.02,-21572.89 4544.02,-21572.89"/>
<polygon fill="black" stroke="black" points="4547.52,-21572.89 4544.02,-21562.89 4540.52,-21572.89 4547.52,-21572.89"/>
</g>
<!-- layer33_moe_expert11 -->
<g id="node1593" class="node">
<title>layer33_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5153,-21562.59 4815,-21562.59 4815,-21510.59 5153,-21510.59 5153,-21562.59"/>
<text text-anchor="middle" x="4984" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 11 L33</text>
<text text-anchor="middle" x="4984" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4984" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4984" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert11 -->
<g id="node1615" class="node">
<title>layer33_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4882" cy="-21445.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4882" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4882" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4882" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer33_moe_expert11&#45;&gt;layer33_moe_comm_from_expert11 -->
<g id="edge2071" class="edge">
<title>layer33_moe_expert11&#45;&gt;layer33_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4895.88,-21510.27C4895.88,-21510.27 4895.88,-21484.41 4895.88,-21484.41"/>
<polygon fill="black" stroke="black" points="4899.38,-21484.41 4895.88,-21474.41 4892.38,-21484.41 4899.38,-21484.41"/>
</g>
<!-- layer33_moe_comm_to_expert11&#45;&gt;layer33_moe_expert11 -->
<g id="edge2040" class="edge">
<title>layer33_moe_comm_to_expert11&#45;&gt;layer33_moe_expert11</title>
<path fill="none" stroke="black" d="M4895.02,-21598.79C4895.02,-21598.79 4895.02,-21572.73 4895.02,-21572.73"/>
<polygon fill="black" stroke="black" points="4898.52,-21572.73 4895.02,-21562.73 4891.52,-21572.73 4898.52,-21572.73"/>
</g>
<!-- layer33_moe_expert12 -->
<g id="node1595" class="node">
<title>layer33_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5509,-21562.59 5171,-21562.59 5171,-21510.59 5509,-21510.59 5509,-21562.59"/>
<text text-anchor="middle" x="5340" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 12 L33</text>
<text text-anchor="middle" x="5340" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5340" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5340" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert12 -->
<g id="node1616" class="node">
<title>layer33_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5233" cy="-21445.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5233" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5233" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5233" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer33_moe_expert12&#45;&gt;layer33_moe_comm_from_expert12 -->
<g id="edge2073" class="edge">
<title>layer33_moe_expert12&#45;&gt;layer33_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5249.38,-21510.27C5249.38,-21510.27 5249.38,-21484.41 5249.38,-21484.41"/>
<polygon fill="black" stroke="black" points="5252.88,-21484.41 5249.38,-21474.41 5245.88,-21484.41 5252.88,-21484.41"/>
</g>
<!-- layer33_moe_comm_to_expert12&#45;&gt;layer33_moe_expert12 -->
<g id="edge2042" class="edge">
<title>layer33_moe_comm_to_expert12&#45;&gt;layer33_moe_expert12</title>
<path fill="none" stroke="black" d="M5248.52,-21598.79C5248.52,-21598.79 5248.52,-21572.73 5248.52,-21572.73"/>
<polygon fill="black" stroke="black" points="5252.02,-21572.73 5248.52,-21562.73 5245.02,-21572.73 5252.02,-21572.73"/>
</g>
<!-- layer33_moe_expert13 -->
<g id="node1597" class="node">
<title>layer33_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5865,-21562.59 5527,-21562.59 5527,-21510.59 5865,-21510.59 5865,-21562.59"/>
<text text-anchor="middle" x="5696" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 13 L33</text>
<text text-anchor="middle" x="5696" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5696" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5696" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert13 -->
<g id="node1617" class="node">
<title>layer33_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5587" cy="-21445.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5587" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5587" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5587" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer33_moe_expert13&#45;&gt;layer33_moe_comm_from_expert13 -->
<g id="edge2075" class="edge">
<title>layer33_moe_expert13&#45;&gt;layer33_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5604.38,-21510.27C5604.38,-21510.27 5604.38,-21484.41 5604.38,-21484.41"/>
<polygon fill="black" stroke="black" points="5607.88,-21484.41 5604.38,-21474.41 5600.88,-21484.41 5607.88,-21484.41"/>
</g>
<!-- layer33_moe_comm_to_expert13&#45;&gt;layer33_moe_expert13 -->
<g id="edge2044" class="edge">
<title>layer33_moe_comm_to_expert13&#45;&gt;layer33_moe_expert13</title>
<path fill="none" stroke="black" d="M5603.02,-21598.79C5603.02,-21598.79 5603.02,-21572.73 5603.02,-21572.73"/>
<polygon fill="black" stroke="black" points="5606.52,-21572.73 5603.02,-21562.73 5599.52,-21572.73 5606.52,-21572.73"/>
</g>
<!-- layer33_moe_expert14 -->
<g id="node1599" class="node">
<title>layer33_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6221,-21562.59 5883,-21562.59 5883,-21510.59 6221,-21510.59 6221,-21562.59"/>
<text text-anchor="middle" x="6052" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 14 L33</text>
<text text-anchor="middle" x="6052" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6052" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6052" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert14 -->
<g id="node1618" class="node">
<title>layer33_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5942" cy="-21445.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5942" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5942" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5942" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer33_moe_expert14&#45;&gt;layer33_moe_comm_from_expert14 -->
<g id="edge2077" class="edge">
<title>layer33_moe_expert14&#45;&gt;layer33_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5959.88,-21510.27C5959.88,-21510.27 5959.88,-21484.09 5959.88,-21484.09"/>
<polygon fill="black" stroke="black" points="5963.38,-21484.09 5959.88,-21474.09 5956.38,-21484.09 5963.38,-21484.09"/>
</g>
<!-- layer33_moe_comm_to_expert14&#45;&gt;layer33_moe_expert14 -->
<g id="edge2046" class="edge">
<title>layer33_moe_comm_to_expert14&#45;&gt;layer33_moe_expert14</title>
<path fill="none" stroke="black" d="M5958.52,-21598.79C5958.52,-21598.79 5958.52,-21572.73 5958.52,-21572.73"/>
<polygon fill="black" stroke="black" points="5962.02,-21572.73 5958.52,-21562.73 5955.02,-21572.73 5962.02,-21572.73"/>
</g>
<!-- layer33_moe_expert15 -->
<g id="node1601" class="node">
<title>layer33_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6577,-21562.59 6239,-21562.59 6239,-21510.59 6577,-21510.59 6577,-21562.59"/>
<text text-anchor="middle" x="6408" y="-21550.59" font-family="Arial" font-size="10.00">EXPERT 15 L33</text>
<text text-anchor="middle" x="6408" y="-21539.59" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6408" y="-21528.59" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6408" y="-21517.59" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_comm_from_expert15 -->
<g id="node1619" class="node">
<title>layer33_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6297" cy="-21445.6" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6297" y="-21454.1" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6297" y="-21443.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6297" y="-21432.1" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer33_moe_expert15&#45;&gt;layer33_moe_comm_from_expert15 -->
<g id="edge2079" class="edge">
<title>layer33_moe_expert15&#45;&gt;layer33_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6315.38,-21510.27C6315.38,-21510.27 6315.38,-21484.09 6315.38,-21484.09"/>
<polygon fill="black" stroke="black" points="6318.88,-21484.09 6315.38,-21474.09 6311.88,-21484.09 6318.88,-21484.09"/>
</g>
<!-- layer33_moe_comm_to_expert15&#45;&gt;layer33_moe_expert15 -->
<g id="edge2048" class="edge">
<title>layer33_moe_comm_to_expert15&#45;&gt;layer33_moe_expert15</title>
<path fill="none" stroke="black" d="M6314.02,-21598.79C6314.02,-21598.79 6314.02,-21572.73 6314.02,-21572.73"/>
<polygon fill="black" stroke="black" points="6317.52,-21572.73 6314.02,-21562.73 6310.52,-21572.73 6317.52,-21572.73"/>
</g>
<!-- layer33_moe_aggregate -->
<g id="node1603" class="node">
<title>layer33_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3983.1,-21380.61 3566.16,-21380.61 3458.9,-21276.61 3875.84,-21276.61 3983.1,-21380.61"/>
<text text-anchor="middle" x="3721" y="-21342.61" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L33</text>
<text text-anchor="middle" x="3721" y="-21331.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3721" y="-21320.61" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3721" y="-21309.61" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_mha -->
<g id="node1620" class="node">
<title>layer34_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3851,-21240.61 3591,-21240.61 3591,-21188.61 3851,-21188.61 3851,-21240.61"/>
<text text-anchor="middle" x="3721" y="-21228.61" font-family="Arial" font-size="10.00">MHA L34</text>
<text text-anchor="middle" x="3721" y="-21217.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3721" y="-21206.61" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3721" y="-21195.61" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer33_moe_aggregate&#45;&gt;layer34_moe_mha -->
<g id="edge2148" class="edge">
<title>layer33_moe_aggregate&#45;&gt;layer34_moe_mha</title>
<path fill="none" stroke="black" d="M3721,-21276.28C3721,-21276.28 3721,-21250.84 3721,-21250.84"/>
<polygon fill="black" stroke="black" points="3724.5,-21250.84 3721,-21240.84 3717.5,-21250.84 3724.5,-21250.84"/>
</g>
<!-- layer33_moe_comm_from_expert0&#45;&gt;layer33_moe_aggregate -->
<g id="edge2050" class="edge">
<title>layer33_moe_comm_from_expert0&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M1294.75,-21435.93C1294.75,-21402.08 1294.75,-21291 1294.75,-21291 1294.75,-21291 3463.6,-21291 3463.6,-21291"/>
<polygon fill="black" stroke="black" points="3463.6,-21294.5 3473.6,-21291 3463.6,-21287.5 3463.6,-21294.5"/>
</g>
<!-- layer33_moe_comm_from_expert1&#45;&gt;layer33_moe_aggregate -->
<g id="edge2052" class="edge">
<title>layer33_moe_comm_from_expert1&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M2006.25,-21434.65C2006.25,-21401.74 2006.25,-21306 2006.25,-21306 2006.25,-21306 3478.85,-21306 3478.85,-21306"/>
<polygon fill="black" stroke="black" points="3478.85,-21309.5 3488.85,-21306 3478.85,-21302.5 3478.85,-21309.5"/>
</g>
<!-- layer33_moe_comm_from_expert2&#45;&gt;layer33_moe_aggregate -->
<g id="edge2054" class="edge">
<title>layer33_moe_comm_from_expert2&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M2450.01,-21428.01C2450.01,-21393.67 2450.01,-21321 2450.01,-21321 2450.01,-21321 3494.67,-21321 3494.67,-21321"/>
<polygon fill="black" stroke="black" points="3494.67,-21324.5 3504.67,-21321 3494.67,-21317.5 3494.67,-21324.5"/>
</g>
<!-- layer33_moe_comm_from_expert3&#45;&gt;layer33_moe_aggregate -->
<g id="edge2056" class="edge">
<title>layer33_moe_comm_from_expert3&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M2778.01,-21427.99C2778.01,-21397.01 2778.01,-21336 2778.01,-21336 2778.01,-21336 3510.15,-21336 3510.15,-21336"/>
<polygon fill="black" stroke="black" points="3510.15,-21339.5 3520.15,-21336 3510.15,-21332.5 3510.15,-21339.5"/>
</g>
<!-- layer33_moe_comm_from_expert4&#45;&gt;layer33_moe_aggregate -->
<g id="edge2058" class="edge">
<title>layer33_moe_comm_from_expert4&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M3048.75,-21431.49C3048.75,-21404.9 3048.75,-21350 3048.75,-21350 3048.75,-21350 3524.19,-21350 3524.19,-21350"/>
<polygon fill="black" stroke="black" points="3524.19,-21353.5 3534.19,-21350 3524.19,-21346.5 3524.19,-21353.5"/>
</g>
<!-- layer33_moe_comm_from_expert5&#45;&gt;layer33_moe_aggregate -->
<g id="edge2060" class="edge">
<title>layer33_moe_comm_from_expert5&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M3270.5,-21427.31C3270.5,-21403.53 3270.5,-21365 3270.5,-21365 3270.5,-21365 3540.04,-21365 3540.04,-21365"/>
<polygon fill="black" stroke="black" points="3540.04,-21368.5 3550.04,-21365 3540.04,-21361.5 3540.04,-21368.5"/>
</g>
<!-- layer33_moe_comm_from_expert6&#45;&gt;layer33_moe_aggregate -->
<g id="edge2062" class="edge">
<title>layer33_moe_comm_from_expert6&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M3482.11,-21426.02C3482.11,-21426.02 3482.11,-21338.65 3482.11,-21338.65"/>
<polygon fill="black" stroke="black" points="3485.61,-21338.65 3482.11,-21328.65 3478.61,-21338.65 3485.61,-21338.65"/>
</g>
<!-- layer33_moe_comm_from_expert7&#45;&gt;layer33_moe_aggregate -->
<g id="edge2064" class="edge">
<title>layer33_moe_comm_from_expert7&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M3622,-21416.38C3622,-21416.38 3622,-21390.67 3622,-21390.67"/>
<polygon fill="black" stroke="black" points="3625.5,-21390.67 3622,-21380.67 3618.5,-21390.67 3625.5,-21390.67"/>
</g>
<!-- layer33_moe_comm_from_expert8&#45;&gt;layer33_moe_aggregate -->
<g id="edge2066" class="edge">
<title>layer33_moe_comm_from_expert8&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M3893.39,-21416.38C3893.39,-21416.38 3893.39,-21390.67 3893.39,-21390.67"/>
<polygon fill="black" stroke="black" points="3896.89,-21390.67 3893.39,-21380.67 3889.89,-21390.67 3896.89,-21390.67"/>
</g>
<!-- layer33_moe_comm_from_expert9&#45;&gt;layer33_moe_aggregate -->
<g id="edge2068" class="edge">
<title>layer33_moe_comm_from_expert9&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M4184.5,-21416.78C4184.5,-21394.35 4184.5,-21367 4184.5,-21367 4184.5,-21367 3979.37,-21367 3979.37,-21367"/>
<polygon fill="black" stroke="black" points="3979.37,-21363.5 3969.37,-21367 3979.37,-21370.5 3979.37,-21363.5"/>
</g>
<!-- layer33_moe_comm_from_expert10&#45;&gt;layer33_moe_aggregate -->
<g id="edge2070" class="edge">
<title>layer33_moe_comm_from_expert10&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M4516.15,-21417.12C4516.15,-21390.23 4516.15,-21354 4516.15,-21354 4516.15,-21354 3965.81,-21354 3965.81,-21354"/>
<polygon fill="black" stroke="black" points="3965.81,-21350.5 3955.81,-21354 3965.81,-21357.5 3965.81,-21350.5"/>
</g>
<!-- layer33_moe_comm_from_expert11&#45;&gt;layer33_moe_aggregate -->
<g id="edge2072" class="edge">
<title>layer33_moe_comm_from_expert11&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M4862.65,-21417.02C4862.65,-21386.05 4862.65,-21341 4862.65,-21341 4862.65,-21341 3952.47,-21341 3952.47,-21341"/>
<polygon fill="black" stroke="black" points="3952.47,-21337.5 3942.47,-21341 3952.47,-21344.5 3952.47,-21337.5"/>
</g>
<!-- layer33_moe_comm_from_expert12&#45;&gt;layer33_moe_aggregate -->
<g id="edge2074" class="edge">
<title>layer33_moe_comm_from_expert12&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M5213.65,-21417.13C5213.65,-21382.33 5213.65,-21328 5213.65,-21328 5213.65,-21328 3938.94,-21328 3938.94,-21328"/>
<polygon fill="black" stroke="black" points="3938.94,-21324.5 3928.94,-21328 3938.94,-21331.5 3938.94,-21324.5"/>
</g>
<!-- layer33_moe_comm_from_expert13&#45;&gt;layer33_moe_aggregate -->
<g id="edge2076" class="edge">
<title>layer33_moe_comm_from_expert13&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M5567.15,-21416.94C5567.15,-21378.49 5567.15,-21315 5567.15,-21315 5567.15,-21315 3925.52,-21315 3925.52,-21315"/>
<polygon fill="black" stroke="black" points="3925.52,-21311.5 3915.52,-21315 3925.52,-21318.5 3925.52,-21311.5"/>
</g>
<!-- layer33_moe_comm_from_expert14&#45;&gt;layer33_moe_aggregate -->
<g id="edge2078" class="edge">
<title>layer33_moe_comm_from_expert14&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M5922.15,-21417.23C5922.15,-21375.38 5922.15,-21302 5922.15,-21302 5922.15,-21302 3912.06,-21302 3912.06,-21302"/>
<polygon fill="black" stroke="black" points="3912.06,-21298.5 3902.06,-21302 3912.06,-21305.5 3912.06,-21298.5"/>
</g>
<!-- layer33_moe_comm_from_expert15&#45;&gt;layer33_moe_aggregate -->
<g id="edge2080" class="edge">
<title>layer33_moe_comm_from_expert15&#45;&gt;layer33_moe_aggregate</title>
<path fill="none" stroke="black" d="M6277.15,-21417.24C6277.15,-21372.11 6277.15,-21289 6277.15,-21289 6277.15,-21289 3898.72,-21289 3898.72,-21289"/>
<polygon fill="black" stroke="black" points="3898.72,-21285.5 3888.72,-21289 3898.72,-21292.5 3898.72,-21285.5"/>
</g>
<!-- layer34_moe_gate -->
<g id="node1621" class="node">
<title>layer34_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3979.3,-21152.61 3568.4,-21152.61 3462.7,-21048.61 3873.6,-21048.61 3979.3,-21152.61"/>
<text text-anchor="middle" x="3721" y="-21114.61" font-family="Arial" font-size="10.00">GATE L34</text>
<text text-anchor="middle" x="3721" y="-21103.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3721" y="-21092.61" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3721" y="-21081.61" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer34_moe_mha&#45;&gt;layer34_moe_gate -->
<g id="edge2149" class="edge">
<title>layer34_moe_mha&#45;&gt;layer34_moe_gate</title>
<path fill="none" stroke="black" d="M3721,-21188.45C3721,-21188.45 3721,-21162.71 3721,-21162.71"/>
<polygon fill="black" stroke="black" points="3724.5,-21162.71 3721,-21152.71 3717.5,-21162.71 3724.5,-21162.71"/>
</g>
<!-- layer34_moe_split -->
<g id="node1622" class="node">
<title>layer34_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3975.01,-21012.61 3570.94,-21012.61 3466.99,-20908.61 3871.06,-20908.61 3975.01,-21012.61"/>
<text text-anchor="middle" x="3721" y="-20974.61" font-family="Arial" font-size="10.00">SPLIT TOKENS L34</text>
<text text-anchor="middle" x="3721" y="-20963.61" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3721" y="-20952.61" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3721" y="-20941.61" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer34_moe_gate&#45;&gt;layer34_moe_split -->
<g id="edge2150" class="edge">
<title>layer34_moe_gate&#45;&gt;layer34_moe_split</title>
<path fill="none" stroke="black" d="M3721,-21048.48C3721,-21048.48 3721,-21022.78 3721,-21022.78"/>
<polygon fill="black" stroke="black" points="3724.5,-21022.78 3721,-21012.78 3717.5,-21022.78 3724.5,-21022.78"/>
</g>
<!-- layer34_moe_comm_to_expert0 -->
<g id="node1624" class="node">
<title>layer34_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1172" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1172" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1172" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1172" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert0 -->
<g id="edge2084" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3554.97,-20997C2992,-20997 1190.5,-20997 1190.5,-20997 1190.5,-20997 1190.5,-20882.11 1190.5,-20882.11"/>
<polygon fill="black" stroke="black" points="1194,-20882.11 1190.5,-20872.11 1187,-20882.11 1194,-20882.11"/>
</g>
<!-- layer34_moe_comm_to_expert1 -->
<g id="node1626" class="node">
<title>layer34_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1885" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1885" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1885" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1885" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert1 -->
<g id="edge2086" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3540.09,-20982C3080.37,-20982 1903.5,-20982 1903.5,-20982 1903.5,-20982 1903.5,-20882.29 1903.5,-20882.29"/>
<polygon fill="black" stroke="black" points="1907,-20882.29 1903.5,-20872.29 1900,-20882.29 1907,-20882.29"/>
</g>
<!-- layer34_moe_comm_to_expert2 -->
<g id="node1628" class="node">
<title>layer34_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2341" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2341" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2341" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2341" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert2 -->
<g id="edge2088" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3526.29,-20968C3149.97,-20968 2359.5,-20968 2359.5,-20968 2359.5,-20968 2359.5,-20882.15 2359.5,-20882.15"/>
<polygon fill="black" stroke="black" points="2363,-20882.15 2359.5,-20872.15 2356,-20882.15 2363,-20882.15"/>
</g>
<!-- layer34_moe_comm_to_expert3 -->
<g id="node1630" class="node">
<title>layer34_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2669" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2669" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2669" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2669" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert3 -->
<g id="edge2090" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3511.23,-20953C3209.15,-20953 2687.5,-20953 2687.5,-20953 2687.5,-20953 2687.5,-20882.07 2687.5,-20882.07"/>
<polygon fill="black" stroke="black" points="2691,-20882.07 2687.5,-20872.07 2684,-20882.07 2691,-20882.07"/>
</g>
<!-- layer34_moe_comm_to_expert4 -->
<g id="node1632" class="node">
<title>layer34_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2932" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2932" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2932" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2932" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert4 -->
<g id="edge2092" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3496.33,-20938C3268.89,-20938 2950.5,-20938 2950.5,-20938 2950.5,-20938 2950.5,-20882.19 2950.5,-20882.19"/>
<polygon fill="black" stroke="black" points="2954,-20882.19 2950.5,-20872.19 2947,-20882.19 2954,-20882.19"/>
</g>
<!-- layer34_moe_comm_to_expert5 -->
<g id="node1634" class="node">
<title>layer34_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3163" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3163" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3163" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3163" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert5 -->
<g id="edge2094" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3481.23,-20923C3337.14,-20923 3181.5,-20923 3181.5,-20923 3181.5,-20923 3181.5,-20882.28 3181.5,-20882.28"/>
<polygon fill="black" stroke="black" points="3185,-20882.28 3181.5,-20872.28 3178,-20882.28 3185,-20882.28"/>
</g>
<!-- layer34_moe_comm_to_expert6 -->
<g id="node1636" class="node">
<title>layer34_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3378" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3378" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3378" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3378" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert6 -->
<g id="edge2096" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3481.5,-20960.52C3481.5,-20956.96 3481.5,-20843 3481.5,-20843 3481.5,-20843 3478.81,-20843 3478.81,-20843"/>
<polygon fill="black" stroke="black" points="3478.81,-20839.5 3468.81,-20843 3478.81,-20846.5 3478.81,-20839.5"/>
</g>
<!-- layer34_moe_comm_to_expert7 -->
<g id="node1638" class="node">
<title>layer34_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3585" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3585" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3585" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3585" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert7 -->
<g id="edge2098" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3585,-20908.27C3585,-20908.27 3585,-20882.83 3585,-20882.83"/>
<polygon fill="black" stroke="black" points="3588.5,-20882.83 3585,-20872.83 3581.5,-20882.83 3588.5,-20882.83"/>
</g>
<!-- layer34_moe_comm_to_expert8 -->
<g id="node1640" class="node">
<title>layer34_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3857" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3857" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3857" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3857" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert8 -->
<g id="edge2100" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3857,-20908.27C3857,-20908.27 3857,-20882.83 3857,-20882.83"/>
<polygon fill="black" stroke="black" points="3860.5,-20882.83 3857,-20872.83 3853.5,-20882.83 3860.5,-20882.83"/>
</g>
<!-- layer34_moe_comm_to_expert9 -->
<g id="node1642" class="node">
<title>layer34_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4166" cy="-20843.62" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4166" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4166" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4166" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert9 -->
<g id="edge2102" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3961.26,-20960.52C3961.26,-20956.96 3961.26,-20843 3961.26,-20843 3961.26,-20843 4065.3,-20843 4065.3,-20843"/>
<polygon fill="black" stroke="black" points="4065.3,-20846.5 4075.3,-20843 4065.3,-20839.5 4065.3,-20846.5"/>
</g>
<!-- layer34_moe_comm_to_expert10 -->
<g id="node1644" class="node">
<title>layer34_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4498" cy="-20843.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4498" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4498" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4498" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert10 -->
<g id="edge2104" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3885.82,-20923C4093.07,-20923 4422.1,-20923 4422.1,-20923 4422.1,-20923 4422.1,-20870.84 4422.1,-20870.84"/>
<polygon fill="black" stroke="black" points="4425.6,-20870.84 4422.1,-20860.84 4418.6,-20870.84 4425.6,-20870.84"/>
</g>
<!-- layer34_moe_comm_to_expert11 -->
<g id="node1646" class="node">
<title>layer34_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4844" cy="-20843.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4844" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4844" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4844" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert11 -->
<g id="edge2106" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3900.49,-20938C4199.86,-20938 4768.6,-20938 4768.6,-20938 4768.6,-20938 4768.6,-20871.37 4768.6,-20871.37"/>
<polygon fill="black" stroke="black" points="4772.1,-20871.37 4768.6,-20861.37 4765.1,-20871.37 4772.1,-20871.37"/>
</g>
<!-- layer34_moe_comm_to_expert12 -->
<g id="node1648" class="node">
<title>layer34_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5195" cy="-20843.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5195" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5195" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5195" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert12 -->
<g id="edge2108" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3915.47,-20953C4299.77,-20953 5119.6,-20953 5119.6,-20953 5119.6,-20953 5119.6,-20871.19 5119.6,-20871.19"/>
<polygon fill="black" stroke="black" points="5123.1,-20871.19 5119.6,-20861.19 5116.1,-20871.19 5123.1,-20871.19"/>
</g>
<!-- layer34_moe_comm_to_expert13 -->
<g id="node1650" class="node">
<title>layer34_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5548" cy="-20843.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5548" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5548" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5548" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert13 -->
<g id="edge2110" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3930.6,-20968C4395.67,-20968 5473.1,-20968 5473.1,-20968 5473.1,-20968 5473.1,-20871.17 5473.1,-20871.17"/>
<polygon fill="black" stroke="black" points="5476.6,-20871.17 5473.1,-20861.17 5469.6,-20871.17 5476.6,-20871.17"/>
</g>
<!-- layer34_moe_comm_to_expert14 -->
<g id="node1652" class="node">
<title>layer34_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5903" cy="-20843.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5903" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5903" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5903" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert14 -->
<g id="edge2112" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3944.5,-20982C4486.79,-20982 5828.1,-20982 5828.1,-20982 5828.1,-20982 5828.1,-20871.42 5828.1,-20871.42"/>
<polygon fill="black" stroke="black" points="5831.6,-20871.42 5828.1,-20861.42 5824.6,-20871.42 5831.6,-20871.42"/>
</g>
<!-- layer34_moe_comm_to_expert15 -->
<g id="node1654" class="node">
<title>layer34_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6258" cy="-20843.62" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6258" y="-20852.12" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6258" y="-20841.12" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6258" y="-20830.12" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert15 -->
<g id="edge2114" class="edge">
<title>layer34_moe_split&#45;&gt;layer34_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3959.59,-20997C4577.69,-20997 6183.1,-20997 6183.1,-20997 6183.1,-20997 6183.1,-20871.21 6183.1,-20871.21"/>
<polygon fill="black" stroke="black" points="6186.6,-20871.21 6183.1,-20861.21 6179.6,-20871.21 6186.6,-20871.21"/>
</g>
<!-- layer34_moe_expert0 -->
<g id="node1623" class="node">
<title>layer34_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1290,-20778.63 962,-20778.63 962,-20726.63 1290,-20726.63 1290,-20778.63"/>
<text text-anchor="middle" x="1126" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 0 L34</text>
<text text-anchor="middle" x="1126" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1126" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1126" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert0 -->
<g id="node1656" class="node">
<title>layer34_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1172" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1172" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1172" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1172" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer34_moe_expert0&#45;&gt;layer34_moe_comm_from_expert0 -->
<g id="edge2116" class="edge">
<title>layer34_moe_expert0&#45;&gt;layer34_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1172,-20726.31C1172,-20726.31 1172,-20700.76 1172,-20700.76"/>
<polygon fill="black" stroke="black" points="1175.5,-20700.76 1172,-20690.76 1168.5,-20700.76 1175.5,-20700.76"/>
</g>
<!-- layer34_moe_comm_to_expert0&#45;&gt;layer34_moe_expert0 -->
<g id="edge2085" class="edge">
<title>layer34_moe_comm_to_expert0&#45;&gt;layer34_moe_expert0</title>
<path fill="none" stroke="black" d="M1172,-20814.58C1172,-20814.58 1172,-20788.93 1172,-20788.93"/>
<polygon fill="black" stroke="black" points="1175.5,-20788.93 1172,-20778.93 1168.5,-20788.93 1175.5,-20788.93"/>
</g>
<!-- layer34_moe_expert1 -->
<g id="node1625" class="node">
<title>layer34_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1636,-20778.63 1308,-20778.63 1308,-20726.63 1636,-20726.63 1636,-20778.63"/>
<text text-anchor="middle" x="1472" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 1 L34</text>
<text text-anchor="middle" x="1472" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1472" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1472" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert1 -->
<g id="node1657" class="node">
<title>layer34_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1885" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1885" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1885" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1885" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer34_moe_expert1&#45;&gt;layer34_moe_comm_from_expert1 -->
<g id="edge2118" class="edge">
<title>layer34_moe_expert1&#45;&gt;layer34_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1573.25,-20726.61C1573.25,-20699.53 1573.25,-20661 1573.25,-20661 1573.25,-20661 1784.41,-20661 1784.41,-20661"/>
<polygon fill="black" stroke="black" points="1784.41,-20664.5 1794.41,-20661 1784.41,-20657.5 1784.41,-20664.5"/>
</g>
<!-- layer34_moe_comm_to_expert1&#45;&gt;layer34_moe_expert1 -->
<g id="edge2087" class="edge">
<title>layer34_moe_comm_to_expert1&#45;&gt;layer34_moe_expert1</title>
<path fill="none" stroke="black" d="M1794.49,-20843C1678.02,-20843 1490.5,-20843 1490.5,-20843 1490.5,-20843 1490.5,-20788.77 1490.5,-20788.77"/>
<polygon fill="black" stroke="black" points="1494,-20788.77 1490.5,-20778.77 1487,-20788.77 1494,-20788.77"/>
</g>
<!-- layer34_moe_expert2 -->
<g id="node1627" class="node">
<title>layer34_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1982,-20778.63 1654,-20778.63 1654,-20726.63 1982,-20726.63 1982,-20778.63"/>
<text text-anchor="middle" x="1818" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 2 L34</text>
<text text-anchor="middle" x="1818" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1818" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1818" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert2 -->
<g id="node1658" class="node">
<title>layer34_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2341" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2341" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2341" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2341" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer34_moe_expert2&#45;&gt;layer34_moe_comm_from_expert2 -->
<g id="edge2120" class="edge">
<title>layer34_moe_expert2&#45;&gt;layer34_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1982.18,-20743C1989.6,-20743 1994,-20743 1994,-20743 1994,-20743 1994,-20661 1994,-20661 1994,-20661 2240.28,-20661 2240.28,-20661"/>
<polygon fill="black" stroke="black" points="2240.28,-20664.5 2250.28,-20661 2240.28,-20657.5 2240.28,-20664.5"/>
</g>
<!-- layer34_moe_comm_to_expert2&#45;&gt;layer34_moe_expert2 -->
<g id="edge2089" class="edge">
<title>layer34_moe_comm_to_expert2&#45;&gt;layer34_moe_expert2</title>
<path fill="none" stroke="black" d="M2250.09,-20843C2145.5,-20843 1988,-20843 1988,-20843 1988,-20843 1988,-20761 1988,-20761 1988,-20761 1987.43,-20761 1987.43,-20761"/>
<polygon fill="black" stroke="black" points="1992.34,-20757.5 1982.34,-20761 1992.34,-20764.5 1992.34,-20757.5"/>
</g>
<!-- layer34_moe_expert3 -->
<g id="node1629" class="node">
<title>layer34_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2328,-20778.63 2000,-20778.63 2000,-20726.63 2328,-20726.63 2328,-20778.63"/>
<text text-anchor="middle" x="2164" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 3 L34</text>
<text text-anchor="middle" x="2164" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2164" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2164" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert3 -->
<g id="node1659" class="node">
<title>layer34_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2669" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2669" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2669" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2669" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer34_moe_expert3&#45;&gt;layer34_moe_comm_from_expert3 -->
<g id="edge2122" class="edge">
<title>layer34_moe_expert3&#45;&gt;layer34_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2289.25,-20726.42C2289.25,-20714.07 2289.25,-20702 2289.25,-20702 2289.25,-20702 2610.33,-20702 2610.33,-20702 2610.33,-20702 2610.33,-20694.18 2610.33,-20694.18"/>
<polygon fill="black" stroke="black" points="2613.83,-20694.18 2610.33,-20684.18 2606.83,-20694.18 2613.83,-20694.18"/>
</g>
<!-- layer34_moe_comm_to_expert3&#45;&gt;layer34_moe_expert3 -->
<g id="edge2091" class="edge">
<title>layer34_moe_comm_to_expert3&#45;&gt;layer34_moe_expert3</title>
<path fill="none" stroke="black" d="M2610.33,-20821.35C2610.33,-20811.45 2610.33,-20802 2610.33,-20802 2610.33,-20802 2289.25,-20802 2289.25,-20802 2289.25,-20802 2289.25,-20788.76 2289.25,-20788.76"/>
<polygon fill="black" stroke="black" points="2292.75,-20788.76 2289.25,-20778.76 2285.75,-20788.76 2292.75,-20788.76"/>
</g>
<!-- layer34_moe_expert4 -->
<g id="node1631" class="node">
<title>layer34_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2674,-20778.63 2346,-20778.63 2346,-20726.63 2674,-20726.63 2674,-20778.63"/>
<text text-anchor="middle" x="2510" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 4 L34</text>
<text text-anchor="middle" x="2510" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2510" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2510" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert4 -->
<g id="node1660" class="node">
<title>layer34_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2932" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2932" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2932" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2932" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer34_moe_expert4&#45;&gt;layer34_moe_comm_from_expert4 -->
<g id="edge2124" class="edge">
<title>layer34_moe_expert4&#45;&gt;layer34_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2642.16,-20726.22C2642.16,-20719.43 2642.16,-20714 2642.16,-20714 2642.16,-20714 2930.75,-20714 2930.75,-20714 2930.75,-20714 2930.75,-20700.88 2930.75,-20700.88"/>
<polygon fill="black" stroke="black" points="2934.25,-20700.88 2930.75,-20690.88 2927.25,-20700.88 2934.25,-20700.88"/>
</g>
<!-- layer34_moe_comm_to_expert4&#45;&gt;layer34_moe_expert4 -->
<g id="edge2093" class="edge">
<title>layer34_moe_comm_to_expert4&#45;&gt;layer34_moe_expert4</title>
<path fill="none" stroke="black" d="M2930.75,-20814.61C2930.75,-20801.98 2930.75,-20790 2930.75,-20790 2930.75,-20790 2642.16,-20790 2642.16,-20790 2642.16,-20790 2642.16,-20788.9 2642.16,-20788.9"/>
<polygon fill="black" stroke="black" points="2645.66,-20788.99 2642.16,-20778.99 2638.66,-20788.99 2645.66,-20788.99"/>
</g>
<!-- layer34_moe_expert5 -->
<g id="node1633" class="node">
<title>layer34_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="3020,-20778.63 2692,-20778.63 2692,-20726.63 3020,-20726.63 3020,-20778.63"/>
<text text-anchor="middle" x="2856" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 5 L34</text>
<text text-anchor="middle" x="2856" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2856" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2856" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert5 -->
<g id="node1661" class="node">
<title>layer34_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3163" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3163" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3163" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3163" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer34_moe_expert5&#45;&gt;layer34_moe_comm_from_expert5 -->
<g id="edge2126" class="edge">
<title>layer34_moe_expert5&#45;&gt;layer34_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M3020.12,-20743C3028.08,-20743 3032.84,-20743 3032.84,-20743 3032.84,-20743 3032.84,-20661 3032.84,-20661 3032.84,-20661 3062.24,-20661 3062.24,-20661"/>
<polygon fill="black" stroke="black" points="3062.24,-20664.5 3072.24,-20661 3062.24,-20657.5 3062.24,-20664.5"/>
</g>
<!-- layer34_moe_comm_to_expert5&#45;&gt;layer34_moe_expert5 -->
<g id="edge2095" class="edge">
<title>layer34_moe_comm_to_expert5&#45;&gt;layer34_moe_expert5</title>
<path fill="none" stroke="black" d="M3072.36,-20843C3047.71,-20843 3027.67,-20843 3027.67,-20843 3027.67,-20843 3027.67,-20761 3027.67,-20761 3027.67,-20761 3026.94,-20761 3026.94,-20761"/>
<polygon fill="black" stroke="black" points="3030.3,-20757.5 3020.3,-20761 3030.3,-20764.5 3030.3,-20757.5"/>
</g>
<!-- layer34_moe_expert6 -->
<g id="node1635" class="node">
<title>layer34_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3366,-20778.63 3038,-20778.63 3038,-20726.63 3366,-20726.63 3366,-20778.63"/>
<text text-anchor="middle" x="3202" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 6 L34</text>
<text text-anchor="middle" x="3202" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3202" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3202" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert6 -->
<g id="node1662" class="node">
<title>layer34_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3378" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3378" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3378" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3378" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer34_moe_expert6&#45;&gt;layer34_moe_comm_from_expert6 -->
<g id="edge2128" class="edge">
<title>layer34_moe_expert6&#45;&gt;layer34_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3326.75,-20726.31C3326.75,-20726.31 3326.75,-20695.72 3326.75,-20695.72"/>
<polygon fill="black" stroke="black" points="3330.25,-20695.72 3326.75,-20685.72 3323.25,-20695.72 3330.25,-20695.72"/>
</g>
<!-- layer34_moe_comm_to_expert6&#45;&gt;layer34_moe_expert6 -->
<g id="edge2097" class="edge">
<title>layer34_moe_comm_to_expert6&#45;&gt;layer34_moe_expert6</title>
<path fill="none" stroke="black" d="M3326.75,-20819.71C3326.75,-20819.71 3326.75,-20788.93 3326.75,-20788.93"/>
<polygon fill="black" stroke="black" points="3330.25,-20788.93 3326.75,-20778.93 3323.25,-20788.93 3330.25,-20788.93"/>
</g>
<!-- layer34_moe_expert7 -->
<g id="node1637" class="node">
<title>layer34_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3712,-20778.63 3384,-20778.63 3384,-20726.63 3712,-20726.63 3712,-20778.63"/>
<text text-anchor="middle" x="3548" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 7 L34</text>
<text text-anchor="middle" x="3548" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3548" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3548" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert7 -->
<g id="node1663" class="node">
<title>layer34_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3585" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3585" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3585" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3585" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer34_moe_expert7&#45;&gt;layer34_moe_comm_from_expert7 -->
<g id="edge2130" class="edge">
<title>layer34_moe_expert7&#45;&gt;layer34_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3585,-20726.31C3585,-20726.31 3585,-20700.76 3585,-20700.76"/>
<polygon fill="black" stroke="black" points="3588.5,-20700.76 3585,-20690.76 3581.5,-20700.76 3588.5,-20700.76"/>
</g>
<!-- layer34_moe_comm_to_expert7&#45;&gt;layer34_moe_expert7 -->
<g id="edge2099" class="edge">
<title>layer34_moe_comm_to_expert7&#45;&gt;layer34_moe_expert7</title>
<path fill="none" stroke="black" d="M3585,-20814.58C3585,-20814.58 3585,-20788.93 3585,-20788.93"/>
<polygon fill="black" stroke="black" points="3588.5,-20788.93 3585,-20778.93 3581.5,-20788.93 3588.5,-20788.93"/>
</g>
<!-- layer34_moe_expert8 -->
<g id="node1639" class="node">
<title>layer34_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4058,-20778.63 3730,-20778.63 3730,-20726.63 4058,-20726.63 4058,-20778.63"/>
<text text-anchor="middle" x="3894" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 8 L34</text>
<text text-anchor="middle" x="3894" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3894" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3894" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert8 -->
<g id="node1664" class="node">
<title>layer34_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3857" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3857" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3857" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3857" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer34_moe_expert8&#45;&gt;layer34_moe_comm_from_expert8 -->
<g id="edge2132" class="edge">
<title>layer34_moe_expert8&#45;&gt;layer34_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3857,-20726.31C3857,-20726.31 3857,-20700.76 3857,-20700.76"/>
<polygon fill="black" stroke="black" points="3860.5,-20700.76 3857,-20690.76 3853.5,-20700.76 3860.5,-20700.76"/>
</g>
<!-- layer34_moe_comm_to_expert8&#45;&gt;layer34_moe_expert8 -->
<g id="edge2101" class="edge">
<title>layer34_moe_comm_to_expert8&#45;&gt;layer34_moe_expert8</title>
<path fill="none" stroke="black" d="M3857,-20814.58C3857,-20814.58 3857,-20788.93 3857,-20788.93"/>
<polygon fill="black" stroke="black" points="3860.5,-20788.93 3857,-20778.93 3853.5,-20788.93 3860.5,-20788.93"/>
</g>
<!-- layer34_moe_expert9 -->
<g id="node1641" class="node">
<title>layer34_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4404,-20778.63 4076,-20778.63 4076,-20726.63 4404,-20726.63 4404,-20778.63"/>
<text text-anchor="middle" x="4240" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 9 L34</text>
<text text-anchor="middle" x="4240" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4240" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4240" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert9 -->
<g id="node1665" class="node">
<title>layer34_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4166" cy="-20661.63" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4166" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4166" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4166" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer34_moe_expert9&#45;&gt;layer34_moe_comm_from_expert9 -->
<g id="edge2134" class="edge">
<title>layer34_moe_expert9&#45;&gt;layer34_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4166.25,-20726.31C4166.25,-20726.31 4166.25,-20700.76 4166.25,-20700.76"/>
<polygon fill="black" stroke="black" points="4169.75,-20700.76 4166.25,-20690.76 4162.75,-20700.76 4169.75,-20700.76"/>
</g>
<!-- layer34_moe_comm_to_expert9&#45;&gt;layer34_moe_expert9 -->
<g id="edge2103" class="edge">
<title>layer34_moe_comm_to_expert9&#45;&gt;layer34_moe_expert9</title>
<path fill="none" stroke="black" d="M4166.25,-20814.58C4166.25,-20814.58 4166.25,-20788.93 4166.25,-20788.93"/>
<polygon fill="black" stroke="black" points="4169.75,-20788.93 4166.25,-20778.93 4162.75,-20788.93 4169.75,-20788.93"/>
</g>
<!-- layer34_moe_expert10 -->
<g id="node1643" class="node">
<title>layer34_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4760,-20778.63 4422,-20778.63 4422,-20726.63 4760,-20726.63 4760,-20778.63"/>
<text text-anchor="middle" x="4591" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 10 L34</text>
<text text-anchor="middle" x="4591" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4591" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4591" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert10 -->
<g id="node1666" class="node">
<title>layer34_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4498" cy="-20661.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4498" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4498" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4498" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer34_moe_expert10&#45;&gt;layer34_moe_comm_from_expert10 -->
<g id="edge2136" class="edge">
<title>layer34_moe_expert10&#45;&gt;layer34_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4507.38,-20726.31C4507.38,-20726.31 4507.38,-20700.76 4507.38,-20700.76"/>
<polygon fill="black" stroke="black" points="4510.88,-20700.76 4507.38,-20690.76 4503.88,-20700.76 4510.88,-20700.76"/>
</g>
<!-- layer34_moe_comm_to_expert10&#45;&gt;layer34_moe_expert10 -->
<g id="edge2105" class="edge">
<title>layer34_moe_comm_to_expert10&#45;&gt;layer34_moe_expert10</title>
<path fill="none" stroke="black" d="M4507.02,-20814.58C4507.02,-20814.58 4507.02,-20788.93 4507.02,-20788.93"/>
<polygon fill="black" stroke="black" points="4510.52,-20788.93 4507.02,-20778.93 4503.52,-20788.93 4510.52,-20788.93"/>
</g>
<!-- layer34_moe_expert11 -->
<g id="node1645" class="node">
<title>layer34_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5116,-20778.63 4778,-20778.63 4778,-20726.63 5116,-20726.63 5116,-20778.63"/>
<text text-anchor="middle" x="4947" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 11 L34</text>
<text text-anchor="middle" x="4947" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4947" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4947" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert11 -->
<g id="node1667" class="node">
<title>layer34_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4845" cy="-20661.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4845" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4845" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4845" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer34_moe_expert11&#45;&gt;layer34_moe_comm_from_expert11 -->
<g id="edge2138" class="edge">
<title>layer34_moe_expert11&#45;&gt;layer34_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4858.88,-20726.31C4858.88,-20726.31 4858.88,-20700.44 4858.88,-20700.44"/>
<polygon fill="black" stroke="black" points="4862.38,-20700.44 4858.88,-20690.44 4855.38,-20700.44 4862.38,-20700.44"/>
</g>
<!-- layer34_moe_comm_to_expert11&#45;&gt;layer34_moe_expert11 -->
<g id="edge2107" class="edge">
<title>layer34_moe_comm_to_expert11&#45;&gt;layer34_moe_expert11</title>
<path fill="none" stroke="black" d="M4858.02,-20814.83C4858.02,-20814.83 4858.02,-20788.76 4858.02,-20788.76"/>
<polygon fill="black" stroke="black" points="4861.52,-20788.76 4858.02,-20778.76 4854.52,-20788.76 4861.52,-20788.76"/>
</g>
<!-- layer34_moe_expert12 -->
<g id="node1647" class="node">
<title>layer34_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5472,-20778.63 5134,-20778.63 5134,-20726.63 5472,-20726.63 5472,-20778.63"/>
<text text-anchor="middle" x="5303" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 12 L34</text>
<text text-anchor="middle" x="5303" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5303" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5303" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert12 -->
<g id="node1668" class="node">
<title>layer34_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5196" cy="-20661.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5196" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5196" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5196" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer34_moe_expert12&#45;&gt;layer34_moe_comm_from_expert12 -->
<g id="edge2140" class="edge">
<title>layer34_moe_expert12&#45;&gt;layer34_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5212.38,-20726.31C5212.38,-20726.31 5212.38,-20700.44 5212.38,-20700.44"/>
<polygon fill="black" stroke="black" points="5215.88,-20700.44 5212.38,-20690.44 5208.88,-20700.44 5215.88,-20700.44"/>
</g>
<!-- layer34_moe_comm_to_expert12&#45;&gt;layer34_moe_expert12 -->
<g id="edge2109" class="edge">
<title>layer34_moe_comm_to_expert12&#45;&gt;layer34_moe_expert12</title>
<path fill="none" stroke="black" d="M5211.52,-20814.83C5211.52,-20814.83 5211.52,-20788.76 5211.52,-20788.76"/>
<polygon fill="black" stroke="black" points="5215.02,-20788.76 5211.52,-20778.76 5208.02,-20788.76 5215.02,-20788.76"/>
</g>
<!-- layer34_moe_expert13 -->
<g id="node1649" class="node">
<title>layer34_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5828,-20778.63 5490,-20778.63 5490,-20726.63 5828,-20726.63 5828,-20778.63"/>
<text text-anchor="middle" x="5659" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 13 L34</text>
<text text-anchor="middle" x="5659" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5659" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5659" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert13 -->
<g id="node1669" class="node">
<title>layer34_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5550" cy="-20661.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5550" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5550" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5550" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer34_moe_expert13&#45;&gt;layer34_moe_comm_from_expert13 -->
<g id="edge2142" class="edge">
<title>layer34_moe_expert13&#45;&gt;layer34_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5567.38,-20726.31C5567.38,-20726.31 5567.38,-20700.44 5567.38,-20700.44"/>
<polygon fill="black" stroke="black" points="5570.88,-20700.44 5567.38,-20690.44 5563.88,-20700.44 5570.88,-20700.44"/>
</g>
<!-- layer34_moe_comm_to_expert13&#45;&gt;layer34_moe_expert13 -->
<g id="edge2111" class="edge">
<title>layer34_moe_comm_to_expert13&#45;&gt;layer34_moe_expert13</title>
<path fill="none" stroke="black" d="M5566.02,-20814.83C5566.02,-20814.83 5566.02,-20788.76 5566.02,-20788.76"/>
<polygon fill="black" stroke="black" points="5569.52,-20788.76 5566.02,-20778.76 5562.52,-20788.76 5569.52,-20788.76"/>
</g>
<!-- layer34_moe_expert14 -->
<g id="node1651" class="node">
<title>layer34_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6184,-20778.63 5846,-20778.63 5846,-20726.63 6184,-20726.63 6184,-20778.63"/>
<text text-anchor="middle" x="6015" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 14 L34</text>
<text text-anchor="middle" x="6015" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="6015" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="6015" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert14 -->
<g id="node1670" class="node">
<title>layer34_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5905" cy="-20661.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5905" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5905" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5905" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer34_moe_expert14&#45;&gt;layer34_moe_comm_from_expert14 -->
<g id="edge2144" class="edge">
<title>layer34_moe_expert14&#45;&gt;layer34_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5922.88,-20726.31C5922.88,-20726.31 5922.88,-20700.12 5922.88,-20700.12"/>
<polygon fill="black" stroke="black" points="5926.38,-20700.12 5922.88,-20690.12 5919.38,-20700.12 5926.38,-20700.12"/>
</g>
<!-- layer34_moe_comm_to_expert14&#45;&gt;layer34_moe_expert14 -->
<g id="edge2113" class="edge">
<title>layer34_moe_comm_to_expert14&#45;&gt;layer34_moe_expert14</title>
<path fill="none" stroke="black" d="M5921.52,-20814.83C5921.52,-20814.83 5921.52,-20788.76 5921.52,-20788.76"/>
<polygon fill="black" stroke="black" points="5925.02,-20788.76 5921.52,-20778.76 5918.02,-20788.76 5925.02,-20788.76"/>
</g>
<!-- layer34_moe_expert15 -->
<g id="node1653" class="node">
<title>layer34_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6540,-20778.63 6202,-20778.63 6202,-20726.63 6540,-20726.63 6540,-20778.63"/>
<text text-anchor="middle" x="6371" y="-20766.63" font-family="Arial" font-size="10.00">EXPERT 15 L34</text>
<text text-anchor="middle" x="6371" y="-20755.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6371" y="-20744.63" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6371" y="-20733.63" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_comm_from_expert15 -->
<g id="node1671" class="node">
<title>layer34_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6260" cy="-20661.63" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6260" y="-20670.13" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6260" y="-20659.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6260" y="-20648.13" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer34_moe_expert15&#45;&gt;layer34_moe_comm_from_expert15 -->
<g id="edge2146" class="edge">
<title>layer34_moe_expert15&#45;&gt;layer34_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6278.38,-20726.31C6278.38,-20726.31 6278.38,-20700.12 6278.38,-20700.12"/>
<polygon fill="black" stroke="black" points="6281.88,-20700.12 6278.38,-20690.12 6274.88,-20700.12 6281.88,-20700.12"/>
</g>
<!-- layer34_moe_comm_to_expert15&#45;&gt;layer34_moe_expert15 -->
<g id="edge2115" class="edge">
<title>layer34_moe_comm_to_expert15&#45;&gt;layer34_moe_expert15</title>
<path fill="none" stroke="black" d="M6277.02,-20814.83C6277.02,-20814.83 6277.02,-20788.76 6277.02,-20788.76"/>
<polygon fill="black" stroke="black" points="6280.52,-20788.76 6277.02,-20778.76 6273.52,-20788.76 6280.52,-20788.76"/>
</g>
<!-- layer34_moe_aggregate -->
<g id="node1655" class="node">
<title>layer34_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3946.1,-20596.64 3529.16,-20596.64 3421.9,-20492.64 3838.84,-20492.64 3946.1,-20596.64"/>
<text text-anchor="middle" x="3684" y="-20558.64" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L34</text>
<text text-anchor="middle" x="3684" y="-20547.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3684" y="-20536.64" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3684" y="-20525.64" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_mha -->
<g id="node1672" class="node">
<title>layer35_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3814,-20456.64 3554,-20456.64 3554,-20404.64 3814,-20404.64 3814,-20456.64"/>
<text text-anchor="middle" x="3684" y="-20444.64" font-family="Arial" font-size="10.00">MHA L35</text>
<text text-anchor="middle" x="3684" y="-20433.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3684" y="-20422.64" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3684" y="-20411.64" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer34_moe_aggregate&#45;&gt;layer35_moe_mha -->
<g id="edge2215" class="edge">
<title>layer34_moe_aggregate&#45;&gt;layer35_moe_mha</title>
<path fill="none" stroke="black" d="M3684,-20492.31C3684,-20492.31 3684,-20466.87 3684,-20466.87"/>
<polygon fill="black" stroke="black" points="3687.5,-20466.87 3684,-20456.87 3680.5,-20466.87 3687.5,-20466.87"/>
</g>
<!-- layer34_moe_comm_from_expert0&#45;&gt;layer34_moe_aggregate -->
<g id="edge2117" class="edge">
<title>layer34_moe_comm_from_expert0&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M1213.5,-20635.75C1213.5,-20591.73 1213.5,-20507 1213.5,-20507 1213.5,-20507 3426.66,-20507 3426.66,-20507"/>
<polygon fill="black" stroke="black" points="3426.66,-20510.5 3436.66,-20507 3426.66,-20503.5 3426.66,-20510.5"/>
</g>
<!-- layer34_moe_comm_from_expert1&#45;&gt;layer34_moe_aggregate -->
<g id="edge2119" class="edge">
<title>layer34_moe_comm_from_expert1&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M1969.51,-20651.14C1969.51,-20618.67 1969.51,-20522 1969.51,-20522 1969.51,-20522 3441.88,-20522 3441.88,-20522"/>
<polygon fill="black" stroke="black" points="3441.88,-20525.5 3451.88,-20522 3441.88,-20518.5 3441.88,-20525.5"/>
</g>
<!-- layer34_moe_comm_from_expert2&#45;&gt;layer34_moe_aggregate -->
<g id="edge2121" class="edge">
<title>layer34_moe_comm_from_expert2&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M2370.25,-20633.97C2370.25,-20597.26 2370.25,-20537 2370.25,-20537 2370.25,-20537 3457.43,-20537 3457.43,-20537"/>
<polygon fill="black" stroke="black" points="3457.43,-20540.5 3467.43,-20537 3457.43,-20533.5 3457.43,-20540.5"/>
</g>
<!-- layer34_moe_comm_from_expert3&#45;&gt;layer34_moe_aggregate -->
<g id="edge2123" class="edge">
<title>layer34_moe_comm_from_expert3&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M2681.5,-20632.83C2681.5,-20600.35 2681.5,-20552 2681.5,-20552 2681.5,-20552 3472.94,-20552 3472.94,-20552"/>
<polygon fill="black" stroke="black" points="3472.94,-20555.5 3482.94,-20552 3472.94,-20548.5 3472.94,-20555.5"/>
</g>
<!-- layer34_moe_comm_from_expert4&#45;&gt;layer34_moe_aggregate -->
<g id="edge2125" class="edge">
<title>layer34_moe_comm_from_expert4&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M2986,-20637.99C2986,-20609.67 2986,-20566 2986,-20566 2986,-20566 3487.41,-20566 3487.41,-20566"/>
<polygon fill="black" stroke="black" points="3487.41,-20569.5 3497.41,-20566 3487.41,-20562.5 3487.41,-20569.5"/>
</g>
<!-- layer34_moe_comm_from_expert5&#45;&gt;layer34_moe_aggregate -->
<g id="edge2127" class="edge">
<title>layer34_moe_comm_from_expert5&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M3237.5,-20644.93C3237.5,-20621.31 3237.5,-20581 3237.5,-20581 3237.5,-20581 3502.97,-20581 3502.97,-20581"/>
<polygon fill="black" stroke="black" points="3502.97,-20584.5 3512.97,-20581 3502.97,-20577.5 3502.97,-20584.5"/>
</g>
<!-- layer34_moe_comm_from_expert6&#45;&gt;layer34_moe_aggregate -->
<g id="edge2129" class="edge">
<title>layer34_moe_comm_from_expert6&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M3445.11,-20642.05C3445.11,-20642.05 3445.11,-20554.69 3445.11,-20554.69"/>
<polygon fill="black" stroke="black" points="3448.61,-20554.69 3445.11,-20544.69 3441.61,-20554.69 3448.61,-20554.69"/>
</g>
<!-- layer34_moe_comm_from_expert7&#45;&gt;layer34_moe_aggregate -->
<g id="edge2131" class="edge">
<title>layer34_moe_comm_from_expert7&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M3585,-20632.41C3585,-20632.41 3585,-20606.7 3585,-20606.7"/>
<polygon fill="black" stroke="black" points="3588.5,-20606.7 3585,-20596.7 3581.5,-20606.7 3588.5,-20606.7"/>
</g>
<!-- layer34_moe_comm_from_expert8&#45;&gt;layer34_moe_aggregate -->
<g id="edge2133" class="edge">
<title>layer34_moe_comm_from_expert8&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M3856.39,-20632.41C3856.39,-20632.41 3856.39,-20606.7 3856.39,-20606.7"/>
<polygon fill="black" stroke="black" points="3859.89,-20606.7 3856.39,-20596.7 3852.89,-20606.7 3859.89,-20606.7"/>
</g>
<!-- layer34_moe_comm_from_expert9&#45;&gt;layer34_moe_aggregate -->
<g id="edge2135" class="edge">
<title>layer34_moe_comm_from_expert9&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M4147.5,-20633.25C4147.5,-20610.72 4147.5,-20583 4147.5,-20583 4147.5,-20583 3942.03,-20583 3942.03,-20583"/>
<polygon fill="black" stroke="black" points="3942.03,-20579.5 3932.03,-20583 3942.03,-20586.5 3942.03,-20579.5"/>
</g>
<!-- layer34_moe_comm_from_expert10&#45;&gt;layer34_moe_aggregate -->
<g id="edge2137" class="edge">
<title>layer34_moe_comm_from_expert10&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M4479.15,-20633.14C4479.15,-20606.24 4479.15,-20570 4479.15,-20570 4479.15,-20570 3928.81,-20570 3928.81,-20570"/>
<polygon fill="black" stroke="black" points="3928.81,-20566.5 3918.81,-20570 3928.81,-20573.5 3928.81,-20566.5"/>
</g>
<!-- layer34_moe_comm_from_expert11&#45;&gt;layer34_moe_aggregate -->
<g id="edge2139" class="edge">
<title>layer34_moe_comm_from_expert11&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M4825.65,-20633.04C4825.65,-20602.06 4825.65,-20557 4825.65,-20557 4825.65,-20557 3915.47,-20557 3915.47,-20557"/>
<polygon fill="black" stroke="black" points="3915.47,-20553.5 3905.47,-20557 3915.47,-20560.5 3915.47,-20553.5"/>
</g>
<!-- layer34_moe_comm_from_expert12&#45;&gt;layer34_moe_aggregate -->
<g id="edge2141" class="edge">
<title>layer34_moe_comm_from_expert12&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M5176.65,-20633.16C5176.65,-20598.34 5176.65,-20544 5176.65,-20544 5176.65,-20544 3901.94,-20544 3901.94,-20544"/>
<polygon fill="black" stroke="black" points="3901.94,-20540.5 3891.94,-20544 3901.94,-20547.5 3901.94,-20540.5"/>
</g>
<!-- layer34_moe_comm_from_expert13&#45;&gt;layer34_moe_aggregate -->
<g id="edge2143" class="edge">
<title>layer34_moe_comm_from_expert13&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M5530.15,-20632.97C5530.15,-20594.51 5530.15,-20531 5530.15,-20531 5530.15,-20531 3888.52,-20531 3888.52,-20531"/>
<polygon fill="black" stroke="black" points="3888.52,-20527.5 3878.52,-20531 3888.52,-20534.5 3888.52,-20527.5"/>
</g>
<!-- layer34_moe_comm_from_expert14&#45;&gt;layer34_moe_aggregate -->
<g id="edge2145" class="edge">
<title>layer34_moe_comm_from_expert14&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M5885.15,-20633.26C5885.15,-20591.4 5885.15,-20518 5885.15,-20518 5885.15,-20518 3875.06,-20518 3875.06,-20518"/>
<polygon fill="black" stroke="black" points="3875.06,-20514.5 3865.06,-20518 3875.06,-20521.5 3875.06,-20514.5"/>
</g>
<!-- layer34_moe_comm_from_expert15&#45;&gt;layer34_moe_aggregate -->
<g id="edge2147" class="edge">
<title>layer34_moe_comm_from_expert15&#45;&gt;layer34_moe_aggregate</title>
<path fill="none" stroke="black" d="M6240.15,-20633.27C6240.15,-20588.13 6240.15,-20505 6240.15,-20505 6240.15,-20505 3861.72,-20505 3861.72,-20505"/>
<polygon fill="black" stroke="black" points="3861.72,-20501.5 3851.72,-20505 3861.72,-20508.5 3861.72,-20501.5"/>
</g>
<!-- layer35_moe_gate -->
<g id="node1673" class="node">
<title>layer35_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3942.3,-20368.64 3531.4,-20368.64 3425.7,-20264.64 3836.6,-20264.64 3942.3,-20368.64"/>
<text text-anchor="middle" x="3684" y="-20330.64" font-family="Arial" font-size="10.00">GATE L35</text>
<text text-anchor="middle" x="3684" y="-20319.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3684" y="-20308.64" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3684" y="-20297.64" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer35_moe_mha&#45;&gt;layer35_moe_gate -->
<g id="edge2216" class="edge">
<title>layer35_moe_mha&#45;&gt;layer35_moe_gate</title>
<path fill="none" stroke="black" d="M3684,-20404.49C3684,-20404.49 3684,-20378.74 3684,-20378.74"/>
<polygon fill="black" stroke="black" points="3687.5,-20378.74 3684,-20368.74 3680.5,-20378.74 3687.5,-20378.74"/>
</g>
<!-- layer35_moe_split -->
<g id="node1674" class="node">
<title>layer35_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3938.01,-20228.64 3533.94,-20228.64 3429.99,-20124.64 3834.06,-20124.64 3938.01,-20228.64"/>
<text text-anchor="middle" x="3684" y="-20190.64" font-family="Arial" font-size="10.00">SPLIT TOKENS L35</text>
<text text-anchor="middle" x="3684" y="-20179.64" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3684" y="-20168.64" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3684" y="-20157.64" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer35_moe_gate&#45;&gt;layer35_moe_split -->
<g id="edge2217" class="edge">
<title>layer35_moe_gate&#45;&gt;layer35_moe_split</title>
<path fill="none" stroke="black" d="M3684,-20264.51C3684,-20264.51 3684,-20238.82 3684,-20238.82"/>
<polygon fill="black" stroke="black" points="3687.5,-20238.82 3684,-20228.82 3680.5,-20238.82 3687.5,-20238.82"/>
</g>
<!-- layer35_moe_comm_to_expert0 -->
<g id="node1676" class="node">
<title>layer35_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1255" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1255" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1255" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1255" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert0 -->
<g id="edge2151" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3518.24,-20213C2981.68,-20213 1326.75,-20213 1326.75,-20213 1326.75,-20213 1326.75,-20087.54 1326.75,-20087.54"/>
<polygon fill="black" stroke="black" points="1330.25,-20087.54 1326.75,-20077.54 1323.25,-20087.54 1330.25,-20087.54"/>
</g>
<!-- layer35_moe_comm_to_expert1 -->
<g id="node1678" class="node">
<title>layer35_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1601" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1601" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1601" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1601" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert1 -->
<g id="edge2153" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3503.3,-20198C3009.28,-20198 1672.75,-20198 1672.75,-20198 1672.75,-20198 1672.75,-20087.45 1672.75,-20087.45"/>
<polygon fill="black" stroke="black" points="1676.25,-20087.45 1672.75,-20077.45 1669.25,-20087.45 1676.25,-20087.45"/>
</g>
<!-- layer35_moe_comm_to_expert2 -->
<g id="node1680" class="node">
<title>layer35_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1873" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1873" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1873" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1873" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert2 -->
<g id="edge2155" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3489.12,-20184C3022.39,-20184 1879,-20184 1879,-20184 1879,-20184 1879,-20098.81 1879,-20098.81"/>
<polygon fill="black" stroke="black" points="1882.5,-20098.81 1879,-20088.81 1875.5,-20098.81 1882.5,-20098.81"/>
</g>
<!-- layer35_moe_comm_to_expert3 -->
<g id="node1682" class="node">
<title>layer35_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2201" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2201" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2201" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2201" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert3 -->
<g id="edge2157" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3473.99,-20169C3080.37,-20169 2271,-20169 2271,-20169 2271,-20169 2271,-20088.2 2271,-20088.2"/>
<polygon fill="black" stroke="black" points="2274.5,-20088.2 2271,-20078.2 2267.5,-20088.2 2274.5,-20088.2"/>
</g>
<!-- layer35_moe_comm_to_expert4 -->
<g id="node1684" class="node">
<title>layer35_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2694" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2694" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2694" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2694" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert4 -->
<g id="edge2159" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3459.15,-20154C3189.1,-20154 2772.01,-20154 2772.01,-20154 2772.01,-20154 2772.01,-20084.39 2772.01,-20084.39"/>
<polygon fill="black" stroke="black" points="2775.51,-20084.39 2772.01,-20074.39 2768.51,-20084.39 2775.51,-20084.39"/>
</g>
<!-- layer35_moe_comm_to_expert5 -->
<g id="node1686" class="node">
<title>layer35_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3040" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3040" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3040" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3040" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert5 -->
<g id="edge2161" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3444.13,-20139C3283.57,-20139 3101.5,-20139 3101.5,-20139 3101.5,-20139 3101.5,-20091.33 3101.5,-20091.33"/>
<polygon fill="black" stroke="black" points="3105,-20091.33 3101.5,-20081.33 3098,-20091.33 3105,-20091.33"/>
</g>
<!-- layer35_moe_comm_to_expert6 -->
<g id="node1688" class="node">
<title>layer35_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3312" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3312" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3312" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3312" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert6 -->
<g id="edge2163" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3443.74,-20176.56C3443.74,-20172.99 3443.74,-20059 3443.74,-20059 3443.74,-20059 3412.78,-20059 3412.78,-20059"/>
<polygon fill="black" stroke="black" points="3412.78,-20055.5 3402.78,-20059 3412.78,-20062.5 3412.78,-20055.5"/>
</g>
<!-- layer35_moe_comm_to_expert7 -->
<g id="node1690" class="node">
<title>layer35_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3548" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3548" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3548" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3548" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert7 -->
<g id="edge2165" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3548,-20124.31C3548,-20124.31 3548,-20098.86 3548,-20098.86"/>
<polygon fill="black" stroke="black" points="3551.5,-20098.86 3548,-20088.86 3544.5,-20098.86 3551.5,-20098.86"/>
</g>
<!-- layer35_moe_comm_to_expert8 -->
<g id="node1692" class="node">
<title>layer35_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3820" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3820" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3820" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3820" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert8 -->
<g id="edge2167" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3820,-20124.31C3820,-20124.31 3820,-20098.86 3820,-20098.86"/>
<polygon fill="black" stroke="black" points="3823.5,-20098.86 3820,-20088.86 3816.5,-20098.86 3823.5,-20098.86"/>
</g>
<!-- layer35_moe_comm_to_expert9 -->
<g id="node1694" class="node">
<title>layer35_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4129" cy="-20059.65" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4129" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4129" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4129" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert9 -->
<g id="edge2169" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3924.26,-20176.56C3924.26,-20172.99 3924.26,-20059 3924.26,-20059 3924.26,-20059 4028.3,-20059 4028.3,-20059"/>
<polygon fill="black" stroke="black" points="4028.3,-20062.5 4038.3,-20059 4028.3,-20055.5 4028.3,-20062.5"/>
</g>
<!-- layer35_moe_comm_to_expert10 -->
<g id="node1696" class="node">
<title>layer35_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4461" cy="-20059.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4461" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4461" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4461" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert10 -->
<g id="edge2171" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3848.82,-20139C4056.07,-20139 4385.1,-20139 4385.1,-20139 4385.1,-20139 4385.1,-20086.87 4385.1,-20086.87"/>
<polygon fill="black" stroke="black" points="4388.6,-20086.87 4385.1,-20076.87 4381.6,-20086.87 4388.6,-20086.87"/>
</g>
<!-- layer35_moe_comm_to_expert11 -->
<g id="node1698" class="node">
<title>layer35_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4807" cy="-20059.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4807" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4807" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4807" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert11 -->
<g id="edge2173" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.49,-20154C4162.86,-20154 4731.6,-20154 4731.6,-20154 4731.6,-20154 4731.6,-20087.4 4731.6,-20087.4"/>
<polygon fill="black" stroke="black" points="4735.1,-20087.4 4731.6,-20077.4 4728.1,-20087.4 4735.1,-20087.4"/>
</g>
<!-- layer35_moe_comm_to_expert12 -->
<g id="node1700" class="node">
<title>layer35_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5158" cy="-20059.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5158" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5158" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5158" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert12 -->
<g id="edge2175" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3878.47,-20169C4262.77,-20169 5082.6,-20169 5082.6,-20169 5082.6,-20169 5082.6,-20087.22 5082.6,-20087.22"/>
<polygon fill="black" stroke="black" points="5086.1,-20087.22 5082.6,-20077.22 5079.1,-20087.22 5086.1,-20087.22"/>
</g>
<!-- layer35_moe_comm_to_expert13 -->
<g id="node1702" class="node">
<title>layer35_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5511" cy="-20059.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5511" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5511" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5511" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert13 -->
<g id="edge2177" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3893.6,-20184C4358.67,-20184 5436.1,-20184 5436.1,-20184 5436.1,-20184 5436.1,-20087.2 5436.1,-20087.2"/>
<polygon fill="black" stroke="black" points="5439.6,-20087.2 5436.1,-20077.2 5432.6,-20087.2 5439.6,-20087.2"/>
</g>
<!-- layer35_moe_comm_to_expert14 -->
<g id="node1704" class="node">
<title>layer35_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5866" cy="-20059.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5866" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5866" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5866" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert14 -->
<g id="edge2179" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3907.5,-20198C4449.79,-20198 5791.1,-20198 5791.1,-20198 5791.1,-20198 5791.1,-20087.45 5791.1,-20087.45"/>
<polygon fill="black" stroke="black" points="5794.6,-20087.45 5791.1,-20077.45 5787.6,-20087.45 5794.6,-20087.45"/>
</g>
<!-- layer35_moe_comm_to_expert15 -->
<g id="node1706" class="node">
<title>layer35_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6221" cy="-20059.65" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6221" y="-20068.15" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6221" y="-20057.15" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6221" y="-20046.15" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert15 -->
<g id="edge2181" class="edge">
<title>layer35_moe_split&#45;&gt;layer35_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3922.59,-20213C4540.69,-20213 6146.1,-20213 6146.1,-20213 6146.1,-20213 6146.1,-20087.24 6146.1,-20087.24"/>
<polygon fill="black" stroke="black" points="6149.6,-20087.24 6146.1,-20077.24 6142.6,-20087.24 6149.6,-20087.24"/>
</g>
<!-- layer35_moe_expert0 -->
<g id="node1675" class="node">
<title>layer35_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1253,-19994.66 925,-19994.66 925,-19942.66 1253,-19942.66 1253,-19994.66"/>
<text text-anchor="middle" x="1089" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 0 L35</text>
<text text-anchor="middle" x="1089" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1089" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1089" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert0 -->
<g id="node1708" class="node">
<title>layer35_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1603" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1603" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1603" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1603" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer35_moe_expert0&#45;&gt;layer35_moe_comm_from_expert0 -->
<g id="edge2183" class="edge">
<title>layer35_moe_expert0&#45;&gt;layer35_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1243.5,-19942.64C1243.5,-19915.54 1243.5,-19877 1243.5,-19877 1243.5,-19877 1502.28,-19877 1502.28,-19877"/>
<polygon fill="black" stroke="black" points="1502.28,-19880.5 1512.28,-19877 1502.28,-19873.5 1502.28,-19880.5"/>
</g>
<!-- layer35_moe_comm_to_expert0&#45;&gt;layer35_moe_expert0 -->
<g id="edge2152" class="edge">
<title>layer35_moe_comm_to_expert0&#45;&gt;layer35_moe_expert0</title>
<path fill="none" stroke="black" d="M1208.75,-20034.3C1208.75,-20034.3 1208.75,-20004.82 1208.75,-20004.82"/>
<polygon fill="black" stroke="black" points="1212.25,-20004.82 1208.75,-19994.82 1205.25,-20004.82 1212.25,-20004.82"/>
</g>
<!-- layer35_moe_expert1 -->
<g id="node1677" class="node">
<title>layer35_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1599,-19994.66 1271,-19994.66 1271,-19942.66 1599,-19942.66 1599,-19994.66"/>
<text text-anchor="middle" x="1435" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 1 L35</text>
<text text-anchor="middle" x="1435" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1435" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1435" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert1 -->
<g id="node1709" class="node">
<title>layer35_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1848" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1848" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1848" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1848" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer35_moe_expert1&#45;&gt;layer35_moe_comm_from_expert1 -->
<g id="edge2185" class="edge">
<title>layer35_moe_expert1&#45;&gt;layer35_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1555.75,-19942.46C1555.75,-19928.84 1555.75,-19915 1555.75,-19915 1555.75,-19915 1848,-19915 1848,-19915 1848,-19915 1848,-19914.17 1848,-19914.17"/>
<polygon fill="black" stroke="black" points="1851.5,-19916.71 1848,-19906.71 1844.5,-19916.71 1851.5,-19916.71"/>
</g>
<!-- layer35_moe_comm_to_expert1&#45;&gt;layer35_moe_expert1 -->
<g id="edge2154" class="edge">
<title>layer35_moe_comm_to_expert1&#45;&gt;layer35_moe_expert1</title>
<path fill="none" stroke="black" d="M1554.75,-20034.3C1554.75,-20034.3 1554.75,-20004.82 1554.75,-20004.82"/>
<polygon fill="black" stroke="black" points="1558.25,-20004.82 1554.75,-19994.82 1551.25,-20004.82 1558.25,-20004.82"/>
</g>
<!-- layer35_moe_expert2 -->
<g id="node1679" class="node">
<title>layer35_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1945,-19994.66 1617,-19994.66 1617,-19942.66 1945,-19942.66 1945,-19994.66"/>
<text text-anchor="middle" x="1781" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 2 L35</text>
<text text-anchor="middle" x="1781" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1781" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1781" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert2 -->
<g id="node1710" class="node">
<title>layer35_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2304" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2304" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2304" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2304" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer35_moe_expert2&#45;&gt;layer35_moe_comm_from_expert2 -->
<g id="edge2187" class="edge">
<title>layer35_moe_expert2&#45;&gt;layer35_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1945.18,-19968C1950.77,-19968 1954,-19968 1954,-19968 1954,-19968 1954,-19877 1954,-19877 1954,-19877 2203.41,-19877 2203.41,-19877"/>
<polygon fill="black" stroke="black" points="2203.41,-19880.5 2213.41,-19877 2203.41,-19873.5 2203.41,-19880.5"/>
</g>
<!-- layer35_moe_comm_to_expert2&#45;&gt;layer35_moe_expert2 -->
<g id="edge2156" class="edge">
<title>layer35_moe_comm_to_expert2&#45;&gt;layer35_moe_expert2</title>
<path fill="none" stroke="black" d="M1863.75,-20030.61C1863.75,-20030.61 1863.75,-20004.96 1863.75,-20004.96"/>
<polygon fill="black" stroke="black" points="1867.25,-20004.96 1863.75,-19994.96 1860.25,-20004.96 1867.25,-20004.96"/>
</g>
<!-- layer35_moe_expert3 -->
<g id="node1681" class="node">
<title>layer35_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2291,-19994.66 1963,-19994.66 1963,-19942.66 2291,-19942.66 2291,-19994.66"/>
<text text-anchor="middle" x="2127" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 3 L35</text>
<text text-anchor="middle" x="2127" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2127" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2127" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert3 -->
<g id="node1711" class="node">
<title>layer35_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2632" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2632" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2632" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2632" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer35_moe_expert3&#45;&gt;layer35_moe_comm_from_expert3 -->
<g id="edge2189" class="edge">
<title>layer35_moe_expert3&#45;&gt;layer35_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2252.25,-19942.42C2252.25,-19932.7 2252.25,-19924 2252.25,-19924 2252.25,-19924 2573.33,-19924 2573.33,-19924 2573.33,-19924 2573.33,-19909.75 2573.33,-19909.75"/>
<polygon fill="black" stroke="black" points="2576.83,-19909.75 2573.33,-19899.75 2569.83,-19909.75 2576.83,-19909.75"/>
</g>
<!-- layer35_moe_comm_to_expert3&#45;&gt;layer35_moe_expert3 -->
<g id="edge2158" class="edge">
<title>layer35_moe_comm_to_expert3&#45;&gt;layer35_moe_expert3</title>
<path fill="none" stroke="black" d="M2200.75,-20030.61C2200.75,-20030.61 2200.75,-20004.96 2200.75,-20004.96"/>
<polygon fill="black" stroke="black" points="2204.25,-20004.96 2200.75,-19994.96 2197.25,-20004.96 2204.25,-20004.96"/>
</g>
<!-- layer35_moe_expert4 -->
<g id="node1683" class="node">
<title>layer35_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2637,-19994.66 2309,-19994.66 2309,-19942.66 2637,-19942.66 2637,-19994.66"/>
<text text-anchor="middle" x="2473" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 4 L35</text>
<text text-anchor="middle" x="2473" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2473" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2473" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert4 -->
<g id="node1712" class="node">
<title>layer35_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2895" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2895" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2895" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2895" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer35_moe_expert4&#45;&gt;layer35_moe_comm_from_expert4 -->
<g id="edge2191" class="edge">
<title>layer35_moe_expert4&#45;&gt;layer35_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2605.16,-19942.37C2605.16,-19937.02 2605.16,-19933 2605.16,-19933 2605.16,-19933 2893.75,-19933 2893.75,-19933 2893.75,-19933 2893.75,-19916.95 2893.75,-19916.95"/>
<polygon fill="black" stroke="black" points="2897.25,-19916.95 2893.75,-19906.95 2890.25,-19916.95 2897.25,-19916.95"/>
</g>
<!-- layer35_moe_comm_to_expert4&#45;&gt;layer35_moe_expert4 -->
<g id="edge2160" class="edge">
<title>layer35_moe_comm_to_expert4&#45;&gt;layer35_moe_expert4</title>
<path fill="none" stroke="black" d="M2620.25,-20042.54C2620.25,-20042.54 2620.25,-20005 2620.25,-20005"/>
<polygon fill="black" stroke="black" points="2623.75,-20005 2620.25,-19995 2616.75,-20005 2623.75,-20005"/>
</g>
<!-- layer35_moe_expert5 -->
<g id="node1685" class="node">
<title>layer35_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2983,-19994.66 2655,-19994.66 2655,-19942.66 2983,-19942.66 2983,-19994.66"/>
<text text-anchor="middle" x="2819" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 5 L35</text>
<text text-anchor="middle" x="2819" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2819" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2819" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert5 -->
<g id="node1713" class="node">
<title>layer35_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3126" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3126" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3126" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3126" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer35_moe_expert5&#45;&gt;layer35_moe_comm_from_expert5 -->
<g id="edge2193" class="edge">
<title>layer35_moe_expert5&#45;&gt;layer35_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2983.18,-19968C2988.77,-19968 2992,-19968 2992,-19968 2992,-19968 2992,-19877 2992,-19877 2992,-19877 3025.51,-19877 3025.51,-19877"/>
<polygon fill="black" stroke="black" points="3025.51,-19880.5 3035.51,-19877 3025.51,-19873.5 3025.51,-19880.5"/>
</g>
<!-- layer35_moe_comm_to_expert5&#45;&gt;layer35_moe_expert5 -->
<g id="edge2162" class="edge">
<title>layer35_moe_comm_to_expert5&#45;&gt;layer35_moe_expert5</title>
<path fill="none" stroke="black" d="M2966.25,-20042.54C2966.25,-20042.54 2966.25,-20005 2966.25,-20005"/>
<polygon fill="black" stroke="black" points="2969.75,-20005 2966.25,-19995 2962.75,-20005 2969.75,-20005"/>
</g>
<!-- layer35_moe_expert6 -->
<g id="node1687" class="node">
<title>layer35_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3329,-19994.66 3001,-19994.66 3001,-19942.66 3329,-19942.66 3329,-19994.66"/>
<text text-anchor="middle" x="3165" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 6 L35</text>
<text text-anchor="middle" x="3165" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3165" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3165" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert6 -->
<g id="node1714" class="node">
<title>layer35_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3341" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3341" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3341" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3341" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer35_moe_expert6&#45;&gt;layer35_moe_comm_from_expert6 -->
<g id="edge2195" class="edge">
<title>layer35_moe_expert6&#45;&gt;layer35_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3289.75,-19942.34C3289.75,-19942.34 3289.75,-19911.75 3289.75,-19911.75"/>
<polygon fill="black" stroke="black" points="3293.25,-19911.75 3289.75,-19901.75 3286.25,-19911.75 3293.25,-19911.75"/>
</g>
<!-- layer35_moe_comm_to_expert6&#45;&gt;layer35_moe_expert6 -->
<g id="edge2164" class="edge">
<title>layer35_moe_comm_to_expert6&#45;&gt;layer35_moe_expert6</title>
<path fill="none" stroke="black" d="M3275.25,-20032.84C3275.25,-20032.84 3275.25,-20004.96 3275.25,-20004.96"/>
<polygon fill="black" stroke="black" points="3278.75,-20004.96 3275.25,-19994.96 3271.75,-20004.96 3278.75,-20004.96"/>
</g>
<!-- layer35_moe_expert7 -->
<g id="node1689" class="node">
<title>layer35_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3675,-19994.66 3347,-19994.66 3347,-19942.66 3675,-19942.66 3675,-19994.66"/>
<text text-anchor="middle" x="3511" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 7 L35</text>
<text text-anchor="middle" x="3511" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3511" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3511" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert7 -->
<g id="node1715" class="node">
<title>layer35_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3548" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3548" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3548" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3548" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer35_moe_expert7&#45;&gt;layer35_moe_comm_from_expert7 -->
<g id="edge2197" class="edge">
<title>layer35_moe_expert7&#45;&gt;layer35_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3548,-19942.34C3548,-19942.34 3548,-19916.8 3548,-19916.8"/>
<polygon fill="black" stroke="black" points="3551.5,-19916.8 3548,-19906.8 3544.5,-19916.8 3551.5,-19916.8"/>
</g>
<!-- layer35_moe_comm_to_expert7&#45;&gt;layer35_moe_expert7 -->
<g id="edge2166" class="edge">
<title>layer35_moe_comm_to_expert7&#45;&gt;layer35_moe_expert7</title>
<path fill="none" stroke="black" d="M3548,-20030.61C3548,-20030.61 3548,-20004.96 3548,-20004.96"/>
<polygon fill="black" stroke="black" points="3551.5,-20004.96 3548,-19994.96 3544.5,-20004.96 3551.5,-20004.96"/>
</g>
<!-- layer35_moe_expert8 -->
<g id="node1691" class="node">
<title>layer35_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="4021,-19994.66 3693,-19994.66 3693,-19942.66 4021,-19942.66 4021,-19994.66"/>
<text text-anchor="middle" x="3857" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 8 L35</text>
<text text-anchor="middle" x="3857" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3857" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3857" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert8 -->
<g id="node1716" class="node">
<title>layer35_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3820" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3820" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3820" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3820" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer35_moe_expert8&#45;&gt;layer35_moe_comm_from_expert8 -->
<g id="edge2199" class="edge">
<title>layer35_moe_expert8&#45;&gt;layer35_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3820,-19942.34C3820,-19942.34 3820,-19916.8 3820,-19916.8"/>
<polygon fill="black" stroke="black" points="3823.5,-19916.8 3820,-19906.8 3816.5,-19916.8 3823.5,-19916.8"/>
</g>
<!-- layer35_moe_comm_to_expert8&#45;&gt;layer35_moe_expert8 -->
<g id="edge2168" class="edge">
<title>layer35_moe_comm_to_expert8&#45;&gt;layer35_moe_expert8</title>
<path fill="none" stroke="black" d="M3820,-20030.61C3820,-20030.61 3820,-20004.96 3820,-20004.96"/>
<polygon fill="black" stroke="black" points="3823.5,-20004.96 3820,-19994.96 3816.5,-20004.96 3823.5,-20004.96"/>
</g>
<!-- layer35_moe_expert9 -->
<g id="node1693" class="node">
<title>layer35_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4367,-19994.66 4039,-19994.66 4039,-19942.66 4367,-19942.66 4367,-19994.66"/>
<text text-anchor="middle" x="4203" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 9 L35</text>
<text text-anchor="middle" x="4203" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4203" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4203" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert9 -->
<g id="node1717" class="node">
<title>layer35_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4129" cy="-19877.67" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4129" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4129" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4129" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer35_moe_expert9&#45;&gt;layer35_moe_comm_from_expert9 -->
<g id="edge2201" class="edge">
<title>layer35_moe_expert9&#45;&gt;layer35_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4129.25,-19942.34C4129.25,-19942.34 4129.25,-19916.8 4129.25,-19916.8"/>
<polygon fill="black" stroke="black" points="4132.75,-19916.8 4129.25,-19906.8 4125.75,-19916.8 4132.75,-19916.8"/>
</g>
<!-- layer35_moe_comm_to_expert9&#45;&gt;layer35_moe_expert9 -->
<g id="edge2170" class="edge">
<title>layer35_moe_comm_to_expert9&#45;&gt;layer35_moe_expert9</title>
<path fill="none" stroke="black" d="M4129.25,-20030.61C4129.25,-20030.61 4129.25,-20004.96 4129.25,-20004.96"/>
<polygon fill="black" stroke="black" points="4132.75,-20004.96 4129.25,-19994.96 4125.75,-20004.96 4132.75,-20004.96"/>
</g>
<!-- layer35_moe_expert10 -->
<g id="node1695" class="node">
<title>layer35_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4723,-19994.66 4385,-19994.66 4385,-19942.66 4723,-19942.66 4723,-19994.66"/>
<text text-anchor="middle" x="4554" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 10 L35</text>
<text text-anchor="middle" x="4554" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4554" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4554" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert10 -->
<g id="node1718" class="node">
<title>layer35_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4461" cy="-19877.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4461" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4461" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4461" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer35_moe_expert10&#45;&gt;layer35_moe_comm_from_expert10 -->
<g id="edge2203" class="edge">
<title>layer35_moe_expert10&#45;&gt;layer35_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4470.38,-19942.34C4470.38,-19942.34 4470.38,-19916.8 4470.38,-19916.8"/>
<polygon fill="black" stroke="black" points="4473.88,-19916.8 4470.38,-19906.8 4466.88,-19916.8 4473.88,-19916.8"/>
</g>
<!-- layer35_moe_comm_to_expert10&#45;&gt;layer35_moe_expert10 -->
<g id="edge2172" class="edge">
<title>layer35_moe_comm_to_expert10&#45;&gt;layer35_moe_expert10</title>
<path fill="none" stroke="black" d="M4470.02,-20030.61C4470.02,-20030.61 4470.02,-20004.96 4470.02,-20004.96"/>
<polygon fill="black" stroke="black" points="4473.52,-20004.96 4470.02,-19994.96 4466.52,-20004.96 4473.52,-20004.96"/>
</g>
<!-- layer35_moe_expert11 -->
<g id="node1697" class="node">
<title>layer35_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5079,-19994.66 4741,-19994.66 4741,-19942.66 5079,-19942.66 5079,-19994.66"/>
<text text-anchor="middle" x="4910" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 11 L35</text>
<text text-anchor="middle" x="4910" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4910" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4910" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert11 -->
<g id="node1719" class="node">
<title>layer35_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4808" cy="-19877.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4808" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4808" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4808" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer35_moe_expert11&#45;&gt;layer35_moe_comm_from_expert11 -->
<g id="edge2205" class="edge">
<title>layer35_moe_expert11&#45;&gt;layer35_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4821.88,-19942.34C4821.88,-19942.34 4821.88,-19916.48 4821.88,-19916.48"/>
<polygon fill="black" stroke="black" points="4825.38,-19916.48 4821.88,-19906.48 4818.38,-19916.48 4825.38,-19916.48"/>
</g>
<!-- layer35_moe_comm_to_expert11&#45;&gt;layer35_moe_expert11 -->
<g id="edge2174" class="edge">
<title>layer35_moe_comm_to_expert11&#45;&gt;layer35_moe_expert11</title>
<path fill="none" stroke="black" d="M4821.02,-20030.86C4821.02,-20030.86 4821.02,-20004.8 4821.02,-20004.8"/>
<polygon fill="black" stroke="black" points="4824.52,-20004.8 4821.02,-19994.8 4817.52,-20004.8 4824.52,-20004.8"/>
</g>
<!-- layer35_moe_expert12 -->
<g id="node1699" class="node">
<title>layer35_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5435,-19994.66 5097,-19994.66 5097,-19942.66 5435,-19942.66 5435,-19994.66"/>
<text text-anchor="middle" x="5266" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 12 L35</text>
<text text-anchor="middle" x="5266" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5266" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5266" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert12 -->
<g id="node1720" class="node">
<title>layer35_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5159" cy="-19877.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5159" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5159" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5159" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer35_moe_expert12&#45;&gt;layer35_moe_comm_from_expert12 -->
<g id="edge2207" class="edge">
<title>layer35_moe_expert12&#45;&gt;layer35_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5175.38,-19942.34C5175.38,-19942.34 5175.38,-19916.48 5175.38,-19916.48"/>
<polygon fill="black" stroke="black" points="5178.88,-19916.48 5175.38,-19906.48 5171.88,-19916.48 5178.88,-19916.48"/>
</g>
<!-- layer35_moe_comm_to_expert12&#45;&gt;layer35_moe_expert12 -->
<g id="edge2176" class="edge">
<title>layer35_moe_comm_to_expert12&#45;&gt;layer35_moe_expert12</title>
<path fill="none" stroke="black" d="M5174.52,-20030.86C5174.52,-20030.86 5174.52,-20004.8 5174.52,-20004.8"/>
<polygon fill="black" stroke="black" points="5178.02,-20004.8 5174.52,-19994.8 5171.02,-20004.8 5178.02,-20004.8"/>
</g>
<!-- layer35_moe_expert13 -->
<g id="node1701" class="node">
<title>layer35_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5791,-19994.66 5453,-19994.66 5453,-19942.66 5791,-19942.66 5791,-19994.66"/>
<text text-anchor="middle" x="5622" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 13 L35</text>
<text text-anchor="middle" x="5622" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5622" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5622" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert13 -->
<g id="node1721" class="node">
<title>layer35_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5513" cy="-19877.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5513" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5513" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5513" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer35_moe_expert13&#45;&gt;layer35_moe_comm_from_expert13 -->
<g id="edge2209" class="edge">
<title>layer35_moe_expert13&#45;&gt;layer35_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5530.38,-19942.34C5530.38,-19942.34 5530.38,-19916.48 5530.38,-19916.48"/>
<polygon fill="black" stroke="black" points="5533.88,-19916.48 5530.38,-19906.48 5526.88,-19916.48 5533.88,-19916.48"/>
</g>
<!-- layer35_moe_comm_to_expert13&#45;&gt;layer35_moe_expert13 -->
<g id="edge2178" class="edge">
<title>layer35_moe_comm_to_expert13&#45;&gt;layer35_moe_expert13</title>
<path fill="none" stroke="black" d="M5529.02,-20030.86C5529.02,-20030.86 5529.02,-20004.8 5529.02,-20004.8"/>
<polygon fill="black" stroke="black" points="5532.52,-20004.8 5529.02,-19994.8 5525.52,-20004.8 5532.52,-20004.8"/>
</g>
<!-- layer35_moe_expert14 -->
<g id="node1703" class="node">
<title>layer35_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6147,-19994.66 5809,-19994.66 5809,-19942.66 6147,-19942.66 6147,-19994.66"/>
<text text-anchor="middle" x="5978" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 14 L35</text>
<text text-anchor="middle" x="5978" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5978" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5978" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert14 -->
<g id="node1722" class="node">
<title>layer35_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5868" cy="-19877.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5868" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5868" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5868" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer35_moe_expert14&#45;&gt;layer35_moe_comm_from_expert14 -->
<g id="edge2211" class="edge">
<title>layer35_moe_expert14&#45;&gt;layer35_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5885.88,-19942.34C5885.88,-19942.34 5885.88,-19916.15 5885.88,-19916.15"/>
<polygon fill="black" stroke="black" points="5889.38,-19916.15 5885.88,-19906.15 5882.38,-19916.15 5889.38,-19916.15"/>
</g>
<!-- layer35_moe_comm_to_expert14&#45;&gt;layer35_moe_expert14 -->
<g id="edge2180" class="edge">
<title>layer35_moe_comm_to_expert14&#45;&gt;layer35_moe_expert14</title>
<path fill="none" stroke="black" d="M5884.52,-20030.86C5884.52,-20030.86 5884.52,-20004.8 5884.52,-20004.8"/>
<polygon fill="black" stroke="black" points="5888.02,-20004.8 5884.52,-19994.8 5881.02,-20004.8 5888.02,-20004.8"/>
</g>
<!-- layer35_moe_expert15 -->
<g id="node1705" class="node">
<title>layer35_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6503,-19994.66 6165,-19994.66 6165,-19942.66 6503,-19942.66 6503,-19994.66"/>
<text text-anchor="middle" x="6334" y="-19982.66" font-family="Arial" font-size="10.00">EXPERT 15 L35</text>
<text text-anchor="middle" x="6334" y="-19971.66" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6334" y="-19960.66" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6334" y="-19949.66" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_comm_from_expert15 -->
<g id="node1723" class="node">
<title>layer35_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6223" cy="-19877.67" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6223" y="-19886.17" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6223" y="-19875.17" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6223" y="-19864.17" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer35_moe_expert15&#45;&gt;layer35_moe_comm_from_expert15 -->
<g id="edge2213" class="edge">
<title>layer35_moe_expert15&#45;&gt;layer35_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6241.38,-19942.34C6241.38,-19942.34 6241.38,-19916.15 6241.38,-19916.15"/>
<polygon fill="black" stroke="black" points="6244.88,-19916.15 6241.38,-19906.15 6237.88,-19916.15 6244.88,-19916.15"/>
</g>
<!-- layer35_moe_comm_to_expert15&#45;&gt;layer35_moe_expert15 -->
<g id="edge2182" class="edge">
<title>layer35_moe_comm_to_expert15&#45;&gt;layer35_moe_expert15</title>
<path fill="none" stroke="black" d="M6240.02,-20030.86C6240.02,-20030.86 6240.02,-20004.8 6240.02,-20004.8"/>
<polygon fill="black" stroke="black" points="6243.52,-20004.8 6240.02,-19994.8 6236.52,-20004.8 6243.52,-20004.8"/>
</g>
<!-- layer35_moe_aggregate -->
<g id="node1707" class="node">
<title>layer35_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3909.1,-19812.68 3492.16,-19812.68 3384.9,-19708.68 3801.84,-19708.68 3909.1,-19812.68"/>
<text text-anchor="middle" x="3647" y="-19774.68" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L35</text>
<text text-anchor="middle" x="3647" y="-19763.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3647" y="-19752.68" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3647" y="-19741.68" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_mha -->
<g id="node1724" class="node">
<title>layer36_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3777,-19672.68 3517,-19672.68 3517,-19620.68 3777,-19620.68 3777,-19672.68"/>
<text text-anchor="middle" x="3647" y="-19660.68" font-family="Arial" font-size="10.00">MHA L36</text>
<text text-anchor="middle" x="3647" y="-19649.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3647" y="-19638.68" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3647" y="-19627.68" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer35_moe_aggregate&#45;&gt;layer36_moe_mha -->
<g id="edge2282" class="edge">
<title>layer35_moe_aggregate&#45;&gt;layer36_moe_mha</title>
<path fill="none" stroke="black" d="M3647,-19708.35C3647,-19708.35 3647,-19682.9 3647,-19682.9"/>
<polygon fill="black" stroke="black" points="3650.5,-19682.9 3647,-19672.9 3643.5,-19682.9 3650.5,-19682.9"/>
</g>
<!-- layer35_moe_comm_from_expert0&#45;&gt;layer35_moe_aggregate -->
<g id="edge2184" class="edge">
<title>layer35_moe_comm_from_expert0&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M1636.75,-19850.73C1636.75,-19806.41 1636.75,-19723 1636.75,-19723 1636.75,-19723 3389.5,-19723 3389.5,-19723"/>
<polygon fill="black" stroke="black" points="3389.5,-19726.5 3399.5,-19723 3389.5,-19719.5 3389.5,-19726.5"/>
</g>
<!-- layer35_moe_comm_from_expert1&#45;&gt;layer35_moe_aggregate -->
<g id="edge2186" class="edge">
<title>layer35_moe_comm_from_expert1&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M1932.25,-19866.71C1932.25,-19833.78 1932.25,-19738 1932.25,-19738 1932.25,-19738 3404.85,-19738 3404.85,-19738"/>
<polygon fill="black" stroke="black" points="3404.85,-19741.5 3414.85,-19738 3404.85,-19734.5 3404.85,-19741.5"/>
</g>
<!-- layer35_moe_comm_from_expert2&#45;&gt;layer35_moe_aggregate -->
<g id="edge2188" class="edge">
<title>layer35_moe_comm_from_expert2&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M2376.01,-19860.07C2376.01,-19825.71 2376.01,-19753 2376.01,-19753 2376.01,-19753 3420.31,-19753 3420.31,-19753"/>
<polygon fill="black" stroke="black" points="3420.31,-19756.5 3430.31,-19753 3420.31,-19749.5 3420.31,-19756.5"/>
</g>
<!-- layer35_moe_comm_from_expert3&#45;&gt;layer35_moe_aggregate -->
<g id="edge2190" class="edge">
<title>layer35_moe_comm_from_expert3&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M2704.01,-19860.05C2704.01,-19829.05 2704.01,-19768 2704.01,-19768 2704.01,-19768 3435.86,-19768 3435.86,-19768"/>
<polygon fill="black" stroke="black" points="3435.86,-19771.5 3445.86,-19768 3435.86,-19764.5 3435.86,-19771.5"/>
</g>
<!-- layer35_moe_comm_from_expert4&#45;&gt;layer35_moe_aggregate -->
<g id="edge2192" class="edge">
<title>layer35_moe_comm_from_expert4&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M2974.75,-19863.96C2974.75,-19837.51 2974.75,-19782 2974.75,-19782 2974.75,-19782 3450.19,-19782 3450.19,-19782"/>
<polygon fill="black" stroke="black" points="3450.19,-19785.5 3460.19,-19782 3450.19,-19778.5 3450.19,-19785.5"/>
</g>
<!-- layer35_moe_comm_from_expert5&#45;&gt;layer35_moe_aggregate -->
<g id="edge2194" class="edge">
<title>layer35_moe_comm_from_expert5&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M3196.5,-19859.36C3196.5,-19835.56 3196.5,-19797 3196.5,-19797 3196.5,-19797 3465.72,-19797 3465.72,-19797"/>
<polygon fill="black" stroke="black" points="3465.72,-19800.5 3475.72,-19797 3465.72,-19793.5 3465.72,-19800.5"/>
</g>
<!-- layer35_moe_comm_from_expert6&#45;&gt;layer35_moe_aggregate -->
<g id="edge2196" class="edge">
<title>layer35_moe_comm_from_expert6&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M3408.11,-19858.09C3408.11,-19858.09 3408.11,-19770.72 3408.11,-19770.72"/>
<polygon fill="black" stroke="black" points="3411.61,-19770.72 3408.11,-19760.72 3404.61,-19770.72 3411.61,-19770.72"/>
</g>
<!-- layer35_moe_comm_from_expert7&#45;&gt;layer35_moe_aggregate -->
<g id="edge2198" class="edge">
<title>layer35_moe_comm_from_expert7&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M3548,-19848.45C3548,-19848.45 3548,-19822.74 3548,-19822.74"/>
<polygon fill="black" stroke="black" points="3551.5,-19822.74 3548,-19812.74 3544.5,-19822.74 3551.5,-19822.74"/>
</g>
<!-- layer35_moe_comm_from_expert8&#45;&gt;layer35_moe_aggregate -->
<g id="edge2200" class="edge">
<title>layer35_moe_comm_from_expert8&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M3819.39,-19848.45C3819.39,-19848.45 3819.39,-19822.74 3819.39,-19822.74"/>
<polygon fill="black" stroke="black" points="3822.89,-19822.74 3819.39,-19812.74 3815.89,-19822.74 3822.89,-19822.74"/>
</g>
<!-- layer35_moe_comm_from_expert9&#45;&gt;layer35_moe_aggregate -->
<g id="edge2202" class="edge">
<title>layer35_moe_comm_from_expert9&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M4110.5,-19849.27C4110.5,-19826.73 4110.5,-19799 4110.5,-19799 4110.5,-19799 3905.03,-19799 3905.03,-19799"/>
<polygon fill="black" stroke="black" points="3905.03,-19795.5 3895.03,-19799 3905.03,-19802.5 3905.03,-19795.5"/>
</g>
<!-- layer35_moe_comm_from_expert10&#45;&gt;layer35_moe_aggregate -->
<g id="edge2204" class="edge">
<title>layer35_moe_comm_from_expert10&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M4442.15,-19849.17C4442.15,-19822.26 4442.15,-19786 4442.15,-19786 4442.15,-19786 3891.81,-19786 3891.81,-19786"/>
<polygon fill="black" stroke="black" points="3891.81,-19782.5 3881.81,-19786 3891.81,-19789.5 3891.81,-19782.5"/>
</g>
<!-- layer35_moe_comm_from_expert11&#45;&gt;layer35_moe_aggregate -->
<g id="edge2206" class="edge">
<title>layer35_moe_comm_from_expert11&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M4788.65,-19849.07C4788.65,-19818.08 4788.65,-19773 4788.65,-19773 4788.65,-19773 3878.47,-19773 3878.47,-19773"/>
<polygon fill="black" stroke="black" points="3878.47,-19769.5 3868.47,-19773 3878.47,-19776.5 3878.47,-19769.5"/>
</g>
<!-- layer35_moe_comm_from_expert12&#45;&gt;layer35_moe_aggregate -->
<g id="edge2208" class="edge">
<title>layer35_moe_comm_from_expert12&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M5139.65,-19849.18C5139.65,-19814.36 5139.65,-19760 5139.65,-19760 5139.65,-19760 3864.94,-19760 3864.94,-19760"/>
<polygon fill="black" stroke="black" points="3864.94,-19756.5 3854.94,-19760 3864.94,-19763.5 3864.94,-19756.5"/>
</g>
<!-- layer35_moe_comm_from_expert13&#45;&gt;layer35_moe_aggregate -->
<g id="edge2210" class="edge">
<title>layer35_moe_comm_from_expert13&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M5493.15,-19849.32C5493.15,-19810.88 5493.15,-19747 5493.15,-19747 5493.15,-19747 3851.52,-19747 3851.52,-19747"/>
<polygon fill="black" stroke="black" points="3851.52,-19743.5 3841.52,-19747 3851.52,-19750.5 3851.52,-19743.5"/>
</g>
<!-- layer35_moe_comm_from_expert14&#45;&gt;layer35_moe_aggregate -->
<g id="edge2212" class="edge">
<title>layer35_moe_comm_from_expert14&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M5848.15,-19849.28C5848.15,-19807.41 5848.15,-19734 5848.15,-19734 5848.15,-19734 3838.06,-19734 3838.06,-19734"/>
<polygon fill="black" stroke="black" points="3838.06,-19730.5 3828.06,-19734 3838.06,-19737.5 3838.06,-19730.5"/>
</g>
<!-- layer35_moe_comm_from_expert15&#45;&gt;layer35_moe_aggregate -->
<g id="edge2214" class="edge">
<title>layer35_moe_comm_from_expert15&#45;&gt;layer35_moe_aggregate</title>
<path fill="none" stroke="black" d="M6203.15,-19849.3C6203.15,-19804.15 6203.15,-19721 6203.15,-19721 6203.15,-19721 3824.72,-19721 3824.72,-19721"/>
<polygon fill="black" stroke="black" points="3824.72,-19717.5 3814.72,-19721 3824.72,-19724.5 3824.72,-19717.5"/>
</g>
<!-- layer36_moe_gate -->
<g id="node1725" class="node">
<title>layer36_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3905.3,-19584.68 3494.4,-19584.68 3388.7,-19480.68 3799.6,-19480.68 3905.3,-19584.68"/>
<text text-anchor="middle" x="3647" y="-19546.68" font-family="Arial" font-size="10.00">GATE L36</text>
<text text-anchor="middle" x="3647" y="-19535.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3647" y="-19524.68" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3647" y="-19513.68" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer36_moe_mha&#45;&gt;layer36_moe_gate -->
<g id="edge2283" class="edge">
<title>layer36_moe_mha&#45;&gt;layer36_moe_gate</title>
<path fill="none" stroke="black" d="M3647,-19620.52C3647,-19620.52 3647,-19594.78 3647,-19594.78"/>
<polygon fill="black" stroke="black" points="3650.5,-19594.78 3647,-19584.78 3643.5,-19594.78 3650.5,-19594.78"/>
</g>
<!-- layer36_moe_split -->
<g id="node1726" class="node">
<title>layer36_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3901.01,-19444.68 3496.94,-19444.68 3392.99,-19340.68 3797.06,-19340.68 3901.01,-19444.68"/>
<text text-anchor="middle" x="3647" y="-19406.68" font-family="Arial" font-size="10.00">SPLIT TOKENS L36</text>
<text text-anchor="middle" x="3647" y="-19395.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3647" y="-19384.68" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3647" y="-19373.68" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer36_moe_gate&#45;&gt;layer36_moe_split -->
<g id="edge2284" class="edge">
<title>layer36_moe_gate&#45;&gt;layer36_moe_split</title>
<path fill="none" stroke="black" d="M3647,-19480.55C3647,-19480.55 3647,-19454.85 3647,-19454.85"/>
<polygon fill="black" stroke="black" points="3650.5,-19454.85 3647,-19444.85 3643.5,-19454.85 3650.5,-19454.85"/>
</g>
<!-- layer36_moe_comm_to_expert0 -->
<g id="node1728" class="node">
<title>layer36_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1098" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1098" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1098" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1098" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert0 -->
<g id="edge2218" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3481.23,-19429C2915.82,-19429 1098,-19429 1098,-19429 1098,-19429 1098,-19314.88 1098,-19314.88"/>
<polygon fill="black" stroke="black" points="1101.5,-19314.88 1098,-19304.88 1094.5,-19314.88 1101.5,-19314.88"/>
</g>
<!-- layer36_moe_comm_to_expert1 -->
<g id="node1730" class="node">
<title>layer36_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1811" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1811" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1811" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1811" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert1 -->
<g id="edge2220" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3466.09,-19414C3006.37,-19414 1829.5,-19414 1829.5,-19414 1829.5,-19414 1829.5,-19314.34 1829.5,-19314.34"/>
<polygon fill="black" stroke="black" points="1833,-19314.34 1829.5,-19304.34 1826,-19314.34 1833,-19314.34"/>
</g>
<!-- layer36_moe_comm_to_expert2 -->
<g id="node1732" class="node">
<title>layer36_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2267" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2267" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2267" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2267" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert2 -->
<g id="edge2222" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3451.93,-19400C3075.46,-19400 2285.5,-19400 2285.5,-19400 2285.5,-19400 2285.5,-19314.21 2285.5,-19314.21"/>
<polygon fill="black" stroke="black" points="2289,-19314.21 2285.5,-19304.21 2282,-19314.21 2289,-19314.21"/>
</g>
<!-- layer36_moe_comm_to_expert3 -->
<g id="node1734" class="node">
<title>layer36_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2595" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2595" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2595" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2595" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert3 -->
<g id="edge2224" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3437.23,-19385C3135.15,-19385 2613.5,-19385 2613.5,-19385 2613.5,-19385 2613.5,-19314.12 2613.5,-19314.12"/>
<polygon fill="black" stroke="black" points="2617,-19314.12 2613.5,-19304.12 2610,-19314.12 2617,-19314.12"/>
</g>
<!-- layer36_moe_comm_to_expert4 -->
<g id="node1736" class="node">
<title>layer36_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2858" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2858" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2858" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2858" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert4 -->
<g id="edge2226" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3422.07,-19370C3194.64,-19370 2876.5,-19370 2876.5,-19370 2876.5,-19370 2876.5,-19314.24 2876.5,-19314.24"/>
<polygon fill="black" stroke="black" points="2880,-19314.24 2876.5,-19304.24 2873,-19314.24 2880,-19314.24"/>
</g>
<!-- layer36_moe_comm_to_expert5 -->
<g id="node1738" class="node">
<title>layer36_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3089" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3089" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3089" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3089" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert5 -->
<g id="edge2228" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3407.23,-19355C3263.14,-19355 3107.5,-19355 3107.5,-19355 3107.5,-19355 3107.5,-19314.32 3107.5,-19314.32"/>
<polygon fill="black" stroke="black" points="3111,-19314.32 3107.5,-19304.32 3104,-19314.32 3111,-19314.32"/>
</g>
<!-- layer36_moe_comm_to_expert6 -->
<g id="node1740" class="node">
<title>layer36_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3304" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3304" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3304" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3304" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert6 -->
<g id="edge2230" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3407.5,-19392.59C3407.5,-19389.03 3407.5,-19275 3407.5,-19275 3407.5,-19275 3404.81,-19275 3404.81,-19275"/>
<polygon fill="black" stroke="black" points="3404.81,-19271.5 3394.81,-19275 3404.81,-19278.5 3404.81,-19271.5"/>
</g>
<!-- layer36_moe_comm_to_expert7 -->
<g id="node1742" class="node">
<title>layer36_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3511" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3511" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3511" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3511" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert7 -->
<g id="edge2232" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3511,-19340.34C3511,-19340.34 3511,-19314.9 3511,-19314.9"/>
<polygon fill="black" stroke="black" points="3514.5,-19314.9 3511,-19304.9 3507.5,-19314.9 3514.5,-19314.9"/>
</g>
<!-- layer36_moe_comm_to_expert8 -->
<g id="node1744" class="node">
<title>layer36_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3783" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3783" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3783" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3783" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert8 -->
<g id="edge2234" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3783,-19340.34C3783,-19340.34 3783,-19314.9 3783,-19314.9"/>
<polygon fill="black" stroke="black" points="3786.5,-19314.9 3783,-19304.9 3779.5,-19314.9 3786.5,-19314.9"/>
</g>
<!-- layer36_moe_comm_to_expert9 -->
<g id="node1746" class="node">
<title>layer36_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4092" cy="-19275.69" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4092" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4092" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4092" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert9 -->
<g id="edge2236" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3887.26,-19392.59C3887.26,-19389.03 3887.26,-19275 3887.26,-19275 3887.26,-19275 3991.3,-19275 3991.3,-19275"/>
<polygon fill="black" stroke="black" points="3991.3,-19278.5 4001.3,-19275 3991.3,-19271.5 3991.3,-19278.5"/>
</g>
<!-- layer36_moe_comm_to_expert10 -->
<g id="node1748" class="node">
<title>layer36_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4424" cy="-19275.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4424" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4424" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4424" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert10 -->
<g id="edge2238" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3811.82,-19355C4019.07,-19355 4348.1,-19355 4348.1,-19355 4348.1,-19355 4348.1,-19302.9 4348.1,-19302.9"/>
<polygon fill="black" stroke="black" points="4351.6,-19302.9 4348.1,-19292.9 4344.6,-19302.9 4351.6,-19302.9"/>
</g>
<!-- layer36_moe_comm_to_expert11 -->
<g id="node1750" class="node">
<title>layer36_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4770" cy="-19275.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4770" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4770" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4770" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert11 -->
<g id="edge2240" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3826.49,-19370C4125.86,-19370 4694.6,-19370 4694.6,-19370 4694.6,-19370 4694.6,-19303.43 4694.6,-19303.43"/>
<polygon fill="black" stroke="black" points="4698.1,-19303.43 4694.6,-19293.43 4691.1,-19303.43 4698.1,-19303.43"/>
</g>
<!-- layer36_moe_comm_to_expert12 -->
<g id="node1752" class="node">
<title>layer36_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5121" cy="-19275.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5121" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5121" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5121" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert12 -->
<g id="edge2242" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3841.47,-19385C4225.77,-19385 5045.6,-19385 5045.6,-19385 5045.6,-19385 5045.6,-19303.25 5045.6,-19303.25"/>
<polygon fill="black" stroke="black" points="5049.1,-19303.25 5045.6,-19293.25 5042.1,-19303.25 5049.1,-19303.25"/>
</g>
<!-- layer36_moe_comm_to_expert13 -->
<g id="node1754" class="node">
<title>layer36_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5474" cy="-19275.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5474" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5474" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5474" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert13 -->
<g id="edge2244" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3856.6,-19400C4321.67,-19400 5399.1,-19400 5399.1,-19400 5399.1,-19400 5399.1,-19303.23 5399.1,-19303.23"/>
<polygon fill="black" stroke="black" points="5402.6,-19303.23 5399.1,-19293.23 5395.6,-19303.23 5402.6,-19303.23"/>
</g>
<!-- layer36_moe_comm_to_expert14 -->
<g id="node1756" class="node">
<title>layer36_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5829" cy="-19275.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5829" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5829" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5829" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert14 -->
<g id="edge2246" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3870.5,-19414C4412.79,-19414 5754.1,-19414 5754.1,-19414 5754.1,-19414 5754.1,-19303.48 5754.1,-19303.48"/>
<polygon fill="black" stroke="black" points="5757.6,-19303.48 5754.1,-19293.48 5750.6,-19303.48 5757.6,-19303.48"/>
</g>
<!-- layer36_moe_comm_to_expert15 -->
<g id="node1758" class="node">
<title>layer36_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6184" cy="-19275.69" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6184" y="-19284.19" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6184" y="-19273.19" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6184" y="-19262.19" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert15 -->
<g id="edge2248" class="edge">
<title>layer36_moe_split&#45;&gt;layer36_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3885.59,-19429C4503.69,-19429 6109.1,-19429 6109.1,-19429 6109.1,-19429 6109.1,-19303.27 6109.1,-19303.27"/>
<polygon fill="black" stroke="black" points="6112.6,-19303.27 6109.1,-19293.27 6105.6,-19303.27 6112.6,-19303.27"/>
</g>
<!-- layer36_moe_expert0 -->
<g id="node1727" class="node">
<title>layer36_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1216,-19210.69 888,-19210.69 888,-19158.69 1216,-19158.69 1216,-19210.69"/>
<text text-anchor="middle" x="1052" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 0 L36</text>
<text text-anchor="middle" x="1052" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1052" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1052" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert0 -->
<g id="node1760" class="node">
<title>layer36_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1566" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1566" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1566" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1566" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer36_moe_expert0&#45;&gt;layer36_moe_comm_from_expert0 -->
<g id="edge2250" class="edge">
<title>layer36_moe_expert0&#45;&gt;layer36_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1206.5,-19158.66C1206.5,-19131.55 1206.5,-19093 1206.5,-19093 1206.5,-19093 1465.28,-19093 1465.28,-19093"/>
<polygon fill="black" stroke="black" points="1465.28,-19096.5 1475.28,-19093 1465.28,-19089.5 1465.28,-19096.5"/>
</g>
<!-- layer36_moe_comm_to_expert0&#45;&gt;layer36_moe_expert0 -->
<g id="edge2219" class="edge">
<title>layer36_moe_comm_to_expert0&#45;&gt;layer36_moe_expert0</title>
<path fill="none" stroke="black" d="M1098,-19246.65C1098,-19246.65 1098,-19221 1098,-19221"/>
<polygon fill="black" stroke="black" points="1101.5,-19221 1098,-19211 1094.5,-19221 1101.5,-19221"/>
</g>
<!-- layer36_moe_expert1 -->
<g id="node1729" class="node">
<title>layer36_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1562,-19210.69 1234,-19210.69 1234,-19158.69 1562,-19158.69 1562,-19210.69"/>
<text text-anchor="middle" x="1398" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 1 L36</text>
<text text-anchor="middle" x="1398" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1398" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1398" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert1 -->
<g id="node1761" class="node">
<title>layer36_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1811" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1811" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1811" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1811" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer36_moe_expert1&#45;&gt;layer36_moe_comm_from_expert1 -->
<g id="edge2252" class="edge">
<title>layer36_moe_expert1&#45;&gt;layer36_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1518.75,-19158.48C1518.75,-19144.85 1518.75,-19131 1518.75,-19131 1518.75,-19131 1811,-19131 1811,-19131 1811,-19131 1811,-19130.17 1811,-19130.17"/>
<polygon fill="black" stroke="black" points="1814.5,-19132.72 1811,-19122.72 1807.5,-19132.72 1814.5,-19132.72"/>
</g>
<!-- layer36_moe_comm_to_expert1&#45;&gt;layer36_moe_expert1 -->
<g id="edge2221" class="edge">
<title>layer36_moe_comm_to_expert1&#45;&gt;layer36_moe_expert1</title>
<path fill="none" stroke="black" d="M1720.22,-19275C1640.54,-19275 1537.25,-19275 1537.25,-19275 1537.25,-19275 1537.25,-19220.81 1537.25,-19220.81"/>
<polygon fill="black" stroke="black" points="1540.75,-19220.81 1537.25,-19210.81 1533.75,-19220.81 1540.75,-19220.81"/>
</g>
<!-- layer36_moe_expert2 -->
<g id="node1731" class="node">
<title>layer36_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1908,-19210.69 1580,-19210.69 1580,-19158.69 1908,-19158.69 1908,-19210.69"/>
<text text-anchor="middle" x="1744" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 2 L36</text>
<text text-anchor="middle" x="1744" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1744" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1744" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert2 -->
<g id="node1762" class="node">
<title>layer36_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2267" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2267" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2267" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2267" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer36_moe_expert2&#45;&gt;layer36_moe_comm_from_expert2 -->
<g id="edge2254" class="edge">
<title>layer36_moe_expert2&#45;&gt;layer36_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1908.18,-19176C1915.6,-19176 1920,-19176 1920,-19176 1920,-19176 1920,-19093 1920,-19093 1920,-19093 2166.28,-19093 2166.28,-19093"/>
<polygon fill="black" stroke="black" points="2166.28,-19096.5 2176.28,-19093 2166.28,-19089.5 2166.28,-19096.5"/>
</g>
<!-- layer36_moe_comm_to_expert2&#45;&gt;layer36_moe_expert2 -->
<g id="edge2223" class="edge">
<title>layer36_moe_comm_to_expert2&#45;&gt;layer36_moe_expert2</title>
<path fill="none" stroke="black" d="M2176.09,-19275C2071.5,-19275 1914,-19275 1914,-19275 1914,-19275 1914,-19193 1914,-19193 1914,-19193 1913.43,-19193 1913.43,-19193"/>
<polygon fill="black" stroke="black" points="1918.34,-19189.5 1908.34,-19193 1918.34,-19196.5 1918.34,-19189.5"/>
</g>
<!-- layer36_moe_expert3 -->
<g id="node1733" class="node">
<title>layer36_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2254,-19210.69 1926,-19210.69 1926,-19158.69 2254,-19158.69 2254,-19210.69"/>
<text text-anchor="middle" x="2090" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 3 L36</text>
<text text-anchor="middle" x="2090" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2090" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2090" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert3 -->
<g id="node1763" class="node">
<title>layer36_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2595" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2595" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2595" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2595" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer36_moe_expert3&#45;&gt;layer36_moe_comm_from_expert3 -->
<g id="edge2256" class="edge">
<title>layer36_moe_expert3&#45;&gt;layer36_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2215.25,-19158.44C2215.25,-19148.71 2215.25,-19140 2215.25,-19140 2215.25,-19140 2536.33,-19140 2536.33,-19140 2536.33,-19140 2536.33,-19126.04 2536.33,-19126.04"/>
<polygon fill="black" stroke="black" points="2539.83,-19126.04 2536.33,-19116.04 2532.83,-19126.04 2539.83,-19126.04"/>
</g>
<!-- layer36_moe_comm_to_expert3&#45;&gt;layer36_moe_expert3 -->
<g id="edge2225" class="edge">
<title>layer36_moe_comm_to_expert3&#45;&gt;layer36_moe_expert3</title>
<path fill="none" stroke="black" d="M2536.33,-19253.38C2536.33,-19243.47 2536.33,-19234 2536.33,-19234 2536.33,-19234 2215.25,-19234 2215.25,-19234 2215.25,-19234 2215.25,-19220.79 2215.25,-19220.79"/>
<polygon fill="black" stroke="black" points="2218.75,-19220.79 2215.25,-19210.79 2211.75,-19220.79 2218.75,-19220.79"/>
</g>
<!-- layer36_moe_expert4 -->
<g id="node1735" class="node">
<title>layer36_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2600,-19210.69 2272,-19210.69 2272,-19158.69 2600,-19158.69 2600,-19210.69"/>
<text text-anchor="middle" x="2436" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 4 L36</text>
<text text-anchor="middle" x="2436" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2436" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2436" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert4 -->
<g id="node1764" class="node">
<title>layer36_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2858" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2858" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2858" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2858" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer36_moe_expert4&#45;&gt;layer36_moe_comm_from_expert4 -->
<g id="edge2258" class="edge">
<title>layer36_moe_expert4&#45;&gt;layer36_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2568.16,-19158.38C2568.16,-19153.03 2568.16,-19149 2568.16,-19149 2568.16,-19149 2856.75,-19149 2856.75,-19149 2856.75,-19149 2856.75,-19132.97 2856.75,-19132.97"/>
<polygon fill="black" stroke="black" points="2860.25,-19132.97 2856.75,-19122.97 2853.25,-19132.97 2860.25,-19132.97"/>
</g>
<!-- layer36_moe_comm_to_expert4&#45;&gt;layer36_moe_expert4 -->
<g id="edge2227" class="edge">
<title>layer36_moe_comm_to_expert4&#45;&gt;layer36_moe_expert4</title>
<path fill="none" stroke="black" d="M2856.75,-19246.64C2856.75,-19233.99 2856.75,-19222 2856.75,-19222 2856.75,-19222 2568.16,-19222 2568.16,-19222 2568.16,-19222 2568.16,-19220.9 2568.16,-19220.9"/>
<polygon fill="black" stroke="black" points="2571.66,-19221.01 2568.16,-19211.01 2564.66,-19221.01 2571.66,-19221.01"/>
</g>
<!-- layer36_moe_expert5 -->
<g id="node1737" class="node">
<title>layer36_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2946,-19210.69 2618,-19210.69 2618,-19158.69 2946,-19158.69 2946,-19210.69"/>
<text text-anchor="middle" x="2782" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 5 L36</text>
<text text-anchor="middle" x="2782" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2782" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2782" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert5 -->
<g id="node1765" class="node">
<title>layer36_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3089" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3089" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3089" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3089" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer36_moe_expert5&#45;&gt;layer36_moe_comm_from_expert5 -->
<g id="edge2260" class="edge">
<title>layer36_moe_expert5&#45;&gt;layer36_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2946.21,-19176C2953.1,-19176 2957.16,-19176 2957.16,-19176 2957.16,-19176 2957.16,-19093 2957.16,-19093 2957.16,-19093 2988.52,-19093 2988.52,-19093"/>
<polygon fill="black" stroke="black" points="2988.52,-19096.5 2998.52,-19093 2988.52,-19089.5 2988.52,-19096.5"/>
</g>
<!-- layer36_moe_comm_to_expert5&#45;&gt;layer36_moe_expert5 -->
<g id="edge2229" class="edge">
<title>layer36_moe_comm_to_expert5&#45;&gt;layer36_moe_expert5</title>
<path fill="none" stroke="black" d="M2998.18,-19275C2973.2,-19275 2952.84,-19275 2952.84,-19275 2952.84,-19275 2952.84,-19193 2952.84,-19193 2952.84,-19193 2952.19,-19193 2952.19,-19193"/>
<polygon fill="black" stroke="black" points="2956.35,-19189.5 2946.35,-19193 2956.35,-19196.5 2956.35,-19189.5"/>
</g>
<!-- layer36_moe_expert6 -->
<g id="node1739" class="node">
<title>layer36_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3292,-19210.69 2964,-19210.69 2964,-19158.69 3292,-19158.69 3292,-19210.69"/>
<text text-anchor="middle" x="3128" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 6 L36</text>
<text text-anchor="middle" x="3128" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3128" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3128" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert6 -->
<g id="node1766" class="node">
<title>layer36_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3304" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3304" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3304" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3304" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer36_moe_expert6&#45;&gt;layer36_moe_comm_from_expert6 -->
<g id="edge2262" class="edge">
<title>layer36_moe_expert6&#45;&gt;layer36_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3252.75,-19158.38C3252.75,-19158.38 3252.75,-19127.78 3252.75,-19127.78"/>
<polygon fill="black" stroke="black" points="3256.25,-19127.78 3252.75,-19117.78 3249.25,-19127.78 3256.25,-19127.78"/>
</g>
<!-- layer36_moe_comm_to_expert6&#45;&gt;layer36_moe_expert6 -->
<g id="edge2231" class="edge">
<title>layer36_moe_comm_to_expert6&#45;&gt;layer36_moe_expert6</title>
<path fill="none" stroke="black" d="M3252.75,-19251.78C3252.75,-19251.78 3252.75,-19221 3252.75,-19221"/>
<polygon fill="black" stroke="black" points="3256.25,-19221 3252.75,-19211 3249.25,-19221 3256.25,-19221"/>
</g>
<!-- layer36_moe_expert7 -->
<g id="node1741" class="node">
<title>layer36_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3638,-19210.69 3310,-19210.69 3310,-19158.69 3638,-19158.69 3638,-19210.69"/>
<text text-anchor="middle" x="3474" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 7 L36</text>
<text text-anchor="middle" x="3474" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3474" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3474" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert7 -->
<g id="node1767" class="node">
<title>layer36_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3511" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3511" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3511" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3511" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer36_moe_expert7&#45;&gt;layer36_moe_comm_from_expert7 -->
<g id="edge2264" class="edge">
<title>layer36_moe_expert7&#45;&gt;layer36_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3511,-19158.38C3511,-19158.38 3511,-19132.83 3511,-19132.83"/>
<polygon fill="black" stroke="black" points="3514.5,-19132.83 3511,-19122.83 3507.5,-19132.83 3514.5,-19132.83"/>
</g>
<!-- layer36_moe_comm_to_expert7&#45;&gt;layer36_moe_expert7 -->
<g id="edge2233" class="edge">
<title>layer36_moe_comm_to_expert7&#45;&gt;layer36_moe_expert7</title>
<path fill="none" stroke="black" d="M3511,-19246.65C3511,-19246.65 3511,-19221 3511,-19221"/>
<polygon fill="black" stroke="black" points="3514.5,-19221 3511,-19211 3507.5,-19221 3514.5,-19221"/>
</g>
<!-- layer36_moe_expert8 -->
<g id="node1743" class="node">
<title>layer36_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3984,-19210.69 3656,-19210.69 3656,-19158.69 3984,-19158.69 3984,-19210.69"/>
<text text-anchor="middle" x="3820" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 8 L36</text>
<text text-anchor="middle" x="3820" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3820" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3820" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert8 -->
<g id="node1768" class="node">
<title>layer36_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3783" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3783" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3783" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3783" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer36_moe_expert8&#45;&gt;layer36_moe_comm_from_expert8 -->
<g id="edge2266" class="edge">
<title>layer36_moe_expert8&#45;&gt;layer36_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3783,-19158.38C3783,-19158.38 3783,-19132.83 3783,-19132.83"/>
<polygon fill="black" stroke="black" points="3786.5,-19132.83 3783,-19122.83 3779.5,-19132.83 3786.5,-19132.83"/>
</g>
<!-- layer36_moe_comm_to_expert8&#45;&gt;layer36_moe_expert8 -->
<g id="edge2235" class="edge">
<title>layer36_moe_comm_to_expert8&#45;&gt;layer36_moe_expert8</title>
<path fill="none" stroke="black" d="M3783,-19246.65C3783,-19246.65 3783,-19221 3783,-19221"/>
<polygon fill="black" stroke="black" points="3786.5,-19221 3783,-19211 3779.5,-19221 3786.5,-19221"/>
</g>
<!-- layer36_moe_expert9 -->
<g id="node1745" class="node">
<title>layer36_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4330,-19210.69 4002,-19210.69 4002,-19158.69 4330,-19158.69 4330,-19210.69"/>
<text text-anchor="middle" x="4166" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 9 L36</text>
<text text-anchor="middle" x="4166" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4166" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4166" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert9 -->
<g id="node1769" class="node">
<title>layer36_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4092" cy="-19093.7" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4092" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4092" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4092" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer36_moe_expert9&#45;&gt;layer36_moe_comm_from_expert9 -->
<g id="edge2268" class="edge">
<title>layer36_moe_expert9&#45;&gt;layer36_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4092.25,-19158.38C4092.25,-19158.38 4092.25,-19132.83 4092.25,-19132.83"/>
<polygon fill="black" stroke="black" points="4095.75,-19132.83 4092.25,-19122.83 4088.75,-19132.83 4095.75,-19132.83"/>
</g>
<!-- layer36_moe_comm_to_expert9&#45;&gt;layer36_moe_expert9 -->
<g id="edge2237" class="edge">
<title>layer36_moe_comm_to_expert9&#45;&gt;layer36_moe_expert9</title>
<path fill="none" stroke="black" d="M4092.25,-19246.65C4092.25,-19246.65 4092.25,-19221 4092.25,-19221"/>
<polygon fill="black" stroke="black" points="4095.75,-19221 4092.25,-19211 4088.75,-19221 4095.75,-19221"/>
</g>
<!-- layer36_moe_expert10 -->
<g id="node1747" class="node">
<title>layer36_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4686,-19210.69 4348,-19210.69 4348,-19158.69 4686,-19158.69 4686,-19210.69"/>
<text text-anchor="middle" x="4517" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 10 L36</text>
<text text-anchor="middle" x="4517" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4517" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4517" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert10 -->
<g id="node1770" class="node">
<title>layer36_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4424" cy="-19093.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4424" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4424" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4424" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer36_moe_expert10&#45;&gt;layer36_moe_comm_from_expert10 -->
<g id="edge2270" class="edge">
<title>layer36_moe_expert10&#45;&gt;layer36_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4433.38,-19158.38C4433.38,-19158.38 4433.38,-19132.83 4433.38,-19132.83"/>
<polygon fill="black" stroke="black" points="4436.88,-19132.83 4433.38,-19122.83 4429.88,-19132.83 4436.88,-19132.83"/>
</g>
<!-- layer36_moe_comm_to_expert10&#45;&gt;layer36_moe_expert10 -->
<g id="edge2239" class="edge">
<title>layer36_moe_comm_to_expert10&#45;&gt;layer36_moe_expert10</title>
<path fill="none" stroke="black" d="M4433.02,-19246.65C4433.02,-19246.65 4433.02,-19221 4433.02,-19221"/>
<polygon fill="black" stroke="black" points="4436.52,-19221 4433.02,-19211 4429.52,-19221 4436.52,-19221"/>
</g>
<!-- layer36_moe_expert11 -->
<g id="node1749" class="node">
<title>layer36_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5042,-19210.69 4704,-19210.69 4704,-19158.69 5042,-19158.69 5042,-19210.69"/>
<text text-anchor="middle" x="4873" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 11 L36</text>
<text text-anchor="middle" x="4873" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4873" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4873" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert11 -->
<g id="node1771" class="node">
<title>layer36_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4771" cy="-19093.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4771" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4771" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4771" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer36_moe_expert11&#45;&gt;layer36_moe_comm_from_expert11 -->
<g id="edge2272" class="edge">
<title>layer36_moe_expert11&#45;&gt;layer36_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4784.88,-19158.38C4784.88,-19158.38 4784.88,-19132.51 4784.88,-19132.51"/>
<polygon fill="black" stroke="black" points="4788.38,-19132.51 4784.88,-19122.51 4781.38,-19132.51 4788.38,-19132.51"/>
</g>
<!-- layer36_moe_comm_to_expert11&#45;&gt;layer36_moe_expert11 -->
<g id="edge2241" class="edge">
<title>layer36_moe_comm_to_expert11&#45;&gt;layer36_moe_expert11</title>
<path fill="none" stroke="black" d="M4784.02,-19246.9C4784.02,-19246.9 4784.02,-19220.83 4784.02,-19220.83"/>
<polygon fill="black" stroke="black" points="4787.52,-19220.83 4784.02,-19210.83 4780.52,-19220.83 4787.52,-19220.83"/>
</g>
<!-- layer36_moe_expert12 -->
<g id="node1751" class="node">
<title>layer36_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5398,-19210.69 5060,-19210.69 5060,-19158.69 5398,-19158.69 5398,-19210.69"/>
<text text-anchor="middle" x="5229" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 12 L36</text>
<text text-anchor="middle" x="5229" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5229" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5229" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert12 -->
<g id="node1772" class="node">
<title>layer36_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5122" cy="-19093.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5122" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5122" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5122" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer36_moe_expert12&#45;&gt;layer36_moe_comm_from_expert12 -->
<g id="edge2274" class="edge">
<title>layer36_moe_expert12&#45;&gt;layer36_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5138.38,-19158.38C5138.38,-19158.38 5138.38,-19132.51 5138.38,-19132.51"/>
<polygon fill="black" stroke="black" points="5141.88,-19132.51 5138.38,-19122.51 5134.88,-19132.51 5141.88,-19132.51"/>
</g>
<!-- layer36_moe_comm_to_expert12&#45;&gt;layer36_moe_expert12 -->
<g id="edge2243" class="edge">
<title>layer36_moe_comm_to_expert12&#45;&gt;layer36_moe_expert12</title>
<path fill="none" stroke="black" d="M5137.52,-19246.9C5137.52,-19246.9 5137.52,-19220.83 5137.52,-19220.83"/>
<polygon fill="black" stroke="black" points="5141.02,-19220.83 5137.52,-19210.83 5134.02,-19220.83 5141.02,-19220.83"/>
</g>
<!-- layer36_moe_expert13 -->
<g id="node1753" class="node">
<title>layer36_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5754,-19210.69 5416,-19210.69 5416,-19158.69 5754,-19158.69 5754,-19210.69"/>
<text text-anchor="middle" x="5585" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 13 L36</text>
<text text-anchor="middle" x="5585" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5585" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5585" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert13 -->
<g id="node1773" class="node">
<title>layer36_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5476" cy="-19093.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5476" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5476" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5476" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer36_moe_expert13&#45;&gt;layer36_moe_comm_from_expert13 -->
<g id="edge2276" class="edge">
<title>layer36_moe_expert13&#45;&gt;layer36_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5493.38,-19158.38C5493.38,-19158.38 5493.38,-19132.51 5493.38,-19132.51"/>
<polygon fill="black" stroke="black" points="5496.88,-19132.51 5493.38,-19122.51 5489.88,-19132.51 5496.88,-19132.51"/>
</g>
<!-- layer36_moe_comm_to_expert13&#45;&gt;layer36_moe_expert13 -->
<g id="edge2245" class="edge">
<title>layer36_moe_comm_to_expert13&#45;&gt;layer36_moe_expert13</title>
<path fill="none" stroke="black" d="M5492.02,-19246.9C5492.02,-19246.9 5492.02,-19220.83 5492.02,-19220.83"/>
<polygon fill="black" stroke="black" points="5495.52,-19220.83 5492.02,-19210.83 5488.52,-19220.83 5495.52,-19220.83"/>
</g>
<!-- layer36_moe_expert14 -->
<g id="node1755" class="node">
<title>layer36_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6110,-19210.69 5772,-19210.69 5772,-19158.69 6110,-19158.69 6110,-19210.69"/>
<text text-anchor="middle" x="5941" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 14 L36</text>
<text text-anchor="middle" x="5941" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5941" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5941" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert14 -->
<g id="node1774" class="node">
<title>layer36_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5831" cy="-19093.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5831" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5831" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5831" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer36_moe_expert14&#45;&gt;layer36_moe_comm_from_expert14 -->
<g id="edge2278" class="edge">
<title>layer36_moe_expert14&#45;&gt;layer36_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5848.88,-19158.38C5848.88,-19158.38 5848.88,-19132.19 5848.88,-19132.19"/>
<polygon fill="black" stroke="black" points="5852.38,-19132.19 5848.88,-19122.19 5845.38,-19132.19 5852.38,-19132.19"/>
</g>
<!-- layer36_moe_comm_to_expert14&#45;&gt;layer36_moe_expert14 -->
<g id="edge2247" class="edge">
<title>layer36_moe_comm_to_expert14&#45;&gt;layer36_moe_expert14</title>
<path fill="none" stroke="black" d="M5847.52,-19246.9C5847.52,-19246.9 5847.52,-19220.83 5847.52,-19220.83"/>
<polygon fill="black" stroke="black" points="5851.02,-19220.83 5847.52,-19210.83 5844.02,-19220.83 5851.02,-19220.83"/>
</g>
<!-- layer36_moe_expert15 -->
<g id="node1757" class="node">
<title>layer36_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6466,-19210.69 6128,-19210.69 6128,-19158.69 6466,-19158.69 6466,-19210.69"/>
<text text-anchor="middle" x="6297" y="-19198.69" font-family="Arial" font-size="10.00">EXPERT 15 L36</text>
<text text-anchor="middle" x="6297" y="-19187.69" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6297" y="-19176.69" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6297" y="-19165.69" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_comm_from_expert15 -->
<g id="node1775" class="node">
<title>layer36_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6186" cy="-19093.7" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6186" y="-19102.2" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6186" y="-19091.2" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6186" y="-19080.2" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer36_moe_expert15&#45;&gt;layer36_moe_comm_from_expert15 -->
<g id="edge2280" class="edge">
<title>layer36_moe_expert15&#45;&gt;layer36_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6204.38,-19158.38C6204.38,-19158.38 6204.38,-19132.19 6204.38,-19132.19"/>
<polygon fill="black" stroke="black" points="6207.88,-19132.19 6204.38,-19122.19 6200.88,-19132.19 6207.88,-19132.19"/>
</g>
<!-- layer36_moe_comm_to_expert15&#45;&gt;layer36_moe_expert15 -->
<g id="edge2249" class="edge">
<title>layer36_moe_comm_to_expert15&#45;&gt;layer36_moe_expert15</title>
<path fill="none" stroke="black" d="M6203.02,-19246.9C6203.02,-19246.9 6203.02,-19220.83 6203.02,-19220.83"/>
<polygon fill="black" stroke="black" points="6206.52,-19220.83 6203.02,-19210.83 6199.52,-19220.83 6206.52,-19220.83"/>
</g>
<!-- layer36_moe_aggregate -->
<g id="node1759" class="node">
<title>layer36_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3872.1,-19028.71 3455.16,-19028.71 3347.9,-18924.71 3764.84,-18924.71 3872.1,-19028.71"/>
<text text-anchor="middle" x="3610" y="-18990.71" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L36</text>
<text text-anchor="middle" x="3610" y="-18979.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3610" y="-18968.71" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3610" y="-18957.71" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_mha -->
<g id="node1776" class="node">
<title>layer37_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3740,-18888.71 3480,-18888.71 3480,-18836.71 3740,-18836.71 3740,-18888.71"/>
<text text-anchor="middle" x="3610" y="-18876.71" font-family="Arial" font-size="10.00">MHA L37</text>
<text text-anchor="middle" x="3610" y="-18865.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3610" y="-18854.71" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3610" y="-18843.71" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer36_moe_aggregate&#45;&gt;layer37_moe_mha -->
<g id="edge2349" class="edge">
<title>layer36_moe_aggregate&#45;&gt;layer37_moe_mha</title>
<path fill="none" stroke="black" d="M3610,-18924.38C3610,-18924.38 3610,-18898.94 3610,-18898.94"/>
<polygon fill="black" stroke="black" points="3613.5,-18898.94 3610,-18888.94 3606.5,-18898.94 3613.5,-18898.94"/>
</g>
<!-- layer36_moe_comm_from_expert0&#45;&gt;layer36_moe_aggregate -->
<g id="edge2251" class="edge">
<title>layer36_moe_comm_from_expert0&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M1638.01,-19075.96C1638.01,-19035.32 1638.01,-18939 1638.01,-18939 1638.01,-18939 3352.24,-18939 3352.24,-18939"/>
<polygon fill="black" stroke="black" points="3352.24,-18942.5 3362.24,-18939 3352.24,-18935.5 3352.24,-18942.5"/>
</g>
<!-- layer36_moe_comm_from_expert1&#45;&gt;layer36_moe_aggregate -->
<g id="edge2253" class="edge">
<title>layer36_moe_comm_from_expert1&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M1895.25,-19082.74C1895.25,-19049.81 1895.25,-18954 1895.25,-18954 1895.25,-18954 3367.85,-18954 3367.85,-18954"/>
<polygon fill="black" stroke="black" points="3367.85,-18957.5 3377.85,-18954 3367.85,-18950.5 3367.85,-18957.5"/>
</g>
<!-- layer36_moe_comm_from_expert2&#45;&gt;layer36_moe_aggregate -->
<g id="edge2255" class="edge">
<title>layer36_moe_comm_from_expert2&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M2339.01,-19076.1C2339.01,-19041.73 2339.01,-18969 2339.01,-18969 2339.01,-18969 3383.31,-18969 3383.31,-18969"/>
<polygon fill="black" stroke="black" points="3383.31,-18972.5 3393.31,-18969 3383.31,-18965.5 3383.31,-18972.5"/>
</g>
<!-- layer36_moe_comm_from_expert3&#45;&gt;layer36_moe_aggregate -->
<g id="edge2257" class="edge">
<title>layer36_moe_comm_from_expert3&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M2667.01,-19076.08C2667.01,-19045.07 2667.01,-18984 2667.01,-18984 2667.01,-18984 3398.86,-18984 3398.86,-18984"/>
<polygon fill="black" stroke="black" points="3398.86,-18987.5 3408.86,-18984 3398.86,-18980.5 3398.86,-18987.5"/>
</g>
<!-- layer36_moe_comm_from_expert4&#45;&gt;layer36_moe_aggregate -->
<g id="edge2259" class="edge">
<title>layer36_moe_comm_from_expert4&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M2937.75,-19079.99C2937.75,-19053.53 2937.75,-18998 2937.75,-18998 2937.75,-18998 3413.19,-18998 3413.19,-18998"/>
<polygon fill="black" stroke="black" points="3413.19,-19001.5 3423.19,-18998 3413.19,-18994.5 3413.19,-19001.5"/>
</g>
<!-- layer36_moe_comm_from_expert5&#45;&gt;layer36_moe_aggregate -->
<g id="edge2261" class="edge">
<title>layer36_moe_comm_from_expert5&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M3159.5,-19075.39C3159.5,-19051.58 3159.5,-19013 3159.5,-19013 3159.5,-19013 3428.72,-19013 3428.72,-19013"/>
<polygon fill="black" stroke="black" points="3428.72,-19016.5 3438.72,-19013 3428.72,-19009.5 3428.72,-19016.5"/>
</g>
<!-- layer36_moe_comm_from_expert6&#45;&gt;layer36_moe_aggregate -->
<g id="edge2263" class="edge">
<title>layer36_moe_comm_from_expert6&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M3371.11,-19074.12C3371.11,-19074.12 3371.11,-18986.76 3371.11,-18986.76"/>
<polygon fill="black" stroke="black" points="3374.61,-18986.76 3371.11,-18976.76 3367.61,-18986.76 3374.61,-18986.76"/>
</g>
<!-- layer36_moe_comm_from_expert7&#45;&gt;layer36_moe_aggregate -->
<g id="edge2265" class="edge">
<title>layer36_moe_comm_from_expert7&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M3511,-19064.48C3511,-19064.48 3511,-19038.77 3511,-19038.77"/>
<polygon fill="black" stroke="black" points="3514.5,-19038.77 3511,-19028.77 3507.5,-19038.77 3514.5,-19038.77"/>
</g>
<!-- layer36_moe_comm_from_expert8&#45;&gt;layer36_moe_aggregate -->
<g id="edge2267" class="edge">
<title>layer36_moe_comm_from_expert8&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M3782.39,-19064.48C3782.39,-19064.48 3782.39,-19038.77 3782.39,-19038.77"/>
<polygon fill="black" stroke="black" points="3785.89,-19038.77 3782.39,-19028.77 3778.89,-19038.77 3785.89,-19038.77"/>
</g>
<!-- layer36_moe_comm_from_expert9&#45;&gt;layer36_moe_aggregate -->
<g id="edge2269" class="edge">
<title>layer36_moe_comm_from_expert9&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M4073.5,-19065.29C4073.5,-19042.75 4073.5,-19015 4073.5,-19015 4073.5,-19015 3868.03,-19015 3868.03,-19015"/>
<polygon fill="black" stroke="black" points="3868.03,-19011.5 3858.03,-19015 3868.03,-19018.5 3868.03,-19011.5"/>
</g>
<!-- layer36_moe_comm_from_expert10&#45;&gt;layer36_moe_aggregate -->
<g id="edge2271" class="edge">
<title>layer36_moe_comm_from_expert10&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M4405.15,-19065.19C4405.15,-19038.27 4405.15,-19002 4405.15,-19002 4405.15,-19002 3854.81,-19002 3854.81,-19002"/>
<polygon fill="black" stroke="black" points="3854.81,-18998.5 3844.81,-19002 3854.81,-19005.5 3854.81,-18998.5"/>
</g>
<!-- layer36_moe_comm_from_expert11&#45;&gt;layer36_moe_aggregate -->
<g id="edge2273" class="edge">
<title>layer36_moe_comm_from_expert11&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M4751.65,-19065.09C4751.65,-19034.09 4751.65,-18989 4751.65,-18989 4751.65,-18989 3841.47,-18989 3841.47,-18989"/>
<polygon fill="black" stroke="black" points="3841.47,-18985.5 3831.47,-18989 3841.47,-18992.5 3841.47,-18985.5"/>
</g>
<!-- layer36_moe_comm_from_expert12&#45;&gt;layer36_moe_aggregate -->
<g id="edge2275" class="edge">
<title>layer36_moe_comm_from_expert12&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M5102.65,-19065.21C5102.65,-19030.38 5102.65,-18976 5102.65,-18976 5102.65,-18976 3827.94,-18976 3827.94,-18976"/>
<polygon fill="black" stroke="black" points="3827.94,-18972.5 3817.94,-18976 3827.94,-18979.5 3827.94,-18972.5"/>
</g>
<!-- layer36_moe_comm_from_expert13&#45;&gt;layer36_moe_aggregate -->
<g id="edge2277" class="edge">
<title>layer36_moe_comm_from_expert13&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M5456.15,-19065.34C5456.15,-19026.9 5456.15,-18963 5456.15,-18963 5456.15,-18963 3814.52,-18963 3814.52,-18963"/>
<polygon fill="black" stroke="black" points="3814.52,-18959.5 3804.52,-18963 3814.52,-18966.5 3814.52,-18959.5"/>
</g>
<!-- layer36_moe_comm_from_expert14&#45;&gt;layer36_moe_aggregate -->
<g id="edge2279" class="edge">
<title>layer36_moe_comm_from_expert14&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M5811.15,-19065.31C5811.15,-19023.43 5811.15,-18950 5811.15,-18950 5811.15,-18950 3801.06,-18950 3801.06,-18950"/>
<polygon fill="black" stroke="black" points="3801.06,-18946.5 3791.06,-18950 3801.06,-18953.5 3801.06,-18946.5"/>
</g>
<!-- layer36_moe_comm_from_expert15&#45;&gt;layer36_moe_aggregate -->
<g id="edge2281" class="edge">
<title>layer36_moe_comm_from_expert15&#45;&gt;layer36_moe_aggregate</title>
<path fill="none" stroke="black" d="M6166.15,-19065.33C6166.15,-19020.17 6166.15,-18937 6166.15,-18937 6166.15,-18937 3787.72,-18937 3787.72,-18937"/>
<polygon fill="black" stroke="black" points="3787.72,-18933.5 3777.72,-18937 3787.72,-18940.5 3787.72,-18933.5"/>
</g>
<!-- layer37_moe_gate -->
<g id="node1777" class="node">
<title>layer37_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3868.3,-18800.71 3457.4,-18800.71 3351.7,-18696.71 3762.6,-18696.71 3868.3,-18800.71"/>
<text text-anchor="middle" x="3610" y="-18762.71" font-family="Arial" font-size="10.00">GATE L37</text>
<text text-anchor="middle" x="3610" y="-18751.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3610" y="-18740.71" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3610" y="-18729.71" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer37_moe_mha&#45;&gt;layer37_moe_gate -->
<g id="edge2350" class="edge">
<title>layer37_moe_mha&#45;&gt;layer37_moe_gate</title>
<path fill="none" stroke="black" d="M3610,-18836.56C3610,-18836.56 3610,-18810.81 3610,-18810.81"/>
<polygon fill="black" stroke="black" points="3613.5,-18810.81 3610,-18800.81 3606.5,-18810.81 3613.5,-18810.81"/>
</g>
<!-- layer37_moe_split -->
<g id="node1778" class="node">
<title>layer37_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3864.01,-18660.71 3459.94,-18660.71 3355.99,-18556.71 3760.06,-18556.71 3864.01,-18660.71"/>
<text text-anchor="middle" x="3610" y="-18622.71" font-family="Arial" font-size="10.00">SPLIT TOKENS L37</text>
<text text-anchor="middle" x="3610" y="-18611.71" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3610" y="-18600.71" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3610" y="-18589.71" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer37_moe_gate&#45;&gt;layer37_moe_split -->
<g id="edge2351" class="edge">
<title>layer37_moe_gate&#45;&gt;layer37_moe_split</title>
<path fill="none" stroke="black" d="M3610,-18696.58C3610,-18696.58 3610,-18670.89 3610,-18670.89"/>
<polygon fill="black" stroke="black" points="3613.5,-18670.89 3610,-18660.89 3606.5,-18670.89 3613.5,-18670.89"/>
</g>
<!-- layer37_moe_comm_to_expert0 -->
<g id="node1780" class="node">
<title>layer37_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1529" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1529" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1529" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1529" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert0 -->
<g id="edge2285" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3443.83,-18645C2953.62,-18645 1547.5,-18645 1547.5,-18645 1547.5,-18645 1547.5,-18530.19 1547.5,-18530.19"/>
<polygon fill="black" stroke="black" points="1551,-18530.19 1547.5,-18520.19 1544,-18530.19 1551,-18530.19"/>
</g>
<!-- layer37_moe_comm_to_expert1 -->
<g id="node1782" class="node">
<title>layer37_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1774" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1774" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1774" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1774" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert1 -->
<g id="edge2287" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3429.09,-18630C2969.37,-18630 1792.5,-18630 1792.5,-18630 1792.5,-18630 1792.5,-18530.37 1792.5,-18530.37"/>
<polygon fill="black" stroke="black" points="1796,-18530.37 1792.5,-18520.37 1789,-18530.37 1796,-18530.37"/>
</g>
<!-- layer37_moe_comm_to_expert2 -->
<g id="node1784" class="node">
<title>layer37_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2230" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2230" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2230" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2230" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert2 -->
<g id="edge2289" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3414.93,-18616C3038.46,-18616 2248.5,-18616 2248.5,-18616 2248.5,-18616 2248.5,-18530.23 2248.5,-18530.23"/>
<polygon fill="black" stroke="black" points="2252,-18530.23 2248.5,-18520.23 2245,-18530.23 2252,-18530.23"/>
</g>
<!-- layer37_moe_comm_to_expert3 -->
<g id="node1786" class="node">
<title>layer37_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2558" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2558" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2558" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2558" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert3 -->
<g id="edge2291" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3400.23,-18601C3098.15,-18601 2576.5,-18601 2576.5,-18601 2576.5,-18601 2576.5,-18530.15 2576.5,-18530.15"/>
<polygon fill="black" stroke="black" points="2580,-18530.15 2576.5,-18520.15 2573,-18530.15 2580,-18530.15"/>
</g>
<!-- layer37_moe_comm_to_expert4 -->
<g id="node1788" class="node">
<title>layer37_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2821" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2821" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2821" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2821" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert4 -->
<g id="edge2293" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3385.07,-18586C3157.64,-18586 2839.5,-18586 2839.5,-18586 2839.5,-18586 2839.5,-18530.26 2839.5,-18530.26"/>
<polygon fill="black" stroke="black" points="2843,-18530.26 2839.5,-18520.26 2836,-18530.26 2843,-18530.26"/>
</g>
<!-- layer37_moe_comm_to_expert5 -->
<g id="node1790" class="node">
<title>layer37_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3052" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3052" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3052" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3052" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert5 -->
<g id="edge2295" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3370.23,-18571C3226.14,-18571 3070.5,-18571 3070.5,-18571 3070.5,-18571 3070.5,-18530.34 3070.5,-18530.34"/>
<polygon fill="black" stroke="black" points="3074,-18530.34 3070.5,-18520.34 3067,-18530.34 3074,-18530.34"/>
</g>
<!-- layer37_moe_comm_to_expert6 -->
<g id="node1792" class="node">
<title>layer37_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3267" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3267" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3267" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3267" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert6 -->
<g id="edge2297" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3370.5,-18608.63C3370.5,-18605.06 3370.5,-18491 3370.5,-18491 3370.5,-18491 3367.81,-18491 3367.81,-18491"/>
<polygon fill="black" stroke="black" points="3367.81,-18487.5 3357.81,-18491 3367.81,-18494.5 3367.81,-18487.5"/>
</g>
<!-- layer37_moe_comm_to_expert7 -->
<g id="node1794" class="node">
<title>layer37_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3474" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3474" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3474" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3474" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert7 -->
<g id="edge2299" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3474,-18556.38C3474,-18556.38 3474,-18530.93 3474,-18530.93"/>
<polygon fill="black" stroke="black" points="3477.5,-18530.93 3474,-18520.93 3470.5,-18530.93 3477.5,-18530.93"/>
</g>
<!-- layer37_moe_comm_to_expert8 -->
<g id="node1796" class="node">
<title>layer37_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3746" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3746" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3746" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3746" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert8 -->
<g id="edge2301" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3746,-18556.38C3746,-18556.38 3746,-18530.93 3746,-18530.93"/>
<polygon fill="black" stroke="black" points="3749.5,-18530.93 3746,-18520.93 3742.5,-18530.93 3749.5,-18530.93"/>
</g>
<!-- layer37_moe_comm_to_expert9 -->
<g id="node1798" class="node">
<title>layer37_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4055" cy="-18491.72" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4055" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4055" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4055" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert9 -->
<g id="edge2303" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3850.26,-18608.63C3850.26,-18605.06 3850.26,-18491 3850.26,-18491 3850.26,-18491 3954.3,-18491 3954.3,-18491"/>
<polygon fill="black" stroke="black" points="3954.3,-18494.5 3964.3,-18491 3954.3,-18487.5 3954.3,-18494.5"/>
</g>
<!-- layer37_moe_comm_to_expert10 -->
<g id="node1800" class="node">
<title>layer37_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4387" cy="-18491.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4387" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4387" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4387" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert10 -->
<g id="edge2305" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3774.38,-18571C3981.6,-18571 4311.1,-18571 4311.1,-18571 4311.1,-18571 4311.1,-18518.92 4311.1,-18518.92"/>
<polygon fill="black" stroke="black" points="4314.6,-18518.92 4311.1,-18508.92 4307.6,-18518.92 4314.6,-18518.92"/>
</g>
<!-- layer37_moe_comm_to_expert11 -->
<g id="node1802" class="node">
<title>layer37_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4733" cy="-18491.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4733" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4733" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4733" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert11 -->
<g id="edge2307" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3789.49,-18586C4088.86,-18586 4657.6,-18586 4657.6,-18586 4657.6,-18586 4657.6,-18519.45 4657.6,-18519.45"/>
<polygon fill="black" stroke="black" points="4661.1,-18519.45 4657.6,-18509.45 4654.1,-18519.45 4661.1,-18519.45"/>
</g>
<!-- layer37_moe_comm_to_expert12 -->
<g id="node1804" class="node">
<title>layer37_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5084" cy="-18491.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5084" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5084" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5084" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert12 -->
<g id="edge2309" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3804.47,-18601C4188.77,-18601 5008.6,-18601 5008.6,-18601 5008.6,-18601 5008.6,-18519.28 5008.6,-18519.28"/>
<polygon fill="black" stroke="black" points="5012.1,-18519.28 5008.6,-18509.28 5005.1,-18519.28 5012.1,-18519.28"/>
</g>
<!-- layer37_moe_comm_to_expert13 -->
<g id="node1806" class="node">
<title>layer37_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5437" cy="-18491.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5437" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5437" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5437" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert13 -->
<g id="edge2311" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3819.6,-18616C4284.67,-18616 5362.1,-18616 5362.1,-18616 5362.1,-18616 5362.1,-18519.26 5362.1,-18519.26"/>
<polygon fill="black" stroke="black" points="5365.6,-18519.26 5362.1,-18509.26 5358.6,-18519.26 5365.6,-18519.26"/>
</g>
<!-- layer37_moe_comm_to_expert14 -->
<g id="node1808" class="node">
<title>layer37_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5792" cy="-18491.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5792" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5792" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5792" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert14 -->
<g id="edge2313" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3833.5,-18630C4375.79,-18630 5717.1,-18630 5717.1,-18630 5717.1,-18630 5717.1,-18519.51 5717.1,-18519.51"/>
<polygon fill="black" stroke="black" points="5720.6,-18519.51 5717.1,-18509.51 5713.6,-18519.51 5720.6,-18519.51"/>
</g>
<!-- layer37_moe_comm_to_expert15 -->
<g id="node1810" class="node">
<title>layer37_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6147" cy="-18491.72" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6147" y="-18500.22" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6147" y="-18489.22" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6147" y="-18478.22" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert15 -->
<g id="edge2315" class="edge">
<title>layer37_moe_split&#45;&gt;layer37_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3848.31,-18645C4466.21,-18645 6072.1,-18645 6072.1,-18645 6072.1,-18645 6072.1,-18519.3 6072.1,-18519.3"/>
<polygon fill="black" stroke="black" points="6075.6,-18519.3 6072.1,-18509.3 6068.6,-18519.3 6075.6,-18519.3"/>
</g>
<!-- layer37_moe_expert0 -->
<g id="node1779" class="node">
<title>layer37_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1179,-18426.73 851,-18426.73 851,-18374.73 1179,-18374.73 1179,-18426.73"/>
<text text-anchor="middle" x="1015" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 0 L37</text>
<text text-anchor="middle" x="1015" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1015" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="1015" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert0 -->
<g id="node1812" class="node">
<title>layer37_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1061" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1061" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1061" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1061" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer37_moe_expert0&#45;&gt;layer37_moe_comm_from_expert0 -->
<g id="edge2317" class="edge">
<title>layer37_moe_expert0&#45;&gt;layer37_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1061,-18374.41C1061,-18374.41 1061,-18348.87 1061,-18348.87"/>
<polygon fill="black" stroke="black" points="1064.5,-18348.87 1061,-18338.87 1057.5,-18348.87 1064.5,-18348.87"/>
</g>
<!-- layer37_moe_comm_to_expert0&#45;&gt;layer37_moe_expert0 -->
<g id="edge2286" class="edge">
<title>layer37_moe_comm_to_expert0&#45;&gt;layer37_moe_expert0</title>
<path fill="none" stroke="black" d="M1438.41,-18491C1295.42,-18491 1033.5,-18491 1033.5,-18491 1033.5,-18491 1033.5,-18436.84 1033.5,-18436.84"/>
<polygon fill="black" stroke="black" points="1037,-18436.84 1033.5,-18426.84 1030,-18436.84 1037,-18436.84"/>
</g>
<!-- layer37_moe_expert1 -->
<g id="node1781" class="node">
<title>layer37_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1525,-18426.73 1197,-18426.73 1197,-18374.73 1525,-18374.73 1525,-18426.73"/>
<text text-anchor="middle" x="1361" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 1 L37</text>
<text text-anchor="middle" x="1361" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1361" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1361" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert1 -->
<g id="node1813" class="node">
<title>layer37_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1774" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1774" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1774" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1774" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer37_moe_expert1&#45;&gt;layer37_moe_comm_from_expert1 -->
<g id="edge2319" class="edge">
<title>layer37_moe_expert1&#45;&gt;layer37_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1515.5,-18374.69C1515.5,-18347.57 1515.5,-18309 1515.5,-18309 1515.5,-18309 1673.23,-18309 1673.23,-18309"/>
<polygon fill="black" stroke="black" points="1673.23,-18312.5 1683.23,-18309 1673.23,-18305.5 1673.23,-18312.5"/>
</g>
<!-- layer37_moe_comm_to_expert1&#45;&gt;layer37_moe_expert1 -->
<g id="edge2288" class="edge">
<title>layer37_moe_comm_to_expert1&#45;&gt;layer37_moe_expert1</title>
<path fill="none" stroke="black" d="M1774,-18462.7C1774,-18448.74 1774,-18435 1774,-18435 1774,-18435 1481.75,-18435 1481.75,-18435 1481.75,-18435 1481.75,-18434.21 1481.75,-18434.21"/>
<polygon fill="black" stroke="black" points="1485.25,-18437.05 1481.75,-18427.05 1478.25,-18437.05 1485.25,-18437.05"/>
</g>
<!-- layer37_moe_expert2 -->
<g id="node1783" class="node">
<title>layer37_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1871,-18426.73 1543,-18426.73 1543,-18374.73 1871,-18374.73 1871,-18426.73"/>
<text text-anchor="middle" x="1707" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 2 L37</text>
<text text-anchor="middle" x="1707" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1707" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1707" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert2 -->
<g id="node1814" class="node">
<title>layer37_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2230" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2230" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2230" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2230" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer37_moe_expert2&#45;&gt;layer37_moe_comm_from_expert2 -->
<g id="edge2321" class="edge">
<title>layer37_moe_expert2&#45;&gt;layer37_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1871.18,-18392C1878.6,-18392 1883,-18392 1883,-18392 1883,-18392 1883,-18309 1883,-18309 1883,-18309 2129.28,-18309 2129.28,-18309"/>
<polygon fill="black" stroke="black" points="2129.28,-18312.5 2139.28,-18309 2129.28,-18305.5 2129.28,-18312.5"/>
</g>
<!-- layer37_moe_comm_to_expert2&#45;&gt;layer37_moe_expert2 -->
<g id="edge2290" class="edge">
<title>layer37_moe_comm_to_expert2&#45;&gt;layer37_moe_expert2</title>
<path fill="none" stroke="black" d="M2139.09,-18491C2034.5,-18491 1877,-18491 1877,-18491 1877,-18491 1877,-18409 1877,-18409 1877,-18409 1876.43,-18409 1876.43,-18409"/>
<polygon fill="black" stroke="black" points="1881.34,-18405.5 1871.34,-18409 1881.34,-18412.5 1881.34,-18405.5"/>
</g>
<!-- layer37_moe_expert3 -->
<g id="node1785" class="node">
<title>layer37_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2217,-18426.73 1889,-18426.73 1889,-18374.73 2217,-18374.73 2217,-18426.73"/>
<text text-anchor="middle" x="2053" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 3 L37</text>
<text text-anchor="middle" x="2053" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2053" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2053" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert3 -->
<g id="node1815" class="node">
<title>layer37_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2558" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2558" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2558" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2558" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer37_moe_expert3&#45;&gt;layer37_moe_comm_from_expert3 -->
<g id="edge2323" class="edge">
<title>layer37_moe_expert3&#45;&gt;layer37_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2178.25,-18374.47C2178.25,-18362.09 2178.25,-18350 2178.25,-18350 2178.25,-18350 2499.33,-18350 2499.33,-18350 2499.33,-18350 2499.33,-18342.22 2499.33,-18342.22"/>
<polygon fill="black" stroke="black" points="2502.83,-18342.22 2499.33,-18332.22 2495.83,-18342.22 2502.83,-18342.22"/>
</g>
<!-- layer37_moe_comm_to_expert3&#45;&gt;layer37_moe_expert3 -->
<g id="edge2292" class="edge">
<title>layer37_moe_comm_to_expert3&#45;&gt;layer37_moe_expert3</title>
<path fill="none" stroke="black" d="M2499.33,-18469.2C2499.33,-18460.68 2499.33,-18453 2499.33,-18453 2499.33,-18453 2178.25,-18453 2178.25,-18453 2178.25,-18453 2178.25,-18436.86 2178.25,-18436.86"/>
<polygon fill="black" stroke="black" points="2181.75,-18436.86 2178.25,-18426.86 2174.75,-18436.86 2181.75,-18436.86"/>
</g>
<!-- layer37_moe_expert4 -->
<g id="node1787" class="node">
<title>layer37_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2563,-18426.73 2235,-18426.73 2235,-18374.73 2563,-18374.73 2563,-18426.73"/>
<text text-anchor="middle" x="2399" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 4 L37</text>
<text text-anchor="middle" x="2399" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2399" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2399" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert4 -->
<g id="node1816" class="node">
<title>layer37_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2821" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2821" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2821" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2821" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer37_moe_expert4&#45;&gt;layer37_moe_comm_from_expert4 -->
<g id="edge2325" class="edge">
<title>layer37_moe_expert4&#45;&gt;layer37_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2531.16,-18374.68C2531.16,-18367.68 2531.16,-18362 2531.16,-18362 2531.16,-18362 2819.75,-18362 2819.75,-18362 2819.75,-18362 2819.75,-18348.92 2819.75,-18348.92"/>
<polygon fill="black" stroke="black" points="2823.25,-18348.92 2819.75,-18338.92 2816.25,-18348.92 2823.25,-18348.92"/>
</g>
<!-- layer37_moe_comm_to_expert4&#45;&gt;layer37_moe_expert4 -->
<g id="edge2294" class="edge">
<title>layer37_moe_comm_to_expert4&#45;&gt;layer37_moe_expert4</title>
<path fill="none" stroke="black" d="M2819.75,-18462.59C2819.75,-18452.65 2819.75,-18444 2819.75,-18444 2819.75,-18444 2531.16,-18444 2531.16,-18444 2531.16,-18444 2531.16,-18436.9 2531.16,-18436.9"/>
<polygon fill="black" stroke="black" points="2534.66,-18436.9 2531.16,-18426.9 2527.66,-18436.9 2534.66,-18436.9"/>
</g>
<!-- layer37_moe_expert5 -->
<g id="node1789" class="node">
<title>layer37_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2909,-18426.73 2581,-18426.73 2581,-18374.73 2909,-18374.73 2909,-18426.73"/>
<text text-anchor="middle" x="2745" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 5 L37</text>
<text text-anchor="middle" x="2745" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2745" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2745" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert5 -->
<g id="node1817" class="node">
<title>layer37_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3052" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3052" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3052" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3052" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer37_moe_expert5&#45;&gt;layer37_moe_comm_from_expert5 -->
<g id="edge2327" class="edge">
<title>layer37_moe_expert5&#45;&gt;layer37_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2909.21,-18392C2916.1,-18392 2920.16,-18392 2920.16,-18392 2920.16,-18392 2920.16,-18309 2920.16,-18309 2920.16,-18309 2951.52,-18309 2951.52,-18309"/>
<polygon fill="black" stroke="black" points="2951.52,-18312.5 2961.52,-18309 2951.52,-18305.5 2951.52,-18312.5"/>
</g>
<!-- layer37_moe_comm_to_expert5&#45;&gt;layer37_moe_expert5 -->
<g id="edge2296" class="edge">
<title>layer37_moe_comm_to_expert5&#45;&gt;layer37_moe_expert5</title>
<path fill="none" stroke="black" d="M2961.18,-18491C2936.2,-18491 2915.84,-18491 2915.84,-18491 2915.84,-18491 2915.84,-18409 2915.84,-18409 2915.84,-18409 2915.19,-18409 2915.19,-18409"/>
<polygon fill="black" stroke="black" points="2919.35,-18405.5 2909.35,-18409 2919.35,-18412.5 2919.35,-18405.5"/>
</g>
<!-- layer37_moe_expert6 -->
<g id="node1791" class="node">
<title>layer37_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3255,-18426.73 2927,-18426.73 2927,-18374.73 3255,-18374.73 3255,-18426.73"/>
<text text-anchor="middle" x="3091" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 6 L37</text>
<text text-anchor="middle" x="3091" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3091" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3091" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert6 -->
<g id="node1818" class="node">
<title>layer37_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3267" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3267" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3267" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3267" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer37_moe_expert6&#45;&gt;layer37_moe_comm_from_expert6 -->
<g id="edge2329" class="edge">
<title>layer37_moe_expert6&#45;&gt;layer37_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3215.75,-18374.41C3215.75,-18374.41 3215.75,-18343.82 3215.75,-18343.82"/>
<polygon fill="black" stroke="black" points="3219.25,-18343.82 3215.75,-18333.82 3212.25,-18343.82 3219.25,-18343.82"/>
</g>
<!-- layer37_moe_comm_to_expert6&#45;&gt;layer37_moe_expert6 -->
<g id="edge2298" class="edge">
<title>layer37_moe_comm_to_expert6&#45;&gt;layer37_moe_expert6</title>
<path fill="none" stroke="black" d="M3215.75,-18467.81C3215.75,-18467.81 3215.75,-18437.04 3215.75,-18437.04"/>
<polygon fill="black" stroke="black" points="3219.25,-18437.04 3215.75,-18427.04 3212.25,-18437.04 3219.25,-18437.04"/>
</g>
<!-- layer37_moe_expert7 -->
<g id="node1793" class="node">
<title>layer37_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3601,-18426.73 3273,-18426.73 3273,-18374.73 3601,-18374.73 3601,-18426.73"/>
<text text-anchor="middle" x="3437" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 7 L37</text>
<text text-anchor="middle" x="3437" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3437" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3437" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert7 -->
<g id="node1819" class="node">
<title>layer37_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3474" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3474" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3474" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3474" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer37_moe_expert7&#45;&gt;layer37_moe_comm_from_expert7 -->
<g id="edge2331" class="edge">
<title>layer37_moe_expert7&#45;&gt;layer37_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3474,-18374.41C3474,-18374.41 3474,-18348.87 3474,-18348.87"/>
<polygon fill="black" stroke="black" points="3477.5,-18348.87 3474,-18338.87 3470.5,-18348.87 3477.5,-18348.87"/>
</g>
<!-- layer37_moe_comm_to_expert7&#45;&gt;layer37_moe_expert7 -->
<g id="edge2300" class="edge">
<title>layer37_moe_comm_to_expert7&#45;&gt;layer37_moe_expert7</title>
<path fill="none" stroke="black" d="M3474,-18462.68C3474,-18462.68 3474,-18437.03 3474,-18437.03"/>
<polygon fill="black" stroke="black" points="3477.5,-18437.03 3474,-18427.03 3470.5,-18437.03 3477.5,-18437.03"/>
</g>
<!-- layer37_moe_expert8 -->
<g id="node1795" class="node">
<title>layer37_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3947,-18426.73 3619,-18426.73 3619,-18374.73 3947,-18374.73 3947,-18426.73"/>
<text text-anchor="middle" x="3783" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 8 L37</text>
<text text-anchor="middle" x="3783" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3783" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3783" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert8 -->
<g id="node1820" class="node">
<title>layer37_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3746" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3746" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3746" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3746" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer37_moe_expert8&#45;&gt;layer37_moe_comm_from_expert8 -->
<g id="edge2333" class="edge">
<title>layer37_moe_expert8&#45;&gt;layer37_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3746,-18374.41C3746,-18374.41 3746,-18348.87 3746,-18348.87"/>
<polygon fill="black" stroke="black" points="3749.5,-18348.87 3746,-18338.87 3742.5,-18348.87 3749.5,-18348.87"/>
</g>
<!-- layer37_moe_comm_to_expert8&#45;&gt;layer37_moe_expert8 -->
<g id="edge2302" class="edge">
<title>layer37_moe_comm_to_expert8&#45;&gt;layer37_moe_expert8</title>
<path fill="none" stroke="black" d="M3746,-18462.68C3746,-18462.68 3746,-18437.03 3746,-18437.03"/>
<polygon fill="black" stroke="black" points="3749.5,-18437.03 3746,-18427.03 3742.5,-18437.03 3749.5,-18437.03"/>
</g>
<!-- layer37_moe_expert9 -->
<g id="node1797" class="node">
<title>layer37_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4293,-18426.73 3965,-18426.73 3965,-18374.73 4293,-18374.73 4293,-18426.73"/>
<text text-anchor="middle" x="4129" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 9 L37</text>
<text text-anchor="middle" x="4129" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4129" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4129" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert9 -->
<g id="node1821" class="node">
<title>layer37_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4055" cy="-18309.74" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4055" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4055" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4055" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer37_moe_expert9&#45;&gt;layer37_moe_comm_from_expert9 -->
<g id="edge2335" class="edge">
<title>layer37_moe_expert9&#45;&gt;layer37_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4055.25,-18374.41C4055.25,-18374.41 4055.25,-18348.87 4055.25,-18348.87"/>
<polygon fill="black" stroke="black" points="4058.75,-18348.87 4055.25,-18338.87 4051.75,-18348.87 4058.75,-18348.87"/>
</g>
<!-- layer37_moe_comm_to_expert9&#45;&gt;layer37_moe_expert9 -->
<g id="edge2304" class="edge">
<title>layer37_moe_comm_to_expert9&#45;&gt;layer37_moe_expert9</title>
<path fill="none" stroke="black" d="M4055.25,-18462.68C4055.25,-18462.68 4055.25,-18437.03 4055.25,-18437.03"/>
<polygon fill="black" stroke="black" points="4058.75,-18437.03 4055.25,-18427.03 4051.75,-18437.03 4058.75,-18437.03"/>
</g>
<!-- layer37_moe_expert10 -->
<g id="node1799" class="node">
<title>layer37_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4649,-18426.73 4311,-18426.73 4311,-18374.73 4649,-18374.73 4649,-18426.73"/>
<text text-anchor="middle" x="4480" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 10 L37</text>
<text text-anchor="middle" x="4480" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4480" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4480" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert10 -->
<g id="node1822" class="node">
<title>layer37_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4387" cy="-18309.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4387" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4387" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4387" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer37_moe_expert10&#45;&gt;layer37_moe_comm_from_expert10 -->
<g id="edge2337" class="edge">
<title>layer37_moe_expert10&#45;&gt;layer37_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4396.38,-18374.41C4396.38,-18374.41 4396.38,-18348.87 4396.38,-18348.87"/>
<polygon fill="black" stroke="black" points="4399.88,-18348.87 4396.38,-18338.87 4392.88,-18348.87 4399.88,-18348.87"/>
</g>
<!-- layer37_moe_comm_to_expert10&#45;&gt;layer37_moe_expert10 -->
<g id="edge2306" class="edge">
<title>layer37_moe_comm_to_expert10&#45;&gt;layer37_moe_expert10</title>
<path fill="none" stroke="black" d="M4396.02,-18462.68C4396.02,-18462.68 4396.02,-18437.03 4396.02,-18437.03"/>
<polygon fill="black" stroke="black" points="4399.52,-18437.03 4396.02,-18427.03 4392.52,-18437.03 4399.52,-18437.03"/>
</g>
<!-- layer37_moe_expert11 -->
<g id="node1801" class="node">
<title>layer37_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="5005,-18426.73 4667,-18426.73 4667,-18374.73 5005,-18374.73 5005,-18426.73"/>
<text text-anchor="middle" x="4836" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 11 L37</text>
<text text-anchor="middle" x="4836" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4836" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4836" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert11 -->
<g id="node1823" class="node">
<title>layer37_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4734" cy="-18309.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4734" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4734" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4734" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer37_moe_expert11&#45;&gt;layer37_moe_comm_from_expert11 -->
<g id="edge2339" class="edge">
<title>layer37_moe_expert11&#45;&gt;layer37_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4747.88,-18374.41C4747.88,-18374.41 4747.88,-18348.55 4747.88,-18348.55"/>
<polygon fill="black" stroke="black" points="4751.38,-18348.55 4747.88,-18338.55 4744.38,-18348.55 4751.38,-18348.55"/>
</g>
<!-- layer37_moe_comm_to_expert11&#45;&gt;layer37_moe_expert11 -->
<g id="edge2308" class="edge">
<title>layer37_moe_comm_to_expert11&#45;&gt;layer37_moe_expert11</title>
<path fill="none" stroke="black" d="M4747.02,-18462.93C4747.02,-18462.93 4747.02,-18436.86 4747.02,-18436.86"/>
<polygon fill="black" stroke="black" points="4750.52,-18436.86 4747.02,-18426.86 4743.52,-18436.86 4750.52,-18436.86"/>
</g>
<!-- layer37_moe_expert12 -->
<g id="node1803" class="node">
<title>layer37_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5361,-18426.73 5023,-18426.73 5023,-18374.73 5361,-18374.73 5361,-18426.73"/>
<text text-anchor="middle" x="5192" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 12 L37</text>
<text text-anchor="middle" x="5192" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5192" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5192" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert12 -->
<g id="node1824" class="node">
<title>layer37_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5085" cy="-18309.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5085" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5085" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5085" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer37_moe_expert12&#45;&gt;layer37_moe_comm_from_expert12 -->
<g id="edge2341" class="edge">
<title>layer37_moe_expert12&#45;&gt;layer37_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5101.38,-18374.41C5101.38,-18374.41 5101.38,-18348.55 5101.38,-18348.55"/>
<polygon fill="black" stroke="black" points="5104.88,-18348.55 5101.38,-18338.55 5097.88,-18348.55 5104.88,-18348.55"/>
</g>
<!-- layer37_moe_comm_to_expert12&#45;&gt;layer37_moe_expert12 -->
<g id="edge2310" class="edge">
<title>layer37_moe_comm_to_expert12&#45;&gt;layer37_moe_expert12</title>
<path fill="none" stroke="black" d="M5100.52,-18462.93C5100.52,-18462.93 5100.52,-18436.86 5100.52,-18436.86"/>
<polygon fill="black" stroke="black" points="5104.02,-18436.86 5100.52,-18426.86 5097.02,-18436.86 5104.02,-18436.86"/>
</g>
<!-- layer37_moe_expert13 -->
<g id="node1805" class="node">
<title>layer37_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5717,-18426.73 5379,-18426.73 5379,-18374.73 5717,-18374.73 5717,-18426.73"/>
<text text-anchor="middle" x="5548" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 13 L37</text>
<text text-anchor="middle" x="5548" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5548" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5548" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert13 -->
<g id="node1825" class="node">
<title>layer37_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5439" cy="-18309.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5439" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5439" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5439" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer37_moe_expert13&#45;&gt;layer37_moe_comm_from_expert13 -->
<g id="edge2343" class="edge">
<title>layer37_moe_expert13&#45;&gt;layer37_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5456.38,-18374.41C5456.38,-18374.41 5456.38,-18348.55 5456.38,-18348.55"/>
<polygon fill="black" stroke="black" points="5459.88,-18348.55 5456.38,-18338.55 5452.88,-18348.55 5459.88,-18348.55"/>
</g>
<!-- layer37_moe_comm_to_expert13&#45;&gt;layer37_moe_expert13 -->
<g id="edge2312" class="edge">
<title>layer37_moe_comm_to_expert13&#45;&gt;layer37_moe_expert13</title>
<path fill="none" stroke="black" d="M5455.02,-18462.93C5455.02,-18462.93 5455.02,-18436.86 5455.02,-18436.86"/>
<polygon fill="black" stroke="black" points="5458.52,-18436.86 5455.02,-18426.86 5451.52,-18436.86 5458.52,-18436.86"/>
</g>
<!-- layer37_moe_expert14 -->
<g id="node1807" class="node">
<title>layer37_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6073,-18426.73 5735,-18426.73 5735,-18374.73 6073,-18374.73 6073,-18426.73"/>
<text text-anchor="middle" x="5904" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 14 L37</text>
<text text-anchor="middle" x="5904" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5904" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5904" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert14 -->
<g id="node1826" class="node">
<title>layer37_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5794" cy="-18309.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5794" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5794" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5794" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer37_moe_expert14&#45;&gt;layer37_moe_comm_from_expert14 -->
<g id="edge2345" class="edge">
<title>layer37_moe_expert14&#45;&gt;layer37_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5811.88,-18374.41C5811.88,-18374.41 5811.88,-18348.22 5811.88,-18348.22"/>
<polygon fill="black" stroke="black" points="5815.38,-18348.22 5811.88,-18338.22 5808.38,-18348.22 5815.38,-18348.22"/>
</g>
<!-- layer37_moe_comm_to_expert14&#45;&gt;layer37_moe_expert14 -->
<g id="edge2314" class="edge">
<title>layer37_moe_comm_to_expert14&#45;&gt;layer37_moe_expert14</title>
<path fill="none" stroke="black" d="M5810.52,-18462.93C5810.52,-18462.93 5810.52,-18436.86 5810.52,-18436.86"/>
<polygon fill="black" stroke="black" points="5814.02,-18436.86 5810.52,-18426.86 5807.02,-18436.86 5814.02,-18436.86"/>
</g>
<!-- layer37_moe_expert15 -->
<g id="node1809" class="node">
<title>layer37_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6429,-18426.73 6091,-18426.73 6091,-18374.73 6429,-18374.73 6429,-18426.73"/>
<text text-anchor="middle" x="6260" y="-18414.73" font-family="Arial" font-size="10.00">EXPERT 15 L37</text>
<text text-anchor="middle" x="6260" y="-18403.73" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6260" y="-18392.73" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6260" y="-18381.73" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_comm_from_expert15 -->
<g id="node1827" class="node">
<title>layer37_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6149" cy="-18309.74" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6149" y="-18318.24" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6149" y="-18307.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6149" y="-18296.24" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer37_moe_expert15&#45;&gt;layer37_moe_comm_from_expert15 -->
<g id="edge2347" class="edge">
<title>layer37_moe_expert15&#45;&gt;layer37_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6167.38,-18374.41C6167.38,-18374.41 6167.38,-18348.22 6167.38,-18348.22"/>
<polygon fill="black" stroke="black" points="6170.88,-18348.22 6167.38,-18338.22 6163.88,-18348.22 6170.88,-18348.22"/>
</g>
<!-- layer37_moe_comm_to_expert15&#45;&gt;layer37_moe_expert15 -->
<g id="edge2316" class="edge">
<title>layer37_moe_comm_to_expert15&#45;&gt;layer37_moe_expert15</title>
<path fill="none" stroke="black" d="M6166.02,-18462.93C6166.02,-18462.93 6166.02,-18436.86 6166.02,-18436.86"/>
<polygon fill="black" stroke="black" points="6169.52,-18436.86 6166.02,-18426.86 6162.52,-18436.86 6169.52,-18436.86"/>
</g>
<!-- layer37_moe_aggregate -->
<g id="node1811" class="node">
<title>layer37_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3835.1,-18244.75 3418.16,-18244.75 3310.9,-18140.75 3727.84,-18140.75 3835.1,-18244.75"/>
<text text-anchor="middle" x="3573" y="-18206.75" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L37</text>
<text text-anchor="middle" x="3573" y="-18195.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3573" y="-18184.75" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3573" y="-18173.75" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_mha -->
<g id="node1828" class="node">
<title>layer38_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3703,-18104.75 3443,-18104.75 3443,-18052.75 3703,-18052.75 3703,-18104.75"/>
<text text-anchor="middle" x="3573" y="-18092.75" font-family="Arial" font-size="10.00">MHA L38</text>
<text text-anchor="middle" x="3573" y="-18081.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3573" y="-18070.75" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3573" y="-18059.75" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer37_moe_aggregate&#45;&gt;layer38_moe_mha -->
<g id="edge2416" class="edge">
<title>layer37_moe_aggregate&#45;&gt;layer38_moe_mha</title>
<path fill="none" stroke="black" d="M3573,-18140.42C3573,-18140.42 3573,-18114.97 3573,-18114.97"/>
<polygon fill="black" stroke="black" points="3576.5,-18114.97 3573,-18104.97 3569.5,-18114.97 3576.5,-18114.97"/>
</g>
<!-- layer37_moe_comm_from_expert0&#45;&gt;layer37_moe_aggregate -->
<g id="edge2318" class="edge">
<title>layer37_moe_comm_from_expert0&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M1146.75,-18300.06C1146.75,-18266.18 1146.75,-18155 1146.75,-18155 1146.75,-18155 3315.6,-18155 3315.6,-18155"/>
<polygon fill="black" stroke="black" points="3315.6,-18158.5 3325.6,-18155 3315.6,-18151.5 3315.6,-18158.5"/>
</g>
<!-- layer37_moe_comm_from_expert1&#45;&gt;layer37_moe_aggregate -->
<g id="edge2320" class="edge">
<title>layer37_moe_comm_from_expert1&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M1858.25,-18298.77C1858.25,-18265.83 1858.25,-18170 1858.25,-18170 1858.25,-18170 3330.85,-18170 3330.85,-18170"/>
<polygon fill="black" stroke="black" points="3330.85,-18173.5 3340.85,-18170 3330.85,-18166.5 3330.85,-18173.5"/>
</g>
<!-- layer37_moe_comm_from_expert2&#45;&gt;layer37_moe_aggregate -->
<g id="edge2322" class="edge">
<title>layer37_moe_comm_from_expert2&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M2302.01,-18292.13C2302.01,-18257.75 2302.01,-18185 2302.01,-18185 2302.01,-18185 3346.31,-18185 3346.31,-18185"/>
<polygon fill="black" stroke="black" points="3346.31,-18188.5 3356.31,-18185 3346.31,-18181.5 3346.31,-18188.5"/>
</g>
<!-- layer37_moe_comm_from_expert3&#45;&gt;layer37_moe_aggregate -->
<g id="edge2324" class="edge">
<title>layer37_moe_comm_from_expert3&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M2630.01,-18292.11C2630.01,-18261.09 2630.01,-18200 2630.01,-18200 2630.01,-18200 3361.86,-18200 3361.86,-18200"/>
<polygon fill="black" stroke="black" points="3361.86,-18203.5 3371.86,-18200 3361.86,-18196.5 3361.86,-18203.5"/>
</g>
<!-- layer37_moe_comm_from_expert4&#45;&gt;layer37_moe_aggregate -->
<g id="edge2326" class="edge">
<title>layer37_moe_comm_from_expert4&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M2900.75,-18295.76C2900.75,-18269.41 2900.75,-18215 2900.75,-18215 2900.75,-18215 3377.08,-18215 3377.08,-18215"/>
<polygon fill="black" stroke="black" points="3377.08,-18218.5 3387.08,-18215 3377.08,-18211.5 3377.08,-18218.5"/>
</g>
<!-- layer37_moe_comm_from_expert5&#45;&gt;layer37_moe_aggregate -->
<g id="edge2328" class="edge">
<title>layer37_moe_comm_from_expert5&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M3122.5,-18291.42C3122.5,-18267.6 3122.5,-18229 3122.5,-18229 3122.5,-18229 3391.72,-18229 3391.72,-18229"/>
<polygon fill="black" stroke="black" points="3391.72,-18232.5 3401.72,-18229 3391.72,-18225.5 3391.72,-18232.5"/>
</g>
<!-- layer37_moe_comm_from_expert6&#45;&gt;layer37_moe_aggregate -->
<g id="edge2330" class="edge">
<title>layer37_moe_comm_from_expert6&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M3334.11,-18290.16C3334.11,-18290.16 3334.11,-18202.79 3334.11,-18202.79"/>
<polygon fill="black" stroke="black" points="3337.61,-18202.79 3334.11,-18192.79 3330.61,-18202.79 3337.61,-18202.79"/>
</g>
<!-- layer37_moe_comm_from_expert7&#45;&gt;layer37_moe_aggregate -->
<g id="edge2332" class="edge">
<title>layer37_moe_comm_from_expert7&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M3474,-18280.52C3474,-18280.52 3474,-18254.81 3474,-18254.81"/>
<polygon fill="black" stroke="black" points="3477.5,-18254.81 3474,-18244.81 3470.5,-18254.81 3477.5,-18254.81"/>
</g>
<!-- layer37_moe_comm_from_expert8&#45;&gt;layer37_moe_aggregate -->
<g id="edge2334" class="edge">
<title>layer37_moe_comm_from_expert8&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M3745.39,-18280.52C3745.39,-18280.52 3745.39,-18254.81 3745.39,-18254.81"/>
<polygon fill="black" stroke="black" points="3748.89,-18254.81 3745.39,-18244.81 3741.89,-18254.81 3748.89,-18254.81"/>
</g>
<!-- layer37_moe_comm_from_expert9&#45;&gt;layer37_moe_aggregate -->
<g id="edge2336" class="edge">
<title>layer37_moe_comm_from_expert9&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M4036.5,-18281.31C4036.5,-18258.76 4036.5,-18231 4036.5,-18231 4036.5,-18231 3831.03,-18231 3831.03,-18231"/>
<polygon fill="black" stroke="black" points="3831.03,-18227.5 3821.03,-18231 3831.03,-18234.5 3831.03,-18227.5"/>
</g>
<!-- layer37_moe_comm_from_expert10&#45;&gt;layer37_moe_aggregate -->
<g id="edge2338" class="edge">
<title>layer37_moe_comm_from_expert10&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M4368.15,-18281.21C4368.15,-18254.28 4368.15,-18218 4368.15,-18218 4368.15,-18218 3817.54,-18218 3817.54,-18218"/>
<polygon fill="black" stroke="black" points="3817.54,-18214.5 3807.54,-18218 3817.54,-18221.5 3817.54,-18214.5"/>
</g>
<!-- layer37_moe_comm_from_expert11&#45;&gt;layer37_moe_aggregate -->
<g id="edge2340" class="edge">
<title>layer37_moe_comm_from_expert11&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M4714.65,-18281.12C4714.65,-18250.11 4714.65,-18205 4714.65,-18205 4714.65,-18205 3804.14,-18205 3804.14,-18205"/>
<polygon fill="black" stroke="black" points="3804.14,-18201.5 3794.14,-18205 3804.14,-18208.5 3804.14,-18201.5"/>
</g>
<!-- layer37_moe_comm_from_expert12&#45;&gt;layer37_moe_aggregate -->
<g id="edge2342" class="edge">
<title>layer37_moe_comm_from_expert12&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M5065.65,-18281.24C5065.65,-18246.39 5065.65,-18192 5065.65,-18192 5065.65,-18192 3790.94,-18192 3790.94,-18192"/>
<polygon fill="black" stroke="black" points="3790.94,-18188.5 3780.94,-18192 3790.94,-18195.5 3790.94,-18188.5"/>
</g>
<!-- layer37_moe_comm_from_expert13&#45;&gt;layer37_moe_aggregate -->
<g id="edge2344" class="edge">
<title>layer37_moe_comm_from_expert13&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M5419.15,-18281.37C5419.15,-18242.92 5419.15,-18179 5419.15,-18179 5419.15,-18179 3777.52,-18179 3777.52,-18179"/>
<polygon fill="black" stroke="black" points="3777.52,-18175.5 3767.52,-18179 3777.52,-18182.5 3777.52,-18175.5"/>
</g>
<!-- layer37_moe_comm_from_expert14&#45;&gt;layer37_moe_aggregate -->
<g id="edge2346" class="edge">
<title>layer37_moe_comm_from_expert14&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M5774.15,-18281.34C5774.15,-18239.45 5774.15,-18166 5774.15,-18166 5774.15,-18166 3764.06,-18166 3764.06,-18166"/>
<polygon fill="black" stroke="black" points="3764.06,-18162.5 3754.06,-18166 3764.06,-18169.5 3764.06,-18162.5"/>
</g>
<!-- layer37_moe_comm_from_expert15&#45;&gt;layer37_moe_aggregate -->
<g id="edge2348" class="edge">
<title>layer37_moe_comm_from_expert15&#45;&gt;layer37_moe_aggregate</title>
<path fill="none" stroke="black" d="M6129.15,-18281.35C6129.15,-18236.19 6129.15,-18153 6129.15,-18153 6129.15,-18153 3750.72,-18153 3750.72,-18153"/>
<polygon fill="black" stroke="black" points="3750.72,-18149.5 3740.72,-18153 3750.72,-18156.5 3750.72,-18149.5"/>
</g>
<!-- layer38_moe_gate -->
<g id="node1829" class="node">
<title>layer38_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3831.3,-18016.75 3420.4,-18016.75 3314.7,-17912.75 3725.6,-17912.75 3831.3,-18016.75"/>
<text text-anchor="middle" x="3573" y="-17978.75" font-family="Arial" font-size="10.00">GATE L38</text>
<text text-anchor="middle" x="3573" y="-17967.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3573" y="-17956.75" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3573" y="-17945.75" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer38_moe_mha&#45;&gt;layer38_moe_gate -->
<g id="edge2417" class="edge">
<title>layer38_moe_mha&#45;&gt;layer38_moe_gate</title>
<path fill="none" stroke="black" d="M3573,-18052.59C3573,-18052.59 3573,-18026.84 3573,-18026.84"/>
<polygon fill="black" stroke="black" points="3576.5,-18026.84 3573,-18016.84 3569.5,-18026.84 3576.5,-18026.84"/>
</g>
<!-- layer38_moe_split -->
<g id="node1830" class="node">
<title>layer38_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3827.01,-17876.75 3422.94,-17876.75 3318.99,-17772.75 3723.06,-17772.75 3827.01,-17876.75"/>
<text text-anchor="middle" x="3573" y="-17838.75" font-family="Arial" font-size="10.00">SPLIT TOKENS L38</text>
<text text-anchor="middle" x="3573" y="-17827.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3573" y="-17816.75" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3573" y="-17805.75" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer38_moe_gate&#45;&gt;layer38_moe_split -->
<g id="edge2418" class="edge">
<title>layer38_moe_gate&#45;&gt;layer38_moe_split</title>
<path fill="none" stroke="black" d="M3573,-17912.62C3573,-17912.62 3573,-17886.92 3573,-17886.92"/>
<polygon fill="black" stroke="black" points="3576.5,-17886.92 3573,-17876.92 3569.5,-17886.92 3576.5,-17886.92"/>
</g>
<!-- layer38_moe_comm_to_expert0 -->
<g id="node1832" class="node">
<title>layer38_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1024" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1024" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1024" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1024" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert0 -->
<g id="edge2352" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3406.97,-17861C2844,-17861 1042.5,-17861 1042.5,-17861 1042.5,-17861 1042.5,-17746.22 1042.5,-17746.22"/>
<polygon fill="black" stroke="black" points="1046,-17746.22 1042.5,-17736.22 1039,-17746.22 1046,-17746.22"/>
</g>
<!-- layer38_moe_comm_to_expert1 -->
<g id="node1834" class="node">
<title>layer38_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1737" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1737" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1737" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1737" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert1 -->
<g id="edge2354" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3392.92,-17847C2933.8,-17847 1755.5,-17847 1755.5,-17847 1755.5,-17847 1755.5,-17746.27 1755.5,-17746.27"/>
<polygon fill="black" stroke="black" points="1759,-17746.27 1755.5,-17736.27 1752,-17746.27 1759,-17746.27"/>
</g>
<!-- layer38_moe_comm_to_expert2 -->
<g id="node1836" class="node">
<title>layer38_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2193" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2193" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2193" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2193" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert2 -->
<g id="edge2356" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3377.93,-17832C3001.46,-17832 2211.5,-17832 2211.5,-17832 2211.5,-17832 2211.5,-17746.26 2211.5,-17746.26"/>
<polygon fill="black" stroke="black" points="2215,-17746.26 2211.5,-17736.26 2208,-17746.26 2215,-17746.26"/>
</g>
<!-- layer38_moe_comm_to_expert3 -->
<g id="node1838" class="node">
<title>layer38_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2521" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2521" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2521" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2521" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert3 -->
<g id="edge2358" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3362.92,-17817C3060.79,-17817 2539.5,-17817 2539.5,-17817 2539.5,-17817 2539.5,-17746.17 2539.5,-17746.17"/>
<polygon fill="black" stroke="black" points="2543,-17746.17 2539.5,-17736.17 2536,-17746.17 2543,-17746.17"/>
</g>
<!-- layer38_moe_comm_to_expert4 -->
<g id="node1840" class="node">
<title>layer38_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2784" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2784" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2784" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2784" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert4 -->
<g id="edge2360" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3348.07,-17802C3120.64,-17802 2802.5,-17802 2802.5,-17802 2802.5,-17802 2802.5,-17746.29 2802.5,-17746.29"/>
<polygon fill="black" stroke="black" points="2806,-17746.29 2802.5,-17736.29 2799,-17746.29 2806,-17746.29"/>
</g>
<!-- layer38_moe_comm_to_expert5 -->
<g id="node1842" class="node">
<title>layer38_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3015" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3015" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="3015" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3015" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert5 -->
<g id="edge2362" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3333.23,-17787C3189.14,-17787 3033.5,-17787 3033.5,-17787 3033.5,-17787 3033.5,-17746.36 3033.5,-17746.36"/>
<polygon fill="black" stroke="black" points="3037,-17746.36 3033.5,-17736.36 3030,-17746.36 3037,-17746.36"/>
</g>
<!-- layer38_moe_comm_to_expert6 -->
<g id="node1844" class="node">
<title>layer38_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3230" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3230" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3230" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3230" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert6 -->
<g id="edge2364" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3333.5,-17824.66C3333.5,-17821.1 3333.5,-17707 3333.5,-17707 3333.5,-17707 3330.81,-17707 3330.81,-17707"/>
<polygon fill="black" stroke="black" points="3330.81,-17703.5 3320.81,-17707 3330.81,-17710.5 3330.81,-17703.5"/>
</g>
<!-- layer38_moe_comm_to_expert7 -->
<g id="node1846" class="node">
<title>layer38_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3437" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3437" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3437" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3437" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert7 -->
<g id="edge2366" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3437,-17772.41C3437,-17772.41 3437,-17746.97 3437,-17746.97"/>
<polygon fill="black" stroke="black" points="3440.5,-17746.97 3437,-17736.97 3433.5,-17746.97 3440.5,-17746.97"/>
</g>
<!-- layer38_moe_comm_to_expert8 -->
<g id="node1848" class="node">
<title>layer38_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3709" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3709" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3709" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3709" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert8 -->
<g id="edge2368" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3709,-17772.41C3709,-17772.41 3709,-17746.97 3709,-17746.97"/>
<polygon fill="black" stroke="black" points="3712.5,-17746.97 3709,-17736.97 3705.5,-17746.97 3712.5,-17746.97"/>
</g>
<!-- layer38_moe_comm_to_expert9 -->
<g id="node1850" class="node">
<title>layer38_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4018" cy="-17707.75" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4018" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="4018" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4018" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert9 -->
<g id="edge2370" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3813.26,-17824.66C3813.26,-17821.1 3813.26,-17707 3813.26,-17707 3813.26,-17707 3917.3,-17707 3917.3,-17707"/>
<polygon fill="black" stroke="black" points="3917.3,-17710.5 3927.3,-17707 3917.3,-17703.5 3917.3,-17710.5"/>
</g>
<!-- layer38_moe_comm_to_expert10 -->
<g id="node1852" class="node">
<title>layer38_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4350" cy="-17707.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4350" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4350" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4350" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert10 -->
<g id="edge2372" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3737.38,-17787C3944.6,-17787 4274.1,-17787 4274.1,-17787 4274.1,-17787 4274.1,-17734.95 4274.1,-17734.95"/>
<polygon fill="black" stroke="black" points="4277.6,-17734.95 4274.1,-17724.95 4270.6,-17734.95 4277.6,-17734.95"/>
</g>
<!-- layer38_moe_comm_to_expert11 -->
<g id="node1854" class="node">
<title>layer38_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4696" cy="-17707.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4696" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4696" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4696" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert11 -->
<g id="edge2374" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3752.49,-17802C4051.86,-17802 4620.6,-17802 4620.6,-17802 4620.6,-17802 4620.6,-17735.48 4620.6,-17735.48"/>
<polygon fill="black" stroke="black" points="4624.1,-17735.48 4620.6,-17725.48 4617.1,-17735.48 4624.1,-17735.48"/>
</g>
<!-- layer38_moe_comm_to_expert12 -->
<g id="node1856" class="node">
<title>layer38_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5047" cy="-17707.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5047" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5047" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5047" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert12 -->
<g id="edge2376" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3767.47,-17817C4151.77,-17817 4971.6,-17817 4971.6,-17817 4971.6,-17817 4971.6,-17735.31 4971.6,-17735.31"/>
<polygon fill="black" stroke="black" points="4975.1,-17735.31 4971.6,-17725.31 4968.1,-17735.31 4975.1,-17735.31"/>
</g>
<!-- layer38_moe_comm_to_expert13 -->
<g id="node1858" class="node">
<title>layer38_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5400" cy="-17707.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5400" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5400" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5400" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert13 -->
<g id="edge2378" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3782.6,-17832C4247.67,-17832 5325.1,-17832 5325.1,-17832 5325.1,-17832 5325.1,-17735.29 5325.1,-17735.29"/>
<polygon fill="black" stroke="black" points="5328.6,-17735.29 5325.1,-17725.29 5321.6,-17735.29 5328.6,-17735.29"/>
</g>
<!-- layer38_moe_comm_to_expert14 -->
<g id="node1860" class="node">
<title>layer38_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5755" cy="-17707.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5755" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5755" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5755" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert14 -->
<g id="edge2380" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3797.5,-17847C4340.43,-17847 5680.1,-17847 5680.1,-17847 5680.1,-17847 5680.1,-17735.39 5680.1,-17735.39"/>
<polygon fill="black" stroke="black" points="5683.6,-17735.39 5680.1,-17725.39 5676.6,-17735.39 5683.6,-17735.39"/>
</g>
<!-- layer38_moe_comm_to_expert15 -->
<g id="node1862" class="node">
<title>layer38_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6110" cy="-17707.75" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6110" y="-17716.25" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6110" y="-17705.25" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6110" y="-17694.25" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert15 -->
<g id="edge2382" class="edge">
<title>layer38_moe_split&#45;&gt;layer38_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3811.31,-17861C4429.21,-17861 6035.1,-17861 6035.1,-17861 6035.1,-17861 6035.1,-17735.33 6035.1,-17735.33"/>
<polygon fill="black" stroke="black" points="6038.6,-17735.33 6035.1,-17725.33 6031.6,-17735.33 6038.6,-17735.33"/>
</g>
<!-- layer38_moe_expert0 -->
<g id="node1831" class="node">
<title>layer38_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1142,-17642.76 814,-17642.76 814,-17590.76 1142,-17590.76 1142,-17642.76"/>
<text text-anchor="middle" x="978" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 0 L38</text>
<text text-anchor="middle" x="978" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="978" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="978" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert0 -->
<g id="node1864" class="node">
<title>layer38_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1024" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1024" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1024" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1024" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer38_moe_expert0&#45;&gt;layer38_moe_comm_from_expert0 -->
<g id="edge2384" class="edge">
<title>layer38_moe_expert0&#45;&gt;layer38_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M1024,-17590.44C1024,-17590.44 1024,-17564.9 1024,-17564.9"/>
<polygon fill="black" stroke="black" points="1027.5,-17564.9 1024,-17554.9 1020.5,-17564.9 1027.5,-17564.9"/>
</g>
<!-- layer38_moe_comm_to_expert0&#45;&gt;layer38_moe_expert0 -->
<g id="edge2353" class="edge">
<title>layer38_moe_comm_to_expert0&#45;&gt;layer38_moe_expert0</title>
<path fill="none" stroke="black" d="M1024,-17678.71C1024,-17678.71 1024,-17653.06 1024,-17653.06"/>
<polygon fill="black" stroke="black" points="1027.5,-17653.06 1024,-17643.06 1020.5,-17653.06 1027.5,-17653.06"/>
</g>
<!-- layer38_moe_expert1 -->
<g id="node1833" class="node">
<title>layer38_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1488,-17642.76 1160,-17642.76 1160,-17590.76 1488,-17590.76 1488,-17642.76"/>
<text text-anchor="middle" x="1324" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 1 L38</text>
<text text-anchor="middle" x="1324" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1324" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1324" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert1 -->
<g id="node1865" class="node">
<title>layer38_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1737" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1737" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1737" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1737" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer38_moe_expert1&#45;&gt;layer38_moe_comm_from_expert1 -->
<g id="edge2386" class="edge">
<title>layer38_moe_expert1&#45;&gt;layer38_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1478.5,-17590.71C1478.5,-17563.58 1478.5,-17525 1478.5,-17525 1478.5,-17525 1636.23,-17525 1636.23,-17525"/>
<polygon fill="black" stroke="black" points="1636.23,-17528.5 1646.23,-17525 1636.23,-17521.5 1636.23,-17528.5"/>
</g>
<!-- layer38_moe_comm_to_expert1&#45;&gt;layer38_moe_expert1 -->
<g id="edge2355" class="edge">
<title>layer38_moe_comm_to_expert1&#45;&gt;layer38_moe_expert1</title>
<path fill="none" stroke="black" d="M1646.49,-17707C1530.02,-17707 1342.5,-17707 1342.5,-17707 1342.5,-17707 1342.5,-17652.86 1342.5,-17652.86"/>
<polygon fill="black" stroke="black" points="1346,-17652.86 1342.5,-17642.86 1339,-17652.86 1346,-17652.86"/>
</g>
<!-- layer38_moe_expert2 -->
<g id="node1835" class="node">
<title>layer38_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1834,-17642.76 1506,-17642.76 1506,-17590.76 1834,-17590.76 1834,-17642.76"/>
<text text-anchor="middle" x="1670" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 2 L38</text>
<text text-anchor="middle" x="1670" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1670" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1670" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert2 -->
<g id="node1866" class="node">
<title>layer38_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2193" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2193" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2193" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2193" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer38_moe_expert2&#45;&gt;layer38_moe_comm_from_expert2 -->
<g id="edge2388" class="edge">
<title>layer38_moe_expert2&#45;&gt;layer38_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1834.18,-17608C1841.6,-17608 1846,-17608 1846,-17608 1846,-17608 1846,-17525 1846,-17525 1846,-17525 2092.28,-17525 2092.28,-17525"/>
<polygon fill="black" stroke="black" points="2092.28,-17528.5 2102.28,-17525 2092.28,-17521.5 2092.28,-17528.5"/>
</g>
<!-- layer38_moe_comm_to_expert2&#45;&gt;layer38_moe_expert2 -->
<g id="edge2357" class="edge">
<title>layer38_moe_comm_to_expert2&#45;&gt;layer38_moe_expert2</title>
<path fill="none" stroke="black" d="M2102.09,-17707C1997.5,-17707 1840,-17707 1840,-17707 1840,-17707 1840,-17625 1840,-17625 1840,-17625 1839.43,-17625 1839.43,-17625"/>
<polygon fill="black" stroke="black" points="1844.34,-17621.5 1834.34,-17625 1844.34,-17628.5 1844.34,-17621.5"/>
</g>
<!-- layer38_moe_expert3 -->
<g id="node1837" class="node">
<title>layer38_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2180,-17642.76 1852,-17642.76 1852,-17590.76 2180,-17590.76 2180,-17642.76"/>
<text text-anchor="middle" x="2016" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 3 L38</text>
<text text-anchor="middle" x="2016" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2016" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="2016" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert3 -->
<g id="node1867" class="node">
<title>layer38_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2521" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2521" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2521" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2521" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer38_moe_expert3&#45;&gt;layer38_moe_comm_from_expert3 -->
<g id="edge2390" class="edge">
<title>layer38_moe_expert3&#45;&gt;layer38_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2141.25,-17590.49C2141.25,-17578.1 2141.25,-17566 2141.25,-17566 2141.25,-17566 2462.33,-17566 2462.33,-17566 2462.33,-17566 2462.33,-17558.24 2462.33,-17558.24"/>
<polygon fill="black" stroke="black" points="2465.83,-17558.24 2462.33,-17548.24 2458.83,-17558.24 2465.83,-17558.24"/>
</g>
<!-- layer38_moe_comm_to_expert3&#45;&gt;layer38_moe_expert3 -->
<g id="edge2359" class="edge">
<title>layer38_moe_comm_to_expert3&#45;&gt;layer38_moe_expert3</title>
<path fill="none" stroke="black" d="M2462.33,-17685.41C2462.33,-17675.48 2462.33,-17666 2462.33,-17666 2462.33,-17666 2141.25,-17666 2141.25,-17666 2141.25,-17666 2141.25,-17652.82 2141.25,-17652.82"/>
<polygon fill="black" stroke="black" points="2144.75,-17652.82 2141.25,-17642.82 2137.75,-17652.82 2144.75,-17652.82"/>
</g>
<!-- layer38_moe_expert4 -->
<g id="node1839" class="node">
<title>layer38_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2526,-17642.76 2198,-17642.76 2198,-17590.76 2526,-17590.76 2526,-17642.76"/>
<text text-anchor="middle" x="2362" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 4 L38</text>
<text text-anchor="middle" x="2362" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2362" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2362" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert4 -->
<g id="node1868" class="node">
<title>layer38_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2784" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2784" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2784" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2784" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer38_moe_expert4&#45;&gt;layer38_moe_comm_from_expert4 -->
<g id="edge2392" class="edge">
<title>layer38_moe_expert4&#45;&gt;layer38_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2494.16,-17590.69C2494.16,-17583.68 2494.16,-17578 2494.16,-17578 2494.16,-17578 2782.75,-17578 2782.75,-17578 2782.75,-17578 2782.75,-17564.94 2782.75,-17564.94"/>
<polygon fill="black" stroke="black" points="2786.25,-17564.94 2782.75,-17554.94 2779.25,-17564.94 2786.25,-17564.94"/>
</g>
<!-- layer38_moe_comm_to_expert4&#45;&gt;layer38_moe_expert4 -->
<g id="edge2361" class="edge">
<title>layer38_moe_comm_to_expert4&#45;&gt;layer38_moe_expert4</title>
<path fill="none" stroke="black" d="M2782.75,-17678.67C2782.75,-17666.01 2782.75,-17654 2782.75,-17654 2782.75,-17654 2494.16,-17654 2494.16,-17654 2494.16,-17654 2494.16,-17652.9 2494.16,-17652.9"/>
<polygon fill="black" stroke="black" points="2497.66,-17653.03 2494.16,-17643.03 2490.66,-17653.03 2497.66,-17653.03"/>
</g>
<!-- layer38_moe_expert5 -->
<g id="node1841" class="node">
<title>layer38_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2872,-17642.76 2544,-17642.76 2544,-17590.76 2872,-17590.76 2872,-17642.76"/>
<text text-anchor="middle" x="2708" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 5 L38</text>
<text text-anchor="middle" x="2708" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2708" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2708" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert5 -->
<g id="node1869" class="node">
<title>layer38_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="3015" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3015" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="3015" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3015" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer38_moe_expert5&#45;&gt;layer38_moe_comm_from_expert5 -->
<g id="edge2394" class="edge">
<title>layer38_moe_expert5&#45;&gt;layer38_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2872.21,-17608C2879.1,-17608 2883.16,-17608 2883.16,-17608 2883.16,-17608 2883.16,-17525 2883.16,-17525 2883.16,-17525 2914.52,-17525 2914.52,-17525"/>
<polygon fill="black" stroke="black" points="2914.52,-17528.5 2924.52,-17525 2914.52,-17521.5 2914.52,-17528.5"/>
</g>
<!-- layer38_moe_comm_to_expert5&#45;&gt;layer38_moe_expert5 -->
<g id="edge2363" class="edge">
<title>layer38_moe_comm_to_expert5&#45;&gt;layer38_moe_expert5</title>
<path fill="none" stroke="black" d="M2924.18,-17707C2899.2,-17707 2878.84,-17707 2878.84,-17707 2878.84,-17707 2878.84,-17625 2878.84,-17625 2878.84,-17625 2878.19,-17625 2878.19,-17625"/>
<polygon fill="black" stroke="black" points="2882.35,-17621.5 2872.35,-17625 2882.35,-17628.5 2882.35,-17621.5"/>
</g>
<!-- layer38_moe_expert6 -->
<g id="node1843" class="node">
<title>layer38_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3218,-17642.76 2890,-17642.76 2890,-17590.76 3218,-17590.76 3218,-17642.76"/>
<text text-anchor="middle" x="3054" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 6 L38</text>
<text text-anchor="middle" x="3054" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3054" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3054" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert6 -->
<g id="node1870" class="node">
<title>layer38_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3230" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3230" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3230" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3230" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer38_moe_expert6&#45;&gt;layer38_moe_comm_from_expert6 -->
<g id="edge2396" class="edge">
<title>layer38_moe_expert6&#45;&gt;layer38_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3178.75,-17590.44C3178.75,-17590.44 3178.75,-17559.85 3178.75,-17559.85"/>
<polygon fill="black" stroke="black" points="3182.25,-17559.85 3178.75,-17549.85 3175.25,-17559.85 3182.25,-17559.85"/>
</g>
<!-- layer38_moe_comm_to_expert6&#45;&gt;layer38_moe_expert6 -->
<g id="edge2365" class="edge">
<title>layer38_moe_comm_to_expert6&#45;&gt;layer38_moe_expert6</title>
<path fill="none" stroke="black" d="M3178.75,-17683.85C3178.75,-17683.85 3178.75,-17653.07 3178.75,-17653.07"/>
<polygon fill="black" stroke="black" points="3182.25,-17653.07 3178.75,-17643.07 3175.25,-17653.07 3182.25,-17653.07"/>
</g>
<!-- layer38_moe_expert7 -->
<g id="node1845" class="node">
<title>layer38_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3564,-17642.76 3236,-17642.76 3236,-17590.76 3564,-17590.76 3564,-17642.76"/>
<text text-anchor="middle" x="3400" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 7 L38</text>
<text text-anchor="middle" x="3400" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3400" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3400" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert7 -->
<g id="node1871" class="node">
<title>layer38_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3437" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3437" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3437" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3437" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer38_moe_expert7&#45;&gt;layer38_moe_comm_from_expert7 -->
<g id="edge2398" class="edge">
<title>layer38_moe_expert7&#45;&gt;layer38_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3437,-17590.44C3437,-17590.44 3437,-17564.9 3437,-17564.9"/>
<polygon fill="black" stroke="black" points="3440.5,-17564.9 3437,-17554.9 3433.5,-17564.9 3440.5,-17564.9"/>
</g>
<!-- layer38_moe_comm_to_expert7&#45;&gt;layer38_moe_expert7 -->
<g id="edge2367" class="edge">
<title>layer38_moe_comm_to_expert7&#45;&gt;layer38_moe_expert7</title>
<path fill="none" stroke="black" d="M3437,-17678.71C3437,-17678.71 3437,-17653.06 3437,-17653.06"/>
<polygon fill="black" stroke="black" points="3440.5,-17653.06 3437,-17643.06 3433.5,-17653.06 3440.5,-17653.06"/>
</g>
<!-- layer38_moe_expert8 -->
<g id="node1847" class="node">
<title>layer38_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3910,-17642.76 3582,-17642.76 3582,-17590.76 3910,-17590.76 3910,-17642.76"/>
<text text-anchor="middle" x="3746" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 8 L38</text>
<text text-anchor="middle" x="3746" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3746" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3746" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert8 -->
<g id="node1872" class="node">
<title>layer38_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3709" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3709" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3709" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3709" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer38_moe_expert8&#45;&gt;layer38_moe_comm_from_expert8 -->
<g id="edge2400" class="edge">
<title>layer38_moe_expert8&#45;&gt;layer38_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3709,-17590.44C3709,-17590.44 3709,-17564.9 3709,-17564.9"/>
<polygon fill="black" stroke="black" points="3712.5,-17564.9 3709,-17554.9 3705.5,-17564.9 3712.5,-17564.9"/>
</g>
<!-- layer38_moe_comm_to_expert8&#45;&gt;layer38_moe_expert8 -->
<g id="edge2369" class="edge">
<title>layer38_moe_comm_to_expert8&#45;&gt;layer38_moe_expert8</title>
<path fill="none" stroke="black" d="M3709,-17678.71C3709,-17678.71 3709,-17653.06 3709,-17653.06"/>
<polygon fill="black" stroke="black" points="3712.5,-17653.06 3709,-17643.06 3705.5,-17653.06 3712.5,-17653.06"/>
</g>
<!-- layer38_moe_expert9 -->
<g id="node1849" class="node">
<title>layer38_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4256,-17642.76 3928,-17642.76 3928,-17590.76 4256,-17590.76 4256,-17642.76"/>
<text text-anchor="middle" x="4092" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 9 L38</text>
<text text-anchor="middle" x="4092" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4092" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4092" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert9 -->
<g id="node1873" class="node">
<title>layer38_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="4018" cy="-17525.77" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="4018" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="4018" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4018" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer38_moe_expert9&#45;&gt;layer38_moe_comm_from_expert9 -->
<g id="edge2402" class="edge">
<title>layer38_moe_expert9&#45;&gt;layer38_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M4018.25,-17590.44C4018.25,-17590.44 4018.25,-17564.9 4018.25,-17564.9"/>
<polygon fill="black" stroke="black" points="4021.75,-17564.9 4018.25,-17554.9 4014.75,-17564.9 4021.75,-17564.9"/>
</g>
<!-- layer38_moe_comm_to_expert9&#45;&gt;layer38_moe_expert9 -->
<g id="edge2371" class="edge">
<title>layer38_moe_comm_to_expert9&#45;&gt;layer38_moe_expert9</title>
<path fill="none" stroke="black" d="M4018.25,-17678.71C4018.25,-17678.71 4018.25,-17653.06 4018.25,-17653.06"/>
<polygon fill="black" stroke="black" points="4021.75,-17653.06 4018.25,-17643.06 4014.75,-17653.06 4021.75,-17653.06"/>
</g>
<!-- layer38_moe_expert10 -->
<g id="node1851" class="node">
<title>layer38_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4612,-17642.76 4274,-17642.76 4274,-17590.76 4612,-17590.76 4612,-17642.76"/>
<text text-anchor="middle" x="4443" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 10 L38</text>
<text text-anchor="middle" x="4443" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4443" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4443" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert10 -->
<g id="node1874" class="node">
<title>layer38_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4350" cy="-17525.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4350" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4350" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4350" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer38_moe_expert10&#45;&gt;layer38_moe_comm_from_expert10 -->
<g id="edge2404" class="edge">
<title>layer38_moe_expert10&#45;&gt;layer38_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4359.38,-17590.44C4359.38,-17590.44 4359.38,-17564.9 4359.38,-17564.9"/>
<polygon fill="black" stroke="black" points="4362.88,-17564.9 4359.38,-17554.9 4355.88,-17564.9 4362.88,-17564.9"/>
</g>
<!-- layer38_moe_comm_to_expert10&#45;&gt;layer38_moe_expert10 -->
<g id="edge2373" class="edge">
<title>layer38_moe_comm_to_expert10&#45;&gt;layer38_moe_expert10</title>
<path fill="none" stroke="black" d="M4359.02,-17678.71C4359.02,-17678.71 4359.02,-17653.06 4359.02,-17653.06"/>
<polygon fill="black" stroke="black" points="4362.52,-17653.06 4359.02,-17643.06 4355.52,-17653.06 4362.52,-17653.06"/>
</g>
<!-- layer38_moe_expert11 -->
<g id="node1853" class="node">
<title>layer38_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4968,-17642.76 4630,-17642.76 4630,-17590.76 4968,-17590.76 4968,-17642.76"/>
<text text-anchor="middle" x="4799" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 11 L38</text>
<text text-anchor="middle" x="4799" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4799" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4799" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert11 -->
<g id="node1875" class="node">
<title>layer38_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4697" cy="-17525.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4697" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4697" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4697" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer38_moe_expert11&#45;&gt;layer38_moe_comm_from_expert11 -->
<g id="edge2406" class="edge">
<title>layer38_moe_expert11&#45;&gt;layer38_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4710.88,-17590.44C4710.88,-17590.44 4710.88,-17564.58 4710.88,-17564.58"/>
<polygon fill="black" stroke="black" points="4714.38,-17564.58 4710.88,-17554.58 4707.38,-17564.58 4714.38,-17564.58"/>
</g>
<!-- layer38_moe_comm_to_expert11&#45;&gt;layer38_moe_expert11 -->
<g id="edge2375" class="edge">
<title>layer38_moe_comm_to_expert11&#45;&gt;layer38_moe_expert11</title>
<path fill="none" stroke="black" d="M4710.02,-17678.96C4710.02,-17678.96 4710.02,-17652.9 4710.02,-17652.9"/>
<polygon fill="black" stroke="black" points="4713.52,-17652.9 4710.02,-17642.9 4706.52,-17652.9 4713.52,-17652.9"/>
</g>
<!-- layer38_moe_expert12 -->
<g id="node1855" class="node">
<title>layer38_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5324,-17642.76 4986,-17642.76 4986,-17590.76 5324,-17590.76 5324,-17642.76"/>
<text text-anchor="middle" x="5155" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 12 L38</text>
<text text-anchor="middle" x="5155" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5155" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5155" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert12 -->
<g id="node1876" class="node">
<title>layer38_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5048" cy="-17525.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5048" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5048" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5048" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer38_moe_expert12&#45;&gt;layer38_moe_comm_from_expert12 -->
<g id="edge2408" class="edge">
<title>layer38_moe_expert12&#45;&gt;layer38_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5064.38,-17590.44C5064.38,-17590.44 5064.38,-17564.58 5064.38,-17564.58"/>
<polygon fill="black" stroke="black" points="5067.88,-17564.58 5064.38,-17554.58 5060.88,-17564.58 5067.88,-17564.58"/>
</g>
<!-- layer38_moe_comm_to_expert12&#45;&gt;layer38_moe_expert12 -->
<g id="edge2377" class="edge">
<title>layer38_moe_comm_to_expert12&#45;&gt;layer38_moe_expert12</title>
<path fill="none" stroke="black" d="M5063.52,-17678.96C5063.52,-17678.96 5063.52,-17652.9 5063.52,-17652.9"/>
<polygon fill="black" stroke="black" points="5067.02,-17652.9 5063.52,-17642.9 5060.02,-17652.9 5067.02,-17652.9"/>
</g>
<!-- layer38_moe_expert13 -->
<g id="node1857" class="node">
<title>layer38_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5680,-17642.76 5342,-17642.76 5342,-17590.76 5680,-17590.76 5680,-17642.76"/>
<text text-anchor="middle" x="5511" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 13 L38</text>
<text text-anchor="middle" x="5511" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5511" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5511" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert13 -->
<g id="node1877" class="node">
<title>layer38_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5402" cy="-17525.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5402" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5402" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5402" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer38_moe_expert13&#45;&gt;layer38_moe_comm_from_expert13 -->
<g id="edge2410" class="edge">
<title>layer38_moe_expert13&#45;&gt;layer38_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5419.38,-17590.44C5419.38,-17590.44 5419.38,-17564.58 5419.38,-17564.58"/>
<polygon fill="black" stroke="black" points="5422.88,-17564.58 5419.38,-17554.58 5415.88,-17564.58 5422.88,-17564.58"/>
</g>
<!-- layer38_moe_comm_to_expert13&#45;&gt;layer38_moe_expert13 -->
<g id="edge2379" class="edge">
<title>layer38_moe_comm_to_expert13&#45;&gt;layer38_moe_expert13</title>
<path fill="none" stroke="black" d="M5418.02,-17678.96C5418.02,-17678.96 5418.02,-17652.9 5418.02,-17652.9"/>
<polygon fill="black" stroke="black" points="5421.52,-17652.9 5418.02,-17642.9 5414.52,-17652.9 5421.52,-17652.9"/>
</g>
<!-- layer38_moe_expert14 -->
<g id="node1859" class="node">
<title>layer38_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="6036,-17642.76 5698,-17642.76 5698,-17590.76 6036,-17590.76 6036,-17642.76"/>
<text text-anchor="middle" x="5867" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 14 L38</text>
<text text-anchor="middle" x="5867" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5867" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5867" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert14 -->
<g id="node1878" class="node">
<title>layer38_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5757" cy="-17525.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5757" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5757" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5757" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer38_moe_expert14&#45;&gt;layer38_moe_comm_from_expert14 -->
<g id="edge2412" class="edge">
<title>layer38_moe_expert14&#45;&gt;layer38_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5774.88,-17590.44C5774.88,-17590.44 5774.88,-17564.26 5774.88,-17564.26"/>
<polygon fill="black" stroke="black" points="5778.38,-17564.26 5774.88,-17554.26 5771.38,-17564.26 5778.38,-17564.26"/>
</g>
<!-- layer38_moe_comm_to_expert14&#45;&gt;layer38_moe_expert14 -->
<g id="edge2381" class="edge">
<title>layer38_moe_comm_to_expert14&#45;&gt;layer38_moe_expert14</title>
<path fill="none" stroke="black" d="M5773.52,-17678.96C5773.52,-17678.96 5773.52,-17652.9 5773.52,-17652.9"/>
<polygon fill="black" stroke="black" points="5777.02,-17652.9 5773.52,-17642.9 5770.02,-17652.9 5777.02,-17652.9"/>
</g>
<!-- layer38_moe_expert15 -->
<g id="node1861" class="node">
<title>layer38_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6392,-17642.76 6054,-17642.76 6054,-17590.76 6392,-17590.76 6392,-17642.76"/>
<text text-anchor="middle" x="6223" y="-17630.76" font-family="Arial" font-size="10.00">EXPERT 15 L38</text>
<text text-anchor="middle" x="6223" y="-17619.76" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6223" y="-17608.76" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6223" y="-17597.76" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_comm_from_expert15 -->
<g id="node1879" class="node">
<title>layer38_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6112" cy="-17525.77" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6112" y="-17534.27" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6112" y="-17523.27" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6112" y="-17512.27" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer38_moe_expert15&#45;&gt;layer38_moe_comm_from_expert15 -->
<g id="edge2414" class="edge">
<title>layer38_moe_expert15&#45;&gt;layer38_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6130.38,-17590.44C6130.38,-17590.44 6130.38,-17564.26 6130.38,-17564.26"/>
<polygon fill="black" stroke="black" points="6133.88,-17564.26 6130.38,-17554.26 6126.88,-17564.26 6133.88,-17564.26"/>
</g>
<!-- layer38_moe_comm_to_expert15&#45;&gt;layer38_moe_expert15 -->
<g id="edge2383" class="edge">
<title>layer38_moe_comm_to_expert15&#45;&gt;layer38_moe_expert15</title>
<path fill="none" stroke="black" d="M6129.02,-17678.96C6129.02,-17678.96 6129.02,-17652.9 6129.02,-17652.9"/>
<polygon fill="black" stroke="black" points="6132.52,-17652.9 6129.02,-17642.9 6125.52,-17652.9 6132.52,-17652.9"/>
</g>
<!-- layer38_moe_aggregate -->
<g id="node1863" class="node">
<title>layer38_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3798.1,-17460.78 3381.16,-17460.78 3273.9,-17356.78 3690.84,-17356.78 3798.1,-17460.78"/>
<text text-anchor="middle" x="3536" y="-17422.78" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L38</text>
<text text-anchor="middle" x="3536" y="-17411.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3536" y="-17400.78" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3536" y="-17389.78" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_mha -->
<g id="node1880" class="node">
<title>layer39_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3666,-17320.78 3406,-17320.78 3406,-17268.78 3666,-17268.78 3666,-17320.78"/>
<text text-anchor="middle" x="3536" y="-17308.78" font-family="Arial" font-size="10.00">MHA L39</text>
<text text-anchor="middle" x="3536" y="-17297.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3536" y="-17286.78" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3536" y="-17275.78" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer38_moe_aggregate&#45;&gt;layer39_moe_mha -->
<g id="edge2483" class="edge">
<title>layer38_moe_aggregate&#45;&gt;layer39_moe_mha</title>
<path fill="none" stroke="black" d="M3536,-17356.45C3536,-17356.45 3536,-17331.01 3536,-17331.01"/>
<polygon fill="black" stroke="black" points="3539.5,-17331.01 3536,-17321.01 3532.5,-17331.01 3539.5,-17331.01"/>
</g>
<!-- layer38_moe_comm_from_expert0&#45;&gt;layer38_moe_aggregate -->
<g id="edge2385" class="edge">
<title>layer38_moe_comm_from_expert0&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M1109.75,-17516.09C1109.75,-17482.21 1109.75,-17371 1109.75,-17371 1109.75,-17371 3278.32,-17371 3278.32,-17371"/>
<polygon fill="black" stroke="black" points="3278.32,-17374.5 3288.32,-17371 3278.32,-17367.5 3278.32,-17374.5"/>
</g>
<!-- layer38_moe_comm_from_expert1&#45;&gt;layer38_moe_aggregate -->
<g id="edge2387" class="edge">
<title>layer38_moe_comm_from_expert1&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M1821.25,-17514.8C1821.25,-17481.85 1821.25,-17386 1821.25,-17386 1821.25,-17386 3293.85,-17386 3293.85,-17386"/>
<polygon fill="black" stroke="black" points="3293.85,-17389.5 3303.85,-17386 3293.85,-17382.5 3293.85,-17389.5"/>
</g>
<!-- layer38_moe_comm_from_expert2&#45;&gt;layer38_moe_aggregate -->
<g id="edge2389" class="edge">
<title>layer38_moe_comm_from_expert2&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M2265.01,-17508.16C2265.01,-17473.77 2265.01,-17401 2265.01,-17401 2265.01,-17401 3309.31,-17401 3309.31,-17401"/>
<polygon fill="black" stroke="black" points="3309.31,-17404.5 3319.31,-17401 3309.31,-17397.5 3309.31,-17404.5"/>
</g>
<!-- layer38_moe_comm_from_expert3&#45;&gt;layer38_moe_aggregate -->
<g id="edge2391" class="edge">
<title>layer38_moe_comm_from_expert3&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M2593.01,-17508.14C2593.01,-17477.11 2593.01,-17416 2593.01,-17416 2593.01,-17416 3324.86,-17416 3324.86,-17416"/>
<polygon fill="black" stroke="black" points="3324.86,-17419.5 3334.86,-17416 3324.86,-17412.5 3324.86,-17419.5"/>
</g>
<!-- layer38_moe_comm_from_expert4&#45;&gt;layer38_moe_aggregate -->
<g id="edge2393" class="edge">
<title>layer38_moe_comm_from_expert4&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M2863.75,-17511.79C2863.75,-17485.43 2863.75,-17431 2863.75,-17431 2863.75,-17431 3340.08,-17431 3340.08,-17431"/>
<polygon fill="black" stroke="black" points="3340.08,-17434.5 3350.08,-17431 3340.08,-17427.5 3340.08,-17434.5"/>
</g>
<!-- layer38_moe_comm_from_expert5&#45;&gt;layer38_moe_aggregate -->
<g id="edge2395" class="edge">
<title>layer38_moe_comm_from_expert5&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M3085.5,-17507.44C3085.5,-17483.61 3085.5,-17445 3085.5,-17445 3085.5,-17445 3354.72,-17445 3354.72,-17445"/>
<polygon fill="black" stroke="black" points="3354.72,-17448.5 3364.72,-17445 3354.72,-17441.5 3354.72,-17448.5"/>
</g>
<!-- layer38_moe_comm_from_expert6&#45;&gt;layer38_moe_aggregate -->
<g id="edge2397" class="edge">
<title>layer38_moe_comm_from_expert6&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M3297.11,-17506.19C3297.11,-17506.19 3297.11,-17418.83 3297.11,-17418.83"/>
<polygon fill="black" stroke="black" points="3300.61,-17418.83 3297.11,-17408.83 3293.61,-17418.83 3300.61,-17418.83"/>
</g>
<!-- layer38_moe_comm_from_expert7&#45;&gt;layer38_moe_aggregate -->
<g id="edge2399" class="edge">
<title>layer38_moe_comm_from_expert7&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M3437,-17496.55C3437,-17496.55 3437,-17470.84 3437,-17470.84"/>
<polygon fill="black" stroke="black" points="3440.5,-17470.84 3437,-17460.84 3433.5,-17470.84 3440.5,-17470.84"/>
</g>
<!-- layer38_moe_comm_from_expert8&#45;&gt;layer38_moe_aggregate -->
<g id="edge2401" class="edge">
<title>layer38_moe_comm_from_expert8&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M3708.39,-17496.55C3708.39,-17496.55 3708.39,-17470.84 3708.39,-17470.84"/>
<polygon fill="black" stroke="black" points="3711.89,-17470.84 3708.39,-17460.84 3704.89,-17470.84 3711.89,-17470.84"/>
</g>
<!-- layer38_moe_comm_from_expert9&#45;&gt;layer38_moe_aggregate -->
<g id="edge2403" class="edge">
<title>layer38_moe_comm_from_expert9&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M3999.5,-17497.33C3999.5,-17474.77 3999.5,-17447 3999.5,-17447 3999.5,-17447 3794.03,-17447 3794.03,-17447"/>
<polygon fill="black" stroke="black" points="3794.03,-17443.5 3784.03,-17447 3794.03,-17450.5 3794.03,-17443.5"/>
</g>
<!-- layer38_moe_comm_from_expert10&#45;&gt;layer38_moe_aggregate -->
<g id="edge2405" class="edge">
<title>layer38_moe_comm_from_expert10&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M4331.15,-17497.24C4331.15,-17470.3 4331.15,-17434 4331.15,-17434 4331.15,-17434 3780.54,-17434 3780.54,-17434"/>
<polygon fill="black" stroke="black" points="3780.54,-17430.5 3770.54,-17434 3780.54,-17437.5 3780.54,-17430.5"/>
</g>
<!-- layer38_moe_comm_from_expert11&#45;&gt;layer38_moe_aggregate -->
<g id="edge2407" class="edge">
<title>layer38_moe_comm_from_expert11&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M4677.65,-17497.14C4677.65,-17466.12 4677.65,-17421 4677.65,-17421 4677.65,-17421 3767.14,-17421 3767.14,-17421"/>
<polygon fill="black" stroke="black" points="3767.14,-17417.5 3757.14,-17421 3767.14,-17424.5 3767.14,-17417.5"/>
</g>
<!-- layer38_moe_comm_from_expert12&#45;&gt;layer38_moe_aggregate -->
<g id="edge2409" class="edge">
<title>layer38_moe_comm_from_expert12&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M5028.65,-17497.26C5028.65,-17462.41 5028.65,-17408 5028.65,-17408 5028.65,-17408 3753.94,-17408 3753.94,-17408"/>
<polygon fill="black" stroke="black" points="3753.94,-17404.5 3743.94,-17408 3753.94,-17411.5 3753.94,-17404.5"/>
</g>
<!-- layer38_moe_comm_from_expert13&#45;&gt;layer38_moe_aggregate -->
<g id="edge2411" class="edge">
<title>layer38_moe_comm_from_expert13&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M5382.15,-17497.4C5382.15,-17458.94 5382.15,-17395 5382.15,-17395 5382.15,-17395 3740.52,-17395 3740.52,-17395"/>
<polygon fill="black" stroke="black" points="3740.52,-17391.5 3730.52,-17395 3740.52,-17398.5 3740.52,-17391.5"/>
</g>
<!-- layer38_moe_comm_from_expert14&#45;&gt;layer38_moe_aggregate -->
<g id="edge2413" class="edge">
<title>layer38_moe_comm_from_expert14&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M5737.15,-17497.37C5737.15,-17455.47 5737.15,-17382 5737.15,-17382 5737.15,-17382 3727.06,-17382 3727.06,-17382"/>
<polygon fill="black" stroke="black" points="3727.06,-17378.5 3717.06,-17382 3727.06,-17385.5 3727.06,-17378.5"/>
</g>
<!-- layer38_moe_comm_from_expert15&#45;&gt;layer38_moe_aggregate -->
<g id="edge2415" class="edge">
<title>layer38_moe_comm_from_expert15&#45;&gt;layer38_moe_aggregate</title>
<path fill="none" stroke="black" d="M6092.15,-17497.38C6092.15,-17452.2 6092.15,-17369 6092.15,-17369 6092.15,-17369 3713.72,-17369 3713.72,-17369"/>
<polygon fill="black" stroke="black" points="3713.72,-17365.5 3703.72,-17369 3713.72,-17372.5 3713.72,-17365.5"/>
</g>
<!-- layer39_moe_gate -->
<g id="node1881" class="node">
<title>layer39_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3794.3,-17232.78 3383.4,-17232.78 3277.7,-17128.78 3688.6,-17128.78 3794.3,-17232.78"/>
<text text-anchor="middle" x="3536" y="-17194.78" font-family="Arial" font-size="10.00">GATE L39</text>
<text text-anchor="middle" x="3536" y="-17183.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3536" y="-17172.78" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3536" y="-17161.78" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer39_moe_mha&#45;&gt;layer39_moe_gate -->
<g id="edge2484" class="edge">
<title>layer39_moe_mha&#45;&gt;layer39_moe_gate</title>
<path fill="none" stroke="black" d="M3536,-17268.63C3536,-17268.63 3536,-17242.88 3536,-17242.88"/>
<polygon fill="black" stroke="black" points="3539.5,-17242.88 3536,-17232.88 3532.5,-17242.88 3539.5,-17242.88"/>
</g>
<!-- layer39_moe_split -->
<g id="node1882" class="node">
<title>layer39_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3790.01,-17092.78 3385.94,-17092.78 3281.99,-16988.78 3686.06,-16988.78 3790.01,-17092.78"/>
<text text-anchor="middle" x="3536" y="-17054.78" font-family="Arial" font-size="10.00">SPLIT TOKENS L39</text>
<text text-anchor="middle" x="3536" y="-17043.78" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3536" y="-17032.78" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3536" y="-17021.78" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer39_moe_gate&#45;&gt;layer39_moe_split -->
<g id="edge2485" class="edge">
<title>layer39_moe_gate&#45;&gt;layer39_moe_split</title>
<path fill="none" stroke="black" d="M3536,-17128.65C3536,-17128.65 3536,-17102.95 3536,-17102.95"/>
<polygon fill="black" stroke="black" points="3539.5,-17102.95 3536,-17092.95 3532.5,-17102.95 3539.5,-17102.95"/>
</g>
<!-- layer39_moe_comm_to_expert0 -->
<g id="node1884" class="node">
<title>layer39_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="987" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="987" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="987" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="987" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert0 -->
<g id="edge2419" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3369.97,-17077C2807,-17077 1005.5,-17077 1005.5,-17077 1005.5,-17077 1005.5,-16962.25 1005.5,-16962.25"/>
<polygon fill="black" stroke="black" points="1009,-16962.25 1005.5,-16952.25 1002,-16962.25 1009,-16962.25"/>
</g>
<!-- layer39_moe_comm_to_expert1 -->
<g id="node1886" class="node">
<title>layer39_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1700" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1700" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1700" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1700" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert1 -->
<g id="edge2421" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3355.92,-17063C2896.8,-17063 1718.5,-17063 1718.5,-17063 1718.5,-17063 1718.5,-16962.3 1718.5,-16962.3"/>
<polygon fill="black" stroke="black" points="1722,-16962.3 1718.5,-16952.3 1715,-16962.3 1722,-16962.3"/>
</g>
<!-- layer39_moe_comm_to_expert2 -->
<g id="node1888" class="node">
<title>layer39_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2156" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2156" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2156" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2156" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert2 -->
<g id="edge2423" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3340.93,-17048C2964.46,-17048 2174.5,-17048 2174.5,-17048 2174.5,-17048 2174.5,-16962.29 2174.5,-16962.29"/>
<polygon fill="black" stroke="black" points="2178,-16962.29 2174.5,-16952.29 2171,-16962.29 2178,-16962.29"/>
</g>
<!-- layer39_moe_comm_to_expert3 -->
<g id="node1890" class="node">
<title>layer39_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2484" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2484" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2484" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2484" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert3 -->
<g id="edge2425" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3325.92,-17033C3023.79,-17033 2502.5,-17033 2502.5,-17033 2502.5,-17033 2502.5,-16962.2 2502.5,-16962.2"/>
<polygon fill="black" stroke="black" points="2506,-16962.2 2502.5,-16952.2 2499,-16962.2 2506,-16962.2"/>
</g>
<!-- layer39_moe_comm_to_expert4 -->
<g id="node1892" class="node">
<title>layer39_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2747" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2747" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2747" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2747" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert4 -->
<g id="edge2427" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3311.07,-17018C3083.64,-17018 2765.5,-17018 2765.5,-17018 2765.5,-17018 2765.5,-16962.31 2765.5,-16962.31"/>
<polygon fill="black" stroke="black" points="2769,-16962.31 2765.5,-16952.31 2762,-16962.31 2769,-16962.31"/>
</g>
<!-- layer39_moe_comm_to_expert5 -->
<g id="node1894" class="node">
<title>layer39_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2978" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2978" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2978" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2978" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert5 -->
<g id="edge2429" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3295.83,-17003C3151.86,-17003 2996.5,-17003 2996.5,-17003 2996.5,-17003 2996.5,-16962.39 2996.5,-16962.39"/>
<polygon fill="black" stroke="black" points="3000,-16962.39 2996.5,-16952.39 2993,-16962.39 3000,-16962.39"/>
</g>
<!-- layer39_moe_comm_to_expert6 -->
<g id="node1896" class="node">
<title>layer39_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3193" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3193" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3193" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3193" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert6 -->
<g id="edge2431" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3296.5,-17040.7C3296.5,-17037.13 3296.5,-16923 3296.5,-16923 3296.5,-16923 3293.81,-16923 3293.81,-16923"/>
<polygon fill="black" stroke="black" points="3293.81,-16919.5 3283.81,-16923 3293.81,-16926.5 3293.81,-16919.5"/>
</g>
<!-- layer39_moe_comm_to_expert7 -->
<g id="node1898" class="node">
<title>layer39_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3400" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3400" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3400" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert7 -->
<g id="edge2433" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3400,-16988.44C3400,-16988.44 3400,-16963 3400,-16963"/>
<polygon fill="black" stroke="black" points="3403.5,-16963 3400,-16953 3396.5,-16963 3403.5,-16963"/>
</g>
<!-- layer39_moe_comm_to_expert8 -->
<g id="node1900" class="node">
<title>layer39_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3672" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3672" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3672" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3672" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert8 -->
<g id="edge2435" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3672,-16988.44C3672,-16988.44 3672,-16963 3672,-16963"/>
<polygon fill="black" stroke="black" points="3675.5,-16963 3672,-16953 3668.5,-16963 3675.5,-16963"/>
</g>
<!-- layer39_moe_comm_to_expert9 -->
<g id="node1902" class="node">
<title>layer39_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3981" cy="-16923.79" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3981" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3981" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3981" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert9 -->
<g id="edge2437" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.26,-17040.7C3776.26,-17037.13 3776.26,-16923 3776.26,-16923 3776.26,-16923 3880.3,-16923 3880.3,-16923"/>
<polygon fill="black" stroke="black" points="3880.3,-16926.5 3890.3,-16923 3880.3,-16919.5 3880.3,-16926.5"/>
</g>
<!-- layer39_moe_comm_to_expert10 -->
<g id="node1904" class="node">
<title>layer39_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4313" cy="-16923.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4313" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4313" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4313" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert10 -->
<g id="edge2439" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3700.38,-17003C3907.6,-17003 4237.1,-17003 4237.1,-17003 4237.1,-17003 4237.1,-16950.98 4237.1,-16950.98"/>
<polygon fill="black" stroke="black" points="4240.6,-16950.98 4237.1,-16940.98 4233.6,-16950.98 4240.6,-16950.98"/>
</g>
<!-- layer39_moe_comm_to_expert11 -->
<g id="node1906" class="node">
<title>layer39_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4659" cy="-16923.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4659" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4659" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4659" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert11 -->
<g id="edge2441" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3715.49,-17018C4014.86,-17018 4583.6,-17018 4583.6,-17018 4583.6,-17018 4583.6,-16951.51 4583.6,-16951.51"/>
<polygon fill="black" stroke="black" points="4587.1,-16951.51 4583.6,-16941.51 4580.1,-16951.51 4587.1,-16951.51"/>
</g>
<!-- layer39_moe_comm_to_expert12 -->
<g id="node1908" class="node">
<title>layer39_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5010" cy="-16923.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5010" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="5010" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5010" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert12 -->
<g id="edge2443" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3730.47,-17033C4114.77,-17033 4934.6,-17033 4934.6,-17033 4934.6,-17033 4934.6,-16951.34 4934.6,-16951.34"/>
<polygon fill="black" stroke="black" points="4938.1,-16951.34 4934.6,-16941.34 4931.1,-16951.34 4938.1,-16951.34"/>
</g>
<!-- layer39_moe_comm_to_expert13 -->
<g id="node1910" class="node">
<title>layer39_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5363" cy="-16923.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5363" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5363" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5363" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert13 -->
<g id="edge2445" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3745.6,-17048C4210.67,-17048 5288.1,-17048 5288.1,-17048 5288.1,-17048 5288.1,-16951.32 5288.1,-16951.32"/>
<polygon fill="black" stroke="black" points="5291.6,-16951.32 5288.1,-16941.32 5284.6,-16951.32 5291.6,-16951.32"/>
</g>
<!-- layer39_moe_comm_to_expert14 -->
<g id="node1912" class="node">
<title>layer39_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5718" cy="-16923.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5718" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5718" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5718" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert14 -->
<g id="edge2447" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3760.5,-17063C4303.43,-17063 5643.1,-17063 5643.1,-17063 5643.1,-17063 5643.1,-16951.42 5643.1,-16951.42"/>
<polygon fill="black" stroke="black" points="5646.6,-16951.42 5643.1,-16941.42 5639.6,-16951.42 5646.6,-16951.42"/>
</g>
<!-- layer39_moe_comm_to_expert15 -->
<g id="node1914" class="node">
<title>layer39_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6073" cy="-16923.79" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6073" y="-16932.29" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6073" y="-16921.29" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6073" y="-16910.29" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert15 -->
<g id="edge2449" class="edge">
<title>layer39_moe_split&#45;&gt;layer39_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3774.31,-17077C4392.21,-17077 5998.1,-17077 5998.1,-17077 5998.1,-17077 5998.1,-16951.36 5998.1,-16951.36"/>
<polygon fill="black" stroke="black" points="6001.6,-16951.36 5998.1,-16941.36 5994.6,-16951.36 6001.6,-16951.36"/>
</g>
<!-- layer39_moe_expert0 -->
<g id="node1883" class="node">
<title>layer39_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1105,-16858.8 777,-16858.8 777,-16806.8 1105,-16806.8 1105,-16858.8"/>
<text text-anchor="middle" x="941" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 0 L39</text>
<text text-anchor="middle" x="941" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="941" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="941" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert0 -->
<g id="node1916" class="node">
<title>layer39_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="987" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="987" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="987" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="987" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer39_moe_expert0&#45;&gt;layer39_moe_comm_from_expert0 -->
<g id="edge2451" class="edge">
<title>layer39_moe_expert0&#45;&gt;layer39_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M987,-16806.48C987,-16806.48 987,-16780.94 987,-16780.94"/>
<polygon fill="black" stroke="black" points="990.5,-16780.94 987,-16770.94 983.5,-16780.94 990.5,-16780.94"/>
</g>
<!-- layer39_moe_comm_to_expert0&#45;&gt;layer39_moe_expert0 -->
<g id="edge2420" class="edge">
<title>layer39_moe_comm_to_expert0&#45;&gt;layer39_moe_expert0</title>
<path fill="none" stroke="black" d="M987,-16894.75C987,-16894.75 987,-16869.1 987,-16869.1"/>
<polygon fill="black" stroke="black" points="990.5,-16869.1 987,-16859.1 983.5,-16869.1 990.5,-16869.1"/>
</g>
<!-- layer39_moe_expert1 -->
<g id="node1885" class="node">
<title>layer39_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1451,-16858.8 1123,-16858.8 1123,-16806.8 1451,-16806.8 1451,-16858.8"/>
<text text-anchor="middle" x="1287" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 1 L39</text>
<text text-anchor="middle" x="1287" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1287" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1287" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert1 -->
<g id="node1917" class="node">
<title>layer39_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1700" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1700" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1700" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1700" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer39_moe_expert1&#45;&gt;layer39_moe_comm_from_expert1 -->
<g id="edge2453" class="edge">
<title>layer39_moe_expert1&#45;&gt;layer39_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1389.25,-16806.74C1389.25,-16779.6 1389.25,-16741 1389.25,-16741 1389.25,-16741 1599.28,-16741 1599.28,-16741"/>
<polygon fill="black" stroke="black" points="1599.28,-16744.5 1609.28,-16741 1599.28,-16737.5 1599.28,-16744.5"/>
</g>
<!-- layer39_moe_comm_to_expert1&#45;&gt;layer39_moe_expert1 -->
<g id="edge2422" class="edge">
<title>layer39_moe_comm_to_expert1&#45;&gt;layer39_moe_expert1</title>
<path fill="none" stroke="black" d="M1609.49,-16923C1493.02,-16923 1305.5,-16923 1305.5,-16923 1305.5,-16923 1305.5,-16868.89 1305.5,-16868.89"/>
<polygon fill="black" stroke="black" points="1309,-16868.89 1305.5,-16858.89 1302,-16868.89 1309,-16868.89"/>
</g>
<!-- layer39_moe_expert2 -->
<g id="node1887" class="node">
<title>layer39_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1797,-16858.8 1469,-16858.8 1469,-16806.8 1797,-16806.8 1797,-16858.8"/>
<text text-anchor="middle" x="1633" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 2 L39</text>
<text text-anchor="middle" x="1633" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1633" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1633" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert2 -->
<g id="node1918" class="node">
<title>layer39_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2156" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2156" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2156" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2156" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer39_moe_expert2&#45;&gt;layer39_moe_comm_from_expert2 -->
<g id="edge2455" class="edge">
<title>layer39_moe_expert2&#45;&gt;layer39_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1797.18,-16824C1804.6,-16824 1809,-16824 1809,-16824 1809,-16824 1809,-16741 1809,-16741 1809,-16741 2055.28,-16741 2055.28,-16741"/>
<polygon fill="black" stroke="black" points="2055.28,-16744.5 2065.28,-16741 2055.28,-16737.5 2055.28,-16744.5"/>
</g>
<!-- layer39_moe_comm_to_expert2&#45;&gt;layer39_moe_expert2 -->
<g id="edge2424" class="edge">
<title>layer39_moe_comm_to_expert2&#45;&gt;layer39_moe_expert2</title>
<path fill="none" stroke="black" d="M2065.09,-16923C1960.5,-16923 1803,-16923 1803,-16923 1803,-16923 1803,-16841 1803,-16841 1803,-16841 1802.43,-16841 1802.43,-16841"/>
<polygon fill="black" stroke="black" points="1807.34,-16837.5 1797.34,-16841 1807.34,-16844.5 1807.34,-16837.5"/>
</g>
<!-- layer39_moe_expert3 -->
<g id="node1889" class="node">
<title>layer39_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2143,-16858.8 1815,-16858.8 1815,-16806.8 2143,-16806.8 2143,-16858.8"/>
<text text-anchor="middle" x="1979" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 3 L39</text>
<text text-anchor="middle" x="1979" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1979" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1979" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert3 -->
<g id="node1919" class="node">
<title>layer39_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2484" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2484" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2484" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2484" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer39_moe_expert3&#45;&gt;layer39_moe_comm_from_expert3 -->
<g id="edge2457" class="edge">
<title>layer39_moe_expert3&#45;&gt;layer39_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2104.25,-16806.51C2104.25,-16794.11 2104.25,-16782 2104.25,-16782 2104.25,-16782 2425.33,-16782 2425.33,-16782 2425.33,-16782 2425.33,-16774.25 2425.33,-16774.25"/>
<polygon fill="black" stroke="black" points="2428.83,-16774.25 2425.33,-16764.25 2421.83,-16774.25 2428.83,-16774.25"/>
</g>
<!-- layer39_moe_comm_to_expert3&#45;&gt;layer39_moe_expert3 -->
<g id="edge2426" class="edge">
<title>layer39_moe_comm_to_expert3&#45;&gt;layer39_moe_expert3</title>
<path fill="none" stroke="black" d="M2425.33,-16901.43C2425.33,-16891.49 2425.33,-16882 2425.33,-16882 2425.33,-16882 2104.25,-16882 2104.25,-16882 2104.25,-16882 2104.25,-16868.84 2104.25,-16868.84"/>
<polygon fill="black" stroke="black" points="2107.75,-16868.84 2104.25,-16858.84 2100.75,-16868.84 2107.75,-16868.84"/>
</g>
<!-- layer39_moe_expert4 -->
<g id="node1891" class="node">
<title>layer39_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2489,-16858.8 2161,-16858.8 2161,-16806.8 2489,-16806.8 2489,-16858.8"/>
<text text-anchor="middle" x="2325" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 4 L39</text>
<text text-anchor="middle" x="2325" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2325" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2325" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert4 -->
<g id="node1920" class="node">
<title>layer39_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2747" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2747" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2747" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2747" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer39_moe_expert4&#45;&gt;layer39_moe_comm_from_expert4 -->
<g id="edge2459" class="edge">
<title>layer39_moe_expert4&#45;&gt;layer39_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2457.16,-16806.7C2457.16,-16799.69 2457.16,-16794 2457.16,-16794 2457.16,-16794 2745.75,-16794 2745.75,-16794 2745.75,-16794 2745.75,-16780.96 2745.75,-16780.96"/>
<polygon fill="black" stroke="black" points="2749.25,-16780.96 2745.75,-16770.96 2742.25,-16780.96 2749.25,-16780.96"/>
</g>
<!-- layer39_moe_comm_to_expert4&#45;&gt;layer39_moe_expert4 -->
<g id="edge2428" class="edge">
<title>layer39_moe_comm_to_expert4&#45;&gt;layer39_moe_expert4</title>
<path fill="none" stroke="black" d="M2745.75,-16894.69C2745.75,-16882.02 2745.75,-16870 2745.75,-16870 2745.75,-16870 2457.16,-16870 2457.16,-16870 2457.16,-16870 2457.16,-16868.9 2457.16,-16868.9"/>
<polygon fill="black" stroke="black" points="2460.66,-16869.04 2457.16,-16859.04 2453.66,-16869.04 2460.66,-16869.04"/>
</g>
<!-- layer39_moe_expert5 -->
<g id="node1893" class="node">
<title>layer39_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2835,-16858.8 2507,-16858.8 2507,-16806.8 2835,-16806.8 2835,-16858.8"/>
<text text-anchor="middle" x="2671" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 5 L39</text>
<text text-anchor="middle" x="2671" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2671" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2671" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert5 -->
<g id="node1921" class="node">
<title>layer39_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2978" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2978" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2978" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2978" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer39_moe_expert5&#45;&gt;layer39_moe_comm_from_expert5 -->
<g id="edge2461" class="edge">
<title>layer39_moe_expert5&#45;&gt;layer39_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2835.21,-16824C2842.1,-16824 2846.16,-16824 2846.16,-16824 2846.16,-16824 2846.16,-16741 2846.16,-16741 2846.16,-16741 2877.52,-16741 2877.52,-16741"/>
<polygon fill="black" stroke="black" points="2877.52,-16744.5 2887.52,-16741 2877.52,-16737.5 2877.52,-16744.5"/>
</g>
<!-- layer39_moe_comm_to_expert5&#45;&gt;layer39_moe_expert5 -->
<g id="edge2430" class="edge">
<title>layer39_moe_comm_to_expert5&#45;&gt;layer39_moe_expert5</title>
<path fill="none" stroke="black" d="M2887.18,-16923C2862.2,-16923 2841.84,-16923 2841.84,-16923 2841.84,-16923 2841.84,-16841 2841.84,-16841 2841.84,-16841 2841.19,-16841 2841.19,-16841"/>
<polygon fill="black" stroke="black" points="2845.35,-16837.5 2835.35,-16841 2845.35,-16844.5 2845.35,-16837.5"/>
</g>
<!-- layer39_moe_expert6 -->
<g id="node1895" class="node">
<title>layer39_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3181,-16858.8 2853,-16858.8 2853,-16806.8 3181,-16806.8 3181,-16858.8"/>
<text text-anchor="middle" x="3017" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 6 L39</text>
<text text-anchor="middle" x="3017" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3017" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="3017" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert6 -->
<g id="node1922" class="node">
<title>layer39_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3193" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3193" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3193" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3193" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer39_moe_expert6&#45;&gt;layer39_moe_comm_from_expert6 -->
<g id="edge2463" class="edge">
<title>layer39_moe_expert6&#45;&gt;layer39_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3141.75,-16806.48C3141.75,-16806.48 3141.75,-16775.89 3141.75,-16775.89"/>
<polygon fill="black" stroke="black" points="3145.25,-16775.89 3141.75,-16765.89 3138.25,-16775.89 3145.25,-16775.89"/>
</g>
<!-- layer39_moe_comm_to_expert6&#45;&gt;layer39_moe_expert6 -->
<g id="edge2432" class="edge">
<title>layer39_moe_comm_to_expert6&#45;&gt;layer39_moe_expert6</title>
<path fill="none" stroke="black" d="M3141.75,-16899.88C3141.75,-16899.88 3141.75,-16869.1 3141.75,-16869.1"/>
<polygon fill="black" stroke="black" points="3145.25,-16869.1 3141.75,-16859.1 3138.25,-16869.1 3145.25,-16869.1"/>
</g>
<!-- layer39_moe_expert7 -->
<g id="node1897" class="node">
<title>layer39_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3527,-16858.8 3199,-16858.8 3199,-16806.8 3527,-16806.8 3527,-16858.8"/>
<text text-anchor="middle" x="3363" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 7 L39</text>
<text text-anchor="middle" x="3363" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3363" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3363" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert7 -->
<g id="node1923" class="node">
<title>layer39_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3400" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3400" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3400" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3400" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer39_moe_expert7&#45;&gt;layer39_moe_comm_from_expert7 -->
<g id="edge2465" class="edge">
<title>layer39_moe_expert7&#45;&gt;layer39_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3400,-16806.48C3400,-16806.48 3400,-16780.94 3400,-16780.94"/>
<polygon fill="black" stroke="black" points="3403.5,-16780.94 3400,-16770.94 3396.5,-16780.94 3403.5,-16780.94"/>
</g>
<!-- layer39_moe_comm_to_expert7&#45;&gt;layer39_moe_expert7 -->
<g id="edge2434" class="edge">
<title>layer39_moe_comm_to_expert7&#45;&gt;layer39_moe_expert7</title>
<path fill="none" stroke="black" d="M3400,-16894.75C3400,-16894.75 3400,-16869.1 3400,-16869.1"/>
<polygon fill="black" stroke="black" points="3403.5,-16869.1 3400,-16859.1 3396.5,-16869.1 3403.5,-16869.1"/>
</g>
<!-- layer39_moe_expert8 -->
<g id="node1899" class="node">
<title>layer39_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3873,-16858.8 3545,-16858.8 3545,-16806.8 3873,-16806.8 3873,-16858.8"/>
<text text-anchor="middle" x="3709" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 8 L39</text>
<text text-anchor="middle" x="3709" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3709" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3709" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert8 -->
<g id="node1924" class="node">
<title>layer39_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3672" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3672" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3672" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3672" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer39_moe_expert8&#45;&gt;layer39_moe_comm_from_expert8 -->
<g id="edge2467" class="edge">
<title>layer39_moe_expert8&#45;&gt;layer39_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3672,-16806.48C3672,-16806.48 3672,-16780.94 3672,-16780.94"/>
<polygon fill="black" stroke="black" points="3675.5,-16780.94 3672,-16770.94 3668.5,-16780.94 3675.5,-16780.94"/>
</g>
<!-- layer39_moe_comm_to_expert8&#45;&gt;layer39_moe_expert8 -->
<g id="edge2436" class="edge">
<title>layer39_moe_comm_to_expert8&#45;&gt;layer39_moe_expert8</title>
<path fill="none" stroke="black" d="M3672,-16894.75C3672,-16894.75 3672,-16869.1 3672,-16869.1"/>
<polygon fill="black" stroke="black" points="3675.5,-16869.1 3672,-16859.1 3668.5,-16869.1 3675.5,-16869.1"/>
</g>
<!-- layer39_moe_expert9 -->
<g id="node1901" class="node">
<title>layer39_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4219,-16858.8 3891,-16858.8 3891,-16806.8 4219,-16806.8 4219,-16858.8"/>
<text text-anchor="middle" x="4055" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 9 L39</text>
<text text-anchor="middle" x="4055" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4055" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4055" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert9 -->
<g id="node1925" class="node">
<title>layer39_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3981" cy="-16741.81" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3981" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3981" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3981" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer39_moe_expert9&#45;&gt;layer39_moe_comm_from_expert9 -->
<g id="edge2469" class="edge">
<title>layer39_moe_expert9&#45;&gt;layer39_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3981.25,-16806.48C3981.25,-16806.48 3981.25,-16780.94 3981.25,-16780.94"/>
<polygon fill="black" stroke="black" points="3984.75,-16780.94 3981.25,-16770.94 3977.75,-16780.94 3984.75,-16780.94"/>
</g>
<!-- layer39_moe_comm_to_expert9&#45;&gt;layer39_moe_expert9 -->
<g id="edge2438" class="edge">
<title>layer39_moe_comm_to_expert9&#45;&gt;layer39_moe_expert9</title>
<path fill="none" stroke="black" d="M3981.25,-16894.75C3981.25,-16894.75 3981.25,-16869.1 3981.25,-16869.1"/>
<polygon fill="black" stroke="black" points="3984.75,-16869.1 3981.25,-16859.1 3977.75,-16869.1 3984.75,-16869.1"/>
</g>
<!-- layer39_moe_expert10 -->
<g id="node1903" class="node">
<title>layer39_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4575,-16858.8 4237,-16858.8 4237,-16806.8 4575,-16806.8 4575,-16858.8"/>
<text text-anchor="middle" x="4406" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 10 L39</text>
<text text-anchor="middle" x="4406" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4406" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4406" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert10 -->
<g id="node1926" class="node">
<title>layer39_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4313" cy="-16741.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4313" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4313" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4313" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer39_moe_expert10&#45;&gt;layer39_moe_comm_from_expert10 -->
<g id="edge2471" class="edge">
<title>layer39_moe_expert10&#45;&gt;layer39_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4322.38,-16806.48C4322.38,-16806.48 4322.38,-16780.94 4322.38,-16780.94"/>
<polygon fill="black" stroke="black" points="4325.88,-16780.94 4322.38,-16770.94 4318.88,-16780.94 4325.88,-16780.94"/>
</g>
<!-- layer39_moe_comm_to_expert10&#45;&gt;layer39_moe_expert10 -->
<g id="edge2440" class="edge">
<title>layer39_moe_comm_to_expert10&#45;&gt;layer39_moe_expert10</title>
<path fill="none" stroke="black" d="M4322.02,-16894.75C4322.02,-16894.75 4322.02,-16869.1 4322.02,-16869.1"/>
<polygon fill="black" stroke="black" points="4325.52,-16869.1 4322.02,-16859.1 4318.52,-16869.1 4325.52,-16869.1"/>
</g>
<!-- layer39_moe_expert11 -->
<g id="node1905" class="node">
<title>layer39_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4931,-16858.8 4593,-16858.8 4593,-16806.8 4931,-16806.8 4931,-16858.8"/>
<text text-anchor="middle" x="4762" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 11 L39</text>
<text text-anchor="middle" x="4762" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4762" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4762" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert11 -->
<g id="node1927" class="node">
<title>layer39_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4660" cy="-16741.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4660" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4660" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4660" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer39_moe_expert11&#45;&gt;layer39_moe_comm_from_expert11 -->
<g id="edge2473" class="edge">
<title>layer39_moe_expert11&#45;&gt;layer39_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4673.88,-16806.48C4673.88,-16806.48 4673.88,-16780.61 4673.88,-16780.61"/>
<polygon fill="black" stroke="black" points="4677.38,-16780.61 4673.88,-16770.61 4670.38,-16780.61 4677.38,-16780.61"/>
</g>
<!-- layer39_moe_comm_to_expert11&#45;&gt;layer39_moe_expert11 -->
<g id="edge2442" class="edge">
<title>layer39_moe_comm_to_expert11&#45;&gt;layer39_moe_expert11</title>
<path fill="none" stroke="black" d="M4673.02,-16895C4673.02,-16895 4673.02,-16868.93 4673.02,-16868.93"/>
<polygon fill="black" stroke="black" points="4676.52,-16868.93 4673.02,-16858.93 4669.52,-16868.93 4676.52,-16868.93"/>
</g>
<!-- layer39_moe_expert12 -->
<g id="node1907" class="node">
<title>layer39_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5287,-16858.8 4949,-16858.8 4949,-16806.8 5287,-16806.8 5287,-16858.8"/>
<text text-anchor="middle" x="5118" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 12 L39</text>
<text text-anchor="middle" x="5118" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5118" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5118" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert12 -->
<g id="node1928" class="node">
<title>layer39_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="5011" cy="-16741.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5011" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="5011" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5011" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer39_moe_expert12&#45;&gt;layer39_moe_comm_from_expert12 -->
<g id="edge2475" class="edge">
<title>layer39_moe_expert12&#45;&gt;layer39_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M5027.38,-16806.48C5027.38,-16806.48 5027.38,-16780.61 5027.38,-16780.61"/>
<polygon fill="black" stroke="black" points="5030.88,-16780.61 5027.38,-16770.61 5023.88,-16780.61 5030.88,-16780.61"/>
</g>
<!-- layer39_moe_comm_to_expert12&#45;&gt;layer39_moe_expert12 -->
<g id="edge2444" class="edge">
<title>layer39_moe_comm_to_expert12&#45;&gt;layer39_moe_expert12</title>
<path fill="none" stroke="black" d="M5026.52,-16895C5026.52,-16895 5026.52,-16868.93 5026.52,-16868.93"/>
<polygon fill="black" stroke="black" points="5030.02,-16868.93 5026.52,-16858.93 5023.02,-16868.93 5030.02,-16868.93"/>
</g>
<!-- layer39_moe_expert13 -->
<g id="node1909" class="node">
<title>layer39_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5643,-16858.8 5305,-16858.8 5305,-16806.8 5643,-16806.8 5643,-16858.8"/>
<text text-anchor="middle" x="5474" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 13 L39</text>
<text text-anchor="middle" x="5474" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5474" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5474" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert13 -->
<g id="node1929" class="node">
<title>layer39_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5365" cy="-16741.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5365" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5365" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5365" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer39_moe_expert13&#45;&gt;layer39_moe_comm_from_expert13 -->
<g id="edge2477" class="edge">
<title>layer39_moe_expert13&#45;&gt;layer39_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5382.38,-16806.48C5382.38,-16806.48 5382.38,-16780.61 5382.38,-16780.61"/>
<polygon fill="black" stroke="black" points="5385.88,-16780.61 5382.38,-16770.61 5378.88,-16780.61 5385.88,-16780.61"/>
</g>
<!-- layer39_moe_comm_to_expert13&#45;&gt;layer39_moe_expert13 -->
<g id="edge2446" class="edge">
<title>layer39_moe_comm_to_expert13&#45;&gt;layer39_moe_expert13</title>
<path fill="none" stroke="black" d="M5381.02,-16895C5381.02,-16895 5381.02,-16868.93 5381.02,-16868.93"/>
<polygon fill="black" stroke="black" points="5384.52,-16868.93 5381.02,-16858.93 5377.52,-16868.93 5384.52,-16868.93"/>
</g>
<!-- layer39_moe_expert14 -->
<g id="node1911" class="node">
<title>layer39_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5999,-16858.8 5661,-16858.8 5661,-16806.8 5999,-16806.8 5999,-16858.8"/>
<text text-anchor="middle" x="5830" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 14 L39</text>
<text text-anchor="middle" x="5830" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5830" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5830" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert14 -->
<g id="node1930" class="node">
<title>layer39_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5720" cy="-16741.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5720" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5720" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5720" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer39_moe_expert14&#45;&gt;layer39_moe_comm_from_expert14 -->
<g id="edge2479" class="edge">
<title>layer39_moe_expert14&#45;&gt;layer39_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5737.88,-16806.48C5737.88,-16806.48 5737.88,-16780.29 5737.88,-16780.29"/>
<polygon fill="black" stroke="black" points="5741.38,-16780.29 5737.88,-16770.29 5734.38,-16780.29 5741.38,-16780.29"/>
</g>
<!-- layer39_moe_comm_to_expert14&#45;&gt;layer39_moe_expert14 -->
<g id="edge2448" class="edge">
<title>layer39_moe_comm_to_expert14&#45;&gt;layer39_moe_expert14</title>
<path fill="none" stroke="black" d="M5736.52,-16895C5736.52,-16895 5736.52,-16868.93 5736.52,-16868.93"/>
<polygon fill="black" stroke="black" points="5740.02,-16868.93 5736.52,-16858.93 5733.02,-16868.93 5740.02,-16868.93"/>
</g>
<!-- layer39_moe_expert15 -->
<g id="node1913" class="node">
<title>layer39_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6355,-16858.8 6017,-16858.8 6017,-16806.8 6355,-16806.8 6355,-16858.8"/>
<text text-anchor="middle" x="6186" y="-16846.8" font-family="Arial" font-size="10.00">EXPERT 15 L39</text>
<text text-anchor="middle" x="6186" y="-16835.8" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6186" y="-16824.8" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6186" y="-16813.8" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_comm_from_expert15 -->
<g id="node1931" class="node">
<title>layer39_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6075" cy="-16741.81" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6075" y="-16750.31" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6075" y="-16739.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6075" y="-16728.31" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer39_moe_expert15&#45;&gt;layer39_moe_comm_from_expert15 -->
<g id="edge2481" class="edge">
<title>layer39_moe_expert15&#45;&gt;layer39_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6093.38,-16806.48C6093.38,-16806.48 6093.38,-16780.29 6093.38,-16780.29"/>
<polygon fill="black" stroke="black" points="6096.88,-16780.29 6093.38,-16770.29 6089.88,-16780.29 6096.88,-16780.29"/>
</g>
<!-- layer39_moe_comm_to_expert15&#45;&gt;layer39_moe_expert15 -->
<g id="edge2450" class="edge">
<title>layer39_moe_comm_to_expert15&#45;&gt;layer39_moe_expert15</title>
<path fill="none" stroke="black" d="M6092.02,-16895C6092.02,-16895 6092.02,-16868.93 6092.02,-16868.93"/>
<polygon fill="black" stroke="black" points="6095.52,-16868.93 6092.02,-16858.93 6088.52,-16868.93 6095.52,-16868.93"/>
</g>
<!-- layer39_moe_aggregate -->
<g id="node1915" class="node">
<title>layer39_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3761.1,-16676.81 3344.16,-16676.81 3236.9,-16572.81 3653.84,-16572.81 3761.1,-16676.81"/>
<text text-anchor="middle" x="3499" y="-16638.81" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L39</text>
<text text-anchor="middle" x="3499" y="-16627.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3499" y="-16616.81" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3499" y="-16605.81" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_mha -->
<g id="node1932" class="node">
<title>layer40_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3629,-16536.81 3369,-16536.81 3369,-16484.81 3629,-16484.81 3629,-16536.81"/>
<text text-anchor="middle" x="3499" y="-16524.81" font-family="Arial" font-size="10.00">MHA L40</text>
<text text-anchor="middle" x="3499" y="-16513.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3499" y="-16502.81" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3499" y="-16491.81" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer39_moe_aggregate&#45;&gt;layer40_moe_mha -->
<g id="edge2550" class="edge">
<title>layer39_moe_aggregate&#45;&gt;layer40_moe_mha</title>
<path fill="none" stroke="black" d="M3499,-16572.49C3499,-16572.49 3499,-16547.04 3499,-16547.04"/>
<polygon fill="black" stroke="black" points="3502.5,-16547.04 3499,-16537.04 3495.5,-16547.04 3502.5,-16547.04"/>
</g>
<!-- layer39_moe_comm_from_expert0&#45;&gt;layer39_moe_aggregate -->
<g id="edge2452" class="edge">
<title>layer39_moe_comm_from_expert0&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M1072.75,-16732.12C1072.75,-16698.23 1072.75,-16587 1072.75,-16587 1072.75,-16587 3241.32,-16587 3241.32,-16587"/>
<polygon fill="black" stroke="black" points="3241.32,-16590.5 3251.32,-16587 3241.32,-16583.5 3241.32,-16590.5"/>
</g>
<!-- layer39_moe_comm_from_expert1&#45;&gt;layer39_moe_aggregate -->
<g id="edge2454" class="edge">
<title>layer39_moe_comm_from_expert1&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M1784.25,-16730.84C1784.25,-16697.88 1784.25,-16602 1784.25,-16602 1784.25,-16602 3256.85,-16602 3256.85,-16602"/>
<polygon fill="black" stroke="black" points="3256.85,-16605.5 3266.85,-16602 3256.85,-16598.5 3256.85,-16605.5"/>
</g>
<!-- layer39_moe_comm_from_expert2&#45;&gt;layer39_moe_aggregate -->
<g id="edge2456" class="edge">
<title>layer39_moe_comm_from_expert2&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M2228.01,-16724.19C2228.01,-16689.79 2228.01,-16617 2228.01,-16617 2228.01,-16617 3272.31,-16617 3272.31,-16617"/>
<polygon fill="black" stroke="black" points="3272.31,-16620.5 3282.31,-16617 3272.31,-16613.5 3272.31,-16620.5"/>
</g>
<!-- layer39_moe_comm_from_expert3&#45;&gt;layer39_moe_aggregate -->
<g id="edge2458" class="edge">
<title>layer39_moe_comm_from_expert3&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M2556.01,-16724.16C2556.01,-16693.12 2556.01,-16632 2556.01,-16632 2556.01,-16632 3287.86,-16632 3287.86,-16632"/>
<polygon fill="black" stroke="black" points="3287.86,-16635.5 3297.86,-16632 3287.86,-16628.5 3287.86,-16635.5"/>
</g>
<!-- layer39_moe_comm_from_expert4&#45;&gt;layer39_moe_aggregate -->
<g id="edge2460" class="edge">
<title>layer39_moe_comm_from_expert4&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M2826.75,-16727.82C2826.75,-16701.45 2826.75,-16647 2826.75,-16647 2826.75,-16647 3303.08,-16647 3303.08,-16647"/>
<polygon fill="black" stroke="black" points="3303.08,-16650.5 3313.08,-16647 3303.08,-16643.5 3303.08,-16650.5"/>
</g>
<!-- layer39_moe_comm_from_expert5&#45;&gt;layer39_moe_aggregate -->
<g id="edge2462" class="edge">
<title>layer39_moe_comm_from_expert5&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M3048.5,-16723.47C3048.5,-16699.63 3048.5,-16661 3048.5,-16661 3048.5,-16661 3317.72,-16661 3317.72,-16661"/>
<polygon fill="black" stroke="black" points="3317.72,-16664.5 3327.72,-16661 3317.72,-16657.5 3317.72,-16664.5"/>
</g>
<!-- layer39_moe_comm_from_expert6&#45;&gt;layer39_moe_aggregate -->
<g id="edge2464" class="edge">
<title>layer39_moe_comm_from_expert6&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M3260.11,-16722.22C3260.11,-16722.22 3260.11,-16634.86 3260.11,-16634.86"/>
<polygon fill="black" stroke="black" points="3263.61,-16634.86 3260.11,-16624.86 3256.61,-16634.86 3263.61,-16634.86"/>
</g>
<!-- layer39_moe_comm_from_expert7&#45;&gt;layer39_moe_aggregate -->
<g id="edge2466" class="edge">
<title>layer39_moe_comm_from_expert7&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M3400,-16712.59C3400,-16712.59 3400,-16686.87 3400,-16686.87"/>
<polygon fill="black" stroke="black" points="3403.5,-16686.87 3400,-16676.87 3396.5,-16686.87 3403.5,-16686.87"/>
</g>
<!-- layer39_moe_comm_from_expert8&#45;&gt;layer39_moe_aggregate -->
<g id="edge2468" class="edge">
<title>layer39_moe_comm_from_expert8&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M3671.39,-16712.59C3671.39,-16712.59 3671.39,-16686.87 3671.39,-16686.87"/>
<polygon fill="black" stroke="black" points="3674.89,-16686.87 3671.39,-16676.87 3667.89,-16686.87 3674.89,-16686.87"/>
</g>
<!-- layer39_moe_comm_from_expert9&#45;&gt;layer39_moe_aggregate -->
<g id="edge2470" class="edge">
<title>layer39_moe_comm_from_expert9&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M3962.5,-16713.36C3962.5,-16690.78 3962.5,-16663 3962.5,-16663 3962.5,-16663 3757.03,-16663 3757.03,-16663"/>
<polygon fill="black" stroke="black" points="3757.03,-16659.5 3747.03,-16663 3757.03,-16666.5 3757.03,-16659.5"/>
</g>
<!-- layer39_moe_comm_from_expert10&#45;&gt;layer39_moe_aggregate -->
<g id="edge2472" class="edge">
<title>layer39_moe_comm_from_expert10&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M4294.15,-16713.26C4294.15,-16686.31 4294.15,-16650 4294.15,-16650 4294.15,-16650 3743.54,-16650 3743.54,-16650"/>
<polygon fill="black" stroke="black" points="3743.54,-16646.5 3733.54,-16650 3743.54,-16653.5 3743.54,-16646.5"/>
</g>
<!-- layer39_moe_comm_from_expert11&#45;&gt;layer39_moe_aggregate -->
<g id="edge2474" class="edge">
<title>layer39_moe_comm_from_expert11&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M4640.65,-16713.17C4640.65,-16682.14 4640.65,-16637 4640.65,-16637 4640.65,-16637 3730.14,-16637 3730.14,-16637"/>
<polygon fill="black" stroke="black" points="3730.14,-16633.5 3720.14,-16637 3730.14,-16640.5 3730.14,-16633.5"/>
</g>
<!-- layer39_moe_comm_from_expert12&#45;&gt;layer39_moe_aggregate -->
<g id="edge2476" class="edge">
<title>layer39_moe_comm_from_expert12&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M4991.65,-16713.29C4991.65,-16678.42 4991.65,-16624 4991.65,-16624 4991.65,-16624 3716.94,-16624 3716.94,-16624"/>
<polygon fill="black" stroke="black" points="3716.94,-16620.5 3706.94,-16624 3716.94,-16627.5 3716.94,-16620.5"/>
</g>
<!-- layer39_moe_comm_from_expert13&#45;&gt;layer39_moe_aggregate -->
<g id="edge2478" class="edge">
<title>layer39_moe_comm_from_expert13&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M5345.15,-16713.42C5345.15,-16674.95 5345.15,-16611 5345.15,-16611 5345.15,-16611 3703.52,-16611 3703.52,-16611"/>
<polygon fill="black" stroke="black" points="3703.52,-16607.5 3693.52,-16611 3703.52,-16614.5 3703.52,-16607.5"/>
</g>
<!-- layer39_moe_comm_from_expert14&#45;&gt;layer39_moe_aggregate -->
<g id="edge2480" class="edge">
<title>layer39_moe_comm_from_expert14&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M5700.15,-16713.39C5700.15,-16671.49 5700.15,-16598 5700.15,-16598 5700.15,-16598 3690.06,-16598 3690.06,-16598"/>
<polygon fill="black" stroke="black" points="3690.06,-16594.5 3680.06,-16598 3690.06,-16601.5 3690.06,-16594.5"/>
</g>
<!-- layer39_moe_comm_from_expert15&#45;&gt;layer39_moe_aggregate -->
<g id="edge2482" class="edge">
<title>layer39_moe_comm_from_expert15&#45;&gt;layer39_moe_aggregate</title>
<path fill="none" stroke="black" d="M6055.15,-16713.41C6055.15,-16668.22 6055.15,-16585 6055.15,-16585 6055.15,-16585 3676.72,-16585 3676.72,-16585"/>
<polygon fill="black" stroke="black" points="3676.72,-16581.5 3666.72,-16585 3676.72,-16588.5 3676.72,-16581.5"/>
</g>
<!-- layer40_moe_gate -->
<g id="node1933" class="node">
<title>layer40_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3757.3,-16448.81 3346.4,-16448.81 3240.7,-16344.81 3651.6,-16344.81 3757.3,-16448.81"/>
<text text-anchor="middle" x="3499" y="-16410.81" font-family="Arial" font-size="10.00">GATE L40</text>
<text text-anchor="middle" x="3499" y="-16399.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3499" y="-16388.81" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3499" y="-16377.81" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer40_moe_mha&#45;&gt;layer40_moe_gate -->
<g id="edge2551" class="edge">
<title>layer40_moe_mha&#45;&gt;layer40_moe_gate</title>
<path fill="none" stroke="black" d="M3499,-16484.66C3499,-16484.66 3499,-16458.91 3499,-16458.91"/>
<polygon fill="black" stroke="black" points="3502.5,-16458.91 3499,-16448.91 3495.5,-16458.91 3502.5,-16458.91"/>
</g>
<!-- layer40_moe_split -->
<g id="node1934" class="node">
<title>layer40_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3753.01,-16308.81 3348.94,-16308.81 3244.99,-16204.81 3649.06,-16204.81 3753.01,-16308.81"/>
<text text-anchor="middle" x="3499" y="-16270.81" font-family="Arial" font-size="10.00">SPLIT TOKENS L40</text>
<text text-anchor="middle" x="3499" y="-16259.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3499" y="-16248.81" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3499" y="-16237.81" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer40_moe_gate&#45;&gt;layer40_moe_split -->
<g id="edge2552" class="edge">
<title>layer40_moe_gate&#45;&gt;layer40_moe_split</title>
<path fill="none" stroke="black" d="M3499,-16344.68C3499,-16344.68 3499,-16318.99 3499,-16318.99"/>
<polygon fill="black" stroke="black" points="3502.5,-16318.99 3499,-16308.99 3495.5,-16318.99 3502.5,-16318.99"/>
</g>
<!-- layer40_moe_comm_to_expert0 -->
<g id="node1936" class="node">
<title>layer40_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1418" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1418" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1418" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1418" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert0 -->
<g id="edge2486" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3332.78,-16293C2851.15,-16293 1488.75,-16293 1488.75,-16293 1488.75,-16293 1488.75,-16168 1488.75,-16168"/>
<polygon fill="black" stroke="black" points="1492.25,-16168 1488.75,-16158 1485.25,-16168 1492.25,-16168"/>
</g>
<!-- layer40_moe_comm_to_expert1 -->
<g id="node1938" class="node">
<title>layer40_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1663" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1663" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1663" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1663" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert1 -->
<g id="edge2488" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3318.92,-16279C2859.8,-16279 1681.5,-16279 1681.5,-16279 1681.5,-16279 1681.5,-16178.32 1681.5,-16178.32"/>
<polygon fill="black" stroke="black" points="1685,-16178.32 1681.5,-16168.32 1678,-16178.32 1685,-16178.32"/>
</g>
<!-- layer40_moe_comm_to_expert2 -->
<g id="node1940" class="node">
<title>layer40_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2119" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2119" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2119" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2119" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert2 -->
<g id="edge2490" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3303.93,-16264C2927.46,-16264 2137.5,-16264 2137.5,-16264 2137.5,-16264 2137.5,-16178.31 2137.5,-16178.31"/>
<polygon fill="black" stroke="black" points="2141,-16178.31 2137.5,-16168.31 2134,-16178.31 2141,-16178.31"/>
</g>
<!-- layer40_moe_comm_to_expert3 -->
<g id="node1942" class="node">
<title>layer40_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2447" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2447" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2447" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2447" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert3 -->
<g id="edge2492" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3288.92,-16249C2986.79,-16249 2465.5,-16249 2465.5,-16249 2465.5,-16249 2465.5,-16178.22 2465.5,-16178.22"/>
<polygon fill="black" stroke="black" points="2469,-16178.22 2465.5,-16168.22 2462,-16178.22 2469,-16178.22"/>
</g>
<!-- layer40_moe_comm_to_expert4 -->
<g id="node1944" class="node">
<title>layer40_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2710" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2710" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2710" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2710" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert4 -->
<g id="edge2494" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3274.07,-16234C3046.64,-16234 2728.5,-16234 2728.5,-16234 2728.5,-16234 2728.5,-16178.34 2728.5,-16178.34"/>
<polygon fill="black" stroke="black" points="2732,-16178.34 2728.5,-16168.34 2725,-16178.34 2732,-16178.34"/>
</g>
<!-- layer40_moe_comm_to_expert5 -->
<g id="node1946" class="node">
<title>layer40_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2941" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2941" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2941" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2941" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert5 -->
<g id="edge2496" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3258.83,-16219C3114.86,-16219 2959.5,-16219 2959.5,-16219 2959.5,-16219 2959.5,-16178.41 2959.5,-16178.41"/>
<polygon fill="black" stroke="black" points="2963,-16178.41 2959.5,-16168.41 2956,-16178.41 2963,-16178.41"/>
</g>
<!-- layer40_moe_comm_to_expert6 -->
<g id="node1948" class="node">
<title>layer40_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3156" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3156" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3156" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3156" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert6 -->
<g id="edge2498" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3259.5,-16256.73C3259.5,-16253.16 3259.5,-16139 3259.5,-16139 3259.5,-16139 3256.81,-16139 3256.81,-16139"/>
<polygon fill="black" stroke="black" points="3256.81,-16135.5 3246.81,-16139 3256.81,-16142.5 3256.81,-16135.5"/>
</g>
<!-- layer40_moe_comm_to_expert7 -->
<g id="node1950" class="node">
<title>layer40_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3363" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3363" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3363" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3363" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert7 -->
<g id="edge2500" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3363,-16204.48C3363,-16204.48 3363,-16179.03 3363,-16179.03"/>
<polygon fill="black" stroke="black" points="3366.5,-16179.03 3363,-16169.03 3359.5,-16179.03 3366.5,-16179.03"/>
</g>
<!-- layer40_moe_comm_to_expert8 -->
<g id="node1952" class="node">
<title>layer40_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3635" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3635" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3635" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3635" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert8 -->
<g id="edge2502" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3635,-16204.48C3635,-16204.48 3635,-16179.03 3635,-16179.03"/>
<polygon fill="black" stroke="black" points="3638.5,-16179.03 3635,-16169.03 3631.5,-16179.03 3638.5,-16179.03"/>
</g>
<!-- layer40_moe_comm_to_expert9 -->
<g id="node1954" class="node">
<title>layer40_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3944" cy="-16139.82" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3944" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3944" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3944" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert9 -->
<g id="edge2504" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3739.26,-16256.73C3739.26,-16253.16 3739.26,-16139 3739.26,-16139 3739.26,-16139 3843.3,-16139 3843.3,-16139"/>
<polygon fill="black" stroke="black" points="3843.3,-16142.5 3853.3,-16139 3843.3,-16135.5 3843.3,-16142.5"/>
</g>
<!-- layer40_moe_comm_to_expert10 -->
<g id="node1956" class="node">
<title>layer40_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4276" cy="-16139.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4276" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4276" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4276" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert10 -->
<g id="edge2506" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3663.38,-16219C3870.6,-16219 4200.1,-16219 4200.1,-16219 4200.1,-16219 4200.1,-16167 4200.1,-16167"/>
<polygon fill="black" stroke="black" points="4203.6,-16167 4200.1,-16157 4196.6,-16167 4203.6,-16167"/>
</g>
<!-- layer40_moe_comm_to_expert11 -->
<g id="node1958" class="node">
<title>layer40_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4622" cy="-16139.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4622" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4622" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4622" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert11 -->
<g id="edge2508" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3678.49,-16234C3977.86,-16234 4546.6,-16234 4546.6,-16234 4546.6,-16234 4546.6,-16167.54 4546.6,-16167.54"/>
<polygon fill="black" stroke="black" points="4550.1,-16167.54 4546.6,-16157.54 4543.1,-16167.54 4550.1,-16167.54"/>
</g>
<!-- layer40_moe_comm_to_expert12 -->
<g id="node1960" class="node">
<title>layer40_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4973" cy="-16139.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4973" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4973" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4973" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert12 -->
<g id="edge2510" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3693.47,-16249C4077.77,-16249 4897.6,-16249 4897.6,-16249 4897.6,-16249 4897.6,-16167.36 4897.6,-16167.36"/>
<polygon fill="black" stroke="black" points="4901.1,-16167.36 4897.6,-16157.36 4894.1,-16167.36 4901.1,-16167.36"/>
</g>
<!-- layer40_moe_comm_to_expert13 -->
<g id="node1962" class="node">
<title>layer40_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5326" cy="-16139.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5326" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5326" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5326" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert13 -->
<g id="edge2512" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3708.6,-16264C4173.67,-16264 5251.1,-16264 5251.1,-16264 5251.1,-16264 5251.1,-16167.61 5251.1,-16167.61"/>
<polygon fill="black" stroke="black" points="5254.6,-16167.61 5251.1,-16157.61 5247.6,-16167.61 5254.6,-16167.61"/>
</g>
<!-- layer40_moe_comm_to_expert14 -->
<g id="node1964" class="node">
<title>layer40_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5681" cy="-16139.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5681" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5681" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5681" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert14 -->
<g id="edge2514" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3723.5,-16279C4266.43,-16279 5606.1,-16279 5606.1,-16279 5606.1,-16279 5606.1,-16167.45 5606.1,-16167.45"/>
<polygon fill="black" stroke="black" points="5609.6,-16167.45 5606.1,-16157.45 5602.6,-16167.45 5609.6,-16167.45"/>
</g>
<!-- layer40_moe_comm_to_expert15 -->
<g id="node1966" class="node">
<title>layer40_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="6036" cy="-16139.82" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="6036" y="-16148.32" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="6036" y="-16137.32" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6036" y="-16126.32" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert15 -->
<g id="edge2516" class="edge">
<title>layer40_moe_split&#45;&gt;layer40_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3737.31,-16293C4355.21,-16293 5961.1,-16293 5961.1,-16293 5961.1,-16293 5961.1,-16167.39 5961.1,-16167.39"/>
<polygon fill="black" stroke="black" points="5964.6,-16167.39 5961.1,-16157.39 5957.6,-16167.39 5964.6,-16167.39"/>
</g>
<!-- layer40_moe_expert0 -->
<g id="node1935" class="node">
<title>layer40_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1068,-16074.83 740,-16074.83 740,-16022.83 1068,-16022.83 1068,-16074.83"/>
<text text-anchor="middle" x="904" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 0 L40</text>
<text text-anchor="middle" x="904" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="904" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="904" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert0 -->
<g id="node1968" class="node">
<title>layer40_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="950" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="950" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="950" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="950" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer40_moe_expert0&#45;&gt;layer40_moe_comm_from_expert0 -->
<g id="edge2518" class="edge">
<title>layer40_moe_expert0&#45;&gt;layer40_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M950,-16022.51C950,-16022.51 950,-15996.97 950,-15996.97"/>
<polygon fill="black" stroke="black" points="953.5,-15996.97 950,-15986.97 946.5,-15996.97 953.5,-15996.97"/>
</g>
<!-- layer40_moe_comm_to_expert0&#45;&gt;layer40_moe_expert0 -->
<g id="edge2487" class="edge">
<title>layer40_moe_comm_to_expert0&#45;&gt;layer40_moe_expert0</title>
<path fill="none" stroke="black" d="M1327.45,-16139C1199.78,-16139 982.25,-16139 982.25,-16139 982.25,-16139 982.25,-16084.91 982.25,-16084.91"/>
<polygon fill="black" stroke="black" points="985.75,-16084.91 982.25,-16074.91 978.75,-16084.91 985.75,-16084.91"/>
</g>
<!-- layer40_moe_expert1 -->
<g id="node1937" class="node">
<title>layer40_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1414,-16074.83 1086,-16074.83 1086,-16022.83 1414,-16022.83 1414,-16074.83"/>
<text text-anchor="middle" x="1250" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 1 L40</text>
<text text-anchor="middle" x="1250" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1250" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1250" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert1 -->
<g id="node1969" class="node">
<title>layer40_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1663" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1663" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1663" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1663" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer40_moe_expert1&#45;&gt;layer40_moe_comm_from_expert1 -->
<g id="edge2520" class="edge">
<title>layer40_moe_expert1&#45;&gt;layer40_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1352.25,-16022.76C1352.25,-15995.61 1352.25,-15957 1352.25,-15957 1352.25,-15957 1562.28,-15957 1562.28,-15957"/>
<polygon fill="black" stroke="black" points="1562.28,-15960.5 1572.28,-15957 1562.28,-15953.5 1562.28,-15960.5"/>
</g>
<!-- layer40_moe_comm_to_expert1&#45;&gt;layer40_moe_expert1 -->
<g id="edge2489" class="edge">
<title>layer40_moe_comm_to_expert1&#45;&gt;layer40_moe_expert1</title>
<path fill="none" stroke="black" d="M1663,-16110.75C1663,-16096.77 1663,-16083 1663,-16083 1663,-16083 1370.75,-16083 1370.75,-16083 1370.75,-16083 1370.75,-16082.21 1370.75,-16082.21"/>
<polygon fill="black" stroke="black" points="1374.25,-16085.08 1370.75,-16075.08 1367.25,-16085.08 1374.25,-16085.08"/>
</g>
<!-- layer40_moe_expert2 -->
<g id="node1939" class="node">
<title>layer40_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1760,-16074.83 1432,-16074.83 1432,-16022.83 1760,-16022.83 1760,-16074.83"/>
<text text-anchor="middle" x="1596" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 2 L40</text>
<text text-anchor="middle" x="1596" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1596" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1596" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert2 -->
<g id="node1970" class="node">
<title>layer40_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2119" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2119" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2119" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2119" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer40_moe_expert2&#45;&gt;layer40_moe_comm_from_expert2 -->
<g id="edge2522" class="edge">
<title>layer40_moe_expert2&#45;&gt;layer40_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1760.18,-16040C1767.6,-16040 1772,-16040 1772,-16040 1772,-16040 1772,-15957 1772,-15957 1772,-15957 2018.28,-15957 2018.28,-15957"/>
<polygon fill="black" stroke="black" points="2018.28,-15960.5 2028.28,-15957 2018.28,-15953.5 2018.28,-15960.5"/>
</g>
<!-- layer40_moe_comm_to_expert2&#45;&gt;layer40_moe_expert2 -->
<g id="edge2491" class="edge">
<title>layer40_moe_comm_to_expert2&#45;&gt;layer40_moe_expert2</title>
<path fill="none" stroke="black" d="M2028.09,-16139C1923.5,-16139 1766,-16139 1766,-16139 1766,-16139 1766,-16057 1766,-16057 1766,-16057 1765.43,-16057 1765.43,-16057"/>
<polygon fill="black" stroke="black" points="1770.34,-16053.5 1760.34,-16057 1770.34,-16060.5 1770.34,-16053.5"/>
</g>
<!-- layer40_moe_expert3 -->
<g id="node1941" class="node">
<title>layer40_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2106,-16074.83 1778,-16074.83 1778,-16022.83 2106,-16022.83 2106,-16074.83"/>
<text text-anchor="middle" x="1942" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 3 L40</text>
<text text-anchor="middle" x="1942" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1942" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1942" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert3 -->
<g id="node1971" class="node">
<title>layer40_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2447" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2447" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2447" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2447" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer40_moe_expert3&#45;&gt;layer40_moe_comm_from_expert3 -->
<g id="edge2524" class="edge">
<title>layer40_moe_expert3&#45;&gt;layer40_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M2067.25,-16022.82C2067.25,-16010.31 2067.25,-15998 2067.25,-15998 2067.25,-15998 2388.33,-15998 2388.33,-15998 2388.33,-15998 2388.33,-15990.27 2388.33,-15990.27"/>
<polygon fill="black" stroke="black" points="2391.83,-15990.27 2388.33,-15980.27 2384.83,-15990.27 2391.83,-15990.27"/>
</g>
<!-- layer40_moe_comm_to_expert3&#45;&gt;layer40_moe_expert3 -->
<g id="edge2493" class="edge">
<title>layer40_moe_comm_to_expert3&#45;&gt;layer40_moe_expert3</title>
<path fill="none" stroke="black" d="M2388.33,-16117.69C2388.33,-16108.97 2388.33,-16101 2388.33,-16101 2388.33,-16101 2067.25,-16101 2067.25,-16101 2067.25,-16101 2067.25,-16084.92 2067.25,-16084.92"/>
<polygon fill="black" stroke="black" points="2070.75,-16084.92 2067.25,-16074.92 2063.75,-16084.92 2070.75,-16084.92"/>
</g>
<!-- layer40_moe_expert4 -->
<g id="node1943" class="node">
<title>layer40_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2452,-16074.83 2124,-16074.83 2124,-16022.83 2452,-16022.83 2452,-16074.83"/>
<text text-anchor="middle" x="2288" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 4 L40</text>
<text text-anchor="middle" x="2288" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2288" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2288" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert4 -->
<g id="node1972" class="node">
<title>layer40_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2710" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2710" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2710" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2710" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer40_moe_expert4&#45;&gt;layer40_moe_comm_from_expert4 -->
<g id="edge2526" class="edge">
<title>layer40_moe_expert4&#45;&gt;layer40_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2420.16,-16022.72C2420.16,-16015.69 2420.16,-16010 2420.16,-16010 2420.16,-16010 2708.75,-16010 2708.75,-16010 2708.75,-16010 2708.75,-15996.97 2708.75,-15996.97"/>
<polygon fill="black" stroke="black" points="2712.25,-15996.97 2708.75,-15986.97 2705.25,-15996.97 2712.25,-15996.97"/>
</g>
<!-- layer40_moe_comm_to_expert4&#45;&gt;layer40_moe_expert4 -->
<g id="edge2495" class="edge">
<title>layer40_moe_comm_to_expert4&#45;&gt;layer40_moe_expert4</title>
<path fill="none" stroke="black" d="M2708.75,-16110.63C2708.75,-16100.67 2708.75,-16092 2708.75,-16092 2708.75,-16092 2420.16,-16092 2420.16,-16092 2420.16,-16092 2420.16,-16084.94 2420.16,-16084.94"/>
<polygon fill="black" stroke="black" points="2423.66,-16084.94 2420.16,-16074.94 2416.66,-16084.94 2423.66,-16084.94"/>
</g>
<!-- layer40_moe_expert5 -->
<g id="node1945" class="node">
<title>layer40_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2798,-16074.83 2470,-16074.83 2470,-16022.83 2798,-16022.83 2798,-16074.83"/>
<text text-anchor="middle" x="2634" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 5 L40</text>
<text text-anchor="middle" x="2634" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2634" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2634" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert5 -->
<g id="node1973" class="node">
<title>layer40_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2941" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2941" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2941" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2941" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer40_moe_expert5&#45;&gt;layer40_moe_comm_from_expert5 -->
<g id="edge2528" class="edge">
<title>layer40_moe_expert5&#45;&gt;layer40_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2798.21,-16040C2805.1,-16040 2809.16,-16040 2809.16,-16040 2809.16,-16040 2809.16,-15957 2809.16,-15957 2809.16,-15957 2840.52,-15957 2840.52,-15957"/>
<polygon fill="black" stroke="black" points="2840.52,-15960.5 2850.52,-15957 2840.52,-15953.5 2840.52,-15960.5"/>
</g>
<!-- layer40_moe_comm_to_expert5&#45;&gt;layer40_moe_expert5 -->
<g id="edge2497" class="edge">
<title>layer40_moe_comm_to_expert5&#45;&gt;layer40_moe_expert5</title>
<path fill="none" stroke="black" d="M2850.18,-16139C2825.2,-16139 2804.84,-16139 2804.84,-16139 2804.84,-16139 2804.84,-16057 2804.84,-16057 2804.84,-16057 2804.19,-16057 2804.19,-16057"/>
<polygon fill="black" stroke="black" points="2808.35,-16053.5 2798.35,-16057 2808.35,-16060.5 2808.35,-16053.5"/>
</g>
<!-- layer40_moe_expert6 -->
<g id="node1947" class="node">
<title>layer40_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3144,-16074.83 2816,-16074.83 2816,-16022.83 3144,-16022.83 3144,-16074.83"/>
<text text-anchor="middle" x="2980" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 6 L40</text>
<text text-anchor="middle" x="2980" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2980" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2980" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert6 -->
<g id="node1974" class="node">
<title>layer40_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3156" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3156" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3156" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3156" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer40_moe_expert6&#45;&gt;layer40_moe_comm_from_expert6 -->
<g id="edge2530" class="edge">
<title>layer40_moe_expert6&#45;&gt;layer40_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3104.75,-16022.51C3104.75,-16022.51 3104.75,-15991.92 3104.75,-15991.92"/>
<polygon fill="black" stroke="black" points="3108.25,-15991.92 3104.75,-15981.92 3101.25,-15991.92 3108.25,-15991.92"/>
</g>
<!-- layer40_moe_comm_to_expert6&#45;&gt;layer40_moe_expert6 -->
<g id="edge2499" class="edge">
<title>layer40_moe_comm_to_expert6&#45;&gt;layer40_moe_expert6</title>
<path fill="none" stroke="black" d="M3104.75,-16115.92C3104.75,-16115.92 3104.75,-16085.14 3104.75,-16085.14"/>
<polygon fill="black" stroke="black" points="3108.25,-16085.14 3104.75,-16075.14 3101.25,-16085.14 3108.25,-16085.14"/>
</g>
<!-- layer40_moe_expert7 -->
<g id="node1949" class="node">
<title>layer40_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3490,-16074.83 3162,-16074.83 3162,-16022.83 3490,-16022.83 3490,-16074.83"/>
<text text-anchor="middle" x="3326" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 7 L40</text>
<text text-anchor="middle" x="3326" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3326" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3326" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert7 -->
<g id="node1975" class="node">
<title>layer40_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3363" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3363" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3363" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3363" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer40_moe_expert7&#45;&gt;layer40_moe_comm_from_expert7 -->
<g id="edge2532" class="edge">
<title>layer40_moe_expert7&#45;&gt;layer40_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3363,-16022.51C3363,-16022.51 3363,-15996.97 3363,-15996.97"/>
<polygon fill="black" stroke="black" points="3366.5,-15996.97 3363,-15986.97 3359.5,-15996.97 3366.5,-15996.97"/>
</g>
<!-- layer40_moe_comm_to_expert7&#45;&gt;layer40_moe_expert7 -->
<g id="edge2501" class="edge">
<title>layer40_moe_comm_to_expert7&#45;&gt;layer40_moe_expert7</title>
<path fill="none" stroke="black" d="M3363,-16110.78C3363,-16110.78 3363,-16085.13 3363,-16085.13"/>
<polygon fill="black" stroke="black" points="3366.5,-16085.13 3363,-16075.13 3359.5,-16085.13 3366.5,-16085.13"/>
</g>
<!-- layer40_moe_expert8 -->
<g id="node1951" class="node">
<title>layer40_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3836,-16074.83 3508,-16074.83 3508,-16022.83 3836,-16022.83 3836,-16074.83"/>
<text text-anchor="middle" x="3672" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 8 L40</text>
<text text-anchor="middle" x="3672" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3672" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3672" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert8 -->
<g id="node1976" class="node">
<title>layer40_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3635" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3635" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3635" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3635" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer40_moe_expert8&#45;&gt;layer40_moe_comm_from_expert8 -->
<g id="edge2534" class="edge">
<title>layer40_moe_expert8&#45;&gt;layer40_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3635,-16022.51C3635,-16022.51 3635,-15996.97 3635,-15996.97"/>
<polygon fill="black" stroke="black" points="3638.5,-15996.97 3635,-15986.97 3631.5,-15996.97 3638.5,-15996.97"/>
</g>
<!-- layer40_moe_comm_to_expert8&#45;&gt;layer40_moe_expert8 -->
<g id="edge2503" class="edge">
<title>layer40_moe_comm_to_expert8&#45;&gt;layer40_moe_expert8</title>
<path fill="none" stroke="black" d="M3635,-16110.78C3635,-16110.78 3635,-16085.13 3635,-16085.13"/>
<polygon fill="black" stroke="black" points="3638.5,-16085.13 3635,-16075.13 3631.5,-16085.13 3638.5,-16085.13"/>
</g>
<!-- layer40_moe_expert9 -->
<g id="node1953" class="node">
<title>layer40_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4182,-16074.83 3854,-16074.83 3854,-16022.83 4182,-16022.83 4182,-16074.83"/>
<text text-anchor="middle" x="4018" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 9 L40</text>
<text text-anchor="middle" x="4018" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4018" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="4018" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert9 -->
<g id="node1977" class="node">
<title>layer40_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3944" cy="-15957.84" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3944" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3944" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3944" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer40_moe_expert9&#45;&gt;layer40_moe_comm_from_expert9 -->
<g id="edge2536" class="edge">
<title>layer40_moe_expert9&#45;&gt;layer40_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3944.25,-16022.51C3944.25,-16022.51 3944.25,-15996.97 3944.25,-15996.97"/>
<polygon fill="black" stroke="black" points="3947.75,-15996.97 3944.25,-15986.97 3940.75,-15996.97 3947.75,-15996.97"/>
</g>
<!-- layer40_moe_comm_to_expert9&#45;&gt;layer40_moe_expert9 -->
<g id="edge2505" class="edge">
<title>layer40_moe_comm_to_expert9&#45;&gt;layer40_moe_expert9</title>
<path fill="none" stroke="black" d="M3944.25,-16110.78C3944.25,-16110.78 3944.25,-16085.13 3944.25,-16085.13"/>
<polygon fill="black" stroke="black" points="3947.75,-16085.13 3944.25,-16075.13 3940.75,-16085.13 3947.75,-16085.13"/>
</g>
<!-- layer40_moe_expert10 -->
<g id="node1955" class="node">
<title>layer40_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4538,-16074.83 4200,-16074.83 4200,-16022.83 4538,-16022.83 4538,-16074.83"/>
<text text-anchor="middle" x="4369" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 10 L40</text>
<text text-anchor="middle" x="4369" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4369" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4369" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert10 -->
<g id="node1978" class="node">
<title>layer40_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4276" cy="-15957.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4276" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4276" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4276" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer40_moe_expert10&#45;&gt;layer40_moe_comm_from_expert10 -->
<g id="edge2538" class="edge">
<title>layer40_moe_expert10&#45;&gt;layer40_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4285.38,-16022.51C4285.38,-16022.51 4285.38,-15996.97 4285.38,-15996.97"/>
<polygon fill="black" stroke="black" points="4288.88,-15996.97 4285.38,-15986.97 4281.88,-15996.97 4288.88,-15996.97"/>
</g>
<!-- layer40_moe_comm_to_expert10&#45;&gt;layer40_moe_expert10 -->
<g id="edge2507" class="edge">
<title>layer40_moe_comm_to_expert10&#45;&gt;layer40_moe_expert10</title>
<path fill="none" stroke="black" d="M4285.02,-16110.78C4285.02,-16110.78 4285.02,-16085.13 4285.02,-16085.13"/>
<polygon fill="black" stroke="black" points="4288.52,-16085.13 4285.02,-16075.13 4281.52,-16085.13 4288.52,-16085.13"/>
</g>
<!-- layer40_moe_expert11 -->
<g id="node1957" class="node">
<title>layer40_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4894,-16074.83 4556,-16074.83 4556,-16022.83 4894,-16022.83 4894,-16074.83"/>
<text text-anchor="middle" x="4725" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 11 L40</text>
<text text-anchor="middle" x="4725" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4725" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4725" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert11 -->
<g id="node1979" class="node">
<title>layer40_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4623" cy="-15957.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4623" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4623" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4623" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer40_moe_expert11&#45;&gt;layer40_moe_comm_from_expert11 -->
<g id="edge2540" class="edge">
<title>layer40_moe_expert11&#45;&gt;layer40_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4636.88,-16022.51C4636.88,-16022.51 4636.88,-15996.65 4636.88,-15996.65"/>
<polygon fill="black" stroke="black" points="4640.38,-15996.65 4636.88,-15986.65 4633.38,-15996.65 4640.38,-15996.65"/>
</g>
<!-- layer40_moe_comm_to_expert11&#45;&gt;layer40_moe_expert11 -->
<g id="edge2509" class="edge">
<title>layer40_moe_comm_to_expert11&#45;&gt;layer40_moe_expert11</title>
<path fill="none" stroke="black" d="M4636.02,-16111.03C4636.02,-16111.03 4636.02,-16084.97 4636.02,-16084.97"/>
<polygon fill="black" stroke="black" points="4639.52,-16084.97 4636.02,-16074.97 4632.52,-16084.97 4639.52,-16084.97"/>
</g>
<!-- layer40_moe_expert12 -->
<g id="node1959" class="node">
<title>layer40_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5250,-16074.83 4912,-16074.83 4912,-16022.83 5250,-16022.83 5250,-16074.83"/>
<text text-anchor="middle" x="5081" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 12 L40</text>
<text text-anchor="middle" x="5081" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5081" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5081" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert12 -->
<g id="node1980" class="node">
<title>layer40_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4974" cy="-15957.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4974" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4974" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4974" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer40_moe_expert12&#45;&gt;layer40_moe_comm_from_expert12 -->
<g id="edge2542" class="edge">
<title>layer40_moe_expert12&#45;&gt;layer40_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4990.38,-16022.51C4990.38,-16022.51 4990.38,-15996.65 4990.38,-15996.65"/>
<polygon fill="black" stroke="black" points="4993.88,-15996.65 4990.38,-15986.65 4986.88,-15996.65 4993.88,-15996.65"/>
</g>
<!-- layer40_moe_comm_to_expert12&#45;&gt;layer40_moe_expert12 -->
<g id="edge2511" class="edge">
<title>layer40_moe_comm_to_expert12&#45;&gt;layer40_moe_expert12</title>
<path fill="none" stroke="black" d="M4989.52,-16111.03C4989.52,-16111.03 4989.52,-16084.97 4989.52,-16084.97"/>
<polygon fill="black" stroke="black" points="4993.02,-16084.97 4989.52,-16074.97 4986.02,-16084.97 4993.02,-16084.97"/>
</g>
<!-- layer40_moe_expert13 -->
<g id="node1961" class="node">
<title>layer40_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5606,-16074.83 5268,-16074.83 5268,-16022.83 5606,-16022.83 5606,-16074.83"/>
<text text-anchor="middle" x="5437" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 13 L40</text>
<text text-anchor="middle" x="5437" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5437" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5437" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert13 -->
<g id="node1981" class="node">
<title>layer40_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5328" cy="-15957.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5328" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5328" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5328" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer40_moe_expert13&#45;&gt;layer40_moe_comm_from_expert13 -->
<g id="edge2544" class="edge">
<title>layer40_moe_expert13&#45;&gt;layer40_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5345.38,-16022.51C5345.38,-16022.51 5345.38,-15996.65 5345.38,-15996.65"/>
<polygon fill="black" stroke="black" points="5348.88,-15996.65 5345.38,-15986.65 5341.88,-15996.65 5348.88,-15996.65"/>
</g>
<!-- layer40_moe_comm_to_expert13&#45;&gt;layer40_moe_expert13 -->
<g id="edge2513" class="edge">
<title>layer40_moe_comm_to_expert13&#45;&gt;layer40_moe_expert13</title>
<path fill="none" stroke="black" d="M5344.02,-16111.03C5344.02,-16111.03 5344.02,-16084.97 5344.02,-16084.97"/>
<polygon fill="black" stroke="black" points="5347.52,-16084.97 5344.02,-16074.97 5340.52,-16084.97 5347.52,-16084.97"/>
</g>
<!-- layer40_moe_expert14 -->
<g id="node1963" class="node">
<title>layer40_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5962,-16074.83 5624,-16074.83 5624,-16022.83 5962,-16022.83 5962,-16074.83"/>
<text text-anchor="middle" x="5793" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 14 L40</text>
<text text-anchor="middle" x="5793" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5793" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5793" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert14 -->
<g id="node1982" class="node">
<title>layer40_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5683" cy="-15957.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5683" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5683" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5683" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer40_moe_expert14&#45;&gt;layer40_moe_comm_from_expert14 -->
<g id="edge2546" class="edge">
<title>layer40_moe_expert14&#45;&gt;layer40_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5700.88,-16022.51C5700.88,-16022.51 5700.88,-15996.33 5700.88,-15996.33"/>
<polygon fill="black" stroke="black" points="5704.38,-15996.33 5700.88,-15986.33 5697.38,-15996.33 5704.38,-15996.33"/>
</g>
<!-- layer40_moe_comm_to_expert14&#45;&gt;layer40_moe_expert14 -->
<g id="edge2515" class="edge">
<title>layer40_moe_comm_to_expert14&#45;&gt;layer40_moe_expert14</title>
<path fill="none" stroke="black" d="M5699.52,-16111.03C5699.52,-16111.03 5699.52,-16084.97 5699.52,-16084.97"/>
<polygon fill="black" stroke="black" points="5703.02,-16084.97 5699.52,-16074.97 5696.02,-16084.97 5703.02,-16084.97"/>
</g>
<!-- layer40_moe_expert15 -->
<g id="node1965" class="node">
<title>layer40_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6318,-16074.83 5980,-16074.83 5980,-16022.83 6318,-16022.83 6318,-16074.83"/>
<text text-anchor="middle" x="6149" y="-16062.83" font-family="Arial" font-size="10.00">EXPERT 15 L40</text>
<text text-anchor="middle" x="6149" y="-16051.83" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6149" y="-16040.83" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6149" y="-16029.83" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_comm_from_expert15 -->
<g id="node1983" class="node">
<title>layer40_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6038" cy="-15957.84" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6038" y="-15966.34" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6038" y="-15955.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6038" y="-15944.34" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer40_moe_expert15&#45;&gt;layer40_moe_comm_from_expert15 -->
<g id="edge2548" class="edge">
<title>layer40_moe_expert15&#45;&gt;layer40_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6056.38,-16022.51C6056.38,-16022.51 6056.38,-15996.33 6056.38,-15996.33"/>
<polygon fill="black" stroke="black" points="6059.88,-15996.33 6056.38,-15986.33 6052.88,-15996.33 6059.88,-15996.33"/>
</g>
<!-- layer40_moe_comm_to_expert15&#45;&gt;layer40_moe_expert15 -->
<g id="edge2517" class="edge">
<title>layer40_moe_comm_to_expert15&#45;&gt;layer40_moe_expert15</title>
<path fill="none" stroke="black" d="M6055.02,-16111.03C6055.02,-16111.03 6055.02,-16084.97 6055.02,-16084.97"/>
<polygon fill="black" stroke="black" points="6058.52,-16084.97 6055.02,-16074.97 6051.52,-16084.97 6058.52,-16084.97"/>
</g>
<!-- layer40_moe_aggregate -->
<g id="node1967" class="node">
<title>layer40_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3724.1,-15892.85 3307.16,-15892.85 3199.9,-15788.85 3616.84,-15788.85 3724.1,-15892.85"/>
<text text-anchor="middle" x="3462" y="-15854.85" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L40</text>
<text text-anchor="middle" x="3462" y="-15843.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3462" y="-15832.85" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3462" y="-15821.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_mha -->
<g id="node1984" class="node">
<title>layer41_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3592,-15752.85 3332,-15752.85 3332,-15700.85 3592,-15700.85 3592,-15752.85"/>
<text text-anchor="middle" x="3462" y="-15740.85" font-family="Arial" font-size="10.00">MHA L41</text>
<text text-anchor="middle" x="3462" y="-15729.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3462" y="-15718.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3462" y="-15707.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer40_moe_aggregate&#45;&gt;layer41_moe_mha -->
<g id="edge2617" class="edge">
<title>layer40_moe_aggregate&#45;&gt;layer41_moe_mha</title>
<path fill="none" stroke="black" d="M3462,-15788.52C3462,-15788.52 3462,-15763.08 3462,-15763.08"/>
<polygon fill="black" stroke="black" points="3465.5,-15763.08 3462,-15753.08 3458.5,-15763.08 3465.5,-15763.08"/>
</g>
<!-- layer40_moe_comm_from_expert0&#45;&gt;layer40_moe_aggregate -->
<g id="edge2519" class="edge">
<title>layer40_moe_comm_from_expert0&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M1035.75,-15948.15C1035.75,-15914.26 1035.75,-15803 1035.75,-15803 1035.75,-15803 3204.32,-15803 3204.32,-15803"/>
<polygon fill="black" stroke="black" points="3204.32,-15806.5 3214.32,-15803 3204.32,-15799.5 3204.32,-15806.5"/>
</g>
<!-- layer40_moe_comm_from_expert1&#45;&gt;layer40_moe_aggregate -->
<g id="edge2521" class="edge">
<title>layer40_moe_comm_from_expert1&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M1747.25,-15946.87C1747.25,-15913.9 1747.25,-15818 1747.25,-15818 1747.25,-15818 3219.85,-15818 3219.85,-15818"/>
<polygon fill="black" stroke="black" points="3219.85,-15821.5 3229.85,-15818 3219.85,-15814.5 3219.85,-15821.5"/>
</g>
<!-- layer40_moe_comm_from_expert2&#45;&gt;layer40_moe_aggregate -->
<g id="edge2523" class="edge">
<title>layer40_moe_comm_from_expert2&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M2191.01,-15940.22C2191.01,-15905.81 2191.01,-15833 2191.01,-15833 2191.01,-15833 3235.31,-15833 3235.31,-15833"/>
<polygon fill="black" stroke="black" points="3235.31,-15836.5 3245.31,-15833 3235.31,-15829.5 3235.31,-15836.5"/>
</g>
<!-- layer40_moe_comm_from_expert3&#45;&gt;layer40_moe_aggregate -->
<g id="edge2525" class="edge">
<title>layer40_moe_comm_from_expert3&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M2519.01,-15940.19C2519.01,-15909.14 2519.01,-15848 2519.01,-15848 2519.01,-15848 3250.86,-15848 3250.86,-15848"/>
<polygon fill="black" stroke="black" points="3250.86,-15851.5 3260.86,-15848 3250.86,-15844.5 3250.86,-15851.5"/>
</g>
<!-- layer40_moe_comm_from_expert4&#45;&gt;layer40_moe_aggregate -->
<g id="edge2527" class="edge">
<title>layer40_moe_comm_from_expert4&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M2789.75,-15943.85C2789.75,-15917.47 2789.75,-15863 2789.75,-15863 2789.75,-15863 3266.08,-15863 3266.08,-15863"/>
<polygon fill="black" stroke="black" points="3266.08,-15866.5 3276.08,-15863 3266.08,-15859.5 3266.08,-15866.5"/>
</g>
<!-- layer40_moe_comm_from_expert5&#45;&gt;layer40_moe_aggregate -->
<g id="edge2529" class="edge">
<title>layer40_moe_comm_from_expert5&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M3011.5,-15939.5C3011.5,-15915.65 3011.5,-15877 3011.5,-15877 3011.5,-15877 3280.72,-15877 3280.72,-15877"/>
<polygon fill="black" stroke="black" points="3280.72,-15880.5 3290.72,-15877 3280.72,-15873.5 3280.72,-15880.5"/>
</g>
<!-- layer40_moe_comm_from_expert6&#45;&gt;layer40_moe_aggregate -->
<g id="edge2531" class="edge">
<title>layer40_moe_comm_from_expert6&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M3223.11,-15938.26C3223.11,-15938.26 3223.11,-15850.9 3223.11,-15850.9"/>
<polygon fill="black" stroke="black" points="3226.61,-15850.9 3223.11,-15840.9 3219.61,-15850.9 3226.61,-15850.9"/>
</g>
<!-- layer40_moe_comm_from_expert7&#45;&gt;layer40_moe_aggregate -->
<g id="edge2533" class="edge">
<title>layer40_moe_comm_from_expert7&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M3363,-15928.62C3363,-15928.62 3363,-15902.91 3363,-15902.91"/>
<polygon fill="black" stroke="black" points="3366.5,-15902.91 3363,-15892.91 3359.5,-15902.91 3366.5,-15902.91"/>
</g>
<!-- layer40_moe_comm_from_expert8&#45;&gt;layer40_moe_aggregate -->
<g id="edge2535" class="edge">
<title>layer40_moe_comm_from_expert8&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M3634.39,-15928.62C3634.39,-15928.62 3634.39,-15902.91 3634.39,-15902.91"/>
<polygon fill="black" stroke="black" points="3637.89,-15902.91 3634.39,-15892.91 3630.89,-15902.91 3637.89,-15902.91"/>
</g>
<!-- layer40_moe_comm_from_expert9&#45;&gt;layer40_moe_aggregate -->
<g id="edge2537" class="edge">
<title>layer40_moe_comm_from_expert9&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M3925.5,-15929.38C3925.5,-15906.79 3925.5,-15879 3925.5,-15879 3925.5,-15879 3720.03,-15879 3720.03,-15879"/>
<polygon fill="black" stroke="black" points="3720.03,-15875.5 3710.03,-15879 3720.03,-15882.5 3720.03,-15875.5"/>
</g>
<!-- layer40_moe_comm_from_expert10&#45;&gt;layer40_moe_aggregate -->
<g id="edge2539" class="edge">
<title>layer40_moe_comm_from_expert10&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M4257.15,-15929.29C4257.15,-15902.33 4257.15,-15866 4257.15,-15866 4257.15,-15866 3706.54,-15866 3706.54,-15866"/>
<polygon fill="black" stroke="black" points="3706.54,-15862.5 3696.54,-15866 3706.54,-15869.5 3706.54,-15862.5"/>
</g>
<!-- layer40_moe_comm_from_expert11&#45;&gt;layer40_moe_aggregate -->
<g id="edge2541" class="edge">
<title>layer40_moe_comm_from_expert11&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M4603.65,-15929.19C4603.65,-15898.15 4603.65,-15853 4603.65,-15853 4603.65,-15853 3693.14,-15853 3693.14,-15853"/>
<polygon fill="black" stroke="black" points="3693.14,-15849.5 3683.14,-15853 3693.14,-15856.5 3693.14,-15849.5"/>
</g>
<!-- layer40_moe_comm_from_expert12&#45;&gt;layer40_moe_aggregate -->
<g id="edge2543" class="edge">
<title>layer40_moe_comm_from_expert12&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M4954.65,-15929.31C4954.65,-15894.44 4954.65,-15840 4954.65,-15840 4954.65,-15840 3679.94,-15840 3679.94,-15840"/>
<polygon fill="black" stroke="black" points="3679.94,-15836.5 3669.94,-15840 3679.94,-15843.5 3679.94,-15836.5"/>
</g>
<!-- layer40_moe_comm_from_expert13&#45;&gt;layer40_moe_aggregate -->
<g id="edge2545" class="edge">
<title>layer40_moe_comm_from_expert13&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M5308.15,-15929.45C5308.15,-15890.97 5308.15,-15827 5308.15,-15827 5308.15,-15827 3666.52,-15827 3666.52,-15827"/>
<polygon fill="black" stroke="black" points="3666.52,-15823.5 3656.52,-15827 3666.52,-15830.5 3666.52,-15823.5"/>
</g>
<!-- layer40_moe_comm_from_expert14&#45;&gt;layer40_moe_aggregate -->
<g id="edge2547" class="edge">
<title>layer40_moe_comm_from_expert14&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M5663.15,-15929.42C5663.15,-15887.5 5663.15,-15814 5663.15,-15814 5663.15,-15814 3653.06,-15814 3653.06,-15814"/>
<polygon fill="black" stroke="black" points="3653.06,-15810.5 3643.06,-15814 3653.06,-15817.5 3653.06,-15810.5"/>
</g>
<!-- layer40_moe_comm_from_expert15&#45;&gt;layer40_moe_aggregate -->
<g id="edge2549" class="edge">
<title>layer40_moe_comm_from_expert15&#45;&gt;layer40_moe_aggregate</title>
<path fill="none" stroke="black" d="M6018.15,-15929.44C6018.15,-15884.24 6018.15,-15801 6018.15,-15801 6018.15,-15801 3639.72,-15801 3639.72,-15801"/>
<polygon fill="black" stroke="black" points="3639.72,-15797.5 3629.72,-15801 3639.72,-15804.5 3639.72,-15797.5"/>
</g>
<!-- layer41_moe_gate -->
<g id="node1985" class="node">
<title>layer41_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3720.3,-15664.85 3309.4,-15664.85 3203.7,-15560.85 3614.6,-15560.85 3720.3,-15664.85"/>
<text text-anchor="middle" x="3462" y="-15626.85" font-family="Arial" font-size="10.00">GATE L41</text>
<text text-anchor="middle" x="3462" y="-15615.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3462" y="-15604.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3462" y="-15593.85" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer41_moe_mha&#45;&gt;layer41_moe_gate -->
<g id="edge2618" class="edge">
<title>layer41_moe_mha&#45;&gt;layer41_moe_gate</title>
<path fill="none" stroke="black" d="M3462,-15700.7C3462,-15700.7 3462,-15674.95 3462,-15674.95"/>
<polygon fill="black" stroke="black" points="3465.5,-15674.95 3462,-15664.95 3458.5,-15674.95 3465.5,-15674.95"/>
</g>
<!-- layer41_moe_split -->
<g id="node1986" class="node">
<title>layer41_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3716.01,-15524.85 3311.94,-15524.85 3207.99,-15420.85 3612.06,-15420.85 3716.01,-15524.85"/>
<text text-anchor="middle" x="3462" y="-15486.85" font-family="Arial" font-size="10.00">SPLIT TOKENS L41</text>
<text text-anchor="middle" x="3462" y="-15475.85" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3462" y="-15464.85" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3462" y="-15453.85" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer41_moe_gate&#45;&gt;layer41_moe_split -->
<g id="edge2619" class="edge">
<title>layer41_moe_gate&#45;&gt;layer41_moe_split</title>
<path fill="none" stroke="black" d="M3462,-15560.72C3462,-15560.72 3462,-15535.02 3462,-15535.02"/>
<polygon fill="black" stroke="black" points="3465.5,-15535.02 3462,-15525.02 3458.5,-15535.02 3465.5,-15535.02"/>
</g>
<!-- layer41_moe_comm_to_expert0 -->
<g id="node1988" class="node">
<title>layer41_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1381" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1381" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1381" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1381" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert0 -->
<g id="edge2553" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3295.78,-15509C2814.15,-15509 1451.75,-15509 1451.75,-15509 1451.75,-15509 1451.75,-15384.03 1451.75,-15384.03"/>
<polygon fill="black" stroke="black" points="1455.25,-15384.03 1451.75,-15374.03 1448.25,-15384.03 1455.25,-15384.03"/>
</g>
<!-- layer41_moe_comm_to_expert1 -->
<g id="node1990" class="node">
<title>layer41_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1626" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1626" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1626" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1626" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert1 -->
<g id="edge2555" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3281.92,-15495C2822.8,-15495 1644.5,-15495 1644.5,-15495 1644.5,-15495 1644.5,-15394.35 1644.5,-15394.35"/>
<polygon fill="black" stroke="black" points="1648,-15394.35 1644.5,-15384.35 1641,-15394.35 1648,-15394.35"/>
</g>
<!-- layer41_moe_comm_to_expert2 -->
<g id="node1992" class="node">
<title>layer41_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2082" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2082" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2082" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2082" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert2 -->
<g id="edge2557" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3266.93,-15480C2890.46,-15480 2100.5,-15480 2100.5,-15480 2100.5,-15480 2100.5,-15394.34 2100.5,-15394.34"/>
<polygon fill="black" stroke="black" points="2104,-15394.34 2100.5,-15384.34 2097,-15394.34 2104,-15394.34"/>
</g>
<!-- layer41_moe_comm_to_expert3 -->
<g id="node1994" class="node">
<title>layer41_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2410" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2410" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2410" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2410" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert3 -->
<g id="edge2559" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3251.92,-15465C2949.79,-15465 2428.5,-15465 2428.5,-15465 2428.5,-15465 2428.5,-15394.25 2428.5,-15394.25"/>
<polygon fill="black" stroke="black" points="2432,-15394.25 2428.5,-15384.25 2425,-15394.25 2432,-15394.25"/>
</g>
<!-- layer41_moe_comm_to_expert4 -->
<g id="node1996" class="node">
<title>layer41_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2673" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2673" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2673" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2673" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert4 -->
<g id="edge2561" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3237.07,-15450C3009.64,-15450 2691.5,-15450 2691.5,-15450 2691.5,-15450 2691.5,-15394.36 2691.5,-15394.36"/>
<polygon fill="black" stroke="black" points="2695,-15394.36 2691.5,-15384.36 2688,-15394.36 2695,-15394.36"/>
</g>
<!-- layer41_moe_comm_to_expert5 -->
<g id="node1998" class="node">
<title>layer41_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2904" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2904" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2904" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2904" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert5 -->
<g id="edge2563" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3221.83,-15435C3077.86,-15435 2922.5,-15435 2922.5,-15435 2922.5,-15435 2922.5,-15394.43 2922.5,-15394.43"/>
<polygon fill="black" stroke="black" points="2926,-15394.43 2922.5,-15384.43 2919,-15394.43 2926,-15394.43"/>
</g>
<!-- layer41_moe_comm_to_expert6 -->
<g id="node2000" class="node">
<title>layer41_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3119" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3119" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3119" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3119" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert6 -->
<g id="edge2565" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3222.5,-15472.76C3222.5,-15469.2 3222.5,-15355 3222.5,-15355 3222.5,-15355 3219.81,-15355 3219.81,-15355"/>
<polygon fill="black" stroke="black" points="3219.81,-15351.5 3209.81,-15355 3219.81,-15358.5 3219.81,-15351.5"/>
</g>
<!-- layer41_moe_comm_to_expert7 -->
<g id="node2002" class="node">
<title>layer41_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3326" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3326" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3326" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3326" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert7 -->
<g id="edge2567" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3326,-15420.51C3326,-15420.51 3326,-15395.07 3326,-15395.07"/>
<polygon fill="black" stroke="black" points="3329.5,-15395.07 3326,-15385.07 3322.5,-15395.07 3329.5,-15395.07"/>
</g>
<!-- layer41_moe_comm_to_expert8 -->
<g id="node2004" class="node">
<title>layer41_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3598" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3598" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3598" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3598" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert8 -->
<g id="edge2569" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3598,-15420.51C3598,-15420.51 3598,-15395.07 3598,-15395.07"/>
<polygon fill="black" stroke="black" points="3601.5,-15395.07 3598,-15385.07 3594.5,-15395.07 3601.5,-15395.07"/>
</g>
<!-- layer41_moe_comm_to_expert9 -->
<g id="node2006" class="node">
<title>layer41_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3907" cy="-15355.86" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3907" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3907" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3907" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert9 -->
<g id="edge2571" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3702.26,-15472.76C3702.26,-15469.2 3702.26,-15355 3702.26,-15355 3702.26,-15355 3806.3,-15355 3806.3,-15355"/>
<polygon fill="black" stroke="black" points="3806.3,-15358.5 3816.3,-15355 3806.3,-15351.5 3806.3,-15358.5"/>
</g>
<!-- layer41_moe_comm_to_expert10 -->
<g id="node2008" class="node">
<title>layer41_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4239" cy="-15355.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4239" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4239" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4239" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert10 -->
<g id="edge2573" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3626.38,-15435C3833.6,-15435 4163.1,-15435 4163.1,-15435 4163.1,-15435 4163.1,-15383.03 4163.1,-15383.03"/>
<polygon fill="black" stroke="black" points="4166.6,-15383.03 4163.1,-15373.03 4159.6,-15383.03 4166.6,-15383.03"/>
</g>
<!-- layer41_moe_comm_to_expert11 -->
<g id="node2010" class="node">
<title>layer41_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4585" cy="-15355.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4585" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4585" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4585" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert11 -->
<g id="edge2575" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3641.49,-15450C3940.86,-15450 4509.6,-15450 4509.6,-15450 4509.6,-15450 4509.6,-15383.57 4509.6,-15383.57"/>
<polygon fill="black" stroke="black" points="4513.1,-15383.57 4509.6,-15373.57 4506.1,-15383.57 4513.1,-15383.57"/>
</g>
<!-- layer41_moe_comm_to_expert12 -->
<g id="node2012" class="node">
<title>layer41_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4936" cy="-15355.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4936" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4936" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4936" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert12 -->
<g id="edge2577" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3656.47,-15465C4040.77,-15465 4860.6,-15465 4860.6,-15465 4860.6,-15465 4860.6,-15383.39 4860.6,-15383.39"/>
<polygon fill="black" stroke="black" points="4864.1,-15383.39 4860.6,-15373.39 4857.1,-15383.39 4864.1,-15383.39"/>
</g>
<!-- layer41_moe_comm_to_expert13 -->
<g id="node2014" class="node">
<title>layer41_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5289" cy="-15355.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5289" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5289" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5289" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert13 -->
<g id="edge2579" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3671.6,-15480C4136.67,-15480 5214.1,-15480 5214.1,-15480 5214.1,-15480 5214.1,-15383.64 5214.1,-15383.64"/>
<polygon fill="black" stroke="black" points="5217.6,-15383.64 5214.1,-15373.64 5210.6,-15383.64 5217.6,-15383.64"/>
</g>
<!-- layer41_moe_comm_to_expert14 -->
<g id="node2016" class="node">
<title>layer41_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5644" cy="-15355.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5644" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5644" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5644" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert14 -->
<g id="edge2581" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3686.5,-15495C4229.43,-15495 5569.1,-15495 5569.1,-15495 5569.1,-15495 5569.1,-15383.48 5569.1,-15383.48"/>
<polygon fill="black" stroke="black" points="5572.6,-15383.48 5569.1,-15373.48 5565.6,-15383.48 5572.6,-15383.48"/>
</g>
<!-- layer41_moe_comm_to_expert15 -->
<g id="node2018" class="node">
<title>layer41_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5999" cy="-15355.86" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5999" y="-15364.36" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5999" y="-15353.36" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5999" y="-15342.36" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert15 -->
<g id="edge2583" class="edge">
<title>layer41_moe_split&#45;&gt;layer41_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3700.31,-15509C4318.21,-15509 5924.1,-15509 5924.1,-15509 5924.1,-15509 5924.1,-15383.43 5924.1,-15383.43"/>
<polygon fill="black" stroke="black" points="5927.6,-15383.43 5924.1,-15373.43 5920.6,-15383.43 5927.6,-15383.43"/>
</g>
<!-- layer41_moe_expert0 -->
<g id="node1987" class="node">
<title>layer41_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="1031,-15290.87 703,-15290.87 703,-15238.87 1031,-15238.87 1031,-15290.87"/>
<text text-anchor="middle" x="867" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 0 L41</text>
<text text-anchor="middle" x="867" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="867" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="867" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert0 -->
<g id="node2020" class="node">
<title>layer41_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="954" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="954" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="954" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="954" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer41_moe_expert0&#45;&gt;layer41_moe_comm_from_expert0 -->
<g id="edge2585" class="edge">
<title>layer41_moe_expert0&#45;&gt;layer41_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M947.25,-15238.55C947.25,-15238.55 947.25,-15213.01 947.25,-15213.01"/>
<polygon fill="black" stroke="black" points="950.75,-15213.01 947.25,-15203.01 943.75,-15213.01 950.75,-15213.01"/>
</g>
<!-- layer41_moe_comm_to_expert0&#45;&gt;layer41_moe_expert0 -->
<g id="edge2554" class="edge">
<title>layer41_moe_comm_to_expert0&#45;&gt;layer41_moe_expert0</title>
<path fill="none" stroke="black" d="M1290.45,-15355C1162.78,-15355 945.25,-15355 945.25,-15355 945.25,-15355 945.25,-15300.94 945.25,-15300.94"/>
<polygon fill="black" stroke="black" points="948.75,-15300.94 945.25,-15290.94 941.75,-15300.94 948.75,-15300.94"/>
</g>
<!-- layer41_moe_expert1 -->
<g id="node1989" class="node">
<title>layer41_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1377,-15290.87 1049,-15290.87 1049,-15238.87 1377,-15238.87 1377,-15290.87"/>
<text text-anchor="middle" x="1213" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 1 L41</text>
<text text-anchor="middle" x="1213" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1213" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1213" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert1 -->
<g id="node2021" class="node">
<title>layer41_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1594" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1594" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1594" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1594" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer41_moe_expert1&#45;&gt;layer41_moe_comm_from_expert1 -->
<g id="edge2587" class="edge">
<title>layer41_moe_expert1&#45;&gt;layer41_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1315.25,-15238.79C1315.25,-15211.63 1315.25,-15173 1315.25,-15173 1315.25,-15173 1493.5,-15173 1493.5,-15173"/>
<polygon fill="black" stroke="black" points="1493.5,-15176.5 1503.5,-15173 1493.5,-15169.5 1493.5,-15176.5"/>
</g>
<!-- layer41_moe_comm_to_expert1&#45;&gt;layer41_moe_expert1 -->
<g id="edge2556" class="edge">
<title>layer41_moe_comm_to_expert1&#45;&gt;layer41_moe_expert1</title>
<path fill="none" stroke="black" d="M1626,-15326.76C1626,-15312.77 1626,-15299 1626,-15299 1626,-15299 1333.75,-15299 1333.75,-15299 1333.75,-15299 1333.75,-15298.21 1333.75,-15298.21"/>
<polygon fill="black" stroke="black" points="1337.25,-15301.08 1333.75,-15291.08 1330.25,-15301.08 1337.25,-15301.08"/>
</g>
<!-- layer41_moe_expert2 -->
<g id="node1991" class="node">
<title>layer41_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1723,-15290.87 1395,-15290.87 1395,-15238.87 1723,-15238.87 1723,-15290.87"/>
<text text-anchor="middle" x="1559" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 2 L41</text>
<text text-anchor="middle" x="1559" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1559" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1559" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert2 -->
<g id="node2022" class="node">
<title>layer41_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2013" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2013" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2013" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2013" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer41_moe_expert2&#45;&gt;layer41_moe_comm_from_expert2 -->
<g id="edge2589" class="edge">
<title>layer41_moe_expert2&#45;&gt;layer41_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1713.5,-15238.79C1713.5,-15211.63 1713.5,-15173 1713.5,-15173 1713.5,-15173 1912.33,-15173 1912.33,-15173"/>
<polygon fill="black" stroke="black" points="1912.33,-15176.5 1922.33,-15173 1912.33,-15169.5 1912.33,-15176.5"/>
</g>
<!-- layer41_moe_comm_to_expert2&#45;&gt;layer41_moe_expert2 -->
<g id="edge2558" class="edge">
<title>layer41_moe_comm_to_expert2&#45;&gt;layer41_moe_expert2</title>
<path fill="none" stroke="black" d="M1991.41,-15355C1887.71,-15355 1732,-15355 1732,-15355 1732,-15355 1732,-15264 1732,-15264 1732,-15264 1731.12,-15264 1731.12,-15264"/>
<polygon fill="black" stroke="black" points="1733.18,-15260.5 1723.18,-15264 1733.18,-15267.5 1733.18,-15260.5"/>
</g>
<!-- layer41_moe_expert3 -->
<g id="node1993" class="node">
<title>layer41_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2069,-15290.87 1741,-15290.87 1741,-15238.87 2069,-15238.87 2069,-15290.87"/>
<text text-anchor="middle" x="1905" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 3 L41</text>
<text text-anchor="middle" x="1905" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1905" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1905" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert3 -->
<g id="node2023" class="node">
<title>layer41_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2322" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2322" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2322" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2322" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer41_moe_expert3&#45;&gt;layer41_moe_comm_from_expert3 -->
<g id="edge2591" class="edge">
<title>layer41_moe_expert3&#45;&gt;layer41_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1995.75,-15238.77C1995.75,-15228.9 1995.75,-15220 1995.75,-15220 1995.75,-15220 2322,-15220 2322,-15220 2322,-15220 2322,-15213.09 2322,-15213.09"/>
<polygon fill="black" stroke="black" points="2325.5,-15213.09 2322,-15203.09 2318.5,-15213.09 2325.5,-15213.09"/>
</g>
<!-- layer41_moe_comm_to_expert3&#45;&gt;layer41_moe_expert3 -->
<g id="edge2560" class="edge">
<title>layer41_moe_comm_to_expert3&#45;&gt;layer41_moe_expert3</title>
<path fill="none" stroke="black" d="M2351.33,-15333.7C2351.33,-15324.98 2351.33,-15317 2351.33,-15317 2351.33,-15317 2030.25,-15317 2030.25,-15317 2030.25,-15317 2030.25,-15300.93 2030.25,-15300.93"/>
<polygon fill="black" stroke="black" points="2033.75,-15300.93 2030.25,-15290.93 2026.75,-15300.93 2033.75,-15300.93"/>
</g>
<!-- layer41_moe_expert4 -->
<g id="node1995" class="node">
<title>layer41_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2415,-15290.87 2087,-15290.87 2087,-15238.87 2415,-15238.87 2415,-15290.87"/>
<text text-anchor="middle" x="2251" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 4 L41</text>
<text text-anchor="middle" x="2251" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2251" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2251" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert4 -->
<g id="node2024" class="node">
<title>layer41_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2576" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2576" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2576" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2576" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer41_moe_expert4&#45;&gt;layer41_moe_comm_from_expert4 -->
<g id="edge2593" class="edge">
<title>layer41_moe_expert4&#45;&gt;layer41_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2415.18,-15264C2420.77,-15264 2424,-15264 2424,-15264 2424,-15264 2424,-15173 2424,-15173 2424,-15173 2475.39,-15173 2475.39,-15173"/>
<polygon fill="black" stroke="black" points="2475.39,-15176.5 2485.39,-15173 2475.39,-15169.5 2475.39,-15176.5"/>
</g>
<!-- layer41_moe_comm_to_expert4&#45;&gt;layer41_moe_expert4 -->
<g id="edge2562" class="edge">
<title>layer41_moe_comm_to_expert4&#45;&gt;layer41_moe_expert4</title>
<path fill="none" stroke="black" d="M2671.75,-15326.64C2671.75,-15316.68 2671.75,-15308 2671.75,-15308 2671.75,-15308 2383.16,-15308 2383.16,-15308 2383.16,-15308 2383.16,-15300.95 2383.16,-15300.95"/>
<polygon fill="black" stroke="black" points="2386.66,-15300.95 2383.16,-15290.95 2379.66,-15300.95 2386.66,-15300.95"/>
</g>
<!-- layer41_moe_expert5 -->
<g id="node1997" class="node">
<title>layer41_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2761,-15290.87 2433,-15290.87 2433,-15238.87 2761,-15238.87 2761,-15290.87"/>
<text text-anchor="middle" x="2597" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 5 L41</text>
<text text-anchor="middle" x="2597" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2597" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2597" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert5 -->
<g id="node2025" class="node">
<title>layer41_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2803" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2803" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2803" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2803" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer41_moe_expert5&#45;&gt;layer41_moe_comm_from_expert5 -->
<g id="edge2595" class="edge">
<title>layer41_moe_expert5&#45;&gt;layer41_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2736.75,-15238.55C2736.75,-15238.55 2736.75,-15203.77 2736.75,-15203.77"/>
<polygon fill="black" stroke="black" points="2740.25,-15203.77 2736.75,-15193.77 2733.25,-15203.77 2740.25,-15203.77"/>
</g>
<!-- layer41_moe_comm_to_expert5&#45;&gt;layer41_moe_expert5 -->
<g id="edge2564" class="edge">
<title>layer41_moe_comm_to_expert5&#45;&gt;layer41_moe_expert5</title>
<path fill="none" stroke="black" d="M2813.26,-15355C2789.92,-15355 2771.25,-15355 2771.25,-15355 2771.25,-15355 2771.25,-15264 2771.25,-15264 2771.25,-15264 2770.24,-15264 2770.24,-15264"/>
<polygon fill="black" stroke="black" points="2771.13,-15260.5 2761.13,-15264 2771.13,-15267.5 2771.13,-15260.5"/>
</g>
<!-- layer41_moe_expert6 -->
<g id="node1999" class="node">
<title>layer41_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3107,-15290.87 2779,-15290.87 2779,-15238.87 3107,-15238.87 3107,-15290.87"/>
<text text-anchor="middle" x="2943" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 6 L41</text>
<text text-anchor="middle" x="2943" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2943" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2943" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert6 -->
<g id="node2026" class="node">
<title>layer41_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3016" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3016" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3016" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3016" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer41_moe_expert6&#45;&gt;layer41_moe_comm_from_expert6 -->
<g id="edge2597" class="edge">
<title>layer41_moe_expert6&#45;&gt;layer41_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M3016,-15238.55C3016,-15238.55 3016,-15213.01 3016,-15213.01"/>
<polygon fill="black" stroke="black" points="3019.5,-15213.01 3016,-15203.01 3012.5,-15213.01 3019.5,-15213.01"/>
</g>
<!-- layer41_moe_comm_to_expert6&#45;&gt;layer41_moe_expert6 -->
<g id="edge2566" class="edge">
<title>layer41_moe_comm_to_expert6&#45;&gt;layer41_moe_expert6</title>
<path fill="none" stroke="black" d="M3067.75,-15331.95C3067.75,-15331.95 3067.75,-15301.17 3067.75,-15301.17"/>
<polygon fill="black" stroke="black" points="3071.25,-15301.17 3067.75,-15291.17 3064.25,-15301.17 3071.25,-15301.17"/>
</g>
<!-- layer41_moe_expert7 -->
<g id="node2001" class="node">
<title>layer41_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3453,-15290.87 3125,-15290.87 3125,-15238.87 3453,-15238.87 3453,-15290.87"/>
<text text-anchor="middle" x="3289" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 7 L41</text>
<text text-anchor="middle" x="3289" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3289" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3289" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert7 -->
<g id="node2027" class="node">
<title>layer41_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3326" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3326" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3326" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3326" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer41_moe_expert7&#45;&gt;layer41_moe_comm_from_expert7 -->
<g id="edge2599" class="edge">
<title>layer41_moe_expert7&#45;&gt;layer41_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3326,-15238.55C3326,-15238.55 3326,-15213.01 3326,-15213.01"/>
<polygon fill="black" stroke="black" points="3329.5,-15213.01 3326,-15203.01 3322.5,-15213.01 3329.5,-15213.01"/>
</g>
<!-- layer41_moe_comm_to_expert7&#45;&gt;layer41_moe_expert7 -->
<g id="edge2568" class="edge">
<title>layer41_moe_comm_to_expert7&#45;&gt;layer41_moe_expert7</title>
<path fill="none" stroke="black" d="M3326,-15326.82C3326,-15326.82 3326,-15301.17 3326,-15301.17"/>
<polygon fill="black" stroke="black" points="3329.5,-15301.17 3326,-15291.17 3322.5,-15301.17 3329.5,-15301.17"/>
</g>
<!-- layer41_moe_expert8 -->
<g id="node2003" class="node">
<title>layer41_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3799,-15290.87 3471,-15290.87 3471,-15238.87 3799,-15238.87 3799,-15290.87"/>
<text text-anchor="middle" x="3635" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 8 L41</text>
<text text-anchor="middle" x="3635" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3635" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3635" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert8 -->
<g id="node2028" class="node">
<title>layer41_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3598" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3598" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3598" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3598" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer41_moe_expert8&#45;&gt;layer41_moe_comm_from_expert8 -->
<g id="edge2601" class="edge">
<title>layer41_moe_expert8&#45;&gt;layer41_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3598,-15238.55C3598,-15238.55 3598,-15213.01 3598,-15213.01"/>
<polygon fill="black" stroke="black" points="3601.5,-15213.01 3598,-15203.01 3594.5,-15213.01 3601.5,-15213.01"/>
</g>
<!-- layer41_moe_comm_to_expert8&#45;&gt;layer41_moe_expert8 -->
<g id="edge2570" class="edge">
<title>layer41_moe_comm_to_expert8&#45;&gt;layer41_moe_expert8</title>
<path fill="none" stroke="black" d="M3598,-15326.82C3598,-15326.82 3598,-15301.17 3598,-15301.17"/>
<polygon fill="black" stroke="black" points="3601.5,-15301.17 3598,-15291.17 3594.5,-15301.17 3601.5,-15301.17"/>
</g>
<!-- layer41_moe_expert9 -->
<g id="node2005" class="node">
<title>layer41_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4145,-15290.87 3817,-15290.87 3817,-15238.87 4145,-15238.87 4145,-15290.87"/>
<text text-anchor="middle" x="3981" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 9 L41</text>
<text text-anchor="middle" x="3981" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3981" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3981" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert9 -->
<g id="node2029" class="node">
<title>layer41_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3907" cy="-15173.88" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3907" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3907" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3907" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer41_moe_expert9&#45;&gt;layer41_moe_comm_from_expert9 -->
<g id="edge2603" class="edge">
<title>layer41_moe_expert9&#45;&gt;layer41_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3907.25,-15238.55C3907.25,-15238.55 3907.25,-15213.01 3907.25,-15213.01"/>
<polygon fill="black" stroke="black" points="3910.75,-15213.01 3907.25,-15203.01 3903.75,-15213.01 3910.75,-15213.01"/>
</g>
<!-- layer41_moe_comm_to_expert9&#45;&gt;layer41_moe_expert9 -->
<g id="edge2572" class="edge">
<title>layer41_moe_comm_to_expert9&#45;&gt;layer41_moe_expert9</title>
<path fill="none" stroke="black" d="M3907.25,-15326.82C3907.25,-15326.82 3907.25,-15301.17 3907.25,-15301.17"/>
<polygon fill="black" stroke="black" points="3910.75,-15301.17 3907.25,-15291.17 3903.75,-15301.17 3910.75,-15301.17"/>
</g>
<!-- layer41_moe_expert10 -->
<g id="node2007" class="node">
<title>layer41_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4501,-15290.87 4163,-15290.87 4163,-15238.87 4501,-15238.87 4501,-15290.87"/>
<text text-anchor="middle" x="4332" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 10 L41</text>
<text text-anchor="middle" x="4332" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4332" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4332" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert10 -->
<g id="node2030" class="node">
<title>layer41_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4239" cy="-15173.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4239" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4239" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4239" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer41_moe_expert10&#45;&gt;layer41_moe_comm_from_expert10 -->
<g id="edge2605" class="edge">
<title>layer41_moe_expert10&#45;&gt;layer41_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4248.38,-15238.55C4248.38,-15238.55 4248.38,-15213.01 4248.38,-15213.01"/>
<polygon fill="black" stroke="black" points="4251.88,-15213.01 4248.38,-15203.01 4244.88,-15213.01 4251.88,-15213.01"/>
</g>
<!-- layer41_moe_comm_to_expert10&#45;&gt;layer41_moe_expert10 -->
<g id="edge2574" class="edge">
<title>layer41_moe_comm_to_expert10&#45;&gt;layer41_moe_expert10</title>
<path fill="none" stroke="black" d="M4248.02,-15326.82C4248.02,-15326.82 4248.02,-15301.17 4248.02,-15301.17"/>
<polygon fill="black" stroke="black" points="4251.52,-15301.17 4248.02,-15291.17 4244.52,-15301.17 4251.52,-15301.17"/>
</g>
<!-- layer41_moe_expert11 -->
<g id="node2009" class="node">
<title>layer41_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4857,-15290.87 4519,-15290.87 4519,-15238.87 4857,-15238.87 4857,-15290.87"/>
<text text-anchor="middle" x="4688" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 11 L41</text>
<text text-anchor="middle" x="4688" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4688" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4688" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert11 -->
<g id="node2031" class="node">
<title>layer41_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4586" cy="-15173.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4586" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4586" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4586" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer41_moe_expert11&#45;&gt;layer41_moe_comm_from_expert11 -->
<g id="edge2607" class="edge">
<title>layer41_moe_expert11&#45;&gt;layer41_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4599.88,-15238.55C4599.88,-15238.55 4599.88,-15212.68 4599.88,-15212.68"/>
<polygon fill="black" stroke="black" points="4603.38,-15212.68 4599.88,-15202.68 4596.38,-15212.68 4603.38,-15212.68"/>
</g>
<!-- layer41_moe_comm_to_expert11&#45;&gt;layer41_moe_expert11 -->
<g id="edge2576" class="edge">
<title>layer41_moe_comm_to_expert11&#45;&gt;layer41_moe_expert11</title>
<path fill="none" stroke="black" d="M4599.02,-15327.07C4599.02,-15327.07 4599.02,-15301 4599.02,-15301"/>
<polygon fill="black" stroke="black" points="4602.52,-15301 4599.02,-15291 4595.52,-15301 4602.52,-15301"/>
</g>
<!-- layer41_moe_expert12 -->
<g id="node2011" class="node">
<title>layer41_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5213,-15290.87 4875,-15290.87 4875,-15238.87 5213,-15238.87 5213,-15290.87"/>
<text text-anchor="middle" x="5044" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 12 L41</text>
<text text-anchor="middle" x="5044" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5044" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5044" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert12 -->
<g id="node2032" class="node">
<title>layer41_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4937" cy="-15173.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4937" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4937" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4937" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer41_moe_expert12&#45;&gt;layer41_moe_comm_from_expert12 -->
<g id="edge2609" class="edge">
<title>layer41_moe_expert12&#45;&gt;layer41_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4953.38,-15238.55C4953.38,-15238.55 4953.38,-15212.68 4953.38,-15212.68"/>
<polygon fill="black" stroke="black" points="4956.88,-15212.68 4953.38,-15202.68 4949.88,-15212.68 4956.88,-15212.68"/>
</g>
<!-- layer41_moe_comm_to_expert12&#45;&gt;layer41_moe_expert12 -->
<g id="edge2578" class="edge">
<title>layer41_moe_comm_to_expert12&#45;&gt;layer41_moe_expert12</title>
<path fill="none" stroke="black" d="M4952.52,-15327.07C4952.52,-15327.07 4952.52,-15301 4952.52,-15301"/>
<polygon fill="black" stroke="black" points="4956.02,-15301 4952.52,-15291 4949.02,-15301 4956.02,-15301"/>
</g>
<!-- layer41_moe_expert13 -->
<g id="node2013" class="node">
<title>layer41_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5569,-15290.87 5231,-15290.87 5231,-15238.87 5569,-15238.87 5569,-15290.87"/>
<text text-anchor="middle" x="5400" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 13 L41</text>
<text text-anchor="middle" x="5400" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5400" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5400" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert13 -->
<g id="node2033" class="node">
<title>layer41_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5291" cy="-15173.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5291" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5291" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5291" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer41_moe_expert13&#45;&gt;layer41_moe_comm_from_expert13 -->
<g id="edge2611" class="edge">
<title>layer41_moe_expert13&#45;&gt;layer41_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5308.38,-15238.55C5308.38,-15238.55 5308.38,-15212.68 5308.38,-15212.68"/>
<polygon fill="black" stroke="black" points="5311.88,-15212.68 5308.38,-15202.68 5304.88,-15212.68 5311.88,-15212.68"/>
</g>
<!-- layer41_moe_comm_to_expert13&#45;&gt;layer41_moe_expert13 -->
<g id="edge2580" class="edge">
<title>layer41_moe_comm_to_expert13&#45;&gt;layer41_moe_expert13</title>
<path fill="none" stroke="black" d="M5307.02,-15327.07C5307.02,-15327.07 5307.02,-15301 5307.02,-15301"/>
<polygon fill="black" stroke="black" points="5310.52,-15301 5307.02,-15291 5303.52,-15301 5310.52,-15301"/>
</g>
<!-- layer41_moe_expert14 -->
<g id="node2015" class="node">
<title>layer41_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5925,-15290.87 5587,-15290.87 5587,-15238.87 5925,-15238.87 5925,-15290.87"/>
<text text-anchor="middle" x="5756" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 14 L41</text>
<text text-anchor="middle" x="5756" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5756" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5756" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert14 -->
<g id="node2034" class="node">
<title>layer41_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5646" cy="-15173.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5646" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5646" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5646" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer41_moe_expert14&#45;&gt;layer41_moe_comm_from_expert14 -->
<g id="edge2613" class="edge">
<title>layer41_moe_expert14&#45;&gt;layer41_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5663.88,-15238.55C5663.88,-15238.55 5663.88,-15212.36 5663.88,-15212.36"/>
<polygon fill="black" stroke="black" points="5667.38,-15212.36 5663.88,-15202.36 5660.38,-15212.36 5667.38,-15212.36"/>
</g>
<!-- layer41_moe_comm_to_expert14&#45;&gt;layer41_moe_expert14 -->
<g id="edge2582" class="edge">
<title>layer41_moe_comm_to_expert14&#45;&gt;layer41_moe_expert14</title>
<path fill="none" stroke="black" d="M5662.52,-15327.07C5662.52,-15327.07 5662.52,-15301 5662.52,-15301"/>
<polygon fill="black" stroke="black" points="5666.02,-15301 5662.52,-15291 5659.02,-15301 5666.02,-15301"/>
</g>
<!-- layer41_moe_expert15 -->
<g id="node2017" class="node">
<title>layer41_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6281,-15290.87 5943,-15290.87 5943,-15238.87 6281,-15238.87 6281,-15290.87"/>
<text text-anchor="middle" x="6112" y="-15278.87" font-family="Arial" font-size="10.00">EXPERT 15 L41</text>
<text text-anchor="middle" x="6112" y="-15267.87" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6112" y="-15256.87" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6112" y="-15245.87" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_comm_from_expert15 -->
<g id="node2035" class="node">
<title>layer41_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="6001" cy="-15173.88" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="6001" y="-15182.38" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="6001" y="-15171.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="6001" y="-15160.38" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer41_moe_expert15&#45;&gt;layer41_moe_comm_from_expert15 -->
<g id="edge2615" class="edge">
<title>layer41_moe_expert15&#45;&gt;layer41_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M6019.38,-15238.55C6019.38,-15238.55 6019.38,-15212.36 6019.38,-15212.36"/>
<polygon fill="black" stroke="black" points="6022.88,-15212.36 6019.38,-15202.36 6015.88,-15212.36 6022.88,-15212.36"/>
</g>
<!-- layer41_moe_comm_to_expert15&#45;&gt;layer41_moe_expert15 -->
<g id="edge2584" class="edge">
<title>layer41_moe_comm_to_expert15&#45;&gt;layer41_moe_expert15</title>
<path fill="none" stroke="black" d="M6018.02,-15327.07C6018.02,-15327.07 6018.02,-15301 6018.02,-15301"/>
<polygon fill="black" stroke="black" points="6021.52,-15301 6018.02,-15291 6014.52,-15301 6021.52,-15301"/>
</g>
<!-- layer41_moe_aggregate -->
<g id="node2019" class="node">
<title>layer41_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3687.1,-15108.88 3270.16,-15108.88 3162.9,-15004.88 3579.84,-15004.88 3687.1,-15108.88"/>
<text text-anchor="middle" x="3425" y="-15070.88" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L41</text>
<text text-anchor="middle" x="3425" y="-15059.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3425" y="-15048.88" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3425" y="-15037.88" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_mha -->
<g id="node2036" class="node">
<title>layer42_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3555,-14968.88 3295,-14968.88 3295,-14916.88 3555,-14916.88 3555,-14968.88"/>
<text text-anchor="middle" x="3425" y="-14956.88" font-family="Arial" font-size="10.00">MHA L42</text>
<text text-anchor="middle" x="3425" y="-14945.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3425" y="-14934.88" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3425" y="-14923.88" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer41_moe_aggregate&#45;&gt;layer42_moe_mha -->
<g id="edge2684" class="edge">
<title>layer41_moe_aggregate&#45;&gt;layer42_moe_mha</title>
<path fill="none" stroke="black" d="M3425,-15004.55C3425,-15004.55 3425,-14979.11 3425,-14979.11"/>
<polygon fill="black" stroke="black" points="3428.5,-14979.11 3425,-14969.11 3421.5,-14979.11 3428.5,-14979.11"/>
</g>
<!-- layer41_moe_comm_from_expert0&#45;&gt;layer41_moe_aggregate -->
<g id="edge2586" class="edge">
<title>layer41_moe_comm_from_expert0&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M1028.25,-15157.01C1028.25,-15116.87 1028.25,-15019 1028.25,-15019 1028.25,-15019 3167.25,-15019 3167.25,-15019"/>
<polygon fill="black" stroke="black" points="3167.25,-15022.5 3177.25,-15019 3167.25,-15015.5 3167.25,-15022.5"/>
</g>
<!-- layer41_moe_comm_from_expert1&#45;&gt;layer41_moe_aggregate -->
<g id="edge2588" class="edge">
<title>layer41_moe_comm_from_expert1&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M1620.84,-15145.91C1620.84,-15105.09 1620.84,-15034 1620.84,-15034 1620.84,-15034 3182.83,-15034 3182.83,-15034"/>
<polygon fill="black" stroke="black" points="3182.83,-15037.5 3192.83,-15034 3182.83,-15030.5 3182.83,-15037.5"/>
</g>
<!-- layer41_moe_comm_from_expert2&#45;&gt;layer41_moe_aggregate -->
<g id="edge2590" class="edge">
<title>layer41_moe_comm_from_expert2&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M2029,-15145.23C2029,-15108.36 2029,-15049 2029,-15049 2029,-15049 3198.02,-15049 3198.02,-15049"/>
<polygon fill="black" stroke="black" points="3198.02,-15052.5 3208.02,-15049 3198.02,-15045.5 3198.02,-15052.5"/>
</g>
<!-- layer41_moe_comm_from_expert3&#45;&gt;layer41_moe_aggregate -->
<g id="edge2592" class="edge">
<title>layer41_moe_comm_from_expert3&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M2347.5,-15145.86C2347.5,-15113.31 2347.5,-15064 2347.5,-15064 2347.5,-15064 3213.59,-15064 3213.59,-15064"/>
<polygon fill="black" stroke="black" points="3213.59,-15067.5 3223.59,-15064 3213.59,-15060.5 3213.59,-15067.5"/>
</g>
<!-- layer41_moe_comm_from_expert4&#45;&gt;layer41_moe_aggregate -->
<g id="edge2594" class="edge">
<title>layer41_moe_comm_from_expert4&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M2606,-15146.43C2606,-15118.41 2606,-15079 2606,-15079 2606,-15079 3229.16,-15079 3229.16,-15079"/>
<polygon fill="black" stroke="black" points="3229.16,-15082.5 3239.16,-15079 3229.16,-15075.5 3229.16,-15082.5"/>
</g>
<!-- layer41_moe_comm_from_expert5&#45;&gt;layer41_moe_aggregate -->
<g id="edge2596" class="edge">
<title>layer41_moe_comm_from_expert5&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M2835,-15146.39C2835,-15123.28 2835,-15094 2835,-15094 2835,-15094 3244.74,-15094 3244.74,-15094"/>
<polygon fill="black" stroke="black" points="3244.74,-15097.5 3254.74,-15094 3244.74,-15090.5 3244.74,-15097.5"/>
</g>
<!-- layer41_moe_comm_from_expert6&#45;&gt;layer41_moe_aggregate -->
<g id="edge2598" class="edge">
<title>layer41_moe_comm_from_expert6&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M3106.48,-15173C3152.6,-15173 3199.1,-15173 3199.1,-15173 3199.1,-15173 3199.1,-15066.97 3199.1,-15066.97"/>
<polygon fill="black" stroke="black" points="3202.6,-15066.97 3199.1,-15056.97 3195.6,-15066.97 3202.6,-15066.97"/>
</g>
<!-- layer41_moe_comm_from_expert7&#45;&gt;layer41_moe_aggregate -->
<g id="edge2600" class="edge">
<title>layer41_moe_comm_from_expert7&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M3326,-15144.66C3326,-15144.66 3326,-15118.94 3326,-15118.94"/>
<polygon fill="black" stroke="black" points="3329.5,-15118.94 3326,-15108.94 3322.5,-15118.94 3329.5,-15118.94"/>
</g>
<!-- layer41_moe_comm_from_expert8&#45;&gt;layer41_moe_aggregate -->
<g id="edge2602" class="edge">
<title>layer41_moe_comm_from_expert8&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M3597.39,-15144.66C3597.39,-15144.66 3597.39,-15118.94 3597.39,-15118.94"/>
<polygon fill="black" stroke="black" points="3600.89,-15118.94 3597.39,-15108.94 3593.89,-15118.94 3600.89,-15118.94"/>
</g>
<!-- layer41_moe_comm_from_expert9&#45;&gt;layer41_moe_aggregate -->
<g id="edge2604" class="edge">
<title>layer41_moe_comm_from_expert9&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M3888.5,-15145.4C3888.5,-15122.81 3888.5,-15095 3888.5,-15095 3888.5,-15095 3683.03,-15095 3683.03,-15095"/>
<polygon fill="black" stroke="black" points="3683.03,-15091.5 3673.03,-15095 3683.03,-15098.5 3683.03,-15091.5"/>
</g>
<!-- layer41_moe_comm_from_expert10&#45;&gt;layer41_moe_aggregate -->
<g id="edge2606" class="edge">
<title>layer41_moe_comm_from_expert10&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M4220.15,-15145.31C4220.15,-15118.34 4220.15,-15082 4220.15,-15082 4220.15,-15082 3669.54,-15082 3669.54,-15082"/>
<polygon fill="black" stroke="black" points="3669.54,-15078.5 3659.54,-15082 3669.54,-15085.5 3669.54,-15078.5"/>
</g>
<!-- layer41_moe_comm_from_expert11&#45;&gt;layer41_moe_aggregate -->
<g id="edge2608" class="edge">
<title>layer41_moe_comm_from_expert11&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M4566.65,-15145.49C4566.65,-15114.44 4566.65,-15069 4566.65,-15069 4566.65,-15069 3656.14,-15069 3656.14,-15069"/>
<polygon fill="black" stroke="black" points="3656.14,-15065.5 3646.14,-15069 3656.14,-15072.5 3656.14,-15065.5"/>
</g>
<!-- layer41_moe_comm_from_expert12&#45;&gt;layer41_moe_aggregate -->
<g id="edge2610" class="edge">
<title>layer41_moe_comm_from_expert12&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M4917.65,-15145.34C4917.65,-15110.46 4917.65,-15056 4917.65,-15056 4917.65,-15056 3642.94,-15056 3642.94,-15056"/>
<polygon fill="black" stroke="black" points="3642.94,-15052.5 3632.94,-15056 3642.94,-15059.5 3642.94,-15052.5"/>
</g>
<!-- layer41_moe_comm_from_expert13&#45;&gt;layer41_moe_aggregate -->
<g id="edge2612" class="edge">
<title>layer41_moe_comm_from_expert13&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M5271.15,-15145.48C5271.15,-15106.99 5271.15,-15043 5271.15,-15043 5271.15,-15043 3629.52,-15043 3629.52,-15043"/>
<polygon fill="black" stroke="black" points="3629.52,-15039.5 3619.52,-15043 3629.52,-15046.5 3629.52,-15039.5"/>
</g>
<!-- layer41_moe_comm_from_expert14&#45;&gt;layer41_moe_aggregate -->
<g id="edge2614" class="edge">
<title>layer41_moe_comm_from_expert14&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M5626.15,-15145.45C5626.15,-15103.52 5626.15,-15030 5626.15,-15030 5626.15,-15030 3616.06,-15030 3616.06,-15030"/>
<polygon fill="black" stroke="black" points="3616.06,-15026.5 3606.06,-15030 3616.06,-15033.5 3616.06,-15026.5"/>
</g>
<!-- layer41_moe_comm_from_expert15&#45;&gt;layer41_moe_aggregate -->
<g id="edge2616" class="edge">
<title>layer41_moe_comm_from_expert15&#45;&gt;layer41_moe_aggregate</title>
<path fill="none" stroke="black" d="M5981.15,-15145.47C5981.15,-15100.26 5981.15,-15017 5981.15,-15017 5981.15,-15017 3602.72,-15017 3602.72,-15017"/>
<polygon fill="black" stroke="black" points="3602.72,-15013.5 3592.72,-15017 3602.72,-15020.5 3602.72,-15013.5"/>
</g>
<!-- layer42_moe_gate -->
<g id="node2037" class="node">
<title>layer42_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3683.3,-14880.88 3272.4,-14880.88 3166.7,-14776.88 3577.6,-14776.88 3683.3,-14880.88"/>
<text text-anchor="middle" x="3425" y="-14842.88" font-family="Arial" font-size="10.00">GATE L42</text>
<text text-anchor="middle" x="3425" y="-14831.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3425" y="-14820.88" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3425" y="-14809.88" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer42_moe_mha&#45;&gt;layer42_moe_gate -->
<g id="edge2685" class="edge">
<title>layer42_moe_mha&#45;&gt;layer42_moe_gate</title>
<path fill="none" stroke="black" d="M3425,-14916.73C3425,-14916.73 3425,-14890.98 3425,-14890.98"/>
<polygon fill="black" stroke="black" points="3428.5,-14890.98 3425,-14880.98 3421.5,-14890.98 3428.5,-14890.98"/>
</g>
<!-- layer42_moe_split -->
<g id="node2038" class="node">
<title>layer42_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3679.01,-14740.88 3274.94,-14740.88 3170.99,-14636.88 3575.06,-14636.88 3679.01,-14740.88"/>
<text text-anchor="middle" x="3425" y="-14702.88" font-family="Arial" font-size="10.00">SPLIT TOKENS L42</text>
<text text-anchor="middle" x="3425" y="-14691.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3425" y="-14680.88" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3425" y="-14669.88" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer42_moe_gate&#45;&gt;layer42_moe_split -->
<g id="edge2686" class="edge">
<title>layer42_moe_gate&#45;&gt;layer42_moe_split</title>
<path fill="none" stroke="black" d="M3425,-14776.75C3425,-14776.75 3425,-14751.06 3425,-14751.06"/>
<polygon fill="black" stroke="black" points="3428.5,-14751.06 3425,-14741.06 3421.5,-14751.06 3428.5,-14751.06"/>
</g>
<!-- layer42_moe_comm_to_expert0 -->
<g id="node2040" class="node">
<title>layer42_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1344" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1344" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1344" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1344" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert0 -->
<g id="edge2620" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3259.64,-14726C2778.77,-14726 1414.75,-14726 1414.75,-14726 1414.75,-14726 1414.75,-14600.18 1414.75,-14600.18"/>
<polygon fill="black" stroke="black" points="1418.25,-14600.18 1414.75,-14590.18 1411.25,-14600.18 1418.25,-14600.18"/>
</g>
<!-- layer42_moe_comm_to_expert1 -->
<g id="node2042" class="node">
<title>layer42_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1589" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1589" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1589" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1589" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert1 -->
<g id="edge2622" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3244.69,-14711C2777.19,-14711 1562.16,-14711 1562.16,-14711 1562.16,-14711 1562.16,-14609.71 1562.16,-14609.71"/>
<polygon fill="black" stroke="black" points="1565.66,-14609.71 1562.16,-14599.71 1558.66,-14609.71 1565.66,-14609.71"/>
</g>
<!-- layer42_moe_comm_to_expert2 -->
<g id="node2044" class="node">
<title>layer42_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2045" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2045" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="2045" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2045" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert2 -->
<g id="edge2624" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3229.91,-14696C2865.85,-14696 2119.51,-14696 2119.51,-14696 2119.51,-14696 2119.51,-14598.37 2119.51,-14598.37"/>
<polygon fill="black" stroke="black" points="2123.01,-14598.37 2119.51,-14588.37 2116.01,-14598.37 2123.01,-14598.37"/>
</g>
<!-- layer42_moe_comm_to_expert3 -->
<g id="node2046" class="node">
<title>layer42_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2373" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2373" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2373" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2373" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert3 -->
<g id="edge2626" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3214.86,-14681C2927.8,-14681 2448.25,-14681 2448.25,-14681 2448.25,-14681 2448.25,-14598.46 2448.25,-14598.46"/>
<polygon fill="black" stroke="black" points="2451.75,-14598.46 2448.25,-14588.46 2444.75,-14598.46 2451.75,-14598.46"/>
</g>
<!-- layer42_moe_comm_to_expert4 -->
<g id="node2048" class="node">
<title>layer42_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2636" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2636" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2636" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2636" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert4 -->
<g id="edge2628" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3199.84,-14666C2993.37,-14666 2719.5,-14666 2719.5,-14666 2719.5,-14666 2719.5,-14593.43 2719.5,-14593.43"/>
<polygon fill="black" stroke="black" points="2723,-14593.43 2719.5,-14583.43 2716,-14593.43 2723,-14593.43"/>
</g>
<!-- layer42_moe_comm_to_expert5 -->
<g id="node2050" class="node">
<title>layer42_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2867" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2867" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2867" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2867" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert5 -->
<g id="edge2630" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3185.02,-14651C3063.56,-14651 2941.5,-14651 2941.5,-14651 2941.5,-14651 2941.5,-14598.67 2941.5,-14598.67"/>
<polygon fill="black" stroke="black" points="2945,-14598.67 2941.5,-14588.67 2938,-14598.67 2945,-14598.67"/>
</g>
<!-- layer42_moe_comm_to_expert6 -->
<g id="node2052" class="node">
<title>layer42_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3082" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3082" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3082" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3082" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert6 -->
<g id="edge2632" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3185.5,-14688.8C3185.5,-14685.23 3185.5,-14571 3185.5,-14571 3185.5,-14571 3182.81,-14571 3182.81,-14571"/>
<polygon fill="black" stroke="black" points="3182.81,-14567.5 3172.81,-14571 3182.81,-14574.5 3182.81,-14567.5"/>
</g>
<!-- layer42_moe_comm_to_expert7 -->
<g id="node2054" class="node">
<title>layer42_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3289" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3289" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3289" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3289" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert7 -->
<g id="edge2634" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3289,-14636.55C3289,-14636.55 3289,-14611.1 3289,-14611.1"/>
<polygon fill="black" stroke="black" points="3292.5,-14611.1 3289,-14601.1 3285.5,-14611.1 3292.5,-14611.1"/>
</g>
<!-- layer42_moe_comm_to_expert8 -->
<g id="node2056" class="node">
<title>layer42_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3561" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3561" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3561" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3561" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert8 -->
<g id="edge2636" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3561,-14636.55C3561,-14636.55 3561,-14611.1 3561,-14611.1"/>
<polygon fill="black" stroke="black" points="3564.5,-14611.1 3561,-14601.1 3557.5,-14611.1 3564.5,-14611.1"/>
</g>
<!-- layer42_moe_comm_to_expert9 -->
<g id="node2058" class="node">
<title>layer42_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3870" cy="-14571.89" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3870" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3870" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3870" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert9 -->
<g id="edge2638" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3665.26,-14688.8C3665.26,-14685.23 3665.26,-14571 3665.26,-14571 3665.26,-14571 3769.3,-14571 3769.3,-14571"/>
<polygon fill="black" stroke="black" points="3769.3,-14574.5 3779.3,-14571 3769.3,-14567.5 3769.3,-14574.5"/>
</g>
<!-- layer42_moe_comm_to_expert10 -->
<g id="node2060" class="node">
<title>layer42_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4202" cy="-14571.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4202" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4202" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4202" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert10 -->
<g id="edge2640" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3589.38,-14651C3796.6,-14651 4126.1,-14651 4126.1,-14651 4126.1,-14651 4126.1,-14599.06 4126.1,-14599.06"/>
<polygon fill="black" stroke="black" points="4129.6,-14599.06 4126.1,-14589.06 4122.6,-14599.06 4129.6,-14599.06"/>
</g>
<!-- layer42_moe_comm_to_expert11 -->
<g id="node2062" class="node">
<title>layer42_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4548" cy="-14571.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4548" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4548" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4548" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert11 -->
<g id="edge2642" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.2,-14666C3903.48,-14666 4472.6,-14666 4472.6,-14666 4472.6,-14666 4472.6,-14599.59 4472.6,-14599.59"/>
<polygon fill="black" stroke="black" points="4476.1,-14599.59 4472.6,-14589.59 4469.1,-14599.59 4476.1,-14599.59"/>
</g>
<!-- layer42_moe_comm_to_expert12 -->
<g id="node2064" class="node">
<title>layer42_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4899" cy="-14571.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4899" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4899" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4899" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert12 -->
<g id="edge2644" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3619.47,-14681C4003.77,-14681 4823.6,-14681 4823.6,-14681 4823.6,-14681 4823.6,-14599.42 4823.6,-14599.42"/>
<polygon fill="black" stroke="black" points="4827.1,-14599.42 4823.6,-14589.42 4820.1,-14599.42 4827.1,-14599.42"/>
</g>
<!-- layer42_moe_comm_to_expert13 -->
<g id="node2066" class="node">
<title>layer42_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5252" cy="-14571.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5252" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5252" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5252" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert13 -->
<g id="edge2646" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3634.17,-14696C4099,-14696 5177.1,-14696 5177.1,-14696 5177.1,-14696 5177.1,-14599.67 5177.1,-14599.67"/>
<polygon fill="black" stroke="black" points="5180.6,-14599.67 5177.1,-14589.67 5173.6,-14599.67 5180.6,-14599.67"/>
</g>
<!-- layer42_moe_comm_to_expert14 -->
<g id="node2068" class="node">
<title>layer42_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5607" cy="-14571.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5607" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5607" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5607" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert14 -->
<g id="edge2648" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3649.5,-14711C4192.43,-14711 5532.1,-14711 5532.1,-14711 5532.1,-14711 5532.1,-14599.51 5532.1,-14599.51"/>
<polygon fill="black" stroke="black" points="5535.6,-14599.51 5532.1,-14589.51 5528.6,-14599.51 5535.6,-14599.51"/>
</g>
<!-- layer42_moe_comm_to_expert15 -->
<g id="node2070" class="node">
<title>layer42_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5962" cy="-14571.89" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5962" y="-14580.39" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5962" y="-14569.39" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5962" y="-14558.39" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert15 -->
<g id="edge2650" class="edge">
<title>layer42_moe_split&#45;&gt;layer42_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3664.15,-14726C4282.66,-14726 5887.1,-14726 5887.1,-14726 5887.1,-14726 5887.1,-14599.57 5887.1,-14599.57"/>
<polygon fill="black" stroke="black" points="5890.6,-14599.57 5887.1,-14589.57 5883.6,-14599.57 5890.6,-14599.57"/>
</g>
<!-- layer42_moe_expert0 -->
<g id="node2039" class="node">
<title>layer42_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="994,-14506.9 666,-14506.9 666,-14454.9 994,-14454.9 994,-14506.9"/>
<text text-anchor="middle" x="830" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 0 L42</text>
<text text-anchor="middle" x="830" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="830" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="830" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert0 -->
<g id="node2072" class="node">
<title>layer42_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="917" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="917" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="917" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="917" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer42_moe_expert0&#45;&gt;layer42_moe_comm_from_expert0 -->
<g id="edge2652" class="edge">
<title>layer42_moe_expert0&#45;&gt;layer42_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M910.25,-14454.58C910.25,-14454.58 910.25,-14429.04 910.25,-14429.04"/>
<polygon fill="black" stroke="black" points="913.75,-14429.04 910.25,-14419.04 906.75,-14429.04 913.75,-14429.04"/>
</g>
<!-- layer42_moe_comm_to_expert0&#45;&gt;layer42_moe_expert0 -->
<g id="edge2621" class="edge">
<title>layer42_moe_comm_to_expert0&#45;&gt;layer42_moe_expert0</title>
<path fill="none" stroke="black" d="M1253.38,-14571C1131.2,-14571 928.75,-14571 928.75,-14571 928.75,-14571 928.75,-14516.96 928.75,-14516.96"/>
<polygon fill="black" stroke="black" points="932.25,-14516.96 928.75,-14506.96 925.25,-14516.96 932.25,-14516.96"/>
</g>
<!-- layer42_moe_expert1 -->
<g id="node2041" class="node">
<title>layer42_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1340,-14506.9 1012,-14506.9 1012,-14454.9 1340,-14454.9 1340,-14506.9"/>
<text text-anchor="middle" x="1176" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 1 L42</text>
<text text-anchor="middle" x="1176" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1176" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1176" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert1 -->
<g id="node2073" class="node">
<title>layer42_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1557" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1557" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1557" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1557" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer42_moe_expert1&#45;&gt;layer42_moe_comm_from_expert1 -->
<g id="edge2654" class="edge">
<title>layer42_moe_expert1&#45;&gt;layer42_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1330.5,-14454.81C1330.5,-14427.64 1330.5,-14389 1330.5,-14389 1330.5,-14389 1456.5,-14389 1456.5,-14389"/>
<polygon fill="black" stroke="black" points="1456.5,-14392.5 1466.5,-14389 1456.5,-14385.5 1456.5,-14392.5"/>
</g>
<!-- layer42_moe_comm_to_expert1&#45;&gt;layer42_moe_expert1 -->
<g id="edge2623" class="edge">
<title>layer42_moe_comm_to_expert1&#45;&gt;layer42_moe_expert1</title>
<path fill="none" stroke="black" d="M1589,-14542.78C1589,-14528.78 1589,-14515 1589,-14515 1589,-14515 1296.75,-14515 1296.75,-14515 1296.75,-14515 1296.75,-14514.21 1296.75,-14514.21"/>
<polygon fill="black" stroke="black" points="1300.25,-14517.09 1296.75,-14507.09 1293.25,-14517.09 1300.25,-14517.09"/>
</g>
<!-- layer42_moe_expert2 -->
<g id="node2043" class="node">
<title>layer42_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1686,-14506.9 1358,-14506.9 1358,-14454.9 1686,-14454.9 1686,-14506.9"/>
<text text-anchor="middle" x="1522" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 2 L42</text>
<text text-anchor="middle" x="1522" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1522" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1522" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert2 -->
<g id="node2074" class="node">
<title>layer42_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1976" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1976" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1976" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1976" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer42_moe_expert2&#45;&gt;layer42_moe_comm_from_expert2 -->
<g id="edge2656" class="edge">
<title>layer42_moe_expert2&#45;&gt;layer42_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1676.5,-14454.81C1676.5,-14427.64 1676.5,-14389 1676.5,-14389 1676.5,-14389 1875.33,-14389 1875.33,-14389"/>
<polygon fill="black" stroke="black" points="1875.33,-14392.5 1885.33,-14389 1875.33,-14385.5 1875.33,-14392.5"/>
</g>
<!-- layer42_moe_comm_to_expert2&#45;&gt;layer42_moe_expert2 -->
<g id="edge2625" class="edge">
<title>layer42_moe_comm_to_expert2&#45;&gt;layer42_moe_expert2</title>
<path fill="none" stroke="black" d="M1954.41,-14571C1850.71,-14571 1695,-14571 1695,-14571 1695,-14571 1695,-14480 1695,-14480 1695,-14480 1694.12,-14480 1694.12,-14480"/>
<polygon fill="black" stroke="black" points="1696.18,-14476.5 1686.18,-14480 1696.18,-14483.5 1696.18,-14476.5"/>
</g>
<!-- layer42_moe_expert3 -->
<g id="node2045" class="node">
<title>layer42_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="2032,-14506.9 1704,-14506.9 1704,-14454.9 2032,-14454.9 2032,-14506.9"/>
<text text-anchor="middle" x="1868" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 3 L42</text>
<text text-anchor="middle" x="1868" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1868" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1868" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert3 -->
<g id="node2075" class="node">
<title>layer42_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2285" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2285" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2285" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2285" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer42_moe_expert3&#45;&gt;layer42_moe_comm_from_expert3 -->
<g id="edge2658" class="edge">
<title>layer42_moe_expert3&#45;&gt;layer42_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1958.75,-14454.78C1958.75,-14444.9 1958.75,-14436 1958.75,-14436 1958.75,-14436 2285,-14436 2285,-14436 2285,-14436 2285,-14429.1 2285,-14429.1"/>
<polygon fill="black" stroke="black" points="2288.5,-14429.1 2285,-14419.1 2281.5,-14429.1 2288.5,-14429.1"/>
</g>
<!-- layer42_moe_comm_to_expert3&#45;&gt;layer42_moe_expert3 -->
<g id="edge2627" class="edge">
<title>layer42_moe_comm_to_expert3&#45;&gt;layer42_moe_expert3</title>
<path fill="none" stroke="black" d="M2314.33,-14549.72C2314.33,-14540.99 2314.33,-14533 2314.33,-14533 2314.33,-14533 1993.25,-14533 1993.25,-14533 1993.25,-14533 1993.25,-14516.95 1993.25,-14516.95"/>
<polygon fill="black" stroke="black" points="1996.75,-14516.95 1993.25,-14506.95 1989.75,-14516.95 1996.75,-14516.95"/>
</g>
<!-- layer42_moe_expert4 -->
<g id="node2047" class="node">
<title>layer42_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2378,-14506.9 2050,-14506.9 2050,-14454.9 2378,-14454.9 2378,-14506.9"/>
<text text-anchor="middle" x="2214" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 4 L42</text>
<text text-anchor="middle" x="2214" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2214" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2214" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert4 -->
<g id="node2076" class="node">
<title>layer42_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2539" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2539" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2539" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2539" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer42_moe_expert4&#45;&gt;layer42_moe_comm_from_expert4 -->
<g id="edge2660" class="edge">
<title>layer42_moe_expert4&#45;&gt;layer42_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2378.18,-14480C2383.77,-14480 2387,-14480 2387,-14480 2387,-14480 2387,-14389 2387,-14389 2387,-14389 2438.39,-14389 2438.39,-14389"/>
<polygon fill="black" stroke="black" points="2438.39,-14392.5 2448.39,-14389 2438.39,-14385.5 2438.39,-14392.5"/>
</g>
<!-- layer42_moe_comm_to_expert4&#45;&gt;layer42_moe_expert4 -->
<g id="edge2629" class="edge">
<title>layer42_moe_comm_to_expert4&#45;&gt;layer42_moe_expert4</title>
<path fill="none" stroke="black" d="M2634.75,-14542.65C2634.75,-14532.68 2634.75,-14524 2634.75,-14524 2634.75,-14524 2346.16,-14524 2346.16,-14524 2346.16,-14524 2346.16,-14516.97 2346.16,-14516.97"/>
<polygon fill="black" stroke="black" points="2349.66,-14516.97 2346.16,-14506.97 2342.66,-14516.97 2349.66,-14516.97"/>
</g>
<!-- layer42_moe_expert5 -->
<g id="node2049" class="node">
<title>layer42_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2724,-14506.9 2396,-14506.9 2396,-14454.9 2724,-14454.9 2724,-14506.9"/>
<text text-anchor="middle" x="2560" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 5 L42</text>
<text text-anchor="middle" x="2560" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2560" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2560" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert5 -->
<g id="node2077" class="node">
<title>layer42_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2766" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2766" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2766" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2766" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer42_moe_expert5&#45;&gt;layer42_moe_comm_from_expert5 -->
<g id="edge2662" class="edge">
<title>layer42_moe_expert5&#45;&gt;layer42_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2699.75,-14454.58C2699.75,-14454.58 2699.75,-14419.81 2699.75,-14419.81"/>
<polygon fill="black" stroke="black" points="2703.25,-14419.81 2699.75,-14409.81 2696.25,-14419.81 2703.25,-14419.81"/>
</g>
<!-- layer42_moe_comm_to_expert5&#45;&gt;layer42_moe_expert5 -->
<g id="edge2631" class="edge">
<title>layer42_moe_comm_to_expert5&#45;&gt;layer42_moe_expert5</title>
<path fill="none" stroke="black" d="M2776.26,-14571C2752.92,-14571 2734.25,-14571 2734.25,-14571 2734.25,-14571 2734.25,-14480 2734.25,-14480 2734.25,-14480 2733.24,-14480 2733.24,-14480"/>
<polygon fill="black" stroke="black" points="2734.13,-14476.5 2724.13,-14480 2734.13,-14483.5 2734.13,-14476.5"/>
</g>
<!-- layer42_moe_expert6 -->
<g id="node2051" class="node">
<title>layer42_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3070,-14506.9 2742,-14506.9 2742,-14454.9 3070,-14454.9 3070,-14506.9"/>
<text text-anchor="middle" x="2906" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 6 L42</text>
<text text-anchor="middle" x="2906" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2906" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2906" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert6 -->
<g id="node2078" class="node">
<title>layer42_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2979" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2979" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2979" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2979" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer42_moe_expert6&#45;&gt;layer42_moe_comm_from_expert6 -->
<g id="edge2664" class="edge">
<title>layer42_moe_expert6&#45;&gt;layer42_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2979,-14454.58C2979,-14454.58 2979,-14429.04 2979,-14429.04"/>
<polygon fill="black" stroke="black" points="2982.5,-14429.04 2979,-14419.04 2975.5,-14429.04 2982.5,-14429.04"/>
</g>
<!-- layer42_moe_comm_to_expert6&#45;&gt;layer42_moe_expert6 -->
<g id="edge2633" class="edge">
<title>layer42_moe_comm_to_expert6&#45;&gt;layer42_moe_expert6</title>
<path fill="none" stroke="black" d="M3030.75,-14547.99C3030.75,-14547.99 3030.75,-14517.21 3030.75,-14517.21"/>
<polygon fill="black" stroke="black" points="3034.25,-14517.21 3030.75,-14507.21 3027.25,-14517.21 3034.25,-14517.21"/>
</g>
<!-- layer42_moe_expert7 -->
<g id="node2053" class="node">
<title>layer42_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3416,-14506.9 3088,-14506.9 3088,-14454.9 3416,-14454.9 3416,-14506.9"/>
<text text-anchor="middle" x="3252" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 7 L42</text>
<text text-anchor="middle" x="3252" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3252" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3252" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert7 -->
<g id="node2079" class="node">
<title>layer42_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3289" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3289" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3289" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3289" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer42_moe_expert7&#45;&gt;layer42_moe_comm_from_expert7 -->
<g id="edge2666" class="edge">
<title>layer42_moe_expert7&#45;&gt;layer42_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3289,-14454.58C3289,-14454.58 3289,-14429.04 3289,-14429.04"/>
<polygon fill="black" stroke="black" points="3292.5,-14429.04 3289,-14419.04 3285.5,-14429.04 3292.5,-14429.04"/>
</g>
<!-- layer42_moe_comm_to_expert7&#45;&gt;layer42_moe_expert7 -->
<g id="edge2635" class="edge">
<title>layer42_moe_comm_to_expert7&#45;&gt;layer42_moe_expert7</title>
<path fill="none" stroke="black" d="M3289,-14542.85C3289,-14542.85 3289,-14517.2 3289,-14517.2"/>
<polygon fill="black" stroke="black" points="3292.5,-14517.2 3289,-14507.2 3285.5,-14517.2 3292.5,-14517.2"/>
</g>
<!-- layer42_moe_expert8 -->
<g id="node2055" class="node">
<title>layer42_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3762,-14506.9 3434,-14506.9 3434,-14454.9 3762,-14454.9 3762,-14506.9"/>
<text text-anchor="middle" x="3598" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 8 L42</text>
<text text-anchor="middle" x="3598" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3598" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3598" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert8 -->
<g id="node2080" class="node">
<title>layer42_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3561" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3561" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3561" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3561" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer42_moe_expert8&#45;&gt;layer42_moe_comm_from_expert8 -->
<g id="edge2668" class="edge">
<title>layer42_moe_expert8&#45;&gt;layer42_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3561,-14454.58C3561,-14454.58 3561,-14429.04 3561,-14429.04"/>
<polygon fill="black" stroke="black" points="3564.5,-14429.04 3561,-14419.04 3557.5,-14429.04 3564.5,-14429.04"/>
</g>
<!-- layer42_moe_comm_to_expert8&#45;&gt;layer42_moe_expert8 -->
<g id="edge2637" class="edge">
<title>layer42_moe_comm_to_expert8&#45;&gt;layer42_moe_expert8</title>
<path fill="none" stroke="black" d="M3561,-14542.85C3561,-14542.85 3561,-14517.2 3561,-14517.2"/>
<polygon fill="black" stroke="black" points="3564.5,-14517.2 3561,-14507.2 3557.5,-14517.2 3564.5,-14517.2"/>
</g>
<!-- layer42_moe_expert9 -->
<g id="node2057" class="node">
<title>layer42_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4108,-14506.9 3780,-14506.9 3780,-14454.9 4108,-14454.9 4108,-14506.9"/>
<text text-anchor="middle" x="3944" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 9 L42</text>
<text text-anchor="middle" x="3944" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3944" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3944" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert9 -->
<g id="node2081" class="node">
<title>layer42_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3870" cy="-14389.91" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3870" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3870" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3870" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer42_moe_expert9&#45;&gt;layer42_moe_comm_from_expert9 -->
<g id="edge2670" class="edge">
<title>layer42_moe_expert9&#45;&gt;layer42_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3870.25,-14454.58C3870.25,-14454.58 3870.25,-14429.04 3870.25,-14429.04"/>
<polygon fill="black" stroke="black" points="3873.75,-14429.04 3870.25,-14419.04 3866.75,-14429.04 3873.75,-14429.04"/>
</g>
<!-- layer42_moe_comm_to_expert9&#45;&gt;layer42_moe_expert9 -->
<g id="edge2639" class="edge">
<title>layer42_moe_comm_to_expert9&#45;&gt;layer42_moe_expert9</title>
<path fill="none" stroke="black" d="M3870.25,-14542.85C3870.25,-14542.85 3870.25,-14517.2 3870.25,-14517.2"/>
<polygon fill="black" stroke="black" points="3873.75,-14517.2 3870.25,-14507.2 3866.75,-14517.2 3873.75,-14517.2"/>
</g>
<!-- layer42_moe_expert10 -->
<g id="node2059" class="node">
<title>layer42_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4464,-14506.9 4126,-14506.9 4126,-14454.9 4464,-14454.9 4464,-14506.9"/>
<text text-anchor="middle" x="4295" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 10 L42</text>
<text text-anchor="middle" x="4295" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4295" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4295" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert10 -->
<g id="node2082" class="node">
<title>layer42_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4202" cy="-14389.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4202" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4202" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4202" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer42_moe_expert10&#45;&gt;layer42_moe_comm_from_expert10 -->
<g id="edge2672" class="edge">
<title>layer42_moe_expert10&#45;&gt;layer42_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4211.38,-14454.58C4211.38,-14454.58 4211.38,-14429.04 4211.38,-14429.04"/>
<polygon fill="black" stroke="black" points="4214.88,-14429.04 4211.38,-14419.04 4207.88,-14429.04 4214.88,-14429.04"/>
</g>
<!-- layer42_moe_comm_to_expert10&#45;&gt;layer42_moe_expert10 -->
<g id="edge2641" class="edge">
<title>layer42_moe_comm_to_expert10&#45;&gt;layer42_moe_expert10</title>
<path fill="none" stroke="black" d="M4211.02,-14542.85C4211.02,-14542.85 4211.02,-14517.2 4211.02,-14517.2"/>
<polygon fill="black" stroke="black" points="4214.52,-14517.2 4211.02,-14507.2 4207.52,-14517.2 4214.52,-14517.2"/>
</g>
<!-- layer42_moe_expert11 -->
<g id="node2061" class="node">
<title>layer42_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4820,-14506.9 4482,-14506.9 4482,-14454.9 4820,-14454.9 4820,-14506.9"/>
<text text-anchor="middle" x="4651" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 11 L42</text>
<text text-anchor="middle" x="4651" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4651" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4651" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert11 -->
<g id="node2083" class="node">
<title>layer42_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4549" cy="-14389.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4549" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4549" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4549" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer42_moe_expert11&#45;&gt;layer42_moe_comm_from_expert11 -->
<g id="edge2674" class="edge">
<title>layer42_moe_expert11&#45;&gt;layer42_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4562.88,-14454.58C4562.88,-14454.58 4562.88,-14428.72 4562.88,-14428.72"/>
<polygon fill="black" stroke="black" points="4566.38,-14428.72 4562.88,-14418.72 4559.38,-14428.72 4566.38,-14428.72"/>
</g>
<!-- layer42_moe_comm_to_expert11&#45;&gt;layer42_moe_expert11 -->
<g id="edge2643" class="edge">
<title>layer42_moe_comm_to_expert11&#45;&gt;layer42_moe_expert11</title>
<path fill="none" stroke="black" d="M4562.02,-14543.1C4562.02,-14543.1 4562.02,-14517.04 4562.02,-14517.04"/>
<polygon fill="black" stroke="black" points="4565.52,-14517.04 4562.02,-14507.04 4558.52,-14517.04 4565.52,-14517.04"/>
</g>
<!-- layer42_moe_expert12 -->
<g id="node2063" class="node">
<title>layer42_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5176,-14506.9 4838,-14506.9 4838,-14454.9 5176,-14454.9 5176,-14506.9"/>
<text text-anchor="middle" x="5007" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 12 L42</text>
<text text-anchor="middle" x="5007" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5007" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="5007" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert12 -->
<g id="node2084" class="node">
<title>layer42_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4900" cy="-14389.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4900" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4900" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4900" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer42_moe_expert12&#45;&gt;layer42_moe_comm_from_expert12 -->
<g id="edge2676" class="edge">
<title>layer42_moe_expert12&#45;&gt;layer42_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4916.38,-14454.58C4916.38,-14454.58 4916.38,-14428.72 4916.38,-14428.72"/>
<polygon fill="black" stroke="black" points="4919.88,-14428.72 4916.38,-14418.72 4912.88,-14428.72 4919.88,-14428.72"/>
</g>
<!-- layer42_moe_comm_to_expert12&#45;&gt;layer42_moe_expert12 -->
<g id="edge2645" class="edge">
<title>layer42_moe_comm_to_expert12&#45;&gt;layer42_moe_expert12</title>
<path fill="none" stroke="black" d="M4915.52,-14543.1C4915.52,-14543.1 4915.52,-14517.04 4915.52,-14517.04"/>
<polygon fill="black" stroke="black" points="4919.02,-14517.04 4915.52,-14507.04 4912.02,-14517.04 4919.02,-14517.04"/>
</g>
<!-- layer42_moe_expert13 -->
<g id="node2065" class="node">
<title>layer42_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5532,-14506.9 5194,-14506.9 5194,-14454.9 5532,-14454.9 5532,-14506.9"/>
<text text-anchor="middle" x="5363" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 13 L42</text>
<text text-anchor="middle" x="5363" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5363" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5363" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert13 -->
<g id="node2085" class="node">
<title>layer42_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5254" cy="-14389.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5254" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5254" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5254" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer42_moe_expert13&#45;&gt;layer42_moe_comm_from_expert13 -->
<g id="edge2678" class="edge">
<title>layer42_moe_expert13&#45;&gt;layer42_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5271.38,-14454.58C5271.38,-14454.58 5271.38,-14428.72 5271.38,-14428.72"/>
<polygon fill="black" stroke="black" points="5274.88,-14428.72 5271.38,-14418.72 5267.88,-14428.72 5274.88,-14428.72"/>
</g>
<!-- layer42_moe_comm_to_expert13&#45;&gt;layer42_moe_expert13 -->
<g id="edge2647" class="edge">
<title>layer42_moe_comm_to_expert13&#45;&gt;layer42_moe_expert13</title>
<path fill="none" stroke="black" d="M5270.02,-14543.1C5270.02,-14543.1 5270.02,-14517.04 5270.02,-14517.04"/>
<polygon fill="black" stroke="black" points="5273.52,-14517.04 5270.02,-14507.04 5266.52,-14517.04 5273.52,-14517.04"/>
</g>
<!-- layer42_moe_expert14 -->
<g id="node2067" class="node">
<title>layer42_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5888,-14506.9 5550,-14506.9 5550,-14454.9 5888,-14454.9 5888,-14506.9"/>
<text text-anchor="middle" x="5719" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 14 L42</text>
<text text-anchor="middle" x="5719" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5719" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5719" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert14 -->
<g id="node2086" class="node">
<title>layer42_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5609" cy="-14389.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5609" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5609" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5609" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer42_moe_expert14&#45;&gt;layer42_moe_comm_from_expert14 -->
<g id="edge2680" class="edge">
<title>layer42_moe_expert14&#45;&gt;layer42_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5626.88,-14454.58C5626.88,-14454.58 5626.88,-14428.4 5626.88,-14428.4"/>
<polygon fill="black" stroke="black" points="5630.38,-14428.4 5626.88,-14418.4 5623.38,-14428.4 5630.38,-14428.4"/>
</g>
<!-- layer42_moe_comm_to_expert14&#45;&gt;layer42_moe_expert14 -->
<g id="edge2649" class="edge">
<title>layer42_moe_comm_to_expert14&#45;&gt;layer42_moe_expert14</title>
<path fill="none" stroke="black" d="M5625.52,-14543.1C5625.52,-14543.1 5625.52,-14517.04 5625.52,-14517.04"/>
<polygon fill="black" stroke="black" points="5629.02,-14517.04 5625.52,-14507.04 5622.02,-14517.04 5629.02,-14517.04"/>
</g>
<!-- layer42_moe_expert15 -->
<g id="node2069" class="node">
<title>layer42_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6244,-14506.9 5906,-14506.9 5906,-14454.9 6244,-14454.9 6244,-14506.9"/>
<text text-anchor="middle" x="6075" y="-14494.9" font-family="Arial" font-size="10.00">EXPERT 15 L42</text>
<text text-anchor="middle" x="6075" y="-14483.9" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6075" y="-14472.9" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6075" y="-14461.9" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_comm_from_expert15 -->
<g id="node2087" class="node">
<title>layer42_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5964" cy="-14389.91" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5964" y="-14398.41" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5964" y="-14387.41" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5964" y="-14376.41" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer42_moe_expert15&#45;&gt;layer42_moe_comm_from_expert15 -->
<g id="edge2682" class="edge">
<title>layer42_moe_expert15&#45;&gt;layer42_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5982.38,-14454.58C5982.38,-14454.58 5982.38,-14428.4 5982.38,-14428.4"/>
<polygon fill="black" stroke="black" points="5985.88,-14428.4 5982.38,-14418.4 5978.88,-14428.4 5985.88,-14428.4"/>
</g>
<!-- layer42_moe_comm_to_expert15&#45;&gt;layer42_moe_expert15 -->
<g id="edge2651" class="edge">
<title>layer42_moe_comm_to_expert15&#45;&gt;layer42_moe_expert15</title>
<path fill="none" stroke="black" d="M5981.02,-14543.1C5981.02,-14543.1 5981.02,-14517.04 5981.02,-14517.04"/>
<polygon fill="black" stroke="black" points="5984.52,-14517.04 5981.02,-14507.04 5977.52,-14517.04 5984.52,-14517.04"/>
</g>
<!-- layer42_moe_aggregate -->
<g id="node2071" class="node">
<title>layer42_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3650.1,-14324.92 3233.16,-14324.92 3125.9,-14220.92 3542.84,-14220.92 3650.1,-14324.92"/>
<text text-anchor="middle" x="3388" y="-14286.92" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L42</text>
<text text-anchor="middle" x="3388" y="-14275.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3388" y="-14264.92" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3388" y="-14253.92" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_mha -->
<g id="node2088" class="node">
<title>layer43_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3518,-14184.92 3258,-14184.92 3258,-14132.92 3518,-14132.92 3518,-14184.92"/>
<text text-anchor="middle" x="3388" y="-14172.92" font-family="Arial" font-size="10.00">MHA L43</text>
<text text-anchor="middle" x="3388" y="-14161.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3388" y="-14150.92" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3388" y="-14139.92" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer42_moe_aggregate&#45;&gt;layer43_moe_mha -->
<g id="edge2751" class="edge">
<title>layer42_moe_aggregate&#45;&gt;layer43_moe_mha</title>
<path fill="none" stroke="black" d="M3388,-14220.59C3388,-14220.59 3388,-14195.15 3388,-14195.15"/>
<polygon fill="black" stroke="black" points="3391.5,-14195.15 3388,-14185.15 3384.5,-14195.15 3391.5,-14195.15"/>
</g>
<!-- layer42_moe_comm_from_expert0&#45;&gt;layer42_moe_aggregate -->
<g id="edge2653" class="edge">
<title>layer42_moe_comm_from_expert0&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M991.25,-14373.12C991.25,-14332.64 991.25,-14233 991.25,-14233 991.25,-14233 3128.29,-14233 3128.29,-14233"/>
<polygon fill="black" stroke="black" points="3128.29,-14236.5 3138.29,-14233 3128.29,-14229.5 3128.29,-14236.5"/>
</g>
<!-- layer42_moe_comm_from_expert1&#45;&gt;layer42_moe_aggregate -->
<g id="edge2655" class="edge">
<title>layer42_moe_comm_from_expert1&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M1622.84,-14369.9C1622.84,-14330.36 1622.84,-14246 1622.84,-14246 1622.84,-14246 3141.32,-14246 3141.32,-14246"/>
<polygon fill="black" stroke="black" points="3141.32,-14249.5 3151.32,-14246 3141.32,-14242.5 3141.32,-14249.5"/>
</g>
<!-- layer42_moe_comm_from_expert2&#45;&gt;layer42_moe_aggregate -->
<g id="edge2657" class="edge">
<title>layer42_moe_comm_from_expert2&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M2048.01,-14372.25C2048.01,-14336.52 2048.01,-14259 2048.01,-14259 2048.01,-14259 3154.85,-14259 3154.85,-14259"/>
<polygon fill="black" stroke="black" points="3154.85,-14262.5 3164.85,-14259 3154.85,-14255.5 3154.85,-14262.5"/>
</g>
<!-- layer42_moe_comm_from_expert3&#45;&gt;layer42_moe_aggregate -->
<g id="edge2659" class="edge">
<title>layer42_moe_comm_from_expert3&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M2367.25,-14377.74C2367.25,-14347.61 2367.25,-14272 2367.25,-14272 2367.25,-14272 3168.36,-14272 3168.36,-14272"/>
<polygon fill="black" stroke="black" points="3168.36,-14275.5 3178.36,-14272 3168.36,-14268.5 3168.36,-14275.5"/>
</g>
<!-- layer42_moe_comm_from_expert4&#45;&gt;layer42_moe_aggregate -->
<g id="edge2661" class="edge">
<title>layer42_moe_comm_from_expert4&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M2611.01,-14372.11C2611.01,-14342.18 2611.01,-14285 2611.01,-14285 2611.01,-14285 3181.93,-14285 3181.93,-14285"/>
<polygon fill="black" stroke="black" points="3181.93,-14288.5 3191.93,-14285 3181.93,-14281.5 3181.93,-14288.5"/>
</g>
<!-- layer42_moe_comm_from_expert5&#45;&gt;layer42_moe_aggregate -->
<g id="edge2663" class="edge">
<title>layer42_moe_comm_from_expert5&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M2835.5,-14371.31C2835.5,-14344.45 2835.5,-14298 2835.5,-14298 2835.5,-14298 3195.18,-14298 3195.18,-14298"/>
<polygon fill="black" stroke="black" points="3195.18,-14301.5 3205.18,-14298 3195.18,-14294.5 3195.18,-14301.5"/>
</g>
<!-- layer42_moe_comm_from_expert6&#45;&gt;layer42_moe_aggregate -->
<g id="edge2665" class="edge">
<title>layer42_moe_comm_from_expert6&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M3060.25,-14376.88C3060.25,-14354.47 3060.25,-14311 3060.25,-14311 3060.25,-14311 3208.37,-14311 3208.37,-14311"/>
<polygon fill="black" stroke="black" points="3208.37,-14314.5 3218.37,-14311 3208.37,-14307.5 3208.37,-14314.5"/>
</g>
<!-- layer42_moe_comm_from_expert7&#45;&gt;layer42_moe_aggregate -->
<g id="edge2667" class="edge">
<title>layer42_moe_comm_from_expert7&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M3289,-14360.69C3289,-14360.69 3289,-14334.98 3289,-14334.98"/>
<polygon fill="black" stroke="black" points="3292.5,-14334.98 3289,-14324.98 3285.5,-14334.98 3292.5,-14334.98"/>
</g>
<!-- layer42_moe_comm_from_expert8&#45;&gt;layer42_moe_aggregate -->
<g id="edge2669" class="edge">
<title>layer42_moe_comm_from_expert8&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M3560.39,-14360.69C3560.39,-14360.69 3560.39,-14334.98 3560.39,-14334.98"/>
<polygon fill="black" stroke="black" points="3563.89,-14334.98 3560.39,-14324.98 3556.89,-14334.98 3563.89,-14334.98"/>
</g>
<!-- layer42_moe_comm_from_expert9&#45;&gt;layer42_moe_aggregate -->
<g id="edge2671" class="edge">
<title>layer42_moe_comm_from_expert9&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M3851.5,-14361.42C3851.5,-14338.82 3851.5,-14311 3851.5,-14311 3851.5,-14311 3646.03,-14311 3646.03,-14311"/>
<polygon fill="black" stroke="black" points="3646.03,-14307.5 3636.03,-14311 3646.03,-14314.5 3646.03,-14307.5"/>
</g>
<!-- layer42_moe_comm_from_expert10&#45;&gt;layer42_moe_aggregate -->
<g id="edge2673" class="edge">
<title>layer42_moe_comm_from_expert10&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M4183.15,-14361.33C4183.15,-14334.35 4183.15,-14298 4183.15,-14298 4183.15,-14298 3632.54,-14298 3632.54,-14298"/>
<polygon fill="black" stroke="black" points="3632.54,-14294.5 3622.54,-14298 3632.54,-14301.5 3632.54,-14294.5"/>
</g>
<!-- layer42_moe_comm_from_expert11&#45;&gt;layer42_moe_aggregate -->
<g id="edge2675" class="edge">
<title>layer42_moe_comm_from_expert11&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M4529.65,-14361.52C4529.65,-14330.45 4529.65,-14285 4529.65,-14285 4529.65,-14285 3619.14,-14285 3619.14,-14285"/>
<polygon fill="black" stroke="black" points="3619.14,-14281.5 3609.14,-14285 3619.14,-14288.5 3619.14,-14281.5"/>
</g>
<!-- layer42_moe_comm_from_expert12&#45;&gt;layer42_moe_aggregate -->
<g id="edge2677" class="edge">
<title>layer42_moe_comm_from_expert12&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M4880.65,-14361.37C4880.65,-14326.47 4880.65,-14272 4880.65,-14272 4880.65,-14272 3605.55,-14272 3605.55,-14272"/>
<polygon fill="black" stroke="black" points="3605.55,-14268.5 3595.55,-14272 3605.55,-14275.5 3605.55,-14268.5"/>
</g>
<!-- layer42_moe_comm_from_expert13&#45;&gt;layer42_moe_aggregate -->
<g id="edge2679" class="edge">
<title>layer42_moe_comm_from_expert13&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M5234.15,-14361.5C5234.15,-14323 5234.15,-14259 5234.15,-14259 5234.15,-14259 3592.52,-14259 3592.52,-14259"/>
<polygon fill="black" stroke="black" points="3592.52,-14255.5 3582.52,-14259 3592.52,-14262.5 3592.52,-14255.5"/>
</g>
<!-- layer42_moe_comm_from_expert14&#45;&gt;layer42_moe_aggregate -->
<g id="edge2681" class="edge">
<title>layer42_moe_comm_from_expert14&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M5589.15,-14361.48C5589.15,-14319.54 5589.15,-14246 5589.15,-14246 5589.15,-14246 3579.06,-14246 3579.06,-14246"/>
<polygon fill="black" stroke="black" points="3579.06,-14242.5 3569.06,-14246 3579.06,-14249.5 3579.06,-14242.5"/>
</g>
<!-- layer42_moe_comm_from_expert15&#45;&gt;layer42_moe_aggregate -->
<g id="edge2683" class="edge">
<title>layer42_moe_comm_from_expert15&#45;&gt;layer42_moe_aggregate</title>
<path fill="none" stroke="black" d="M5944.15,-14361.49C5944.15,-14316.28 5944.15,-14233 5944.15,-14233 5944.15,-14233 3565.72,-14233 3565.72,-14233"/>
<polygon fill="black" stroke="black" points="3565.72,-14229.5 3555.72,-14233 3565.72,-14236.5 3565.72,-14229.5"/>
</g>
<!-- layer43_moe_gate -->
<g id="node2089" class="node">
<title>layer43_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3646.3,-14096.92 3235.4,-14096.92 3129.7,-13992.92 3540.6,-13992.92 3646.3,-14096.92"/>
<text text-anchor="middle" x="3388" y="-14058.92" font-family="Arial" font-size="10.00">GATE L43</text>
<text text-anchor="middle" x="3388" y="-14047.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3388" y="-14036.92" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3388" y="-14025.92" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer43_moe_mha&#45;&gt;layer43_moe_gate -->
<g id="edge2752" class="edge">
<title>layer43_moe_mha&#45;&gt;layer43_moe_gate</title>
<path fill="none" stroke="black" d="M3388,-14132.76C3388,-14132.76 3388,-14107.02 3388,-14107.02"/>
<polygon fill="black" stroke="black" points="3391.5,-14107.02 3388,-14097.02 3384.5,-14107.02 3391.5,-14107.02"/>
</g>
<!-- layer43_moe_split -->
<g id="node2090" class="node">
<title>layer43_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3642.01,-13956.92 3237.94,-13956.92 3133.99,-13852.92 3538.06,-13852.92 3642.01,-13956.92"/>
<text text-anchor="middle" x="3388" y="-13918.92" font-family="Arial" font-size="10.00">SPLIT TOKENS L43</text>
<text text-anchor="middle" x="3388" y="-13907.92" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3388" y="-13896.92" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3388" y="-13885.92" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer43_moe_gate&#45;&gt;layer43_moe_split -->
<g id="edge2753" class="edge">
<title>layer43_moe_gate&#45;&gt;layer43_moe_split</title>
<path fill="none" stroke="black" d="M3388,-13992.79C3388,-13992.79 3388,-13967.09 3388,-13967.09"/>
<polygon fill="black" stroke="black" points="3391.5,-13967.09 3388,-13957.09 3384.5,-13967.09 3391.5,-13967.09"/>
</g>
<!-- layer43_moe_comm_to_expert0 -->
<g id="node2092" class="node">
<title>layer43_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="880" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="880" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="880" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="880" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert0 -->
<g id="edge2687" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3222.73,-13942C2666.71,-13942 898.5,-13942 898.5,-13942 898.5,-13942 898.5,-13826.55 898.5,-13826.55"/>
<polygon fill="black" stroke="black" points="902,-13826.55 898.5,-13816.55 895,-13826.55 902,-13826.55"/>
</g>
<!-- layer43_moe_comm_to_expert1 -->
<g id="node2094" class="node">
<title>layer43_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1520" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1520" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1520" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1520" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert1 -->
<g id="edge2689" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3207.72,-13927C2742.64,-13927 1538.5,-13927 1538.5,-13927 1538.5,-13927 1538.5,-13826.41 1538.5,-13826.41"/>
<polygon fill="black" stroke="black" points="1542,-13826.41 1538.5,-13816.41 1535,-13826.41 1542,-13826.41"/>
</g>
<!-- layer43_moe_comm_to_expert2 -->
<g id="node2096" class="node">
<title>layer43_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1939" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1939" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1939" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1939" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert2 -->
<g id="edge2691" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3192.84,-13912C2801.39,-13912 1957.5,-13912 1957.5,-13912 1957.5,-13912 1957.5,-13826.39 1957.5,-13826.39"/>
<polygon fill="black" stroke="black" points="1961,-13826.39 1957.5,-13816.39 1954,-13826.39 1961,-13826.39"/>
</g>
<!-- layer43_moe_comm_to_expert3 -->
<g id="node2098" class="node">
<title>layer43_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2248" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2248" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2248" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2248" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert3 -->
<g id="edge2693" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3178.04,-13897C2853.37,-13897 2266.5,-13897 2266.5,-13897 2266.5,-13897 2266.5,-13826.58 2266.5,-13826.58"/>
<polygon fill="black" stroke="black" points="2270,-13826.58 2266.5,-13816.58 2263,-13826.58 2270,-13826.58"/>
</g>
<!-- layer43_moe_comm_to_expert4 -->
<g id="node2100" class="node">
<title>layer43_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2502" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2502" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2502" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2502" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert4 -->
<g id="edge2695" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3162.9,-13882C2905.87,-13882 2520.5,-13882 2520.5,-13882 2520.5,-13882 2520.5,-13826.41 2520.5,-13826.41"/>
<polygon fill="black" stroke="black" points="2524,-13826.41 2520.5,-13816.41 2517,-13826.41 2524,-13826.41"/>
</g>
<!-- layer43_moe_comm_to_expert5 -->
<g id="node2102" class="node">
<title>layer43_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2729" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2729" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2729" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2729" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert5 -->
<g id="edge2697" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3147.68,-13867C2965.93,-13867 2747.5,-13867 2747.5,-13867 2747.5,-13867 2747.5,-13826.47 2747.5,-13826.47"/>
<polygon fill="black" stroke="black" points="2751,-13826.47 2747.5,-13816.47 2744,-13826.47 2751,-13826.47"/>
</g>
<!-- layer43_moe_comm_to_expert6 -->
<g id="node2104" class="node">
<title>layer43_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2942" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2942" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2942" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2942" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert6 -->
<g id="edge2699" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3147.74,-13904.83C3147.74,-13901.26 3147.74,-13787 3147.74,-13787 3147.74,-13787 3042.54,-13787 3042.54,-13787"/>
<polygon fill="black" stroke="black" points="3042.54,-13783.5 3032.54,-13787 3042.54,-13790.5 3042.54,-13783.5"/>
</g>
<!-- layer43_moe_comm_to_expert7 -->
<g id="node2106" class="node">
<title>layer43_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3252" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3252" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3252" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3252" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert7 -->
<g id="edge2701" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3252,-13852.58C3252,-13852.58 3252,-13827.14 3252,-13827.14"/>
<polygon fill="black" stroke="black" points="3255.5,-13827.14 3252,-13817.14 3248.5,-13827.14 3255.5,-13827.14"/>
</g>
<!-- layer43_moe_comm_to_expert8 -->
<g id="node2108" class="node">
<title>layer43_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3524" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3524" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3524" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3524" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert8 -->
<g id="edge2703" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3524,-13852.58C3524,-13852.58 3524,-13827.14 3524,-13827.14"/>
<polygon fill="black" stroke="black" points="3527.5,-13827.14 3524,-13817.14 3520.5,-13827.14 3527.5,-13827.14"/>
</g>
<!-- layer43_moe_comm_to_expert9 -->
<g id="node2110" class="node">
<title>layer43_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3833" cy="-13787.93" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3833" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3833" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3833" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert9 -->
<g id="edge2705" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3628.26,-13904.83C3628.26,-13901.26 3628.26,-13787 3628.26,-13787 3628.26,-13787 3732.3,-13787 3732.3,-13787"/>
<polygon fill="black" stroke="black" points="3732.3,-13790.5 3742.3,-13787 3732.3,-13783.5 3732.3,-13790.5"/>
</g>
<!-- layer43_moe_comm_to_expert10 -->
<g id="node2112" class="node">
<title>layer43_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4165" cy="-13787.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4165" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4165" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4165" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert10 -->
<g id="edge2707" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3552.38,-13867C3759.6,-13867 4089.1,-13867 4089.1,-13867 4089.1,-13867 4089.1,-13815.08 4089.1,-13815.08"/>
<polygon fill="black" stroke="black" points="4092.6,-13815.08 4089.1,-13805.08 4085.6,-13815.08 4092.6,-13815.08"/>
</g>
<!-- layer43_moe_comm_to_expert11 -->
<g id="node2114" class="node">
<title>layer43_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4511" cy="-13787.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4511" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4511" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4511" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert11 -->
<g id="edge2709" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3567.2,-13882C3866.48,-13882 4435.6,-13882 4435.6,-13882 4435.6,-13882 4435.6,-13815.62 4435.6,-13815.62"/>
<polygon fill="black" stroke="black" points="4439.1,-13815.62 4435.6,-13805.62 4432.1,-13815.62 4439.1,-13815.62"/>
</g>
<!-- layer43_moe_comm_to_expert12 -->
<g id="node2116" class="node">
<title>layer43_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4862" cy="-13787.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4862" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4862" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4862" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert12 -->
<g id="edge2711" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3582.47,-13897C3966.77,-13897 4786.6,-13897 4786.6,-13897 4786.6,-13897 4786.6,-13815.45 4786.6,-13815.45"/>
<polygon fill="black" stroke="black" points="4790.1,-13815.45 4786.6,-13805.45 4783.1,-13815.45 4790.1,-13815.45"/>
</g>
<!-- layer43_moe_comm_to_expert13 -->
<g id="node2118" class="node">
<title>layer43_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5215" cy="-13787.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5215" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5215" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5215" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert13 -->
<g id="edge2713" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3597.17,-13912C4062,-13912 5140.1,-13912 5140.1,-13912 5140.1,-13912 5140.1,-13815.7 5140.1,-13815.7"/>
<polygon fill="black" stroke="black" points="5143.6,-13815.7 5140.1,-13805.7 5136.6,-13815.7 5143.6,-13815.7"/>
</g>
<!-- layer43_moe_comm_to_expert14 -->
<g id="node2120" class="node">
<title>layer43_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5570" cy="-13787.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5570" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5570" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5570" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert14 -->
<g id="edge2715" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3612.5,-13927C4155.43,-13927 5495.1,-13927 5495.1,-13927 5495.1,-13927 5495.1,-13815.54 5495.1,-13815.54"/>
<polygon fill="black" stroke="black" points="5498.6,-13815.54 5495.1,-13805.54 5491.6,-13815.54 5498.6,-13815.54"/>
</g>
<!-- layer43_moe_comm_to_expert15 -->
<g id="node2122" class="node">
<title>layer43_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5925" cy="-13787.93" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5925" y="-13796.43" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5925" y="-13785.43" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5925" y="-13774.43" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert15 -->
<g id="edge2717" class="edge">
<title>layer43_moe_split&#45;&gt;layer43_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3627.15,-13942C4245.66,-13942 5850.1,-13942 5850.1,-13942 5850.1,-13942 5850.1,-13815.6 5850.1,-13815.6"/>
<polygon fill="black" stroke="black" points="5853.6,-13815.6 5850.1,-13805.6 5846.6,-13815.6 5853.6,-13815.6"/>
</g>
<!-- layer43_moe_expert0 -->
<g id="node2091" class="node">
<title>layer43_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="957,-13722.94 629,-13722.94 629,-13670.94 957,-13670.94 957,-13722.94"/>
<text text-anchor="middle" x="793" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 0 L43</text>
<text text-anchor="middle" x="793" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="793" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="793" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert0 -->
<g id="node2124" class="node">
<title>layer43_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1307" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1307" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1307" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1307" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer43_moe_expert0&#45;&gt;layer43_moe_comm_from_expert0 -->
<g id="edge2719" class="edge">
<title>layer43_moe_expert0&#45;&gt;layer43_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M947.5,-13670.84C947.5,-13643.66 947.5,-13605 947.5,-13605 947.5,-13605 1206.28,-13605 1206.28,-13605"/>
<polygon fill="black" stroke="black" points="1206.28,-13608.5 1216.28,-13605 1206.28,-13601.5 1206.28,-13608.5"/>
</g>
<!-- layer43_moe_comm_to_expert0&#45;&gt;layer43_moe_expert0 -->
<g id="edge2688" class="edge">
<title>layer43_moe_comm_to_expert0&#45;&gt;layer43_moe_expert0</title>
<path fill="none" stroke="black" d="M873.25,-13758.89C873.25,-13758.89 873.25,-13733.24 873.25,-13733.24"/>
<polygon fill="black" stroke="black" points="876.75,-13733.24 873.25,-13723.24 869.75,-13733.24 876.75,-13733.24"/>
</g>
<!-- layer43_moe_expert1 -->
<g id="node2093" class="node">
<title>layer43_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1303,-13722.94 975,-13722.94 975,-13670.94 1303,-13670.94 1303,-13722.94"/>
<text text-anchor="middle" x="1139" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 1 L43</text>
<text text-anchor="middle" x="1139" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1139" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1139" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert1 -->
<g id="node2125" class="node">
<title>layer43_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1552" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1552" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1552" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1552" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer43_moe_expert1&#45;&gt;layer43_moe_comm_from_expert1 -->
<g id="edge2721" class="edge">
<title>layer43_moe_expert1&#45;&gt;layer43_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1259.75,-13670.92C1259.75,-13657.12 1259.75,-13643 1259.75,-13643 1259.75,-13643 1552,-13643 1552,-13643 1552,-13643 1552,-13642.21 1552,-13642.21"/>
<polygon fill="black" stroke="black" points="1555.5,-13645.14 1552,-13635.14 1548.5,-13645.14 1555.5,-13645.14"/>
</g>
<!-- layer43_moe_comm_to_expert1&#45;&gt;layer43_moe_expert1 -->
<g id="edge2690" class="edge">
<title>layer43_moe_comm_to_expert1&#45;&gt;layer43_moe_expert1</title>
<path fill="none" stroke="black" d="M1429.46,-13787C1322.09,-13787 1157.5,-13787 1157.5,-13787 1157.5,-13787 1157.5,-13732.99 1157.5,-13732.99"/>
<polygon fill="black" stroke="black" points="1161,-13732.99 1157.5,-13722.99 1154,-13732.99 1161,-13732.99"/>
</g>
<!-- layer43_moe_expert2 -->
<g id="node2095" class="node">
<title>layer43_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1649,-13722.94 1321,-13722.94 1321,-13670.94 1649,-13670.94 1649,-13722.94"/>
<text text-anchor="middle" x="1485" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 2 L43</text>
<text text-anchor="middle" x="1485" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1485" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1485" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert2 -->
<g id="node2126" class="node">
<title>layer43_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="2008" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2008" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="2008" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2008" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer43_moe_expert2&#45;&gt;layer43_moe_comm_from_expert2 -->
<g id="edge2723" class="edge">
<title>layer43_moe_expert2&#45;&gt;layer43_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1649.18,-13696C1654.77,-13696 1658,-13696 1658,-13696 1658,-13696 1658,-13605 1658,-13605 1658,-13605 1907.41,-13605 1907.41,-13605"/>
<polygon fill="black" stroke="black" points="1907.41,-13608.5 1917.41,-13605 1907.41,-13601.5 1907.41,-13608.5"/>
</g>
<!-- layer43_moe_comm_to_expert2&#45;&gt;layer43_moe_expert2 -->
<g id="edge2692" class="edge">
<title>layer43_moe_comm_to_expert2&#45;&gt;layer43_moe_expert2</title>
<path fill="none" stroke="black" d="M1848.25,-13787C1758.73,-13787 1635.18,-13787 1635.18,-13787 1635.18,-13787 1635.18,-13732.99 1635.18,-13732.99"/>
<polygon fill="black" stroke="black" points="1638.68,-13732.99 1635.18,-13722.99 1631.68,-13732.99 1638.68,-13732.99"/>
</g>
<!-- layer43_moe_expert3 -->
<g id="node2097" class="node">
<title>layer43_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1995,-13722.94 1667,-13722.94 1667,-13670.94 1995,-13670.94 1995,-13722.94"/>
<text text-anchor="middle" x="1831" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 3 L43</text>
<text text-anchor="middle" x="1831" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1831" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1831" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert3 -->
<g id="node2127" class="node">
<title>layer43_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2336" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2336" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2336" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2336" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer43_moe_expert3&#45;&gt;layer43_moe_comm_from_expert3 -->
<g id="edge2725" class="edge">
<title>layer43_moe_expert3&#45;&gt;layer43_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1956.25,-13670.8C1956.25,-13660.91 1956.25,-13652 1956.25,-13652 1956.25,-13652 2277.33,-13652 2277.33,-13652 2277.33,-13652 2277.33,-13638.16 2277.33,-13638.16"/>
<polygon fill="black" stroke="black" points="2280.83,-13638.16 2277.33,-13628.16 2273.83,-13638.16 2280.83,-13638.16"/>
</g>
<!-- layer43_moe_comm_to_expert3&#45;&gt;layer43_moe_expert3 -->
<g id="edge2694" class="edge">
<title>layer43_moe_comm_to_expert3&#45;&gt;layer43_moe_expert3</title>
<path fill="none" stroke="black" d="M2248,-13758.67C2248,-13748.69 2248,-13740 2248,-13740 2248,-13740 1921.75,-13740 1921.75,-13740 1921.75,-13740 1921.75,-13732.98 1921.75,-13732.98"/>
<polygon fill="black" stroke="black" points="1925.25,-13732.98 1921.75,-13722.98 1918.25,-13732.98 1925.25,-13732.98"/>
</g>
<!-- layer43_moe_expert4 -->
<g id="node2099" class="node">
<title>layer43_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2341,-13722.94 2013,-13722.94 2013,-13670.94 2341,-13670.94 2341,-13722.94"/>
<text text-anchor="middle" x="2177" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 4 L43</text>
<text text-anchor="middle" x="2177" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2177" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2177" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert4 -->
<g id="node2128" class="node">
<title>layer43_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2599" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2599" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2599" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2599" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer43_moe_expert4&#45;&gt;layer43_moe_comm_from_expert4 -->
<g id="edge2727" class="edge">
<title>layer43_moe_expert4&#45;&gt;layer43_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2309.16,-13670.82C2309.16,-13665.25 2309.16,-13661 2309.16,-13661 2309.16,-13661 2597.75,-13661 2597.75,-13661 2597.75,-13661 2597.75,-13645.08 2597.75,-13645.08"/>
<polygon fill="black" stroke="black" points="2601.25,-13645.08 2597.75,-13635.08 2594.25,-13645.08 2601.25,-13645.08"/>
</g>
<!-- layer43_moe_comm_to_expert4&#45;&gt;layer43_moe_expert4 -->
<g id="edge2696" class="edge">
<title>layer43_moe_comm_to_expert4&#45;&gt;layer43_moe_expert4</title>
<path fill="none" stroke="black" d="M2411.39,-13787C2378.83,-13787 2350,-13787 2350,-13787 2350,-13787 2350,-13696 2350,-13696 2350,-13696 2349.12,-13696 2349.12,-13696"/>
<polygon fill="black" stroke="black" points="2351.18,-13692.5 2341.18,-13696 2351.18,-13699.5 2351.18,-13692.5"/>
</g>
<!-- layer43_moe_expert5 -->
<g id="node2101" class="node">
<title>layer43_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2687,-13722.94 2359,-13722.94 2359,-13670.94 2687,-13670.94 2687,-13722.94"/>
<text text-anchor="middle" x="2523" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 5 L43</text>
<text text-anchor="middle" x="2523" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2523" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2523" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert5 -->
<g id="node2129" class="node">
<title>layer43_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2830" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2830" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2830" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2830" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer43_moe_expert5&#45;&gt;layer43_moe_comm_from_expert5 -->
<g id="edge2729" class="edge">
<title>layer43_moe_expert5&#45;&gt;layer43_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2687.18,-13696C2692.77,-13696 2696,-13696 2696,-13696 2696,-13696 2696,-13605 2696,-13605 2696,-13605 2729.51,-13605 2729.51,-13605"/>
<polygon fill="black" stroke="black" points="2729.51,-13608.5 2739.51,-13605 2729.51,-13601.5 2729.51,-13608.5"/>
</g>
<!-- layer43_moe_comm_to_expert5&#45;&gt;layer43_moe_expert5 -->
<g id="edge2698" class="edge">
<title>layer43_moe_comm_to_expert5&#45;&gt;layer43_moe_expert5</title>
<path fill="none" stroke="black" d="M2662.75,-13767.73C2662.75,-13767.73 2662.75,-13732.96 2662.75,-13732.96"/>
<polygon fill="black" stroke="black" points="2666.25,-13732.96 2662.75,-13722.96 2659.25,-13732.96 2666.25,-13732.96"/>
</g>
<!-- layer43_moe_expert6 -->
<g id="node2103" class="node">
<title>layer43_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="3033,-13722.94 2705,-13722.94 2705,-13670.94 3033,-13670.94 3033,-13722.94"/>
<text text-anchor="middle" x="2869" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 6 L43</text>
<text text-anchor="middle" x="2869" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2869" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2869" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert6 -->
<g id="node2130" class="node">
<title>layer43_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3045" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3045" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3045" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3045" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer43_moe_expert6&#45;&gt;layer43_moe_comm_from_expert6 -->
<g id="edge2731" class="edge">
<title>layer43_moe_expert6&#45;&gt;layer43_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2993.75,-13670.62C2993.75,-13670.62 2993.75,-13640.03 2993.75,-13640.03"/>
<polygon fill="black" stroke="black" points="2997.25,-13640.03 2993.75,-13630.03 2990.25,-13640.03 2997.25,-13640.03"/>
</g>
<!-- layer43_moe_comm_to_expert6&#45;&gt;layer43_moe_expert6 -->
<g id="edge2700" class="edge">
<title>layer43_moe_comm_to_expert6&#45;&gt;layer43_moe_expert6</title>
<path fill="none" stroke="black" d="M2942,-13758.89C2942,-13758.89 2942,-13733.24 2942,-13733.24"/>
<polygon fill="black" stroke="black" points="2945.5,-13733.24 2942,-13723.24 2938.5,-13733.24 2945.5,-13733.24"/>
</g>
<!-- layer43_moe_expert7 -->
<g id="node2105" class="node">
<title>layer43_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3379,-13722.94 3051,-13722.94 3051,-13670.94 3379,-13670.94 3379,-13722.94"/>
<text text-anchor="middle" x="3215" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 7 L43</text>
<text text-anchor="middle" x="3215" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3215" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3215" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert7 -->
<g id="node2131" class="node">
<title>layer43_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3252" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3252" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3252" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3252" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer43_moe_expert7&#45;&gt;layer43_moe_comm_from_expert7 -->
<g id="edge2733" class="edge">
<title>layer43_moe_expert7&#45;&gt;layer43_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3252,-13670.62C3252,-13670.62 3252,-13645.07 3252,-13645.07"/>
<polygon fill="black" stroke="black" points="3255.5,-13645.07 3252,-13635.07 3248.5,-13645.07 3255.5,-13645.07"/>
</g>
<!-- layer43_moe_comm_to_expert7&#45;&gt;layer43_moe_expert7 -->
<g id="edge2702" class="edge">
<title>layer43_moe_comm_to_expert7&#45;&gt;layer43_moe_expert7</title>
<path fill="none" stroke="black" d="M3252,-13758.89C3252,-13758.89 3252,-13733.24 3252,-13733.24"/>
<polygon fill="black" stroke="black" points="3255.5,-13733.24 3252,-13723.24 3248.5,-13733.24 3255.5,-13733.24"/>
</g>
<!-- layer43_moe_expert8 -->
<g id="node2107" class="node">
<title>layer43_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3725,-13722.94 3397,-13722.94 3397,-13670.94 3725,-13670.94 3725,-13722.94"/>
<text text-anchor="middle" x="3561" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 8 L43</text>
<text text-anchor="middle" x="3561" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3561" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3561" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert8 -->
<g id="node2132" class="node">
<title>layer43_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3524" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3524" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3524" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3524" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer43_moe_expert8&#45;&gt;layer43_moe_comm_from_expert8 -->
<g id="edge2735" class="edge">
<title>layer43_moe_expert8&#45;&gt;layer43_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3524,-13670.62C3524,-13670.62 3524,-13645.07 3524,-13645.07"/>
<polygon fill="black" stroke="black" points="3527.5,-13645.07 3524,-13635.07 3520.5,-13645.07 3527.5,-13645.07"/>
</g>
<!-- layer43_moe_comm_to_expert8&#45;&gt;layer43_moe_expert8 -->
<g id="edge2704" class="edge">
<title>layer43_moe_comm_to_expert8&#45;&gt;layer43_moe_expert8</title>
<path fill="none" stroke="black" d="M3524,-13758.89C3524,-13758.89 3524,-13733.24 3524,-13733.24"/>
<polygon fill="black" stroke="black" points="3527.5,-13733.24 3524,-13723.24 3520.5,-13733.24 3527.5,-13733.24"/>
</g>
<!-- layer43_moe_expert9 -->
<g id="node2109" class="node">
<title>layer43_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4071,-13722.94 3743,-13722.94 3743,-13670.94 4071,-13670.94 4071,-13722.94"/>
<text text-anchor="middle" x="3907" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 9 L43</text>
<text text-anchor="middle" x="3907" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3907" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3907" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert9 -->
<g id="node2133" class="node">
<title>layer43_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3833" cy="-13605.94" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3833" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3833" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3833" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer43_moe_expert9&#45;&gt;layer43_moe_comm_from_expert9 -->
<g id="edge2737" class="edge">
<title>layer43_moe_expert9&#45;&gt;layer43_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3833.25,-13670.62C3833.25,-13670.62 3833.25,-13645.07 3833.25,-13645.07"/>
<polygon fill="black" stroke="black" points="3836.75,-13645.07 3833.25,-13635.07 3829.75,-13645.07 3836.75,-13645.07"/>
</g>
<!-- layer43_moe_comm_to_expert9&#45;&gt;layer43_moe_expert9 -->
<g id="edge2706" class="edge">
<title>layer43_moe_comm_to_expert9&#45;&gt;layer43_moe_expert9</title>
<path fill="none" stroke="black" d="M3833.25,-13758.89C3833.25,-13758.89 3833.25,-13733.24 3833.25,-13733.24"/>
<polygon fill="black" stroke="black" points="3836.75,-13733.24 3833.25,-13723.24 3829.75,-13733.24 3836.75,-13733.24"/>
</g>
<!-- layer43_moe_expert10 -->
<g id="node2111" class="node">
<title>layer43_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4427,-13722.94 4089,-13722.94 4089,-13670.94 4427,-13670.94 4427,-13722.94"/>
<text text-anchor="middle" x="4258" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 10 L43</text>
<text text-anchor="middle" x="4258" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4258" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4258" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert10 -->
<g id="node2134" class="node">
<title>layer43_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4165" cy="-13605.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4165" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4165" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4165" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer43_moe_expert10&#45;&gt;layer43_moe_comm_from_expert10 -->
<g id="edge2739" class="edge">
<title>layer43_moe_expert10&#45;&gt;layer43_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4174.38,-13670.62C4174.38,-13670.62 4174.38,-13645.07 4174.38,-13645.07"/>
<polygon fill="black" stroke="black" points="4177.88,-13645.07 4174.38,-13635.07 4170.88,-13645.07 4177.88,-13645.07"/>
</g>
<!-- layer43_moe_comm_to_expert10&#45;&gt;layer43_moe_expert10 -->
<g id="edge2708" class="edge">
<title>layer43_moe_comm_to_expert10&#45;&gt;layer43_moe_expert10</title>
<path fill="none" stroke="black" d="M4174.02,-13758.89C4174.02,-13758.89 4174.02,-13733.24 4174.02,-13733.24"/>
<polygon fill="black" stroke="black" points="4177.52,-13733.24 4174.02,-13723.24 4170.52,-13733.24 4177.52,-13733.24"/>
</g>
<!-- layer43_moe_expert11 -->
<g id="node2113" class="node">
<title>layer43_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4783,-13722.94 4445,-13722.94 4445,-13670.94 4783,-13670.94 4783,-13722.94"/>
<text text-anchor="middle" x="4614" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 11 L43</text>
<text text-anchor="middle" x="4614" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4614" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4614" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert11 -->
<g id="node2135" class="node">
<title>layer43_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4512" cy="-13605.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4512" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4512" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4512" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer43_moe_expert11&#45;&gt;layer43_moe_comm_from_expert11 -->
<g id="edge2741" class="edge">
<title>layer43_moe_expert11&#45;&gt;layer43_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4525.88,-13670.62C4525.88,-13670.62 4525.88,-13644.75 4525.88,-13644.75"/>
<polygon fill="black" stroke="black" points="4529.38,-13644.75 4525.88,-13634.75 4522.38,-13644.75 4529.38,-13644.75"/>
</g>
<!-- layer43_moe_comm_to_expert11&#45;&gt;layer43_moe_expert11 -->
<g id="edge2710" class="edge">
<title>layer43_moe_comm_to_expert11&#45;&gt;layer43_moe_expert11</title>
<path fill="none" stroke="black" d="M4525.02,-13759.14C4525.02,-13759.14 4525.02,-13733.07 4525.02,-13733.07"/>
<polygon fill="black" stroke="black" points="4528.52,-13733.07 4525.02,-13723.07 4521.52,-13733.07 4528.52,-13733.07"/>
</g>
<!-- layer43_moe_expert12 -->
<g id="node2115" class="node">
<title>layer43_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5139,-13722.94 4801,-13722.94 4801,-13670.94 5139,-13670.94 5139,-13722.94"/>
<text text-anchor="middle" x="4970" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 12 L43</text>
<text text-anchor="middle" x="4970" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4970" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4970" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert12 -->
<g id="node2136" class="node">
<title>layer43_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4863" cy="-13605.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4863" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4863" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4863" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer43_moe_expert12&#45;&gt;layer43_moe_comm_from_expert12 -->
<g id="edge2743" class="edge">
<title>layer43_moe_expert12&#45;&gt;layer43_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4879.38,-13670.62C4879.38,-13670.62 4879.38,-13644.75 4879.38,-13644.75"/>
<polygon fill="black" stroke="black" points="4882.88,-13644.75 4879.38,-13634.75 4875.88,-13644.75 4882.88,-13644.75"/>
</g>
<!-- layer43_moe_comm_to_expert12&#45;&gt;layer43_moe_expert12 -->
<g id="edge2712" class="edge">
<title>layer43_moe_comm_to_expert12&#45;&gt;layer43_moe_expert12</title>
<path fill="none" stroke="black" d="M4878.52,-13759.14C4878.52,-13759.14 4878.52,-13733.07 4878.52,-13733.07"/>
<polygon fill="black" stroke="black" points="4882.02,-13733.07 4878.52,-13723.07 4875.02,-13733.07 4882.02,-13733.07"/>
</g>
<!-- layer43_moe_expert13 -->
<g id="node2117" class="node">
<title>layer43_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5495,-13722.94 5157,-13722.94 5157,-13670.94 5495,-13670.94 5495,-13722.94"/>
<text text-anchor="middle" x="5326" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 13 L43</text>
<text text-anchor="middle" x="5326" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5326" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5326" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert13 -->
<g id="node2137" class="node">
<title>layer43_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5217" cy="-13605.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5217" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5217" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5217" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer43_moe_expert13&#45;&gt;layer43_moe_comm_from_expert13 -->
<g id="edge2745" class="edge">
<title>layer43_moe_expert13&#45;&gt;layer43_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5234.38,-13670.62C5234.38,-13670.62 5234.38,-13644.75 5234.38,-13644.75"/>
<polygon fill="black" stroke="black" points="5237.88,-13644.75 5234.38,-13634.75 5230.88,-13644.75 5237.88,-13644.75"/>
</g>
<!-- layer43_moe_comm_to_expert13&#45;&gt;layer43_moe_expert13 -->
<g id="edge2714" class="edge">
<title>layer43_moe_comm_to_expert13&#45;&gt;layer43_moe_expert13</title>
<path fill="none" stroke="black" d="M5233.02,-13759.14C5233.02,-13759.14 5233.02,-13733.07 5233.02,-13733.07"/>
<polygon fill="black" stroke="black" points="5236.52,-13733.07 5233.02,-13723.07 5229.52,-13733.07 5236.52,-13733.07"/>
</g>
<!-- layer43_moe_expert14 -->
<g id="node2119" class="node">
<title>layer43_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5851,-13722.94 5513,-13722.94 5513,-13670.94 5851,-13670.94 5851,-13722.94"/>
<text text-anchor="middle" x="5682" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 14 L43</text>
<text text-anchor="middle" x="5682" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5682" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5682" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert14 -->
<g id="node2138" class="node">
<title>layer43_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5572" cy="-13605.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5572" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5572" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5572" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer43_moe_expert14&#45;&gt;layer43_moe_comm_from_expert14 -->
<g id="edge2747" class="edge">
<title>layer43_moe_expert14&#45;&gt;layer43_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5589.88,-13670.62C5589.88,-13670.62 5589.88,-13644.43 5589.88,-13644.43"/>
<polygon fill="black" stroke="black" points="5593.38,-13644.43 5589.88,-13634.43 5586.38,-13644.43 5593.38,-13644.43"/>
</g>
<!-- layer43_moe_comm_to_expert14&#45;&gt;layer43_moe_expert14 -->
<g id="edge2716" class="edge">
<title>layer43_moe_comm_to_expert14&#45;&gt;layer43_moe_expert14</title>
<path fill="none" stroke="black" d="M5588.52,-13759.14C5588.52,-13759.14 5588.52,-13733.07 5588.52,-13733.07"/>
<polygon fill="black" stroke="black" points="5592.02,-13733.07 5588.52,-13723.07 5585.02,-13733.07 5592.02,-13733.07"/>
</g>
<!-- layer43_moe_expert15 -->
<g id="node2121" class="node">
<title>layer43_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6207,-13722.94 5869,-13722.94 5869,-13670.94 6207,-13670.94 6207,-13722.94"/>
<text text-anchor="middle" x="6038" y="-13710.94" font-family="Arial" font-size="10.00">EXPERT 15 L43</text>
<text text-anchor="middle" x="6038" y="-13699.94" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6038" y="-13688.94" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6038" y="-13677.94" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_comm_from_expert15 -->
<g id="node2139" class="node">
<title>layer43_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5927" cy="-13605.94" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5927" y="-13614.44" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5927" y="-13603.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5927" y="-13592.44" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer43_moe_expert15&#45;&gt;layer43_moe_comm_from_expert15 -->
<g id="edge2749" class="edge">
<title>layer43_moe_expert15&#45;&gt;layer43_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5945.38,-13670.62C5945.38,-13670.62 5945.38,-13644.43 5945.38,-13644.43"/>
<polygon fill="black" stroke="black" points="5948.88,-13644.43 5945.38,-13634.43 5941.88,-13644.43 5948.88,-13644.43"/>
</g>
<!-- layer43_moe_comm_to_expert15&#45;&gt;layer43_moe_expert15 -->
<g id="edge2718" class="edge">
<title>layer43_moe_comm_to_expert15&#45;&gt;layer43_moe_expert15</title>
<path fill="none" stroke="black" d="M5944.02,-13759.14C5944.02,-13759.14 5944.02,-13733.07 5944.02,-13733.07"/>
<polygon fill="black" stroke="black" points="5947.52,-13733.07 5944.02,-13723.07 5940.52,-13733.07 5947.52,-13733.07"/>
</g>
<!-- layer43_moe_aggregate -->
<g id="node2123" class="node">
<title>layer43_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3613.1,-13540.95 3196.16,-13540.95 3088.9,-13436.95 3505.84,-13436.95 3613.1,-13540.95"/>
<text text-anchor="middle" x="3351" y="-13502.95" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L43</text>
<text text-anchor="middle" x="3351" y="-13491.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3351" y="-13480.95" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3351" y="-13469.95" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_mha -->
<g id="node2140" class="node">
<title>layer44_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3481,-13400.95 3221,-13400.95 3221,-13348.95 3481,-13348.95 3481,-13400.95"/>
<text text-anchor="middle" x="3351" y="-13388.95" font-family="Arial" font-size="10.00">MHA L44</text>
<text text-anchor="middle" x="3351" y="-13377.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3351" y="-13366.95" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3351" y="-13355.95" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer43_moe_aggregate&#45;&gt;layer44_moe_mha -->
<g id="edge2818" class="edge">
<title>layer43_moe_aggregate&#45;&gt;layer44_moe_mha</title>
<path fill="none" stroke="black" d="M3351,-13436.62C3351,-13436.62 3351,-13411.18 3351,-13411.18"/>
<polygon fill="black" stroke="black" points="3354.5,-13411.18 3351,-13401.18 3347.5,-13411.18 3354.5,-13411.18"/>
</g>
<!-- layer43_moe_comm_from_expert0&#45;&gt;layer43_moe_aggregate -->
<g id="edge2720" class="edge">
<title>layer43_moe_comm_from_expert0&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M1379.01,-13588.17C1379.01,-13547.47 1379.01,-13451 1379.01,-13451 1379.01,-13451 3093.24,-13451 3093.24,-13451"/>
<polygon fill="black" stroke="black" points="3093.24,-13454.5 3103.24,-13451 3093.24,-13447.5 3093.24,-13454.5"/>
</g>
<!-- layer43_moe_comm_from_expert1&#45;&gt;layer43_moe_aggregate -->
<g id="edge2722" class="edge">
<title>layer43_moe_comm_from_expert1&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M1636.25,-13594.96C1636.25,-13561.97 1636.25,-13466 1636.25,-13466 1636.25,-13466 3108.85,-13466 3108.85,-13466"/>
<polygon fill="black" stroke="black" points="3108.85,-13469.5 3118.85,-13466 3108.85,-13462.5 3108.85,-13469.5"/>
</g>
<!-- layer43_moe_comm_from_expert2&#45;&gt;layer43_moe_aggregate -->
<g id="edge2724" class="edge">
<title>layer43_moe_comm_from_expert2&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M2080.01,-13588.31C2080.01,-13553.87 2080.01,-13481 2080.01,-13481 2080.01,-13481 3124.31,-13481 3124.31,-13481"/>
<polygon fill="black" stroke="black" points="3124.31,-13484.5 3134.31,-13481 3124.31,-13477.5 3124.31,-13484.5"/>
</g>
<!-- layer43_moe_comm_from_expert3&#45;&gt;layer43_moe_aggregate -->
<g id="edge2726" class="edge">
<title>layer43_moe_comm_from_expert3&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M2408.01,-13588.28C2408.01,-13557.2 2408.01,-13496 2408.01,-13496 2408.01,-13496 3139.57,-13496 3139.57,-13496"/>
<polygon fill="black" stroke="black" points="3139.57,-13499.5 3149.57,-13496 3139.57,-13492.5 3139.57,-13499.5"/>
</g>
<!-- layer43_moe_comm_from_expert4&#45;&gt;layer43_moe_aggregate -->
<g id="edge2728" class="edge">
<title>layer43_moe_comm_from_expert4&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M2678.75,-13591.93C2678.75,-13565.52 2678.75,-13511 2678.75,-13511 2678.75,-13511 3155.08,-13511 3155.08,-13511"/>
<polygon fill="black" stroke="black" points="3155.08,-13514.5 3165.08,-13511 3155.08,-13507.5 3155.08,-13514.5"/>
</g>
<!-- layer43_moe_comm_from_expert5&#45;&gt;layer43_moe_aggregate -->
<g id="edge2730" class="edge">
<title>layer43_moe_comm_from_expert5&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M2900.5,-13587.4C2900.5,-13563.79 2900.5,-13526 2900.5,-13526 2900.5,-13526 3170.69,-13526 3170.69,-13526"/>
<polygon fill="black" stroke="black" points="3170.69,-13529.5 3180.69,-13526 3170.69,-13522.5 3170.69,-13529.5"/>
</g>
<!-- layer43_moe_comm_from_expert6&#45;&gt;layer43_moe_aggregate -->
<g id="edge2732" class="edge">
<title>layer43_moe_comm_from_expert6&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M3112.11,-13586.36C3112.11,-13586.36 3112.11,-13499 3112.11,-13499"/>
<polygon fill="black" stroke="black" points="3115.61,-13499 3112.11,-13489 3108.61,-13499 3115.61,-13499"/>
</g>
<!-- layer43_moe_comm_from_expert7&#45;&gt;layer43_moe_aggregate -->
<g id="edge2734" class="edge">
<title>layer43_moe_comm_from_expert7&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M3252,-13576.72C3252,-13576.72 3252,-13551.01 3252,-13551.01"/>
<polygon fill="black" stroke="black" points="3255.5,-13551.01 3252,-13541.01 3248.5,-13551.01 3255.5,-13551.01"/>
</g>
<!-- layer43_moe_comm_from_expert8&#45;&gt;layer43_moe_aggregate -->
<g id="edge2736" class="edge">
<title>layer43_moe_comm_from_expert8&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M3523.39,-13576.72C3523.39,-13576.72 3523.39,-13551.01 3523.39,-13551.01"/>
<polygon fill="black" stroke="black" points="3526.89,-13551.01 3523.39,-13541.01 3519.89,-13551.01 3526.89,-13551.01"/>
</g>
<!-- layer43_moe_comm_from_expert9&#45;&gt;layer43_moe_aggregate -->
<g id="edge2738" class="edge">
<title>layer43_moe_comm_from_expert9&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M3814.5,-13577.44C3814.5,-13554.83 3814.5,-13527 3814.5,-13527 3814.5,-13527 3609.03,-13527 3609.03,-13527"/>
<polygon fill="black" stroke="black" points="3609.03,-13523.5 3599.03,-13527 3609.03,-13530.5 3609.03,-13523.5"/>
</g>
<!-- layer43_moe_comm_from_expert10&#45;&gt;layer43_moe_aggregate -->
<g id="edge2740" class="edge">
<title>layer43_moe_comm_from_expert10&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M4146.15,-13577.36C4146.15,-13550.37 4146.15,-13514 4146.15,-13514 4146.15,-13514 3595.54,-13514 3595.54,-13514"/>
<polygon fill="black" stroke="black" points="3595.54,-13510.5 3585.54,-13514 3595.54,-13517.5 3595.54,-13510.5"/>
</g>
<!-- layer43_moe_comm_from_expert11&#45;&gt;layer43_moe_aggregate -->
<g id="edge2742" class="edge">
<title>layer43_moe_comm_from_expert11&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M4492.65,-13577.54C4492.65,-13546.47 4492.65,-13501 4492.65,-13501 4492.65,-13501 3582.14,-13501 3582.14,-13501"/>
<polygon fill="black" stroke="black" points="3582.14,-13497.5 3572.14,-13501 3582.14,-13504.5 3582.14,-13497.5"/>
</g>
<!-- layer43_moe_comm_from_expert12&#45;&gt;layer43_moe_aggregate -->
<g id="edge2744" class="edge">
<title>layer43_moe_comm_from_expert12&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M4843.65,-13577.39C4843.65,-13542.49 4843.65,-13488 4843.65,-13488 4843.65,-13488 3568.55,-13488 3568.55,-13488"/>
<polygon fill="black" stroke="black" points="3568.55,-13484.5 3558.55,-13488 3568.55,-13491.5 3568.55,-13484.5"/>
</g>
<!-- layer43_moe_comm_from_expert13&#45;&gt;layer43_moe_aggregate -->
<g id="edge2746" class="edge">
<title>layer43_moe_comm_from_expert13&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M5197.15,-13577.53C5197.15,-13539.02 5197.15,-13475 5197.15,-13475 5197.15,-13475 3555.08,-13475 3555.08,-13475"/>
<polygon fill="black" stroke="black" points="3555.08,-13471.5 3545.08,-13475 3555.08,-13478.5 3555.08,-13471.5"/>
</g>
<!-- layer43_moe_comm_from_expert14&#45;&gt;layer43_moe_aggregate -->
<g id="edge2748" class="edge">
<title>layer43_moe_comm_from_expert14&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M5552.15,-13577.51C5552.15,-13535.56 5552.15,-13462 5552.15,-13462 5552.15,-13462 3542.06,-13462 3542.06,-13462"/>
<polygon fill="black" stroke="black" points="3542.06,-13458.5 3532.06,-13462 3542.06,-13465.5 3542.06,-13458.5"/>
</g>
<!-- layer43_moe_comm_from_expert15&#45;&gt;layer43_moe_aggregate -->
<g id="edge2750" class="edge">
<title>layer43_moe_comm_from_expert15&#45;&gt;layer43_moe_aggregate</title>
<path fill="none" stroke="black" d="M5907.15,-13577.52C5907.15,-13532.3 5907.15,-13449 5907.15,-13449 5907.15,-13449 3528.72,-13449 3528.72,-13449"/>
<polygon fill="black" stroke="black" points="3528.72,-13445.5 3518.72,-13449 3528.72,-13452.5 3528.72,-13445.5"/>
</g>
<!-- layer44_moe_gate -->
<g id="node2141" class="node">
<title>layer44_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3609.3,-13312.95 3198.4,-13312.95 3092.7,-13208.95 3503.6,-13208.95 3609.3,-13312.95"/>
<text text-anchor="middle" x="3351" y="-13274.95" font-family="Arial" font-size="10.00">GATE L44</text>
<text text-anchor="middle" x="3351" y="-13263.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3351" y="-13252.95" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3351" y="-13241.95" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer44_moe_mha&#45;&gt;layer44_moe_gate -->
<g id="edge2819" class="edge">
<title>layer44_moe_mha&#45;&gt;layer44_moe_gate</title>
<path fill="none" stroke="black" d="M3351,-13348.8C3351,-13348.8 3351,-13323.05 3351,-13323.05"/>
<polygon fill="black" stroke="black" points="3354.5,-13323.05 3351,-13313.05 3347.5,-13323.05 3354.5,-13323.05"/>
</g>
<!-- layer44_moe_split -->
<g id="node2142" class="node">
<title>layer44_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3605.01,-13172.95 3200.94,-13172.95 3096.99,-13068.95 3501.06,-13068.95 3605.01,-13172.95"/>
<text text-anchor="middle" x="3351" y="-13134.95" font-family="Arial" font-size="10.00">SPLIT TOKENS L44</text>
<text text-anchor="middle" x="3351" y="-13123.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3351" y="-13112.95" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3351" y="-13101.95" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer44_moe_gate&#45;&gt;layer44_moe_split -->
<g id="edge2820" class="edge">
<title>layer44_moe_gate&#45;&gt;layer44_moe_split</title>
<path fill="none" stroke="black" d="M3351,-13208.82C3351,-13208.82 3351,-13183.13 3351,-13183.13"/>
<polygon fill="black" stroke="black" points="3354.5,-13183.13 3351,-13173.13 3347.5,-13183.13 3354.5,-13183.13"/>
</g>
<!-- layer44_moe_comm_to_expert0 -->
<g id="node2144" class="node">
<title>layer44_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1270" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1270" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1270" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1270" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert0 -->
<g id="edge2754" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3185.7,-13158C2696.28,-13158 1288.5,-13158 1288.5,-13158 1288.5,-13158 1288.5,-13042.57 1288.5,-13042.57"/>
<polygon fill="black" stroke="black" points="1292,-13042.57 1288.5,-13032.57 1285,-13042.57 1292,-13042.57"/>
</g>
<!-- layer44_moe_comm_to_expert1 -->
<g id="node2146" class="node">
<title>layer44_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1515" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1515" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1515" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1515" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert1 -->
<g id="edge2756" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3170.92,-13143C2711.8,-13143 1533.5,-13143 1533.5,-13143 1533.5,-13143 1533.5,-13042.43 1533.5,-13042.43"/>
<polygon fill="black" stroke="black" points="1537,-13042.43 1533.5,-13032.43 1530,-13042.43 1537,-13042.43"/>
</g>
<!-- layer44_moe_comm_to_expert2 -->
<g id="node2148" class="node">
<title>layer44_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1971" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1971" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1971" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1971" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert2 -->
<g id="edge2758" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3155.93,-13128C2779.46,-13128 1989.5,-13128 1989.5,-13128 1989.5,-13128 1989.5,-13042.42 1989.5,-13042.42"/>
<polygon fill="black" stroke="black" points="1993,-13042.42 1989.5,-13032.42 1986,-13042.42 1993,-13042.42"/>
</g>
<!-- layer44_moe_comm_to_expert3 -->
<g id="node2150" class="node">
<title>layer44_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2299" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2299" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2299" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2299" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert3 -->
<g id="edge2760" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3140.92,-13113C2838.79,-13113 2317.5,-13113 2317.5,-13113 2317.5,-13113 2317.5,-13042.61 2317.5,-13042.61"/>
<polygon fill="black" stroke="black" points="2321,-13042.61 2317.5,-13032.61 2314,-13042.61 2321,-13042.61"/>
</g>
<!-- layer44_moe_comm_to_expert4 -->
<g id="node2152" class="node">
<title>layer44_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2562" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2562" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2562" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2562" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert4 -->
<g id="edge2762" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3125.81,-13098C2898.4,-13098 2580.5,-13098 2580.5,-13098 2580.5,-13098 2580.5,-13042.43 2580.5,-13042.43"/>
<polygon fill="black" stroke="black" points="2584,-13042.43 2580.5,-13032.43 2577,-13042.43 2584,-13042.43"/>
</g>
<!-- layer44_moe_comm_to_expert5 -->
<g id="node2154" class="node">
<title>layer44_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2793" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2793" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2793" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2793" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert5 -->
<g id="edge2764" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3110.83,-13083C2966.86,-13083 2811.5,-13083 2811.5,-13083 2811.5,-13083 2811.5,-13042.5 2811.5,-13042.5"/>
<polygon fill="black" stroke="black" points="2815,-13042.5 2811.5,-13032.5 2808,-13042.5 2815,-13042.5"/>
</g>
<!-- layer44_moe_comm_to_expert6 -->
<g id="node2156" class="node">
<title>layer44_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3008" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3008" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="3008" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3008" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert6 -->
<g id="edge2766" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3111.5,-13120.87C3111.5,-13117.3 3111.5,-13003 3111.5,-13003 3111.5,-13003 3108.81,-13003 3108.81,-13003"/>
<polygon fill="black" stroke="black" points="3108.81,-12999.5 3098.81,-13003 3108.81,-13006.5 3108.81,-12999.5"/>
</g>
<!-- layer44_moe_comm_to_expert7 -->
<g id="node2158" class="node">
<title>layer44_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3215" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3215" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3215" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3215" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert7 -->
<g id="edge2768" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3215,-13068.62C3215,-13068.62 3215,-13043.17 3215,-13043.17"/>
<polygon fill="black" stroke="black" points="3218.5,-13043.17 3215,-13033.17 3211.5,-13043.17 3218.5,-13043.17"/>
</g>
<!-- layer44_moe_comm_to_expert8 -->
<g id="node2160" class="node">
<title>layer44_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3487" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3487" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3487" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3487" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert8 -->
<g id="edge2770" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3487,-13068.62C3487,-13068.62 3487,-13043.17 3487,-13043.17"/>
<polygon fill="black" stroke="black" points="3490.5,-13043.17 3487,-13033.17 3483.5,-13043.17 3490.5,-13043.17"/>
</g>
<!-- layer44_moe_comm_to_expert9 -->
<g id="node2162" class="node">
<title>layer44_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3796" cy="-13003.96" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3796" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3796" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3796" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert9 -->
<g id="edge2772" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3591.26,-13120.87C3591.26,-13117.3 3591.26,-13003 3591.26,-13003 3591.26,-13003 3695.3,-13003 3695.3,-13003"/>
<polygon fill="black" stroke="black" points="3695.3,-13006.5 3705.3,-13003 3695.3,-12999.5 3695.3,-13006.5"/>
</g>
<!-- layer44_moe_comm_to_expert10 -->
<g id="node2164" class="node">
<title>layer44_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4128" cy="-13003.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4128" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4128" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4128" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert10 -->
<g id="edge2774" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3515.38,-13083C3722.6,-13083 4052.1,-13083 4052.1,-13083 4052.1,-13083 4052.1,-13031.11 4052.1,-13031.11"/>
<polygon fill="black" stroke="black" points="4055.6,-13031.11 4052.1,-13021.11 4048.6,-13031.11 4055.6,-13031.11"/>
</g>
<!-- layer44_moe_comm_to_expert11 -->
<g id="node2166" class="node">
<title>layer44_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4474" cy="-13003.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4474" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4474" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4474" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert11 -->
<g id="edge2776" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3530.2,-13098C3829.48,-13098 4398.6,-13098 4398.6,-13098 4398.6,-13098 4398.6,-13031.65 4398.6,-13031.65"/>
<polygon fill="black" stroke="black" points="4402.1,-13031.65 4398.6,-13021.65 4395.1,-13031.65 4402.1,-13031.65"/>
</g>
<!-- layer44_moe_comm_to_expert12 -->
<g id="node2168" class="node">
<title>layer44_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4825" cy="-13003.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4825" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4825" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4825" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert12 -->
<g id="edge2778" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3545.1,-13113C3929.24,-13113 4749.6,-13113 4749.6,-13113 4749.6,-13113 4749.6,-13031.48 4749.6,-13031.48"/>
<polygon fill="black" stroke="black" points="4753.1,-13031.48 4749.6,-13021.48 4746.1,-13031.48 4753.1,-13031.48"/>
</g>
<!-- layer44_moe_comm_to_expert13 -->
<g id="node2170" class="node">
<title>layer44_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5178" cy="-13003.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5178" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5178" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5178" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert13 -->
<g id="edge2780" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3560.17,-13128C4025,-13128 5103.1,-13128 5103.1,-13128 5103.1,-13128 5103.1,-13031.73 5103.1,-13031.73"/>
<polygon fill="black" stroke="black" points="5106.6,-13031.73 5103.1,-13021.73 5099.6,-13031.73 5106.6,-13031.73"/>
</g>
<!-- layer44_moe_comm_to_expert14 -->
<g id="node2172" class="node">
<title>layer44_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5533" cy="-13003.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5533" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5533" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5533" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert14 -->
<g id="edge2782" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3575.5,-13143C4118.43,-13143 5458.1,-13143 5458.1,-13143 5458.1,-13143 5458.1,-13031.57 5458.1,-13031.57"/>
<polygon fill="black" stroke="black" points="5461.6,-13031.57 5458.1,-13021.57 5454.6,-13031.57 5461.6,-13031.57"/>
</g>
<!-- layer44_moe_comm_to_expert15 -->
<g id="node2174" class="node">
<title>layer44_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5888" cy="-13003.96" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5888" y="-13012.46" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5888" y="-13001.46" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5888" y="-12990.46" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert15 -->
<g id="edge2784" class="edge">
<title>layer44_moe_split&#45;&gt;layer44_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3590.15,-13158C4208.66,-13158 5813.1,-13158 5813.1,-13158 5813.1,-13158 5813.1,-13031.63 5813.1,-13031.63"/>
<polygon fill="black" stroke="black" points="5816.6,-13031.63 5813.1,-13021.63 5809.6,-13031.63 5816.6,-13031.63"/>
</g>
<!-- layer44_moe_expert0 -->
<g id="node2143" class="node">
<title>layer44_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="920,-12938.97 592,-12938.97 592,-12886.97 920,-12886.97 920,-12938.97"/>
<text text-anchor="middle" x="756" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 0 L44</text>
<text text-anchor="middle" x="756" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="756" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="756" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert0 -->
<g id="node2176" class="node">
<title>layer44_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="802" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="802" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="802" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="802" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer44_moe_expert0&#45;&gt;layer44_moe_comm_from_expert0 -->
<g id="edge2786" class="edge">
<title>layer44_moe_expert0&#45;&gt;layer44_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M802,-12886.65C802,-12886.65 802,-12861.11 802,-12861.11"/>
<polygon fill="black" stroke="black" points="805.5,-12861.11 802,-12851.11 798.5,-12861.11 805.5,-12861.11"/>
</g>
<!-- layer44_moe_comm_to_expert0&#45;&gt;layer44_moe_expert0 -->
<g id="edge2755" class="edge">
<title>layer44_moe_comm_to_expert0&#45;&gt;layer44_moe_expert0</title>
<path fill="none" stroke="black" d="M1179.41,-13003C1036.42,-13003 774.5,-13003 774.5,-13003 774.5,-13003 774.5,-12949.01 774.5,-12949.01"/>
<polygon fill="black" stroke="black" points="778,-12949.01 774.5,-12939.01 771,-12949.01 778,-12949.01"/>
</g>
<!-- layer44_moe_expert1 -->
<g id="node2145" class="node">
<title>layer44_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1266,-12938.97 938,-12938.97 938,-12886.97 1266,-12886.97 1266,-12938.97"/>
<text text-anchor="middle" x="1102" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 1 L44</text>
<text text-anchor="middle" x="1102" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1102" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1102" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert1 -->
<g id="node2177" class="node">
<title>layer44_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1515" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1515" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1515" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1515" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer44_moe_expert1&#45;&gt;layer44_moe_comm_from_expert1 -->
<g id="edge2788" class="edge">
<title>layer44_moe_expert1&#45;&gt;layer44_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1256.5,-12886.86C1256.5,-12859.67 1256.5,-12821 1256.5,-12821 1256.5,-12821 1414.23,-12821 1414.23,-12821"/>
<polygon fill="black" stroke="black" points="1414.23,-12824.5 1424.23,-12821 1414.23,-12817.5 1414.23,-12824.5"/>
</g>
<!-- layer44_moe_comm_to_expert1&#45;&gt;layer44_moe_expert1 -->
<g id="edge2757" class="edge">
<title>layer44_moe_comm_to_expert1&#45;&gt;layer44_moe_expert1</title>
<path fill="none" stroke="black" d="M1515,-12974.81C1515,-12960.8 1515,-12947 1515,-12947 1515,-12947 1222.75,-12947 1222.75,-12947 1222.75,-12947 1222.75,-12946.21 1222.75,-12946.21"/>
<polygon fill="black" stroke="black" points="1226.25,-12949.11 1222.75,-12939.11 1219.25,-12949.11 1226.25,-12949.11"/>
</g>
<!-- layer44_moe_expert2 -->
<g id="node2147" class="node">
<title>layer44_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1612,-12938.97 1284,-12938.97 1284,-12886.97 1612,-12886.97 1612,-12938.97"/>
<text text-anchor="middle" x="1448" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 2 L44</text>
<text text-anchor="middle" x="1448" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1448" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1448" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert2 -->
<g id="node2178" class="node">
<title>layer44_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1971" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1971" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1971" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1971" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer44_moe_expert2&#45;&gt;layer44_moe_comm_from_expert2 -->
<g id="edge2790" class="edge">
<title>layer44_moe_expert2&#45;&gt;layer44_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1612.18,-12904C1619.6,-12904 1624,-12904 1624,-12904 1624,-12904 1624,-12821 1624,-12821 1624,-12821 1870.28,-12821 1870.28,-12821"/>
<polygon fill="black" stroke="black" points="1870.28,-12824.5 1880.28,-12821 1870.28,-12817.5 1870.28,-12824.5"/>
</g>
<!-- layer44_moe_comm_to_expert2&#45;&gt;layer44_moe_expert2 -->
<g id="edge2759" class="edge">
<title>layer44_moe_comm_to_expert2&#45;&gt;layer44_moe_expert2</title>
<path fill="none" stroke="black" d="M1880.09,-13003C1775.5,-13003 1618,-13003 1618,-13003 1618,-13003 1618,-12921 1618,-12921 1618,-12921 1617.43,-12921 1617.43,-12921"/>
<polygon fill="black" stroke="black" points="1622.34,-12917.5 1612.34,-12921 1622.34,-12924.5 1622.34,-12917.5"/>
</g>
<!-- layer44_moe_expert3 -->
<g id="node2149" class="node">
<title>layer44_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1958,-12938.97 1630,-12938.97 1630,-12886.97 1958,-12886.97 1958,-12938.97"/>
<text text-anchor="middle" x="1794" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 3 L44</text>
<text text-anchor="middle" x="1794" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1794" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1794" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert3 -->
<g id="node2179" class="node">
<title>layer44_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2299" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2299" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2299" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2299" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer44_moe_expert3&#45;&gt;layer44_moe_comm_from_expert3 -->
<g id="edge2792" class="edge">
<title>layer44_moe_expert3&#45;&gt;layer44_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1919.25,-12886.89C1919.25,-12874.35 1919.25,-12862 1919.25,-12862 1919.25,-12862 2240.33,-12862 2240.33,-12862 2240.33,-12862 2240.33,-12854.33 2240.33,-12854.33"/>
<polygon fill="black" stroke="black" points="2243.83,-12854.33 2240.33,-12844.33 2236.83,-12854.33 2243.83,-12854.33"/>
</g>
<!-- layer44_moe_comm_to_expert3&#45;&gt;layer44_moe_expert3 -->
<g id="edge2761" class="edge">
<title>layer44_moe_comm_to_expert3&#45;&gt;layer44_moe_expert3</title>
<path fill="none" stroke="black" d="M2240.33,-12981.75C2240.33,-12973 2240.33,-12965 2240.33,-12965 2240.33,-12965 1919.25,-12965 1919.25,-12965 1919.25,-12965 1919.25,-12948.99 1919.25,-12948.99"/>
<polygon fill="black" stroke="black" points="1922.75,-12948.98 1919.25,-12938.99 1915.75,-12948.99 1922.75,-12948.98"/>
</g>
<!-- layer44_moe_expert4 -->
<g id="node2151" class="node">
<title>layer44_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2304,-12938.97 1976,-12938.97 1976,-12886.97 2304,-12886.97 2304,-12938.97"/>
<text text-anchor="middle" x="2140" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 4 L44</text>
<text text-anchor="middle" x="2140" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2140" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2140" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert4 -->
<g id="node2180" class="node">
<title>layer44_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2562" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2562" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2562" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2562" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer44_moe_expert4&#45;&gt;layer44_moe_comm_from_expert4 -->
<g id="edge2794" class="edge">
<title>layer44_moe_expert4&#45;&gt;layer44_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2272.16,-12886.76C2272.16,-12879.71 2272.16,-12874 2272.16,-12874 2272.16,-12874 2560.75,-12874 2560.75,-12874 2560.75,-12874 2560.75,-12861.03 2560.75,-12861.03"/>
<polygon fill="black" stroke="black" points="2564.25,-12861.03 2560.75,-12851.03 2557.25,-12861.03 2564.25,-12861.03"/>
</g>
<!-- layer44_moe_comm_to_expert4&#45;&gt;layer44_moe_expert4 -->
<g id="edge2763" class="edge">
<title>layer44_moe_comm_to_expert4&#45;&gt;layer44_moe_expert4</title>
<path fill="none" stroke="black" d="M2560.75,-12974.96C2560.75,-12964.86 2560.75,-12956 2560.75,-12956 2560.75,-12956 2272.16,-12956 2272.16,-12956 2272.16,-12956 2272.16,-12948.99 2272.16,-12948.99"/>
<polygon fill="black" stroke="black" points="2275.66,-12948.99 2272.16,-12938.99 2268.66,-12948.99 2275.66,-12948.99"/>
</g>
<!-- layer44_moe_expert5 -->
<g id="node2153" class="node">
<title>layer44_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2650,-12938.97 2322,-12938.97 2322,-12886.97 2650,-12886.97 2650,-12938.97"/>
<text text-anchor="middle" x="2486" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 5 L44</text>
<text text-anchor="middle" x="2486" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2486" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2486" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert5 -->
<g id="node2181" class="node">
<title>layer44_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2793" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2793" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2793" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2793" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer44_moe_expert5&#45;&gt;layer44_moe_comm_from_expert5 -->
<g id="edge2796" class="edge">
<title>layer44_moe_expert5&#45;&gt;layer44_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2650.21,-12904C2657.1,-12904 2661.16,-12904 2661.16,-12904 2661.16,-12904 2661.16,-12821 2661.16,-12821 2661.16,-12821 2692.52,-12821 2692.52,-12821"/>
<polygon fill="black" stroke="black" points="2692.52,-12824.5 2702.52,-12821 2692.52,-12817.5 2692.52,-12824.5"/>
</g>
<!-- layer44_moe_comm_to_expert5&#45;&gt;layer44_moe_expert5 -->
<g id="edge2765" class="edge">
<title>layer44_moe_comm_to_expert5&#45;&gt;layer44_moe_expert5</title>
<path fill="none" stroke="black" d="M2702.18,-13003C2677.2,-13003 2656.84,-13003 2656.84,-13003 2656.84,-13003 2656.84,-12921 2656.84,-12921 2656.84,-12921 2656.19,-12921 2656.19,-12921"/>
<polygon fill="black" stroke="black" points="2660.35,-12917.5 2650.35,-12921 2660.35,-12924.5 2660.35,-12917.5"/>
</g>
<!-- layer44_moe_expert6 -->
<g id="node2155" class="node">
<title>layer44_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2996,-12938.97 2668,-12938.97 2668,-12886.97 2996,-12886.97 2996,-12938.97"/>
<text text-anchor="middle" x="2832" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 6 L44</text>
<text text-anchor="middle" x="2832" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2832" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2832" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert6 -->
<g id="node2182" class="node">
<title>layer44_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="3008" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3008" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="3008" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3008" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer44_moe_expert6&#45;&gt;layer44_moe_comm_from_expert6 -->
<g id="edge2798" class="edge">
<title>layer44_moe_expert6&#45;&gt;layer44_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2956.75,-12886.65C2956.75,-12886.65 2956.75,-12856.06 2956.75,-12856.06"/>
<polygon fill="black" stroke="black" points="2960.25,-12856.06 2956.75,-12846.06 2953.25,-12856.06 2960.25,-12856.06"/>
</g>
<!-- layer44_moe_comm_to_expert6&#45;&gt;layer44_moe_expert6 -->
<g id="edge2767" class="edge">
<title>layer44_moe_comm_to_expert6&#45;&gt;layer44_moe_expert6</title>
<path fill="none" stroke="black" d="M2956.75,-12980.05C2956.75,-12980.05 2956.75,-12949.28 2956.75,-12949.28"/>
<polygon fill="black" stroke="black" points="2960.25,-12949.28 2956.75,-12939.28 2953.25,-12949.28 2960.25,-12949.28"/>
</g>
<!-- layer44_moe_expert7 -->
<g id="node2157" class="node">
<title>layer44_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3342,-12938.97 3014,-12938.97 3014,-12886.97 3342,-12886.97 3342,-12938.97"/>
<text text-anchor="middle" x="3178" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 7 L44</text>
<text text-anchor="middle" x="3178" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3178" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3178" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert7 -->
<g id="node2183" class="node">
<title>layer44_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3215" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3215" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3215" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3215" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer44_moe_expert7&#45;&gt;layer44_moe_comm_from_expert7 -->
<g id="edge2800" class="edge">
<title>layer44_moe_expert7&#45;&gt;layer44_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3215,-12886.65C3215,-12886.65 3215,-12861.11 3215,-12861.11"/>
<polygon fill="black" stroke="black" points="3218.5,-12861.11 3215,-12851.11 3211.5,-12861.11 3218.5,-12861.11"/>
</g>
<!-- layer44_moe_comm_to_expert7&#45;&gt;layer44_moe_expert7 -->
<g id="edge2769" class="edge">
<title>layer44_moe_comm_to_expert7&#45;&gt;layer44_moe_expert7</title>
<path fill="none" stroke="black" d="M3215,-12974.92C3215,-12974.92 3215,-12949.27 3215,-12949.27"/>
<polygon fill="black" stroke="black" points="3218.5,-12949.27 3215,-12939.27 3211.5,-12949.27 3218.5,-12949.27"/>
</g>
<!-- layer44_moe_expert8 -->
<g id="node2159" class="node">
<title>layer44_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3688,-12938.97 3360,-12938.97 3360,-12886.97 3688,-12886.97 3688,-12938.97"/>
<text text-anchor="middle" x="3524" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 8 L44</text>
<text text-anchor="middle" x="3524" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3524" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3524" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert8 -->
<g id="node2184" class="node">
<title>layer44_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3487" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3487" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3487" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3487" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer44_moe_expert8&#45;&gt;layer44_moe_comm_from_expert8 -->
<g id="edge2802" class="edge">
<title>layer44_moe_expert8&#45;&gt;layer44_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3487,-12886.65C3487,-12886.65 3487,-12861.11 3487,-12861.11"/>
<polygon fill="black" stroke="black" points="3490.5,-12861.11 3487,-12851.11 3483.5,-12861.11 3490.5,-12861.11"/>
</g>
<!-- layer44_moe_comm_to_expert8&#45;&gt;layer44_moe_expert8 -->
<g id="edge2771" class="edge">
<title>layer44_moe_comm_to_expert8&#45;&gt;layer44_moe_expert8</title>
<path fill="none" stroke="black" d="M3487,-12974.92C3487,-12974.92 3487,-12949.27 3487,-12949.27"/>
<polygon fill="black" stroke="black" points="3490.5,-12949.27 3487,-12939.27 3483.5,-12949.27 3490.5,-12949.27"/>
</g>
<!-- layer44_moe_expert9 -->
<g id="node2161" class="node">
<title>layer44_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="4034,-12938.97 3706,-12938.97 3706,-12886.97 4034,-12886.97 4034,-12938.97"/>
<text text-anchor="middle" x="3870" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 9 L44</text>
<text text-anchor="middle" x="3870" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3870" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3870" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert9 -->
<g id="node2185" class="node">
<title>layer44_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3796" cy="-12821.98" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3796" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3796" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3796" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer44_moe_expert9&#45;&gt;layer44_moe_comm_from_expert9 -->
<g id="edge2804" class="edge">
<title>layer44_moe_expert9&#45;&gt;layer44_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3796.25,-12886.65C3796.25,-12886.65 3796.25,-12861.11 3796.25,-12861.11"/>
<polygon fill="black" stroke="black" points="3799.75,-12861.11 3796.25,-12851.11 3792.75,-12861.11 3799.75,-12861.11"/>
</g>
<!-- layer44_moe_comm_to_expert9&#45;&gt;layer44_moe_expert9 -->
<g id="edge2773" class="edge">
<title>layer44_moe_comm_to_expert9&#45;&gt;layer44_moe_expert9</title>
<path fill="none" stroke="black" d="M3796.25,-12974.92C3796.25,-12974.92 3796.25,-12949.27 3796.25,-12949.27"/>
<polygon fill="black" stroke="black" points="3799.75,-12949.27 3796.25,-12939.27 3792.75,-12949.27 3799.75,-12949.27"/>
</g>
<!-- layer44_moe_expert10 -->
<g id="node2163" class="node">
<title>layer44_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4390,-12938.97 4052,-12938.97 4052,-12886.97 4390,-12886.97 4390,-12938.97"/>
<text text-anchor="middle" x="4221" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 10 L44</text>
<text text-anchor="middle" x="4221" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4221" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4221" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert10 -->
<g id="node2186" class="node">
<title>layer44_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4128" cy="-12821.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4128" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4128" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4128" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer44_moe_expert10&#45;&gt;layer44_moe_comm_from_expert10 -->
<g id="edge2806" class="edge">
<title>layer44_moe_expert10&#45;&gt;layer44_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4137.38,-12886.65C4137.38,-12886.65 4137.38,-12861.11 4137.38,-12861.11"/>
<polygon fill="black" stroke="black" points="4140.88,-12861.11 4137.38,-12851.11 4133.88,-12861.11 4140.88,-12861.11"/>
</g>
<!-- layer44_moe_comm_to_expert10&#45;&gt;layer44_moe_expert10 -->
<g id="edge2775" class="edge">
<title>layer44_moe_comm_to_expert10&#45;&gt;layer44_moe_expert10</title>
<path fill="none" stroke="black" d="M4137.02,-12974.92C4137.02,-12974.92 4137.02,-12949.27 4137.02,-12949.27"/>
<polygon fill="black" stroke="black" points="4140.52,-12949.27 4137.02,-12939.27 4133.52,-12949.27 4140.52,-12949.27"/>
</g>
<!-- layer44_moe_expert11 -->
<g id="node2165" class="node">
<title>layer44_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4746,-12938.97 4408,-12938.97 4408,-12886.97 4746,-12886.97 4746,-12938.97"/>
<text text-anchor="middle" x="4577" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 11 L44</text>
<text text-anchor="middle" x="4577" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4577" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4577" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert11 -->
<g id="node2187" class="node">
<title>layer44_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4475" cy="-12821.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4475" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4475" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4475" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer44_moe_expert11&#45;&gt;layer44_moe_comm_from_expert11 -->
<g id="edge2808" class="edge">
<title>layer44_moe_expert11&#45;&gt;layer44_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4488.88,-12886.65C4488.88,-12886.65 4488.88,-12860.79 4488.88,-12860.79"/>
<polygon fill="black" stroke="black" points="4492.38,-12860.79 4488.88,-12850.79 4485.38,-12860.79 4492.38,-12860.79"/>
</g>
<!-- layer44_moe_comm_to_expert11&#45;&gt;layer44_moe_expert11 -->
<g id="edge2777" class="edge">
<title>layer44_moe_comm_to_expert11&#45;&gt;layer44_moe_expert11</title>
<path fill="none" stroke="black" d="M4488.02,-12975.17C4488.02,-12975.17 4488.02,-12949.11 4488.02,-12949.11"/>
<polygon fill="black" stroke="black" points="4491.52,-12949.11 4488.02,-12939.11 4484.52,-12949.11 4491.52,-12949.11"/>
</g>
<!-- layer44_moe_expert12 -->
<g id="node2167" class="node">
<title>layer44_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5102,-12938.97 4764,-12938.97 4764,-12886.97 5102,-12886.97 5102,-12938.97"/>
<text text-anchor="middle" x="4933" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 12 L44</text>
<text text-anchor="middle" x="4933" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4933" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4933" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert12 -->
<g id="node2188" class="node">
<title>layer44_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4826" cy="-12821.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4826" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4826" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4826" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer44_moe_expert12&#45;&gt;layer44_moe_comm_from_expert12 -->
<g id="edge2810" class="edge">
<title>layer44_moe_expert12&#45;&gt;layer44_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4842.38,-12886.65C4842.38,-12886.65 4842.38,-12860.79 4842.38,-12860.79"/>
<polygon fill="black" stroke="black" points="4845.88,-12860.79 4842.38,-12850.79 4838.88,-12860.79 4845.88,-12860.79"/>
</g>
<!-- layer44_moe_comm_to_expert12&#45;&gt;layer44_moe_expert12 -->
<g id="edge2779" class="edge">
<title>layer44_moe_comm_to_expert12&#45;&gt;layer44_moe_expert12</title>
<path fill="none" stroke="black" d="M4841.52,-12975.17C4841.52,-12975.17 4841.52,-12949.11 4841.52,-12949.11"/>
<polygon fill="black" stroke="black" points="4845.02,-12949.11 4841.52,-12939.11 4838.02,-12949.11 4845.02,-12949.11"/>
</g>
<!-- layer44_moe_expert13 -->
<g id="node2169" class="node">
<title>layer44_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5458,-12938.97 5120,-12938.97 5120,-12886.97 5458,-12886.97 5458,-12938.97"/>
<text text-anchor="middle" x="5289" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 13 L44</text>
<text text-anchor="middle" x="5289" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5289" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5289" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert13 -->
<g id="node2189" class="node">
<title>layer44_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5180" cy="-12821.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5180" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5180" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5180" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer44_moe_expert13&#45;&gt;layer44_moe_comm_from_expert13 -->
<g id="edge2812" class="edge">
<title>layer44_moe_expert13&#45;&gt;layer44_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5197.38,-12886.65C5197.38,-12886.65 5197.38,-12860.79 5197.38,-12860.79"/>
<polygon fill="black" stroke="black" points="5200.88,-12860.79 5197.38,-12850.79 5193.88,-12860.79 5200.88,-12860.79"/>
</g>
<!-- layer44_moe_comm_to_expert13&#45;&gt;layer44_moe_expert13 -->
<g id="edge2781" class="edge">
<title>layer44_moe_comm_to_expert13&#45;&gt;layer44_moe_expert13</title>
<path fill="none" stroke="black" d="M5196.02,-12975.17C5196.02,-12975.17 5196.02,-12949.11 5196.02,-12949.11"/>
<polygon fill="black" stroke="black" points="5199.52,-12949.11 5196.02,-12939.11 5192.52,-12949.11 5199.52,-12949.11"/>
</g>
<!-- layer44_moe_expert14 -->
<g id="node2171" class="node">
<title>layer44_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5814,-12938.97 5476,-12938.97 5476,-12886.97 5814,-12886.97 5814,-12938.97"/>
<text text-anchor="middle" x="5645" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 14 L44</text>
<text text-anchor="middle" x="5645" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5645" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5645" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert14 -->
<g id="node2190" class="node">
<title>layer44_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5535" cy="-12821.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5535" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5535" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5535" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer44_moe_expert14&#45;&gt;layer44_moe_comm_from_expert14 -->
<g id="edge2814" class="edge">
<title>layer44_moe_expert14&#45;&gt;layer44_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5552.88,-12886.65C5552.88,-12886.65 5552.88,-12860.46 5552.88,-12860.46"/>
<polygon fill="black" stroke="black" points="5556.38,-12860.46 5552.88,-12850.46 5549.38,-12860.46 5556.38,-12860.46"/>
</g>
<!-- layer44_moe_comm_to_expert14&#45;&gt;layer44_moe_expert14 -->
<g id="edge2783" class="edge">
<title>layer44_moe_comm_to_expert14&#45;&gt;layer44_moe_expert14</title>
<path fill="none" stroke="black" d="M5551.52,-12975.17C5551.52,-12975.17 5551.52,-12949.11 5551.52,-12949.11"/>
<polygon fill="black" stroke="black" points="5555.02,-12949.11 5551.52,-12939.11 5548.02,-12949.11 5555.02,-12949.11"/>
</g>
<!-- layer44_moe_expert15 -->
<g id="node2173" class="node">
<title>layer44_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6170,-12938.97 5832,-12938.97 5832,-12886.97 6170,-12886.97 6170,-12938.97"/>
<text text-anchor="middle" x="6001" y="-12926.97" font-family="Arial" font-size="10.00">EXPERT 15 L44</text>
<text text-anchor="middle" x="6001" y="-12915.97" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6001" y="-12904.97" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="6001" y="-12893.97" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_comm_from_expert15 -->
<g id="node2191" class="node">
<title>layer44_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5890" cy="-12821.98" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5890" y="-12830.48" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5890" y="-12819.48" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5890" y="-12808.48" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer44_moe_expert15&#45;&gt;layer44_moe_comm_from_expert15 -->
<g id="edge2816" class="edge">
<title>layer44_moe_expert15&#45;&gt;layer44_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5908.38,-12886.65C5908.38,-12886.65 5908.38,-12860.46 5908.38,-12860.46"/>
<polygon fill="black" stroke="black" points="5911.88,-12860.46 5908.38,-12850.46 5904.88,-12860.46 5911.88,-12860.46"/>
</g>
<!-- layer44_moe_comm_to_expert15&#45;&gt;layer44_moe_expert15 -->
<g id="edge2785" class="edge">
<title>layer44_moe_comm_to_expert15&#45;&gt;layer44_moe_expert15</title>
<path fill="none" stroke="black" d="M5907.02,-12975.17C5907.02,-12975.17 5907.02,-12949.11 5907.02,-12949.11"/>
<polygon fill="black" stroke="black" points="5910.52,-12949.11 5907.02,-12939.11 5903.52,-12949.11 5910.52,-12949.11"/>
</g>
<!-- layer44_moe_aggregate -->
<g id="node2175" class="node">
<title>layer44_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3576.1,-12756.99 3159.16,-12756.99 3051.9,-12652.99 3468.84,-12652.99 3576.1,-12756.99"/>
<text text-anchor="middle" x="3314" y="-12718.99" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L44</text>
<text text-anchor="middle" x="3314" y="-12707.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3314" y="-12696.99" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3314" y="-12685.99" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_mha -->
<g id="node2192" class="node">
<title>layer45_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3444,-12616.99 3184,-12616.99 3184,-12564.99 3444,-12564.99 3444,-12616.99"/>
<text text-anchor="middle" x="3314" y="-12604.99" font-family="Arial" font-size="10.00">MHA L45</text>
<text text-anchor="middle" x="3314" y="-12593.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3314" y="-12582.99" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3314" y="-12571.99" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer44_moe_aggregate&#45;&gt;layer45_moe_mha -->
<g id="edge2885" class="edge">
<title>layer44_moe_aggregate&#45;&gt;layer45_moe_mha</title>
<path fill="none" stroke="black" d="M3314,-12652.66C3314,-12652.66 3314,-12627.21 3314,-12627.21"/>
<polygon fill="black" stroke="black" points="3317.5,-12627.21 3314,-12617.21 3310.5,-12627.22 3317.5,-12627.21"/>
</g>
<!-- layer44_moe_comm_from_expert0&#45;&gt;layer44_moe_aggregate -->
<g id="edge2787" class="edge">
<title>layer44_moe_comm_from_expert0&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M887.75,-12812.28C887.75,-12778.36 887.75,-12667 887.75,-12667 887.75,-12667 3056.32,-12667 3056.32,-12667"/>
<polygon fill="black" stroke="black" points="3056.32,-12670.5 3066.32,-12667 3056.32,-12663.5 3056.32,-12670.5"/>
</g>
<!-- layer44_moe_comm_from_expert1&#45;&gt;layer44_moe_aggregate -->
<g id="edge2789" class="edge">
<title>layer44_moe_comm_from_expert1&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M1599.25,-12810.99C1599.25,-12778 1599.25,-12682 1599.25,-12682 1599.25,-12682 3071.4,-12682 3071.4,-12682"/>
<polygon fill="black" stroke="black" points="3071.4,-12685.5 3081.4,-12682 3071.4,-12678.5 3071.4,-12685.5"/>
</g>
<!-- layer44_moe_comm_from_expert2&#45;&gt;layer44_moe_aggregate -->
<g id="edge2791" class="edge">
<title>layer44_moe_comm_from_expert2&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M2043.01,-12804.34C2043.01,-12769.89 2043.01,-12697 2043.01,-12697 2043.01,-12697 3086.95,-12697 3086.95,-12697"/>
<polygon fill="black" stroke="black" points="3086.95,-12700.5 3096.95,-12697 3086.95,-12693.5 3086.95,-12700.5"/>
</g>
<!-- layer44_moe_comm_from_expert3&#45;&gt;layer44_moe_aggregate -->
<g id="edge2793" class="edge">
<title>layer44_moe_comm_from_expert3&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M2371.01,-12804.31C2371.01,-12773.22 2371.01,-12712 2371.01,-12712 2371.01,-12712 3102.57,-12712 3102.57,-12712"/>
<polygon fill="black" stroke="black" points="3102.57,-12715.5 3112.57,-12712 3102.57,-12708.5 3102.57,-12715.5"/>
</g>
<!-- layer44_moe_comm_from_expert4&#45;&gt;layer44_moe_aggregate -->
<g id="edge2795" class="edge">
<title>layer44_moe_comm_from_expert4&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M2641.75,-12807.96C2641.75,-12781.54 2641.75,-12727 2641.75,-12727 2641.75,-12727 3118.08,-12727 3118.08,-12727"/>
<polygon fill="black" stroke="black" points="3118.08,-12730.5 3128.08,-12727 3118.08,-12723.5 3118.08,-12730.5"/>
</g>
<!-- layer44_moe_comm_from_expert5&#45;&gt;layer44_moe_aggregate -->
<g id="edge2797" class="edge">
<title>layer44_moe_comm_from_expert5&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M2863.5,-12803.43C2863.5,-12779.8 2863.5,-12742 2863.5,-12742 2863.5,-12742 3133.69,-12742 3133.69,-12742"/>
<polygon fill="black" stroke="black" points="3133.69,-12745.5 3143.69,-12742 3133.69,-12738.5 3133.69,-12745.5"/>
</g>
<!-- layer44_moe_comm_from_expert6&#45;&gt;layer44_moe_aggregate -->
<g id="edge2799" class="edge">
<title>layer44_moe_comm_from_expert6&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M3075.11,-12802.4C3075.11,-12802.4 3075.11,-12715.03 3075.11,-12715.03"/>
<polygon fill="black" stroke="black" points="3078.61,-12715.03 3075.11,-12705.03 3071.61,-12715.03 3078.61,-12715.03"/>
</g>
<!-- layer44_moe_comm_from_expert7&#45;&gt;layer44_moe_aggregate -->
<g id="edge2801" class="edge">
<title>layer44_moe_comm_from_expert7&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M3215,-12792.76C3215,-12792.76 3215,-12767.05 3215,-12767.05"/>
<polygon fill="black" stroke="black" points="3218.5,-12767.05 3215,-12757.05 3211.5,-12767.05 3218.5,-12767.05"/>
</g>
<!-- layer44_moe_comm_from_expert8&#45;&gt;layer44_moe_aggregate -->
<g id="edge2803" class="edge">
<title>layer44_moe_comm_from_expert8&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M3486.39,-12792.76C3486.39,-12792.76 3486.39,-12767.05 3486.39,-12767.05"/>
<polygon fill="black" stroke="black" points="3489.89,-12767.05 3486.39,-12757.05 3482.89,-12767.05 3489.89,-12767.05"/>
</g>
<!-- layer44_moe_comm_from_expert9&#45;&gt;layer44_moe_aggregate -->
<g id="edge2805" class="edge">
<title>layer44_moe_comm_from_expert9&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M3777.5,-12793.47C3777.5,-12770.84 3777.5,-12743 3777.5,-12743 3777.5,-12743 3571.69,-12743 3571.69,-12743"/>
<polygon fill="black" stroke="black" points="3571.69,-12739.5 3561.69,-12743 3571.69,-12746.5 3571.69,-12739.5"/>
</g>
<!-- layer44_moe_comm_from_expert10&#45;&gt;layer44_moe_aggregate -->
<g id="edge2807" class="edge">
<title>layer44_moe_comm_from_expert10&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M4109.15,-12793.38C4109.15,-12766.38 4109.15,-12730 4109.15,-12730 4109.15,-12730 3558.27,-12730 3558.27,-12730"/>
<polygon fill="black" stroke="black" points="3558.27,-12726.5 3548.27,-12730 3558.27,-12733.5 3558.27,-12726.5"/>
</g>
<!-- layer44_moe_comm_from_expert11&#45;&gt;layer44_moe_aggregate -->
<g id="edge2809" class="edge">
<title>layer44_moe_comm_from_expert11&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M4455.65,-12793.57C4455.65,-12762.48 4455.65,-12717 4455.65,-12717 4455.65,-12717 3545.14,-12717 3545.14,-12717"/>
<polygon fill="black" stroke="black" points="3545.14,-12713.5 3535.14,-12717 3545.14,-12720.5 3545.14,-12713.5"/>
</g>
<!-- layer44_moe_comm_from_expert12&#45;&gt;layer44_moe_aggregate -->
<g id="edge2811" class="edge">
<title>layer44_moe_comm_from_expert12&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M4806.65,-12793.42C4806.65,-12758.5 4806.65,-12704 4806.65,-12704 4806.65,-12704 3531.55,-12704 3531.55,-12704"/>
<polygon fill="black" stroke="black" points="3531.55,-12700.5 3521.55,-12704 3531.55,-12707.5 3531.55,-12700.5"/>
</g>
<!-- layer44_moe_comm_from_expert13&#45;&gt;layer44_moe_aggregate -->
<g id="edge2813" class="edge">
<title>layer44_moe_comm_from_expert13&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M5160.15,-12793.56C5160.15,-12755.04 5160.15,-12691 5160.15,-12691 5160.15,-12691 3518.08,-12691 3518.08,-12691"/>
<polygon fill="black" stroke="black" points="3518.08,-12687.5 3508.08,-12691 3518.08,-12694.5 3518.08,-12687.5"/>
</g>
<!-- layer44_moe_comm_from_expert14&#45;&gt;layer44_moe_aggregate -->
<g id="edge2815" class="edge">
<title>layer44_moe_comm_from_expert14&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M5515.15,-12793.53C5515.15,-12751.57 5515.15,-12678 5515.15,-12678 5515.15,-12678 3505.06,-12678 3505.06,-12678"/>
<polygon fill="black" stroke="black" points="3505.06,-12674.5 3495.06,-12678 3505.06,-12681.5 3505.06,-12674.5"/>
</g>
<!-- layer44_moe_comm_from_expert15&#45;&gt;layer44_moe_aggregate -->
<g id="edge2817" class="edge">
<title>layer44_moe_comm_from_expert15&#45;&gt;layer44_moe_aggregate</title>
<path fill="none" stroke="black" d="M5870.15,-12793.55C5870.15,-12748.31 5870.15,-12665 5870.15,-12665 5870.15,-12665 3491.72,-12665 3491.72,-12665"/>
<polygon fill="black" stroke="black" points="3491.72,-12661.5 3481.72,-12665 3491.72,-12668.5 3491.72,-12661.5"/>
</g>
<!-- layer45_moe_gate -->
<g id="node2193" class="node">
<title>layer45_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3572.3,-12528.99 3161.4,-12528.99 3055.7,-12424.99 3466.6,-12424.99 3572.3,-12528.99"/>
<text text-anchor="middle" x="3314" y="-12490.99" font-family="Arial" font-size="10.00">GATE L45</text>
<text text-anchor="middle" x="3314" y="-12479.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3314" y="-12468.99" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3314" y="-12457.99" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer45_moe_mha&#45;&gt;layer45_moe_gate -->
<g id="edge2886" class="edge">
<title>layer45_moe_mha&#45;&gt;layer45_moe_gate</title>
<path fill="none" stroke="black" d="M3314,-12564.83C3314,-12564.83 3314,-12539.09 3314,-12539.09"/>
<polygon fill="black" stroke="black" points="3317.5,-12539.09 3314,-12529.09 3310.5,-12539.09 3317.5,-12539.09"/>
</g>
<!-- layer45_moe_split -->
<g id="node2194" class="node">
<title>layer45_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3568.01,-12388.99 3163.94,-12388.99 3059.99,-12284.99 3464.06,-12284.99 3568.01,-12388.99"/>
<text text-anchor="middle" x="3314" y="-12350.99" font-family="Arial" font-size="10.00">SPLIT TOKENS L45</text>
<text text-anchor="middle" x="3314" y="-12339.99" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3314" y="-12328.99" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3314" y="-12317.99" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer45_moe_gate&#45;&gt;layer45_moe_split -->
<g id="edge2887" class="edge">
<title>layer45_moe_gate&#45;&gt;layer45_moe_split</title>
<path fill="none" stroke="black" d="M3314,-12424.86C3314,-12424.86 3314,-12399.16 3314,-12399.16"/>
<polygon fill="black" stroke="black" points="3317.5,-12399.16 3314,-12389.16 3310.5,-12399.16 3317.5,-12399.16"/>
</g>
<!-- layer45_moe_comm_to_expert0 -->
<g id="node2196" class="node">
<title>layer45_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="765" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="765" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="765" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="765" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert0 -->
<g id="edge2821" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3148.94,-12374C2587.08,-12374 783.5,-12374 783.5,-12374 783.5,-12374 783.5,-12258.6 783.5,-12258.6"/>
<polygon fill="black" stroke="black" points="787,-12258.6 783.5,-12248.6 780,-12258.6 787,-12258.6"/>
</g>
<!-- layer45_moe_comm_to_expert1 -->
<g id="node2198" class="node">
<title>layer45_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1478" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1478" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1478" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1478" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert1 -->
<g id="edge2823" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3133.92,-12359C2674.8,-12359 1496.5,-12359 1496.5,-12359 1496.5,-12359 1496.5,-12258.46 1496.5,-12258.46"/>
<polygon fill="black" stroke="black" points="1500,-12258.46 1496.5,-12248.46 1493,-12258.46 1500,-12258.46"/>
</g>
<!-- layer45_moe_comm_to_expert2 -->
<g id="node2200" class="node">
<title>layer45_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1934" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1934" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1934" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1934" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert2 -->
<g id="edge2825" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3118.93,-12344C2742.46,-12344 1952.5,-12344 1952.5,-12344 1952.5,-12344 1952.5,-12258.44 1952.5,-12258.44"/>
<polygon fill="black" stroke="black" points="1956,-12258.44 1952.5,-12248.44 1949,-12258.44 1956,-12258.44"/>
</g>
<!-- layer45_moe_comm_to_expert3 -->
<g id="node2202" class="node">
<title>layer45_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2262" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2262" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2262" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2262" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert3 -->
<g id="edge2827" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3103.92,-12329C2801.79,-12329 2280.5,-12329 2280.5,-12329 2280.5,-12329 2280.5,-12258.64 2280.5,-12258.64"/>
<polygon fill="black" stroke="black" points="2284,-12258.64 2280.5,-12248.64 2277,-12258.64 2284,-12258.64"/>
</g>
<!-- layer45_moe_comm_to_expert4 -->
<g id="node2204" class="node">
<title>layer45_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2525" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2525" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2525" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2525" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert4 -->
<g id="edge2829" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3088.81,-12314C2861.4,-12314 2543.5,-12314 2543.5,-12314 2543.5,-12314 2543.5,-12258.46 2543.5,-12258.46"/>
<polygon fill="black" stroke="black" points="2547,-12258.46 2543.5,-12248.46 2540,-12258.46 2547,-12258.46"/>
</g>
<!-- layer45_moe_comm_to_expert5 -->
<g id="node2206" class="node">
<title>layer45_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2756" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2756" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2756" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2756" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert5 -->
<g id="edge2831" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3073.83,-12299C2929.86,-12299 2774.5,-12299 2774.5,-12299 2774.5,-12299 2774.5,-12258.52 2774.5,-12258.52"/>
<polygon fill="black" stroke="black" points="2778,-12258.52 2774.5,-12248.52 2771,-12258.52 2778,-12258.52"/>
</g>
<!-- layer45_moe_comm_to_expert6 -->
<g id="node2208" class="node">
<title>layer45_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2971" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2971" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2971" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2971" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert6 -->
<g id="edge2833" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3074.5,-12336.9C3074.5,-12333.33 3074.5,-12219 3074.5,-12219 3074.5,-12219 3071.81,-12219 3071.81,-12219"/>
<polygon fill="black" stroke="black" points="3071.81,-12215.5 3061.81,-12219 3071.81,-12222.5 3071.81,-12215.5"/>
</g>
<!-- layer45_moe_comm_to_expert7 -->
<g id="node2210" class="node">
<title>layer45_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3178" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3178" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3178" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3178" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert7 -->
<g id="edge2835" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3178,-12284.65C3178,-12284.65 3178,-12259.21 3178,-12259.21"/>
<polygon fill="black" stroke="black" points="3181.5,-12259.21 3178,-12249.21 3174.5,-12259.21 3181.5,-12259.21"/>
</g>
<!-- layer45_moe_comm_to_expert8 -->
<g id="node2212" class="node">
<title>layer45_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3450" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3450" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3450" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3450" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert8 -->
<g id="edge2837" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3450,-12284.65C3450,-12284.65 3450,-12259.21 3450,-12259.21"/>
<polygon fill="black" stroke="black" points="3453.5,-12259.21 3450,-12249.21 3446.5,-12259.21 3453.5,-12259.21"/>
</g>
<!-- layer45_moe_comm_to_expert9 -->
<g id="node2214" class="node">
<title>layer45_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3759" cy="-12220" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3759" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3759" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3759" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert9 -->
<g id="edge2839" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3554.26,-12336.9C3554.26,-12333.33 3554.26,-12219 3554.26,-12219 3554.26,-12219 3658.3,-12219 3658.3,-12219"/>
<polygon fill="black" stroke="black" points="3658.3,-12222.5 3668.3,-12219 3658.3,-12215.5 3658.3,-12222.5"/>
</g>
<!-- layer45_moe_comm_to_expert10 -->
<g id="node2216" class="node">
<title>layer45_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4091" cy="-12220" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4091" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4091" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4091" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert10 -->
<g id="edge2841" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3478.38,-12299C3685.6,-12299 4015.1,-12299 4015.1,-12299 4015.1,-12299 4015.1,-12247.14 4015.1,-12247.14"/>
<polygon fill="black" stroke="black" points="4018.6,-12247.14 4015.1,-12237.14 4011.6,-12247.14 4018.6,-12247.14"/>
</g>
<!-- layer45_moe_comm_to_expert11 -->
<g id="node2218" class="node">
<title>layer45_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4437" cy="-12220" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4437" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4437" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4437" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert11 -->
<g id="edge2843" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3493.2,-12314C3792.48,-12314 4361.6,-12314 4361.6,-12314 4361.6,-12314 4361.6,-12247.68 4361.6,-12247.68"/>
<polygon fill="black" stroke="black" points="4365.1,-12247.68 4361.6,-12237.68 4358.1,-12247.68 4365.1,-12247.68"/>
</g>
<!-- layer45_moe_comm_to_expert12 -->
<g id="node2220" class="node">
<title>layer45_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4788" cy="-12220" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4788" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4788" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4788" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert12 -->
<g id="edge2845" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3508.1,-12329C3892.24,-12329 4712.6,-12329 4712.6,-12329 4712.6,-12329 4712.6,-12247.51 4712.6,-12247.51"/>
<polygon fill="black" stroke="black" points="4716.1,-12247.51 4712.6,-12237.51 4709.1,-12247.51 4716.1,-12247.51"/>
</g>
<!-- layer45_moe_comm_to_expert13 -->
<g id="node2222" class="node">
<title>layer45_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5141" cy="-12220" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5141" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5141" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5141" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert13 -->
<g id="edge2847" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3523.17,-12344C3988,-12344 5066.1,-12344 5066.1,-12344 5066.1,-12344 5066.1,-12247.76 5066.1,-12247.76"/>
<polygon fill="black" stroke="black" points="5069.6,-12247.76 5066.1,-12237.76 5062.6,-12247.76 5069.6,-12247.76"/>
</g>
<!-- layer45_moe_comm_to_expert14 -->
<g id="node2224" class="node">
<title>layer45_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5496" cy="-12220" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5496" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5496" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5496" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert14 -->
<g id="edge2849" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3538.5,-12359C4081.43,-12359 5421.1,-12359 5421.1,-12359 5421.1,-12359 5421.1,-12247.6 5421.1,-12247.6"/>
<polygon fill="black" stroke="black" points="5424.6,-12247.6 5421.1,-12237.6 5417.6,-12247.6 5424.6,-12247.6"/>
</g>
<!-- layer45_moe_comm_to_expert15 -->
<g id="node2226" class="node">
<title>layer45_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5851" cy="-12220" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5851" y="-12228.5" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5851" y="-12217.5" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5851" y="-12206.5" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert15 -->
<g id="edge2851" class="edge">
<title>layer45_moe_split&#45;&gt;layer45_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3553.15,-12374C4171.66,-12374 5776.1,-12374 5776.1,-12374 5776.1,-12374 5776.1,-12247.66 5776.1,-12247.66"/>
<polygon fill="black" stroke="black" points="5779.6,-12247.66 5776.1,-12237.66 5772.6,-12247.66 5779.6,-12247.66"/>
</g>
<!-- layer45_moe_expert0 -->
<g id="node2195" class="node">
<title>layer45_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="883,-12155 555,-12155 555,-12103 883,-12103 883,-12155"/>
<text text-anchor="middle" x="719" y="-12143" font-family="Arial" font-size="10.00">EXPERT 0 L45</text>
<text text-anchor="middle" x="719" y="-12132" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="719" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="719" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert0 -->
<g id="node2228" class="node">
<title>layer45_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="1086" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1086" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="1086" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1086" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer45_moe_expert0&#45;&gt;layer45_moe_comm_from_expert0 -->
<g id="edge2853" class="edge">
<title>layer45_moe_expert0&#45;&gt;layer45_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M815.75,-12102.68C815.75,-12075.81 815.75,-12038 815.75,-12038 815.75,-12038 985.26,-12038 985.26,-12038"/>
<polygon fill="black" stroke="black" points="985.26,-12041.5 995.26,-12038 985.26,-12034.5 985.26,-12041.5"/>
</g>
<!-- layer45_moe_comm_to_expert0&#45;&gt;layer45_moe_expert0 -->
<g id="edge2822" class="edge">
<title>layer45_moe_comm_to_expert0&#45;&gt;layer45_moe_expert0</title>
<path fill="none" stroke="black" d="M765,-12190.96C765,-12190.96 765,-12165.31 765,-12165.31"/>
<polygon fill="black" stroke="black" points="768.5,-12165.31 765,-12155.31 761.5,-12165.31 768.5,-12165.31"/>
</g>
<!-- layer45_moe_expert1 -->
<g id="node2197" class="node">
<title>layer45_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1229,-12155 901,-12155 901,-12103 1229,-12103 1229,-12155"/>
<text text-anchor="middle" x="1065" y="-12143" font-family="Arial" font-size="10.00">EXPERT 1 L45</text>
<text text-anchor="middle" x="1065" y="-12132" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1065" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1065" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert1 -->
<g id="node2229" class="node">
<title>layer45_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1418" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1418" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1418" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1418" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer45_moe_expert1&#45;&gt;layer45_moe_comm_from_expert1 -->
<g id="edge2855" class="edge">
<title>layer45_moe_expert1&#45;&gt;layer45_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1202.75,-12102.68C1202.75,-12075.81 1202.75,-12038 1202.75,-12038 1202.75,-12038 1317.34,-12038 1317.34,-12038"/>
<polygon fill="black" stroke="black" points="1317.34,-12041.5 1327.34,-12038 1317.34,-12034.5 1317.34,-12041.5"/>
</g>
<!-- layer45_moe_comm_to_expert1&#45;&gt;layer45_moe_expert1 -->
<g id="edge2824" class="edge">
<title>layer45_moe_comm_to_expert1&#45;&gt;layer45_moe_expert1</title>
<path fill="none" stroke="black" d="M1387.49,-12219C1271.02,-12219 1083.5,-12219 1083.5,-12219 1083.5,-12219 1083.5,-12165.03 1083.5,-12165.03"/>
<polygon fill="black" stroke="black" points="1087,-12165.03 1083.5,-12155.03 1080,-12165.03 1087,-12165.03"/>
</g>
<!-- layer45_moe_expert2 -->
<g id="node2199" class="node">
<title>layer45_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1575,-12155 1247,-12155 1247,-12103 1575,-12103 1575,-12155"/>
<text text-anchor="middle" x="1411" y="-12143" font-family="Arial" font-size="10.00">EXPERT 2 L45</text>
<text text-anchor="middle" x="1411" y="-12132" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1411" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1411" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert2 -->
<g id="node2230" class="node">
<title>layer45_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1801" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1801" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1801" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1801" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer45_moe_expert2&#45;&gt;layer45_moe_comm_from_expert2 -->
<g id="edge2857" class="edge">
<title>layer45_moe_expert2&#45;&gt;layer45_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1541.75,-12102.68C1541.75,-12075.81 1541.75,-12038 1541.75,-12038 1541.75,-12038 1700.33,-12038 1700.33,-12038"/>
<polygon fill="black" stroke="black" points="1700.33,-12041.5 1710.33,-12038 1700.33,-12034.5 1700.33,-12041.5"/>
</g>
<!-- layer45_moe_comm_to_expert2&#45;&gt;layer45_moe_expert2 -->
<g id="edge2826" class="edge">
<title>layer45_moe_comm_to_expert2&#45;&gt;layer45_moe_expert2</title>
<path fill="none" stroke="black" d="M1843.41,-12219C1739.71,-12219 1584,-12219 1584,-12219 1584,-12219 1584,-12129 1584,-12129 1584,-12129 1583.12,-12129 1583.12,-12129"/>
<polygon fill="black" stroke="black" points="1585.18,-12125.5 1575.18,-12129 1585.18,-12132.5 1585.18,-12125.5"/>
</g>
<!-- layer45_moe_expert3 -->
<g id="node2201" class="node">
<title>layer45_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1921,-12155 1593,-12155 1593,-12103 1921,-12103 1921,-12155"/>
<text text-anchor="middle" x="1757" y="-12143" font-family="Arial" font-size="10.00">EXPERT 3 L45</text>
<text text-anchor="middle" x="1757" y="-12132" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1757" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1757" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert3 -->
<g id="node2231" class="node">
<title>layer45_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2092" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2092" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2092" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2092" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer45_moe_expert3&#45;&gt;layer45_moe_comm_from_expert3 -->
<g id="edge2859" class="edge">
<title>layer45_moe_expert3&#45;&gt;layer45_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1916.25,-12102.68C1916.25,-12075.81 1916.25,-12038 1916.25,-12038 1916.25,-12038 1991.3,-12038 1991.3,-12038"/>
<polygon fill="black" stroke="black" points="1991.3,-12041.5 2001.3,-12038 1991.3,-12034.5 1991.3,-12041.5"/>
</g>
<!-- layer45_moe_comm_to_expert3&#45;&gt;layer45_moe_expert3 -->
<g id="edge2828" class="edge">
<title>layer45_moe_comm_to_expert3&#45;&gt;layer45_moe_expert3</title>
<path fill="none" stroke="black" d="M2203.33,-12197.58C2203.33,-12188.01 2203.33,-12179 2203.33,-12179 2203.33,-12179 1882.25,-12179 1882.25,-12179 1882.25,-12179 1882.25,-12165.17 1882.25,-12165.17"/>
<polygon fill="black" stroke="black" points="1885.75,-12165.17 1882.25,-12155.17 1878.75,-12165.17 1885.75,-12165.17"/>
</g>
<!-- layer45_moe_expert4 -->
<g id="node2203" class="node">
<title>layer45_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2267,-12155 1939,-12155 1939,-12103 2267,-12103 2267,-12155"/>
<text text-anchor="middle" x="2103" y="-12143" font-family="Arial" font-size="10.00">EXPERT 4 L45</text>
<text text-anchor="middle" x="2103" y="-12132" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2103" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2103" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert4 -->
<g id="node2232" class="node">
<title>layer45_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2337" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2337" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2337" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2337" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer45_moe_expert4&#45;&gt;layer45_moe_comm_from_expert4 -->
<g id="edge2861" class="edge">
<title>layer45_moe_expert4&#45;&gt;layer45_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2256.75,-12102.69C2256.75,-12102.69 2256.75,-12061.64 2256.75,-12061.64"/>
<polygon fill="black" stroke="black" points="2260.25,-12061.64 2256.75,-12051.64 2253.25,-12061.64 2260.25,-12061.64"/>
</g>
<!-- layer45_moe_comm_to_expert4&#45;&gt;layer45_moe_expert4 -->
<g id="edge2830" class="edge">
<title>layer45_moe_comm_to_expert4&#45;&gt;layer45_moe_expert4</title>
<path fill="none" stroke="black" d="M2523.75,-12190.71C2523.75,-12178.45 2523.75,-12167 2523.75,-12167 2523.75,-12167 2235.16,-12167 2235.16,-12167 2235.16,-12167 2235.16,-12165.39 2235.16,-12165.39"/>
<polygon fill="black" stroke="black" points="2238.66,-12165.39 2235.16,-12155.39 2231.66,-12165.39 2238.66,-12165.39"/>
</g>
<!-- layer45_moe_expert5 -->
<g id="node2205" class="node">
<title>layer45_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2613,-12155 2285,-12155 2285,-12103 2613,-12103 2613,-12155"/>
<text text-anchor="middle" x="2449" y="-12143" font-family="Arial" font-size="10.00">EXPERT 5 L45</text>
<text text-anchor="middle" x="2449" y="-12132" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2449" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2449" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert5 -->
<g id="node2233" class="node">
<title>layer45_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2559" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2559" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2559" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2559" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer45_moe_expert5&#45;&gt;layer45_moe_comm_from_expert5 -->
<g id="edge2863" class="edge">
<title>layer45_moe_expert5&#45;&gt;layer45_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2540.75,-12102.69C2540.75,-12102.69 2540.75,-12076.5 2540.75,-12076.5"/>
<polygon fill="black" stroke="black" points="2544.25,-12076.5 2540.75,-12066.5 2537.25,-12076.5 2544.25,-12076.5"/>
</g>
<!-- layer45_moe_comm_to_expert5&#45;&gt;layer45_moe_expert5 -->
<g id="edge2832" class="edge">
<title>layer45_moe_comm_to_expert5&#45;&gt;layer45_moe_expert5</title>
<path fill="none" stroke="black" d="M2665.26,-12219C2641.92,-12219 2623.25,-12219 2623.25,-12219 2623.25,-12219 2623.25,-12129 2623.25,-12129 2623.25,-12129 2622.24,-12129 2622.24,-12129"/>
<polygon fill="black" stroke="black" points="2623.13,-12125.5 2613.13,-12129 2623.13,-12132.5 2623.13,-12125.5"/>
</g>
<!-- layer45_moe_expert6 -->
<g id="node2207" class="node">
<title>layer45_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2959,-12155 2631,-12155 2631,-12103 2959,-12103 2959,-12155"/>
<text text-anchor="middle" x="2795" y="-12143" font-family="Arial" font-size="10.00">EXPERT 6 L45</text>
<text text-anchor="middle" x="2795" y="-12132" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2795" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2795" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert6 -->
<g id="node2234" class="node">
<title>layer45_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2906" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2906" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2906" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2906" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer45_moe_expert6&#45;&gt;layer45_moe_comm_from_expert6 -->
<g id="edge2865" class="edge">
<title>layer45_moe_expert6&#45;&gt;layer45_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2887.25,-12102.69C2887.25,-12102.69 2887.25,-12076.5 2887.25,-12076.5"/>
<polygon fill="black" stroke="black" points="2890.75,-12076.5 2887.25,-12066.5 2883.75,-12076.5 2890.75,-12076.5"/>
</g>
<!-- layer45_moe_comm_to_expert6&#45;&gt;layer45_moe_expert6 -->
<g id="edge2834" class="edge">
<title>layer45_moe_comm_to_expert6&#45;&gt;layer45_moe_expert6</title>
<path fill="none" stroke="black" d="M2919.75,-12196.09C2919.75,-12196.09 2919.75,-12165.31 2919.75,-12165.31"/>
<polygon fill="black" stroke="black" points="2923.25,-12165.31 2919.75,-12155.31 2916.25,-12165.31 2923.25,-12165.31"/>
</g>
<!-- layer45_moe_expert7 -->
<g id="node2209" class="node">
<title>layer45_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3305,-12155 2977,-12155 2977,-12103 3305,-12103 3305,-12155"/>
<text text-anchor="middle" x="3141" y="-12143" font-family="Arial" font-size="10.00">EXPERT 7 L45</text>
<text text-anchor="middle" x="3141" y="-12132" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3141" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3141" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert7 -->
<g id="node2235" class="node">
<title>layer45_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3178" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3178" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3178" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3178" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer45_moe_expert7&#45;&gt;layer45_moe_comm_from_expert7 -->
<g id="edge2867" class="edge">
<title>layer45_moe_expert7&#45;&gt;layer45_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3178,-12102.69C3178,-12102.69 3178,-12077.14 3178,-12077.14"/>
<polygon fill="black" stroke="black" points="3181.5,-12077.14 3178,-12067.14 3174.5,-12077.14 3181.5,-12077.14"/>
</g>
<!-- layer45_moe_comm_to_expert7&#45;&gt;layer45_moe_expert7 -->
<g id="edge2836" class="edge">
<title>layer45_moe_comm_to_expert7&#45;&gt;layer45_moe_expert7</title>
<path fill="none" stroke="black" d="M3178,-12190.96C3178,-12190.96 3178,-12165.31 3178,-12165.31"/>
<polygon fill="black" stroke="black" points="3181.5,-12165.31 3178,-12155.31 3174.5,-12165.31 3181.5,-12165.31"/>
</g>
<!-- layer45_moe_expert8 -->
<g id="node2211" class="node">
<title>layer45_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3651,-12155 3323,-12155 3323,-12103 3651,-12103 3651,-12155"/>
<text text-anchor="middle" x="3487" y="-12143" font-family="Arial" font-size="10.00">EXPERT 8 L45</text>
<text text-anchor="middle" x="3487" y="-12132" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3487" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3487" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert8 -->
<g id="node2236" class="node">
<title>layer45_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3450" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3450" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3450" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3450" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer45_moe_expert8&#45;&gt;layer45_moe_comm_from_expert8 -->
<g id="edge2869" class="edge">
<title>layer45_moe_expert8&#45;&gt;layer45_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3450,-12102.69C3450,-12102.69 3450,-12077.14 3450,-12077.14"/>
<polygon fill="black" stroke="black" points="3453.5,-12077.14 3450,-12067.14 3446.5,-12077.14 3453.5,-12077.14"/>
</g>
<!-- layer45_moe_comm_to_expert8&#45;&gt;layer45_moe_expert8 -->
<g id="edge2838" class="edge">
<title>layer45_moe_comm_to_expert8&#45;&gt;layer45_moe_expert8</title>
<path fill="none" stroke="black" d="M3450,-12190.96C3450,-12190.96 3450,-12165.31 3450,-12165.31"/>
<polygon fill="black" stroke="black" points="3453.5,-12165.31 3450,-12155.31 3446.5,-12165.31 3453.5,-12165.31"/>
</g>
<!-- layer45_moe_expert9 -->
<g id="node2213" class="node">
<title>layer45_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3997,-12155 3669,-12155 3669,-12103 3997,-12103 3997,-12155"/>
<text text-anchor="middle" x="3833" y="-12143" font-family="Arial" font-size="10.00">EXPERT 9 L45</text>
<text text-anchor="middle" x="3833" y="-12132" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3833" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3833" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert9 -->
<g id="node2237" class="node">
<title>layer45_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3759" cy="-12038.01" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3759" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3759" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3759" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer45_moe_expert9&#45;&gt;layer45_moe_comm_from_expert9 -->
<g id="edge2871" class="edge">
<title>layer45_moe_expert9&#45;&gt;layer45_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3759.25,-12102.69C3759.25,-12102.69 3759.25,-12077.14 3759.25,-12077.14"/>
<polygon fill="black" stroke="black" points="3762.75,-12077.14 3759.25,-12067.14 3755.75,-12077.14 3762.75,-12077.14"/>
</g>
<!-- layer45_moe_comm_to_expert9&#45;&gt;layer45_moe_expert9 -->
<g id="edge2840" class="edge">
<title>layer45_moe_comm_to_expert9&#45;&gt;layer45_moe_expert9</title>
<path fill="none" stroke="black" d="M3759.25,-12190.96C3759.25,-12190.96 3759.25,-12165.31 3759.25,-12165.31"/>
<polygon fill="black" stroke="black" points="3762.75,-12165.31 3759.25,-12155.31 3755.75,-12165.31 3762.75,-12165.31"/>
</g>
<!-- layer45_moe_expert10 -->
<g id="node2215" class="node">
<title>layer45_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4353,-12155 4015,-12155 4015,-12103 4353,-12103 4353,-12155"/>
<text text-anchor="middle" x="4184" y="-12143" font-family="Arial" font-size="10.00">EXPERT 10 L45</text>
<text text-anchor="middle" x="4184" y="-12132" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4184" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4184" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert10 -->
<g id="node2238" class="node">
<title>layer45_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4091" cy="-12038.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4091" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4091" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4091" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer45_moe_expert10&#45;&gt;layer45_moe_comm_from_expert10 -->
<g id="edge2873" class="edge">
<title>layer45_moe_expert10&#45;&gt;layer45_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4100.38,-12102.69C4100.38,-12102.69 4100.38,-12077.14 4100.38,-12077.14"/>
<polygon fill="black" stroke="black" points="4103.88,-12077.14 4100.38,-12067.14 4096.88,-12077.14 4103.88,-12077.14"/>
</g>
<!-- layer45_moe_comm_to_expert10&#45;&gt;layer45_moe_expert10 -->
<g id="edge2842" class="edge">
<title>layer45_moe_comm_to_expert10&#45;&gt;layer45_moe_expert10</title>
<path fill="none" stroke="black" d="M4100.02,-12190.96C4100.02,-12190.96 4100.02,-12165.31 4100.02,-12165.31"/>
<polygon fill="black" stroke="black" points="4103.52,-12165.31 4100.02,-12155.31 4096.52,-12165.31 4103.52,-12165.31"/>
</g>
<!-- layer45_moe_expert11 -->
<g id="node2217" class="node">
<title>layer45_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4709,-12155 4371,-12155 4371,-12103 4709,-12103 4709,-12155"/>
<text text-anchor="middle" x="4540" y="-12143" font-family="Arial" font-size="10.00">EXPERT 11 L45</text>
<text text-anchor="middle" x="4540" y="-12132" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4540" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4540" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert11 -->
<g id="node2239" class="node">
<title>layer45_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4438" cy="-12038.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4438" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4438" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4438" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer45_moe_expert11&#45;&gt;layer45_moe_comm_from_expert11 -->
<g id="edge2875" class="edge">
<title>layer45_moe_expert11&#45;&gt;layer45_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4451.88,-12102.69C4451.88,-12102.69 4451.88,-12076.82 4451.88,-12076.82"/>
<polygon fill="black" stroke="black" points="4455.38,-12076.82 4451.88,-12066.82 4448.38,-12076.82 4455.38,-12076.82"/>
</g>
<!-- layer45_moe_comm_to_expert11&#45;&gt;layer45_moe_expert11 -->
<g id="edge2844" class="edge">
<title>layer45_moe_comm_to_expert11&#45;&gt;layer45_moe_expert11</title>
<path fill="none" stroke="black" d="M4451.02,-12191.21C4451.02,-12191.21 4451.02,-12165.14 4451.02,-12165.14"/>
<polygon fill="black" stroke="black" points="4454.52,-12165.14 4451.02,-12155.14 4447.52,-12165.14 4454.52,-12165.14"/>
</g>
<!-- layer45_moe_expert12 -->
<g id="node2219" class="node">
<title>layer45_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5065,-12155 4727,-12155 4727,-12103 5065,-12103 5065,-12155"/>
<text text-anchor="middle" x="4896" y="-12143" font-family="Arial" font-size="10.00">EXPERT 12 L45</text>
<text text-anchor="middle" x="4896" y="-12132" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4896" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4896" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert12 -->
<g id="node2240" class="node">
<title>layer45_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4789" cy="-12038.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4789" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4789" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4789" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer45_moe_expert12&#45;&gt;layer45_moe_comm_from_expert12 -->
<g id="edge2877" class="edge">
<title>layer45_moe_expert12&#45;&gt;layer45_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4805.38,-12102.69C4805.38,-12102.69 4805.38,-12076.82 4805.38,-12076.82"/>
<polygon fill="black" stroke="black" points="4808.88,-12076.82 4805.38,-12066.82 4801.88,-12076.82 4808.88,-12076.82"/>
</g>
<!-- layer45_moe_comm_to_expert12&#45;&gt;layer45_moe_expert12 -->
<g id="edge2846" class="edge">
<title>layer45_moe_comm_to_expert12&#45;&gt;layer45_moe_expert12</title>
<path fill="none" stroke="black" d="M4804.52,-12191.21C4804.52,-12191.21 4804.52,-12165.14 4804.52,-12165.14"/>
<polygon fill="black" stroke="black" points="4808.02,-12165.14 4804.52,-12155.14 4801.02,-12165.14 4808.02,-12165.14"/>
</g>
<!-- layer45_moe_expert13 -->
<g id="node2221" class="node">
<title>layer45_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5421,-12155 5083,-12155 5083,-12103 5421,-12103 5421,-12155"/>
<text text-anchor="middle" x="5252" y="-12143" font-family="Arial" font-size="10.00">EXPERT 13 L45</text>
<text text-anchor="middle" x="5252" y="-12132" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5252" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5252" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert13 -->
<g id="node2241" class="node">
<title>layer45_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5143" cy="-12038.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5143" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5143" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5143" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer45_moe_expert13&#45;&gt;layer45_moe_comm_from_expert13 -->
<g id="edge2879" class="edge">
<title>layer45_moe_expert13&#45;&gt;layer45_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5160.38,-12102.69C5160.38,-12102.69 5160.38,-12076.82 5160.38,-12076.82"/>
<polygon fill="black" stroke="black" points="5163.88,-12076.82 5160.38,-12066.82 5156.88,-12076.82 5163.88,-12076.82"/>
</g>
<!-- layer45_moe_comm_to_expert13&#45;&gt;layer45_moe_expert13 -->
<g id="edge2848" class="edge">
<title>layer45_moe_comm_to_expert13&#45;&gt;layer45_moe_expert13</title>
<path fill="none" stroke="black" d="M5159.02,-12191.21C5159.02,-12191.21 5159.02,-12165.14 5159.02,-12165.14"/>
<polygon fill="black" stroke="black" points="5162.52,-12165.14 5159.02,-12155.14 5155.52,-12165.14 5162.52,-12165.14"/>
</g>
<!-- layer45_moe_expert14 -->
<g id="node2223" class="node">
<title>layer45_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5777,-12155 5439,-12155 5439,-12103 5777,-12103 5777,-12155"/>
<text text-anchor="middle" x="5608" y="-12143" font-family="Arial" font-size="10.00">EXPERT 14 L45</text>
<text text-anchor="middle" x="5608" y="-12132" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5608" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5608" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert14 -->
<g id="node2242" class="node">
<title>layer45_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5498" cy="-12038.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5498" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5498" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5498" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer45_moe_expert14&#45;&gt;layer45_moe_comm_from_expert14 -->
<g id="edge2881" class="edge">
<title>layer45_moe_expert14&#45;&gt;layer45_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5515.88,-12102.69C5515.88,-12102.69 5515.88,-12076.5 5515.88,-12076.5"/>
<polygon fill="black" stroke="black" points="5519.38,-12076.5 5515.88,-12066.5 5512.38,-12076.5 5519.38,-12076.5"/>
</g>
<!-- layer45_moe_comm_to_expert14&#45;&gt;layer45_moe_expert14 -->
<g id="edge2850" class="edge">
<title>layer45_moe_comm_to_expert14&#45;&gt;layer45_moe_expert14</title>
<path fill="none" stroke="black" d="M5514.52,-12191.21C5514.52,-12191.21 5514.52,-12165.14 5514.52,-12165.14"/>
<polygon fill="black" stroke="black" points="5518.02,-12165.14 5514.52,-12155.14 5511.02,-12165.14 5518.02,-12165.14"/>
</g>
<!-- layer45_moe_expert15 -->
<g id="node2225" class="node">
<title>layer45_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6133,-12155 5795,-12155 5795,-12103 6133,-12103 6133,-12155"/>
<text text-anchor="middle" x="5964" y="-12143" font-family="Arial" font-size="10.00">EXPERT 15 L45</text>
<text text-anchor="middle" x="5964" y="-12132" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5964" y="-12121" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5964" y="-12110" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_comm_from_expert15 -->
<g id="node2243" class="node">
<title>layer45_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5853" cy="-12038.01" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5853" y="-12046.51" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5853" y="-12035.51" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5853" y="-12024.51" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer45_moe_expert15&#45;&gt;layer45_moe_comm_from_expert15 -->
<g id="edge2883" class="edge">
<title>layer45_moe_expert15&#45;&gt;layer45_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5871.38,-12102.69C5871.38,-12102.69 5871.38,-12076.5 5871.38,-12076.5"/>
<polygon fill="black" stroke="black" points="5874.88,-12076.5 5871.38,-12066.5 5867.88,-12076.5 5874.88,-12076.5"/>
</g>
<!-- layer45_moe_comm_to_expert15&#45;&gt;layer45_moe_expert15 -->
<g id="edge2852" class="edge">
<title>layer45_moe_comm_to_expert15&#45;&gt;layer45_moe_expert15</title>
<path fill="none" stroke="black" d="M5870.02,-12191.21C5870.02,-12191.21 5870.02,-12165.14 5870.02,-12165.14"/>
<polygon fill="black" stroke="black" points="5873.52,-12165.14 5870.02,-12155.14 5866.52,-12165.14 5873.52,-12165.14"/>
</g>
<!-- layer45_moe_aggregate -->
<g id="node2227" class="node">
<title>layer45_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3539.1,-11973.02 3122.16,-11973.02 3014.9,-11869.02 3431.84,-11869.02 3539.1,-11973.02"/>
<text text-anchor="middle" x="3277" y="-11935.02" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L45</text>
<text text-anchor="middle" x="3277" y="-11924.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3277" y="-11913.02" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3277" y="-11902.02" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_mha -->
<g id="node2244" class="node">
<title>layer46_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3407,-11833.02 3147,-11833.02 3147,-11781.02 3407,-11781.02 3407,-11833.02"/>
<text text-anchor="middle" x="3277" y="-11821.02" font-family="Arial" font-size="10.00">MHA L46</text>
<text text-anchor="middle" x="3277" y="-11810.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3277" y="-11799.02" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3277" y="-11788.02" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer45_moe_aggregate&#45;&gt;layer46_moe_mha -->
<g id="edge2952" class="edge">
<title>layer45_moe_aggregate&#45;&gt;layer46_moe_mha</title>
<path fill="none" stroke="black" d="M3277,-11868.69C3277,-11868.69 3277,-11843.25 3277,-11843.25"/>
<polygon fill="black" stroke="black" points="3280.5,-11843.25 3277,-11833.25 3273.5,-11843.25 3280.5,-11843.25"/>
</g>
<!-- layer45_moe_comm_from_expert0&#45;&gt;layer45_moe_aggregate -->
<g id="edge2854" class="edge">
<title>layer45_moe_comm_from_expert0&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M1172,-12028.72C1172,-11995.13 1172,-11882 1172,-11882 1172,-11882 3018.04,-11882 3018.04,-11882"/>
<polygon fill="black" stroke="black" points="3018.04,-11885.5 3028.04,-11882 3018.04,-11878.5 3018.04,-11885.5"/>
</g>
<!-- layer45_moe_comm_from_expert1&#45;&gt;layer45_moe_aggregate -->
<g id="edge2856" class="edge">
<title>layer45_moe_comm_from_expert1&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M1492.5,-12021.33C1492.5,-11983.6 1492.5,-11895 1492.5,-11895 1492.5,-11895 3031.41,-11895 3031.41,-11895"/>
<polygon fill="black" stroke="black" points="3031.41,-11898.5 3041.41,-11895 3031.41,-11891.5 3031.41,-11898.5"/>
</g>
<!-- layer45_moe_comm_from_expert2&#45;&gt;layer45_moe_aggregate -->
<g id="edge2858" class="edge">
<title>layer45_moe_comm_from_expert2&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M1811,-12009.16C1811,-11970.86 1811,-11908 1811,-11908 1811,-11908 3044.74,-11908 3044.74,-11908"/>
<polygon fill="black" stroke="black" points="3044.74,-11911.5 3054.74,-11908 3044.74,-11904.5 3044.74,-11911.5"/>
</g>
<!-- layer45_moe_comm_from_expert3&#45;&gt;layer45_moe_aggregate -->
<g id="edge2860" class="edge">
<title>layer45_moe_comm_from_expert3&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M2125.5,-12010.87C2125.5,-11976.31 2125.5,-11921 2125.5,-11921 2125.5,-11921 3058.47,-11921 3058.47,-11921"/>
<polygon fill="black" stroke="black" points="3058.47,-11924.5 3068.47,-11921 3058.47,-11917.5 3058.47,-11924.5"/>
</g>
<!-- layer45_moe_comm_from_expert4&#45;&gt;layer45_moe_aggregate -->
<g id="edge2862" class="edge">
<title>layer45_moe_comm_from_expert4&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M2338.51,-12008.76C2338.51,-11978 2338.51,-11934 2338.51,-11934 2338.51,-11934 3071.69,-11934 3071.69,-11934"/>
<polygon fill="black" stroke="black" points="3071.69,-11937.5 3081.69,-11934 3071.69,-11930.5 3071.69,-11937.5"/>
</g>
<!-- layer45_moe_comm_from_expert5&#45;&gt;layer45_moe_aggregate -->
<g id="edge2864" class="edge">
<title>layer45_moe_comm_from_expert5&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M2568.5,-12008.97C2568.5,-11982.33 2568.5,-11947 2568.5,-11947 2568.5,-11947 3085,-11947 3085,-11947"/>
<polygon fill="black" stroke="black" points="3085,-11950.5 3095,-11947 3085,-11943.5 3085,-11950.5"/>
</g>
<!-- layer45_moe_comm_from_expert6&#45;&gt;layer45_moe_aggregate -->
<g id="edge2866" class="edge">
<title>layer45_moe_comm_from_expert6&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M2987.01,-12024.78C2987.01,-12002.52 2987.01,-11960 2987.01,-11960 2987.01,-11960 3098.31,-11960 3098.31,-11960"/>
<polygon fill="black" stroke="black" points="3098.31,-11963.5 3108.31,-11960 3098.31,-11956.5 3098.31,-11963.5"/>
</g>
<!-- layer45_moe_comm_from_expert7&#45;&gt;layer45_moe_aggregate -->
<g id="edge2868" class="edge">
<title>layer45_moe_comm_from_expert7&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M3178,-12008.79C3178,-12008.79 3178,-11983.08 3178,-11983.08"/>
<polygon fill="black" stroke="black" points="3181.5,-11983.08 3178,-11973.08 3174.5,-11983.08 3181.5,-11983.08"/>
</g>
<!-- layer45_moe_comm_from_expert8&#45;&gt;layer45_moe_aggregate -->
<g id="edge2870" class="edge">
<title>layer45_moe_comm_from_expert8&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M3449.39,-12008.79C3449.39,-12008.79 3449.39,-11983.08 3449.39,-11983.08"/>
<polygon fill="black" stroke="black" points="3452.89,-11983.08 3449.39,-11973.08 3445.89,-11983.08 3452.89,-11983.08"/>
</g>
<!-- layer45_moe_comm_from_expert9&#45;&gt;layer45_moe_aggregate -->
<g id="edge2872" class="edge">
<title>layer45_moe_comm_from_expert9&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M3740.5,-12009.41C3740.5,-11987.14 3740.5,-11960 3740.5,-11960 3740.5,-11960 3535.71,-11960 3535.71,-11960"/>
<polygon fill="black" stroke="black" points="3535.71,-11956.5 3525.71,-11960 3535.71,-11963.5 3535.71,-11956.5"/>
</g>
<!-- layer45_moe_comm_from_expert10&#45;&gt;layer45_moe_aggregate -->
<g id="edge2874" class="edge">
<title>layer45_moe_comm_from_expert10&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M4072.15,-12009.22C4072.15,-11982.55 4072.15,-11947 4072.15,-11947 4072.15,-11947 3522.34,-11947 3522.34,-11947"/>
<polygon fill="black" stroke="black" points="3522.34,-11943.5 3512.34,-11947 3522.34,-11950.5 3522.34,-11943.5"/>
</g>
<!-- layer45_moe_comm_from_expert11&#45;&gt;layer45_moe_aggregate -->
<g id="edge2876" class="edge">
<title>layer45_moe_comm_from_expert11&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M4418.65,-12009.59C4418.65,-11978.79 4418.65,-11934 4418.65,-11934 4418.65,-11934 3509.15,-11934 3509.15,-11934"/>
<polygon fill="black" stroke="black" points="3509.15,-11930.5 3499.15,-11934 3509.15,-11937.5 3509.15,-11930.5"/>
</g>
<!-- layer45_moe_comm_from_expert12&#45;&gt;layer45_moe_aggregate -->
<g id="edge2878" class="edge">
<title>layer45_moe_comm_from_expert12&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M4769.65,-12009.39C4769.65,-11974.75 4769.65,-11921 4769.65,-11921 4769.65,-11921 3495.72,-11921 3495.72,-11921"/>
<polygon fill="black" stroke="black" points="3495.72,-11917.5 3485.72,-11921 3495.72,-11924.5 3495.72,-11917.5"/>
</g>
<!-- layer45_moe_comm_from_expert13&#45;&gt;layer45_moe_aggregate -->
<g id="edge2880" class="edge">
<title>layer45_moe_comm_from_expert13&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M5123.15,-12009.48C5123.15,-11971.21 5123.15,-11908 5123.15,-11908 5123.15,-11908 3482.39,-11908 3482.39,-11908"/>
<polygon fill="black" stroke="black" points="3482.39,-11904.5 3472.39,-11908 3482.39,-11911.5 3482.39,-11904.5"/>
</g>
<!-- layer45_moe_comm_from_expert14&#45;&gt;layer45_moe_aggregate -->
<g id="edge2882" class="edge">
<title>layer45_moe_comm_from_expert14&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M5478.15,-12009.42C5478.15,-11967.68 5478.15,-11895 5478.15,-11895 5478.15,-11895 3469,-11895 3469,-11895"/>
<polygon fill="black" stroke="black" points="3469,-11891.5 3459,-11895 3469,-11898.5 3469,-11891.5"/>
</g>
<!-- layer45_moe_comm_from_expert15&#45;&gt;layer45_moe_aggregate -->
<g id="edge2884" class="edge">
<title>layer45_moe_comm_from_expert15&#45;&gt;layer45_moe_aggregate</title>
<path fill="none" stroke="black" d="M5833.15,-12009.4C5833.15,-11964.36 5833.15,-11882 5833.15,-11882 5833.15,-11882 3455.7,-11882 3455.7,-11882"/>
<polygon fill="black" stroke="black" points="3455.7,-11878.5 3445.7,-11882 3455.7,-11885.5 3455.7,-11878.5"/>
</g>
<!-- layer46_moe_gate -->
<g id="node2245" class="node">
<title>layer46_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3535.3,-11745.02 3124.4,-11745.02 3018.7,-11641.02 3429.6,-11641.02 3535.3,-11745.02"/>
<text text-anchor="middle" x="3277" y="-11707.02" font-family="Arial" font-size="10.00">GATE L46</text>
<text text-anchor="middle" x="3277" y="-11696.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3277" y="-11685.02" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3277" y="-11674.02" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer46_moe_mha&#45;&gt;layer46_moe_gate -->
<g id="edge2953" class="edge">
<title>layer46_moe_mha&#45;&gt;layer46_moe_gate</title>
<path fill="none" stroke="black" d="M3277,-11780.87C3277,-11780.87 3277,-11755.12 3277,-11755.12"/>
<polygon fill="black" stroke="black" points="3280.5,-11755.12 3277,-11745.12 3273.5,-11755.12 3280.5,-11755.12"/>
</g>
<!-- layer46_moe_split -->
<g id="node2246" class="node">
<title>layer46_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3531.01,-11605.02 3126.94,-11605.02 3022.99,-11501.02 3427.06,-11501.02 3531.01,-11605.02"/>
<text text-anchor="middle" x="3277" y="-11567.02" font-family="Arial" font-size="10.00">SPLIT TOKENS L46</text>
<text text-anchor="middle" x="3277" y="-11556.02" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3277" y="-11545.02" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3277" y="-11534.02" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer46_moe_gate&#45;&gt;layer46_moe_split -->
<g id="edge2954" class="edge">
<title>layer46_moe_gate&#45;&gt;layer46_moe_split</title>
<path fill="none" stroke="black" d="M3277,-11640.89C3277,-11640.89 3277,-11615.2 3277,-11615.2"/>
<polygon fill="black" stroke="black" points="3280.5,-11615.2 3277,-11605.2 3273.5,-11615.2 3280.5,-11615.2"/>
</g>
<!-- layer46_moe_comm_to_expert0 -->
<g id="node2248" class="node">
<title>layer46_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="839" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="839" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="839" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="839" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert0 -->
<g id="edge2888" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3111.87,-11590C2575.28,-11590 915.25,-11590 915.25,-11590 915.25,-11590 915.25,-11461.93 915.25,-11461.93"/>
<polygon fill="black" stroke="black" points="918.75,-11461.93 915.25,-11451.93 911.75,-11461.93 918.75,-11461.93"/>
</g>
<!-- layer46_moe_comm_to_expert1 -->
<g id="node2250" class="node">
<title>layer46_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1258" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1258" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1258" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1258" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert1 -->
<g id="edge2890" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3096.76,-11575C2615.74,-11575 1338,-11575 1338,-11575 1338,-11575 1338,-11459.61 1338,-11459.61"/>
<polygon fill="black" stroke="black" points="1341.5,-11459.61 1338,-11449.61 1334.5,-11459.61 1341.5,-11459.61"/>
</g>
<!-- layer46_moe_comm_to_expert2 -->
<g id="node2252" class="node">
<title>layer46_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1567" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1567" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1567" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1567" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert2 -->
<g id="edge2892" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3081.85,-11560C2644.77,-11560 1625.25,-11560 1625.25,-11560 1625.25,-11560 1625.25,-11468.48 1625.25,-11468.48"/>
<polygon fill="black" stroke="black" points="1628.75,-11468.48 1625.25,-11458.48 1621.75,-11468.48 1628.75,-11468.48"/>
</g>
<!-- layer46_moe_comm_to_expert3 -->
<g id="node2254" class="node">
<title>layer46_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1821" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1821" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1821" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1821" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert3 -->
<g id="edge2894" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3066.6,-11545C2681.28,-11545 1901.51,-11545 1901.51,-11545 1901.51,-11545 1901.51,-11459.39 1901.51,-11459.39"/>
<polygon fill="black" stroke="black" points="1905.01,-11459.39 1901.51,-11449.39 1898.01,-11459.39 1905.01,-11459.39"/>
</g>
<!-- layer46_moe_comm_to_expert4 -->
<g id="node2256" class="node">
<title>layer46_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2159" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2159" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2159" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2159" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert4 -->
<g id="edge2896" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3051.67,-11530C2739.78,-11530 2214.5,-11530 2214.5,-11530 2214.5,-11530 2214.5,-11469.26 2214.5,-11469.26"/>
<polygon fill="black" stroke="black" points="2218,-11469.26 2214.5,-11459.26 2211,-11469.26 2218,-11469.26"/>
</g>
<!-- layer46_moe_comm_to_expert5 -->
<g id="node2258" class="node">
<title>layer46_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2578" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2578" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2578" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2578" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert5 -->
<g id="edge2898" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3036.74,-11515C2863.12,-11515 2659.01,-11515 2659.01,-11515 2659.01,-11515 2659.01,-11459.07 2659.01,-11459.07"/>
<polygon fill="black" stroke="black" points="2662.51,-11459.07 2659.01,-11449.07 2655.51,-11459.07 2662.51,-11459.07"/>
</g>
<!-- layer46_moe_comm_to_expert6 -->
<g id="node2260" class="node">
<title>layer46_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2887" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2887" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2887" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2887" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert6 -->
<g id="edge2900" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3036.74,-11552.94C3036.74,-11549.39 3036.74,-11436 3036.74,-11436 3036.74,-11436 2987.56,-11436 2987.56,-11436"/>
<polygon fill="black" stroke="black" points="2987.56,-11432.5 2977.56,-11436 2987.56,-11439.5 2987.56,-11432.5"/>
</g>
<!-- layer46_moe_comm_to_expert7 -->
<g id="node2262" class="node">
<title>layer46_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3141" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3141" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3141" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3141" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert7 -->
<g id="edge2902" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3141,-11500.69C3141,-11500.69 3141,-11475.24 3141,-11475.24"/>
<polygon fill="black" stroke="black" points="3144.5,-11475.24 3141,-11465.24 3137.5,-11475.24 3144.5,-11475.24"/>
</g>
<!-- layer46_moe_comm_to_expert8 -->
<g id="node2264" class="node">
<title>layer46_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3413" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3413" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3413" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3413" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert8 -->
<g id="edge2904" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3413,-11500.69C3413,-11500.69 3413,-11475.24 3413,-11475.24"/>
<polygon fill="black" stroke="black" points="3416.5,-11475.24 3413,-11465.24 3409.5,-11475.24 3416.5,-11475.24"/>
</g>
<!-- layer46_moe_comm_to_expert9 -->
<g id="node2266" class="node">
<title>layer46_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3722" cy="-11436.03" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3722" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3722" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3722" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert9 -->
<g id="edge2906" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3517.26,-11552.94C3517.26,-11549.39 3517.26,-11436 3517.26,-11436 3517.26,-11436 3621.3,-11436 3621.3,-11436"/>
<polygon fill="black" stroke="black" points="3621.3,-11439.5 3631.3,-11436 3621.3,-11432.5 3621.3,-11439.5"/>
</g>
<!-- layer46_moe_comm_to_expert10 -->
<g id="node2268" class="node">
<title>layer46_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4054" cy="-11436.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4054" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4054" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4054" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert10 -->
<g id="edge2908" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3441.38,-11515C3648.6,-11515 3978.1,-11515 3978.1,-11515 3978.1,-11515 3978.1,-11463.17 3978.1,-11463.17"/>
<polygon fill="black" stroke="black" points="3981.6,-11463.17 3978.1,-11453.17 3974.6,-11463.17 3981.6,-11463.17"/>
</g>
<!-- layer46_moe_comm_to_expert11 -->
<g id="node2270" class="node">
<title>layer46_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4400" cy="-11436.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4400" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4400" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4400" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert11 -->
<g id="edge2910" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3456.2,-11530C3755.48,-11530 4324.6,-11530 4324.6,-11530 4324.6,-11530 4324.6,-11463.71 4324.6,-11463.71"/>
<polygon fill="black" stroke="black" points="4328.1,-11463.71 4324.6,-11453.71 4321.1,-11463.71 4328.1,-11463.71"/>
</g>
<!-- layer46_moe_comm_to_expert12 -->
<g id="node2272" class="node">
<title>layer46_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4751" cy="-11436.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4751" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4751" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4751" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert12 -->
<g id="edge2912" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.1,-11545C3855.24,-11545 4675.6,-11545 4675.6,-11545 4675.6,-11545 4675.6,-11463.54 4675.6,-11463.54"/>
<polygon fill="black" stroke="black" points="4679.1,-11463.54 4675.6,-11453.54 4672.1,-11463.54 4679.1,-11463.54"/>
</g>
<!-- layer46_moe_comm_to_expert13 -->
<g id="node2274" class="node">
<title>layer46_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5104" cy="-11436.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5104" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5104" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5104" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert13 -->
<g id="edge2914" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3486.17,-11560C3951,-11560 5029.1,-11560 5029.1,-11560 5029.1,-11560 5029.1,-11463.79 5029.1,-11463.79"/>
<polygon fill="black" stroke="black" points="5032.6,-11463.79 5029.1,-11453.79 5025.6,-11463.79 5032.6,-11463.79"/>
</g>
<!-- layer46_moe_comm_to_expert14 -->
<g id="node2276" class="node">
<title>layer46_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5459" cy="-11436.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5459" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5459" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5459" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert14 -->
<g id="edge2916" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3501.5,-11575C4044.43,-11575 5384.1,-11575 5384.1,-11575 5384.1,-11575 5384.1,-11463.63 5384.1,-11463.63"/>
<polygon fill="black" stroke="black" points="5387.6,-11463.63 5384.1,-11453.63 5380.6,-11463.63 5387.6,-11463.63"/>
</g>
<!-- layer46_moe_comm_to_expert15 -->
<g id="node2278" class="node">
<title>layer46_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5814" cy="-11436.03" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5814" y="-11444.53" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5814" y="-11433.53" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5814" y="-11422.53" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert15 -->
<g id="edge2918" class="edge">
<title>layer46_moe_split&#45;&gt;layer46_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3516.15,-11590C4134.66,-11590 5739.1,-11590 5739.1,-11590 5739.1,-11590 5739.1,-11463.69 5739.1,-11463.69"/>
<polygon fill="black" stroke="black" points="5742.6,-11463.69 5739.1,-11453.69 5735.6,-11463.69 5742.6,-11463.69"/>
</g>
<!-- layer46_moe_expert0 -->
<g id="node2247" class="node">
<title>layer46_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="846,-11371.04 518,-11371.04 518,-11319.04 846,-11319.04 846,-11371.04"/>
<text text-anchor="middle" x="682" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 0 L46</text>
<text text-anchor="middle" x="682" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="682" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="682" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert0 -->
<g id="node2280" class="node">
<title>layer46_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="841" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="841" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="841" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="841" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer46_moe_expert0&#45;&gt;layer46_moe_comm_from_expert0 -->
<g id="edge2920" class="edge">
<title>layer46_moe_expert0&#45;&gt;layer46_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M798.25,-11318.72C798.25,-11318.72 798.25,-11289.68 798.25,-11289.68"/>
<polygon fill="black" stroke="black" points="801.75,-11289.68 798.25,-11279.68 794.75,-11289.68 801.75,-11289.68"/>
</g>
<!-- layer46_moe_comm_to_expert0&#45;&gt;layer46_moe_expert0 -->
<g id="edge2889" class="edge">
<title>layer46_moe_comm_to_expert0&#45;&gt;layer46_moe_expert0</title>
<path fill="none" stroke="black" d="M797.25,-11410.2C797.25,-11410.2 797.25,-11381.25 797.25,-11381.25"/>
<polygon fill="black" stroke="black" points="800.75,-11381.25 797.25,-11371.25 793.75,-11381.25 800.75,-11381.25"/>
</g>
<!-- layer46_moe_expert1 -->
<g id="node2249" class="node">
<title>layer46_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1192,-11371.04 864,-11371.04 864,-11319.04 1192,-11319.04 1192,-11371.04"/>
<text text-anchor="middle" x="1028" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 1 L46</text>
<text text-anchor="middle" x="1028" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1028" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="1028" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert1 -->
<g id="node2281" class="node">
<title>layer46_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1113" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1113" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1113" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1113" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer46_moe_expert1&#45;&gt;layer46_moe_comm_from_expert1 -->
<g id="edge2922" class="edge">
<title>layer46_moe_expert1&#45;&gt;layer46_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1107.25,-11318.72C1107.25,-11318.72 1107.25,-11293.18 1107.25,-11293.18"/>
<polygon fill="black" stroke="black" points="1110.75,-11293.18 1107.25,-11283.18 1103.75,-11293.18 1110.75,-11293.18"/>
</g>
<!-- layer46_moe_comm_to_expert1&#45;&gt;layer46_moe_expert1 -->
<g id="edge2891" class="edge">
<title>layer46_moe_comm_to_expert1&#45;&gt;layer46_moe_expert1</title>
<path fill="none" stroke="black" d="M1179.75,-11421.41C1179.75,-11421.41 1179.75,-11381.37 1179.75,-11381.37"/>
<polygon fill="black" stroke="black" points="1183.25,-11381.37 1179.75,-11371.37 1176.25,-11381.37 1183.25,-11381.37"/>
</g>
<!-- layer46_moe_expert2 -->
<g id="node2251" class="node">
<title>layer46_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1538,-11371.04 1210,-11371.04 1210,-11319.04 1538,-11319.04 1538,-11371.04"/>
<text text-anchor="middle" x="1374" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 2 L46</text>
<text text-anchor="middle" x="1374" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1374" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1374" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert2 -->
<g id="node2282" class="node">
<title>layer46_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1434" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1434" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1434" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1434" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer46_moe_expert2&#45;&gt;layer46_moe_comm_from_expert2 -->
<g id="edge2924" class="edge">
<title>layer46_moe_expert2&#45;&gt;layer46_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1434,-11318.72C1434,-11318.72 1434,-11293.18 1434,-11293.18"/>
<polygon fill="black" stroke="black" points="1437.5,-11293.18 1434,-11283.18 1430.5,-11293.18 1437.5,-11293.18"/>
</g>
<!-- layer46_moe_comm_to_expert2&#45;&gt;layer46_moe_expert2 -->
<g id="edge2893" class="edge">
<title>layer46_moe_comm_to_expert2&#45;&gt;layer46_moe_expert2</title>
<path fill="none" stroke="black" d="M1507.25,-11414C1507.25,-11414 1507.25,-11381.06 1507.25,-11381.06"/>
<polygon fill="black" stroke="black" points="1510.75,-11381.06 1507.25,-11371.06 1503.75,-11381.06 1510.75,-11381.06"/>
</g>
<!-- layer46_moe_expert3 -->
<g id="node2253" class="node">
<title>layer46_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1884,-11371.04 1556,-11371.04 1556,-11319.04 1884,-11319.04 1884,-11371.04"/>
<text text-anchor="middle" x="1720" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 3 L46</text>
<text text-anchor="middle" x="1720" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1720" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1720" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert3 -->
<g id="node2283" class="node">
<title>layer46_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2000" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2000" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2000" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2000" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer46_moe_expert3&#45;&gt;layer46_moe_comm_from_expert3 -->
<g id="edge2926" class="edge">
<title>layer46_moe_expert3&#45;&gt;layer46_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1826.75,-11318.71C1826.75,-11291.82 1826.75,-11254 1826.75,-11254 1826.75,-11254 1899.31,-11254 1899.31,-11254"/>
<polygon fill="black" stroke="black" points="1899.31,-11257.5 1909.31,-11254 1899.31,-11250.5 1899.31,-11257.5"/>
</g>
<!-- layer46_moe_comm_to_expert3&#45;&gt;layer46_moe_expert3 -->
<g id="edge2895" class="edge">
<title>layer46_moe_comm_to_expert3&#45;&gt;layer46_moe_expert3</title>
<path fill="none" stroke="black" d="M1807.25,-11407.24C1807.25,-11407.24 1807.25,-11381.17 1807.25,-11381.17"/>
<polygon fill="black" stroke="black" points="1810.75,-11381.17 1807.25,-11371.17 1803.75,-11381.17 1810.75,-11381.17"/>
</g>
<!-- layer46_moe_expert4 -->
<g id="node2255" class="node">
<title>layer46_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2230,-11371.04 1902,-11371.04 1902,-11319.04 2230,-11319.04 2230,-11371.04"/>
<text text-anchor="middle" x="2066" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 4 L46</text>
<text text-anchor="middle" x="2066" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2066" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2066" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert4 -->
<g id="node2284" class="node">
<title>layer46_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2383" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2383" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2383" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2383" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer46_moe_expert4&#45;&gt;layer46_moe_comm_from_expert4 -->
<g id="edge2928" class="edge">
<title>layer46_moe_expert4&#45;&gt;layer46_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2163.75,-11318.71C2163.75,-11291.82 2163.75,-11254 2163.75,-11254 2163.75,-11254 2282.24,-11254 2282.24,-11254"/>
<polygon fill="black" stroke="black" points="2282.24,-11257.5 2292.24,-11254 2282.24,-11250.5 2282.24,-11257.5"/>
</g>
<!-- layer46_moe_comm_to_expert4&#45;&gt;layer46_moe_expert4 -->
<g id="edge2897" class="edge">
<title>layer46_moe_comm_to_expert4&#45;&gt;layer46_moe_expert4</title>
<path fill="none" stroke="black" d="M2149.25,-11406.99C2149.25,-11406.99 2149.25,-11381.34 2149.25,-11381.34"/>
<polygon fill="black" stroke="black" points="2152.75,-11381.34 2149.25,-11371.34 2145.75,-11381.34 2152.75,-11381.34"/>
</g>
<!-- layer46_moe_expert5 -->
<g id="node2257" class="node">
<title>layer46_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2576,-11371.04 2248,-11371.04 2248,-11319.04 2576,-11319.04 2576,-11371.04"/>
<text text-anchor="middle" x="2412" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 5 L46</text>
<text text-anchor="middle" x="2412" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2412" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2412" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert5 -->
<g id="node2285" class="node">
<title>layer46_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2674" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2674" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2674" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2674" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer46_moe_expert5&#45;&gt;layer46_moe_comm_from_expert5 -->
<g id="edge2930" class="edge">
<title>layer46_moe_expert5&#45;&gt;layer46_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2576.03,-11345C2583.99,-11345 2588.75,-11345 2588.75,-11345 2588.75,-11345 2588.75,-11274.13 2588.75,-11274.13"/>
<polygon fill="black" stroke="black" points="2592.25,-11274.13 2588.75,-11264.13 2585.25,-11274.13 2592.25,-11274.13"/>
</g>
<!-- layer46_moe_comm_to_expert5&#45;&gt;layer46_moe_expert5 -->
<g id="edge2899" class="edge">
<title>layer46_moe_comm_to_expert5&#45;&gt;layer46_moe_expert5</title>
<path fill="none" stroke="black" d="M2531.75,-11410.68C2531.75,-11410.68 2531.75,-11381.2 2531.75,-11381.2"/>
<polygon fill="black" stroke="black" points="2535.25,-11381.2 2531.75,-11371.2 2528.25,-11381.2 2535.25,-11381.2"/>
</g>
<!-- layer46_moe_expert6 -->
<g id="node2259" class="node">
<title>layer46_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2922,-11371.04 2594,-11371.04 2594,-11319.04 2922,-11319.04 2922,-11371.04"/>
<text text-anchor="middle" x="2758" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 6 L46</text>
<text text-anchor="middle" x="2758" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2758" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2758" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert6 -->
<g id="node2286" class="node">
<title>layer46_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2919" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2919" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2919" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2919" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer46_moe_expert6&#45;&gt;layer46_moe_comm_from_expert6 -->
<g id="edge2932" class="edge">
<title>layer46_moe_expert6&#45;&gt;layer46_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2875.25,-11318.72C2875.25,-11318.72 2875.25,-11289.68 2875.25,-11289.68"/>
<polygon fill="black" stroke="black" points="2878.75,-11289.68 2875.25,-11279.68 2871.75,-11289.68 2878.75,-11289.68"/>
</g>
<!-- layer46_moe_comm_to_expert6&#45;&gt;layer46_moe_expert6 -->
<g id="edge2901" class="edge">
<title>layer46_moe_comm_to_expert6&#45;&gt;layer46_moe_expert6</title>
<path fill="none" stroke="black" d="M2859.25,-11408.24C2859.25,-11408.24 2859.25,-11381.11 2859.25,-11381.11"/>
<polygon fill="black" stroke="black" points="2862.75,-11381.11 2859.25,-11371.11 2855.75,-11381.11 2862.75,-11381.11"/>
</g>
<!-- layer46_moe_expert7 -->
<g id="node2261" class="node">
<title>layer46_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3268,-11371.04 2940,-11371.04 2940,-11319.04 3268,-11319.04 3268,-11371.04"/>
<text text-anchor="middle" x="3104" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 7 L46</text>
<text text-anchor="middle" x="3104" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3104" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3104" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert7 -->
<g id="node2287" class="node">
<title>layer46_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3141" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3141" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3141" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3141" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer46_moe_expert7&#45;&gt;layer46_moe_comm_from_expert7 -->
<g id="edge2934" class="edge">
<title>layer46_moe_expert7&#45;&gt;layer46_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3141,-11318.72C3141,-11318.72 3141,-11293.18 3141,-11293.18"/>
<polygon fill="black" stroke="black" points="3144.5,-11293.18 3141,-11283.18 3137.5,-11293.18 3144.5,-11293.18"/>
</g>
<!-- layer46_moe_comm_to_expert7&#45;&gt;layer46_moe_expert7 -->
<g id="edge2903" class="edge">
<title>layer46_moe_comm_to_expert7&#45;&gt;layer46_moe_expert7</title>
<path fill="none" stroke="black" d="M3141,-11406.99C3141,-11406.99 3141,-11381.34 3141,-11381.34"/>
<polygon fill="black" stroke="black" points="3144.5,-11381.34 3141,-11371.34 3137.5,-11381.34 3144.5,-11381.34"/>
</g>
<!-- layer46_moe_expert8 -->
<g id="node2263" class="node">
<title>layer46_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3614,-11371.04 3286,-11371.04 3286,-11319.04 3614,-11319.04 3614,-11371.04"/>
<text text-anchor="middle" x="3450" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 8 L46</text>
<text text-anchor="middle" x="3450" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3450" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3450" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert8 -->
<g id="node2288" class="node">
<title>layer46_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3413" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3413" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3413" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3413" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer46_moe_expert8&#45;&gt;layer46_moe_comm_from_expert8 -->
<g id="edge2936" class="edge">
<title>layer46_moe_expert8&#45;&gt;layer46_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3413,-11318.72C3413,-11318.72 3413,-11293.18 3413,-11293.18"/>
<polygon fill="black" stroke="black" points="3416.5,-11293.18 3413,-11283.18 3409.5,-11293.18 3416.5,-11293.18"/>
</g>
<!-- layer46_moe_comm_to_expert8&#45;&gt;layer46_moe_expert8 -->
<g id="edge2905" class="edge">
<title>layer46_moe_comm_to_expert8&#45;&gt;layer46_moe_expert8</title>
<path fill="none" stroke="black" d="M3413,-11406.99C3413,-11406.99 3413,-11381.34 3413,-11381.34"/>
<polygon fill="black" stroke="black" points="3416.5,-11381.34 3413,-11371.34 3409.5,-11381.34 3416.5,-11381.34"/>
</g>
<!-- layer46_moe_expert9 -->
<g id="node2265" class="node">
<title>layer46_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3960,-11371.04 3632,-11371.04 3632,-11319.04 3960,-11319.04 3960,-11371.04"/>
<text text-anchor="middle" x="3796" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 9 L46</text>
<text text-anchor="middle" x="3796" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3796" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3796" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert9 -->
<g id="node2289" class="node">
<title>layer46_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3722" cy="-11254.05" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3722" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3722" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3722" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer46_moe_expert9&#45;&gt;layer46_moe_comm_from_expert9 -->
<g id="edge2938" class="edge">
<title>layer46_moe_expert9&#45;&gt;layer46_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3722.25,-11318.72C3722.25,-11318.72 3722.25,-11293.18 3722.25,-11293.18"/>
<polygon fill="black" stroke="black" points="3725.75,-11293.18 3722.25,-11283.18 3718.75,-11293.18 3725.75,-11293.18"/>
</g>
<!-- layer46_moe_comm_to_expert9&#45;&gt;layer46_moe_expert9 -->
<g id="edge2907" class="edge">
<title>layer46_moe_comm_to_expert9&#45;&gt;layer46_moe_expert9</title>
<path fill="none" stroke="black" d="M3722.25,-11406.99C3722.25,-11406.99 3722.25,-11381.34 3722.25,-11381.34"/>
<polygon fill="black" stroke="black" points="3725.75,-11381.34 3722.25,-11371.34 3718.75,-11381.34 3725.75,-11381.34"/>
</g>
<!-- layer46_moe_expert10 -->
<g id="node2267" class="node">
<title>layer46_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4316,-11371.04 3978,-11371.04 3978,-11319.04 4316,-11319.04 4316,-11371.04"/>
<text text-anchor="middle" x="4147" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 10 L46</text>
<text text-anchor="middle" x="4147" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4147" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4147" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert10 -->
<g id="node2290" class="node">
<title>layer46_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4054" cy="-11254.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4054" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4054" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4054" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer46_moe_expert10&#45;&gt;layer46_moe_comm_from_expert10 -->
<g id="edge2940" class="edge">
<title>layer46_moe_expert10&#45;&gt;layer46_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4063.38,-11318.72C4063.38,-11318.72 4063.38,-11293.18 4063.38,-11293.18"/>
<polygon fill="black" stroke="black" points="4066.88,-11293.18 4063.38,-11283.18 4059.88,-11293.18 4066.88,-11293.18"/>
</g>
<!-- layer46_moe_comm_to_expert10&#45;&gt;layer46_moe_expert10 -->
<g id="edge2909" class="edge">
<title>layer46_moe_comm_to_expert10&#45;&gt;layer46_moe_expert10</title>
<path fill="none" stroke="black" d="M4063.02,-11406.99C4063.02,-11406.99 4063.02,-11381.34 4063.02,-11381.34"/>
<polygon fill="black" stroke="black" points="4066.52,-11381.34 4063.02,-11371.34 4059.52,-11381.34 4066.52,-11381.34"/>
</g>
<!-- layer46_moe_expert11 -->
<g id="node2269" class="node">
<title>layer46_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4672,-11371.04 4334,-11371.04 4334,-11319.04 4672,-11319.04 4672,-11371.04"/>
<text text-anchor="middle" x="4503" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 11 L46</text>
<text text-anchor="middle" x="4503" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4503" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4503" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert11 -->
<g id="node2291" class="node">
<title>layer46_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4401" cy="-11254.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4401" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4401" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4401" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer46_moe_expert11&#45;&gt;layer46_moe_comm_from_expert11 -->
<g id="edge2942" class="edge">
<title>layer46_moe_expert11&#45;&gt;layer46_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4414.88,-11318.72C4414.88,-11318.72 4414.88,-11292.86 4414.88,-11292.86"/>
<polygon fill="black" stroke="black" points="4418.38,-11292.86 4414.88,-11282.86 4411.38,-11292.86 4418.38,-11292.86"/>
</g>
<!-- layer46_moe_comm_to_expert11&#45;&gt;layer46_moe_expert11 -->
<g id="edge2911" class="edge">
<title>layer46_moe_comm_to_expert11&#45;&gt;layer46_moe_expert11</title>
<path fill="none" stroke="black" d="M4414.02,-11407.24C4414.02,-11407.24 4414.02,-11381.17 4414.02,-11381.17"/>
<polygon fill="black" stroke="black" points="4417.52,-11381.17 4414.02,-11371.17 4410.52,-11381.17 4417.52,-11381.17"/>
</g>
<!-- layer46_moe_expert12 -->
<g id="node2271" class="node">
<title>layer46_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="5028,-11371.04 4690,-11371.04 4690,-11319.04 5028,-11319.04 5028,-11371.04"/>
<text text-anchor="middle" x="4859" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 12 L46</text>
<text text-anchor="middle" x="4859" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4859" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4859" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert12 -->
<g id="node2292" class="node">
<title>layer46_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4752" cy="-11254.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4752" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4752" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4752" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer46_moe_expert12&#45;&gt;layer46_moe_comm_from_expert12 -->
<g id="edge2944" class="edge">
<title>layer46_moe_expert12&#45;&gt;layer46_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4768.38,-11318.72C4768.38,-11318.72 4768.38,-11292.86 4768.38,-11292.86"/>
<polygon fill="black" stroke="black" points="4771.88,-11292.86 4768.38,-11282.86 4764.88,-11292.86 4771.88,-11292.86"/>
</g>
<!-- layer46_moe_comm_to_expert12&#45;&gt;layer46_moe_expert12 -->
<g id="edge2913" class="edge">
<title>layer46_moe_comm_to_expert12&#45;&gt;layer46_moe_expert12</title>
<path fill="none" stroke="black" d="M4767.52,-11407.24C4767.52,-11407.24 4767.52,-11381.17 4767.52,-11381.17"/>
<polygon fill="black" stroke="black" points="4771.02,-11381.17 4767.52,-11371.17 4764.02,-11381.17 4771.02,-11381.17"/>
</g>
<!-- layer46_moe_expert13 -->
<g id="node2273" class="node">
<title>layer46_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5384,-11371.04 5046,-11371.04 5046,-11319.04 5384,-11319.04 5384,-11371.04"/>
<text text-anchor="middle" x="5215" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 13 L46</text>
<text text-anchor="middle" x="5215" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5215" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5215" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert13 -->
<g id="node2293" class="node">
<title>layer46_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5106" cy="-11254.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5106" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5106" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5106" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer46_moe_expert13&#45;&gt;layer46_moe_comm_from_expert13 -->
<g id="edge2946" class="edge">
<title>layer46_moe_expert13&#45;&gt;layer46_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5123.38,-11318.72C5123.38,-11318.72 5123.38,-11292.86 5123.38,-11292.86"/>
<polygon fill="black" stroke="black" points="5126.88,-11292.86 5123.38,-11282.86 5119.88,-11292.86 5126.88,-11292.86"/>
</g>
<!-- layer46_moe_comm_to_expert13&#45;&gt;layer46_moe_expert13 -->
<g id="edge2915" class="edge">
<title>layer46_moe_comm_to_expert13&#45;&gt;layer46_moe_expert13</title>
<path fill="none" stroke="black" d="M5122.02,-11407.24C5122.02,-11407.24 5122.02,-11381.17 5122.02,-11381.17"/>
<polygon fill="black" stroke="black" points="5125.52,-11381.17 5122.02,-11371.17 5118.52,-11381.17 5125.52,-11381.17"/>
</g>
<!-- layer46_moe_expert14 -->
<g id="node2275" class="node">
<title>layer46_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5740,-11371.04 5402,-11371.04 5402,-11319.04 5740,-11319.04 5740,-11371.04"/>
<text text-anchor="middle" x="5571" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 14 L46</text>
<text text-anchor="middle" x="5571" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5571" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5571" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert14 -->
<g id="node2294" class="node">
<title>layer46_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5461" cy="-11254.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5461" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5461" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5461" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer46_moe_expert14&#45;&gt;layer46_moe_comm_from_expert14 -->
<g id="edge2948" class="edge">
<title>layer46_moe_expert14&#45;&gt;layer46_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5478.88,-11318.72C5478.88,-11318.72 5478.88,-11292.53 5478.88,-11292.53"/>
<polygon fill="black" stroke="black" points="5482.38,-11292.53 5478.88,-11282.53 5475.38,-11292.53 5482.38,-11292.53"/>
</g>
<!-- layer46_moe_comm_to_expert14&#45;&gt;layer46_moe_expert14 -->
<g id="edge2917" class="edge">
<title>layer46_moe_comm_to_expert14&#45;&gt;layer46_moe_expert14</title>
<path fill="none" stroke="black" d="M5477.52,-11407.24C5477.52,-11407.24 5477.52,-11381.17 5477.52,-11381.17"/>
<polygon fill="black" stroke="black" points="5481.02,-11381.17 5477.52,-11371.17 5474.02,-11381.17 5481.02,-11381.17"/>
</g>
<!-- layer46_moe_expert15 -->
<g id="node2277" class="node">
<title>layer46_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6096,-11371.04 5758,-11371.04 5758,-11319.04 6096,-11319.04 6096,-11371.04"/>
<text text-anchor="middle" x="5927" y="-11359.04" font-family="Arial" font-size="10.00">EXPERT 15 L46</text>
<text text-anchor="middle" x="5927" y="-11348.04" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5927" y="-11337.04" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5927" y="-11326.04" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_comm_from_expert15 -->
<g id="node2295" class="node">
<title>layer46_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5816" cy="-11254.05" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5816" y="-11262.55" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5816" y="-11251.55" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5816" y="-11240.55" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer46_moe_expert15&#45;&gt;layer46_moe_comm_from_expert15 -->
<g id="edge2950" class="edge">
<title>layer46_moe_expert15&#45;&gt;layer46_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5834.38,-11318.72C5834.38,-11318.72 5834.38,-11292.53 5834.38,-11292.53"/>
<polygon fill="black" stroke="black" points="5837.88,-11292.53 5834.38,-11282.53 5830.88,-11292.53 5837.88,-11292.53"/>
</g>
<!-- layer46_moe_comm_to_expert15&#45;&gt;layer46_moe_expert15 -->
<g id="edge2919" class="edge">
<title>layer46_moe_comm_to_expert15&#45;&gt;layer46_moe_expert15</title>
<path fill="none" stroke="black" d="M5833.02,-11407.24C5833.02,-11407.24 5833.02,-11381.17 5833.02,-11381.17"/>
<polygon fill="black" stroke="black" points="5836.52,-11381.17 5833.02,-11371.17 5829.52,-11381.17 5836.52,-11381.17"/>
</g>
<!-- layer46_moe_aggregate -->
<g id="node2279" class="node">
<title>layer46_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3502.1,-11189.06 3085.16,-11189.06 2977.9,-11085.06 3394.84,-11085.06 3502.1,-11189.06"/>
<text text-anchor="middle" x="3240" y="-11151.06" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L46</text>
<text text-anchor="middle" x="3240" y="-11140.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3240" y="-11129.06" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3240" y="-11118.06" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_mha -->
<g id="node2296" class="node">
<title>layer47_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3370,-11049.06 3110,-11049.06 3110,-10997.06 3370,-10997.06 3370,-11049.06"/>
<text text-anchor="middle" x="3240" y="-11037.06" font-family="Arial" font-size="10.00">MHA L47</text>
<text text-anchor="middle" x="3240" y="-11026.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3240" y="-11015.06" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3240" y="-11004.06" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer46_moe_aggregate&#45;&gt;layer47_moe_mha -->
<g id="edge3019" class="edge">
<title>layer46_moe_aggregate&#45;&gt;layer47_moe_mha</title>
<path fill="none" stroke="black" d="M3240,-11084.73C3240,-11084.73 3240,-11059.28 3240,-11059.28"/>
<polygon fill="black" stroke="black" points="3243.5,-11059.28 3240,-11049.28 3236.5,-11059.28 3243.5,-11059.28"/>
</g>
<!-- layer46_moe_comm_from_expert0&#45;&gt;layer46_moe_aggregate -->
<g id="edge2921" class="edge">
<title>layer46_moe_comm_from_expert0&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M879.25,-11227.75C879.25,-11183.51 879.25,-11099 879.25,-11099 879.25,-11099 2982.1,-11099 2982.1,-11099"/>
<polygon fill="black" stroke="black" points="2982.1,-11102.5 2992.1,-11099 2982.1,-11095.5 2982.1,-11102.5"/>
</g>
<!-- layer46_moe_comm_from_expert1&#45;&gt;layer46_moe_aggregate -->
<g id="edge2923" class="edge">
<title>layer46_moe_comm_from_expert1&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M1136,-11225.71C1136,-11184.78 1136,-11114 1136,-11114 1136,-11114 2997.55,-11114 2997.55,-11114"/>
<polygon fill="black" stroke="black" points="2997.55,-11117.5 3007.55,-11114 2997.55,-11110.5 2997.55,-11117.5"/>
</g>
<!-- layer46_moe_comm_from_expert2&#45;&gt;layer46_moe_aggregate -->
<g id="edge2925" class="edge">
<title>layer46_moe_comm_from_expert2&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M1507,-11236.66C1507,-11202.3 1507,-11129 1507,-11129 1507,-11129 3013.14,-11129 3013.14,-11129"/>
<polygon fill="black" stroke="black" points="3013.14,-11132.5 3023.14,-11129 3013.14,-11125.5 3013.14,-11132.5"/>
</g>
<!-- layer46_moe_comm_from_expert3&#45;&gt;layer46_moe_aggregate -->
<g id="edge2927" class="edge">
<title>layer46_moe_comm_from_expert3&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M2020.51,-11225.71C2020.51,-11193.1 2020.51,-11144 2020.51,-11144 2020.51,-11144 3028.63,-11144 3028.63,-11144"/>
<polygon fill="black" stroke="black" points="3028.63,-11147.5 3038.63,-11144 3028.63,-11140.5 3028.63,-11147.5"/>
</g>
<!-- layer46_moe_comm_from_expert4&#45;&gt;layer46_moe_aggregate -->
<g id="edge2929" class="edge">
<title>layer46_moe_comm_from_expert4&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M2417,-11227.07C2417,-11198.96 2417,-11159 2417,-11159 2417,-11159 3044.02,-11159 3044.02,-11159"/>
<polygon fill="black" stroke="black" points="3044.02,-11162.5 3054.02,-11159 3044.02,-11155.5 3044.02,-11162.5"/>
</g>
<!-- layer46_moe_comm_from_expert5&#45;&gt;layer46_moe_aggregate -->
<g id="edge2931" class="edge">
<title>layer46_moe_comm_from_expert5&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M2678,-11224.7C2678,-11201.85 2678,-11174 2678,-11174 2678,-11174 3059.47,-11174 3059.47,-11174"/>
<polygon fill="black" stroke="black" points="3059.47,-11177.5 3069.47,-11174 3059.47,-11170.5 3059.47,-11177.5"/>
</g>
<!-- layer46_moe_comm_from_expert6&#45;&gt;layer46_moe_aggregate -->
<g id="edge2933" class="edge">
<title>layer46_moe_comm_from_expert6&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M2993.61,-11237.53C2993.61,-11237.53 2993.61,-11147.11 2993.61,-11147.11"/>
<polygon fill="black" stroke="black" points="2997.11,-11147.11 2993.61,-11137.11 2990.11,-11147.11 2997.11,-11147.11"/>
</g>
<!-- layer46_moe_comm_from_expert7&#45;&gt;layer46_moe_aggregate -->
<g id="edge2935" class="edge">
<title>layer46_moe_comm_from_expert7&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M3141,-11224.83C3141,-11224.83 3141,-11199.12 3141,-11199.12"/>
<polygon fill="black" stroke="black" points="3144.5,-11199.12 3141,-11189.12 3137.5,-11199.12 3144.5,-11199.12"/>
</g>
<!-- layer46_moe_comm_from_expert8&#45;&gt;layer46_moe_aggregate -->
<g id="edge2937" class="edge">
<title>layer46_moe_comm_from_expert8&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M3412.39,-11224.83C3412.39,-11224.83 3412.39,-11199.12 3412.39,-11199.12"/>
<polygon fill="black" stroke="black" points="3415.89,-11199.12 3412.39,-11189.12 3408.89,-11199.12 3415.89,-11199.12"/>
</g>
<!-- layer46_moe_comm_from_expert9&#45;&gt;layer46_moe_aggregate -->
<g id="edge2939" class="edge">
<title>layer46_moe_comm_from_expert9&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M3703.5,-11225.43C3703.5,-11203.15 3703.5,-11176 3703.5,-11176 3703.5,-11176 3498.71,-11176 3498.71,-11176"/>
<polygon fill="black" stroke="black" points="3498.71,-11172.5 3488.71,-11176 3498.71,-11179.5 3498.71,-11172.5"/>
</g>
<!-- layer46_moe_comm_from_expert10&#45;&gt;layer46_moe_aggregate -->
<g id="edge2941" class="edge">
<title>layer46_moe_comm_from_expert10&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M4035.15,-11225.24C4035.15,-11198.57 4035.15,-11163 4035.15,-11163 4035.15,-11163 3485.34,-11163 3485.34,-11163"/>
<polygon fill="black" stroke="black" points="3485.34,-11159.5 3475.34,-11163 3485.34,-11166.5 3485.34,-11159.5"/>
</g>
<!-- layer46_moe_comm_from_expert11&#45;&gt;layer46_moe_aggregate -->
<g id="edge2943" class="edge">
<title>layer46_moe_comm_from_expert11&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M4381.65,-11225.62C4381.65,-11194.81 4381.65,-11150 4381.65,-11150 4381.65,-11150 3472.15,-11150 3472.15,-11150"/>
<polygon fill="black" stroke="black" points="3472.15,-11146.5 3462.15,-11150 3472.15,-11153.5 3472.15,-11146.5"/>
</g>
<!-- layer46_moe_comm_from_expert12&#45;&gt;layer46_moe_aggregate -->
<g id="edge2945" class="edge">
<title>layer46_moe_comm_from_expert12&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M4732.65,-11225.41C4732.65,-11190.76 4732.65,-11137 4732.65,-11137 4732.65,-11137 3458.72,-11137 3458.72,-11137"/>
<polygon fill="black" stroke="black" points="3458.72,-11133.5 3448.72,-11137 3458.72,-11140.5 3458.72,-11133.5"/>
</g>
<!-- layer46_moe_comm_from_expert13&#45;&gt;layer46_moe_aggregate -->
<g id="edge2947" class="edge">
<title>layer46_moe_comm_from_expert13&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M5086.15,-11225.51C5086.15,-11187.23 5086.15,-11124 5086.15,-11124 5086.15,-11124 3445.39,-11124 3445.39,-11124"/>
<polygon fill="black" stroke="black" points="3445.39,-11120.5 3435.39,-11124 3445.39,-11127.5 3445.39,-11120.5"/>
</g>
<!-- layer46_moe_comm_from_expert14&#45;&gt;layer46_moe_aggregate -->
<g id="edge2949" class="edge">
<title>layer46_moe_comm_from_expert14&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M5441.15,-11225.44C5441.15,-11183.7 5441.15,-11111 5441.15,-11111 5441.15,-11111 3432,-11111 3432,-11111"/>
<polygon fill="black" stroke="black" points="3432,-11107.5 3422,-11111 3432,-11114.5 3432,-11107.5"/>
</g>
<!-- layer46_moe_comm_from_expert15&#45;&gt;layer46_moe_aggregate -->
<g id="edge2951" class="edge">
<title>layer46_moe_comm_from_expert15&#45;&gt;layer46_moe_aggregate</title>
<path fill="none" stroke="black" d="M5796.15,-11225.43C5796.15,-11180.38 5796.15,-11098 5796.15,-11098 5796.15,-11098 3418.21,-11098 3418.21,-11098"/>
<polygon fill="black" stroke="black" points="3418.21,-11094.5 3408.21,-11098 3418.21,-11101.5 3418.21,-11094.5"/>
</g>
<!-- layer47_moe_gate -->
<g id="node2297" class="node">
<title>layer47_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3498.3,-10961.06 3087.4,-10961.06 2981.7,-10857.06 3392.6,-10857.06 3498.3,-10961.06"/>
<text text-anchor="middle" x="3240" y="-10923.06" font-family="Arial" font-size="10.00">GATE L47</text>
<text text-anchor="middle" x="3240" y="-10912.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3240" y="-10901.06" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3240" y="-10890.06" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer47_moe_mha&#45;&gt;layer47_moe_gate -->
<g id="edge3020" class="edge">
<title>layer47_moe_mha&#45;&gt;layer47_moe_gate</title>
<path fill="none" stroke="black" d="M3240,-10996.9C3240,-10996.9 3240,-10971.15 3240,-10971.15"/>
<polygon fill="black" stroke="black" points="3243.5,-10971.15 3240,-10961.15 3236.5,-10971.15 3243.5,-10971.15"/>
</g>
<!-- layer47_moe_split -->
<g id="node2298" class="node">
<title>layer47_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3494.01,-10821.06 3089.94,-10821.06 2985.99,-10717.06 3390.06,-10717.06 3494.01,-10821.06"/>
<text text-anchor="middle" x="3240" y="-10783.06" font-family="Arial" font-size="10.00">SPLIT TOKENS L47</text>
<text text-anchor="middle" x="3240" y="-10772.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3240" y="-10761.06" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3240" y="-10750.06" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer47_moe_gate&#45;&gt;layer47_moe_split -->
<g id="edge3021" class="edge">
<title>layer47_moe_gate&#45;&gt;layer47_moe_split</title>
<path fill="none" stroke="black" d="M3240,-10856.93C3240,-10856.93 3240,-10831.23 3240,-10831.23"/>
<polygon fill="black" stroke="black" points="3243.5,-10831.23 3240,-10821.23 3236.5,-10831.23 3243.5,-10831.23"/>
</g>
<!-- layer47_moe_comm_to_expert0 -->
<g id="node2300" class="node">
<title>layer47_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1159" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1159" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1159" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1159" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert0 -->
<g id="edge2955" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3074.64,-10806C2593.77,-10806 1229.75,-10806 1229.75,-10806 1229.75,-10806 1229.75,-10680.33 1229.75,-10680.33"/>
<polygon fill="black" stroke="black" points="1233.25,-10680.33 1229.75,-10670.33 1226.25,-10680.33 1233.25,-10680.33"/>
</g>
<!-- layer47_moe_comm_to_expert1 -->
<g id="node2302" class="node">
<title>layer47_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1404" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1404" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1404" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1404" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert1 -->
<g id="edge2957" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3059.58,-10791C2599.57,-10791 1419,-10791 1419,-10791 1419,-10791 1419,-10690.85 1419,-10690.85"/>
<polygon fill="black" stroke="black" points="1422.5,-10690.85 1419,-10680.85 1415.5,-10690.85 1422.5,-10690.85"/>
</g>
<!-- layer47_moe_comm_to_expert2 -->
<g id="node2304" class="node">
<title>layer47_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1860" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1860" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1860" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1860" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert2 -->
<g id="edge2959" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3044.59,-10776C2679.4,-10776 1930,-10776 1930,-10776 1930,-10776 1930,-10680.62 1930,-10680.62"/>
<polygon fill="black" stroke="black" points="1933.5,-10680.62 1930,-10670.62 1926.5,-10680.62 1933.5,-10680.62"/>
</g>
<!-- layer47_moe_comm_to_expert3 -->
<g id="node2306" class="node">
<title>layer47_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2188" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2188" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2188" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2188" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert3 -->
<g id="edge2961" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3029.86,-10761C2742.8,-10761 2263.25,-10761 2263.25,-10761 2263.25,-10761 2263.25,-10678.61 2263.25,-10678.61"/>
<polygon fill="black" stroke="black" points="2266.75,-10678.61 2263.25,-10668.61 2259.75,-10678.61 2266.75,-10678.61"/>
</g>
<!-- layer47_moe_comm_to_expert4 -->
<g id="node2308" class="node">
<title>layer47_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2451" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2451" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2451" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2451" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert4 -->
<g id="edge2963" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3014.75,-10746C2799.48,-10746 2507.51,-10746 2507.51,-10746 2507.51,-10746 2507.51,-10684.8 2507.51,-10684.8"/>
<polygon fill="black" stroke="black" points="2511.01,-10684.8 2507.51,-10674.8 2504.01,-10684.8 2511.01,-10684.8"/>
</g>
<!-- layer47_moe_comm_to_expert5 -->
<g id="node2310" class="node">
<title>layer47_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2682" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2682" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2682" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2682" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert5 -->
<g id="edge2965" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2999.77,-10731C2883.41,-10731 2768.51,-10731 2768.51,-10731 2768.51,-10731 2768.51,-10670.81 2768.51,-10670.81"/>
<polygon fill="black" stroke="black" points="2772.01,-10670.81 2768.51,-10660.81 2765.01,-10670.81 2772.01,-10670.81"/>
</g>
<!-- layer47_moe_comm_to_expert6 -->
<g id="node2312" class="node">
<title>layer47_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2897" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2897" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2897" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2897" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert6 -->
<g id="edge2967" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3000.5,-10768.97C3000.5,-10765.43 3000.5,-10652 3000.5,-10652 3000.5,-10652 2997.81,-10652 2997.81,-10652"/>
<polygon fill="black" stroke="black" points="2997.81,-10648.5 2987.81,-10652 2997.81,-10655.5 2997.81,-10648.5"/>
</g>
<!-- layer47_moe_comm_to_expert7 -->
<g id="node2314" class="node">
<title>layer47_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3104" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3104" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3104" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3104" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert7 -->
<g id="edge2969" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3104,-10716.72C3104,-10716.72 3104,-10691.28 3104,-10691.28"/>
<polygon fill="black" stroke="black" points="3107.5,-10691.28 3104,-10681.28 3100.5,-10691.28 3107.5,-10691.28"/>
</g>
<!-- layer47_moe_comm_to_expert8 -->
<g id="node2316" class="node">
<title>layer47_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3376" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3376" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3376" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3376" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert8 -->
<g id="edge2971" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3376,-10716.72C3376,-10716.72 3376,-10691.28 3376,-10691.28"/>
<polygon fill="black" stroke="black" points="3379.5,-10691.28 3376,-10681.28 3372.5,-10691.28 3379.5,-10691.28"/>
</g>
<!-- layer47_moe_comm_to_expert9 -->
<g id="node2318" class="node">
<title>layer47_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3685" cy="-10652.06" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3685" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3685" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3685" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert9 -->
<g id="edge2973" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3480.26,-10768.97C3480.26,-10765.43 3480.26,-10652 3480.26,-10652 3480.26,-10652 3584.3,-10652 3584.3,-10652"/>
<polygon fill="black" stroke="black" points="3584.3,-10655.5 3594.3,-10652 3584.3,-10648.5 3584.3,-10655.5"/>
</g>
<!-- layer47_moe_comm_to_expert10 -->
<g id="node2320" class="node">
<title>layer47_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4017" cy="-10652.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4017" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="4017" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4017" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert10 -->
<g id="edge2975" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3404.38,-10731C3611.6,-10731 3941.1,-10731 3941.1,-10731 3941.1,-10731 3941.1,-10679.19 3941.1,-10679.19"/>
<polygon fill="black" stroke="black" points="3944.6,-10679.19 3941.1,-10669.19 3937.6,-10679.19 3944.6,-10679.19"/>
</g>
<!-- layer47_moe_comm_to_expert11 -->
<g id="node2322" class="node">
<title>layer47_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4363" cy="-10652.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4363" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4363" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4363" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert11 -->
<g id="edge2977" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3419.2,-10746C3718.48,-10746 4287.6,-10746 4287.6,-10746 4287.6,-10746 4287.6,-10679.73 4287.6,-10679.73"/>
<polygon fill="black" stroke="black" points="4291.1,-10679.73 4287.6,-10669.73 4284.1,-10679.73 4291.1,-10679.73"/>
</g>
<!-- layer47_moe_comm_to_expert12 -->
<g id="node2324" class="node">
<title>layer47_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4714" cy="-10652.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4714" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4714" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4714" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert12 -->
<g id="edge2979" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3434.1,-10761C3818.24,-10761 4638.6,-10761 4638.6,-10761 4638.6,-10761 4638.6,-10679.57 4638.6,-10679.57"/>
<polygon fill="black" stroke="black" points="4642.1,-10679.57 4638.6,-10669.57 4635.1,-10679.57 4642.1,-10679.57"/>
</g>
<!-- layer47_moe_comm_to_expert13 -->
<g id="node2326" class="node">
<title>layer47_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5067" cy="-10652.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5067" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5067" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5067" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert13 -->
<g id="edge2981" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3449.17,-10776C3914,-10776 4992.1,-10776 4992.1,-10776 4992.1,-10776 4992.1,-10679.82 4992.1,-10679.82"/>
<polygon fill="black" stroke="black" points="4995.6,-10679.82 4992.1,-10669.82 4988.6,-10679.82 4995.6,-10679.82"/>
</g>
<!-- layer47_moe_comm_to_expert14 -->
<g id="node2328" class="node">
<title>layer47_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5422" cy="-10652.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5422" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5422" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5422" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert14 -->
<g id="edge2983" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3464,-10791C4006.61,-10791 5347.1,-10791 5347.1,-10791 5347.1,-10791 5347.1,-10679.66 5347.1,-10679.66"/>
<polygon fill="black" stroke="black" points="5350.6,-10679.66 5347.1,-10669.66 5343.6,-10679.66 5350.6,-10679.66"/>
</g>
<!-- layer47_moe_comm_to_expert15 -->
<g id="node2330" class="node">
<title>layer47_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5777" cy="-10652.06" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5777" y="-10660.56" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5777" y="-10649.56" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5777" y="-10638.56" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert15 -->
<g id="edge2985" class="edge">
<title>layer47_moe_split&#45;&gt;layer47_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3479.15,-10806C4097.66,-10806 5702.1,-10806 5702.1,-10806 5702.1,-10806 5702.1,-10679.72 5702.1,-10679.72"/>
<polygon fill="black" stroke="black" points="5705.6,-10679.72 5702.1,-10669.72 5698.6,-10679.72 5705.6,-10679.72"/>
</g>
<!-- layer47_moe_expert0 -->
<g id="node2299" class="node">
<title>layer47_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="809,-10587.07 481,-10587.07 481,-10535.07 809,-10535.07 809,-10587.07"/>
<text text-anchor="middle" x="645" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 0 L47</text>
<text text-anchor="middle" x="645" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="645" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="645" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert0 -->
<g id="node2332" class="node">
<title>layer47_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="778" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="778" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="778" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="778" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer47_moe_expert0&#45;&gt;layer47_moe_comm_from_expert0 -->
<g id="edge2987" class="edge">
<title>layer47_moe_expert0&#45;&gt;layer47_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M748.25,-10534.76C748.25,-10534.76 748.25,-10507.61 748.25,-10507.61"/>
<polygon fill="black" stroke="black" points="751.75,-10507.61 748.25,-10497.61 744.75,-10507.61 751.75,-10507.61"/>
</g>
<!-- layer47_moe_comm_to_expert0&#45;&gt;layer47_moe_expert0 -->
<g id="edge2956" class="edge">
<title>layer47_moe_comm_to_expert0&#45;&gt;layer47_moe_expert0</title>
<path fill="none" stroke="black" d="M1068.16,-10652C955.96,-10652 779.75,-10652 779.75,-10652 779.75,-10652 779.75,-10597.37 779.75,-10597.37"/>
<polygon fill="black" stroke="black" points="783.25,-10597.37 779.75,-10587.37 776.25,-10597.37 783.25,-10597.37"/>
</g>
<!-- layer47_moe_expert1 -->
<g id="node2301" class="node">
<title>layer47_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1155,-10587.07 827,-10587.07 827,-10535.07 1155,-10535.07 1155,-10587.07"/>
<text text-anchor="middle" x="991" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 1 L47</text>
<text text-anchor="middle" x="991" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="991" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="991" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert1 -->
<g id="node2333" class="node">
<title>layer47_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1344" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1344" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1344" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1344" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer47_moe_expert1&#45;&gt;layer47_moe_comm_from_expert1 -->
<g id="edge2989" class="edge">
<title>layer47_moe_expert1&#45;&gt;layer47_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1145.5,-10534.73C1145.5,-10507.83 1145.5,-10470 1145.5,-10470 1145.5,-10470 1243.46,-10470 1243.46,-10470"/>
<polygon fill="black" stroke="black" points="1243.46,-10473.5 1253.46,-10470 1243.46,-10466.5 1243.46,-10473.5"/>
</g>
<!-- layer47_moe_comm_to_expert1&#45;&gt;layer47_moe_expert1 -->
<g id="edge2958" class="edge">
<title>layer47_moe_comm_to_expert1&#45;&gt;layer47_moe_expert1</title>
<path fill="none" stroke="black" d="M1404,-10623.05C1404,-10609.37 1404,-10596 1404,-10596 1404,-10596 1111.75,-10596 1111.75,-10596 1111.75,-10596 1111.75,-10595.12 1111.75,-10595.12"/>
<polygon fill="black" stroke="black" points="1115.25,-10597.19 1111.75,-10587.19 1108.25,-10597.19 1115.25,-10597.19"/>
</g>
<!-- layer47_moe_expert2 -->
<g id="node2303" class="node">
<title>layer47_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1501,-10587.07 1173,-10587.07 1173,-10535.07 1501,-10535.07 1501,-10587.07"/>
<text text-anchor="middle" x="1337" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 2 L47</text>
<text text-anchor="middle" x="1337" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1337" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1337" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert2 -->
<g id="node2334" class="node">
<title>layer47_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1727" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1727" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1727" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1727" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer47_moe_expert2&#45;&gt;layer47_moe_comm_from_expert2 -->
<g id="edge2991" class="edge">
<title>layer47_moe_expert2&#45;&gt;layer47_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1491.5,-10534.73C1491.5,-10507.83 1491.5,-10470 1491.5,-10470 1491.5,-10470 1626.29,-10470 1626.29,-10470"/>
<polygon fill="black" stroke="black" points="1626.29,-10473.5 1636.29,-10470 1626.29,-10466.5 1626.29,-10473.5"/>
</g>
<!-- layer47_moe_comm_to_expert2&#45;&gt;layer47_moe_expert2 -->
<g id="edge2960" class="edge">
<title>layer47_moe_comm_to_expert2&#45;&gt;layer47_moe_expert2</title>
<path fill="none" stroke="black" d="M1769.28,-10652C1666.47,-10652 1513,-10652 1513,-10652 1513,-10652 1513,-10561 1513,-10561 1513,-10561 1511.18,-10561 1511.18,-10561"/>
<polygon fill="black" stroke="black" points="1511.18,-10557.5 1501.18,-10561 1511.18,-10564.5 1511.18,-10557.5"/>
</g>
<!-- layer47_moe_expert3 -->
<g id="node2305" class="node">
<title>layer47_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1847,-10587.07 1519,-10587.07 1519,-10535.07 1847,-10535.07 1847,-10587.07"/>
<text text-anchor="middle" x="1683" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 3 L47</text>
<text text-anchor="middle" x="1683" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1683" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1683" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert3 -->
<g id="node2335" class="node">
<title>layer47_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2018" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2018" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2018" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2018" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer47_moe_expert3&#45;&gt;layer47_moe_comm_from_expert3 -->
<g id="edge2993" class="edge">
<title>layer47_moe_expert3&#45;&gt;layer47_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1835.51,-10534.73C1835.51,-10507.83 1835.51,-10470 1835.51,-10470 1835.51,-10470 1917.29,-10470 1917.29,-10470"/>
<polygon fill="black" stroke="black" points="1917.29,-10473.5 1927.29,-10470 1917.29,-10466.5 1917.29,-10473.5"/>
</g>
<!-- layer47_moe_comm_to_expert3&#45;&gt;layer47_moe_expert3 -->
<g id="edge2962" class="edge">
<title>layer47_moe_comm_to_expert3&#45;&gt;layer47_moe_expert3</title>
<path fill="none" stroke="black" d="M2129.33,-10629.92C2129.33,-10621.55 2129.33,-10614 2129.33,-10614 2129.33,-10614 1808.25,-10614 1808.25,-10614 1808.25,-10614 1808.25,-10597.23 1808.25,-10597.23"/>
<polygon fill="black" stroke="black" points="1811.75,-10597.23 1808.25,-10587.23 1804.75,-10597.23 1811.75,-10597.23"/>
</g>
<!-- layer47_moe_expert4 -->
<g id="node2307" class="node">
<title>layer47_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2193,-10587.07 1865,-10587.07 1865,-10535.07 2193,-10535.07 2193,-10587.07"/>
<text text-anchor="middle" x="2029" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 4 L47</text>
<text text-anchor="middle" x="2029" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2029" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="2029" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert4 -->
<g id="node2336" class="node">
<title>layer47_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2263" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2263" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2263" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2263" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer47_moe_expert4&#45;&gt;layer47_moe_comm_from_expert4 -->
<g id="edge2995" class="edge">
<title>layer47_moe_expert4&#45;&gt;layer47_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2182.75,-10534.76C2182.75,-10534.76 2182.75,-10493.71 2182.75,-10493.71"/>
<polygon fill="black" stroke="black" points="2186.25,-10493.71 2182.75,-10483.71 2179.25,-10493.71 2186.25,-10493.71"/>
</g>
<!-- layer47_moe_comm_to_expert4&#45;&gt;layer47_moe_expert4 -->
<g id="edge2964" class="edge">
<title>layer47_moe_comm_to_expert4&#45;&gt;layer47_moe_expert4</title>
<path fill="none" stroke="black" d="M2449.75,-10623.06C2449.75,-10613.38 2449.75,-10605 2449.75,-10605 2449.75,-10605 2161.16,-10605 2161.16,-10605 2161.16,-10605 2161.16,-10597.13 2161.16,-10597.13"/>
<polygon fill="black" stroke="black" points="2164.66,-10597.13 2161.16,-10587.13 2157.66,-10597.13 2164.66,-10597.13"/>
</g>
<!-- layer47_moe_expert5 -->
<g id="node2309" class="node">
<title>layer47_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2539,-10587.07 2211,-10587.07 2211,-10535.07 2539,-10535.07 2539,-10587.07"/>
<text text-anchor="middle" x="2375" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 5 L47</text>
<text text-anchor="middle" x="2375" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2375" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2375" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert5 -->
<g id="node2337" class="node">
<title>layer47_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2485" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2485" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2485" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2485" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer47_moe_expert5&#45;&gt;layer47_moe_comm_from_expert5 -->
<g id="edge2997" class="edge">
<title>layer47_moe_expert5&#45;&gt;layer47_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2466.75,-10534.76C2466.75,-10534.76 2466.75,-10508.57 2466.75,-10508.57"/>
<polygon fill="black" stroke="black" points="2470.25,-10508.57 2466.75,-10498.57 2463.25,-10508.57 2470.25,-10508.57"/>
</g>
<!-- layer47_moe_comm_to_expert5&#45;&gt;layer47_moe_expert5 -->
<g id="edge2966" class="edge">
<title>layer47_moe_comm_to_expert5&#45;&gt;layer47_moe_expert5</title>
<path fill="none" stroke="black" d="M2591.26,-10652C2567.92,-10652 2549.25,-10652 2549.25,-10652 2549.25,-10652 2549.25,-10561 2549.25,-10561 2549.25,-10561 2548.24,-10561 2548.24,-10561"/>
<polygon fill="black" stroke="black" points="2549.13,-10557.5 2539.13,-10561 2549.13,-10564.5 2549.13,-10557.5"/>
</g>
<!-- layer47_moe_expert6 -->
<g id="node2311" class="node">
<title>layer47_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2885,-10587.07 2557,-10587.07 2557,-10535.07 2885,-10535.07 2885,-10587.07"/>
<text text-anchor="middle" x="2721" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 6 L47</text>
<text text-anchor="middle" x="2721" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2721" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2721" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert6 -->
<g id="node2338" class="node">
<title>layer47_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2832" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2832" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2832" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2832" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer47_moe_expert6&#45;&gt;layer47_moe_comm_from_expert6 -->
<g id="edge2999" class="edge">
<title>layer47_moe_expert6&#45;&gt;layer47_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2813.25,-10534.76C2813.25,-10534.76 2813.25,-10508.57 2813.25,-10508.57"/>
<polygon fill="black" stroke="black" points="2816.75,-10508.57 2813.25,-10498.57 2809.75,-10508.57 2816.75,-10508.57"/>
</g>
<!-- layer47_moe_comm_to_expert6&#45;&gt;layer47_moe_expert6 -->
<g id="edge2968" class="edge">
<title>layer47_moe_comm_to_expert6&#45;&gt;layer47_moe_expert6</title>
<path fill="none" stroke="black" d="M2845.75,-10628.16C2845.75,-10628.16 2845.75,-10597.38 2845.75,-10597.38"/>
<polygon fill="black" stroke="black" points="2849.25,-10597.38 2845.75,-10587.38 2842.25,-10597.38 2849.25,-10597.38"/>
</g>
<!-- layer47_moe_expert7 -->
<g id="node2313" class="node">
<title>layer47_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3231,-10587.07 2903,-10587.07 2903,-10535.07 3231,-10535.07 3231,-10587.07"/>
<text text-anchor="middle" x="3067" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 7 L47</text>
<text text-anchor="middle" x="3067" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3067" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3067" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert7 -->
<g id="node2339" class="node">
<title>layer47_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3104" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3104" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3104" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3104" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer47_moe_expert7&#45;&gt;layer47_moe_comm_from_expert7 -->
<g id="edge3001" class="edge">
<title>layer47_moe_expert7&#45;&gt;layer47_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3104,-10534.76C3104,-10534.76 3104,-10509.21 3104,-10509.21"/>
<polygon fill="black" stroke="black" points="3107.5,-10509.21 3104,-10499.21 3100.5,-10509.21 3107.5,-10509.21"/>
</g>
<!-- layer47_moe_comm_to_expert7&#45;&gt;layer47_moe_expert7 -->
<g id="edge2970" class="edge">
<title>layer47_moe_comm_to_expert7&#45;&gt;layer47_moe_expert7</title>
<path fill="none" stroke="black" d="M3104,-10623.02C3104,-10623.02 3104,-10597.37 3104,-10597.37"/>
<polygon fill="black" stroke="black" points="3107.5,-10597.37 3104,-10587.37 3100.5,-10597.37 3107.5,-10597.37"/>
</g>
<!-- layer47_moe_expert8 -->
<g id="node2315" class="node">
<title>layer47_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3577,-10587.07 3249,-10587.07 3249,-10535.07 3577,-10535.07 3577,-10587.07"/>
<text text-anchor="middle" x="3413" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 8 L47</text>
<text text-anchor="middle" x="3413" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3413" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3413" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert8 -->
<g id="node2340" class="node">
<title>layer47_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3376" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3376" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3376" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3376" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer47_moe_expert8&#45;&gt;layer47_moe_comm_from_expert8 -->
<g id="edge3003" class="edge">
<title>layer47_moe_expert8&#45;&gt;layer47_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3376,-10534.76C3376,-10534.76 3376,-10509.21 3376,-10509.21"/>
<polygon fill="black" stroke="black" points="3379.5,-10509.21 3376,-10499.21 3372.5,-10509.21 3379.5,-10509.21"/>
</g>
<!-- layer47_moe_comm_to_expert8&#45;&gt;layer47_moe_expert8 -->
<g id="edge2972" class="edge">
<title>layer47_moe_comm_to_expert8&#45;&gt;layer47_moe_expert8</title>
<path fill="none" stroke="black" d="M3376,-10623.02C3376,-10623.02 3376,-10597.37 3376,-10597.37"/>
<polygon fill="black" stroke="black" points="3379.5,-10597.37 3376,-10587.37 3372.5,-10597.37 3379.5,-10597.37"/>
</g>
<!-- layer47_moe_expert9 -->
<g id="node2317" class="node">
<title>layer47_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3923,-10587.07 3595,-10587.07 3595,-10535.07 3923,-10535.07 3923,-10587.07"/>
<text text-anchor="middle" x="3759" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 9 L47</text>
<text text-anchor="middle" x="3759" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3759" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3759" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert9 -->
<g id="node2341" class="node">
<title>layer47_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3685" cy="-10470.08" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3685" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3685" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3685" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer47_moe_expert9&#45;&gt;layer47_moe_comm_from_expert9 -->
<g id="edge3005" class="edge">
<title>layer47_moe_expert9&#45;&gt;layer47_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3685.25,-10534.76C3685.25,-10534.76 3685.25,-10509.21 3685.25,-10509.21"/>
<polygon fill="black" stroke="black" points="3688.75,-10509.21 3685.25,-10499.21 3681.75,-10509.21 3688.75,-10509.21"/>
</g>
<!-- layer47_moe_comm_to_expert9&#45;&gt;layer47_moe_expert9 -->
<g id="edge2974" class="edge">
<title>layer47_moe_comm_to_expert9&#45;&gt;layer47_moe_expert9</title>
<path fill="none" stroke="black" d="M3685.25,-10623.02C3685.25,-10623.02 3685.25,-10597.37 3685.25,-10597.37"/>
<polygon fill="black" stroke="black" points="3688.75,-10597.37 3685.25,-10587.37 3681.75,-10597.37 3688.75,-10597.37"/>
</g>
<!-- layer47_moe_expert10 -->
<g id="node2319" class="node">
<title>layer47_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4279,-10587.07 3941,-10587.07 3941,-10535.07 4279,-10535.07 4279,-10587.07"/>
<text text-anchor="middle" x="4110" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 10 L47</text>
<text text-anchor="middle" x="4110" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4110" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4110" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert10 -->
<g id="node2342" class="node">
<title>layer47_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="4017" cy="-10470.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4017" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="4017" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4017" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer47_moe_expert10&#45;&gt;layer47_moe_comm_from_expert10 -->
<g id="edge3007" class="edge">
<title>layer47_moe_expert10&#45;&gt;layer47_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M4026.38,-10534.76C4026.38,-10534.76 4026.38,-10509.21 4026.38,-10509.21"/>
<polygon fill="black" stroke="black" points="4029.88,-10509.21 4026.38,-10499.21 4022.88,-10509.21 4029.88,-10509.21"/>
</g>
<!-- layer47_moe_comm_to_expert10&#45;&gt;layer47_moe_expert10 -->
<g id="edge2976" class="edge">
<title>layer47_moe_comm_to_expert10&#45;&gt;layer47_moe_expert10</title>
<path fill="none" stroke="black" d="M4026.02,-10623.02C4026.02,-10623.02 4026.02,-10597.37 4026.02,-10597.37"/>
<polygon fill="black" stroke="black" points="4029.52,-10597.37 4026.02,-10587.37 4022.52,-10597.37 4029.52,-10597.37"/>
</g>
<!-- layer47_moe_expert11 -->
<g id="node2321" class="node">
<title>layer47_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4635,-10587.07 4297,-10587.07 4297,-10535.07 4635,-10535.07 4635,-10587.07"/>
<text text-anchor="middle" x="4466" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 11 L47</text>
<text text-anchor="middle" x="4466" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4466" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4466" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert11 -->
<g id="node2343" class="node">
<title>layer47_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4364" cy="-10470.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4364" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4364" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4364" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer47_moe_expert11&#45;&gt;layer47_moe_comm_from_expert11 -->
<g id="edge3009" class="edge">
<title>layer47_moe_expert11&#45;&gt;layer47_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4377.88,-10534.76C4377.88,-10534.76 4377.88,-10508.89 4377.88,-10508.89"/>
<polygon fill="black" stroke="black" points="4381.38,-10508.89 4377.88,-10498.89 4374.38,-10508.89 4381.38,-10508.89"/>
</g>
<!-- layer47_moe_comm_to_expert11&#45;&gt;layer47_moe_expert11 -->
<g id="edge2978" class="edge">
<title>layer47_moe_comm_to_expert11&#45;&gt;layer47_moe_expert11</title>
<path fill="none" stroke="black" d="M4377.02,-10623.27C4377.02,-10623.27 4377.02,-10597.21 4377.02,-10597.21"/>
<polygon fill="black" stroke="black" points="4380.52,-10597.21 4377.02,-10587.21 4373.52,-10597.21 4380.52,-10597.21"/>
</g>
<!-- layer47_moe_expert12 -->
<g id="node2323" class="node">
<title>layer47_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4991,-10587.07 4653,-10587.07 4653,-10535.07 4991,-10535.07 4991,-10587.07"/>
<text text-anchor="middle" x="4822" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 12 L47</text>
<text text-anchor="middle" x="4822" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4822" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4822" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert12 -->
<g id="node2344" class="node">
<title>layer47_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4715" cy="-10470.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4715" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4715" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4715" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer47_moe_expert12&#45;&gt;layer47_moe_comm_from_expert12 -->
<g id="edge3011" class="edge">
<title>layer47_moe_expert12&#45;&gt;layer47_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4731.38,-10534.76C4731.38,-10534.76 4731.38,-10508.89 4731.38,-10508.89"/>
<polygon fill="black" stroke="black" points="4734.88,-10508.89 4731.38,-10498.89 4727.88,-10508.89 4734.88,-10508.89"/>
</g>
<!-- layer47_moe_comm_to_expert12&#45;&gt;layer47_moe_expert12 -->
<g id="edge2980" class="edge">
<title>layer47_moe_comm_to_expert12&#45;&gt;layer47_moe_expert12</title>
<path fill="none" stroke="black" d="M4730.52,-10623.27C4730.52,-10623.27 4730.52,-10597.21 4730.52,-10597.21"/>
<polygon fill="black" stroke="black" points="4734.02,-10597.21 4730.52,-10587.21 4727.02,-10597.21 4734.02,-10597.21"/>
</g>
<!-- layer47_moe_expert13 -->
<g id="node2325" class="node">
<title>layer47_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5347,-10587.07 5009,-10587.07 5009,-10535.07 5347,-10535.07 5347,-10587.07"/>
<text text-anchor="middle" x="5178" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 13 L47</text>
<text text-anchor="middle" x="5178" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5178" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5178" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert13 -->
<g id="node2345" class="node">
<title>layer47_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5069" cy="-10470.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5069" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5069" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5069" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer47_moe_expert13&#45;&gt;layer47_moe_comm_from_expert13 -->
<g id="edge3013" class="edge">
<title>layer47_moe_expert13&#45;&gt;layer47_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5086.38,-10534.76C5086.38,-10534.76 5086.38,-10508.89 5086.38,-10508.89"/>
<polygon fill="black" stroke="black" points="5089.88,-10508.89 5086.38,-10498.89 5082.88,-10508.89 5089.88,-10508.89"/>
</g>
<!-- layer47_moe_comm_to_expert13&#45;&gt;layer47_moe_expert13 -->
<g id="edge2982" class="edge">
<title>layer47_moe_comm_to_expert13&#45;&gt;layer47_moe_expert13</title>
<path fill="none" stroke="black" d="M5085.02,-10623.27C5085.02,-10623.27 5085.02,-10597.21 5085.02,-10597.21"/>
<polygon fill="black" stroke="black" points="5088.52,-10597.21 5085.02,-10587.21 5081.52,-10597.21 5088.52,-10597.21"/>
</g>
<!-- layer47_moe_expert14 -->
<g id="node2327" class="node">
<title>layer47_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5703,-10587.07 5365,-10587.07 5365,-10535.07 5703,-10535.07 5703,-10587.07"/>
<text text-anchor="middle" x="5534" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 14 L47</text>
<text text-anchor="middle" x="5534" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5534" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5534" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert14 -->
<g id="node2346" class="node">
<title>layer47_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5424" cy="-10470.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5424" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5424" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5424" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer47_moe_expert14&#45;&gt;layer47_moe_comm_from_expert14 -->
<g id="edge3015" class="edge">
<title>layer47_moe_expert14&#45;&gt;layer47_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5441.88,-10534.76C5441.88,-10534.76 5441.88,-10508.57 5441.88,-10508.57"/>
<polygon fill="black" stroke="black" points="5445.38,-10508.57 5441.88,-10498.57 5438.38,-10508.57 5445.38,-10508.57"/>
</g>
<!-- layer47_moe_comm_to_expert14&#45;&gt;layer47_moe_expert14 -->
<g id="edge2984" class="edge">
<title>layer47_moe_comm_to_expert14&#45;&gt;layer47_moe_expert14</title>
<path fill="none" stroke="black" d="M5440.52,-10623.27C5440.52,-10623.27 5440.52,-10597.21 5440.52,-10597.21"/>
<polygon fill="black" stroke="black" points="5444.02,-10597.21 5440.52,-10587.21 5437.02,-10597.21 5444.02,-10597.21"/>
</g>
<!-- layer47_moe_expert15 -->
<g id="node2329" class="node">
<title>layer47_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6059,-10587.07 5721,-10587.07 5721,-10535.07 6059,-10535.07 6059,-10587.07"/>
<text text-anchor="middle" x="5890" y="-10575.07" font-family="Arial" font-size="10.00">EXPERT 15 L47</text>
<text text-anchor="middle" x="5890" y="-10564.07" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5890" y="-10553.07" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5890" y="-10542.07" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_comm_from_expert15 -->
<g id="node2347" class="node">
<title>layer47_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5779" cy="-10470.08" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5779" y="-10478.58" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5779" y="-10467.58" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5779" y="-10456.58" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer47_moe_expert15&#45;&gt;layer47_moe_comm_from_expert15 -->
<g id="edge3017" class="edge">
<title>layer47_moe_expert15&#45;&gt;layer47_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5797.38,-10534.76C5797.38,-10534.76 5797.38,-10508.57 5797.38,-10508.57"/>
<polygon fill="black" stroke="black" points="5800.88,-10508.57 5797.38,-10498.57 5793.88,-10508.57 5800.88,-10508.57"/>
</g>
<!-- layer47_moe_comm_to_expert15&#45;&gt;layer47_moe_expert15 -->
<g id="edge2986" class="edge">
<title>layer47_moe_comm_to_expert15&#45;&gt;layer47_moe_expert15</title>
<path fill="none" stroke="black" d="M5796.02,-10623.27C5796.02,-10623.27 5796.02,-10597.21 5796.02,-10597.21"/>
<polygon fill="black" stroke="black" points="5799.52,-10597.21 5796.02,-10587.21 5792.52,-10597.21 5799.52,-10597.21"/>
</g>
<!-- layer47_moe_aggregate -->
<g id="node2331" class="node">
<title>layer47_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3465.1,-10405.09 3048.16,-10405.09 2940.9,-10301.09 3357.84,-10301.09 3465.1,-10405.09"/>
<text text-anchor="middle" x="3203" y="-10367.09" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L47</text>
<text text-anchor="middle" x="3203" y="-10356.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3203" y="-10345.09" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3203" y="-10334.09" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_mha -->
<g id="node2348" class="node">
<title>layer48_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3333,-10265.09 3073,-10265.09 3073,-10213.09 3333,-10213.09 3333,-10265.09"/>
<text text-anchor="middle" x="3203" y="-10253.09" font-family="Arial" font-size="10.00">MHA L48</text>
<text text-anchor="middle" x="3203" y="-10242.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3203" y="-10231.09" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3203" y="-10220.09" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer47_moe_aggregate&#45;&gt;layer48_moe_mha -->
<g id="edge3086" class="edge">
<title>layer47_moe_aggregate&#45;&gt;layer48_moe_mha</title>
<path fill="none" stroke="black" d="M3203,-10300.76C3203,-10300.76 3203,-10275.32 3203,-10275.32"/>
<polygon fill="black" stroke="black" points="3206.5,-10275.32 3203,-10265.32 3199.5,-10275.32 3206.5,-10275.32"/>
</g>
<!-- layer47_moe_comm_from_expert0&#45;&gt;layer47_moe_aggregate -->
<g id="edge2988" class="edge">
<title>layer47_moe_comm_from_expert0&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M829.25,-10445.85C829.25,-10402.23 829.25,-10315 829.25,-10315 829.25,-10315 2945.13,-10315 2945.13,-10315"/>
<polygon fill="black" stroke="black" points="2945.13,-10318.5 2955.13,-10315 2945.13,-10311.5 2945.13,-10318.5"/>
</g>
<!-- layer47_moe_comm_from_expert1&#45;&gt;layer47_moe_aggregate -->
<g id="edge2990" class="edge">
<title>layer47_moe_comm_from_expert1&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M1430.01,-10460.89C1430.01,-10429.73 1430.01,-10330 1430.01,-10330 1430.01,-10330 2960.3,-10330 2960.3,-10330"/>
<polygon fill="black" stroke="black" points="2960.3,-10333.5 2970.3,-10330 2960.3,-10326.5 2960.3,-10333.5"/>
</g>
<!-- layer47_moe_comm_from_expert2&#45;&gt;layer47_moe_aggregate -->
<g id="edge2992" class="edge">
<title>layer47_moe_comm_from_expert2&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M1740.5,-10441.39C1740.5,-10404.46 1740.5,-10345 1740.5,-10345 1740.5,-10345 2976.02,-10345 2976.02,-10345"/>
<polygon fill="black" stroke="black" points="2976.02,-10348.5 2986.02,-10345 2976.02,-10341.5 2976.02,-10348.5"/>
</g>
<!-- layer47_moe_comm_from_expert3&#45;&gt;layer47_moe_aggregate -->
<g id="edge2994" class="edge">
<title>layer47_moe_comm_from_expert3&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M2040.5,-10441.73C2040.5,-10409.12 2040.5,-10360 2040.5,-10360 2040.5,-10360 2991.5,-10360 2991.5,-10360"/>
<polygon fill="black" stroke="black" points="2991.5,-10363.5 3001.5,-10360 2991.5,-10356.5 2991.5,-10363.5"/>
</g>
<!-- layer47_moe_comm_from_expert4&#45;&gt;layer47_moe_aggregate -->
<g id="edge2996" class="edge">
<title>layer47_moe_comm_from_expert4&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M2290,-10442.32C2290,-10414.26 2290,-10375 2290,-10375 2290,-10375 3006.86,-10375 3006.86,-10375"/>
<polygon fill="black" stroke="black" points="3006.86,-10378.5 3016.86,-10375 3006.86,-10371.5 3006.86,-10378.5"/>
</g>
<!-- layer47_moe_comm_from_expert5&#45;&gt;layer47_moe_aggregate -->
<g id="edge2998" class="edge">
<title>layer47_moe_comm_from_expert5&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M2514.5,-10442.52C2514.5,-10419.36 2514.5,-10390 2514.5,-10390 2514.5,-10390 3022.37,-10390 3022.37,-10390"/>
<polygon fill="black" stroke="black" points="3022.37,-10393.5 3032.37,-10390 3022.37,-10386.5 3022.37,-10393.5"/>
</g>
<!-- layer47_moe_comm_from_expert6&#45;&gt;layer47_moe_aggregate -->
<g id="edge3000" class="edge">
<title>layer47_moe_comm_from_expert6&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M2922.65,-10470C2951.98,-10470 2977.1,-10470 2977.1,-10470 2977.1,-10470 2977.1,-10363.18 2977.1,-10363.18"/>
<polygon fill="black" stroke="black" points="2980.6,-10363.18 2977.1,-10353.18 2973.6,-10363.18 2980.6,-10363.18"/>
</g>
<!-- layer47_moe_comm_from_expert7&#45;&gt;layer47_moe_aggregate -->
<g id="edge3002" class="edge">
<title>layer47_moe_comm_from_expert7&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M3104,-10440.86C3104,-10440.86 3104,-10415.15 3104,-10415.15"/>
<polygon fill="black" stroke="black" points="3107.5,-10415.15 3104,-10405.15 3100.5,-10415.15 3107.5,-10415.15"/>
</g>
<!-- layer47_moe_comm_from_expert8&#45;&gt;layer47_moe_aggregate -->
<g id="edge3004" class="edge">
<title>layer47_moe_comm_from_expert8&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M3375.39,-10440.86C3375.39,-10440.86 3375.39,-10415.15 3375.39,-10415.15"/>
<polygon fill="black" stroke="black" points="3378.89,-10415.15 3375.39,-10405.15 3371.89,-10415.15 3378.89,-10415.15"/>
</g>
<!-- layer47_moe_comm_from_expert9&#45;&gt;layer47_moe_aggregate -->
<g id="edge3006" class="edge">
<title>layer47_moe_comm_from_expert9&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M3666.5,-10441.45C3666.5,-10419.17 3666.5,-10392 3666.5,-10392 3666.5,-10392 3461.71,-10392 3461.71,-10392"/>
<polygon fill="black" stroke="black" points="3461.71,-10388.5 3451.71,-10392 3461.71,-10395.5 3461.71,-10388.5"/>
</g>
<!-- layer47_moe_comm_from_expert10&#45;&gt;layer47_moe_aggregate -->
<g id="edge3008" class="edge">
<title>layer47_moe_comm_from_expert10&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M3998.15,-10441.26C3998.15,-10414.58 3998.15,-10379 3998.15,-10379 3998.15,-10379 3448.34,-10379 3448.34,-10379"/>
<polygon fill="black" stroke="black" points="3448.34,-10375.5 3438.34,-10379 3448.34,-10382.5 3448.34,-10375.5"/>
</g>
<!-- layer47_moe_comm_from_expert11&#45;&gt;layer47_moe_aggregate -->
<g id="edge3010" class="edge">
<title>layer47_moe_comm_from_expert11&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M4344.65,-10441.64C4344.65,-10410.82 4344.65,-10366 4344.65,-10366 4344.65,-10366 3434.81,-10366 3434.81,-10366"/>
<polygon fill="black" stroke="black" points="3434.81,-10362.5 3424.81,-10366 3434.81,-10369.5 3434.81,-10362.5"/>
</g>
<!-- layer47_moe_comm_from_expert12&#45;&gt;layer47_moe_aggregate -->
<g id="edge3012" class="edge">
<title>layer47_moe_comm_from_expert12&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M4695.65,-10441.44C4695.65,-10406.78 4695.65,-10353 4695.65,-10353 4695.65,-10353 3421.72,-10353 3421.72,-10353"/>
<polygon fill="black" stroke="black" points="3421.72,-10349.5 3411.72,-10353 3421.72,-10356.5 3421.72,-10349.5"/>
</g>
<!-- layer47_moe_comm_from_expert13&#45;&gt;layer47_moe_aggregate -->
<g id="edge3014" class="edge">
<title>layer47_moe_comm_from_expert13&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M5049.15,-10441.54C5049.15,-10403.24 5049.15,-10340 5049.15,-10340 5049.15,-10340 3408.39,-10340 3408.39,-10340"/>
<polygon fill="black" stroke="black" points="3408.39,-10336.5 3398.39,-10340 3408.39,-10343.5 3408.39,-10336.5"/>
</g>
<!-- layer47_moe_comm_from_expert14&#45;&gt;layer47_moe_aggregate -->
<g id="edge3016" class="edge">
<title>layer47_moe_comm_from_expert14&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M5404.15,-10441.47C5404.15,-10399.72 5404.15,-10327 5404.15,-10327 5404.15,-10327 3395,-10327 3395,-10327"/>
<polygon fill="black" stroke="black" points="3395,-10323.5 3385,-10327 3395,-10330.5 3395,-10323.5"/>
</g>
<!-- layer47_moe_comm_from_expert15&#45;&gt;layer47_moe_aggregate -->
<g id="edge3018" class="edge">
<title>layer47_moe_comm_from_expert15&#45;&gt;layer47_moe_aggregate</title>
<path fill="none" stroke="black" d="M5759.15,-10441.45C5759.15,-10396.39 5759.15,-10314 5759.15,-10314 5759.15,-10314 3381.21,-10314 3381.21,-10314"/>
<polygon fill="black" stroke="black" points="3381.21,-10310.5 3371.21,-10314 3381.21,-10317.5 3381.21,-10310.5"/>
</g>
<!-- layer48_moe_gate -->
<g id="node2349" class="node">
<title>layer48_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3461.3,-10177.09 3050.4,-10177.09 2944.7,-10073.09 3355.6,-10073.09 3461.3,-10177.09"/>
<text text-anchor="middle" x="3203" y="-10139.09" font-family="Arial" font-size="10.00">GATE L48</text>
<text text-anchor="middle" x="3203" y="-10128.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3203" y="-10117.09" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3203" y="-10106.09" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer48_moe_mha&#45;&gt;layer48_moe_gate -->
<g id="edge3087" class="edge">
<title>layer48_moe_mha&#45;&gt;layer48_moe_gate</title>
<path fill="none" stroke="black" d="M3203,-10212.94C3203,-10212.94 3203,-10187.19 3203,-10187.19"/>
<polygon fill="black" stroke="black" points="3206.5,-10187.19 3203,-10177.19 3199.5,-10187.19 3206.5,-10187.19"/>
</g>
<!-- layer48_moe_split -->
<g id="node2350" class="node">
<title>layer48_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3457.01,-10037.09 3052.94,-10037.09 2948.99,-9933.09 3353.06,-9933.09 3457.01,-10037.09"/>
<text text-anchor="middle" x="3203" y="-9999.09" font-family="Arial" font-size="10.00">SPLIT TOKENS L48</text>
<text text-anchor="middle" x="3203" y="-9988.09" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3203" y="-9977.09" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3203" y="-9966.09" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer48_moe_gate&#45;&gt;layer48_moe_split -->
<g id="edge3088" class="edge">
<title>layer48_moe_gate&#45;&gt;layer48_moe_split</title>
<path fill="none" stroke="black" d="M3203,-10072.96C3203,-10072.96 3203,-10047.27 3203,-10047.27"/>
<polygon fill="black" stroke="black" points="3206.5,-10047.27 3203,-10037.27 3199.5,-10047.27 3206.5,-10047.27"/>
</g>
<!-- layer48_moe_comm_to_expert0 -->
<g id="node2352" class="node">
<title>layer48_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="695" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="695" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="695" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="695" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert0 -->
<g id="edge3022" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3037.82,-10022C2485.33,-10022 736.5,-10022 736.5,-10022 736.5,-10022 736.5,-9904.21 736.5,-9904.21"/>
<polygon fill="black" stroke="black" points="740,-9904.21 736.5,-9894.21 733,-9904.21 740,-9904.21"/>
</g>
<!-- layer48_moe_comm_to_expert1 -->
<g id="node2354" class="node">
<title>layer48_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1335" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1335" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1335" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1335" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert1 -->
<g id="edge3024" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3022.63,-10007C2554.96,-10007 1339.5,-10007 1339.5,-10007 1339.5,-10007 1339.5,-9907.22 1339.5,-9907.22"/>
<polygon fill="black" stroke="black" points="1343,-9907.22 1339.5,-9897.22 1336,-9907.22 1343,-9907.22"/>
</g>
<!-- layer48_moe_comm_to_expert2 -->
<g id="node2356" class="node">
<title>layer48_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1754" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1754" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1754" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1754" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert2 -->
<g id="edge3026" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3007.61,-9992C2627.73,-9992 1826.51,-9992 1826.51,-9992 1826.51,-9992 1826.51,-9895.59 1826.51,-9895.59"/>
<polygon fill="black" stroke="black" points="1830.01,-9895.59 1826.51,-9885.59 1823.01,-9895.59 1830.01,-9895.59"/>
</g>
<!-- layer48_moe_comm_to_expert3 -->
<g id="node2358" class="node">
<title>layer48_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2063" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2063" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2063" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2063" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert3 -->
<g id="edge3028" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2992.81,-9977C2680.67,-9977 2131.01,-9977 2131.01,-9977 2131.01,-9977 2131.01,-9897.32 2131.01,-9897.32"/>
<polygon fill="black" stroke="black" points="2134.51,-9897.32 2131.01,-9887.32 2127.51,-9897.32 2134.51,-9897.32"/>
</g>
<!-- layer48_moe_comm_to_expert4 -->
<g id="node2360" class="node">
<title>layer48_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2317" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2317" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2317" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2317" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert4 -->
<g id="edge3030" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2977.73,-9962C2740.51,-9962 2401,-9962 2401,-9962 2401,-9962 2401,-9889.24 2401,-9889.24"/>
<polygon fill="black" stroke="black" points="2404.5,-9889.24 2401,-9879.24 2397.5,-9889.24 2404.5,-9889.24"/>
</g>
<!-- layer48_moe_comm_to_expert5 -->
<g id="node2362" class="node">
<title>layer48_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2544" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2544" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2544" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2544" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert5 -->
<g id="edge3032" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2962.79,-9947C2796.52,-9947 2605.01,-9947 2605.01,-9947 2605.01,-9947 2605.01,-9899.66 2605.01,-9899.66"/>
<polygon fill="black" stroke="black" points="2608.51,-9899.66 2605.01,-9889.66 2601.51,-9899.66 2608.51,-9899.66"/>
</g>
<!-- layer48_moe_comm_to_expert6 -->
<g id="node2364" class="node">
<title>layer48_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2757" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2757" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2757" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2757" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert6 -->
<g id="edge3034" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2962.74,-9985.01C2962.74,-9981.46 2962.74,-9868 2962.74,-9868 2962.74,-9868 2857.54,-9868 2857.54,-9868"/>
<polygon fill="black" stroke="black" points="2857.54,-9864.5 2847.54,-9868 2857.54,-9871.5 2857.54,-9864.5"/>
</g>
<!-- layer48_moe_comm_to_expert7 -->
<g id="node2366" class="node">
<title>layer48_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3067" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3067" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3067" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3067" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert7 -->
<g id="edge3036" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3067,-9932.75C3067,-9932.75 3067,-9907.31 3067,-9907.31"/>
<polygon fill="black" stroke="black" points="3070.5,-9907.31 3067,-9897.31 3063.5,-9907.31 3070.5,-9907.31"/>
</g>
<!-- layer48_moe_comm_to_expert8 -->
<g id="node2368" class="node">
<title>layer48_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3339" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3339" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3339" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3339" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert8 -->
<g id="edge3038" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3339,-9932.75C3339,-9932.75 3339,-9907.31 3339,-9907.31"/>
<polygon fill="black" stroke="black" points="3342.5,-9907.31 3339,-9897.31 3335.5,-9907.31 3342.5,-9907.31"/>
</g>
<!-- layer48_moe_comm_to_expert9 -->
<g id="node2370" class="node">
<title>layer48_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3648" cy="-9868.1" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3648" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3648" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3648" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert9 -->
<g id="edge3040" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3443.26,-9985.01C3443.26,-9981.46 3443.26,-9868 3443.26,-9868 3443.26,-9868 3547.3,-9868 3547.3,-9868"/>
<polygon fill="black" stroke="black" points="3547.3,-9871.5 3557.3,-9868 3547.3,-9864.5 3547.3,-9871.5"/>
</g>
<!-- layer48_moe_comm_to_expert10 -->
<g id="node2372" class="node">
<title>layer48_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3980" cy="-9868.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3980" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3980" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3980" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert10 -->
<g id="edge3042" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3367.38,-9947C3574.6,-9947 3904.1,-9947 3904.1,-9947 3904.1,-9947 3904.1,-9895.22 3904.1,-9895.22"/>
<polygon fill="black" stroke="black" points="3907.6,-9895.22 3904.1,-9885.22 3900.6,-9895.22 3907.6,-9895.22"/>
</g>
<!-- layer48_moe_comm_to_expert11 -->
<g id="node2374" class="node">
<title>layer48_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4326" cy="-9868.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4326" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4326" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4326" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert11 -->
<g id="edge3044" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3382.2,-9962C3681.48,-9962 4250.6,-9962 4250.6,-9962 4250.6,-9962 4250.6,-9895.76 4250.6,-9895.76"/>
<polygon fill="black" stroke="black" points="4254.1,-9895.76 4250.6,-9885.76 4247.1,-9895.76 4254.1,-9895.76"/>
</g>
<!-- layer48_moe_comm_to_expert12 -->
<g id="node2376" class="node">
<title>layer48_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4677" cy="-9868.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4677" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4677" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4677" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert12 -->
<g id="edge3046" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3397.1,-9977C3781.24,-9977 4601.6,-9977 4601.6,-9977 4601.6,-9977 4601.6,-9895.6 4601.6,-9895.6"/>
<polygon fill="black" stroke="black" points="4605.1,-9895.6 4601.6,-9885.6 4598.1,-9895.6 4605.1,-9895.6"/>
</g>
<!-- layer48_moe_comm_to_expert13 -->
<g id="node2378" class="node">
<title>layer48_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5030" cy="-9868.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5030" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="5030" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5030" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert13 -->
<g id="edge3048" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3412.17,-9992C3877,-9992 4955.1,-9992 4955.1,-9992 4955.1,-9992 4955.1,-9895.85 4955.1,-9895.85"/>
<polygon fill="black" stroke="black" points="4958.6,-9895.85 4955.1,-9885.85 4951.6,-9895.85 4958.6,-9895.85"/>
</g>
<!-- layer48_moe_comm_to_expert14 -->
<g id="node2380" class="node">
<title>layer48_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5385" cy="-9868.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5385" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5385" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5385" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert14 -->
<g id="edge3050" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3427,-10007C3969.61,-10007 5310.1,-10007 5310.1,-10007 5310.1,-10007 5310.1,-9895.69 5310.1,-9895.69"/>
<polygon fill="black" stroke="black" points="5313.6,-9895.69 5310.1,-9885.69 5306.6,-9895.69 5313.6,-9895.69"/>
</g>
<!-- layer48_moe_comm_to_expert15 -->
<g id="node2382" class="node">
<title>layer48_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5740" cy="-9868.1" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5740" y="-9876.6" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5740" y="-9865.6" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5740" y="-9854.6" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert15 -->
<g id="edge3052" class="edge">
<title>layer48_moe_split&#45;&gt;layer48_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3442.15,-10022C4060.66,-10022 5665.1,-10022 5665.1,-10022 5665.1,-10022 5665.1,-9895.75 5665.1,-9895.75"/>
<polygon fill="black" stroke="black" points="5668.6,-9895.75 5665.1,-9885.75 5661.6,-9895.75 5668.6,-9895.75"/>
</g>
<!-- layer48_moe_expert0 -->
<g id="node2351" class="node">
<title>layer48_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="772,-9803.11 444,-9803.11 444,-9751.11 772,-9751.11 772,-9803.11"/>
<text text-anchor="middle" x="608" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 0 L48</text>
<text text-anchor="middle" x="608" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="608" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="608" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert0 -->
<g id="node2384" class="node">
<title>layer48_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="654" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="654" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="654" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="654" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer48_moe_expert0&#45;&gt;layer48_moe_comm_from_expert0 -->
<g id="edge3054" class="edge">
<title>layer48_moe_expert0&#45;&gt;layer48_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M654,-9750.79C654,-9750.79 654,-9725.25 654,-9725.25"/>
<polygon fill="black" stroke="black" points="657.5,-9725.25 654,-9715.25 650.5,-9725.25 657.5,-9725.25"/>
</g>
<!-- layer48_moe_comm_to_expert0&#45;&gt;layer48_moe_expert0 -->
<g id="edge3023" class="edge">
<title>layer48_moe_comm_to_expert0&#45;&gt;layer48_moe_expert0</title>
<path fill="none" stroke="black" d="M688.25,-9839.06C688.25,-9839.06 688.25,-9813.41 688.25,-9813.41"/>
<polygon fill="black" stroke="black" points="691.75,-9813.41 688.25,-9803.41 684.75,-9813.41 691.75,-9813.41"/>
</g>
<!-- layer48_moe_expert1 -->
<g id="node2353" class="node">
<title>layer48_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1118,-9803.11 790,-9803.11 790,-9751.11 1118,-9751.11 1118,-9803.11"/>
<text text-anchor="middle" x="954" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 1 L48</text>
<text text-anchor="middle" x="954" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="954" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="954" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert1 -->
<g id="node2385" class="node">
<title>layer48_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1367" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1367" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1367" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1367" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer48_moe_expert1&#45;&gt;layer48_moe_comm_from_expert1 -->
<g id="edge3056" class="edge">
<title>layer48_moe_expert1&#45;&gt;layer48_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1056.25,-9750.76C1056.25,-9723.85 1056.25,-9686 1056.25,-9686 1056.25,-9686 1266.28,-9686 1266.28,-9686"/>
<polygon fill="black" stroke="black" points="1266.28,-9689.5 1276.28,-9686 1266.28,-9682.5 1266.28,-9689.5"/>
</g>
<!-- layer48_moe_comm_to_expert1&#45;&gt;layer48_moe_expert1 -->
<g id="edge3025" class="edge">
<title>layer48_moe_comm_to_expert1&#45;&gt;layer48_moe_expert1</title>
<path fill="none" stroke="black" d="M1244.32,-9868C1143.07,-9868 993.25,-9868 993.25,-9868 993.25,-9868 993.25,-9813.4 993.25,-9813.4"/>
<polygon fill="black" stroke="black" points="996.75,-9813.4 993.25,-9803.4 989.75,-9813.4 996.75,-9813.4"/>
</g>
<!-- layer48_moe_expert2 -->
<g id="node2355" class="node">
<title>layer48_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1464,-9803.11 1136,-9803.11 1136,-9751.11 1464,-9751.11 1464,-9803.11"/>
<text text-anchor="middle" x="1300" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 2 L48</text>
<text text-anchor="middle" x="1300" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1300" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1300" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert2 -->
<g id="node2386" class="node">
<title>layer48_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1823" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1823" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1823" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1823" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer48_moe_expert2&#45;&gt;layer48_moe_comm_from_expert2 -->
<g id="edge3058" class="edge">
<title>layer48_moe_expert2&#45;&gt;layer48_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1464.18,-9777C1469.77,-9777 1473,-9777 1473,-9777 1473,-9777 1473,-9686 1473,-9686 1473,-9686 1722.41,-9686 1722.41,-9686"/>
<polygon fill="black" stroke="black" points="1722.41,-9689.5 1732.41,-9686 1722.41,-9682.5 1722.41,-9689.5"/>
</g>
<!-- layer48_moe_comm_to_expert2&#45;&gt;layer48_moe_expert2 -->
<g id="edge3027" class="edge">
<title>layer48_moe_comm_to_expert2&#45;&gt;layer48_moe_expert2</title>
<path fill="none" stroke="black" d="M1663.39,-9868C1573.56,-9868 1449.25,-9868 1449.25,-9868 1449.25,-9868 1449.25,-9813.4 1449.25,-9813.4"/>
<polygon fill="black" stroke="black" points="1452.75,-9813.4 1449.25,-9803.4 1445.75,-9813.4 1452.75,-9813.4"/>
</g>
<!-- layer48_moe_expert3 -->
<g id="node2357" class="node">
<title>layer48_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1810,-9803.11 1482,-9803.11 1482,-9751.11 1810,-9751.11 1810,-9803.11"/>
<text text-anchor="middle" x="1646" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 3 L48</text>
<text text-anchor="middle" x="1646" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1646" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1646" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert3 -->
<g id="node2387" class="node">
<title>layer48_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2151" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2151" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2151" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2151" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer48_moe_expert3&#45;&gt;layer48_moe_comm_from_expert3 -->
<g id="edge3060" class="edge">
<title>layer48_moe_expert3&#45;&gt;layer48_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1771.25,-9750.88C1771.25,-9738.76 1771.25,-9727 1771.25,-9727 1771.25,-9727 2092.33,-9727 2092.33,-9727 2092.33,-9727 2092.33,-9718.47 2092.33,-9718.47"/>
<polygon fill="black" stroke="black" points="2095.83,-9718.47 2092.33,-9708.47 2088.83,-9718.47 2095.83,-9718.47"/>
</g>
<!-- layer48_moe_comm_to_expert3&#45;&gt;layer48_moe_expert3 -->
<g id="edge3029" class="edge">
<title>layer48_moe_comm_to_expert3&#45;&gt;layer48_moe_expert3</title>
<path fill="none" stroke="black" d="M2063,-9839.08C2063,-9829.38 2063,-9821 2063,-9821 2063,-9821 1736.75,-9821 1736.75,-9821 1736.75,-9821 1736.75,-9813.15 1736.75,-9813.15"/>
<polygon fill="black" stroke="black" points="1740.25,-9813.15 1736.75,-9803.15 1733.25,-9813.15 1740.25,-9813.15"/>
</g>
<!-- layer48_moe_expert4 -->
<g id="node2359" class="node">
<title>layer48_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2156,-9803.11 1828,-9803.11 1828,-9751.11 2156,-9751.11 2156,-9803.11"/>
<text text-anchor="middle" x="1992" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 4 L48</text>
<text text-anchor="middle" x="1992" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1992" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1992" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert4 -->
<g id="node2388" class="node">
<title>layer48_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2414" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2414" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2414" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2414" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer48_moe_expert4&#45;&gt;layer48_moe_comm_from_expert4 -->
<g id="edge3062" class="edge">
<title>layer48_moe_expert4&#45;&gt;layer48_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2124.16,-9751.06C2124.16,-9744.36 2124.16,-9739 2124.16,-9739 2124.16,-9739 2412.75,-9739 2412.75,-9739 2412.75,-9739 2412.75,-9725.34 2412.75,-9725.34"/>
<polygon fill="black" stroke="black" points="2416.25,-9725.34 2412.75,-9715.34 2409.25,-9725.34 2416.25,-9725.34"/>
</g>
<!-- layer48_moe_comm_to_expert4&#45;&gt;layer48_moe_expert4 -->
<g id="edge3031" class="edge">
<title>layer48_moe_comm_to_expert4&#45;&gt;layer48_moe_expert4</title>
<path fill="none" stroke="black" d="M2226.38,-9868C2193.48,-9868 2164.25,-9868 2164.25,-9868 2164.25,-9868 2164.25,-9777 2164.25,-9777 2164.25,-9777 2163.46,-9777 2163.46,-9777"/>
<polygon fill="black" stroke="black" points="2166.4,-9773.5 2156.4,-9777 2166.4,-9780.5 2166.4,-9773.5"/>
</g>
<!-- layer48_moe_expert5 -->
<g id="node2361" class="node">
<title>layer48_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2502,-9803.11 2174,-9803.11 2174,-9751.11 2502,-9751.11 2502,-9803.11"/>
<text text-anchor="middle" x="2338" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 5 L48</text>
<text text-anchor="middle" x="2338" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2338" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2338" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert5 -->
<g id="node2389" class="node">
<title>layer48_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2645" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2645" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2645" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2645" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer48_moe_expert5&#45;&gt;layer48_moe_comm_from_expert5 -->
<g id="edge3064" class="edge">
<title>layer48_moe_expert5&#45;&gt;layer48_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2502.18,-9777C2507.77,-9777 2511,-9777 2511,-9777 2511,-9777 2511,-9686 2511,-9686 2511,-9686 2544.14,-9686 2544.14,-9686"/>
<polygon fill="black" stroke="black" points="2544.14,-9689.5 2554.14,-9686 2544.14,-9682.5 2544.14,-9689.5"/>
</g>
<!-- layer48_moe_comm_to_expert5&#45;&gt;layer48_moe_expert5 -->
<g id="edge3033" class="edge">
<title>layer48_moe_comm_to_expert5&#45;&gt;layer48_moe_expert5</title>
<path fill="none" stroke="black" d="M2477.75,-9847.91C2477.75,-9847.91 2477.75,-9813.13 2477.75,-9813.13"/>
<polygon fill="black" stroke="black" points="2481.25,-9813.13 2477.75,-9803.13 2474.25,-9813.13 2481.25,-9813.13"/>
</g>
<!-- layer48_moe_expert6 -->
<g id="node2363" class="node">
<title>layer48_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2848,-9803.11 2520,-9803.11 2520,-9751.11 2848,-9751.11 2848,-9803.11"/>
<text text-anchor="middle" x="2684" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 6 L48</text>
<text text-anchor="middle" x="2684" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2684" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2684" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert6 -->
<g id="node2390" class="node">
<title>layer48_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2860" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2860" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2860" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2860" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer48_moe_expert6&#45;&gt;layer48_moe_comm_from_expert6 -->
<g id="edge3066" class="edge">
<title>layer48_moe_expert6&#45;&gt;layer48_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2808.75,-9750.79C2808.75,-9750.79 2808.75,-9720.2 2808.75,-9720.2"/>
<polygon fill="black" stroke="black" points="2812.25,-9720.2 2808.75,-9710.2 2805.25,-9720.2 2812.25,-9720.2"/>
</g>
<!-- layer48_moe_comm_to_expert6&#45;&gt;layer48_moe_expert6 -->
<g id="edge3035" class="edge">
<title>layer48_moe_comm_to_expert6&#45;&gt;layer48_moe_expert6</title>
<path fill="none" stroke="black" d="M2757,-9839.06C2757,-9839.06 2757,-9813.41 2757,-9813.41"/>
<polygon fill="black" stroke="black" points="2760.5,-9813.41 2757,-9803.41 2753.5,-9813.41 2760.5,-9813.41"/>
</g>
<!-- layer48_moe_expert7 -->
<g id="node2365" class="node">
<title>layer48_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3194,-9803.11 2866,-9803.11 2866,-9751.11 3194,-9751.11 3194,-9803.11"/>
<text text-anchor="middle" x="3030" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 7 L48</text>
<text text-anchor="middle" x="3030" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3030" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="3030" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert7 -->
<g id="node2391" class="node">
<title>layer48_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3067" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3067" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3067" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3067" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer48_moe_expert7&#45;&gt;layer48_moe_comm_from_expert7 -->
<g id="edge3068" class="edge">
<title>layer48_moe_expert7&#45;&gt;layer48_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3067,-9750.79C3067,-9750.79 3067,-9725.25 3067,-9725.25"/>
<polygon fill="black" stroke="black" points="3070.5,-9725.25 3067,-9715.25 3063.5,-9725.25 3070.5,-9725.25"/>
</g>
<!-- layer48_moe_comm_to_expert7&#45;&gt;layer48_moe_expert7 -->
<g id="edge3037" class="edge">
<title>layer48_moe_comm_to_expert7&#45;&gt;layer48_moe_expert7</title>
<path fill="none" stroke="black" d="M3067,-9839.06C3067,-9839.06 3067,-9813.41 3067,-9813.41"/>
<polygon fill="black" stroke="black" points="3070.5,-9813.41 3067,-9803.41 3063.5,-9813.41 3070.5,-9813.41"/>
</g>
<!-- layer48_moe_expert8 -->
<g id="node2367" class="node">
<title>layer48_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3540,-9803.11 3212,-9803.11 3212,-9751.11 3540,-9751.11 3540,-9803.11"/>
<text text-anchor="middle" x="3376" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 8 L48</text>
<text text-anchor="middle" x="3376" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3376" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3376" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert8 -->
<g id="node2392" class="node">
<title>layer48_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3339" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3339" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3339" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3339" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer48_moe_expert8&#45;&gt;layer48_moe_comm_from_expert8 -->
<g id="edge3070" class="edge">
<title>layer48_moe_expert8&#45;&gt;layer48_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3339,-9750.79C3339,-9750.79 3339,-9725.25 3339,-9725.25"/>
<polygon fill="black" stroke="black" points="3342.5,-9725.25 3339,-9715.25 3335.5,-9725.25 3342.5,-9725.25"/>
</g>
<!-- layer48_moe_comm_to_expert8&#45;&gt;layer48_moe_expert8 -->
<g id="edge3039" class="edge">
<title>layer48_moe_comm_to_expert8&#45;&gt;layer48_moe_expert8</title>
<path fill="none" stroke="black" d="M3339,-9839.06C3339,-9839.06 3339,-9813.41 3339,-9813.41"/>
<polygon fill="black" stroke="black" points="3342.5,-9813.41 3339,-9803.41 3335.5,-9813.41 3342.5,-9813.41"/>
</g>
<!-- layer48_moe_expert9 -->
<g id="node2369" class="node">
<title>layer48_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3886,-9803.11 3558,-9803.11 3558,-9751.11 3886,-9751.11 3886,-9803.11"/>
<text text-anchor="middle" x="3722" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 9 L48</text>
<text text-anchor="middle" x="3722" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3722" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3722" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert9 -->
<g id="node2393" class="node">
<title>layer48_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3648" cy="-9686.12" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3648" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3648" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3648" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer48_moe_expert9&#45;&gt;layer48_moe_comm_from_expert9 -->
<g id="edge3072" class="edge">
<title>layer48_moe_expert9&#45;&gt;layer48_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3648.25,-9750.79C3648.25,-9750.79 3648.25,-9725.25 3648.25,-9725.25"/>
<polygon fill="black" stroke="black" points="3651.75,-9725.25 3648.25,-9715.25 3644.75,-9725.25 3651.75,-9725.25"/>
</g>
<!-- layer48_moe_comm_to_expert9&#45;&gt;layer48_moe_expert9 -->
<g id="edge3041" class="edge">
<title>layer48_moe_comm_to_expert9&#45;&gt;layer48_moe_expert9</title>
<path fill="none" stroke="black" d="M3648.25,-9839.06C3648.25,-9839.06 3648.25,-9813.41 3648.25,-9813.41"/>
<polygon fill="black" stroke="black" points="3651.75,-9813.41 3648.25,-9803.41 3644.75,-9813.41 3651.75,-9813.41"/>
</g>
<!-- layer48_moe_expert10 -->
<g id="node2371" class="node">
<title>layer48_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4242,-9803.11 3904,-9803.11 3904,-9751.11 4242,-9751.11 4242,-9803.11"/>
<text text-anchor="middle" x="4073" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 10 L48</text>
<text text-anchor="middle" x="4073" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4073" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4073" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert10 -->
<g id="node2394" class="node">
<title>layer48_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3980" cy="-9686.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3980" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3980" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3980" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer48_moe_expert10&#45;&gt;layer48_moe_comm_from_expert10 -->
<g id="edge3074" class="edge">
<title>layer48_moe_expert10&#45;&gt;layer48_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3989.38,-9750.79C3989.38,-9750.79 3989.38,-9725.25 3989.38,-9725.25"/>
<polygon fill="black" stroke="black" points="3992.88,-9725.25 3989.38,-9715.25 3985.88,-9725.25 3992.88,-9725.25"/>
</g>
<!-- layer48_moe_comm_to_expert10&#45;&gt;layer48_moe_expert10 -->
<g id="edge3043" class="edge">
<title>layer48_moe_comm_to_expert10&#45;&gt;layer48_moe_expert10</title>
<path fill="none" stroke="black" d="M3989.02,-9839.06C3989.02,-9839.06 3989.02,-9813.41 3989.02,-9813.41"/>
<polygon fill="black" stroke="black" points="3992.52,-9813.41 3989.02,-9803.41 3985.52,-9813.41 3992.52,-9813.41"/>
</g>
<!-- layer48_moe_expert11 -->
<g id="node2373" class="node">
<title>layer48_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4598,-9803.11 4260,-9803.11 4260,-9751.11 4598,-9751.11 4598,-9803.11"/>
<text text-anchor="middle" x="4429" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 11 L48</text>
<text text-anchor="middle" x="4429" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4429" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4429" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert11 -->
<g id="node2395" class="node">
<title>layer48_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4327" cy="-9686.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4327" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4327" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4327" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer48_moe_expert11&#45;&gt;layer48_moe_comm_from_expert11 -->
<g id="edge3076" class="edge">
<title>layer48_moe_expert11&#45;&gt;layer48_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4340.88,-9750.79C4340.88,-9750.79 4340.88,-9724.92 4340.88,-9724.92"/>
<polygon fill="black" stroke="black" points="4344.38,-9724.92 4340.88,-9714.92 4337.38,-9724.92 4344.38,-9724.92"/>
</g>
<!-- layer48_moe_comm_to_expert11&#45;&gt;layer48_moe_expert11 -->
<g id="edge3045" class="edge">
<title>layer48_moe_comm_to_expert11&#45;&gt;layer48_moe_expert11</title>
<path fill="none" stroke="black" d="M4340.02,-9839.31C4340.02,-9839.31 4340.02,-9813.24 4340.02,-9813.24"/>
<polygon fill="black" stroke="black" points="4343.52,-9813.24 4340.02,-9803.24 4336.52,-9813.24 4343.52,-9813.24"/>
</g>
<!-- layer48_moe_expert12 -->
<g id="node2375" class="node">
<title>layer48_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4954,-9803.11 4616,-9803.11 4616,-9751.11 4954,-9751.11 4954,-9803.11"/>
<text text-anchor="middle" x="4785" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 12 L48</text>
<text text-anchor="middle" x="4785" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4785" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4785" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert12 -->
<g id="node2396" class="node">
<title>layer48_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4678" cy="-9686.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4678" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4678" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4678" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer48_moe_expert12&#45;&gt;layer48_moe_comm_from_expert12 -->
<g id="edge3078" class="edge">
<title>layer48_moe_expert12&#45;&gt;layer48_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4694.38,-9750.79C4694.38,-9750.79 4694.38,-9724.92 4694.38,-9724.92"/>
<polygon fill="black" stroke="black" points="4697.88,-9724.92 4694.38,-9714.92 4690.88,-9724.92 4697.88,-9724.92"/>
</g>
<!-- layer48_moe_comm_to_expert12&#45;&gt;layer48_moe_expert12 -->
<g id="edge3047" class="edge">
<title>layer48_moe_comm_to_expert12&#45;&gt;layer48_moe_expert12</title>
<path fill="none" stroke="black" d="M4693.52,-9839.31C4693.52,-9839.31 4693.52,-9813.24 4693.52,-9813.24"/>
<polygon fill="black" stroke="black" points="4697.02,-9813.24 4693.52,-9803.24 4690.02,-9813.24 4697.02,-9813.24"/>
</g>
<!-- layer48_moe_expert13 -->
<g id="node2377" class="node">
<title>layer48_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5310,-9803.11 4972,-9803.11 4972,-9751.11 5310,-9751.11 5310,-9803.11"/>
<text text-anchor="middle" x="5141" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 13 L48</text>
<text text-anchor="middle" x="5141" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5141" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5141" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert13 -->
<g id="node2397" class="node">
<title>layer48_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="5032" cy="-9686.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5032" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="5032" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5032" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer48_moe_expert13&#45;&gt;layer48_moe_comm_from_expert13 -->
<g id="edge3080" class="edge">
<title>layer48_moe_expert13&#45;&gt;layer48_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5049.38,-9750.79C5049.38,-9750.79 5049.38,-9724.92 5049.38,-9724.92"/>
<polygon fill="black" stroke="black" points="5052.88,-9724.92 5049.38,-9714.92 5045.88,-9724.92 5052.88,-9724.92"/>
</g>
<!-- layer48_moe_comm_to_expert13&#45;&gt;layer48_moe_expert13 -->
<g id="edge3049" class="edge">
<title>layer48_moe_comm_to_expert13&#45;&gt;layer48_moe_expert13</title>
<path fill="none" stroke="black" d="M5048.02,-9839.31C5048.02,-9839.31 5048.02,-9813.24 5048.02,-9813.24"/>
<polygon fill="black" stroke="black" points="5051.52,-9813.24 5048.02,-9803.24 5044.52,-9813.24 5051.52,-9813.24"/>
</g>
<!-- layer48_moe_expert14 -->
<g id="node2379" class="node">
<title>layer48_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5666,-9803.11 5328,-9803.11 5328,-9751.11 5666,-9751.11 5666,-9803.11"/>
<text text-anchor="middle" x="5497" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 14 L48</text>
<text text-anchor="middle" x="5497" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5497" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5497" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert14 -->
<g id="node2398" class="node">
<title>layer48_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5387" cy="-9686.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5387" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5387" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5387" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer48_moe_expert14&#45;&gt;layer48_moe_comm_from_expert14 -->
<g id="edge3082" class="edge">
<title>layer48_moe_expert14&#45;&gt;layer48_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5404.88,-9750.79C5404.88,-9750.79 5404.88,-9724.6 5404.88,-9724.6"/>
<polygon fill="black" stroke="black" points="5408.38,-9724.6 5404.88,-9714.6 5401.38,-9724.6 5408.38,-9724.6"/>
</g>
<!-- layer48_moe_comm_to_expert14&#45;&gt;layer48_moe_expert14 -->
<g id="edge3051" class="edge">
<title>layer48_moe_comm_to_expert14&#45;&gt;layer48_moe_expert14</title>
<path fill="none" stroke="black" d="M5403.52,-9839.31C5403.52,-9839.31 5403.52,-9813.24 5403.52,-9813.24"/>
<polygon fill="black" stroke="black" points="5407.02,-9813.24 5403.52,-9803.24 5400.02,-9813.24 5407.02,-9813.24"/>
</g>
<!-- layer48_moe_expert15 -->
<g id="node2381" class="node">
<title>layer48_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="6022,-9803.11 5684,-9803.11 5684,-9751.11 6022,-9751.11 6022,-9803.11"/>
<text text-anchor="middle" x="5853" y="-9791.11" font-family="Arial" font-size="10.00">EXPERT 15 L48</text>
<text text-anchor="middle" x="5853" y="-9780.11" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5853" y="-9769.11" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5853" y="-9758.11" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_comm_from_expert15 -->
<g id="node2399" class="node">
<title>layer48_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5742" cy="-9686.12" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5742" y="-9694.62" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5742" y="-9683.62" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5742" y="-9672.62" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer48_moe_expert15&#45;&gt;layer48_moe_comm_from_expert15 -->
<g id="edge3084" class="edge">
<title>layer48_moe_expert15&#45;&gt;layer48_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5760.38,-9750.79C5760.38,-9750.79 5760.38,-9724.6 5760.38,-9724.6"/>
<polygon fill="black" stroke="black" points="5763.88,-9724.6 5760.38,-9714.6 5756.88,-9724.6 5763.88,-9724.6"/>
</g>
<!-- layer48_moe_comm_to_expert15&#45;&gt;layer48_moe_expert15 -->
<g id="edge3053" class="edge">
<title>layer48_moe_comm_to_expert15&#45;&gt;layer48_moe_expert15</title>
<path fill="none" stroke="black" d="M5759.02,-9839.31C5759.02,-9839.31 5759.02,-9813.24 5759.02,-9813.24"/>
<polygon fill="black" stroke="black" points="5762.52,-9813.24 5759.02,-9803.24 5755.52,-9813.24 5762.52,-9813.24"/>
</g>
<!-- layer48_moe_aggregate -->
<g id="node2383" class="node">
<title>layer48_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3428.1,-9621.13 3011.16,-9621.13 2903.9,-9517.13 3320.84,-9517.13 3428.1,-9621.13"/>
<text text-anchor="middle" x="3166" y="-9583.13" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L48</text>
<text text-anchor="middle" x="3166" y="-9572.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3166" y="-9561.13" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3166" y="-9550.13" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_mha -->
<g id="node2400" class="node">
<title>layer49_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3296,-9481.13 3036,-9481.13 3036,-9429.13 3296,-9429.13 3296,-9481.13"/>
<text text-anchor="middle" x="3166" y="-9469.13" font-family="Arial" font-size="10.00">MHA L49</text>
<text text-anchor="middle" x="3166" y="-9458.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3166" y="-9447.13" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3166" y="-9436.13" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer48_moe_aggregate&#45;&gt;layer49_moe_mha -->
<g id="edge3153" class="edge">
<title>layer48_moe_aggregate&#45;&gt;layer49_moe_mha</title>
<path fill="none" stroke="black" d="M3166,-9516.8C3166,-9516.8 3166,-9491.35 3166,-9491.35"/>
<polygon fill="black" stroke="black" points="3169.5,-9491.35 3166,-9481.35 3162.5,-9491.35 3169.5,-9491.35"/>
</g>
<!-- layer48_moe_comm_from_expert0&#45;&gt;layer48_moe_aggregate -->
<g id="edge3055" class="edge">
<title>layer48_moe_comm_from_expert0&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M739.75,-9676.41C739.75,-9642.45 739.75,-9531 739.75,-9531 739.75,-9531 2908.03,-9531 2908.03,-9531"/>
<polygon fill="black" stroke="black" points="2908.03,-9534.5 2918.03,-9531 2908.03,-9527.5 2908.03,-9534.5"/>
</g>
<!-- layer48_moe_comm_from_expert1&#45;&gt;layer48_moe_aggregate -->
<g id="edge3057" class="edge">
<title>layer48_moe_comm_from_expert1&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M1451.25,-9675.12C1451.25,-9642.09 1451.25,-9546 1451.25,-9546 1451.25,-9546 2923.4,-9546 2923.4,-9546"/>
<polygon fill="black" stroke="black" points="2923.4,-9549.5 2933.4,-9546 2923.4,-9542.5 2923.4,-9549.5"/>
</g>
<!-- layer48_moe_comm_from_expert2&#45;&gt;layer48_moe_aggregate -->
<g id="edge3059" class="edge">
<title>layer48_moe_comm_from_expert2&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M1895.01,-9668.46C1895.01,-9633.97 1895.01,-9561 1895.01,-9561 1895.01,-9561 2938.95,-9561 2938.95,-9561"/>
<polygon fill="black" stroke="black" points="2938.95,-9564.5 2948.95,-9561 2938.95,-9557.5 2938.95,-9564.5"/>
</g>
<!-- layer48_moe_comm_from_expert3&#45;&gt;layer48_moe_aggregate -->
<g id="edge3061" class="edge">
<title>layer48_moe_comm_from_expert3&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M2223.01,-9668.42C2223.01,-9637.3 2223.01,-9576 2223.01,-9576 2223.01,-9576 2954.57,-9576 2954.57,-9576"/>
<polygon fill="black" stroke="black" points="2954.57,-9579.5 2964.57,-9576 2954.57,-9572.5 2954.57,-9579.5"/>
</g>
<!-- layer48_moe_comm_from_expert4&#45;&gt;layer48_moe_aggregate -->
<g id="edge3063" class="edge">
<title>layer48_moe_comm_from_expert4&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M2493.75,-9672.08C2493.75,-9645.62 2493.75,-9591 2493.75,-9591 2493.75,-9591 2970.08,-9591 2970.08,-9591"/>
<polygon fill="black" stroke="black" points="2970.08,-9594.5 2980.08,-9591 2970.08,-9587.5 2970.08,-9594.5"/>
</g>
<!-- layer48_moe_comm_from_expert5&#45;&gt;layer48_moe_aggregate -->
<g id="edge3065" class="edge">
<title>layer48_moe_comm_from_expert5&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M2715.5,-9667.53C2715.5,-9643.87 2715.5,-9606 2715.5,-9606 2715.5,-9606 2985.36,-9606 2985.36,-9606"/>
<polygon fill="black" stroke="black" points="2985.36,-9609.5 2995.36,-9606 2985.36,-9602.5 2985.36,-9609.5"/>
</g>
<!-- layer48_moe_comm_from_expert6&#45;&gt;layer48_moe_aggregate -->
<g id="edge3067" class="edge">
<title>layer48_moe_comm_from_expert6&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M2927.11,-9666.53C2927.11,-9666.53 2927.11,-9579.17 2927.11,-9579.17"/>
<polygon fill="black" stroke="black" points="2930.61,-9579.17 2927.11,-9569.17 2923.61,-9579.17 2930.61,-9579.17"/>
</g>
<!-- layer48_moe_comm_from_expert7&#45;&gt;layer48_moe_aggregate -->
<g id="edge3069" class="edge">
<title>layer48_moe_comm_from_expert7&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M3067,-9656.9C3067,-9656.9 3067,-9631.18 3067,-9631.18"/>
<polygon fill="black" stroke="black" points="3070.5,-9631.18 3067,-9621.18 3063.5,-9631.18 3070.5,-9631.18"/>
</g>
<!-- layer48_moe_comm_from_expert8&#45;&gt;layer48_moe_aggregate -->
<g id="edge3071" class="edge">
<title>layer48_moe_comm_from_expert8&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M3338.39,-9656.9C3338.39,-9656.9 3338.39,-9631.18 3338.39,-9631.18"/>
<polygon fill="black" stroke="black" points="3341.89,-9631.18 3338.39,-9621.18 3334.89,-9631.18 3341.89,-9631.18"/>
</g>
<!-- layer48_moe_comm_from_expert9&#45;&gt;layer48_moe_aggregate -->
<g id="edge3073" class="edge">
<title>layer48_moe_comm_from_expert9&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M3629.5,-9657.47C3629.5,-9635.18 3629.5,-9608 3629.5,-9608 3629.5,-9608 3424.71,-9608 3424.71,-9608"/>
<polygon fill="black" stroke="black" points="3424.71,-9604.5 3414.71,-9608 3424.71,-9611.5 3424.71,-9604.5"/>
</g>
<!-- layer48_moe_comm_from_expert10&#45;&gt;layer48_moe_aggregate -->
<g id="edge3075" class="edge">
<title>layer48_moe_comm_from_expert10&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M3961.15,-9657.29C3961.15,-9630.59 3961.15,-9595 3961.15,-9595 3961.15,-9595 3411.34,-9595 3411.34,-9595"/>
<polygon fill="black" stroke="black" points="3411.34,-9591.5 3401.34,-9595 3411.34,-9598.5 3411.34,-9591.5"/>
</g>
<!-- layer48_moe_comm_from_expert11&#45;&gt;layer48_moe_aggregate -->
<g id="edge3077" class="edge">
<title>layer48_moe_comm_from_expert11&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M4307.65,-9657.67C4307.65,-9626.84 4307.65,-9582 4307.65,-9582 4307.65,-9582 3397.81,-9582 3397.81,-9582"/>
<polygon fill="black" stroke="black" points="3397.81,-9578.5 3387.81,-9582 3397.81,-9585.5 3397.81,-9578.5"/>
</g>
<!-- layer48_moe_comm_from_expert12&#45;&gt;layer48_moe_aggregate -->
<g id="edge3079" class="edge">
<title>layer48_moe_comm_from_expert12&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M4658.65,-9657.47C4658.65,-9622.79 4658.65,-9569 4658.65,-9569 4658.65,-9569 3384.72,-9569 3384.72,-9569"/>
<polygon fill="black" stroke="black" points="3384.72,-9565.5 3374.72,-9569 3384.72,-9572.5 3384.72,-9565.5"/>
</g>
<!-- layer48_moe_comm_from_expert13&#45;&gt;layer48_moe_aggregate -->
<g id="edge3081" class="edge">
<title>layer48_moe_comm_from_expert13&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M5012.15,-9657.56C5012.15,-9619.26 5012.15,-9556 5012.15,-9556 5012.15,-9556 3370.95,-9556 3370.95,-9556"/>
<polygon fill="black" stroke="black" points="3370.95,-9552.5 3360.95,-9556 3370.95,-9559.5 3370.95,-9552.5"/>
</g>
<!-- layer48_moe_comm_from_expert14&#45;&gt;layer48_moe_aggregate -->
<g id="edge3083" class="edge">
<title>layer48_moe_comm_from_expert14&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M5367.15,-9657.5C5367.15,-9615.73 5367.15,-9543 5367.15,-9543 5367.15,-9543 3357.53,-9543 3357.53,-9543"/>
<polygon fill="black" stroke="black" points="3357.53,-9539.5 3347.53,-9543 3357.53,-9546.5 3357.53,-9539.5"/>
</g>
<!-- layer48_moe_comm_from_expert15&#45;&gt;layer48_moe_aggregate -->
<g id="edge3085" class="edge">
<title>layer48_moe_comm_from_expert15&#45;&gt;layer48_moe_aggregate</title>
<path fill="none" stroke="black" d="M5722.15,-9657.48C5722.15,-9612.41 5722.15,-9530 5722.15,-9530 5722.15,-9530 3344.21,-9530 3344.21,-9530"/>
<polygon fill="black" stroke="black" points="3344.21,-9526.5 3334.21,-9530 3344.21,-9533.5 3344.21,-9526.5"/>
</g>
<!-- layer49_moe_gate -->
<g id="node2401" class="node">
<title>layer49_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3424.3,-9393.13 3013.4,-9393.13 2907.7,-9289.13 3318.6,-9289.13 3424.3,-9393.13"/>
<text text-anchor="middle" x="3166" y="-9355.13" font-family="Arial" font-size="10.00">GATE L49</text>
<text text-anchor="middle" x="3166" y="-9344.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3166" y="-9333.13" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3166" y="-9322.13" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer49_moe_mha&#45;&gt;layer49_moe_gate -->
<g id="edge3154" class="edge">
<title>layer49_moe_mha&#45;&gt;layer49_moe_gate</title>
<path fill="none" stroke="black" d="M3166,-9428.97C3166,-9428.97 3166,-9403.22 3166,-9403.22"/>
<polygon fill="black" stroke="black" points="3169.5,-9403.22 3166,-9393.22 3162.5,-9403.22 3169.5,-9403.22"/>
</g>
<!-- layer49_moe_split -->
<g id="node2402" class="node">
<title>layer49_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3420.01,-9253.13 3015.94,-9253.13 2911.99,-9149.13 3316.06,-9149.13 3420.01,-9253.13"/>
<text text-anchor="middle" x="3166" y="-9215.13" font-family="Arial" font-size="10.00">SPLIT TOKENS L49</text>
<text text-anchor="middle" x="3166" y="-9204.13" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3166" y="-9193.13" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3166" y="-9182.13" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer49_moe_gate&#45;&gt;layer49_moe_split -->
<g id="edge3155" class="edge">
<title>layer49_moe_gate&#45;&gt;layer49_moe_split</title>
<path fill="none" stroke="black" d="M3166,-9288.99C3166,-9288.99 3166,-9263.3 3166,-9263.3"/>
<polygon fill="black" stroke="black" points="3169.5,-9263.3 3166,-9253.3 3162.5,-9263.3 3169.5,-9263.3"/>
</g>
<!-- layer49_moe_comm_to_expert0 -->
<g id="node2404" class="node">
<title>layer49_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1085" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1085" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1085" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1085" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert0 -->
<g id="edge3089" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3000.64,-9238C2519.77,-9238 1155.75,-9238 1155.75,-9238 1155.75,-9238 1155.75,-9112.39 1155.75,-9112.39"/>
<polygon fill="black" stroke="black" points="1159.25,-9112.39 1155.75,-9102.39 1152.25,-9112.39 1159.25,-9112.39"/>
</g>
<!-- layer49_moe_comm_to_expert1 -->
<g id="node2406" class="node">
<title>layer49_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1330" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1330" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1330" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1330" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert1 -->
<g id="edge3091" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2985.5,-9223C2526.09,-9223 1348.5,-9223 1348.5,-9223 1348.5,-9223 1348.5,-9122.57 1348.5,-9122.57"/>
<polygon fill="black" stroke="black" points="1352,-9122.57 1348.5,-9112.57 1345,-9122.57 1352,-9122.57"/>
</g>
<!-- layer49_moe_comm_to_expert2 -->
<g id="node2408" class="node">
<title>layer49_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1786" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1786" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1786" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1786" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert2 -->
<g id="edge3093" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2970.57,-9208C2593.96,-9208 1804.5,-9208 1804.5,-9208 1804.5,-9208 1804.5,-9122.55 1804.5,-9122.55"/>
<polygon fill="black" stroke="black" points="1808,-9122.55 1804.5,-9112.55 1801,-9122.55 1808,-9122.55"/>
</g>
<!-- layer49_moe_comm_to_expert3 -->
<g id="node2410" class="node">
<title>layer49_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2114" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2114" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2114" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2114" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert3 -->
<g id="edge3095" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2955.61,-9193C2653.43,-9193 2132.5,-9193 2132.5,-9193 2132.5,-9193 2132.5,-9122.74 2132.5,-9122.74"/>
<polygon fill="black" stroke="black" points="2136,-9122.74 2132.5,-9112.74 2129,-9122.74 2136,-9122.74"/>
</g>
<!-- layer49_moe_comm_to_expert4 -->
<g id="node2412" class="node">
<title>layer49_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2377" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2377" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2377" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2377" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert4 -->
<g id="edge3097" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2940.81,-9178C2713.4,-9178 2395.5,-9178 2395.5,-9178 2395.5,-9178 2395.5,-9122.55 2395.5,-9122.55"/>
<polygon fill="black" stroke="black" points="2399,-9122.55 2395.5,-9112.55 2392,-9122.55 2399,-9122.55"/>
</g>
<!-- layer49_moe_comm_to_expert5 -->
<g id="node2414" class="node">
<title>layer49_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2608" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2608" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2608" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2608" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert5 -->
<g id="edge3099" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2925.83,-9163C2781.86,-9163 2626.5,-9163 2626.5,-9163 2626.5,-9163 2626.5,-9122.61 2626.5,-9122.61"/>
<polygon fill="black" stroke="black" points="2630,-9122.61 2626.5,-9112.61 2623,-9122.61 2630,-9122.61"/>
</g>
<!-- layer49_moe_comm_to_expert6 -->
<g id="node2416" class="node">
<title>layer49_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2823" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2823" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2823" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2823" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert6 -->
<g id="edge3101" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2926.5,-9201.04C2926.5,-9197.49 2926.5,-9084 2926.5,-9084 2926.5,-9084 2923.81,-9084 2923.81,-9084"/>
<polygon fill="black" stroke="black" points="2923.81,-9080.5 2913.81,-9084 2923.81,-9087.5 2923.81,-9080.5"/>
</g>
<!-- layer49_moe_comm_to_expert7 -->
<g id="node2418" class="node">
<title>layer49_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3030" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3030" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="3030" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3030" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert7 -->
<g id="edge3103" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3030,-9148.79C3030,-9148.79 3030,-9123.34 3030,-9123.34"/>
<polygon fill="black" stroke="black" points="3033.5,-9123.34 3030,-9113.34 3026.5,-9123.34 3033.5,-9123.34"/>
</g>
<!-- layer49_moe_comm_to_expert8 -->
<g id="node2420" class="node">
<title>layer49_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3302" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3302" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3302" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3302" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert8 -->
<g id="edge3105" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3302,-9148.79C3302,-9148.79 3302,-9123.34 3302,-9123.34"/>
<polygon fill="black" stroke="black" points="3305.5,-9123.34 3302,-9113.34 3298.5,-9123.34 3305.5,-9123.34"/>
</g>
<!-- layer49_moe_comm_to_expert9 -->
<g id="node2422" class="node">
<title>layer49_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3611" cy="-9084.13" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3611" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3611" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3611" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert9 -->
<g id="edge3107" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3406.26,-9201.04C3406.26,-9197.49 3406.26,-9084 3406.26,-9084 3406.26,-9084 3510.3,-9084 3510.3,-9084"/>
<polygon fill="black" stroke="black" points="3510.3,-9087.5 3520.3,-9084 3510.3,-9080.5 3510.3,-9087.5"/>
</g>
<!-- layer49_moe_comm_to_expert10 -->
<g id="node2424" class="node">
<title>layer49_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3943" cy="-9084.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3943" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3943" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3943" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert10 -->
<g id="edge3109" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3329.93,-9163C3537.13,-9163 3867.1,-9163 3867.1,-9163 3867.1,-9163 3867.1,-9111.64 3867.1,-9111.64"/>
<polygon fill="black" stroke="black" points="3870.6,-9111.64 3867.1,-9101.64 3863.6,-9111.64 3870.6,-9111.64"/>
</g>
<!-- layer49_moe_comm_to_expert11 -->
<g id="node2426" class="node">
<title>layer49_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4289" cy="-9084.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4289" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4289" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4289" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert11 -->
<g id="edge3111" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3345.2,-9178C3644.48,-9178 4213.6,-9178 4213.6,-9178 4213.6,-9178 4213.6,-9111.79 4213.6,-9111.79"/>
<polygon fill="black" stroke="black" points="4217.1,-9111.79 4213.6,-9101.79 4210.1,-9111.79 4217.1,-9111.79"/>
</g>
<!-- layer49_moe_comm_to_expert12 -->
<g id="node2428" class="node">
<title>layer49_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4640" cy="-9084.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4640" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4640" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4640" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert12 -->
<g id="edge3113" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3360.1,-9193C3744.24,-9193 4564.6,-9193 4564.6,-9193 4564.6,-9193 4564.6,-9111.63 4564.6,-9111.63"/>
<polygon fill="black" stroke="black" points="4568.1,-9111.63 4564.6,-9101.63 4561.1,-9111.63 4568.1,-9111.63"/>
</g>
<!-- layer49_moe_comm_to_expert13 -->
<g id="node2430" class="node">
<title>layer49_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4993" cy="-9084.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4993" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4993" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4993" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert13 -->
<g id="edge3115" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3375.17,-9208C3840,-9208 4918.1,-9208 4918.1,-9208 4918.1,-9208 4918.1,-9111.88 4918.1,-9111.88"/>
<polygon fill="black" stroke="black" points="4921.6,-9111.88 4918.1,-9101.88 4914.6,-9111.88 4921.6,-9111.88"/>
</g>
<!-- layer49_moe_comm_to_expert14 -->
<g id="node2432" class="node">
<title>layer49_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5348" cy="-9084.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5348" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5348" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5348" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert14 -->
<g id="edge3117" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3390,-9223C3932.61,-9223 5273.1,-9223 5273.1,-9223 5273.1,-9223 5273.1,-9111.72 5273.1,-9111.72"/>
<polygon fill="black" stroke="black" points="5276.6,-9111.72 5273.1,-9101.72 5269.6,-9111.72 5276.6,-9111.72"/>
</g>
<!-- layer49_moe_comm_to_expert15 -->
<g id="node2434" class="node">
<title>layer49_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5703" cy="-9084.13" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5703" y="-9092.63" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5703" y="-9081.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5703" y="-9070.63" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert15 -->
<g id="edge3119" class="edge">
<title>layer49_moe_split&#45;&gt;layer49_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3405.15,-9238C4023.66,-9238 5628.1,-9238 5628.1,-9238 5628.1,-9238 5628.1,-9111.78 5628.1,-9111.78"/>
<polygon fill="black" stroke="black" points="5631.6,-9111.78 5628.1,-9101.78 5624.6,-9111.78 5631.6,-9111.78"/>
</g>
<!-- layer49_moe_expert0 -->
<g id="node2403" class="node">
<title>layer49_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="735,-9019.14 407,-9019.14 407,-8967.14 735,-8967.14 735,-9019.14"/>
<text text-anchor="middle" x="571" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 0 L49</text>
<text text-anchor="middle" x="571" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="571" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="571" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert0 -->
<g id="node2436" class="node">
<title>layer49_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="617" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="617" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="617" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="617" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer49_moe_expert0&#45;&gt;layer49_moe_comm_from_expert0 -->
<g id="edge3121" class="edge">
<title>layer49_moe_expert0&#45;&gt;layer49_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M617,-8966.82C617,-8966.82 617,-8941.28 617,-8941.28"/>
<polygon fill="black" stroke="black" points="620.5,-8941.28 617,-8931.28 613.5,-8941.28 620.5,-8941.28"/>
</g>
<!-- layer49_moe_comm_to_expert0&#45;&gt;layer49_moe_expert0 -->
<g id="edge3090" class="edge">
<title>layer49_moe_comm_to_expert0&#45;&gt;layer49_moe_expert0</title>
<path fill="none" stroke="black" d="M994.45,-9084C866.78,-9084 649.25,-9084 649.25,-9084 649.25,-9084 649.25,-9029.42 649.25,-9029.42"/>
<polygon fill="black" stroke="black" points="652.75,-9029.42 649.25,-9019.42 645.75,-9029.42 652.75,-9029.42"/>
</g>
<!-- layer49_moe_expert1 -->
<g id="node2405" class="node">
<title>layer49_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1081,-9019.14 753,-9019.14 753,-8967.14 1081,-8967.14 1081,-9019.14"/>
<text text-anchor="middle" x="917" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 1 L49</text>
<text text-anchor="middle" x="917" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="917" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="917" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert1 -->
<g id="node2437" class="node">
<title>layer49_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1330" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1330" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1330" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1330" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer49_moe_expert1&#45;&gt;layer49_moe_comm_from_expert1 -->
<g id="edge3123" class="edge">
<title>layer49_moe_expert1&#45;&gt;layer49_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M1071.5,-8966.78C1071.5,-8939.86 1071.5,-8902 1071.5,-8902 1071.5,-8902 1229.23,-8902 1229.23,-8902"/>
<polygon fill="black" stroke="black" points="1229.23,-8905.5 1239.23,-8902 1229.23,-8898.5 1229.23,-8905.5"/>
</g>
<!-- layer49_moe_comm_to_expert1&#45;&gt;layer49_moe_expert1 -->
<g id="edge3092" class="edge">
<title>layer49_moe_comm_to_expert1&#45;&gt;layer49_moe_expert1</title>
<path fill="none" stroke="black" d="M1330,-9055.08C1330,-9041.38 1330,-9028 1330,-9028 1330,-9028 1037.75,-9028 1037.75,-9028 1037.75,-9028 1037.75,-9027.12 1037.75,-9027.12"/>
<polygon fill="black" stroke="black" points="1041.25,-9029.2 1037.75,-9019.2 1034.25,-9029.2 1041.25,-9029.2"/>
</g>
<!-- layer49_moe_expert2 -->
<g id="node2407" class="node">
<title>layer49_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1427,-9019.14 1099,-9019.14 1099,-8967.14 1427,-8967.14 1427,-9019.14"/>
<text text-anchor="middle" x="1263" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 2 L49</text>
<text text-anchor="middle" x="1263" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1263" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1263" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert2 -->
<g id="node2438" class="node">
<title>layer49_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1786" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1786" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1786" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1786" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer49_moe_expert2&#45;&gt;layer49_moe_comm_from_expert2 -->
<g id="edge3125" class="edge">
<title>layer49_moe_expert2&#45;&gt;layer49_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1427.18,-8984C1434.6,-8984 1439,-8984 1439,-8984 1439,-8984 1439,-8902 1439,-8902 1439,-8902 1685.28,-8902 1685.28,-8902"/>
<polygon fill="black" stroke="black" points="1685.28,-8905.5 1695.28,-8902 1685.28,-8898.5 1685.28,-8905.5"/>
</g>
<!-- layer49_moe_comm_to_expert2&#45;&gt;layer49_moe_expert2 -->
<g id="edge3094" class="edge">
<title>layer49_moe_comm_to_expert2&#45;&gt;layer49_moe_expert2</title>
<path fill="none" stroke="black" d="M1695.09,-9084C1590.5,-9084 1433,-9084 1433,-9084 1433,-9084 1433,-9001 1433,-9001 1433,-9001 1432.43,-9001 1432.43,-9001"/>
<polygon fill="black" stroke="black" points="1437.34,-8997.5 1427.34,-9001 1437.34,-9004.5 1437.34,-8997.5"/>
</g>
<!-- layer49_moe_expert3 -->
<g id="node2409" class="node">
<title>layer49_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1773,-9019.14 1445,-9019.14 1445,-8967.14 1773,-8967.14 1773,-9019.14"/>
<text text-anchor="middle" x="1609" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 3 L49</text>
<text text-anchor="middle" x="1609" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1609" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1609" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert3 -->
<g id="node2439" class="node">
<title>layer49_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2114" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2114" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2114" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2114" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer49_moe_expert3&#45;&gt;layer49_moe_comm_from_expert3 -->
<g id="edge3127" class="edge">
<title>layer49_moe_expert3&#45;&gt;layer49_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1734.25,-8966.9C1734.25,-8954.76 1734.25,-8943 1734.25,-8943 1734.25,-8943 2055.33,-8943 2055.33,-8943 2055.33,-8943 2055.33,-8934.49 2055.33,-8934.49"/>
<polygon fill="black" stroke="black" points="2058.83,-8934.49 2055.33,-8924.49 2051.83,-8934.49 2058.83,-8934.49"/>
</g>
<!-- layer49_moe_comm_to_expert3&#45;&gt;layer49_moe_expert3 -->
<g id="edge3096" class="edge">
<title>layer49_moe_comm_to_expert3&#45;&gt;layer49_moe_expert3</title>
<path fill="none" stroke="black" d="M2055.33,-9061.95C2055.33,-9053.56 2055.33,-9046 2055.33,-9046 2055.33,-9046 1734.25,-9046 1734.25,-9046 1734.25,-9046 1734.25,-9029.26 1734.25,-9029.26"/>
<polygon fill="black" stroke="black" points="1737.75,-9029.26 1734.25,-9019.26 1730.75,-9029.26 1737.75,-9029.26"/>
</g>
<!-- layer49_moe_expert4 -->
<g id="node2411" class="node">
<title>layer49_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2119,-9019.14 1791,-9019.14 1791,-8967.14 2119,-8967.14 2119,-9019.14"/>
<text text-anchor="middle" x="1955" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 4 L49</text>
<text text-anchor="middle" x="1955" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1955" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1955" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert4 -->
<g id="node2440" class="node">
<title>layer49_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2377" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2377" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2377" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2377" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer49_moe_expert4&#45;&gt;layer49_moe_comm_from_expert4 -->
<g id="edge3129" class="edge">
<title>layer49_moe_expert4&#45;&gt;layer49_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2087.16,-8967.07C2087.16,-8960.36 2087.16,-8955 2087.16,-8955 2087.16,-8955 2375.75,-8955 2375.75,-8955 2375.75,-8955 2375.75,-8941.36 2375.75,-8941.36"/>
<polygon fill="black" stroke="black" points="2379.25,-8941.36 2375.75,-8931.36 2372.25,-8941.36 2379.25,-8941.36"/>
</g>
<!-- layer49_moe_comm_to_expert4&#45;&gt;layer49_moe_expert4 -->
<g id="edge3098" class="edge">
<title>layer49_moe_comm_to_expert4&#45;&gt;layer49_moe_expert4</title>
<path fill="none" stroke="black" d="M2375.75,-9055.09C2375.75,-9045.39 2375.75,-9037 2375.75,-9037 2375.75,-9037 2087.16,-9037 2087.16,-9037 2087.16,-9037 2087.16,-9029.16 2087.16,-9029.16"/>
<polygon fill="black" stroke="black" points="2090.66,-9029.16 2087.16,-9019.16 2083.66,-9029.16 2090.66,-9029.16"/>
</g>
<!-- layer49_moe_expert5 -->
<g id="node2413" class="node">
<title>layer49_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2465,-9019.14 2137,-9019.14 2137,-8967.14 2465,-8967.14 2465,-9019.14"/>
<text text-anchor="middle" x="2301" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 5 L49</text>
<text text-anchor="middle" x="2301" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2301" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2301" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert5 -->
<g id="node2441" class="node">
<title>layer49_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2608" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2608" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2608" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2608" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer49_moe_expert5&#45;&gt;layer49_moe_comm_from_expert5 -->
<g id="edge3131" class="edge">
<title>layer49_moe_expert5&#45;&gt;layer49_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2465.12,-8984C2473.08,-8984 2477.84,-8984 2477.84,-8984 2477.84,-8984 2477.84,-8902 2477.84,-8902 2477.84,-8902 2507.24,-8902 2507.24,-8902"/>
<polygon fill="black" stroke="black" points="2507.24,-8905.5 2517.24,-8902 2507.24,-8898.5 2507.24,-8905.5"/>
</g>
<!-- layer49_moe_comm_to_expert5&#45;&gt;layer49_moe_expert5 -->
<g id="edge3100" class="edge">
<title>layer49_moe_comm_to_expert5&#45;&gt;layer49_moe_expert5</title>
<path fill="none" stroke="black" d="M2517.36,-9084C2492.71,-9084 2472.67,-9084 2472.67,-9084 2472.67,-9084 2472.67,-9001 2472.67,-9001 2472.67,-9001 2471.94,-9001 2471.94,-9001"/>
<polygon fill="black" stroke="black" points="2475.3,-8997.5 2465.3,-9001 2475.3,-9004.5 2475.3,-8997.5"/>
</g>
<!-- layer49_moe_expert6 -->
<g id="node2415" class="node">
<title>layer49_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2811,-9019.14 2483,-9019.14 2483,-8967.14 2811,-8967.14 2811,-9019.14"/>
<text text-anchor="middle" x="2647" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 6 L49</text>
<text text-anchor="middle" x="2647" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2647" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2647" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert6 -->
<g id="node2442" class="node">
<title>layer49_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2823" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2823" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2823" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2823" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer49_moe_expert6&#45;&gt;layer49_moe_comm_from_expert6 -->
<g id="edge3133" class="edge">
<title>layer49_moe_expert6&#45;&gt;layer49_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2771.75,-8966.82C2771.75,-8966.82 2771.75,-8936.23 2771.75,-8936.23"/>
<polygon fill="black" stroke="black" points="2775.25,-8936.23 2771.75,-8926.23 2768.25,-8936.23 2775.25,-8936.23"/>
</g>
<!-- layer49_moe_comm_to_expert6&#45;&gt;layer49_moe_expert6 -->
<g id="edge3102" class="edge">
<title>layer49_moe_comm_to_expert6&#45;&gt;layer49_moe_expert6</title>
<path fill="none" stroke="black" d="M2771.75,-9060.23C2771.75,-9060.23 2771.75,-9029.45 2771.75,-9029.45"/>
<polygon fill="black" stroke="black" points="2775.25,-9029.45 2771.75,-9019.45 2768.25,-9029.45 2775.25,-9029.45"/>
</g>
<!-- layer49_moe_expert7 -->
<g id="node2417" class="node">
<title>layer49_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3157,-9019.14 2829,-9019.14 2829,-8967.14 3157,-8967.14 3157,-9019.14"/>
<text text-anchor="middle" x="2993" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 7 L49</text>
<text text-anchor="middle" x="2993" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2993" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2993" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert7 -->
<g id="node2443" class="node">
<title>layer49_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="3030" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3030" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="3030" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3030" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer49_moe_expert7&#45;&gt;layer49_moe_comm_from_expert7 -->
<g id="edge3135" class="edge">
<title>layer49_moe_expert7&#45;&gt;layer49_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M3030,-8966.82C3030,-8966.82 3030,-8941.28 3030,-8941.28"/>
<polygon fill="black" stroke="black" points="3033.5,-8941.28 3030,-8931.28 3026.5,-8941.28 3033.5,-8941.28"/>
</g>
<!-- layer49_moe_comm_to_expert7&#45;&gt;layer49_moe_expert7 -->
<g id="edge3104" class="edge">
<title>layer49_moe_comm_to_expert7&#45;&gt;layer49_moe_expert7</title>
<path fill="none" stroke="black" d="M3030,-9055.09C3030,-9055.09 3030,-9029.44 3030,-9029.44"/>
<polygon fill="black" stroke="black" points="3033.5,-9029.44 3030,-9019.44 3026.5,-9029.44 3033.5,-9029.44"/>
</g>
<!-- layer49_moe_expert8 -->
<g id="node2419" class="node">
<title>layer49_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3503,-9019.14 3175,-9019.14 3175,-8967.14 3503,-8967.14 3503,-9019.14"/>
<text text-anchor="middle" x="3339" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 8 L49</text>
<text text-anchor="middle" x="3339" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3339" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3339" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert8 -->
<g id="node2444" class="node">
<title>layer49_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3302" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3302" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3302" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3302" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer49_moe_expert8&#45;&gt;layer49_moe_comm_from_expert8 -->
<g id="edge3137" class="edge">
<title>layer49_moe_expert8&#45;&gt;layer49_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3302,-8966.82C3302,-8966.82 3302,-8941.28 3302,-8941.28"/>
<polygon fill="black" stroke="black" points="3305.5,-8941.28 3302,-8931.28 3298.5,-8941.28 3305.5,-8941.28"/>
</g>
<!-- layer49_moe_comm_to_expert8&#45;&gt;layer49_moe_expert8 -->
<g id="edge3106" class="edge">
<title>layer49_moe_comm_to_expert8&#45;&gt;layer49_moe_expert8</title>
<path fill="none" stroke="black" d="M3302,-9055.09C3302,-9055.09 3302,-9029.44 3302,-9029.44"/>
<polygon fill="black" stroke="black" points="3305.5,-9029.44 3302,-9019.44 3298.5,-9029.44 3305.5,-9029.44"/>
</g>
<!-- layer49_moe_expert9 -->
<g id="node2421" class="node">
<title>layer49_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3849,-9019.14 3521,-9019.14 3521,-8967.14 3849,-8967.14 3849,-9019.14"/>
<text text-anchor="middle" x="3685" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 9 L49</text>
<text text-anchor="middle" x="3685" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3685" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3685" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert9 -->
<g id="node2445" class="node">
<title>layer49_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3611" cy="-8902.15" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3611" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3611" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3611" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer49_moe_expert9&#45;&gt;layer49_moe_comm_from_expert9 -->
<g id="edge3139" class="edge">
<title>layer49_moe_expert9&#45;&gt;layer49_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3611.25,-8966.82C3611.25,-8966.82 3611.25,-8941.28 3611.25,-8941.28"/>
<polygon fill="black" stroke="black" points="3614.75,-8941.28 3611.25,-8931.28 3607.75,-8941.28 3614.75,-8941.28"/>
</g>
<!-- layer49_moe_comm_to_expert9&#45;&gt;layer49_moe_expert9 -->
<g id="edge3108" class="edge">
<title>layer49_moe_comm_to_expert9&#45;&gt;layer49_moe_expert9</title>
<path fill="none" stroke="black" d="M3611.25,-9055.09C3611.25,-9055.09 3611.25,-9029.44 3611.25,-9029.44"/>
<polygon fill="black" stroke="black" points="3614.75,-9029.44 3611.25,-9019.44 3607.75,-9029.44 3614.75,-9029.44"/>
</g>
<!-- layer49_moe_expert10 -->
<g id="node2423" class="node">
<title>layer49_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4205,-9019.14 3867,-9019.14 3867,-8967.14 4205,-8967.14 4205,-9019.14"/>
<text text-anchor="middle" x="4036" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 10 L49</text>
<text text-anchor="middle" x="4036" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4036" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="4036" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert10 -->
<g id="node2446" class="node">
<title>layer49_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3943" cy="-8902.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3943" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3943" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3943" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer49_moe_expert10&#45;&gt;layer49_moe_comm_from_expert10 -->
<g id="edge3141" class="edge">
<title>layer49_moe_expert10&#45;&gt;layer49_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3952.38,-8966.82C3952.38,-8966.82 3952.38,-8941.28 3952.38,-8941.28"/>
<polygon fill="black" stroke="black" points="3955.88,-8941.28 3952.38,-8931.28 3948.88,-8941.28 3955.88,-8941.28"/>
</g>
<!-- layer49_moe_comm_to_expert10&#45;&gt;layer49_moe_expert10 -->
<g id="edge3110" class="edge">
<title>layer49_moe_comm_to_expert10&#45;&gt;layer49_moe_expert10</title>
<path fill="none" stroke="black" d="M3952.02,-9055.09C3952.02,-9055.09 3952.02,-9029.44 3952.02,-9029.44"/>
<polygon fill="black" stroke="black" points="3955.52,-9029.44 3952.02,-9019.44 3948.52,-9029.44 3955.52,-9029.44"/>
</g>
<!-- layer49_moe_expert11 -->
<g id="node2425" class="node">
<title>layer49_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4561,-9019.14 4223,-9019.14 4223,-8967.14 4561,-8967.14 4561,-9019.14"/>
<text text-anchor="middle" x="4392" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 11 L49</text>
<text text-anchor="middle" x="4392" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4392" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4392" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert11 -->
<g id="node2447" class="node">
<title>layer49_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4290" cy="-8902.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4290" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4290" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4290" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer49_moe_expert11&#45;&gt;layer49_moe_comm_from_expert11 -->
<g id="edge3143" class="edge">
<title>layer49_moe_expert11&#45;&gt;layer49_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4303.88,-8966.82C4303.88,-8966.82 4303.88,-8940.96 4303.88,-8940.96"/>
<polygon fill="black" stroke="black" points="4307.38,-8940.96 4303.88,-8930.96 4300.38,-8940.96 4307.38,-8940.96"/>
</g>
<!-- layer49_moe_comm_to_expert11&#45;&gt;layer49_moe_expert11 -->
<g id="edge3112" class="edge">
<title>layer49_moe_comm_to_expert11&#45;&gt;layer49_moe_expert11</title>
<path fill="none" stroke="black" d="M4303.02,-9055.34C4303.02,-9055.34 4303.02,-9029.28 4303.02,-9029.28"/>
<polygon fill="black" stroke="black" points="4306.52,-9029.28 4303.02,-9019.28 4299.52,-9029.28 4306.52,-9029.28"/>
</g>
<!-- layer49_moe_expert12 -->
<g id="node2427" class="node">
<title>layer49_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4917,-9019.14 4579,-9019.14 4579,-8967.14 4917,-8967.14 4917,-9019.14"/>
<text text-anchor="middle" x="4748" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 12 L49</text>
<text text-anchor="middle" x="4748" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4748" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4748" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert12 -->
<g id="node2448" class="node">
<title>layer49_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4641" cy="-8902.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4641" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4641" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4641" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer49_moe_expert12&#45;&gt;layer49_moe_comm_from_expert12 -->
<g id="edge3145" class="edge">
<title>layer49_moe_expert12&#45;&gt;layer49_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4657.38,-8966.82C4657.38,-8966.82 4657.38,-8940.96 4657.38,-8940.96"/>
<polygon fill="black" stroke="black" points="4660.88,-8940.96 4657.38,-8930.96 4653.88,-8940.96 4660.88,-8940.96"/>
</g>
<!-- layer49_moe_comm_to_expert12&#45;&gt;layer49_moe_expert12 -->
<g id="edge3114" class="edge">
<title>layer49_moe_comm_to_expert12&#45;&gt;layer49_moe_expert12</title>
<path fill="none" stroke="black" d="M4656.52,-9055.34C4656.52,-9055.34 4656.52,-9029.28 4656.52,-9029.28"/>
<polygon fill="black" stroke="black" points="4660.02,-9029.28 4656.52,-9019.28 4653.02,-9029.28 4660.02,-9029.28"/>
</g>
<!-- layer49_moe_expert13 -->
<g id="node2429" class="node">
<title>layer49_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5273,-9019.14 4935,-9019.14 4935,-8967.14 5273,-8967.14 5273,-9019.14"/>
<text text-anchor="middle" x="5104" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 13 L49</text>
<text text-anchor="middle" x="5104" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5104" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5104" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert13 -->
<g id="node2449" class="node">
<title>layer49_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4995" cy="-8902.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4995" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4995" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4995" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer49_moe_expert13&#45;&gt;layer49_moe_comm_from_expert13 -->
<g id="edge3147" class="edge">
<title>layer49_moe_expert13&#45;&gt;layer49_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M5012.38,-8966.82C5012.38,-8966.82 5012.38,-8940.96 5012.38,-8940.96"/>
<polygon fill="black" stroke="black" points="5015.88,-8940.96 5012.38,-8930.96 5008.88,-8940.96 5015.88,-8940.96"/>
</g>
<!-- layer49_moe_comm_to_expert13&#45;&gt;layer49_moe_expert13 -->
<g id="edge3116" class="edge">
<title>layer49_moe_comm_to_expert13&#45;&gt;layer49_moe_expert13</title>
<path fill="none" stroke="black" d="M5011.02,-9055.34C5011.02,-9055.34 5011.02,-9029.28 5011.02,-9029.28"/>
<polygon fill="black" stroke="black" points="5014.52,-9029.28 5011.02,-9019.28 5007.52,-9029.28 5014.52,-9029.28"/>
</g>
<!-- layer49_moe_expert14 -->
<g id="node2431" class="node">
<title>layer49_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5629,-9019.14 5291,-9019.14 5291,-8967.14 5629,-8967.14 5629,-9019.14"/>
<text text-anchor="middle" x="5460" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 14 L49</text>
<text text-anchor="middle" x="5460" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5460" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5460" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert14 -->
<g id="node2450" class="node">
<title>layer49_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5350" cy="-8902.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5350" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5350" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5350" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer49_moe_expert14&#45;&gt;layer49_moe_comm_from_expert14 -->
<g id="edge3149" class="edge">
<title>layer49_moe_expert14&#45;&gt;layer49_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5367.88,-8966.82C5367.88,-8966.82 5367.88,-8940.64 5367.88,-8940.64"/>
<polygon fill="black" stroke="black" points="5371.38,-8940.64 5367.88,-8930.64 5364.38,-8940.64 5371.38,-8940.64"/>
</g>
<!-- layer49_moe_comm_to_expert14&#45;&gt;layer49_moe_expert14 -->
<g id="edge3118" class="edge">
<title>layer49_moe_comm_to_expert14&#45;&gt;layer49_moe_expert14</title>
<path fill="none" stroke="black" d="M5366.52,-9055.34C5366.52,-9055.34 5366.52,-9029.28 5366.52,-9029.28"/>
<polygon fill="black" stroke="black" points="5370.02,-9029.28 5366.52,-9019.28 5363.02,-9029.28 5370.02,-9029.28"/>
</g>
<!-- layer49_moe_expert15 -->
<g id="node2433" class="node">
<title>layer49_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5985,-9019.14 5647,-9019.14 5647,-8967.14 5985,-8967.14 5985,-9019.14"/>
<text text-anchor="middle" x="5816" y="-9007.14" font-family="Arial" font-size="10.00">EXPERT 15 L49</text>
<text text-anchor="middle" x="5816" y="-8996.14" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5816" y="-8985.14" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5816" y="-8974.14" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_comm_from_expert15 -->
<g id="node2451" class="node">
<title>layer49_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5705" cy="-8902.15" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5705" y="-8910.65" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5705" y="-8899.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5705" y="-8888.65" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer49_moe_expert15&#45;&gt;layer49_moe_comm_from_expert15 -->
<g id="edge3151" class="edge">
<title>layer49_moe_expert15&#45;&gt;layer49_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5723.38,-8966.82C5723.38,-8966.82 5723.38,-8940.64 5723.38,-8940.64"/>
<polygon fill="black" stroke="black" points="5726.88,-8940.64 5723.38,-8930.64 5719.88,-8940.64 5726.88,-8940.64"/>
</g>
<!-- layer49_moe_comm_to_expert15&#45;&gt;layer49_moe_expert15 -->
<g id="edge3120" class="edge">
<title>layer49_moe_comm_to_expert15&#45;&gt;layer49_moe_expert15</title>
<path fill="none" stroke="black" d="M5722.02,-9055.34C5722.02,-9055.34 5722.02,-9029.28 5722.02,-9029.28"/>
<polygon fill="black" stroke="black" points="5725.52,-9029.28 5722.02,-9019.28 5718.52,-9029.28 5725.52,-9029.28"/>
</g>
<!-- layer49_moe_aggregate -->
<g id="node2435" class="node">
<title>layer49_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3391.1,-8837.16 2974.16,-8837.16 2866.9,-8733.16 3283.84,-8733.16 3391.1,-8837.16"/>
<text text-anchor="middle" x="3129" y="-8799.16" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L49</text>
<text text-anchor="middle" x="3129" y="-8788.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3129" y="-8777.16" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3129" y="-8766.16" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_mha -->
<g id="node2452" class="node">
<title>layer50_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3259,-8697.16 2999,-8697.16 2999,-8645.16 3259,-8645.16 3259,-8697.16"/>
<text text-anchor="middle" x="3129" y="-8685.16" font-family="Arial" font-size="10.00">MHA L50</text>
<text text-anchor="middle" x="3129" y="-8674.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3129" y="-8663.16" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3129" y="-8652.16" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer49_moe_aggregate&#45;&gt;layer50_moe_mha -->
<g id="edge3220" class="edge">
<title>layer49_moe_aggregate&#45;&gt;layer50_moe_mha</title>
<path fill="none" stroke="black" d="M3129,-8732.83C3129,-8732.83 3129,-8707.39 3129,-8707.39"/>
<polygon fill="black" stroke="black" points="3132.5,-8707.39 3129,-8697.39 3125.5,-8707.39 3132.5,-8707.39"/>
</g>
<!-- layer49_moe_comm_from_expert0&#45;&gt;layer49_moe_aggregate -->
<g id="edge3122" class="edge">
<title>layer49_moe_comm_from_expert0&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M589.5,-8874.24C589.5,-8829.81 589.5,-8748 589.5,-8748 589.5,-8748 2872.04,-8748 2872.04,-8748"/>
<polygon fill="black" stroke="black" points="2872.04,-8751.5 2882.04,-8748 2872.04,-8744.5 2872.04,-8751.5"/>
</g>
<!-- layer49_moe_comm_from_expert1&#45;&gt;layer49_moe_aggregate -->
<g id="edge3124" class="edge">
<title>layer49_moe_comm_from_expert1&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M1414.25,-8891.15C1414.25,-8858.11 1414.25,-8762 1414.25,-8762 1414.25,-8762 2886.4,-8762 2886.4,-8762"/>
<polygon fill="black" stroke="black" points="2886.4,-8765.5 2896.4,-8762 2886.4,-8758.5 2886.4,-8765.5"/>
</g>
<!-- layer49_moe_comm_from_expert2&#45;&gt;layer49_moe_aggregate -->
<g id="edge3126" class="edge">
<title>layer49_moe_comm_from_expert2&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M1823.51,-8875.61C1823.51,-8838.87 1823.51,-8777 1823.51,-8777 1823.51,-8777 2901.96,-8777 2901.96,-8777"/>
<polygon fill="black" stroke="black" points="2901.96,-8780.5 2911.96,-8777 2901.96,-8773.5 2901.96,-8780.5"/>
</g>
<!-- layer49_moe_comm_from_expert3&#45;&gt;layer49_moe_aggregate -->
<g id="edge3128" class="edge">
<title>layer49_moe_comm_from_expert3&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M2178.5,-8881.69C2178.5,-8849.84 2178.5,-8792 2178.5,-8792 2178.5,-8792 2917.42,-8792 2917.42,-8792"/>
<polygon fill="black" stroke="black" points="2917.42,-8795.5 2927.42,-8792 2917.42,-8788.5 2917.42,-8795.5"/>
</g>
<!-- layer49_moe_comm_from_expert4&#45;&gt;layer49_moe_aggregate -->
<g id="edge3130" class="edge">
<title>layer49_moe_comm_from_expert4&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M2423.5,-8877.15C2423.5,-8848.96 2423.5,-8807 2423.5,-8807 2423.5,-8807 2932.72,-8807 2932.72,-8807"/>
<polygon fill="black" stroke="black" points="2932.72,-8810.5 2942.72,-8807 2932.72,-8803.5 2932.72,-8810.5"/>
</g>
<!-- layer49_moe_comm_from_expert5&#45;&gt;layer49_moe_aggregate -->
<g id="edge3132" class="edge">
<title>layer49_moe_comm_from_expert5&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M2645.5,-8875.46C2645.5,-8852.15 2645.5,-8822 2645.5,-8822 2645.5,-8822 2948.2,-8822 2948.2,-8822"/>
<polygon fill="black" stroke="black" points="2948.2,-8825.5 2958.2,-8822 2948.2,-8818.5 2948.2,-8825.5"/>
</g>
<!-- layer49_moe_comm_from_expert6&#45;&gt;layer49_moe_aggregate -->
<g id="edge3134" class="edge">
<title>layer49_moe_comm_from_expert6&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M2890.11,-8882.57C2890.11,-8882.57 2890.11,-8795.21 2890.11,-8795.21"/>
<polygon fill="black" stroke="black" points="2893.61,-8795.21 2890.11,-8785.21 2886.61,-8795.21 2893.61,-8795.21"/>
</g>
<!-- layer49_moe_comm_from_expert7&#45;&gt;layer49_moe_aggregate -->
<g id="edge3136" class="edge">
<title>layer49_moe_comm_from_expert7&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M3030,-8872.93C3030,-8872.93 3030,-8847.22 3030,-8847.22"/>
<polygon fill="black" stroke="black" points="3033.5,-8847.22 3030,-8837.22 3026.5,-8847.22 3033.5,-8847.22"/>
</g>
<!-- layer49_moe_comm_from_expert8&#45;&gt;layer49_moe_aggregate -->
<g id="edge3138" class="edge">
<title>layer49_moe_comm_from_expert8&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M3301.39,-8872.93C3301.39,-8872.93 3301.39,-8847.22 3301.39,-8847.22"/>
<polygon fill="black" stroke="black" points="3304.89,-8847.22 3301.39,-8837.22 3297.89,-8847.22 3304.89,-8847.22"/>
</g>
<!-- layer49_moe_comm_from_expert9&#45;&gt;layer49_moe_aggregate -->
<g id="edge3140" class="edge">
<title>layer49_moe_comm_from_expert9&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M3592.5,-8873.49C3592.5,-8851.19 3592.5,-8824 3592.5,-8824 3592.5,-8824 3387.71,-8824 3387.71,-8824"/>
<polygon fill="black" stroke="black" points="3387.71,-8820.5 3377.71,-8824 3387.71,-8827.5 3387.71,-8820.5"/>
</g>
<!-- layer49_moe_comm_from_expert10&#45;&gt;layer49_moe_aggregate -->
<g id="edge3142" class="edge">
<title>layer49_moe_comm_from_expert10&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M3924.15,-8873.31C3924.15,-8846.61 3924.15,-8811 3924.15,-8811 3924.15,-8811 3374.34,-8811 3374.34,-8811"/>
<polygon fill="black" stroke="black" points="3374.34,-8807.5 3364.34,-8811 3374.34,-8814.5 3374.34,-8807.5"/>
</g>
<!-- layer49_moe_comm_from_expert11&#45;&gt;layer49_moe_aggregate -->
<g id="edge3144" class="edge">
<title>layer49_moe_comm_from_expert11&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M4270.65,-8873.69C4270.65,-8842.85 4270.65,-8798 4270.65,-8798 4270.65,-8798 3360.81,-8798 3360.81,-8798"/>
<polygon fill="black" stroke="black" points="3360.81,-8794.5 3350.81,-8798 3360.81,-8801.5 3360.81,-8794.5"/>
</g>
<!-- layer49_moe_comm_from_expert12&#45;&gt;layer49_moe_aggregate -->
<g id="edge3146" class="edge">
<title>layer49_moe_comm_from_expert12&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M4621.65,-8873.49C4621.65,-8838.81 4621.65,-8785 4621.65,-8785 4621.65,-8785 3347.33,-8785 3347.33,-8785"/>
<polygon fill="black" stroke="black" points="3347.33,-8781.5 3337.33,-8785 3347.33,-8788.5 3347.33,-8781.5"/>
</g>
<!-- layer49_moe_comm_from_expert13&#45;&gt;layer49_moe_aggregate -->
<g id="edge3148" class="edge">
<title>layer49_moe_comm_from_expert13&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M4975.15,-8873.59C4975.15,-8835.28 4975.15,-8772 4975.15,-8772 4975.15,-8772 3333.95,-8772 3333.95,-8772"/>
<polygon fill="black" stroke="black" points="3333.95,-8768.5 3323.95,-8772 3333.95,-8775.5 3333.95,-8768.5"/>
</g>
<!-- layer49_moe_comm_from_expert14&#45;&gt;layer49_moe_aggregate -->
<g id="edge3150" class="edge">
<title>layer49_moe_comm_from_expert14&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M5330.15,-8873.53C5330.15,-8831.75 5330.15,-8759 5330.15,-8759 5330.15,-8759 3320.53,-8759 3320.53,-8759"/>
<polygon fill="black" stroke="black" points="3320.53,-8755.5 3310.53,-8759 3320.53,-8762.5 3320.53,-8755.5"/>
</g>
<!-- layer49_moe_comm_from_expert15&#45;&gt;layer49_moe_aggregate -->
<g id="edge3152" class="edge">
<title>layer49_moe_comm_from_expert15&#45;&gt;layer49_moe_aggregate</title>
<path fill="none" stroke="black" d="M5685.15,-8873.51C5685.15,-8828.43 5685.15,-8746 5685.15,-8746 5685.15,-8746 3307.21,-8746 3307.21,-8746"/>
<polygon fill="black" stroke="black" points="3307.21,-8742.5 3297.21,-8746 3307.21,-8749.5 3307.21,-8742.5"/>
</g>
<!-- layer50_moe_gate -->
<g id="node2453" class="node">
<title>layer50_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3387.3,-8609.16 2976.4,-8609.16 2870.7,-8505.16 3281.6,-8505.16 3387.3,-8609.16"/>
<text text-anchor="middle" x="3129" y="-8571.16" font-family="Arial" font-size="10.00">GATE L50</text>
<text text-anchor="middle" x="3129" y="-8560.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3129" y="-8549.16" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3129" y="-8538.16" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer50_moe_mha&#45;&gt;layer50_moe_gate -->
<g id="edge3221" class="edge">
<title>layer50_moe_mha&#45;&gt;layer50_moe_gate</title>
<path fill="none" stroke="black" d="M3129,-8645.01C3129,-8645.01 3129,-8619.26 3129,-8619.26"/>
<polygon fill="black" stroke="black" points="3132.5,-8619.26 3129,-8609.26 3125.5,-8619.26 3132.5,-8619.26"/>
</g>
<!-- layer50_moe_split -->
<g id="node2454" class="node">
<title>layer50_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3383.01,-8469.16 2978.94,-8469.16 2874.99,-8365.16 3279.06,-8365.16 3383.01,-8469.16"/>
<text text-anchor="middle" x="3129" y="-8431.16" font-family="Arial" font-size="10.00">SPLIT TOKENS L50</text>
<text text-anchor="middle" x="3129" y="-8420.16" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3129" y="-8409.16" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3129" y="-8398.16" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer50_moe_gate&#45;&gt;layer50_moe_split -->
<g id="edge3222" class="edge">
<title>layer50_moe_gate&#45;&gt;layer50_moe_split</title>
<path fill="none" stroke="black" d="M3129,-8505.03C3129,-8505.03 3129,-8479.33 3129,-8479.33"/>
<polygon fill="black" stroke="black" points="3132.5,-8479.33 3129,-8469.33 3125.5,-8479.33 3132.5,-8479.33"/>
</g>
<!-- layer50_moe_comm_to_expert0 -->
<g id="node2456" class="node">
<title>layer50_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="621" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="621" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="621" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="621" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert0 -->
<g id="edge3156" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2963.36,-8454C2408.28,-8454 648.5,-8454 648.5,-8454 648.5,-8454 648.5,-8338.03 648.5,-8338.03"/>
<polygon fill="black" stroke="black" points="652,-8338.03 648.5,-8328.03 645,-8338.03 652,-8338.03"/>
</g>
<!-- layer50_moe_comm_to_expert1 -->
<g id="node2458" class="node">
<title>layer50_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1261" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1261" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1261" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1261" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert1 -->
<g id="edge3158" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2948.6,-8439C2486.34,-8439 1295.5,-8439 1295.5,-8439 1295.5,-8439 1295.5,-8337.27 1295.5,-8337.27"/>
<polygon fill="black" stroke="black" points="1299,-8337.27 1295.5,-8327.27 1292,-8337.27 1299,-8337.27"/>
</g>
<!-- layer50_moe_comm_to_expert2 -->
<g id="node2460" class="node">
<title>layer50_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1680" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1680" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1680" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1680" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert2 -->
<g id="edge3160" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2933.79,-8424C2549.74,-8424 1733,-8424 1733,-8424 1733,-8424 1733,-8333.75 1733,-8333.75"/>
<polygon fill="black" stroke="black" points="1736.5,-8333.75 1733,-8323.75 1729.5,-8333.75 1736.5,-8333.75"/>
</g>
<!-- layer50_moe_comm_to_expert3 -->
<g id="node2462" class="node">
<title>layer50_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1989" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1989" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1989" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1989" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert3 -->
<g id="edge3162" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2918.69,-8409C2605.12,-8409 2051.5,-8409 2051.5,-8409 2051.5,-8409 2051.5,-8331.15 2051.5,-8331.15"/>
<polygon fill="black" stroke="black" points="2055,-8331.15 2051.5,-8321.15 2048,-8331.15 2055,-8331.15"/>
</g>
<!-- layer50_moe_comm_to_expert4 -->
<g id="node2464" class="node">
<title>layer50_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2243" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2243" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2243" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2243" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert4 -->
<g id="edge3164" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2903.58,-8394C2661.14,-8394 2310,-8394 2310,-8394 2310,-8394 2310,-8330.07 2310,-8330.07"/>
<polygon fill="black" stroke="black" points="2313.5,-8330.07 2310,-8320.07 2306.5,-8330.07 2313.5,-8330.07"/>
</g>
<!-- layer50_moe_comm_to_expert5 -->
<g id="node2466" class="node">
<title>layer50_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2470" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2470" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2470" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2470" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert5 -->
<g id="edge3166" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2889.45,-8380C2726,-8380 2539,-8380 2539,-8380 2539,-8380 2539,-8329.09 2539,-8329.09"/>
<polygon fill="black" stroke="black" points="2542.5,-8329.09 2539,-8319.09 2535.5,-8329.09 2542.5,-8329.09"/>
</g>
<!-- layer50_moe_comm_to_expert6 -->
<g id="node2468" class="node">
<title>layer50_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2683" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2683" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2683" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2683" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert6 -->
<g id="edge3168" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2888.74,-8417.07C2888.74,-8413.53 2888.74,-8300 2888.74,-8300 2888.74,-8300 2783.54,-8300 2783.54,-8300"/>
<polygon fill="black" stroke="black" points="2783.54,-8296.5 2773.54,-8300 2783.54,-8303.5 2783.54,-8296.5"/>
</g>
<!-- layer50_moe_comm_to_expert7 -->
<g id="node2470" class="node">
<title>layer50_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2993" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2993" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2993" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2993" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert7 -->
<g id="edge3170" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2993,-8364.82C2993,-8364.82 2993,-8339.38 2993,-8339.38"/>
<polygon fill="black" stroke="black" points="2996.5,-8339.38 2993,-8329.38 2989.5,-8339.38 2996.5,-8339.38"/>
</g>
<!-- layer50_moe_comm_to_expert8 -->
<g id="node2472" class="node">
<title>layer50_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3265" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3265" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3265" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3265" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert8 -->
<g id="edge3172" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3265,-8364.82C3265,-8364.82 3265,-8339.38 3265,-8339.38"/>
<polygon fill="black" stroke="black" points="3268.5,-8339.38 3265,-8329.38 3261.5,-8339.38 3268.5,-8339.38"/>
</g>
<!-- layer50_moe_comm_to_expert9 -->
<g id="node2474" class="node">
<title>layer50_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3574" cy="-8300.17" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3574" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3574" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3574" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert9 -->
<g id="edge3174" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3369.26,-8417.07C3369.26,-8413.53 3369.26,-8300 3369.26,-8300 3369.26,-8300 3473.3,-8300 3473.3,-8300"/>
<polygon fill="black" stroke="black" points="3473.3,-8303.5 3483.3,-8300 3473.3,-8296.5 3473.3,-8303.5"/>
</g>
<!-- layer50_moe_comm_to_expert10 -->
<g id="node2476" class="node">
<title>layer50_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3906" cy="-8300.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3906" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3906" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3906" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert10 -->
<g id="edge3176" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3294.26,-8380C3501.54,-8380 3830.1,-8380 3830.1,-8380 3830.1,-8380 3830.1,-8327.49 3830.1,-8327.49"/>
<polygon fill="black" stroke="black" points="3833.6,-8327.49 3830.1,-8317.49 3826.6,-8327.49 3833.6,-8327.49"/>
</g>
<!-- layer50_moe_comm_to_expert11 -->
<g id="node2478" class="node">
<title>layer50_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4252" cy="-8300.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4252" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4252" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4252" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert11 -->
<g id="edge3178" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3307.9,-8394C3607.11,-8394 4176.6,-8394 4176.6,-8394 4176.6,-8394 4176.6,-8327.82 4176.6,-8327.82"/>
<polygon fill="black" stroke="black" points="4180.1,-8327.82 4176.6,-8317.82 4173.1,-8327.82 4180.1,-8327.82"/>
</g>
<!-- layer50_moe_comm_to_expert12 -->
<g id="node2480" class="node">
<title>layer50_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4603" cy="-8300.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4603" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4603" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4603" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert12 -->
<g id="edge3180" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3323.1,-8409C3707.24,-8409 4527.6,-8409 4527.6,-8409 4527.6,-8409 4527.6,-8327.65 4527.6,-8327.65"/>
<polygon fill="black" stroke="black" points="4531.1,-8327.65 4527.6,-8317.65 4524.1,-8327.65 4531.1,-8327.65"/>
</g>
<!-- layer50_moe_comm_to_expert13 -->
<g id="node2482" class="node">
<title>layer50_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4956" cy="-8300.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4956" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4956" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4956" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert13 -->
<g id="edge3182" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3338.17,-8424C3803,-8424 4881.1,-8424 4881.1,-8424 4881.1,-8424 4881.1,-8327.91 4881.1,-8327.91"/>
<polygon fill="black" stroke="black" points="4884.6,-8327.91 4881.1,-8317.91 4877.6,-8327.91 4884.6,-8327.91"/>
</g>
<!-- layer50_moe_comm_to_expert14 -->
<g id="node2484" class="node">
<title>layer50_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5311" cy="-8300.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5311" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5311" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5311" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert14 -->
<g id="edge3184" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3353,-8439C3895.61,-8439 5236.1,-8439 5236.1,-8439 5236.1,-8439 5236.1,-8327.75 5236.1,-8327.75"/>
<polygon fill="black" stroke="black" points="5239.6,-8327.75 5236.1,-8317.75 5232.6,-8327.75 5239.6,-8327.75"/>
</g>
<!-- layer50_moe_comm_to_expert15 -->
<g id="node2486" class="node">
<title>layer50_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5666" cy="-8300.17" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5666" y="-8308.67" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5666" y="-8297.67" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5666" y="-8286.67" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert15 -->
<g id="edge3186" class="edge">
<title>layer50_moe_split&#45;&gt;layer50_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3367.87,-8454C3986.18,-8454 5591.1,-8454 5591.1,-8454 5591.1,-8454 5591.1,-8327.81 5591.1,-8327.81"/>
<polygon fill="black" stroke="black" points="5594.6,-8327.81 5591.1,-8317.81 5587.6,-8327.81 5594.6,-8327.81"/>
</g>
<!-- layer50_moe_expert0 -->
<g id="node2455" class="node">
<title>layer50_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="698,-8235.18 370,-8235.18 370,-8183.18 698,-8183.18 698,-8235.18"/>
<text text-anchor="middle" x="534" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 0 L50</text>
<text text-anchor="middle" x="534" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="534" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="534" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert0 -->
<g id="node2488" class="node">
<title>layer50_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="667" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="667" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="667" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="667" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer50_moe_expert0&#45;&gt;layer50_moe_comm_from_expert0 -->
<g id="edge3188" class="edge">
<title>layer50_moe_expert0&#45;&gt;layer50_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M637.25,-8182.86C637.25,-8182.86 637.25,-8155.71 637.25,-8155.71"/>
<polygon fill="black" stroke="black" points="640.75,-8155.71 637.25,-8145.71 633.75,-8155.71 640.75,-8155.71"/>
</g>
<!-- layer50_moe_comm_to_expert0&#45;&gt;layer50_moe_expert0 -->
<g id="edge3157" class="edge">
<title>layer50_moe_comm_to_expert0&#45;&gt;layer50_moe_expert0</title>
<path fill="none" stroke="black" d="M614.25,-8271.13C614.25,-8271.13 614.25,-8245.48 614.25,-8245.48"/>
<polygon fill="black" stroke="black" points="617.75,-8245.48 614.25,-8235.48 610.75,-8245.48 617.75,-8245.48"/>
</g>
<!-- layer50_moe_expert1 -->
<g id="node2457" class="node">
<title>layer50_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1044,-8235.18 716,-8235.18 716,-8183.18 1044,-8183.18 1044,-8235.18"/>
<text text-anchor="middle" x="880" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 1 L50</text>
<text text-anchor="middle" x="880" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="880" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="880" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert1 -->
<g id="node2489" class="node">
<title>layer50_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1233" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1233" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1233" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1233" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer50_moe_expert1&#45;&gt;layer50_moe_comm_from_expert1 -->
<g id="edge3190" class="edge">
<title>layer50_moe_expert1&#45;&gt;layer50_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M982.25,-8182.8C982.25,-8155.88 982.25,-8118 982.25,-8118 982.25,-8118 1132.47,-8118 1132.47,-8118"/>
<polygon fill="black" stroke="black" points="1132.47,-8121.5 1142.47,-8118 1132.47,-8114.5 1132.47,-8121.5"/>
</g>
<!-- layer50_moe_comm_to_expert1&#45;&gt;layer50_moe_expert1 -->
<g id="edge3159" class="edge">
<title>layer50_moe_comm_to_expert1&#45;&gt;layer50_moe_expert1</title>
<path fill="none" stroke="black" d="M1170.46,-8300C1063.09,-8300 898.5,-8300 898.5,-8300 898.5,-8300 898.5,-8245.45 898.5,-8245.45"/>
<polygon fill="black" stroke="black" points="902,-8245.45 898.5,-8235.45 895,-8245.45 902,-8245.45"/>
</g>
<!-- layer50_moe_expert2 -->
<g id="node2459" class="node">
<title>layer50_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1390,-8235.18 1062,-8235.18 1062,-8183.18 1390,-8183.18 1390,-8235.18"/>
<text text-anchor="middle" x="1226" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 2 L50</text>
<text text-anchor="middle" x="1226" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1226" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1226" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert2 -->
<g id="node2490" class="node">
<title>layer50_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1616" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1616" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1616" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1616" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer50_moe_expert2&#45;&gt;layer50_moe_comm_from_expert2 -->
<g id="edge3192" class="edge">
<title>layer50_moe_expert2&#45;&gt;layer50_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1380.5,-8182.8C1380.5,-8155.88 1380.5,-8118 1380.5,-8118 1380.5,-8118 1515.29,-8118 1515.29,-8118"/>
<polygon fill="black" stroke="black" points="1515.29,-8121.5 1525.29,-8118 1515.29,-8114.5 1515.29,-8121.5"/>
</g>
<!-- layer50_moe_comm_to_expert2&#45;&gt;layer50_moe_expert2 -->
<g id="edge3161" class="edge">
<title>layer50_moe_comm_to_expert2&#45;&gt;layer50_moe_expert2</title>
<path fill="none" stroke="black" d="M1589.31,-8300C1498.06,-8300 1370.75,-8300 1370.75,-8300 1370.75,-8300 1370.75,-8245.45 1370.75,-8245.45"/>
<polygon fill="black" stroke="black" points="1374.25,-8245.45 1370.75,-8235.45 1367.25,-8245.45 1374.25,-8245.45"/>
</g>
<!-- layer50_moe_expert3 -->
<g id="node2461" class="node">
<title>layer50_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1736,-8235.18 1408,-8235.18 1408,-8183.18 1736,-8183.18 1736,-8235.18"/>
<text text-anchor="middle" x="1572" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 3 L50</text>
<text text-anchor="middle" x="1572" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1572" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1572" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert3 -->
<g id="node2491" class="node">
<title>layer50_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1907" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1907" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1907" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1907" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer50_moe_expert3&#45;&gt;layer50_moe_comm_from_expert3 -->
<g id="edge3194" class="edge">
<title>layer50_moe_expert3&#45;&gt;layer50_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1721.25,-8182.8C1721.25,-8155.88 1721.25,-8118 1721.25,-8118 1721.25,-8118 1806.3,-8118 1806.3,-8118"/>
<polygon fill="black" stroke="black" points="1806.3,-8121.5 1816.3,-8118 1806.3,-8114.5 1806.3,-8121.5"/>
</g>
<!-- layer50_moe_comm_to_expert3&#45;&gt;layer50_moe_expert3 -->
<g id="edge3163" class="edge">
<title>layer50_moe_comm_to_expert3&#45;&gt;layer50_moe_expert3</title>
<path fill="none" stroke="black" d="M1989,-8271.1C1989,-8261.39 1989,-8253 1989,-8253 1989,-8253 1662.75,-8253 1662.75,-8253 1662.75,-8253 1662.75,-8245.43 1662.75,-8245.43"/>
<polygon fill="black" stroke="black" points="1666.25,-8245.43 1662.75,-8235.43 1659.25,-8245.43 1666.25,-8245.43"/>
</g>
<!-- layer50_moe_expert4 -->
<g id="node2463" class="node">
<title>layer50_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2082,-8235.18 1754,-8235.18 1754,-8183.18 2082,-8183.18 2082,-8235.18"/>
<text text-anchor="middle" x="1918" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 4 L50</text>
<text text-anchor="middle" x="1918" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1918" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1918" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert4 -->
<g id="node2492" class="node">
<title>layer50_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2152" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2152" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2152" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2152" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer50_moe_expert4&#45;&gt;layer50_moe_comm_from_expert4 -->
<g id="edge3196" class="edge">
<title>layer50_moe_expert4&#45;&gt;layer50_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2071.75,-8182.86C2071.75,-8182.86 2071.75,-8141.82 2071.75,-8141.82"/>
<polygon fill="black" stroke="black" points="2075.25,-8141.82 2071.75,-8131.82 2068.25,-8141.82 2075.25,-8141.82"/>
</g>
<!-- layer50_moe_comm_to_expert4&#45;&gt;layer50_moe_expert4 -->
<g id="edge3165" class="edge">
<title>layer50_moe_comm_to_expert4&#45;&gt;layer50_moe_expert4</title>
<path fill="none" stroke="black" d="M2152.39,-8300C2119.83,-8300 2091,-8300 2091,-8300 2091,-8300 2091,-8209 2091,-8209 2091,-8209 2090.12,-8209 2090.12,-8209"/>
<polygon fill="black" stroke="black" points="2092.18,-8205.5 2082.18,-8209 2092.18,-8212.5 2092.18,-8205.5"/>
</g>
<!-- layer50_moe_expert5 -->
<g id="node2465" class="node">
<title>layer50_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2428,-8235.18 2100,-8235.18 2100,-8183.18 2428,-8183.18 2428,-8235.18"/>
<text text-anchor="middle" x="2264" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 5 L50</text>
<text text-anchor="middle" x="2264" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2264" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2264" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert5 -->
<g id="node2493" class="node">
<title>layer50_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2374" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2374" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2374" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2374" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer50_moe_expert5&#45;&gt;layer50_moe_comm_from_expert5 -->
<g id="edge3198" class="edge">
<title>layer50_moe_expert5&#45;&gt;layer50_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2355.75,-8182.86C2355.75,-8182.86 2355.75,-8156.67 2355.75,-8156.67"/>
<polygon fill="black" stroke="black" points="2359.25,-8156.67 2355.75,-8146.67 2352.25,-8156.67 2359.25,-8156.67"/>
</g>
<!-- layer50_moe_comm_to_expert5&#45;&gt;layer50_moe_expert5 -->
<g id="edge3167" class="edge">
<title>layer50_moe_comm_to_expert5&#45;&gt;layer50_moe_expert5</title>
<path fill="none" stroke="black" d="M2403.75,-8279.97C2403.75,-8279.97 2403.75,-8245.2 2403.75,-8245.2"/>
<polygon fill="black" stroke="black" points="2407.25,-8245.2 2403.75,-8235.2 2400.25,-8245.2 2407.25,-8245.2"/>
</g>
<!-- layer50_moe_expert6 -->
<g id="node2467" class="node">
<title>layer50_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2774,-8235.18 2446,-8235.18 2446,-8183.18 2774,-8183.18 2774,-8235.18"/>
<text text-anchor="middle" x="2610" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 6 L50</text>
<text text-anchor="middle" x="2610" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2610" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2610" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert6 -->
<g id="node2494" class="node">
<title>layer50_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2721" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2721" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2721" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2721" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer50_moe_expert6&#45;&gt;layer50_moe_comm_from_expert6 -->
<g id="edge3200" class="edge">
<title>layer50_moe_expert6&#45;&gt;layer50_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2702.25,-8182.86C2702.25,-8182.86 2702.25,-8156.67 2702.25,-8156.67"/>
<polygon fill="black" stroke="black" points="2705.75,-8156.67 2702.25,-8146.67 2698.75,-8156.67 2705.75,-8156.67"/>
</g>
<!-- layer50_moe_comm_to_expert6&#45;&gt;layer50_moe_expert6 -->
<g id="edge3169" class="edge">
<title>layer50_moe_comm_to_expert6&#45;&gt;layer50_moe_expert6</title>
<path fill="none" stroke="black" d="M2683,-8271.13C2683,-8271.13 2683,-8245.48 2683,-8245.48"/>
<polygon fill="black" stroke="black" points="2686.5,-8245.48 2683,-8235.48 2679.5,-8245.48 2686.5,-8245.48"/>
</g>
<!-- layer50_moe_expert7 -->
<g id="node2469" class="node">
<title>layer50_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3120,-8235.18 2792,-8235.18 2792,-8183.18 3120,-8183.18 3120,-8235.18"/>
<text text-anchor="middle" x="2956" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 7 L50</text>
<text text-anchor="middle" x="2956" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2956" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2956" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert7 -->
<g id="node2495" class="node">
<title>layer50_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2993" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2993" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2993" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2993" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer50_moe_expert7&#45;&gt;layer50_moe_comm_from_expert7 -->
<g id="edge3202" class="edge">
<title>layer50_moe_expert7&#45;&gt;layer50_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2993,-8182.86C2993,-8182.86 2993,-8157.32 2993,-8157.32"/>
<polygon fill="black" stroke="black" points="2996.5,-8157.32 2993,-8147.32 2989.5,-8157.32 2996.5,-8157.32"/>
</g>
<!-- layer50_moe_comm_to_expert7&#45;&gt;layer50_moe_expert7 -->
<g id="edge3171" class="edge">
<title>layer50_moe_comm_to_expert7&#45;&gt;layer50_moe_expert7</title>
<path fill="none" stroke="black" d="M2993,-8271.13C2993,-8271.13 2993,-8245.48 2993,-8245.48"/>
<polygon fill="black" stroke="black" points="2996.5,-8245.48 2993,-8235.48 2989.5,-8245.48 2996.5,-8245.48"/>
</g>
<!-- layer50_moe_expert8 -->
<g id="node2471" class="node">
<title>layer50_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3466,-8235.18 3138,-8235.18 3138,-8183.18 3466,-8183.18 3466,-8235.18"/>
<text text-anchor="middle" x="3302" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 8 L50</text>
<text text-anchor="middle" x="3302" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3302" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3302" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert8 -->
<g id="node2496" class="node">
<title>layer50_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3265" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3265" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3265" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3265" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer50_moe_expert8&#45;&gt;layer50_moe_comm_from_expert8 -->
<g id="edge3204" class="edge">
<title>layer50_moe_expert8&#45;&gt;layer50_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3265,-8182.86C3265,-8182.86 3265,-8157.32 3265,-8157.32"/>
<polygon fill="black" stroke="black" points="3268.5,-8157.32 3265,-8147.32 3261.5,-8157.32 3268.5,-8157.32"/>
</g>
<!-- layer50_moe_comm_to_expert8&#45;&gt;layer50_moe_expert8 -->
<g id="edge3173" class="edge">
<title>layer50_moe_comm_to_expert8&#45;&gt;layer50_moe_expert8</title>
<path fill="none" stroke="black" d="M3265,-8271.13C3265,-8271.13 3265,-8245.48 3265,-8245.48"/>
<polygon fill="black" stroke="black" points="3268.5,-8245.48 3265,-8235.48 3261.5,-8245.48 3268.5,-8245.48"/>
</g>
<!-- layer50_moe_expert9 -->
<g id="node2473" class="node">
<title>layer50_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3812,-8235.18 3484,-8235.18 3484,-8183.18 3812,-8183.18 3812,-8235.18"/>
<text text-anchor="middle" x="3648" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 9 L50</text>
<text text-anchor="middle" x="3648" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3648" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3648" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert9 -->
<g id="node2497" class="node">
<title>layer50_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3574" cy="-8118.19" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3574" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3574" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3574" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer50_moe_expert9&#45;&gt;layer50_moe_comm_from_expert9 -->
<g id="edge3206" class="edge">
<title>layer50_moe_expert9&#45;&gt;layer50_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3574.25,-8182.86C3574.25,-8182.86 3574.25,-8157.32 3574.25,-8157.32"/>
<polygon fill="black" stroke="black" points="3577.75,-8157.32 3574.25,-8147.32 3570.75,-8157.32 3577.75,-8157.32"/>
</g>
<!-- layer50_moe_comm_to_expert9&#45;&gt;layer50_moe_expert9 -->
<g id="edge3175" class="edge">
<title>layer50_moe_comm_to_expert9&#45;&gt;layer50_moe_expert9</title>
<path fill="none" stroke="black" d="M3574.25,-8271.13C3574.25,-8271.13 3574.25,-8245.48 3574.25,-8245.48"/>
<polygon fill="black" stroke="black" points="3577.75,-8245.48 3574.25,-8235.48 3570.75,-8245.48 3577.75,-8245.48"/>
</g>
<!-- layer50_moe_expert10 -->
<g id="node2475" class="node">
<title>layer50_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4168,-8235.18 3830,-8235.18 3830,-8183.18 4168,-8183.18 4168,-8235.18"/>
<text text-anchor="middle" x="3999" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 10 L50</text>
<text text-anchor="middle" x="3999" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3999" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3999" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert10 -->
<g id="node2498" class="node">
<title>layer50_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3906" cy="-8118.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3906" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3906" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3906" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer50_moe_expert10&#45;&gt;layer50_moe_comm_from_expert10 -->
<g id="edge3208" class="edge">
<title>layer50_moe_expert10&#45;&gt;layer50_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3915.38,-8182.86C3915.38,-8182.86 3915.38,-8157.32 3915.38,-8157.32"/>
<polygon fill="black" stroke="black" points="3918.88,-8157.32 3915.38,-8147.32 3911.88,-8157.32 3918.88,-8157.32"/>
</g>
<!-- layer50_moe_comm_to_expert10&#45;&gt;layer50_moe_expert10 -->
<g id="edge3177" class="edge">
<title>layer50_moe_comm_to_expert10&#45;&gt;layer50_moe_expert10</title>
<path fill="none" stroke="black" d="M3915.02,-8271.13C3915.02,-8271.13 3915.02,-8245.48 3915.02,-8245.48"/>
<polygon fill="black" stroke="black" points="3918.52,-8245.48 3915.02,-8235.48 3911.52,-8245.48 3918.52,-8245.48"/>
</g>
<!-- layer50_moe_expert11 -->
<g id="node2477" class="node">
<title>layer50_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4524,-8235.18 4186,-8235.18 4186,-8183.18 4524,-8183.18 4524,-8235.18"/>
<text text-anchor="middle" x="4355" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 11 L50</text>
<text text-anchor="middle" x="4355" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4355" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4355" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert11 -->
<g id="node2499" class="node">
<title>layer50_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4253" cy="-8118.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4253" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4253" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4253" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer50_moe_expert11&#45;&gt;layer50_moe_comm_from_expert11 -->
<g id="edge3210" class="edge">
<title>layer50_moe_expert11&#45;&gt;layer50_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4266.88,-8182.86C4266.88,-8182.86 4266.88,-8156.99 4266.88,-8156.99"/>
<polygon fill="black" stroke="black" points="4270.38,-8156.99 4266.88,-8146.99 4263.38,-8156.99 4270.38,-8156.99"/>
</g>
<!-- layer50_moe_comm_to_expert11&#45;&gt;layer50_moe_expert11 -->
<g id="edge3179" class="edge">
<title>layer50_moe_comm_to_expert11&#45;&gt;layer50_moe_expert11</title>
<path fill="none" stroke="black" d="M4266.02,-8271.38C4266.02,-8271.38 4266.02,-8245.31 4266.02,-8245.31"/>
<polygon fill="black" stroke="black" points="4269.52,-8245.31 4266.02,-8235.31 4262.52,-8245.31 4269.52,-8245.31"/>
</g>
<!-- layer50_moe_expert12 -->
<g id="node2479" class="node">
<title>layer50_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4880,-8235.18 4542,-8235.18 4542,-8183.18 4880,-8183.18 4880,-8235.18"/>
<text text-anchor="middle" x="4711" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 12 L50</text>
<text text-anchor="middle" x="4711" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4711" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4711" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert12 -->
<g id="node2500" class="node">
<title>layer50_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4604" cy="-8118.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4604" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4604" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4604" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer50_moe_expert12&#45;&gt;layer50_moe_comm_from_expert12 -->
<g id="edge3212" class="edge">
<title>layer50_moe_expert12&#45;&gt;layer50_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4620.38,-8182.86C4620.38,-8182.86 4620.38,-8156.99 4620.38,-8156.99"/>
<polygon fill="black" stroke="black" points="4623.88,-8156.99 4620.38,-8146.99 4616.88,-8156.99 4623.88,-8156.99"/>
</g>
<!-- layer50_moe_comm_to_expert12&#45;&gt;layer50_moe_expert12 -->
<g id="edge3181" class="edge">
<title>layer50_moe_comm_to_expert12&#45;&gt;layer50_moe_expert12</title>
<path fill="none" stroke="black" d="M4619.52,-8271.38C4619.52,-8271.38 4619.52,-8245.31 4619.52,-8245.31"/>
<polygon fill="black" stroke="black" points="4623.02,-8245.31 4619.52,-8235.31 4616.02,-8245.31 4623.02,-8245.31"/>
</g>
<!-- layer50_moe_expert13 -->
<g id="node2481" class="node">
<title>layer50_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5236,-8235.18 4898,-8235.18 4898,-8183.18 5236,-8183.18 5236,-8235.18"/>
<text text-anchor="middle" x="5067" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 13 L50</text>
<text text-anchor="middle" x="5067" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5067" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5067" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert13 -->
<g id="node2501" class="node">
<title>layer50_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4958" cy="-8118.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4958" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4958" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4958" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer50_moe_expert13&#45;&gt;layer50_moe_comm_from_expert13 -->
<g id="edge3214" class="edge">
<title>layer50_moe_expert13&#45;&gt;layer50_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4975.38,-8182.86C4975.38,-8182.86 4975.38,-8156.99 4975.38,-8156.99"/>
<polygon fill="black" stroke="black" points="4978.88,-8156.99 4975.38,-8146.99 4971.88,-8156.99 4978.88,-8156.99"/>
</g>
<!-- layer50_moe_comm_to_expert13&#45;&gt;layer50_moe_expert13 -->
<g id="edge3183" class="edge">
<title>layer50_moe_comm_to_expert13&#45;&gt;layer50_moe_expert13</title>
<path fill="none" stroke="black" d="M4974.02,-8271.38C4974.02,-8271.38 4974.02,-8245.31 4974.02,-8245.31"/>
<polygon fill="black" stroke="black" points="4977.52,-8245.31 4974.02,-8235.31 4970.52,-8245.31 4977.52,-8245.31"/>
</g>
<!-- layer50_moe_expert14 -->
<g id="node2483" class="node">
<title>layer50_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5592,-8235.18 5254,-8235.18 5254,-8183.18 5592,-8183.18 5592,-8235.18"/>
<text text-anchor="middle" x="5423" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 14 L50</text>
<text text-anchor="middle" x="5423" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5423" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5423" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert14 -->
<g id="node2502" class="node">
<title>layer50_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5313" cy="-8118.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5313" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5313" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5313" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer50_moe_expert14&#45;&gt;layer50_moe_comm_from_expert14 -->
<g id="edge3216" class="edge">
<title>layer50_moe_expert14&#45;&gt;layer50_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5330.88,-8182.86C5330.88,-8182.86 5330.88,-8156.67 5330.88,-8156.67"/>
<polygon fill="black" stroke="black" points="5334.38,-8156.67 5330.88,-8146.67 5327.38,-8156.67 5334.38,-8156.67"/>
</g>
<!-- layer50_moe_comm_to_expert14&#45;&gt;layer50_moe_expert14 -->
<g id="edge3185" class="edge">
<title>layer50_moe_comm_to_expert14&#45;&gt;layer50_moe_expert14</title>
<path fill="none" stroke="black" d="M5329.52,-8271.38C5329.52,-8271.38 5329.52,-8245.31 5329.52,-8245.31"/>
<polygon fill="black" stroke="black" points="5333.02,-8245.31 5329.52,-8235.31 5326.02,-8245.31 5333.02,-8245.31"/>
</g>
<!-- layer50_moe_expert15 -->
<g id="node2485" class="node">
<title>layer50_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5948,-8235.18 5610,-8235.18 5610,-8183.18 5948,-8183.18 5948,-8235.18"/>
<text text-anchor="middle" x="5779" y="-8223.18" font-family="Arial" font-size="10.00">EXPERT 15 L50</text>
<text text-anchor="middle" x="5779" y="-8212.18" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5779" y="-8201.18" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5779" y="-8190.18" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_comm_from_expert15 -->
<g id="node2503" class="node">
<title>layer50_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5668" cy="-8118.19" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5668" y="-8126.69" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5668" y="-8115.69" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5668" y="-8104.69" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer50_moe_expert15&#45;&gt;layer50_moe_comm_from_expert15 -->
<g id="edge3218" class="edge">
<title>layer50_moe_expert15&#45;&gt;layer50_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5686.38,-8182.86C5686.38,-8182.86 5686.38,-8156.67 5686.38,-8156.67"/>
<polygon fill="black" stroke="black" points="5689.88,-8156.67 5686.38,-8146.67 5682.88,-8156.67 5689.88,-8156.67"/>
</g>
<!-- layer50_moe_comm_to_expert15&#45;&gt;layer50_moe_expert15 -->
<g id="edge3187" class="edge">
<title>layer50_moe_comm_to_expert15&#45;&gt;layer50_moe_expert15</title>
<path fill="none" stroke="black" d="M5685.02,-8271.38C5685.02,-8271.38 5685.02,-8245.31 5685.02,-8245.31"/>
<polygon fill="black" stroke="black" points="5688.52,-8245.31 5685.02,-8235.31 5681.52,-8245.31 5688.52,-8245.31"/>
</g>
<!-- layer50_moe_aggregate -->
<g id="node2487" class="node">
<title>layer50_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3354.1,-8053.19 2937.16,-8053.19 2829.9,-7949.19 3246.84,-7949.19 3354.1,-8053.19"/>
<text text-anchor="middle" x="3092" y="-8015.19" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L50</text>
<text text-anchor="middle" x="3092" y="-8004.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3092" y="-7993.19" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3092" y="-7982.19" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_mha -->
<g id="node2504" class="node">
<title>layer51_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3222,-7913.19 2962,-7913.19 2962,-7861.19 3222,-7861.19 3222,-7913.19"/>
<text text-anchor="middle" x="3092" y="-7901.19" font-family="Arial" font-size="10.00">MHA L51</text>
<text text-anchor="middle" x="3092" y="-7890.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3092" y="-7879.19" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3092" y="-7868.19" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer50_moe_aggregate&#45;&gt;layer51_moe_mha -->
<g id="edge3287" class="edge">
<title>layer50_moe_aggregate&#45;&gt;layer51_moe_mha</title>
<path fill="none" stroke="black" d="M3092,-7948.87C3092,-7948.87 3092,-7923.42 3092,-7923.42"/>
<polygon fill="black" stroke="black" points="3095.5,-7923.42 3092,-7913.42 3088.5,-7923.42 3095.5,-7923.42"/>
</g>
<!-- layer50_moe_comm_from_expert0&#45;&gt;layer50_moe_aggregate -->
<g id="edge3189" class="edge">
<title>layer50_moe_comm_from_expert0&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M718.25,-8094.09C718.25,-8050.73 718.25,-7964 718.25,-7964 718.25,-7964 2834.96,-7964 2834.96,-7964"/>
<polygon fill="black" stroke="black" points="2834.96,-7967.5 2844.96,-7964 2834.96,-7960.5 2834.96,-7967.5"/>
</g>
<!-- layer50_moe_comm_from_expert1&#45;&gt;layer50_moe_aggregate -->
<g id="edge3191" class="edge">
<title>layer50_moe_comm_from_expert1&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M1244.5,-8089.14C1244.5,-8048.08 1244.5,-7978 1244.5,-7978 1244.5,-7978 2849.42,-7978 2849.42,-7978"/>
<polygon fill="black" stroke="black" points="2849.42,-7981.5 2859.42,-7978 2849.42,-7974.5 2849.42,-7981.5"/>
</g>
<!-- layer50_moe_comm_from_expert2&#45;&gt;layer50_moe_aggregate -->
<g id="edge3193" class="edge">
<title>layer50_moe_comm_from_expert2&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M1664,-8093.45C1664,-8056.97 1664,-7993 1664,-7993 1664,-7993 2864.73,-7993 2864.73,-7993"/>
<polygon fill="black" stroke="black" points="2864.73,-7996.5 2874.73,-7993 2864.73,-7989.5 2864.73,-7996.5"/>
</g>
<!-- layer50_moe_comm_from_expert3&#45;&gt;layer50_moe_aggregate -->
<g id="edge3195" class="edge">
<title>layer50_moe_comm_from_expert3&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M1973.5,-8098.49C1973.5,-8066.79 1973.5,-8008 1973.5,-8008 1973.5,-8008 2880.42,-8008 2880.42,-8008"/>
<polygon fill="black" stroke="black" points="2880.42,-8011.5 2890.42,-8008 2880.42,-8004.5 2880.42,-8011.5"/>
</g>
<!-- layer50_moe_comm_from_expert4&#45;&gt;layer50_moe_aggregate -->
<g id="edge3197" class="edge">
<title>layer50_moe_comm_from_expert4&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M2227.5,-8102.04C2227.5,-8074.88 2227.5,-8023 2227.5,-8023 2227.5,-8023 2896.01,-8023 2896.01,-8023"/>
<polygon fill="black" stroke="black" points="2896.01,-8026.5 2906.01,-8023 2896.01,-8019.5 2896.01,-8026.5"/>
</g>
<!-- layer50_moe_comm_from_expert5&#45;&gt;layer50_moe_aggregate -->
<g id="edge3199" class="edge">
<title>layer50_moe_comm_from_expert5&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M2454,-8104.58C2454,-8081.71 2454,-8038 2454,-8038 2454,-8038 2911.45,-8038 2911.45,-8038"/>
<polygon fill="black" stroke="black" points="2911.45,-8041.5 2921.45,-8038 2911.45,-8034.5 2911.45,-8041.5"/>
</g>
<!-- layer50_moe_comm_from_expert6&#45;&gt;layer50_moe_aggregate -->
<g id="edge3201" class="edge">
<title>layer50_moe_comm_from_expert6&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M2811.65,-8118C2840.98,-8118 2866.1,-8118 2866.1,-8118 2866.1,-8118 2866.1,-8011.28 2866.1,-8011.28"/>
<polygon fill="black" stroke="black" points="2869.6,-8011.28 2866.1,-8001.28 2862.6,-8011.28 2869.6,-8011.28"/>
</g>
<!-- layer50_moe_comm_from_expert7&#45;&gt;layer50_moe_aggregate -->
<g id="edge3203" class="edge">
<title>layer50_moe_comm_from_expert7&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M2993,-8088.97C2993,-8088.97 2993,-8063.25 2993,-8063.25"/>
<polygon fill="black" stroke="black" points="2996.5,-8063.25 2993,-8053.25 2989.5,-8063.25 2996.5,-8063.25"/>
</g>
<!-- layer50_moe_comm_from_expert8&#45;&gt;layer50_moe_aggregate -->
<g id="edge3205" class="edge">
<title>layer50_moe_comm_from_expert8&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M3264.39,-8088.97C3264.39,-8088.97 3264.39,-8063.25 3264.39,-8063.25"/>
<polygon fill="black" stroke="black" points="3267.89,-8063.25 3264.39,-8053.25 3260.89,-8063.25 3267.89,-8063.25"/>
</g>
<!-- layer50_moe_comm_from_expert9&#45;&gt;layer50_moe_aggregate -->
<g id="edge3207" class="edge">
<title>layer50_moe_comm_from_expert9&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M3555.5,-8089.52C3555.5,-8067.2 3555.5,-8040 3555.5,-8040 3555.5,-8040 3350.71,-8040 3350.71,-8040"/>
<polygon fill="black" stroke="black" points="3350.71,-8036.5 3340.71,-8040 3350.71,-8043.5 3350.71,-8036.5"/>
</g>
<!-- layer50_moe_comm_from_expert10&#45;&gt;layer50_moe_aggregate -->
<g id="edge3209" class="edge">
<title>layer50_moe_comm_from_expert10&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M3887.15,-8089.33C3887.15,-8062.62 3887.15,-8027 3887.15,-8027 3887.15,-8027 3337.34,-8027 3337.34,-8027"/>
<polygon fill="black" stroke="black" points="3337.34,-8023.5 3327.34,-8027 3337.34,-8030.5 3337.34,-8023.5"/>
</g>
<!-- layer50_moe_comm_from_expert11&#45;&gt;layer50_moe_aggregate -->
<g id="edge3211" class="edge">
<title>layer50_moe_comm_from_expert11&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M4233.65,-8089.72C4233.65,-8058.87 4233.65,-8014 4233.65,-8014 4233.65,-8014 3323.81,-8014 3323.81,-8014"/>
<polygon fill="black" stroke="black" points="3323.81,-8010.5 3313.81,-8014 3323.81,-8017.5 3323.81,-8010.5"/>
</g>
<!-- layer50_moe_comm_from_expert12&#45;&gt;layer50_moe_aggregate -->
<g id="edge3213" class="edge">
<title>layer50_moe_comm_from_expert12&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M4584.65,-8089.52C4584.65,-8054.83 4584.65,-8001 4584.65,-8001 4584.65,-8001 3310.33,-8001 3310.33,-8001"/>
<polygon fill="black" stroke="black" points="3310.33,-7997.5 3300.33,-8001 3310.33,-8004.5 3310.33,-7997.5"/>
</g>
<!-- layer50_moe_comm_from_expert13&#45;&gt;layer50_moe_aggregate -->
<g id="edge3215" class="edge">
<title>layer50_moe_comm_from_expert13&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M4938.15,-8089.62C4938.15,-8051.29 4938.15,-7988 4938.15,-7988 4938.15,-7988 3296.95,-7988 3296.95,-7988"/>
<polygon fill="black" stroke="black" points="3296.95,-7984.5 3286.95,-7988 3296.95,-7991.5 3296.95,-7984.5"/>
</g>
<!-- layer50_moe_comm_from_expert14&#45;&gt;layer50_moe_aggregate -->
<g id="edge3217" class="edge">
<title>layer50_moe_comm_from_expert14&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M5293.15,-8089.55C5293.15,-8047.77 5293.15,-7975 5293.15,-7975 5293.15,-7975 3283.53,-7975 3283.53,-7975"/>
<polygon fill="black" stroke="black" points="3283.53,-7971.5 3273.53,-7975 3283.53,-7978.5 3283.53,-7971.5"/>
</g>
<!-- layer50_moe_comm_from_expert15&#45;&gt;layer50_moe_aggregate -->
<g id="edge3219" class="edge">
<title>layer50_moe_comm_from_expert15&#45;&gt;layer50_moe_aggregate</title>
<path fill="none" stroke="black" d="M5648.15,-8089.54C5648.15,-8044.45 5648.15,-7962 5648.15,-7962 5648.15,-7962 3270.21,-7962 3270.21,-7962"/>
<polygon fill="black" stroke="black" points="3270.21,-7958.5 3260.21,-7962 3270.21,-7965.5 3270.21,-7958.5"/>
</g>
<!-- layer51_moe_gate -->
<g id="node2505" class="node">
<title>layer51_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3350.3,-7825.19 2939.4,-7825.19 2833.7,-7721.19 3244.6,-7721.19 3350.3,-7825.19"/>
<text text-anchor="middle" x="3092" y="-7787.19" font-family="Arial" font-size="10.00">GATE L51</text>
<text text-anchor="middle" x="3092" y="-7776.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3092" y="-7765.19" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3092" y="-7754.19" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer51_moe_mha&#45;&gt;layer51_moe_gate -->
<g id="edge3288" class="edge">
<title>layer51_moe_mha&#45;&gt;layer51_moe_gate</title>
<path fill="none" stroke="black" d="M3092,-7861.04C3092,-7861.04 3092,-7835.29 3092,-7835.29"/>
<polygon fill="black" stroke="black" points="3095.5,-7835.29 3092,-7825.29 3088.5,-7835.29 3095.5,-7835.29"/>
</g>
<!-- layer51_moe_split -->
<g id="node2506" class="node">
<title>layer51_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3346.01,-7685.19 2941.94,-7685.19 2837.99,-7581.19 3242.06,-7581.19 3346.01,-7685.19"/>
<text text-anchor="middle" x="3092" y="-7647.19" font-family="Arial" font-size="10.00">SPLIT TOKENS L51</text>
<text text-anchor="middle" x="3092" y="-7636.19" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3092" y="-7625.19" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3092" y="-7614.19" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer51_moe_gate&#45;&gt;layer51_moe_split -->
<g id="edge3289" class="edge">
<title>layer51_moe_gate&#45;&gt;layer51_moe_split</title>
<path fill="none" stroke="black" d="M3092,-7721.06C3092,-7721.06 3092,-7695.37 3092,-7695.37"/>
<polygon fill="black" stroke="black" points="3095.5,-7695.37 3092,-7685.37 3088.5,-7695.37 3095.5,-7695.37"/>
</g>
<!-- layer51_moe_comm_to_expert0 -->
<g id="node2508" class="node">
<title>layer51_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1011" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1011" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="1011" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1011" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert0 -->
<g id="edge3223" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2926.64,-7670C2445.77,-7670 1081.75,-7670 1081.75,-7670 1081.75,-7670 1081.75,-7544.45 1081.75,-7544.45"/>
<polygon fill="black" stroke="black" points="1085.25,-7544.45 1081.75,-7534.45 1078.25,-7544.45 1085.25,-7544.45"/>
</g>
<!-- layer51_moe_comm_to_expert1 -->
<g id="node2510" class="node">
<title>layer51_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1256" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1256" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1256" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1256" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert1 -->
<g id="edge3225" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2911.41,-7655C2463.06,-7655 1335.01,-7655 1335.01,-7655 1335.01,-7655 1335.01,-7540.53 1335.01,-7540.53"/>
<polygon fill="black" stroke="black" points="1338.51,-7540.53 1335.01,-7530.53 1331.51,-7540.53 1338.51,-7540.53"/>
</g>
<!-- layer51_moe_comm_to_expert2 -->
<g id="node2512" class="node">
<title>layer51_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1712" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1712" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1712" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1712" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert2 -->
<g id="edge3227" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2896.74,-7640C2530.77,-7640 1778.25,-7640 1778.25,-7640 1778.25,-7640 1778.25,-7546.09 1778.25,-7546.09"/>
<polygon fill="black" stroke="black" points="1781.75,-7546.09 1778.25,-7536.09 1774.75,-7546.09 1781.75,-7546.09"/>
</g>
<!-- layer51_moe_comm_to_expert3 -->
<g id="node2514" class="node">
<title>layer51_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2040" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2040" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2040" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2040" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert3 -->
<g id="edge3229" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2881.69,-7625C2589.43,-7625 2096,-7625 2096,-7625 2096,-7625 2096,-7549.01 2096,-7549.01"/>
<polygon fill="black" stroke="black" points="2099.5,-7549.01 2096,-7539.01 2092.5,-7549.01 2099.5,-7549.01"/>
</g>
<!-- layer51_moe_comm_to_expert4 -->
<g id="node2516" class="node">
<title>layer51_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2303" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2303" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2303" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2303" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert4 -->
<g id="edge3231" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2866.69,-7610C2644.68,-7610 2338.5,-7610 2338.5,-7610 2338.5,-7610 2338.5,-7553.08 2338.5,-7553.08"/>
<polygon fill="black" stroke="black" points="2342,-7553.08 2338.5,-7543.08 2335,-7553.08 2342,-7553.08"/>
</g>
<!-- layer51_moe_comm_to_expert5 -->
<g id="node2518" class="node">
<title>layer51_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2534" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2534" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2534" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2534" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert5 -->
<g id="edge3233" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2852.66,-7596C2705.34,-7596 2544.51,-7596 2544.51,-7596 2544.51,-7596 2544.51,-7555.01 2544.51,-7555.01"/>
<polygon fill="black" stroke="black" points="2548.01,-7555.01 2544.51,-7545.01 2541.01,-7555.01 2548.01,-7555.01"/>
</g>
<!-- layer51_moe_comm_to_expert6 -->
<g id="node2520" class="node">
<title>layer51_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2749" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2749" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2749" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2749" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert6 -->
<g id="edge3235" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2852.5,-7633.11C2852.5,-7629.56 2852.5,-7516 2852.5,-7516 2852.5,-7516 2849.81,-7516 2849.81,-7516"/>
<polygon fill="black" stroke="black" points="2849.81,-7512.5 2839.81,-7516 2849.81,-7519.5 2849.81,-7512.5"/>
</g>
<!-- layer51_moe_comm_to_expert7 -->
<g id="node2522" class="node">
<title>layer51_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2956" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2956" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2956" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2956" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert7 -->
<g id="edge3237" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2956,-7580.86C2956,-7580.86 2956,-7555.41 2956,-7555.41"/>
<polygon fill="black" stroke="black" points="2959.5,-7555.41 2956,-7545.41 2952.5,-7555.41 2959.5,-7555.41"/>
</g>
<!-- layer51_moe_comm_to_expert8 -->
<g id="node2524" class="node">
<title>layer51_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3228" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3228" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3228" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3228" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert8 -->
<g id="edge3239" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3228,-7580.86C3228,-7580.86 3228,-7555.41 3228,-7555.41"/>
<polygon fill="black" stroke="black" points="3231.5,-7555.41 3228,-7545.41 3224.5,-7555.41 3231.5,-7555.41"/>
</g>
<!-- layer51_moe_comm_to_expert9 -->
<g id="node2526" class="node">
<title>layer51_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3537" cy="-7516.2" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3537" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3537" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3537" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert9 -->
<g id="edge3241" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3332.26,-7633.11C3332.26,-7629.56 3332.26,-7516 3332.26,-7516 3332.26,-7516 3436.3,-7516 3436.3,-7516"/>
<polygon fill="black" stroke="black" points="3436.3,-7519.5 3446.3,-7516 3436.3,-7512.5 3436.3,-7519.5"/>
</g>
<!-- layer51_moe_comm_to_expert10 -->
<g id="node2528" class="node">
<title>layer51_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3869" cy="-7516.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3869" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3869" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3869" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert10 -->
<g id="edge3243" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3257.26,-7596C3464.54,-7596 3793.1,-7596 3793.1,-7596 3793.1,-7596 3793.1,-7543.52 3793.1,-7543.52"/>
<polygon fill="black" stroke="black" points="3796.6,-7543.52 3793.1,-7533.52 3789.6,-7543.52 3796.6,-7543.52"/>
</g>
<!-- layer51_moe_comm_to_expert11 -->
<g id="node2530" class="node">
<title>layer51_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4215" cy="-7516.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4215" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4215" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4215" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert11 -->
<g id="edge3245" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3270.9,-7610C3570.11,-7610 4139.6,-7610 4139.6,-7610 4139.6,-7610 4139.6,-7543.85 4139.6,-7543.85"/>
<polygon fill="black" stroke="black" points="4143.1,-7543.85 4139.6,-7533.85 4136.1,-7543.85 4143.1,-7543.85"/>
</g>
<!-- layer51_moe_comm_to_expert12 -->
<g id="node2532" class="node">
<title>layer51_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4566" cy="-7516.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4566" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4566" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4566" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert12 -->
<g id="edge3247" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3286.1,-7625C3670.24,-7625 4490.6,-7625 4490.6,-7625 4490.6,-7625 4490.6,-7543.68 4490.6,-7543.68"/>
<polygon fill="black" stroke="black" points="4494.1,-7543.68 4490.6,-7533.68 4487.1,-7543.68 4494.1,-7543.68"/>
</g>
<!-- layer51_moe_comm_to_expert13 -->
<g id="node2534" class="node">
<title>layer51_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4919" cy="-7516.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4919" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4919" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4919" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert13 -->
<g id="edge3249" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3301.17,-7640C3766,-7640 4844.1,-7640 4844.1,-7640 4844.1,-7640 4844.1,-7543.94 4844.1,-7543.94"/>
<polygon fill="black" stroke="black" points="4847.6,-7543.94 4844.1,-7533.94 4840.6,-7543.94 4847.6,-7543.94"/>
</g>
<!-- layer51_moe_comm_to_expert14 -->
<g id="node2536" class="node">
<title>layer51_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5274" cy="-7516.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5274" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5274" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5274" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert14 -->
<g id="edge3251" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3316,-7655C3858.61,-7655 5199.1,-7655 5199.1,-7655 5199.1,-7655 5199.1,-7543.78 5199.1,-7543.78"/>
<polygon fill="black" stroke="black" points="5202.6,-7543.78 5199.1,-7533.78 5195.6,-7543.78 5202.6,-7543.78"/>
</g>
<!-- layer51_moe_comm_to_expert15 -->
<g id="node2538" class="node">
<title>layer51_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5629" cy="-7516.2" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5629" y="-7524.7" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5629" y="-7513.7" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5629" y="-7502.7" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert15 -->
<g id="edge3253" class="edge">
<title>layer51_moe_split&#45;&gt;layer51_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3330.87,-7670C3949.18,-7670 5554.1,-7670 5554.1,-7670 5554.1,-7670 5554.1,-7543.85 5554.1,-7543.85"/>
<polygon fill="black" stroke="black" points="5557.6,-7543.85 5554.1,-7533.85 5550.6,-7543.85 5557.6,-7543.85"/>
</g>
<!-- layer51_moe_expert0 -->
<g id="node2507" class="node">
<title>layer51_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="661,-7451.21 333,-7451.21 333,-7399.21 661,-7399.21 661,-7451.21"/>
<text text-anchor="middle" x="497" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 0 L51</text>
<text text-anchor="middle" x="497" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="497" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="497" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert0 -->
<g id="node2540" class="node">
<title>layer51_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="543" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="543" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="543" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="543" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer51_moe_expert0&#45;&gt;layer51_moe_comm_from_expert0 -->
<g id="edge3255" class="edge">
<title>layer51_moe_expert0&#45;&gt;layer51_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M543,-7398.89C543,-7398.89 543,-7373.35 543,-7373.35"/>
<polygon fill="black" stroke="black" points="546.5,-7373.35 543,-7363.35 539.5,-7373.35 546.5,-7373.35"/>
</g>
<!-- layer51_moe_comm_to_expert0&#45;&gt;layer51_moe_expert0 -->
<g id="edge3224" class="edge">
<title>layer51_moe_comm_to_expert0&#45;&gt;layer51_moe_expert0</title>
<path fill="none" stroke="black" d="M920.02,-7516C804.15,-7516 618.75,-7516 618.75,-7516 618.75,-7516 618.75,-7461.47 618.75,-7461.47"/>
<polygon fill="black" stroke="black" points="622.25,-7461.47 618.75,-7451.47 615.25,-7461.47 622.25,-7461.47"/>
</g>
<!-- layer51_moe_expert1 -->
<g id="node2509" class="node">
<title>layer51_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="1007,-7451.21 679,-7451.21 679,-7399.21 1007,-7399.21 1007,-7451.21"/>
<text text-anchor="middle" x="843" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 1 L51</text>
<text text-anchor="middle" x="843" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="843" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="843" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert1 -->
<g id="node2541" class="node">
<title>layer51_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1256" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1256" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1256" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1256" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer51_moe_expert1&#45;&gt;layer51_moe_comm_from_expert1 -->
<g id="edge3257" class="edge">
<title>layer51_moe_expert1&#45;&gt;layer51_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M945.25,-7398.83C945.25,-7371.89 945.25,-7334 945.25,-7334 945.25,-7334 1155.28,-7334 1155.28,-7334"/>
<polygon fill="black" stroke="black" points="1155.28,-7337.5 1165.28,-7334 1155.28,-7330.5 1155.28,-7337.5"/>
</g>
<!-- layer51_moe_comm_to_expert1&#45;&gt;layer51_moe_expert1 -->
<g id="edge3226" class="edge">
<title>layer51_moe_comm_to_expert1&#45;&gt;layer51_moe_expert1</title>
<path fill="none" stroke="black" d="M1256,-7487.11C1256,-7473.4 1256,-7460 1256,-7460 1256,-7460 963.75,-7460 963.75,-7460 963.75,-7460 963.75,-7459.12 963.75,-7459.12"/>
<polygon fill="black" stroke="black" points="967.25,-7461.22 963.75,-7451.22 960.25,-7461.22 967.25,-7461.22"/>
</g>
<!-- layer51_moe_expert2 -->
<g id="node2511" class="node">
<title>layer51_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1353,-7451.21 1025,-7451.21 1025,-7399.21 1353,-7399.21 1353,-7451.21"/>
<text text-anchor="middle" x="1189" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 2 L51</text>
<text text-anchor="middle" x="1189" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1189" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1189" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert2 -->
<g id="node2542" class="node">
<title>layer51_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1712" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1712" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1712" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1712" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer51_moe_expert2&#45;&gt;layer51_moe_comm_from_expert2 -->
<g id="edge3259" class="edge">
<title>layer51_moe_expert2&#45;&gt;layer51_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1353.18,-7416C1360.6,-7416 1365,-7416 1365,-7416 1365,-7416 1365,-7334 1365,-7334 1365,-7334 1611.28,-7334 1611.28,-7334"/>
<polygon fill="black" stroke="black" points="1611.28,-7337.5 1621.28,-7334 1611.28,-7330.5 1611.28,-7337.5"/>
</g>
<!-- layer51_moe_comm_to_expert2&#45;&gt;layer51_moe_expert2 -->
<g id="edge3228" class="edge">
<title>layer51_moe_comm_to_expert2&#45;&gt;layer51_moe_expert2</title>
<path fill="none" stroke="black" d="M1621.09,-7516C1516.5,-7516 1359,-7516 1359,-7516 1359,-7516 1359,-7433 1359,-7433 1359,-7433 1358.43,-7433 1358.43,-7433"/>
<polygon fill="black" stroke="black" points="1363.34,-7429.5 1353.34,-7433 1363.34,-7436.5 1363.34,-7429.5"/>
</g>
<!-- layer51_moe_expert3 -->
<g id="node2513" class="node">
<title>layer51_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1699,-7451.21 1371,-7451.21 1371,-7399.21 1699,-7399.21 1699,-7451.21"/>
<text text-anchor="middle" x="1535" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 3 L51</text>
<text text-anchor="middle" x="1535" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1535" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1535" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert3 -->
<g id="node2543" class="node">
<title>layer51_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="2040" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2040" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="2040" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2040" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer51_moe_expert3&#45;&gt;layer51_moe_comm_from_expert3 -->
<g id="edge3261" class="edge">
<title>layer51_moe_expert3&#45;&gt;layer51_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1660.25,-7398.93C1660.25,-7386.78 1660.25,-7375 1660.25,-7375 1660.25,-7375 1981.33,-7375 1981.33,-7375 1981.33,-7375 1981.33,-7366.52 1981.33,-7366.52"/>
<polygon fill="black" stroke="black" points="1984.83,-7366.52 1981.33,-7356.52 1977.83,-7366.52 1984.83,-7366.52"/>
</g>
<!-- layer51_moe_comm_to_expert3&#45;&gt;layer51_moe_expert3 -->
<g id="edge3230" class="edge">
<title>layer51_moe_comm_to_expert3&#45;&gt;layer51_moe_expert3</title>
<path fill="none" stroke="black" d="M1981.33,-7493.98C1981.33,-7485.58 1981.33,-7478 1981.33,-7478 1981.33,-7478 1660.25,-7478 1660.25,-7478 1660.25,-7478 1660.25,-7461.3 1660.25,-7461.3"/>
<polygon fill="black" stroke="black" points="1663.75,-7461.3 1660.25,-7451.3 1656.75,-7461.3 1663.75,-7461.3"/>
</g>
<!-- layer51_moe_expert4 -->
<g id="node2515" class="node">
<title>layer51_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2045,-7451.21 1717,-7451.21 1717,-7399.21 2045,-7399.21 2045,-7451.21"/>
<text text-anchor="middle" x="1881" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 4 L51</text>
<text text-anchor="middle" x="1881" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1881" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1881" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert4 -->
<g id="node2544" class="node">
<title>layer51_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2303" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2303" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2303" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2303" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer51_moe_expert4&#45;&gt;layer51_moe_comm_from_expert4 -->
<g id="edge3263" class="edge">
<title>layer51_moe_expert4&#45;&gt;layer51_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M2013.16,-7399.09C2013.16,-7392.37 2013.16,-7387 2013.16,-7387 2013.16,-7387 2301.75,-7387 2301.75,-7387 2301.75,-7387 2301.75,-7373.39 2301.75,-7373.39"/>
<polygon fill="black" stroke="black" points="2305.25,-7373.39 2301.75,-7363.39 2298.25,-7373.39 2305.25,-7373.39"/>
</g>
<!-- layer51_moe_comm_to_expert4&#45;&gt;layer51_moe_expert4 -->
<g id="edge3232" class="edge">
<title>layer51_moe_comm_to_expert4&#45;&gt;layer51_moe_expert4</title>
<path fill="none" stroke="black" d="M2301.75,-7487.11C2301.75,-7477.4 2301.75,-7469 2301.75,-7469 2301.75,-7469 2013.16,-7469 2013.16,-7469 2013.16,-7469 2013.16,-7461.44 2013.16,-7461.44"/>
<polygon fill="black" stroke="black" points="2016.66,-7461.44 2013.16,-7451.44 2009.66,-7461.44 2016.66,-7461.44"/>
</g>
<!-- layer51_moe_expert5 -->
<g id="node2517" class="node">
<title>layer51_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2391,-7451.21 2063,-7451.21 2063,-7399.21 2391,-7399.21 2391,-7451.21"/>
<text text-anchor="middle" x="2227" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 5 L51</text>
<text text-anchor="middle" x="2227" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2227" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2227" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert5 -->
<g id="node2545" class="node">
<title>layer51_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2534" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2534" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2534" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2534" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer51_moe_expert5&#45;&gt;layer51_moe_comm_from_expert5 -->
<g id="edge3265" class="edge">
<title>layer51_moe_expert5&#45;&gt;layer51_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2391.21,-7416C2398.1,-7416 2402.16,-7416 2402.16,-7416 2402.16,-7416 2402.16,-7334 2402.16,-7334 2402.16,-7334 2433.15,-7334 2433.15,-7334"/>
<polygon fill="black" stroke="black" points="2433.15,-7337.5 2443.15,-7334 2433.15,-7330.5 2433.15,-7337.5"/>
</g>
<!-- layer51_moe_comm_to_expert5&#45;&gt;layer51_moe_expert5 -->
<g id="edge3234" class="edge">
<title>layer51_moe_comm_to_expert5&#45;&gt;layer51_moe_expert5</title>
<path fill="none" stroke="black" d="M2443.18,-7516C2418.2,-7516 2397.84,-7516 2397.84,-7516 2397.84,-7516 2397.84,-7433 2397.84,-7433 2397.84,-7433 2397.19,-7433 2397.19,-7433"/>
<polygon fill="black" stroke="black" points="2401.35,-7429.5 2391.35,-7433 2401.35,-7436.5 2401.35,-7429.5"/>
</g>
<!-- layer51_moe_expert6 -->
<g id="node2519" class="node">
<title>layer51_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2737,-7451.21 2409,-7451.21 2409,-7399.21 2737,-7399.21 2737,-7451.21"/>
<text text-anchor="middle" x="2573" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 6 L51</text>
<text text-anchor="middle" x="2573" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2573" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2573" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert6 -->
<g id="node2546" class="node">
<title>layer51_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2749" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2749" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2749" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2749" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer51_moe_expert6&#45;&gt;layer51_moe_comm_from_expert6 -->
<g id="edge3267" class="edge">
<title>layer51_moe_expert6&#45;&gt;layer51_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2697.75,-7398.89C2697.75,-7398.89 2697.75,-7368.3 2697.75,-7368.3"/>
<polygon fill="black" stroke="black" points="2701.25,-7368.3 2697.75,-7358.3 2694.25,-7368.3 2701.25,-7368.3"/>
</g>
<!-- layer51_moe_comm_to_expert6&#45;&gt;layer51_moe_expert6 -->
<g id="edge3236" class="edge">
<title>layer51_moe_comm_to_expert6&#45;&gt;layer51_moe_expert6</title>
<path fill="none" stroke="black" d="M2697.75,-7492.3C2697.75,-7492.3 2697.75,-7461.52 2697.75,-7461.52"/>
<polygon fill="black" stroke="black" points="2701.25,-7461.52 2697.75,-7451.52 2694.25,-7461.52 2701.25,-7461.52"/>
</g>
<!-- layer51_moe_expert7 -->
<g id="node2521" class="node">
<title>layer51_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3083,-7451.21 2755,-7451.21 2755,-7399.21 3083,-7399.21 3083,-7451.21"/>
<text text-anchor="middle" x="2919" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 7 L51</text>
<text text-anchor="middle" x="2919" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2919" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2919" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert7 -->
<g id="node2547" class="node">
<title>layer51_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2956" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2956" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2956" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2956" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer51_moe_expert7&#45;&gt;layer51_moe_comm_from_expert7 -->
<g id="edge3269" class="edge">
<title>layer51_moe_expert7&#45;&gt;layer51_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2956,-7398.89C2956,-7398.89 2956,-7373.35 2956,-7373.35"/>
<polygon fill="black" stroke="black" points="2959.5,-7373.35 2956,-7363.35 2952.5,-7373.35 2959.5,-7373.35"/>
</g>
<!-- layer51_moe_comm_to_expert7&#45;&gt;layer51_moe_expert7 -->
<g id="edge3238" class="edge">
<title>layer51_moe_comm_to_expert7&#45;&gt;layer51_moe_expert7</title>
<path fill="none" stroke="black" d="M2956,-7487.16C2956,-7487.16 2956,-7461.51 2956,-7461.51"/>
<polygon fill="black" stroke="black" points="2959.5,-7461.51 2956,-7451.51 2952.5,-7461.51 2959.5,-7461.51"/>
</g>
<!-- layer51_moe_expert8 -->
<g id="node2523" class="node">
<title>layer51_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3429,-7451.21 3101,-7451.21 3101,-7399.21 3429,-7399.21 3429,-7451.21"/>
<text text-anchor="middle" x="3265" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 8 L51</text>
<text text-anchor="middle" x="3265" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3265" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3265" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert8 -->
<g id="node2548" class="node">
<title>layer51_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3228" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3228" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3228" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3228" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer51_moe_expert8&#45;&gt;layer51_moe_comm_from_expert8 -->
<g id="edge3271" class="edge">
<title>layer51_moe_expert8&#45;&gt;layer51_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3228,-7398.89C3228,-7398.89 3228,-7373.35 3228,-7373.35"/>
<polygon fill="black" stroke="black" points="3231.5,-7373.35 3228,-7363.35 3224.5,-7373.35 3231.5,-7373.35"/>
</g>
<!-- layer51_moe_comm_to_expert8&#45;&gt;layer51_moe_expert8 -->
<g id="edge3240" class="edge">
<title>layer51_moe_comm_to_expert8&#45;&gt;layer51_moe_expert8</title>
<path fill="none" stroke="black" d="M3228,-7487.16C3228,-7487.16 3228,-7461.51 3228,-7461.51"/>
<polygon fill="black" stroke="black" points="3231.5,-7461.51 3228,-7451.51 3224.5,-7461.51 3231.5,-7461.51"/>
</g>
<!-- layer51_moe_expert9 -->
<g id="node2525" class="node">
<title>layer51_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3775,-7451.21 3447,-7451.21 3447,-7399.21 3775,-7399.21 3775,-7451.21"/>
<text text-anchor="middle" x="3611" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 9 L51</text>
<text text-anchor="middle" x="3611" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3611" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3611" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert9 -->
<g id="node2549" class="node">
<title>layer51_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3537" cy="-7334.22" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3537" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3537" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3537" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer51_moe_expert9&#45;&gt;layer51_moe_comm_from_expert9 -->
<g id="edge3273" class="edge">
<title>layer51_moe_expert9&#45;&gt;layer51_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3537.25,-7398.89C3537.25,-7398.89 3537.25,-7373.35 3537.25,-7373.35"/>
<polygon fill="black" stroke="black" points="3540.75,-7373.35 3537.25,-7363.35 3533.75,-7373.35 3540.75,-7373.35"/>
</g>
<!-- layer51_moe_comm_to_expert9&#45;&gt;layer51_moe_expert9 -->
<g id="edge3242" class="edge">
<title>layer51_moe_comm_to_expert9&#45;&gt;layer51_moe_expert9</title>
<path fill="none" stroke="black" d="M3537.25,-7487.16C3537.25,-7487.16 3537.25,-7461.51 3537.25,-7461.51"/>
<polygon fill="black" stroke="black" points="3540.75,-7461.51 3537.25,-7451.51 3533.75,-7461.51 3540.75,-7461.51"/>
</g>
<!-- layer51_moe_expert10 -->
<g id="node2527" class="node">
<title>layer51_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4131,-7451.21 3793,-7451.21 3793,-7399.21 4131,-7399.21 4131,-7451.21"/>
<text text-anchor="middle" x="3962" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 10 L51</text>
<text text-anchor="middle" x="3962" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3962" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3962" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert10 -->
<g id="node2550" class="node">
<title>layer51_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3869" cy="-7334.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3869" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3869" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3869" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer51_moe_expert10&#45;&gt;layer51_moe_comm_from_expert10 -->
<g id="edge3275" class="edge">
<title>layer51_moe_expert10&#45;&gt;layer51_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3878.38,-7398.89C3878.38,-7398.89 3878.38,-7373.35 3878.38,-7373.35"/>
<polygon fill="black" stroke="black" points="3881.88,-7373.35 3878.38,-7363.35 3874.88,-7373.35 3881.88,-7373.35"/>
</g>
<!-- layer51_moe_comm_to_expert10&#45;&gt;layer51_moe_expert10 -->
<g id="edge3244" class="edge">
<title>layer51_moe_comm_to_expert10&#45;&gt;layer51_moe_expert10</title>
<path fill="none" stroke="black" d="M3878.02,-7487.16C3878.02,-7487.16 3878.02,-7461.51 3878.02,-7461.51"/>
<polygon fill="black" stroke="black" points="3881.52,-7461.51 3878.02,-7451.51 3874.52,-7461.51 3881.52,-7461.51"/>
</g>
<!-- layer51_moe_expert11 -->
<g id="node2529" class="node">
<title>layer51_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4487,-7451.21 4149,-7451.21 4149,-7399.21 4487,-7399.21 4487,-7451.21"/>
<text text-anchor="middle" x="4318" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 11 L51</text>
<text text-anchor="middle" x="4318" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4318" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4318" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert11 -->
<g id="node2551" class="node">
<title>layer51_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4216" cy="-7334.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4216" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4216" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4216" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer51_moe_expert11&#45;&gt;layer51_moe_comm_from_expert11 -->
<g id="edge3277" class="edge">
<title>layer51_moe_expert11&#45;&gt;layer51_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4229.88,-7398.89C4229.88,-7398.89 4229.88,-7373.03 4229.88,-7373.03"/>
<polygon fill="black" stroke="black" points="4233.38,-7373.03 4229.88,-7363.03 4226.38,-7373.03 4233.38,-7373.03"/>
</g>
<!-- layer51_moe_comm_to_expert11&#45;&gt;layer51_moe_expert11 -->
<g id="edge3246" class="edge">
<title>layer51_moe_comm_to_expert11&#45;&gt;layer51_moe_expert11</title>
<path fill="none" stroke="black" d="M4229.02,-7487.41C4229.02,-7487.41 4229.02,-7461.35 4229.02,-7461.35"/>
<polygon fill="black" stroke="black" points="4232.52,-7461.35 4229.02,-7451.35 4225.52,-7461.35 4232.52,-7461.35"/>
</g>
<!-- layer51_moe_expert12 -->
<g id="node2531" class="node">
<title>layer51_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4843,-7451.21 4505,-7451.21 4505,-7399.21 4843,-7399.21 4843,-7451.21"/>
<text text-anchor="middle" x="4674" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 12 L51</text>
<text text-anchor="middle" x="4674" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4674" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4674" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert12 -->
<g id="node2552" class="node">
<title>layer51_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4567" cy="-7334.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4567" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4567" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4567" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer51_moe_expert12&#45;&gt;layer51_moe_comm_from_expert12 -->
<g id="edge3279" class="edge">
<title>layer51_moe_expert12&#45;&gt;layer51_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4583.38,-7398.89C4583.38,-7398.89 4583.38,-7373.03 4583.38,-7373.03"/>
<polygon fill="black" stroke="black" points="4586.88,-7373.03 4583.38,-7363.03 4579.88,-7373.03 4586.88,-7373.03"/>
</g>
<!-- layer51_moe_comm_to_expert12&#45;&gt;layer51_moe_expert12 -->
<g id="edge3248" class="edge">
<title>layer51_moe_comm_to_expert12&#45;&gt;layer51_moe_expert12</title>
<path fill="none" stroke="black" d="M4582.52,-7487.41C4582.52,-7487.41 4582.52,-7461.35 4582.52,-7461.35"/>
<polygon fill="black" stroke="black" points="4586.02,-7461.35 4582.52,-7451.35 4579.02,-7461.35 4586.02,-7461.35"/>
</g>
<!-- layer51_moe_expert13 -->
<g id="node2533" class="node">
<title>layer51_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5199,-7451.21 4861,-7451.21 4861,-7399.21 5199,-7399.21 5199,-7451.21"/>
<text text-anchor="middle" x="5030" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 13 L51</text>
<text text-anchor="middle" x="5030" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5030" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="5030" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert13 -->
<g id="node2553" class="node">
<title>layer51_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4921" cy="-7334.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4921" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4921" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4921" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer51_moe_expert13&#45;&gt;layer51_moe_comm_from_expert13 -->
<g id="edge3281" class="edge">
<title>layer51_moe_expert13&#45;&gt;layer51_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4938.38,-7398.89C4938.38,-7398.89 4938.38,-7373.03 4938.38,-7373.03"/>
<polygon fill="black" stroke="black" points="4941.88,-7373.03 4938.38,-7363.03 4934.88,-7373.03 4941.88,-7373.03"/>
</g>
<!-- layer51_moe_comm_to_expert13&#45;&gt;layer51_moe_expert13 -->
<g id="edge3250" class="edge">
<title>layer51_moe_comm_to_expert13&#45;&gt;layer51_moe_expert13</title>
<path fill="none" stroke="black" d="M4937.02,-7487.41C4937.02,-7487.41 4937.02,-7461.35 4937.02,-7461.35"/>
<polygon fill="black" stroke="black" points="4940.52,-7461.35 4937.02,-7451.35 4933.52,-7461.35 4940.52,-7461.35"/>
</g>
<!-- layer51_moe_expert14 -->
<g id="node2535" class="node">
<title>layer51_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5555,-7451.21 5217,-7451.21 5217,-7399.21 5555,-7399.21 5555,-7451.21"/>
<text text-anchor="middle" x="5386" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 14 L51</text>
<text text-anchor="middle" x="5386" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5386" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5386" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert14 -->
<g id="node2554" class="node">
<title>layer51_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5276" cy="-7334.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5276" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5276" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5276" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer51_moe_expert14&#45;&gt;layer51_moe_comm_from_expert14 -->
<g id="edge3283" class="edge">
<title>layer51_moe_expert14&#45;&gt;layer51_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5293.88,-7398.89C5293.88,-7398.89 5293.88,-7372.71 5293.88,-7372.71"/>
<polygon fill="black" stroke="black" points="5297.38,-7372.71 5293.88,-7362.71 5290.38,-7372.71 5297.38,-7372.71"/>
</g>
<!-- layer51_moe_comm_to_expert14&#45;&gt;layer51_moe_expert14 -->
<g id="edge3252" class="edge">
<title>layer51_moe_comm_to_expert14&#45;&gt;layer51_moe_expert14</title>
<path fill="none" stroke="black" d="M5292.52,-7487.41C5292.52,-7487.41 5292.52,-7461.35 5292.52,-7461.35"/>
<polygon fill="black" stroke="black" points="5296.02,-7461.35 5292.52,-7451.35 5289.02,-7461.35 5296.02,-7461.35"/>
</g>
<!-- layer51_moe_expert15 -->
<g id="node2537" class="node">
<title>layer51_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5911,-7451.21 5573,-7451.21 5573,-7399.21 5911,-7399.21 5911,-7451.21"/>
<text text-anchor="middle" x="5742" y="-7439.21" font-family="Arial" font-size="10.00">EXPERT 15 L51</text>
<text text-anchor="middle" x="5742" y="-7428.21" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5742" y="-7417.21" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5742" y="-7406.21" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_comm_from_expert15 -->
<g id="node2555" class="node">
<title>layer51_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5631" cy="-7334.22" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5631" y="-7342.72" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5631" y="-7331.72" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5631" y="-7320.72" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer51_moe_expert15&#45;&gt;layer51_moe_comm_from_expert15 -->
<g id="edge3285" class="edge">
<title>layer51_moe_expert15&#45;&gt;layer51_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5649.38,-7398.89C5649.38,-7398.89 5649.38,-7372.71 5649.38,-7372.71"/>
<polygon fill="black" stroke="black" points="5652.88,-7372.71 5649.38,-7362.71 5645.88,-7372.71 5652.88,-7372.71"/>
</g>
<!-- layer51_moe_comm_to_expert15&#45;&gt;layer51_moe_expert15 -->
<g id="edge3254" class="edge">
<title>layer51_moe_comm_to_expert15&#45;&gt;layer51_moe_expert15</title>
<path fill="none" stroke="black" d="M5648.02,-7487.41C5648.02,-7487.41 5648.02,-7461.35 5648.02,-7461.35"/>
<polygon fill="black" stroke="black" points="5651.52,-7461.35 5648.02,-7451.35 5644.52,-7461.35 5651.52,-7461.35"/>
</g>
<!-- layer51_moe_aggregate -->
<g id="node2539" class="node">
<title>layer51_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3317.1,-7269.23 2900.16,-7269.23 2792.9,-7165.23 3209.84,-7165.23 3317.1,-7269.23"/>
<text text-anchor="middle" x="3055" y="-7231.23" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L51</text>
<text text-anchor="middle" x="3055" y="-7220.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3055" y="-7209.23" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3055" y="-7198.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_mha -->
<g id="node2556" class="node">
<title>layer52_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3185,-7129.23 2925,-7129.23 2925,-7077.23 3185,-7077.23 3185,-7129.23"/>
<text text-anchor="middle" x="3055" y="-7117.23" font-family="Arial" font-size="10.00">MHA L52</text>
<text text-anchor="middle" x="3055" y="-7106.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3055" y="-7095.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3055" y="-7084.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer51_moe_aggregate&#45;&gt;layer52_moe_mha -->
<g id="edge3354" class="edge">
<title>layer51_moe_aggregate&#45;&gt;layer52_moe_mha</title>
<path fill="none" stroke="black" d="M3055,-7164.9C3055,-7164.9 3055,-7139.46 3055,-7139.46"/>
<polygon fill="black" stroke="black" points="3058.5,-7139.46 3055,-7129.46 3051.5,-7139.46 3058.5,-7139.46"/>
</g>
<!-- layer51_moe_comm_from_expert0&#45;&gt;layer51_moe_aggregate -->
<g id="edge3256" class="edge">
<title>layer51_moe_comm_from_expert0&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M628.75,-7324.57C628.75,-7290.81 628.75,-7180 628.75,-7180 628.75,-7180 2797.88,-7180 2797.88,-7180"/>
<polygon fill="black" stroke="black" points="2797.88,-7183.5 2807.88,-7180 2797.88,-7176.5 2797.88,-7183.5"/>
</g>
<!-- layer51_moe_comm_from_expert1&#45;&gt;layer51_moe_aggregate -->
<g id="edge3258" class="edge">
<title>layer51_moe_comm_from_expert1&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M1340.25,-7323.22C1340.25,-7290.16 1340.25,-7194 1340.25,-7194 1340.25,-7194 2812.4,-7194 2812.4,-7194"/>
<polygon fill="black" stroke="black" points="2812.4,-7197.5 2822.4,-7194 2812.4,-7190.5 2812.4,-7197.5"/>
</g>
<!-- layer51_moe_comm_from_expert2&#45;&gt;layer51_moe_aggregate -->
<g id="edge3260" class="edge">
<title>layer51_moe_comm_from_expert2&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M1784.01,-7316.54C1784.01,-7282.03 1784.01,-7209 1784.01,-7209 1784.01,-7209 2827.95,-7209 2827.95,-7209"/>
<polygon fill="black" stroke="black" points="2827.95,-7212.5 2837.95,-7209 2827.95,-7205.5 2827.95,-7212.5"/>
</g>
<!-- layer51_moe_comm_from_expert3&#45;&gt;layer51_moe_aggregate -->
<g id="edge3262" class="edge">
<title>layer51_moe_comm_from_expert3&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M2112.01,-7316.51C2112.01,-7285.35 2112.01,-7224 2112.01,-7224 2112.01,-7224 2843.28,-7224 2843.28,-7224"/>
<polygon fill="black" stroke="black" points="2843.28,-7227.5 2853.28,-7224 2843.28,-7220.5 2843.28,-7227.5"/>
</g>
<!-- layer51_moe_comm_from_expert4&#45;&gt;layer51_moe_aggregate -->
<g id="edge3264" class="edge">
<title>layer51_moe_comm_from_expert4&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M2382.75,-7320.17C2382.75,-7293.68 2382.75,-7239 2382.75,-7239 2382.75,-7239 2858.63,-7239 2858.63,-7239"/>
<polygon fill="black" stroke="black" points="2858.64,-7242.5 2868.63,-7239 2858.63,-7235.5 2858.64,-7242.5"/>
</g>
<!-- layer51_moe_comm_from_expert5&#45;&gt;layer51_moe_aggregate -->
<g id="edge3266" class="edge">
<title>layer51_moe_comm_from_expert5&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M2604.5,-7316.02C2604.5,-7292.35 2604.5,-7254 2604.5,-7254 2604.5,-7254 2874.36,-7254 2874.36,-7254"/>
<polygon fill="black" stroke="black" points="2874.36,-7257.5 2884.36,-7254 2874.36,-7250.5 2874.36,-7257.5"/>
</g>
<!-- layer51_moe_comm_from_expert6&#45;&gt;layer51_moe_aggregate -->
<g id="edge3268" class="edge">
<title>layer51_moe_comm_from_expert6&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M2816.11,-7314.64C2816.11,-7314.64 2816.11,-7227.28 2816.11,-7227.28"/>
<polygon fill="black" stroke="black" points="2819.61,-7227.28 2816.11,-7217.28 2812.61,-7227.28 2819.61,-7227.28"/>
</g>
<!-- layer51_moe_comm_from_expert7&#45;&gt;layer51_moe_aggregate -->
<g id="edge3270" class="edge">
<title>layer51_moe_comm_from_expert7&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M2956,-7305C2956,-7305 2956,-7279.29 2956,-7279.29"/>
<polygon fill="black" stroke="black" points="2959.5,-7279.29 2956,-7269.29 2952.5,-7279.29 2959.5,-7279.29"/>
</g>
<!-- layer51_moe_comm_from_expert8&#45;&gt;layer51_moe_aggregate -->
<g id="edge3272" class="edge">
<title>layer51_moe_comm_from_expert8&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M3227.39,-7305C3227.39,-7305 3227.39,-7279.29 3227.39,-7279.29"/>
<polygon fill="black" stroke="black" points="3230.89,-7279.29 3227.39,-7269.29 3223.89,-7279.29 3230.89,-7279.29"/>
</g>
<!-- layer51_moe_comm_from_expert9&#45;&gt;layer51_moe_aggregate -->
<g id="edge3274" class="edge">
<title>layer51_moe_comm_from_expert9&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M3518.5,-7305.54C3518.5,-7283.21 3518.5,-7256 3518.5,-7256 3518.5,-7256 3313.71,-7256 3313.71,-7256"/>
<polygon fill="black" stroke="black" points="3313.71,-7252.5 3303.71,-7256 3313.71,-7259.5 3313.71,-7252.5"/>
</g>
<!-- layer51_moe_comm_from_expert10&#45;&gt;layer51_moe_aggregate -->
<g id="edge3276" class="edge">
<title>layer51_moe_comm_from_expert10&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M3850.15,-7305.36C3850.15,-7278.63 3850.15,-7243 3850.15,-7243 3850.15,-7243 3300.07,-7243 3300.07,-7243"/>
<polygon fill="black" stroke="black" points="3300.07,-7239.5 3290.07,-7243 3300.07,-7246.5 3300.07,-7239.5"/>
</g>
<!-- layer51_moe_comm_from_expert11&#45;&gt;layer51_moe_aggregate -->
<g id="edge3278" class="edge">
<title>layer51_moe_comm_from_expert11&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M4196.65,-7305.74C4196.65,-7274.88 4196.65,-7230 4196.65,-7230 4196.65,-7230 3286.81,-7230 3286.81,-7230"/>
<polygon fill="black" stroke="black" points="3286.81,-7226.5 3276.81,-7230 3286.81,-7233.5 3286.81,-7226.5"/>
</g>
<!-- layer51_moe_comm_from_expert12&#45;&gt;layer51_moe_aggregate -->
<g id="edge3280" class="edge">
<title>layer51_moe_comm_from_expert12&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M4547.65,-7305.54C4547.65,-7270.84 4547.65,-7217 4547.65,-7217 4547.65,-7217 3273.33,-7217 3273.33,-7217"/>
<polygon fill="black" stroke="black" points="3273.33,-7213.5 3263.33,-7217 3273.33,-7220.5 3273.33,-7213.5"/>
</g>
<!-- layer51_moe_comm_from_expert13&#45;&gt;layer51_moe_aggregate -->
<g id="edge3282" class="edge">
<title>layer51_moe_comm_from_expert13&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M4901.15,-7305.64C4901.15,-7267.31 4901.15,-7204 4901.15,-7204 4901.15,-7204 3259.95,-7204 3259.95,-7204"/>
<polygon fill="black" stroke="black" points="3259.95,-7200.5 3249.95,-7204 3259.95,-7207.5 3259.95,-7200.5"/>
</g>
<!-- layer51_moe_comm_from_expert14&#45;&gt;layer51_moe_aggregate -->
<g id="edge3284" class="edge">
<title>layer51_moe_comm_from_expert14&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M5256.15,-7305.58C5256.15,-7263.79 5256.15,-7191 5256.15,-7191 5256.15,-7191 3246.53,-7191 3246.53,-7191"/>
<polygon fill="black" stroke="black" points="3246.53,-7187.5 3236.53,-7191 3246.53,-7194.5 3246.53,-7187.5"/>
</g>
<!-- layer51_moe_comm_from_expert15&#45;&gt;layer51_moe_aggregate -->
<g id="edge3286" class="edge">
<title>layer51_moe_comm_from_expert15&#45;&gt;layer51_moe_aggregate</title>
<path fill="none" stroke="black" d="M5611.15,-7305.57C5611.15,-7260.47 5611.15,-7178 5611.15,-7178 5611.15,-7178 3233.21,-7178 3233.21,-7178"/>
<polygon fill="black" stroke="black" points="3233.21,-7174.5 3223.21,-7178 3233.21,-7181.5 3233.21,-7174.5"/>
</g>
<!-- layer52_moe_gate -->
<g id="node2557" class="node">
<title>layer52_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3313.3,-7041.23 2902.4,-7041.23 2796.7,-6937.23 3207.6,-6937.23 3313.3,-7041.23"/>
<text text-anchor="middle" x="3055" y="-7003.23" font-family="Arial" font-size="10.00">GATE L52</text>
<text text-anchor="middle" x="3055" y="-6992.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3055" y="-6981.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3055" y="-6970.23" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer52_moe_mha&#45;&gt;layer52_moe_gate -->
<g id="edge3355" class="edge">
<title>layer52_moe_mha&#45;&gt;layer52_moe_gate</title>
<path fill="none" stroke="black" d="M3055,-7077.07C3055,-7077.07 3055,-7051.33 3055,-7051.33"/>
<polygon fill="black" stroke="black" points="3058.5,-7051.33 3055,-7041.33 3051.5,-7051.33 3058.5,-7051.33"/>
</g>
<!-- layer52_moe_split -->
<g id="node2558" class="node">
<title>layer52_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3309.01,-6901.23 2904.94,-6901.23 2800.99,-6797.23 3205.06,-6797.23 3309.01,-6901.23"/>
<text text-anchor="middle" x="3055" y="-6863.23" font-family="Arial" font-size="10.00">SPLIT TOKENS L52</text>
<text text-anchor="middle" x="3055" y="-6852.23" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3055" y="-6841.23" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3055" y="-6830.23" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer52_moe_gate&#45;&gt;layer52_moe_split -->
<g id="edge3356" class="edge">
<title>layer52_moe_gate&#45;&gt;layer52_moe_split</title>
<path fill="none" stroke="black" d="M3055,-6937.1C3055,-6937.1 3055,-6911.4 3055,-6911.4"/>
<polygon fill="black" stroke="black" points="3058.5,-6911.4 3055,-6901.4 3051.5,-6911.4 3058.5,-6911.4"/>
</g>
<!-- layer52_moe_comm_to_expert0 -->
<g id="node2560" class="node">
<title>layer52_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="974" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="974" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="974" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="974" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert0 -->
<g id="edge3290" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2889.64,-6886C2408.77,-6886 1044.75,-6886 1044.75,-6886 1044.75,-6886 1044.75,-6760.48 1044.75,-6760.48"/>
<polygon fill="black" stroke="black" points="1048.25,-6760.48 1044.75,-6750.48 1041.25,-6760.48 1048.25,-6760.48"/>
</g>
<!-- layer52_moe_comm_to_expert1 -->
<g id="node2562" class="node">
<title>layer52_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1219" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1219" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1219" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1219" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert1 -->
<g id="edge3292" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2874.5,-6871C2415.09,-6871 1237.5,-6871 1237.5,-6871 1237.5,-6871 1237.5,-6770.65 1237.5,-6770.65"/>
<polygon fill="black" stroke="black" points="1241,-6770.65 1237.5,-6760.65 1234,-6770.65 1241,-6770.65"/>
</g>
<!-- layer52_moe_comm_to_expert2 -->
<g id="node2564" class="node">
<title>layer52_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1675" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1675" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1675" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1675" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert2 -->
<g id="edge3294" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2859.57,-6856C2482.96,-6856 1693.5,-6856 1693.5,-6856 1693.5,-6856 1693.5,-6770.63 1693.5,-6770.63"/>
<polygon fill="black" stroke="black" points="1697,-6770.63 1693.5,-6760.63 1690,-6770.63 1697,-6770.63"/>
</g>
<!-- layer52_moe_comm_to_expert3 -->
<g id="node2566" class="node">
<title>layer52_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2003" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2003" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="2003" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2003" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert3 -->
<g id="edge3296" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2844.61,-6841C2542.43,-6841 2021.5,-6841 2021.5,-6841 2021.5,-6841 2021.5,-6770.81 2021.5,-6770.81"/>
<polygon fill="black" stroke="black" points="2025,-6770.81 2021.5,-6760.81 2018,-6770.81 2025,-6770.81"/>
</g>
<!-- layer52_moe_comm_to_expert4 -->
<g id="node2568" class="node">
<title>layer52_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2266" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2266" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2266" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2266" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert4 -->
<g id="edge3298" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2829.55,-6826C2602.16,-6826 2284.5,-6826 2284.5,-6826 2284.5,-6826 2284.5,-6770.62 2284.5,-6770.62"/>
<polygon fill="black" stroke="black" points="2288,-6770.62 2284.5,-6760.62 2281,-6770.62 2288,-6770.62"/>
</g>
<!-- layer52_moe_comm_to_expert5 -->
<g id="node2570" class="node">
<title>layer52_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2497" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2497" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2497" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2497" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert5 -->
<g id="edge3300" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2815.62,-6812C2671.42,-6812 2515.5,-6812 2515.5,-6812 2515.5,-6812 2515.5,-6771.03 2515.5,-6771.03"/>
<polygon fill="black" stroke="black" points="2519,-6771.03 2515.5,-6761.03 2512,-6771.03 2519,-6771.03"/>
</g>
<!-- layer52_moe_comm_to_expert6 -->
<g id="node2572" class="node">
<title>layer52_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2712" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2712" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2712" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2712" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert6 -->
<g id="edge3302" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2815.5,-6849.14C2815.5,-6845.59 2815.5,-6732 2815.5,-6732 2815.5,-6732 2812.81,-6732 2812.81,-6732"/>
<polygon fill="black" stroke="black" points="2812.81,-6728.5 2802.81,-6732 2812.81,-6735.5 2812.81,-6728.5"/>
</g>
<!-- layer52_moe_comm_to_expert7 -->
<g id="node2574" class="node">
<title>layer52_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2919" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2919" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2919" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2919" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert7 -->
<g id="edge3304" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2919,-6796.89C2919,-6796.89 2919,-6771.45 2919,-6771.45"/>
<polygon fill="black" stroke="black" points="2922.5,-6771.45 2919,-6761.45 2915.5,-6771.45 2922.5,-6771.45"/>
</g>
<!-- layer52_moe_comm_to_expert8 -->
<g id="node2576" class="node">
<title>layer52_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3191" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3191" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3191" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3191" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert8 -->
<g id="edge3306" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3191,-6796.89C3191,-6796.89 3191,-6771.45 3191,-6771.45"/>
<polygon fill="black" stroke="black" points="3194.5,-6771.45 3191,-6761.45 3187.5,-6771.45 3194.5,-6771.45"/>
</g>
<!-- layer52_moe_comm_to_expert9 -->
<g id="node2578" class="node">
<title>layer52_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3500" cy="-6732.24" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3500" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3500" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3500" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert9 -->
<g id="edge3308" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3295.26,-6849.14C3295.26,-6845.59 3295.26,-6732 3295.26,-6732 3295.26,-6732 3399.3,-6732 3399.3,-6732"/>
<polygon fill="black" stroke="black" points="3399.3,-6735.5 3409.3,-6732 3399.3,-6728.5 3399.3,-6735.5"/>
</g>
<!-- layer52_moe_comm_to_expert10 -->
<g id="node2580" class="node">
<title>layer52_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3832" cy="-6732.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3832" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3832" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3832" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert10 -->
<g id="edge3310" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3220.26,-6812C3427.54,-6812 3756.1,-6812 3756.1,-6812 3756.1,-6812 3756.1,-6759.54 3756.1,-6759.54"/>
<polygon fill="black" stroke="black" points="3759.6,-6759.54 3756.1,-6749.54 3752.6,-6759.54 3759.6,-6759.54"/>
</g>
<!-- layer52_moe_comm_to_expert11 -->
<g id="node2582" class="node">
<title>layer52_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4178" cy="-6732.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4178" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4178" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4178" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert11 -->
<g id="edge3312" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3233.9,-6826C3533.11,-6826 4102.6,-6826 4102.6,-6826 4102.6,-6826 4102.6,-6759.87 4102.6,-6759.87"/>
<polygon fill="black" stroke="black" points="4106.1,-6759.87 4102.6,-6749.87 4099.1,-6759.87 4106.1,-6759.87"/>
</g>
<!-- layer52_moe_comm_to_expert12 -->
<g id="node2584" class="node">
<title>layer52_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4529" cy="-6732.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4529" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4529" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4529" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert12 -->
<g id="edge3314" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3249.1,-6841C3633.24,-6841 4453.6,-6841 4453.6,-6841 4453.6,-6841 4453.6,-6759.71 4453.6,-6759.71"/>
<polygon fill="black" stroke="black" points="4457.1,-6759.71 4453.6,-6749.71 4450.1,-6759.71 4457.1,-6759.71"/>
</g>
<!-- layer52_moe_comm_to_expert13 -->
<g id="node2586" class="node">
<title>layer52_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4882" cy="-6732.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4882" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4882" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4882" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert13 -->
<g id="edge3316" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3264.17,-6856C3729,-6856 4807.1,-6856 4807.1,-6856 4807.1,-6856 4807.1,-6759.97 4807.1,-6759.97"/>
<polygon fill="black" stroke="black" points="4810.6,-6759.97 4807.1,-6749.97 4803.6,-6759.97 4810.6,-6759.97"/>
</g>
<!-- layer52_moe_comm_to_expert14 -->
<g id="node2588" class="node">
<title>layer52_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5237" cy="-6732.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5237" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5237" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5237" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert14 -->
<g id="edge3318" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3279,-6871C3821.61,-6871 5162.1,-6871 5162.1,-6871 5162.1,-6871 5162.1,-6759.81 5162.1,-6759.81"/>
<polygon fill="black" stroke="black" points="5165.6,-6759.81 5162.1,-6749.81 5158.6,-6759.81 5165.6,-6759.81"/>
</g>
<!-- layer52_moe_comm_to_expert15 -->
<g id="node2590" class="node">
<title>layer52_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5592" cy="-6732.24" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5592" y="-6740.74" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5592" y="-6729.74" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5592" y="-6718.74" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert15 -->
<g id="edge3320" class="edge">
<title>layer52_moe_split&#45;&gt;layer52_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3293.87,-6886C3912.18,-6886 5517.1,-6886 5517.1,-6886 5517.1,-6886 5517.1,-6759.88 5517.1,-6759.88"/>
<polygon fill="black" stroke="black" points="5520.6,-6759.88 5517.1,-6749.88 5513.6,-6759.88 5520.6,-6759.88"/>
</g>
<!-- layer52_moe_expert0 -->
<g id="node2559" class="node">
<title>layer52_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="624,-6667.25 296,-6667.25 296,-6615.25 624,-6615.25 624,-6667.25"/>
<text text-anchor="middle" x="460" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 0 L52</text>
<text text-anchor="middle" x="460" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="460" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="460" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert0 -->
<g id="node2592" class="node">
<title>layer52_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="754" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="754" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="754" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="754" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer52_moe_expert0&#45;&gt;layer52_moe_comm_from_expert0 -->
<g id="edge3322" class="edge">
<title>layer52_moe_expert0&#45;&gt;layer52_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M614.5,-6614.85C614.5,-6587.91 614.5,-6550 614.5,-6550 614.5,-6550 653.29,-6550 653.29,-6550"/>
<polygon fill="black" stroke="black" points="653.29,-6553.5 663.29,-6550 653.29,-6546.5 653.29,-6553.5"/>
</g>
<!-- layer52_moe_comm_to_expert0&#45;&gt;layer52_moe_expert0 -->
<g id="edge3291" class="edge">
<title>layer52_moe_comm_to_expert0&#45;&gt;layer52_moe_expert0</title>
<path fill="none" stroke="black" d="M883.45,-6732C755.78,-6732 538.25,-6732 538.25,-6732 538.25,-6732 538.25,-6677.5 538.25,-6677.5"/>
<polygon fill="black" stroke="black" points="541.75,-6677.5 538.25,-6667.5 534.75,-6677.5 541.75,-6677.5"/>
</g>
<!-- layer52_moe_expert1 -->
<g id="node2561" class="node">
<title>layer52_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="970,-6667.25 642,-6667.25 642,-6615.25 970,-6615.25 970,-6667.25"/>
<text text-anchor="middle" x="806" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 1 L52</text>
<text text-anchor="middle" x="806" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="806" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="806" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert1 -->
<g id="node2593" class="node">
<title>layer52_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1100" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1100" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1100" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1100" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer52_moe_expert1&#45;&gt;layer52_moe_comm_from_expert1 -->
<g id="edge3324" class="edge">
<title>layer52_moe_expert1&#45;&gt;layer52_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M960.5,-6614.85C960.5,-6587.91 960.5,-6550 960.5,-6550 960.5,-6550 999.29,-6550 999.29,-6550"/>
<polygon fill="black" stroke="black" points="999.29,-6553.5 1009.29,-6550 999.29,-6546.5 999.29,-6553.5"/>
</g>
<!-- layer52_moe_comm_to_expert1&#45;&gt;layer52_moe_expert1 -->
<g id="edge3293" class="edge">
<title>layer52_moe_comm_to_expert1&#45;&gt;layer52_moe_expert1</title>
<path fill="none" stroke="black" d="M1219,-6703.13C1219,-6689.41 1219,-6676 1219,-6676 1219,-6676 926.75,-6676 926.75,-6676 926.75,-6676 926.75,-6675.16 926.75,-6675.16"/>
<polygon fill="black" stroke="black" points="930.25,-6677.59 926.75,-6667.59 923.25,-6677.59 930.25,-6677.59"/>
</g>
<!-- layer52_moe_expert2 -->
<g id="node2563" class="node">
<title>layer52_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1316,-6667.25 988,-6667.25 988,-6615.25 1316,-6615.25 1316,-6667.25"/>
<text text-anchor="middle" x="1152" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 2 L52</text>
<text text-anchor="middle" x="1152" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1152" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1152" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert2 -->
<g id="node2594" class="node">
<title>layer52_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1446" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1446" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1446" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1446" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer52_moe_expert2&#45;&gt;layer52_moe_comm_from_expert2 -->
<g id="edge3326" class="edge">
<title>layer52_moe_expert2&#45;&gt;layer52_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1306.5,-6614.85C1306.5,-6587.91 1306.5,-6550 1306.5,-6550 1306.5,-6550 1345.29,-6550 1345.29,-6550"/>
<polygon fill="black" stroke="black" points="1345.29,-6553.5 1355.29,-6550 1345.29,-6546.5 1345.29,-6553.5"/>
</g>
<!-- layer52_moe_comm_to_expert2&#45;&gt;layer52_moe_expert2 -->
<g id="edge3295" class="edge">
<title>layer52_moe_comm_to_expert2&#45;&gt;layer52_moe_expert2</title>
<path fill="none" stroke="black" d="M1584.41,-6732C1480.71,-6732 1325,-6732 1325,-6732 1325,-6732 1325,-6641 1325,-6641 1325,-6641 1324.12,-6641 1324.12,-6641"/>
<polygon fill="black" stroke="black" points="1326.18,-6637.5 1316.18,-6641 1326.18,-6644.5 1326.18,-6637.5"/>
</g>
<!-- layer52_moe_expert3 -->
<g id="node2565" class="node">
<title>layer52_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1662,-6667.25 1334,-6667.25 1334,-6615.25 1662,-6615.25 1662,-6667.25"/>
<text text-anchor="middle" x="1498" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 3 L52</text>
<text text-anchor="middle" x="1498" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1498" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1498" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert3 -->
<g id="node2595" class="node">
<title>layer52_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1718" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1718" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1718" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1718" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer52_moe_expert3&#45;&gt;layer52_moe_comm_from_expert3 -->
<g id="edge3328" class="edge">
<title>layer52_moe_expert3&#45;&gt;layer52_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1644.75,-6614.93C1644.75,-6614.93 1644.75,-6577.33 1644.75,-6577.33"/>
<polygon fill="black" stroke="black" points="1648.25,-6577.33 1644.75,-6567.33 1641.25,-6577.33 1648.25,-6577.33"/>
</g>
<!-- layer52_moe_comm_to_expert3&#45;&gt;layer52_moe_expert3 -->
<g id="edge3297" class="edge">
<title>layer52_moe_comm_to_expert3&#45;&gt;layer52_moe_expert3</title>
<path fill="none" stroke="black" d="M1944.33,-6709.99C1944.33,-6701.58 1944.33,-6694 1944.33,-6694 1944.33,-6694 1623.25,-6694 1623.25,-6694 1623.25,-6694 1623.25,-6677.31 1623.25,-6677.31"/>
<polygon fill="black" stroke="black" points="1626.75,-6677.31 1623.25,-6667.31 1619.75,-6677.31 1626.75,-6677.31"/>
</g>
<!-- layer52_moe_expert4 -->
<g id="node2567" class="node">
<title>layer52_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="2008,-6667.25 1680,-6667.25 1680,-6615.25 2008,-6615.25 2008,-6667.25"/>
<text text-anchor="middle" x="1844" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 4 L52</text>
<text text-anchor="middle" x="1844" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1844" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1844" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert4 -->
<g id="node2596" class="node">
<title>layer52_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="1954" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1954" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="1954" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1954" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer52_moe_expert4&#45;&gt;layer52_moe_comm_from_expert4 -->
<g id="edge3330" class="edge">
<title>layer52_moe_expert4&#45;&gt;layer52_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1935.75,-6614.93C1935.75,-6614.93 1935.75,-6588.74 1935.75,-6588.74"/>
<polygon fill="black" stroke="black" points="1939.25,-6588.74 1935.75,-6578.74 1932.25,-6588.74 1939.25,-6588.74"/>
</g>
<!-- layer52_moe_comm_to_expert4&#45;&gt;layer52_moe_expert4 -->
<g id="edge3299" class="edge">
<title>layer52_moe_comm_to_expert4&#45;&gt;layer52_moe_expert4</title>
<path fill="none" stroke="black" d="M2264.75,-6703.13C2264.75,-6693.41 2264.75,-6685 2264.75,-6685 2264.75,-6685 1976.16,-6685 1976.16,-6685 1976.16,-6685 1976.16,-6677.46 1976.16,-6677.46"/>
<polygon fill="black" stroke="black" points="1979.66,-6677.46 1976.16,-6667.46 1972.66,-6677.46 1979.66,-6677.46"/>
</g>
<!-- layer52_moe_expert5 -->
<g id="node2569" class="node">
<title>layer52_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2354,-6667.25 2026,-6667.25 2026,-6615.25 2354,-6615.25 2354,-6667.25"/>
<text text-anchor="middle" x="2190" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 5 L52</text>
<text text-anchor="middle" x="2190" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2190" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2190" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert5 -->
<g id="node2597" class="node">
<title>layer52_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2301" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2301" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2301" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2301" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer52_moe_expert5&#45;&gt;layer52_moe_comm_from_expert5 -->
<g id="edge3332" class="edge">
<title>layer52_moe_expert5&#45;&gt;layer52_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2282.25,-6614.93C2282.25,-6614.93 2282.25,-6588.74 2282.25,-6588.74"/>
<polygon fill="black" stroke="black" points="2285.75,-6588.74 2282.25,-6578.74 2278.75,-6588.74 2285.75,-6588.74"/>
</g>
<!-- layer52_moe_comm_to_expert5&#45;&gt;layer52_moe_expert5 -->
<g id="edge3301" class="edge">
<title>layer52_moe_comm_to_expert5&#45;&gt;layer52_moe_expert5</title>
<path fill="none" stroke="black" d="M2406.26,-6732C2382.92,-6732 2364.25,-6732 2364.25,-6732 2364.25,-6732 2364.25,-6641 2364.25,-6641 2364.25,-6641 2363.24,-6641 2363.24,-6641"/>
<polygon fill="black" stroke="black" points="2364.13,-6637.5 2354.13,-6641 2364.13,-6644.5 2364.13,-6637.5"/>
</g>
<!-- layer52_moe_expert6 -->
<g id="node2571" class="node">
<title>layer52_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2700,-6667.25 2372,-6667.25 2372,-6615.25 2700,-6615.25 2700,-6667.25"/>
<text text-anchor="middle" x="2536" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 6 L52</text>
<text text-anchor="middle" x="2536" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2536" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2536" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert6 -->
<g id="node2598" class="node">
<title>layer52_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2647" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2647" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2647" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2647" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer52_moe_expert6&#45;&gt;layer52_moe_comm_from_expert6 -->
<g id="edge3334" class="edge">
<title>layer52_moe_expert6&#45;&gt;layer52_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2628.25,-6614.93C2628.25,-6614.93 2628.25,-6588.74 2628.25,-6588.74"/>
<polygon fill="black" stroke="black" points="2631.75,-6588.74 2628.25,-6578.74 2624.75,-6588.74 2631.75,-6588.74"/>
</g>
<!-- layer52_moe_comm_to_expert6&#45;&gt;layer52_moe_expert6 -->
<g id="edge3303" class="edge">
<title>layer52_moe_comm_to_expert6&#45;&gt;layer52_moe_expert6</title>
<path fill="none" stroke="black" d="M2660.75,-6708.33C2660.75,-6708.33 2660.75,-6677.55 2660.75,-6677.55"/>
<polygon fill="black" stroke="black" points="2664.25,-6677.55 2660.75,-6667.55 2657.25,-6677.55 2664.25,-6677.55"/>
</g>
<!-- layer52_moe_expert7 -->
<g id="node2573" class="node">
<title>layer52_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3046,-6667.25 2718,-6667.25 2718,-6615.25 3046,-6615.25 3046,-6667.25"/>
<text text-anchor="middle" x="2882" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 7 L52</text>
<text text-anchor="middle" x="2882" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2882" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2882" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert7 -->
<g id="node2599" class="node">
<title>layer52_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2919" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2919" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2919" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2919" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer52_moe_expert7&#45;&gt;layer52_moe_comm_from_expert7 -->
<g id="edge3336" class="edge">
<title>layer52_moe_expert7&#45;&gt;layer52_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2919,-6614.93C2919,-6614.93 2919,-6589.39 2919,-6589.39"/>
<polygon fill="black" stroke="black" points="2922.5,-6589.38 2919,-6579.39 2915.5,-6589.39 2922.5,-6589.38"/>
</g>
<!-- layer52_moe_comm_to_expert7&#45;&gt;layer52_moe_expert7 -->
<g id="edge3305" class="edge">
<title>layer52_moe_comm_to_expert7&#45;&gt;layer52_moe_expert7</title>
<path fill="none" stroke="black" d="M2919,-6703.2C2919,-6703.2 2919,-6677.55 2919,-6677.55"/>
<polygon fill="black" stroke="black" points="2922.5,-6677.55 2919,-6667.55 2915.5,-6677.55 2922.5,-6677.55"/>
</g>
<!-- layer52_moe_expert8 -->
<g id="node2575" class="node">
<title>layer52_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3392,-6667.25 3064,-6667.25 3064,-6615.25 3392,-6615.25 3392,-6667.25"/>
<text text-anchor="middle" x="3228" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 8 L52</text>
<text text-anchor="middle" x="3228" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3228" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3228" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert8 -->
<g id="node2600" class="node">
<title>layer52_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3191" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3191" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3191" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3191" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer52_moe_expert8&#45;&gt;layer52_moe_comm_from_expert8 -->
<g id="edge3338" class="edge">
<title>layer52_moe_expert8&#45;&gt;layer52_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3191,-6614.93C3191,-6614.93 3191,-6589.39 3191,-6589.39"/>
<polygon fill="black" stroke="black" points="3194.5,-6589.38 3191,-6579.39 3187.5,-6589.39 3194.5,-6589.38"/>
</g>
<!-- layer52_moe_comm_to_expert8&#45;&gt;layer52_moe_expert8 -->
<g id="edge3307" class="edge">
<title>layer52_moe_comm_to_expert8&#45;&gt;layer52_moe_expert8</title>
<path fill="none" stroke="black" d="M3191,-6703.2C3191,-6703.2 3191,-6677.55 3191,-6677.55"/>
<polygon fill="black" stroke="black" points="3194.5,-6677.55 3191,-6667.55 3187.5,-6677.55 3194.5,-6677.55"/>
</g>
<!-- layer52_moe_expert9 -->
<g id="node2577" class="node">
<title>layer52_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3738,-6667.25 3410,-6667.25 3410,-6615.25 3738,-6615.25 3738,-6667.25"/>
<text text-anchor="middle" x="3574" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 9 L52</text>
<text text-anchor="middle" x="3574" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3574" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3574" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert9 -->
<g id="node2601" class="node">
<title>layer52_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3500" cy="-6550.25" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3500" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3500" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3500" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer52_moe_expert9&#45;&gt;layer52_moe_comm_from_expert9 -->
<g id="edge3340" class="edge">
<title>layer52_moe_expert9&#45;&gt;layer52_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3500.25,-6614.93C3500.25,-6614.93 3500.25,-6589.39 3500.25,-6589.39"/>
<polygon fill="black" stroke="black" points="3503.75,-6589.38 3500.25,-6579.39 3496.75,-6589.39 3503.75,-6589.38"/>
</g>
<!-- layer52_moe_comm_to_expert9&#45;&gt;layer52_moe_expert9 -->
<g id="edge3309" class="edge">
<title>layer52_moe_comm_to_expert9&#45;&gt;layer52_moe_expert9</title>
<path fill="none" stroke="black" d="M3500.25,-6703.2C3500.25,-6703.2 3500.25,-6677.55 3500.25,-6677.55"/>
<polygon fill="black" stroke="black" points="3503.75,-6677.55 3500.25,-6667.55 3496.75,-6677.55 3503.75,-6677.55"/>
</g>
<!-- layer52_moe_expert10 -->
<g id="node2579" class="node">
<title>layer52_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4094,-6667.25 3756,-6667.25 3756,-6615.25 4094,-6615.25 4094,-6667.25"/>
<text text-anchor="middle" x="3925" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 10 L52</text>
<text text-anchor="middle" x="3925" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3925" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3925" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert10 -->
<g id="node2602" class="node">
<title>layer52_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3832" cy="-6550.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3832" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3832" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3832" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer52_moe_expert10&#45;&gt;layer52_moe_comm_from_expert10 -->
<g id="edge3342" class="edge">
<title>layer52_moe_expert10&#45;&gt;layer52_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3841.38,-6614.93C3841.38,-6614.93 3841.38,-6589.39 3841.38,-6589.39"/>
<polygon fill="black" stroke="black" points="3844.88,-6589.38 3841.38,-6579.39 3837.88,-6589.39 3844.88,-6589.38"/>
</g>
<!-- layer52_moe_comm_to_expert10&#45;&gt;layer52_moe_expert10 -->
<g id="edge3311" class="edge">
<title>layer52_moe_comm_to_expert10&#45;&gt;layer52_moe_expert10</title>
<path fill="none" stroke="black" d="M3841.02,-6703.2C3841.02,-6703.2 3841.02,-6677.55 3841.02,-6677.55"/>
<polygon fill="black" stroke="black" points="3844.52,-6677.55 3841.02,-6667.55 3837.52,-6677.55 3844.52,-6677.55"/>
</g>
<!-- layer52_moe_expert11 -->
<g id="node2581" class="node">
<title>layer52_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4450,-6667.25 4112,-6667.25 4112,-6615.25 4450,-6615.25 4450,-6667.25"/>
<text text-anchor="middle" x="4281" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 11 L52</text>
<text text-anchor="middle" x="4281" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4281" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4281" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert11 -->
<g id="node2603" class="node">
<title>layer52_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4179" cy="-6550.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4179" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4179" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4179" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer52_moe_expert11&#45;&gt;layer52_moe_comm_from_expert11 -->
<g id="edge3344" class="edge">
<title>layer52_moe_expert11&#45;&gt;layer52_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4192.88,-6614.93C4192.88,-6614.93 4192.88,-6589.06 4192.88,-6589.06"/>
<polygon fill="black" stroke="black" points="4196.38,-6589.06 4192.88,-6579.06 4189.38,-6589.06 4196.38,-6589.06"/>
</g>
<!-- layer52_moe_comm_to_expert11&#45;&gt;layer52_moe_expert11 -->
<g id="edge3313" class="edge">
<title>layer52_moe_comm_to_expert11&#45;&gt;layer52_moe_expert11</title>
<path fill="none" stroke="black" d="M4192.02,-6703.45C4192.02,-6703.45 4192.02,-6677.38 4192.02,-6677.38"/>
<polygon fill="black" stroke="black" points="4195.52,-6677.38 4192.02,-6667.38 4188.52,-6677.38 4195.52,-6677.38"/>
</g>
<!-- layer52_moe_expert12 -->
<g id="node2583" class="node">
<title>layer52_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4806,-6667.25 4468,-6667.25 4468,-6615.25 4806,-6615.25 4806,-6667.25"/>
<text text-anchor="middle" x="4637" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 12 L52</text>
<text text-anchor="middle" x="4637" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4637" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4637" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert12 -->
<g id="node2604" class="node">
<title>layer52_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4530" cy="-6550.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4530" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4530" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4530" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer52_moe_expert12&#45;&gt;layer52_moe_comm_from_expert12 -->
<g id="edge3346" class="edge">
<title>layer52_moe_expert12&#45;&gt;layer52_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4546.38,-6614.93C4546.38,-6614.93 4546.38,-6589.06 4546.38,-6589.06"/>
<polygon fill="black" stroke="black" points="4549.88,-6589.06 4546.38,-6579.06 4542.88,-6589.06 4549.88,-6589.06"/>
</g>
<!-- layer52_moe_comm_to_expert12&#45;&gt;layer52_moe_expert12 -->
<g id="edge3315" class="edge">
<title>layer52_moe_comm_to_expert12&#45;&gt;layer52_moe_expert12</title>
<path fill="none" stroke="black" d="M4545.52,-6703.45C4545.52,-6703.45 4545.52,-6677.38 4545.52,-6677.38"/>
<polygon fill="black" stroke="black" points="4549.02,-6677.38 4545.52,-6667.38 4542.02,-6677.38 4549.02,-6677.38"/>
</g>
<!-- layer52_moe_expert13 -->
<g id="node2585" class="node">
<title>layer52_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5162,-6667.25 4824,-6667.25 4824,-6615.25 5162,-6615.25 5162,-6667.25"/>
<text text-anchor="middle" x="4993" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 13 L52</text>
<text text-anchor="middle" x="4993" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4993" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4993" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert13 -->
<g id="node2605" class="node">
<title>layer52_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4884" cy="-6550.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4884" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4884" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4884" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer52_moe_expert13&#45;&gt;layer52_moe_comm_from_expert13 -->
<g id="edge3348" class="edge">
<title>layer52_moe_expert13&#45;&gt;layer52_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4901.38,-6614.93C4901.38,-6614.93 4901.38,-6589.06 4901.38,-6589.06"/>
<polygon fill="black" stroke="black" points="4904.88,-6589.06 4901.38,-6579.06 4897.88,-6589.06 4904.88,-6589.06"/>
</g>
<!-- layer52_moe_comm_to_expert13&#45;&gt;layer52_moe_expert13 -->
<g id="edge3317" class="edge">
<title>layer52_moe_comm_to_expert13&#45;&gt;layer52_moe_expert13</title>
<path fill="none" stroke="black" d="M4900.02,-6703.45C4900.02,-6703.45 4900.02,-6677.38 4900.02,-6677.38"/>
<polygon fill="black" stroke="black" points="4903.52,-6677.38 4900.02,-6667.38 4896.52,-6677.38 4903.52,-6677.38"/>
</g>
<!-- layer52_moe_expert14 -->
<g id="node2587" class="node">
<title>layer52_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5518,-6667.25 5180,-6667.25 5180,-6615.25 5518,-6615.25 5518,-6667.25"/>
<text text-anchor="middle" x="5349" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 14 L52</text>
<text text-anchor="middle" x="5349" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5349" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5349" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert14 -->
<g id="node2606" class="node">
<title>layer52_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5239" cy="-6550.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5239" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5239" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5239" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer52_moe_expert14&#45;&gt;layer52_moe_comm_from_expert14 -->
<g id="edge3350" class="edge">
<title>layer52_moe_expert14&#45;&gt;layer52_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5256.88,-6614.93C5256.88,-6614.93 5256.88,-6588.74 5256.88,-6588.74"/>
<polygon fill="black" stroke="black" points="5260.38,-6588.74 5256.88,-6578.74 5253.38,-6588.74 5260.38,-6588.74"/>
</g>
<!-- layer52_moe_comm_to_expert14&#45;&gt;layer52_moe_expert14 -->
<g id="edge3319" class="edge">
<title>layer52_moe_comm_to_expert14&#45;&gt;layer52_moe_expert14</title>
<path fill="none" stroke="black" d="M5255.52,-6703.45C5255.52,-6703.45 5255.52,-6677.38 5255.52,-6677.38"/>
<polygon fill="black" stroke="black" points="5259.02,-6677.38 5255.52,-6667.38 5252.02,-6677.38 5259.02,-6677.38"/>
</g>
<!-- layer52_moe_expert15 -->
<g id="node2589" class="node">
<title>layer52_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5874,-6667.25 5536,-6667.25 5536,-6615.25 5874,-6615.25 5874,-6667.25"/>
<text text-anchor="middle" x="5705" y="-6655.25" font-family="Arial" font-size="10.00">EXPERT 15 L52</text>
<text text-anchor="middle" x="5705" y="-6644.25" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5705" y="-6633.25" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5705" y="-6622.25" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_comm_from_expert15 -->
<g id="node2607" class="node">
<title>layer52_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5594" cy="-6550.25" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5594" y="-6558.75" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5594" y="-6547.75" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5594" y="-6536.75" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer52_moe_expert15&#45;&gt;layer52_moe_comm_from_expert15 -->
<g id="edge3352" class="edge">
<title>layer52_moe_expert15&#45;&gt;layer52_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5612.38,-6614.93C5612.38,-6614.93 5612.38,-6588.74 5612.38,-6588.74"/>
<polygon fill="black" stroke="black" points="5615.88,-6588.74 5612.38,-6578.74 5608.88,-6588.74 5615.88,-6588.74"/>
</g>
<!-- layer52_moe_comm_to_expert15&#45;&gt;layer52_moe_expert15 -->
<g id="edge3321" class="edge">
<title>layer52_moe_comm_to_expert15&#45;&gt;layer52_moe_expert15</title>
<path fill="none" stroke="black" d="M5611.02,-6703.45C5611.02,-6703.45 5611.02,-6677.38 5611.02,-6677.38"/>
<polygon fill="black" stroke="black" points="5614.52,-6677.38 5611.02,-6667.38 5607.52,-6677.38 5614.52,-6677.38"/>
</g>
<!-- layer52_moe_aggregate -->
<g id="node2591" class="node">
<title>layer52_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3280.1,-6485.26 2863.16,-6485.26 2755.9,-6381.26 3172.84,-6381.26 3280.1,-6485.26"/>
<text text-anchor="middle" x="3018" y="-6447.26" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L52</text>
<text text-anchor="middle" x="3018" y="-6436.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3018" y="-6425.26" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="3018" y="-6414.26" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_mha -->
<g id="node2608" class="node">
<title>layer53_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3148,-6345.26 2888,-6345.26 2888,-6293.26 3148,-6293.26 3148,-6345.26"/>
<text text-anchor="middle" x="3018" y="-6333.26" font-family="Arial" font-size="10.00">MHA L53</text>
<text text-anchor="middle" x="3018" y="-6322.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3018" y="-6311.26" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3018" y="-6300.26" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer52_moe_aggregate&#45;&gt;layer53_moe_mha -->
<g id="edge3421" class="edge">
<title>layer52_moe_aggregate&#45;&gt;layer53_moe_mha</title>
<path fill="none" stroke="black" d="M3018,-6380.93C3018,-6380.93 3018,-6355.49 3018,-6355.49"/>
<polygon fill="black" stroke="black" points="3021.5,-6355.49 3018,-6345.49 3014.5,-6355.49 3021.5,-6355.49"/>
</g>
<!-- layer52_moe_comm_from_expert0&#45;&gt;layer52_moe_aggregate -->
<g id="edge3323" class="edge">
<title>layer52_moe_comm_from_expert0&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M754,-6521.24C754,-6476.56 754,-6396 754,-6396 754,-6396 2760.86,-6396 2760.86,-6396"/>
<polygon fill="black" stroke="black" points="2760.86,-6399.5 2770.86,-6396 2760.86,-6392.5 2760.86,-6399.5"/>
</g>
<!-- layer52_moe_comm_from_expert1&#45;&gt;layer52_moe_aggregate -->
<g id="edge3325" class="edge">
<title>layer52_moe_comm_from_expert1&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M1141,-6524.2C1141,-6483.64 1141,-6410 1141,-6410 1141,-6410 2775.49,-6410 2775.49,-6410"/>
<polygon fill="black" stroke="black" points="2775.49,-6413.5 2785.49,-6410 2775.49,-6406.5 2775.49,-6413.5"/>
</g>
<!-- layer52_moe_comm_from_expert2&#45;&gt;layer52_moe_aggregate -->
<g id="edge3327" class="edge">
<title>layer52_moe_comm_from_expert2&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M1446,-6521.2C1446,-6484.2 1446,-6425 1446,-6425 1446,-6425 2790.66,-6425 2790.66,-6425"/>
<polygon fill="black" stroke="black" points="2790.66,-6428.5 2800.66,-6425 2790.66,-6421.5 2790.66,-6428.5"/>
</g>
<!-- layer52_moe_comm_from_expert3&#45;&gt;layer52_moe_aggregate -->
<g id="edge3329" class="edge">
<title>layer52_moe_comm_from_expert3&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M1768.51,-6526.06C1768.51,-6493.6 1768.51,-6440 1768.51,-6440 1768.51,-6440 2806.21,-6440 2806.21,-6440"/>
<polygon fill="black" stroke="black" points="2806.21,-6443.5 2816.21,-6440 2806.21,-6436.5 2806.21,-6443.5"/>
</g>
<!-- layer52_moe_comm_from_expert4&#45;&gt;layer52_moe_aggregate -->
<g id="edge3331" class="edge">
<title>layer52_moe_comm_from_expert4&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M1960,-6521.16C1960,-6493.14 1960,-6455 1960,-6455 1960,-6455 2821.89,-6455 2821.89,-6455"/>
<polygon fill="black" stroke="black" points="2821.89,-6458.5 2831.89,-6455 2821.89,-6451.5 2821.89,-6458.5"/>
</g>
<!-- layer52_moe_comm_from_expert5&#45;&gt;layer52_moe_aggregate -->
<g id="edge3333" class="edge">
<title>layer52_moe_comm_from_expert5&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M2380.5,-6536.28C2380.5,-6513.28 2380.5,-6470 2380.5,-6470 2380.5,-6470 2837.16,-6470 2837.16,-6470"/>
<polygon fill="black" stroke="black" points="2837.16,-6473.5 2847.16,-6470 2837.16,-6466.5 2837.16,-6473.5"/>
</g>
<!-- layer52_moe_comm_from_expert6&#45;&gt;layer52_moe_aggregate -->
<g id="edge3335" class="edge">
<title>layer52_moe_comm_from_expert6&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M2737.65,-6550C2766.98,-6550 2792.1,-6550 2792.1,-6550 2792.1,-6550 2792.1,-6443.35 2792.1,-6443.35"/>
<polygon fill="black" stroke="black" points="2795.6,-6443.35 2792.1,-6433.35 2788.6,-6443.35 2795.6,-6443.35"/>
</g>
<!-- layer52_moe_comm_from_expert7&#45;&gt;layer52_moe_aggregate -->
<g id="edge3337" class="edge">
<title>layer52_moe_comm_from_expert7&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M2919,-6521.03C2919,-6521.03 2919,-6495.32 2919,-6495.32"/>
<polygon fill="black" stroke="black" points="2922.5,-6495.32 2919,-6485.32 2915.5,-6495.32 2922.5,-6495.32"/>
</g>
<!-- layer52_moe_comm_from_expert8&#45;&gt;layer52_moe_aggregate -->
<g id="edge3339" class="edge">
<title>layer52_moe_comm_from_expert8&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M3190.39,-6521.03C3190.39,-6521.03 3190.39,-6495.32 3190.39,-6495.32"/>
<polygon fill="black" stroke="black" points="3193.89,-6495.32 3190.39,-6485.32 3186.89,-6495.32 3193.89,-6495.32"/>
</g>
<!-- layer52_moe_comm_from_expert9&#45;&gt;layer52_moe_aggregate -->
<g id="edge3341" class="edge">
<title>layer52_moe_comm_from_expert9&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M3481.5,-6521.56C3481.5,-6499.23 3481.5,-6472 3481.5,-6472 3481.5,-6472 3276.71,-6472 3276.71,-6472"/>
<polygon fill="black" stroke="black" points="3276.71,-6468.5 3266.71,-6472 3276.71,-6475.5 3276.71,-6468.5"/>
</g>
<!-- layer52_moe_comm_from_expert10&#45;&gt;layer52_moe_aggregate -->
<g id="edge3343" class="edge">
<title>layer52_moe_comm_from_expert10&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M3813.15,-6521.38C3813.15,-6494.65 3813.15,-6459 3813.15,-6459 3813.15,-6459 3263.07,-6459 3263.07,-6459"/>
<polygon fill="black" stroke="black" points="3263.07,-6455.5 3253.07,-6459 3263.07,-6462.5 3263.07,-6455.5"/>
</g>
<!-- layer52_moe_comm_from_expert11&#45;&gt;layer52_moe_aggregate -->
<g id="edge3345" class="edge">
<title>layer52_moe_comm_from_expert11&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M4159.65,-6521.77C4159.65,-6490.9 4159.65,-6446 4159.65,-6446 4159.65,-6446 3249.81,-6446 3249.81,-6446"/>
<polygon fill="black" stroke="black" points="3249.81,-6442.5 3239.81,-6446 3249.81,-6449.5 3249.81,-6442.5"/>
</g>
<!-- layer52_moe_comm_from_expert12&#45;&gt;layer52_moe_aggregate -->
<g id="edge3347" class="edge">
<title>layer52_moe_comm_from_expert12&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M4510.65,-6521.87C4510.65,-6487.17 4510.65,-6433 4510.65,-6433 4510.65,-6433 3236.33,-6433 3236.33,-6433"/>
<polygon fill="black" stroke="black" points="3236.33,-6429.5 3226.33,-6433 3236.33,-6436.5 3236.33,-6429.5"/>
</g>
<!-- layer52_moe_comm_from_expert13&#45;&gt;layer52_moe_aggregate -->
<g id="edge3349" class="edge">
<title>layer52_moe_comm_from_expert13&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M4864.15,-6521.67C4864.15,-6483.33 4864.15,-6420 4864.15,-6420 4864.15,-6420 3222.95,-6420 3222.95,-6420"/>
<polygon fill="black" stroke="black" points="3222.95,-6416.5 3212.95,-6420 3222.95,-6423.5 3222.95,-6416.5"/>
</g>
<!-- layer52_moe_comm_from_expert14&#45;&gt;layer52_moe_aggregate -->
<g id="edge3351" class="edge">
<title>layer52_moe_comm_from_expert14&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M5219.15,-6521.61C5219.15,-6479.8 5219.15,-6407 5219.15,-6407 5219.15,-6407 3209.53,-6407 3209.53,-6407"/>
<polygon fill="black" stroke="black" points="3209.53,-6403.5 3199.53,-6407 3209.53,-6410.5 3209.53,-6403.5"/>
</g>
<!-- layer52_moe_comm_from_expert15&#45;&gt;layer52_moe_aggregate -->
<g id="edge3353" class="edge">
<title>layer52_moe_comm_from_expert15&#45;&gt;layer52_moe_aggregate</title>
<path fill="none" stroke="black" d="M5574.15,-6521.6C5574.15,-6476.49 5574.15,-6394 5574.15,-6394 5574.15,-6394 3196.21,-6394 3196.21,-6394"/>
<polygon fill="black" stroke="black" points="3196.21,-6390.5 3186.21,-6394 3196.21,-6397.5 3196.21,-6390.5"/>
</g>
<!-- layer53_moe_gate -->
<g id="node2609" class="node">
<title>layer53_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3276.3,-6257.26 2865.4,-6257.26 2759.7,-6153.26 3170.6,-6153.26 3276.3,-6257.26"/>
<text text-anchor="middle" x="3018" y="-6219.26" font-family="Arial" font-size="10.00">GATE L53</text>
<text text-anchor="middle" x="3018" y="-6208.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3018" y="-6197.26" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-6186.26" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer53_moe_mha&#45;&gt;layer53_moe_gate -->
<g id="edge3422" class="edge">
<title>layer53_moe_mha&#45;&gt;layer53_moe_gate</title>
<path fill="none" stroke="black" d="M3018,-6293.11C3018,-6293.11 3018,-6267.36 3018,-6267.36"/>
<polygon fill="black" stroke="black" points="3021.5,-6267.36 3018,-6257.36 3014.5,-6267.36 3021.5,-6267.36"/>
</g>
<!-- layer53_moe_split -->
<g id="node2610" class="node">
<title>layer53_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3272.01,-6117.26 2867.94,-6117.26 2763.99,-6013.26 3168.06,-6013.26 3272.01,-6117.26"/>
<text text-anchor="middle" x="3018" y="-6079.26" font-family="Arial" font-size="10.00">SPLIT TOKENS L53</text>
<text text-anchor="middle" x="3018" y="-6068.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3018" y="-6057.26" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="3018" y="-6046.26" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer53_moe_gate&#45;&gt;layer53_moe_split -->
<g id="edge3423" class="edge">
<title>layer53_moe_gate&#45;&gt;layer53_moe_split</title>
<path fill="none" stroke="black" d="M3018,-6153.13C3018,-6153.13 3018,-6127.44 3018,-6127.44"/>
<polygon fill="black" stroke="black" points="3021.5,-6127.44 3018,-6117.44 3014.5,-6127.44 3021.5,-6127.44"/>
</g>
<!-- layer53_moe_comm_to_expert0 -->
<g id="node2612" class="node">
<title>layer53_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="469" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="469" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="469" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="469" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert0 -->
<g id="edge3357" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2852.23,-6102C2286.82,-6102 469,-6102 469,-6102 469,-6102 469,-5987.55 469,-5987.55"/>
<polygon fill="black" stroke="black" points="472.5,-5987.55 469,-5977.55 465.5,-5987.55 472.5,-5987.55"/>
</g>
<!-- layer53_moe_comm_to_expert1 -->
<g id="node2614" class="node">
<title>layer53_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1182" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1182" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1182" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1182" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert1 -->
<g id="edge3359" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2837.28,-6087C2383.39,-6087 1231.51,-6087 1231.51,-6087 1231.51,-6087 1231.51,-5982.75 1231.51,-5982.75"/>
<polygon fill="black" stroke="black" points="1235.01,-5982.75 1231.51,-5972.75 1228.01,-5982.75 1235.01,-5982.75"/>
</g>
<!-- layer53_moe_comm_to_expert2 -->
<g id="node2616" class="node">
<title>layer53_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1638" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1638" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1638" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1638" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert2 -->
<g id="edge3361" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2822.44,-6072C2450.51,-6072 1678,-6072 1678,-6072 1678,-6072 1678,-5984.51 1678,-5984.51"/>
<polygon fill="black" stroke="black" points="1681.5,-5984.51 1678,-5974.51 1674.5,-5984.51 1681.5,-5984.51"/>
</g>
<!-- layer53_moe_comm_to_expert3 -->
<g id="node2618" class="node">
<title>layer53_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1966" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1966" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1966" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1966" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert3 -->
<g id="edge3363" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2807.47,-6057C2522.86,-6057 2050.51,-6057 2050.51,-6057 2050.51,-6057 2050.51,-5968.7 2050.51,-5968.7"/>
<polygon fill="black" stroke="black" points="2054.01,-5968.7 2050.51,-5958.7 2047.01,-5968.7 2054.01,-5968.7"/>
</g>
<!-- layer53_moe_comm_to_expert4 -->
<g id="node2620" class="node">
<title>layer53_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2229" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2229" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2229" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2229" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert4 -->
<g id="edge3365" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2792.59,-6042C2570.74,-6042 2265,-6042 2265,-6042 2265,-6042 2265,-5984.88 2265,-5984.88"/>
<polygon fill="black" stroke="black" points="2268.5,-5984.88 2265,-5974.88 2261.5,-5984.88 2268.5,-5984.88"/>
</g>
<!-- layer53_moe_comm_to_expert5 -->
<g id="node2622" class="node">
<title>layer53_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2460" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2460" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2460" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2460" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert5 -->
<g id="edge3367" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2778.48,-6028C2631.4,-6028 2471.01,-6028 2471.01,-6028 2471.01,-6028 2471.01,-5987.06 2471.01,-5987.06"/>
<polygon fill="black" stroke="black" points="2474.51,-5987.06 2471.01,-5977.06 2467.51,-5987.06 2474.51,-5987.06"/>
</g>
<!-- layer53_moe_comm_to_expert6 -->
<g id="node2624" class="node">
<title>layer53_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2675" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2675" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2675" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2675" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert6 -->
<g id="edge3369" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2778.5,-6065.18C2778.5,-6061.63 2778.5,-5948 2778.5,-5948 2778.5,-5948 2775.81,-5948 2775.81,-5948"/>
<polygon fill="black" stroke="black" points="2775.81,-5944.5 2765.81,-5948 2775.81,-5951.5 2775.81,-5944.5"/>
</g>
<!-- layer53_moe_comm_to_expert7 -->
<g id="node2626" class="node">
<title>layer53_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2882" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2882" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2882" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2882" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert7 -->
<g id="edge3371" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2882,-6012.93C2882,-6012.93 2882,-5987.48 2882,-5987.48"/>
<polygon fill="black" stroke="black" points="2885.5,-5987.48 2882,-5977.48 2878.5,-5987.48 2885.5,-5987.48"/>
</g>
<!-- layer53_moe_comm_to_expert8 -->
<g id="node2628" class="node">
<title>layer53_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3154" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3154" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3154" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3154" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert8 -->
<g id="edge3373" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3154,-6012.93C3154,-6012.93 3154,-5987.48 3154,-5987.48"/>
<polygon fill="black" stroke="black" points="3157.5,-5987.48 3154,-5977.48 3150.5,-5987.48 3157.5,-5987.48"/>
</g>
<!-- layer53_moe_comm_to_expert9 -->
<g id="node2630" class="node">
<title>layer53_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3463" cy="-5948.27" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3463" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3463" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3463" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert9 -->
<g id="edge3375" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3258.26,-6065.18C3258.26,-6061.63 3258.26,-5948 3258.26,-5948 3258.26,-5948 3362.3,-5948 3362.3,-5948"/>
<polygon fill="black" stroke="black" points="3362.3,-5951.5 3372.3,-5948 3362.3,-5944.5 3362.3,-5951.5"/>
</g>
<!-- layer53_moe_comm_to_expert10 -->
<g id="node2632" class="node">
<title>layer53_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3795" cy="-5948.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3795" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3795" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3795" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert10 -->
<g id="edge3377" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3182.82,-6028C3390.07,-6028 3719.1,-6028 3719.1,-6028 3719.1,-6028 3719.1,-5975.57 3719.1,-5975.57"/>
<polygon fill="black" stroke="black" points="3722.6,-5975.57 3719.1,-5965.57 3715.6,-5975.57 3722.6,-5975.57"/>
</g>
<!-- layer53_moe_comm_to_expert11 -->
<g id="node2634" class="node">
<title>layer53_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4141" cy="-5948.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4141" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4141" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4141" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert11 -->
<g id="edge3379" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3196.9,-6042C3496.11,-6042 4065.6,-6042 4065.6,-6042 4065.6,-6042 4065.6,-5975.9 4065.6,-5975.9"/>
<polygon fill="black" stroke="black" points="4069.1,-5975.9 4065.6,-5965.9 4062.1,-5975.9 4069.1,-5975.9"/>
</g>
<!-- layer53_moe_comm_to_expert12 -->
<g id="node2636" class="node">
<title>layer53_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4492" cy="-5948.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4492" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4492" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4492" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert12 -->
<g id="edge3381" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3212.1,-6057C3596.24,-6057 4416.6,-6057 4416.6,-6057 4416.6,-6057 4416.6,-5975.74 4416.6,-5975.74"/>
<polygon fill="black" stroke="black" points="4420.1,-5975.74 4416.6,-5965.74 4413.1,-5975.74 4420.1,-5975.74"/>
</g>
<!-- layer53_moe_comm_to_expert13 -->
<g id="node2638" class="node">
<title>layer53_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4845" cy="-5948.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4845" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4845" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4845" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert13 -->
<g id="edge3383" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3227.17,-6072C3692,-6072 4770.1,-6072 4770.1,-6072 4770.1,-6072 4770.1,-5976 4770.1,-5976"/>
<polygon fill="black" stroke="black" points="4773.6,-5976 4770.1,-5966 4766.6,-5976 4773.6,-5976"/>
</g>
<!-- layer53_moe_comm_to_expert14 -->
<g id="node2640" class="node">
<title>layer53_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5200" cy="-5948.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5200" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5200" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5200" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert14 -->
<g id="edge3385" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3242,-6087C3784.61,-6087 5125.1,-6087 5125.1,-6087 5125.1,-6087 5125.1,-5975.84 5125.1,-5975.84"/>
<polygon fill="black" stroke="black" points="5128.6,-5975.84 5125.1,-5965.84 5121.6,-5975.84 5128.6,-5975.84"/>
</g>
<!-- layer53_moe_comm_to_expert15 -->
<g id="node2642" class="node">
<title>layer53_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5555" cy="-5948.27" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5555" y="-5956.77" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5555" y="-5945.77" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5555" y="-5934.77" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert15 -->
<g id="edge3387" class="edge">
<title>layer53_moe_split&#45;&gt;layer53_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3256.87,-6102C3875.18,-6102 5480.1,-6102 5480.1,-6102 5480.1,-6102 5480.1,-5975.91 5480.1,-5975.91"/>
<polygon fill="black" stroke="black" points="5483.6,-5975.91 5480.1,-5965.91 5476.6,-5975.91 5483.6,-5975.91"/>
</g>
<!-- layer53_moe_expert0 -->
<g id="node2611" class="node">
<title>layer53_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="587,-5883.28 259,-5883.28 259,-5831.28 587,-5831.28 587,-5883.28"/>
<text text-anchor="middle" x="423" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 0 L53</text>
<text text-anchor="middle" x="423" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="423" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="423" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert0 -->
<g id="node2644" class="node">
<title>layer53_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="496" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="496" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="496" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="496" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer53_moe_expert0&#45;&gt;layer53_moe_comm_from_expert0 -->
<g id="edge3389" class="edge">
<title>layer53_moe_expert0&#45;&gt;layer53_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M496,-5830.96C496,-5830.96 496,-5805.42 496,-5805.42"/>
<polygon fill="black" stroke="black" points="499.5,-5805.42 496,-5795.42 492.5,-5805.42 499.5,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert0&#45;&gt;layer53_moe_expert0 -->
<g id="edge3358" class="edge">
<title>layer53_moe_comm_to_expert0&#45;&gt;layer53_moe_expert0</title>
<path fill="none" stroke="black" d="M469,-5919.23C469,-5919.23 469,-5893.58 469,-5893.58"/>
<polygon fill="black" stroke="black" points="472.5,-5893.58 469,-5883.58 465.5,-5893.58 472.5,-5893.58"/>
</g>
<!-- layer53_moe_expert1 -->
<g id="node2613" class="node">
<title>layer53_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="933,-5883.28 605,-5883.28 605,-5831.28 933,-5831.28 933,-5883.28"/>
<text text-anchor="middle" x="769" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 1 L53</text>
<text text-anchor="middle" x="769" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="769" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="769" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert1 -->
<g id="node2645" class="node">
<title>layer53_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="854" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="854" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="854" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="854" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer53_moe_expert1&#45;&gt;layer53_moe_comm_from_expert1 -->
<g id="edge3391" class="edge">
<title>layer53_moe_expert1&#45;&gt;layer53_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M848.25,-5830.96C848.25,-5830.96 848.25,-5805.42 848.25,-5805.42"/>
<polygon fill="black" stroke="black" points="851.75,-5805.42 848.25,-5795.42 844.75,-5805.42 851.75,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert1&#45;&gt;layer53_moe_expert1 -->
<g id="edge3360" class="edge">
<title>layer53_moe_comm_to_expert1&#45;&gt;layer53_moe_expert1</title>
<path fill="none" stroke="black" d="M1091.22,-5948C1005.1,-5948 888.75,-5948 888.75,-5948 888.75,-5948 888.75,-5893.52 888.75,-5893.52"/>
<polygon fill="black" stroke="black" points="892.25,-5893.52 888.75,-5883.52 885.25,-5893.52 892.25,-5893.52"/>
</g>
<!-- layer53_moe_expert2 -->
<g id="node2615" class="node">
<title>layer53_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1279,-5883.28 951,-5883.28 951,-5831.28 1279,-5831.28 1279,-5883.28"/>
<text text-anchor="middle" x="1115" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 2 L53</text>
<text text-anchor="middle" x="1115" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1115" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1115" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert2 -->
<g id="node2646" class="node">
<title>layer53_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1175" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1175" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1175" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1175" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer53_moe_expert2&#45;&gt;layer53_moe_comm_from_expert2 -->
<g id="edge3393" class="edge">
<title>layer53_moe_expert2&#45;&gt;layer53_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1175,-5830.96C1175,-5830.96 1175,-5805.42 1175,-5805.42"/>
<polygon fill="black" stroke="black" points="1178.5,-5805.42 1175,-5795.42 1171.5,-5805.42 1178.5,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert2&#45;&gt;layer53_moe_expert2 -->
<g id="edge3362" class="edge">
<title>layer53_moe_comm_to_expert2&#45;&gt;layer53_moe_expert2</title>
<path fill="none" stroke="black" d="M1547.41,-5948C1443.71,-5948 1288,-5948 1288,-5948 1288,-5948 1288,-5857 1288,-5857 1288,-5857 1287.12,-5857 1287.12,-5857"/>
<polygon fill="black" stroke="black" points="1289.18,-5853.5 1279.18,-5857 1289.18,-5860.5 1289.18,-5853.5"/>
</g>
<!-- layer53_moe_expert3 -->
<g id="node2617" class="node">
<title>layer53_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1625,-5883.28 1297,-5883.28 1297,-5831.28 1625,-5831.28 1625,-5883.28"/>
<text text-anchor="middle" x="1461" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 3 L53</text>
<text text-anchor="middle" x="1461" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1461" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1461" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert3 -->
<g id="node2647" class="node">
<title>layer53_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1741" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1741" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1741" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1741" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer53_moe_expert3&#45;&gt;layer53_moe_comm_from_expert3 -->
<g id="edge3395" class="edge">
<title>layer53_moe_expert3&#45;&gt;layer53_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1567.75,-5830.88C1567.75,-5803.92 1567.75,-5766 1567.75,-5766 1567.75,-5766 1640.31,-5766 1640.31,-5766"/>
<polygon fill="black" stroke="black" points="1640.31,-5769.5 1650.31,-5766 1640.31,-5762.5 1640.31,-5769.5"/>
</g>
<!-- layer53_moe_comm_to_expert3&#45;&gt;layer53_moe_expert3 -->
<g id="edge3364" class="edge">
<title>layer53_moe_comm_to_expert3&#45;&gt;layer53_moe_expert3</title>
<path fill="none" stroke="black" d="M1907.33,-5926.19C1907.33,-5916.37 1907.33,-5907 1907.33,-5907 1907.33,-5907 1586.25,-5907 1586.25,-5907 1586.25,-5907 1586.25,-5893.31 1586.25,-5893.31"/>
<polygon fill="black" stroke="black" points="1589.75,-5893.31 1586.25,-5883.31 1582.75,-5893.31 1589.75,-5893.31"/>
</g>
<!-- layer53_moe_expert4 -->
<g id="node2619" class="node">
<title>layer53_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1971,-5883.28 1643,-5883.28 1643,-5831.28 1971,-5831.28 1971,-5883.28"/>
<text text-anchor="middle" x="1807" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 4 L53</text>
<text text-anchor="middle" x="1807" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1807" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1807" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert4 -->
<g id="node2648" class="node">
<title>layer53_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2124" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2124" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2124" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2124" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer53_moe_expert4&#45;&gt;layer53_moe_comm_from_expert4 -->
<g id="edge3397" class="edge">
<title>layer53_moe_expert4&#45;&gt;layer53_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1904.75,-5830.88C1904.75,-5803.92 1904.75,-5766 1904.75,-5766 1904.75,-5766 2023.24,-5766 2023.24,-5766"/>
<polygon fill="black" stroke="black" points="2023.24,-5769.5 2033.24,-5766 2023.24,-5762.5 2023.24,-5769.5"/>
</g>
<!-- layer53_moe_comm_to_expert4&#45;&gt;layer53_moe_expert4 -->
<g id="edge3366" class="edge">
<title>layer53_moe_comm_to_expert4&#45;&gt;layer53_moe_expert4</title>
<path fill="none" stroke="black" d="M2227.75,-5919.14C2227.75,-5906.71 2227.75,-5895 2227.75,-5895 2227.75,-5895 1939.16,-5895 1939.16,-5895 1939.16,-5895 1939.16,-5893.48 1939.16,-5893.48"/>
<polygon fill="black" stroke="black" points="1942.66,-5893.48 1939.16,-5883.48 1935.66,-5893.48 1942.66,-5893.48"/>
</g>
<!-- layer53_moe_expert5 -->
<g id="node2621" class="node">
<title>layer53_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2317,-5883.28 1989,-5883.28 1989,-5831.28 2317,-5831.28 2317,-5883.28"/>
<text text-anchor="middle" x="2153" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 5 L53</text>
<text text-anchor="middle" x="2153" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2153" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2153" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert5 -->
<g id="node2649" class="node">
<title>layer53_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2415" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2415" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2415" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2415" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer53_moe_expert5&#45;&gt;layer53_moe_comm_from_expert5 -->
<g id="edge3399" class="edge">
<title>layer53_moe_expert5&#45;&gt;layer53_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2317.19,-5848C2326.1,-5848 2331.5,-5848 2331.5,-5848 2331.5,-5848 2331.5,-5787.65 2331.5,-5787.65"/>
<polygon fill="black" stroke="black" points="2335,-5787.65 2331.5,-5777.65 2328,-5787.65 2335,-5787.65"/>
</g>
<!-- layer53_moe_comm_to_expert5&#45;&gt;layer53_moe_expert5 -->
<g id="edge3368" class="edge">
<title>layer53_moe_comm_to_expert5&#45;&gt;layer53_moe_expert5</title>
<path fill="none" stroke="black" d="M2369.4,-5948C2346.36,-5948 2327.99,-5948 2327.99,-5948 2327.99,-5948 2327.99,-5865 2327.99,-5865 2327.99,-5865 2326.9,-5865 2326.9,-5865"/>
<polygon fill="black" stroke="black" points="2327.05,-5861.5 2317.05,-5865 2327.05,-5868.5 2327.05,-5861.5"/>
</g>
<!-- layer53_moe_expert6 -->
<g id="node2623" class="node">
<title>layer53_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2663,-5883.28 2335,-5883.28 2335,-5831.28 2663,-5831.28 2663,-5883.28"/>
<text text-anchor="middle" x="2499" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 6 L53</text>
<text text-anchor="middle" x="2499" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2499" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2499" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert6 -->
<g id="node2650" class="node">
<title>layer53_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2660" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2660" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2660" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2660" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer53_moe_expert6&#45;&gt;layer53_moe_comm_from_expert6 -->
<g id="edge3401" class="edge">
<title>layer53_moe_expert6&#45;&gt;layer53_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2616.25,-5830.96C2616.25,-5830.96 2616.25,-5801.92 2616.25,-5801.92"/>
<polygon fill="black" stroke="black" points="2619.75,-5801.92 2616.25,-5791.92 2612.75,-5801.92 2619.75,-5801.92"/>
</g>
<!-- layer53_moe_comm_to_expert6&#45;&gt;layer53_moe_expert6 -->
<g id="edge3370" class="edge">
<title>layer53_moe_comm_to_expert6&#45;&gt;layer53_moe_expert6</title>
<path fill="none" stroke="black" d="M2623.75,-5924.36C2623.75,-5924.36 2623.75,-5893.59 2623.75,-5893.59"/>
<polygon fill="black" stroke="black" points="2627.25,-5893.59 2623.75,-5883.59 2620.25,-5893.59 2627.25,-5893.59"/>
</g>
<!-- layer53_moe_expert7 -->
<g id="node2625" class="node">
<title>layer53_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="3009,-5883.28 2681,-5883.28 2681,-5831.28 3009,-5831.28 3009,-5883.28"/>
<text text-anchor="middle" x="2845" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 7 L53</text>
<text text-anchor="middle" x="2845" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2845" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2845" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert7 -->
<g id="node2651" class="node">
<title>layer53_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2882" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2882" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2882" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2882" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer53_moe_expert7&#45;&gt;layer53_moe_comm_from_expert7 -->
<g id="edge3403" class="edge">
<title>layer53_moe_expert7&#45;&gt;layer53_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2882,-5830.96C2882,-5830.96 2882,-5805.42 2882,-5805.42"/>
<polygon fill="black" stroke="black" points="2885.5,-5805.42 2882,-5795.42 2878.5,-5805.42 2885.5,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert7&#45;&gt;layer53_moe_expert7 -->
<g id="edge3372" class="edge">
<title>layer53_moe_comm_to_expert7&#45;&gt;layer53_moe_expert7</title>
<path fill="none" stroke="black" d="M2882,-5919.23C2882,-5919.23 2882,-5893.58 2882,-5893.58"/>
<polygon fill="black" stroke="black" points="2885.5,-5893.58 2882,-5883.58 2878.5,-5893.58 2885.5,-5893.58"/>
</g>
<!-- layer53_moe_expert8 -->
<g id="node2627" class="node">
<title>layer53_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3355,-5883.28 3027,-5883.28 3027,-5831.28 3355,-5831.28 3355,-5883.28"/>
<text text-anchor="middle" x="3191" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 8 L53</text>
<text text-anchor="middle" x="3191" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3191" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3191" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert8 -->
<g id="node2652" class="node">
<title>layer53_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3154" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3154" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3154" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3154" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer53_moe_expert8&#45;&gt;layer53_moe_comm_from_expert8 -->
<g id="edge3405" class="edge">
<title>layer53_moe_expert8&#45;&gt;layer53_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3154,-5830.96C3154,-5830.96 3154,-5805.42 3154,-5805.42"/>
<polygon fill="black" stroke="black" points="3157.5,-5805.42 3154,-5795.42 3150.5,-5805.42 3157.5,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert8&#45;&gt;layer53_moe_expert8 -->
<g id="edge3374" class="edge">
<title>layer53_moe_comm_to_expert8&#45;&gt;layer53_moe_expert8</title>
<path fill="none" stroke="black" d="M3154,-5919.23C3154,-5919.23 3154,-5893.58 3154,-5893.58"/>
<polygon fill="black" stroke="black" points="3157.5,-5893.58 3154,-5883.58 3150.5,-5893.58 3157.5,-5893.58"/>
</g>
<!-- layer53_moe_expert9 -->
<g id="node2629" class="node">
<title>layer53_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3701,-5883.28 3373,-5883.28 3373,-5831.28 3701,-5831.28 3701,-5883.28"/>
<text text-anchor="middle" x="3537" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 9 L53</text>
<text text-anchor="middle" x="3537" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3537" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3537" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert9 -->
<g id="node2653" class="node">
<title>layer53_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3463" cy="-5766.29" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3463" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3463" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3463" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer53_moe_expert9&#45;&gt;layer53_moe_comm_from_expert9 -->
<g id="edge3407" class="edge">
<title>layer53_moe_expert9&#45;&gt;layer53_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3463.25,-5830.96C3463.25,-5830.96 3463.25,-5805.42 3463.25,-5805.42"/>
<polygon fill="black" stroke="black" points="3466.75,-5805.42 3463.25,-5795.42 3459.75,-5805.42 3466.75,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert9&#45;&gt;layer53_moe_expert9 -->
<g id="edge3376" class="edge">
<title>layer53_moe_comm_to_expert9&#45;&gt;layer53_moe_expert9</title>
<path fill="none" stroke="black" d="M3463.25,-5919.23C3463.25,-5919.23 3463.25,-5893.58 3463.25,-5893.58"/>
<polygon fill="black" stroke="black" points="3466.75,-5893.58 3463.25,-5883.58 3459.75,-5893.58 3466.75,-5893.58"/>
</g>
<!-- layer53_moe_expert10 -->
<g id="node2631" class="node">
<title>layer53_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4057,-5883.28 3719,-5883.28 3719,-5831.28 4057,-5831.28 4057,-5883.28"/>
<text text-anchor="middle" x="3888" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 10 L53</text>
<text text-anchor="middle" x="3888" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3888" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3888" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert10 -->
<g id="node2654" class="node">
<title>layer53_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3795" cy="-5766.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3795" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3795" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3795" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer53_moe_expert10&#45;&gt;layer53_moe_comm_from_expert10 -->
<g id="edge3409" class="edge">
<title>layer53_moe_expert10&#45;&gt;layer53_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3804.38,-5830.96C3804.38,-5830.96 3804.38,-5805.42 3804.38,-5805.42"/>
<polygon fill="black" stroke="black" points="3807.88,-5805.42 3804.38,-5795.42 3800.88,-5805.42 3807.88,-5805.42"/>
</g>
<!-- layer53_moe_comm_to_expert10&#45;&gt;layer53_moe_expert10 -->
<g id="edge3378" class="edge">
<title>layer53_moe_comm_to_expert10&#45;&gt;layer53_moe_expert10</title>
<path fill="none" stroke="black" d="M3804.02,-5919.23C3804.02,-5919.23 3804.02,-5893.58 3804.02,-5893.58"/>
<polygon fill="black" stroke="black" points="3807.52,-5893.58 3804.02,-5883.58 3800.52,-5893.58 3807.52,-5893.58"/>
</g>
<!-- layer53_moe_expert11 -->
<g id="node2633" class="node">
<title>layer53_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4413,-5883.28 4075,-5883.28 4075,-5831.28 4413,-5831.28 4413,-5883.28"/>
<text text-anchor="middle" x="4244" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 11 L53</text>
<text text-anchor="middle" x="4244" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4244" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4244" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert11 -->
<g id="node2655" class="node">
<title>layer53_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4142" cy="-5766.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4142" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4142" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4142" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer53_moe_expert11&#45;&gt;layer53_moe_comm_from_expert11 -->
<g id="edge3411" class="edge">
<title>layer53_moe_expert11&#45;&gt;layer53_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4155.88,-5830.96C4155.88,-5830.96 4155.88,-5805.1 4155.88,-5805.1"/>
<polygon fill="black" stroke="black" points="4159.38,-5805.1 4155.88,-5795.1 4152.38,-5805.1 4159.38,-5805.1"/>
</g>
<!-- layer53_moe_comm_to_expert11&#45;&gt;layer53_moe_expert11 -->
<g id="edge3380" class="edge">
<title>layer53_moe_comm_to_expert11&#45;&gt;layer53_moe_expert11</title>
<path fill="none" stroke="black" d="M4155.02,-5919.48C4155.02,-5919.48 4155.02,-5893.42 4155.02,-5893.42"/>
<polygon fill="black" stroke="black" points="4158.52,-5893.42 4155.02,-5883.42 4151.52,-5893.42 4158.52,-5893.42"/>
</g>
<!-- layer53_moe_expert12 -->
<g id="node2635" class="node">
<title>layer53_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4769,-5883.28 4431,-5883.28 4431,-5831.28 4769,-5831.28 4769,-5883.28"/>
<text text-anchor="middle" x="4600" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 12 L53</text>
<text text-anchor="middle" x="4600" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4600" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4600" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert12 -->
<g id="node2656" class="node">
<title>layer53_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4493" cy="-5766.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4493" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4493" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4493" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer53_moe_expert12&#45;&gt;layer53_moe_comm_from_expert12 -->
<g id="edge3413" class="edge">
<title>layer53_moe_expert12&#45;&gt;layer53_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4509.38,-5830.96C4509.38,-5830.96 4509.38,-5805.1 4509.38,-5805.1"/>
<polygon fill="black" stroke="black" points="4512.88,-5805.1 4509.38,-5795.1 4505.88,-5805.1 4512.88,-5805.1"/>
</g>
<!-- layer53_moe_comm_to_expert12&#45;&gt;layer53_moe_expert12 -->
<g id="edge3382" class="edge">
<title>layer53_moe_comm_to_expert12&#45;&gt;layer53_moe_expert12</title>
<path fill="none" stroke="black" d="M4508.52,-5919.48C4508.52,-5919.48 4508.52,-5893.42 4508.52,-5893.42"/>
<polygon fill="black" stroke="black" points="4512.02,-5893.42 4508.52,-5883.42 4505.02,-5893.42 4512.02,-5893.42"/>
</g>
<!-- layer53_moe_expert13 -->
<g id="node2637" class="node">
<title>layer53_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5125,-5883.28 4787,-5883.28 4787,-5831.28 5125,-5831.28 5125,-5883.28"/>
<text text-anchor="middle" x="4956" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 13 L53</text>
<text text-anchor="middle" x="4956" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4956" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4956" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert13 -->
<g id="node2657" class="node">
<title>layer53_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4847" cy="-5766.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4847" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4847" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4847" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer53_moe_expert13&#45;&gt;layer53_moe_comm_from_expert13 -->
<g id="edge3415" class="edge">
<title>layer53_moe_expert13&#45;&gt;layer53_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4864.38,-5830.96C4864.38,-5830.96 4864.38,-5805.1 4864.38,-5805.1"/>
<polygon fill="black" stroke="black" points="4867.88,-5805.1 4864.38,-5795.1 4860.88,-5805.1 4867.88,-5805.1"/>
</g>
<!-- layer53_moe_comm_to_expert13&#45;&gt;layer53_moe_expert13 -->
<g id="edge3384" class="edge">
<title>layer53_moe_comm_to_expert13&#45;&gt;layer53_moe_expert13</title>
<path fill="none" stroke="black" d="M4863.02,-5919.48C4863.02,-5919.48 4863.02,-5893.42 4863.02,-5893.42"/>
<polygon fill="black" stroke="black" points="4866.52,-5893.42 4863.02,-5883.42 4859.52,-5893.42 4866.52,-5893.42"/>
</g>
<!-- layer53_moe_expert14 -->
<g id="node2639" class="node">
<title>layer53_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5481,-5883.28 5143,-5883.28 5143,-5831.28 5481,-5831.28 5481,-5883.28"/>
<text text-anchor="middle" x="5312" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 14 L53</text>
<text text-anchor="middle" x="5312" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5312" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5312" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert14 -->
<g id="node2658" class="node">
<title>layer53_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5202" cy="-5766.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5202" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5202" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5202" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer53_moe_expert14&#45;&gt;layer53_moe_comm_from_expert14 -->
<g id="edge3417" class="edge">
<title>layer53_moe_expert14&#45;&gt;layer53_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5219.88,-5830.96C5219.88,-5830.96 5219.88,-5804.78 5219.88,-5804.78"/>
<polygon fill="black" stroke="black" points="5223.38,-5804.78 5219.88,-5794.78 5216.38,-5804.78 5223.38,-5804.78"/>
</g>
<!-- layer53_moe_comm_to_expert14&#45;&gt;layer53_moe_expert14 -->
<g id="edge3386" class="edge">
<title>layer53_moe_comm_to_expert14&#45;&gt;layer53_moe_expert14</title>
<path fill="none" stroke="black" d="M5218.52,-5919.48C5218.52,-5919.48 5218.52,-5893.42 5218.52,-5893.42"/>
<polygon fill="black" stroke="black" points="5222.02,-5893.42 5218.52,-5883.42 5215.02,-5893.42 5222.02,-5893.42"/>
</g>
<!-- layer53_moe_expert15 -->
<g id="node2641" class="node">
<title>layer53_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5837,-5883.28 5499,-5883.28 5499,-5831.28 5837,-5831.28 5837,-5883.28"/>
<text text-anchor="middle" x="5668" y="-5871.28" font-family="Arial" font-size="10.00">EXPERT 15 L53</text>
<text text-anchor="middle" x="5668" y="-5860.28" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5668" y="-5849.28" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5668" y="-5838.28" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_comm_from_expert15 -->
<g id="node2659" class="node">
<title>layer53_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5557" cy="-5766.29" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5557" y="-5774.79" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5557" y="-5763.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5557" y="-5752.79" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer53_moe_expert15&#45;&gt;layer53_moe_comm_from_expert15 -->
<g id="edge3419" class="edge">
<title>layer53_moe_expert15&#45;&gt;layer53_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5575.38,-5830.96C5575.38,-5830.96 5575.38,-5804.78 5575.38,-5804.78"/>
<polygon fill="black" stroke="black" points="5578.88,-5804.78 5575.38,-5794.78 5571.88,-5804.78 5578.88,-5804.78"/>
</g>
<!-- layer53_moe_comm_to_expert15&#45;&gt;layer53_moe_expert15 -->
<g id="edge3388" class="edge">
<title>layer53_moe_comm_to_expert15&#45;&gt;layer53_moe_expert15</title>
<path fill="none" stroke="black" d="M5574.02,-5919.48C5574.02,-5919.48 5574.02,-5893.42 5574.02,-5893.42"/>
<polygon fill="black" stroke="black" points="5577.52,-5893.42 5574.02,-5883.42 5570.52,-5893.42 5577.52,-5893.42"/>
</g>
<!-- layer53_moe_aggregate -->
<g id="node2643" class="node">
<title>layer53_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3243.1,-5701.3 2826.16,-5701.3 2718.9,-5597.3 3135.84,-5597.3 3243.1,-5701.3"/>
<text text-anchor="middle" x="2981" y="-5663.3" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L53</text>
<text text-anchor="middle" x="2981" y="-5652.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2981" y="-5641.3" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2981" y="-5630.3" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_mha -->
<g id="node2660" class="node">
<title>layer54_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3111,-5561.3 2851,-5561.3 2851,-5509.3 3111,-5509.3 3111,-5561.3"/>
<text text-anchor="middle" x="2981" y="-5549.3" font-family="Arial" font-size="10.00">MHA L54</text>
<text text-anchor="middle" x="2981" y="-5538.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2981" y="-5527.3" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2981" y="-5516.3" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer53_moe_aggregate&#45;&gt;layer54_moe_mha -->
<g id="edge3488" class="edge">
<title>layer53_moe_aggregate&#45;&gt;layer54_moe_mha</title>
<path fill="none" stroke="black" d="M2981,-5596.97C2981,-5596.97 2981,-5571.53 2981,-5571.53"/>
<polygon fill="black" stroke="black" points="2984.5,-5571.53 2981,-5561.53 2977.5,-5571.53 2984.5,-5571.53"/>
</g>
<!-- layer53_moe_comm_from_expert0&#45;&gt;layer53_moe_aggregate -->
<g id="edge3390" class="edge">
<title>layer53_moe_comm_from_expert0&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M577.25,-5753.4C577.25,-5716.32 577.25,-5612 577.25,-5612 577.25,-5612 2723.93,-5612 2723.93,-5612"/>
<polygon fill="black" stroke="black" points="2723.93,-5615.5 2733.93,-5612 2723.93,-5608.5 2723.93,-5615.5"/>
</g>
<!-- layer53_moe_comm_from_expert1&#45;&gt;layer53_moe_aggregate -->
<g id="edge3392" class="edge">
<title>layer53_moe_comm_from_expert1&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M929.25,-5750.04C929.25,-5713.3 929.25,-5627 929.25,-5627 929.25,-5627 2739.13,-5627 2739.13,-5627"/>
<polygon fill="black" stroke="black" points="2739.13,-5630.5 2749.13,-5627 2739.13,-5623.5 2739.13,-5630.5"/>
</g>
<!-- layer53_moe_comm_from_expert2&#45;&gt;layer53_moe_aggregate -->
<g id="edge3394" class="edge">
<title>layer53_moe_comm_from_expert2&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M1248,-5749.13C1248,-5714.82 1248,-5641 1248,-5641 1248,-5641 2753.71,-5641 2753.71,-5641"/>
<polygon fill="black" stroke="black" points="2753.71,-5644.5 2763.71,-5641 2753.71,-5637.5 2753.71,-5644.5"/>
</g>
<!-- layer53_moe_comm_from_expert3&#45;&gt;layer53_moe_aggregate -->
<g id="edge3396" class="edge">
<title>layer53_moe_comm_from_expert3&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M1761.51,-5737.89C1761.51,-5705.21 1761.51,-5656 1761.51,-5656 1761.51,-5656 2769.28,-5656 2769.28,-5656"/>
<polygon fill="black" stroke="black" points="2769.28,-5659.5 2779.28,-5656 2769.28,-5652.5 2769.28,-5659.5"/>
</g>
<!-- layer53_moe_comm_from_expert4&#45;&gt;layer53_moe_aggregate -->
<g id="edge3398" class="edge">
<title>layer53_moe_comm_from_expert4&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M2158,-5739.24C2158,-5711.07 2158,-5671 2158,-5671 2158,-5671 2784.76,-5671 2784.76,-5671"/>
<polygon fill="black" stroke="black" points="2784.76,-5674.5 2794.76,-5671 2784.76,-5667.5 2784.76,-5674.5"/>
</g>
<!-- layer53_moe_comm_from_expert5&#45;&gt;layer53_moe_aggregate -->
<g id="edge3400" class="edge">
<title>layer53_moe_comm_from_expert5&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M2419,-5737.3C2419,-5714.31 2419,-5686 2419,-5686 2419,-5686 2800.09,-5686 2800.09,-5686"/>
<polygon fill="black" stroke="black" points="2800.09,-5689.5 2810.09,-5686 2800.09,-5682.5 2800.09,-5689.5"/>
</g>
<!-- layer53_moe_comm_from_expert6&#45;&gt;layer53_moe_aggregate -->
<g id="edge3402" class="edge">
<title>layer53_moe_comm_from_expert6&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M2734.61,-5749.78C2734.61,-5749.78 2734.61,-5659.35 2734.61,-5659.35"/>
<polygon fill="black" stroke="black" points="2738.11,-5659.35 2734.61,-5649.35 2731.11,-5659.35 2738.11,-5659.35"/>
</g>
<!-- layer53_moe_comm_from_expert7&#45;&gt;layer53_moe_aggregate -->
<g id="edge3404" class="edge">
<title>layer53_moe_comm_from_expert7&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M2882,-5737.07C2882,-5737.07 2882,-5711.36 2882,-5711.36"/>
<polygon fill="black" stroke="black" points="2885.5,-5711.36 2882,-5701.36 2878.5,-5711.36 2885.5,-5711.36"/>
</g>
<!-- layer53_moe_comm_from_expert8&#45;&gt;layer53_moe_aggregate -->
<g id="edge3406" class="edge">
<title>layer53_moe_comm_from_expert8&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M3153.39,-5737.07C3153.39,-5737.07 3153.39,-5711.36 3153.39,-5711.36"/>
<polygon fill="black" stroke="black" points="3156.89,-5711.36 3153.39,-5701.36 3149.89,-5711.36 3156.89,-5711.36"/>
</g>
<!-- layer53_moe_comm_from_expert9&#45;&gt;layer53_moe_aggregate -->
<g id="edge3408" class="edge">
<title>layer53_moe_comm_from_expert9&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M3444.5,-5737.58C3444.5,-5715.24 3444.5,-5688 3444.5,-5688 3444.5,-5688 3239.71,-5688 3239.71,-5688"/>
<polygon fill="black" stroke="black" points="3239.71,-5684.5 3229.71,-5688 3239.71,-5691.5 3239.71,-5684.5"/>
</g>
<!-- layer53_moe_comm_from_expert10&#45;&gt;layer53_moe_aggregate -->
<g id="edge3410" class="edge">
<title>layer53_moe_comm_from_expert10&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M3776.15,-5737.4C3776.15,-5710.66 3776.15,-5675 3776.15,-5675 3776.15,-5675 3226.07,-5675 3226.07,-5675"/>
<polygon fill="black" stroke="black" points="3226.07,-5671.5 3216.07,-5675 3226.07,-5678.5 3226.07,-5671.5"/>
</g>
<!-- layer53_moe_comm_from_expert11&#45;&gt;layer53_moe_aggregate -->
<g id="edge3412" class="edge">
<title>layer53_moe_comm_from_expert11&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M4122.65,-5737.79C4122.65,-5706.91 4122.65,-5662 4122.65,-5662 4122.65,-5662 3212.81,-5662 3212.81,-5662"/>
<polygon fill="black" stroke="black" points="3212.81,-5658.5 3202.81,-5662 3212.81,-5665.5 3212.81,-5658.5"/>
</g>
<!-- layer53_moe_comm_from_expert12&#45;&gt;layer53_moe_aggregate -->
<g id="edge3414" class="edge">
<title>layer53_moe_comm_from_expert12&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M4473.65,-5737.9C4473.65,-5703.18 4473.65,-5649 4473.65,-5649 4473.65,-5649 3199.33,-5649 3199.33,-5649"/>
<polygon fill="black" stroke="black" points="3199.33,-5645.5 3189.33,-5649 3199.33,-5652.5 3199.33,-5645.5"/>
</g>
<!-- layer53_moe_comm_from_expert13&#45;&gt;layer53_moe_aggregate -->
<g id="edge3416" class="edge">
<title>layer53_moe_comm_from_expert13&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M4827.15,-5737.7C4827.15,-5699.34 4827.15,-5636 4827.15,-5636 4827.15,-5636 3185.95,-5636 3185.95,-5636"/>
<polygon fill="black" stroke="black" points="3185.95,-5632.5 3175.95,-5636 3185.95,-5639.5 3185.95,-5632.5"/>
</g>
<!-- layer53_moe_comm_from_expert14&#45;&gt;layer53_moe_aggregate -->
<g id="edge3418" class="edge">
<title>layer53_moe_comm_from_expert14&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M5182.15,-5737.64C5182.15,-5695.82 5182.15,-5623 5182.15,-5623 5182.15,-5623 3172.53,-5623 3172.53,-5623"/>
<polygon fill="black" stroke="black" points="3172.53,-5619.5 3162.53,-5623 3172.53,-5626.5 3172.53,-5619.5"/>
</g>
<!-- layer53_moe_comm_from_expert15&#45;&gt;layer53_moe_aggregate -->
<g id="edge3420" class="edge">
<title>layer53_moe_comm_from_expert15&#45;&gt;layer53_moe_aggregate</title>
<path fill="none" stroke="black" d="M5537.15,-5737.62C5537.15,-5692.5 5537.15,-5610 5537.15,-5610 5537.15,-5610 3159.21,-5610 3159.21,-5610"/>
<polygon fill="black" stroke="black" points="3159.21,-5606.5 3149.21,-5610 3159.21,-5613.5 3159.21,-5606.5"/>
</g>
<!-- layer54_moe_gate -->
<g id="node2661" class="node">
<title>layer54_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3239.3,-5473.3 2828.4,-5473.3 2722.7,-5369.3 3133.6,-5369.3 3239.3,-5473.3"/>
<text text-anchor="middle" x="2981" y="-5435.3" font-family="Arial" font-size="10.00">GATE L54</text>
<text text-anchor="middle" x="2981" y="-5424.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2981" y="-5413.3" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2981" y="-5402.3" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer54_moe_mha&#45;&gt;layer54_moe_gate -->
<g id="edge3489" class="edge">
<title>layer54_moe_mha&#45;&gt;layer54_moe_gate</title>
<path fill="none" stroke="black" d="M2981,-5509.14C2981,-5509.14 2981,-5483.4 2981,-5483.4"/>
<polygon fill="black" stroke="black" points="2984.5,-5483.4 2981,-5473.4 2977.5,-5483.4 2984.5,-5483.4"/>
</g>
<!-- layer54_moe_split -->
<g id="node2662" class="node">
<title>layer54_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3235.01,-5333.3 2830.94,-5333.3 2726.99,-5229.3 3131.06,-5229.3 3235.01,-5333.3"/>
<text text-anchor="middle" x="2981" y="-5295.3" font-family="Arial" font-size="10.00">SPLIT TOKENS L54</text>
<text text-anchor="middle" x="2981" y="-5284.3" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2981" y="-5273.3" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2981" y="-5262.3" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer54_moe_gate&#45;&gt;layer54_moe_split -->
<g id="edge3490" class="edge">
<title>layer54_moe_gate&#45;&gt;layer54_moe_split</title>
<path fill="none" stroke="black" d="M2981,-5369.17C2981,-5369.17 2981,-5343.47 2981,-5343.47"/>
<polygon fill="black" stroke="black" points="2984.5,-5343.47 2981,-5333.47 2977.5,-5343.47 2984.5,-5343.47"/>
</g>
<!-- layer54_moe_comm_to_expert0 -->
<g id="node2664" class="node">
<title>layer54_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="432" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="432" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="432" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="432" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert0 -->
<g id="edge3424" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2815.37,-5318C2254.85,-5318 464,-5318 464,-5318 464,-5318 464,-5201.43 464,-5201.43"/>
<polygon fill="black" stroke="black" points="467.5,-5201.43 464,-5191.43 460.5,-5201.43 467.5,-5201.43"/>
</g>
<!-- layer54_moe_comm_to_expert1 -->
<g id="node2666" class="node">
<title>layer54_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1145" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1145" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1145" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1145" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert1 -->
<g id="edge3426" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2800.58,-5303C2340.57,-5303 1160,-5303 1160,-5303 1160,-5303 1160,-5203.04 1160,-5203.04"/>
<polygon fill="black" stroke="black" points="1163.5,-5203.04 1160,-5193.04 1156.5,-5203.04 1163.5,-5203.04"/>
</g>
<!-- layer54_moe_comm_to_expert2 -->
<g id="node2668" class="node">
<title>layer54_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1601" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1601" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1601" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1601" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert2 -->
<g id="edge3428" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2785.59,-5288C2420.4,-5288 1671,-5288 1671,-5288 1671,-5288 1671,-5192.82 1671,-5192.82"/>
<polygon fill="black" stroke="black" points="1674.5,-5192.82 1671,-5182.82 1667.5,-5192.82 1674.5,-5192.82"/>
</g>
<!-- layer54_moe_comm_to_expert3 -->
<g id="node2670" class="node">
<title>layer54_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1929" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1929" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1929" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1929" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert3 -->
<g id="edge3430" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2770.56,-5273C2483.46,-5273 2004.25,-5273 2004.25,-5273 2004.25,-5273 2004.25,-5190.81 2004.25,-5190.81"/>
<polygon fill="black" stroke="black" points="2007.75,-5190.81 2004.25,-5180.81 2000.75,-5190.81 2007.75,-5190.81"/>
</g>
<!-- layer54_moe_comm_to_expert4 -->
<g id="node2672" class="node">
<title>layer54_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2192" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2192" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2192" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2192" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert4 -->
<g id="edge3432" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.25,-5259C2540.93,-5259 2248.51,-5259 2248.51,-5259 2248.51,-5259 2248.51,-5197.23 2248.51,-5197.23"/>
<polygon fill="black" stroke="black" points="2252.01,-5197.23 2248.51,-5187.23 2245.01,-5197.23 2252.01,-5197.23"/>
</g>
<!-- layer54_moe_comm_to_expert5 -->
<g id="node2674" class="node">
<title>layer54_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2423" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2423" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2423" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2423" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert5 -->
<g id="edge3434" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.46,-5244C2624.86,-5244 2509.51,-5244 2509.51,-5244 2509.51,-5244 2509.51,-5182.83 2509.51,-5182.83"/>
<polygon fill="black" stroke="black" points="2513.01,-5182.83 2509.51,-5172.83 2506.01,-5182.83 2513.01,-5182.83"/>
</g>
<!-- layer54_moe_comm_to_expert6 -->
<g id="node2676" class="node">
<title>layer54_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2638" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2638" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2638" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2638" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert6 -->
<g id="edge3436" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.5,-5281.21C2741.5,-5277.66 2741.5,-5164 2741.5,-5164 2741.5,-5164 2738.81,-5164 2738.81,-5164"/>
<polygon fill="black" stroke="black" points="2738.81,-5160.5 2728.81,-5164 2738.81,-5167.5 2738.81,-5160.5"/>
</g>
<!-- layer54_moe_comm_to_expert7 -->
<g id="node2678" class="node">
<title>layer54_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2845" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2845" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2845" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2845" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert7 -->
<g id="edge3438" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2845,-5228.96C2845,-5228.96 2845,-5203.52 2845,-5203.52"/>
<polygon fill="black" stroke="black" points="2848.5,-5203.52 2845,-5193.52 2841.5,-5203.52 2848.5,-5203.52"/>
</g>
<!-- layer54_moe_comm_to_expert8 -->
<g id="node2680" class="node">
<title>layer54_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3117" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3117" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3117" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3117" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert8 -->
<g id="edge3440" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3117,-5228.96C3117,-5228.96 3117,-5203.52 3117,-5203.52"/>
<polygon fill="black" stroke="black" points="3120.5,-5203.52 3117,-5193.52 3113.5,-5203.52 3120.5,-5203.52"/>
</g>
<!-- layer54_moe_comm_to_expert9 -->
<g id="node2682" class="node">
<title>layer54_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3426" cy="-5164.31" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3426" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3426" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3426" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert9 -->
<g id="edge3442" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3221.26,-5281.21C3221.26,-5277.66 3221.26,-5164 3221.26,-5164 3221.26,-5164 3325.3,-5164 3325.3,-5164"/>
<polygon fill="black" stroke="black" points="3325.3,-5167.5 3335.3,-5164 3325.3,-5160.5 3325.3,-5167.5"/>
</g>
<!-- layer54_moe_comm_to_expert10 -->
<g id="node2684" class="node">
<title>layer54_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3758" cy="-5164.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3758" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3758" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3758" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert10 -->
<g id="edge3444" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3145.82,-5244C3353.07,-5244 3682.1,-5244 3682.1,-5244 3682.1,-5244 3682.1,-5191.6 3682.1,-5191.6"/>
<polygon fill="black" stroke="black" points="3685.6,-5191.6 3682.1,-5181.6 3678.6,-5191.6 3685.6,-5191.6"/>
</g>
<!-- layer54_moe_comm_to_expert11 -->
<g id="node2686" class="node">
<title>layer54_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4104" cy="-5164.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4104" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4104" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4104" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert11 -->
<g id="edge3446" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3160.79,-5259C3460.24,-5259 4028.6,-5259 4028.6,-5259 4028.6,-5259 4028.6,-5191.67 4028.6,-5191.67"/>
<polygon fill="black" stroke="black" points="4032.1,-5191.67 4028.6,-5181.67 4025.1,-5191.67 4032.1,-5191.67"/>
</g>
<!-- layer54_moe_comm_to_expert12 -->
<g id="node2688" class="node">
<title>layer54_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4455" cy="-5164.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4455" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4455" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4455" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert12 -->
<g id="edge3448" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3175.1,-5273C3559.24,-5273 4379.6,-5273 4379.6,-5273 4379.6,-5273 4379.6,-5191.77 4379.6,-5191.77"/>
<polygon fill="black" stroke="black" points="4383.1,-5191.77 4379.6,-5181.77 4376.1,-5191.77 4383.1,-5191.77"/>
</g>
<!-- layer54_moe_comm_to_expert13 -->
<g id="node2690" class="node">
<title>layer54_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4808" cy="-5164.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4808" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4808" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4808" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert13 -->
<g id="edge3450" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3189.74,-5288C3654.33,-5288 4733.1,-5288 4733.1,-5288 4733.1,-5288 4733.1,-5192.03 4733.1,-5192.03"/>
<polygon fill="black" stroke="black" points="4736.6,-5192.03 4733.1,-5182.03 4729.6,-5192.03 4736.6,-5192.03"/>
</g>
<!-- layer54_moe_comm_to_expert14 -->
<g id="node2692" class="node">
<title>layer54_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5163" cy="-5164.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5163" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5163" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5163" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert14 -->
<g id="edge3452" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205,-5303C3747.61,-5303 5088.1,-5303 5088.1,-5303 5088.1,-5303 5088.1,-5191.87 5088.1,-5191.87"/>
<polygon fill="black" stroke="black" points="5091.6,-5191.87 5088.1,-5181.87 5084.6,-5191.87 5091.6,-5191.87"/>
</g>
<!-- layer54_moe_comm_to_expert15 -->
<g id="node2694" class="node">
<title>layer54_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5518" cy="-5164.31" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5518" y="-5172.81" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5518" y="-5161.81" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5518" y="-5150.81" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert15 -->
<g id="edge3454" class="edge">
<title>layer54_moe_split&#45;&gt;layer54_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3219.87,-5318C3838.18,-5318 5443.1,-5318 5443.1,-5318 5443.1,-5318 5443.1,-5191.94 5443.1,-5191.94"/>
<polygon fill="black" stroke="black" points="5446.6,-5191.94 5443.1,-5181.94 5439.6,-5191.94 5446.6,-5191.94"/>
</g>
<!-- layer54_moe_expert0 -->
<g id="node2663" class="node">
<title>layer54_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="550,-5099.31 222,-5099.31 222,-5047.31 550,-5047.31 550,-5099.31"/>
<text text-anchor="middle" x="386" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 0 L54</text>
<text text-anchor="middle" x="386" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="386" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="386" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert0 -->
<g id="node2696" class="node">
<title>layer54_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="533" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="533" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="533" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="533" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer54_moe_expert0&#45;&gt;layer54_moe_comm_from_expert0 -->
<g id="edge3456" class="edge">
<title>layer54_moe_expert0&#45;&gt;layer54_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M496.25,-5047C496.25,-5047 496.25,-5018.9 496.25,-5018.9"/>
<polygon fill="black" stroke="black" points="499.75,-5018.9 496.25,-5008.9 492.75,-5018.9 499.75,-5018.9"/>
</g>
<!-- layer54_moe_comm_to_expert0&#45;&gt;layer54_moe_expert0 -->
<g id="edge3425" class="edge">
<title>layer54_moe_comm_to_expert0&#45;&gt;layer54_moe_expert0</title>
<path fill="none" stroke="black" d="M432,-5135.27C432,-5135.27 432,-5109.62 432,-5109.62"/>
<polygon fill="black" stroke="black" points="435.5,-5109.62 432,-5099.62 428.5,-5109.62 435.5,-5109.62"/>
</g>
<!-- layer54_moe_expert1 -->
<g id="node2665" class="node">
<title>layer54_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="896,-5099.31 568,-5099.31 568,-5047.31 896,-5047.31 896,-5099.31"/>
<text text-anchor="middle" x="732" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 1 L54</text>
<text text-anchor="middle" x="732" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="732" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="732" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert1 -->
<g id="node2697" class="node">
<title>layer54_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1026" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1026" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1026" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1026" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer54_moe_expert1&#45;&gt;layer54_moe_comm_from_expert1 -->
<g id="edge3458" class="edge">
<title>layer54_moe_expert1&#45;&gt;layer54_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M834.25,-5046.9C834.25,-5019.93 834.25,-4982 834.25,-4982 834.25,-4982 925.46,-4982 925.46,-4982"/>
<polygon fill="black" stroke="black" points="925.46,-4985.5 935.46,-4982 925.46,-4978.5 925.46,-4985.5"/>
</g>
<!-- layer54_moe_comm_to_expert1&#45;&gt;layer54_moe_expert1 -->
<g id="edge3427" class="edge">
<title>layer54_moe_comm_to_expert1&#45;&gt;layer54_moe_expert1</title>
<path fill="none" stroke="black" d="M1054.24,-5164C961.11,-5164 829.75,-5164 829.75,-5164 829.75,-5164 829.75,-5109.54 829.75,-5109.54"/>
<polygon fill="black" stroke="black" points="833.25,-5109.54 829.75,-5099.54 826.25,-5109.54 833.25,-5109.54"/>
</g>
<!-- layer54_moe_expert2 -->
<g id="node2667" class="node">
<title>layer54_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1242,-5099.31 914,-5099.31 914,-5047.31 1242,-5047.31 1242,-5099.31"/>
<text text-anchor="middle" x="1078" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 2 L54</text>
<text text-anchor="middle" x="1078" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1078" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1078" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert2 -->
<g id="node2698" class="node">
<title>layer54_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1372" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1372" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1372" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1372" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer54_moe_expert2&#45;&gt;layer54_moe_comm_from_expert2 -->
<g id="edge3460" class="edge">
<title>layer54_moe_expert2&#45;&gt;layer54_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1232.5,-5046.9C1232.5,-5019.93 1232.5,-4982 1232.5,-4982 1232.5,-4982 1271.29,-4982 1271.29,-4982"/>
<polygon fill="black" stroke="black" points="1271.29,-4985.5 1281.29,-4982 1271.29,-4978.5 1271.29,-4985.5"/>
</g>
<!-- layer54_moe_comm_to_expert2&#45;&gt;layer54_moe_expert2 -->
<g id="edge3429" class="edge">
<title>layer54_moe_comm_to_expert2&#45;&gt;layer54_moe_expert2</title>
<path fill="none" stroke="black" d="M1510.28,-5164C1407.47,-5164 1254,-5164 1254,-5164 1254,-5164 1254,-5073 1254,-5073 1254,-5073 1252.18,-5073 1252.18,-5073"/>
<polygon fill="black" stroke="black" points="1252.18,-5069.5 1242.18,-5073 1252.18,-5076.5 1252.18,-5069.5"/>
</g>
<!-- layer54_moe_expert3 -->
<g id="node2669" class="node">
<title>layer54_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1588,-5099.31 1260,-5099.31 1260,-5047.31 1588,-5047.31 1588,-5099.31"/>
<text text-anchor="middle" x="1424" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 3 L54</text>
<text text-anchor="middle" x="1424" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1424" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1424" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert3 -->
<g id="node2699" class="node">
<title>layer54_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1644" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1644" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1644" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1644" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer54_moe_expert3&#45;&gt;layer54_moe_comm_from_expert3 -->
<g id="edge3462" class="edge">
<title>layer54_moe_expert3&#45;&gt;layer54_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1570.75,-5047C1570.75,-5047 1570.75,-5009.39 1570.75,-5009.39"/>
<polygon fill="black" stroke="black" points="1574.25,-5009.39 1570.75,-4999.39 1567.25,-5009.39 1574.25,-5009.39"/>
</g>
<!-- layer54_moe_comm_to_expert3&#45;&gt;layer54_moe_expert3 -->
<g id="edge3431" class="edge">
<title>layer54_moe_comm_to_expert3&#45;&gt;layer54_moe_expert3</title>
<path fill="none" stroke="black" d="M1870.33,-5142.2C1870.33,-5132.38 1870.33,-5123 1870.33,-5123 1870.33,-5123 1549.25,-5123 1549.25,-5123 1549.25,-5123 1549.25,-5109.32 1549.25,-5109.32"/>
<polygon fill="black" stroke="black" points="1552.75,-5109.32 1549.25,-5099.32 1545.75,-5109.32 1552.75,-5109.32"/>
</g>
<!-- layer54_moe_expert4 -->
<g id="node2671" class="node">
<title>layer54_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1934,-5099.31 1606,-5099.31 1606,-5047.31 1934,-5047.31 1934,-5099.31"/>
<text text-anchor="middle" x="1770" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 4 L54</text>
<text text-anchor="middle" x="1770" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1770" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1770" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert4 -->
<g id="node2700" class="node">
<title>layer54_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="1880" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1880" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="1880" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1880" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer54_moe_expert4&#45;&gt;layer54_moe_comm_from_expert4 -->
<g id="edge3464" class="edge">
<title>layer54_moe_expert4&#45;&gt;layer54_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1861.75,-5047C1861.75,-5047 1861.75,-5020.81 1861.75,-5020.81"/>
<polygon fill="black" stroke="black" points="1865.25,-5020.81 1861.75,-5010.81 1858.25,-5020.81 1865.25,-5020.81"/>
</g>
<!-- layer54_moe_comm_to_expert4&#45;&gt;layer54_moe_expert4 -->
<g id="edge3433" class="edge">
<title>layer54_moe_comm_to_expert4&#45;&gt;layer54_moe_expert4</title>
<path fill="none" stroke="black" d="M2190.75,-5135.16C2190.75,-5122.71 2190.75,-5111 2190.75,-5111 2190.75,-5111 1902.16,-5111 1902.16,-5111 1902.16,-5111 1902.16,-5109.49 1902.16,-5109.49"/>
<polygon fill="black" stroke="black" points="1905.66,-5109.49 1902.16,-5099.49 1898.66,-5109.49 1905.66,-5109.49"/>
</g>
<!-- layer54_moe_expert5 -->
<g id="node2673" class="node">
<title>layer54_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2280,-5099.31 1952,-5099.31 1952,-5047.31 2280,-5047.31 2280,-5099.31"/>
<text text-anchor="middle" x="2116" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 5 L54</text>
<text text-anchor="middle" x="2116" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2116" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2116" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert5 -->
<g id="node2701" class="node">
<title>layer54_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2227" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2227" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2227" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2227" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer54_moe_expert5&#45;&gt;layer54_moe_comm_from_expert5 -->
<g id="edge3466" class="edge">
<title>layer54_moe_expert5&#45;&gt;layer54_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2208.25,-5047C2208.25,-5047 2208.25,-5020.81 2208.25,-5020.81"/>
<polygon fill="black" stroke="black" points="2211.75,-5020.81 2208.25,-5010.81 2204.75,-5020.81 2211.75,-5020.81"/>
</g>
<!-- layer54_moe_comm_to_expert5&#45;&gt;layer54_moe_expert5 -->
<g id="edge3435" class="edge">
<title>layer54_moe_comm_to_expert5&#45;&gt;layer54_moe_expert5</title>
<path fill="none" stroke="black" d="M2332.26,-5164C2308.92,-5164 2290.25,-5164 2290.25,-5164 2290.25,-5164 2290.25,-5073 2290.25,-5073 2290.25,-5073 2289.24,-5073 2289.24,-5073"/>
<polygon fill="black" stroke="black" points="2290.13,-5069.5 2280.13,-5073 2290.13,-5076.5 2290.13,-5069.5"/>
</g>
<!-- layer54_moe_expert6 -->
<g id="node2675" class="node">
<title>layer54_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2626,-5099.31 2298,-5099.31 2298,-5047.31 2626,-5047.31 2626,-5099.31"/>
<text text-anchor="middle" x="2462" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 6 L54</text>
<text text-anchor="middle" x="2462" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2462" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2462" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert6 -->
<g id="node2702" class="node">
<title>layer54_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2573" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2573" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2573" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2573" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer54_moe_expert6&#45;&gt;layer54_moe_comm_from_expert6 -->
<g id="edge3468" class="edge">
<title>layer54_moe_expert6&#45;&gt;layer54_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2554.25,-5047C2554.25,-5047 2554.25,-5020.81 2554.25,-5020.81"/>
<polygon fill="black" stroke="black" points="2557.75,-5020.81 2554.25,-5010.81 2550.75,-5020.81 2557.75,-5020.81"/>
</g>
<!-- layer54_moe_comm_to_expert6&#45;&gt;layer54_moe_expert6 -->
<g id="edge3437" class="edge">
<title>layer54_moe_comm_to_expert6&#45;&gt;layer54_moe_expert6</title>
<path fill="none" stroke="black" d="M2586.75,-5140.4C2586.75,-5140.4 2586.75,-5109.62 2586.75,-5109.62"/>
<polygon fill="black" stroke="black" points="2590.25,-5109.62 2586.75,-5099.62 2583.25,-5109.62 2590.25,-5109.62"/>
</g>
<!-- layer54_moe_expert7 -->
<g id="node2677" class="node">
<title>layer54_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2972,-5099.31 2644,-5099.31 2644,-5047.31 2972,-5047.31 2972,-5099.31"/>
<text text-anchor="middle" x="2808" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 7 L54</text>
<text text-anchor="middle" x="2808" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2808" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2808" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert7 -->
<g id="node2703" class="node">
<title>layer54_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2845" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2845" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2845" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2845" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer54_moe_expert7&#45;&gt;layer54_moe_comm_from_expert7 -->
<g id="edge3470" class="edge">
<title>layer54_moe_expert7&#45;&gt;layer54_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2845,-5047C2845,-5047 2845,-5021.45 2845,-5021.45"/>
<polygon fill="black" stroke="black" points="2848.5,-5021.45 2845,-5011.45 2841.5,-5021.45 2848.5,-5021.45"/>
</g>
<!-- layer54_moe_comm_to_expert7&#45;&gt;layer54_moe_expert7 -->
<g id="edge3439" class="edge">
<title>layer54_moe_comm_to_expert7&#45;&gt;layer54_moe_expert7</title>
<path fill="none" stroke="black" d="M2845,-5135.27C2845,-5135.27 2845,-5109.62 2845,-5109.62"/>
<polygon fill="black" stroke="black" points="2848.5,-5109.62 2845,-5099.62 2841.5,-5109.62 2848.5,-5109.62"/>
</g>
<!-- layer54_moe_expert8 -->
<g id="node2679" class="node">
<title>layer54_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3318,-5099.31 2990,-5099.31 2990,-5047.31 3318,-5047.31 3318,-5099.31"/>
<text text-anchor="middle" x="3154" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 8 L54</text>
<text text-anchor="middle" x="3154" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3154" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3154" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert8 -->
<g id="node2704" class="node">
<title>layer54_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3117" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3117" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3117" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3117" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer54_moe_expert8&#45;&gt;layer54_moe_comm_from_expert8 -->
<g id="edge3472" class="edge">
<title>layer54_moe_expert8&#45;&gt;layer54_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3117,-5047C3117,-5047 3117,-5021.45 3117,-5021.45"/>
<polygon fill="black" stroke="black" points="3120.5,-5021.45 3117,-5011.45 3113.5,-5021.45 3120.5,-5021.45"/>
</g>
<!-- layer54_moe_comm_to_expert8&#45;&gt;layer54_moe_expert8 -->
<g id="edge3441" class="edge">
<title>layer54_moe_comm_to_expert8&#45;&gt;layer54_moe_expert8</title>
<path fill="none" stroke="black" d="M3117,-5135.27C3117,-5135.27 3117,-5109.62 3117,-5109.62"/>
<polygon fill="black" stroke="black" points="3120.5,-5109.62 3117,-5099.62 3113.5,-5109.62 3120.5,-5109.62"/>
</g>
<!-- layer54_moe_expert9 -->
<g id="node2681" class="node">
<title>layer54_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3664,-5099.31 3336,-5099.31 3336,-5047.31 3664,-5047.31 3664,-5099.31"/>
<text text-anchor="middle" x="3500" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 9 L54</text>
<text text-anchor="middle" x="3500" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3500" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3500" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert9 -->
<g id="node2705" class="node">
<title>layer54_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3426" cy="-4982.32" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3426" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3426" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3426" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer54_moe_expert9&#45;&gt;layer54_moe_comm_from_expert9 -->
<g id="edge3474" class="edge">
<title>layer54_moe_expert9&#45;&gt;layer54_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3426.25,-5047C3426.25,-5047 3426.25,-5021.45 3426.25,-5021.45"/>
<polygon fill="black" stroke="black" points="3429.75,-5021.45 3426.25,-5011.45 3422.75,-5021.45 3429.75,-5021.45"/>
</g>
<!-- layer54_moe_comm_to_expert9&#45;&gt;layer54_moe_expert9 -->
<g id="edge3443" class="edge">
<title>layer54_moe_comm_to_expert9&#45;&gt;layer54_moe_expert9</title>
<path fill="none" stroke="black" d="M3426.25,-5135.27C3426.25,-5135.27 3426.25,-5109.62 3426.25,-5109.62"/>
<polygon fill="black" stroke="black" points="3429.75,-5109.62 3426.25,-5099.62 3422.75,-5109.62 3429.75,-5109.62"/>
</g>
<!-- layer54_moe_expert10 -->
<g id="node2683" class="node">
<title>layer54_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="4020,-5099.31 3682,-5099.31 3682,-5047.31 4020,-5047.31 4020,-5099.31"/>
<text text-anchor="middle" x="3851" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 10 L54</text>
<text text-anchor="middle" x="3851" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3851" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3851" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert10 -->
<g id="node2706" class="node">
<title>layer54_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3758" cy="-4982.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3758" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3758" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3758" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer54_moe_expert10&#45;&gt;layer54_moe_comm_from_expert10 -->
<g id="edge3476" class="edge">
<title>layer54_moe_expert10&#45;&gt;layer54_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3767.38,-5047C3767.38,-5047 3767.38,-5021.45 3767.38,-5021.45"/>
<polygon fill="black" stroke="black" points="3770.88,-5021.45 3767.38,-5011.45 3763.88,-5021.45 3770.88,-5021.45"/>
</g>
<!-- layer54_moe_comm_to_expert10&#45;&gt;layer54_moe_expert10 -->
<g id="edge3445" class="edge">
<title>layer54_moe_comm_to_expert10&#45;&gt;layer54_moe_expert10</title>
<path fill="none" stroke="black" d="M3767.02,-5135.27C3767.02,-5135.27 3767.02,-5109.62 3767.02,-5109.62"/>
<polygon fill="black" stroke="black" points="3770.52,-5109.62 3767.02,-5099.62 3763.52,-5109.62 3770.52,-5109.62"/>
</g>
<!-- layer54_moe_expert11 -->
<g id="node2685" class="node">
<title>layer54_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4376,-5099.31 4038,-5099.31 4038,-5047.31 4376,-5047.31 4376,-5099.31"/>
<text text-anchor="middle" x="4207" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 11 L54</text>
<text text-anchor="middle" x="4207" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4207" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4207" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert11 -->
<g id="node2707" class="node">
<title>layer54_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4105" cy="-4982.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4105" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4105" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4105" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer54_moe_expert11&#45;&gt;layer54_moe_comm_from_expert11 -->
<g id="edge3478" class="edge">
<title>layer54_moe_expert11&#45;&gt;layer54_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4118.88,-5047C4118.88,-5047 4118.88,-5021.13 4118.88,-5021.13"/>
<polygon fill="black" stroke="black" points="4122.38,-5021.13 4118.88,-5011.13 4115.38,-5021.13 4122.38,-5021.13"/>
</g>
<!-- layer54_moe_comm_to_expert11&#45;&gt;layer54_moe_expert11 -->
<g id="edge3447" class="edge">
<title>layer54_moe_comm_to_expert11&#45;&gt;layer54_moe_expert11</title>
<path fill="none" stroke="black" d="M4118.02,-5135.52C4118.02,-5135.52 4118.02,-5109.45 4118.02,-5109.45"/>
<polygon fill="black" stroke="black" points="4121.52,-5109.45 4118.02,-5099.45 4114.52,-5109.45 4121.52,-5109.45"/>
</g>
<!-- layer54_moe_expert12 -->
<g id="node2687" class="node">
<title>layer54_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4732,-5099.31 4394,-5099.31 4394,-5047.31 4732,-5047.31 4732,-5099.31"/>
<text text-anchor="middle" x="4563" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 12 L54</text>
<text text-anchor="middle" x="4563" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4563" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4563" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert12 -->
<g id="node2708" class="node">
<title>layer54_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4456" cy="-4982.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4456" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4456" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4456" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer54_moe_expert12&#45;&gt;layer54_moe_comm_from_expert12 -->
<g id="edge3480" class="edge">
<title>layer54_moe_expert12&#45;&gt;layer54_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4472.38,-5047C4472.38,-5047 4472.38,-5021.13 4472.38,-5021.13"/>
<polygon fill="black" stroke="black" points="4475.88,-5021.13 4472.38,-5011.13 4468.88,-5021.13 4475.88,-5021.13"/>
</g>
<!-- layer54_moe_comm_to_expert12&#45;&gt;layer54_moe_expert12 -->
<g id="edge3449" class="edge">
<title>layer54_moe_comm_to_expert12&#45;&gt;layer54_moe_expert12</title>
<path fill="none" stroke="black" d="M4471.52,-5135.52C4471.52,-5135.52 4471.52,-5109.45 4471.52,-5109.45"/>
<polygon fill="black" stroke="black" points="4475.02,-5109.45 4471.52,-5099.45 4468.02,-5109.45 4475.02,-5109.45"/>
</g>
<!-- layer54_moe_expert13 -->
<g id="node2689" class="node">
<title>layer54_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5088,-5099.31 4750,-5099.31 4750,-5047.31 5088,-5047.31 5088,-5099.31"/>
<text text-anchor="middle" x="4919" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 13 L54</text>
<text text-anchor="middle" x="4919" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4919" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4919" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert13 -->
<g id="node2709" class="node">
<title>layer54_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4810" cy="-4982.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4810" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4810" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4810" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer54_moe_expert13&#45;&gt;layer54_moe_comm_from_expert13 -->
<g id="edge3482" class="edge">
<title>layer54_moe_expert13&#45;&gt;layer54_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4827.38,-5047C4827.38,-5047 4827.38,-5021.13 4827.38,-5021.13"/>
<polygon fill="black" stroke="black" points="4830.88,-5021.13 4827.38,-5011.13 4823.88,-5021.13 4830.88,-5021.13"/>
</g>
<!-- layer54_moe_comm_to_expert13&#45;&gt;layer54_moe_expert13 -->
<g id="edge3451" class="edge">
<title>layer54_moe_comm_to_expert13&#45;&gt;layer54_moe_expert13</title>
<path fill="none" stroke="black" d="M4826.02,-5135.52C4826.02,-5135.52 4826.02,-5109.45 4826.02,-5109.45"/>
<polygon fill="black" stroke="black" points="4829.52,-5109.45 4826.02,-5099.45 4822.52,-5109.45 4829.52,-5109.45"/>
</g>
<!-- layer54_moe_expert14 -->
<g id="node2691" class="node">
<title>layer54_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5444,-5099.31 5106,-5099.31 5106,-5047.31 5444,-5047.31 5444,-5099.31"/>
<text text-anchor="middle" x="5275" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 14 L54</text>
<text text-anchor="middle" x="5275" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5275" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5275" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert14 -->
<g id="node2710" class="node">
<title>layer54_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5165" cy="-4982.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5165" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5165" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5165" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer54_moe_expert14&#45;&gt;layer54_moe_comm_from_expert14 -->
<g id="edge3484" class="edge">
<title>layer54_moe_expert14&#45;&gt;layer54_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5182.88,-5047C5182.88,-5047 5182.88,-5020.81 5182.88,-5020.81"/>
<polygon fill="black" stroke="black" points="5186.38,-5020.81 5182.88,-5010.81 5179.38,-5020.81 5186.38,-5020.81"/>
</g>
<!-- layer54_moe_comm_to_expert14&#45;&gt;layer54_moe_expert14 -->
<g id="edge3453" class="edge">
<title>layer54_moe_comm_to_expert14&#45;&gt;layer54_moe_expert14</title>
<path fill="none" stroke="black" d="M5181.52,-5135.52C5181.52,-5135.52 5181.52,-5109.45 5181.52,-5109.45"/>
<polygon fill="black" stroke="black" points="5185.02,-5109.45 5181.52,-5099.45 5178.02,-5109.45 5185.02,-5109.45"/>
</g>
<!-- layer54_moe_expert15 -->
<g id="node2693" class="node">
<title>layer54_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5800,-5099.31 5462,-5099.31 5462,-5047.31 5800,-5047.31 5800,-5099.31"/>
<text text-anchor="middle" x="5631" y="-5087.31" font-family="Arial" font-size="10.00">EXPERT 15 L54</text>
<text text-anchor="middle" x="5631" y="-5076.31" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5631" y="-5065.31" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5631" y="-5054.31" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_comm_from_expert15 -->
<g id="node2711" class="node">
<title>layer54_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5520" cy="-4982.32" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5520" y="-4990.82" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5520" y="-4979.82" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5520" y="-4968.82" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer54_moe_expert15&#45;&gt;layer54_moe_comm_from_expert15 -->
<g id="edge3486" class="edge">
<title>layer54_moe_expert15&#45;&gt;layer54_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5538.38,-5047C5538.38,-5047 5538.38,-5020.81 5538.38,-5020.81"/>
<polygon fill="black" stroke="black" points="5541.88,-5020.81 5538.38,-5010.81 5534.88,-5020.81 5541.88,-5020.81"/>
</g>
<!-- layer54_moe_comm_to_expert15&#45;&gt;layer54_moe_expert15 -->
<g id="edge3455" class="edge">
<title>layer54_moe_comm_to_expert15&#45;&gt;layer54_moe_expert15</title>
<path fill="none" stroke="black" d="M5537.02,-5135.52C5537.02,-5135.52 5537.02,-5109.45 5537.02,-5109.45"/>
<polygon fill="black" stroke="black" points="5540.52,-5109.45 5537.02,-5099.45 5533.52,-5109.45 5540.52,-5109.45"/>
</g>
<!-- layer54_moe_aggregate -->
<g id="node2695" class="node">
<title>layer54_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3206.1,-4917.33 2789.16,-4917.33 2681.9,-4813.33 3098.84,-4813.33 3206.1,-4917.33"/>
<text text-anchor="middle" x="2944" y="-4879.33" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L54</text>
<text text-anchor="middle" x="2944" y="-4868.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2944" y="-4857.33" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2944" y="-4846.33" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_mha -->
<g id="node2712" class="node">
<title>layer55_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3074,-4777.33 2814,-4777.33 2814,-4725.33 3074,-4725.33 3074,-4777.33"/>
<text text-anchor="middle" x="2944" y="-4765.33" font-family="Arial" font-size="10.00">MHA L55</text>
<text text-anchor="middle" x="2944" y="-4754.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2944" y="-4743.33" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2944" y="-4732.33" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer54_moe_aggregate&#45;&gt;layer55_moe_mha -->
<g id="edge3555" class="edge">
<title>layer54_moe_aggregate&#45;&gt;layer55_moe_mha</title>
<path fill="none" stroke="black" d="M2944,-4813C2944,-4813 2944,-4787.56 2944,-4787.56"/>
<polygon fill="black" stroke="black" points="2947.5,-4787.56 2944,-4777.56 2940.5,-4787.56 2947.5,-4787.56"/>
</g>
<!-- layer54_moe_comm_from_expert0&#45;&gt;layer54_moe_aggregate -->
<g id="edge3457" class="edge">
<title>layer54_moe_comm_from_expert0&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M577.25,-4956.84C577.25,-4913.01 577.25,-4828 577.25,-4828 577.25,-4828 2686.86,-4828 2686.86,-4828"/>
<polygon fill="black" stroke="black" points="2686.86,-4831.5 2696.86,-4828 2686.86,-4824.5 2686.86,-4831.5"/>
</g>
<!-- layer54_moe_comm_from_expert1&#45;&gt;layer54_moe_aggregate -->
<g id="edge3459" class="edge">
<title>layer54_moe_comm_from_expert1&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M1067,-4956.44C1067,-4916.15 1067,-4843 1067,-4843 1067,-4843 2702.43,-4843 2702.43,-4843"/>
<polygon fill="black" stroke="black" points="2702.43,-4846.5 2712.43,-4843 2702.43,-4839.5 2702.43,-4846.5"/>
</g>
<!-- layer54_moe_comm_from_expert2&#45;&gt;layer54_moe_aggregate -->
<g id="edge3461" class="edge">
<title>layer54_moe_comm_from_expert2&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M1372,-4953.26C1372,-4916.23 1372,-4857 1372,-4857 1372,-4857 2716.66,-4857 2716.66,-4857"/>
<polygon fill="black" stroke="black" points="2716.66,-4860.5 2726.66,-4857 2716.66,-4853.5 2716.66,-4860.5"/>
</g>
<!-- layer54_moe_comm_from_expert3&#45;&gt;layer54_moe_aggregate -->
<g id="edge3463" class="edge">
<title>layer54_moe_comm_from_expert3&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M1694.51,-4958.11C1694.51,-4925.64 1694.51,-4872 1694.51,-4872 1694.51,-4872 2732.21,-4872 2732.21,-4872"/>
<polygon fill="black" stroke="black" points="2732.21,-4875.5 2742.21,-4872 2732.21,-4868.5 2732.21,-4875.5"/>
</g>
<!-- layer54_moe_comm_from_expert4&#45;&gt;layer54_moe_aggregate -->
<g id="edge3465" class="edge">
<title>layer54_moe_comm_from_expert4&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M1886,-4953.21C1886,-4925.17 1886,-4887 1886,-4887 1886,-4887 2747.59,-4887 2747.59,-4887"/>
<polygon fill="black" stroke="black" points="2747.59,-4890.5 2757.59,-4887 2747.59,-4883.5 2747.59,-4890.5"/>
</g>
<!-- layer54_moe_comm_from_expert5&#45;&gt;layer54_moe_aggregate -->
<g id="edge3467" class="edge">
<title>layer54_moe_comm_from_expert5&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M2306.5,-4968.33C2306.5,-4945.32 2306.5,-4902 2306.5,-4902 2306.5,-4902 2763.16,-4902 2763.16,-4902"/>
<polygon fill="black" stroke="black" points="2763.16,-4905.5 2773.16,-4902 2763.16,-4898.5 2763.16,-4905.5"/>
</g>
<!-- layer54_moe_comm_from_expert6&#45;&gt;layer54_moe_aggregate -->
<g id="edge3469" class="edge">
<title>layer54_moe_comm_from_expert6&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M2663.65,-4982C2692.98,-4982 2718.1,-4982 2718.1,-4982 2718.1,-4982 2718.1,-4875.42 2718.1,-4875.42"/>
<polygon fill="black" stroke="black" points="2721.6,-4875.42 2718.1,-4865.42 2714.6,-4875.42 2721.6,-4875.42"/>
</g>
<!-- layer54_moe_comm_from_expert7&#45;&gt;layer54_moe_aggregate -->
<g id="edge3471" class="edge">
<title>layer54_moe_comm_from_expert7&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M2845,-4953.1C2845,-4953.1 2845,-4927.39 2845,-4927.39"/>
<polygon fill="black" stroke="black" points="2848.5,-4927.39 2845,-4917.39 2841.5,-4927.39 2848.5,-4927.39"/>
</g>
<!-- layer54_moe_comm_from_expert8&#45;&gt;layer54_moe_aggregate -->
<g id="edge3473" class="edge">
<title>layer54_moe_comm_from_expert8&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M3116.39,-4953.1C3116.39,-4953.1 3116.39,-4927.39 3116.39,-4927.39"/>
<polygon fill="black" stroke="black" points="3119.89,-4927.39 3116.39,-4917.39 3112.89,-4927.39 3119.89,-4927.39"/>
</g>
<!-- layer54_moe_comm_from_expert9&#45;&gt;layer54_moe_aggregate -->
<g id="edge3475" class="edge">
<title>layer54_moe_comm_from_expert9&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M3407.5,-4953.6C3407.5,-4931.25 3407.5,-4904 3407.5,-4904 3407.5,-4904 3202.37,-4904 3202.37,-4904"/>
<polygon fill="black" stroke="black" points="3202.37,-4900.5 3192.37,-4904 3202.37,-4907.5 3202.37,-4900.5"/>
</g>
<!-- layer54_moe_comm_from_expert10&#45;&gt;layer54_moe_aggregate -->
<g id="edge3477" class="edge">
<title>layer54_moe_comm_from_expert10&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M3739.15,-4953.43C3739.15,-4926.67 3739.15,-4891 3739.15,-4891 3739.15,-4891 3189.07,-4891 3189.07,-4891"/>
<polygon fill="black" stroke="black" points="3189.07,-4887.5 3179.07,-4891 3189.07,-4894.5 3189.07,-4887.5"/>
</g>
<!-- layer54_moe_comm_from_expert11&#45;&gt;layer54_moe_aggregate -->
<g id="edge3479" class="edge">
<title>layer54_moe_comm_from_expert11&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M4085.65,-4953.82C4085.65,-4922.93 4085.65,-4878 4085.65,-4878 4085.65,-4878 3175.81,-4878 3175.81,-4878"/>
<polygon fill="black" stroke="black" points="3175.81,-4874.5 3165.81,-4878 3175.81,-4881.5 3175.81,-4874.5"/>
</g>
<!-- layer54_moe_comm_from_expert12&#45;&gt;layer54_moe_aggregate -->
<g id="edge3481" class="edge">
<title>layer54_moe_comm_from_expert12&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M4436.65,-4953.92C4436.65,-4919.2 4436.65,-4865 4436.65,-4865 4436.65,-4865 3162.33,-4865 3162.33,-4865"/>
<polygon fill="black" stroke="black" points="3162.33,-4861.5 3152.33,-4865 3162.33,-4868.5 3162.33,-4861.5"/>
</g>
<!-- layer54_moe_comm_from_expert13&#45;&gt;layer54_moe_aggregate -->
<g id="edge3483" class="edge">
<title>layer54_moe_comm_from_expert13&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M4790.15,-4953.72C4790.15,-4915.36 4790.15,-4852 4790.15,-4852 4790.15,-4852 3148.95,-4852 3148.95,-4852"/>
<polygon fill="black" stroke="black" points="3148.95,-4848.5 3138.95,-4852 3148.95,-4855.5 3148.95,-4848.5"/>
</g>
<!-- layer54_moe_comm_from_expert14&#45;&gt;layer54_moe_aggregate -->
<g id="edge3485" class="edge">
<title>layer54_moe_comm_from_expert14&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M5145.15,-4953.66C5145.15,-4911.84 5145.15,-4839 5145.15,-4839 5145.15,-4839 3135.53,-4839 3135.53,-4839"/>
<polygon fill="black" stroke="black" points="3135.53,-4835.5 3125.53,-4839 3135.53,-4842.5 3135.53,-4835.5"/>
</g>
<!-- layer54_moe_comm_from_expert15&#45;&gt;layer54_moe_aggregate -->
<g id="edge3487" class="edge">
<title>layer54_moe_comm_from_expert15&#45;&gt;layer54_moe_aggregate</title>
<path fill="none" stroke="black" d="M5500.15,-4953.65C5500.15,-4908.52 5500.15,-4826 5500.15,-4826 5500.15,-4826 3122.21,-4826 3122.21,-4826"/>
<polygon fill="black" stroke="black" points="3122.21,-4822.5 3112.21,-4826 3122.21,-4829.5 3122.21,-4822.5"/>
</g>
<!-- layer55_moe_gate -->
<g id="node2713" class="node">
<title>layer55_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3202.3,-4689.33 2791.4,-4689.33 2685.7,-4585.33 3096.6,-4585.33 3202.3,-4689.33"/>
<text text-anchor="middle" x="2944" y="-4651.33" font-family="Arial" font-size="10.00">GATE L55</text>
<text text-anchor="middle" x="2944" y="-4640.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2944" y="-4629.33" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2944" y="-4618.33" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer55_moe_mha&#45;&gt;layer55_moe_gate -->
<g id="edge3556" class="edge">
<title>layer55_moe_mha&#45;&gt;layer55_moe_gate</title>
<path fill="none" stroke="black" d="M2944,-4725.18C2944,-4725.18 2944,-4699.43 2944,-4699.43"/>
<polygon fill="black" stroke="black" points="2947.5,-4699.43 2944,-4689.43 2940.5,-4699.43 2947.5,-4699.43"/>
</g>
<!-- layer55_moe_split -->
<g id="node2714" class="node">
<title>layer55_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3198.01,-4549.33 2793.94,-4549.33 2689.99,-4445.33 3094.06,-4445.33 3198.01,-4549.33"/>
<text text-anchor="middle" x="2944" y="-4511.33" font-family="Arial" font-size="10.00">SPLIT TOKENS L55</text>
<text text-anchor="middle" x="2944" y="-4500.33" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2944" y="-4489.33" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2944" y="-4478.33" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer55_moe_gate&#45;&gt;layer55_moe_split -->
<g id="edge3557" class="edge">
<title>layer55_moe_gate&#45;&gt;layer55_moe_split</title>
<path fill="none" stroke="black" d="M2944,-4585.2C2944,-4585.2 2944,-4559.51 2944,-4559.51"/>
<polygon fill="black" stroke="black" points="2947.5,-4559.51 2944,-4549.51 2940.5,-4559.51 2947.5,-4559.51"/>
</g>
<!-- layer55_moe_comm_to_expert0 -->
<g id="node2716" class="node">
<title>layer55_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="863" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="863" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="863" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="863" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert0 -->
<g id="edge3491" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2778.24,-4534C2298.81,-4534 944.5,-4534 944.5,-4534 944.5,-4534 944.5,-4403.18 944.5,-4403.18"/>
<polygon fill="black" stroke="black" points="948,-4403.18 944.5,-4393.18 941,-4403.18 948,-4403.18"/>
</g>
<!-- layer55_moe_comm_to_expert1 -->
<g id="node2718" class="node">
<title>layer55_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1108" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1108" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1108" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1108" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert1 -->
<g id="edge3493" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2763.28,-4519C2309.39,-4519 1157.51,-4519 1157.51,-4519 1157.51,-4519 1157.51,-4414.81 1157.51,-4414.81"/>
<polygon fill="black" stroke="black" points="1161.01,-4414.81 1157.51,-4404.81 1154.01,-4414.81 1161.01,-4414.81"/>
</g>
<!-- layer55_moe_comm_to_expert2 -->
<g id="node2720" class="node">
<title>layer55_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1564" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1564" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1564" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1564" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert2 -->
<g id="edge3495" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2748.44,-4504C2376.51,-4504 1604,-4504 1604,-4504 1604,-4504 1604,-4416.57 1604,-4416.57"/>
<polygon fill="black" stroke="black" points="1607.5,-4416.57 1604,-4406.57 1600.5,-4416.57 1607.5,-4416.57"/>
</g>
<!-- layer55_moe_comm_to_expert3 -->
<g id="node2722" class="node">
<title>layer55_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1892" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1892" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1892" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1892" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert3 -->
<g id="edge3497" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.47,-4489C2448.86,-4489 1976.51,-4489 1976.51,-4489 1976.51,-4489 1976.51,-4400.76 1976.51,-4400.76"/>
<polygon fill="black" stroke="black" points="1980.01,-4400.76 1976.51,-4390.76 1973.01,-4400.76 1980.01,-4400.76"/>
</g>
<!-- layer55_moe_comm_to_expert4 -->
<g id="node2724" class="node">
<title>layer55_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2155" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2155" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2155" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2155" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert4 -->
<g id="edge3499" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2719.6,-4475C2497.68,-4475 2191,-4475 2191,-4475 2191,-4475 2191,-4416.96 2191,-4416.96"/>
<polygon fill="black" stroke="black" points="2194.5,-4416.96 2191,-4406.96 2187.5,-4416.96 2194.5,-4416.96"/>
</g>
<!-- layer55_moe_comm_to_expert5 -->
<g id="node2726" class="node">
<title>layer55_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2386" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2386" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2386" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2386" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert5 -->
<g id="edge3501" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2704.48,-4460C2557.4,-4460 2397.01,-4460 2397.01,-4460 2397.01,-4460 2397.01,-4419.55 2397.01,-4419.55"/>
<polygon fill="black" stroke="black" points="2400.51,-4419.55 2397.01,-4409.55 2393.51,-4419.55 2400.51,-4419.55"/>
</g>
<!-- layer55_moe_comm_to_expert6 -->
<g id="node2728" class="node">
<title>layer55_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2601" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2601" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2601" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2601" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert6 -->
<g id="edge3503" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2704.5,-4497.25C2704.5,-4493.69 2704.5,-4380 2704.5,-4380 2704.5,-4380 2701.81,-4380 2701.81,-4380"/>
<polygon fill="black" stroke="black" points="2701.81,-4376.5 2691.81,-4380 2701.81,-4383.5 2701.81,-4376.5"/>
</g>
<!-- layer55_moe_comm_to_expert7 -->
<g id="node2730" class="node">
<title>layer55_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2808" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2808" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2808" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2808" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert7 -->
<g id="edge3505" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2808,-4445C2808,-4445 2808,-4419.55 2808,-4419.55"/>
<polygon fill="black" stroke="black" points="2811.5,-4419.55 2808,-4409.55 2804.5,-4419.55 2811.5,-4419.55"/>
</g>
<!-- layer55_moe_comm_to_expert8 -->
<g id="node2732" class="node">
<title>layer55_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3080" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3080" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3080" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3080" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert8 -->
<g id="edge3507" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3080,-4445C3080,-4445 3080,-4419.55 3080,-4419.55"/>
<polygon fill="black" stroke="black" points="3083.5,-4419.55 3080,-4409.55 3076.5,-4419.55 3083.5,-4419.55"/>
</g>
<!-- layer55_moe_comm_to_expert9 -->
<g id="node2734" class="node">
<title>layer55_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3389" cy="-4380.34" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3389" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3389" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3389" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert9 -->
<g id="edge3509" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3184.26,-4497.25C3184.26,-4493.69 3184.26,-4380 3184.26,-4380 3184.26,-4380 3288.3,-4380 3288.3,-4380"/>
<polygon fill="black" stroke="black" points="3288.3,-4383.5 3298.3,-4380 3288.3,-4376.5 3288.3,-4383.5"/>
</g>
<!-- layer55_moe_comm_to_expert10 -->
<g id="node2736" class="node">
<title>layer55_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3721" cy="-4380.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3721" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3721" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3721" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert10 -->
<g id="edge3511" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3108.82,-4460C3316.07,-4460 3645.1,-4460 3645.1,-4460 3645.1,-4460 3645.1,-4407.63 3645.1,-4407.63"/>
<polygon fill="black" stroke="black" points="3648.6,-4407.63 3645.1,-4397.63 3641.6,-4407.63 3648.6,-4407.63"/>
</g>
<!-- layer55_moe_comm_to_expert11 -->
<g id="node2738" class="node">
<title>layer55_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4067" cy="-4380.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4067" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4067" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4067" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert11 -->
<g id="edge3513" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3123.79,-4475C3423.24,-4475 3991.6,-4475 3991.6,-4475 3991.6,-4475 3991.6,-4407.7 3991.6,-4407.7"/>
<polygon fill="black" stroke="black" points="3995.1,-4407.7 3991.6,-4397.7 3988.1,-4407.7 3995.1,-4407.7"/>
</g>
<!-- layer55_moe_comm_to_expert12 -->
<g id="node2740" class="node">
<title>layer55_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4418" cy="-4380.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4418" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4418" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4418" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert12 -->
<g id="edge3515" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3137.73,-4489C3521.72,-4489 4342.6,-4489 4342.6,-4489 4342.6,-4489 4342.6,-4407.8 4342.6,-4407.8"/>
<polygon fill="black" stroke="black" points="4346.1,-4407.8 4342.6,-4397.8 4339.1,-4407.8 4346.1,-4407.8"/>
</g>
<!-- layer55_moe_comm_to_expert13 -->
<g id="node2742" class="node">
<title>layer55_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4771" cy="-4380.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4771" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4771" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4771" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert13 -->
<g id="edge3517" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3152.74,-4504C3617.33,-4504 4696.1,-4504 4696.1,-4504 4696.1,-4504 4696.1,-4408.06 4696.1,-4408.06"/>
<polygon fill="black" stroke="black" points="4699.6,-4408.06 4696.1,-4398.06 4692.6,-4408.06 4699.6,-4408.06"/>
</g>
<!-- layer55_moe_comm_to_expert14 -->
<g id="node2744" class="node">
<title>layer55_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5126" cy="-4380.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5126" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5126" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5126" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert14 -->
<g id="edge3519" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3168,-4519C3710.61,-4519 5051.1,-4519 5051.1,-4519 5051.1,-4519 5051.1,-4407.9 5051.1,-4407.9"/>
<polygon fill="black" stroke="black" points="5054.6,-4407.9 5051.1,-4397.9 5047.6,-4407.9 5054.6,-4407.9"/>
</g>
<!-- layer55_moe_comm_to_expert15 -->
<g id="node2746" class="node">
<title>layer55_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5481" cy="-4380.34" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5481" y="-4388.84" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5481" y="-4377.84" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5481" y="-4366.84" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert15 -->
<g id="edge3521" class="edge">
<title>layer55_moe_split&#45;&gt;layer55_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3182.87,-4534C3801.18,-4534 5406.1,-4534 5406.1,-4534 5406.1,-4534 5406.1,-4407.97 5406.1,-4407.97"/>
<polygon fill="black" stroke="black" points="5409.6,-4407.97 5406.1,-4397.97 5402.6,-4407.97 5409.6,-4407.97"/>
</g>
<!-- layer55_moe_expert0 -->
<g id="node2715" class="node">
<title>layer55_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="513,-4315.35 185,-4315.35 185,-4263.35 513,-4263.35 513,-4315.35"/>
<text text-anchor="middle" x="349" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 0 L55</text>
<text text-anchor="middle" x="349" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="349" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="349" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert0 -->
<g id="node2748" class="node">
<title>layer55_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="863" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="863" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="863" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="863" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer55_moe_expert0&#45;&gt;layer55_moe_comm_from_expert0 -->
<g id="edge3523" class="edge">
<title>layer55_moe_expert0&#45;&gt;layer55_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M503.5,-4262.93C503.5,-4235.95 503.5,-4198 503.5,-4198 503.5,-4198 762.28,-4198 762.28,-4198"/>
<polygon fill="black" stroke="black" points="762.28,-4201.5 772.28,-4198 762.28,-4194.5 762.28,-4201.5"/>
</g>
<!-- layer55_moe_comm_to_expert0&#45;&gt;layer55_moe_expert0 -->
<g id="edge3492" class="edge">
<title>layer55_moe_comm_to_expert0&#45;&gt;layer55_moe_expert0</title>
<path fill="none" stroke="black" d="M772.19,-4380C658.29,-4380 477.75,-4380 477.75,-4380 477.75,-4380 477.75,-4325.57 477.75,-4325.57"/>
<polygon fill="black" stroke="black" points="481.25,-4325.57 477.75,-4315.57 474.25,-4325.57 481.25,-4325.57"/>
</g>
<!-- layer55_moe_expert1 -->
<g id="node2717" class="node">
<title>layer55_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="859,-4315.35 531,-4315.35 531,-4263.35 859,-4263.35 859,-4315.35"/>
<text text-anchor="middle" x="695" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 1 L55</text>
<text text-anchor="middle" x="695" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="695" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="695" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert1 -->
<g id="node2749" class="node">
<title>layer55_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1108" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1108" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1108" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1108" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer55_moe_expert1&#45;&gt;layer55_moe_comm_from_expert1 -->
<g id="edge3525" class="edge">
<title>layer55_moe_expert1&#45;&gt;layer55_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M815.75,-4263.3C815.75,-4249.76 815.75,-4236 815.75,-4236 815.75,-4236 1108,-4236 1108,-4236 1108,-4236 1108,-4235.16 1108,-4235.16"/>
<polygon fill="black" stroke="black" points="1111.5,-4237.65 1108,-4227.65 1104.5,-4237.65 1111.5,-4237.65"/>
</g>
<!-- layer55_moe_comm_to_expert1&#45;&gt;layer55_moe_expert1 -->
<g id="edge3494" class="edge">
<title>layer55_moe_comm_to_expert1&#45;&gt;layer55_moe_expert1</title>
<path fill="none" stroke="black" d="M1108,-4351.18C1108,-4337.43 1108,-4324 1108,-4324 1108,-4324 815.75,-4324 815.75,-4324 815.75,-4324 815.75,-4323.16 815.75,-4323.16"/>
<polygon fill="black" stroke="black" points="819.25,-4325.61 815.75,-4315.61 812.25,-4325.61 819.25,-4325.61"/>
</g>
<!-- layer55_moe_expert2 -->
<g id="node2719" class="node">
<title>layer55_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1205,-4315.35 877,-4315.35 877,-4263.35 1205,-4263.35 1205,-4315.35"/>
<text text-anchor="middle" x="1041" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 2 L55</text>
<text text-anchor="middle" x="1041" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1041" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1041" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert2 -->
<g id="node2750" class="node">
<title>layer55_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1564" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1564" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1564" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1564" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer55_moe_expert2&#45;&gt;layer55_moe_comm_from_expert2 -->
<g id="edge3527" class="edge">
<title>layer55_moe_expert2&#45;&gt;layer55_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1205.18,-4280C1212.6,-4280 1217,-4280 1217,-4280 1217,-4280 1217,-4198 1217,-4198 1217,-4198 1463.28,-4198 1463.28,-4198"/>
<polygon fill="black" stroke="black" points="1463.28,-4201.5 1473.28,-4198 1463.28,-4194.5 1463.28,-4201.5"/>
</g>
<!-- layer55_moe_comm_to_expert2&#45;&gt;layer55_moe_expert2 -->
<g id="edge3496" class="edge">
<title>layer55_moe_comm_to_expert2&#45;&gt;layer55_moe_expert2</title>
<path fill="none" stroke="black" d="M1473.09,-4380C1368.5,-4380 1211,-4380 1211,-4380 1211,-4380 1211,-4298 1211,-4298 1211,-4298 1210.43,-4298 1210.43,-4298"/>
<polygon fill="black" stroke="black" points="1215.34,-4294.5 1205.34,-4298 1215.34,-4301.5 1215.34,-4294.5"/>
</g>
<!-- layer55_moe_expert3 -->
<g id="node2721" class="node">
<title>layer55_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1551,-4315.35 1223,-4315.35 1223,-4263.35 1551,-4263.35 1551,-4315.35"/>
<text text-anchor="middle" x="1387" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 3 L55</text>
<text text-anchor="middle" x="1387" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1387" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1387" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert3 -->
<g id="node2751" class="node">
<title>layer55_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1892" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1892" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1892" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1892" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer55_moe_expert3&#45;&gt;layer55_moe_comm_from_expert3 -->
<g id="edge3529" class="edge">
<title>layer55_moe_expert3&#45;&gt;layer55_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1512.25,-4263.29C1512.25,-4253.64 1512.25,-4245 1512.25,-4245 1512.25,-4245 1833.33,-4245 1833.33,-4245 1833.33,-4245 1833.33,-4230.59 1833.33,-4230.59"/>
<polygon fill="black" stroke="black" points="1836.83,-4230.59 1833.33,-4220.59 1829.83,-4230.59 1836.83,-4230.59"/>
</g>
<!-- layer55_moe_comm_to_expert3&#45;&gt;layer55_moe_expert3 -->
<g id="edge3498" class="edge">
<title>layer55_moe_comm_to_expert3&#45;&gt;layer55_moe_expert3</title>
<path fill="none" stroke="black" d="M1833.33,-4358.04C1833.33,-4349.6 1833.33,-4342 1833.33,-4342 1833.33,-4342 1512.25,-4342 1512.25,-4342 1512.25,-4342 1512.25,-4325.37 1512.25,-4325.37"/>
<polygon fill="black" stroke="black" points="1515.75,-4325.37 1512.25,-4315.37 1508.75,-4325.37 1515.75,-4325.37"/>
</g>
<!-- layer55_moe_expert4 -->
<g id="node2723" class="node">
<title>layer55_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1897,-4315.35 1569,-4315.35 1569,-4263.35 1897,-4263.35 1897,-4315.35"/>
<text text-anchor="middle" x="1733" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 4 L55</text>
<text text-anchor="middle" x="1733" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1733" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1733" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert4 -->
<g id="node2752" class="node">
<title>layer55_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2155" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2155" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2155" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2155" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer55_moe_expert4&#45;&gt;layer55_moe_comm_from_expert4 -->
<g id="edge3531" class="edge">
<title>layer55_moe_expert4&#45;&gt;layer55_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1865.16,-4263.29C1865.16,-4257.99 1865.16,-4254 1865.16,-4254 1865.16,-4254 2153.75,-4254 2153.75,-4254 2153.75,-4254 2153.75,-4237.48 2153.75,-4237.48"/>
<polygon fill="black" stroke="black" points="2157.25,-4237.48 2153.75,-4227.48 2150.25,-4237.48 2157.25,-4237.48"/>
</g>
<!-- layer55_moe_comm_to_expert4&#45;&gt;layer55_moe_expert4 -->
<g id="edge3500" class="edge">
<title>layer55_moe_comm_to_expert4&#45;&gt;layer55_moe_expert4</title>
<path fill="none" stroke="black" d="M2153.75,-4351.17C2153.75,-4341.43 2153.75,-4333 2153.75,-4333 2153.75,-4333 1865.16,-4333 1865.16,-4333 1865.16,-4333 1865.16,-4325.5 1865.16,-4325.5"/>
<polygon fill="black" stroke="black" points="1868.66,-4325.5 1865.16,-4315.5 1861.66,-4325.5 1868.66,-4325.5"/>
</g>
<!-- layer55_moe_expert5 -->
<g id="node2725" class="node">
<title>layer55_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2243,-4315.35 1915,-4315.35 1915,-4263.35 2243,-4263.35 2243,-4315.35"/>
<text text-anchor="middle" x="2079" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 5 L55</text>
<text text-anchor="middle" x="2079" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2079" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2079" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert5 -->
<g id="node2753" class="node">
<title>layer55_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2386" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2386" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2386" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2386" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer55_moe_expert5&#45;&gt;layer55_moe_comm_from_expert5 -->
<g id="edge3533" class="edge">
<title>layer55_moe_expert5&#45;&gt;layer55_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2243.21,-4280C2250.1,-4280 2254.16,-4280 2254.16,-4280 2254.16,-4280 2254.16,-4198 2254.16,-4198 2254.16,-4198 2285.15,-4198 2285.15,-4198"/>
<polygon fill="black" stroke="black" points="2285.15,-4201.5 2295.15,-4198 2285.15,-4194.5 2285.15,-4201.5"/>
</g>
<!-- layer55_moe_comm_to_expert5&#45;&gt;layer55_moe_expert5 -->
<g id="edge3502" class="edge">
<title>layer55_moe_comm_to_expert5&#45;&gt;layer55_moe_expert5</title>
<path fill="none" stroke="black" d="M2295.18,-4380C2270.2,-4380 2249.84,-4380 2249.84,-4380 2249.84,-4380 2249.84,-4298 2249.84,-4298 2249.84,-4298 2249.19,-4298 2249.19,-4298"/>
<polygon fill="black" stroke="black" points="2253.35,-4294.5 2243.35,-4298 2253.35,-4301.5 2253.35,-4294.5"/>
</g>
<!-- layer55_moe_expert6 -->
<g id="node2727" class="node">
<title>layer55_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2589,-4315.35 2261,-4315.35 2261,-4263.35 2589,-4263.35 2589,-4315.35"/>
<text text-anchor="middle" x="2425" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 6 L55</text>
<text text-anchor="middle" x="2425" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2425" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2425" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert6 -->
<g id="node2754" class="node">
<title>layer55_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2601" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2601" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2601" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2601" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer55_moe_expert6&#45;&gt;layer55_moe_comm_from_expert6 -->
<g id="edge3535" class="edge">
<title>layer55_moe_expert6&#45;&gt;layer55_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2549.75,-4263.03C2549.75,-4263.03 2549.75,-4232.44 2549.75,-4232.44"/>
<polygon fill="black" stroke="black" points="2553.25,-4232.44 2549.75,-4222.44 2546.25,-4232.44 2553.25,-4232.44"/>
</g>
<!-- layer55_moe_comm_to_expert6&#45;&gt;layer55_moe_expert6 -->
<g id="edge3504" class="edge">
<title>layer55_moe_comm_to_expert6&#45;&gt;layer55_moe_expert6</title>
<path fill="none" stroke="black" d="M2549.75,-4356.43C2549.75,-4356.43 2549.75,-4325.66 2549.75,-4325.66"/>
<polygon fill="black" stroke="black" points="2553.25,-4325.66 2549.75,-4315.66 2546.25,-4325.66 2553.25,-4325.66"/>
</g>
<!-- layer55_moe_expert7 -->
<g id="node2729" class="node">
<title>layer55_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2935,-4315.35 2607,-4315.35 2607,-4263.35 2935,-4263.35 2935,-4315.35"/>
<text text-anchor="middle" x="2771" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 7 L55</text>
<text text-anchor="middle" x="2771" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2771" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2771" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert7 -->
<g id="node2755" class="node">
<title>layer55_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2808" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2808" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2808" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2808" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer55_moe_expert7&#45;&gt;layer55_moe_comm_from_expert7 -->
<g id="edge3537" class="edge">
<title>layer55_moe_expert7&#45;&gt;layer55_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2808,-4263.03C2808,-4263.03 2808,-4237.49 2808,-4237.49"/>
<polygon fill="black" stroke="black" points="2811.5,-4237.49 2808,-4227.49 2804.5,-4237.49 2811.5,-4237.49"/>
</g>
<!-- layer55_moe_comm_to_expert7&#45;&gt;layer55_moe_expert7 -->
<g id="edge3506" class="edge">
<title>layer55_moe_comm_to_expert7&#45;&gt;layer55_moe_expert7</title>
<path fill="none" stroke="black" d="M2808,-4351.3C2808,-4351.3 2808,-4325.65 2808,-4325.65"/>
<polygon fill="black" stroke="black" points="2811.5,-4325.65 2808,-4315.65 2804.5,-4325.65 2811.5,-4325.65"/>
</g>
<!-- layer55_moe_expert8 -->
<g id="node2731" class="node">
<title>layer55_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3281,-4315.35 2953,-4315.35 2953,-4263.35 3281,-4263.35 3281,-4315.35"/>
<text text-anchor="middle" x="3117" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 8 L55</text>
<text text-anchor="middle" x="3117" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3117" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3117" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert8 -->
<g id="node2756" class="node">
<title>layer55_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3080" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3080" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3080" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3080" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer55_moe_expert8&#45;&gt;layer55_moe_comm_from_expert8 -->
<g id="edge3539" class="edge">
<title>layer55_moe_expert8&#45;&gt;layer55_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3080,-4263.03C3080,-4263.03 3080,-4237.49 3080,-4237.49"/>
<polygon fill="black" stroke="black" points="3083.5,-4237.49 3080,-4227.49 3076.5,-4237.49 3083.5,-4237.49"/>
</g>
<!-- layer55_moe_comm_to_expert8&#45;&gt;layer55_moe_expert8 -->
<g id="edge3508" class="edge">
<title>layer55_moe_comm_to_expert8&#45;&gt;layer55_moe_expert8</title>
<path fill="none" stroke="black" d="M3080,-4351.3C3080,-4351.3 3080,-4325.65 3080,-4325.65"/>
<polygon fill="black" stroke="black" points="3083.5,-4325.65 3080,-4315.65 3076.5,-4325.65 3083.5,-4325.65"/>
</g>
<!-- layer55_moe_expert9 -->
<g id="node2733" class="node">
<title>layer55_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3627,-4315.35 3299,-4315.35 3299,-4263.35 3627,-4263.35 3627,-4315.35"/>
<text text-anchor="middle" x="3463" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 9 L55</text>
<text text-anchor="middle" x="3463" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3463" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3463" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert9 -->
<g id="node2757" class="node">
<title>layer55_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3389" cy="-4198.36" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3389" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3389" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3389" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer55_moe_expert9&#45;&gt;layer55_moe_comm_from_expert9 -->
<g id="edge3541" class="edge">
<title>layer55_moe_expert9&#45;&gt;layer55_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3389.25,-4263.03C3389.25,-4263.03 3389.25,-4237.49 3389.25,-4237.49"/>
<polygon fill="black" stroke="black" points="3392.75,-4237.49 3389.25,-4227.49 3385.75,-4237.49 3392.75,-4237.49"/>
</g>
<!-- layer55_moe_comm_to_expert9&#45;&gt;layer55_moe_expert9 -->
<g id="edge3510" class="edge">
<title>layer55_moe_comm_to_expert9&#45;&gt;layer55_moe_expert9</title>
<path fill="none" stroke="black" d="M3389.25,-4351.3C3389.25,-4351.3 3389.25,-4325.65 3389.25,-4325.65"/>
<polygon fill="black" stroke="black" points="3392.75,-4325.65 3389.25,-4315.65 3385.75,-4325.65 3392.75,-4325.65"/>
</g>
<!-- layer55_moe_expert10 -->
<g id="node2735" class="node">
<title>layer55_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="3983,-4315.35 3645,-4315.35 3645,-4263.35 3983,-4263.35 3983,-4315.35"/>
<text text-anchor="middle" x="3814" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 10 L55</text>
<text text-anchor="middle" x="3814" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3814" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3814" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert10 -->
<g id="node2758" class="node">
<title>layer55_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3721" cy="-4198.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3721" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3721" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3721" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer55_moe_expert10&#45;&gt;layer55_moe_comm_from_expert10 -->
<g id="edge3543" class="edge">
<title>layer55_moe_expert10&#45;&gt;layer55_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3730.38,-4263.03C3730.38,-4263.03 3730.38,-4237.49 3730.38,-4237.49"/>
<polygon fill="black" stroke="black" points="3733.88,-4237.49 3730.38,-4227.49 3726.88,-4237.49 3733.88,-4237.49"/>
</g>
<!-- layer55_moe_comm_to_expert10&#45;&gt;layer55_moe_expert10 -->
<g id="edge3512" class="edge">
<title>layer55_moe_comm_to_expert10&#45;&gt;layer55_moe_expert10</title>
<path fill="none" stroke="black" d="M3730.02,-4351.3C3730.02,-4351.3 3730.02,-4325.65 3730.02,-4325.65"/>
<polygon fill="black" stroke="black" points="3733.52,-4325.65 3730.02,-4315.65 3726.52,-4325.65 3733.52,-4325.65"/>
</g>
<!-- layer55_moe_expert11 -->
<g id="node2737" class="node">
<title>layer55_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4339,-4315.35 4001,-4315.35 4001,-4263.35 4339,-4263.35 4339,-4315.35"/>
<text text-anchor="middle" x="4170" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 11 L55</text>
<text text-anchor="middle" x="4170" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4170" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4170" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert11 -->
<g id="node2759" class="node">
<title>layer55_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4068" cy="-4198.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4068" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4068" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4068" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer55_moe_expert11&#45;&gt;layer55_moe_comm_from_expert11 -->
<g id="edge3545" class="edge">
<title>layer55_moe_expert11&#45;&gt;layer55_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4081.88,-4263.03C4081.88,-4263.03 4081.88,-4237.17 4081.88,-4237.17"/>
<polygon fill="black" stroke="black" points="4085.38,-4237.17 4081.88,-4227.17 4078.38,-4237.17 4085.38,-4237.17"/>
</g>
<!-- layer55_moe_comm_to_expert11&#45;&gt;layer55_moe_expert11 -->
<g id="edge3514" class="edge">
<title>layer55_moe_comm_to_expert11&#45;&gt;layer55_moe_expert11</title>
<path fill="none" stroke="black" d="M4081.02,-4351.55C4081.02,-4351.55 4081.02,-4325.48 4081.02,-4325.48"/>
<polygon fill="black" stroke="black" points="4084.52,-4325.48 4081.02,-4315.48 4077.52,-4325.48 4084.52,-4325.48"/>
</g>
<!-- layer55_moe_expert12 -->
<g id="node2739" class="node">
<title>layer55_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4695,-4315.35 4357,-4315.35 4357,-4263.35 4695,-4263.35 4695,-4315.35"/>
<text text-anchor="middle" x="4526" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 12 L55</text>
<text text-anchor="middle" x="4526" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4526" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4526" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert12 -->
<g id="node2760" class="node">
<title>layer55_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4419" cy="-4198.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4419" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4419" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4419" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer55_moe_expert12&#45;&gt;layer55_moe_comm_from_expert12 -->
<g id="edge3547" class="edge">
<title>layer55_moe_expert12&#45;&gt;layer55_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4435.38,-4263.03C4435.38,-4263.03 4435.38,-4237.17 4435.38,-4237.17"/>
<polygon fill="black" stroke="black" points="4438.88,-4237.17 4435.38,-4227.17 4431.88,-4237.17 4438.88,-4237.17"/>
</g>
<!-- layer55_moe_comm_to_expert12&#45;&gt;layer55_moe_expert12 -->
<g id="edge3516" class="edge">
<title>layer55_moe_comm_to_expert12&#45;&gt;layer55_moe_expert12</title>
<path fill="none" stroke="black" d="M4434.52,-4351.55C4434.52,-4351.55 4434.52,-4325.48 4434.52,-4325.48"/>
<polygon fill="black" stroke="black" points="4438.02,-4325.48 4434.52,-4315.48 4431.02,-4325.48 4438.02,-4325.48"/>
</g>
<!-- layer55_moe_expert13 -->
<g id="node2741" class="node">
<title>layer55_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5051,-4315.35 4713,-4315.35 4713,-4263.35 5051,-4263.35 5051,-4315.35"/>
<text text-anchor="middle" x="4882" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 13 L55</text>
<text text-anchor="middle" x="4882" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4882" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4882" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert13 -->
<g id="node2761" class="node">
<title>layer55_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4773" cy="-4198.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4773" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4773" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4773" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer55_moe_expert13&#45;&gt;layer55_moe_comm_from_expert13 -->
<g id="edge3549" class="edge">
<title>layer55_moe_expert13&#45;&gt;layer55_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4790.38,-4263.03C4790.38,-4263.03 4790.38,-4237.17 4790.38,-4237.17"/>
<polygon fill="black" stroke="black" points="4793.88,-4237.17 4790.38,-4227.17 4786.88,-4237.17 4793.88,-4237.17"/>
</g>
<!-- layer55_moe_comm_to_expert13&#45;&gt;layer55_moe_expert13 -->
<g id="edge3518" class="edge">
<title>layer55_moe_comm_to_expert13&#45;&gt;layer55_moe_expert13</title>
<path fill="none" stroke="black" d="M4789.02,-4351.55C4789.02,-4351.55 4789.02,-4325.48 4789.02,-4325.48"/>
<polygon fill="black" stroke="black" points="4792.52,-4325.48 4789.02,-4315.48 4785.52,-4325.48 4792.52,-4325.48"/>
</g>
<!-- layer55_moe_expert14 -->
<g id="node2743" class="node">
<title>layer55_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5407,-4315.35 5069,-4315.35 5069,-4263.35 5407,-4263.35 5407,-4315.35"/>
<text text-anchor="middle" x="5238" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 14 L55</text>
<text text-anchor="middle" x="5238" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5238" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5238" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert14 -->
<g id="node2762" class="node">
<title>layer55_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5128" cy="-4198.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5128" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5128" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5128" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer55_moe_expert14&#45;&gt;layer55_moe_comm_from_expert14 -->
<g id="edge3551" class="edge">
<title>layer55_moe_expert14&#45;&gt;layer55_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5145.88,-4263.03C5145.88,-4263.03 5145.88,-4236.84 5145.88,-4236.84"/>
<polygon fill="black" stroke="black" points="5149.38,-4236.84 5145.88,-4226.84 5142.38,-4236.84 5149.38,-4236.84"/>
</g>
<!-- layer55_moe_comm_to_expert14&#45;&gt;layer55_moe_expert14 -->
<g id="edge3520" class="edge">
<title>layer55_moe_comm_to_expert14&#45;&gt;layer55_moe_expert14</title>
<path fill="none" stroke="black" d="M5144.52,-4351.55C5144.52,-4351.55 5144.52,-4325.48 5144.52,-4325.48"/>
<polygon fill="black" stroke="black" points="5148.02,-4325.48 5144.52,-4315.48 5141.02,-4325.48 5148.02,-4325.48"/>
</g>
<!-- layer55_moe_expert15 -->
<g id="node2745" class="node">
<title>layer55_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5763,-4315.35 5425,-4315.35 5425,-4263.35 5763,-4263.35 5763,-4315.35"/>
<text text-anchor="middle" x="5594" y="-4303.35" font-family="Arial" font-size="10.00">EXPERT 15 L55</text>
<text text-anchor="middle" x="5594" y="-4292.35" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5594" y="-4281.35" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5594" y="-4270.35" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_comm_from_expert15 -->
<g id="node2763" class="node">
<title>layer55_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5483" cy="-4198.36" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5483" y="-4206.86" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5483" y="-4195.86" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5483" y="-4184.86" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer55_moe_expert15&#45;&gt;layer55_moe_comm_from_expert15 -->
<g id="edge3553" class="edge">
<title>layer55_moe_expert15&#45;&gt;layer55_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5501.38,-4263.03C5501.38,-4263.03 5501.38,-4236.84 5501.38,-4236.84"/>
<polygon fill="black" stroke="black" points="5504.88,-4236.84 5501.38,-4226.84 5497.88,-4236.84 5504.88,-4236.84"/>
</g>
<!-- layer55_moe_comm_to_expert15&#45;&gt;layer55_moe_expert15 -->
<g id="edge3522" class="edge">
<title>layer55_moe_comm_to_expert15&#45;&gt;layer55_moe_expert15</title>
<path fill="none" stroke="black" d="M5500.02,-4351.55C5500.02,-4351.55 5500.02,-4325.48 5500.02,-4325.48"/>
<polygon fill="black" stroke="black" points="5503.52,-4325.48 5500.02,-4315.48 5496.52,-4325.48 5503.52,-4325.48"/>
</g>
<!-- layer55_moe_aggregate -->
<g id="node2747" class="node">
<title>layer55_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3169.1,-4133.37 2752.16,-4133.37 2644.9,-4029.37 3061.84,-4029.37 3169.1,-4133.37"/>
<text text-anchor="middle" x="2907" y="-4095.37" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L55</text>
<text text-anchor="middle" x="2907" y="-4084.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2907" y="-4073.37" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2907" y="-4062.37" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_mha -->
<g id="node2764" class="node">
<title>layer56_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3037,-3993.37 2777,-3993.37 2777,-3941.37 3037,-3941.37 3037,-3993.37"/>
<text text-anchor="middle" x="2907" y="-3981.37" font-family="Arial" font-size="10.00">MHA L56</text>
<text text-anchor="middle" x="2907" y="-3970.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2907" y="-3959.37" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2907" y="-3948.37" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer55_moe_aggregate&#45;&gt;layer56_moe_mha -->
<g id="edge3622" class="edge">
<title>layer55_moe_aggregate&#45;&gt;layer56_moe_mha</title>
<path fill="none" stroke="black" d="M2907,-4029.04C2907,-4029.04 2907,-4003.59 2907,-4003.59"/>
<polygon fill="black" stroke="black" points="2910.5,-4003.59 2907,-3993.59 2903.5,-4003.59 2910.5,-4003.59"/>
</g>
<!-- layer55_moe_comm_from_expert0&#45;&gt;layer55_moe_aggregate -->
<g id="edge3524" class="edge">
<title>layer55_moe_comm_from_expert0&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M935.01,-4180.65C935.01,-4140.11 935.01,-4044 935.01,-4044 935.01,-4044 2649.74,-4044 2649.74,-4044"/>
<polygon fill="black" stroke="black" points="2649.74,-4047.5 2659.74,-4044 2649.74,-4040.5 2649.74,-4047.5"/>
</g>
<!-- layer55_moe_comm_from_expert1&#45;&gt;layer55_moe_aggregate -->
<g id="edge3526" class="edge">
<title>layer55_moe_comm_from_expert1&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M1192.25,-4187.42C1192.25,-4154.57 1192.25,-4059 1192.25,-4059 1192.25,-4059 2665.3,-4059 2665.3,-4059"/>
<polygon fill="black" stroke="black" points="2665.3,-4062.5 2675.3,-4059 2665.3,-4055.5 2665.3,-4062.5"/>
</g>
<!-- layer55_moe_comm_from_expert2&#45;&gt;layer55_moe_aggregate -->
<g id="edge3528" class="edge">
<title>layer55_moe_comm_from_expert2&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M1636.01,-4180.66C1636.01,-4146.11 1636.01,-4073 1636.01,-4073 1636.01,-4073 2679.59,-4073 2679.59,-4073"/>
<polygon fill="black" stroke="black" points="2679.59,-4076.5 2689.59,-4073 2679.59,-4069.5 2679.59,-4076.5"/>
</g>
<!-- layer55_moe_comm_from_expert3&#45;&gt;layer55_moe_aggregate -->
<g id="edge3530" class="edge">
<title>layer55_moe_comm_from_expert3&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M1964.01,-4180.63C1964.01,-4149.43 1964.01,-4088 1964.01,-4088 1964.01,-4088 2695.28,-4088 2695.28,-4088"/>
<polygon fill="black" stroke="black" points="2695.28,-4091.5 2705.28,-4088 2695.28,-4084.5 2695.28,-4091.5"/>
</g>
<!-- layer55_moe_comm_from_expert4&#45;&gt;layer55_moe_aggregate -->
<g id="edge3532" class="edge">
<title>layer55_moe_comm_from_expert4&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M2234.75,-4184.29C2234.75,-4157.76 2234.75,-4103 2234.75,-4103 2234.75,-4103 2710.63,-4103 2710.63,-4103"/>
<polygon fill="black" stroke="black" points="2710.64,-4106.5 2720.63,-4103 2710.63,-4099.5 2710.64,-4106.5"/>
</g>
<!-- layer55_moe_comm_from_expert5&#45;&gt;layer55_moe_aggregate -->
<g id="edge3534" class="edge">
<title>layer55_moe_comm_from_expert5&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M2456.5,-4180.12C2456.5,-4156.41 2456.5,-4118 2456.5,-4118 2456.5,-4118 2726.04,-4118 2726.04,-4118"/>
<polygon fill="black" stroke="black" points="2726.04,-4121.5 2736.04,-4118 2726.04,-4114.5 2726.04,-4121.5"/>
</g>
<!-- layer55_moe_comm_from_expert6&#45;&gt;layer55_moe_aggregate -->
<g id="edge3536" class="edge">
<title>layer55_moe_comm_from_expert6&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M2668.11,-4178.78C2668.11,-4178.78 2668.11,-4091.41 2668.11,-4091.41"/>
<polygon fill="black" stroke="black" points="2671.61,-4091.41 2668.11,-4081.41 2664.61,-4091.41 2671.61,-4091.41"/>
</g>
<!-- layer55_moe_comm_from_expert7&#45;&gt;layer55_moe_aggregate -->
<g id="edge3538" class="edge">
<title>layer55_moe_comm_from_expert7&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M2808,-4169.14C2808,-4169.14 2808,-4143.43 2808,-4143.43"/>
<polygon fill="black" stroke="black" points="2811.5,-4143.43 2808,-4133.43 2804.5,-4143.43 2811.5,-4143.43"/>
</g>
<!-- layer55_moe_comm_from_expert8&#45;&gt;layer55_moe_aggregate -->
<g id="edge3540" class="edge">
<title>layer55_moe_comm_from_expert8&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M3079.39,-4169.14C3079.39,-4169.14 3079.39,-4143.43 3079.39,-4143.43"/>
<polygon fill="black" stroke="black" points="3082.89,-4143.43 3079.39,-4133.43 3075.89,-4143.43 3082.89,-4143.43"/>
</g>
<!-- layer55_moe_comm_from_expert9&#45;&gt;layer55_moe_aggregate -->
<g id="edge3542" class="edge">
<title>layer55_moe_comm_from_expert9&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M3370.5,-4169.63C3370.5,-4147.26 3370.5,-4120 3370.5,-4120 3370.5,-4120 3165.37,-4120 3165.37,-4120"/>
<polygon fill="black" stroke="black" points="3165.37,-4116.5 3155.37,-4120 3165.37,-4123.5 3165.37,-4116.5"/>
</g>
<!-- layer55_moe_comm_from_expert10&#45;&gt;layer55_moe_aggregate -->
<g id="edge3544" class="edge">
<title>layer55_moe_comm_from_expert10&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M3702.15,-4169.45C3702.15,-4142.69 3702.15,-4107 3702.15,-4107 3702.15,-4107 3152.07,-4107 3152.07,-4107"/>
<polygon fill="black" stroke="black" points="3152.07,-4103.5 3142.07,-4107 3152.07,-4110.5 3152.07,-4103.5"/>
</g>
<!-- layer55_moe_comm_from_expert11&#45;&gt;layer55_moe_aggregate -->
<g id="edge3546" class="edge">
<title>layer55_moe_comm_from_expert11&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M4048.65,-4169.84C4048.65,-4138.94 4048.65,-4094 4048.65,-4094 4048.65,-4094 3138.81,-4094 3138.81,-4094"/>
<polygon fill="black" stroke="black" points="3138.81,-4090.5 3128.81,-4094 3138.81,-4097.5 3138.81,-4090.5"/>
</g>
<!-- layer55_moe_comm_from_expert12&#45;&gt;layer55_moe_aggregate -->
<g id="edge3548" class="edge">
<title>layer55_moe_comm_from_expert12&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M4399.65,-4169.95C4399.65,-4135.22 4399.65,-4081 4399.65,-4081 4399.65,-4081 3125.33,-4081 3125.33,-4081"/>
<polygon fill="black" stroke="black" points="3125.33,-4077.5 3115.33,-4081 3125.33,-4084.5 3125.33,-4077.5"/>
</g>
<!-- layer55_moe_comm_from_expert13&#45;&gt;layer55_moe_aggregate -->
<g id="edge3550" class="edge">
<title>layer55_moe_comm_from_expert13&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M4753.15,-4169.75C4753.15,-4131.38 4753.15,-4068 4753.15,-4068 4753.15,-4068 3111.95,-4068 3111.95,-4068"/>
<polygon fill="black" stroke="black" points="3111.95,-4064.5 3101.95,-4068 3111.95,-4071.5 3111.95,-4064.5"/>
</g>
<!-- layer55_moe_comm_from_expert14&#45;&gt;layer55_moe_aggregate -->
<g id="edge3552" class="edge">
<title>layer55_moe_comm_from_expert14&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M5108.15,-4169.69C5108.15,-4127.86 5108.15,-4055 5108.15,-4055 5108.15,-4055 3098.53,-4055 3098.53,-4055"/>
<polygon fill="black" stroke="black" points="3098.53,-4051.5 3088.53,-4055 3098.53,-4058.5 3098.53,-4051.5"/>
</g>
<!-- layer55_moe_comm_from_expert15&#45;&gt;layer55_moe_aggregate -->
<g id="edge3554" class="edge">
<title>layer55_moe_comm_from_expert15&#45;&gt;layer55_moe_aggregate</title>
<path fill="none" stroke="black" d="M5463.15,-4169.68C5463.15,-4124.54 5463.15,-4042 5463.15,-4042 5463.15,-4042 3085.21,-4042 3085.21,-4042"/>
<polygon fill="black" stroke="black" points="3085.21,-4038.5 3075.21,-4042 3085.21,-4045.5 3085.21,-4038.5"/>
</g>
<!-- layer56_moe_gate -->
<g id="node2765" class="node">
<title>layer56_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3165.3,-3905.37 2754.4,-3905.37 2648.7,-3801.37 3059.6,-3801.37 3165.3,-3905.37"/>
<text text-anchor="middle" x="2907" y="-3867.37" font-family="Arial" font-size="10.00">GATE L56</text>
<text text-anchor="middle" x="2907" y="-3856.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2907" y="-3845.37" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2907" y="-3834.37" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer56_moe_mha&#45;&gt;layer56_moe_gate -->
<g id="edge3623" class="edge">
<title>layer56_moe_mha&#45;&gt;layer56_moe_gate</title>
<path fill="none" stroke="black" d="M2907,-3941.21C2907,-3941.21 2907,-3915.47 2907,-3915.47"/>
<polygon fill="black" stroke="black" points="2910.5,-3915.47 2907,-3905.47 2903.5,-3915.47 2910.5,-3915.47"/>
</g>
<!-- layer56_moe_split -->
<g id="node2766" class="node">
<title>layer56_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3161.01,-3765.37 2756.94,-3765.37 2652.99,-3661.37 3057.06,-3661.37 3161.01,-3765.37"/>
<text text-anchor="middle" x="2907" y="-3727.37" font-family="Arial" font-size="10.00">SPLIT TOKENS L56</text>
<text text-anchor="middle" x="2907" y="-3716.37" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2907" y="-3705.37" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2907" y="-3694.37" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer56_moe_gate&#45;&gt;layer56_moe_split -->
<g id="edge3624" class="edge">
<title>layer56_moe_gate&#45;&gt;layer56_moe_split</title>
<path fill="none" stroke="black" d="M2907,-3801.24C2907,-3801.24 2907,-3775.54 2907,-3775.54"/>
<polygon fill="black" stroke="black" points="2910.5,-3775.54 2907,-3765.54 2903.5,-3775.54 2910.5,-3775.54"/>
</g>
<!-- layer56_moe_comm_to_expert0 -->
<g id="node2768" class="node">
<title>layer56_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="826" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="826" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="826" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="826" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert0 -->
<g id="edge3558" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.27,-3750C2251.45,-3750 844.5,-3750 844.5,-3750 844.5,-3750 844.5,-3634.91 844.5,-3634.91"/>
<polygon fill="black" stroke="black" points="848,-3634.91 844.5,-3624.91 841,-3634.91 848,-3634.91"/>
</g>
<!-- layer56_moe_comm_to_expert1 -->
<g id="node2770" class="node">
<title>layer56_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1071" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1071" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="1071" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1071" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert1 -->
<g id="edge3560" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2726.5,-3735C2267.09,-3735 1089.5,-3735 1089.5,-3735 1089.5,-3735 1089.5,-3634.76 1089.5,-3634.76"/>
<polygon fill="black" stroke="black" points="1093,-3634.76 1089.5,-3624.76 1086,-3634.76 1093,-3634.76"/>
</g>
<!-- layer56_moe_comm_to_expert2 -->
<g id="node2772" class="node">
<title>layer56_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1527" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1527" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1527" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1527" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert2 -->
<g id="edge3562" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2711.57,-3720C2334.96,-3720 1545.5,-3720 1545.5,-3720 1545.5,-3720 1545.5,-3635.05 1545.5,-3635.05"/>
<polygon fill="black" stroke="black" points="1549,-3635.05 1545.5,-3625.05 1542,-3635.05 1549,-3635.05"/>
</g>
<!-- layer56_moe_comm_to_expert3 -->
<g id="node2774" class="node">
<title>layer56_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1855" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1855" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1855" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1855" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert3 -->
<g id="edge3564" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2696.3,-3705C2394.07,-3705 1873.5,-3705 1873.5,-3705 1873.5,-3705 1873.5,-3634.92 1873.5,-3634.92"/>
<polygon fill="black" stroke="black" points="1877,-3634.92 1873.5,-3624.92 1870,-3634.92 1877,-3634.92"/>
</g>
<!-- layer56_moe_comm_to_expert4 -->
<g id="node2776" class="node">
<title>layer56_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2118" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2118" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2118" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2118" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert4 -->
<g id="edge3566" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2682.59,-3691C2455.13,-3691 2136.5,-3691 2136.5,-3691 2136.5,-3691 2136.5,-3634.77 2136.5,-3634.77"/>
<polygon fill="black" stroke="black" points="2140,-3634.77 2136.5,-3624.77 2133,-3634.77 2140,-3634.77"/>
</g>
<!-- layer56_moe_comm_to_expert5 -->
<g id="node2778" class="node">
<title>layer56_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2349" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2349" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2349" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2349" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert5 -->
<g id="edge3568" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.23,-3676C2523.14,-3676 2367.5,-3676 2367.5,-3676 2367.5,-3676 2367.5,-3635.12 2367.5,-3635.12"/>
<polygon fill="black" stroke="black" points="2371,-3635.12 2367.5,-3625.12 2364,-3635.12 2371,-3635.12"/>
</g>
<!-- layer56_moe_comm_to_expert6 -->
<g id="node2780" class="node">
<title>layer56_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2564" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2564" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2564" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2564" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert6 -->
<g id="edge3570" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.5,-3713.28C2667.5,-3709.73 2667.5,-3596 2667.5,-3596 2667.5,-3596 2664.81,-3596 2664.81,-3596"/>
<polygon fill="black" stroke="black" points="2664.81,-3592.5 2654.81,-3596 2664.81,-3599.5 2664.81,-3592.5"/>
</g>
<!-- layer56_moe_comm_to_expert7 -->
<g id="node2782" class="node">
<title>layer56_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2771" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2771" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2771" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2771" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert7 -->
<g id="edge3572" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2771,-3661.03C2771,-3661.03 2771,-3635.59 2771,-3635.59"/>
<polygon fill="black" stroke="black" points="2774.5,-3635.59 2771,-3625.59 2767.5,-3635.59 2774.5,-3635.59"/>
</g>
<!-- layer56_moe_comm_to_expert8 -->
<g id="node2784" class="node">
<title>layer56_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3043" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3043" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3043" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3043" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert8 -->
<g id="edge3574" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3043,-3661.03C3043,-3661.03 3043,-3635.59 3043,-3635.59"/>
<polygon fill="black" stroke="black" points="3046.5,-3635.59 3043,-3625.59 3039.5,-3635.59 3046.5,-3635.59"/>
</g>
<!-- layer56_moe_comm_to_expert9 -->
<g id="node2786" class="node">
<title>layer56_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3352" cy="-3596.38" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3352" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3352" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3352" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert9 -->
<g id="edge3576" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3147.26,-3713.28C3147.26,-3709.73 3147.26,-3596 3147.26,-3596 3147.26,-3596 3251.3,-3596 3251.3,-3596"/>
<polygon fill="black" stroke="black" points="3251.3,-3599.5 3261.3,-3596 3251.3,-3592.5 3251.3,-3599.5"/>
</g>
<!-- layer56_moe_comm_to_expert10 -->
<g id="node2788" class="node">
<title>layer56_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3684" cy="-3596.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3684" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3684" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3684" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert10 -->
<g id="edge3578" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3071.82,-3676C3279.07,-3676 3608.1,-3676 3608.1,-3676 3608.1,-3676 3608.1,-3623.65 3608.1,-3623.65"/>
<polygon fill="black" stroke="black" points="3611.6,-3623.65 3608.1,-3613.65 3604.6,-3623.65 3611.6,-3623.65"/>
</g>
<!-- layer56_moe_comm_to_expert11 -->
<g id="node2790" class="node">
<title>layer56_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4030" cy="-3596.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4030" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="4030" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4030" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert11 -->
<g id="edge3580" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3086.79,-3691C3386.24,-3691 3954.6,-3691 3954.6,-3691 3954.6,-3691 3954.6,-3623.73 3954.6,-3623.73"/>
<polygon fill="black" stroke="black" points="3958.1,-3623.73 3954.6,-3613.73 3951.1,-3623.73 3958.1,-3623.73"/>
</g>
<!-- layer56_moe_comm_to_expert12 -->
<g id="node2792" class="node">
<title>layer56_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4381" cy="-3596.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4381" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4381" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4381" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert12 -->
<g id="edge3582" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3100.73,-3705C3484.72,-3705 4305.6,-3705 4305.6,-3705 4305.6,-3705 4305.6,-3623.83 4305.6,-3623.83"/>
<polygon fill="black" stroke="black" points="4309.1,-3623.83 4305.6,-3613.83 4302.1,-3623.83 4309.1,-3623.83"/>
</g>
<!-- layer56_moe_comm_to_expert13 -->
<g id="node2794" class="node">
<title>layer56_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4734" cy="-3596.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4734" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4734" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4734" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert13 -->
<g id="edge3584" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3115.74,-3720C3580.33,-3720 4659.1,-3720 4659.1,-3720 4659.1,-3720 4659.1,-3624.09 4659.1,-3624.09"/>
<polygon fill="black" stroke="black" points="4662.6,-3624.09 4659.1,-3614.09 4655.6,-3624.09 4662.6,-3624.09"/>
</g>
<!-- layer56_moe_comm_to_expert14 -->
<g id="node2796" class="node">
<title>layer56_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5089" cy="-3596.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5089" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5089" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5089" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert14 -->
<g id="edge3586" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3131,-3735C3673.61,-3735 5014.1,-3735 5014.1,-3735 5014.1,-3735 5014.1,-3623.93 5014.1,-3623.93"/>
<polygon fill="black" stroke="black" points="5017.6,-3623.93 5014.1,-3613.93 5010.6,-3623.93 5017.6,-3623.93"/>
</g>
<!-- layer56_moe_comm_to_expert15 -->
<g id="node2798" class="node">
<title>layer56_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5444" cy="-3596.38" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5444" y="-3604.88" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5444" y="-3593.88" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5444" y="-3582.88" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert15 -->
<g id="edge3588" class="edge">
<title>layer56_moe_split&#45;&gt;layer56_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3145.87,-3750C3764.18,-3750 5369.1,-3750 5369.1,-3750 5369.1,-3750 5369.1,-3624 5369.1,-3624"/>
<polygon fill="black" stroke="black" points="5372.6,-3624 5369.1,-3614 5365.6,-3624 5372.6,-3624"/>
</g>
<!-- layer56_moe_expert0 -->
<g id="node2767" class="node">
<title>layer56_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="476,-3531.38 148,-3531.38 148,-3479.38 476,-3479.38 476,-3531.38"/>
<text text-anchor="middle" x="312" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 0 L56</text>
<text text-anchor="middle" x="312" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="312" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="312" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert0 -->
<g id="node2800" class="node">
<title>layer56_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="358" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="358" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="358" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="358" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer56_moe_expert0&#45;&gt;layer56_moe_comm_from_expert0 -->
<g id="edge3590" class="edge">
<title>layer56_moe_expert0&#45;&gt;layer56_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M358,-3479.07C358,-3479.07 358,-3453.52 358,-3453.52"/>
<polygon fill="black" stroke="black" points="361.5,-3453.52 358,-3443.52 354.5,-3453.52 361.5,-3453.52"/>
</g>
<!-- layer56_moe_comm_to_expert0&#45;&gt;layer56_moe_expert0 -->
<g id="edge3559" class="edge">
<title>layer56_moe_comm_to_expert0&#45;&gt;layer56_moe_expert0</title>
<path fill="none" stroke="black" d="M735.41,-3596C592.42,-3596 330.5,-3596 330.5,-3596 330.5,-3596 330.5,-3541.59 330.5,-3541.59"/>
<polygon fill="black" stroke="black" points="334,-3541.59 330.5,-3531.59 327,-3541.59 334,-3541.59"/>
</g>
<!-- layer56_moe_expert1 -->
<g id="node2769" class="node">
<title>layer56_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="822,-3531.38 494,-3531.38 494,-3479.38 822,-3479.38 822,-3531.38"/>
<text text-anchor="middle" x="658" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 1 L56</text>
<text text-anchor="middle" x="658" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="658" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="658" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert1 -->
<g id="node2801" class="node">
<title>layer56_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1071" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1071" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1071" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1071" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer56_moe_expert1&#45;&gt;layer56_moe_comm_from_expert1 -->
<g id="edge3592" class="edge">
<title>layer56_moe_expert1&#45;&gt;layer56_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M812.5,-3478.95C812.5,-3451.96 812.5,-3414 812.5,-3414 812.5,-3414 970.23,-3414 970.23,-3414"/>
<polygon fill="black" stroke="black" points="970.23,-3417.5 980.23,-3414 970.23,-3410.5 970.23,-3417.5"/>
</g>
<!-- layer56_moe_comm_to_expert1&#45;&gt;layer56_moe_expert1 -->
<g id="edge3561" class="edge">
<title>layer56_moe_comm_to_expert1&#45;&gt;layer56_moe_expert1</title>
<path fill="none" stroke="black" d="M1071,-3567.2C1071,-3553.44 1071,-3540 1071,-3540 1071,-3540 778.75,-3540 778.75,-3540 778.75,-3540 778.75,-3539.16 778.75,-3539.16"/>
<polygon fill="black" stroke="black" points="782.25,-3541.62 778.75,-3531.62 775.25,-3541.62 782.25,-3541.62"/>
</g>
<!-- layer56_moe_expert2 -->
<g id="node2771" class="node">
<title>layer56_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1168,-3531.38 840,-3531.38 840,-3479.38 1168,-3479.38 1168,-3531.38"/>
<text text-anchor="middle" x="1004" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 2 L56</text>
<text text-anchor="middle" x="1004" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1004" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="1004" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert2 -->
<g id="node2802" class="node">
<title>layer56_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1527" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1527" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1527" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1527" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer56_moe_expert2&#45;&gt;layer56_moe_comm_from_expert2 -->
<g id="edge3594" class="edge">
<title>layer56_moe_expert2&#45;&gt;layer56_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1168.11,-3496C1176.07,-3496 1180.83,-3496 1180.83,-3496 1180.83,-3496 1180.83,-3414 1180.83,-3414 1180.83,-3414 1426.05,-3414 1426.05,-3414"/>
<polygon fill="black" stroke="black" points="1426.05,-3417.5 1436.05,-3414 1426.05,-3410.5 1426.05,-3417.5"/>
</g>
<!-- layer56_moe_comm_to_expert2&#45;&gt;layer56_moe_expert2 -->
<g id="edge3563" class="edge">
<title>layer56_moe_comm_to_expert2&#45;&gt;layer56_moe_expert2</title>
<path fill="none" stroke="black" d="M1436.06,-3596C1331.96,-3596 1175.66,-3596 1175.66,-3596 1175.66,-3596 1175.66,-3514 1175.66,-3514 1175.66,-3514 1174.92,-3514 1174.92,-3514"/>
<polygon fill="black" stroke="black" points="1178.28,-3510.5 1168.28,-3514 1178.28,-3517.5 1178.28,-3510.5"/>
</g>
<!-- layer56_moe_expert3 -->
<g id="node2773" class="node">
<title>layer56_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1514,-3531.38 1186,-3531.38 1186,-3479.38 1514,-3479.38 1514,-3531.38"/>
<text text-anchor="middle" x="1350" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 3 L56</text>
<text text-anchor="middle" x="1350" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1350" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1350" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert3 -->
<g id="node2803" class="node">
<title>layer56_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1855" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1855" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1855" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1855" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer56_moe_expert3&#45;&gt;layer56_moe_comm_from_expert3 -->
<g id="edge3596" class="edge">
<title>layer56_moe_expert3&#45;&gt;layer56_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1475.25,-3479.31C1475.25,-3467.01 1475.25,-3455 1475.25,-3455 1475.25,-3455 1796.33,-3455 1796.33,-3455 1796.33,-3455 1796.33,-3446.6 1796.33,-3446.6"/>
<polygon fill="black" stroke="black" points="1799.83,-3446.6 1796.33,-3436.6 1792.83,-3446.6 1799.83,-3446.6"/>
</g>
<!-- layer56_moe_comm_to_expert3&#45;&gt;layer56_moe_expert3 -->
<g id="edge3565" class="edge">
<title>layer56_moe_comm_to_expert3&#45;&gt;layer56_moe_expert3</title>
<path fill="none" stroke="black" d="M1796.33,-3574.05C1796.33,-3565.61 1796.33,-3558 1796.33,-3558 1796.33,-3558 1475.25,-3558 1475.25,-3558 1475.25,-3558 1475.25,-3541.69 1475.25,-3541.69"/>
<polygon fill="black" stroke="black" points="1478.75,-3541.69 1475.25,-3531.69 1471.75,-3541.69 1478.75,-3541.69"/>
</g>
<!-- layer56_moe_expert4 -->
<g id="node2775" class="node">
<title>layer56_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1860,-3531.38 1532,-3531.38 1532,-3479.38 1860,-3479.38 1860,-3531.38"/>
<text text-anchor="middle" x="1696" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 4 L56</text>
<text text-anchor="middle" x="1696" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1696" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1696" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert4 -->
<g id="node2804" class="node">
<title>layer56_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2118" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2118" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2118" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2118" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer56_moe_expert4&#45;&gt;layer56_moe_comm_from_expert4 -->
<g id="edge3598" class="edge">
<title>layer56_moe_expert4&#45;&gt;layer56_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1828.16,-3479.14C1828.16,-3472.4 1828.16,-3467 1828.16,-3467 1828.16,-3467 2116.75,-3467 2116.75,-3467 2116.75,-3467 2116.75,-3453.47 2116.75,-3453.47"/>
<polygon fill="black" stroke="black" points="2120.25,-3453.47 2116.75,-3443.47 2113.25,-3453.47 2120.25,-3453.47"/>
</g>
<!-- layer56_moe_comm_to_expert4&#45;&gt;layer56_moe_expert4 -->
<g id="edge3567" class="edge">
<title>layer56_moe_comm_to_expert4&#45;&gt;layer56_moe_expert4</title>
<path fill="none" stroke="black" d="M2116.75,-3567.18C2116.75,-3557.43 2116.75,-3549 2116.75,-3549 2116.75,-3549 1828.16,-3549 1828.16,-3549 1828.16,-3549 1828.16,-3541.76 1828.16,-3541.76"/>
<polygon fill="black" stroke="black" points="1831.66,-3541.76 1828.16,-3531.76 1824.66,-3541.76 1831.66,-3541.76"/>
</g>
<!-- layer56_moe_expert5 -->
<g id="node2777" class="node">
<title>layer56_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2206,-3531.38 1878,-3531.38 1878,-3479.38 2206,-3479.38 2206,-3531.38"/>
<text text-anchor="middle" x="2042" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 5 L56</text>
<text text-anchor="middle" x="2042" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2042" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2042" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert5 -->
<g id="node2805" class="node">
<title>layer56_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2349" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2349" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2349" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2349" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer56_moe_expert5&#45;&gt;layer56_moe_comm_from_expert5 -->
<g id="edge3600" class="edge">
<title>layer56_moe_expert5&#45;&gt;layer56_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2206.12,-3496C2214.08,-3496 2218.84,-3496 2218.84,-3496 2218.84,-3496 2218.84,-3414 2218.84,-3414 2218.84,-3414 2248.24,-3414 2248.24,-3414"/>
<polygon fill="black" stroke="black" points="2248.24,-3417.5 2258.24,-3414 2248.24,-3410.5 2248.24,-3417.5"/>
</g>
<!-- layer56_moe_comm_to_expert5&#45;&gt;layer56_moe_expert5 -->
<g id="edge3569" class="edge">
<title>layer56_moe_comm_to_expert5&#45;&gt;layer56_moe_expert5</title>
<path fill="none" stroke="black" d="M2258.36,-3596C2233.71,-3596 2213.67,-3596 2213.67,-3596 2213.67,-3596 2213.67,-3514 2213.67,-3514 2213.67,-3514 2212.94,-3514 2212.94,-3514"/>
<polygon fill="black" stroke="black" points="2216.3,-3510.5 2206.3,-3514 2216.3,-3517.5 2216.3,-3510.5"/>
</g>
<!-- layer56_moe_expert6 -->
<g id="node2779" class="node">
<title>layer56_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2552,-3531.38 2224,-3531.38 2224,-3479.38 2552,-3479.38 2552,-3531.38"/>
<text text-anchor="middle" x="2388" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 6 L56</text>
<text text-anchor="middle" x="2388" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2388" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2388" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert6 -->
<g id="node2806" class="node">
<title>layer56_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2564" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2564" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2564" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2564" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer56_moe_expert6&#45;&gt;layer56_moe_comm_from_expert6 -->
<g id="edge3602" class="edge">
<title>layer56_moe_expert6&#45;&gt;layer56_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2512.75,-3479.07C2512.75,-3479.07 2512.75,-3448.47 2512.75,-3448.47"/>
<polygon fill="black" stroke="black" points="2516.25,-3448.47 2512.75,-3438.47 2509.25,-3448.47 2516.25,-3448.47"/>
</g>
<!-- layer56_moe_comm_to_expert6&#45;&gt;layer56_moe_expert6 -->
<g id="edge3571" class="edge">
<title>layer56_moe_comm_to_expert6&#45;&gt;layer56_moe_expert6</title>
<path fill="none" stroke="black" d="M2512.75,-3572.47C2512.75,-3572.47 2512.75,-3541.69 2512.75,-3541.69"/>
<polygon fill="black" stroke="black" points="2516.25,-3541.69 2512.75,-3531.69 2509.25,-3541.69 2516.25,-3541.69"/>
</g>
<!-- layer56_moe_expert7 -->
<g id="node2781" class="node">
<title>layer56_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2898,-3531.38 2570,-3531.38 2570,-3479.38 2898,-3479.38 2898,-3531.38"/>
<text text-anchor="middle" x="2734" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 7 L56</text>
<text text-anchor="middle" x="2734" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2734" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2734" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert7 -->
<g id="node2807" class="node">
<title>layer56_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2771" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2771" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2771" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2771" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer56_moe_expert7&#45;&gt;layer56_moe_comm_from_expert7 -->
<g id="edge3604" class="edge">
<title>layer56_moe_expert7&#45;&gt;layer56_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2771,-3479.07C2771,-3479.07 2771,-3453.52 2771,-3453.52"/>
<polygon fill="black" stroke="black" points="2774.5,-3453.52 2771,-3443.52 2767.5,-3453.52 2774.5,-3453.52"/>
</g>
<!-- layer56_moe_comm_to_expert7&#45;&gt;layer56_moe_expert7 -->
<g id="edge3573" class="edge">
<title>layer56_moe_comm_to_expert7&#45;&gt;layer56_moe_expert7</title>
<path fill="none" stroke="black" d="M2771,-3567.33C2771,-3567.33 2771,-3541.69 2771,-3541.69"/>
<polygon fill="black" stroke="black" points="2774.5,-3541.69 2771,-3531.69 2767.5,-3541.69 2774.5,-3541.69"/>
</g>
<!-- layer56_moe_expert8 -->
<g id="node2783" class="node">
<title>layer56_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3244,-3531.38 2916,-3531.38 2916,-3479.38 3244,-3479.38 3244,-3531.38"/>
<text text-anchor="middle" x="3080" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 8 L56</text>
<text text-anchor="middle" x="3080" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3080" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3080" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert8 -->
<g id="node2808" class="node">
<title>layer56_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3043" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3043" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3043" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3043" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer56_moe_expert8&#45;&gt;layer56_moe_comm_from_expert8 -->
<g id="edge3606" class="edge">
<title>layer56_moe_expert8&#45;&gt;layer56_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3043,-3479.07C3043,-3479.07 3043,-3453.52 3043,-3453.52"/>
<polygon fill="black" stroke="black" points="3046.5,-3453.52 3043,-3443.52 3039.5,-3453.52 3046.5,-3453.52"/>
</g>
<!-- layer56_moe_comm_to_expert8&#45;&gt;layer56_moe_expert8 -->
<g id="edge3575" class="edge">
<title>layer56_moe_comm_to_expert8&#45;&gt;layer56_moe_expert8</title>
<path fill="none" stroke="black" d="M3043,-3567.33C3043,-3567.33 3043,-3541.69 3043,-3541.69"/>
<polygon fill="black" stroke="black" points="3046.5,-3541.69 3043,-3531.69 3039.5,-3541.69 3046.5,-3541.69"/>
</g>
<!-- layer56_moe_expert9 -->
<g id="node2785" class="node">
<title>layer56_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3590,-3531.38 3262,-3531.38 3262,-3479.38 3590,-3479.38 3590,-3531.38"/>
<text text-anchor="middle" x="3426" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 9 L56</text>
<text text-anchor="middle" x="3426" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3426" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3426" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert9 -->
<g id="node2809" class="node">
<title>layer56_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3352" cy="-3414.39" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3352" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3352" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3352" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer56_moe_expert9&#45;&gt;layer56_moe_comm_from_expert9 -->
<g id="edge3608" class="edge">
<title>layer56_moe_expert9&#45;&gt;layer56_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3352.25,-3479.07C3352.25,-3479.07 3352.25,-3453.52 3352.25,-3453.52"/>
<polygon fill="black" stroke="black" points="3355.75,-3453.52 3352.25,-3443.52 3348.75,-3453.52 3355.75,-3453.52"/>
</g>
<!-- layer56_moe_comm_to_expert9&#45;&gt;layer56_moe_expert9 -->
<g id="edge3577" class="edge">
<title>layer56_moe_comm_to_expert9&#45;&gt;layer56_moe_expert9</title>
<path fill="none" stroke="black" d="M3352.25,-3567.33C3352.25,-3567.33 3352.25,-3541.69 3352.25,-3541.69"/>
<polygon fill="black" stroke="black" points="3355.75,-3541.69 3352.25,-3531.69 3348.75,-3541.69 3355.75,-3541.69"/>
</g>
<!-- layer56_moe_expert10 -->
<g id="node2787" class="node">
<title>layer56_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="3946,-3531.38 3608,-3531.38 3608,-3479.38 3946,-3479.38 3946,-3531.38"/>
<text text-anchor="middle" x="3777" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 10 L56</text>
<text text-anchor="middle" x="3777" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3777" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3777" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert10 -->
<g id="node2810" class="node">
<title>layer56_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3684" cy="-3414.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3684" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3684" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3684" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer56_moe_expert10&#45;&gt;layer56_moe_comm_from_expert10 -->
<g id="edge3610" class="edge">
<title>layer56_moe_expert10&#45;&gt;layer56_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3693.38,-3479.07C3693.38,-3479.07 3693.38,-3453.52 3693.38,-3453.52"/>
<polygon fill="black" stroke="black" points="3696.88,-3453.52 3693.38,-3443.52 3689.88,-3453.52 3696.88,-3453.52"/>
</g>
<!-- layer56_moe_comm_to_expert10&#45;&gt;layer56_moe_expert10 -->
<g id="edge3579" class="edge">
<title>layer56_moe_comm_to_expert10&#45;&gt;layer56_moe_expert10</title>
<path fill="none" stroke="black" d="M3693.02,-3567.33C3693.02,-3567.33 3693.02,-3541.69 3693.02,-3541.69"/>
<polygon fill="black" stroke="black" points="3696.52,-3541.69 3693.02,-3531.69 3689.52,-3541.69 3696.52,-3541.69"/>
</g>
<!-- layer56_moe_expert11 -->
<g id="node2789" class="node">
<title>layer56_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4302,-3531.38 3964,-3531.38 3964,-3479.38 4302,-3479.38 4302,-3531.38"/>
<text text-anchor="middle" x="4133" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 11 L56</text>
<text text-anchor="middle" x="4133" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4133" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4133" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert11 -->
<g id="node2811" class="node">
<title>layer56_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="4031" cy="-3414.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4031" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="4031" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4031" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer56_moe_expert11&#45;&gt;layer56_moe_comm_from_expert11 -->
<g id="edge3612" class="edge">
<title>layer56_moe_expert11&#45;&gt;layer56_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4044.88,-3479.07C4044.88,-3479.07 4044.88,-3453.2 4044.88,-3453.2"/>
<polygon fill="black" stroke="black" points="4048.38,-3453.2 4044.88,-3443.2 4041.38,-3453.2 4048.38,-3453.2"/>
</g>
<!-- layer56_moe_comm_to_expert11&#45;&gt;layer56_moe_expert11 -->
<g id="edge3581" class="edge">
<title>layer56_moe_comm_to_expert11&#45;&gt;layer56_moe_expert11</title>
<path fill="none" stroke="black" d="M4044.02,-3567.59C4044.02,-3567.59 4044.02,-3541.52 4044.02,-3541.52"/>
<polygon fill="black" stroke="black" points="4047.52,-3541.52 4044.02,-3531.52 4040.52,-3541.52 4047.52,-3541.52"/>
</g>
<!-- layer56_moe_expert12 -->
<g id="node2791" class="node">
<title>layer56_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4658,-3531.38 4320,-3531.38 4320,-3479.38 4658,-3479.38 4658,-3531.38"/>
<text text-anchor="middle" x="4489" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 12 L56</text>
<text text-anchor="middle" x="4489" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4489" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4489" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert12 -->
<g id="node2812" class="node">
<title>layer56_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4382" cy="-3414.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4382" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4382" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4382" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer56_moe_expert12&#45;&gt;layer56_moe_comm_from_expert12 -->
<g id="edge3614" class="edge">
<title>layer56_moe_expert12&#45;&gt;layer56_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4398.38,-3479.07C4398.38,-3479.07 4398.38,-3453.2 4398.38,-3453.2"/>
<polygon fill="black" stroke="black" points="4401.88,-3453.2 4398.38,-3443.2 4394.88,-3453.2 4401.88,-3453.2"/>
</g>
<!-- layer56_moe_comm_to_expert12&#45;&gt;layer56_moe_expert12 -->
<g id="edge3583" class="edge">
<title>layer56_moe_comm_to_expert12&#45;&gt;layer56_moe_expert12</title>
<path fill="none" stroke="black" d="M4397.52,-3567.59C4397.52,-3567.59 4397.52,-3541.52 4397.52,-3541.52"/>
<polygon fill="black" stroke="black" points="4401.02,-3541.52 4397.52,-3531.52 4394.02,-3541.52 4401.02,-3541.52"/>
</g>
<!-- layer56_moe_expert13 -->
<g id="node2793" class="node">
<title>layer56_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="5014,-3531.38 4676,-3531.38 4676,-3479.38 5014,-3479.38 5014,-3531.38"/>
<text text-anchor="middle" x="4845" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 13 L56</text>
<text text-anchor="middle" x="4845" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4845" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4845" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert13 -->
<g id="node2813" class="node">
<title>layer56_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4736" cy="-3414.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4736" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4736" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4736" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer56_moe_expert13&#45;&gt;layer56_moe_comm_from_expert13 -->
<g id="edge3616" class="edge">
<title>layer56_moe_expert13&#45;&gt;layer56_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4753.38,-3479.07C4753.38,-3479.07 4753.38,-3453.2 4753.38,-3453.2"/>
<polygon fill="black" stroke="black" points="4756.88,-3453.2 4753.38,-3443.2 4749.88,-3453.2 4756.88,-3453.2"/>
</g>
<!-- layer56_moe_comm_to_expert13&#45;&gt;layer56_moe_expert13 -->
<g id="edge3585" class="edge">
<title>layer56_moe_comm_to_expert13&#45;&gt;layer56_moe_expert13</title>
<path fill="none" stroke="black" d="M4752.02,-3567.59C4752.02,-3567.59 4752.02,-3541.52 4752.02,-3541.52"/>
<polygon fill="black" stroke="black" points="4755.52,-3541.52 4752.02,-3531.52 4748.52,-3541.52 4755.52,-3541.52"/>
</g>
<!-- layer56_moe_expert14 -->
<g id="node2795" class="node">
<title>layer56_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5370,-3531.38 5032,-3531.38 5032,-3479.38 5370,-3479.38 5370,-3531.38"/>
<text text-anchor="middle" x="5201" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 14 L56</text>
<text text-anchor="middle" x="5201" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5201" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5201" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert14 -->
<g id="node2814" class="node">
<title>layer56_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5091" cy="-3414.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5091" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5091" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5091" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer56_moe_expert14&#45;&gt;layer56_moe_comm_from_expert14 -->
<g id="edge3618" class="edge">
<title>layer56_moe_expert14&#45;&gt;layer56_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5108.88,-3479.07C5108.88,-3479.07 5108.88,-3452.88 5108.88,-3452.88"/>
<polygon fill="black" stroke="black" points="5112.38,-3452.88 5108.88,-3442.88 5105.38,-3452.88 5112.38,-3452.88"/>
</g>
<!-- layer56_moe_comm_to_expert14&#45;&gt;layer56_moe_expert14 -->
<g id="edge3587" class="edge">
<title>layer56_moe_comm_to_expert14&#45;&gt;layer56_moe_expert14</title>
<path fill="none" stroke="black" d="M5107.52,-3567.59C5107.52,-3567.59 5107.52,-3541.52 5107.52,-3541.52"/>
<polygon fill="black" stroke="black" points="5111.02,-3541.52 5107.52,-3531.52 5104.02,-3541.52 5111.02,-3541.52"/>
</g>
<!-- layer56_moe_expert15 -->
<g id="node2797" class="node">
<title>layer56_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5726,-3531.38 5388,-3531.38 5388,-3479.38 5726,-3479.38 5726,-3531.38"/>
<text text-anchor="middle" x="5557" y="-3519.38" font-family="Arial" font-size="10.00">EXPERT 15 L56</text>
<text text-anchor="middle" x="5557" y="-3508.38" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5557" y="-3497.38" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5557" y="-3486.38" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_comm_from_expert15 -->
<g id="node2815" class="node">
<title>layer56_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5446" cy="-3414.39" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5446" y="-3422.89" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5446" y="-3411.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5446" y="-3400.89" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer56_moe_expert15&#45;&gt;layer56_moe_comm_from_expert15 -->
<g id="edge3620" class="edge">
<title>layer56_moe_expert15&#45;&gt;layer56_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5464.38,-3479.07C5464.38,-3479.07 5464.38,-3452.88 5464.38,-3452.88"/>
<polygon fill="black" stroke="black" points="5467.88,-3452.88 5464.38,-3442.88 5460.88,-3452.88 5467.88,-3452.88"/>
</g>
<!-- layer56_moe_comm_to_expert15&#45;&gt;layer56_moe_expert15 -->
<g id="edge3589" class="edge">
<title>layer56_moe_comm_to_expert15&#45;&gt;layer56_moe_expert15</title>
<path fill="none" stroke="black" d="M5463.02,-3567.59C5463.02,-3567.59 5463.02,-3541.52 5463.02,-3541.52"/>
<polygon fill="black" stroke="black" points="5466.52,-3541.52 5463.02,-3531.52 5459.52,-3541.52 5466.52,-3541.52"/>
</g>
<!-- layer56_moe_aggregate -->
<g id="node2799" class="node">
<title>layer56_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3132.1,-3349.4 2715.16,-3349.4 2607.9,-3245.4 3024.84,-3245.4 3132.1,-3349.4"/>
<text text-anchor="middle" x="2870" y="-3311.4" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L56</text>
<text text-anchor="middle" x="2870" y="-3300.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2870" y="-3289.4" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2870" y="-3278.4" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_mha -->
<g id="node2816" class="node">
<title>layer57_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="3000,-3209.4 2740,-3209.4 2740,-3157.4 3000,-3157.4 3000,-3209.4"/>
<text text-anchor="middle" x="2870" y="-3197.4" font-family="Arial" font-size="10.00">MHA L57</text>
<text text-anchor="middle" x="2870" y="-3186.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2870" y="-3175.4" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2870" y="-3164.4" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer56_moe_aggregate&#45;&gt;layer57_moe_mha -->
<g id="edge3689" class="edge">
<title>layer56_moe_aggregate&#45;&gt;layer57_moe_mha</title>
<path fill="none" stroke="black" d="M2870,-3245.07C2870,-3245.07 2870,-3219.63 2870,-3219.63"/>
<polygon fill="black" stroke="black" points="2873.5,-3219.63 2870,-3209.63 2866.5,-3219.63 2873.5,-3219.63"/>
</g>
<!-- layer56_moe_comm_from_expert0&#45;&gt;layer56_moe_aggregate -->
<g id="edge3591" class="edge">
<title>layer56_moe_comm_from_expert0&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M390,-3387.15C390,-3342.82 390,-3260 390,-3260 390,-3260 2612.86,-3260 2612.86,-3260"/>
<polygon fill="black" stroke="black" points="2612.86,-3263.5 2622.86,-3260 2612.86,-3256.5 2612.86,-3263.5"/>
</g>
<!-- layer56_moe_comm_from_expert1&#45;&gt;layer56_moe_aggregate -->
<g id="edge3593" class="edge">
<title>layer56_moe_comm_from_expert1&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M1155.25,-3403.45C1155.25,-3370.59 1155.25,-3275 1155.25,-3275 1155.25,-3275 2628.3,-3275 2628.3,-3275"/>
<polygon fill="black" stroke="black" points="2628.3,-3278.5 2638.3,-3275 2628.3,-3271.5 2628.3,-3278.5"/>
</g>
<!-- layer56_moe_comm_from_expert2&#45;&gt;layer56_moe_aggregate -->
<g id="edge3595" class="edge">
<title>layer56_moe_comm_from_expert2&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M1500.83,-3386.56C1500.83,-3349.62 1500.83,-3289 1500.83,-3289 1500.83,-3289 2642.67,-3289 2642.67,-3289"/>
<polygon fill="black" stroke="black" points="2642.67,-3292.5 2652.67,-3289 2642.67,-3285.5 2642.67,-3292.5"/>
</g>
<!-- layer56_moe_comm_from_expert3&#45;&gt;layer56_moe_aggregate -->
<g id="edge3597" class="edge">
<title>layer56_moe_comm_from_expert3&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M1902.51,-3389.62C1902.51,-3357.07 1902.51,-3304 1902.51,-3304 1902.51,-3304 2658.07,-3304 2658.07,-3304"/>
<polygon fill="black" stroke="black" points="2658.07,-3307.5 2668.07,-3304 2658.07,-3300.5 2658.07,-3307.5"/>
</g>
<!-- layer56_moe_comm_from_expert4&#45;&gt;layer56_moe_aggregate -->
<g id="edge3599" class="edge">
<title>layer56_moe_comm_from_expert4&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M2146.84,-3386.8C2146.84,-3358.63 2146.84,-3319 2146.84,-3319 2146.84,-3319 2673.77,-3319 2673.77,-3319"/>
<polygon fill="black" stroke="black" points="2673.77,-3322.5 2683.77,-3319 2673.77,-3315.5 2673.77,-3322.5"/>
</g>
<!-- layer56_moe_comm_from_expert5&#45;&gt;layer56_moe_aggregate -->
<g id="edge3601" class="edge">
<title>layer56_moe_comm_from_expert5&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M2405.5,-3391.57C2405.5,-3367.8 2405.5,-3334 2405.5,-3334 2405.5,-3334 2689.02,-3334 2689.02,-3334"/>
<polygon fill="black" stroke="black" points="2689.02,-3337.5 2699.02,-3334 2689.02,-3330.5 2689.02,-3337.5"/>
</g>
<!-- layer56_moe_comm_from_expert6&#45;&gt;layer56_moe_aggregate -->
<g id="edge3603" class="edge">
<title>layer56_moe_comm_from_expert6&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M2631.11,-3394.81C2631.11,-3394.81 2631.11,-3307.45 2631.11,-3307.45"/>
<polygon fill="black" stroke="black" points="2634.61,-3307.45 2631.11,-3297.45 2627.61,-3307.45 2634.61,-3307.45"/>
</g>
<!-- layer56_moe_comm_from_expert7&#45;&gt;layer56_moe_aggregate -->
<g id="edge3605" class="edge">
<title>layer56_moe_comm_from_expert7&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M2771,-3385.17C2771,-3385.17 2771,-3359.46 2771,-3359.46"/>
<polygon fill="black" stroke="black" points="2774.5,-3359.46 2771,-3349.46 2767.5,-3359.46 2774.5,-3359.46"/>
</g>
<!-- layer56_moe_comm_from_expert8&#45;&gt;layer56_moe_aggregate -->
<g id="edge3607" class="edge">
<title>layer56_moe_comm_from_expert8&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M3042.39,-3385.17C3042.39,-3385.17 3042.39,-3359.46 3042.39,-3359.46"/>
<polygon fill="black" stroke="black" points="3045.89,-3359.46 3042.39,-3349.46 3038.89,-3359.46 3045.89,-3359.46"/>
</g>
<!-- layer56_moe_comm_from_expert9&#45;&gt;layer56_moe_aggregate -->
<g id="edge3609" class="edge">
<title>layer56_moe_comm_from_expert9&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M3333.5,-3385.65C3333.5,-3363.27 3333.5,-3336 3333.5,-3336 3333.5,-3336 3128.37,-3336 3128.37,-3336"/>
<polygon fill="black" stroke="black" points="3128.37,-3332.5 3118.37,-3336 3128.37,-3339.5 3128.37,-3332.5"/>
</g>
<!-- layer56_moe_comm_from_expert10&#45;&gt;layer56_moe_aggregate -->
<g id="edge3611" class="edge">
<title>layer56_moe_comm_from_expert10&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M3665.15,-3385.98C3665.15,-3359.15 3665.15,-3323 3665.15,-3323 3665.15,-3323 3115.07,-3323 3115.07,-3323"/>
<polygon fill="black" stroke="black" points="3115.07,-3319.5 3105.07,-3323 3115.07,-3326.5 3115.07,-3319.5"/>
</g>
<!-- layer56_moe_comm_from_expert11&#45;&gt;layer56_moe_aggregate -->
<g id="edge3613" class="edge">
<title>layer56_moe_comm_from_expert11&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M4011.65,-3385.87C4011.65,-3354.96 4011.65,-3310 4011.65,-3310 4011.65,-3310 3101.47,-3310 3101.47,-3310"/>
<polygon fill="black" stroke="black" points="3101.47,-3306.5 3091.47,-3310 3101.47,-3313.5 3101.47,-3306.5"/>
</g>
<!-- layer56_moe_comm_from_expert12&#45;&gt;layer56_moe_aggregate -->
<g id="edge3615" class="edge">
<title>layer56_moe_comm_from_expert12&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M4362.65,-3385.98C4362.65,-3351.23 4362.65,-3297 4362.65,-3297 4362.65,-3297 3088.33,-3297 3088.33,-3297"/>
<polygon fill="black" stroke="black" points="3088.33,-3293.5 3078.33,-3297 3088.33,-3300.5 3088.33,-3293.5"/>
</g>
<!-- layer56_moe_comm_from_expert13&#45;&gt;layer56_moe_aggregate -->
<g id="edge3617" class="edge">
<title>layer56_moe_comm_from_expert13&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M4716.15,-3385.78C4716.15,-3347.39 4716.15,-3284 4716.15,-3284 4716.15,-3284 3074.95,-3284 3074.95,-3284"/>
<polygon fill="black" stroke="black" points="3074.95,-3280.5 3064.95,-3284 3074.95,-3287.5 3074.95,-3280.5"/>
</g>
<!-- layer56_moe_comm_from_expert14&#45;&gt;layer56_moe_aggregate -->
<g id="edge3619" class="edge">
<title>layer56_moe_comm_from_expert14&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M5071.15,-3385.72C5071.15,-3343.87 5071.15,-3271 5071.15,-3271 5071.15,-3271 3061.53,-3271 3061.53,-3271"/>
<polygon fill="black" stroke="black" points="3061.53,-3267.5 3051.53,-3271 3061.53,-3274.5 3061.53,-3267.5"/>
</g>
<!-- layer56_moe_comm_from_expert15&#45;&gt;layer56_moe_aggregate -->
<g id="edge3621" class="edge">
<title>layer56_moe_comm_from_expert15&#45;&gt;layer56_moe_aggregate</title>
<path fill="none" stroke="black" d="M5426.15,-3385.71C5426.15,-3340.56 5426.15,-3258 5426.15,-3258 5426.15,-3258 3048.21,-3258 3048.21,-3258"/>
<polygon fill="black" stroke="black" points="3048.21,-3254.5 3038.21,-3258 3048.21,-3261.5 3048.21,-3254.5"/>
</g>
<!-- layer57_moe_gate -->
<g id="node2817" class="node">
<title>layer57_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3128.3,-3121.4 2717.4,-3121.4 2611.7,-3017.4 3022.6,-3017.4 3128.3,-3121.4"/>
<text text-anchor="middle" x="2870" y="-3083.4" font-family="Arial" font-size="10.00">GATE L57</text>
<text text-anchor="middle" x="2870" y="-3072.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2870" y="-3061.4" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2870" y="-3050.4" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer57_moe_mha&#45;&gt;layer57_moe_gate -->
<g id="edge3690" class="edge">
<title>layer57_moe_mha&#45;&gt;layer57_moe_gate</title>
<path fill="none" stroke="black" d="M2870,-3157.25C2870,-3157.25 2870,-3131.5 2870,-3131.5"/>
<polygon fill="black" stroke="black" points="2873.5,-3131.5 2870,-3121.5 2866.5,-3131.5 2873.5,-3131.5"/>
</g>
<!-- layer57_moe_split -->
<g id="node2818" class="node">
<title>layer57_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3124.01,-2981.4 2719.94,-2981.4 2615.99,-2877.4 3020.06,-2877.4 3124.01,-2981.4"/>
<text text-anchor="middle" x="2870" y="-2943.4" font-family="Arial" font-size="10.00">SPLIT TOKENS L57</text>
<text text-anchor="middle" x="2870" y="-2932.4" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2870" y="-2921.4" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2870" y="-2910.4" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer57_moe_gate&#45;&gt;layer57_moe_split -->
<g id="edge3691" class="edge">
<title>layer57_moe_gate&#45;&gt;layer57_moe_split</title>
<path fill="none" stroke="black" d="M2870,-3017.27C2870,-3017.27 2870,-2991.58 2870,-2991.58"/>
<polygon fill="black" stroke="black" points="2873.5,-2991.58 2870,-2981.58 2866.5,-2991.58 2873.5,-2991.58"/>
</g>
<!-- layer57_moe_comm_to_expert0 -->
<g id="node2820" class="node">
<title>layer57_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="422" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="422" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="422" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="422" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert0 -->
<g id="edge3625" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2704.52,-2966C2166.79,-2966 503.25,-2966 503.25,-2966 503.25,-2966 503.25,-2835.24 503.25,-2835.24"/>
<polygon fill="black" stroke="black" points="506.75,-2835.24 503.25,-2825.24 499.75,-2835.24 506.75,-2835.24"/>
</g>
<!-- layer57_moe_comm_to_expert1 -->
<g id="node2822" class="node">
<title>layer57_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="915" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="915" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="915" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="915" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert1 -->
<g id="edge3627" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2689.17,-2951C2218.75,-2951 993,-2951 993,-2951 993,-2951 993,-2837.24 993,-2837.24"/>
<polygon fill="black" stroke="black" points="996.5,-2837.24 993,-2827.24 989.5,-2837.24 996.5,-2837.24"/>
</g>
<!-- layer57_moe_comm_to_expert2 -->
<g id="node2824" class="node">
<title>layer57_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1261" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1261" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1261" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1261" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert2 -->
<g id="edge3629" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2674.46,-2936C2247.3,-2936 1268.75,-2936 1268.75,-2936 1268.75,-2936 1268.75,-2851.39 1268.75,-2851.39"/>
<polygon fill="black" stroke="black" points="1272.25,-2851.39 1268.75,-2841.39 1265.25,-2851.39 1272.25,-2851.39"/>
</g>
<!-- layer57_moe_comm_to_expert3 -->
<g id="node2826" class="node">
<title>layer57_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1533" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1533" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1533" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1533" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert3 -->
<g id="edge3631" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2659.39,-2921C2288.85,-2921 1559.17,-2921 1559.17,-2921 1559.17,-2921 1559.17,-2850.37 1559.17,-2850.37"/>
<polygon fill="black" stroke="black" points="1562.67,-2850.37 1559.17,-2840.37 1555.67,-2850.37 1562.67,-2850.37"/>
</g>
<!-- layer57_moe_comm_to_expert4 -->
<g id="node2828" class="node">
<title>layer57_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1769" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1769" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="1769" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1769" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert4 -->
<g id="edge3633" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2645.3,-2907C2334.7,-2907 1812,-2907 1812,-2907 1812,-2907 1812,-2848.26 1812,-2848.26"/>
<polygon fill="black" stroke="black" points="1815.5,-2848.26 1812,-2838.26 1808.5,-2848.26 1815.5,-2848.26"/>
</g>
<!-- layer57_moe_comm_to_expert5 -->
<g id="node2830" class="node">
<title>layer57_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2116" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2116" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2116" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2116" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert5 -->
<g id="edge3635" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2630.34,-2892C2400.17,-2892 2087.16,-2892 2087.16,-2892 2087.16,-2892 2087.16,-2850.25 2087.16,-2850.25"/>
<polygon fill="black" stroke="black" points="2090.66,-2850.25 2087.16,-2840.25 2083.66,-2850.25 2090.66,-2850.25"/>
</g>
<!-- layer57_moe_comm_to_expert6 -->
<g id="node2832" class="node">
<title>layer57_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2462" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2462" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2462" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2462" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert6 -->
<g id="edge3637" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2629.74,-2929.32C2629.74,-2925.76 2629.74,-2812 2629.74,-2812 2629.74,-2812 2562.74,-2812 2562.74,-2812"/>
<polygon fill="black" stroke="black" points="2562.74,-2808.5 2552.74,-2812 2562.74,-2815.5 2562.74,-2808.5"/>
</g>
<!-- layer57_moe_comm_to_expert7 -->
<g id="node2834" class="node">
<title>layer57_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2734" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2734" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2734" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2734" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert7 -->
<g id="edge3639" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2734,-2877.06C2734,-2877.06 2734,-2851.62 2734,-2851.62"/>
<polygon fill="black" stroke="black" points="2737.5,-2851.62 2734,-2841.62 2730.5,-2851.62 2737.5,-2851.62"/>
</g>
<!-- layer57_moe_comm_to_expert8 -->
<g id="node2836" class="node">
<title>layer57_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3006" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3006" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="3006" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3006" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert8 -->
<g id="edge3641" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3006,-2877.06C3006,-2877.06 3006,-2851.62 3006,-2851.62"/>
<polygon fill="black" stroke="black" points="3009.5,-2851.62 3006,-2841.62 3002.5,-2851.62 3009.5,-2851.62"/>
</g>
<!-- layer57_moe_comm_to_expert9 -->
<g id="node2838" class="node">
<title>layer57_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3315" cy="-2812.41" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3315" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3315" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3315" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert9 -->
<g id="edge3643" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3110.26,-2929.32C3110.26,-2925.76 3110.26,-2812 3110.26,-2812 3110.26,-2812 3214.3,-2812 3214.3,-2812"/>
<polygon fill="black" stroke="black" points="3214.3,-2815.5 3224.3,-2812 3214.3,-2808.5 3214.3,-2815.5"/>
</g>
<!-- layer57_moe_comm_to_expert10 -->
<g id="node2840" class="node">
<title>layer57_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3647" cy="-2812.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3647" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3647" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3647" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert10 -->
<g id="edge3645" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3034.82,-2892C3242.07,-2892 3571.1,-2892 3571.1,-2892 3571.1,-2892 3571.1,-2839.68 3571.1,-2839.68"/>
<polygon fill="black" stroke="black" points="3574.6,-2839.68 3571.1,-2829.68 3567.6,-2839.68 3574.6,-2839.68"/>
</g>
<!-- layer57_moe_comm_to_expert11 -->
<g id="node2842" class="node">
<title>layer57_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3993" cy="-2812.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3993" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="3993" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3993" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert11 -->
<g id="edge3647" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3049.79,-2907C3349.24,-2907 3917.6,-2907 3917.6,-2907 3917.6,-2907 3917.6,-2839.76 3917.6,-2839.76"/>
<polygon fill="black" stroke="black" points="3921.1,-2839.76 3917.6,-2829.76 3914.1,-2839.76 3921.1,-2839.76"/>
</g>
<!-- layer57_moe_comm_to_expert12 -->
<g id="node2844" class="node">
<title>layer57_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4344" cy="-2812.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4344" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4344" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4344" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert12 -->
<g id="edge3649" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3063.73,-2921C3447.72,-2921 4268.6,-2921 4268.6,-2921 4268.6,-2921 4268.6,-2839.86 4268.6,-2839.86"/>
<polygon fill="black" stroke="black" points="4272.1,-2839.86 4268.6,-2829.86 4265.1,-2839.86 4272.1,-2839.86"/>
</g>
<!-- layer57_moe_comm_to_expert13 -->
<g id="node2846" class="node">
<title>layer57_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4697" cy="-2812.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4697" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4697" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4697" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert13 -->
<g id="edge3651" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3078.74,-2936C3543.33,-2936 4622.1,-2936 4622.1,-2936 4622.1,-2936 4622.1,-2840.12 4622.1,-2840.12"/>
<polygon fill="black" stroke="black" points="4625.6,-2840.12 4622.1,-2830.12 4618.6,-2840.12 4625.6,-2840.12"/>
</g>
<!-- layer57_moe_comm_to_expert14 -->
<g id="node2848" class="node">
<title>layer57_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5052" cy="-2812.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5052" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5052" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5052" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert14 -->
<g id="edge3653" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3094,-2951C3636.61,-2951 4977.1,-2951 4977.1,-2951 4977.1,-2951 4977.1,-2839.96 4977.1,-2839.96"/>
<polygon fill="black" stroke="black" points="4980.6,-2839.96 4977.1,-2829.96 4973.6,-2839.96 4980.6,-2839.96"/>
</g>
<!-- layer57_moe_comm_to_expert15 -->
<g id="node2850" class="node">
<title>layer57_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5407" cy="-2812.41" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5407" y="-2820.91" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5407" y="-2809.91" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5407" y="-2798.91" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert15 -->
<g id="edge3655" class="edge">
<title>layer57_moe_split&#45;&gt;layer57_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3108.87,-2966C3727.18,-2966 5332.1,-2966 5332.1,-2966 5332.1,-2966 5332.1,-2840.03 5332.1,-2840.03"/>
<polygon fill="black" stroke="black" points="5335.6,-2840.03 5332.1,-2830.03 5328.6,-2840.03 5335.6,-2840.03"/>
</g>
<!-- layer57_moe_expert0 -->
<g id="node2819" class="node">
<title>layer57_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="439,-2747.42 111,-2747.42 111,-2695.42 439,-2695.42 439,-2747.42"/>
<text text-anchor="middle" x="275" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 0 L57</text>
<text text-anchor="middle" x="275" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="275" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="275" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert0 -->
<g id="node2852" class="node">
<title>layer57_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="321" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="321" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="321" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="321" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer57_moe_expert0&#45;&gt;layer57_moe_comm_from_expert0 -->
<g id="edge3657" class="edge">
<title>layer57_moe_expert0&#45;&gt;layer57_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M321,-2695.1C321,-2695.1 321,-2669.56 321,-2669.56"/>
<polygon fill="black" stroke="black" points="324.5,-2669.56 321,-2659.56 317.5,-2669.56 324.5,-2669.56"/>
</g>
<!-- layer57_moe_comm_to_expert0&#45;&gt;layer57_moe_expert0 -->
<g id="edge3626" class="edge">
<title>layer57_moe_comm_to_expert0&#45;&gt;layer57_moe_expert0</title>
<path fill="none" stroke="black" d="M385.25,-2785.6C385.25,-2785.6 385.25,-2757.72 385.25,-2757.72"/>
<polygon fill="black" stroke="black" points="388.75,-2757.72 385.25,-2747.72 381.75,-2757.72 388.75,-2757.72"/>
</g>
<!-- layer57_moe_expert1 -->
<g id="node2821" class="node">
<title>layer57_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="785,-2747.42 457,-2747.42 457,-2695.42 785,-2695.42 785,-2747.42"/>
<text text-anchor="middle" x="621" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 1 L57</text>
<text text-anchor="middle" x="621" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="621" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="621" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert1 -->
<g id="node2853" class="node">
<title>layer57_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="1034" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1034" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="1034" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1034" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer57_moe_expert1&#45;&gt;layer57_moe_comm_from_expert1 -->
<g id="edge3659" class="edge">
<title>layer57_moe_expert1&#45;&gt;layer57_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M723.25,-2694.98C723.25,-2667.98 723.25,-2630 723.25,-2630 723.25,-2630 933.28,-2630 933.28,-2630"/>
<polygon fill="black" stroke="black" points="933.28,-2633.5 943.28,-2630 933.28,-2626.5 933.28,-2633.5"/>
</g>
<!-- layer57_moe_comm_to_expert1&#45;&gt;layer57_moe_expert1 -->
<g id="edge3628" class="edge">
<title>layer57_moe_comm_to_expert1&#45;&gt;layer57_moe_expert1</title>
<path fill="none" stroke="black" d="M824.49,-2812C747.31,-2812 648.75,-2812 648.75,-2812 648.75,-2812 648.75,-2757.62 648.75,-2757.62"/>
<polygon fill="black" stroke="black" points="652.25,-2757.62 648.75,-2747.62 645.25,-2757.62 652.25,-2757.62"/>
</g>
<!-- layer57_moe_expert2 -->
<g id="node2823" class="node">
<title>layer57_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1131,-2747.42 803,-2747.42 803,-2695.42 1131,-2695.42 1131,-2747.42"/>
<text text-anchor="middle" x="967" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 2 L57</text>
<text text-anchor="middle" x="967" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="967" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="967" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert2 -->
<g id="node2854" class="node">
<title>layer57_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1490" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1490" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1490" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1490" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer57_moe_expert2&#45;&gt;layer57_moe_comm_from_expert2 -->
<g id="edge3661" class="edge">
<title>layer57_moe_expert2&#45;&gt;layer57_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1131.18,-2721C1136.77,-2721 1140,-2721 1140,-2721 1140,-2721 1140,-2630 1140,-2630 1140,-2630 1389.41,-2630 1389.41,-2630"/>
<polygon fill="black" stroke="black" points="1389.41,-2633.5 1399.41,-2630 1389.41,-2626.5 1389.41,-2633.5"/>
</g>
<!-- layer57_moe_comm_to_expert2&#45;&gt;layer57_moe_expert2 -->
<g id="edge3630" class="edge">
<title>layer57_moe_comm_to_expert2&#45;&gt;layer57_moe_expert2</title>
<path fill="none" stroke="black" d="M1170.27,-2812C1120.28,-2812 1068.25,-2812 1068.25,-2812 1068.25,-2812 1068.25,-2757.62 1068.25,-2757.62"/>
<polygon fill="black" stroke="black" points="1071.75,-2757.62 1068.25,-2747.62 1064.75,-2757.62 1071.75,-2757.62"/>
</g>
<!-- layer57_moe_expert3 -->
<g id="node2825" class="node">
<title>layer57_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1477,-2747.42 1149,-2747.42 1149,-2695.42 1477,-2695.42 1477,-2747.42"/>
<text text-anchor="middle" x="1313" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 3 L57</text>
<text text-anchor="middle" x="1313" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1313" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1313" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert3 -->
<g id="node2855" class="node">
<title>layer57_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1818" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1818" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1818" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1818" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer57_moe_expert3&#45;&gt;layer57_moe_comm_from_expert3 -->
<g id="edge3663" class="edge">
<title>layer57_moe_expert3&#45;&gt;layer57_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1438.25,-2695.32C1438.25,-2683.02 1438.25,-2671 1438.25,-2671 1438.25,-2671 1759.33,-2671 1759.33,-2671 1759.33,-2671 1759.33,-2662.61 1759.33,-2662.61"/>
<polygon fill="black" stroke="black" points="1762.83,-2662.61 1759.33,-2652.61 1755.83,-2662.61 1762.83,-2662.61"/>
</g>
<!-- layer57_moe_comm_to_expert3&#45;&gt;layer57_moe_expert3 -->
<g id="edge3632" class="edge">
<title>layer57_moe_comm_to_expert3&#45;&gt;layer57_moe_expert3</title>
<path fill="none" stroke="black" d="M1459.75,-2795.29C1459.75,-2795.29 1459.75,-2757.76 1459.75,-2757.76"/>
<polygon fill="black" stroke="black" points="1463.25,-2757.76 1459.75,-2747.76 1456.25,-2757.76 1463.25,-2757.76"/>
</g>
<!-- layer57_moe_expert4 -->
<g id="node2827" class="node">
<title>layer57_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1823,-2747.42 1495,-2747.42 1495,-2695.42 1823,-2695.42 1823,-2747.42"/>
<text text-anchor="middle" x="1659" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 4 L57</text>
<text text-anchor="middle" x="1659" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1659" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1659" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert4 -->
<g id="node2856" class="node">
<title>layer57_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2081" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2081" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2081" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2081" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer57_moe_expert4&#45;&gt;layer57_moe_comm_from_expert4 -->
<g id="edge3665" class="edge">
<title>layer57_moe_expert4&#45;&gt;layer57_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1791.16,-2695.16C1791.16,-2688.4 1791.16,-2683 1791.16,-2683 1791.16,-2683 2079.75,-2683 2079.75,-2683 2079.75,-2683 2079.75,-2669.48 2079.75,-2669.48"/>
<polygon fill="black" stroke="black" points="2083.25,-2669.48 2079.75,-2659.48 2076.25,-2669.48 2083.25,-2669.48"/>
</g>
<!-- layer57_moe_comm_to_expert4&#45;&gt;layer57_moe_expert4 -->
<g id="edge3634" class="edge">
<title>layer57_moe_comm_to_expert4&#45;&gt;layer57_moe_expert4</title>
<path fill="none" stroke="black" d="M1750.75,-2783.62C1750.75,-2783.62 1750.75,-2757.55 1750.75,-2757.55"/>
<polygon fill="black" stroke="black" points="1754.25,-2757.55 1750.75,-2747.55 1747.25,-2757.55 1754.25,-2757.55"/>
</g>
<!-- layer57_moe_expert5 -->
<g id="node2829" class="node">
<title>layer57_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2169,-2747.42 1841,-2747.42 1841,-2695.42 2169,-2695.42 2169,-2747.42"/>
<text text-anchor="middle" x="2005" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 5 L57</text>
<text text-anchor="middle" x="2005" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2005" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="2005" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert5 -->
<g id="node2857" class="node">
<title>layer57_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2312" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2312" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2312" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2312" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer57_moe_expert5&#45;&gt;layer57_moe_comm_from_expert5 -->
<g id="edge3667" class="edge">
<title>layer57_moe_expert5&#45;&gt;layer57_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2169.18,-2721C2174.77,-2721 2178,-2721 2178,-2721 2178,-2721 2178,-2630 2178,-2630 2178,-2630 2211.14,-2630 2211.14,-2630"/>
<polygon fill="black" stroke="black" points="2211.14,-2633.5 2221.14,-2630 2211.14,-2626.5 2211.14,-2633.5"/>
</g>
<!-- layer57_moe_comm_to_expert5&#45;&gt;layer57_moe_expert5 -->
<g id="edge3636" class="edge">
<title>layer57_moe_comm_to_expert5&#45;&gt;layer57_moe_expert5</title>
<path fill="none" stroke="black" d="M2097.25,-2783.62C2097.25,-2783.62 2097.25,-2757.55 2097.25,-2757.55"/>
<polygon fill="black" stroke="black" points="2100.75,-2757.55 2097.25,-2747.55 2093.75,-2757.55 2100.75,-2757.55"/>
</g>
<!-- layer57_moe_expert6 -->
<g id="node2831" class="node">
<title>layer57_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2515,-2747.42 2187,-2747.42 2187,-2695.42 2515,-2695.42 2515,-2747.42"/>
<text text-anchor="middle" x="2351" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 6 L57</text>
<text text-anchor="middle" x="2351" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2351" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2351" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert6 -->
<g id="node2858" class="node">
<title>layer57_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2527" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2527" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2527" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2527" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer57_moe_expert6&#45;&gt;layer57_moe_comm_from_expert6 -->
<g id="edge3669" class="edge">
<title>layer57_moe_expert6&#45;&gt;layer57_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2475.75,-2695.1C2475.75,-2695.1 2475.75,-2664.51 2475.75,-2664.51"/>
<polygon fill="black" stroke="black" points="2479.25,-2664.51 2475.75,-2654.51 2472.25,-2664.51 2479.25,-2664.51"/>
</g>
<!-- layer57_moe_comm_to_expert6&#45;&gt;layer57_moe_expert6 -->
<g id="edge3638" class="edge">
<title>layer57_moe_comm_to_expert6&#45;&gt;layer57_moe_expert6</title>
<path fill="none" stroke="black" d="M2443.25,-2783.62C2443.25,-2783.62 2443.25,-2757.55 2443.25,-2757.55"/>
<polygon fill="black" stroke="black" points="2446.75,-2757.55 2443.25,-2747.55 2439.75,-2757.55 2446.75,-2757.55"/>
</g>
<!-- layer57_moe_expert7 -->
<g id="node2833" class="node">
<title>layer57_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2861,-2747.42 2533,-2747.42 2533,-2695.42 2861,-2695.42 2861,-2747.42"/>
<text text-anchor="middle" x="2697" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 7 L57</text>
<text text-anchor="middle" x="2697" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2697" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2697" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert7 -->
<g id="node2859" class="node">
<title>layer57_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2734" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2734" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2734" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2734" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer57_moe_expert7&#45;&gt;layer57_moe_comm_from_expert7 -->
<g id="edge3671" class="edge">
<title>layer57_moe_expert7&#45;&gt;layer57_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2734,-2695.1C2734,-2695.1 2734,-2669.56 2734,-2669.56"/>
<polygon fill="black" stroke="black" points="2737.5,-2669.56 2734,-2659.56 2730.5,-2669.56 2737.5,-2669.56"/>
</g>
<!-- layer57_moe_comm_to_expert7&#45;&gt;layer57_moe_expert7 -->
<g id="edge3640" class="edge">
<title>layer57_moe_comm_to_expert7&#45;&gt;layer57_moe_expert7</title>
<path fill="none" stroke="black" d="M2734,-2783.37C2734,-2783.37 2734,-2757.72 2734,-2757.72"/>
<polygon fill="black" stroke="black" points="2737.5,-2757.72 2734,-2747.72 2730.5,-2757.72 2737.5,-2757.72"/>
</g>
<!-- layer57_moe_expert8 -->
<g id="node2835" class="node">
<title>layer57_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3207,-2747.42 2879,-2747.42 2879,-2695.42 3207,-2695.42 3207,-2747.42"/>
<text text-anchor="middle" x="3043" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 8 L57</text>
<text text-anchor="middle" x="3043" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3043" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3043" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert8 -->
<g id="node2860" class="node">
<title>layer57_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="3006" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3006" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="3006" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3006" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer57_moe_expert8&#45;&gt;layer57_moe_comm_from_expert8 -->
<g id="edge3673" class="edge">
<title>layer57_moe_expert8&#45;&gt;layer57_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M3006,-2695.1C3006,-2695.1 3006,-2669.56 3006,-2669.56"/>
<polygon fill="black" stroke="black" points="3009.5,-2669.56 3006,-2659.56 3002.5,-2669.56 3009.5,-2669.56"/>
</g>
<!-- layer57_moe_comm_to_expert8&#45;&gt;layer57_moe_expert8 -->
<g id="edge3642" class="edge">
<title>layer57_moe_comm_to_expert8&#45;&gt;layer57_moe_expert8</title>
<path fill="none" stroke="black" d="M3006,-2783.37C3006,-2783.37 3006,-2757.72 3006,-2757.72"/>
<polygon fill="black" stroke="black" points="3009.5,-2757.72 3006,-2747.72 3002.5,-2757.72 3009.5,-2757.72"/>
</g>
<!-- layer57_moe_expert9 -->
<g id="node2837" class="node">
<title>layer57_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3553,-2747.42 3225,-2747.42 3225,-2695.42 3553,-2695.42 3553,-2747.42"/>
<text text-anchor="middle" x="3389" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 9 L57</text>
<text text-anchor="middle" x="3389" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3389" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3389" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert9 -->
<g id="node2861" class="node">
<title>layer57_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3315" cy="-2630.43" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3315" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3315" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3315" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer57_moe_expert9&#45;&gt;layer57_moe_comm_from_expert9 -->
<g id="edge3675" class="edge">
<title>layer57_moe_expert9&#45;&gt;layer57_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3315.25,-2695.1C3315.25,-2695.1 3315.25,-2669.56 3315.25,-2669.56"/>
<polygon fill="black" stroke="black" points="3318.75,-2669.56 3315.25,-2659.56 3311.75,-2669.56 3318.75,-2669.56"/>
</g>
<!-- layer57_moe_comm_to_expert9&#45;&gt;layer57_moe_expert9 -->
<g id="edge3644" class="edge">
<title>layer57_moe_comm_to_expert9&#45;&gt;layer57_moe_expert9</title>
<path fill="none" stroke="black" d="M3315.25,-2783.37C3315.25,-2783.37 3315.25,-2757.72 3315.25,-2757.72"/>
<polygon fill="black" stroke="black" points="3318.75,-2757.72 3315.25,-2747.72 3311.75,-2757.72 3318.75,-2757.72"/>
</g>
<!-- layer57_moe_expert10 -->
<g id="node2839" class="node">
<title>layer57_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="3909,-2747.42 3571,-2747.42 3571,-2695.42 3909,-2695.42 3909,-2747.42"/>
<text text-anchor="middle" x="3740" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 10 L57</text>
<text text-anchor="middle" x="3740" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3740" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3740" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert10 -->
<g id="node2862" class="node">
<title>layer57_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3647" cy="-2630.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3647" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3647" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3647" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer57_moe_expert10&#45;&gt;layer57_moe_comm_from_expert10 -->
<g id="edge3677" class="edge">
<title>layer57_moe_expert10&#45;&gt;layer57_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3656.38,-2695.1C3656.38,-2695.1 3656.38,-2669.56 3656.38,-2669.56"/>
<polygon fill="black" stroke="black" points="3659.88,-2669.56 3656.38,-2659.56 3652.88,-2669.56 3659.88,-2669.56"/>
</g>
<!-- layer57_moe_comm_to_expert10&#45;&gt;layer57_moe_expert10 -->
<g id="edge3646" class="edge">
<title>layer57_moe_comm_to_expert10&#45;&gt;layer57_moe_expert10</title>
<path fill="none" stroke="black" d="M3656.02,-2783.37C3656.02,-2783.37 3656.02,-2757.72 3656.02,-2757.72"/>
<polygon fill="black" stroke="black" points="3659.52,-2757.72 3656.02,-2747.72 3652.52,-2757.72 3659.52,-2757.72"/>
</g>
<!-- layer57_moe_expert11 -->
<g id="node2841" class="node">
<title>layer57_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4265,-2747.42 3927,-2747.42 3927,-2695.42 4265,-2695.42 4265,-2747.42"/>
<text text-anchor="middle" x="4096" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 11 L57</text>
<text text-anchor="middle" x="4096" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4096" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4096" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert11 -->
<g id="node2863" class="node">
<title>layer57_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="3994" cy="-2630.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3994" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="3994" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3994" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer57_moe_expert11&#45;&gt;layer57_moe_comm_from_expert11 -->
<g id="edge3679" class="edge">
<title>layer57_moe_expert11&#45;&gt;layer57_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M4007.88,-2695.1C4007.88,-2695.1 4007.88,-2669.23 4007.88,-2669.23"/>
<polygon fill="black" stroke="black" points="4011.38,-2669.23 4007.88,-2659.23 4004.38,-2669.23 4011.38,-2669.23"/>
</g>
<!-- layer57_moe_comm_to_expert11&#45;&gt;layer57_moe_expert11 -->
<g id="edge3648" class="edge">
<title>layer57_moe_comm_to_expert11&#45;&gt;layer57_moe_expert11</title>
<path fill="none" stroke="black" d="M4007.02,-2783.62C4007.02,-2783.62 4007.02,-2757.55 4007.02,-2757.55"/>
<polygon fill="black" stroke="black" points="4010.52,-2757.55 4007.02,-2747.55 4003.52,-2757.55 4010.52,-2757.55"/>
</g>
<!-- layer57_moe_expert12 -->
<g id="node2843" class="node">
<title>layer57_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4621,-2747.42 4283,-2747.42 4283,-2695.42 4621,-2695.42 4621,-2747.42"/>
<text text-anchor="middle" x="4452" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 12 L57</text>
<text text-anchor="middle" x="4452" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4452" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4452" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert12 -->
<g id="node2864" class="node">
<title>layer57_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4345" cy="-2630.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4345" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4345" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4345" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer57_moe_expert12&#45;&gt;layer57_moe_comm_from_expert12 -->
<g id="edge3681" class="edge">
<title>layer57_moe_expert12&#45;&gt;layer57_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4361.38,-2695.1C4361.38,-2695.1 4361.38,-2669.23 4361.38,-2669.23"/>
<polygon fill="black" stroke="black" points="4364.88,-2669.23 4361.38,-2659.23 4357.88,-2669.23 4364.88,-2669.23"/>
</g>
<!-- layer57_moe_comm_to_expert12&#45;&gt;layer57_moe_expert12 -->
<g id="edge3650" class="edge">
<title>layer57_moe_comm_to_expert12&#45;&gt;layer57_moe_expert12</title>
<path fill="none" stroke="black" d="M4360.52,-2783.62C4360.52,-2783.62 4360.52,-2757.55 4360.52,-2757.55"/>
<polygon fill="black" stroke="black" points="4364.02,-2757.55 4360.52,-2747.55 4357.02,-2757.55 4364.02,-2757.55"/>
</g>
<!-- layer57_moe_expert13 -->
<g id="node2845" class="node">
<title>layer57_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="4977,-2747.42 4639,-2747.42 4639,-2695.42 4977,-2695.42 4977,-2747.42"/>
<text text-anchor="middle" x="4808" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 13 L57</text>
<text text-anchor="middle" x="4808" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4808" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4808" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert13 -->
<g id="node2865" class="node">
<title>layer57_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4699" cy="-2630.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4699" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4699" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4699" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer57_moe_expert13&#45;&gt;layer57_moe_comm_from_expert13 -->
<g id="edge3683" class="edge">
<title>layer57_moe_expert13&#45;&gt;layer57_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4716.38,-2695.1C4716.38,-2695.1 4716.38,-2669.23 4716.38,-2669.23"/>
<polygon fill="black" stroke="black" points="4719.88,-2669.23 4716.38,-2659.23 4712.88,-2669.23 4719.88,-2669.23"/>
</g>
<!-- layer57_moe_comm_to_expert13&#45;&gt;layer57_moe_expert13 -->
<g id="edge3652" class="edge">
<title>layer57_moe_comm_to_expert13&#45;&gt;layer57_moe_expert13</title>
<path fill="none" stroke="black" d="M4715.02,-2783.62C4715.02,-2783.62 4715.02,-2757.55 4715.02,-2757.55"/>
<polygon fill="black" stroke="black" points="4718.52,-2757.55 4715.02,-2747.55 4711.52,-2757.55 4718.52,-2757.55"/>
</g>
<!-- layer57_moe_expert14 -->
<g id="node2847" class="node">
<title>layer57_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5333,-2747.42 4995,-2747.42 4995,-2695.42 5333,-2695.42 5333,-2747.42"/>
<text text-anchor="middle" x="5164" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 14 L57</text>
<text text-anchor="middle" x="5164" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5164" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5164" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert14 -->
<g id="node2866" class="node">
<title>layer57_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5054" cy="-2630.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5054" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5054" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5054" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer57_moe_expert14&#45;&gt;layer57_moe_comm_from_expert14 -->
<g id="edge3685" class="edge">
<title>layer57_moe_expert14&#45;&gt;layer57_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5071.88,-2695.1C5071.88,-2695.1 5071.88,-2668.91 5071.88,-2668.91"/>
<polygon fill="black" stroke="black" points="5075.38,-2668.91 5071.88,-2658.91 5068.38,-2668.91 5075.38,-2668.91"/>
</g>
<!-- layer57_moe_comm_to_expert14&#45;&gt;layer57_moe_expert14 -->
<g id="edge3654" class="edge">
<title>layer57_moe_comm_to_expert14&#45;&gt;layer57_moe_expert14</title>
<path fill="none" stroke="black" d="M5070.52,-2783.62C5070.52,-2783.62 5070.52,-2757.55 5070.52,-2757.55"/>
<polygon fill="black" stroke="black" points="5074.02,-2757.55 5070.52,-2747.55 5067.02,-2757.55 5074.02,-2757.55"/>
</g>
<!-- layer57_moe_expert15 -->
<g id="node2849" class="node">
<title>layer57_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5689,-2747.42 5351,-2747.42 5351,-2695.42 5689,-2695.42 5689,-2747.42"/>
<text text-anchor="middle" x="5520" y="-2735.42" font-family="Arial" font-size="10.00">EXPERT 15 L57</text>
<text text-anchor="middle" x="5520" y="-2724.42" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5520" y="-2713.42" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5520" y="-2702.42" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_comm_from_expert15 -->
<g id="node2867" class="node">
<title>layer57_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5409" cy="-2630.43" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5409" y="-2638.93" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5409" y="-2627.93" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5409" y="-2616.93" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer57_moe_expert15&#45;&gt;layer57_moe_comm_from_expert15 -->
<g id="edge3687" class="edge">
<title>layer57_moe_expert15&#45;&gt;layer57_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5427.38,-2695.1C5427.38,-2695.1 5427.38,-2668.91 5427.38,-2668.91"/>
<polygon fill="black" stroke="black" points="5430.88,-2668.91 5427.38,-2658.91 5423.88,-2668.91 5430.88,-2668.91"/>
</g>
<!-- layer57_moe_comm_to_expert15&#45;&gt;layer57_moe_expert15 -->
<g id="edge3656" class="edge">
<title>layer57_moe_comm_to_expert15&#45;&gt;layer57_moe_expert15</title>
<path fill="none" stroke="black" d="M5426.02,-2783.62C5426.02,-2783.62 5426.02,-2757.55 5426.02,-2757.55"/>
<polygon fill="black" stroke="black" points="5429.52,-2757.55 5426.02,-2747.55 5422.52,-2757.55 5429.52,-2757.55"/>
</g>
<!-- layer57_moe_aggregate -->
<g id="node2851" class="node">
<title>layer57_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3095.1,-2565.44 2678.16,-2565.44 2570.9,-2461.44 2987.84,-2461.44 3095.1,-2565.44"/>
<text text-anchor="middle" x="2833" y="-2527.44" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L57</text>
<text text-anchor="middle" x="2833" y="-2516.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2833" y="-2505.44" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2833" y="-2494.44" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_mha -->
<g id="node2868" class="node">
<title>layer58_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="2963,-2425.44 2703,-2425.44 2703,-2373.44 2963,-2373.44 2963,-2425.44"/>
<text text-anchor="middle" x="2833" y="-2413.44" font-family="Arial" font-size="10.00">MHA L58</text>
<text text-anchor="middle" x="2833" y="-2402.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2833" y="-2391.44" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2833" y="-2380.44" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer57_moe_aggregate&#45;&gt;layer58_moe_mha -->
<g id="edge3756" class="edge">
<title>layer57_moe_aggregate&#45;&gt;layer58_moe_mha</title>
<path fill="none" stroke="black" d="M2833,-2461.11C2833,-2461.11 2833,-2435.66 2833,-2435.66"/>
<polygon fill="black" stroke="black" points="2836.5,-2435.66 2833,-2425.66 2829.5,-2435.66 2836.5,-2435.66"/>
</g>
<!-- layer57_moe_comm_from_expert0&#45;&gt;layer57_moe_aggregate -->
<g id="edge3658" class="edge">
<title>layer57_moe_comm_from_expert0&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M406.75,-2620.77C406.75,-2586.96 406.75,-2476 406.75,-2476 406.75,-2476 2575.88,-2476 2575.88,-2476"/>
<polygon fill="black" stroke="black" points="2575.88,-2479.5 2585.88,-2476 2575.88,-2472.5 2575.88,-2479.5"/>
</g>
<!-- layer57_moe_comm_from_expert1&#45;&gt;layer57_moe_aggregate -->
<g id="edge3660" class="edge">
<title>layer57_moe_comm_from_expert1&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M1118.25,-2619.49C1118.25,-2586.62 1118.25,-2491 1118.25,-2491 1118.25,-2491 2591.3,-2491 2591.3,-2491"/>
<polygon fill="black" stroke="black" points="2591.3,-2494.5 2601.3,-2491 2591.3,-2487.5 2591.3,-2494.5"/>
</g>
<!-- layer57_moe_comm_from_expert2&#45;&gt;layer57_moe_aggregate -->
<g id="edge3662" class="edge">
<title>layer57_moe_comm_from_expert2&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M1562.01,-2612.6C1562.01,-2578.19 1562.01,-2506 1562.01,-2506 1562.01,-2506 2606.67,-2506 2606.67,-2506"/>
<polygon fill="black" stroke="black" points="2606.67,-2509.5 2616.67,-2506 2606.67,-2502.5 2606.67,-2509.5"/>
</g>
<!-- layer57_moe_comm_from_expert3&#45;&gt;layer57_moe_aggregate -->
<g id="edge3664" class="edge">
<title>layer57_moe_comm_from_expert3&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M1890.01,-2612.69C1890.01,-2581.47 1890.01,-2520 1890.01,-2520 1890.01,-2520 2621.28,-2520 2621.28,-2520"/>
<polygon fill="black" stroke="black" points="2621.28,-2523.5 2631.28,-2520 2621.28,-2516.5 2621.28,-2523.5"/>
</g>
<!-- layer57_moe_comm_from_expert4&#45;&gt;layer57_moe_aggregate -->
<g id="edge3666" class="edge">
<title>layer57_moe_comm_from_expert4&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M2160.75,-2616.35C2160.75,-2589.8 2160.75,-2535 2160.75,-2535 2160.75,-2535 2636.63,-2535 2636.63,-2535"/>
<polygon fill="black" stroke="black" points="2636.64,-2538.5 2646.63,-2535 2636.63,-2531.5 2636.64,-2538.5"/>
</g>
<!-- layer57_moe_comm_from_expert5&#45;&gt;layer57_moe_aggregate -->
<g id="edge3668" class="edge">
<title>layer57_moe_comm_from_expert5&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M2382.5,-2612.18C2382.5,-2588.45 2382.5,-2550 2382.5,-2550 2382.5,-2550 2652.04,-2550 2652.04,-2550"/>
<polygon fill="black" stroke="black" points="2652.04,-2553.5 2662.04,-2550 2652.04,-2546.5 2652.04,-2553.5"/>
</g>
<!-- layer57_moe_comm_from_expert6&#45;&gt;layer57_moe_aggregate -->
<g id="edge3670" class="edge">
<title>layer57_moe_comm_from_expert6&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M2594.11,-2610.85C2594.11,-2610.85 2594.11,-2523.48 2594.11,-2523.48"/>
<polygon fill="black" stroke="black" points="2597.61,-2523.48 2594.11,-2513.48 2590.61,-2523.48 2597.61,-2523.48"/>
</g>
<!-- layer57_moe_comm_from_expert7&#45;&gt;layer57_moe_aggregate -->
<g id="edge3672" class="edge">
<title>layer57_moe_comm_from_expert7&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M2734,-2601.21C2734,-2601.21 2734,-2575.49 2734,-2575.49"/>
<polygon fill="black" stroke="black" points="2737.5,-2575.49 2734,-2565.49 2730.5,-2575.5 2737.5,-2575.49"/>
</g>
<!-- layer57_moe_comm_from_expert8&#45;&gt;layer57_moe_aggregate -->
<g id="edge3674" class="edge">
<title>layer57_moe_comm_from_expert8&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M3005.39,-2601.21C3005.39,-2601.21 3005.39,-2575.49 3005.39,-2575.49"/>
<polygon fill="black" stroke="black" points="3008.89,-2575.49 3005.39,-2565.49 3001.89,-2575.5 3008.89,-2575.49"/>
</g>
<!-- layer57_moe_comm_from_expert9&#45;&gt;layer57_moe_aggregate -->
<g id="edge3676" class="edge">
<title>layer57_moe_comm_from_expert9&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M3296.5,-2601.67C3296.5,-2579.29 3296.5,-2552 3296.5,-2552 3296.5,-2552 3091.37,-2552 3091.37,-2552"/>
<polygon fill="black" stroke="black" points="3091.37,-2548.5 3081.37,-2552 3091.37,-2555.5 3091.37,-2548.5"/>
</g>
<!-- layer57_moe_comm_from_expert10&#45;&gt;layer57_moe_aggregate -->
<g id="edge3678" class="edge">
<title>layer57_moe_comm_from_expert10&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M3628.15,-2602C3628.15,-2575.16 3628.15,-2539 3628.15,-2539 3628.15,-2539 3078.07,-2539 3078.07,-2539"/>
<polygon fill="black" stroke="black" points="3078.07,-2535.5 3068.07,-2539 3078.07,-2542.5 3078.07,-2535.5"/>
</g>
<!-- layer57_moe_comm_from_expert11&#45;&gt;layer57_moe_aggregate -->
<g id="edge3680" class="edge">
<title>layer57_moe_comm_from_expert11&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M3974.65,-2601.89C3974.65,-2570.97 3974.65,-2526 3974.65,-2526 3974.65,-2526 3064.47,-2526 3064.47,-2526"/>
<polygon fill="black" stroke="black" points="3064.47,-2522.5 3054.47,-2526 3064.47,-2529.5 3064.47,-2522.5"/>
</g>
<!-- layer57_moe_comm_from_expert12&#45;&gt;layer57_moe_aggregate -->
<g id="edge3682" class="edge">
<title>layer57_moe_comm_from_expert12&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M4325.65,-2602C4325.65,-2567.25 4325.65,-2513 4325.65,-2513 4325.65,-2513 3051.33,-2513 3051.33,-2513"/>
<polygon fill="black" stroke="black" points="3051.33,-2509.5 3041.33,-2513 3051.33,-2516.5 3051.33,-2509.5"/>
</g>
<!-- layer57_moe_comm_from_expert13&#45;&gt;layer57_moe_aggregate -->
<g id="edge3684" class="edge">
<title>layer57_moe_comm_from_expert13&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M4679.15,-2601.8C4679.15,-2563.41 4679.15,-2500 4679.15,-2500 4679.15,-2500 3037.95,-2500 3037.95,-2500"/>
<polygon fill="black" stroke="black" points="3037.95,-2496.5 3027.95,-2500 3037.95,-2503.5 3037.95,-2496.5"/>
</g>
<!-- layer57_moe_comm_from_expert14&#45;&gt;layer57_moe_aggregate -->
<g id="edge3686" class="edge">
<title>layer57_moe_comm_from_expert14&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M5034.15,-2601.75C5034.15,-2559.89 5034.15,-2487 5034.15,-2487 5034.15,-2487 3024.53,-2487 3024.53,-2487"/>
<polygon fill="black" stroke="black" points="3024.53,-2483.5 3014.53,-2487 3024.53,-2490.5 3024.53,-2483.5"/>
</g>
<!-- layer57_moe_comm_from_expert15&#45;&gt;layer57_moe_aggregate -->
<g id="edge3688" class="edge">
<title>layer57_moe_comm_from_expert15&#45;&gt;layer57_moe_aggregate</title>
<path fill="none" stroke="black" d="M5389.15,-2601.74C5389.15,-2556.58 5389.15,-2474 5389.15,-2474 5389.15,-2474 3011.21,-2474 3011.21,-2474"/>
<polygon fill="black" stroke="black" points="3011.21,-2470.5 3001.21,-2474 3011.21,-2477.5 3011.21,-2470.5"/>
</g>
<!-- layer58_moe_gate -->
<g id="node2869" class="node">
<title>layer58_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3091.3,-2337.44 2680.4,-2337.44 2574.7,-2233.44 2985.6,-2233.44 3091.3,-2337.44"/>
<text text-anchor="middle" x="2833" y="-2299.44" font-family="Arial" font-size="10.00">GATE L58</text>
<text text-anchor="middle" x="2833" y="-2288.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2833" y="-2277.44" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2833" y="-2266.44" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer58_moe_mha&#45;&gt;layer58_moe_gate -->
<g id="edge3757" class="edge">
<title>layer58_moe_mha&#45;&gt;layer58_moe_gate</title>
<path fill="none" stroke="black" d="M2833,-2373.28C2833,-2373.28 2833,-2347.53 2833,-2347.53"/>
<polygon fill="black" stroke="black" points="2836.5,-2347.53 2833,-2337.53 2829.5,-2347.53 2836.5,-2347.53"/>
</g>
<!-- layer58_moe_split -->
<g id="node2870" class="node">
<title>layer58_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3087.01,-2197.44 2682.94,-2197.44 2578.99,-2093.44 2983.06,-2093.44 3087.01,-2197.44"/>
<text text-anchor="middle" x="2833" y="-2159.44" font-family="Arial" font-size="10.00">SPLIT TOKENS L58</text>
<text text-anchor="middle" x="2833" y="-2148.44" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2833" y="-2137.44" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2833" y="-2126.44" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer58_moe_gate&#45;&gt;layer58_moe_split -->
<g id="edge3758" class="edge">
<title>layer58_moe_gate&#45;&gt;layer58_moe_split</title>
<path fill="none" stroke="black" d="M2833,-2233.3C2833,-2233.3 2833,-2207.61 2833,-2207.61"/>
<polygon fill="black" stroke="black" points="2836.5,-2207.61 2833,-2197.61 2829.5,-2207.61 2836.5,-2207.61"/>
</g>
<!-- layer58_moe_comm_to_expert0 -->
<g id="node2872" class="node">
<title>layer58_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="752" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="752" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="752" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="752" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert0 -->
<g id="edge3692" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.21,-2182C2185.96,-2182 822.75,-2182 822.75,-2182 822.75,-2182 822.75,-2056.66 822.75,-2056.66"/>
<polygon fill="black" stroke="black" points="826.25,-2056.66 822.75,-2046.66 819.25,-2056.66 826.25,-2056.66"/>
</g>
<!-- layer58_moe_comm_to_expert1 -->
<g id="node2874" class="node">
<title>layer58_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="997" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="997" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="997" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="997" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert1 -->
<g id="edge3694" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2652.5,-2167C2193.09,-2167 1015.5,-2167 1015.5,-2167 1015.5,-2167 1015.5,-2067.15 1015.5,-2067.15"/>
<polygon fill="black" stroke="black" points="1019,-2067.15 1015.5,-2057.15 1012,-2067.15 1019,-2067.15"/>
</g>
<!-- layer58_moe_comm_to_expert2 -->
<g id="node2876" class="node">
<title>layer58_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1453" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1453" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1453" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1453" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert2 -->
<g id="edge3696" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2637.21,-2152C2260.45,-2152 1471.5,-2152 1471.5,-2152 1471.5,-2152 1471.5,-2067.1 1471.5,-2067.1"/>
<polygon fill="black" stroke="black" points="1475,-2067.1 1471.5,-2057.1 1468,-2067.1 1475,-2067.1"/>
</g>
<!-- layer58_moe_comm_to_expert3 -->
<g id="node2878" class="node">
<title>layer58_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1781" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1781" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1781" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1781" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert3 -->
<g id="edge3698" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2623.23,-2138C2321.15,-2138 1799.5,-2138 1799.5,-2138 1799.5,-2138 1799.5,-2066.94 1799.5,-2066.94"/>
<polygon fill="black" stroke="black" points="1803,-2066.94 1799.5,-2056.94 1796,-2066.94 1803,-2066.94"/>
</g>
<!-- layer58_moe_comm_to_expert4 -->
<g id="node2880" class="node">
<title>layer58_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2044" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2044" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="2044" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2044" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert4 -->
<g id="edge3700" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2608.33,-2123C2380.89,-2123 2062.5,-2123 2062.5,-2123 2062.5,-2123 2062.5,-2067.07 2062.5,-2067.07"/>
<polygon fill="black" stroke="black" points="2066,-2067.07 2062.5,-2057.07 2059,-2067.07 2066,-2067.07"/>
</g>
<!-- layer58_moe_comm_to_expert5 -->
<g id="node2882" class="node">
<title>layer58_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2275" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2275" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2275" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2275" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert5 -->
<g id="edge3702" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2593.23,-2108C2449.14,-2108 2293.5,-2108 2293.5,-2108 2293.5,-2108 2293.5,-2067.17 2293.5,-2067.17"/>
<polygon fill="black" stroke="black" points="2297,-2067.17 2293.5,-2057.17 2290,-2067.17 2297,-2067.17"/>
</g>
<!-- layer58_moe_comm_to_expert6 -->
<g id="node2884" class="node">
<title>layer58_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2490" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2490" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2490" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2490" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert6 -->
<g id="edge3704" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2593.5,-2145.35C2593.5,-2141.79 2593.5,-2028 2593.5,-2028 2593.5,-2028 2590.81,-2028 2590.81,-2028"/>
<polygon fill="black" stroke="black" points="2590.81,-2024.5 2580.81,-2028 2590.81,-2031.5 2590.81,-2024.5"/>
</g>
<!-- layer58_moe_comm_to_expert7 -->
<g id="node2886" class="node">
<title>layer58_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2697" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2697" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2697" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2697" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert7 -->
<g id="edge3706" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2697,-2093.1C2697,-2093.1 2697,-2067.65 2697,-2067.65"/>
<polygon fill="black" stroke="black" points="2700.5,-2067.65 2697,-2057.65 2693.5,-2067.65 2700.5,-2067.65"/>
</g>
<!-- layer58_moe_comm_to_expert8 -->
<g id="node2888" class="node">
<title>layer58_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2969" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2969" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="2969" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2969" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert8 -->
<g id="edge3708" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2969,-2093.1C2969,-2093.1 2969,-2067.65 2969,-2067.65"/>
<polygon fill="black" stroke="black" points="2972.5,-2067.65 2969,-2057.65 2965.5,-2067.65 2972.5,-2067.65"/>
</g>
<!-- layer58_moe_comm_to_expert9 -->
<g id="node2890" class="node">
<title>layer58_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3278" cy="-2028.44" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3278" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3278" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3278" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert9 -->
<g id="edge3710" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3073.26,-2145.35C3073.26,-2141.79 3073.26,-2028 3073.26,-2028 3073.26,-2028 3177.3,-2028 3177.3,-2028"/>
<polygon fill="black" stroke="black" points="3177.3,-2031.5 3187.3,-2028 3177.3,-2024.5 3177.3,-2031.5"/>
</g>
<!-- layer58_moe_comm_to_expert10 -->
<g id="node2892" class="node">
<title>layer58_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3610" cy="-2028.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3610" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3610" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3610" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert10 -->
<g id="edge3712" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2997.82,-2108C3205.07,-2108 3534.1,-2108 3534.1,-2108 3534.1,-2108 3534.1,-2055.71 3534.1,-2055.71"/>
<polygon fill="black" stroke="black" points="3537.6,-2055.71 3534.1,-2045.71 3530.6,-2055.71 3537.6,-2055.71"/>
</g>
<!-- layer58_moe_comm_to_expert11 -->
<g id="node2894" class="node">
<title>layer58_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3956" cy="-2028.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3956" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="3956" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3956" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert11 -->
<g id="edge3714" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3012.79,-2123C3312.24,-2123 3880.6,-2123 3880.6,-2123 3880.6,-2123 3880.6,-2055.79 3880.6,-2055.79"/>
<polygon fill="black" stroke="black" points="3884.1,-2055.79 3880.6,-2045.79 3877.1,-2055.79 3884.1,-2055.79"/>
</g>
<!-- layer58_moe_comm_to_expert12 -->
<g id="node2896" class="node">
<title>layer58_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4307" cy="-2028.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4307" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4307" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4307" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert12 -->
<g id="edge3716" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3027.84,-2138C3412.29,-2138 4231.6,-2138 4231.6,-2138 4231.6,-2138 4231.6,-2056.05 4231.6,-2056.05"/>
<polygon fill="black" stroke="black" points="4235.1,-2056.05 4231.6,-2046.05 4228.1,-2056.05 4235.1,-2056.05"/>
</g>
<!-- layer58_moe_comm_to_expert13 -->
<g id="node2898" class="node">
<title>layer58_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4660" cy="-2028.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4660" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4660" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4660" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert13 -->
<g id="edge3718" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3041.74,-2152C3506.33,-2152 4585.1,-2152 4585.1,-2152 4585.1,-2152 4585.1,-2056.15 4585.1,-2056.15"/>
<polygon fill="black" stroke="black" points="4588.6,-2056.15 4585.1,-2046.15 4581.6,-2056.15 4588.6,-2056.15"/>
</g>
<!-- layer58_moe_comm_to_expert14 -->
<g id="node2900" class="node">
<title>layer58_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5015" cy="-2028.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5015" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="5015" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5015" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert14 -->
<g id="edge3720" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3057,-2167C3599.61,-2167 4940.1,-2167 4940.1,-2167 4940.1,-2167 4940.1,-2055.99 4940.1,-2055.99"/>
<polygon fill="black" stroke="black" points="4943.6,-2055.99 4940.1,-2045.99 4936.6,-2055.99 4943.6,-2055.99"/>
</g>
<!-- layer58_moe_comm_to_expert15 -->
<g id="node2902" class="node">
<title>layer58_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5370" cy="-2028.44" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5370" y="-2036.94" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5370" y="-2025.94" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5370" y="-2014.94" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert15 -->
<g id="edge3722" class="edge">
<title>layer58_moe_split&#45;&gt;layer58_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3071.59,-2182C3689.69,-2182 5295.1,-2182 5295.1,-2182 5295.1,-2182 5295.1,-2056.06 5295.1,-2056.06"/>
<polygon fill="black" stroke="black" points="5298.6,-2056.06 5295.1,-2046.06 5291.6,-2056.06 5298.6,-2056.06"/>
</g>
<!-- layer58_moe_expert0 -->
<g id="node2871" class="node">
<title>layer58_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="402,-1963.45 74,-1963.45 74,-1911.45 402,-1911.45 402,-1963.45"/>
<text text-anchor="middle" x="238" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 0 L58</text>
<text text-anchor="middle" x="238" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="238" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="238" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert0 -->
<g id="node2904" class="node">
<title>layer58_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="284" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="284" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="284" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="284" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer58_moe_expert0&#45;&gt;layer58_moe_comm_from_expert0 -->
<g id="edge3724" class="edge">
<title>layer58_moe_expert0&#45;&gt;layer58_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M284,-1911.13C284,-1911.13 284,-1885.59 284,-1885.59"/>
<polygon fill="black" stroke="black" points="287.5,-1885.59 284,-1875.59 280.5,-1885.59 287.5,-1885.59"/>
</g>
<!-- layer58_moe_comm_to_expert0&#45;&gt;layer58_moe_expert0 -->
<g id="edge3693" class="edge">
<title>layer58_moe_comm_to_expert0&#45;&gt;layer58_moe_expert0</title>
<path fill="none" stroke="black" d="M661.45,-2028C533.78,-2028 316.25,-2028 316.25,-2028 316.25,-2028 316.25,-1973.64 316.25,-1973.64"/>
<polygon fill="black" stroke="black" points="319.75,-1973.64 316.25,-1963.64 312.75,-1973.64 319.75,-1973.64"/>
</g>
<!-- layer58_moe_expert1 -->
<g id="node2873" class="node">
<title>layer58_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="748,-1963.45 420,-1963.45 420,-1911.45 748,-1911.45 748,-1963.45"/>
<text text-anchor="middle" x="584" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 1 L58</text>
<text text-anchor="middle" x="584" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="584" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="584" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert1 -->
<g id="node2905" class="node">
<title>layer58_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="997" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="997" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="997" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="997" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer58_moe_expert1&#45;&gt;layer58_moe_comm_from_expert1 -->
<g id="edge3726" class="edge">
<title>layer58_moe_expert1&#45;&gt;layer58_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M694.25,-1911C694.25,-1883.99 694.25,-1846 694.25,-1846 694.25,-1846 896.16,-1846 896.16,-1846"/>
<polygon fill="black" stroke="black" points="896.16,-1849.5 906.16,-1846 896.16,-1842.5 896.16,-1849.5"/>
</g>
<!-- layer58_moe_comm_to_expert1&#45;&gt;layer58_moe_expert1 -->
<g id="edge3695" class="edge">
<title>layer58_moe_comm_to_expert1&#45;&gt;layer58_moe_expert1</title>
<path fill="none" stroke="black" d="M997,-1999.23C997,-1985.46 997,-1972 997,-1972 997,-1972 704.75,-1972 704.75,-1972 704.75,-1972 704.75,-1971.16 704.75,-1971.16"/>
<polygon fill="black" stroke="black" points="708.25,-1973.64 704.75,-1963.64 701.25,-1973.64 708.25,-1973.64"/>
</g>
<!-- layer58_moe_expert2 -->
<g id="node2875" class="node">
<title>layer58_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1094,-1963.45 766,-1963.45 766,-1911.45 1094,-1911.45 1094,-1963.45"/>
<text text-anchor="middle" x="930" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 2 L58</text>
<text text-anchor="middle" x="930" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="930" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="930" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert2 -->
<g id="node2906" class="node">
<title>layer58_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1453" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1453" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1453" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1453" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer58_moe_expert2&#45;&gt;layer58_moe_comm_from_expert2 -->
<g id="edge3728" class="edge">
<title>layer58_moe_expert2&#45;&gt;layer58_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1094.18,-1928C1101.6,-1928 1106,-1928 1106,-1928 1106,-1928 1106,-1846 1106,-1846 1106,-1846 1352.28,-1846 1352.28,-1846"/>
<polygon fill="black" stroke="black" points="1352.28,-1849.5 1362.28,-1846 1352.28,-1842.5 1352.28,-1849.5"/>
</g>
<!-- layer58_moe_comm_to_expert2&#45;&gt;layer58_moe_expert2 -->
<g id="edge3697" class="edge">
<title>layer58_moe_comm_to_expert2&#45;&gt;layer58_moe_expert2</title>
<path fill="none" stroke="black" d="M1362.09,-2028C1257.5,-2028 1100,-2028 1100,-2028 1100,-2028 1100,-1946 1100,-1946 1100,-1946 1099.43,-1946 1099.43,-1946"/>
<polygon fill="black" stroke="black" points="1104.34,-1942.5 1094.34,-1946 1104.34,-1949.5 1104.34,-1942.5"/>
</g>
<!-- layer58_moe_expert3 -->
<g id="node2877" class="node">
<title>layer58_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1440,-1963.45 1112,-1963.45 1112,-1911.45 1440,-1911.45 1440,-1963.45"/>
<text text-anchor="middle" x="1276" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 3 L58</text>
<text text-anchor="middle" x="1276" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1276" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1276" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert3 -->
<g id="node2907" class="node">
<title>layer58_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1781" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1781" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1781" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1781" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer58_moe_expert3&#45;&gt;layer58_moe_comm_from_expert3 -->
<g id="edge3730" class="edge">
<title>layer58_moe_expert3&#45;&gt;layer58_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1401.25,-1911.34C1401.25,-1899.03 1401.25,-1887 1401.25,-1887 1401.25,-1887 1722.33,-1887 1722.33,-1887 1722.33,-1887 1722.33,-1878.63 1722.33,-1878.63"/>
<polygon fill="black" stroke="black" points="1725.83,-1878.63 1722.33,-1868.63 1718.83,-1878.63 1725.83,-1878.63"/>
</g>
<!-- layer58_moe_comm_to_expert3&#45;&gt;layer58_moe_expert3 -->
<g id="edge3699" class="edge">
<title>layer58_moe_comm_to_expert3&#45;&gt;layer58_moe_expert3</title>
<path fill="none" stroke="black" d="M1722.33,-2006.08C1722.33,-1997.62 1722.33,-1990 1722.33,-1990 1722.33,-1990 1401.25,-1990 1401.25,-1990 1401.25,-1990 1401.25,-1973.73 1401.25,-1973.73"/>
<polygon fill="black" stroke="black" points="1404.75,-1973.73 1401.25,-1963.73 1397.75,-1973.73 1404.75,-1973.73"/>
</g>
<!-- layer58_moe_expert4 -->
<g id="node2879" class="node">
<title>layer58_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1786,-1963.45 1458,-1963.45 1458,-1911.45 1786,-1911.45 1786,-1963.45"/>
<text text-anchor="middle" x="1622" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 4 L58</text>
<text text-anchor="middle" x="1622" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1622" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1622" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert4 -->
<g id="node2908" class="node">
<title>layer58_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="2044" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2044" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="2044" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2044" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer58_moe_expert4&#45;&gt;layer58_moe_comm_from_expert4 -->
<g id="edge3732" class="edge">
<title>layer58_moe_expert4&#45;&gt;layer58_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1754.16,-1911.17C1754.16,-1904.41 1754.16,-1899 1754.16,-1899 1754.16,-1899 2042.75,-1899 2042.75,-1899 2042.75,-1899 2042.75,-1885.5 2042.75,-1885.5"/>
<polygon fill="black" stroke="black" points="2046.25,-1885.5 2042.75,-1875.5 2039.25,-1885.5 2046.25,-1885.5"/>
</g>
<!-- layer58_moe_comm_to_expert4&#45;&gt;layer58_moe_expert4 -->
<g id="edge3701" class="edge">
<title>layer58_moe_comm_to_expert4&#45;&gt;layer58_moe_expert4</title>
<path fill="none" stroke="black" d="M2042.75,-1999.21C2042.75,-1989.44 2042.75,-1981 2042.75,-1981 2042.75,-1981 1754.16,-1981 1754.16,-1981 1754.16,-1981 1754.16,-1973.79 1754.16,-1973.79"/>
<polygon fill="black" stroke="black" points="1757.66,-1973.79 1754.16,-1963.79 1750.66,-1973.79 1757.66,-1973.79"/>
</g>
<!-- layer58_moe_expert5 -->
<g id="node2881" class="node">
<title>layer58_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2132,-1963.45 1804,-1963.45 1804,-1911.45 2132,-1911.45 2132,-1963.45"/>
<text text-anchor="middle" x="1968" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 5 L58</text>
<text text-anchor="middle" x="1968" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1968" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="1968" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert5 -->
<g id="node2909" class="node">
<title>layer58_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2275" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2275" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2275" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2275" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer58_moe_expert5&#45;&gt;layer58_moe_comm_from_expert5 -->
<g id="edge3734" class="edge">
<title>layer58_moe_expert5&#45;&gt;layer58_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2132.12,-1928C2140.08,-1928 2144.84,-1928 2144.84,-1928 2144.84,-1928 2144.84,-1846 2144.84,-1846 2144.84,-1846 2174.24,-1846 2174.24,-1846"/>
<polygon fill="black" stroke="black" points="2174.24,-1849.5 2184.24,-1846 2174.24,-1842.5 2174.24,-1849.5"/>
</g>
<!-- layer58_moe_comm_to_expert5&#45;&gt;layer58_moe_expert5 -->
<g id="edge3703" class="edge">
<title>layer58_moe_comm_to_expert5&#45;&gt;layer58_moe_expert5</title>
<path fill="none" stroke="black" d="M2184.36,-2028C2159.71,-2028 2139.67,-2028 2139.67,-2028 2139.67,-2028 2139.67,-1946 2139.67,-1946 2139.67,-1946 2138.94,-1946 2138.94,-1946"/>
<polygon fill="black" stroke="black" points="2142.3,-1942.5 2132.3,-1946 2142.3,-1949.5 2142.3,-1942.5"/>
</g>
<!-- layer58_moe_expert6 -->
<g id="node2883" class="node">
<title>layer58_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2478,-1963.45 2150,-1963.45 2150,-1911.45 2478,-1911.45 2478,-1963.45"/>
<text text-anchor="middle" x="2314" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 6 L58</text>
<text text-anchor="middle" x="2314" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2314" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2314" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert6 -->
<g id="node2910" class="node">
<title>layer58_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2490" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2490" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2490" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2490" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer58_moe_expert6&#45;&gt;layer58_moe_comm_from_expert6 -->
<g id="edge3736" class="edge">
<title>layer58_moe_expert6&#45;&gt;layer58_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2438.75,-1911.13C2438.75,-1911.13 2438.75,-1880.54 2438.75,-1880.54"/>
<polygon fill="black" stroke="black" points="2442.25,-1880.54 2438.75,-1870.54 2435.25,-1880.54 2442.25,-1880.54"/>
</g>
<!-- layer58_moe_comm_to_expert6&#45;&gt;layer58_moe_expert6 -->
<g id="edge3705" class="edge">
<title>layer58_moe_comm_to_expert6&#45;&gt;layer58_moe_expert6</title>
<path fill="none" stroke="black" d="M2438.75,-2004.54C2438.75,-2004.54 2438.75,-1973.76 2438.75,-1973.76"/>
<polygon fill="black" stroke="black" points="2442.25,-1973.76 2438.75,-1963.76 2435.25,-1973.76 2442.25,-1973.76"/>
</g>
<!-- layer58_moe_expert7 -->
<g id="node2885" class="node">
<title>layer58_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2824,-1963.45 2496,-1963.45 2496,-1911.45 2824,-1911.45 2824,-1963.45"/>
<text text-anchor="middle" x="2660" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 7 L58</text>
<text text-anchor="middle" x="2660" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2660" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2660" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert7 -->
<g id="node2911" class="node">
<title>layer58_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2697" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2697" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2697" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2697" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer58_moe_expert7&#45;&gt;layer58_moe_comm_from_expert7 -->
<g id="edge3738" class="edge">
<title>layer58_moe_expert7&#45;&gt;layer58_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2697,-1911.13C2697,-1911.13 2697,-1885.59 2697,-1885.59"/>
<polygon fill="black" stroke="black" points="2700.5,-1885.59 2697,-1875.59 2693.5,-1885.59 2700.5,-1885.59"/>
</g>
<!-- layer58_moe_comm_to_expert7&#45;&gt;layer58_moe_expert7 -->
<g id="edge3707" class="edge">
<title>layer58_moe_comm_to_expert7&#45;&gt;layer58_moe_expert7</title>
<path fill="none" stroke="black" d="M2697,-1999.4C2697,-1999.4 2697,-1973.75 2697,-1973.75"/>
<polygon fill="black" stroke="black" points="2700.5,-1973.75 2697,-1963.75 2693.5,-1973.75 2700.5,-1973.75"/>
</g>
<!-- layer58_moe_expert8 -->
<g id="node2887" class="node">
<title>layer58_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3170,-1963.45 2842,-1963.45 2842,-1911.45 3170,-1911.45 3170,-1963.45"/>
<text text-anchor="middle" x="3006" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 8 L58</text>
<text text-anchor="middle" x="3006" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="3006" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="3006" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert8 -->
<g id="node2912" class="node">
<title>layer58_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="2969" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2969" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="2969" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2969" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer58_moe_expert8&#45;&gt;layer58_moe_comm_from_expert8 -->
<g id="edge3740" class="edge">
<title>layer58_moe_expert8&#45;&gt;layer58_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M2969,-1911.13C2969,-1911.13 2969,-1885.59 2969,-1885.59"/>
<polygon fill="black" stroke="black" points="2972.5,-1885.59 2969,-1875.59 2965.5,-1885.59 2972.5,-1885.59"/>
</g>
<!-- layer58_moe_comm_to_expert8&#45;&gt;layer58_moe_expert8 -->
<g id="edge3709" class="edge">
<title>layer58_moe_comm_to_expert8&#45;&gt;layer58_moe_expert8</title>
<path fill="none" stroke="black" d="M2969,-1999.4C2969,-1999.4 2969,-1973.75 2969,-1973.75"/>
<polygon fill="black" stroke="black" points="2972.5,-1973.75 2969,-1963.75 2965.5,-1973.75 2972.5,-1973.75"/>
</g>
<!-- layer58_moe_expert9 -->
<g id="node2889" class="node">
<title>layer58_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3516,-1963.45 3188,-1963.45 3188,-1911.45 3516,-1911.45 3516,-1963.45"/>
<text text-anchor="middle" x="3352" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 9 L58</text>
<text text-anchor="middle" x="3352" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3352" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3352" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert9 -->
<g id="node2913" class="node">
<title>layer58_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3278" cy="-1846.46" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3278" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3278" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3278" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer58_moe_expert9&#45;&gt;layer58_moe_comm_from_expert9 -->
<g id="edge3742" class="edge">
<title>layer58_moe_expert9&#45;&gt;layer58_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3278.25,-1911.13C3278.25,-1911.13 3278.25,-1885.59 3278.25,-1885.59"/>
<polygon fill="black" stroke="black" points="3281.75,-1885.59 3278.25,-1875.59 3274.75,-1885.59 3281.75,-1885.59"/>
</g>
<!-- layer58_moe_comm_to_expert9&#45;&gt;layer58_moe_expert9 -->
<g id="edge3711" class="edge">
<title>layer58_moe_comm_to_expert9&#45;&gt;layer58_moe_expert9</title>
<path fill="none" stroke="black" d="M3278.25,-1999.4C3278.25,-1999.4 3278.25,-1973.75 3278.25,-1973.75"/>
<polygon fill="black" stroke="black" points="3281.75,-1973.75 3278.25,-1963.75 3274.75,-1973.75 3281.75,-1973.75"/>
</g>
<!-- layer58_moe_expert10 -->
<g id="node2891" class="node">
<title>layer58_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="3872,-1963.45 3534,-1963.45 3534,-1911.45 3872,-1911.45 3872,-1963.45"/>
<text text-anchor="middle" x="3703" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 10 L58</text>
<text text-anchor="middle" x="3703" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3703" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3703" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert10 -->
<g id="node2914" class="node">
<title>layer58_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3610" cy="-1846.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3610" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3610" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3610" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer58_moe_expert10&#45;&gt;layer58_moe_comm_from_expert10 -->
<g id="edge3744" class="edge">
<title>layer58_moe_expert10&#45;&gt;layer58_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3619.38,-1911.13C3619.38,-1911.13 3619.38,-1885.59 3619.38,-1885.59"/>
<polygon fill="black" stroke="black" points="3622.88,-1885.59 3619.38,-1875.59 3615.88,-1885.59 3622.88,-1885.59"/>
</g>
<!-- layer58_moe_comm_to_expert10&#45;&gt;layer58_moe_expert10 -->
<g id="edge3713" class="edge">
<title>layer58_moe_comm_to_expert10&#45;&gt;layer58_moe_expert10</title>
<path fill="none" stroke="black" d="M3619.02,-1999.4C3619.02,-1999.4 3619.02,-1973.75 3619.02,-1973.75"/>
<polygon fill="black" stroke="black" points="3622.52,-1973.75 3619.02,-1963.75 3615.52,-1973.75 3622.52,-1973.75"/>
</g>
<!-- layer58_moe_expert11 -->
<g id="node2893" class="node">
<title>layer58_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4228,-1963.45 3890,-1963.45 3890,-1911.45 4228,-1911.45 4228,-1963.45"/>
<text text-anchor="middle" x="4059" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 11 L58</text>
<text text-anchor="middle" x="4059" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4059" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4059" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert11 -->
<g id="node2915" class="node">
<title>layer58_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="3957" cy="-1846.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3957" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="3957" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3957" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer58_moe_expert11&#45;&gt;layer58_moe_comm_from_expert11 -->
<g id="edge3746" class="edge">
<title>layer58_moe_expert11&#45;&gt;layer58_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M3970.88,-1911.13C3970.88,-1911.13 3970.88,-1885.27 3970.88,-1885.27"/>
<polygon fill="black" stroke="black" points="3974.38,-1885.27 3970.88,-1875.27 3967.38,-1885.27 3974.38,-1885.27"/>
</g>
<!-- layer58_moe_comm_to_expert11&#45;&gt;layer58_moe_expert11 -->
<g id="edge3715" class="edge">
<title>layer58_moe_comm_to_expert11&#45;&gt;layer58_moe_expert11</title>
<path fill="none" stroke="black" d="M3970.02,-1999.65C3970.02,-1999.65 3970.02,-1973.59 3970.02,-1973.59"/>
<polygon fill="black" stroke="black" points="3973.52,-1973.59 3970.02,-1963.59 3966.52,-1973.59 3973.52,-1973.59"/>
</g>
<!-- layer58_moe_expert12 -->
<g id="node2895" class="node">
<title>layer58_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4584,-1963.45 4246,-1963.45 4246,-1911.45 4584,-1911.45 4584,-1963.45"/>
<text text-anchor="middle" x="4415" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 12 L58</text>
<text text-anchor="middle" x="4415" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4415" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4415" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert12 -->
<g id="node2916" class="node">
<title>layer58_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4308" cy="-1846.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4308" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4308" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4308" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer58_moe_expert12&#45;&gt;layer58_moe_comm_from_expert12 -->
<g id="edge3748" class="edge">
<title>layer58_moe_expert12&#45;&gt;layer58_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4324.38,-1911.13C4324.38,-1911.13 4324.38,-1885.27 4324.38,-1885.27"/>
<polygon fill="black" stroke="black" points="4327.88,-1885.27 4324.38,-1875.27 4320.88,-1885.27 4327.88,-1885.27"/>
</g>
<!-- layer58_moe_comm_to_expert12&#45;&gt;layer58_moe_expert12 -->
<g id="edge3717" class="edge">
<title>layer58_moe_comm_to_expert12&#45;&gt;layer58_moe_expert12</title>
<path fill="none" stroke="black" d="M4323.52,-1999.65C4323.52,-1999.65 4323.52,-1973.59 4323.52,-1973.59"/>
<polygon fill="black" stroke="black" points="4327.02,-1973.59 4323.52,-1963.59 4320.02,-1973.59 4327.02,-1973.59"/>
</g>
<!-- layer58_moe_expert13 -->
<g id="node2897" class="node">
<title>layer58_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="4940,-1963.45 4602,-1963.45 4602,-1911.45 4940,-1911.45 4940,-1963.45"/>
<text text-anchor="middle" x="4771" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 13 L58</text>
<text text-anchor="middle" x="4771" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4771" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4771" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert13 -->
<g id="node2917" class="node">
<title>layer58_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4662" cy="-1846.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4662" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4662" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4662" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer58_moe_expert13&#45;&gt;layer58_moe_comm_from_expert13 -->
<g id="edge3750" class="edge">
<title>layer58_moe_expert13&#45;&gt;layer58_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4679.38,-1911.13C4679.38,-1911.13 4679.38,-1885.27 4679.38,-1885.27"/>
<polygon fill="black" stroke="black" points="4682.88,-1885.27 4679.38,-1875.27 4675.88,-1885.27 4682.88,-1885.27"/>
</g>
<!-- layer58_moe_comm_to_expert13&#45;&gt;layer58_moe_expert13 -->
<g id="edge3719" class="edge">
<title>layer58_moe_comm_to_expert13&#45;&gt;layer58_moe_expert13</title>
<path fill="none" stroke="black" d="M4678.02,-1999.65C4678.02,-1999.65 4678.02,-1973.59 4678.02,-1973.59"/>
<polygon fill="black" stroke="black" points="4681.52,-1973.59 4678.02,-1963.59 4674.52,-1973.59 4681.52,-1973.59"/>
</g>
<!-- layer58_moe_expert14 -->
<g id="node2899" class="node">
<title>layer58_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5296,-1963.45 4958,-1963.45 4958,-1911.45 5296,-1911.45 5296,-1963.45"/>
<text text-anchor="middle" x="5127" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 14 L58</text>
<text text-anchor="middle" x="5127" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5127" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5127" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert14 -->
<g id="node2918" class="node">
<title>layer58_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="5017" cy="-1846.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5017" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="5017" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5017" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer58_moe_expert14&#45;&gt;layer58_moe_comm_from_expert14 -->
<g id="edge3752" class="edge">
<title>layer58_moe_expert14&#45;&gt;layer58_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M5034.88,-1911.13C5034.88,-1911.13 5034.88,-1884.95 5034.88,-1884.95"/>
<polygon fill="black" stroke="black" points="5038.38,-1884.95 5034.88,-1874.95 5031.38,-1884.95 5038.38,-1884.95"/>
</g>
<!-- layer58_moe_comm_to_expert14&#45;&gt;layer58_moe_expert14 -->
<g id="edge3721" class="edge">
<title>layer58_moe_comm_to_expert14&#45;&gt;layer58_moe_expert14</title>
<path fill="none" stroke="black" d="M5033.52,-1999.65C5033.52,-1999.65 5033.52,-1973.59 5033.52,-1973.59"/>
<polygon fill="black" stroke="black" points="5037.02,-1973.59 5033.52,-1963.59 5030.02,-1973.59 5037.02,-1973.59"/>
</g>
<!-- layer58_moe_expert15 -->
<g id="node2901" class="node">
<title>layer58_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5652,-1963.45 5314,-1963.45 5314,-1911.45 5652,-1911.45 5652,-1963.45"/>
<text text-anchor="middle" x="5483" y="-1951.45" font-family="Arial" font-size="10.00">EXPERT 15 L58</text>
<text text-anchor="middle" x="5483" y="-1940.45" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5483" y="-1929.45" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5483" y="-1918.45" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_comm_from_expert15 -->
<g id="node2919" class="node">
<title>layer58_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5372" cy="-1846.46" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5372" y="-1854.96" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5372" y="-1843.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5372" y="-1832.96" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer58_moe_expert15&#45;&gt;layer58_moe_comm_from_expert15 -->
<g id="edge3754" class="edge">
<title>layer58_moe_expert15&#45;&gt;layer58_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5390.38,-1911.13C5390.38,-1911.13 5390.38,-1884.95 5390.38,-1884.95"/>
<polygon fill="black" stroke="black" points="5393.88,-1884.95 5390.38,-1874.95 5386.88,-1884.95 5393.88,-1884.95"/>
</g>
<!-- layer58_moe_comm_to_expert15&#45;&gt;layer58_moe_expert15 -->
<g id="edge3723" class="edge">
<title>layer58_moe_comm_to_expert15&#45;&gt;layer58_moe_expert15</title>
<path fill="none" stroke="black" d="M5389.02,-1999.65C5389.02,-1999.65 5389.02,-1973.59 5389.02,-1973.59"/>
<polygon fill="black" stroke="black" points="5392.52,-1973.59 5389.02,-1963.59 5385.52,-1973.59 5392.52,-1973.59"/>
</g>
<!-- layer58_moe_aggregate -->
<g id="node2903" class="node">
<title>layer58_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3058.1,-1781.47 2641.16,-1781.47 2533.9,-1677.47 2950.84,-1677.47 3058.1,-1781.47"/>
<text text-anchor="middle" x="2796" y="-1743.47" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L58</text>
<text text-anchor="middle" x="2796" y="-1732.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2796" y="-1721.47" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2796" y="-1710.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_mha -->
<g id="node2920" class="node">
<title>layer59_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="2926,-1641.47 2666,-1641.47 2666,-1589.47 2926,-1589.47 2926,-1641.47"/>
<text text-anchor="middle" x="2796" y="-1629.47" font-family="Arial" font-size="10.00">MHA L59</text>
<text text-anchor="middle" x="2796" y="-1618.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2796" y="-1607.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2796" y="-1596.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer58_moe_aggregate&#45;&gt;layer59_moe_mha -->
<g id="edge3823" class="edge">
<title>layer58_moe_aggregate&#45;&gt;layer59_moe_mha</title>
<path fill="none" stroke="black" d="M2796,-1677.14C2796,-1677.14 2796,-1651.7 2796,-1651.7"/>
<polygon fill="black" stroke="black" points="2799.5,-1651.7 2796,-1641.7 2792.5,-1651.7 2799.5,-1651.7"/>
</g>
<!-- layer58_moe_comm_from_expert0&#45;&gt;layer58_moe_aggregate -->
<g id="edge3725" class="edge">
<title>layer58_moe_comm_from_expert0&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M334.5,-1822.33C334.5,-1778.88 334.5,-1692 334.5,-1692 334.5,-1692 2538.71,-1692 2538.71,-1692"/>
<polygon fill="black" stroke="black" points="2538.71,-1695.5 2548.71,-1692 2538.71,-1688.5 2538.71,-1695.5"/>
</g>
<!-- layer58_moe_comm_from_expert1&#45;&gt;layer58_moe_aggregate -->
<g id="edge3727" class="edge">
<title>layer58_moe_comm_from_expert1&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M970.83,-1818.57C970.83,-1777.88 970.83,-1707 970.83,-1707 970.83,-1707 2553.91,-1707 2553.91,-1707"/>
<polygon fill="black" stroke="black" points="2553.91,-1710.5 2563.91,-1707 2553.91,-1703.5 2553.91,-1710.5"/>
</g>
<!-- layer58_moe_comm_from_expert2&#45;&gt;layer58_moe_aggregate -->
<g id="edge3729" class="edge">
<title>layer58_moe_comm_from_expert2&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M1528.51,-1830.45C1528.51,-1796.83 1528.51,-1722 1528.51,-1722 1528.51,-1722 2569.55,-1722 2569.55,-1722"/>
<polygon fill="black" stroke="black" points="2569.55,-1725.5 2579.55,-1722 2569.55,-1718.5 2569.55,-1725.5"/>
</g>
<!-- layer58_moe_comm_from_expert3&#45;&gt;layer58_moe_aggregate -->
<g id="edge3731" class="edge">
<title>layer58_moe_comm_from_expert3&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M1828.51,-1821.67C1828.51,-1789.1 1828.51,-1736 1828.51,-1736 1828.51,-1736 2584.07,-1736 2584.07,-1736"/>
<polygon fill="black" stroke="black" points="2584.07,-1739.5 2594.07,-1736 2584.07,-1732.5 2584.07,-1739.5"/>
</g>
<!-- layer58_moe_comm_from_expert4&#45;&gt;layer58_moe_aggregate -->
<g id="edge3733" class="edge">
<title>layer58_moe_comm_from_expert4&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M2072.84,-1818.85C2072.84,-1790.66 2072.84,-1751 2072.84,-1751 2072.84,-1751 2599.3,-1751 2599.3,-1751"/>
<polygon fill="black" stroke="black" points="2599.3,-1754.5 2609.3,-1751 2599.3,-1747.5 2599.3,-1754.5"/>
</g>
<!-- layer58_moe_comm_from_expert5&#45;&gt;layer58_moe_aggregate -->
<g id="edge3735" class="edge">
<title>layer58_moe_comm_from_expert5&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M2331.5,-1823.62C2331.5,-1799.83 2331.5,-1766 2331.5,-1766 2331.5,-1766 2615.02,-1766 2615.02,-1766"/>
<polygon fill="black" stroke="black" points="2615.02,-1769.5 2625.02,-1766 2615.02,-1762.5 2615.02,-1769.5"/>
</g>
<!-- layer58_moe_comm_from_expert6&#45;&gt;layer58_moe_aggregate -->
<g id="edge3737" class="edge">
<title>layer58_moe_comm_from_expert6&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M2557.11,-1826.88C2557.11,-1826.88 2557.11,-1739.52 2557.11,-1739.52"/>
<polygon fill="black" stroke="black" points="2560.61,-1739.52 2557.11,-1729.52 2553.61,-1739.52 2560.61,-1739.52"/>
</g>
<!-- layer58_moe_comm_from_expert7&#45;&gt;layer58_moe_aggregate -->
<g id="edge3739" class="edge">
<title>layer58_moe_comm_from_expert7&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M2697,-1817.24C2697,-1817.24 2697,-1791.53 2697,-1791.53"/>
<polygon fill="black" stroke="black" points="2700.5,-1791.53 2697,-1781.53 2693.5,-1791.53 2700.5,-1791.53"/>
</g>
<!-- layer58_moe_comm_from_expert8&#45;&gt;layer58_moe_aggregate -->
<g id="edge3741" class="edge">
<title>layer58_moe_comm_from_expert8&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M2968.39,-1817.24C2968.39,-1817.24 2968.39,-1791.53 2968.39,-1791.53"/>
<polygon fill="black" stroke="black" points="2971.89,-1791.53 2968.39,-1781.53 2964.89,-1791.53 2971.89,-1791.53"/>
</g>
<!-- layer58_moe_comm_from_expert9&#45;&gt;layer58_moe_aggregate -->
<g id="edge3743" class="edge">
<title>layer58_moe_comm_from_expert9&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M3259.5,-1817.69C3259.5,-1795.3 3259.5,-1768 3259.5,-1768 3259.5,-1768 3054.37,-1768 3054.37,-1768"/>
<polygon fill="black" stroke="black" points="3054.37,-1764.5 3044.37,-1768 3054.37,-1771.5 3054.37,-1764.5"/>
</g>
<!-- layer58_moe_comm_from_expert10&#45;&gt;layer58_moe_aggregate -->
<g id="edge3745" class="edge">
<title>layer58_moe_comm_from_expert10&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M3591.15,-1818.02C3591.15,-1791.18 3591.15,-1755 3591.15,-1755 3591.15,-1755 3040.81,-1755 3040.81,-1755"/>
<polygon fill="black" stroke="black" points="3040.81,-1751.5 3030.81,-1755 3040.81,-1758.5 3040.81,-1751.5"/>
</g>
<!-- layer58_moe_comm_from_expert11&#45;&gt;layer58_moe_aggregate -->
<g id="edge3747" class="edge">
<title>layer58_moe_comm_from_expert11&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M3937.65,-1817.92C3937.65,-1786.99 3937.65,-1742 3937.65,-1742 3937.65,-1742 3027.47,-1742 3027.47,-1742"/>
<polygon fill="black" stroke="black" points="3027.47,-1738.5 3017.47,-1742 3027.47,-1745.5 3027.47,-1738.5"/>
</g>
<!-- layer58_moe_comm_from_expert12&#45;&gt;layer58_moe_aggregate -->
<g id="edge3749" class="edge">
<title>layer58_moe_comm_from_expert12&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M4288.65,-1818.03C4288.65,-1783.26 4288.65,-1729 4288.65,-1729 4288.65,-1729 3014.33,-1729 3014.33,-1729"/>
<polygon fill="black" stroke="black" points="3014.33,-1725.5 3004.33,-1729 3014.33,-1732.5 3014.33,-1725.5"/>
</g>
<!-- layer58_moe_comm_from_expert13&#45;&gt;layer58_moe_aggregate -->
<g id="edge3751" class="edge">
<title>layer58_moe_comm_from_expert13&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M4642.15,-1817.83C4642.15,-1779.43 4642.15,-1716 4642.15,-1716 4642.15,-1716 3000.95,-1716 3000.95,-1716"/>
<polygon fill="black" stroke="black" points="3000.95,-1712.5 2990.95,-1716 3000.95,-1719.5 3000.95,-1712.5"/>
</g>
<!-- layer58_moe_comm_from_expert14&#45;&gt;layer58_moe_aggregate -->
<g id="edge3753" class="edge">
<title>layer58_moe_comm_from_expert14&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M4997.15,-1817.77C4997.15,-1775.91 4997.15,-1703 4997.15,-1703 4997.15,-1703 2987.53,-1703 2987.53,-1703"/>
<polygon fill="black" stroke="black" points="2987.53,-1699.5 2977.53,-1703 2987.53,-1706.5 2987.53,-1699.5"/>
</g>
<!-- layer58_moe_comm_from_expert15&#45;&gt;layer58_moe_aggregate -->
<g id="edge3755" class="edge">
<title>layer58_moe_comm_from_expert15&#45;&gt;layer58_moe_aggregate</title>
<path fill="none" stroke="black" d="M5352.15,-1817.76C5352.15,-1772.59 5352.15,-1690 5352.15,-1690 5352.15,-1690 2974.21,-1690 2974.21,-1690"/>
<polygon fill="black" stroke="black" points="2974.21,-1686.5 2964.21,-1690 2974.21,-1693.5 2974.21,-1686.5"/>
</g>
<!-- layer59_moe_gate -->
<g id="node2921" class="node">
<title>layer59_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3054.3,-1553.47 2643.4,-1553.47 2537.7,-1449.47 2948.6,-1449.47 3054.3,-1553.47"/>
<text text-anchor="middle" x="2796" y="-1515.47" font-family="Arial" font-size="10.00">GATE L59</text>
<text text-anchor="middle" x="2796" y="-1504.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2796" y="-1493.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2796" y="-1482.47" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer59_moe_mha&#45;&gt;layer59_moe_gate -->
<g id="edge3824" class="edge">
<title>layer59_moe_mha&#45;&gt;layer59_moe_gate</title>
<path fill="none" stroke="black" d="M2796,-1589.32C2796,-1589.32 2796,-1563.57 2796,-1563.57"/>
<polygon fill="black" stroke="black" points="2799.5,-1563.57 2796,-1553.57 2792.5,-1563.57 2799.5,-1563.57"/>
</g>
<!-- layer59_moe_split -->
<g id="node2922" class="node">
<title>layer59_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3050.01,-1413.47 2645.94,-1413.47 2541.99,-1309.47 2946.06,-1309.47 3050.01,-1413.47"/>
<text text-anchor="middle" x="2796" y="-1375.47" font-family="Arial" font-size="10.00">SPLIT TOKENS L59</text>
<text text-anchor="middle" x="2796" y="-1364.47" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2796" y="-1353.47" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2796" y="-1342.47" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer59_moe_gate&#45;&gt;layer59_moe_split -->
<g id="edge3825" class="edge">
<title>layer59_moe_gate&#45;&gt;layer59_moe_split</title>
<path fill="none" stroke="black" d="M2796,-1449.34C2796,-1449.34 2796,-1423.64 2796,-1423.64"/>
<polygon fill="black" stroke="black" points="2799.5,-1423.64 2796,-1413.64 2792.5,-1423.64 2799.5,-1423.64"/>
</g>
<!-- layer59_moe_comm_to_expert0 -->
<g id="node2924" class="node">
<title>layer59_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="385" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="385" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="385" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="385" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert0 -->
<g id="edge3759" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2630.41,-1398C2095.4,-1398 447.75,-1398 447.75,-1398 447.75,-1398 447.75,-1275.5 447.75,-1275.5"/>
<polygon fill="black" stroke="black" points="451.25,-1275.5 447.75,-1265.5 444.25,-1275.5 451.25,-1275.5"/>
</g>
<!-- layer59_moe_comm_to_expert1 -->
<g id="node2926" class="node">
<title>layer59_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="731" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="731" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="731" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="731" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert1 -->
<g id="edge3761" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2615.23,-1383C2122.71,-1383 793.75,-1383 793.75,-1383 793.75,-1383 793.75,-1275.52 793.75,-1275.52"/>
<polygon fill="black" stroke="black" points="797.25,-1275.52 793.75,-1265.52 790.25,-1275.52 797.25,-1275.52"/>
</g>
<!-- layer59_moe_comm_to_expert2 -->
<g id="node2928" class="node">
<title>layer59_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1003" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1003" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1003" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1003" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert2 -->
<g id="edge3763" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2600.17,-1368C2140.15,-1368 1029.17,-1368 1029.17,-1368 1029.17,-1368 1029.17,-1282.51 1029.17,-1282.51"/>
<polygon fill="black" stroke="black" points="1032.67,-1282.51 1029.17,-1272.51 1025.67,-1282.51 1032.67,-1282.51"/>
</g>
<!-- layer59_moe_comm_to_expert3 -->
<g id="node2930" class="node">
<title>layer59_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1423" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1423" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1423" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1423" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert3 -->
<g id="edge3765" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2586.42,-1354C2205.36,-1354 1438,-1354 1438,-1354 1438,-1354 1438,-1283.25 1438,-1283.25"/>
<polygon fill="black" stroke="black" points="1441.5,-1283.25 1438,-1273.25 1434.5,-1283.25 1441.5,-1283.25"/>
</g>
<!-- layer59_moe_comm_to_expert4 -->
<g id="node2932" class="node">
<title>layer59_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1695" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1695" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="1695" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1695" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert4 -->
<g id="edge3767" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2571.3,-1339C2260.7,-1339 1738,-1339 1738,-1339 1738,-1339 1738,-1280.31 1738,-1280.31"/>
<polygon fill="black" stroke="black" points="1741.5,-1280.31 1738,-1270.31 1734.5,-1280.31 1741.5,-1280.31"/>
</g>
<!-- layer59_moe_comm_to_expert5 -->
<g id="node2934" class="node">
<title>layer59_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2042" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2042" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2042" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2042" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert5 -->
<g id="edge3769" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2556.34,-1324C2326.17,-1324 2013.16,-1324 2013.16,-1324 2013.16,-1324 2013.16,-1282.29 2013.16,-1282.29"/>
<polygon fill="black" stroke="black" points="2016.66,-1282.29 2013.16,-1272.29 2009.66,-1282.29 2016.66,-1282.29"/>
</g>
<!-- layer59_moe_comm_to_expert6 -->
<g id="node2936" class="node">
<title>layer59_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2388" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2388" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2388" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2388" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert6 -->
<g id="edge3771" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2555.74,-1361.38C2555.74,-1357.83 2555.74,-1244 2555.74,-1244 2555.74,-1244 2488.74,-1244 2488.74,-1244"/>
<polygon fill="black" stroke="black" points="2488.74,-1240.5 2478.74,-1244 2488.74,-1247.5 2488.74,-1240.5"/>
</g>
<!-- layer59_moe_comm_to_expert7 -->
<g id="node2938" class="node">
<title>layer59_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2660" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2660" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2660" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2660" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert7 -->
<g id="edge3773" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2660,-1309.13C2660,-1309.13 2660,-1283.69 2660,-1283.69"/>
<polygon fill="black" stroke="black" points="2663.5,-1283.69 2660,-1273.69 2656.5,-1283.69 2663.5,-1283.69"/>
</g>
<!-- layer59_moe_comm_to_expert8 -->
<g id="node2940" class="node">
<title>layer59_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2932" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2932" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="2932" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2932" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert8 -->
<g id="edge3775" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2932,-1309.13C2932,-1309.13 2932,-1283.69 2932,-1283.69"/>
<polygon fill="black" stroke="black" points="2935.5,-1283.69 2932,-1273.69 2928.5,-1283.69 2935.5,-1283.69"/>
</g>
<!-- layer59_moe_comm_to_expert9 -->
<g id="node2942" class="node">
<title>layer59_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3241" cy="-1244.48" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3241" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3241" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3241" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert9 -->
<g id="edge3777" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3036.26,-1361.38C3036.26,-1357.83 3036.26,-1244 3036.26,-1244 3036.26,-1244 3140.3,-1244 3140.3,-1244"/>
<polygon fill="black" stroke="black" points="3140.3,-1247.5 3150.3,-1244 3140.3,-1240.5 3140.3,-1247.5"/>
</g>
<!-- layer59_moe_comm_to_expert10 -->
<g id="node2944" class="node">
<title>layer59_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3573" cy="-1244.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3573" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3573" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3573" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert10 -->
<g id="edge3779" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2960.82,-1324C3168.07,-1324 3497.1,-1324 3497.1,-1324 3497.1,-1324 3497.1,-1271.73 3497.1,-1271.73"/>
<polygon fill="black" stroke="black" points="3500.6,-1271.73 3497.1,-1261.73 3493.6,-1271.73 3500.6,-1271.73"/>
</g>
<!-- layer59_moe_comm_to_expert11 -->
<g id="node2946" class="node">
<title>layer59_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3919" cy="-1244.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3919" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="3919" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3919" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert11 -->
<g id="edge3781" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2975.79,-1339C3275.24,-1339 3843.6,-1339 3843.6,-1339 3843.6,-1339 3843.6,-1271.82 3843.6,-1271.82"/>
<polygon fill="black" stroke="black" points="3847.1,-1271.82 3843.6,-1261.82 3840.1,-1271.82 3847.1,-1271.82"/>
</g>
<!-- layer59_moe_comm_to_expert12 -->
<g id="node2948" class="node">
<title>layer59_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4270" cy="-1244.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4270" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4270" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4270" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert12 -->
<g id="edge3783" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2990.84,-1354C3375.29,-1354 4194.6,-1354 4194.6,-1354 4194.6,-1354 4194.6,-1272.08 4194.6,-1272.08"/>
<polygon fill="black" stroke="black" points="4198.1,-1272.08 4194.6,-1262.08 4191.1,-1272.08 4198.1,-1272.08"/>
</g>
<!-- layer59_moe_comm_to_expert13 -->
<g id="node2950" class="node">
<title>layer59_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4623" cy="-1244.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4623" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4623" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4623" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert13 -->
<g id="edge3785" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3004.74,-1368C3469.33,-1368 4548.1,-1368 4548.1,-1368 4548.1,-1368 4548.1,-1272.18 4548.1,-1272.18"/>
<polygon fill="black" stroke="black" points="4551.6,-1272.18 4548.1,-1262.18 4544.6,-1272.18 4551.6,-1272.18"/>
</g>
<!-- layer59_moe_comm_to_expert14 -->
<g id="node2952" class="node">
<title>layer59_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4978" cy="-1244.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4978" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="4978" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4978" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert14 -->
<g id="edge3787" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3020,-1383C3562.61,-1383 4903.1,-1383 4903.1,-1383 4903.1,-1383 4903.1,-1272.02 4903.1,-1272.02"/>
<polygon fill="black" stroke="black" points="4906.6,-1272.02 4903.1,-1262.02 4899.6,-1272.02 4906.6,-1272.02"/>
</g>
<!-- layer59_moe_comm_to_expert15 -->
<g id="node2954" class="node">
<title>layer59_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5333" cy="-1244.48" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5333" y="-1252.98" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5333" y="-1241.98" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5333" y="-1230.98" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert15 -->
<g id="edge3789" class="edge">
<title>layer59_moe_split&#45;&gt;layer59_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3034.59,-1398C3652.69,-1398 5258.1,-1398 5258.1,-1398 5258.1,-1398 5258.1,-1272.09 5258.1,-1272.09"/>
<polygon fill="black" stroke="black" points="5261.6,-1272.09 5258.1,-1262.09 5254.6,-1272.09 5261.6,-1272.09"/>
</g>
<!-- layer59_moe_expert0 -->
<g id="node2923" class="node">
<title>layer59_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="365,-1179.49 37,-1179.49 37,-1127.49 365,-1127.49 365,-1179.49"/>
<text text-anchor="middle" x="201" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 0 L59</text>
<text text-anchor="middle" x="201" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="201" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="201" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert0 -->
<g id="node2956" class="node">
<title>layer59_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="358" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="358" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="358" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="358" y="-1049" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer59_moe_expert0&#45;&gt;layer59_moe_comm_from_expert0 -->
<g id="edge3791" class="edge">
<title>layer59_moe_expert0&#45;&gt;layer59_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M316.25,-1127.17C316.25,-1127.17 316.25,-1098.44 316.25,-1098.44"/>
<polygon fill="black" stroke="black" points="319.75,-1098.44 316.25,-1088.44 312.75,-1098.44 319.75,-1098.44"/>
</g>
<!-- layer59_moe_comm_to_expert0&#45;&gt;layer59_moe_expert0 -->
<g id="edge3760" class="edge">
<title>layer59_moe_comm_to_expert0&#45;&gt;layer59_moe_expert0</title>
<path fill="none" stroke="black" d="M329.75,-1221.05C329.75,-1221.05 329.75,-1189.73 329.75,-1189.73"/>
<polygon fill="black" stroke="black" points="333.25,-1189.73 329.75,-1179.73 326.25,-1189.73 333.25,-1189.73"/>
</g>
<!-- layer59_moe_expert1 -->
<g id="node2925" class="node">
<title>layer59_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="711,-1179.49 383,-1179.49 383,-1127.49 711,-1127.49 711,-1179.49"/>
<text text-anchor="middle" x="547" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 1 L59</text>
<text text-anchor="middle" x="547" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="547" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="547" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert1 -->
<g id="node2957" class="node">
<title>layer59_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="777" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="777" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="777" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="777" y="-1049" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer59_moe_expert1&#45;&gt;layer59_moe_comm_from_expert1 -->
<g id="edge3793" class="edge">
<title>layer59_moe_expert1&#45;&gt;layer59_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M698.75,-1127.17C698.75,-1127.17 698.75,-1087.15 698.75,-1087.15"/>
<polygon fill="black" stroke="black" points="702.25,-1087.15 698.75,-1077.15 695.25,-1087.15 702.25,-1087.15"/>
</g>
<!-- layer59_moe_comm_to_expert1&#45;&gt;layer59_moe_expert1 -->
<g id="edge3762" class="edge">
<title>layer59_moe_comm_to_expert1&#45;&gt;layer59_moe_expert1</title>
<path fill="none" stroke="black" d="M675.75,-1221.05C675.75,-1221.05 675.75,-1189.73 675.75,-1189.73"/>
<polygon fill="black" stroke="black" points="679.25,-1189.73 675.75,-1179.73 672.25,-1189.73 679.25,-1189.73"/>
</g>
<!-- layer59_moe_expert2 -->
<g id="node2927" class="node">
<title>layer59_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1057,-1179.49 729,-1179.49 729,-1127.49 1057,-1127.49 1057,-1179.49"/>
<text text-anchor="middle" x="893" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 2 L59</text>
<text text-anchor="middle" x="893" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="893" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="893" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert2 -->
<g id="node2958" class="node">
<title>layer59_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1086" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1086" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1086" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1086" y="-1049" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer59_moe_expert2&#45;&gt;layer59_moe_comm_from_expert2 -->
<g id="edge3795" class="edge">
<title>layer59_moe_expert2&#45;&gt;layer59_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M1026.25,-1127.17C1026.25,-1127.17 1026.25,-1094.46 1026.25,-1094.46"/>
<polygon fill="black" stroke="black" points="1029.75,-1094.46 1026.25,-1084.46 1022.75,-1094.46 1029.75,-1094.46"/>
</g>
<!-- layer59_moe_comm_to_expert2&#45;&gt;layer59_moe_expert2 -->
<g id="edge3764" class="edge">
<title>layer59_moe_comm_to_expert2&#45;&gt;layer59_moe_expert2</title>
<path fill="none" stroke="black" d="M984.75,-1215.69C984.75,-1215.69 984.75,-1189.62 984.75,-1189.62"/>
<polygon fill="black" stroke="black" points="988.25,-1189.62 984.75,-1179.62 981.25,-1189.62 988.25,-1189.62"/>
</g>
<!-- layer59_moe_expert3 -->
<g id="node2929" class="node">
<title>layer59_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1403,-1179.49 1075,-1179.49 1075,-1127.49 1403,-1127.49 1403,-1179.49"/>
<text text-anchor="middle" x="1239" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 3 L59</text>
<text text-anchor="middle" x="1239" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1239" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1239" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert3 -->
<g id="node2959" class="node">
<title>layer59_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1340" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1340" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1340" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1340" y="-1049" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer59_moe_expert3&#45;&gt;layer59_moe_comm_from_expert3 -->
<g id="edge3797" class="edge">
<title>layer59_moe_expert3&#45;&gt;layer59_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1326.25,-1127.17C1326.25,-1127.17 1326.25,-1101.3 1326.25,-1101.3"/>
<polygon fill="black" stroke="black" points="1329.75,-1101.3 1326.25,-1091.3 1322.75,-1101.3 1329.75,-1101.3"/>
</g>
<!-- layer59_moe_comm_to_expert3&#45;&gt;layer59_moe_expert3 -->
<g id="edge3766" class="edge">
<title>layer59_moe_comm_to_expert3&#45;&gt;layer59_moe_expert3</title>
<path fill="none" stroke="black" d="M1367.75,-1221.05C1367.75,-1221.05 1367.75,-1189.73 1367.75,-1189.73"/>
<polygon fill="black" stroke="black" points="1371.25,-1189.73 1367.75,-1179.73 1364.25,-1189.73 1371.25,-1189.73"/>
</g>
<!-- layer59_moe_expert4 -->
<g id="node2931" class="node">
<title>layer59_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1749,-1179.49 1421,-1179.49 1421,-1127.49 1749,-1127.49 1749,-1179.49"/>
<text text-anchor="middle" x="1585" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 4 L59</text>
<text text-anchor="middle" x="1585" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1585" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1585" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert4 -->
<g id="node2960" class="node">
<title>layer59_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="1678" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1678" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="1678" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1678" y="-1049" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer59_moe_expert4&#45;&gt;layer59_moe_comm_from_expert4 -->
<g id="edge3799" class="edge">
<title>layer59_moe_expert4&#45;&gt;layer59_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1668.25,-1127.17C1668.25,-1127.17 1668.25,-1101.63 1668.25,-1101.63"/>
<polygon fill="black" stroke="black" points="1671.75,-1101.63 1668.25,-1091.63 1664.75,-1101.63 1671.75,-1101.63"/>
</g>
<!-- layer59_moe_comm_to_expert4&#45;&gt;layer59_moe_expert4 -->
<g id="edge3768" class="edge">
<title>layer59_moe_comm_to_expert4&#45;&gt;layer59_moe_expert4</title>
<path fill="none" stroke="black" d="M1676.75,-1215.69C1676.75,-1215.69 1676.75,-1189.62 1676.75,-1189.62"/>
<polygon fill="black" stroke="black" points="1680.25,-1189.62 1676.75,-1179.62 1673.25,-1189.62 1680.25,-1189.62"/>
</g>
<!-- layer59_moe_expert5 -->
<g id="node2933" class="node">
<title>layer59_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2095,-1179.49 1767,-1179.49 1767,-1127.49 2095,-1127.49 2095,-1179.49"/>
<text text-anchor="middle" x="1931" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 5 L59</text>
<text text-anchor="middle" x="1931" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1931" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="1931" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert5 -->
<g id="node2961" class="node">
<title>layer59_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2097" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2097" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2097" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2097" y="-1049" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer59_moe_expert5&#45;&gt;layer59_moe_comm_from_expert5 -->
<g id="edge3801" class="edge">
<title>layer59_moe_expert5&#45;&gt;layer59_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M2050.75,-1127.17C2050.75,-1127.17 2050.75,-1097.5 2050.75,-1097.5"/>
<polygon fill="black" stroke="black" points="2054.25,-1097.5 2050.75,-1087.5 2047.25,-1097.5 2054.25,-1097.5"/>
</g>
<!-- layer59_moe_comm_to_expert5&#45;&gt;layer59_moe_expert5 -->
<g id="edge3770" class="edge">
<title>layer59_moe_comm_to_expert5&#45;&gt;layer59_moe_expert5</title>
<path fill="none" stroke="black" d="M2023.25,-1215.69C2023.25,-1215.69 2023.25,-1189.62 2023.25,-1189.62"/>
<polygon fill="black" stroke="black" points="2026.75,-1189.62 2023.25,-1179.62 2019.75,-1189.62 2026.75,-1189.62"/>
</g>
<!-- layer59_moe_expert6 -->
<g id="node2935" class="node">
<title>layer59_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2441,-1179.49 2113,-1179.49 2113,-1127.49 2441,-1127.49 2441,-1179.49"/>
<text text-anchor="middle" x="2277" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 6 L59</text>
<text text-anchor="middle" x="2277" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2277" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2277" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert6 -->
<g id="node2962" class="node">
<title>layer59_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2406" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2406" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2406" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2406" y="-1049" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer59_moe_expert6&#45;&gt;layer59_moe_comm_from_expert6 -->
<g id="edge3803" class="edge">
<title>layer59_moe_expert6&#45;&gt;layer59_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2378.25,-1127.17C2378.25,-1127.17 2378.25,-1100.34 2378.25,-1100.34"/>
<polygon fill="black" stroke="black" points="2381.75,-1100.34 2378.25,-1090.34 2374.75,-1100.34 2381.75,-1100.34"/>
</g>
<!-- layer59_moe_comm_to_expert6&#45;&gt;layer59_moe_expert6 -->
<g id="edge3772" class="edge">
<title>layer59_moe_comm_to_expert6&#45;&gt;layer59_moe_expert6</title>
<path fill="none" stroke="black" d="M2369.25,-1215.69C2369.25,-1215.69 2369.25,-1189.62 2369.25,-1189.62"/>
<polygon fill="black" stroke="black" points="2372.75,-1189.62 2369.25,-1179.62 2365.75,-1189.62 2372.75,-1189.62"/>
</g>
<!-- layer59_moe_expert7 -->
<g id="node2937" class="node">
<title>layer59_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2787,-1179.49 2459,-1179.49 2459,-1127.49 2787,-1127.49 2787,-1179.49"/>
<text text-anchor="middle" x="2623" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 7 L59</text>
<text text-anchor="middle" x="2623" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2623" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2623" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert7 -->
<g id="node2963" class="node">
<title>layer59_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2660" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2660" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2660" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2660" y="-1049" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer59_moe_expert7&#45;&gt;layer59_moe_comm_from_expert7 -->
<g id="edge3805" class="edge">
<title>layer59_moe_expert7&#45;&gt;layer59_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2660,-1127.17C2660,-1127.17 2660,-1101.63 2660,-1101.63"/>
<polygon fill="black" stroke="black" points="2663.5,-1101.63 2660,-1091.63 2656.5,-1101.63 2663.5,-1101.63"/>
</g>
<!-- layer59_moe_comm_to_expert7&#45;&gt;layer59_moe_expert7 -->
<g id="edge3774" class="edge">
<title>layer59_moe_comm_to_expert7&#45;&gt;layer59_moe_expert7</title>
<path fill="none" stroke="black" d="M2660,-1215.44C2660,-1215.44 2660,-1189.79 2660,-1189.79"/>
<polygon fill="black" stroke="black" points="2663.5,-1189.79 2660,-1179.79 2656.5,-1189.79 2663.5,-1189.79"/>
</g>
<!-- layer59_moe_expert8 -->
<g id="node2939" class="node">
<title>layer59_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3133,-1179.49 2805,-1179.49 2805,-1127.49 3133,-1127.49 3133,-1179.49"/>
<text text-anchor="middle" x="2969" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 8 L59</text>
<text text-anchor="middle" x="2969" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2969" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="2969" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert8 -->
<g id="node2964" class="node">
<title>layer59_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="2932" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2932" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="2932" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2932" y="-1049" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer59_moe_expert8&#45;&gt;layer59_moe_comm_from_expert8 -->
<g id="edge3807" class="edge">
<title>layer59_moe_expert8&#45;&gt;layer59_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M2932,-1127.17C2932,-1127.17 2932,-1101.63 2932,-1101.63"/>
<polygon fill="black" stroke="black" points="2935.5,-1101.63 2932,-1091.63 2928.5,-1101.63 2935.5,-1101.63"/>
</g>
<!-- layer59_moe_comm_to_expert8&#45;&gt;layer59_moe_expert8 -->
<g id="edge3776" class="edge">
<title>layer59_moe_comm_to_expert8&#45;&gt;layer59_moe_expert8</title>
<path fill="none" stroke="black" d="M2932,-1215.44C2932,-1215.44 2932,-1189.79 2932,-1189.79"/>
<polygon fill="black" stroke="black" points="2935.5,-1189.79 2932,-1179.79 2928.5,-1189.79 2935.5,-1189.79"/>
</g>
<!-- layer59_moe_expert9 -->
<g id="node2941" class="node">
<title>layer59_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3479,-1179.49 3151,-1179.49 3151,-1127.49 3479,-1127.49 3479,-1179.49"/>
<text text-anchor="middle" x="3315" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 9 L59</text>
<text text-anchor="middle" x="3315" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3315" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3315" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert9 -->
<g id="node2965" class="node">
<title>layer59_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3241" cy="-1062.5" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3241" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3241" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3241" y="-1049" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer59_moe_expert9&#45;&gt;layer59_moe_comm_from_expert9 -->
<g id="edge3809" class="edge">
<title>layer59_moe_expert9&#45;&gt;layer59_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3241.25,-1127.17C3241.25,-1127.17 3241.25,-1101.63 3241.25,-1101.63"/>
<polygon fill="black" stroke="black" points="3244.75,-1101.63 3241.25,-1091.63 3237.75,-1101.63 3244.75,-1101.63"/>
</g>
<!-- layer59_moe_comm_to_expert9&#45;&gt;layer59_moe_expert9 -->
<g id="edge3778" class="edge">
<title>layer59_moe_comm_to_expert9&#45;&gt;layer59_moe_expert9</title>
<path fill="none" stroke="black" d="M3241.25,-1215.44C3241.25,-1215.44 3241.25,-1189.79 3241.25,-1189.79"/>
<polygon fill="black" stroke="black" points="3244.75,-1189.79 3241.25,-1179.79 3237.75,-1189.79 3244.75,-1189.79"/>
</g>
<!-- layer59_moe_expert10 -->
<g id="node2943" class="node">
<title>layer59_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="3835,-1179.49 3497,-1179.49 3497,-1127.49 3835,-1127.49 3835,-1179.49"/>
<text text-anchor="middle" x="3666" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 10 L59</text>
<text text-anchor="middle" x="3666" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3666" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3666" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert10 -->
<g id="node2966" class="node">
<title>layer59_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3573" cy="-1062.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3573" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3573" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3573" y="-1049" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer59_moe_expert10&#45;&gt;layer59_moe_comm_from_expert10 -->
<g id="edge3811" class="edge">
<title>layer59_moe_expert10&#45;&gt;layer59_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3582.38,-1127.17C3582.38,-1127.17 3582.38,-1101.63 3582.38,-1101.63"/>
<polygon fill="black" stroke="black" points="3585.88,-1101.63 3582.38,-1091.63 3578.88,-1101.63 3585.88,-1101.63"/>
</g>
<!-- layer59_moe_comm_to_expert10&#45;&gt;layer59_moe_expert10 -->
<g id="edge3780" class="edge">
<title>layer59_moe_comm_to_expert10&#45;&gt;layer59_moe_expert10</title>
<path fill="none" stroke="black" d="M3582.02,-1215.44C3582.02,-1215.44 3582.02,-1189.79 3582.02,-1189.79"/>
<polygon fill="black" stroke="black" points="3585.52,-1189.79 3582.02,-1179.79 3578.52,-1189.79 3585.52,-1189.79"/>
</g>
<!-- layer59_moe_expert11 -->
<g id="node2945" class="node">
<title>layer59_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4191,-1179.49 3853,-1179.49 3853,-1127.49 4191,-1127.49 4191,-1179.49"/>
<text text-anchor="middle" x="4022" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 11 L59</text>
<text text-anchor="middle" x="4022" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4022" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="4022" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert11 -->
<g id="node2967" class="node">
<title>layer59_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="3920" cy="-1062.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3920" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="3920" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3920" y="-1049" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer59_moe_expert11&#45;&gt;layer59_moe_comm_from_expert11 -->
<g id="edge3813" class="edge">
<title>layer59_moe_expert11&#45;&gt;layer59_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M3933.88,-1127.17C3933.88,-1127.17 3933.88,-1101.3 3933.88,-1101.3"/>
<polygon fill="black" stroke="black" points="3937.38,-1101.3 3933.88,-1091.3 3930.38,-1101.3 3937.38,-1101.3"/>
</g>
<!-- layer59_moe_comm_to_expert11&#45;&gt;layer59_moe_expert11 -->
<g id="edge3782" class="edge">
<title>layer59_moe_comm_to_expert11&#45;&gt;layer59_moe_expert11</title>
<path fill="none" stroke="black" d="M3933.02,-1215.69C3933.02,-1215.69 3933.02,-1189.62 3933.02,-1189.62"/>
<polygon fill="black" stroke="black" points="3936.52,-1189.62 3933.02,-1179.62 3929.52,-1189.62 3936.52,-1189.62"/>
</g>
<!-- layer59_moe_expert12 -->
<g id="node2947" class="node">
<title>layer59_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4547,-1179.49 4209,-1179.49 4209,-1127.49 4547,-1127.49 4547,-1179.49"/>
<text text-anchor="middle" x="4378" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 12 L59</text>
<text text-anchor="middle" x="4378" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4378" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4378" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert12 -->
<g id="node2968" class="node">
<title>layer59_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4271" cy="-1062.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4271" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4271" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4271" y="-1049" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer59_moe_expert12&#45;&gt;layer59_moe_comm_from_expert12 -->
<g id="edge3815" class="edge">
<title>layer59_moe_expert12&#45;&gt;layer59_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4287.38,-1127.17C4287.38,-1127.17 4287.38,-1101.3 4287.38,-1101.3"/>
<polygon fill="black" stroke="black" points="4290.88,-1101.3 4287.38,-1091.3 4283.88,-1101.3 4290.88,-1101.3"/>
</g>
<!-- layer59_moe_comm_to_expert12&#45;&gt;layer59_moe_expert12 -->
<g id="edge3784" class="edge">
<title>layer59_moe_comm_to_expert12&#45;&gt;layer59_moe_expert12</title>
<path fill="none" stroke="black" d="M4286.52,-1215.69C4286.52,-1215.69 4286.52,-1189.62 4286.52,-1189.62"/>
<polygon fill="black" stroke="black" points="4290.02,-1189.62 4286.52,-1179.62 4283.02,-1189.62 4290.02,-1189.62"/>
</g>
<!-- layer59_moe_expert13 -->
<g id="node2949" class="node">
<title>layer59_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="4903,-1179.49 4565,-1179.49 4565,-1127.49 4903,-1127.49 4903,-1179.49"/>
<text text-anchor="middle" x="4734" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 13 L59</text>
<text text-anchor="middle" x="4734" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4734" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4734" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert13 -->
<g id="node2969" class="node">
<title>layer59_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4625" cy="-1062.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4625" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4625" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4625" y="-1049" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer59_moe_expert13&#45;&gt;layer59_moe_comm_from_expert13 -->
<g id="edge3817" class="edge">
<title>layer59_moe_expert13&#45;&gt;layer59_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4642.38,-1127.17C4642.38,-1127.17 4642.38,-1101.3 4642.38,-1101.3"/>
<polygon fill="black" stroke="black" points="4645.88,-1101.3 4642.38,-1091.3 4638.88,-1101.3 4645.88,-1101.3"/>
</g>
<!-- layer59_moe_comm_to_expert13&#45;&gt;layer59_moe_expert13 -->
<g id="edge3786" class="edge">
<title>layer59_moe_comm_to_expert13&#45;&gt;layer59_moe_expert13</title>
<path fill="none" stroke="black" d="M4641.02,-1215.69C4641.02,-1215.69 4641.02,-1189.62 4641.02,-1189.62"/>
<polygon fill="black" stroke="black" points="4644.52,-1189.62 4641.02,-1179.62 4637.52,-1189.62 4644.52,-1189.62"/>
</g>
<!-- layer59_moe_expert14 -->
<g id="node2951" class="node">
<title>layer59_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5259,-1179.49 4921,-1179.49 4921,-1127.49 5259,-1127.49 5259,-1179.49"/>
<text text-anchor="middle" x="5090" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 14 L59</text>
<text text-anchor="middle" x="5090" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5090" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5090" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert14 -->
<g id="node2970" class="node">
<title>layer59_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="4980" cy="-1062.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4980" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="4980" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4980" y="-1049" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer59_moe_expert14&#45;&gt;layer59_moe_comm_from_expert14 -->
<g id="edge3819" class="edge">
<title>layer59_moe_expert14&#45;&gt;layer59_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M4997.88,-1127.17C4997.88,-1127.17 4997.88,-1100.98 4997.88,-1100.98"/>
<polygon fill="black" stroke="black" points="5001.38,-1100.98 4997.88,-1090.98 4994.38,-1100.98 5001.38,-1100.98"/>
</g>
<!-- layer59_moe_comm_to_expert14&#45;&gt;layer59_moe_expert14 -->
<g id="edge3788" class="edge">
<title>layer59_moe_comm_to_expert14&#45;&gt;layer59_moe_expert14</title>
<path fill="none" stroke="black" d="M4996.52,-1215.69C4996.52,-1215.69 4996.52,-1189.62 4996.52,-1189.62"/>
<polygon fill="black" stroke="black" points="5000.02,-1189.62 4996.52,-1179.62 4993.02,-1189.62 5000.02,-1189.62"/>
</g>
<!-- layer59_moe_expert15 -->
<g id="node2953" class="node">
<title>layer59_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5615,-1179.49 5277,-1179.49 5277,-1127.49 5615,-1127.49 5615,-1179.49"/>
<text text-anchor="middle" x="5446" y="-1167.49" font-family="Arial" font-size="10.00">EXPERT 15 L59</text>
<text text-anchor="middle" x="5446" y="-1156.49" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5446" y="-1145.49" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5446" y="-1134.49" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_comm_from_expert15 -->
<g id="node2971" class="node">
<title>layer59_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5335" cy="-1062.5" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5335" y="-1071" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5335" y="-1060" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5335" y="-1049" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer59_moe_expert15&#45;&gt;layer59_moe_comm_from_expert15 -->
<g id="edge3821" class="edge">
<title>layer59_moe_expert15&#45;&gt;layer59_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5353.38,-1127.17C5353.38,-1127.17 5353.38,-1100.98 5353.38,-1100.98"/>
<polygon fill="black" stroke="black" points="5356.88,-1100.98 5353.38,-1090.98 5349.88,-1100.98 5356.88,-1100.98"/>
</g>
<!-- layer59_moe_comm_to_expert15&#45;&gt;layer59_moe_expert15 -->
<g id="edge3790" class="edge">
<title>layer59_moe_comm_to_expert15&#45;&gt;layer59_moe_expert15</title>
<path fill="none" stroke="black" d="M5352.02,-1215.69C5352.02,-1215.69 5352.02,-1189.62 5352.02,-1189.62"/>
<polygon fill="black" stroke="black" points="5355.52,-1189.62 5352.02,-1179.62 5348.52,-1189.62 5355.52,-1189.62"/>
</g>
<!-- layer59_moe_aggregate -->
<g id="node2955" class="node">
<title>layer59_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="3021.1,-997.5 2604.16,-997.5 2496.9,-893.5 2913.84,-893.5 3021.1,-997.5"/>
<text text-anchor="middle" x="2759" y="-959.5" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L59</text>
<text text-anchor="middle" x="2759" y="-948.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2759" y="-937.5" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2759" y="-926.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_mha -->
<g id="node2972" class="node">
<title>layer60_moe_mha</title>
<polygon fill="lightblue" stroke="black" points="2889,-857.5 2629,-857.5 2629,-805.5 2889,-805.5 2889,-857.5"/>
<text text-anchor="middle" x="2759" y="-845.5" font-family="Arial" font-size="10.00">MHA L60</text>
<text text-anchor="middle" x="2759" y="-834.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2759" y="-823.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2759" y="-812.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer59_moe_aggregate&#45;&gt;layer60_moe_mha -->
<g id="edge3890" class="edge">
<title>layer59_moe_aggregate&#45;&gt;layer60_moe_mha</title>
<path fill="none" stroke="black" d="M2759,-893.18C2759,-893.18 2759,-867.73 2759,-867.73"/>
<polygon fill="black" stroke="black" points="2762.5,-867.73 2759,-857.73 2755.5,-867.73 2762.5,-867.73"/>
</g>
<!-- layer59_moe_comm_from_expert0&#45;&gt;layer59_moe_aggregate -->
<g id="edge3792" class="edge">
<title>layer59_moe_comm_from_expert0&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M425.01,-1042.93C425.01,-1001.36 425.01,-908 425.01,-908 425.01,-908 2501.71,-908 2501.71,-908"/>
<polygon fill="black" stroke="black" points="2501.71,-911.5 2511.71,-908 2501.71,-904.5 2501.71,-911.5"/>
</g>
<!-- layer59_moe_comm_from_expert1&#45;&gt;layer59_moe_aggregate -->
<g id="edge3794" class="edge">
<title>layer59_moe_comm_from_expert1&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M790.5,-1033.59C790.5,-992.73 790.5,-923 790.5,-923 790.5,-923 2516.91,-923 2516.91,-923"/>
<polygon fill="black" stroke="black" points="2516.91,-926.5 2526.91,-923 2516.91,-919.5 2516.91,-926.5"/>
</g>
<!-- layer59_moe_comm_from_expert2&#45;&gt;layer59_moe_aggregate -->
<g id="edge3796" class="edge">
<title>layer59_moe_comm_from_expert2&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M1118,-1035.17C1118,-998.53 1118,-938 1118,-938 1118,-938 2532.78,-938 2532.78,-938"/>
<polygon fill="black" stroke="black" points="2532.78,-941.5 2542.78,-938 2532.78,-934.5 2532.78,-941.5"/>
</g>
<!-- layer59_moe_comm_from_expert3&#45;&gt;layer59_moe_aggregate -->
<g id="edge3798" class="edge">
<title>layer59_moe_comm_from_expert3&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M1381,-1036.59C1381,-1003.93 1381,-952 1381,-952 1381,-952 2547.15,-952 2547.15,-952"/>
<polygon fill="black" stroke="black" points="2547.15,-955.5 2557.15,-952 2547.15,-948.5 2547.15,-955.5"/>
</g>
<!-- layer59_moe_comm_from_expert4&#45;&gt;layer59_moe_aggregate -->
<g id="edge3800" class="edge">
<title>layer59_moe_comm_from_expert4&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M1758.51,-1049.22C1758.51,-1022.98 1758.51,-967 1758.51,-967 1758.51,-967 2562.57,-967 2562.57,-967"/>
<polygon fill="black" stroke="black" points="2562.57,-970.5 2572.57,-967 2562.57,-963.5 2562.57,-970.5"/>
</g>
<!-- layer59_moe_comm_from_expert5&#45;&gt;layer59_moe_aggregate -->
<g id="edge3802" class="edge">
<title>layer59_moe_comm_from_expert5&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M2141.51,-1037.03C2141.51,-1013.44 2141.51,-982 2141.51,-982 2141.51,-982 2577.81,-982 2577.81,-982"/>
<polygon fill="black" stroke="black" points="2577.81,-985.5 2587.81,-982 2577.81,-978.5 2577.81,-985.5"/>
</g>
<!-- layer59_moe_comm_from_expert6&#45;&gt;layer59_moe_aggregate -->
<g id="edge3804" class="edge">
<title>layer59_moe_comm_from_expert6&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M2496.68,-1062C2517.21,-1062 2533.1,-1062 2533.1,-1062 2533.1,-1062 2533.1,-955.59 2533.1,-955.59"/>
<polygon fill="black" stroke="black" points="2536.6,-955.59 2533.1,-945.59 2529.6,-955.59 2536.6,-955.59"/>
</g>
<!-- layer59_moe_comm_from_expert7&#45;&gt;layer59_moe_aggregate -->
<g id="edge3806" class="edge">
<title>layer59_moe_comm_from_expert7&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M2660,-1033.28C2660,-1033.28 2660,-1007.56 2660,-1007.56"/>
<polygon fill="black" stroke="black" points="2663.5,-1007.56 2660,-997.56 2656.5,-1007.56 2663.5,-1007.56"/>
</g>
<!-- layer59_moe_comm_from_expert8&#45;&gt;layer59_moe_aggregate -->
<g id="edge3808" class="edge">
<title>layer59_moe_comm_from_expert8&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M2931.39,-1033.28C2931.39,-1033.28 2931.39,-1007.56 2931.39,-1007.56"/>
<polygon fill="black" stroke="black" points="2934.89,-1007.56 2931.39,-997.56 2927.89,-1007.56 2934.89,-1007.56"/>
</g>
<!-- layer59_moe_comm_from_expert9&#45;&gt;layer59_moe_aggregate -->
<g id="edge3810" class="edge">
<title>layer59_moe_comm_from_expert9&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M3222.5,-1033.71C3222.5,-1011.31 3222.5,-984 3222.5,-984 3222.5,-984 3017.37,-984 3017.37,-984"/>
<polygon fill="black" stroke="black" points="3017.37,-980.5 3007.37,-984 3017.37,-987.5 3017.37,-980.5"/>
</g>
<!-- layer59_moe_comm_from_expert10&#45;&gt;layer59_moe_aggregate -->
<g id="edge3812" class="edge">
<title>layer59_moe_comm_from_expert10&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M3554.15,-1034.05C3554.15,-1007.19 3554.15,-971 3554.15,-971 3554.15,-971 3003.81,-971 3003.81,-971"/>
<polygon fill="black" stroke="black" points="3003.81,-967.5 2993.81,-971 3003.81,-974.5 3003.81,-967.5"/>
</g>
<!-- layer59_moe_comm_from_expert11&#45;&gt;layer59_moe_aggregate -->
<g id="edge3814" class="edge">
<title>layer59_moe_comm_from_expert11&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M3900.65,-1033.94C3900.65,-1003 3900.65,-958 3900.65,-958 3900.65,-958 2990.47,-958 2990.47,-958"/>
<polygon fill="black" stroke="black" points="2990.47,-954.5 2980.47,-958 2990.47,-961.5 2990.47,-954.5"/>
</g>
<!-- layer59_moe_comm_from_expert12&#45;&gt;layer59_moe_aggregate -->
<g id="edge3816" class="edge">
<title>layer59_moe_comm_from_expert12&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M4251.65,-1034.05C4251.65,-999.28 4251.65,-945 4251.65,-945 4251.65,-945 2977.33,-945 2977.33,-945"/>
<polygon fill="black" stroke="black" points="2977.33,-941.5 2967.33,-945 2977.33,-948.5 2977.33,-941.5"/>
</g>
<!-- layer59_moe_comm_from_expert13&#45;&gt;layer59_moe_aggregate -->
<g id="edge3818" class="edge">
<title>layer59_moe_comm_from_expert13&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M4605.15,-1033.86C4605.15,-995.44 4605.15,-932 4605.15,-932 4605.15,-932 2963.95,-932 2963.95,-932"/>
<polygon fill="black" stroke="black" points="2963.95,-928.5 2953.95,-932 2963.95,-935.5 2963.95,-928.5"/>
</g>
<!-- layer59_moe_comm_from_expert14&#45;&gt;layer59_moe_aggregate -->
<g id="edge3820" class="edge">
<title>layer59_moe_comm_from_expert14&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M4960.15,-1034.15C4960.15,-992.33 4960.15,-919 4960.15,-919 4960.15,-919 2950.53,-919 2950.53,-919"/>
<polygon fill="black" stroke="black" points="2950.53,-915.5 2940.53,-919 2950.53,-922.5 2950.53,-915.5"/>
</g>
<!-- layer59_moe_comm_from_expert15&#45;&gt;layer59_moe_aggregate -->
<g id="edge3822" class="edge">
<title>layer59_moe_comm_from_expert15&#45;&gt;layer59_moe_aggregate</title>
<path fill="none" stroke="black" d="M5315.15,-1033.79C5315.15,-988.61 5315.15,-906 5315.15,-906 5315.15,-906 2937.21,-906 2937.21,-906"/>
<polygon fill="black" stroke="black" points="2937.21,-902.5 2927.21,-906 2937.21,-909.5 2937.21,-902.5"/>
</g>
<!-- layer60_moe_gate -->
<g id="node2973" class="node">
<title>layer60_moe_gate</title>
<polygon fill="lightyellow" stroke="black" points="3017.3,-769.5 2606.4,-769.5 2500.7,-665.5 2911.6,-665.5 3017.3,-769.5"/>
<text text-anchor="middle" x="2759" y="-731.5" font-family="Arial" font-size="10.00">GATE L60</text>
<text text-anchor="middle" x="2759" y="-720.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2759" y="-709.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2759" y="-698.5" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, num_experts=16]</text>
</g>
<!-- layer60_moe_mha&#45;&gt;layer60_moe_gate -->
<g id="edge3891" class="edge">
<title>layer60_moe_mha&#45;&gt;layer60_moe_gate</title>
<path fill="none" stroke="black" d="M2759,-805.35C2759,-805.35 2759,-779.6 2759,-779.6"/>
<polygon fill="black" stroke="black" points="2762.5,-779.6 2759,-769.6 2755.5,-779.6 2762.5,-779.6"/>
</g>
<!-- layer60_moe_split -->
<g id="node2974" class="node">
<title>layer60_moe_split</title>
<polygon fill="lightcoral" stroke="black" points="3013.01,-629.5 2608.94,-629.5 2504.99,-525.5 2909.06,-525.5 3013.01,-629.5"/>
<text text-anchor="middle" x="2759" y="-591.5" font-family="Arial" font-size="10.00">SPLIT TOKENS L60</text>
<text text-anchor="middle" x="2759" y="-580.5" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2759" y="-569.5" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2759" y="-558.5" font-family="Arial" font-size="10.00">Output: Multiple expert&#45;specific batches</text>
</g>
<!-- layer60_moe_gate&#45;&gt;layer60_moe_split -->
<g id="edge3892" class="edge">
<title>layer60_moe_gate&#45;&gt;layer60_moe_split</title>
<path fill="none" stroke="black" d="M2759,-665.37C2759,-665.37 2759,-639.68 2759,-639.68"/>
<polygon fill="black" stroke="black" points="2762.5,-639.68 2759,-629.68 2755.5,-639.68 2762.5,-639.68"/>
</g>
<!-- layer60_moe_comm_to_expert0 -->
<g id="node2976" class="node">
<title>layer60_moe_comm_to_expert0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="311" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="311" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 0</text>
<text text-anchor="middle" x="311" y="-458.01" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="311" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 0</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert0 -->
<g id="edge3826" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2593.31,-614C2046.58,-614 334.5,-614 334.5,-614 334.5,-614 334.5,-498.67 334.5,-498.67"/>
<polygon fill="black" stroke="black" points="338,-498.67 334.5,-488.67 331,-498.67 338,-498.67"/>
</g>
<!-- layer60_moe_comm_to_expert1 -->
<g id="node2978" class="node">
<title>layer60_moe_comm_to_expert1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="804" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="804" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 1</text>
<text text-anchor="middle" x="804" y="-458.01" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="804" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 1</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert1 -->
<g id="edge3828" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2578.08,-599C2107.4,-599 881.01,-599 881.01,-599 881.01,-599 881.01,-485.86 881.01,-485.86"/>
<polygon fill="black" stroke="black" points="884.51,-485.86 881.01,-475.86 877.51,-485.86 884.51,-485.86"/>
</g>
<!-- layer60_moe_comm_to_expert2 -->
<g id="node2980" class="node">
<title>layer60_moe_comm_to_expert2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1150" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1150" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 2</text>
<text text-anchor="middle" x="1150" y="-458.01" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1150" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 2</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert2 -->
<g id="edge3830" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2563.41,-584C2146.59,-584 1208.51,-584 1208.51,-584 1208.51,-584 1208.51,-492.88 1208.51,-492.88"/>
<polygon fill="black" stroke="black" points="1212.01,-492.88 1208.51,-482.88 1205.01,-492.88 1212.01,-492.88"/>
</g>
<!-- layer60_moe_comm_to_expert3 -->
<g id="node2982" class="node">
<title>layer60_moe_comm_to_expert3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1422" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1422" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 3</text>
<text text-anchor="middle" x="1422" y="-458.01" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1422" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 3</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert3 -->
<g id="edge3832" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2549.28,-570C2184.45,-570 1471.51,-570 1471.51,-570 1471.51,-570 1471.51,-494.81 1471.51,-494.81"/>
<polygon fill="black" stroke="black" points="1475.01,-494.81 1471.51,-484.81 1468.01,-494.81 1475.01,-494.81"/>
</g>
<!-- layer60_moe_comm_to_expert4 -->
<g id="node2984" class="node">
<title>layer60_moe_comm_to_expert4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1658" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1658" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 4</text>
<text text-anchor="middle" x="1658" y="-458.01" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1658" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 4</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert4 -->
<g id="edge3834" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2534.27,-555C2214.89,-555 1668,-555 1668,-555 1668,-555 1668,-499.38 1668,-499.38"/>
<polygon fill="black" stroke="black" points="1671.5,-499.38 1668,-489.38 1664.5,-499.38 1671.5,-499.38"/>
</g>
<!-- layer60_moe_comm_to_expert5 -->
<g id="node2986" class="node">
<title>layer60_moe_comm_to_expert5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2005" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2005" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 5</text>
<text text-anchor="middle" x="2005" y="-458.01" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2005" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 5</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert5 -->
<g id="edge3836" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2519.3,-540C2313.91,-540 2051,-540 2051,-540 2051,-540 2051,-495.66 2051,-495.66"/>
<polygon fill="black" stroke="black" points="2054.5,-495.66 2051,-485.66 2047.5,-495.66 2054.5,-495.66"/>
</g>
<!-- layer60_moe_comm_to_expert6 -->
<g id="node2988" class="node">
<title>layer60_moe_comm_to_expert6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2351" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2351" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 6</text>
<text text-anchor="middle" x="2351" y="-458.01" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2351" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 6</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert6 -->
<g id="edge3838" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2518.74,-577.42C2518.74,-573.86 2518.74,-460 2518.74,-460 2518.74,-460 2451.74,-460 2451.74,-460"/>
<polygon fill="black" stroke="black" points="2451.74,-456.5 2441.74,-460 2451.74,-463.5 2451.74,-456.5"/>
</g>
<!-- layer60_moe_comm_to_expert7 -->
<g id="node2990" class="node">
<title>layer60_moe_comm_to_expert7</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2623" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2623" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 7</text>
<text text-anchor="middle" x="2623" y="-458.01" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2623" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 7</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert7 -->
<g id="edge3840" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2623,-525.17C2623,-525.17 2623,-499.72 2623,-499.72"/>
<polygon fill="black" stroke="black" points="2626.5,-499.72 2623,-489.72 2619.5,-499.72 2626.5,-499.72"/>
</g>
<!-- layer60_moe_comm_to_expert8 -->
<g id="node2992" class="node">
<title>layer60_moe_comm_to_expert8</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2895" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2895" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 8</text>
<text text-anchor="middle" x="2895" y="-458.01" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2895" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 8</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert8 -->
<g id="edge3842" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2895,-525.17C2895,-525.17 2895,-499.72 2895,-499.72"/>
<polygon fill="black" stroke="black" points="2898.5,-499.72 2895,-489.72 2891.5,-499.72 2898.5,-499.72"/>
</g>
<!-- layer60_moe_comm_to_expert9 -->
<g id="node2994" class="node">
<title>layer60_moe_comm_to_expert9</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3204" cy="-460.51" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3204" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 9</text>
<text text-anchor="middle" x="3204" y="-458.01" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3204" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 9</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert9 -->
<g id="edge3844" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2999.26,-577.42C2999.26,-573.86 2999.26,-460 2999.26,-460 2999.26,-460 3103.3,-460 3103.3,-460"/>
<polygon fill="black" stroke="black" points="3103.3,-463.5 3113.3,-460 3103.3,-456.5 3103.3,-463.5"/>
</g>
<!-- layer60_moe_comm_to_expert10 -->
<g id="node2996" class="node">
<title>layer60_moe_comm_to_expert10</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3536" cy="-460.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3536" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 10</text>
<text text-anchor="middle" x="3536" y="-458.01" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3536" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 10</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert10 -->
<g id="edge3846" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2923.82,-540C3131.07,-540 3460.1,-540 3460.1,-540 3460.1,-540 3460.1,-487.76 3460.1,-487.76"/>
<polygon fill="black" stroke="black" points="3463.6,-487.76 3460.1,-477.76 3456.6,-487.76 3463.6,-487.76"/>
</g>
<!-- layer60_moe_comm_to_expert11 -->
<g id="node2998" class="node">
<title>layer60_moe_comm_to_expert11</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="3882" cy="-460.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="3882" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 11</text>
<text text-anchor="middle" x="3882" y="-458.01" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3882" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 11</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert11 -->
<g id="edge3848" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2938.79,-555C3238.24,-555 3806.6,-555 3806.6,-555 3806.6,-555 3806.6,-487.84 3806.6,-487.84"/>
<polygon fill="black" stroke="black" points="3810.1,-487.84 3806.6,-477.84 3803.1,-487.84 3810.1,-487.84"/>
</g>
<!-- layer60_moe_comm_to_expert12 -->
<g id="node3000" class="node">
<title>layer60_moe_comm_to_expert12</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4233" cy="-460.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4233" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 12</text>
<text text-anchor="middle" x="4233" y="-458.01" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4233" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 12</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert12 -->
<g id="edge3850" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2953.84,-570C3338.29,-570 4157.6,-570 4157.6,-570 4157.6,-570 4157.6,-488.1 4157.6,-488.1"/>
<polygon fill="black" stroke="black" points="4161.1,-488.1 4157.6,-478.1 4154.1,-488.1 4161.1,-488.1"/>
</g>
<!-- layer60_moe_comm_to_expert13 -->
<g id="node3002" class="node">
<title>layer60_moe_comm_to_expert13</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4586" cy="-460.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4586" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 13</text>
<text text-anchor="middle" x="4586" y="-458.01" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4586" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 13</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert13 -->
<g id="edge3852" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2967.74,-584C3432.33,-584 4511.1,-584 4511.1,-584 4511.1,-584 4511.1,-488.21 4511.1,-488.21"/>
<polygon fill="black" stroke="black" points="4514.6,-488.21 4511.1,-478.21 4507.6,-488.21 4514.6,-488.21"/>
</g>
<!-- layer60_moe_comm_to_expert14 -->
<g id="node3004" class="node">
<title>layer60_moe_comm_to_expert14</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="4941" cy="-460.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="4941" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 14</text>
<text text-anchor="middle" x="4941" y="-458.01" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4941" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 14</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert14 -->
<g id="edge3854" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2983,-599C3525.61,-599 4866.1,-599 4866.1,-599 4866.1,-599 4866.1,-488.05 4866.1,-488.05"/>
<polygon fill="black" stroke="black" points="4869.6,-488.05 4866.1,-478.05 4862.6,-488.05 4869.6,-488.05"/>
</g>
<!-- layer60_moe_comm_to_expert15 -->
<g id="node3006" class="node">
<title>layer60_moe_comm_to_expert15</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="5296" cy="-460.51" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5296" y="-469.01" font-family="Arial" font-size="10.00">SEND TO EXPERT 15</text>
<text text-anchor="middle" x="5296" y="-458.01" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5296" y="-447.01" font-family="Arial" font-size="10.00">Tokens routed to expert 15</text>
</g>
<!-- layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert15 -->
<g id="edge3856" class="edge">
<title>layer60_moe_split&#45;&gt;layer60_moe_comm_to_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2997.59,-614C3615.69,-614 5221.1,-614 5221.1,-614 5221.1,-614 5221.1,-488.12 5221.1,-488.12"/>
<polygon fill="black" stroke="black" points="5224.6,-488.12 5221.1,-478.12 5217.6,-488.12 5224.6,-488.12"/>
</g>
<!-- layer60_moe_expert0 -->
<g id="node2975" class="node">
<title>layer60_moe_expert0</title>
<polygon fill="lightblue" stroke="black" points="328,-395.52 0,-395.52 0,-343.52 328,-343.52 328,-395.52"/>
<text text-anchor="middle" x="164" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 0 L60</text>
<text text-anchor="middle" x="164" y="-372.52" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="164" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
<text text-anchor="middle" x="164" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert0 -->
<g id="node3008" class="node">
<title>layer60_moe_comm_from_expert0</title>
<ellipse fill="lightgreen" stroke="black" cx="384" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="384" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 0</text>
<text text-anchor="middle" x="384" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="384" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 0</text>
</g>
<!-- layer60_moe_expert0&#45;&gt;layer60_moe_comm_from_expert0 -->
<g id="edge3858" class="edge">
<title>layer60_moe_expert0&#45;&gt;layer60_moe_comm_from_expert0</title>
<path fill="none" stroke="black" d="M310.75,-343.2C310.75,-343.2 310.75,-305.6 310.75,-305.6"/>
<polygon fill="black" stroke="black" points="314.25,-305.6 310.75,-295.6 307.25,-305.6 314.25,-305.6"/>
</g>
<!-- layer60_moe_comm_to_expert0&#45;&gt;layer60_moe_expert0 -->
<g id="edge3827" class="edge">
<title>layer60_moe_comm_to_expert0&#45;&gt;layer60_moe_expert0</title>
<path fill="none" stroke="black" d="M274.25,-433.7C274.25,-433.7 274.25,-405.83 274.25,-405.83"/>
<polygon fill="black" stroke="black" points="277.75,-405.83 274.25,-395.83 270.75,-405.83 277.75,-405.83"/>
</g>
<!-- layer60_moe_expert1 -->
<g id="node2977" class="node">
<title>layer60_moe_expert1</title>
<polygon fill="lightblue" stroke="black" points="674,-395.52 346,-395.52 346,-343.52 674,-343.52 674,-395.52"/>
<text text-anchor="middle" x="510" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 1 L60</text>
<text text-anchor="middle" x="510" y="-372.52" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="510" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
<text text-anchor="middle" x="510" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert1 -->
<g id="node3009" class="node">
<title>layer60_moe_comm_from_expert1</title>
<ellipse fill="lightgreen" stroke="black" cx="749" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="749" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 1</text>
<text text-anchor="middle" x="749" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="749" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 1</text>
</g>
<!-- layer60_moe_expert1&#45;&gt;layer60_moe_comm_from_expert1 -->
<g id="edge3860" class="edge">
<title>layer60_moe_expert1&#45;&gt;layer60_moe_comm_from_expert1</title>
<path fill="none" stroke="black" d="M666.25,-343.2C666.25,-343.2 666.25,-300.43 666.25,-300.43"/>
<polygon fill="black" stroke="black" points="669.75,-300.43 666.25,-290.43 662.75,-300.43 669.75,-300.43"/>
</g>
<!-- layer60_moe_comm_to_expert1&#45;&gt;layer60_moe_expert1 -->
<g id="edge3829" class="edge">
<title>layer60_moe_comm_to_expert1&#45;&gt;layer60_moe_expert1</title>
<path fill="none" stroke="black" d="M713.27,-460C644.32,-460 561.25,-460 561.25,-460 561.25,-460 561.25,-405.69 561.25,-405.69"/>
<polygon fill="black" stroke="black" points="564.75,-405.69 561.25,-395.69 557.75,-405.69 564.75,-405.69"/>
</g>
<!-- layer60_moe_expert2 -->
<g id="node2979" class="node">
<title>layer60_moe_expert2</title>
<polygon fill="lightblue" stroke="black" points="1020,-395.52 692,-395.52 692,-343.52 1020,-343.52 1020,-395.52"/>
<text text-anchor="middle" x="856" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 2 L60</text>
<text text-anchor="middle" x="856" y="-372.52" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="856" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
<text text-anchor="middle" x="856" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert2 -->
<g id="node3010" class="node">
<title>layer60_moe_comm_from_expert2</title>
<ellipse fill="lightgreen" stroke="black" cx="1058" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1058" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 2</text>
<text text-anchor="middle" x="1058" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1058" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 2</text>
</g>
<!-- layer60_moe_expert2&#45;&gt;layer60_moe_comm_from_expert2 -->
<g id="edge3862" class="edge">
<title>layer60_moe_expert2&#45;&gt;layer60_moe_comm_from_expert2</title>
<path fill="none" stroke="black" d="M993.75,-343.2C993.75,-343.2 993.75,-309.01 993.75,-309.01"/>
<polygon fill="black" stroke="black" points="997.25,-309.01 993.75,-299.01 990.25,-309.01 997.25,-309.01"/>
</g>
<!-- layer60_moe_comm_to_expert2&#45;&gt;layer60_moe_expert2 -->
<g id="edge3831" class="edge">
<title>layer60_moe_comm_to_expert2&#45;&gt;layer60_moe_expert2</title>
<path fill="none" stroke="black" d="M1059.1,-460C1031.22,-460 1007.75,-460 1007.75,-460 1007.75,-460 1007.75,-405.69 1007.75,-405.69"/>
<polygon fill="black" stroke="black" points="1011.25,-405.69 1007.75,-395.69 1004.25,-405.69 1011.25,-405.69"/>
</g>
<!-- layer60_moe_expert3 -->
<g id="node2981" class="node">
<title>layer60_moe_expert3</title>
<polygon fill="lightblue" stroke="black" points="1366,-395.52 1038,-395.52 1038,-343.52 1366,-343.52 1366,-395.52"/>
<text text-anchor="middle" x="1202" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 3 L60</text>
<text text-anchor="middle" x="1202" y="-372.52" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1202" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
<text text-anchor="middle" x="1202" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert3 -->
<g id="node3011" class="node">
<title>layer60_moe_comm_from_expert3</title>
<ellipse fill="lightgreen" stroke="black" cx="1312" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1312" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 3</text>
<text text-anchor="middle" x="1312" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1312" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 3</text>
</g>
<!-- layer60_moe_expert3&#45;&gt;layer60_moe_comm_from_expert3 -->
<g id="edge3864" class="edge">
<title>layer60_moe_expert3&#45;&gt;layer60_moe_comm_from_expert3</title>
<path fill="none" stroke="black" d="M1293.75,-343.2C1293.75,-343.2 1293.75,-317.02 1293.75,-317.02"/>
<polygon fill="black" stroke="black" points="1297.25,-317.02 1293.75,-307.02 1290.25,-317.02 1297.25,-317.02"/>
</g>
<!-- layer60_moe_comm_to_expert3&#45;&gt;layer60_moe_expert3 -->
<g id="edge3833" class="edge">
<title>layer60_moe_comm_to_expert3&#45;&gt;layer60_moe_expert3</title>
<path fill="none" stroke="black" d="M1348.75,-443.4C1348.75,-443.4 1348.75,-405.87 1348.75,-405.87"/>
<polygon fill="black" stroke="black" points="1352.25,-405.87 1348.75,-395.87 1345.25,-405.87 1352.25,-405.87"/>
</g>
<!-- layer60_moe_expert4 -->
<g id="node2983" class="node">
<title>layer60_moe_expert4</title>
<polygon fill="lightblue" stroke="black" points="1712,-395.52 1384,-395.52 1384,-343.52 1712,-343.52 1712,-395.52"/>
<text text-anchor="middle" x="1548" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 4 L60</text>
<text text-anchor="middle" x="1548" y="-372.52" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1548" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
<text text-anchor="middle" x="1548" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert4 -->
<g id="node3012" class="node">
<title>layer60_moe_comm_from_expert4</title>
<ellipse fill="lightgreen" stroke="black" cx="1732" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="1732" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 4</text>
<text text-anchor="middle" x="1732" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1732" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 4</text>
</g>
<!-- layer60_moe_expert4&#45;&gt;layer60_moe_comm_from_expert4 -->
<g id="edge3866" class="edge">
<title>layer60_moe_expert4&#45;&gt;layer60_moe_comm_from_expert4</title>
<path fill="none" stroke="black" d="M1676.75,-343.2C1676.75,-343.2 1676.75,-311.7 1676.75,-311.7"/>
<polygon fill="black" stroke="black" points="1680.25,-311.7 1676.75,-301.7 1673.25,-311.7 1680.25,-311.7"/>
</g>
<!-- layer60_moe_comm_to_expert4&#45;&gt;layer60_moe_expert4 -->
<g id="edge3835" class="edge">
<title>layer60_moe_comm_to_expert4&#45;&gt;layer60_moe_expert4</title>
<path fill="none" stroke="black" d="M1639.75,-431.72C1639.75,-431.72 1639.75,-405.66 1639.75,-405.66"/>
<polygon fill="black" stroke="black" points="1643.25,-405.66 1639.75,-395.66 1636.25,-405.66 1643.25,-405.66"/>
</g>
<!-- layer60_moe_expert5 -->
<g id="node2985" class="node">
<title>layer60_moe_expert5</title>
<polygon fill="lightblue" stroke="black" points="2058,-395.52 1730,-395.52 1730,-343.52 2058,-343.52 2058,-395.52"/>
<text text-anchor="middle" x="1894" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 5 L60</text>
<text text-anchor="middle" x="1894" y="-372.52" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1894" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
<text text-anchor="middle" x="1894" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert5 -->
<g id="node3013" class="node">
<title>layer60_moe_comm_from_expert5</title>
<ellipse fill="lightgreen" stroke="black" cx="2004" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2004" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 5</text>
<text text-anchor="middle" x="2004" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2004" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 5</text>
</g>
<!-- layer60_moe_expert5&#45;&gt;layer60_moe_comm_from_expert5 -->
<g id="edge3868" class="edge">
<title>layer60_moe_expert5&#45;&gt;layer60_moe_comm_from_expert5</title>
<path fill="none" stroke="black" d="M1985.75,-343.2C1985.75,-343.2 1985.75,-317.02 1985.75,-317.02"/>
<polygon fill="black" stroke="black" points="1989.25,-317.02 1985.75,-307.02 1982.25,-317.02 1989.25,-317.02"/>
</g>
<!-- layer60_moe_comm_to_expert5&#45;&gt;layer60_moe_expert5 -->
<g id="edge3837" class="edge">
<title>layer60_moe_comm_to_expert5&#45;&gt;layer60_moe_expert5</title>
<path fill="none" stroke="black" d="M1986.25,-431.72C1986.25,-431.72 1986.25,-405.66 1986.25,-405.66"/>
<polygon fill="black" stroke="black" points="1989.75,-405.66 1986.25,-395.66 1982.75,-405.66 1989.75,-405.66"/>
</g>
<!-- layer60_moe_expert6 -->
<g id="node2987" class="node">
<title>layer60_moe_expert6</title>
<polygon fill="lightblue" stroke="black" points="2404,-395.52 2076,-395.52 2076,-343.52 2404,-343.52 2404,-395.52"/>
<text text-anchor="middle" x="2240" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 6 L60</text>
<text text-anchor="middle" x="2240" y="-372.52" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2240" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
<text text-anchor="middle" x="2240" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert6 -->
<g id="node3014" class="node">
<title>layer60_moe_comm_from_expert6</title>
<ellipse fill="lightgreen" stroke="black" cx="2351" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2351" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 6</text>
<text text-anchor="middle" x="2351" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2351" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 6</text>
</g>
<!-- layer60_moe_expert6&#45;&gt;layer60_moe_comm_from_expert6 -->
<g id="edge3870" class="edge">
<title>layer60_moe_expert6&#45;&gt;layer60_moe_comm_from_expert6</title>
<path fill="none" stroke="black" d="M2332.25,-343.2C2332.25,-343.2 2332.25,-317.02 2332.25,-317.02"/>
<polygon fill="black" stroke="black" points="2335.75,-317.02 2332.25,-307.02 2328.75,-317.02 2335.75,-317.02"/>
</g>
<!-- layer60_moe_comm_to_expert6&#45;&gt;layer60_moe_expert6 -->
<g id="edge3839" class="edge">
<title>layer60_moe_comm_to_expert6&#45;&gt;layer60_moe_expert6</title>
<path fill="none" stroke="black" d="M2332.25,-431.72C2332.25,-431.72 2332.25,-405.66 2332.25,-405.66"/>
<polygon fill="black" stroke="black" points="2335.75,-405.66 2332.25,-395.66 2328.75,-405.66 2335.75,-405.66"/>
</g>
<!-- layer60_moe_expert7 -->
<g id="node2989" class="node">
<title>layer60_moe_expert7</title>
<polygon fill="lightblue" stroke="black" points="2750,-395.52 2422,-395.52 2422,-343.52 2750,-343.52 2750,-395.52"/>
<text text-anchor="middle" x="2586" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 7 L60</text>
<text text-anchor="middle" x="2586" y="-372.52" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2586" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
<text text-anchor="middle" x="2586" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert7 -->
<g id="node3015" class="node">
<title>layer60_moe_comm_from_expert7</title>
<ellipse fill="lightgreen" stroke="black" cx="2623" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2623" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 7</text>
<text text-anchor="middle" x="2623" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2623" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 7</text>
</g>
<!-- layer60_moe_expert7&#45;&gt;layer60_moe_comm_from_expert7 -->
<g id="edge3872" class="edge">
<title>layer60_moe_expert7&#45;&gt;layer60_moe_comm_from_expert7</title>
<path fill="none" stroke="black" d="M2623,-343.2C2623,-343.2 2623,-317.66 2623,-317.66"/>
<polygon fill="black" stroke="black" points="2626.5,-317.66 2623,-307.66 2619.5,-317.66 2626.5,-317.66"/>
</g>
<!-- layer60_moe_comm_to_expert7&#45;&gt;layer60_moe_expert7 -->
<g id="edge3841" class="edge">
<title>layer60_moe_comm_to_expert7&#45;&gt;layer60_moe_expert7</title>
<path fill="none" stroke="black" d="M2623,-431.47C2623,-431.47 2623,-405.82 2623,-405.82"/>
<polygon fill="black" stroke="black" points="2626.5,-405.82 2623,-395.82 2619.5,-405.82 2626.5,-405.82"/>
</g>
<!-- layer60_moe_expert8 -->
<g id="node2991" class="node">
<title>layer60_moe_expert8</title>
<polygon fill="lightblue" stroke="black" points="3096,-395.52 2768,-395.52 2768,-343.52 3096,-343.52 3096,-395.52"/>
<text text-anchor="middle" x="2932" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 8 L60</text>
<text text-anchor="middle" x="2932" y="-372.52" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2932" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
<text text-anchor="middle" x="2932" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert8 -->
<g id="node3016" class="node">
<title>layer60_moe_comm_from_expert8</title>
<ellipse fill="lightgreen" stroke="black" cx="2895" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="2895" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 8</text>
<text text-anchor="middle" x="2895" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2895" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 8</text>
</g>
<!-- layer60_moe_expert8&#45;&gt;layer60_moe_comm_from_expert8 -->
<g id="edge3874" class="edge">
<title>layer60_moe_expert8&#45;&gt;layer60_moe_comm_from_expert8</title>
<path fill="none" stroke="black" d="M2895,-343.2C2895,-343.2 2895,-317.66 2895,-317.66"/>
<polygon fill="black" stroke="black" points="2898.5,-317.66 2895,-307.66 2891.5,-317.66 2898.5,-317.66"/>
</g>
<!-- layer60_moe_comm_to_expert8&#45;&gt;layer60_moe_expert8 -->
<g id="edge3843" class="edge">
<title>layer60_moe_comm_to_expert8&#45;&gt;layer60_moe_expert8</title>
<path fill="none" stroke="black" d="M2895,-431.47C2895,-431.47 2895,-405.82 2895,-405.82"/>
<polygon fill="black" stroke="black" points="2898.5,-405.82 2895,-395.82 2891.5,-405.82 2898.5,-405.82"/>
</g>
<!-- layer60_moe_expert9 -->
<g id="node2993" class="node">
<title>layer60_moe_expert9</title>
<polygon fill="lightblue" stroke="black" points="3442,-395.52 3114,-395.52 3114,-343.52 3442,-343.52 3442,-395.52"/>
<text text-anchor="middle" x="3278" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 9 L60</text>
<text text-anchor="middle" x="3278" y="-372.52" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3278" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
<text text-anchor="middle" x="3278" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert9 -->
<g id="node3017" class="node">
<title>layer60_moe_comm_from_expert9</title>
<ellipse fill="lightgreen" stroke="black" cx="3204" cy="-278.53" rx="90.52" ry="28.98"/>
<text text-anchor="middle" x="3204" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 9</text>
<text text-anchor="middle" x="3204" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3204" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 9</text>
</g>
<!-- layer60_moe_expert9&#45;&gt;layer60_moe_comm_from_expert9 -->
<g id="edge3876" class="edge">
<title>layer60_moe_expert9&#45;&gt;layer60_moe_comm_from_expert9</title>
<path fill="none" stroke="black" d="M3204.25,-343.2C3204.25,-343.2 3204.25,-317.66 3204.25,-317.66"/>
<polygon fill="black" stroke="black" points="3207.75,-317.66 3204.25,-307.66 3200.75,-317.66 3207.75,-317.66"/>
</g>
<!-- layer60_moe_comm_to_expert9&#45;&gt;layer60_moe_expert9 -->
<g id="edge3845" class="edge">
<title>layer60_moe_comm_to_expert9&#45;&gt;layer60_moe_expert9</title>
<path fill="none" stroke="black" d="M3204.25,-431.47C3204.25,-431.47 3204.25,-405.82 3204.25,-405.82"/>
<polygon fill="black" stroke="black" points="3207.75,-405.82 3204.25,-395.82 3200.75,-405.82 3207.75,-405.82"/>
</g>
<!-- layer60_moe_expert10 -->
<g id="node2995" class="node">
<title>layer60_moe_expert10</title>
<polygon fill="lightblue" stroke="black" points="3798,-395.52 3460,-395.52 3460,-343.52 3798,-343.52 3798,-395.52"/>
<text text-anchor="middle" x="3629" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 10 L60</text>
<text text-anchor="middle" x="3629" y="-372.52" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="3629" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
<text text-anchor="middle" x="3629" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert10 -->
<g id="node3018" class="node">
<title>layer60_moe_comm_from_expert10</title>
<ellipse fill="lightgreen" stroke="black" cx="3536" cy="-278.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3536" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 10</text>
<text text-anchor="middle" x="3536" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3536" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 10</text>
</g>
<!-- layer60_moe_expert10&#45;&gt;layer60_moe_comm_from_expert10 -->
<g id="edge3878" class="edge">
<title>layer60_moe_expert10&#45;&gt;layer60_moe_comm_from_expert10</title>
<path fill="none" stroke="black" d="M3545.38,-343.2C3545.38,-343.2 3545.38,-317.66 3545.38,-317.66"/>
<polygon fill="black" stroke="black" points="3548.88,-317.66 3545.38,-307.66 3541.88,-317.66 3548.88,-317.66"/>
</g>
<!-- layer60_moe_comm_to_expert10&#45;&gt;layer60_moe_expert10 -->
<g id="edge3847" class="edge">
<title>layer60_moe_comm_to_expert10&#45;&gt;layer60_moe_expert10</title>
<path fill="none" stroke="black" d="M3545.02,-431.47C3545.02,-431.47 3545.02,-405.82 3545.02,-405.82"/>
<polygon fill="black" stroke="black" points="3548.52,-405.82 3545.02,-395.82 3541.52,-405.82 3548.52,-405.82"/>
</g>
<!-- layer60_moe_expert11 -->
<g id="node2997" class="node">
<title>layer60_moe_expert11</title>
<polygon fill="lightblue" stroke="black" points="4154,-395.52 3816,-395.52 3816,-343.52 4154,-343.52 4154,-395.52"/>
<text text-anchor="middle" x="3985" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 11 L60</text>
<text text-anchor="middle" x="3985" y="-372.52" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3985" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
<text text-anchor="middle" x="3985" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert11 -->
<g id="node3019" class="node">
<title>layer60_moe_comm_from_expert11</title>
<ellipse fill="lightgreen" stroke="black" cx="3883" cy="-278.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="3883" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 11</text>
<text text-anchor="middle" x="3883" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3883" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 11</text>
</g>
<!-- layer60_moe_expert11&#45;&gt;layer60_moe_comm_from_expert11 -->
<g id="edge3880" class="edge">
<title>layer60_moe_expert11&#45;&gt;layer60_moe_comm_from_expert11</title>
<path fill="none" stroke="black" d="M3896.88,-343.2C3896.88,-343.2 3896.88,-317.34 3896.88,-317.34"/>
<polygon fill="black" stroke="black" points="3900.38,-317.34 3896.88,-307.34 3893.38,-317.34 3900.38,-317.34"/>
</g>
<!-- layer60_moe_comm_to_expert11&#45;&gt;layer60_moe_expert11 -->
<g id="edge3849" class="edge">
<title>layer60_moe_comm_to_expert11&#45;&gt;layer60_moe_expert11</title>
<path fill="none" stroke="black" d="M3896.02,-431.72C3896.02,-431.72 3896.02,-405.66 3896.02,-405.66"/>
<polygon fill="black" stroke="black" points="3899.52,-405.66 3896.02,-395.66 3892.52,-405.66 3899.52,-405.66"/>
</g>
<!-- layer60_moe_expert12 -->
<g id="node2999" class="node">
<title>layer60_moe_expert12</title>
<polygon fill="lightblue" stroke="black" points="4510,-395.52 4172,-395.52 4172,-343.52 4510,-343.52 4510,-395.52"/>
<text text-anchor="middle" x="4341" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 12 L60</text>
<text text-anchor="middle" x="4341" y="-372.52" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4341" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
<text text-anchor="middle" x="4341" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert12 -->
<g id="node3020" class="node">
<title>layer60_moe_comm_from_expert12</title>
<ellipse fill="lightgreen" stroke="black" cx="4234" cy="-278.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4234" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 12</text>
<text text-anchor="middle" x="4234" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4234" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 12</text>
</g>
<!-- layer60_moe_expert12&#45;&gt;layer60_moe_comm_from_expert12 -->
<g id="edge3882" class="edge">
<title>layer60_moe_expert12&#45;&gt;layer60_moe_comm_from_expert12</title>
<path fill="none" stroke="black" d="M4250.38,-343.2C4250.38,-343.2 4250.38,-317.34 4250.38,-317.34"/>
<polygon fill="black" stroke="black" points="4253.88,-317.34 4250.38,-307.34 4246.88,-317.34 4253.88,-317.34"/>
</g>
<!-- layer60_moe_comm_to_expert12&#45;&gt;layer60_moe_expert12 -->
<g id="edge3851" class="edge">
<title>layer60_moe_comm_to_expert12&#45;&gt;layer60_moe_expert12</title>
<path fill="none" stroke="black" d="M4249.52,-431.72C4249.52,-431.72 4249.52,-405.66 4249.52,-405.66"/>
<polygon fill="black" stroke="black" points="4253.02,-405.66 4249.52,-395.66 4246.02,-405.66 4253.02,-405.66"/>
</g>
<!-- layer60_moe_expert13 -->
<g id="node3001" class="node">
<title>layer60_moe_expert13</title>
<polygon fill="lightblue" stroke="black" points="4866,-395.52 4528,-395.52 4528,-343.52 4866,-343.52 4866,-395.52"/>
<text text-anchor="middle" x="4697" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 13 L60</text>
<text text-anchor="middle" x="4697" y="-372.52" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="4697" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
<text text-anchor="middle" x="4697" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert13 -->
<g id="node3021" class="node">
<title>layer60_moe_comm_from_expert13</title>
<ellipse fill="lightgreen" stroke="black" cx="4588" cy="-278.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4588" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 13</text>
<text text-anchor="middle" x="4588" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4588" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 13</text>
</g>
<!-- layer60_moe_expert13&#45;&gt;layer60_moe_comm_from_expert13 -->
<g id="edge3884" class="edge">
<title>layer60_moe_expert13&#45;&gt;layer60_moe_comm_from_expert13</title>
<path fill="none" stroke="black" d="M4605.38,-343.2C4605.38,-343.2 4605.38,-317.34 4605.38,-317.34"/>
<polygon fill="black" stroke="black" points="4608.88,-317.34 4605.38,-307.34 4601.88,-317.34 4608.88,-317.34"/>
</g>
<!-- layer60_moe_comm_to_expert13&#45;&gt;layer60_moe_expert13 -->
<g id="edge3853" class="edge">
<title>layer60_moe_comm_to_expert13&#45;&gt;layer60_moe_expert13</title>
<path fill="none" stroke="black" d="M4604.02,-431.72C4604.02,-431.72 4604.02,-405.66 4604.02,-405.66"/>
<polygon fill="black" stroke="black" points="4607.52,-405.66 4604.02,-395.66 4600.52,-405.66 4607.52,-405.66"/>
</g>
<!-- layer60_moe_expert14 -->
<g id="node3003" class="node">
<title>layer60_moe_expert14</title>
<polygon fill="lightblue" stroke="black" points="5222,-395.52 4884,-395.52 4884,-343.52 5222,-343.52 5222,-395.52"/>
<text text-anchor="middle" x="5053" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 14 L60</text>
<text text-anchor="middle" x="5053" y="-372.52" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5053" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
<text text-anchor="middle" x="5053" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert14 -->
<g id="node3022" class="node">
<title>layer60_moe_comm_from_expert14</title>
<ellipse fill="lightgreen" stroke="black" cx="4943" cy="-278.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="4943" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 14</text>
<text text-anchor="middle" x="4943" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4943" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 14</text>
</g>
<!-- layer60_moe_expert14&#45;&gt;layer60_moe_comm_from_expert14 -->
<g id="edge3886" class="edge">
<title>layer60_moe_expert14&#45;&gt;layer60_moe_comm_from_expert14</title>
<path fill="none" stroke="black" d="M4960.88,-343.2C4960.88,-343.2 4960.88,-317.02 4960.88,-317.02"/>
<polygon fill="black" stroke="black" points="4964.38,-317.02 4960.88,-307.02 4957.38,-317.02 4964.38,-317.02"/>
</g>
<!-- layer60_moe_comm_to_expert14&#45;&gt;layer60_moe_expert14 -->
<g id="edge3855" class="edge">
<title>layer60_moe_comm_to_expert14&#45;&gt;layer60_moe_expert14</title>
<path fill="none" stroke="black" d="M4959.52,-431.72C4959.52,-431.72 4959.52,-405.66 4959.52,-405.66"/>
<polygon fill="black" stroke="black" points="4963.02,-405.66 4959.52,-395.66 4956.02,-405.66 4963.02,-405.66"/>
</g>
<!-- layer60_moe_expert15 -->
<g id="node3005" class="node">
<title>layer60_moe_expert15</title>
<polygon fill="lightblue" stroke="black" points="5578,-395.52 5240,-395.52 5240,-343.52 5578,-343.52 5578,-395.52"/>
<text text-anchor="middle" x="5409" y="-383.52" font-family="Arial" font-size="10.00">EXPERT 15 L60</text>
<text text-anchor="middle" x="5409" y="-372.52" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5409" y="-361.52" font-family="Arial" font-size="10.00">Input: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
<text text-anchor="middle" x="5409" y="-350.52" font-family="Arial" font-size="10.00">Output: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_comm_from_expert15 -->
<g id="node3023" class="node">
<title>layer60_moe_comm_from_expert15</title>
<ellipse fill="lightgreen" stroke="black" cx="5298" cy="-278.53" rx="94.51" ry="28.98"/>
<text text-anchor="middle" x="5298" y="-287.03" font-family="Arial" font-size="10.00">RECV FROM EXPERT 15</text>
<text text-anchor="middle" x="5298" y="-276.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5298" y="-265.03" font-family="Arial" font-size="10.00">Output from expert 15</text>
</g>
<!-- layer60_moe_expert15&#45;&gt;layer60_moe_comm_from_expert15 -->
<g id="edge3888" class="edge">
<title>layer60_moe_expert15&#45;&gt;layer60_moe_comm_from_expert15</title>
<path fill="none" stroke="black" d="M5316.38,-343.2C5316.38,-343.2 5316.38,-317.02 5316.38,-317.02"/>
<polygon fill="black" stroke="black" points="5319.88,-317.02 5316.38,-307.02 5312.88,-317.02 5319.88,-317.02"/>
</g>
<!-- layer60_moe_comm_to_expert15&#45;&gt;layer60_moe_expert15 -->
<g id="edge3857" class="edge">
<title>layer60_moe_comm_to_expert15&#45;&gt;layer60_moe_expert15</title>
<path fill="none" stroke="black" d="M5315.02,-431.72C5315.02,-431.72 5315.02,-405.66 5315.02,-405.66"/>
<polygon fill="black" stroke="black" points="5318.52,-405.66 5315.02,-395.66 5311.52,-405.66 5318.52,-405.66"/>
</g>
<!-- layer60_moe_aggregate -->
<g id="node3007" class="node">
<title>layer60_moe_aggregate</title>
<polygon fill="lightcoral" stroke="black" points="2984.1,-213.54 2567.16,-213.54 2459.9,-109.54 2876.84,-109.54 2984.1,-213.54"/>
<text text-anchor="middle" x="2722" y="-175.54" font-family="Arial" font-size="10.00">AGGREGATE EXPERTS L60</text>
<text text-anchor="middle" x="2722" y="-164.54" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2722" y="-153.54" font-family="Arial" font-size="10.00">Input: Multiple expert outputs</text>
<text text-anchor="middle" x="2722" y="-142.54" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- output -->
<g id="node3024" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="2722" cy="-36.77" rx="178.8" ry="36.54"/>
<text text-anchor="middle" x="2722" y="-50.77" font-family="Arial" font-size="10.00">OUTPUT</text>
<text text-anchor="middle" x="2722" y="-39.77" font-family="Arial" font-size="10.00">GPU: Host</text>
<text text-anchor="middle" x="2722" y="-28.77" font-family="Arial" font-size="10.00">Input: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
<text text-anchor="middle" x="2722" y="-17.77" font-family="Arial" font-size="10.00">Output: [batch_size=B, seq_len=S, hidden_dim=7168]</text>
</g>
<!-- layer60_moe_aggregate&#45;&gt;output -->
<g id="edge3893" class="edge">
<title>layer60_moe_aggregate&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2722,-109.35C2722,-109.35 2722,-83.58 2722,-83.58"/>
<polygon fill="black" stroke="black" points="2725.5,-83.58 2722,-73.58 2718.5,-83.58 2725.5,-83.58"/>
</g>
<!-- layer60_moe_comm_from_expert0&#45;&gt;layer60_moe_aggregate -->
<g id="edge3859" class="edge">
<title>layer60_moe_comm_from_expert0&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M384,-249.46C384,-204.7 384,-124 384,-124 384,-124 2464.56,-124 2464.56,-124"/>
<polygon fill="black" stroke="black" points="2464.56,-127.5 2474.56,-124 2464.56,-120.5 2464.56,-127.5"/>
</g>
<!-- layer60_moe_comm_from_expert1&#45;&gt;layer60_moe_aggregate -->
<g id="edge3861" class="edge">
<title>layer60_moe_comm_from_expert1&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M749,-249.28C749,-208.37 749,-139 749,-139 749,-139 2479.87,-139 2479.87,-139"/>
<polygon fill="black" stroke="black" points="2479.87,-142.5 2489.87,-139 2479.87,-135.5 2479.87,-142.5"/>
</g>
<!-- layer60_moe_comm_from_expert2&#45;&gt;layer60_moe_aggregate -->
<g id="edge3863" class="edge">
<title>layer60_moe_comm_from_expert2&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M1058,-249.33C1058,-212.53 1058,-154 1058,-154 1058,-154 2495.74,-154 2495.74,-154"/>
<polygon fill="black" stroke="black" points="2495.74,-157.5 2505.74,-154 2495.74,-150.5 2495.74,-157.5"/>
</g>
<!-- layer60_moe_comm_from_expert3&#45;&gt;layer60_moe_aggregate -->
<g id="edge3865" class="edge">
<title>layer60_moe_comm_from_expert3&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M1312,-249.49C1312,-216.74 1312,-168 1312,-168 1312,-168 2509.98,-168 2509.98,-168"/>
<polygon fill="black" stroke="black" points="2509.98,-171.5 2519.98,-168 2509.98,-164.5 2509.98,-171.5"/>
</g>
<!-- layer60_moe_comm_from_expert4&#45;&gt;layer60_moe_aggregate -->
<g id="edge3867" class="edge">
<title>layer60_moe_comm_from_expert4&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M1732,-249.35C1732,-221.26 1732,-183 1732,-183 1732,-183 2525.5,-183 2525.5,-183"/>
<polygon fill="black" stroke="black" points="2525.5,-186.5 2535.5,-183 2525.5,-179.5 2525.5,-186.5"/>
</g>
<!-- layer60_moe_comm_from_expert5&#45;&gt;layer60_moe_aggregate -->
<g id="edge3869" class="edge">
<title>layer60_moe_comm_from_expert5&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M2004,-249.46C2004,-226.39 2004,-198 2004,-198 2004,-198 2540.93,-198 2540.93,-198"/>
<polygon fill="black" stroke="black" points="2540.93,-201.5 2550.93,-198 2540.93,-194.5 2540.93,-201.5"/>
</g>
<!-- layer60_moe_comm_from_expert6&#45;&gt;layer60_moe_aggregate -->
<g id="edge3871" class="edge">
<title>layer60_moe_comm_from_expert6&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M2441.65,-278C2470.98,-278 2496.1,-278 2496.1,-278 2496.1,-278 2496.1,-171.62 2496.1,-171.62"/>
<polygon fill="black" stroke="black" points="2499.6,-171.62 2496.1,-161.62 2492.6,-171.62 2499.6,-171.62"/>
</g>
<!-- layer60_moe_comm_from_expert7&#45;&gt;layer60_moe_aggregate -->
<g id="edge3873" class="edge">
<title>layer60_moe_comm_from_expert7&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M2623,-249.31C2623,-249.31 2623,-223.6 2623,-223.6"/>
<polygon fill="black" stroke="black" points="2626.5,-223.6 2623,-213.6 2619.5,-223.6 2626.5,-223.6"/>
</g>
<!-- layer60_moe_comm_from_expert8&#45;&gt;layer60_moe_aggregate -->
<g id="edge3875" class="edge">
<title>layer60_moe_comm_from_expert8&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M2894.39,-249.31C2894.39,-249.31 2894.39,-223.6 2894.39,-223.6"/>
<polygon fill="black" stroke="black" points="2897.89,-223.6 2894.39,-213.6 2890.89,-223.6 2897.89,-223.6"/>
</g>
<!-- layer60_moe_comm_from_expert9&#45;&gt;layer60_moe_aggregate -->
<g id="edge3877" class="edge">
<title>layer60_moe_comm_from_expert9&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M3204,-249.29C3204,-226.96 3204,-200 3204,-200 3204,-200 2980.41,-200 2980.41,-200"/>
<polygon fill="black" stroke="black" points="2980.41,-196.5 2970.41,-200 2980.41,-203.5 2980.41,-196.5"/>
</g>
<!-- layer60_moe_comm_from_expert10&#45;&gt;layer60_moe_aggregate -->
<g id="edge3879" class="edge">
<title>layer60_moe_comm_from_expert10&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M3536,-249.32C3536,-222.53 3536,-187 3536,-187 3536,-187 2966.9,-187 2966.9,-187"/>
<polygon fill="black" stroke="black" points="2966.9,-183.5 2956.9,-187 2966.9,-190.5 2966.9,-183.5"/>
</g>
<!-- layer60_moe_comm_from_expert11&#45;&gt;layer60_moe_aggregate -->
<g id="edge3881" class="edge">
<title>layer60_moe_comm_from_expert11&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M3883,-249.41C3883,-218.48 3883,-174 3883,-174 3883,-174 2953.45,-174 2953.45,-174"/>
<polygon fill="black" stroke="black" points="2953.45,-170.5 2943.45,-174 2953.45,-177.5 2953.45,-170.5"/>
</g>
<!-- layer60_moe_comm_from_expert12&#45;&gt;layer60_moe_aggregate -->
<g id="edge3883" class="edge">
<title>layer60_moe_comm_from_expert12&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M4234,-249.48C4234,-214.67 4234,-161 4234,-161 4234,-161 2940.25,-161 2940.25,-161"/>
<polygon fill="black" stroke="black" points="2940.25,-157.5 2930.25,-161 2940.25,-164.5 2940.25,-157.5"/>
</g>
<!-- layer60_moe_comm_from_expert13&#45;&gt;layer60_moe_aggregate -->
<g id="edge3885" class="edge">
<title>layer60_moe_comm_from_expert13&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M4588,-249.24C4588,-210.75 4588,-148 4588,-148 4588,-148 2926.85,-148 2926.85,-148"/>
<polygon fill="black" stroke="black" points="2926.85,-144.5 2916.85,-148 2926.85,-151.5 2926.85,-144.5"/>
</g>
<!-- layer60_moe_comm_from_expert14&#45;&gt;layer60_moe_aggregate -->
<g id="edge3887" class="edge">
<title>layer60_moe_comm_from_expert14&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M4943,-249.48C4943,-207.54 4943,-135 4943,-135 4943,-135 2913.28,-135 2913.28,-135"/>
<polygon fill="black" stroke="black" points="2913.28,-131.5 2903.28,-135 2913.28,-138.5 2913.28,-131.5"/>
</g>
<!-- layer60_moe_comm_from_expert15&#45;&gt;layer60_moe_aggregate -->
<g id="edge3889" class="edge">
<title>layer60_moe_comm_from_expert15&#45;&gt;layer60_moe_aggregate</title>
<path fill="none" stroke="black" d="M5298,-249.46C5298,-204.19 5298,-122 5298,-122 5298,-122 2900.02,-122 2900.02,-122"/>
<polygon fill="black" stroke="black" points="2900.02,-118.5 2890.02,-122 2900.02,-125.5 2900.02,-118.5"/>
</g>
</g>
</svg>
