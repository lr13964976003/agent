<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: mha_layer_0_partitioned Pages: 1 -->
<svg width="1440pt" height="66pt"
 viewBox="0.00 0.00 1440.00 66.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 1079)">
<title>mha_layer_0_partitioned</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1079 23534,-1079 23534,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="18234.95,-1075 17484.19,-1075 17291.05,-969 18041.81,-969 18234.95,-1075"/>
<text text-anchor="middle" x="17763" y="-1033.3" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="17763" y="-1018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="17763" y="-1003.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln -->
<g id="node2" class="node">
<title>ln</title>
<polygon fill="lightyellow" stroke="black" points="12229.5,-933 11762.5,-933 11762.5,-865 12229.5,-865 12229.5,-933"/>
<text text-anchor="middle" x="11996" y="-917.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11996" y="-902.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11996" y="-887.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11996" y="-872.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;ln -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln</title>
<path fill="none" stroke="black" d="M17370.58,-1012.77C16263.38,-989.54 13137.28,-923.95 12239.74,-905.11"/>
<polygon fill="black" stroke="black" points="12239.68,-901.61 12229.6,-904.9 12239.53,-908.61 12239.68,-901.61"/>
</g>
<!-- residual -->
<g id="node73" class="node">
<title>residual</title>
<polygon fill="lightgray" stroke="black" points="19712,-83 19244,-83 19244,0 19712,0 19712,-83"/>
<text text-anchor="middle" x="19478" y="-67.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19478" y="-52.8" font-family="Times,serif" font-size="14.00">Input 1: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19478" y="-37.8" font-family="Times,serif" font-size="14.00">Input 2: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19478" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19478" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;residual -->
<g id="edge120" class="edge">
<title>input&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M18133.55,-1019.21C19369.63,-1011.86 23286.51,-976.97 23511,-829 23527.6,-818.06 23530,-808.38 23530,-788.5 23530,-788.5 23530,-788.5 23530,-290 23530,-98.18 20598.67,-53.61 19722.47,-44.58"/>
<polygon fill="black" stroke="black" points="19722.29,-41.08 19712.25,-44.47 19722.22,-48.08 19722.29,-41.08"/>
</g>
<!-- q_hg0_ds0 -->
<g id="node3" class="node">
<title>q_hg0_ds0</title>
<polygon fill="lightcoral" stroke="black" points="472,-829 0,-829 0,-746 472,-746 472,-829"/>
<text text-anchor="middle" x="236" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="236" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 0</text>
<text text-anchor="middle" x="236" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="236" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="236" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;q_hg0_ds0 -->
<g id="edge2" class="edge">
<title>ln&#45;&gt;q_hg0_ds0</title>
<path fill="none" stroke="black" d="M11762.4,-897.65C10187.37,-895.15 1160.62,-878.71 482.5,-829.02"/>
<polygon fill="black" stroke="black" points="482.5,-825.51 472.25,-828.22 481.95,-832.49 482.5,-825.51"/>
</g>
<!-- k_hg0_ds0 -->
<g id="node4" class="node">
<title>k_hg0_ds0</title>
<polygon fill="lightcoral" stroke="black" points="962,-829 490,-829 490,-746 962,-746 962,-829"/>
<text text-anchor="middle" x="726" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="726" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 0</text>
<text text-anchor="middle" x="726" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="726" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="726" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;k_hg0_ds0 -->
<g id="edge3" class="edge">
<title>ln&#45;&gt;k_hg0_ds0</title>
<path fill="none" stroke="black" d="M11762.2,-897.58C10226.39,-894.71 1624.29,-876.6 972.53,-829.02"/>
<polygon fill="black" stroke="black" points="972.5,-825.51 962.25,-828.21 971.95,-832.49 972.5,-825.51"/>
</g>
<!-- v_hg0_ds0 -->
<g id="node5" class="node">
<title>v_hg0_ds0</title>
<polygon fill="lightcoral" stroke="black" points="1452,-829 980,-829 980,-746 1452,-746 1452,-829"/>
<text text-anchor="middle" x="1216" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="1216" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 0</text>
<text text-anchor="middle" x="1216" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1216" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="1216" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;v_hg0_ds0 -->
<g id="edge4" class="edge">
<title>ln&#45;&gt;v_hg0_ds0</title>
<path fill="none" stroke="black" d="M11762.4,-897.51C10267.76,-894.26 2087.65,-874.49 1462.52,-829.02"/>
<polygon fill="black" stroke="black" points="1462.5,-825.51 1452.25,-828.21 1461.95,-832.49 1462.5,-825.51"/>
</g>
<!-- q_hg0_ds1 -->
<g id="node7" class="node">
<title>q_hg0_ds1</title>
<polygon fill="lightcoral" stroke="black" points="1942,-829 1470,-829 1470,-746 1942,-746 1942,-829"/>
<text text-anchor="middle" x="1706" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="1706" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 1</text>
<text text-anchor="middle" x="1706" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1706" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;q_hg0_ds1 -->
<g id="edge8" class="edge">
<title>ln&#45;&gt;q_hg0_ds1</title>
<path fill="none" stroke="black" d="M11762.46,-897.43C10309.54,-893.79 2550.61,-872.39 1952.46,-829.01"/>
<polygon fill="black" stroke="black" points="1952.5,-825.51 1942.25,-828.21 1951.95,-832.48 1952.5,-825.51"/>
</g>
<!-- k_hg0_ds1 -->
<g id="node8" class="node">
<title>k_hg0_ds1</title>
<polygon fill="lightcoral" stroke="black" points="2432,-829 1960,-829 1960,-746 2432,-746 2432,-829"/>
<text text-anchor="middle" x="2196" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="2196" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 1</text>
<text text-anchor="middle" x="2196" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2196" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;k_hg0_ds1 -->
<g id="edge9" class="edge">
<title>ln&#45;&gt;k_hg0_ds1</title>
<path fill="none" stroke="black" d="M11762.49,-897.35C10352.18,-893.29 3013.2,-870.29 2442.36,-829"/>
<polygon fill="black" stroke="black" points="2442.5,-825.5 2432.25,-828.21 2441.95,-832.48 2442.5,-825.5"/>
</g>
<!-- v_hg0_ds1 -->
<g id="node9" class="node">
<title>v_hg0_ds1</title>
<polygon fill="lightcoral" stroke="black" points="2922,-829 2450,-829 2450,-746 2922,-746 2922,-829"/>
<text text-anchor="middle" x="2686" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="2686" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 1</text>
<text text-anchor="middle" x="2686" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2686" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="2686" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;v_hg0_ds1 -->
<g id="edge10" class="edge">
<title>ln&#45;&gt;v_hg0_ds1</title>
<path fill="none" stroke="black" d="M11762.31,-897.25C10395.55,-892.76 3478.79,-868.21 2932.62,-829.02"/>
<polygon fill="black" stroke="black" points="2932.5,-825.5 2922.25,-828.21 2931.95,-832.48 2932.5,-825.5"/>
</g>
<!-- q_hg0_ds2 -->
<g id="node11" class="node">
<title>q_hg0_ds2</title>
<polygon fill="lightcoral" stroke="black" points="3412,-829 2940,-829 2940,-746 3412,-746 3412,-829"/>
<text text-anchor="middle" x="3176" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="3176" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 2</text>
<text text-anchor="middle" x="3176" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3176" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;q_hg0_ds2 -->
<g id="edge14" class="edge">
<title>ln&#45;&gt;q_hg0_ds2</title>
<path fill="none" stroke="black" d="M11762.27,-898.3C10479.27,-899.63 4317.92,-902.21 3422.23,-829.04"/>
<polygon fill="black" stroke="black" points="3422.51,-825.55 3412.25,-828.21 3421.93,-832.53 3422.51,-825.55"/>
</g>
<!-- k_hg0_ds2 -->
<g id="node12" class="node">
<title>k_hg0_ds2</title>
<polygon fill="lightcoral" stroke="black" points="3902,-829 3430,-829 3430,-746 3902,-746 3902,-829"/>
<text text-anchor="middle" x="3666" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="3666" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 2</text>
<text text-anchor="middle" x="3666" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3666" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;k_hg0_ds2 -->
<g id="edge15" class="edge">
<title>ln&#45;&gt;k_hg0_ds2</title>
<path fill="none" stroke="black" d="M11762.28,-898.17C10524.16,-898.8 4756.29,-898 3912.25,-829.04"/>
<polygon fill="black" stroke="black" points="3912.51,-825.55 3902.25,-828.2 3911.92,-832.53 3912.51,-825.55"/>
</g>
<!-- v_hg0_ds2 -->
<g id="node13" class="node">
<title>v_hg0_ds2</title>
<polygon fill="lightcoral" stroke="black" points="4392,-829 3920,-829 3920,-746 4392,-746 4392,-829"/>
<text text-anchor="middle" x="4156" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="4156" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 2</text>
<text text-anchor="middle" x="4156" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4156" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="4156" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;v_hg0_ds2 -->
<g id="edge16" class="edge">
<title>ln&#45;&gt;v_hg0_ds2</title>
<path fill="none" stroke="black" d="M11762.34,-898.03C10570.68,-897.91 5195.7,-893.79 4402.49,-829.06"/>
<polygon fill="black" stroke="black" points="4402.51,-825.55 4392.25,-828.2 4401.92,-832.53 4402.51,-825.55"/>
</g>
<!-- q_hg0_ds3 -->
<g id="node15" class="node">
<title>q_hg0_ds3</title>
<polygon fill="lightcoral" stroke="black" points="4882,-829 4410,-829 4410,-746 4882,-746 4882,-829"/>
<text text-anchor="middle" x="4646" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="4646" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 3</text>
<text text-anchor="middle" x="4646" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4646" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4646" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;q_hg0_ds3 -->
<g id="edge20" class="edge">
<title>ln&#45;&gt;q_hg0_ds3</title>
<path fill="none" stroke="black" d="M11762.42,-897.87C10618.58,-896.97 5633.43,-889.6 4892.34,-829.05"/>
<polygon fill="black" stroke="black" points="4892.51,-825.55 4882.25,-828.2 4891.92,-832.53 4892.51,-825.55"/>
</g>
<!-- k_hg0_ds3 -->
<g id="node16" class="node">
<title>k_hg0_ds3</title>
<polygon fill="lightcoral" stroke="black" points="5372,-829 4900,-829 4900,-746 5372,-746 5372,-829"/>
<text text-anchor="middle" x="5136" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="5136" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 3</text>
<text text-anchor="middle" x="5136" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5136" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5136" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;k_hg0_ds3 -->
<g id="edge21" class="edge">
<title>ln&#45;&gt;k_hg0_ds3</title>
<path fill="none" stroke="black" d="M11762.32,-897.69C10667.72,-895.96 6071.98,-885.42 5382.36,-829.05"/>
<polygon fill="black" stroke="black" points="5382.51,-825.55 5372.25,-828.2 5381.92,-832.53 5382.51,-825.55"/>
</g>
<!-- v_hg0_ds3 -->
<g id="node17" class="node">
<title>v_hg0_ds3</title>
<polygon fill="lightcoral" stroke="black" points="5862,-829 5390,-829 5390,-746 5862,-746 5862,-829"/>
<text text-anchor="middle" x="5626" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="5626" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 3</text>
<text text-anchor="middle" x="5626" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5626" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="5626" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;v_hg0_ds3 -->
<g id="edge22" class="edge">
<title>ln&#45;&gt;v_hg0_ds3</title>
<path fill="none" stroke="black" d="M11762.38,-897.48C10719.14,-894.87 6510.12,-881.24 5872.27,-829.04"/>
<polygon fill="black" stroke="black" points="5872.51,-825.55 5862.25,-828.19 5871.92,-832.53 5872.51,-825.55"/>
</g>
<!-- q_hg1_ds0 -->
<g id="node19" class="node">
<title>q_hg1_ds0</title>
<polygon fill="lightcoral" stroke="black" points="6352,-829 5880,-829 5880,-746 6352,-746 6352,-829"/>
<text text-anchor="middle" x="6116" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="6116" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 0</text>
<text text-anchor="middle" x="6116" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6116" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6116" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;q_hg1_ds0 -->
<g id="edge26" class="edge">
<title>ln&#45;&gt;q_hg1_ds0</title>
<path fill="none" stroke="black" d="M11762.14,-897.23C10771.93,-893.69 6948.73,-877.08 6362.29,-829.04"/>
<polygon fill="black" stroke="black" points="6362.51,-825.55 6352.25,-828.19 6361.92,-832.52 6362.51,-825.55"/>
</g>
<!-- k_hg1_ds0 -->
<g id="node20" class="node">
<title>k_hg1_ds0</title>
<polygon fill="lightcoral" stroke="black" points="6842,-829 6370,-829 6370,-746 6842,-746 6842,-829"/>
<text text-anchor="middle" x="6606" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="6606" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 0</text>
<text text-anchor="middle" x="6606" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6606" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6606" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;k_hg1_ds0 -->
<g id="edge27" class="edge">
<title>ln&#45;&gt;k_hg1_ds0</title>
<path fill="none" stroke="black" d="M11762.15,-896.94C10827.93,-892.41 7388.51,-872.95 6852.54,-829.06"/>
<polygon fill="black" stroke="black" points="6852.52,-825.55 6842.25,-828.18 6851.92,-832.52 6852.52,-825.55"/>
</g>
<!-- v_hg1_ds0 -->
<g id="node21" class="node">
<title>v_hg1_ds0</title>
<polygon fill="lightcoral" stroke="black" points="7332,-829 6860,-829 6860,-746 7332,-746 7332,-829"/>
<text text-anchor="middle" x="7096" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="7096" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 0</text>
<text text-anchor="middle" x="7096" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="7096" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="7096" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;v_hg1_ds0 -->
<g id="edge28" class="edge">
<title>ln&#45;&gt;v_hg1_ds0</title>
<path fill="none" stroke="black" d="M11762.28,-896.58C10886.82,-890.99 7827.39,-868.84 7342.56,-829.06"/>
<polygon fill="black" stroke="black" points="7342.52,-825.55 7332.26,-828.18 7341.92,-832.52 7342.52,-825.55"/>
</g>
<!-- q_hg1_ds1 -->
<g id="node23" class="node">
<title>q_hg1_ds1</title>
<polygon fill="lightcoral" stroke="black" points="7822,-829 7350,-829 7350,-746 7822,-746 7822,-829"/>
<text text-anchor="middle" x="7586" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="7586" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 1</text>
<text text-anchor="middle" x="7586" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="7586" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7586" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;q_hg1_ds1 -->
<g id="edge32" class="edge">
<title>ln&#45;&gt;q_hg1_ds1</title>
<path fill="none" stroke="black" d="M11762.37,-898.66C11005.28,-900.08 8623.38,-898.82 7832.35,-829.07"/>
<polygon fill="black" stroke="black" points="7832.53,-825.58 7822.26,-828.17 7831.9,-832.55 7832.53,-825.58"/>
</g>
<!-- k_hg1_ds1 -->
<g id="node24" class="node">
<title>k_hg1_ds1</title>
<polygon fill="lightcoral" stroke="black" points="8312,-829 7840,-829 7840,-746 8312,-746 8312,-829"/>
<text text-anchor="middle" x="8076" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="8076" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 1</text>
<text text-anchor="middle" x="8076" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="8076" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8076" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;k_hg1_ds1 -->
<g id="edge33" class="edge">
<title>ln&#45;&gt;k_hg1_ds1</title>
<path fill="none" stroke="black" d="M11762.39,-898.05C11066.45,-897.49 9013.2,-890.59 8322.33,-829.07"/>
<polygon fill="black" stroke="black" points="8322.53,-825.58 8312.26,-828.16 8321.9,-832.55 8322.53,-825.58"/>
</g>
<!-- v_hg1_ds1 -->
<g id="node25" class="node">
<title>v_hg1_ds1</title>
<polygon fill="lightcoral" stroke="black" points="8802,-829 8330,-829 8330,-746 8802,-746 8802,-829"/>
<text text-anchor="middle" x="8566" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="8566" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 1</text>
<text text-anchor="middle" x="8566" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="8566" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="8566" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;v_hg1_ds1 -->
<g id="edge34" class="edge">
<title>ln&#45;&gt;v_hg1_ds1</title>
<path fill="none" stroke="black" d="M11762.48,-897.25C11132.09,-894.54 9404.14,-882.41 8812.6,-829.1"/>
<polygon fill="black" stroke="black" points="8812.54,-825.58 8802.26,-828.15 8811.9,-832.55 8812.54,-825.58"/>
</g>
<!-- q_hg1_ds2 -->
<g id="node27" class="node">
<title>q_hg1_ds2</title>
<polygon fill="lightcoral" stroke="black" points="9292,-829 8820,-829 8820,-746 9292,-746 9292,-829"/>
<text text-anchor="middle" x="9056" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="9056" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 2</text>
<text text-anchor="middle" x="9056" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9056" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9056" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;q_hg1_ds2 -->
<g id="edge38" class="edge">
<title>ln&#45;&gt;q_hg1_ds2</title>
<path fill="none" stroke="black" d="M11762.27,-896.17C11202.28,-891.11 9794.51,-874.27 9302.29,-829.07"/>
<polygon fill="black" stroke="black" points="9302.54,-825.58 9292.26,-828.13 9301.89,-832.55 9302.54,-825.58"/>
</g>
<!-- k_hg1_ds2 -->
<g id="node28" class="node">
<title>k_hg1_ds2</title>
<polygon fill="lightcoral" stroke="black" points="9782,-829 9310,-829 9310,-746 9782,-746 9782,-829"/>
<text text-anchor="middle" x="9546" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="9546" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 2</text>
<text text-anchor="middle" x="9546" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="9546" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9546" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;k_hg1_ds2 -->
<g id="edge39" class="edge">
<title>ln&#45;&gt;k_hg1_ds2</title>
<path fill="none" stroke="black" d="M11762.16,-894.61C11279.58,-886.97 10186.3,-866.2 9792.29,-829.07"/>
<polygon fill="black" stroke="black" points="9792.55,-825.58 9782.26,-828.11 9791.88,-832.55 9792.55,-825.58"/>
</g>
<!-- v_hg1_ds2 -->
<g id="node29" class="node">
<title>v_hg1_ds2</title>
<polygon fill="lightcoral" stroke="black" points="10272,-829 9800,-829 9800,-746 10272,-746 10272,-829"/>
<text text-anchor="middle" x="10036" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="10036" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 2</text>
<text text-anchor="middle" x="10036" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="10036" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="10036" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;v_hg1_ds2 -->
<g id="edge40" class="edge">
<title>ln&#45;&gt;v_hg1_ds2</title>
<path fill="none" stroke="black" d="M11762.34,-897.73C11433.77,-895.29 10816.55,-883.17 10282.49,-829.12"/>
<polygon fill="black" stroke="black" points="10282.57,-825.61 10272.27,-828.07 10281.86,-832.57 10282.57,-825.61"/>
</g>
<!-- q_hg1_ds3 -->
<g id="node31" class="node">
<title>q_hg1_ds3</title>
<polygon fill="lightcoral" stroke="black" points="10762,-829 10290,-829 10290,-746 10762,-746 10762,-829"/>
<text text-anchor="middle" x="10526" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="10526" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 3</text>
<text text-anchor="middle" x="10526" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="10526" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10526" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;q_hg1_ds3 -->
<g id="edge44" class="edge">
<title>ln&#45;&gt;q_hg1_ds3</title>
<path fill="none" stroke="black" d="M11762.25,-892.31C11517.64,-884.62 11122.4,-867.32 10772.35,-829.12"/>
<polygon fill="black" stroke="black" points="10772.59,-825.62 10762.27,-828.01 10771.83,-832.58 10772.59,-825.62"/>
</g>
<!-- k_hg1_ds3 -->
<g id="node32" class="node">
<title>k_hg1_ds3</title>
<polygon fill="lightcoral" stroke="black" points="11252,-829 10780,-829 10780,-746 11252,-746 11252,-829"/>
<text text-anchor="middle" x="11016" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="11016" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 3</text>
<text text-anchor="middle" x="11016" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11016" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11016" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;k_hg1_ds3 -->
<g id="edge45" class="edge">
<title>ln&#45;&gt;k_hg1_ds3</title>
<path fill="none" stroke="black" d="M11762.17,-880.26C11620.26,-868.48 11435.34,-851.3 11262.35,-829.15"/>
<polygon fill="black" stroke="black" points="11262.66,-825.66 11252.29,-827.85 11261.76,-832.6 11262.66,-825.66"/>
</g>
<!-- v_hg1_ds3 -->
<g id="node33" class="node">
<title>v_hg1_ds3</title>
<polygon fill="lightcoral" stroke="black" points="11742,-829 11270,-829 11270,-746 11742,-746 11742,-829"/>
<text text-anchor="middle" x="11506" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="11506" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 3</text>
<text text-anchor="middle" x="11506" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11506" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="11506" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;v_hg1_ds3 -->
<g id="edge46" class="edge">
<title>ln&#45;&gt;v_hg1_ds3</title>
<path fill="none" stroke="black" d="M11848.32,-865C11800.9,-854.4 11747.67,-842.51 11697.58,-831.31"/>
<polygon fill="black" stroke="black" points="11698.12,-827.85 11687.6,-829.08 11696.6,-834.68 11698.12,-827.85"/>
</g>
<!-- q_hg2_ds0 -->
<g id="node35" class="node">
<title>q_hg2_ds0</title>
<polygon fill="lightcoral" stroke="black" points="12232,-829 11760,-829 11760,-746 12232,-746 12232,-829"/>
<text text-anchor="middle" x="11996" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="11996" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 0</text>
<text text-anchor="middle" x="11996" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="11996" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11996" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln&#45;&gt;q_hg2_ds0 -->
<g id="edge50" class="edge">
<title>ln&#45;&gt;q_hg2_ds0</title>
<path fill="none" stroke="black" d="M11996,-864.85C11996,-856.8 11996,-848 11996,-839.34"/>
<polygon fill="black" stroke="black" points="11999.5,-839.28 11996,-829.28 11992.5,-839.28 11999.5,-839.28"/>
</g>
<!-- k_hg2_ds0 -->
<g id="node36" class="node">
<title>k_hg2_ds0</title>
<polygon fill="lightcoral" stroke="black" points="12722,-829 12250,-829 12250,-746 12722,-746 12722,-829"/>
<text text-anchor="middle" x="12486" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="12486" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 0</text>
<text text-anchor="middle" x="12486" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="12486" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12486" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln&#45;&gt;k_hg2_ds0 -->
<g id="edge51" class="edge">
<title>ln&#45;&gt;k_hg2_ds0</title>
<path fill="none" stroke="black" d="M12143.68,-865C12191.1,-854.4 12244.33,-842.51 12294.42,-831.31"/>
<polygon fill="black" stroke="black" points="12295.4,-834.68 12304.4,-829.08 12293.88,-827.85 12295.4,-834.68"/>
</g>
<!-- v_hg2_ds0 -->
<g id="node37" class="node">
<title>v_hg2_ds0</title>
<polygon fill="lightcoral" stroke="black" points="13212,-829 12740,-829 12740,-746 13212,-746 13212,-829"/>
<text text-anchor="middle" x="12976" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="12976" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 0</text>
<text text-anchor="middle" x="12976" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="12976" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="12976" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln&#45;&gt;v_hg2_ds0 -->
<g id="edge52" class="edge">
<title>ln&#45;&gt;v_hg2_ds0</title>
<path fill="none" stroke="black" d="M12229.83,-880.26C12371.74,-868.48 12556.66,-851.3 12729.65,-829.15"/>
<polygon fill="black" stroke="black" points="12730.24,-832.6 12739.71,-827.85 12729.34,-825.66 12730.24,-832.6"/>
</g>
<!-- q_hg2_ds1 -->
<g id="node39" class="node">
<title>q_hg2_ds1</title>
<polygon fill="lightcoral" stroke="black" points="13702,-829 13230,-829 13230,-746 13702,-746 13702,-829"/>
<text text-anchor="middle" x="13466" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="13466" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 1</text>
<text text-anchor="middle" x="13466" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="13466" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13466" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln&#45;&gt;q_hg2_ds1 -->
<g id="edge56" class="edge">
<title>ln&#45;&gt;q_hg2_ds1</title>
<path fill="none" stroke="black" d="M12229.75,-892.31C12474.36,-884.62 12869.6,-867.32 13219.65,-829.12"/>
<polygon fill="black" stroke="black" points="13220.17,-832.58 13229.73,-828.01 13219.41,-825.62 13220.17,-832.58"/>
</g>
<!-- k_hg2_ds1 -->
<g id="node40" class="node">
<title>k_hg2_ds1</title>
<polygon fill="lightcoral" stroke="black" points="14192,-829 13720,-829 13720,-746 14192,-746 14192,-829"/>
<text text-anchor="middle" x="13956" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="13956" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 1</text>
<text text-anchor="middle" x="13956" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="13956" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13956" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln&#45;&gt;k_hg2_ds1 -->
<g id="edge57" class="edge">
<title>ln&#45;&gt;k_hg2_ds1</title>
<path fill="none" stroke="black" d="M12229.66,-897.73C12558.23,-895.29 13175.45,-883.17 13709.51,-829.12"/>
<polygon fill="black" stroke="black" points="13710.14,-832.57 13719.73,-828.07 13709.43,-825.61 13710.14,-832.57"/>
</g>
<!-- v_hg2_ds1 -->
<g id="node41" class="node">
<title>v_hg2_ds1</title>
<polygon fill="lightcoral" stroke="black" points="14682,-829 14210,-829 14210,-746 14682,-746 14682,-829"/>
<text text-anchor="middle" x="14446" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="14446" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 1</text>
<text text-anchor="middle" x="14446" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="14446" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="14446" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln&#45;&gt;v_hg2_ds1 -->
<g id="edge58" class="edge">
<title>ln&#45;&gt;v_hg2_ds1</title>
<path fill="none" stroke="black" d="M12229.84,-894.61C12712.42,-886.97 13805.7,-866.2 14199.71,-829.07"/>
<polygon fill="black" stroke="black" points="14200.12,-832.55 14209.74,-828.11 14199.45,-825.58 14200.12,-832.55"/>
</g>
<!-- q_hg2_ds2 -->
<g id="node43" class="node">
<title>q_hg2_ds2</title>
<polygon fill="lightcoral" stroke="black" points="15172,-829 14700,-829 14700,-746 15172,-746 15172,-829"/>
<text text-anchor="middle" x="14936" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="14936" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 2</text>
<text text-anchor="middle" x="14936" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="14936" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14936" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln&#45;&gt;q_hg2_ds2 -->
<g id="edge62" class="edge">
<title>ln&#45;&gt;q_hg2_ds2</title>
<path fill="none" stroke="black" d="M12229.73,-896.17C12789.72,-891.11 14197.49,-874.27 14689.71,-829.07"/>
<polygon fill="black" stroke="black" points="14690.11,-832.55 14699.74,-828.13 14689.46,-825.58 14690.11,-832.55"/>
</g>
<!-- k_hg2_ds2 -->
<g id="node44" class="node">
<title>k_hg2_ds2</title>
<polygon fill="lightcoral" stroke="black" points="15662,-829 15190,-829 15190,-746 15662,-746 15662,-829"/>
<text text-anchor="middle" x="15426" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="15426" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 2</text>
<text text-anchor="middle" x="15426" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="15426" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15426" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln&#45;&gt;k_hg2_ds2 -->
<g id="edge63" class="edge">
<title>ln&#45;&gt;k_hg2_ds2</title>
<path fill="none" stroke="black" d="M12229.52,-897.25C12859.91,-894.54 14587.86,-882.41 15179.4,-829.1"/>
<polygon fill="black" stroke="black" points="15180.1,-832.55 15189.74,-828.15 15179.46,-825.58 15180.1,-832.55"/>
</g>
<!-- v_hg2_ds2 -->
<g id="node45" class="node">
<title>v_hg2_ds2</title>
<polygon fill="lightcoral" stroke="black" points="16152,-829 15680,-829 15680,-746 16152,-746 16152,-829"/>
<text text-anchor="middle" x="15916" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="15916" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 2</text>
<text text-anchor="middle" x="15916" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="15916" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="15916" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln&#45;&gt;v_hg2_ds2 -->
<g id="edge64" class="edge">
<title>ln&#45;&gt;v_hg2_ds2</title>
<path fill="none" stroke="black" d="M12229.61,-898.05C12925.55,-897.49 14978.8,-890.59 15669.67,-829.07"/>
<polygon fill="black" stroke="black" points="15670.1,-832.55 15679.74,-828.16 15669.47,-825.58 15670.1,-832.55"/>
</g>
<!-- q_hg2_ds3 -->
<g id="node47" class="node">
<title>q_hg2_ds3</title>
<polygon fill="lightcoral" stroke="black" points="16642,-829 16170,-829 16170,-746 16642,-746 16642,-829"/>
<text text-anchor="middle" x="16406" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="16406" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 3</text>
<text text-anchor="middle" x="16406" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="16406" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16406" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln&#45;&gt;q_hg2_ds3 -->
<g id="edge68" class="edge">
<title>ln&#45;&gt;q_hg2_ds3</title>
<path fill="none" stroke="black" d="M12229.63,-898.66C12986.72,-900.08 15368.62,-898.82 16159.65,-829.07"/>
<polygon fill="black" stroke="black" points="16160.1,-832.55 16169.74,-828.17 16159.47,-825.58 16160.1,-832.55"/>
</g>
<!-- k_hg2_ds3 -->
<g id="node48" class="node">
<title>k_hg2_ds3</title>
<polygon fill="lightcoral" stroke="black" points="17132,-829 16660,-829 16660,-746 17132,-746 17132,-829"/>
<text text-anchor="middle" x="16896" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="16896" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 3</text>
<text text-anchor="middle" x="16896" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="16896" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16896" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln&#45;&gt;k_hg2_ds3 -->
<g id="edge69" class="edge">
<title>ln&#45;&gt;k_hg2_ds3</title>
<path fill="none" stroke="black" d="M12229.72,-896.58C13105.18,-890.99 16164.61,-868.84 16649.44,-829.06"/>
<polygon fill="black" stroke="black" points="16650.08,-832.52 16659.74,-828.18 16649.48,-825.55 16650.08,-832.52"/>
</g>
<!-- v_hg2_ds3 -->
<g id="node49" class="node">
<title>v_hg2_ds3</title>
<polygon fill="lightcoral" stroke="black" points="17622,-829 17150,-829 17150,-746 17622,-746 17622,-829"/>
<text text-anchor="middle" x="17386" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="17386" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 3</text>
<text text-anchor="middle" x="17386" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="17386" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="17386" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln&#45;&gt;v_hg2_ds3 -->
<g id="edge70" class="edge">
<title>ln&#45;&gt;v_hg2_ds3</title>
<path fill="none" stroke="black" d="M12229.85,-896.94C13164.07,-892.41 16603.49,-872.95 17139.46,-829.06"/>
<polygon fill="black" stroke="black" points="17140.08,-832.52 17149.75,-828.18 17139.48,-825.55 17140.08,-832.52"/>
</g>
<!-- q_hg3_ds0 -->
<g id="node51" class="node">
<title>q_hg3_ds0</title>
<polygon fill="lightcoral" stroke="black" points="18112,-829 17640,-829 17640,-746 18112,-746 18112,-829"/>
<text text-anchor="middle" x="17876" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="17876" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 0</text>
<text text-anchor="middle" x="17876" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="17876" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17876" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln&#45;&gt;q_hg3_ds0 -->
<g id="edge74" class="edge">
<title>ln&#45;&gt;q_hg3_ds0</title>
<path fill="none" stroke="black" d="M12229.86,-897.23C13220.07,-893.69 17043.27,-877.08 17629.71,-829.04"/>
<polygon fill="black" stroke="black" points="17630.08,-832.52 17639.75,-828.19 17629.49,-825.55 17630.08,-832.52"/>
</g>
<!-- k_hg3_ds0 -->
<g id="node52" class="node">
<title>k_hg3_ds0</title>
<polygon fill="lightcoral" stroke="black" points="18602,-829 18130,-829 18130,-746 18602,-746 18602,-829"/>
<text text-anchor="middle" x="18366" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="18366" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 0</text>
<text text-anchor="middle" x="18366" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="18366" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18366" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln&#45;&gt;k_hg3_ds0 -->
<g id="edge75" class="edge">
<title>ln&#45;&gt;k_hg3_ds0</title>
<path fill="none" stroke="black" d="M12229.62,-897.48C13272.86,-894.87 17481.88,-881.24 18119.73,-829.04"/>
<polygon fill="black" stroke="black" points="18120.08,-832.53 18129.75,-828.19 18119.49,-825.55 18120.08,-832.53"/>
</g>
<!-- v_hg3_ds0 -->
<g id="node53" class="node">
<title>v_hg3_ds0</title>
<polygon fill="lightcoral" stroke="black" points="19092,-829 18620,-829 18620,-746 19092,-746 19092,-829"/>
<text text-anchor="middle" x="18856" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="18856" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 0</text>
<text text-anchor="middle" x="18856" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="18856" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="18856" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln&#45;&gt;v_hg3_ds0 -->
<g id="edge76" class="edge">
<title>ln&#45;&gt;v_hg3_ds0</title>
<path fill="none" stroke="black" d="M12229.68,-897.69C13324.28,-895.96 17920.02,-885.42 18609.64,-829.05"/>
<polygon fill="black" stroke="black" points="18610.08,-832.53 18619.75,-828.2 18609.49,-825.55 18610.08,-832.53"/>
</g>
<!-- q_hg3_ds1 -->
<g id="node55" class="node">
<title>q_hg3_ds1</title>
<polygon fill="lightcoral" stroke="black" points="19582,-829 19110,-829 19110,-746 19582,-746 19582,-829"/>
<text text-anchor="middle" x="19346" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="19346" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 1</text>
<text text-anchor="middle" x="19346" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19346" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19346" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln&#45;&gt;q_hg3_ds1 -->
<g id="edge80" class="edge">
<title>ln&#45;&gt;q_hg3_ds1</title>
<path fill="none" stroke="black" d="M12229.58,-897.87C13373.42,-896.97 18358.57,-889.6 19099.66,-829.05"/>
<polygon fill="black" stroke="black" points="19100.08,-832.53 19109.75,-828.2 19099.49,-825.55 19100.08,-832.53"/>
</g>
<!-- k_hg3_ds1 -->
<g id="node56" class="node">
<title>k_hg3_ds1</title>
<polygon fill="lightcoral" stroke="black" points="20072,-829 19600,-829 19600,-746 20072,-746 20072,-829"/>
<text text-anchor="middle" x="19836" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="19836" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 1</text>
<text text-anchor="middle" x="19836" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19836" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19836" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln&#45;&gt;k_hg3_ds1 -->
<g id="edge81" class="edge">
<title>ln&#45;&gt;k_hg3_ds1</title>
<path fill="none" stroke="black" d="M12229.66,-898.03C13421.32,-897.91 18796.3,-893.79 19589.51,-829.06"/>
<polygon fill="black" stroke="black" points="19590.08,-832.53 19599.75,-828.2 19589.49,-825.55 19590.08,-832.53"/>
</g>
<!-- v_hg3_ds1 -->
<g id="node57" class="node">
<title>v_hg3_ds1</title>
<polygon fill="lightcoral" stroke="black" points="20562,-829 20090,-829 20090,-746 20562,-746 20562,-829"/>
<text text-anchor="middle" x="20326" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="20326" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 1</text>
<text text-anchor="middle" x="20326" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="20326" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="20326" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln&#45;&gt;v_hg3_ds1 -->
<g id="edge82" class="edge">
<title>ln&#45;&gt;v_hg3_ds1</title>
<path fill="none" stroke="black" d="M12229.72,-898.17C13467.84,-898.8 19235.71,-898 20079.75,-829.04"/>
<polygon fill="black" stroke="black" points="20080.08,-832.53 20089.75,-828.2 20079.49,-825.55 20080.08,-832.53"/>
</g>
<!-- q_hg3_ds2 -->
<g id="node59" class="node">
<title>q_hg3_ds2</title>
<polygon fill="lightcoral" stroke="black" points="21052,-829 20580,-829 20580,-746 21052,-746 21052,-829"/>
<text text-anchor="middle" x="20816" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="20816" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 2</text>
<text text-anchor="middle" x="20816" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="20816" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20816" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln&#45;&gt;q_hg3_ds2 -->
<g id="edge86" class="edge">
<title>ln&#45;&gt;q_hg3_ds2</title>
<path fill="none" stroke="black" d="M12229.73,-898.3C13512.73,-899.63 19674.08,-902.21 20569.77,-829.04"/>
<polygon fill="black" stroke="black" points="20570.07,-832.53 20579.75,-828.21 20569.49,-825.55 20570.07,-832.53"/>
</g>
<!-- k_hg3_ds2 -->
<g id="node60" class="node">
<title>k_hg3_ds2</title>
<polygon fill="lightcoral" stroke="black" points="21542,-829 21070,-829 21070,-746 21542,-746 21542,-829"/>
<text text-anchor="middle" x="21306" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="21306" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 2</text>
<text text-anchor="middle" x="21306" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="21306" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21306" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln&#45;&gt;k_hg3_ds2 -->
<g id="edge87" class="edge">
<title>ln&#45;&gt;k_hg3_ds2</title>
<path fill="none" stroke="black" d="M12229.69,-897.25C13596.45,-892.76 20513.21,-868.21 21059.38,-829.02"/>
<polygon fill="black" stroke="black" points="21060.05,-832.48 21069.75,-828.21 21059.5,-825.5 21060.05,-832.48"/>
</g>
<!-- v_hg3_ds2 -->
<g id="node61" class="node">
<title>v_hg3_ds2</title>
<polygon fill="lightcoral" stroke="black" points="22032,-829 21560,-829 21560,-746 22032,-746 22032,-829"/>
<text text-anchor="middle" x="21796" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="21796" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 2</text>
<text text-anchor="middle" x="21796" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="21796" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="21796" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln&#45;&gt;v_hg3_ds2 -->
<g id="edge88" class="edge">
<title>ln&#45;&gt;v_hg3_ds2</title>
<path fill="none" stroke="black" d="M12229.51,-897.35C13639.82,-893.29 20978.8,-870.29 21549.64,-829"/>
<polygon fill="black" stroke="black" points="21550.05,-832.48 21559.75,-828.21 21549.5,-825.5 21550.05,-832.48"/>
</g>
<!-- q_hg3_ds3 -->
<g id="node63" class="node">
<title>q_hg3_ds3</title>
<polygon fill="lightcoral" stroke="black" points="22522,-829 22050,-829 22050,-746 22522,-746 22522,-829"/>
<text text-anchor="middle" x="22286" y="-813.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="22286" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 3</text>
<text text-anchor="middle" x="22286" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="22286" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22286" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln&#45;&gt;q_hg3_ds3 -->
<g id="edge92" class="edge">
<title>ln&#45;&gt;q_hg3_ds3</title>
<path fill="none" stroke="black" d="M12229.54,-897.43C13682.46,-893.79 21441.39,-872.39 22039.54,-829.01"/>
<polygon fill="black" stroke="black" points="22040.05,-832.48 22049.75,-828.21 22039.5,-825.51 22040.05,-832.48"/>
</g>
<!-- k_hg3_ds3 -->
<g id="node64" class="node">
<title>k_hg3_ds3</title>
<polygon fill="lightcoral" stroke="black" points="23012,-829 22540,-829 22540,-746 23012,-746 23012,-829"/>
<text text-anchor="middle" x="22776" y="-813.8" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="22776" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 3</text>
<text text-anchor="middle" x="22776" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="22776" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22776" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln&#45;&gt;k_hg3_ds3 -->
<g id="edge93" class="edge">
<title>ln&#45;&gt;k_hg3_ds3</title>
<path fill="none" stroke="black" d="M12229.6,-897.51C13724.24,-894.26 21904.35,-874.49 22529.48,-829.02"/>
<polygon fill="black" stroke="black" points="22530.05,-832.49 22539.75,-828.21 22529.5,-825.51 22530.05,-832.49"/>
</g>
<!-- v_hg3_ds3 -->
<g id="node65" class="node">
<title>v_hg3_ds3</title>
<polygon fill="lightcoral" stroke="black" points="23502,-829 23030,-829 23030,-746 23502,-746 23502,-829"/>
<text text-anchor="middle" x="23266" y="-813.8" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="23266" y="-798.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 3</text>
<text text-anchor="middle" x="23266" y="-783.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="23266" y="-768.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="23266" y="-753.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln&#45;&gt;v_hg3_ds3 -->
<g id="edge94" class="edge">
<title>ln&#45;&gt;v_hg3_ds3</title>
<path fill="none" stroke="black" d="M12229.8,-897.58C13765.61,-894.71 22367.71,-876.6 23019.47,-829.02"/>
<polygon fill="black" stroke="black" points="23020.05,-832.49 23029.75,-828.21 23019.5,-825.51 23020.05,-832.49"/>
</g>
<!-- attn_hg0_ds0 -->
<g id="node6" class="node">
<title>attn_hg0_ds0</title>
<polygon fill="lightpink" stroke="black" points="1207,-710 735,-710 735,-597 1207,-597 1207,-710"/>
<text text-anchor="middle" x="971" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="971" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 0</text>
<text text-anchor="middle" x="971" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="971" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="971" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="971" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="971" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_hg0_ds0&#45;&gt;attn_hg0_ds0 -->
<g id="edge5" class="edge">
<title>q_hg0_ds0&#45;&gt;attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M461.52,-746C544.83,-731.04 639.65,-714.01 724.71,-698.73"/>
<polygon fill="black" stroke="black" points="725.55,-702.14 734.77,-696.93 724.31,-695.25 725.55,-702.14"/>
</g>
<!-- k_hg0_ds0&#45;&gt;attn_hg0_ds0 -->
<g id="edge6" class="edge">
<title>k_hg0_ds0&#45;&gt;attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M801.17,-746C819.35,-736.21 839.17,-725.53 858.64,-715.04"/>
<polygon fill="black" stroke="black" points="860.41,-718.06 867.55,-710.23 857.09,-711.9 860.41,-718.06"/>
</g>
<!-- v_hg0_ds0&#45;&gt;attn_hg0_ds0 -->
<g id="edge7" class="edge">
<title>v_hg0_ds0&#45;&gt;attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M1140.83,-746C1122.65,-736.21 1102.83,-725.53 1083.36,-715.04"/>
<polygon fill="black" stroke="black" points="1084.91,-711.9 1074.45,-710.23 1081.59,-718.06 1084.91,-711.9"/>
</g>
<!-- concat_group_0 -->
<g id="node67" class="node">
<title>concat_group_0</title>
<polygon fill="lightsteelblue" stroke="black" points="4164.86,-561 3371.29,-561 3167.14,-395 3960.71,-395 4164.86,-561"/>
<text text-anchor="middle" x="3666" y="-504.3" font-family="Times,serif" font-size="14.00">Concatenate Dimension Segments</text>
<text text-anchor="middle" x="3666" y="-489.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="3666" y="-474.3" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="3666" y="-459.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
<text text-anchor="middle" x="3666" y="-444.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- attn_hg0_ds0&#45;&gt;concat_group_0 -->
<g id="edge98" class="edge">
<title>attn_hg0_ds0&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" d="M1207.21,-637.29C1675.38,-607.15 2724.42,-539.62 3289.07,-503.27"/>
<polygon fill="black" stroke="black" points="3289.67,-506.74 3299.42,-502.6 3289.22,-499.75 3289.67,-506.74"/>
</g>
<!-- attn_hg0_ds1 -->
<g id="node10" class="node">
<title>attn_hg0_ds1</title>
<polygon fill="lightpink" stroke="black" points="2677,-710 2205,-710 2205,-597 2677,-597 2677,-710"/>
<text text-anchor="middle" x="2441" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2441" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 1</text>
<text text-anchor="middle" x="2441" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2441" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2441" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="2441" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="2441" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_hg0_ds1&#45;&gt;attn_hg0_ds1 -->
<g id="edge11" class="edge">
<title>q_hg0_ds1&#45;&gt;attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M1931.52,-746C2014.83,-731.04 2109.65,-714.01 2194.71,-698.73"/>
<polygon fill="black" stroke="black" points="2195.55,-702.14 2204.77,-696.93 2194.31,-695.25 2195.55,-702.14"/>
</g>
<!-- k_hg0_ds1&#45;&gt;attn_hg0_ds1 -->
<g id="edge12" class="edge">
<title>k_hg0_ds1&#45;&gt;attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M2271.17,-746C2289.35,-736.21 2309.17,-725.53 2328.64,-715.04"/>
<polygon fill="black" stroke="black" points="2330.41,-718.06 2337.55,-710.23 2327.09,-711.9 2330.41,-718.06"/>
</g>
<!-- v_hg0_ds1&#45;&gt;attn_hg0_ds1 -->
<g id="edge13" class="edge">
<title>v_hg0_ds1&#45;&gt;attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M2610.83,-746C2592.65,-736.21 2572.83,-725.53 2553.36,-715.04"/>
<polygon fill="black" stroke="black" points="2554.91,-711.9 2544.45,-710.23 2551.59,-718.06 2554.91,-711.9"/>
</g>
<!-- attn_hg0_ds1&#45;&gt;concat_group_0 -->
<g id="edge99" class="edge">
<title>attn_hg0_ds1&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" d="M2677.19,-619.05C2859.24,-593.26 3113.69,-557.23 3318.88,-528.16"/>
<polygon fill="black" stroke="black" points="3319.51,-531.61 3328.92,-526.74 3318.53,-524.68 3319.51,-531.61"/>
</g>
<!-- attn_hg0_ds2 -->
<g id="node14" class="node">
<title>attn_hg0_ds2</title>
<polygon fill="lightpink" stroke="black" points="3902,-710 3430,-710 3430,-597 3902,-597 3902,-710"/>
<text text-anchor="middle" x="3666" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3666" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 2</text>
<text text-anchor="middle" x="3666" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="3666" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="3666" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_hg0_ds2&#45;&gt;attn_hg0_ds2 -->
<g id="edge17" class="edge">
<title>q_hg0_ds2&#45;&gt;attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M3326.35,-746C3365.36,-735.49 3408.17,-723.96 3449.84,-712.73"/>
<polygon fill="black" stroke="black" points="3450.81,-716.09 3459.56,-710.11 3448.99,-709.33 3450.81,-716.09"/>
</g>
<!-- k_hg0_ds2&#45;&gt;attn_hg0_ds2 -->
<g id="edge18" class="edge">
<title>k_hg0_ds2&#45;&gt;attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M3666,-745.82C3666,-737.76 3666,-729.11 3666,-720.46"/>
<polygon fill="black" stroke="black" points="3669.5,-720.34 3666,-710.34 3662.5,-720.34 3669.5,-720.34"/>
</g>
<!-- v_hg0_ds2&#45;&gt;attn_hg0_ds2 -->
<g id="edge19" class="edge">
<title>v_hg0_ds2&#45;&gt;attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M4005.65,-746C3966.64,-735.49 3923.83,-723.96 3882.16,-712.73"/>
<polygon fill="black" stroke="black" points="3883.01,-709.33 3872.44,-710.11 3881.19,-716.09 3883.01,-709.33"/>
</g>
<!-- attn_hg0_ds2&#45;&gt;concat_group_0 -->
<g id="edge100" class="edge">
<title>attn_hg0_ds2&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" d="M3666,-596.65C3666,-588.53 3666,-580 3666,-571.39"/>
<polygon fill="black" stroke="black" points="3669.5,-571.28 3666,-561.28 3662.5,-571.28 3669.5,-571.28"/>
</g>
<!-- attn_hg0_ds3 -->
<g id="node18" class="node">
<title>attn_hg0_ds3</title>
<polygon fill="lightpink" stroke="black" points="5127,-710 4655,-710 4655,-597 5127,-597 5127,-710"/>
<text text-anchor="middle" x="4891" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4891" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 3</text>
<text text-anchor="middle" x="4891" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4891" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4891" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="4891" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="4891" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_hg0_ds3&#45;&gt;attn_hg0_ds3 -->
<g id="edge23" class="edge">
<title>q_hg0_ds3&#45;&gt;attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M4721.17,-746C4739.35,-736.21 4759.17,-725.53 4778.64,-715.04"/>
<polygon fill="black" stroke="black" points="4780.41,-718.06 4787.55,-710.23 4777.09,-711.9 4780.41,-718.06"/>
</g>
<!-- k_hg0_ds3&#45;&gt;attn_hg0_ds3 -->
<g id="edge24" class="edge">
<title>k_hg0_ds3&#45;&gt;attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M5060.83,-746C5042.65,-736.21 5022.83,-725.53 5003.36,-715.04"/>
<polygon fill="black" stroke="black" points="5004.91,-711.9 4994.45,-710.23 5001.59,-718.06 5004.91,-711.9"/>
</g>
<!-- v_hg0_ds3&#45;&gt;attn_hg0_ds3 -->
<g id="edge25" class="edge">
<title>v_hg0_ds3&#45;&gt;attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M5400.48,-746C5317.17,-731.04 5222.35,-714.01 5137.29,-698.73"/>
<polygon fill="black" stroke="black" points="5137.69,-695.25 5127.23,-696.93 5136.45,-702.14 5137.69,-695.25"/>
</g>
<!-- attn_hg0_ds3&#45;&gt;concat_group_0 -->
<g id="edge101" class="edge">
<title>attn_hg0_ds3&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" d="M4654.81,-619.05C4513.8,-599.08 4329.35,-572.95 4158,-548.68"/>
<polygon fill="black" stroke="black" points="4158.43,-545.21 4148.04,-547.27 4157.45,-552.14 4158.43,-545.21"/>
</g>
<!-- attn_hg1_ds0 -->
<g id="node22" class="node">
<title>attn_hg1_ds0</title>
<polygon fill="lightpink" stroke="black" points="7087,-710 6615,-710 6615,-597 7087,-597 7087,-710"/>
<text text-anchor="middle" x="6851" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6851" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 0</text>
<text text-anchor="middle" x="6851" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6851" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6851" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="6851" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="6851" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_hg1_ds0&#45;&gt;attn_hg1_ds0 -->
<g id="edge29" class="edge">
<title>q_hg1_ds0&#45;&gt;attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M6341.52,-746C6424.83,-731.04 6519.65,-714.01 6604.71,-698.73"/>
<polygon fill="black" stroke="black" points="6605.55,-702.14 6614.77,-696.93 6604.31,-695.25 6605.55,-702.14"/>
</g>
<!-- k_hg1_ds0&#45;&gt;attn_hg1_ds0 -->
<g id="edge30" class="edge">
<title>k_hg1_ds0&#45;&gt;attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M6681.17,-746C6699.35,-736.21 6719.17,-725.53 6738.64,-715.04"/>
<polygon fill="black" stroke="black" points="6740.41,-718.06 6747.55,-710.23 6737.09,-711.9 6740.41,-718.06"/>
</g>
<!-- v_hg1_ds0&#45;&gt;attn_hg1_ds0 -->
<g id="edge31" class="edge">
<title>v_hg1_ds0&#45;&gt;attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M7020.83,-746C7002.65,-736.21 6982.83,-725.53 6963.36,-715.04"/>
<polygon fill="black" stroke="black" points="6964.91,-711.9 6954.45,-710.23 6961.59,-718.06 6964.91,-711.9"/>
</g>
<!-- concat_group_1 -->
<g id="node68" class="node">
<title>concat_group_1</title>
<polygon fill="lightsteelblue" stroke="black" points="10044.86,-561 9251.29,-561 9047.14,-395 9840.71,-395 10044.86,-561"/>
<text text-anchor="middle" x="9546" y="-504.3" font-family="Times,serif" font-size="14.00">Concatenate Dimension Segments</text>
<text text-anchor="middle" x="9546" y="-489.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9546" y="-474.3" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="9546" y="-459.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
<text text-anchor="middle" x="9546" y="-444.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- attn_hg1_ds0&#45;&gt;concat_group_1 -->
<g id="edge102" class="edge">
<title>attn_hg1_ds0&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" d="M7087.21,-637.29C7555.38,-607.15 8604.42,-539.62 9169.07,-503.27"/>
<polygon fill="black" stroke="black" points="9169.67,-506.74 9179.42,-502.6 9169.22,-499.75 9169.67,-506.74"/>
</g>
<!-- attn_hg1_ds1 -->
<g id="node26" class="node">
<title>attn_hg1_ds1</title>
<polygon fill="lightpink" stroke="black" points="8557,-710 8085,-710 8085,-597 8557,-597 8557,-710"/>
<text text-anchor="middle" x="8321" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8321" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 1</text>
<text text-anchor="middle" x="8321" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8321" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8321" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="8321" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="8321" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_hg1_ds1&#45;&gt;attn_hg1_ds1 -->
<g id="edge35" class="edge">
<title>q_hg1_ds1&#45;&gt;attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M7811.52,-746C7894.83,-731.04 7989.65,-714.01 8074.71,-698.73"/>
<polygon fill="black" stroke="black" points="8075.55,-702.14 8084.77,-696.93 8074.31,-695.25 8075.55,-702.14"/>
</g>
<!-- k_hg1_ds1&#45;&gt;attn_hg1_ds1 -->
<g id="edge36" class="edge">
<title>k_hg1_ds1&#45;&gt;attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M8151.17,-746C8169.35,-736.21 8189.17,-725.53 8208.64,-715.04"/>
<polygon fill="black" stroke="black" points="8210.41,-718.06 8217.55,-710.23 8207.09,-711.9 8210.41,-718.06"/>
</g>
<!-- v_hg1_ds1&#45;&gt;attn_hg1_ds1 -->
<g id="edge37" class="edge">
<title>v_hg1_ds1&#45;&gt;attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M8490.83,-746C8472.65,-736.21 8452.83,-725.53 8433.36,-715.04"/>
<polygon fill="black" stroke="black" points="8434.91,-711.9 8424.45,-710.23 8431.59,-718.06 8434.91,-711.9"/>
</g>
<!-- attn_hg1_ds1&#45;&gt;concat_group_1 -->
<g id="edge103" class="edge">
<title>attn_hg1_ds1&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" d="M8557.19,-619.05C8739.24,-593.26 8993.69,-557.23 9198.88,-528.16"/>
<polygon fill="black" stroke="black" points="9199.51,-531.61 9208.92,-526.74 9198.53,-524.68 9199.51,-531.61"/>
</g>
<!-- attn_hg1_ds2 -->
<g id="node30" class="node">
<title>attn_hg1_ds2</title>
<polygon fill="lightpink" stroke="black" points="9782,-710 9310,-710 9310,-597 9782,-597 9782,-710"/>
<text text-anchor="middle" x="9546" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9546" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 2</text>
<text text-anchor="middle" x="9546" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9546" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9546" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="9546" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="9546" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_hg1_ds2&#45;&gt;attn_hg1_ds2 -->
<g id="edge41" class="edge">
<title>q_hg1_ds2&#45;&gt;attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M9206.35,-746C9245.36,-735.49 9288.17,-723.96 9329.84,-712.73"/>
<polygon fill="black" stroke="black" points="9330.81,-716.09 9339.56,-710.11 9328.99,-709.33 9330.81,-716.09"/>
</g>
<!-- k_hg1_ds2&#45;&gt;attn_hg1_ds2 -->
<g id="edge42" class="edge">
<title>k_hg1_ds2&#45;&gt;attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M9546,-745.82C9546,-737.76 9546,-729.11 9546,-720.46"/>
<polygon fill="black" stroke="black" points="9549.5,-720.34 9546,-710.34 9542.5,-720.34 9549.5,-720.34"/>
</g>
<!-- v_hg1_ds2&#45;&gt;attn_hg1_ds2 -->
<g id="edge43" class="edge">
<title>v_hg1_ds2&#45;&gt;attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M9885.65,-746C9846.64,-735.49 9803.83,-723.96 9762.16,-712.73"/>
<polygon fill="black" stroke="black" points="9763.01,-709.33 9752.44,-710.11 9761.19,-716.09 9763.01,-709.33"/>
</g>
<!-- attn_hg1_ds2&#45;&gt;concat_group_1 -->
<g id="edge104" class="edge">
<title>attn_hg1_ds2&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" d="M9546,-596.65C9546,-588.53 9546,-580 9546,-571.39"/>
<polygon fill="black" stroke="black" points="9549.5,-571.28 9546,-561.28 9542.5,-571.28 9549.5,-571.28"/>
</g>
<!-- attn_hg1_ds3 -->
<g id="node34" class="node">
<title>attn_hg1_ds3</title>
<polygon fill="lightpink" stroke="black" points="11007,-710 10535,-710 10535,-597 11007,-597 11007,-710"/>
<text text-anchor="middle" x="10771" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10771" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 3</text>
<text text-anchor="middle" x="10771" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10771" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10771" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="10771" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="10771" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_hg1_ds3&#45;&gt;attn_hg1_ds3 -->
<g id="edge47" class="edge">
<title>q_hg1_ds3&#45;&gt;attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M10601.17,-746C10619.35,-736.21 10639.17,-725.53 10658.64,-715.04"/>
<polygon fill="black" stroke="black" points="10660.41,-718.06 10667.55,-710.23 10657.09,-711.9 10660.41,-718.06"/>
</g>
<!-- k_hg1_ds3&#45;&gt;attn_hg1_ds3 -->
<g id="edge48" class="edge">
<title>k_hg1_ds3&#45;&gt;attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M10940.83,-746C10922.65,-736.21 10902.83,-725.53 10883.36,-715.04"/>
<polygon fill="black" stroke="black" points="10884.91,-711.9 10874.45,-710.23 10881.59,-718.06 10884.91,-711.9"/>
</g>
<!-- v_hg1_ds3&#45;&gt;attn_hg1_ds3 -->
<g id="edge49" class="edge">
<title>v_hg1_ds3&#45;&gt;attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M11280.48,-746C11197.17,-731.04 11102.35,-714.01 11017.29,-698.73"/>
<polygon fill="black" stroke="black" points="11017.69,-695.25 11007.23,-696.93 11016.45,-702.14 11017.69,-695.25"/>
</g>
<!-- attn_hg1_ds3&#45;&gt;concat_group_1 -->
<g id="edge105" class="edge">
<title>attn_hg1_ds3&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" d="M10534.81,-619.05C10393.8,-599.08 10209.35,-572.95 10038,-548.68"/>
<polygon fill="black" stroke="black" points="10038.43,-545.21 10028.04,-547.27 10037.45,-552.14 10038.43,-545.21"/>
</g>
<!-- attn_hg2_ds0 -->
<g id="node38" class="node">
<title>attn_hg2_ds0</title>
<polygon fill="lightpink" stroke="black" points="12967,-710 12495,-710 12495,-597 12967,-597 12967,-710"/>
<text text-anchor="middle" x="12731" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12731" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 0</text>
<text text-anchor="middle" x="12731" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12731" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12731" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="12731" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="12731" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_hg2_ds0&#45;&gt;attn_hg2_ds0 -->
<g id="edge53" class="edge">
<title>q_hg2_ds0&#45;&gt;attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M12221.52,-746C12304.83,-731.04 12399.65,-714.01 12484.71,-698.73"/>
<polygon fill="black" stroke="black" points="12485.55,-702.14 12494.77,-696.93 12484.31,-695.25 12485.55,-702.14"/>
</g>
<!-- k_hg2_ds0&#45;&gt;attn_hg2_ds0 -->
<g id="edge54" class="edge">
<title>k_hg2_ds0&#45;&gt;attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M12561.17,-746C12579.35,-736.21 12599.17,-725.53 12618.64,-715.04"/>
<polygon fill="black" stroke="black" points="12620.41,-718.06 12627.55,-710.23 12617.09,-711.9 12620.41,-718.06"/>
</g>
<!-- v_hg2_ds0&#45;&gt;attn_hg2_ds0 -->
<g id="edge55" class="edge">
<title>v_hg2_ds0&#45;&gt;attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M12900.83,-746C12882.65,-736.21 12862.83,-725.53 12843.36,-715.04"/>
<polygon fill="black" stroke="black" points="12844.91,-711.9 12834.45,-710.23 12841.59,-718.06 12844.91,-711.9"/>
</g>
<!-- concat_group_2 -->
<g id="node69" class="node">
<title>concat_group_2</title>
<polygon fill="lightsteelblue" stroke="black" points="14944.86,-561 14151.29,-561 13947.14,-395 14740.71,-395 14944.86,-561"/>
<text text-anchor="middle" x="14446" y="-504.3" font-family="Times,serif" font-size="14.00">Concatenate Dimension Segments</text>
<text text-anchor="middle" x="14446" y="-489.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="14446" y="-474.3" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="14446" y="-459.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
<text text-anchor="middle" x="14446" y="-444.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- attn_hg2_ds0&#45;&gt;concat_group_2 -->
<g id="edge106" class="edge">
<title>attn_hg2_ds0&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" d="M12967.21,-628.6C13255.85,-599.4 13747.24,-549.69 14083.77,-515.65"/>
<polygon fill="black" stroke="black" points="14084.58,-519.08 14094.18,-514.59 14083.88,-512.12 14084.58,-519.08"/>
</g>
<!-- attn_hg2_ds1 -->
<g id="node42" class="node">
<title>attn_hg2_ds1</title>
<polygon fill="lightpink" stroke="black" points="14437,-710 13965,-710 13965,-597 14437,-597 14437,-710"/>
<text text-anchor="middle" x="14201" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14201" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 1</text>
<text text-anchor="middle" x="14201" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14201" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14201" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="14201" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="14201" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_hg2_ds1&#45;&gt;attn_hg2_ds1 -->
<g id="edge59" class="edge">
<title>q_hg2_ds1&#45;&gt;attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M13691.52,-746C13774.83,-731.04 13869.65,-714.01 13954.71,-698.73"/>
<polygon fill="black" stroke="black" points="13955.55,-702.14 13964.77,-696.93 13954.31,-695.25 13955.55,-702.14"/>
</g>
<!-- k_hg2_ds1&#45;&gt;attn_hg2_ds1 -->
<g id="edge60" class="edge">
<title>k_hg2_ds1&#45;&gt;attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M14031.17,-746C14049.35,-736.21 14069.17,-725.53 14088.64,-715.04"/>
<polygon fill="black" stroke="black" points="14090.41,-718.06 14097.55,-710.23 14087.09,-711.9 14090.41,-718.06"/>
</g>
<!-- v_hg2_ds1&#45;&gt;attn_hg2_ds1 -->
<g id="edge61" class="edge">
<title>v_hg2_ds1&#45;&gt;attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M14370.83,-746C14352.65,-736.21 14332.83,-725.53 14313.36,-715.04"/>
<polygon fill="black" stroke="black" points="14314.91,-711.9 14304.45,-710.23 14311.59,-718.06 14314.91,-711.9"/>
</g>
<!-- attn_hg2_ds1&#45;&gt;concat_group_2 -->
<g id="edge107" class="edge">
<title>attn_hg2_ds1&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" d="M14279.53,-596.89C14292.99,-587.36 14307.26,-577.25 14321.56,-567.12"/>
<polygon fill="black" stroke="black" points="14323.85,-569.79 14329.98,-561.16 14319.8,-564.08 14323.85,-569.79"/>
</g>
<!-- attn_hg2_ds2 -->
<g id="node46" class="node">
<title>attn_hg2_ds2</title>
<polygon fill="lightpink" stroke="black" points="15417,-710 14945,-710 14945,-597 15417,-597 15417,-710"/>
<text text-anchor="middle" x="15181" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15181" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 2</text>
<text text-anchor="middle" x="15181" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15181" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15181" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="15181" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="15181" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_hg2_ds2&#45;&gt;attn_hg2_ds2 -->
<g id="edge65" class="edge">
<title>q_hg2_ds2&#45;&gt;attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M15011.17,-746C15029.35,-736.21 15049.17,-725.53 15068.64,-715.04"/>
<polygon fill="black" stroke="black" points="15070.41,-718.06 15077.55,-710.23 15067.09,-711.9 15070.41,-718.06"/>
</g>
<!-- k_hg2_ds2&#45;&gt;attn_hg2_ds2 -->
<g id="edge66" class="edge">
<title>k_hg2_ds2&#45;&gt;attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M15350.83,-746C15332.65,-736.21 15312.83,-725.53 15293.36,-715.04"/>
<polygon fill="black" stroke="black" points="15294.91,-711.9 15284.45,-710.23 15291.59,-718.06 15294.91,-711.9"/>
</g>
<!-- v_hg2_ds2&#45;&gt;attn_hg2_ds2 -->
<g id="edge67" class="edge">
<title>v_hg2_ds2&#45;&gt;attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M15690.48,-746C15607.17,-731.04 15512.35,-714.01 15427.29,-698.73"/>
<polygon fill="black" stroke="black" points="15427.69,-695.25 15417.23,-696.93 15426.45,-702.14 15427.69,-695.25"/>
</g>
<!-- attn_hg2_ds2&#45;&gt;concat_group_2 -->
<g id="edge108" class="edge">
<title>attn_hg2_ds2&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" d="M14945.66,-596.95C14900.28,-586.24 14851.8,-574.79 14803.55,-563.4"/>
<polygon fill="black" stroke="black" points="14804.12,-559.94 14793.59,-561.05 14802.51,-566.75 14804.12,-559.94"/>
</g>
<!-- attn_hg2_ds3 -->
<g id="node50" class="node">
<title>attn_hg2_ds3</title>
<polygon fill="lightpink" stroke="black" points="16887,-710 16415,-710 16415,-597 16887,-597 16887,-710"/>
<text text-anchor="middle" x="16651" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16651" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 3</text>
<text text-anchor="middle" x="16651" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16651" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16651" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="16651" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="16651" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_hg2_ds3&#45;&gt;attn_hg2_ds3 -->
<g id="edge71" class="edge">
<title>q_hg2_ds3&#45;&gt;attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M16481.17,-746C16499.35,-736.21 16519.17,-725.53 16538.64,-715.04"/>
<polygon fill="black" stroke="black" points="16540.41,-718.06 16547.55,-710.23 16537.09,-711.9 16540.41,-718.06"/>
</g>
<!-- k_hg2_ds3&#45;&gt;attn_hg2_ds3 -->
<g id="edge72" class="edge">
<title>k_hg2_ds3&#45;&gt;attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M16820.83,-746C16802.65,-736.21 16782.83,-725.53 16763.36,-715.04"/>
<polygon fill="black" stroke="black" points="16764.91,-711.9 16754.45,-710.23 16761.59,-718.06 16764.91,-711.9"/>
</g>
<!-- v_hg2_ds3&#45;&gt;attn_hg2_ds3 -->
<g id="edge73" class="edge">
<title>v_hg2_ds3&#45;&gt;attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M17160.48,-746C17077.17,-731.04 16982.35,-714.01 16897.29,-698.73"/>
<polygon fill="black" stroke="black" points="16897.69,-695.25 16887.23,-696.93 16896.45,-702.14 16897.69,-695.25"/>
</g>
<!-- attn_hg2_ds3&#45;&gt;concat_group_2 -->
<g id="edge109" class="edge">
<title>attn_hg2_ds3&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" d="M16414.76,-633.91C16053.4,-605.48 15356.97,-550.68 14896.8,-514.47"/>
<polygon fill="black" stroke="black" points="14896.9,-510.97 14886.66,-513.67 14896.35,-517.95 14896.9,-510.97"/>
</g>
<!-- attn_hg3_ds0 -->
<g id="node54" class="node">
<title>attn_hg3_ds0</title>
<polygon fill="lightpink" stroke="black" points="18847,-710 18375,-710 18375,-597 18847,-597 18847,-710"/>
<text text-anchor="middle" x="18611" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="18611" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 0</text>
<text text-anchor="middle" x="18611" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18611" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18611" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="18611" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="18611" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_hg3_ds0&#45;&gt;attn_hg3_ds0 -->
<g id="edge77" class="edge">
<title>q_hg3_ds0&#45;&gt;attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M18101.52,-746C18184.83,-731.04 18279.65,-714.01 18364.71,-698.73"/>
<polygon fill="black" stroke="black" points="18365.55,-702.14 18374.77,-696.93 18364.31,-695.25 18365.55,-702.14"/>
</g>
<!-- k_hg3_ds0&#45;&gt;attn_hg3_ds0 -->
<g id="edge78" class="edge">
<title>k_hg3_ds0&#45;&gt;attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M18441.17,-746C18459.35,-736.21 18479.17,-725.53 18498.64,-715.04"/>
<polygon fill="black" stroke="black" points="18500.41,-718.06 18507.55,-710.23 18497.09,-711.9 18500.41,-718.06"/>
</g>
<!-- v_hg3_ds0&#45;&gt;attn_hg3_ds0 -->
<g id="edge79" class="edge">
<title>v_hg3_ds0&#45;&gt;attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M18780.83,-746C18762.65,-736.21 18742.83,-725.53 18723.36,-715.04"/>
<polygon fill="black" stroke="black" points="18724.91,-711.9 18714.45,-710.23 18721.59,-718.06 18724.91,-711.9"/>
</g>
<!-- concat_group_3 -->
<g id="node70" class="node">
<title>concat_group_3</title>
<polygon fill="lightsteelblue" stroke="black" points="20334.86,-561 19541.29,-561 19337.14,-395 20130.71,-395 20334.86,-561"/>
<text text-anchor="middle" x="19836" y="-504.3" font-family="Times,serif" font-size="14.00">Concatenate Dimension Segments</text>
<text text-anchor="middle" x="19836" y="-489.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="19836" y="-474.3" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="19836" y="-459.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
<text text-anchor="middle" x="19836" y="-444.3" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- attn_hg3_ds0&#45;&gt;concat_group_3 -->
<g id="edge110" class="edge">
<title>attn_hg3_ds0&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" d="M18847.19,-619.05C19029.24,-593.26 19283.69,-557.23 19488.88,-528.16"/>
<polygon fill="black" stroke="black" points="19489.51,-531.61 19498.92,-526.74 19488.53,-524.68 19489.51,-531.61"/>
</g>
<!-- attn_hg3_ds1 -->
<g id="node58" class="node">
<title>attn_hg3_ds1</title>
<polygon fill="lightpink" stroke="black" points="20072,-710 19600,-710 19600,-597 20072,-597 20072,-710"/>
<text text-anchor="middle" x="19836" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="19836" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 1</text>
<text text-anchor="middle" x="19836" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19836" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19836" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="19836" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="19836" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_hg3_ds1&#45;&gt;attn_hg3_ds1 -->
<g id="edge83" class="edge">
<title>q_hg3_ds1&#45;&gt;attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M19496.35,-746C19535.36,-735.49 19578.17,-723.96 19619.84,-712.73"/>
<polygon fill="black" stroke="black" points="19620.81,-716.09 19629.56,-710.11 19618.99,-709.33 19620.81,-716.09"/>
</g>
<!-- k_hg3_ds1&#45;&gt;attn_hg3_ds1 -->
<g id="edge84" class="edge">
<title>k_hg3_ds1&#45;&gt;attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M19836,-745.82C19836,-737.76 19836,-729.11 19836,-720.46"/>
<polygon fill="black" stroke="black" points="19839.5,-720.34 19836,-710.34 19832.5,-720.34 19839.5,-720.34"/>
</g>
<!-- v_hg3_ds1&#45;&gt;attn_hg3_ds1 -->
<g id="edge85" class="edge">
<title>v_hg3_ds1&#45;&gt;attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M20175.65,-746C20136.64,-735.49 20093.83,-723.96 20052.16,-712.73"/>
<polygon fill="black" stroke="black" points="20053.01,-709.33 20042.44,-710.11 20051.19,-716.09 20053.01,-709.33"/>
</g>
<!-- attn_hg3_ds1&#45;&gt;concat_group_3 -->
<g id="edge111" class="edge">
<title>attn_hg3_ds1&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" d="M19836,-596.65C19836,-588.53 19836,-580 19836,-571.39"/>
<polygon fill="black" stroke="black" points="19839.5,-571.28 19836,-561.28 19832.5,-571.28 19839.5,-571.28"/>
</g>
<!-- attn_hg3_ds2 -->
<g id="node62" class="node">
<title>attn_hg3_ds2</title>
<polygon fill="lightpink" stroke="black" points="21297,-710 20825,-710 20825,-597 21297,-597 21297,-710"/>
<text text-anchor="middle" x="21061" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="21061" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 2</text>
<text text-anchor="middle" x="21061" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21061" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21061" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="21061" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="21061" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_hg3_ds2&#45;&gt;attn_hg3_ds2 -->
<g id="edge89" class="edge">
<title>q_hg3_ds2&#45;&gt;attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M20891.17,-746C20909.35,-736.21 20929.17,-725.53 20948.64,-715.04"/>
<polygon fill="black" stroke="black" points="20950.41,-718.06 20957.55,-710.23 20947.09,-711.9 20950.41,-718.06"/>
</g>
<!-- k_hg3_ds2&#45;&gt;attn_hg3_ds2 -->
<g id="edge90" class="edge">
<title>k_hg3_ds2&#45;&gt;attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M21230.83,-746C21212.65,-736.21 21192.83,-725.53 21173.36,-715.04"/>
<polygon fill="black" stroke="black" points="21174.91,-711.9 21164.45,-710.23 21171.59,-718.06 21174.91,-711.9"/>
</g>
<!-- v_hg3_ds2&#45;&gt;attn_hg3_ds2 -->
<g id="edge91" class="edge">
<title>v_hg3_ds2&#45;&gt;attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M21570.48,-746C21487.17,-731.04 21392.35,-714.01 21307.29,-698.73"/>
<polygon fill="black" stroke="black" points="21307.69,-695.25 21297.23,-696.93 21306.45,-702.14 21307.69,-695.25"/>
</g>
<!-- attn_hg3_ds2&#45;&gt;concat_group_3 -->
<g id="edge112" class="edge">
<title>attn_hg3_ds2&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" d="M20824.81,-619.05C20683.8,-599.08 20499.35,-572.95 20328,-548.68"/>
<polygon fill="black" stroke="black" points="20328.43,-545.21 20318.04,-547.27 20327.45,-552.14 20328.43,-545.21"/>
</g>
<!-- attn_hg3_ds3 -->
<g id="node66" class="node">
<title>attn_hg3_ds3</title>
<polygon fill="lightpink" stroke="black" points="22767,-710 22295,-710 22295,-597 22767,-597 22767,-710"/>
<text text-anchor="middle" x="22531" y="-694.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="22531" y="-679.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 3</text>
<text text-anchor="middle" x="22531" y="-664.8" font-family="Times,serif" font-size="14.00">Q: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22531" y="-649.8" font-family="Times,serif" font-size="14.00">K: [batch_size=1024, seq_len=10000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22531" y="-634.8" font-family="Times,serif" font-size="14.00">V: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="22531" y="-619.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="22531" y="-604.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_hg3_ds3&#45;&gt;attn_hg3_ds3 -->
<g id="edge95" class="edge">
<title>q_hg3_ds3&#45;&gt;attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M22361.17,-746C22379.35,-736.21 22399.17,-725.53 22418.64,-715.04"/>
<polygon fill="black" stroke="black" points="22420.41,-718.06 22427.55,-710.23 22417.09,-711.9 22420.41,-718.06"/>
</g>
<!-- k_hg3_ds3&#45;&gt;attn_hg3_ds3 -->
<g id="edge96" class="edge">
<title>k_hg3_ds3&#45;&gt;attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M22700.83,-746C22682.65,-736.21 22662.83,-725.53 22643.36,-715.04"/>
<polygon fill="black" stroke="black" points="22644.91,-711.9 22634.45,-710.23 22641.59,-718.06 22644.91,-711.9"/>
</g>
<!-- v_hg3_ds3&#45;&gt;attn_hg3_ds3 -->
<g id="edge97" class="edge">
<title>v_hg3_ds3&#45;&gt;attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M23040.48,-746C22957.17,-731.04 22862.35,-714.01 22777.29,-698.73"/>
<polygon fill="black" stroke="black" points="22777.69,-695.25 22767.23,-696.93 22776.45,-702.14 22777.69,-695.25"/>
</g>
<!-- attn_hg3_ds3&#45;&gt;concat_group_3 -->
<g id="edge113" class="edge">
<title>attn_hg3_ds3&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" d="M22294.79,-637.29C21844.21,-608.29 20855.58,-544.64 20278.56,-507.49"/>
<polygon fill="black" stroke="black" points="20278.61,-503.99 20268.4,-506.84 20278.16,-510.97 20278.61,-503.99"/>
</g>
<!-- final_concat -->
<g id="node71" class="node">
<title>final_concat</title>
<polygon fill="lightsteelblue" stroke="black" points="14944.86,-359 14151.29,-359 13947.14,-223 14740.71,-223 14944.86,-359"/>
<text text-anchor="middle" x="14446" y="-309.8" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="14446" y="-294.8" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
<text text-anchor="middle" x="14446" y="-279.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="14446" y="-264.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- concat_group_0&#45;&gt;final_concat -->
<g id="edge114" class="edge">
<title>concat_group_0&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M4053.64,-470.35C5731.16,-441.56 12356.81,-327.85 14050.22,-298.79"/>
<polygon fill="black" stroke="black" points="14050.48,-302.29 14060.42,-298.62 14050.36,-295.29 14050.48,-302.29"/>
</g>
<!-- concat_group_1&#45;&gt;final_concat -->
<g id="edge115" class="edge">
<title>concat_group_1&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M9924.13,-462.72C10835.21,-428.33 13144.15,-341.15 14061.6,-306.51"/>
<polygon fill="black" stroke="black" points="14061.8,-310.01 14071.66,-306.13 14061.54,-303.01 14061.8,-310.01"/>
</g>
<!-- concat_group_2&#45;&gt;final_concat -->
<g id="edge116" class="edge">
<title>concat_group_2&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M14446,-394.78C14446,-386.34 14446,-377.79 14446,-369.4"/>
<polygon fill="black" stroke="black" points="14449.5,-369.28 14446,-359.28 14442.5,-369.28 14449.5,-369.28"/>
</g>
<!-- concat_group_3&#45;&gt;final_concat -->
<g id="edge117" class="edge">
<title>concat_group_3&#45;&gt;final_concat</title>
<path fill="none" stroke="black" d="M19420.33,-462.73C18420.76,-428.43 15890.38,-341.58 14876.17,-306.76"/>
<polygon fill="black" stroke="black" points="14876.28,-303.27 14866.16,-306.42 14876.04,-310.26 14876.28,-303.27"/>
</g>
<!-- output_proj -->
<g id="node72" class="node">
<title>output_proj</title>
<polygon fill="lightcoral" stroke="black" points="19580.5,-187 19113.5,-187 19113.5,-119 19580.5,-119 19580.5,-187"/>
<text text-anchor="middle" x="19347" y="-171.8" font-family="Times,serif" font-size="14.00">Output Linear Projection</text>
<text text-anchor="middle" x="19347" y="-156.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19347" y="-141.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="19347" y="-126.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs (tensor parallel)</text>
</g>
<!-- final_concat&#45;&gt;output_proj -->
<g id="edge118" class="edge">
<title>final_concat&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M14825.48,-279.47C15788.75,-252.74 18308.43,-182.82 19103.17,-160.77"/>
<polygon fill="black" stroke="black" points="19103.41,-164.26 19113.31,-160.48 19103.22,-157.26 19103.41,-164.26"/>
</g>
<!-- output_proj&#45;&gt;residual -->
<g id="edge119" class="edge">
<title>output_proj&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M19386.66,-118.85C19397.55,-109.75 19409.58,-99.69 19421.23,-89.95"/>
<polygon fill="black" stroke="black" points="19423.79,-92.38 19429.22,-83.28 19419.3,-87.01 19423.79,-92.38"/>
</g>
</g>
</svg>
