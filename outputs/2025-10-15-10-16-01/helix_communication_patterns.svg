<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: helix_communication_patterns Pages: 1 -->
<svg width="1145pt" height="1440pt"
 viewBox="0.00 0.00 1145.50 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.45 0.45) rotate(0) translate(4 3228)">
<title>helix_communication_patterns</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3228 2567.01,-3228 2567.01,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_device_0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-209 8,-402 496,-402 496,-209 8,-209"/>
<text text-anchor="middle" x="252" y="-386.8" font-family="Times,serif" font-size="14.00">Device 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_device_1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-8 8,-201 496,-201 496,-8 8,-8"/>
<text text-anchor="middle" x="252" y="-185.8" font-family="Times,serif" font-size="14.00">Device 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_device_2</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-611 8,-804 496,-804 496,-611 8,-611"/>
<text text-anchor="middle" x="252" y="-788.8" font-family="Times,serif" font-size="14.00">Device 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_device_3</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-410 8,-603 496,-603 496,-410 8,-410"/>
<text text-anchor="middle" x="252" y="-587.8" font-family="Times,serif" font-size="14.00">Device 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_device_4</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-2621 8,-2814 496,-2814 496,-2621 8,-2621"/>
<text text-anchor="middle" x="252" y="-2798.8" font-family="Times,serif" font-size="14.00">Device 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_device_5</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-2420 8,-2613 496,-2613 496,-2420 8,-2420"/>
<text text-anchor="middle" x="252" y="-2597.8" font-family="Times,serif" font-size="14.00">Device 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_device_6</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-3023 8,-3216 496,-3216 496,-3023 8,-3023"/>
<text text-anchor="middle" x="252" y="-3200.8" font-family="Times,serif" font-size="14.00">Device 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_device_7</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-2822 8,-3015 496,-3015 496,-2822 8,-2822"/>
<text text-anchor="middle" x="252" y="-2999.8" font-family="Times,serif" font-size="14.00">Device 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_device_8</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-1817 8,-2010 496,-2010 496,-1817 8,-1817"/>
<text text-anchor="middle" x="252" y="-1994.8" font-family="Times,serif" font-size="14.00">Device 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_device_9</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-1616 8,-1809 496,-1809 496,-1616 8,-1616"/>
<text text-anchor="middle" x="252" y="-1793.8" font-family="Times,serif" font-size="14.00">Device 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_device_10</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-2219 8,-2412 496,-2412 496,-2219 8,-2219"/>
<text text-anchor="middle" x="252" y="-2396.8" font-family="Times,serif" font-size="14.00">Device 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_device_11</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-2018 8,-2211 496,-2211 496,-2018 8,-2018"/>
<text text-anchor="middle" x="252" y="-2195.8" font-family="Times,serif" font-size="14.00">Device 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_device_12</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-1013 8,-1206 496,-1206 496,-1013 8,-1013"/>
<text text-anchor="middle" x="252" y="-1190.8" font-family="Times,serif" font-size="14.00">Device 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_device_13</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-812 8,-1005 496,-1005 496,-812 8,-812"/>
<text text-anchor="middle" x="252" y="-989.8" font-family="Times,serif" font-size="14.00">Device 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_device_14</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-1415 8,-1608 496,-1608 496,-1415 8,-1415"/>
<text text-anchor="middle" x="252" y="-1592.8" font-family="Times,serif" font-size="14.00">Device 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_device_15</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-1214 8,-1407 496,-1407 496,-1214 8,-1214"/>
<text text-anchor="middle" x="252" y="-1391.8" font-family="Times,serif" font-size="14.00">Device 15</text>
</g>
<!-- mha_part_0 -->
<g id="node1" class="node">
<title>mha_part_0</title>
<polygon fill="lightcoral" stroke="black" points="488,-285 16,-285 16,-217 488,-217 488,-285"/>
<text text-anchor="middle" x="252" y="-269.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-254.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 0</text>
<text text-anchor="middle" x="252" y="-239.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-224.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- group_concat_0 -->
<g id="node33" class="node">
<title>group_concat_0</title>
<polygon fill="lightsteelblue" stroke="black" points="1525.68,-520 732.11,-520 527.97,-384 1321.54,-384 1525.68,-520"/>
<text text-anchor="middle" x="1026.83" y="-470.8" font-family="Times,serif" font-size="14.00">Concatenate Group 0</text>
<text text-anchor="middle" x="1026.83" y="-455.8" font-family="Times,serif" font-size="14.00">4 devices → 1</text>
<text text-anchor="middle" x="1026.83" y="-440.8" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="1026.83" y="-425.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
</g>
<!-- mha_part_0&#45;&gt;group_concat_0 -->
<g id="edge1" class="edge">
<title>mha_part_0&#45;&gt;group_concat_0</title>
<path fill="none" stroke="black" d="M455.57,-285.03C469.29,-287.9 482.87,-290.89 496,-294 599.62,-318.53 712.93,-351.48 808.08,-380.93"/>
<polygon fill="black" stroke="black" points="807.23,-384.33 817.82,-383.95 809.3,-377.65 807.23,-384.33"/>
</g>
<!-- mlp_part_0 -->
<g id="node2" class="node">
<title>mlp_part_0</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-371 18.5,-371 18.5,-303 485.5,-303 485.5,-371"/>
<text text-anchor="middle" x="252" y="-355.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-340.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 0</text>
<text text-anchor="middle" x="252" y="-325.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-310.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- all_reduce_mlp -->
<g id="node38" class="node">
<title>all_reduce_mlp</title>
<polygon fill="lightsteelblue" stroke="black" points="1529.48,-1668 729.87,-1668 524.17,-1532 1323.78,-1532 1529.48,-1668"/>
<text text-anchor="middle" x="1026.83" y="-1618.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="1026.83" y="-1603.8" font-family="Times,serif" font-size="14.00">16 devices → 1</text>
<text text-anchor="middle" x="1026.83" y="-1588.8" font-family="Times,serif" font-size="14.00">Input: 16×[batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1026.83" y="-1573.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_0&#45;&gt;all_reduce_mlp -->
<g id="edge2" class="edge">
<title>mlp_part_0&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M455.63,-371.08C471.03,-380.27 484.88,-391.73 496,-406 559.36,-487.27 469.61,-1245.48 524,-1333 581.08,-1424.86 681.26,-1487 777.17,-1528.03"/>
<polygon fill="black" stroke="black" points="775.86,-1531.28 786.43,-1531.94 778.58,-1524.83 775.86,-1531.28"/>
</g>
<!-- mha_part_1 -->
<g id="node3" class="node">
<title>mha_part_1</title>
<polygon fill="lightcoral" stroke="black" points="488,-84 16,-84 16,-16 488,-16 488,-84"/>
<text text-anchor="middle" x="252" y="-68.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-53.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 1</text>
<text text-anchor="middle" x="252" y="-38.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-23.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_1&#45;&gt;group_concat_0 -->
<g id="edge3" class="edge">
<title>mha_part_1&#45;&gt;group_concat_0</title>
<path fill="none" stroke="black" d="M471.54,-84.04C479.88,-86.8 488.06,-89.78 496,-93 667.93,-162.73 840.98,-294.23 940.55,-377.25"/>
<polygon fill="black" stroke="black" points="938.56,-380.15 948.47,-383.89 943.05,-374.79 938.56,-380.15"/>
</g>
<!-- mlp_part_1 -->
<g id="node4" class="node">
<title>mlp_part_1</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-170 18.5,-170 18.5,-102 485.5,-102 485.5,-170"/>
<text text-anchor="middle" x="252" y="-154.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-139.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 1</text>
<text text-anchor="middle" x="252" y="-124.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-109.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_1&#45;&gt;all_reduce_mlp -->
<g id="edge4" class="edge">
<title>mlp_part_1&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M455.71,-170.02C471.09,-179.22 484.92,-190.7 496,-205 572.82,-304.08 458.11,-1226.34 524,-1333 580.77,-1424.91 680.75,-1487.04 776.6,-1528.05"/>
<polygon fill="black" stroke="black" points="775.29,-1531.29 785.87,-1531.95 778.01,-1524.84 775.29,-1531.29"/>
</g>
<!-- mha_part_2 -->
<g id="node5" class="node">
<title>mha_part_2</title>
<polygon fill="lightcoral" stroke="black" points="488,-687 16,-687 16,-619 488,-619 488,-687"/>
<text text-anchor="middle" x="252" y="-671.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-656.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 2</text>
<text text-anchor="middle" x="252" y="-641.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-626.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_2&#45;&gt;group_concat_0 -->
<g id="edge5" class="edge">
<title>mha_part_2&#45;&gt;group_concat_0</title>
<path fill="none" stroke="black" d="M442.75,-618.94C460.8,-615.14 478.78,-611.14 496,-607 597.02,-582.72 707.48,-551.21 801.28,-522.95"/>
<polygon fill="black" stroke="black" points="802.33,-526.29 810.89,-520.05 800.3,-519.59 802.33,-526.29"/>
</g>
<!-- mlp_part_2 -->
<g id="node6" class="node">
<title>mlp_part_2</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-773 18.5,-773 18.5,-705 485.5,-705 485.5,-773"/>
<text text-anchor="middle" x="252" y="-757.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-742.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 2</text>
<text text-anchor="middle" x="252" y="-727.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-712.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_2&#45;&gt;all_reduce_mlp -->
<g id="edge6" class="edge">
<title>mlp_part_2&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M454.72,-773.03C470.42,-782.21 484.58,-793.69 496,-808 568.89,-899.31 461.19,-1234.48 524,-1333 582.46,-1424.7 683.57,-1486.92 779.79,-1528.06"/>
<polygon fill="black" stroke="black" points="778.51,-1531.32 789.08,-1531.98 781.23,-1524.87 778.51,-1531.32"/>
</g>
<!-- mha_part_3 -->
<g id="node7" class="node">
<title>mha_part_3</title>
<polygon fill="lightcoral" stroke="black" points="488,-486 16,-486 16,-418 488,-418 488,-486"/>
<text text-anchor="middle" x="252" y="-470.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-455.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Seg 3</text>
<text text-anchor="middle" x="252" y="-440.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-425.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_3&#45;&gt;group_concat_0 -->
<g id="edge7" class="edge">
<title>mha_part_3&#45;&gt;group_concat_0</title>
<path fill="none" stroke="black" d="M488.02,-452C529.93,-452 574.65,-452 619.74,-452"/>
<polygon fill="black" stroke="black" points="619.97,-455.5 629.97,-452 619.97,-448.5 619.97,-455.5"/>
</g>
<!-- mlp_part_3 -->
<g id="node8" class="node">
<title>mlp_part_3</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-572 18.5,-572 18.5,-504 485.5,-504 485.5,-572"/>
<text text-anchor="middle" x="252" y="-556.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-541.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 3</text>
<text text-anchor="middle" x="252" y="-526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_3&#45;&gt;all_reduce_mlp -->
<g id="edge8" class="edge">
<title>mlp_part_3&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M455.22,-572.02C470.76,-581.21 484.75,-592.69 496,-607 545.9,-670.46 481.11,-1264.61 524,-1333 581.59,-1424.82 682.14,-1487 778.18,-1528.07"/>
<polygon fill="black" stroke="black" points="776.88,-1531.32 787.46,-1531.98 779.6,-1524.87 776.88,-1531.32"/>
</g>
<!-- mha_part_4 -->
<g id="node9" class="node">
<title>mha_part_4</title>
<polygon fill="lightcoral" stroke="black" points="488,-2783 16,-2783 16,-2715 488,-2715 488,-2783"/>
<text text-anchor="middle" x="252" y="-2767.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-2752.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 0</text>
<text text-anchor="middle" x="252" y="-2737.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2722.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- group_concat_1 -->
<g id="node34" class="node">
<title>group_concat_1</title>
<polygon fill="lightsteelblue" stroke="black" points="1525.68,-2817 732.11,-2817 527.97,-2681 1321.54,-2681 1525.68,-2817"/>
<text text-anchor="middle" x="1026.83" y="-2767.8" font-family="Times,serif" font-size="14.00">Concatenate Group 1</text>
<text text-anchor="middle" x="1026.83" y="-2752.8" font-family="Times,serif" font-size="14.00">4 devices → 1</text>
<text text-anchor="middle" x="1026.83" y="-2737.8" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="1026.83" y="-2722.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
</g>
<!-- mha_part_4&#45;&gt;group_concat_1 -->
<g id="edge9" class="edge">
<title>mha_part_4&#45;&gt;group_concat_1</title>
<path fill="none" stroke="black" d="M488.02,-2749C529.93,-2749 574.65,-2749 619.74,-2749"/>
<polygon fill="black" stroke="black" points="619.97,-2752.5 629.97,-2749 619.97,-2745.5 619.97,-2752.5"/>
</g>
<!-- mlp_part_4 -->
<g id="node10" class="node">
<title>mlp_part_4</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-2697 18.5,-2697 18.5,-2629 485.5,-2629 485.5,-2697"/>
<text text-anchor="middle" x="252" y="-2681.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-2666.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 4</text>
<text text-anchor="middle" x="252" y="-2651.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2636.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_4&#45;&gt;all_reduce_mlp -->
<g id="edge10" class="edge">
<title>mlp_part_4&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M484.34,-2628.78C488.46,-2625.15 492.36,-2621.23 496,-2617 550.32,-2553.87 479.85,-1938.61 524,-1868 581.7,-1775.72 682.71,-1713.23 779.05,-1671.97"/>
<polygon fill="black" stroke="black" points="780.51,-1675.16 788.36,-1668.05 777.79,-1668.71 780.51,-1675.16"/>
</g>
<!-- mha_part_5 -->
<g id="node11" class="node">
<title>mha_part_5</title>
<polygon fill="lightcoral" stroke="black" points="488,-2582 16,-2582 16,-2514 488,-2514 488,-2582"/>
<text text-anchor="middle" x="252" y="-2566.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-2551.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 1</text>
<text text-anchor="middle" x="252" y="-2536.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2521.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_5&#45;&gt;group_concat_1 -->
<g id="edge11" class="edge">
<title>mha_part_5&#45;&gt;group_concat_1</title>
<path fill="none" stroke="black" d="M384.1,-2582.1C485.25,-2608.4 628.65,-2645.7 754.24,-2678.37"/>
<polygon fill="black" stroke="black" points="753.46,-2681.78 764.02,-2680.91 755.22,-2675 753.46,-2681.78"/>
</g>
<!-- mlp_part_5 -->
<g id="node12" class="node">
<title>mlp_part_5</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-2496 18.5,-2496 18.5,-2428 485.5,-2428 485.5,-2496"/>
<text text-anchor="middle" x="252" y="-2480.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-2465.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 5</text>
<text text-anchor="middle" x="252" y="-2450.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2435.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_5&#45;&gt;all_reduce_mlp -->
<g id="edge12" class="edge">
<title>mlp_part_5&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M484.26,-2427.71C488.41,-2424.1 492.33,-2420.21 496,-2416 536.08,-2370.06 491.32,-1919.47 524,-1868 582.53,-1775.81 684.1,-1713.27 780.62,-1671.95"/>
<polygon fill="black" stroke="black" points="782.09,-1675.13 789.94,-1668.02 779.37,-1668.68 782.09,-1675.13"/>
</g>
<!-- mha_part_6 -->
<g id="node13" class="node">
<title>mha_part_6</title>
<polygon fill="lightcoral" stroke="black" points="488,-3185 16,-3185 16,-3117 488,-3117 488,-3185"/>
<text text-anchor="middle" x="252" y="-3169.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-3154.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 2</text>
<text text-anchor="middle" x="252" y="-3139.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-3124.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_6&#45;&gt;group_concat_1 -->
<g id="edge13" class="edge">
<title>mha_part_6&#45;&gt;group_concat_1</title>
<path fill="none" stroke="black" d="M471.54,-3116.96C479.88,-3114.2 488.06,-3111.22 496,-3108 667.93,-3038.27 840.98,-2906.77 940.55,-2823.75"/>
<polygon fill="black" stroke="black" points="943.05,-2826.21 948.47,-2817.11 938.56,-2820.85 943.05,-2826.21"/>
</g>
<!-- mlp_part_6 -->
<g id="node14" class="node">
<title>mlp_part_6</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-3099 18.5,-3099 18.5,-3031 485.5,-3031 485.5,-3099"/>
<text text-anchor="middle" x="252" y="-3083.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-3068.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 6</text>
<text text-anchor="middle" x="252" y="-3053.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-3038.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_6&#45;&gt;all_reduce_mlp -->
<g id="edge14" class="edge">
<title>mlp_part_6&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M484.42,-3030.84C488.51,-3027.2 492.39,-3023.25 496,-3019 537.4,-2970.24 490.44,-1922.45 524,-1868 580.91,-1775.65 681.36,-1713.21 777.51,-1672.02"/>
<polygon fill="black" stroke="black" points="778.95,-1675.21 786.8,-1668.1 776.23,-1668.76 778.95,-1675.21"/>
</g>
<!-- mha_part_7 -->
<g id="node15" class="node">
<title>mha_part_7</title>
<polygon fill="lightcoral" stroke="black" points="488,-2984 16,-2984 16,-2916 488,-2916 488,-2984"/>
<text text-anchor="middle" x="252" y="-2968.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-2953.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Seg 3</text>
<text text-anchor="middle" x="252" y="-2938.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2923.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_7&#45;&gt;group_concat_1 -->
<g id="edge15" class="edge">
<title>mha_part_7&#45;&gt;group_concat_1</title>
<path fill="none" stroke="black" d="M455.57,-2915.97C469.29,-2913.1 482.87,-2910.11 496,-2907 599.62,-2882.47 712.93,-2849.52 808.08,-2820.07"/>
<polygon fill="black" stroke="black" points="809.3,-2823.35 817.82,-2817.05 807.23,-2816.67 809.3,-2823.35"/>
</g>
<!-- mlp_part_7 -->
<g id="node16" class="node">
<title>mlp_part_7</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-2898 18.5,-2898 18.5,-2830 485.5,-2830 485.5,-2898"/>
<text text-anchor="middle" x="252" y="-2882.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-2867.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 7</text>
<text text-anchor="middle" x="252" y="-2852.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2837.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_7&#45;&gt;all_reduce_mlp -->
<g id="edge16" class="edge">
<title>mlp_part_7&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M484.39,-2829.82C488.49,-2826.18 492.38,-2822.25 496,-2818 564.56,-2737.68 468.37,-1957.76 524,-1868 581.21,-1775.69 681.85,-1713.24 778.06,-1672.02"/>
<polygon fill="black" stroke="black" points="779.51,-1675.22 787.36,-1668.1 776.78,-1668.77 779.51,-1675.22"/>
</g>
<!-- mha_part_8 -->
<g id="node17" class="node">
<title>mha_part_8</title>
<polygon fill="lightcoral" stroke="black" points="488,-1979 16,-1979 16,-1911 488,-1911 488,-1979"/>
<text text-anchor="middle" x="252" y="-1963.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-1948.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 0</text>
<text text-anchor="middle" x="252" y="-1933.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1918.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- group_concat_2 -->
<g id="node35" class="node">
<title>group_concat_2</title>
<polygon fill="lightsteelblue" stroke="black" points="1525.68,-2013 732.11,-2013 527.97,-1877 1321.54,-1877 1525.68,-2013"/>
<text text-anchor="middle" x="1026.83" y="-1963.8" font-family="Times,serif" font-size="14.00">Concatenate Group 2</text>
<text text-anchor="middle" x="1026.83" y="-1948.8" font-family="Times,serif" font-size="14.00">4 devices → 1</text>
<text text-anchor="middle" x="1026.83" y="-1933.8" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="1026.83" y="-1918.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
</g>
<!-- mha_part_8&#45;&gt;group_concat_2 -->
<g id="edge17" class="edge">
<title>mha_part_8&#45;&gt;group_concat_2</title>
<path fill="none" stroke="black" d="M488.02,-1945C529.93,-1945 574.65,-1945 619.74,-1945"/>
<polygon fill="black" stroke="black" points="619.97,-1948.5 629.97,-1945 619.97,-1941.5 619.97,-1948.5"/>
</g>
<!-- mlp_part_8 -->
<g id="node18" class="node">
<title>mlp_part_8</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-1893 18.5,-1893 18.5,-1825 485.5,-1825 485.5,-1893"/>
<text text-anchor="middle" x="252" y="-1877.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-1862.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 8</text>
<text text-anchor="middle" x="252" y="-1847.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1832.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_8&#45;&gt;all_reduce_mlp -->
<g id="edge18" class="edge">
<title>mlp_part_8&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M450.72,-1824.94C466.13,-1821.26 481.37,-1817.28 496,-1813 624.84,-1775.3 765.62,-1717.89 869.66,-1672.16"/>
<polygon fill="black" stroke="black" points="871.24,-1675.29 878.98,-1668.06 868.42,-1668.89 871.24,-1675.29"/>
</g>
<!-- mha_part_9 -->
<g id="node19" class="node">
<title>mha_part_9</title>
<polygon fill="lightcoral" stroke="black" points="488,-1778 16,-1778 16,-1710 488,-1710 488,-1778"/>
<text text-anchor="middle" x="252" y="-1762.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-1747.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 1</text>
<text text-anchor="middle" x="252" y="-1732.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1717.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_9&#45;&gt;group_concat_2 -->
<g id="edge19" class="edge">
<title>mha_part_9&#45;&gt;group_concat_2</title>
<path fill="none" stroke="black" d="M384.1,-1778.1C485.25,-1804.4 628.65,-1841.7 754.24,-1874.37"/>
<polygon fill="black" stroke="black" points="753.46,-1877.78 764.02,-1876.91 755.22,-1871 753.46,-1877.78"/>
</g>
<!-- mlp_part_9 -->
<g id="node20" class="node">
<title>mlp_part_9</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-1692 18.5,-1692 18.5,-1624 485.5,-1624 485.5,-1692"/>
<text text-anchor="middle" x="252" y="-1676.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-1661.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 9</text>
<text text-anchor="middle" x="252" y="-1646.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1631.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_9&#45;&gt;all_reduce_mlp -->
<g id="edge20" class="edge">
<title>mlp_part_9&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M485.66,-1640.54C539.86,-1636.47 598.89,-1632.04 657.36,-1627.65"/>
<polygon fill="black" stroke="black" points="657.79,-1631.13 667.5,-1626.89 657.27,-1624.15 657.79,-1631.13"/>
</g>
<!-- mha_part_10 -->
<g id="node21" class="node">
<title>mha_part_10</title>
<polygon fill="lightcoral" stroke="black" points="488,-2381 16,-2381 16,-2313 488,-2313 488,-2381"/>
<text text-anchor="middle" x="252" y="-2365.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-2350.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 2</text>
<text text-anchor="middle" x="252" y="-2335.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2320.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_10&#45;&gt;group_concat_2 -->
<g id="edge21" class="edge">
<title>mha_part_10&#45;&gt;group_concat_2</title>
<path fill="none" stroke="black" d="M471.54,-2312.96C479.88,-2310.2 488.06,-2307.22 496,-2304 667.93,-2234.27 840.98,-2102.77 940.55,-2019.75"/>
<polygon fill="black" stroke="black" points="943.05,-2022.21 948.47,-2013.11 938.56,-2016.85 943.05,-2022.21"/>
</g>
<!-- mlp_part_10 -->
<g id="node22" class="node">
<title>mlp_part_10</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-2295 18.5,-2295 18.5,-2227 485.5,-2227 485.5,-2295"/>
<text text-anchor="middle" x="252" y="-2279.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-2264.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 10</text>
<text text-anchor="middle" x="252" y="-2249.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2234.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_10&#45;&gt;all_reduce_mlp -->
<g id="edge22" class="edge">
<title>mlp_part_10&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M483.61,-2226.98C487.98,-2223.3 492.13,-2219.31 496,-2215 547.71,-2157.46 481.58,-1932.69 524,-1868 584.27,-1776.08 686.97,-1713.44 783.83,-1671.98"/>
<polygon fill="black" stroke="black" points="785.32,-1675.15 793.18,-1668.04 782.6,-1668.7 785.32,-1675.15"/>
</g>
<!-- mha_part_11 -->
<g id="node23" class="node">
<title>mha_part_11</title>
<polygon fill="lightcoral" stroke="black" points="488,-2180 16,-2180 16,-2112 488,-2112 488,-2180"/>
<text text-anchor="middle" x="252" y="-2164.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-2149.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Seg 3</text>
<text text-anchor="middle" x="252" y="-2134.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2119.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_11&#45;&gt;group_concat_2 -->
<g id="edge23" class="edge">
<title>mha_part_11&#45;&gt;group_concat_2</title>
<path fill="none" stroke="black" d="M455.57,-2111.97C469.29,-2109.1 482.87,-2106.11 496,-2103 599.62,-2078.47 712.93,-2045.52 808.08,-2016.07"/>
<polygon fill="black" stroke="black" points="809.3,-2019.35 817.82,-2013.05 807.23,-2012.67 809.3,-2019.35"/>
</g>
<!-- mlp_part_11 -->
<g id="node24" class="node">
<title>mlp_part_11</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-2094 18.5,-2094 18.5,-2026 485.5,-2026 485.5,-2094"/>
<text text-anchor="middle" x="252" y="-2078.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-2063.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 11</text>
<text text-anchor="middle" x="252" y="-2048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-2033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_11&#45;&gt;all_reduce_mlp -->
<g id="edge24" class="edge">
<title>mlp_part_11&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M482.24,-2025.97C487.07,-2022.3 491.67,-2018.32 496,-2014 542.78,-1967.34 484.81,-1921.2 524,-1868 590.89,-1777.19 697.95,-1714.07 796.04,-1672.01"/>
<polygon fill="black" stroke="black" points="797.66,-1675.12 805.51,-1668 794.93,-1668.68 797.66,-1675.12"/>
</g>
<!-- mha_part_12 -->
<g id="node25" class="node">
<title>mha_part_12</title>
<polygon fill="lightcoral" stroke="black" points="488,-1089 16,-1089 16,-1021 488,-1021 488,-1089"/>
<text text-anchor="middle" x="252" y="-1073.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-1058.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 0</text>
<text text-anchor="middle" x="252" y="-1043.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1028.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- group_concat_3 -->
<g id="node36" class="node">
<title>group_concat_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1525.68,-1324 732.11,-1324 527.97,-1188 1321.54,-1188 1525.68,-1324"/>
<text text-anchor="middle" x="1026.83" y="-1274.8" font-family="Times,serif" font-size="14.00">Concatenate Group 3</text>
<text text-anchor="middle" x="1026.83" y="-1259.8" font-family="Times,serif" font-size="14.00">4 devices → 1</text>
<text text-anchor="middle" x="1026.83" y="-1244.8" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
<text text-anchor="middle" x="1026.83" y="-1229.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
</g>
<!-- mha_part_12&#45;&gt;group_concat_3 -->
<g id="edge25" class="edge">
<title>mha_part_12&#45;&gt;group_concat_3</title>
<path fill="none" stroke="black" d="M455.57,-1089.03C469.29,-1091.9 482.87,-1094.89 496,-1098 599.62,-1122.53 712.93,-1155.48 808.08,-1184.93"/>
<polygon fill="black" stroke="black" points="807.23,-1188.33 817.82,-1187.95 809.3,-1181.65 807.23,-1188.33"/>
</g>
<!-- mlp_part_12 -->
<g id="node26" class="node">
<title>mlp_part_12</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-1175 18.5,-1175 18.5,-1107 485.5,-1107 485.5,-1175"/>
<text text-anchor="middle" x="252" y="-1159.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-1144.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 12</text>
<text text-anchor="middle" x="252" y="-1129.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1114.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_12&#45;&gt;all_reduce_mlp -->
<g id="edge26" class="edge">
<title>mlp_part_12&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M448.14,-1175.02C465.92,-1184.14 482.34,-1195.6 496,-1210 534.58,-1250.68 489.94,-1288.46 524,-1333 592.74,-1422.9 700.6,-1485.83 798.73,-1527.92"/>
<polygon fill="black" stroke="black" points="797.62,-1531.25 808.19,-1531.93 800.35,-1524.81 797.62,-1531.25"/>
</g>
<!-- mha_part_13 -->
<g id="node27" class="node">
<title>mha_part_13</title>
<polygon fill="lightcoral" stroke="black" points="488,-888 16,-888 16,-820 488,-820 488,-888"/>
<text text-anchor="middle" x="252" y="-872.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-857.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 1</text>
<text text-anchor="middle" x="252" y="-842.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-827.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_13&#45;&gt;group_concat_3 -->
<g id="edge27" class="edge">
<title>mha_part_13&#45;&gt;group_concat_3</title>
<path fill="none" stroke="black" d="M471.54,-888.04C479.88,-890.8 488.06,-893.78 496,-897 667.93,-966.73 840.98,-1098.23 940.55,-1181.25"/>
<polygon fill="black" stroke="black" points="938.56,-1184.15 948.47,-1187.89 943.05,-1178.79 938.56,-1184.15"/>
</g>
<!-- mlp_part_13 -->
<g id="node28" class="node">
<title>mlp_part_13</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-974 18.5,-974 18.5,-906 485.5,-906 485.5,-974"/>
<text text-anchor="middle" x="252" y="-958.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-943.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 13</text>
<text text-anchor="middle" x="252" y="-928.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-913.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_13&#45;&gt;all_reduce_mlp -->
<g id="edge28" class="edge">
<title>mlp_part_13&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M453.66,-974.1C469.68,-983.26 484.2,-994.71 496,-1009 542.01,-1064.73 484.15,-1272.71 524,-1333 584.42,-1424.42 686.85,-1486.77 783.46,-1528.06"/>
<polygon fill="black" stroke="black" points="782.22,-1531.34 792.79,-1531.99 784.94,-1524.89 782.22,-1531.34"/>
</g>
<!-- mha_part_14 -->
<g id="node29" class="node">
<title>mha_part_14</title>
<polygon fill="lightcoral" stroke="black" points="488,-1491 16,-1491 16,-1423 488,-1423 488,-1491"/>
<text text-anchor="middle" x="252" y="-1475.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-1460.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 2</text>
<text text-anchor="middle" x="252" y="-1445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_14&#45;&gt;group_concat_3 -->
<g id="edge29" class="edge">
<title>mha_part_14&#45;&gt;group_concat_3</title>
<path fill="none" stroke="black" d="M442.75,-1422.94C460.8,-1419.14 478.78,-1415.14 496,-1411 597.02,-1386.72 707.48,-1355.21 801.28,-1326.95"/>
<polygon fill="black" stroke="black" points="802.33,-1330.29 810.89,-1324.05 800.3,-1323.59 802.33,-1330.29"/>
</g>
<!-- mlp_part_14 -->
<g id="node30" class="node">
<title>mlp_part_14</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-1577 18.5,-1577 18.5,-1509 485.5,-1509 485.5,-1577"/>
<text text-anchor="middle" x="252" y="-1561.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-1546.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 14</text>
<text text-anchor="middle" x="252" y="-1531.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1516.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_14&#45;&gt;all_reduce_mlp -->
<g id="edge30" class="edge">
<title>mlp_part_14&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M485.66,-1560.16C511.69,-1562.08 538.83,-1564.08 566.49,-1566.12"/>
<polygon fill="black" stroke="black" points="566.47,-1569.63 576.7,-1566.87 566.98,-1562.65 566.47,-1569.63"/>
</g>
<!-- mha_part_15 -->
<g id="node31" class="node">
<title>mha_part_15</title>
<polygon fill="lightcoral" stroke="black" points="488,-1290 16,-1290 16,-1222 488,-1222 488,-1290"/>
<text text-anchor="middle" x="252" y="-1274.8" font-family="Times,serif" font-size="14.00">MHA Partition</text>
<text text-anchor="middle" x="252" y="-1259.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Seg 3</text>
<text text-anchor="middle" x="252" y="-1244.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1229.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=4, d_v=128]</text>
</g>
<!-- mha_part_15&#45;&gt;group_concat_3 -->
<g id="edge31" class="edge">
<title>mha_part_15&#45;&gt;group_concat_3</title>
<path fill="none" stroke="black" d="M488.02,-1256C529.93,-1256 574.65,-1256 619.74,-1256"/>
<polygon fill="black" stroke="black" points="619.97,-1259.5 629.97,-1256 619.97,-1252.5 619.97,-1259.5"/>
</g>
<!-- mlp_part_15 -->
<g id="node32" class="node">
<title>mlp_part_15</title>
<polygon fill="lightgreen" stroke="black" points="485.5,-1376 18.5,-1376 18.5,-1308 485.5,-1308 485.5,-1376"/>
<text text-anchor="middle" x="252" y="-1360.8" font-family="Times,serif" font-size="14.00">MLP Partition</text>
<text text-anchor="middle" x="252" y="-1345.8" font-family="Times,serif" font-size="14.00">Tensor Parallel Slice 15</text>
<text text-anchor="middle" x="252" y="-1330.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="252" y="-1315.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- mlp_part_15&#45;&gt;all_reduce_mlp -->
<g id="edge32" class="edge">
<title>mlp_part_15&#45;&gt;all_reduce_mlp</title>
<path fill="none" stroke="black" d="M378.97,-1376.06C416.76,-1386.74 458.2,-1398.91 496,-1411 609.2,-1447.22 734.51,-1491.71 834.83,-1528.43"/>
<polygon fill="black" stroke="black" points="833.87,-1531.81 844.46,-1531.96 836.28,-1525.23 833.87,-1531.81"/>
</g>
<!-- final_concat_all -->
<g id="node37" class="node">
<title>final_concat_all</title>
<polygon fill="lightsteelblue" stroke="black" points="2563.19,-1668 1769.62,-1668 1565.47,-1532 2359.04,-1532 2563.19,-1668"/>
<text text-anchor="middle" x="2064.33" y="-1618.8" font-family="Times,serif" font-size="14.00">Final Concatenation</text>
<text text-anchor="middle" x="2064.33" y="-1603.8" font-family="Times,serif" font-size="14.00">4 groups → 1</text>
<text text-anchor="middle" x="2064.33" y="-1588.8" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=1024, seq_len=10000, heads=4, d_v=512]</text>
<text text-anchor="middle" x="2064.33" y="-1573.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
</g>
<!-- group_concat_0&#45;&gt;final_concat_all -->
<g id="edge33" class="edge">
<title>group_concat_0&#45;&gt;final_concat_all</title>
<path fill="none" stroke="black" d="M1089.5,-520.37C1271.43,-722.06 1804.98,-1313.59 1995.09,-1524.35"/>
<polygon fill="black" stroke="black" points="1992.68,-1526.9 2001.98,-1531.98 1997.88,-1522.21 1992.68,-1526.9"/>
</g>
<!-- group_concat_1&#45;&gt;final_concat_all -->
<g id="edge34" class="edge">
<title>group_concat_1&#45;&gt;final_concat_all</title>
<path fill="none" stroke="black" d="M1089.12,-2680.99C1270.65,-2479.56 1804.71,-1886.96 1995.01,-1675.8"/>
<polygon fill="black" stroke="black" points="1997.82,-1677.92 2001.91,-1668.15 1992.62,-1673.23 1997.82,-1677.92"/>
</g>
<!-- group_concat_2&#45;&gt;final_concat_all -->
<g id="edge35" class="edge">
<title>group_concat_2&#45;&gt;final_concat_all</title>
<path fill="none" stroke="black" d="M1232.1,-1876.94C1410.41,-1817.53 1668.29,-1731.62 1849.4,-1671.27"/>
<polygon fill="black" stroke="black" points="1850.67,-1674.54 1859.05,-1668.06 1848.45,-1667.9 1850.67,-1674.54"/>
</g>
<!-- group_concat_3&#45;&gt;final_concat_all -->
<g id="edge36" class="edge">
<title>group_concat_3&#45;&gt;final_concat_all</title>
<path fill="none" stroke="black" d="M1232.72,-1324.07C1410.8,-1383.23 1667.9,-1468.64 1848.78,-1528.72"/>
<polygon fill="black" stroke="black" points="1847.82,-1532.09 1858.41,-1531.93 1850.02,-1525.45 1847.82,-1532.09"/>
</g>
</g>
</svg>
