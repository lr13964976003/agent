<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: mlp_layer_0_tensor_parallel Pages: 1 -->
<svg width="1440pt" height="189pt"
 viewBox="0.00 0.00 1440.00 189.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.19 0.19) rotate(0) translate(4 1019)">
<title>mlp_layer_0_tensor_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1019 7774.5,-1019 7774.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="6413.45,-1015 5662.69,-1015 5469.55,-909 6220.31,-909 6413.45,-1015"/>
<text text-anchor="middle" x="5941.5" y="-973.3" font-family="Times,serif" font-size="14.00">MLP Input</text>
<text text-anchor="middle" x="5941.5" y="-958.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5941.5" y="-943.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln -->
<g id="node2" class="node">
<title>ln</title>
<polygon fill="lightyellow" stroke="black" points="4347,-873 3880,-873 3880,-805 4347,-805 4347,-873"/>
<text text-anchor="middle" x="4113.5" y="-857.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4113.5" y="-842.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4113.5" y="-827.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4113.5" y="-812.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;ln -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln</title>
<path fill="none" stroke="black" d="M5512.34,-932.59C5152.77,-908.79 4652.31,-875.67 4357.7,-856.16"/>
<polygon fill="black" stroke="black" points="4357.52,-852.64 4347.31,-855.48 4357.06,-859.63 4357.52,-852.64"/>
</g>
<!-- residual -->
<g id="node38" class="node">
<title>residual</title>
<polygon fill="lightgray" stroke="black" points="6175.5,-83 5707.5,-83 5707.5,0 6175.5,0 6175.5,-83"/>
<text text-anchor="middle" x="5941.5" y="-67.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5941.5" y="-52.8" font-family="Times,serif" font-size="14.00">Input 1: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5941.5" y="-37.8" font-family="Times,serif" font-size="14.00">Input 2: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5941.5" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5941.5" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;residual -->
<g id="edge68" class="edge">
<title>input&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M6282.22,-942.83C6773.42,-913.95 7634.69,-852.2 7751.5,-769 7767.69,-757.47 7770.5,-748.38 7770.5,-728.5 7770.5,-728.5 7770.5,-728.5 7770.5,-331.5 7770.5,-311.62 7767.52,-302.78 7751.5,-291 7507.67,-111.61 6621.24,-61.58 6185.99,-47.74"/>
<polygon fill="black" stroke="black" points="6185.9,-44.23 6175.8,-47.42 6185.68,-51.23 6185.9,-44.23"/>
</g>
<!-- fc1_device_0 -->
<g id="node3" class="node">
<title>fc1_device_0</title>
<polygon fill="lightcoral" stroke="black" points="467,-769 0,-769 0,-686 467,-686 467,-769"/>
<text text-anchor="middle" x="233.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="233.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="233.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="233.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="233.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln&#45;&gt;fc1_device_0 -->
<g id="edge2" class="edge">
<title>ln&#45;&gt;fc1_device_0</title>
<path fill="none" stroke="black" d="M3879.77,-838.06C3188.54,-837.51 1160.34,-830.63 477.39,-769.13"/>
<polygon fill="black" stroke="black" points="477.46,-765.62 467.18,-768.2 476.82,-772.59 477.46,-765.62"/>
</g>
<!-- fc1_device_1 -->
<g id="node4" class="node">
<title>fc1_device_1</title>
<polygon fill="lightcoral" stroke="black" points="952,-769 485,-769 485,-686 952,-686 952,-769"/>
<text text-anchor="middle" x="718.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="718.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="718.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="718.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="718.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln&#45;&gt;fc1_device_1 -->
<g id="edge3" class="edge">
<title>ln&#45;&gt;fc1_device_1</title>
<path fill="none" stroke="black" d="M3879.76,-837.25C3253.59,-834.54 1546.81,-822.43 962.4,-769.13"/>
<polygon fill="black" stroke="black" points="962.46,-765.62 952.18,-768.18 961.82,-772.59 962.46,-765.62"/>
</g>
<!-- fc1_device_2 -->
<g id="node5" class="node">
<title>fc1_device_2</title>
<polygon fill="lightcoral" stroke="black" points="1437,-769 970,-769 970,-686 1437,-686 1437,-769"/>
<text text-anchor="middle" x="1203.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="1203.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="1203.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1203.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="1203.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln&#45;&gt;fc1_device_2 -->
<g id="edge4" class="edge">
<title>ln&#45;&gt;fc1_device_2</title>
<path fill="none" stroke="black" d="M3879.79,-836.16C3323.97,-831.09 1934.01,-814.29 1447.46,-769.14"/>
<polygon fill="black" stroke="black" points="1447.47,-765.62 1437.19,-768.17 1446.81,-772.59 1447.47,-765.62"/>
</g>
<!-- fc1_device_3 -->
<g id="node6" class="node">
<title>fc1_device_3</title>
<polygon fill="lightcoral" stroke="black" points="1922,-769 1455,-769 1455,-686 1922,-686 1922,-769"/>
<text text-anchor="middle" x="1688.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="1688.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 3</text>
<text text-anchor="middle" x="1688.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="1688.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="1688.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln&#45;&gt;fc1_device_3 -->
<g id="edge5" class="edge">
<title>ln&#45;&gt;fc1_device_3</title>
<path fill="none" stroke="black" d="M3879.7,-834.58C3400.87,-826.93 2321.72,-806.21 1932.38,-769.14"/>
<polygon fill="black" stroke="black" points="1932.48,-765.63 1922.19,-768.15 1931.8,-772.6 1932.48,-765.63"/>
</g>
<!-- fc1_device_4 -->
<g id="node7" class="node">
<title>fc1_device_4</title>
<polygon fill="lightcoral" stroke="black" points="2407,-769 1940,-769 1940,-686 2407,-686 2407,-769"/>
<text text-anchor="middle" x="2173.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="2173.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 4</text>
<text text-anchor="middle" x="2173.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2173.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="2173.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln&#45;&gt;fc1_device_4 -->
<g id="edge6" class="edge">
<title>ln&#45;&gt;fc1_device_4</title>
<path fill="none" stroke="black" d="M3879.72,-837.74C3553.78,-835.29 2944.38,-823.13 2417.28,-769.15"/>
<polygon fill="black" stroke="black" points="2417.5,-765.65 2407.19,-768.11 2416.78,-772.62 2417.5,-765.65"/>
</g>
<!-- fc1_device_5 -->
<g id="node8" class="node">
<title>fc1_device_5</title>
<polygon fill="lightcoral" stroke="black" points="2892,-769 2425,-769 2425,-686 2892,-686 2892,-769"/>
<text text-anchor="middle" x="2658.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="2658.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 5</text>
<text text-anchor="middle" x="2658.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="2658.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="2658.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln&#45;&gt;fc1_device_5 -->
<g id="edge7" class="edge">
<title>ln&#45;&gt;fc1_device_5</title>
<path fill="none" stroke="black" d="M3879.76,-832.26C3637.36,-824.56 3247.34,-807.26 2902.14,-769.15"/>
<polygon fill="black" stroke="black" points="2902.52,-765.67 2892.2,-768.05 2901.75,-772.63 2902.52,-765.67"/>
</g>
<!-- fc1_device_6 -->
<g id="node9" class="node">
<title>fc1_device_6</title>
<polygon fill="lightcoral" stroke="black" points="3377,-769 2910,-769 2910,-686 3377,-686 3377,-769"/>
<text text-anchor="middle" x="3143.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="3143.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 6</text>
<text text-anchor="middle" x="3143.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3143.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="3143.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln&#45;&gt;fc1_device_6 -->
<g id="edge8" class="edge">
<title>ln&#45;&gt;fc1_device_6</title>
<path fill="none" stroke="black" d="M3879.83,-820.12C3739.61,-808.35 3557.52,-791.25 3387.37,-769.22"/>
<polygon fill="black" stroke="black" points="3387.58,-765.72 3377.22,-767.9 3386.68,-772.66 3387.58,-765.72"/>
</g>
<!-- fc1_device_7 -->
<g id="node10" class="node">
<title>fc1_device_7</title>
<polygon fill="lightcoral" stroke="black" points="3862,-769 3395,-769 3395,-686 3862,-686 3862,-769"/>
<text text-anchor="middle" x="3628.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="3628.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 7</text>
<text text-anchor="middle" x="3628.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="3628.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="3628.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln&#45;&gt;fc1_device_7 -->
<g id="edge9" class="edge">
<title>ln&#45;&gt;fc1_device_7</title>
<path fill="none" stroke="black" d="M3967.33,-805C3920.39,-794.4 3867.7,-782.51 3818.12,-771.31"/>
<polygon fill="black" stroke="black" points="3818.77,-767.87 3808.25,-769.08 3817.23,-774.7 3818.77,-767.87"/>
</g>
<!-- fc1_device_8 -->
<g id="node11" class="node">
<title>fc1_device_8</title>
<polygon fill="lightcoral" stroke="black" points="4347,-769 3880,-769 3880,-686 4347,-686 4347,-769"/>
<text text-anchor="middle" x="4113.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="4113.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 8</text>
<text text-anchor="middle" x="4113.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4113.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="4113.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln&#45;&gt;fc1_device_8 -->
<g id="edge10" class="edge">
<title>ln&#45;&gt;fc1_device_8</title>
<path fill="none" stroke="black" d="M4113.5,-804.85C4113.5,-796.8 4113.5,-788 4113.5,-779.34"/>
<polygon fill="black" stroke="black" points="4117,-779.28 4113.5,-769.28 4110,-779.28 4117,-779.28"/>
</g>
<!-- fc1_device_9 -->
<g id="node12" class="node">
<title>fc1_device_9</title>
<polygon fill="lightcoral" stroke="black" points="4832,-769 4365,-769 4365,-686 4832,-686 4832,-769"/>
<text text-anchor="middle" x="4598.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="4598.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 9</text>
<text text-anchor="middle" x="4598.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4598.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="4598.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln&#45;&gt;fc1_device_9 -->
<g id="edge11" class="edge">
<title>ln&#45;&gt;fc1_device_9</title>
<path fill="none" stroke="black" d="M4259.67,-805C4306.61,-794.4 4359.3,-782.51 4408.88,-771.31"/>
<polygon fill="black" stroke="black" points="4409.77,-774.7 4418.75,-769.08 4408.23,-767.87 4409.77,-774.7"/>
</g>
<!-- fc1_device_10 -->
<g id="node13" class="node">
<title>fc1_device_10</title>
<polygon fill="lightcoral" stroke="black" points="5317,-769 4850,-769 4850,-686 5317,-686 5317,-769"/>
<text text-anchor="middle" x="5083.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="5083.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 10</text>
<text text-anchor="middle" x="5083.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5083.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="5083.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln&#45;&gt;fc1_device_10 -->
<g id="edge12" class="edge">
<title>ln&#45;&gt;fc1_device_10</title>
<path fill="none" stroke="black" d="M4347.17,-820.12C4487.39,-808.35 4669.48,-791.25 4839.63,-769.22"/>
<polygon fill="black" stroke="black" points="4840.32,-772.66 4849.78,-767.9 4839.42,-765.72 4840.32,-772.66"/>
</g>
<!-- fc1_device_11 -->
<g id="node14" class="node">
<title>fc1_device_11</title>
<polygon fill="lightcoral" stroke="black" points="5802,-769 5335,-769 5335,-686 5802,-686 5802,-769"/>
<text text-anchor="middle" x="5568.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="5568.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 11</text>
<text text-anchor="middle" x="5568.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="5568.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="5568.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln&#45;&gt;fc1_device_11 -->
<g id="edge13" class="edge">
<title>ln&#45;&gt;fc1_device_11</title>
<path fill="none" stroke="black" d="M4347.24,-832.26C4589.64,-824.56 4979.66,-807.26 5324.86,-769.15"/>
<polygon fill="black" stroke="black" points="5325.25,-772.63 5334.8,-768.05 5324.48,-765.67 5325.25,-772.63"/>
</g>
<!-- fc1_device_12 -->
<g id="node15" class="node">
<title>fc1_device_12</title>
<polygon fill="lightcoral" stroke="black" points="6287,-769 5820,-769 5820,-686 6287,-686 6287,-769"/>
<text text-anchor="middle" x="6053.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="6053.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 12</text>
<text text-anchor="middle" x="6053.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6053.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="6053.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln&#45;&gt;fc1_device_12 -->
<g id="edge14" class="edge">
<title>ln&#45;&gt;fc1_device_12</title>
<path fill="none" stroke="black" d="M4347.28,-837.74C4673.22,-835.29 5282.62,-823.13 5809.72,-769.15"/>
<polygon fill="black" stroke="black" points="5810.22,-772.62 5819.81,-768.11 5809.5,-765.65 5810.22,-772.62"/>
</g>
<!-- fc1_device_13 -->
<g id="node16" class="node">
<title>fc1_device_13</title>
<polygon fill="lightcoral" stroke="black" points="6772,-769 6305,-769 6305,-686 6772,-686 6772,-769"/>
<text text-anchor="middle" x="6538.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="6538.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 13</text>
<text text-anchor="middle" x="6538.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="6538.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="6538.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln&#45;&gt;fc1_device_13 -->
<g id="edge15" class="edge">
<title>ln&#45;&gt;fc1_device_13</title>
<path fill="none" stroke="black" d="M4347.3,-834.58C4826.13,-826.93 5905.28,-806.21 6294.62,-769.14"/>
<polygon fill="black" stroke="black" points="6295.2,-772.6 6304.81,-768.15 6294.52,-765.63 6295.2,-772.6"/>
</g>
<!-- fc1_device_14 -->
<g id="node17" class="node">
<title>fc1_device_14</title>
<polygon fill="lightcoral" stroke="black" points="7257,-769 6790,-769 6790,-686 7257,-686 7257,-769"/>
<text text-anchor="middle" x="7023.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="7023.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 14</text>
<text text-anchor="middle" x="7023.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="7023.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="7023.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln&#45;&gt;fc1_device_14 -->
<g id="edge16" class="edge">
<title>ln&#45;&gt;fc1_device_14</title>
<path fill="none" stroke="black" d="M4347.21,-836.16C4903.03,-831.09 6292.99,-814.29 6779.54,-769.14"/>
<polygon fill="black" stroke="black" points="6780.19,-772.59 6789.81,-768.17 6779.53,-765.62 6780.19,-772.59"/>
</g>
<!-- fc1_device_15 -->
<g id="node18" class="node">
<title>fc1_device_15</title>
<polygon fill="lightcoral" stroke="black" points="7742,-769 7275,-769 7275,-686 7742,-686 7742,-769"/>
<text text-anchor="middle" x="7508.5" y="-753.8" font-family="Times,serif" font-size="14.00">FC1 Linear (Column Parallel)</text>
<text text-anchor="middle" x="7508.5" y="-738.8" font-family="Times,serif" font-size="14.00">Device 15</text>
<text text-anchor="middle" x="7508.5" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="7508.5" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="7508.5" y="-693.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln&#45;&gt;fc1_device_15 -->
<g id="edge17" class="edge">
<title>ln&#45;&gt;fc1_device_15</title>
<path fill="none" stroke="black" d="M4347.24,-837.25C4973.41,-834.54 6680.19,-822.43 7264.6,-769.13"/>
<polygon fill="black" stroke="black" points="7265.18,-772.59 7274.82,-768.18 7264.54,-765.62 7265.18,-772.59"/>
</g>
<!-- fc1_concat -->
<g id="node19" class="node">
<title>fc1_concat</title>
<polygon fill="lightsteelblue" stroke="black" points="4373.15,-650 3573.55,-650 3367.85,-514 4167.45,-514 4373.15,-650"/>
<text text-anchor="middle" x="3870.5" y="-600.8" font-family="Times,serif" font-size="14.00">Concatenate FC1 Outputs</text>
<text text-anchor="middle" x="3870.5" y="-585.8" font-family="Times,serif" font-size="14.00">Input: 16×[batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="3870.5" y="-570.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=32768]</text>
<text text-anchor="middle" x="3870.5" y="-555.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- fc1_device_0&#45;&gt;fc1_concat -->
<g id="edge18" class="edge">
<title>fc1_device_0&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M467.19,-686.85C469.97,-686.55 472.74,-686.27 475.5,-686 1044.71,-630 2700.69,-599.72 3469.57,-588.34"/>
<polygon fill="black" stroke="black" points="3469.76,-591.84 3479.7,-588.2 3469.65,-584.84 3469.76,-591.84"/>
</g>
<!-- fc1_device_1&#45;&gt;fc1_concat -->
<g id="edge19" class="edge">
<title>fc1_device_1&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M952.19,-686.87C954.97,-686.57 957.75,-686.28 960.5,-686 1435.46,-638.06 2793.44,-604.79 3473.05,-590.64"/>
<polygon fill="black" stroke="black" points="3473.32,-594.14 3483.25,-590.43 3473.18,-587.14 3473.32,-594.14"/>
</g>
<!-- fc1_device_2&#45;&gt;fc1_concat -->
<g id="edge20" class="edge">
<title>fc1_device_2&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1437.19,-686.9C1439.98,-686.59 1442.75,-686.29 1445.5,-686 2153.06,-612.05 2982.05,-590.84 3464.57,-584.97"/>
<polygon fill="black" stroke="black" points="3464.89,-588.47 3474.84,-584.85 3464.8,-581.47 3464.89,-588.47"/>
</g>
<!-- fc1_device_3&#45;&gt;fc1_concat -->
<g id="edge21" class="edge">
<title>fc1_device_3&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M1922.2,-686.94C1924.98,-686.62 1927.75,-686.3 1930.5,-686 2462.54,-627.54 3080.46,-601.98 3473.33,-590.99"/>
<polygon fill="black" stroke="black" points="3473.53,-594.49 3483.43,-590.71 3473.34,-587.49 3473.53,-594.49"/>
</g>
<!-- fc1_device_4&#45;&gt;fc1_concat -->
<g id="edge22" class="edge">
<title>fc1_device_4&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M2407.2,-687.01C2409.98,-686.66 2412.75,-686.33 2415.5,-686 2777.72,-642.97 3192.96,-615.75 3486.89,-600.18"/>
<polygon fill="black" stroke="black" points="3487.49,-603.65 3497.29,-599.63 3487.12,-596.66 3487.49,-603.65"/>
</g>
<!-- fc1_device_5&#45;&gt;fc1_concat -->
<g id="edge23" class="edge">
<title>fc1_device_5&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M2892.22,-687.15C2895,-686.76 2897.76,-686.37 2900.5,-686 3101.81,-658.49 3327.49,-634.14 3510.48,-616.04"/>
<polygon fill="black" stroke="black" points="3510.93,-619.51 3520.53,-615.04 3510.24,-612.54 3510.93,-619.51"/>
</g>
<!-- fc1_device_6&#45;&gt;fc1_concat -->
<g id="edge24" class="edge">
<title>fc1_device_6&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M3348.91,-685.95C3412.45,-673.41 3483.98,-659.29 3553.24,-645.62"/>
<polygon fill="black" stroke="black" points="3554.31,-648.98 3563.44,-643.61 3552.95,-642.11 3554.31,-648.98"/>
</g>
<!-- fc1_device_7&#45;&gt;fc1_concat -->
<g id="edge25" class="edge">
<title>fc1_device_7&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M3696.88,-685.95C3713.09,-676.34 3730.87,-665.79 3748.68,-655.24"/>
<polygon fill="black" stroke="black" points="3750.6,-658.17 3757.41,-650.06 3747.03,-652.15 3750.6,-658.17"/>
</g>
<!-- fc1_device_8&#45;&gt;fc1_concat -->
<g id="edge26" class="edge">
<title>fc1_device_8&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M4044.84,-685.95C4028.56,-676.34 4010.7,-665.79 3992.82,-655.24"/>
<polygon fill="black" stroke="black" points="3994.44,-652.13 3984.05,-650.06 3990.88,-658.16 3994.44,-652.13"/>
</g>
<!-- fc1_device_9&#45;&gt;fc1_concat -->
<g id="edge27" class="edge">
<title>fc1_device_9&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M4392.8,-685.95C4339.03,-675.36 4279.54,-663.63 4220.54,-652"/>
<polygon fill="black" stroke="black" points="4221.18,-648.56 4210.69,-650.06 4219.82,-655.42 4221.18,-648.56"/>
</g>
<!-- fc1_device_10&#45;&gt;fc1_concat -->
<g id="edge28" class="edge">
<title>fc1_device_10&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M4849.78,-687.14C4847,-686.76 4844.24,-686.37 4841.5,-686 4681.36,-664.13 4505.81,-644.26 4348.55,-627.94"/>
<polygon fill="black" stroke="black" points="4348.53,-624.42 4338.22,-626.87 4347.81,-631.38 4348.53,-624.42"/>
</g>
<!-- fc1_device_11&#45;&gt;fc1_concat -->
<g id="edge29" class="edge">
<title>fc1_device_11&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M5334.8,-687.01C5332.02,-686.66 5329.25,-686.33 5326.5,-686 4987.19,-645.7 4601.39,-619.28 4312.2,-603.29"/>
<polygon fill="black" stroke="black" points="4312.13,-599.79 4301.95,-602.73 4311.74,-606.77 4312.13,-599.79"/>
</g>
<!-- fc1_device_12&#45;&gt;fc1_concat -->
<g id="edge30" class="edge">
<title>fc1_device_12&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M5819.8,-686.94C5817.02,-686.62 5814.25,-686.3 5811.5,-686 5291.24,-628.85 4688.91,-603.14 4294.93,-591.75"/>
<polygon fill="black" stroke="black" points="4294.88,-588.25 4284.79,-591.46 4294.68,-595.25 4294.88,-588.25"/>
</g>
<!-- fc1_device_13&#45;&gt;fc1_concat -->
<g id="edge31" class="edge">
<title>fc1_device_13&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M6304.81,-686.9C6302.02,-686.59 6299.25,-686.29 6296.5,-686 5592.81,-612.46 4769.07,-591.08 4285.15,-585.07"/>
<polygon fill="black" stroke="black" points="4284.89,-581.57 4274.85,-584.94 4284.8,-588.56 4284.89,-581.57"/>
</g>
<!-- fc1_device_14&#45;&gt;fc1_concat -->
<g id="edge32" class="edge">
<title>fc1_device_14&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M6789.81,-686.87C6787.03,-686.57 6784.25,-686.28 6781.5,-686 6312.34,-638.65 4981.91,-605.62 4294.02,-591.18"/>
<polygon fill="black" stroke="black" points="4294.01,-587.68 4283.94,-590.97 4293.86,-594.68 4294.01,-587.68"/>
</g>
<!-- fc1_device_15&#45;&gt;fc1_concat -->
<g id="edge33" class="edge">
<title>fc1_device_15&#45;&gt;fc1_concat</title>
<path fill="none" stroke="black" d="M7274.81,-686.85C7272.03,-686.55 7269.26,-686.27 7266.5,-686 6701.78,-630.44 5067.68,-600.21 4290.59,-588.63"/>
<polygon fill="black" stroke="black" points="4290.41,-585.12 4280.35,-588.47 4290.3,-592.12 4290.41,-585.12"/>
</g>
<!-- gelu -->
<g id="node20" class="node">
<title>gelu</title>
<polygon fill="lightyellow" stroke="black" points="4108.5,-478 3632.5,-478 3632.5,-410 4108.5,-410 4108.5,-478"/>
<text text-anchor="middle" x="3870.5" y="-462.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="3870.5" y="-447.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=32768]</text>
<text text-anchor="middle" x="3870.5" y="-432.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_dim=32768]</text>
<text text-anchor="middle" x="3870.5" y="-417.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- fc1_concat&#45;&gt;gelu -->
<g id="edge34" class="edge">
<title>fc1_concat&#45;&gt;gelu</title>
<path fill="none" stroke="black" d="M3870.5,-513.8C3870.5,-505.04 3870.5,-496.28 3870.5,-488.07"/>
<polygon fill="black" stroke="black" points="3874,-488.02 3870.5,-478.02 3867,-488.02 3874,-488.02"/>
</g>
<!-- fc2_device_0 -->
<g id="node21" class="node">
<title>fc2_device_0</title>
<polygon fill="lightcoral" stroke="black" points="467,-374 0,-374 0,-291 467,-291 467,-374"/>
<text text-anchor="middle" x="233.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="233.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 0</text>
<text text-anchor="middle" x="233.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="233.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="233.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gelu&#45;&gt;fc2_device_0 -->
<g id="edge35" class="edge">
<title>gelu&#45;&gt;fc2_device_0</title>
<path fill="none" stroke="black" d="M3632.44,-442.67C2969.39,-441.03 1109.38,-431.39 477.32,-374.12"/>
<polygon fill="black" stroke="black" points="477.46,-370.62 467.18,-373.19 476.82,-377.59 477.46,-370.62"/>
</g>
<!-- fc2_device_1 -->
<g id="node22" class="node">
<title>fc2_device_1</title>
<polygon fill="lightcoral" stroke="black" points="952,-374 485,-374 485,-291 952,-291 952,-374"/>
<text text-anchor="middle" x="718.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="718.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 1</text>
<text text-anchor="middle" x="718.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="718.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="718.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gelu&#45;&gt;fc2_device_1 -->
<g id="edge36" class="edge">
<title>gelu&#45;&gt;fc2_device_1</title>
<path fill="none" stroke="black" d="M3632.26,-441.72C3037.22,-437.81 1496.12,-423.22 962.29,-374.12"/>
<polygon fill="black" stroke="black" points="962.47,-370.62 952.19,-373.18 961.82,-377.59 962.47,-370.62"/>
</g>
<!-- fc2_device_2 -->
<g id="node23" class="node">
<title>fc2_device_2</title>
<polygon fill="lightcoral" stroke="black" points="1437,-374 970,-374 970,-291 1437,-291 1437,-374"/>
<text text-anchor="middle" x="1203.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="1203.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 2</text>
<text text-anchor="middle" x="1203.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="1203.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1203.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gelu&#45;&gt;fc2_device_2 -->
<g id="edge37" class="edge">
<title>gelu&#45;&gt;fc2_device_2</title>
<path fill="none" stroke="black" d="M3632.34,-440.39C3111.54,-434.01 1883.81,-415.12 1447.35,-374.13"/>
<polygon fill="black" stroke="black" points="1447.47,-370.63 1437.19,-373.16 1446.81,-377.59 1447.47,-370.63"/>
</g>
<!-- fc2_device_3 -->
<g id="node24" class="node">
<title>fc2_device_3</title>
<polygon fill="lightcoral" stroke="black" points="1922,-374 1455,-374 1455,-291 1922,-291 1922,-374"/>
<text text-anchor="middle" x="1688.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="1688.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 3</text>
<text text-anchor="middle" x="1688.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="1688.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="1688.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gelu&#45;&gt;fc2_device_3 -->
<g id="edge38" class="edge">
<title>gelu&#45;&gt;fc2_device_3</title>
<path fill="none" stroke="black" d="M3632.49,-438.42C3193.81,-429.33 2272.24,-407.09 1932.32,-374.13"/>
<polygon fill="black" stroke="black" points="1932.49,-370.63 1922.19,-373.13 1931.8,-377.6 1932.49,-370.63"/>
</g>
<!-- fc2_device_4 -->
<g id="node25" class="node">
<title>fc2_device_4</title>
<polygon fill="lightcoral" stroke="black" points="2407,-374 1940,-374 1940,-291 2407,-291 2407,-374"/>
<text text-anchor="middle" x="2173.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="2173.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 4</text>
<text text-anchor="middle" x="2173.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="2173.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="2173.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gelu&#45;&gt;fc2_device_4 -->
<g id="edge39" class="edge">
<title>gelu&#45;&gt;fc2_device_4</title>
<path fill="none" stroke="black" d="M3632.3,-440.35C3345.85,-435.18 2850.47,-419.95 2417.41,-374.17"/>
<polygon fill="black" stroke="black" points="2417.51,-370.66 2407.19,-373.08 2416.77,-377.62 2417.51,-370.66"/>
</g>
<!-- fc2_device_5 -->
<g id="node26" class="node">
<title>fc2_device_5</title>
<polygon fill="lightcoral" stroke="black" points="2892,-374 2425,-374 2425,-291 2892,-291 2892,-374"/>
<text text-anchor="middle" x="2658.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="2658.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 5</text>
<text text-anchor="middle" x="2658.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="2658.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="2658.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gelu&#45;&gt;fc2_device_5 -->
<g id="edge40" class="edge">
<title>gelu&#45;&gt;fc2_device_5</title>
<path fill="none" stroke="black" d="M3632.22,-432.36C3438.09,-422.2 3156.78,-404.08 2902.39,-374.19"/>
<polygon fill="black" stroke="black" points="2902.55,-370.69 2892.2,-372.99 2901.72,-377.64 2902.55,-370.69"/>
</g>
<!-- fc2_device_6 -->
<g id="node27" class="node">
<title>fc2_device_6</title>
<polygon fill="lightcoral" stroke="black" points="3377,-374 2910,-374 2910,-291 3377,-291 3377,-374"/>
<text text-anchor="middle" x="3143.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="3143.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 6</text>
<text text-anchor="middle" x="3143.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="3143.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="3143.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gelu&#45;&gt;fc2_device_6 -->
<g id="edge41" class="edge">
<title>gelu&#45;&gt;fc2_device_6</title>
<path fill="none" stroke="black" d="M3632.28,-410.29C3556.64,-399.6 3472.45,-387.39 3387.35,-374.28"/>
<polygon fill="black" stroke="black" points="3387.66,-370.78 3377.24,-372.72 3386.59,-377.7 3387.66,-370.78"/>
</g>
<!-- fc2_device_7 -->
<g id="node28" class="node">
<title>fc2_device_7</title>
<polygon fill="lightcoral" stroke="black" points="3862,-374 3395,-374 3395,-291 3862,-291 3862,-374"/>
<text text-anchor="middle" x="3628.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="3628.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 7</text>
<text text-anchor="middle" x="3628.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="3628.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="3628.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gelu&#45;&gt;fc2_device_7 -->
<g id="edge42" class="edge">
<title>gelu&#45;&gt;fc2_device_7</title>
<path fill="none" stroke="black" d="M3797.56,-410C3775.57,-400.05 3751.05,-388.95 3727.66,-378.37"/>
<polygon fill="black" stroke="black" points="3728.96,-375.11 3718.41,-374.18 3726.07,-381.49 3728.96,-375.11"/>
</g>
<!-- fc2_device_8 -->
<g id="node29" class="node">
<title>fc2_device_8</title>
<polygon fill="lightcoral" stroke="black" points="4347,-374 3880,-374 3880,-291 4347,-291 4347,-374"/>
<text text-anchor="middle" x="4113.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="4113.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 8</text>
<text text-anchor="middle" x="4113.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="4113.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="4113.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gelu&#45;&gt;fc2_device_8 -->
<g id="edge43" class="edge">
<title>gelu&#45;&gt;fc2_device_8</title>
<path fill="none" stroke="black" d="M3943.74,-410C3965.82,-400.05 3990.44,-388.95 4013.93,-378.37"/>
<polygon fill="black" stroke="black" points="4015.54,-381.48 4023.22,-374.18 4012.67,-375.1 4015.54,-381.48"/>
</g>
<!-- fc2_device_9 -->
<g id="node30" class="node">
<title>fc2_device_9</title>
<polygon fill="lightcoral" stroke="black" points="4832,-374 4365,-374 4365,-291 4832,-291 4832,-374"/>
<text text-anchor="middle" x="4598.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="4598.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 9</text>
<text text-anchor="middle" x="4598.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="4598.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="4598.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gelu&#45;&gt;fc2_device_9 -->
<g id="edge44" class="edge">
<title>gelu&#45;&gt;fc2_device_9</title>
<path fill="none" stroke="black" d="M4108.6,-410.4C4184.62,-399.68 4269.32,-387.42 4354.86,-374.24"/>
<polygon fill="black" stroke="black" points="4355.41,-377.7 4364.76,-372.72 4354.34,-370.78 4355.41,-377.7"/>
</g>
<!-- fc2_device_10 -->
<g id="node31" class="node">
<title>fc2_device_10</title>
<polygon fill="lightcoral" stroke="black" points="5317,-374 4850,-374 4850,-291 5317,-291 5317,-374"/>
<text text-anchor="middle" x="5083.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="5083.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 10</text>
<text text-anchor="middle" x="5083.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="5083.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="5083.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gelu&#45;&gt;fc2_device_10 -->
<g id="edge45" class="edge">
<title>gelu&#45;&gt;fc2_device_10</title>
<path fill="none" stroke="black" d="M4108.53,-432.4C4302.87,-422.25 4584.74,-404.13 4839.6,-374.2"/>
<polygon fill="black" stroke="black" points="4840.28,-377.64 4849.8,-372.99 4839.45,-370.69 4840.28,-377.64"/>
</g>
<!-- fc2_device_11 -->
<g id="node32" class="node">
<title>fc2_device_11</title>
<polygon fill="lightcoral" stroke="black" points="5802,-374 5335,-374 5335,-291 5802,-291 5802,-374"/>
<text text-anchor="middle" x="5568.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="5568.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 11</text>
<text text-anchor="middle" x="5568.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="5568.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="5568.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gelu&#45;&gt;fc2_device_11 -->
<g id="edge46" class="edge">
<title>gelu&#45;&gt;fc2_device_11</title>
<path fill="none" stroke="black" d="M4108.54,-440.36C4395.14,-435.21 4891.07,-419.99 5324.58,-374.17"/>
<polygon fill="black" stroke="black" points="5325.23,-377.62 5334.81,-373.08 5324.49,-370.66 5325.23,-377.62"/>
</g>
<!-- fc2_device_12 -->
<g id="node33" class="node">
<title>fc2_device_12</title>
<polygon fill="lightcoral" stroke="black" points="6287,-374 5820,-374 5820,-291 6287,-291 6287,-374"/>
<text text-anchor="middle" x="6053.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="6053.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 12</text>
<text text-anchor="middle" x="6053.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="6053.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="6053.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gelu&#45;&gt;fc2_device_12 -->
<g id="edge47" class="edge">
<title>gelu&#45;&gt;fc2_device_12</title>
<path fill="none" stroke="black" d="M4108.63,-438.42C4547.54,-429.33 5469.59,-407.1 5809.67,-374.13"/>
<polygon fill="black" stroke="black" points="5810.2,-377.6 5819.81,-373.13 5809.51,-370.63 5810.2,-377.6"/>
</g>
<!-- fc2_device_13 -->
<g id="node34" class="node">
<title>fc2_device_13</title>
<polygon fill="lightcoral" stroke="black" points="6772,-374 6305,-374 6305,-291 6772,-291 6772,-374"/>
<text text-anchor="middle" x="6538.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="6538.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 13</text>
<text text-anchor="middle" x="6538.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="6538.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="6538.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gelu&#45;&gt;fc2_device_13 -->
<g id="edge48" class="edge">
<title>gelu&#45;&gt;fc2_device_13</title>
<path fill="none" stroke="black" d="M4108.76,-440.39C4629.77,-434.02 5858.01,-415.13 6294.65,-374.13"/>
<polygon fill="black" stroke="black" points="6295.19,-377.59 6304.81,-373.16 6294.53,-370.63 6295.19,-377.59"/>
</g>
<!-- fc2_device_14 -->
<g id="node35" class="node">
<title>fc2_device_14</title>
<polygon fill="lightcoral" stroke="black" points="7257,-374 6790,-374 6790,-291 7257,-291 7257,-374"/>
<text text-anchor="middle" x="7023.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="7023.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 14</text>
<text text-anchor="middle" x="7023.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="7023.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="7023.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gelu&#45;&gt;fc2_device_14 -->
<g id="edge49" class="edge">
<title>gelu&#45;&gt;fc2_device_14</title>
<path fill="none" stroke="black" d="M4108.55,-441.72C4703.59,-437.82 6245.61,-423.24 6779.7,-374.12"/>
<polygon fill="black" stroke="black" points="6780.18,-377.59 6789.81,-373.18 6779.53,-370.62 6780.18,-377.59"/>
</g>
<!-- fc2_device_15 -->
<g id="node36" class="node">
<title>fc2_device_15</title>
<polygon fill="lightcoral" stroke="black" points="7742,-374 7275,-374 7275,-291 7742,-291 7742,-374"/>
<text text-anchor="middle" x="7508.5" y="-358.8" font-family="Times,serif" font-size="14.00">FC2 Linear (Row Parallel)</text>
<text text-anchor="middle" x="7508.5" y="-343.8" font-family="Times,serif" font-size="14.00">Device 15</text>
<text text-anchor="middle" x="7508.5" y="-328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_dim=2048]</text>
<text text-anchor="middle" x="7508.5" y="-313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="7508.5" y="-298.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gelu&#45;&gt;fc2_device_15 -->
<g id="edge50" class="edge">
<title>gelu&#45;&gt;fc2_device_15</title>
<path fill="none" stroke="black" d="M4108.63,-442.67C4771.88,-441.04 6632.43,-431.41 7264.68,-374.12"/>
<polygon fill="black" stroke="black" points="7265.18,-377.59 7274.82,-373.19 7264.54,-370.62 7265.18,-377.59"/>
</g>
<!-- fc2_allreduce -->
<g id="node37" class="node">
<title>fc2_allreduce</title>
<polygon fill="lightsteelblue" stroke="black" points="4616.15,-255 3816.55,-255 3610.85,-119 4410.45,-119 4616.15,-255"/>
<text text-anchor="middle" x="4113.5" y="-205.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="4113.5" y="-190.8" font-family="Times,serif" font-size="14.00">Input: 16×[batch_size=1024, seq_len=10000, embed_dim=2048]</text>
<text text-anchor="middle" x="4113.5" y="-175.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, embed_dim=8192]</text>
<text text-anchor="middle" x="4113.5" y="-160.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- fc2_device_0&#45;&gt;fc2_allreduce -->
<g id="edge51" class="edge">
<title>fc2_device_0&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M467.19,-291.84C469.97,-291.55 472.74,-291.27 475.5,-291 1092.37,-230.94 2900.28,-202.44 3711.48,-192.4"/>
<polygon fill="black" stroke="black" points="3711.61,-195.9 3721.57,-192.28 3711.53,-188.9 3711.61,-195.9"/>
</g>
<!-- fc2_device_1&#45;&gt;fc2_allreduce -->
<g id="edge52" class="edge">
<title>fc2_device_1&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M952.19,-291.86C954.97,-291.56 957.74,-291.27 960.5,-291 1482.62,-239.02 2989.47,-207.15 3714.49,-194.4"/>
<polygon fill="black" stroke="black" points="3714.64,-197.9 3724.58,-194.23 3714.52,-190.9 3714.64,-197.9"/>
</g>
<!-- fc2_device_2&#45;&gt;fc2_allreduce -->
<g id="edge53" class="edge">
<title>fc2_device_2&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1437.19,-291.88C1439.97,-291.58 1442.75,-291.28 1445.5,-291 2242.61,-209.25 3179.74,-190.94 3704.33,-187.67"/>
<polygon fill="black" stroke="black" points="3704.36,-191.17 3714.33,-187.61 3704.31,-184.17 3704.36,-191.17"/>
</g>
<!-- fc2_device_3&#45;&gt;fc2_allreduce -->
<g id="edge54" class="edge">
<title>fc2_device_3&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M1922.19,-291.92C1924.98,-291.6 1927.75,-291.29 1930.5,-291 2549.76,-224.81 3272.38,-201.15 3711.22,-192.7"/>
<polygon fill="black" stroke="black" points="3711.6,-196.19 3721.53,-192.5 3711.47,-189.2 3711.6,-196.19"/>
</g>
<!-- fc2_device_4&#45;&gt;fc2_allreduce -->
<g id="edge55" class="edge">
<title>fc2_device_4&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M2407.2,-291.97C2409.98,-291.64 2412.75,-291.31 2415.5,-291 2862.08,-240.23 3377.78,-213.42 3722.59,-200.03"/>
<polygon fill="black" stroke="black" points="3722.89,-203.52 3732.74,-199.64 3722.62,-196.53 3722.89,-203.52"/>
</g>
<!-- fc2_device_5&#45;&gt;fc2_allreduce -->
<g id="edge56" class="edge">
<title>fc2_device_5&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M2892.21,-292.06C2894.99,-291.7 2897.75,-291.35 2900.5,-291 3181,-255.68 3499.55,-229.15 3739.8,-211.86"/>
<polygon fill="black" stroke="black" points="3740.38,-215.33 3750.1,-211.13 3739.88,-208.35 3740.38,-215.33"/>
</g>
<!-- fc2_device_6&#45;&gt;fc2_allreduce -->
<g id="edge57" class="edge">
<title>fc2_device_6&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M3377.24,-292.28C3380.01,-291.85 3382.76,-291.42 3385.5,-291 3511.73,-271.51 3650.5,-251.52 3772.73,-234.4"/>
<polygon fill="black" stroke="black" points="3773.58,-237.81 3783,-232.96 3772.61,-230.88 3773.58,-237.81"/>
</g>
<!-- fc2_device_7&#45;&gt;fc2_allreduce -->
<g id="edge58" class="edge">
<title>fc2_device_7&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M3765.54,-290.95C3800.4,-280.64 3838.87,-269.26 3877.14,-257.93"/>
<polygon fill="black" stroke="black" points="3878.27,-261.25 3886.86,-255.06 3876.28,-254.54 3878.27,-261.25"/>
</g>
<!-- fc2_device_8&#45;&gt;fc2_allreduce -->
<g id="edge59" class="edge">
<title>fc2_device_8&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M4113.5,-290.76C4113.5,-282.78 4113.5,-274.17 4113.5,-265.44"/>
<polygon fill="black" stroke="black" points="4117,-265.17 4113.5,-255.17 4110,-265.17 4117,-265.17"/>
</g>
<!-- fc2_device_9&#45;&gt;fc2_allreduce -->
<g id="edge60" class="edge">
<title>fc2_device_9&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M4461.46,-290.95C4426.6,-280.64 4388.13,-269.26 4349.86,-257.93"/>
<polygon fill="black" stroke="black" points="4350.72,-254.54 4340.14,-255.06 4348.73,-261.25 4350.72,-254.54"/>
</g>
<!-- fc2_device_10&#45;&gt;fc2_allreduce -->
<g id="edge61" class="edge">
<title>fc2_device_10&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M4849.76,-292.28C4846.99,-291.85 4844.24,-291.42 4841.5,-291 4766.64,-279.44 4687.38,-267.71 4609.77,-256.5"/>
<polygon fill="black" stroke="black" points="4610.22,-253.03 4599.82,-255.07 4609.22,-259.96 4610.22,-253.03"/>
</g>
<!-- fc2_device_11&#45;&gt;fc2_allreduce -->
<g id="edge62" class="edge">
<title>fc2_device_11&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M5334.79,-292.06C5332.01,-291.7 5329.25,-291.35 5326.5,-291 5076.88,-259.57 4797.12,-235.09 4569.22,-217.91"/>
<polygon fill="black" stroke="black" points="4569.33,-214.41 4559.09,-217.15 4568.8,-221.39 4569.33,-214.41"/>
</g>
<!-- fc2_device_12&#45;&gt;fc2_allreduce -->
<g id="edge63" class="edge">
<title>fc2_device_12&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M5819.8,-291.97C5817.02,-291.64 5814.25,-291.31 5811.5,-291 5382.17,-242.19 4888.96,-215.53 4545.12,-201.64"/>
<polygon fill="black" stroke="black" points="4545.13,-198.14 4534.99,-201.24 4544.85,-205.13 4545.13,-198.14"/>
</g>
<!-- fc2_device_13&#45;&gt;fc2_allreduce -->
<g id="edge64" class="edge">
<title>fc2_device_13&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M6304.81,-291.92C6302.02,-291.6 6299.25,-291.29 6296.5,-291 5684.92,-225.63 4972.54,-201.75 4532.25,-193.02"/>
<polygon fill="black" stroke="black" points="4532.29,-189.52 4522.23,-192.83 4532.16,-196.52 4532.29,-189.52"/>
</g>
<!-- fc2_device_14&#45;&gt;fc2_allreduce -->
<g id="edge65" class="edge">
<title>fc2_device_14&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M6789.81,-291.88C6787.03,-291.58 6784.25,-291.28 6781.5,-291 5985.25,-209.34 5049.28,-190.98 4524.37,-187.68"/>
<polygon fill="black" stroke="black" points="4524.38,-184.18 4514.36,-187.62 4524.34,-191.18 4524.38,-184.18"/>
</g>
<!-- fc2_device_15&#45;&gt;fc2_allreduce -->
<g id="edge66" class="edge">
<title>fc2_device_15&#45;&gt;fc2_allreduce</title>
<path fill="none" stroke="black" d="M7274.81,-291.86C7272.03,-291.56 7269.26,-291.27 7266.5,-291 6749.8,-239.56 5268.73,-207.81 4535.36,-194.81"/>
<polygon fill="black" stroke="black" points="4535.21,-191.31 4525.15,-194.63 4535.09,-198.3 4535.21,-191.31"/>
</g>
<!-- fc2_allreduce&#45;&gt;residual -->
<g id="edge67" class="edge">
<title>fc2_allreduce&#45;&gt;residual</title>
<path fill="none" stroke="black" d="M4469.75,-158.03C4831.5,-129.64 5381.95,-86.43 5697.1,-61.69"/>
<polygon fill="black" stroke="black" points="5697.59,-65.16 5707.28,-60.89 5697.04,-58.18 5697.59,-65.16"/>
</g>
</g>
</svg>
