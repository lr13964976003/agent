<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: NewStrategy Pages: 1 -->
<svg width="3913pt" height="1103pt"
 viewBox="0.00 0.00 3912.91 1103.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1099.16)">
<title>NewStrategy</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1099.16 3908.91,-1099.16 3908.91,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline</title>
<polygon fill="lightyellow" stroke="black" points="8,-205.98 8,-889.17 3882,-889.17 3882,-205.98 8,-205.98"/>
<text text-anchor="middle" x="1945" y="-875.57" font-family="Arial" font-size="12.00">Pipeline Parallelism (PP2)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage0</title>
<polygon fill="lightcoral" stroke="black" points="1949,-213.98 1949,-860.17 3874,-860.17 3874,-213.98 1949,-213.98"/>
<text text-anchor="middle" x="2911.5" y="-846.57" font-family="Arial" font-size="12.00">Stage 0: Layers 0&#45;7 (GPU 0&#45;1023)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_tp_stage0</title>
<polygon fill="lightpink" stroke="black" points="1957,-221.98 1957,-831.17 3866,-831.17 3866,-221.98 1957,-221.98"/>
<text text-anchor="middle" x="2911.5" y="-817.57" font-family="Arial" font-size="12.00">TP8 within Stage 0</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_ep_layer0</title>
<polygon fill="lightcyan" stroke="black" points="3085,-229.98 3085,-318.98 3799,-318.98 3799,-229.98 3085,-229.98"/>
<text text-anchor="middle" x="3442" y="-305.38" font-family="Arial" font-size="12.00">EP64: 1 expert per GPU</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage1</title>
<polygon fill="lightcoral" stroke="black" points="16,-213.98 16,-860.17 1941,-860.17 1941,-213.98 16,-213.98"/>
<text text-anchor="middle" x="978.5" y="-846.57" font-family="Arial" font-size="12.00">Stage 1: Layers 8&#45;15 (GPU 1024&#45;2047)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_tp_stage1</title>
<polygon fill="lightpink" stroke="black" points="24,-221.98 24,-831.17 1933,-831.17 1933,-221.98 24,-221.98"/>
<text text-anchor="middle" x="978.5" y="-817.57" font-family="Arial" font-size="12.00">TP8 within Stage 1</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_ep_layer8</title>
<polygon fill="lightcyan" stroke="black" points="621,-229.98 621,-318.98 1335,-318.98 1335,-229.98 621,-229.98"/>
<text text-anchor="middle" x="978" y="-305.38" font-family="Arial" font-size="12.00">EP64: 1 expert per GPU</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="lightblue" stroke="black" cx="2911" cy="-1066.17" rx="188.18" ry="28.98"/>
<text text-anchor="middle" x="2911" y="-1074.67" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="2911" y="-1063.67" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=128&#45;10240, dim=1024]</text>
<text text-anchor="middle" x="2911" y="-1052.67" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=128&#45;10240, dim=1024]</text>
</g>
<!-- DP_Split -->
<g id="node2" class="node">
<title>DP_Split</title>
<polygon fill="lightgreen" stroke="black" points="3140.24,-1001.17 2775.57,-1001.17 2681.76,-897.17 3046.43,-897.17 3140.24,-1001.17"/>
<text text-anchor="middle" x="2911" y="-963.17" font-family="Arial" font-size="10.00">DP Split</text>
<text text-anchor="middle" x="2911" y="-952.17" font-family="Arial" font-size="10.00">2&#45;way Data Parallel</text>
<text text-anchor="middle" x="2911" y="-941.17" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2911" y="-930.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Input&#45;&gt;DP_Split -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;DP_Split</title>
<path fill="none" stroke="black" d="M2911,-1037.03C2911,-1029.21 2911,-1020.39 2911,-1011.45"/>
<polygon fill="black" stroke="black" points="2914.5,-1011.35 2911,-1001.35 2907.5,-1011.35 2914.5,-1011.35"/>
</g>
<!-- Layer0_TP0 -->
<g id="node3" class="node">
<title>Layer0_TP0</title>
<polygon fill="white" stroke="black" points="3858.5,-802.17 3637.5,-802.17 3637.5,-739.17 3858.5,-739.17 3858.5,-802.17"/>
<text text-anchor="middle" x="3748" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP0</text>
<text text-anchor="middle" x="3748" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3748" y="-768.17" font-family="Arial" font-size="10.00">GPU: 0&#45;127</text>
<text text-anchor="middle" x="3748" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3748" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP0 -->
<g id="edge2" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP0</title>
<path fill="none" stroke="black" d="M3091.83,-947.28C3272.65,-943.91 3536.72,-931.55 3629,-889.17 3666.54,-871.93 3699.11,-837.56 3720.64,-810.43"/>
<polygon fill="black" stroke="black" points="3723.6,-812.31 3726.96,-802.26 3718.07,-808.03 3723.6,-812.31"/>
</g>
<!-- Layer0_TP1 -->
<g id="node4" class="node">
<title>Layer0_TP1</title>
<polygon fill="white" stroke="black" points="3619.5,-802.17 3398.5,-802.17 3398.5,-739.17 3619.5,-739.17 3619.5,-802.17"/>
<text text-anchor="middle" x="3509" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP1</text>
<text text-anchor="middle" x="3509" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3509" y="-768.17" font-family="Arial" font-size="10.00">GPU: 128&#45;255</text>
<text text-anchor="middle" x="3509" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3509" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP1 -->
<g id="edge3" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP1</title>
<path fill="none" stroke="black" d="M3084.09,-938.57C3198.65,-930 3337.16,-914.75 3390,-889.17 3426.95,-871.29 3459.38,-837.32 3481.01,-810.49"/>
<polygon fill="black" stroke="black" points="3483.93,-812.44 3487.37,-802.42 3478.44,-808.11 3483.93,-812.44"/>
</g>
<!-- Layer0_TP2 -->
<g id="node5" class="node">
<title>Layer0_TP2</title>
<polygon fill="white" stroke="black" points="3380.5,-802.17 3159.5,-802.17 3159.5,-739.17 3380.5,-739.17 3380.5,-802.17"/>
<text text-anchor="middle" x="3270" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP2</text>
<text text-anchor="middle" x="3270" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3270" y="-768.17" font-family="Arial" font-size="10.00">GPU: 256&#45;383</text>
<text text-anchor="middle" x="3270" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3270" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP2 -->
<g id="edge4" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP2</title>
<path fill="none" stroke="black" d="M3069.26,-922.13C3097.52,-913.94 3125.91,-903.21 3151,-889.17 3186.36,-869.39 3218.54,-836.26 3240.49,-810.21"/>
<polygon fill="black" stroke="black" points="3243.29,-812.31 3246.96,-802.37 3237.89,-807.85 3243.29,-812.31"/>
</g>
<!-- Layer0_TP3 -->
<g id="node6" class="node">
<title>Layer0_TP3</title>
<polygon fill="white" stroke="black" points="3141.5,-802.17 2920.5,-802.17 2920.5,-739.17 3141.5,-739.17 3141.5,-802.17"/>
<text text-anchor="middle" x="3031" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP3</text>
<text text-anchor="middle" x="3031" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3031" y="-768.17" font-family="Arial" font-size="10.00">GPU: 384&#45;511</text>
<text text-anchor="middle" x="3031" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3031" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP3 -->
<g id="edge5" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP3</title>
<path fill="none" stroke="black" d="M2945.71,-897.12C2964.43,-869.59 2987.17,-836.14 3004.46,-810.71"/>
<polygon fill="black" stroke="black" points="3007.37,-812.65 3010.1,-802.42 3001.58,-808.72 3007.37,-812.65"/>
</g>
<!-- Layer0_TP4 -->
<g id="node7" class="node">
<title>Layer0_TP4</title>
<polygon fill="white" stroke="black" points="2902.5,-802.17 2681.5,-802.17 2681.5,-739.17 2902.5,-739.17 2902.5,-802.17"/>
<text text-anchor="middle" x="2792" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP4</text>
<text text-anchor="middle" x="2792" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2792" y="-768.17" font-family="Arial" font-size="10.00">GPU: 512&#45;639</text>
<text text-anchor="middle" x="2792" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2792" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP4 -->
<g id="edge6" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP4</title>
<path fill="none" stroke="black" d="M2876.58,-897.12C2858.02,-869.59 2835.47,-836.14 2818.32,-810.71"/>
<polygon fill="black" stroke="black" points="2821.22,-808.75 2812.73,-802.42 2815.42,-812.66 2821.22,-808.75"/>
</g>
<!-- Layer0_TP5 -->
<g id="node8" class="node">
<title>Layer0_TP5</title>
<polygon fill="white" stroke="black" points="2663.5,-802.17 2442.5,-802.17 2442.5,-739.17 2663.5,-739.17 2663.5,-802.17"/>
<text text-anchor="middle" x="2553" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP5</text>
<text text-anchor="middle" x="2553" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2553" y="-768.17" font-family="Arial" font-size="10.00">GPU: 640&#45;767</text>
<text text-anchor="middle" x="2553" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2553" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP5 -->
<g id="edge7" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP5</title>
<path fill="none" stroke="black" d="M2688.13,-897.05C2682.98,-894.54 2677.93,-891.92 2673,-889.17 2637.46,-869.35 2605.01,-836.22 2582.84,-810.18"/>
<polygon fill="black" stroke="black" points="2585.39,-807.78 2576.3,-802.35 2580.02,-812.27 2585.39,-807.78"/>
</g>
<!-- Layer0_TP6 -->
<g id="node9" class="node">
<title>Layer0_TP6</title>
<polygon fill="white" stroke="black" points="2424.5,-802.17 2203.5,-802.17 2203.5,-739.17 2424.5,-739.17 2424.5,-802.17"/>
<text text-anchor="middle" x="2314" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP6</text>
<text text-anchor="middle" x="2314" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2314" y="-768.17" font-family="Arial" font-size="10.00">GPU: 768&#45;895</text>
<text text-anchor="middle" x="2314" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2314" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP6 -->
<g id="edge8" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP6</title>
<path fill="none" stroke="black" d="M2717.35,-936.78C2607.94,-927.9 2483.43,-912.99 2434,-889.17 2396.86,-871.28 2364.15,-837.32 2342.29,-810.49"/>
<polygon fill="black" stroke="black" points="2344.84,-808.06 2335.87,-802.42 2339.36,-812.42 2344.84,-808.06"/>
</g>
<!-- Layer0_TP7 -->
<g id="node10" class="node">
<title>Layer0_TP7</title>
<polygon fill="white" stroke="black" points="2185.5,-802.17 1964.5,-802.17 1964.5,-739.17 2185.5,-739.17 2185.5,-802.17"/>
<text text-anchor="middle" x="2075" y="-790.17" font-family="Arial" font-size="10.00">Layer 0 TP7</text>
<text text-anchor="middle" x="2075" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2075" y="-768.17" font-family="Arial" font-size="10.00">GPU: 896&#45;1023</text>
<text text-anchor="middle" x="2075" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2075" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP7 -->
<g id="edge9" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP7</title>
<path fill="none" stroke="black" d="M2726.53,-947.07C2546.38,-943.5 2286.4,-930.93 2195,-889.17 2157.27,-871.93 2124.41,-837.56 2102.66,-810.43"/>
<polygon fill="black" stroke="black" points="2105.2,-807.98 2096.28,-802.26 2099.68,-812.3 2105.2,-807.98"/>
</g>
<!-- AR_Layer0 -->
<g id="node11" class="node">
<title>AR_Layer0</title>
<ellipse fill="lightgray" stroke="black" cx="3031" cy="-658.63" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="3031" y="-678.13" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3031" y="-667.13" font-family="Arial" font-size="10.00">TP8 Reduction</text>
<text text-anchor="middle" x="3031" y="-656.13" font-family="Arial" font-size="10.00">GPU: 0&#45;1023</text>
<text text-anchor="middle" x="3031" y="-645.13" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3031" y="-634.13" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer0_TP0&#45;&gt;AR_Layer0 -->
<g id="edge10" class="edge">
<title>Layer0_TP0&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M3637.25,-740.83C3634.47,-740.25 3631.72,-739.7 3629,-739.17 3480.37,-710.35 3308.91,-688.71 3187.8,-675.34"/>
<polygon fill="black" stroke="black" points="3188.03,-671.84 3177.71,-674.23 3187.26,-678.8 3188.03,-671.84"/>
</g>
<!-- Layer0_TP1&#45;&gt;AR_Layer0 -->
<g id="edge11" class="edge">
<title>Layer0_TP1&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M3398.5,-741.22C3395.64,-740.53 3392.8,-739.84 3390,-739.17 3315.58,-721.4 3232.15,-702.83 3164.47,-688.11"/>
<polygon fill="black" stroke="black" points="3165.11,-684.67 3154.6,-685.96 3163.63,-691.51 3165.11,-684.67"/>
</g>
<!-- Layer0_TP2&#45;&gt;AR_Layer0 -->
<g id="edge12" class="edge">
<title>Layer0_TP2&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M3203.74,-739.17C3178.17,-727.39 3148.52,-713.74 3121.07,-701.1"/>
<polygon fill="black" stroke="black" points="3122.41,-697.86 3111.86,-696.86 3119.48,-704.22 3122.41,-697.86"/>
</g>
<!-- Layer0_TP3&#45;&gt;AR_Layer0 -->
<g id="edge13" class="edge">
<title>Layer0_TP3&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M3031,-739.02C3031,-731.07 3031,-722.26 3031,-713.49"/>
<polygon fill="black" stroke="black" points="3034.5,-713.28 3031,-703.28 3027.5,-713.28 3034.5,-713.28"/>
</g>
<!-- Layer0_TP4&#45;&gt;AR_Layer0 -->
<g id="edge14" class="edge">
<title>Layer0_TP4&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M2858.26,-739.17C2883.83,-727.39 2913.48,-713.74 2940.93,-701.1"/>
<polygon fill="black" stroke="black" points="2942.52,-704.22 2950.14,-696.86 2939.59,-697.86 2942.52,-704.22"/>
</g>
<!-- Layer0_TP5&#45;&gt;AR_Layer0 -->
<g id="edge15" class="edge">
<title>Layer0_TP5&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M2663.79,-741.38C2666.89,-740.63 2669.97,-739.9 2673,-739.17 2747.23,-721.5 2830.43,-702.94 2897.93,-688.19"/>
<polygon fill="black" stroke="black" points="2898.74,-691.6 2907.77,-686.05 2897.25,-684.76 2898.74,-691.6"/>
</g>
<!-- Layer0_TP6&#45;&gt;AR_Layer0 -->
<g id="edge16" class="edge">
<title>Layer0_TP6&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M2424.72,-741.03C2427.84,-740.39 2430.94,-739.76 2434,-739.17 2582.42,-710.53 2753.58,-688.87 2874.48,-675.44"/>
<polygon fill="black" stroke="black" points="2875,-678.9 2884.55,-674.32 2874.23,-671.94 2875,-678.9"/>
</g>
<!-- Layer0_TP7&#45;&gt;AR_Layer0 -->
<g id="edge17" class="edge">
<title>Layer0_TP7&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M2185.69,-740.88C2188.82,-740.28 2191.93,-739.71 2195,-739.17 2426.68,-698.95 2698.27,-677.84 2867.52,-667.72"/>
<polygon fill="black" stroke="black" points="2867.73,-671.21 2877.51,-667.13 2867.32,-664.22 2867.73,-671.21"/>
</g>
<!-- Routing_L0 -->
<g id="node16" class="node">
<title>Routing_L0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3487.73,-578.08 3135.01,-578.08 3044.27,-452.08 3396.99,-452.08 3487.73,-578.08"/>
<text text-anchor="middle" x="3266" y="-534.58" font-family="Arial" font-size="10.00">Routing Gate</text>
<text text-anchor="middle" x="3266" y="-523.58" font-family="Arial" font-size="10.00">Select experts</text>
<text text-anchor="middle" x="3266" y="-512.58" font-family="Arial" font-size="10.00">GPU: 0&#45;1023</text>
<text text-anchor="middle" x="3266" y="-501.58" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3266" y="-490.58" font-family="Arial" font-size="10.00">Output: routing decisions</text>
</g>
<!-- AR_Layer0&#45;&gt;Routing_L0 -->
<g id="edge18" class="edge">
<title>AR_Layer0&#45;&gt;Routing_L0</title>
<path fill="none" stroke="black" d="M3096.77,-618.01C3114.63,-607.25 3134.49,-595.29 3154.13,-583.46"/>
<polygon fill="black" stroke="black" points="3156.07,-586.38 3162.83,-578.22 3152.46,-580.38 3156.07,-586.38"/>
</g>
<!-- Expert_L0_GPU0 -->
<g id="node12" class="node">
<title>Expert_L0_GPU0</title>
<polygon fill="white" stroke="black" points="3552.5,-289.98 3331.5,-289.98 3331.5,-237.98 3552.5,-237.98 3552.5,-289.98"/>
<text text-anchor="middle" x="3442" y="-277.98" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3442" y="-266.98" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3442" y="-255.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3442" y="-244.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- PP_Comm0 -->
<g id="node31" class="node">
<title>PP_Comm0</title>
<ellipse fill="lightgray" stroke="black" cx="3561" cy="-145.98" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="3561" y="-165.48" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="3561" y="-154.48" font-family="Arial" font-size="10.00">Stage 0→1</text>
<text text-anchor="middle" x="3561" y="-143.48" font-family="Arial" font-size="10.00">GPU: 1023→1024</text>
<text text-anchor="middle" x="3561" y="-132.48" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3561" y="-121.48" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L0_GPU0&#45;&gt;PP_Comm0 -->
<g id="edge23" class="edge">
<title>Expert_L0_GPU0&#45;&gt;PP_Comm0</title>
<path fill="none" stroke="black" d="M3467.82,-237.81C3480.39,-225.56 3495.95,-210.39 3510.74,-195.98"/>
<polygon fill="black" stroke="black" points="3513.2,-198.47 3517.91,-188.98 3508.31,-193.46 3513.2,-198.47"/>
</g>
<!-- Expert_L0_GPU1 -->
<g id="node13" class="node">
<title>Expert_L0_GPU1</title>
<polygon fill="white" stroke="black" points="3313.5,-289.98 3092.5,-289.98 3092.5,-237.98 3313.5,-237.98 3313.5,-289.98"/>
<text text-anchor="middle" x="3203" y="-277.98" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3203" y="-266.98" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="3203" y="-255.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3203" y="-244.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L0_GPU1&#45;&gt;PP_Comm0 -->
<g id="edge24" class="edge">
<title>Expert_L0_GPU1&#45;&gt;PP_Comm0</title>
<path fill="none" stroke="black" d="M3250.24,-237.85C3271.97,-226.99 3298.35,-214.79 3323,-205.98 3355.93,-194.22 3392.23,-183.92 3426.35,-175.38"/>
<polygon fill="black" stroke="black" points="3427.51,-178.69 3436.38,-172.89 3425.83,-171.9 3427.51,-178.69"/>
</g>
<!-- Expert_L0_GPU63 -->
<g id="node14" class="node">
<title>Expert_L0_GPU63</title>
<polygon fill="white" stroke="black" points="3791.5,-289.98 3570.5,-289.98 3570.5,-237.98 3791.5,-237.98 3791.5,-289.98"/>
<text text-anchor="middle" x="3681" y="-277.98" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="3681" y="-266.98" font-family="Arial" font-size="10.00">GPU: 63</text>
<text text-anchor="middle" x="3681" y="-255.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3681" y="-244.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L0_GPU63&#45;&gt;PP_Comm0 -->
<g id="edge25" class="edge">
<title>Expert_L0_GPU63&#45;&gt;PP_Comm0</title>
<path fill="none" stroke="black" d="M3654.96,-237.81C3642.28,-225.56 3626.59,-210.39 3611.69,-195.98"/>
<polygon fill="black" stroke="black" points="3614.07,-193.42 3604.45,-188.98 3609.2,-198.45 3614.07,-193.42"/>
</g>
<!-- A2A_Layer0 -->
<g id="node15" class="node">
<title>A2A_Layer0</title>
<ellipse fill="lightgray" stroke="black" cx="3325" cy="-371.53" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="3325" y="-391.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="3325" y="-380.03" font-family="Arial" font-size="10.00">EP64 Dispatch</text>
<text text-anchor="middle" x="3325" y="-369.03" font-family="Arial" font-size="10.00">GPU: 0&#45;1023</text>
<text text-anchor="middle" x="3325" y="-358.03" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3325" y="-347.03" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- A2A_Layer0&#45;&gt;Expert_L0_GPU0 -->
<g id="edge20" class="edge">
<title>A2A_Layer0&#45;&gt;Expert_L0_GPU0</title>
<path fill="none" stroke="black" d="M3371.24,-328.82C3383.07,-318.14 3395.61,-306.83 3406.79,-296.75"/>
<polygon fill="black" stroke="black" points="3409.2,-299.28 3414.28,-289.99 3404.51,-294.09 3409.2,-299.28"/>
</g>
<!-- A2A_Layer0&#45;&gt;Expert_L0_GPU1 -->
<g id="edge21" class="edge">
<title>A2A_Layer0&#45;&gt;Expert_L0_GPU1</title>
<path fill="none" stroke="black" d="M3277.13,-329.12C3264.77,-318.42 3251.64,-307.07 3239.93,-296.93"/>
<polygon fill="black" stroke="black" points="3241.93,-294.03 3232.07,-290.14 3237.35,-299.33 3241.93,-294.03"/>
</g>
<!-- A2A_Layer0&#45;&gt;Expert_L0_GPU63 -->
<g id="edge22" class="edge">
<title>A2A_Layer0&#45;&gt;Expert_L0_GPU63</title>
<path fill="none" stroke="black" d="M3456.11,-347.2C3490.93,-339.6 3528.23,-330.18 3562,-318.98 3582.26,-312.27 3603.71,-303.19 3622.73,-294.4"/>
<polygon fill="black" stroke="black" points="3624.29,-297.53 3631.86,-290.12 3621.32,-291.19 3624.29,-297.53"/>
</g>
<!-- Routing_L0&#45;&gt;A2A_Layer0 -->
<g id="edge19" class="edge">
<title>Routing_L0&#45;&gt;A2A_Layer0</title>
<path fill="none" stroke="black" d="M3291.88,-451.99C3295.61,-443.05 3299.41,-433.91 3303.06,-425.17"/>
<polygon fill="black" stroke="black" points="3306.32,-426.45 3306.93,-415.87 3299.86,-423.76 3306.32,-426.45"/>
</g>
<!-- Layer8_TP0 -->
<g id="node17" class="node">
<title>Layer8_TP0</title>
<polygon fill="white" stroke="black" points="1925.5,-802.17 1704.5,-802.17 1704.5,-739.17 1925.5,-739.17 1925.5,-802.17"/>
<text text-anchor="middle" x="1815" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP0</text>
<text text-anchor="middle" x="1815" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1815" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1024&#45;1151</text>
<text text-anchor="middle" x="1815" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1815" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- AR_Layer8 -->
<g id="node25" class="node">
<title>AR_Layer8</title>
<ellipse fill="lightgray" stroke="black" cx="978" cy="-658.63" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="978" y="-678.13" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="978" y="-667.13" font-family="Arial" font-size="10.00">TP8 Reduction</text>
<text text-anchor="middle" x="978" y="-656.13" font-family="Arial" font-size="10.00">GPU: 1024&#45;2047</text>
<text text-anchor="middle" x="978" y="-645.13" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="978" y="-634.13" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP0&#45;&gt;AR_Layer8 -->
<g id="edge27" class="edge">
<title>Layer8_TP0&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M1704.26,-740.75C1701.48,-740.2 1698.73,-739.67 1696,-739.17 1506.39,-704.55 1285.67,-682.83 1139.53,-671"/>
<polygon fill="black" stroke="black" points="1139.38,-667.47 1129.14,-670.16 1138.82,-674.45 1139.38,-667.47"/>
</g>
<!-- Layer8_TP1 -->
<g id="node18" class="node">
<title>Layer8_TP1</title>
<polygon fill="white" stroke="black" points="252.5,-802.17 31.5,-802.17 31.5,-739.17 252.5,-739.17 252.5,-802.17"/>
<text text-anchor="middle" x="142" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP1</text>
<text text-anchor="middle" x="142" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="142" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1152&#45;1279</text>
<text text-anchor="middle" x="142" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="142" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP1&#45;&gt;AR_Layer8 -->
<g id="edge28" class="edge">
<title>Layer8_TP1&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M252.7,-740.94C255.83,-740.32 258.93,-739.73 262,-739.17 450.97,-704.83 670.87,-683.07 816.59,-671.15"/>
<polygon fill="black" stroke="black" points="817.27,-674.6 826.96,-670.31 816.7,-667.63 817.27,-674.6"/>
</g>
<!-- Layer8_TP2 -->
<g id="node19" class="node">
<title>Layer8_TP2</title>
<polygon fill="white" stroke="black" points="1686.5,-802.17 1465.5,-802.17 1465.5,-739.17 1686.5,-739.17 1686.5,-802.17"/>
<text text-anchor="middle" x="1576" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP2</text>
<text text-anchor="middle" x="1576" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1576" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1280&#45;1407</text>
<text text-anchor="middle" x="1576" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1576" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP2&#45;&gt;AR_Layer8 -->
<g id="edge29" class="edge">
<title>Layer8_TP2&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M1465.22,-740.95C1462.46,-740.34 1459.71,-739.75 1457,-739.17 1346.86,-715.96 1221.3,-695.32 1126.38,-680.89"/>
<polygon fill="black" stroke="black" points="1126.83,-677.41 1116.41,-679.38 1125.78,-684.34 1126.83,-677.41"/>
</g>
<!-- Layer8_TP3 -->
<g id="node20" class="node">
<title>Layer8_TP3</title>
<polygon fill="white" stroke="black" points="1447.5,-802.17 1226.5,-802.17 1226.5,-739.17 1447.5,-739.17 1447.5,-802.17"/>
<text text-anchor="middle" x="1337" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP3</text>
<text text-anchor="middle" x="1337" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1337" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1408&#45;1535</text>
<text text-anchor="middle" x="1337" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1337" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP3&#45;&gt;AR_Layer8 -->
<g id="edge30" class="edge">
<title>Layer8_TP3&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M1237.48,-739.17C1192.53,-725.39 1139.18,-709.03 1092.57,-694.75"/>
<polygon fill="black" stroke="black" points="1093.32,-691.32 1082.73,-691.73 1091.27,-698.01 1093.32,-691.32"/>
</g>
<!-- Layer8_TP4 -->
<g id="node21" class="node">
<title>Layer8_TP4</title>
<polygon fill="white" stroke="black" points="1208.5,-802.17 987.5,-802.17 987.5,-739.17 1208.5,-739.17 1208.5,-802.17"/>
<text text-anchor="middle" x="1098" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP4</text>
<text text-anchor="middle" x="1098" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1098" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1536&#45;1663</text>
<text text-anchor="middle" x="1098" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1098" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP4&#45;&gt;AR_Layer8 -->
<g id="edge31" class="edge">
<title>Layer8_TP4&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M1064.57,-739.02C1054.22,-729.52 1042.54,-718.82 1031.2,-708.41"/>
<polygon fill="black" stroke="black" points="1033.54,-705.81 1023.8,-701.63 1028.81,-710.97 1033.54,-705.81"/>
</g>
<!-- Layer8_TP5 -->
<g id="node22" class="node">
<title>Layer8_TP5</title>
<polygon fill="white" stroke="black" points="969.5,-802.17 748.5,-802.17 748.5,-739.17 969.5,-739.17 969.5,-802.17"/>
<text text-anchor="middle" x="859" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP5</text>
<text text-anchor="middle" x="859" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="859" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1664&#45;1791</text>
<text text-anchor="middle" x="859" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="859" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP5&#45;&gt;AR_Layer8 -->
<g id="edge32" class="edge">
<title>Layer8_TP5&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M892.15,-739.02C902.32,-729.61 913.77,-719.02 924.93,-708.71"/>
<polygon fill="black" stroke="black" points="927.61,-710.99 932.58,-701.63 922.86,-705.85 927.61,-710.99"/>
</g>
<!-- Layer8_TP6 -->
<g id="node23" class="node">
<title>Layer8_TP6</title>
<polygon fill="white" stroke="black" points="730.5,-802.17 509.5,-802.17 509.5,-739.17 730.5,-739.17 730.5,-802.17"/>
<text text-anchor="middle" x="620" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP6</text>
<text text-anchor="middle" x="620" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="620" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1792&#45;1919</text>
<text text-anchor="middle" x="620" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="620" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP6&#45;&gt;AR_Layer8 -->
<g id="edge33" class="edge">
<title>Layer8_TP6&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M719.25,-739.17C763.97,-725.42 817.04,-709.1 863.45,-694.84"/>
<polygon fill="black" stroke="black" points="864.71,-698.11 873.24,-691.83 862.66,-691.42 864.71,-698.11"/>
</g>
<!-- Layer8_TP7 -->
<g id="node24" class="node">
<title>Layer8_TP7</title>
<polygon fill="white" stroke="black" points="491.5,-802.17 270.5,-802.17 270.5,-739.17 491.5,-739.17 491.5,-802.17"/>
<text text-anchor="middle" x="381" y="-790.17" font-family="Arial" font-size="10.00">Layer 8 TP7</text>
<text text-anchor="middle" x="381" y="-779.17" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="381" y="-768.17" font-family="Arial" font-size="10.00">GPU: 1920&#45;2047</text>
<text text-anchor="middle" x="381" y="-757.17" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="381" y="-746.17" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP7&#45;&gt;AR_Layer8 -->
<g id="edge34" class="edge">
<title>Layer8_TP7&#45;&gt;AR_Layer8</title>
<path fill="none" stroke="black" d="M491.75,-741.17C494.86,-740.48 497.95,-739.81 501,-739.17 610.61,-716.15 735.51,-695.52 830.01,-681.04"/>
<polygon fill="black" stroke="black" points="830.56,-684.5 839.92,-679.53 829.51,-677.58 830.56,-684.5"/>
</g>
<!-- Routing_L8 -->
<g id="node30" class="node">
<title>Routing_L8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1199.73,-578.08 847.01,-578.08 756.27,-452.08 1108.99,-452.08 1199.73,-578.08"/>
<text text-anchor="middle" x="978" y="-534.58" font-family="Arial" font-size="10.00">Routing Gate</text>
<text text-anchor="middle" x="978" y="-523.58" font-family="Arial" font-size="10.00">Select experts</text>
<text text-anchor="middle" x="978" y="-512.58" font-family="Arial" font-size="10.00">GPU: 1024&#45;2047</text>
<text text-anchor="middle" x="978" y="-501.58" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="978" y="-490.58" font-family="Arial" font-size="10.00">Output: routing decisions</text>
</g>
<!-- AR_Layer8&#45;&gt;Routing_L8 -->
<g id="edge35" class="edge">
<title>AR_Layer8&#45;&gt;Routing_L8</title>
<path fill="none" stroke="black" d="M978,-614C978,-605.89 978,-597.21 978,-588.5"/>
<polygon fill="black" stroke="black" points="981.5,-588.29 978,-578.29 974.5,-588.29 981.5,-588.29"/>
</g>
<!-- Expert_L8_GPU1024 -->
<g id="node26" class="node">
<title>Expert_L8_GPU1024</title>
<polygon fill="white" stroke="black" points="1088.5,-289.98 867.5,-289.98 867.5,-237.98 1088.5,-237.98 1088.5,-289.98"/>
<text text-anchor="middle" x="978" y="-277.98" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="978" y="-266.98" font-family="Arial" font-size="10.00">GPU: 1024</text>
<text text-anchor="middle" x="978" y="-255.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="978" y="-244.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Aggregate -->
<g id="node32" class="node">
<title>DP_Aggregate</title>
<polygon fill="lightgreen" stroke="black" points="1213.19,-197.98 839.06,-197.98 742.81,-93.98 1116.94,-93.98 1213.19,-197.98"/>
<text text-anchor="middle" x="978" y="-159.98" font-family="Arial" font-size="10.00">DP Aggregate</text>
<text text-anchor="middle" x="978" y="-148.98" font-family="Arial" font-size="10.00">2&#45;way reduction</text>
<text text-anchor="middle" x="978" y="-137.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="978" y="-126.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L8_GPU1024&#45;&gt;DP_Aggregate -->
<g id="edge40" class="edge">
<title>Expert_L8_GPU1024&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M978,-237.81C978,-229.12 978,-218.95 978,-208.63"/>
<polygon fill="black" stroke="black" points="981.5,-208.31 978,-198.31 974.5,-208.31 981.5,-208.31"/>
</g>
<!-- Expert_L8_GPU1025 -->
<g id="node27" class="node">
<title>Expert_L8_GPU1025</title>
<polygon fill="white" stroke="black" points="849.5,-289.98 628.5,-289.98 628.5,-237.98 849.5,-237.98 849.5,-289.98"/>
<text text-anchor="middle" x="739" y="-277.98" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="739" y="-266.98" font-family="Arial" font-size="10.00">GPU: 1025</text>
<text text-anchor="middle" x="739" y="-255.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="739" y="-244.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L8_GPU1025&#45;&gt;DP_Aggregate -->
<g id="edge41" class="edge">
<title>Expert_L8_GPU1025&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M790.57,-237.96C812.05,-227.53 837.91,-214.97 863.48,-202.57"/>
<polygon fill="black" stroke="black" points="865.03,-205.7 872.5,-198.19 861.97,-199.41 865.03,-205.7"/>
</g>
<!-- Expert_L8_GPU1087 -->
<g id="node28" class="node">
<title>Expert_L8_GPU1087</title>
<polygon fill="white" stroke="black" points="1327.5,-289.98 1106.5,-289.98 1106.5,-237.98 1327.5,-237.98 1327.5,-289.98"/>
<text text-anchor="middle" x="1217" y="-277.98" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="1217" y="-266.98" font-family="Arial" font-size="10.00">GPU: 1087</text>
<text text-anchor="middle" x="1217" y="-255.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1217" y="-244.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L8_GPU1087&#45;&gt;DP_Aggregate -->
<g id="edge42" class="edge">
<title>Expert_L8_GPU1087&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M1165.43,-237.96C1143.95,-227.53 1118.09,-214.97 1092.52,-202.57"/>
<polygon fill="black" stroke="black" points="1094.03,-199.41 1083.5,-198.19 1090.97,-205.7 1094.03,-199.41"/>
</g>
<!-- A2A_Layer8 -->
<g id="node29" class="node">
<title>A2A_Layer8</title>
<ellipse fill="lightgray" stroke="black" cx="978" cy="-371.53" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="978" y="-391.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="978" y="-380.03" font-family="Arial" font-size="10.00">EP64 Dispatch</text>
<text text-anchor="middle" x="978" y="-369.03" font-family="Arial" font-size="10.00">GPU: 1024&#45;2047</text>
<text text-anchor="middle" x="978" y="-358.03" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="978" y="-347.03" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=?, dim=1024]</text>
</g>
<!-- A2A_Layer8&#45;&gt;Expert_L8_GPU1024 -->
<g id="edge37" class="edge">
<title>A2A_Layer8&#45;&gt;Expert_L8_GPU1024</title>
<path fill="none" stroke="black" d="M978,-326.69C978,-317.92 978,-308.82 978,-300.39"/>
<polygon fill="black" stroke="black" points="981.5,-300.14 978,-290.14 974.5,-300.14 981.5,-300.14"/>
</g>
<!-- A2A_Layer8&#45;&gt;Expert_L8_GPU1025 -->
<g id="edge38" class="edge">
<title>A2A_Layer8&#45;&gt;Expert_L8_GPU1025</title>
<path fill="none" stroke="black" d="M893.43,-334.07C881.85,-329.03 870.12,-323.89 859,-318.98 840.94,-311.01 821.39,-302.26 803.42,-294.17"/>
<polygon fill="black" stroke="black" points="804.74,-290.93 794.19,-290.01 801.87,-297.31 804.74,-290.93"/>
</g>
<!-- A2A_Layer8&#45;&gt;Expert_L8_GPU1087 -->
<g id="edge39" class="edge">
<title>A2A_Layer8&#45;&gt;Expert_L8_GPU1087</title>
<path fill="none" stroke="black" d="M1063.31,-334.13C1074.98,-329.08 1086.8,-323.93 1098,-318.98 1115.94,-311.06 1135.33,-302.33 1153.15,-294.25"/>
<polygon fill="black" stroke="black" points="1154.65,-297.41 1162.3,-290.08 1151.75,-291.03 1154.65,-297.41"/>
</g>
<!-- Routing_L8&#45;&gt;A2A_Layer8 -->
<g id="edge36" class="edge">
<title>Routing_L8&#45;&gt;A2A_Layer8</title>
<path fill="none" stroke="black" d="M978,-451.99C978,-443.44 978,-434.71 978,-426.32"/>
<polygon fill="black" stroke="black" points="981.5,-426.29 978,-416.29 974.5,-426.29 981.5,-426.29"/>
</g>
<!-- PP_Comm0&#45;&gt;Layer8_TP0 -->
<g id="edge26" class="edge">
<title>PP_Comm0&#45;&gt;Layer8_TP0</title>
<path fill="none" stroke="black" d="M3706.62,-162.2C3740.71,-171.01 3775.16,-184.73 3803,-205.98 3864.9,-253.24 3892,-337.87 3892,-370.53 3892,-516.08 3892,-516.08 3892,-516.08 3892,-599.8 3932.04,-646.95 3870,-703.17 3830.54,-738.94 2005.89,-732.9 1953,-739.17 1947.3,-739.85 1941.49,-740.66 1935.64,-741.57"/>
<polygon fill="black" stroke="black" points="1935.07,-738.11 1925.77,-743.19 1936.2,-745.02 1935.07,-738.11"/>
</g>
<!-- Output -->
<g id="node33" class="node">
<title>Output</title>
<ellipse fill="lightblue" stroke="black" cx="978" cy="-28.99" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="978" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="978" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="978" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Aggregate&#45;&gt;Output -->
<g id="edge43" class="edge">
<title>DP_Aggregate&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M978,-93.88C978,-85.27 978,-76.48 978,-68.27"/>
<polygon fill="black" stroke="black" points="981.5,-68.25 978,-58.25 974.5,-68.25 981.5,-68.25"/>
</g>
</g>
</svg>
