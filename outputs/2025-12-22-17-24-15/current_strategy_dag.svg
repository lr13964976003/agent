<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: CurrentStrategy Pages: 1 -->
<svg width="5061pt" height="1009pt"
 viewBox="0.00 0.00 5061.34 1009.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1005.17)">
<title>CurrentStrategy</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1005.17 5057.34,-1005.17 5057.34,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline</title>
<polygon fill="lightyellow" stroke="black" points="8,-97.1 8,-795.19 3876,-795.19 3876,-97.1 8,-97.1"/>
<text text-anchor="middle" x="1942" y="-781.59" font-family="Arial" font-size="12.00">Pipeline Parallelism (PP4)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage0</title>
<polygon fill="lightcoral" stroke="black" points="16,-105.1 16,-766.19 985,-766.19 985,-105.1 16,-105.1"/>
<text text-anchor="middle" x="500.5" y="-752.59" font-family="Arial" font-size="12.00">Stage 0: Layers 0&#45;3 (GPU 0&#45;255)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_tp_stage0</title>
<polygon fill="lightpink" stroke="black" points="24,-113.1 24,-737.19 977,-737.19 977,-113.1 24,-113.1"/>
<text text-anchor="middle" x="500.5" y="-723.59" font-family="Arial" font-size="12.00">TP4 within Stage 0</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_ep_layer0</title>
<polygon fill="lightcyan" stroke="black" points="255,-121.1 255,-210.1 969,-210.1 969,-121.1 255,-121.1"/>
<text text-anchor="middle" x="612" y="-196.5" font-family="Arial" font-size="12.00">EP16: 4 experts per GPU</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage1</title>
<polygon fill="lightcoral" stroke="black" points="993,-637.19 993,-737.19 1946,-737.19 1946,-637.19 993,-637.19"/>
<text text-anchor="middle" x="1469.5" y="-723.59" font-family="Arial" font-size="12.00">Stage 1: Layers 4&#45;7 (GPU 256&#45;511)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage2</title>
<polygon fill="lightcoral" stroke="black" points="1954,-637.19 1954,-737.19 2907,-737.19 2907,-637.19 1954,-637.19"/>
<text text-anchor="middle" x="2430.5" y="-723.59" font-family="Arial" font-size="12.00">Stage 2: Layers 8&#45;11 (GPU 512&#45;767)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_stage3</title>
<polygon fill="lightcoral" stroke="black" points="2915,-637.19 2915,-737.19 3868,-737.19 3868,-637.19 2915,-637.19"/>
<text text-anchor="middle" x="3391.5" y="-723.59" font-family="Arial" font-size="12.00">Stage 3: Layers 12&#45;15 (GPU 768&#45;1023)</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="lightblue" stroke="black" cx="500" cy="-972.18" rx="188.18" ry="28.98"/>
<text text-anchor="middle" x="500" y="-980.68" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="500" y="-969.68" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=128&#45;10240, dim=1024]</text>
<text text-anchor="middle" x="500" y="-958.68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=128&#45;10240, dim=1024]</text>
</g>
<!-- DP_Split -->
<g id="node2" class="node">
<title>DP_Split</title>
<polygon fill="lightgreen" stroke="black" points="729.24,-907.19 364.57,-907.19 270.76,-803.19 635.43,-803.19 729.24,-907.19"/>
<text text-anchor="middle" x="500" y="-869.19" font-family="Arial" font-size="10.00">DP Split</text>
<text text-anchor="middle" x="500" y="-858.19" font-family="Arial" font-size="10.00">4&#45;way Data Parallel</text>
<text text-anchor="middle" x="500" y="-847.19" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="500" y="-836.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Input&#45;&gt;DP_Split -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;DP_Split</title>
<path fill="none" stroke="black" d="M500,-943.05C500,-935.23 500,-926.41 500,-917.47"/>
<polygon fill="black" stroke="black" points="503.5,-917.37 500,-907.37 496.5,-917.37 503.5,-917.37"/>
</g>
<!-- Layer0_TP0 -->
<g id="node3" class="node">
<title>Layer0_TP0</title>
<polygon fill="white" stroke="black" points="969.5,-708.19 748.5,-708.19 748.5,-645.19 969.5,-645.19 969.5,-708.19"/>
<text text-anchor="middle" x="859" y="-696.19" font-family="Arial" font-size="10.00">Layer 0 TP0</text>
<text text-anchor="middle" x="859" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="859" y="-674.19" font-family="Arial" font-size="10.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="859" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="859" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP0 -->
<g id="edge2" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP0</title>
<path fill="none" stroke="black" d="M657.87,-827.9C685.91,-819.74 714.08,-809.08 739,-795.19 774.55,-775.38 807,-742.25 829.17,-716.21"/>
<polygon fill="black" stroke="black" points="831.99,-718.29 835.71,-708.38 826.61,-713.81 831.99,-718.29"/>
</g>
<!-- Layer0_TP1 -->
<g id="node4" class="node">
<title>Layer0_TP1</title>
<polygon fill="white" stroke="black" points="730.5,-708.19 509.5,-708.19 509.5,-645.19 730.5,-645.19 730.5,-708.19"/>
<text text-anchor="middle" x="620" y="-696.19" font-family="Arial" font-size="10.00">Layer 0 TP1</text>
<text text-anchor="middle" x="620" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="620" y="-674.19" font-family="Arial" font-size="10.00">GPU: 64&#45;127</text>
<text text-anchor="middle" x="620" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="620" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP1 -->
<g id="edge3" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP1</title>
<path fill="none" stroke="black" d="M534.71,-803.14C553.43,-775.61 576.17,-742.16 593.46,-716.73"/>
<polygon fill="black" stroke="black" points="596.37,-718.67 599.1,-708.43 590.58,-714.74 596.37,-718.67"/>
</g>
<!-- Layer0_TP2 -->
<g id="node5" class="node">
<title>Layer0_TP2</title>
<polygon fill="white" stroke="black" points="491.5,-708.19 270.5,-708.19 270.5,-645.19 491.5,-645.19 491.5,-708.19"/>
<text text-anchor="middle" x="381" y="-696.19" font-family="Arial" font-size="10.00">Layer 0 TP2</text>
<text text-anchor="middle" x="381" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="381" y="-674.19" font-family="Arial" font-size="10.00">GPU: 128&#45;191</text>
<text text-anchor="middle" x="381" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="381" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP2 -->
<g id="edge4" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP2</title>
<path fill="none" stroke="black" d="M465.58,-803.14C447.02,-775.61 424.47,-742.16 407.32,-716.73"/>
<polygon fill="black" stroke="black" points="410.22,-714.77 401.73,-708.43 404.42,-718.68 410.22,-714.77"/>
</g>
<!-- Layer0_TP3 -->
<g id="node6" class="node">
<title>Layer0_TP3</title>
<polygon fill="white" stroke="black" points="252.5,-708.19 31.5,-708.19 31.5,-645.19 252.5,-645.19 252.5,-708.19"/>
<text text-anchor="middle" x="142" y="-696.19" font-family="Arial" font-size="10.00">Layer 0 TP3</text>
<text text-anchor="middle" x="142" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="142" y="-674.19" font-family="Arial" font-size="10.00">GPU: 192&#45;255</text>
<text text-anchor="middle" x="142" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="142" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Split&#45;&gt;Layer0_TP3 -->
<g id="edge5" class="edge">
<title>DP_Split&#45;&gt;Layer0_TP3</title>
<path fill="none" stroke="black" d="M276.18,-803.11C271.01,-800.6 265.94,-797.96 261,-795.19 225.65,-775.39 193.47,-742.26 171.52,-716.21"/>
<polygon fill="black" stroke="black" points="174.11,-713.86 165.04,-708.38 168.72,-718.32 174.11,-713.86"/>
</g>
<!-- AR_Layer0 -->
<g id="node7" class="node">
<title>AR_Layer0</title>
<ellipse fill="lightgray" stroke="black" cx="612" cy="-557.19" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="612" y="-576.69" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="612" y="-565.69" font-family="Arial" font-size="10.00">TP4 Reduction</text>
<text text-anchor="middle" x="612" y="-554.69" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="612" y="-543.69" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="612" y="-532.69" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer0_TP0&#45;&gt;AR_Layer0 -->
<g id="edge6" class="edge">
<title>Layer0_TP0&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M794.75,-645.13C765.87,-631.39 731.32,-614.95 700.08,-600.09"/>
<polygon fill="black" stroke="black" points="701.46,-596.87 690.93,-595.74 698.46,-603.19 701.46,-596.87"/>
</g>
<!-- Layer0_TP1&#45;&gt;AR_Layer0 -->
<g id="edge7" class="edge">
<title>Layer0_TP1&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M617.92,-645.13C617.23,-635.03 616.44,-623.47 615.67,-612.15"/>
<polygon fill="black" stroke="black" points="619.15,-611.61 614.97,-601.87 612.16,-612.09 619.15,-611.61"/>
</g>
<!-- Layer0_TP2&#45;&gt;AR_Layer0 -->
<g id="edge8" class="edge">
<title>Layer0_TP2&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M441.09,-645.13C467.51,-631.69 498.99,-615.67 527.7,-601.07"/>
<polygon fill="black" stroke="black" points="529.58,-604.04 536.91,-596.39 526.41,-597.8 529.58,-604.04"/>
</g>
<!-- Layer0_TP3&#45;&gt;AR_Layer0 -->
<g id="edge9" class="edge">
<title>Layer0_TP3&#45;&gt;AR_Layer0</title>
<path fill="none" stroke="black" d="M233.68,-645.11C242.87,-642.32 252.1,-639.63 261,-637.19 331.34,-617.94 410.53,-599.82 475.87,-585.8"/>
<polygon fill="black" stroke="black" points="476.77,-589.18 485.82,-583.67 475.31,-582.34 476.77,-589.18"/>
</g>
<!-- Routing_L0 -->
<g id="node12" class="node">
<title>Routing_L0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="833.73,-469.19 481.01,-469.19 390.27,-343.19 742.99,-343.19 833.73,-469.19"/>
<text text-anchor="middle" x="612" y="-425.69" font-family="Arial" font-size="10.00">Routing Gate</text>
<text text-anchor="middle" x="612" y="-414.69" font-family="Arial" font-size="10.00">Select experts</text>
<text text-anchor="middle" x="612" y="-403.69" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="612" y="-392.69" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="612" y="-381.69" font-family="Arial" font-size="10.00">Output: routing decisions</text>
</g>
<!-- AR_Layer0&#45;&gt;Routing_L0 -->
<g id="edge10" class="edge">
<title>AR_Layer0&#45;&gt;Routing_L0</title>
<path fill="none" stroke="black" d="M612,-512.29C612,-501.97 612,-490.71 612,-479.51"/>
<polygon fill="black" stroke="black" points="615.5,-479.27 612,-469.27 608.5,-479.27 615.5,-479.27"/>
</g>
<!-- Expert_L0_GPU0 -->
<g id="node8" class="node">
<title>Expert_L0_GPU0</title>
<polygon fill="white" stroke="black" points="483.5,-181.1 262.5,-181.1 262.5,-129.1 483.5,-129.1 483.5,-181.1"/>
<text text-anchor="middle" x="373" y="-169.1" font-family="Arial" font-size="10.00">Expert 0&#45;3</text>
<text text-anchor="middle" x="373" y="-158.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="373" y="-147.1" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="373" y="-136.1" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- PP_Comm0 -->
<g id="node25" class="node">
<title>PP_Comm0</title>
<ellipse fill="lightgray" stroke="black" cx="731" cy="-44.55" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="731" y="-64.05" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="731" y="-53.05" font-family="Arial" font-size="10.00">Stage 0→1</text>
<text text-anchor="middle" x="731" y="-42.05" font-family="Arial" font-size="10.00">GPU: 255→256</text>
<text text-anchor="middle" x="731" y="-31.05" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="731" y="-20.05" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L0_GPU0&#45;&gt;PP_Comm0 -->
<g id="edge15" class="edge">
<title>Expert_L0_GPU0&#45;&gt;PP_Comm0</title>
<path fill="none" stroke="black" d="M418.85,-129.03C440.53,-117.99 467.07,-105.62 492,-97.1 522.76,-86.58 556.5,-77.74 588.69,-70.52"/>
<polygon fill="black" stroke="black" points="589.61,-73.9 598.62,-68.33 588.1,-67.06 589.61,-73.9"/>
</g>
<!-- Expert_L0_GPU1 -->
<g id="node9" class="node">
<title>Expert_L0_GPU1</title>
<polygon fill="white" stroke="black" points="961.5,-181.1 740.5,-181.1 740.5,-129.1 961.5,-129.1 961.5,-181.1"/>
<text text-anchor="middle" x="851" y="-169.1" font-family="Arial" font-size="10.00">Expert 4&#45;7</text>
<text text-anchor="middle" x="851" y="-158.1" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="851" y="-147.1" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="851" y="-136.1" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L0_GPU1&#45;&gt;PP_Comm0 -->
<g id="edge16" class="edge">
<title>Expert_L0_GPU1&#45;&gt;PP_Comm0</title>
<path fill="none" stroke="black" d="M823.17,-128.92C811.71,-118.55 798.03,-106.18 784.76,-94.17"/>
<polygon fill="black" stroke="black" points="786.77,-91.28 777.01,-87.17 782.08,-96.47 786.77,-91.28"/>
</g>
<!-- Expert_L0_GPU15 -->
<g id="node10" class="node">
<title>Expert_L0_GPU15</title>
<polygon fill="white" stroke="black" points="722.5,-181.1 501.5,-181.1 501.5,-129.1 722.5,-129.1 722.5,-181.1"/>
<text text-anchor="middle" x="612" y="-169.1" font-family="Arial" font-size="10.00">Expert 60&#45;63</text>
<text text-anchor="middle" x="612" y="-158.1" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="612" y="-147.1" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="612" y="-136.1" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Expert_L0_GPU15&#45;&gt;PP_Comm0 -->
<g id="edge17" class="edge">
<title>Expert_L0_GPU15&#45;&gt;PP_Comm0</title>
<path fill="none" stroke="black" d="M639.6,-128.92C650.96,-118.55 664.53,-106.18 677.69,-94.17"/>
<polygon fill="black" stroke="black" points="680.34,-96.49 685.37,-87.17 675.63,-91.32 680.34,-96.49"/>
</g>
<!-- A2A_Layer0 -->
<g id="node11" class="node">
<title>A2A_Layer0</title>
<ellipse fill="lightgray" stroke="black" cx="612" cy="-262.64" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="612" y="-282.14" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="612" y="-271.14" font-family="Arial" font-size="10.00">EP16 Dispatch</text>
<text text-anchor="middle" x="612" y="-260.14" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="612" y="-249.14" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="612" y="-238.14" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- A2A_Layer0&#45;&gt;Expert_L0_GPU0 -->
<g id="edge12" class="edge">
<title>A2A_Layer0&#45;&gt;Expert_L0_GPU0</title>
<path fill="none" stroke="black" d="M526.69,-225.25C515.02,-220.19 503.2,-215.04 492,-210.1 474.06,-202.17 454.67,-193.45 436.85,-185.36"/>
<polygon fill="black" stroke="black" points="438.25,-182.15 427.7,-181.2 435.35,-188.52 438.25,-182.15"/>
</g>
<!-- A2A_Layer0&#45;&gt;Expert_L0_GPU1 -->
<g id="edge13" class="edge">
<title>A2A_Layer0&#45;&gt;Expert_L0_GPU1</title>
<path fill="none" stroke="black" d="M696.57,-225.18C708.15,-220.14 719.88,-215.01 731,-210.1 749.06,-202.12 768.61,-193.37 786.58,-185.29"/>
<polygon fill="black" stroke="black" points="788.13,-188.42 795.81,-181.13 785.26,-182.04 788.13,-188.42"/>
</g>
<!-- A2A_Layer0&#45;&gt;Expert_L0_GPU15 -->
<g id="edge14" class="edge">
<title>A2A_Layer0&#45;&gt;Expert_L0_GPU15</title>
<path fill="none" stroke="black" d="M612,-217.8C612,-209.04 612,-199.94 612,-191.5"/>
<polygon fill="black" stroke="black" points="615.5,-191.25 612,-181.25 608.5,-191.25 615.5,-191.25"/>
</g>
<!-- Routing_L0&#45;&gt;A2A_Layer0 -->
<g id="edge11" class="edge">
<title>Routing_L0&#45;&gt;A2A_Layer0</title>
<path fill="none" stroke="black" d="M612,-343.11C612,-334.55 612,-325.82 612,-317.43"/>
<polygon fill="black" stroke="black" points="615.5,-317.4 612,-307.4 608.5,-317.4 615.5,-317.4"/>
</g>
<!-- Layer4_TP0 -->
<g id="node13" class="node">
<title>Layer4_TP0</title>
<polygon fill="white" stroke="black" points="1938.5,-708.19 1717.5,-708.19 1717.5,-645.19 1938.5,-645.19 1938.5,-708.19"/>
<text text-anchor="middle" x="1828" y="-696.19" font-family="Arial" font-size="10.00">Layer 4 TP0</text>
<text text-anchor="middle" x="1828" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1828" y="-674.19" font-family="Arial" font-size="10.00">GPU: 256&#45;319</text>
<text text-anchor="middle" x="1828" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1828" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- PP_Comm1 -->
<g id="node26" class="node">
<title>PP_Comm1</title>
<ellipse fill="lightgray" stroke="black" cx="4040" cy="-557.19" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="4040" y="-576.69" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="4040" y="-565.69" font-family="Arial" font-size="10.00">Stage 1→2</text>
<text text-anchor="middle" x="4040" y="-554.69" font-family="Arial" font-size="10.00">GPU: 511→512</text>
<text text-anchor="middle" x="4040" y="-543.69" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="4040" y="-532.69" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer4_TP0&#45;&gt;PP_Comm1 -->
<g id="edge19" class="edge">
<title>Layer4_TP0&#45;&gt;PP_Comm1</title>
<path fill="none" stroke="black" d="M1914.93,-645.16C1926.6,-641.98 1938.51,-639.18 1950,-637.19 2318.3,-573.31 3446.06,-561.08 3873.45,-558.74"/>
<polygon fill="black" stroke="black" points="3873.74,-562.24 3883.72,-558.69 3873.71,-555.24 3873.74,-562.24"/>
</g>
<!-- Layer4_TP1 -->
<g id="node14" class="node">
<title>Layer4_TP1</title>
<polygon fill="white" stroke="black" points="1460.5,-708.19 1239.5,-708.19 1239.5,-645.19 1460.5,-645.19 1460.5,-708.19"/>
<text text-anchor="middle" x="1350" y="-696.19" font-family="Arial" font-size="10.00">Layer 4 TP1</text>
<text text-anchor="middle" x="1350" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1350" y="-674.19" font-family="Arial" font-size="10.00">GPU: 320&#45;383</text>
<text text-anchor="middle" x="1350" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1350" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer4_TP1&#45;&gt;PP_Comm1 -->
<g id="edge20" class="edge">
<title>Layer4_TP1&#45;&gt;PP_Comm1</title>
<path fill="none" stroke="black" d="M1434.42,-645.17C1445.92,-641.96 1457.66,-639.16 1469,-637.19 1704.34,-596.36 3342,-568.6 3873.7,-560.58"/>
<polygon fill="black" stroke="black" points="3873.81,-564.08 3883.76,-560.43 3873.71,-557.08 3873.81,-564.08"/>
</g>
<!-- Layer4_TP2 -->
<g id="node15" class="node">
<title>Layer4_TP2</title>
<polygon fill="white" stroke="black" points="1221.5,-708.19 1000.5,-708.19 1000.5,-645.19 1221.5,-645.19 1221.5,-708.19"/>
<text text-anchor="middle" x="1111" y="-696.19" font-family="Arial" font-size="10.00">Layer 4 TP2</text>
<text text-anchor="middle" x="1111" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1111" y="-674.19" font-family="Arial" font-size="10.00">GPU: 384&#45;447</text>
<text text-anchor="middle" x="1111" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1111" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer4_TP2&#45;&gt;PP_Comm1 -->
<g id="edge21" class="edge">
<title>Layer4_TP2&#45;&gt;PP_Comm1</title>
<path fill="none" stroke="black" d="M1195.42,-645.14C1206.91,-641.94 1218.66,-639.14 1230,-637.19 1489.55,-592.5 3309.31,-567.01 3873.57,-560.11"/>
<polygon fill="black" stroke="black" points="3873.87,-563.61 3883.82,-559.99 3873.78,-556.61 3873.87,-563.61"/>
</g>
<!-- Layer4_TP3 -->
<g id="node16" class="node">
<title>Layer4_TP3</title>
<polygon fill="white" stroke="black" points="1699.5,-708.19 1478.5,-708.19 1478.5,-645.19 1699.5,-645.19 1699.5,-708.19"/>
<text text-anchor="middle" x="1589" y="-696.19" font-family="Arial" font-size="10.00">Layer 4 TP3</text>
<text text-anchor="middle" x="1589" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="1589" y="-674.19" font-family="Arial" font-size="10.00">GPU: 448&#45;511</text>
<text text-anchor="middle" x="1589" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="1589" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer4_TP3&#45;&gt;PP_Comm1 -->
<g id="edge22" class="edge">
<title>Layer4_TP3&#45;&gt;PP_Comm1</title>
<path fill="none" stroke="black" d="M1673.75,-645.11C1685.14,-641.94 1696.77,-639.16 1708,-637.19 2124.4,-564.26 3411.85,-557.74 3873.3,-557.82"/>
<polygon fill="black" stroke="black" points="3873.37,-561.32 3883.38,-557.82 3873.38,-554.32 3873.37,-561.32"/>
</g>
<!-- Layer8_TP0 -->
<g id="node17" class="node">
<title>Layer8_TP0</title>
<polygon fill="white" stroke="black" points="2182.5,-708.19 1961.5,-708.19 1961.5,-645.19 2182.5,-645.19 2182.5,-708.19"/>
<text text-anchor="middle" x="2072" y="-696.19" font-family="Arial" font-size="10.00">Layer 8 TP0</text>
<text text-anchor="middle" x="2072" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2072" y="-674.19" font-family="Arial" font-size="10.00">GPU: 512&#45;575</text>
<text text-anchor="middle" x="2072" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2072" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- PP_Comm2 -->
<g id="node27" class="node">
<title>PP_Comm2</title>
<ellipse fill="lightgray" stroke="black" cx="4408" cy="-557.19" rx="156.04" ry="44.6"/>
<text text-anchor="middle" x="4408" y="-576.69" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="4408" y="-565.69" font-family="Arial" font-size="10.00">Stage 2→3</text>
<text text-anchor="middle" x="4408" y="-554.69" font-family="Arial" font-size="10.00">GPU: 767→768</text>
<text text-anchor="middle" x="4408" y="-543.69" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="4408" y="-532.69" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP0&#45;&gt;PP_Comm2 -->
<g id="edge24" class="edge">
<title>Layer8_TP0&#45;&gt;PP_Comm2</title>
<path fill="none" stroke="black" d="M2155.74,-645.17C2167.45,-641.91 2179.43,-639.1 2191,-637.19 2639.88,-563.24 3788.35,-678.33 4238,-609.19 4258.77,-606 4280.54,-600.89 4301.3,-595.1"/>
<polygon fill="black" stroke="black" points="4302.43,-598.42 4311.08,-592.31 4300.5,-591.69 4302.43,-598.42"/>
</g>
<!-- Layer8_TP1 -->
<g id="node18" class="node">
<title>Layer8_TP1</title>
<polygon fill="white" stroke="black" points="2421.5,-708.19 2200.5,-708.19 2200.5,-645.19 2421.5,-645.19 2421.5,-708.19"/>
<text text-anchor="middle" x="2311" y="-696.19" font-family="Arial" font-size="10.00">Layer 8 TP1</text>
<text text-anchor="middle" x="2311" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2311" y="-674.19" font-family="Arial" font-size="10.00">GPU: 576&#45;639</text>
<text text-anchor="middle" x="2311" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2311" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP1&#45;&gt;PP_Comm2 -->
<g id="edge25" class="edge">
<title>Layer8_TP1&#45;&gt;PP_Comm2</title>
<path fill="none" stroke="black" d="M2394.74,-645.19C2406.45,-641.93 2418.43,-639.11 2430,-637.19 2826.42,-571.51 3840.9,-670.62 4238,-609.19 4258.77,-605.98 4280.53,-600.86 4301.3,-595.07"/>
<polygon fill="black" stroke="black" points="4302.42,-598.39 4311.08,-592.28 4300.5,-591.66 4302.42,-598.39"/>
</g>
<!-- Layer8_TP2 -->
<g id="node19" class="node">
<title>Layer8_TP2</title>
<polygon fill="white" stroke="black" points="2899.5,-708.19 2678.5,-708.19 2678.5,-645.19 2899.5,-645.19 2899.5,-708.19"/>
<text text-anchor="middle" x="2789" y="-696.19" font-family="Arial" font-size="10.00">Layer 8 TP2</text>
<text text-anchor="middle" x="2789" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2789" y="-674.19" font-family="Arial" font-size="10.00">GPU: 640&#45;703</text>
<text text-anchor="middle" x="2789" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2789" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP2&#45;&gt;PP_Comm2 -->
<g id="edge26" class="edge">
<title>Layer8_TP2&#45;&gt;PP_Comm2</title>
<path fill="none" stroke="black" d="M2875.23,-645.16C2887.12,-641.93 2899.28,-639.12 2911,-637.19 3202.03,-589.21 3946.64,-655.1 4238,-609.19 4258.76,-605.92 4280.52,-600.77 4301.28,-594.98"/>
<polygon fill="black" stroke="black" points="4302.41,-598.3 4311.06,-592.18 4300.48,-591.57 4302.41,-598.3"/>
</g>
<!-- Layer8_TP3 -->
<g id="node20" class="node">
<title>Layer8_TP3</title>
<polygon fill="white" stroke="black" points="2660.5,-708.19 2439.5,-708.19 2439.5,-645.19 2660.5,-645.19 2660.5,-708.19"/>
<text text-anchor="middle" x="2550" y="-696.19" font-family="Arial" font-size="10.00">Layer 8 TP3</text>
<text text-anchor="middle" x="2550" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="2550" y="-674.19" font-family="Arial" font-size="10.00">GPU: 704&#45;767</text>
<text text-anchor="middle" x="2550" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="2550" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer8_TP3&#45;&gt;PP_Comm2 -->
<g id="edge27" class="edge">
<title>Layer8_TP3&#45;&gt;PP_Comm2</title>
<path fill="none" stroke="black" d="M2634.07,-645.12C2645.67,-641.9 2657.54,-639.1 2669,-637.19 3012.96,-579.78 3893.44,-662.91 4238,-609.19 4258.76,-605.95 4280.53,-600.82 4301.29,-595.03"/>
<polygon fill="black" stroke="black" points="4302.42,-598.35 4311.07,-592.24 4300.49,-591.62 4302.42,-598.35"/>
</g>
<!-- Layer12_TP0 -->
<g id="node21" class="node">
<title>Layer12_TP0</title>
<polygon fill="white" stroke="black" points="3143.5,-708.19 2922.5,-708.19 2922.5,-645.19 3143.5,-645.19 3143.5,-708.19"/>
<text text-anchor="middle" x="3033" y="-696.19" font-family="Arial" font-size="10.00">Layer 12 TP0</text>
<text text-anchor="middle" x="3033" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3033" y="-674.19" font-family="Arial" font-size="10.00">GPU: 768&#45;831</text>
<text text-anchor="middle" x="3033" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3033" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Aggregate -->
<g id="node28" class="node">
<title>DP_Aggregate</title>
<polygon fill="lightgreen" stroke="black" points="5053.19,-609.19 4679.06,-609.19 4582.81,-505.19 4956.94,-505.19 5053.19,-609.19"/>
<text text-anchor="middle" x="4818" y="-571.19" font-family="Arial" font-size="10.00">DP Aggregate</text>
<text text-anchor="middle" x="4818" y="-560.19" font-family="Arial" font-size="10.00">4&#45;way reduction</text>
<text text-anchor="middle" x="4818" y="-549.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="4818" y="-538.19" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=?, dim=1024]</text>
</g>
<!-- Layer12_TP0&#45;&gt;DP_Aggregate -->
<g id="edge29" class="edge">
<title>Layer12_TP0&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M3117.07,-645.14C3128.68,-641.91 3140.54,-639.11 3152,-637.19 3463.48,-584.91 4259.16,-644.64 4573,-609.19 4599.72,-606.17 4627.85,-601.63 4655.13,-596.48"/>
<polygon fill="black" stroke="black" points="4655.98,-599.88 4665.14,-594.56 4654.66,-593.01 4655.98,-599.88"/>
</g>
<!-- Layer12_TP1 -->
<g id="node22" class="node">
<title>Layer12_TP1</title>
<polygon fill="white" stroke="black" points="3382.5,-708.19 3161.5,-708.19 3161.5,-645.19 3382.5,-645.19 3382.5,-708.19"/>
<text text-anchor="middle" x="3272" y="-696.19" font-family="Arial" font-size="10.00">Layer 12 TP1</text>
<text text-anchor="middle" x="3272" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3272" y="-674.19" font-family="Arial" font-size="10.00">GPU: 832&#45;895</text>
<text text-anchor="middle" x="3272" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3272" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer12_TP1&#45;&gt;DP_Aggregate -->
<g id="edge30" class="edge">
<title>Layer12_TP1&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M3356.08,-645.19C3367.68,-641.95 3379.55,-639.14 3391,-637.19 3650.03,-593.18 4311.98,-639.2 4573,-609.19 4599.72,-606.12 4627.84,-601.55 4655.12,-596.39"/>
<polygon fill="black" stroke="black" points="4655.97,-599.79 4665.13,-594.46 4654.65,-592.92 4655.97,-599.79"/>
</g>
<!-- Layer12_TP2 -->
<g id="node23" class="node">
<title>Layer12_TP2</title>
<polygon fill="white" stroke="black" points="3860.5,-708.19 3639.5,-708.19 3639.5,-645.19 3860.5,-645.19 3860.5,-708.19"/>
<text text-anchor="middle" x="3750" y="-696.19" font-family="Arial" font-size="10.00">Layer 12 TP2</text>
<text text-anchor="middle" x="3750" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3750" y="-674.19" font-family="Arial" font-size="10.00">GPU: 896&#45;959</text>
<text text-anchor="middle" x="3750" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3750" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer12_TP2&#45;&gt;DP_Aggregate -->
<g id="edge31" class="edge">
<title>Layer12_TP2&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M3860.64,-671.13C4019.11,-663.61 4319.56,-645.66 4573,-609.19 4599.33,-605.4 4627.08,-600.51 4654.07,-595.25"/>
<polygon fill="black" stroke="black" points="4654.84,-598.67 4663.97,-593.3 4653.48,-591.8 4654.84,-598.67"/>
</g>
<!-- Layer12_TP3 -->
<g id="node24" class="node">
<title>Layer12_TP3</title>
<polygon fill="white" stroke="black" points="3621.5,-708.19 3400.5,-708.19 3400.5,-645.19 3621.5,-645.19 3621.5,-708.19"/>
<text text-anchor="middle" x="3511" y="-696.19" font-family="Arial" font-size="10.00">Layer 12 TP3</text>
<text text-anchor="middle" x="3511" y="-685.19" font-family="Arial" font-size="10.00">Attention (QKV)</text>
<text text-anchor="middle" x="3511" y="-674.19" font-family="Arial" font-size="10.00">GPU: 960&#45;1023</text>
<text text-anchor="middle" x="3511" y="-663.19" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="3511" y="-652.19" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=?, dim=1024]</text>
</g>
<!-- Layer12_TP3&#45;&gt;DP_Aggregate -->
<g id="edge32" class="edge">
<title>Layer12_TP3&#45;&gt;DP_Aggregate</title>
<path fill="none" stroke="black" d="M3595.42,-645.16C3606.91,-641.95 3618.66,-639.15 3630,-637.19 3836.58,-601.46 4364.8,-633.76 4573,-609.19 4599.71,-606.04 4627.82,-601.43 4655.1,-596.25"/>
<polygon fill="black" stroke="black" points="4655.96,-599.65 4665.11,-594.32 4654.63,-592.78 4655.96,-599.65"/>
</g>
<!-- PP_Comm0&#45;&gt;Layer4_TP0 -->
<g id="edge18" class="edge">
<title>PP_Comm0&#45;&gt;Layer4_TP0</title>
<path fill="none" stroke="black" d="M887.3,-46.92C1566.06,-53.9 4224,-92.04 4224,-261.64 4224,-407.19 4224,-407.19 4224,-407.19 4224,-497.36 4271.3,-548.07 4205,-609.19 4158.94,-651.65 2011.85,-627.27 1950,-637.19 1941.4,-638.57 1932.56,-640.43 1923.78,-642.6"/>
<polygon fill="black" stroke="black" points="1922.69,-639.26 1913.89,-645.16 1924.44,-646.04 1922.69,-639.26"/>
</g>
<!-- PP_Comm1&#45;&gt;Layer8_TP0 -->
<g id="edge23" class="edge">
<title>PP_Comm1&#45;&gt;Layer8_TP0</title>
<path fill="none" stroke="black" d="M3883.82,-559.45C3499.18,-563.43 2514.05,-579.14 2191,-637.19 2183.1,-638.61 2175,-640.42 2166.92,-642.49"/>
<polygon fill="black" stroke="black" points="2165.85,-639.15 2157.09,-645.12 2167.66,-645.91 2165.85,-639.15"/>
</g>
<!-- PP_Comm2&#45;&gt;Layer12_TP0 -->
<g id="edge28" class="edge">
<title>PP_Comm2&#45;&gt;Layer12_TP0</title>
<path fill="none" stroke="black" d="M4310.6,-592.24C4287.11,-599.1 4261.88,-605.37 4238,-609.19 3999.62,-647.32 3389.96,-596.51 3152,-637.19 3143.85,-638.58 3135.48,-640.42 3127.16,-642.52"/>
<polygon fill="black" stroke="black" points="3126.18,-639.16 3117.41,-645.12 3127.97,-645.93 3126.18,-639.16"/>
</g>
<!-- Output -->
<g id="node29" class="node">
<title>Output</title>
<ellipse fill="lightblue" stroke="black" cx="4818" cy="-406.19" rx="160.53" ry="28.98"/>
<text text-anchor="middle" x="4818" y="-414.69" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="4818" y="-403.69" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=?, dim=1024]</text>
<text text-anchor="middle" x="4818" y="-392.69" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=?, dim=1024]</text>
</g>
<!-- DP_Aggregate&#45;&gt;Output -->
<g id="edge33" class="edge">
<title>DP_Aggregate&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M4818,-504.91C4818,-485.49 4818,-463.73 4818,-445.68"/>
<polygon fill="black" stroke="black" points="4821.5,-445.53 4818,-435.53 4814.5,-445.53 4821.5,-445.53"/>
</g>
</g>
</svg>
