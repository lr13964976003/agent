<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="1748pt"
 viewBox="0.00 0.00 1440.00 1747.75" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.09 0.09) rotate(0) translate(4 20507.66)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-20507.66 16895.88,-20507.66 16895.88,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="11130.44" cy="-20455.58" rx="307.68" ry="48.17"/>
<text text-anchor="middle" x="11130.44" y="-20474.38" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="11130.44" y="-20459.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11130.44" y="-20444.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11130.44" y="-20429.38" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router -->
<g id="node2" class="node">
<title>router</title>
<polygon fill="lightgray" stroke="black" points="11620.71,-20370.5 10840.8,-20370.5 10640.17,-20234.5 11420.08,-20234.5 11620.71,-20370.5"/>
<text text-anchor="middle" x="11130.44" y="-20321.3" font-family="Times,serif" font-size="14.00">Token Router</text>
<text text-anchor="middle" x="11130.44" y="-20306.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11130.44" y="-20291.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="11130.44" y="-20276.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- input&#45;&gt;router -->
<g id="edge1" class="edge">
<title>input&#45;&gt;router</title>
<path fill="none" stroke="black" d="M11130.44,-20407.19C11130.44,-20398.76 11130.44,-20389.79 11130.44,-20380.79"/>
<polygon fill="black" stroke="black" points="11133.94,-20380.64 11130.44,-20370.64 11126.94,-20380.64 11133.94,-20380.64"/>
</g>
<!-- ln1_l0 -->
<g id="node3" class="node">
<title>ln1_l0</title>
<polygon fill="lightyellow" stroke="black" points="10517.94,-20197.5 10082.94,-20197.5 10082.94,-20129.5 10517.94,-20129.5 10517.94,-20197.5"/>
<text text-anchor="middle" x="10300.44" y="-20182.3" font-family="Times,serif" font-size="14.00">LayerNorm L0</text>
<text text-anchor="middle" x="10300.44" y="-20167.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="10300.44" y="-20152.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="10300.44" y="-20137.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l0 -->
<g id="edge3" class="edge">
<title>router&#45;&gt;ln1_l0</title>
<path fill="none" stroke="black" d="M10640.45,-20234.7C10604.53,-20228.86 10568.89,-20222.77 10534.44,-20216.5 10507.25,-20211.54 10478.41,-20205.66 10450.62,-20199.66"/>
<polygon fill="black" stroke="black" points="10451.35,-20196.24 10440.84,-20197.54 10449.87,-20203.08 10451.35,-20196.24"/>
</g>
<!-- route_l0 -->
<g id="node7" class="node">
<title>route_l0</title>
<polygon fill="lightgray" stroke="black" points="6650.96,-19777.5 5899.29,-19777.5 5705.92,-19641.5 6457.59,-19641.5 6650.96,-19777.5"/>
<text text-anchor="middle" x="6178.44" y="-19728.3" font-family="Times,serif" font-size="14.00">Expert Routing L0</text>
<text text-anchor="middle" x="6178.44" y="-19713.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6178.44" y="-19698.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6178.44" y="-19683.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l0 -->
<g id="edge2" class="edge">
<title>router&#45;&gt;route_l0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10661.69,-20249.13C10594.96,-20229.33 10548.44,-20202.06 10548.44,-20164.5 10548.44,-20164.5 10548.44,-20164.5 10548.44,-19847.5 10548.44,-19748.44 7641.21,-19719.83 6569.26,-19712.65"/>
<polygon fill="black" stroke="black" points="6569.1,-19709.15 6559.08,-19712.58 6569.06,-19716.15 6569.1,-19709.15"/>
</g>
<!-- ln1_l1 -->
<g id="node58" class="node">
<title>ln1_l1</title>
<polygon fill="lightyellow" stroke="black" points="5919.94,-18941.16 5484.94,-18941.16 5484.94,-18873.16 5919.94,-18873.16 5919.94,-18941.16"/>
<text text-anchor="middle" x="5702.44" y="-18925.96" font-family="Times,serif" font-size="14.00">LayerNorm L1</text>
<text text-anchor="middle" x="5702.44" y="-18910.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18895.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18880.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l1 -->
<g id="edge75" class="edge">
<title>router&#45;&gt;ln1_l1</title>
<path fill="none" stroke="black" d="M10674.55,-20234.46C10661.06,-20228.91 10649.81,-20222.93 10641.44,-20216.5 10621.26,-20200.98 10617.44,-20189.95 10617.44,-20164.5 10617.44,-20164.5 10617.44,-20164.5 10617.44,-19011.16 10617.44,-18951.76 6897.65,-18917.76 5930.18,-18909.92"/>
<polygon fill="black" stroke="black" points="5930,-18906.42 5919.97,-18909.84 5929.95,-18913.42 5930,-18906.42"/>
</g>
<!-- route_l1 -->
<g id="node62" class="node">
<title>route_l1</title>
<polygon fill="lightgray" stroke="black" points="6174.96,-18521.16 5423.29,-18521.16 5229.92,-18385.16 5981.59,-18385.16 6174.96,-18521.16"/>
<text text-anchor="middle" x="5702.44" y="-18471.96" font-family="Times,serif" font-size="14.00">Expert Routing L1</text>
<text text-anchor="middle" x="5702.44" y="-18456.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18441.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18426.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l1 -->
<g id="edge74" class="edge">
<title>router&#45;&gt;route_l1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10712.23,-20234.37C10698.77,-20228.82 10687.61,-20222.87 10679.44,-20216.5 10659.37,-20200.84 10655.44,-20189.95 10655.44,-20164.5 10655.44,-20164.5 10655.44,-20164.5 10655.44,-18591.16 10655.44,-18477.18 7258.65,-18458.03 6091.06,-18454.81"/>
<polygon fill="black" stroke="black" points="6090.84,-18451.31 6080.83,-18454.78 6090.82,-18458.31 6090.84,-18451.31"/>
</g>
<!-- ln1_l2 -->
<g id="node113" class="node">
<title>ln1_l2</title>
<polygon fill="lightyellow" stroke="black" points="5995.94,-17684.83 5560.94,-17684.83 5560.94,-17616.83 5995.94,-17616.83 5995.94,-17684.83"/>
<text text-anchor="middle" x="5778.44" y="-17669.63" font-family="Times,serif" font-size="14.00">LayerNorm L2</text>
<text text-anchor="middle" x="5778.44" y="-17654.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17639.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17624.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l2 -->
<g id="edge147" class="edge">
<title>router&#45;&gt;ln1_l2</title>
<path fill="none" stroke="black" d="M10750.29,-20234.48C10736.68,-20228.86 10725.47,-20222.86 10717.44,-20216.5 10697.5,-20200.68 10693.44,-20189.95 10693.44,-20164.5 10693.44,-20164.5 10693.44,-20164.5 10693.44,-17754.83 10693.44,-17695.43 6973.65,-17661.43 6006.18,-17653.59"/>
<polygon fill="black" stroke="black" points="6006,-17650.09 5995.97,-17653.51 6005.95,-17657.09 6006,-17650.09"/>
</g>
<!-- route_l2 -->
<g id="node117" class="node">
<title>route_l2</title>
<polygon fill="lightgray" stroke="black" points="6250.96,-17264.83 5499.29,-17264.83 5305.92,-17128.83 6057.59,-17128.83 6250.96,-17264.83"/>
<text text-anchor="middle" x="5778.44" y="-17215.63" font-family="Times,serif" font-size="14.00">Expert Routing L2</text>
<text text-anchor="middle" x="5778.44" y="-17200.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17185.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17170.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l2 -->
<g id="edge146" class="edge">
<title>router&#45;&gt;route_l2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10787.88,-20234.46C10774.33,-20228.79 10763.22,-20222.8 10755.44,-20216.5 10735.66,-20200.48 10731.44,-20189.95 10731.44,-20164.5 10731.44,-20164.5 10731.44,-20164.5 10731.44,-17334.83 10731.44,-17220.85 7334.65,-17201.69 6167.06,-17198.48"/>
<polygon fill="black" stroke="black" points="6166.84,-17194.98 6156.83,-17198.45 6166.82,-17201.98 6166.84,-17194.98"/>
</g>
<!-- ln1_l3 -->
<g id="node168" class="node">
<title>ln1_l3</title>
<polygon fill="lightyellow" stroke="black" points="6071.94,-16428.5 5636.94,-16428.5 5636.94,-16360.5 6071.94,-16360.5 6071.94,-16428.5"/>
<text text-anchor="middle" x="5854.44" y="-16413.3" font-family="Times,serif" font-size="14.00">LayerNorm L3</text>
<text text-anchor="middle" x="5854.44" y="-16398.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16383.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16368.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l3 -->
<g id="edge219" class="edge">
<title>router&#45;&gt;ln1_l3</title>
<path fill="none" stroke="black" d="M10817.96,-20234.45C10809.42,-20228.92 10801.22,-20222.95 10793.44,-20216.5 10773.85,-20200.24 10769.44,-20189.95 10769.44,-20164.5 10769.44,-20164.5 10769.44,-20164.5 10769.44,-16498.5 10769.44,-16439.1 7049.65,-16405.09 6082.18,-16397.26"/>
<polygon fill="black" stroke="black" points="6082,-16393.75 6071.97,-16397.17 6081.95,-16400.75 6082,-16393.75"/>
</g>
<!-- route_l3 -->
<g id="node172" class="node">
<title>route_l3</title>
<polygon fill="lightgray" stroke="black" points="6326.96,-16008.5 5575.29,-16008.5 5381.92,-15872.5 6133.59,-15872.5 6326.96,-16008.5"/>
<text text-anchor="middle" x="5854.44" y="-15959.3" font-family="Times,serif" font-size="14.00">Expert Routing L3</text>
<text text-anchor="middle" x="5854.44" y="-15944.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15929.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15914.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l3 -->
<g id="edge218" class="edge">
<title>router&#45;&gt;route_l3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10836.67,-20234.47C10818.56,-20216.34 10807.44,-20193.43 10807.44,-20164.5 10807.44,-20164.5 10807.44,-20164.5 10807.44,-16078.5 10807.44,-15964.52 7410.65,-15945.36 6243.06,-15942.14"/>
<polygon fill="black" stroke="black" points="6242.84,-15938.64 6232.83,-15942.12 6242.82,-15945.64 6242.84,-15938.64"/>
</g>
<!-- ln1_l4 -->
<g id="node223" class="node">
<title>ln1_l4</title>
<polygon fill="lightyellow" stroke="black" points="6147.94,-15172.16 5712.94,-15172.16 5712.94,-15104.16 6147.94,-15104.16 6147.94,-15172.16"/>
<text text-anchor="middle" x="5930.44" y="-15156.96" font-family="Times,serif" font-size="14.00">LayerNorm L4</text>
<text text-anchor="middle" x="5930.44" y="-15141.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-15126.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-15111.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l4 -->
<g id="edge291" class="edge">
<title>router&#45;&gt;ln1_l4</title>
<path fill="none" stroke="black" d="M10876.76,-20234.31C10857.54,-20216.3 10845.44,-20193.45 10845.44,-20164.5 10845.44,-20164.5 10845.44,-20164.5 10845.44,-15242.16 10845.44,-15182.76 7125.65,-15148.76 6158.18,-15140.92"/>
<polygon fill="black" stroke="black" points="6158,-15137.42 6147.97,-15140.84 6157.95,-15144.42 6158,-15137.42"/>
</g>
<!-- route_l4 -->
<g id="node227" class="node">
<title>route_l4</title>
<polygon fill="lightgray" stroke="black" points="6402.96,-14752.16 5651.29,-14752.16 5457.92,-14616.16 6209.59,-14616.16 6402.96,-14752.16"/>
<text text-anchor="middle" x="5930.44" y="-14702.96" font-family="Times,serif" font-size="14.00">Expert Routing L4</text>
<text text-anchor="middle" x="5930.44" y="-14687.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14672.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14657.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l4 -->
<g id="edge290" class="edge">
<title>router&#45;&gt;route_l4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10916.75,-20234.37C10896.56,-20216.3 10883.44,-20193.43 10883.44,-20164.5 10883.44,-20164.5 10883.44,-20164.5 10883.44,-14822.16 10883.44,-14708.18 7486.65,-14689.03 6319.06,-14685.81"/>
<polygon fill="black" stroke="black" points="6318.84,-14682.31 6308.83,-14685.78 6318.82,-14689.31 6318.84,-14682.31"/>
</g>
<!-- ln1_l5 -->
<g id="node278" class="node">
<title>ln1_l5</title>
<polygon fill="lightyellow" stroke="black" points="6223.94,-13915.83 5788.94,-13915.83 5788.94,-13847.83 6223.94,-13847.83 6223.94,-13915.83"/>
<text text-anchor="middle" x="6006.44" y="-13900.63" font-family="Times,serif" font-size="14.00">LayerNorm L5</text>
<text text-anchor="middle" x="6006.44" y="-13885.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13870.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13855.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l5 -->
<g id="edge363" class="edge">
<title>router&#45;&gt;ln1_l5</title>
<path fill="none" stroke="black" d="M10955.95,-20234.44C10935.33,-20216.11 10921.44,-20193.13 10921.44,-20164.5 10921.44,-20164.5 10921.44,-20164.5 10921.44,-13985.83 10921.44,-13926.43 7201.65,-13892.43 6234.18,-13884.59"/>
<polygon fill="black" stroke="black" points="6234,-13881.09 6223.97,-13884.51 6233.95,-13888.09 6234,-13881.09"/>
</g>
<!-- route_l5 -->
<g id="node282" class="node">
<title>route_l5</title>
<polygon fill="lightgray" stroke="black" points="6478.96,-13495.83 5727.29,-13495.83 5533.92,-13359.83 6285.59,-13359.83 6478.96,-13495.83"/>
<text text-anchor="middle" x="6006.44" y="-13446.63" font-family="Times,serif" font-size="14.00">Expert Routing L5</text>
<text text-anchor="middle" x="6006.44" y="-13431.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13416.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13401.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l5 -->
<g id="edge362" class="edge">
<title>router&#45;&gt;route_l5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10993.22,-20234.13C10973.35,-20215.34 10959.44,-20192.26 10959.44,-20164.5 10959.44,-20164.5 10959.44,-20164.5 10959.44,-13565.83 10959.44,-13451.85 7562.65,-13432.7 6395.06,-13429.48"/>
<polygon fill="black" stroke="black" points="6394.84,-13425.98 6384.83,-13429.45 6394.82,-13432.98 6394.84,-13425.98"/>
</g>
<!-- ln1_l6 -->
<g id="node333" class="node">
<title>ln1_l6</title>
<polygon fill="lightyellow" stroke="black" points="6299.94,-12659.5 5864.94,-12659.5 5864.94,-12591.5 6299.94,-12591.5 6299.94,-12659.5"/>
<text text-anchor="middle" x="6082.44" y="-12644.3" font-family="Times,serif" font-size="14.00">LayerNorm L6</text>
<text text-anchor="middle" x="6082.44" y="-12629.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12614.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12599.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l6 -->
<g id="edge435" class="edge">
<title>router&#45;&gt;ln1_l6</title>
<path fill="none" stroke="black" d="M11028.62,-20234.24C11010.59,-20214.63 10997.44,-20191.18 10997.44,-20164.5 10997.44,-20164.5 10997.44,-20164.5 10997.44,-12729.5 10997.44,-12670.1 7277.65,-12636.1 6310.18,-12628.26"/>
<polygon fill="black" stroke="black" points="6310,-12624.75 6299.97,-12628.17 6309.95,-12631.75 6310,-12624.75"/>
</g>
<!-- route_l6 -->
<g id="node337" class="node">
<title>route_l6</title>
<polygon fill="lightgray" stroke="black" points="6554.96,-12239.5 5803.29,-12239.5 5609.92,-12103.5 6361.59,-12103.5 6554.96,-12239.5"/>
<text text-anchor="middle" x="6082.44" y="-12190.3" font-family="Times,serif" font-size="14.00">Expert Routing L6</text>
<text text-anchor="middle" x="6082.44" y="-12175.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12160.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12145.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l6 -->
<g id="edge434" class="edge">
<title>router&#45;&gt;route_l6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11061.15,-20234.49C11046.54,-20213.84 11035.44,-20189.82 11035.44,-20164.5 11035.44,-20164.5 11035.44,-20164.5 11035.44,-12309.5 11035.44,-12195.52 7638.65,-12176.36 6471.06,-12173.15"/>
<polygon fill="black" stroke="black" points="6470.84,-12169.65 6460.83,-12173.12 6470.82,-12176.65 6470.84,-12169.65"/>
</g>
<!-- ln1_l7 -->
<g id="node388" class="node">
<title>ln1_l7</title>
<polygon fill="lightyellow" stroke="black" points="6375.94,-11403.16 5940.94,-11403.16 5940.94,-11335.16 6375.94,-11335.16 6375.94,-11403.16"/>
<text text-anchor="middle" x="6158.44" y="-11387.96" font-family="Times,serif" font-size="14.00">LayerNorm L7</text>
<text text-anchor="middle" x="6158.44" y="-11372.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11357.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11342.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l7 -->
<g id="edge507" class="edge">
<title>router&#45;&gt;ln1_l7</title>
<path fill="none" stroke="black" d="M11090.39,-20234.39C11080.88,-20212.82 11073.44,-20188.32 11073.44,-20164.5 11073.44,-20164.5 11073.44,-20164.5 11073.44,-11473.16 11073.44,-11413.76 7353.65,-11379.76 6386.18,-11371.92"/>
<polygon fill="black" stroke="black" points="6386,-11368.42 6375.97,-11371.84 6385.95,-11375.42 6386,-11368.42"/>
</g>
<!-- route_l7 -->
<g id="node392" class="node">
<title>route_l7</title>
<polygon fill="lightgray" stroke="black" points="6630.96,-10983.16 5879.29,-10983.16 5685.92,-10847.16 6437.59,-10847.16 6630.96,-10983.16"/>
<text text-anchor="middle" x="6158.44" y="-10933.96" font-family="Times,serif" font-size="14.00">Expert Routing L7</text>
<text text-anchor="middle" x="6158.44" y="-10918.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10903.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10888.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l7 -->
<g id="edge506" class="edge">
<title>router&#45;&gt;route_l7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11117.35,-20234.16C11114.06,-20212.05 11111.44,-20187.31 11111.44,-20164.5 11111.44,-20164.5 11111.44,-20164.5 11111.44,-11053.16 11111.44,-10939.18 7714.65,-10920.03 6547.06,-10916.81"/>
<polygon fill="black" stroke="black" points="6546.84,-10913.31 6536.83,-10916.78 6546.82,-10920.31 6546.84,-10913.31"/>
</g>
<!-- ln1_l8 -->
<g id="node443" class="node">
<title>ln1_l8</title>
<polygon fill="lightyellow" stroke="black" points="6451.94,-10146.83 6016.94,-10146.83 6016.94,-10078.83 6451.94,-10078.83 6451.94,-10146.83"/>
<text text-anchor="middle" x="6234.44" y="-10131.63" font-family="Times,serif" font-size="14.00">LayerNorm L8</text>
<text text-anchor="middle" x="6234.44" y="-10116.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-10101.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-10086.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l8 -->
<g id="edge579" class="edge">
<title>router&#45;&gt;ln1_l8</title>
<path fill="none" stroke="black" d="M11143.53,-20234.16C11146.82,-20212.05 11149.44,-20187.31 11149.44,-20164.5 11149.44,-20164.5 11149.44,-20164.5 11149.44,-10216.83 11149.44,-10157.43 7429.65,-10123.43 6462.18,-10115.59"/>
<polygon fill="black" stroke="black" points="6462,-10112.09 6451.97,-10115.51 6461.95,-10119.09 6462,-10112.09"/>
</g>
<!-- route_l8 -->
<g id="node447" class="node">
<title>route_l8</title>
<polygon fill="lightgray" stroke="black" points="6706.96,-9726.83 5955.29,-9726.83 5761.92,-9590.83 6513.59,-9590.83 6706.96,-9726.83"/>
<text text-anchor="middle" x="6234.44" y="-9677.63" font-family="Times,serif" font-size="14.00">Expert Routing L8</text>
<text text-anchor="middle" x="6234.44" y="-9662.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9647.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9632.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l8 -->
<g id="edge578" class="edge">
<title>router&#45;&gt;route_l8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11170.49,-20234.39C11180,-20212.82 11187.44,-20188.32 11187.44,-20164.5 11187.44,-20164.5 11187.44,-20164.5 11187.44,-9796.83 11187.44,-9682.85 7790.65,-9663.7 6623.06,-9660.48"/>
<polygon fill="black" stroke="black" points="6622.84,-9656.98 6612.83,-9660.45 6622.82,-9663.98 6622.84,-9656.98"/>
</g>
<!-- ln1_l9 -->
<g id="node498" class="node">
<title>ln1_l9</title>
<polygon fill="lightyellow" stroke="black" points="6527.94,-8890.5 6092.94,-8890.5 6092.94,-8822.5 6527.94,-8822.5 6527.94,-8890.5"/>
<text text-anchor="middle" x="6310.44" y="-8875.3" font-family="Times,serif" font-size="14.00">LayerNorm L9</text>
<text text-anchor="middle" x="6310.44" y="-8860.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8845.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8830.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l9 -->
<g id="edge651" class="edge">
<title>router&#45;&gt;ln1_l9</title>
<path fill="none" stroke="black" d="M11199.73,-20234.49C11214.34,-20213.84 11225.44,-20189.82 11225.44,-20164.5 11225.44,-20164.5 11225.44,-20164.5 11225.44,-8960.5 11225.44,-8901.1 7505.65,-8867.1 6538.18,-8859.26"/>
<polygon fill="black" stroke="black" points="6538,-8855.76 6527.97,-8859.17 6537.95,-8862.76 6538,-8855.76"/>
</g>
<!-- route_l9 -->
<g id="node502" class="node">
<title>route_l9</title>
<polygon fill="lightgray" stroke="black" points="6782.96,-8470.5 6031.29,-8470.5 5837.92,-8334.5 6589.59,-8334.5 6782.96,-8470.5"/>
<text text-anchor="middle" x="6310.44" y="-8421.3" font-family="Times,serif" font-size="14.00">Expert Routing L9</text>
<text text-anchor="middle" x="6310.44" y="-8406.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8391.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8376.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l9 -->
<g id="edge650" class="edge">
<title>router&#45;&gt;route_l9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11232.26,-20234.24C11250.29,-20214.63 11263.44,-20191.18 11263.44,-20164.5 11263.44,-20164.5 11263.44,-20164.5 11263.44,-8540.5 11263.44,-8426.52 7866.65,-8407.36 6699.06,-8404.15"/>
<polygon fill="black" stroke="black" points="6698.84,-8400.65 6688.83,-8404.12 6698.82,-8407.65 6698.84,-8400.65"/>
</g>
<!-- ln1_l10 -->
<g id="node553" class="node">
<title>ln1_l10</title>
<polygon fill="lightyellow" stroke="black" points="6603.94,-7634.16 6168.94,-7634.16 6168.94,-7566.16 6603.94,-7566.16 6603.94,-7634.16"/>
<text text-anchor="middle" x="6386.44" y="-7618.96" font-family="Times,serif" font-size="14.00">LayerNorm L10</text>
<text text-anchor="middle" x="6386.44" y="-7603.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7588.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7573.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l10 -->
<g id="edge723" class="edge">
<title>router&#45;&gt;ln1_l10</title>
<path fill="none" stroke="black" d="M11267.66,-20234.13C11287.54,-20215.34 11301.44,-20192.26 11301.44,-20164.5 11301.44,-20164.5 11301.44,-20164.5 11301.44,-7704.16 11301.44,-7644.77 7581.65,-7610.76 6614.18,-7602.92"/>
<polygon fill="black" stroke="black" points="6614,-7599.42 6603.97,-7602.84 6613.95,-7606.42 6614,-7599.42"/>
</g>
<!-- route_l10 -->
<g id="node557" class="node">
<title>route_l10</title>
<polygon fill="lightgray" stroke="black" points="6858.96,-7214.16 6107.29,-7214.16 5913.92,-7078.16 6665.59,-7078.16 6858.96,-7214.16"/>
<text text-anchor="middle" x="6386.44" y="-7164.96" font-family="Times,serif" font-size="14.00">Expert Routing L10</text>
<text text-anchor="middle" x="6386.44" y="-7149.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7134.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7119.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l10 -->
<g id="edge722" class="edge">
<title>router&#45;&gt;route_l10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11304.93,-20234.44C11325.55,-20216.11 11339.44,-20193.13 11339.44,-20164.5 11339.44,-20164.5 11339.44,-20164.5 11339.44,-7284.16 11339.44,-7170.18 7942.65,-7151.03 6775.06,-7147.81"/>
<polygon fill="black" stroke="black" points="6774.84,-7144.31 6764.83,-7147.79 6774.82,-7151.31 6774.84,-7144.31"/>
</g>
<!-- ln1_l11 -->
<g id="node608" class="node">
<title>ln1_l11</title>
<polygon fill="lightyellow" stroke="black" points="6679.94,-6377.83 6244.94,-6377.83 6244.94,-6309.83 6679.94,-6309.83 6679.94,-6377.83"/>
<text text-anchor="middle" x="6462.44" y="-6362.63" font-family="Times,serif" font-size="14.00">LayerNorm L11</text>
<text text-anchor="middle" x="6462.44" y="-6347.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6332.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6317.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l11 -->
<g id="edge795" class="edge">
<title>router&#45;&gt;ln1_l11</title>
<path fill="none" stroke="black" d="M11344.13,-20234.37C11364.32,-20216.3 11377.44,-20193.43 11377.44,-20164.5 11377.44,-20164.5 11377.44,-20164.5 11377.44,-6447.83 11377.44,-6388.43 7657.65,-6354.43 6690.18,-6346.59"/>
<polygon fill="black" stroke="black" points="6690,-6343.09 6679.97,-6346.51 6689.95,-6350.09 6690,-6343.09"/>
</g>
<!-- route_l11 -->
<g id="node612" class="node">
<title>route_l11</title>
<polygon fill="lightgray" stroke="black" points="6934.96,-5957.83 6183.29,-5957.83 5989.92,-5821.83 6741.59,-5821.83 6934.96,-5957.83"/>
<text text-anchor="middle" x="6462.44" y="-5908.63" font-family="Times,serif" font-size="14.00">Expert Routing L11</text>
<text text-anchor="middle" x="6462.44" y="-5893.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5878.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5863.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l11 -->
<g id="edge794" class="edge">
<title>router&#45;&gt;route_l11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11384.13,-20234.31C11403.34,-20216.3 11415.44,-20193.45 11415.44,-20164.5 11415.44,-20164.5 11415.44,-20164.5 11415.44,-6027.83 11415.44,-5913.85 8018.65,-5894.7 6851.06,-5891.48"/>
<polygon fill="black" stroke="black" points="6850.84,-5887.98 6840.83,-5891.45 6850.82,-5894.98 6850.84,-5887.98"/>
</g>
<!-- ln1_l12 -->
<g id="node663" class="node">
<title>ln1_l12</title>
<polygon fill="lightyellow" stroke="black" points="6755.94,-5121.5 6320.94,-5121.5 6320.94,-5053.5 6755.94,-5053.5 6755.94,-5121.5"/>
<text text-anchor="middle" x="6538.44" y="-5106.3" font-family="Times,serif" font-size="14.00">LayerNorm L12</text>
<text text-anchor="middle" x="6538.44" y="-5091.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-5076.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-5061.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l12 -->
<g id="edge867" class="edge">
<title>router&#45;&gt;ln1_l12</title>
<path fill="none" stroke="black" d="M11422.76,-20235.89C11441.73,-20217.54 11453.44,-20194.19 11453.44,-20164.5 11453.44,-20164.5 11453.44,-20164.5 11453.44,-5191.5 11453.44,-5132.1 7733.65,-5098.1 6766.18,-5090.26"/>
<polygon fill="black" stroke="black" points="6766,-5086.76 6755.97,-5090.18 6765.95,-5093.76 6766,-5086.76"/>
</g>
<!-- route_l12 -->
<g id="node667" class="node">
<title>route_l12</title>
<polygon fill="lightgray" stroke="black" points="7010.96,-4701.5 6259.29,-4701.5 6065.92,-4565.5 6817.59,-4565.5 7010.96,-4701.5"/>
<text text-anchor="middle" x="6538.44" y="-4652.3" font-family="Times,serif" font-size="14.00">Expert Routing L12</text>
<text text-anchor="middle" x="6538.44" y="-4637.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4622.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4607.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l12 -->
<g id="edge866" class="edge">
<title>router&#45;&gt;route_l12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11421.23,-20235.06C11432.04,-20229.37 11442.49,-20223.2 11452.44,-20216.5 11476.4,-20200.36 11491.44,-20193.38 11491.44,-20164.5 11491.44,-20164.5 11491.44,-20164.5 11491.44,-4771.5 11491.44,-4657.52 8094.65,-4638.36 6927.06,-4635.15"/>
<polygon fill="black" stroke="black" points="6926.84,-4631.65 6916.83,-4635.12 6926.82,-4638.65 6926.84,-4631.65"/>
</g>
<!-- ln1_l13 -->
<g id="node718" class="node">
<title>ln1_l13</title>
<polygon fill="lightyellow" stroke="black" points="6831.94,-3865.17 6396.94,-3865.17 6396.94,-3797.17 6831.94,-3797.17 6831.94,-3865.17"/>
<text text-anchor="middle" x="6614.44" y="-3849.97" font-family="Times,serif" font-size="14.00">LayerNorm L13</text>
<text text-anchor="middle" x="6614.44" y="-3834.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3819.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3804.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l13 -->
<g id="edge939" class="edge">
<title>router&#45;&gt;ln1_l13</title>
<path fill="none" stroke="black" d="M11429.27,-20240.54C11486.74,-20220.43 11529.44,-20195.16 11529.44,-20164.5 11529.44,-20164.5 11529.44,-20164.5 11529.44,-3935.17 11529.44,-3875.77 7809.65,-3841.76 6842.18,-3833.92"/>
<polygon fill="black" stroke="black" points="6842,-3830.42 6831.97,-3833.84 6841.95,-3837.42 6842,-3830.42"/>
</g>
<!-- route_l13 -->
<g id="node722" class="node">
<title>route_l13</title>
<polygon fill="lightgray" stroke="black" points="7086.96,-3445.17 6335.29,-3445.17 6141.92,-3309.17 6893.59,-3309.17 7086.96,-3445.17"/>
<text text-anchor="middle" x="6614.44" y="-3395.97" font-family="Times,serif" font-size="14.00">Expert Routing L13</text>
<text text-anchor="middle" x="6614.44" y="-3380.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3365.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3350.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l13 -->
<g id="edge938" class="edge">
<title>router&#45;&gt;route_l13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11441.63,-20249.04C11512.53,-20228.29 11567.44,-20200.57 11567.44,-20164.5 11567.44,-20164.5 11567.44,-20164.5 11567.44,-3515.17 11567.44,-3401.18 8170.65,-3382.03 7003.06,-3378.81"/>
<polygon fill="black" stroke="black" points="7002.84,-3375.31 6992.83,-3378.79 7002.82,-3382.31 7002.84,-3375.31"/>
</g>
<!-- ln1_l14 -->
<g id="node773" class="node">
<title>ln1_l14</title>
<polygon fill="lightyellow" stroke="black" points="6907.94,-2608.83 6472.94,-2608.83 6472.94,-2540.83 6907.94,-2540.83 6907.94,-2608.83"/>
<text text-anchor="middle" x="6690.44" y="-2593.63" font-family="Times,serif" font-size="14.00">LayerNorm L14</text>
<text text-anchor="middle" x="6690.44" y="-2578.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2563.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2548.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l14 -->
<g id="edge1011" class="edge">
<title>router&#45;&gt;ln1_l14</title>
<path fill="none" stroke="black" d="M11452.86,-20256.69C11537.42,-20235.79 11605.44,-20206.07 11605.44,-20164.5 11605.44,-20164.5 11605.44,-20164.5 11605.44,-2678.83 11605.44,-2619.43 7885.65,-2585.43 6918.18,-2577.59"/>
<polygon fill="black" stroke="black" points="6918,-2574.09 6907.97,-2577.51 6917.95,-2581.09 6918,-2574.09"/>
</g>
<!-- route_l14 -->
<g id="node777" class="node">
<title>route_l14</title>
<polygon fill="lightgray" stroke="black" points="7162.96,-2188.83 6411.29,-2188.83 6217.92,-2052.83 6969.59,-2052.83 7162.96,-2188.83"/>
<text text-anchor="middle" x="6690.44" y="-2139.63" font-family="Times,serif" font-size="14.00">Expert Routing L14</text>
<text text-anchor="middle" x="6690.44" y="-2124.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2109.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2094.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l14 -->
<g id="edge1010" class="edge">
<title>router&#45;&gt;route_l14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11463.3,-20263.6C11561.6,-20242.96 11643.44,-20211.62 11643.44,-20164.5 11643.44,-20164.5 11643.44,-20164.5 11643.44,-2258.83 11643.44,-2144.85 8246.65,-2125.7 7079.06,-2122.48"/>
<polygon fill="black" stroke="black" points="7078.84,-2118.98 7068.83,-2122.45 7078.82,-2125.98 7078.84,-2118.98"/>
</g>
<!-- ln1_l15 -->
<g id="node828" class="node">
<title>ln1_l15</title>
<polygon fill="lightyellow" stroke="black" points="11678.94,-1352.5 11243.94,-1352.5 11243.94,-1284.5 11678.94,-1284.5 11678.94,-1352.5"/>
<text text-anchor="middle" x="11461.44" y="-1337.3" font-family="Times,serif" font-size="14.00">LayerNorm L15</text>
<text text-anchor="middle" x="11461.44" y="-1322.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11461.44" y="-1307.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11461.44" y="-1292.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;ln1_l15 -->
<g id="edge1083" class="edge">
<title>router&#45;&gt;ln1_l15</title>
<path fill="none" stroke="black" d="M11472.74,-20269.95C11584.96,-20249.89 11681.44,-20217.29 11681.44,-20164.5 11681.44,-20164.5 11681.44,-20164.5 11681.44,-1422.5 11681.44,-1393.58 11665.65,-1372.76 11642.54,-1357.78"/>
<polygon fill="black" stroke="black" points="11644.09,-1354.63 11633.7,-1352.52 11640.51,-1360.64 11644.09,-1354.63"/>
</g>
<!-- route_l15 -->
<g id="node832" class="node">
<title>route_l15</title>
<polygon fill="lightgray" stroke="black" points="12068.96,-932.5 11317.29,-932.5 11123.92,-796.5 11875.59,-796.5 12068.96,-932.5"/>
<text text-anchor="middle" x="11596.44" y="-883.3" font-family="Times,serif" font-size="14.00">Expert Routing L15</text>
<text text-anchor="middle" x="11596.44" y="-868.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11596.44" y="-853.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11596.44" y="-838.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- router&#45;&gt;route_l15 -->
<g id="edge1082" class="edge">
<title>router&#45;&gt;route_l15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11481.15,-20275.83C11607.46,-20256.63 11719.44,-20223.09 11719.44,-20164.5 11719.44,-20164.5 11719.44,-20164.5 11719.44,-1002.5 11719.44,-979.63 11709.83,-958.85 11695.99,-940.76"/>
<polygon fill="black" stroke="black" points="11698.39,-938.17 11689.35,-932.65 11692.97,-942.6 11698.39,-938.17"/>
</g>
<!-- attn_l0 -->
<g id="node4" class="node">
<title>attn_l0</title>
<polygon fill="lightcoral" stroke="black" points="10457.44,-20092.5 9997.44,-20092.5 9997.44,-20024.5 10457.44,-20024.5 10457.44,-20092.5"/>
<text text-anchor="middle" x="10227.44" y="-20077.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L0</text>
<text text-anchor="middle" x="10227.44" y="-20062.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10227.44" y="-20047.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="10227.44" y="-20032.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l0&#45;&gt;attn_l0 -->
<g id="edge4" class="edge">
<title>ln1_l0&#45;&gt;attn_l0</title>
<path fill="none" stroke="black" d="M10276.94,-20129.34C10270.49,-20120.24 10263.42,-20110.27 10256.7,-20100.77"/>
<polygon fill="black" stroke="black" points="10259.53,-20098.72 10250.9,-20092.59 10253.82,-20102.77 10259.53,-20098.72"/>
</g>
<!-- residual1_l0 -->
<g id="node5" class="node">
<title>residual1_l0</title>
<polygon fill="lightpink" stroke="black" points="10066.94,-19987.5 9631.94,-19987.5 9631.94,-19919.5 10066.94,-19919.5 10066.94,-19987.5"/>
<text text-anchor="middle" x="9849.44" y="-19972.3" font-family="Times,serif" font-size="14.00">ResidualAdd L0</text>
<text text-anchor="middle" x="9849.44" y="-19957.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="9849.44" y="-19942.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="9849.44" y="-19927.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l0&#45;&gt;residual1_l0 -->
<g id="edge5" class="edge">
<title>attn_l0&#45;&gt;residual1_l0</title>
<path fill="none" stroke="black" d="M10106.28,-20024.48C10066.1,-20013.53 10021.2,-20001.3 9980.31,-19990.16"/>
<polygon fill="black" stroke="black" points="9981.13,-19986.75 9970.56,-19987.5 9979.29,-19993.51 9981.13,-19986.75"/>
</g>
<!-- ln2_l0 -->
<g id="node6" class="node">
<title>ln2_l0</title>
<polygon fill="lightyellow" stroke="black" points="8554.94,-19882.5 8119.94,-19882.5 8119.94,-19814.5 8554.94,-19814.5 8554.94,-19882.5"/>
<text text-anchor="middle" x="8337.44" y="-19867.3" font-family="Times,serif" font-size="14.00">LayerNorm L0</text>
<text text-anchor="middle" x="8337.44" y="-19852.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="8337.44" y="-19837.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="8337.44" y="-19822.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l0&#45;&gt;ln2_l0 -->
<g id="edge6" class="edge">
<title>residual1_l0&#45;&gt;ln2_l0</title>
<path fill="none" stroke="black" d="M9631.6,-19937.66C9347.82,-19918.32 8853.95,-19884.68 8565.31,-19865.02"/>
<polygon fill="black" stroke="black" points="8565.35,-19861.51 8555.13,-19864.32 8564.87,-19868.5 8565.35,-19861.51"/>
</g>
<!-- ln2_l0&#45;&gt;route_l0 -->
<g id="edge7" class="edge">
<title>ln2_l0&#45;&gt;route_l0</title>
<path fill="none" stroke="black" d="M8119.54,-19833.67C7765.55,-19811.21 7059.32,-19766.39 6603.37,-19737.46"/>
<polygon fill="black" stroke="black" points="6603.52,-19733.96 6593.32,-19736.82 6603.08,-19740.95 6603.52,-19733.96"/>
</g>
<!-- recv_l0_e0_gpu0 -->
<g id="node8" class="node">
<title>recv_l0_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="322.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="322.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E0</text>
<text text-anchor="middle" x="322.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="322.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="322.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e0_gpu0 -->
<g id="edge8" class="edge">
<title>route_l0&#45;&gt;recv_l0_e0_gpu0</title>
<path fill="none" stroke="black" d="M5796.05,-19704.97C4987.49,-19696.78 3044.87,-19673.28 1416.44,-19623.5 1077.61,-19613.14 991.99,-19621.66 654.44,-19590.5 621.33,-19587.44 586.47,-19583.4 552.29,-19578.97"/>
<polygon fill="black" stroke="black" points="552.56,-19575.48 542.19,-19577.65 551.65,-19582.42 552.56,-19575.48"/>
<text text-anchor="middle" x="1488.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l0_e1_gpu1 -->
<g id="node11" class="node">
<title>recv_l0_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="985.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="985.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E1</text>
<text text-anchor="middle" x="985.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="985.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="985.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e1_gpu1 -->
<g id="edge12" class="edge">
<title>route_l0&#45;&gt;recv_l0_e1_gpu1</title>
<path fill="none" stroke="black" d="M5794.04,-19703.49C5066.98,-19693.38 3440.47,-19667.62 2071.44,-19623.5 1736.18,-19612.69 1651.44,-19621.41 1317.44,-19590.5 1284.33,-19587.43 1249.48,-19583.39 1215.29,-19578.96"/>
<polygon fill="black" stroke="black" points="1215.56,-19575.47 1205.19,-19577.64 1214.65,-19582.41 1215.56,-19575.47"/>
<text text-anchor="middle" x="2143.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l0_e2_gpu2 -->
<g id="node14" class="node">
<title>recv_l0_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1648.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1648.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E2</text>
<text text-anchor="middle" x="1648.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1648.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1648.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e2_gpu2 -->
<g id="edge16" class="edge">
<title>route_l0&#45;&gt;recv_l0_e2_gpu2</title>
<path fill="none" stroke="black" d="M5790.58,-19701.12C5155.62,-19688.55 3854.68,-19660.66 2753.44,-19623.5 2409.77,-19611.9 2322.86,-19622.01 1980.44,-19590.5 1947.33,-19587.45 1912.47,-19583.42 1878.29,-19578.99"/>
<polygon fill="black" stroke="black" points="1878.56,-19575.5 1868.19,-19577.67 1877.65,-19582.44 1878.56,-19575.5"/>
<text text-anchor="middle" x="2825.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l0_e3_gpu3 -->
<g id="node17" class="node">
<title>recv_l0_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2311.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2311.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E3</text>
<text text-anchor="middle" x="2311.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2311.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2311.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e3_gpu3 -->
<g id="edge20" class="edge">
<title>route_l0&#45;&gt;recv_l0_e3_gpu3</title>
<path fill="none" stroke="black" d="M5783.03,-19695.73C5275.73,-19679.3 4368.55,-19649.74 3592.44,-19623.5 3170.65,-19609.23 3063.85,-19627.51 2643.44,-19590.5 2610.06,-19587.56 2574.9,-19583.56 2540.45,-19579.13"/>
<polygon fill="black" stroke="black" points="2540.64,-19575.62 2530.27,-19577.8 2539.74,-19582.56 2540.64,-19575.62"/>
<text text-anchor="middle" x="3664.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l0_e4_gpu4 -->
<g id="node20" class="node">
<title>recv_l0_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="2974.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2974.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E4</text>
<text text-anchor="middle" x="2974.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2974.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2974.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e4_gpu4 -->
<g id="edge24" class="edge">
<title>route_l0&#45;&gt;recv_l0_e4_gpu4</title>
<path fill="none" stroke="black" d="M5778.13,-19692.3C4995.73,-19660.62 3336.8,-19593.26 3306.44,-19590.5 3273.2,-19587.46 3238.19,-19583.43 3203.88,-19578.99"/>
<polygon fill="black" stroke="black" points="3204.11,-19575.49 3193.74,-19577.66 3203.2,-19582.43 3204.11,-19575.49"/>
<text text-anchor="middle" x="4090.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l0_e5_gpu5 -->
<g id="node23" class="node">
<title>recv_l0_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3637.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3637.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E5</text>
<text text-anchor="middle" x="3637.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3637.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3637.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e5_gpu5 -->
<g id="edge28" class="edge">
<title>route_l0&#45;&gt;recv_l0_e5_gpu5</title>
<path fill="none" stroke="black" d="M5750.9,-19673.36C5466.88,-19651.3 5085.61,-19624.17 4748.44,-19608.5 4402.5,-19592.41 4314.59,-19618.86 3969.44,-19590.5 3935.64,-19587.72 3900.04,-19583.77 3865.2,-19579.32"/>
<polygon fill="black" stroke="black" points="3865.27,-19575.8 3854.9,-19577.99 3864.37,-19582.74 3865.27,-19575.8"/>
<text text-anchor="middle" x="5094.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l0_e6_gpu6 -->
<g id="node26" class="node">
<title>recv_l0_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4300.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4300.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E6</text>
<text text-anchor="middle" x="4300.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4300.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4300.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e6_gpu6 -->
<g id="edge32" class="edge">
<title>route_l0&#45;&gt;recv_l0_e6_gpu6</title>
<path fill="none" stroke="black" d="M5709.54,-19644.07C5592.16,-19630.11 5466.37,-19617 5349.44,-19608.5 5031.51,-19585.38 4950.11,-19616.92 4632.44,-19590.5 4598.65,-19587.68 4563.04,-19583.71 4528.2,-19579.26"/>
<polygon fill="black" stroke="black" points="4528.28,-19575.74 4517.91,-19577.93 4527.38,-19582.68 4528.28,-19575.74"/>
<text text-anchor="middle" x="5581.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l0_e7_gpu7 -->
<g id="node29" class="node">
<title>recv_l0_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="4963.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4963.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E7</text>
<text text-anchor="middle" x="4963.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4963.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4963.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e7_gpu7 -->
<g id="edge36" class="edge">
<title>route_l0&#45;&gt;recv_l0_e7_gpu7</title>
<path fill="none" stroke="black" d="M5916.6,-19641.43C5856.77,-19628.41 5793.2,-19616.37 5733.44,-19608.5 5540.28,-19583.03 5489.47,-19608.2 5295.44,-19590.5 5262.2,-19587.46 5227.19,-19583.43 5192.88,-19578.99"/>
<polygon fill="black" stroke="black" points="5193.11,-19575.49 5182.74,-19577.66 5192.2,-19582.43 5193.11,-19575.49"/>
<text text-anchor="middle" x="5892.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l0_e8_gpu8 -->
<g id="node32" class="node">
<title>recv_l0_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5626.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5626.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E8</text>
<text text-anchor="middle" x="5626.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e8_gpu8 -->
<g id="edge40" class="edge">
<title>route_l0&#45;&gt;recv_l0_e8_gpu8</title>
<path fill="none" stroke="black" d="M6078.02,-19641.4C6055.83,-19628.89 6031.92,-19617.07 6008.44,-19608.5 5970.05,-19594.47 5928.37,-19583.44 5887.11,-19574.77"/>
<polygon fill="black" stroke="black" points="5887.7,-19571.31 5877.2,-19572.72 5886.29,-19578.17 5887.7,-19571.31"/>
<text text-anchor="middle" x="6115.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l0_e9_gpu9 -->
<g id="node35" class="node">
<title>recv_l0_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6289.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6289.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E9</text>
<text text-anchor="middle" x="6289.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6289.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6289.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e9_gpu9 -->
<g id="edge44" class="edge">
<title>route_l0&#45;&gt;recv_l0_e9_gpu9</title>
<path fill="none" stroke="black" d="M6223.59,-19641.35C6233.13,-19627.16 6243.1,-19612.33 6252.31,-19598.64"/>
<polygon fill="black" stroke="black" points="6255.25,-19600.53 6257.93,-19590.28 6249.45,-19596.62 6255.25,-19600.53"/>
<text text-anchor="middle" x="6316.44" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l0_e10_gpu10 -->
<g id="node38" class="node">
<title>recv_l0_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="6952.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6952.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E10</text>
<text text-anchor="middle" x="6952.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6952.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6952.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e10_gpu10 -->
<g id="edge48" class="edge">
<title>route_l0&#45;&gt;recv_l0_e10_gpu10</title>
<path fill="none" stroke="black" d="M6465.82,-19647.2C6564.18,-19626.22 6671.75,-19603.28 6760.68,-19584.31"/>
<polygon fill="black" stroke="black" points="6761.56,-19587.7 6770.61,-19582.19 6760.1,-19580.86 6761.56,-19587.7"/>
<text text-anchor="middle" x="6711.94" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l0_e11_gpu11 -->
<g id="node41" class="node">
<title>recv_l0_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7615.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7615.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E11</text>
<text text-anchor="middle" x="7615.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7615.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7615.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e11_gpu11 -->
<g id="edge52" class="edge">
<title>route_l0&#45;&gt;recv_l0_e11_gpu11</title>
<path fill="none" stroke="black" d="M6507.27,-19676.38C6727.2,-19654.16 7022.94,-19622.87 7283.44,-19590.5 7314.33,-19586.66 7346.8,-19582.37 7378.84,-19577.98"/>
<polygon fill="black" stroke="black" points="7379.34,-19581.45 7388.77,-19576.62 7378.39,-19574.51 7379.34,-19581.45"/>
<text text-anchor="middle" x="7209.94" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l0_e12_gpu12 -->
<g id="node44" class="node">
<title>recv_l0_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8278.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8278.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E12</text>
<text text-anchor="middle" x="8278.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8278.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8278.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e12_gpu12 -->
<g id="edge56" class="edge">
<title>route_l0&#45;&gt;recv_l0_e12_gpu12</title>
<path fill="none" stroke="black" d="M6530.48,-19692.71C6887.76,-19674.88 7456.5,-19641.51 7946.44,-19590.5 7978.58,-19587.15 8012.39,-19583.04 8045.64,-19578.66"/>
<polygon fill="black" stroke="black" points="8046.48,-19582.07 8055.94,-19577.29 8045.56,-19575.14 8046.48,-19582.07"/>
<text text-anchor="middle" x="7831.94" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l0_e13_gpu13 -->
<g id="node47" class="node">
<title>recv_l0_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="8941.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8941.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E13</text>
<text text-anchor="middle" x="8941.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8941.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8941.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e13_gpu13 -->
<g id="edge60" class="edge">
<title>route_l0&#45;&gt;recv_l0_e13_gpu13</title>
<path fill="none" stroke="black" d="M6542.65,-19701.3C7018.72,-19689.5 7878.03,-19659.96 8609.44,-19590.5 8642.41,-19587.36 8677.12,-19583.3 8711.17,-19578.87"/>
<polygon fill="black" stroke="black" points="8711.77,-19582.32 8721.23,-19577.55 8710.86,-19575.38 8711.77,-19582.32"/>
<text text-anchor="middle" x="8423.94" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l0_e14_gpu14 -->
<g id="node50" class="node">
<title>recv_l0_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9604.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9604.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E14</text>
<text text-anchor="middle" x="9604.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9604.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9604.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e14_gpu14 -->
<g id="edge64" class="edge">
<title>route_l0&#45;&gt;recv_l0_e14_gpu14</title>
<path fill="none" stroke="black" d="M6535.6,-19696.16C6992.2,-19680.22 7807.18,-19651.22 8504.44,-19623.5 8845.82,-19609.92 8932.23,-19621.85 9272.44,-19590.5 9305.55,-19587.44 9340.41,-19583.41 9374.59,-19578.99"/>
<polygon fill="black" stroke="black" points="9375.23,-19582.43 9384.69,-19577.66 9374.32,-19575.49 9375.23,-19582.43"/>
<text text-anchor="middle" x="9097.94" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l0_e15_gpu15 -->
<g id="node53" class="node">
<title>recv_l0_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10267.44" cy="-19542.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10267.44" y="-19561.21" font-family="Times,serif" font-size="14.00">Token Receive L0E15</text>
<text text-anchor="middle" x="10267.44" y="-19546.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10267.44" y="-19531.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10267.44" y="-19516.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l0&#45;&gt;recv_l0_e15_gpu15 -->
<g id="edge68" class="edge">
<title>route_l0&#45;&gt;recv_l0_e15_gpu15</title>
<path fill="none" stroke="black" d="M6541.01,-19700.01C7105.06,-19686.39 8226.85,-19657.72 9178.44,-19623.5 9514.99,-19611.39 9600.11,-19621.51 9935.44,-19590.5 9968.55,-19587.43 10003.41,-19583.39 10037.59,-19578.97"/>
<polygon fill="black" stroke="black" points="10038.23,-19582.41 10047.69,-19577.64 10037.32,-19575.47 10038.23,-19582.41"/>
<text text-anchor="middle" x="9764.94" y="-19612.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l0_e0_gpu0 -->
<g id="node9" class="node">
<title>expert_l0_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="550.44,-19457.33 94.44,-19457.33 94.44,-19389.33 550.44,-19389.33 550.44,-19457.33"/>
<text text-anchor="middle" x="322.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E0</text>
<text text-anchor="middle" x="322.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="322.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="322.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l0_e0_gpu0&#45;&gt;expert_l0_e0_gpu0 -->
<g id="edge9" class="edge">
<title>recv_l0_e0_gpu0&#45;&gt;expert_l0_e0_gpu0</title>
<path fill="none" stroke="black" d="M322.44,-19494.13C322.44,-19485.37 322.44,-19476.27 322.44,-19467.64"/>
<polygon fill="black" stroke="black" points="325.94,-19467.41 322.44,-19457.41 318.94,-19467.41 325.94,-19467.41"/>
</g>
<!-- send_l0_e0_gpu0 -->
<g id="node10" class="node">
<title>send_l0_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="322.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="322.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E0</text>
<text text-anchor="middle" x="322.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="322.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="322.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l0_e0_gpu0&#45;&gt;send_l0_e0_gpu0 -->
<g id="edge10" class="edge">
<title>expert_l0_e0_gpu0&#45;&gt;send_l0_e0_gpu0</title>
<path fill="none" stroke="black" d="M322.44,-19389.09C322.44,-19380.84 322.44,-19371.76 322.44,-19362.71"/>
<polygon fill="black" stroke="black" points="325.94,-19362.55 322.44,-19352.55 318.94,-19362.55 325.94,-19362.55"/>
</g>
<!-- agg_l0 -->
<g id="node56" class="node">
<title>agg_l0</title>
<polygon fill="lightgray" stroke="black" points="6104.33,-19219.16 5344.12,-19219.16 5148.55,-19083.16 5908.76,-19083.16 6104.33,-19219.16"/>
<text text-anchor="middle" x="5626.44" y="-19169.96" font-family="Times,serif" font-size="14.00">Expert Aggregation L0</text>
<text text-anchor="middle" x="5626.44" y="-19154.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19139.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19124.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l0_e0_gpu0&#45;&gt;agg_l0 -->
<g id="edge11" class="edge">
<title>send_l0_e0_gpu0&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M539.45,-19268.66C577.68,-19263.66 617.16,-19259.18 654.44,-19256.16 1542.88,-19184.13 4232.64,-19160.64 5240.01,-19154.25"/>
<polygon fill="black" stroke="black" points="5240.34,-19157.74 5250.32,-19154.18 5240.29,-19150.74 5240.34,-19157.74"/>
</g>
<!-- expert_l0_e1_gpu1 -->
<g id="node12" class="node">
<title>expert_l0_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1213.44,-19457.33 757.44,-19457.33 757.44,-19389.33 1213.44,-19389.33 1213.44,-19457.33"/>
<text text-anchor="middle" x="985.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E1</text>
<text text-anchor="middle" x="985.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="985.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="985.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l0_e1_gpu1&#45;&gt;expert_l0_e1_gpu1 -->
<g id="edge13" class="edge">
<title>recv_l0_e1_gpu1&#45;&gt;expert_l0_e1_gpu1</title>
<path fill="none" stroke="black" d="M985.44,-19494.13C985.44,-19485.37 985.44,-19476.27 985.44,-19467.64"/>
<polygon fill="black" stroke="black" points="988.94,-19467.41 985.44,-19457.41 981.94,-19467.41 988.94,-19467.41"/>
</g>
<!-- send_l0_e1_gpu1 -->
<g id="node13" class="node">
<title>send_l0_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="985.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="985.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E1</text>
<text text-anchor="middle" x="985.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="985.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="985.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l0_e1_gpu1&#45;&gt;send_l0_e1_gpu1 -->
<g id="edge14" class="edge">
<title>expert_l0_e1_gpu1&#45;&gt;send_l0_e1_gpu1</title>
<path fill="none" stroke="black" d="M985.44,-19389.09C985.44,-19380.84 985.44,-19371.76 985.44,-19362.71"/>
<polygon fill="black" stroke="black" points="988.94,-19362.55 985.44,-19352.55 981.94,-19362.55 988.94,-19362.55"/>
</g>
<!-- send_l0_e1_gpu1&#45;&gt;agg_l0 -->
<g id="edge15" class="edge">
<title>send_l0_e1_gpu1&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M1202.91,-19268.7C1240.99,-19263.71 1280.31,-19259.23 1317.44,-19256.16 2073.27,-19193.66 4333.64,-19164.93 5242.13,-19155.68"/>
<polygon fill="black" stroke="black" points="5242.46,-19159.18 5252.42,-19155.58 5242.39,-19152.18 5242.46,-19159.18"/>
</g>
<!-- expert_l0_e2_gpu2 -->
<g id="node15" class="node">
<title>expert_l0_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="1876.44,-19457.33 1420.44,-19457.33 1420.44,-19389.33 1876.44,-19389.33 1876.44,-19457.33"/>
<text text-anchor="middle" x="1648.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E2</text>
<text text-anchor="middle" x="1648.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1648.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1648.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l0_e2_gpu2&#45;&gt;expert_l0_e2_gpu2 -->
<g id="edge17" class="edge">
<title>recv_l0_e2_gpu2&#45;&gt;expert_l0_e2_gpu2</title>
<path fill="none" stroke="black" d="M1648.44,-19494.13C1648.44,-19485.37 1648.44,-19476.27 1648.44,-19467.64"/>
<polygon fill="black" stroke="black" points="1651.94,-19467.41 1648.44,-19457.41 1644.94,-19467.41 1651.94,-19467.41"/>
</g>
<!-- send_l0_e2_gpu2 -->
<g id="node16" class="node">
<title>send_l0_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1648.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1648.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E2</text>
<text text-anchor="middle" x="1648.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1648.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1648.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l0_e2_gpu2&#45;&gt;send_l0_e2_gpu2 -->
<g id="edge18" class="edge">
<title>expert_l0_e2_gpu2&#45;&gt;send_l0_e2_gpu2</title>
<path fill="none" stroke="black" d="M1648.44,-19389.09C1648.44,-19380.84 1648.44,-19371.76 1648.44,-19362.71"/>
<polygon fill="black" stroke="black" points="1651.94,-19362.55 1648.44,-19352.55 1644.94,-19362.55 1651.94,-19362.55"/>
</g>
<!-- send_l0_e2_gpu2&#45;&gt;agg_l0 -->
<g id="edge19" class="edge">
<title>send_l0_e2_gpu2&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M1866.36,-19268.78C1904.31,-19263.8 1943.46,-19259.3 1980.44,-19256.16 2604.79,-19203.15 4442.71,-19169.95 5244.78,-19157.61"/>
<polygon fill="black" stroke="black" points="5245.1,-19161.11 5255.05,-19157.45 5244.99,-19154.11 5245.1,-19161.11"/>
</g>
<!-- expert_l0_e3_gpu3 -->
<g id="node18" class="node">
<title>expert_l0_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2539.44,-19457.33 2083.44,-19457.33 2083.44,-19389.33 2539.44,-19389.33 2539.44,-19457.33"/>
<text text-anchor="middle" x="2311.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E3</text>
<text text-anchor="middle" x="2311.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2311.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2311.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l0_e3_gpu3&#45;&gt;expert_l0_e3_gpu3 -->
<g id="edge21" class="edge">
<title>recv_l0_e3_gpu3&#45;&gt;expert_l0_e3_gpu3</title>
<path fill="none" stroke="black" d="M2311.44,-19494.13C2311.44,-19485.37 2311.44,-19476.27 2311.44,-19467.64"/>
<polygon fill="black" stroke="black" points="2314.94,-19467.41 2311.44,-19457.41 2307.94,-19467.41 2314.94,-19467.41"/>
</g>
<!-- send_l0_e3_gpu3 -->
<g id="node19" class="node">
<title>send_l0_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2311.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2311.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E3</text>
<text text-anchor="middle" x="2311.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2311.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2311.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l0_e3_gpu3&#45;&gt;send_l0_e3_gpu3 -->
<g id="edge22" class="edge">
<title>expert_l0_e3_gpu3&#45;&gt;send_l0_e3_gpu3</title>
<path fill="none" stroke="black" d="M2311.44,-19389.09C2311.44,-19380.84 2311.44,-19371.76 2311.44,-19362.71"/>
<polygon fill="black" stroke="black" points="2314.94,-19362.55 2311.44,-19352.55 2307.94,-19362.55 2314.94,-19362.55"/>
</g>
<!-- send_l0_e3_gpu3&#45;&gt;agg_l0 -->
<g id="edge23" class="edge">
<title>send_l0_e3_gpu3&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M2528.45,-19268.58C2566.67,-19263.59 2606.16,-19259.14 2643.44,-19256.16 3074.59,-19221.73 3184.13,-19251.41 3616.44,-19238.16 4192.24,-19220.52 4860.41,-19189.91 5262.93,-19170.37"/>
<polygon fill="black" stroke="black" points="5263.16,-19173.86 5272.98,-19169.88 5262.82,-19166.87 5263.16,-19173.86"/>
</g>
<!-- expert_l0_e4_gpu4 -->
<g id="node21" class="node">
<title>expert_l0_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3202.44,-19457.33 2746.44,-19457.33 2746.44,-19389.33 3202.44,-19389.33 3202.44,-19457.33"/>
<text text-anchor="middle" x="2974.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E4</text>
<text text-anchor="middle" x="2974.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2974.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2974.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l0_e4_gpu4&#45;&gt;expert_l0_e4_gpu4 -->
<g id="edge25" class="edge">
<title>recv_l0_e4_gpu4&#45;&gt;expert_l0_e4_gpu4</title>
<path fill="none" stroke="black" d="M2974.44,-19494.13C2974.44,-19485.37 2974.44,-19476.27 2974.44,-19467.64"/>
<polygon fill="black" stroke="black" points="2977.94,-19467.41 2974.44,-19457.41 2970.94,-19467.41 2977.94,-19467.41"/>
</g>
<!-- send_l0_e4_gpu4 -->
<g id="node22" class="node">
<title>send_l0_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="2974.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2974.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E4</text>
<text text-anchor="middle" x="2974.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2974.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2974.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l0_e4_gpu4&#45;&gt;send_l0_e4_gpu4 -->
<g id="edge26" class="edge">
<title>expert_l0_e4_gpu4&#45;&gt;send_l0_e4_gpu4</title>
<path fill="none" stroke="black" d="M2974.44,-19389.09C2974.44,-19380.84 2974.44,-19371.76 2974.44,-19362.71"/>
<polygon fill="black" stroke="black" points="2977.94,-19362.55 2974.44,-19352.55 2970.94,-19362.55 2977.94,-19362.55"/>
</g>
<!-- send_l0_e4_gpu4&#45;&gt;agg_l0 -->
<g id="edge27" class="edge">
<title>send_l0_e4_gpu4&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M3191.45,-19268.58C3229.67,-19263.59 3269.16,-19259.14 3306.44,-19256.16 3737.59,-19221.73 3847.29,-19255.95 4279.44,-19238.16 4617.82,-19224.24 5003.46,-19198.62 5275.14,-19178.96"/>
<polygon fill="black" stroke="black" points="5275.43,-19182.45 5285.16,-19178.23 5274.93,-19175.47 5275.43,-19182.45"/>
</g>
<!-- expert_l0_e5_gpu5 -->
<g id="node24" class="node">
<title>expert_l0_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="3865.44,-19457.33 3409.44,-19457.33 3409.44,-19389.33 3865.44,-19389.33 3865.44,-19457.33"/>
<text text-anchor="middle" x="3637.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E5</text>
<text text-anchor="middle" x="3637.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3637.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3637.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l0_e5_gpu5&#45;&gt;expert_l0_e5_gpu5 -->
<g id="edge29" class="edge">
<title>recv_l0_e5_gpu5&#45;&gt;expert_l0_e5_gpu5</title>
<path fill="none" stroke="black" d="M3637.44,-19494.13C3637.44,-19485.37 3637.44,-19476.27 3637.44,-19467.64"/>
<polygon fill="black" stroke="black" points="3640.94,-19467.41 3637.44,-19457.41 3633.94,-19467.41 3640.94,-19467.41"/>
</g>
<!-- send_l0_e5_gpu5 -->
<g id="node25" class="node">
<title>send_l0_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3637.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3637.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E5</text>
<text text-anchor="middle" x="3637.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3637.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3637.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l0_e5_gpu5&#45;&gt;send_l0_e5_gpu5 -->
<g id="edge30" class="edge">
<title>expert_l0_e5_gpu5&#45;&gt;send_l0_e5_gpu5</title>
<path fill="none" stroke="black" d="M3637.44,-19389.09C3637.44,-19380.84 3637.44,-19371.76 3637.44,-19362.71"/>
<polygon fill="black" stroke="black" points="3640.94,-19362.55 3637.44,-19352.55 3633.94,-19362.55 3640.94,-19362.55"/>
</g>
<!-- send_l0_e5_gpu5&#45;&gt;agg_l0 -->
<g id="edge31" class="edge">
<title>send_l0_e5_gpu5&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M3856.28,-19268.91C3893.94,-19263.95 3932.76,-19259.42 3969.44,-19256.16 4188.28,-19236.71 4244.07,-19250.27 4463.44,-19238.16 4737.33,-19223.05 5047.06,-19199.85 5277.99,-19181.35"/>
<polygon fill="black" stroke="black" points="5278.55,-19184.81 5288.23,-19180.53 5277.99,-19177.84 5278.55,-19184.81"/>
</g>
<!-- expert_l0_e6_gpu6 -->
<g id="node27" class="node">
<title>expert_l0_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4528.44,-19457.33 4072.44,-19457.33 4072.44,-19389.33 4528.44,-19389.33 4528.44,-19457.33"/>
<text text-anchor="middle" x="4300.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E6</text>
<text text-anchor="middle" x="4300.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4300.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4300.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l0_e6_gpu6&#45;&gt;expert_l0_e6_gpu6 -->
<g id="edge33" class="edge">
<title>recv_l0_e6_gpu6&#45;&gt;expert_l0_e6_gpu6</title>
<path fill="none" stroke="black" d="M4300.44,-19494.13C4300.44,-19485.37 4300.44,-19476.27 4300.44,-19467.64"/>
<polygon fill="black" stroke="black" points="4303.94,-19467.41 4300.44,-19457.41 4296.94,-19467.41 4303.94,-19467.41"/>
</g>
<!-- send_l0_e6_gpu6 -->
<g id="node28" class="node">
<title>send_l0_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4300.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4300.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E6</text>
<text text-anchor="middle" x="4300.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4300.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4300.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l0_e6_gpu6&#45;&gt;send_l0_e6_gpu6 -->
<g id="edge34" class="edge">
<title>expert_l0_e6_gpu6&#45;&gt;send_l0_e6_gpu6</title>
<path fill="none" stroke="black" d="M4300.44,-19389.09C4300.44,-19380.84 4300.44,-19371.76 4300.44,-19362.71"/>
<polygon fill="black" stroke="black" points="4303.94,-19362.55 4300.44,-19352.55 4296.94,-19362.55 4303.94,-19362.55"/>
</g>
<!-- send_l0_e6_gpu6&#45;&gt;agg_l0 -->
<g id="edge35" class="edge">
<title>send_l0_e6_gpu6&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M4526.65,-19269.98C4562.03,-19265.12 4598.2,-19260.35 4632.44,-19256.16 4710.05,-19246.67 4729.67,-19246.24 4807.44,-19238.16 4965.04,-19221.78 5139.68,-19203.47 5287.07,-19187.96"/>
<polygon fill="black" stroke="black" points="5287.61,-19191.42 5297.19,-19186.9 5286.88,-19184.46 5287.61,-19191.42"/>
</g>
<!-- expert_l0_e7_gpu7 -->
<g id="node30" class="node">
<title>expert_l0_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5191.44,-19457.33 4735.44,-19457.33 4735.44,-19389.33 5191.44,-19389.33 5191.44,-19457.33"/>
<text text-anchor="middle" x="4963.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E7</text>
<text text-anchor="middle" x="4963.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4963.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4963.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l0_e7_gpu7&#45;&gt;expert_l0_e7_gpu7 -->
<g id="edge37" class="edge">
<title>recv_l0_e7_gpu7&#45;&gt;expert_l0_e7_gpu7</title>
<path fill="none" stroke="black" d="M4963.44,-19494.13C4963.44,-19485.37 4963.44,-19476.27 4963.44,-19467.64"/>
<polygon fill="black" stroke="black" points="4966.94,-19467.41 4963.44,-19457.41 4959.94,-19467.41 4966.94,-19467.41"/>
</g>
<!-- send_l0_e7_gpu7 -->
<g id="node31" class="node">
<title>send_l0_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="4963.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4963.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E7</text>
<text text-anchor="middle" x="4963.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4963.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4963.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l0_e7_gpu7&#45;&gt;send_l0_e7_gpu7 -->
<g id="edge38" class="edge">
<title>expert_l0_e7_gpu7&#45;&gt;send_l0_e7_gpu7</title>
<path fill="none" stroke="black" d="M4963.44,-19389.09C4963.44,-19380.84 4963.44,-19371.76 4963.44,-19362.71"/>
<polygon fill="black" stroke="black" points="4966.94,-19362.55 4963.44,-19352.55 4959.94,-19362.55 4966.94,-19362.55"/>
</g>
<!-- send_l0_e7_gpu7&#45;&gt;agg_l0 -->
<g id="edge39" class="edge">
<title>send_l0_e7_gpu7&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M5137.2,-19263.65C5196.63,-19250.11 5264.87,-19234.56 5331.16,-19219.45"/>
<polygon fill="black" stroke="black" points="5331.95,-19222.86 5340.92,-19217.23 5330.39,-19216.04 5331.95,-19222.86"/>
</g>
<!-- expert_l0_e8_gpu8 -->
<g id="node33" class="node">
<title>expert_l0_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="5854.44,-19457.33 5398.44,-19457.33 5398.44,-19389.33 5854.44,-19389.33 5854.44,-19457.33"/>
<text text-anchor="middle" x="5626.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E8</text>
<text text-anchor="middle" x="5626.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l0_e8_gpu8&#45;&gt;expert_l0_e8_gpu8 -->
<g id="edge41" class="edge">
<title>recv_l0_e8_gpu8&#45;&gt;expert_l0_e8_gpu8</title>
<path fill="none" stroke="black" d="M5626.44,-19494.13C5626.44,-19485.37 5626.44,-19476.27 5626.44,-19467.64"/>
<polygon fill="black" stroke="black" points="5629.94,-19467.41 5626.44,-19457.41 5622.94,-19467.41 5629.94,-19467.41"/>
</g>
<!-- send_l0_e8_gpu8 -->
<g id="node34" class="node">
<title>send_l0_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5626.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5626.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E8</text>
<text text-anchor="middle" x="5626.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5626.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l0_e8_gpu8&#45;&gt;send_l0_e8_gpu8 -->
<g id="edge42" class="edge">
<title>expert_l0_e8_gpu8&#45;&gt;send_l0_e8_gpu8</title>
<path fill="none" stroke="black" d="M5626.44,-19389.09C5626.44,-19380.84 5626.44,-19371.76 5626.44,-19362.71"/>
<polygon fill="black" stroke="black" points="5629.94,-19362.55 5626.44,-19352.55 5622.94,-19362.55 5629.94,-19362.55"/>
</g>
<!-- send_l0_e8_gpu8&#45;&gt;agg_l0 -->
<g id="edge43" class="edge">
<title>send_l0_e8_gpu8&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M5626.44,-19255.86C5626.44,-19247.43 5626.44,-19238.46 5626.44,-19229.46"/>
<polygon fill="black" stroke="black" points="5629.94,-19229.3 5626.44,-19219.3 5622.94,-19229.3 5629.94,-19229.3"/>
</g>
<!-- expert_l0_e9_gpu9 -->
<g id="node36" class="node">
<title>expert_l0_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6517.44,-19457.33 6061.44,-19457.33 6061.44,-19389.33 6517.44,-19389.33 6517.44,-19457.33"/>
<text text-anchor="middle" x="6289.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E9</text>
<text text-anchor="middle" x="6289.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6289.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6289.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l0_e9_gpu9&#45;&gt;expert_l0_e9_gpu9 -->
<g id="edge45" class="edge">
<title>recv_l0_e9_gpu9&#45;&gt;expert_l0_e9_gpu9</title>
<path fill="none" stroke="black" d="M6289.44,-19494.13C6289.44,-19485.37 6289.44,-19476.27 6289.44,-19467.64"/>
<polygon fill="black" stroke="black" points="6292.94,-19467.41 6289.44,-19457.41 6285.94,-19467.41 6292.94,-19467.41"/>
</g>
<!-- send_l0_e9_gpu9 -->
<g id="node37" class="node">
<title>send_l0_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6289.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6289.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E9</text>
<text text-anchor="middle" x="6289.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6289.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6289.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l0_e9_gpu9&#45;&gt;send_l0_e9_gpu9 -->
<g id="edge46" class="edge">
<title>expert_l0_e9_gpu9&#45;&gt;send_l0_e9_gpu9</title>
<path fill="none" stroke="black" d="M6289.44,-19389.09C6289.44,-19380.84 6289.44,-19371.76 6289.44,-19362.71"/>
<polygon fill="black" stroke="black" points="6292.94,-19362.55 6289.44,-19352.55 6285.94,-19362.55 6292.94,-19362.55"/>
</g>
<!-- send_l0_e9_gpu9&#45;&gt;agg_l0 -->
<g id="edge47" class="edge">
<title>send_l0_e9_gpu9&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M6115.68,-19263.65C6058.84,-19250.7 5993.93,-19235.91 5930.39,-19221.43"/>
<polygon fill="black" stroke="black" points="5931.14,-19218.01 5920.61,-19219.2 5929.59,-19224.83 5931.14,-19218.01"/>
</g>
<!-- expert_l0_e10_gpu10 -->
<g id="node39" class="node">
<title>expert_l0_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7180.44,-19457.33 6724.44,-19457.33 6724.44,-19389.33 7180.44,-19389.33 7180.44,-19457.33"/>
<text text-anchor="middle" x="6952.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E10</text>
<text text-anchor="middle" x="6952.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6952.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6952.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l0_e10_gpu10&#45;&gt;expert_l0_e10_gpu10 -->
<g id="edge49" class="edge">
<title>recv_l0_e10_gpu10&#45;&gt;expert_l0_e10_gpu10</title>
<path fill="none" stroke="black" d="M6952.44,-19494.13C6952.44,-19485.37 6952.44,-19476.27 6952.44,-19467.64"/>
<polygon fill="black" stroke="black" points="6955.94,-19467.41 6952.44,-19457.41 6948.94,-19467.41 6955.94,-19467.41"/>
</g>
<!-- send_l0_e10_gpu10 -->
<g id="node40" class="node">
<title>send_l0_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="6952.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6952.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E10</text>
<text text-anchor="middle" x="6952.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6952.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6952.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l0_e10_gpu10&#45;&gt;send_l0_e10_gpu10 -->
<g id="edge50" class="edge">
<title>expert_l0_e10_gpu10&#45;&gt;send_l0_e10_gpu10</title>
<path fill="none" stroke="black" d="M6952.44,-19389.09C6952.44,-19380.84 6952.44,-19371.76 6952.44,-19362.71"/>
<polygon fill="black" stroke="black" points="6955.94,-19362.55 6952.44,-19352.55 6948.94,-19362.55 6955.94,-19362.55"/>
</g>
<!-- send_l0_e10_gpu10&#45;&gt;agg_l0 -->
<g id="edge51" class="edge">
<title>send_l0_e10_gpu10&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M6725.78,-19269.97C6690.54,-19265.13 6654.53,-19260.36 6620.44,-19256.16 6444,-19234.43 6249.57,-19213.43 6079.81,-19196.06"/>
<polygon fill="black" stroke="black" points="6080,-19192.57 6069.69,-19195.03 6079.29,-19199.53 6080,-19192.57"/>
</g>
<!-- expert_l0_e11_gpu11 -->
<g id="node42" class="node">
<title>expert_l0_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="7843.44,-19457.33 7387.44,-19457.33 7387.44,-19389.33 7843.44,-19389.33 7843.44,-19457.33"/>
<text text-anchor="middle" x="7615.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E11</text>
<text text-anchor="middle" x="7615.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7615.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7615.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l0_e11_gpu11&#45;&gt;expert_l0_e11_gpu11 -->
<g id="edge53" class="edge">
<title>recv_l0_e11_gpu11&#45;&gt;expert_l0_e11_gpu11</title>
<path fill="none" stroke="black" d="M7615.44,-19494.13C7615.44,-19485.37 7615.44,-19476.27 7615.44,-19467.64"/>
<polygon fill="black" stroke="black" points="7618.94,-19467.41 7615.44,-19457.41 7611.94,-19467.41 7618.94,-19467.41"/>
</g>
<!-- send_l0_e11_gpu11 -->
<g id="node43" class="node">
<title>send_l0_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7615.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7615.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E11</text>
<text text-anchor="middle" x="7615.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7615.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7615.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l0_e11_gpu11&#45;&gt;send_l0_e11_gpu11 -->
<g id="edge54" class="edge">
<title>expert_l0_e11_gpu11&#45;&gt;send_l0_e11_gpu11</title>
<path fill="none" stroke="black" d="M7615.44,-19389.09C7615.44,-19380.84 7615.44,-19371.76 7615.44,-19362.71"/>
<polygon fill="black" stroke="black" points="7618.94,-19362.55 7615.44,-19352.55 7611.94,-19362.55 7618.94,-19362.55"/>
</g>
<!-- send_l0_e11_gpu11&#45;&gt;agg_l0 -->
<g id="edge55" class="edge">
<title>send_l0_e11_gpu11&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M7393.85,-19269.31C7357.03,-19264.4 7319.21,-19259.78 7283.44,-19256.16 7152.75,-19242.93 7119.54,-19246.3 6988.44,-19238.16 6676.76,-19218.81 6324.98,-19196.59 6057.01,-19179.58"/>
<polygon fill="black" stroke="black" points="6056.92,-19176.07 6046.72,-19178.93 6056.47,-19183.06 6056.92,-19176.07"/>
</g>
<!-- expert_l0_e12_gpu12 -->
<g id="node45" class="node">
<title>expert_l0_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8506.44,-19457.33 8050.44,-19457.33 8050.44,-19389.33 8506.44,-19389.33 8506.44,-19457.33"/>
<text text-anchor="middle" x="8278.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E12</text>
<text text-anchor="middle" x="8278.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8278.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8278.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l0_e12_gpu12&#45;&gt;expert_l0_e12_gpu12 -->
<g id="edge57" class="edge">
<title>recv_l0_e12_gpu12&#45;&gt;expert_l0_e12_gpu12</title>
<path fill="none" stroke="black" d="M8278.44,-19494.13C8278.44,-19485.37 8278.44,-19476.27 8278.44,-19467.64"/>
<polygon fill="black" stroke="black" points="8281.94,-19467.41 8278.44,-19457.41 8274.94,-19467.41 8281.94,-19467.41"/>
</g>
<!-- send_l0_e12_gpu12 -->
<g id="node46" class="node">
<title>send_l0_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8278.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8278.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E12</text>
<text text-anchor="middle" x="8278.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8278.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8278.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l0_e12_gpu12&#45;&gt;send_l0_e12_gpu12 -->
<g id="edge58" class="edge">
<title>expert_l0_e12_gpu12&#45;&gt;send_l0_e12_gpu12</title>
<path fill="none" stroke="black" d="M8278.44,-19389.09C8278.44,-19380.84 8278.44,-19371.76 8278.44,-19362.71"/>
<polygon fill="black" stroke="black" points="8281.94,-19362.55 8278.44,-19352.55 8274.94,-19362.55 8281.94,-19362.55"/>
</g>
<!-- send_l0_e12_gpu12&#45;&gt;agg_l0 -->
<g id="edge59" class="edge">
<title>send_l0_e12_gpu12&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M8058.69,-19269.05C8021.3,-19264.1 7982.81,-19259.55 7946.44,-19256.16 7274.83,-19193.63 6490.23,-19168.41 6027.13,-19158.45"/>
<polygon fill="black" stroke="black" points="6027.01,-19154.94 6016.93,-19158.23 6026.86,-19161.94 6027.01,-19154.94"/>
</g>
<!-- expert_l0_e13_gpu13 -->
<g id="node48" class="node">
<title>expert_l0_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9169.44,-19457.33 8713.44,-19457.33 8713.44,-19389.33 9169.44,-19389.33 9169.44,-19457.33"/>
<text text-anchor="middle" x="8941.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E13</text>
<text text-anchor="middle" x="8941.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8941.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8941.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l0_e13_gpu13&#45;&gt;expert_l0_e13_gpu13 -->
<g id="edge61" class="edge">
<title>recv_l0_e13_gpu13&#45;&gt;expert_l0_e13_gpu13</title>
<path fill="none" stroke="black" d="M8941.44,-19494.13C8941.44,-19485.37 8941.44,-19476.27 8941.44,-19467.64"/>
<polygon fill="black" stroke="black" points="8944.94,-19467.41 8941.44,-19457.41 8937.94,-19467.41 8944.94,-19467.41"/>
</g>
<!-- send_l0_e13_gpu13 -->
<g id="node49" class="node">
<title>send_l0_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="8941.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8941.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E13</text>
<text text-anchor="middle" x="8941.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8941.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8941.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l0_e13_gpu13&#45;&gt;send_l0_e13_gpu13 -->
<g id="edge62" class="edge">
<title>expert_l0_e13_gpu13&#45;&gt;send_l0_e13_gpu13</title>
<path fill="none" stroke="black" d="M8941.44,-19389.09C8941.44,-19380.84 8941.44,-19371.76 8941.44,-19362.71"/>
<polygon fill="black" stroke="black" points="8944.94,-19362.55 8941.44,-19352.55 8937.94,-19362.55 8944.94,-19362.55"/>
</g>
<!-- send_l0_e13_gpu13&#45;&gt;agg_l0 -->
<g id="edge63" class="edge">
<title>send_l0_e13_gpu13&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M8722.61,-19268.86C8684.94,-19263.9 8646.12,-19259.39 8609.44,-19256.16 7683.16,-19174.57 6589.8,-19156.26 6018.69,-19152.61"/>
<polygon fill="black" stroke="black" points="6018.67,-19149.11 6008.65,-19152.55 6018.63,-19156.11 6018.67,-19149.11"/>
</g>
<!-- expert_l0_e14_gpu14 -->
<g id="node51" class="node">
<title>expert_l0_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="9832.44,-19457.33 9376.44,-19457.33 9376.44,-19389.33 9832.44,-19389.33 9832.44,-19457.33"/>
<text text-anchor="middle" x="9604.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E14</text>
<text text-anchor="middle" x="9604.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9604.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9604.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l0_e14_gpu14&#45;&gt;expert_l0_e14_gpu14 -->
<g id="edge65" class="edge">
<title>recv_l0_e14_gpu14&#45;&gt;expert_l0_e14_gpu14</title>
<path fill="none" stroke="black" d="M9604.44,-19494.13C9604.44,-19485.37 9604.44,-19476.27 9604.44,-19467.64"/>
<polygon fill="black" stroke="black" points="9607.94,-19467.41 9604.44,-19457.41 9600.94,-19467.41 9607.94,-19467.41"/>
</g>
<!-- send_l0_e14_gpu14 -->
<g id="node52" class="node">
<title>send_l0_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9604.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9604.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E14</text>
<text text-anchor="middle" x="9604.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9604.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9604.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l0_e14_gpu14&#45;&gt;send_l0_e14_gpu14 -->
<g id="edge66" class="edge">
<title>expert_l0_e14_gpu14&#45;&gt;send_l0_e14_gpu14</title>
<path fill="none" stroke="black" d="M9604.44,-19389.09C9604.44,-19380.84 9604.44,-19371.76 9604.44,-19362.71"/>
<polygon fill="black" stroke="black" points="9607.94,-19362.55 9604.44,-19352.55 9600.94,-19362.55 9607.94,-19362.55"/>
</g>
<!-- send_l0_e14_gpu14&#45;&gt;agg_l0 -->
<g id="edge67" class="edge">
<title>send_l0_e14_gpu14&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M9386.52,-19268.78C9348.57,-19263.8 9309.42,-19259.3 9272.44,-19256.16 8652.73,-19203.55 6837.4,-19170.45 6026.14,-19157.89"/>
<polygon fill="black" stroke="black" points="6026.1,-19154.39 6016.05,-19157.73 6025.99,-19161.39 6026.1,-19154.39"/>
</g>
<!-- expert_l0_e15_gpu15 -->
<g id="node54" class="node">
<title>expert_l0_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10495.44,-19457.33 10039.44,-19457.33 10039.44,-19389.33 10495.44,-19389.33 10495.44,-19457.33"/>
<text text-anchor="middle" x="10267.44" y="-19442.13" font-family="Times,serif" font-size="14.00">Expert L0E15</text>
<text text-anchor="middle" x="10267.44" y="-19427.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10267.44" y="-19412.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10267.44" y="-19397.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l0_e15_gpu15&#45;&gt;expert_l0_e15_gpu15 -->
<g id="edge69" class="edge">
<title>recv_l0_e15_gpu15&#45;&gt;expert_l0_e15_gpu15</title>
<path fill="none" stroke="black" d="M10267.44,-19494.13C10267.44,-19485.37 10267.44,-19476.27 10267.44,-19467.64"/>
<polygon fill="black" stroke="black" points="10270.94,-19467.41 10267.44,-19457.41 10263.94,-19467.41 10270.94,-19467.41"/>
</g>
<!-- send_l0_e15_gpu15 -->
<g id="node55" class="node">
<title>send_l0_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10267.44" cy="-19304.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10267.44" y="-19323.05" font-family="Times,serif" font-size="14.00">Token Send L0E15</text>
<text text-anchor="middle" x="10267.44" y="-19308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10267.44" y="-19293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10267.44" y="-19278.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l0_e15_gpu15&#45;&gt;send_l0_e15_gpu15 -->
<g id="edge70" class="edge">
<title>expert_l0_e15_gpu15&#45;&gt;send_l0_e15_gpu15</title>
<path fill="none" stroke="black" d="M10267.44,-19389.09C10267.44,-19380.84 10267.44,-19371.76 10267.44,-19362.71"/>
<polygon fill="black" stroke="black" points="10270.94,-19362.55 10267.44,-19352.55 10263.94,-19362.55 10270.94,-19362.55"/>
</g>
<!-- send_l0_e15_gpu15&#45;&gt;agg_l0 -->
<g id="edge71" class="edge">
<title>send_l0_e15_gpu15&#45;&gt;agg_l0</title>
<path fill="none" stroke="black" d="M10049.97,-19268.7C10011.89,-19263.71 9972.57,-19259.23 9935.44,-19256.16 9183.12,-19193.95 6940.18,-19165.2 6023.48,-19155.81"/>
<polygon fill="black" stroke="black" points="6023.46,-19152.31 6013.43,-19155.71 6023.39,-19159.31 6023.46,-19152.31"/>
</g>
<!-- residual2_l0 -->
<g id="node57" class="node">
<title>residual2_l0</title>
<polygon fill="lightpink" stroke="black" points="5891.94,-19046.16 5456.94,-19046.16 5456.94,-18978.16 5891.94,-18978.16 5891.94,-19046.16"/>
<text text-anchor="middle" x="5674.44" y="-19030.96" font-family="Times,serif" font-size="14.00">ResidualAdd L0</text>
<text text-anchor="middle" x="5674.44" y="-19015.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5674.44" y="-19000.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5674.44" y="-18985.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l0&#45;&gt;residual2_l0 -->
<g id="edge72" class="edge">
<title>agg_l0&#45;&gt;residual2_l0</title>
<path fill="none" stroke="black" d="M5650.02,-19082.87C5653.22,-19073.72 5656.44,-19064.55 5659.43,-19056"/>
<polygon fill="black" stroke="black" points="5662.83,-19056.89 5662.83,-19046.29 5656.22,-19054.57 5662.83,-19056.89"/>
</g>
<!-- residual2_l0&#45;&gt;ln1_l1 -->
<g id="edge73" class="edge">
<title>residual2_l0&#45;&gt;ln1_l1</title>
<path fill="none" stroke="black" d="M5683.45,-18978.01C5685.78,-18969.46 5688.31,-18960.14 5690.75,-18951.17"/>
<polygon fill="black" stroke="black" points="5694.2,-18951.82 5693.44,-18941.26 5687.44,-18949.99 5694.2,-18951.82"/>
</g>
<!-- attn_l1 -->
<g id="node59" class="node">
<title>attn_l1</title>
<polygon fill="lightcoral" stroke="black" points="5932.44,-18836.16 5472.44,-18836.16 5472.44,-18768.16 5932.44,-18768.16 5932.44,-18836.16"/>
<text text-anchor="middle" x="5702.44" y="-18820.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L1</text>
<text text-anchor="middle" x="5702.44" y="-18805.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5702.44" y="-18790.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18775.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l1&#45;&gt;attn_l1 -->
<g id="edge76" class="edge">
<title>ln1_l1&#45;&gt;attn_l1</title>
<path fill="none" stroke="black" d="M5702.44,-18873.01C5702.44,-18864.55 5702.44,-18855.34 5702.44,-18846.46"/>
<polygon fill="black" stroke="black" points="5705.94,-18846.26 5702.44,-18836.26 5698.94,-18846.26 5705.94,-18846.26"/>
</g>
<!-- residual1_l1 -->
<g id="node60" class="node">
<title>residual1_l1</title>
<polygon fill="lightpink" stroke="black" points="5919.94,-18731.16 5484.94,-18731.16 5484.94,-18663.16 5919.94,-18663.16 5919.94,-18731.16"/>
<text text-anchor="middle" x="5702.44" y="-18715.96" font-family="Times,serif" font-size="14.00">ResidualAdd L1</text>
<text text-anchor="middle" x="5702.44" y="-18700.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18685.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18670.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l1&#45;&gt;residual1_l1 -->
<g id="edge77" class="edge">
<title>attn_l1&#45;&gt;residual1_l1</title>
<path fill="none" stroke="black" d="M5702.44,-18768.01C5702.44,-18759.55 5702.44,-18750.34 5702.44,-18741.46"/>
<polygon fill="black" stroke="black" points="5705.94,-18741.26 5702.44,-18731.26 5698.94,-18741.26 5705.94,-18741.26"/>
</g>
<!-- ln2_l1 -->
<g id="node61" class="node">
<title>ln2_l1</title>
<polygon fill="lightyellow" stroke="black" points="5919.94,-18626.16 5484.94,-18626.16 5484.94,-18558.16 5919.94,-18558.16 5919.94,-18626.16"/>
<text text-anchor="middle" x="5702.44" y="-18610.96" font-family="Times,serif" font-size="14.00">LayerNorm L1</text>
<text text-anchor="middle" x="5702.44" y="-18595.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18580.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18565.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l1&#45;&gt;ln2_l1 -->
<g id="edge78" class="edge">
<title>residual1_l1&#45;&gt;ln2_l1</title>
<path fill="none" stroke="black" d="M5702.44,-18663.01C5702.44,-18654.55 5702.44,-18645.34 5702.44,-18636.46"/>
<polygon fill="black" stroke="black" points="5705.94,-18636.26 5702.44,-18626.26 5698.94,-18636.26 5705.94,-18636.26"/>
</g>
<!-- ln2_l1&#45;&gt;route_l1 -->
<g id="edge79" class="edge">
<title>ln2_l1&#45;&gt;route_l1</title>
<path fill="none" stroke="black" d="M5702.44,-18558C5702.44,-18549.86 5702.44,-18540.8 5702.44,-18531.52"/>
<polygon fill="black" stroke="black" points="5705.94,-18531.4 5702.44,-18521.4 5698.94,-18531.4 5705.94,-18531.4"/>
</g>
<!-- recv_l1_e0_gpu0 -->
<g id="node63" class="node">
<title>recv_l1_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="398.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="398.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E0</text>
<text text-anchor="middle" x="398.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="398.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="398.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e0_gpu0 -->
<g id="edge80" class="edge">
<title>route_l1&#45;&gt;recv_l1_e0_gpu0</title>
<path fill="none" stroke="black" d="M5318.34,-18447.47C4576.72,-18437.74 2896,-18412.41 1482.44,-18367.16 1148.07,-18356.46 1063.56,-18365.02 730.44,-18334.16 697.33,-18331.1 662.48,-18327.05 628.29,-18322.62"/>
<polygon fill="black" stroke="black" points="628.56,-18319.13 618.19,-18321.3 627.65,-18326.07 628.56,-18319.13"/>
<text text-anchor="middle" x="1554.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l1_e1_gpu1 -->
<g id="node66" class="node">
<title>recv_l1_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1061.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1061.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E1</text>
<text text-anchor="middle" x="1061.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1061.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1061.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e1_gpu1 -->
<g id="edge84" class="edge">
<title>route_l1&#45;&gt;recv_l1_e1_gpu1</title>
<path fill="none" stroke="black" d="M5315.4,-18445.29C4663.9,-18433.18 3306.87,-18405.64 2159.44,-18367.16 1818.87,-18355.74 1732.76,-18365.46 1393.44,-18334.16 1360.33,-18331.11 1325.47,-18327.07 1291.29,-18322.65"/>
<polygon fill="black" stroke="black" points="1291.56,-18319.15 1281.19,-18321.33 1290.65,-18326.09 1291.56,-18319.15"/>
<text text-anchor="middle" x="2231.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l1_e2_gpu2 -->
<g id="node69" class="node">
<title>recv_l1_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1724.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1724.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E2</text>
<text text-anchor="middle" x="1724.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1724.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1724.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e2_gpu2 -->
<g id="edge88" class="edge">
<title>route_l1&#45;&gt;recv_l1_e2_gpu2</title>
<path fill="none" stroke="black" d="M5311.09,-18442.29C4757.03,-18427.94 3712.24,-18399.46 2822.44,-18367.16 2481.9,-18354.8 2395.76,-18365.46 2056.44,-18334.16 2023.33,-18331.11 1988.47,-18327.07 1954.29,-18322.65"/>
<polygon fill="black" stroke="black" points="1954.56,-18319.15 1944.19,-18321.33 1953.65,-18326.09 1954.56,-18319.15"/>
<text text-anchor="middle" x="2894.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l1_e3_gpu3 -->
<g id="node72" class="node">
<title>recv_l1_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2387.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2387.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E3</text>
<text text-anchor="middle" x="2387.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2387.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2387.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e3_gpu3 -->
<g id="edge92" class="edge">
<title>route_l1&#45;&gt;recv_l1_e3_gpu3</title>
<path fill="none" stroke="black" d="M5304.18,-18437.46C4860.4,-18420.95 4121.54,-18393.06 3485.44,-18367.16 3144.96,-18353.3 3058.76,-18365.46 2719.44,-18334.16 2686.33,-18331.11 2651.47,-18327.07 2617.29,-18322.65"/>
<polygon fill="black" stroke="black" points="2617.56,-18319.15 2607.19,-18321.33 2616.65,-18326.09 2617.56,-18319.15"/>
<text text-anchor="middle" x="3557.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l1_e4_gpu4 -->
<g id="node75" class="node">
<title>recv_l1_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3050.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3050.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E4</text>
<text text-anchor="middle" x="3050.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3050.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3050.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e4_gpu4 -->
<g id="edge96" class="edge">
<title>route_l1&#45;&gt;recv_l1_e4_gpu4</title>
<path fill="none" stroke="black" d="M5312.2,-18443.04C4850.53,-18429.76 4059.13,-18399.22 3382.44,-18334.16 3349.61,-18331.01 3315.05,-18326.94 3281.13,-18322.52"/>
<polygon fill="black" stroke="black" points="3281.48,-18319.04 3271.11,-18321.2 3280.57,-18325.98 3281.48,-18319.04"/>
<text text-anchor="middle" x="3833.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l1_e5_gpu5 -->
<g id="node78" class="node">
<title>recv_l1_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3713.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3713.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E5</text>
<text text-anchor="middle" x="3713.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3713.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3713.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e5_gpu5 -->
<g id="edge100" class="edge">
<title>route_l1&#45;&gt;recv_l1_e5_gpu5</title>
<path fill="none" stroke="black" d="M5267.99,-18412.1C5035.93,-18391.81 4745.31,-18368.15 4485.44,-18352.16 4290.09,-18340.15 4240.35,-18351.93 4045.44,-18334.16 4012.2,-18331.13 3977.19,-18327.1 3942.88,-18322.66"/>
<polygon fill="black" stroke="black" points="3943.11,-18319.16 3932.74,-18321.34 3942.2,-18326.1 3943.11,-18319.16"/>
<text text-anchor="middle" x="4757.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l1_e6_gpu6 -->
<g id="node81" class="node">
<title>recv_l1_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4376.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4376.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E6</text>
<text text-anchor="middle" x="4376.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4376.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4376.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e6_gpu6 -->
<g id="edge104" class="edge">
<title>route_l1&#45;&gt;recv_l1_e6_gpu6</title>
<path fill="none" stroke="black" d="M5288.6,-18385.11C5201.53,-18372.69 5110.11,-18360.9 5024.44,-18352.16 4884.49,-18337.88 4848.43,-18348.05 4708.44,-18334.16 4675.75,-18330.92 4641.34,-18326.82 4607.56,-18322.39"/>
<polygon fill="black" stroke="black" points="4607.95,-18318.92 4597.57,-18321.08 4607.03,-18325.86 4607.95,-18318.92"/>
<text text-anchor="middle" x="5227.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l1_e7_gpu7 -->
<g id="node84" class="node">
<title>recv_l1_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5039.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5039.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E7</text>
<text text-anchor="middle" x="5039.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5039.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5039.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e7_gpu7 -->
<g id="edge108" class="edge">
<title>route_l1&#45;&gt;recv_l1_e7_gpu7</title>
<path fill="none" stroke="black" d="M5496.2,-18385.03C5456.97,-18373.31 5416.1,-18361.8 5377.44,-18352.16 5338.34,-18342.41 5296.38,-18333.28 5255.79,-18325.12"/>
<polygon fill="black" stroke="black" points="5256.27,-18321.65 5245.77,-18323.12 5254.9,-18328.51 5256.27,-18321.65"/>
<text text-anchor="middle" x="5503.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l1_e8_gpu8 -->
<g id="node87" class="node">
<title>recv_l1_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5702.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5702.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E8</text>
<text text-anchor="middle" x="5702.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e8_gpu8 -->
<g id="edge112" class="edge">
<title>route_l1&#45;&gt;recv_l1_e8_gpu8</title>
<path fill="none" stroke="black" d="M5702.44,-18385.02C5702.44,-18371.63 5702.44,-18357.69 5702.44,-18344.66"/>
<polygon fill="black" stroke="black" points="5705.94,-18344.44 5702.44,-18334.44 5698.94,-18344.44 5705.94,-18344.44"/>
<text text-anchor="middle" x="5774.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l1_e9_gpu9 -->
<g id="node90" class="node">
<title>recv_l1_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6365.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6365.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E9</text>
<text text-anchor="middle" x="6365.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6365.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6365.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e9_gpu9 -->
<g id="edge116" class="edge">
<title>route_l1&#45;&gt;recv_l1_e9_gpu9</title>
<path fill="none" stroke="black" d="M5971.63,-18385.14C6046.17,-18366.58 6125.06,-18346.93 6192.51,-18330.14"/>
<polygon fill="black" stroke="black" points="6193.51,-18333.49 6202.37,-18327.68 6191.82,-18326.7 6193.51,-18333.49"/>
<text text-anchor="middle" x="6165.44" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l1_e10_gpu10 -->
<g id="node93" class="node">
<title>recv_l1_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7028.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7028.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E10</text>
<text text-anchor="middle" x="7028.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7028.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7028.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e10_gpu10 -->
<g id="edge120" class="edge">
<title>route_l1&#45;&gt;recv_l1_e10_gpu10</title>
<path fill="none" stroke="black" d="M6025.27,-18415.72C6219.83,-18393.29 6472.53,-18363.33 6696.44,-18334.16 6726.78,-18330.21 6758.66,-18325.9 6790.17,-18321.54"/>
<polygon fill="black" stroke="black" points="6790.96,-18324.96 6800.38,-18320.12 6789.99,-18318.03 6790.96,-18324.96"/>
<text text-anchor="middle" x="6610.94" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l1_e11_gpu11 -->
<g id="node96" class="node">
<title>recv_l1_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7691.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7691.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E11</text>
<text text-anchor="middle" x="7691.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7691.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7691.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e11_gpu11 -->
<g id="edge124" class="edge">
<title>route_l1&#45;&gt;recv_l1_e11_gpu11</title>
<path fill="none" stroke="black" d="M6051.79,-18434.38C6387.56,-18415.62 6909.01,-18382.08 7359.44,-18334.16 7391.44,-18330.76 7425.1,-18326.63 7458.22,-18322.25"/>
<polygon fill="black" stroke="black" points="7459.02,-18325.67 7468.47,-18320.88 7458.1,-18318.73 7459.02,-18325.67"/>
<text text-anchor="middle" x="7256.94" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l1_e12_gpu12 -->
<g id="node99" class="node">
<title>recv_l1_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8354.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8354.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E12</text>
<text text-anchor="middle" x="8354.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8354.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8354.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e12_gpu12 -->
<g id="edge128" class="edge">
<title>route_l1&#45;&gt;recv_l1_e12_gpu12</title>
<path fill="none" stroke="black" d="M6065.35,-18443.81C6522.61,-18430.97 7332.2,-18400.52 8022.44,-18334.16 8055.27,-18331.01 8089.83,-18326.94 8123.75,-18322.52"/>
<polygon fill="black" stroke="black" points="8124.32,-18325.98 8133.77,-18321.2 8123.4,-18319.04 8124.32,-18325.98"/>
<text text-anchor="middle" x="7848.94" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l1_e13_gpu13 -->
<g id="node102" class="node">
<title>recv_l1_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9017.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9017.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E13</text>
<text text-anchor="middle" x="9017.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9017.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9017.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e13_gpu13 -->
<g id="edge132" class="edge">
<title>route_l1&#45;&gt;recv_l1_e13_gpu13</title>
<path fill="none" stroke="black" d="M6058.76,-18439.16C6498.49,-18422.98 7269.1,-18394.18 7929.44,-18367.16 8265.48,-18353.42 8350.55,-18365.14 8685.44,-18334.16 8718.55,-18331.1 8753.41,-18327.06 8787.59,-18322.63"/>
<polygon fill="black" stroke="black" points="8788.23,-18326.08 8797.69,-18321.31 8787.32,-18319.14 8788.23,-18326.08"/>
<text text-anchor="middle" x="8514.94" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l1_e14_gpu14 -->
<g id="node105" class="node">
<title>recv_l1_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9680.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9680.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E14</text>
<text text-anchor="middle" x="9680.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9680.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9680.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e14_gpu14 -->
<g id="edge136" class="edge">
<title>route_l1&#45;&gt;recv_l1_e14_gpu14</title>
<path fill="none" stroke="black" d="M6064.16,-18443.21C6611.91,-18429.27 7684.53,-18400.5 8595.44,-18367.16 8930.2,-18354.91 9014.88,-18365.05 9348.44,-18334.16 9381.55,-18331.1 9416.41,-18327.06 9450.59,-18322.63"/>
<polygon fill="black" stroke="black" points="9451.23,-18326.07 9460.69,-18321.3 9450.32,-18319.13 9451.23,-18326.07"/>
<text text-anchor="middle" x="9178.94" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l1_e15_gpu15 -->
<g id="node108" class="node">
<title>recv_l1_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10343.44" cy="-18286.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10343.44" y="-18304.88" font-family="Times,serif" font-size="14.00">Token Receive L1E15</text>
<text text-anchor="middle" x="10343.44" y="-18289.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10343.44" y="-18274.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10343.44" y="-18259.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l1&#45;&gt;recv_l1_e15_gpu15 -->
<g id="edge140" class="edge">
<title>route_l1&#45;&gt;recv_l1_e15_gpu15</title>
<path fill="none" stroke="black" d="M6067.99,-18445.83C6712.66,-18434.13 8093.79,-18406.66 9259.44,-18367.16 9593.79,-18355.83 9678.32,-18365.02 10011.44,-18334.16 10044.55,-18331.1 10079.41,-18327.05 10113.59,-18322.62"/>
<polygon fill="black" stroke="black" points="10114.23,-18326.07 10123.69,-18321.3 10113.32,-18319.13 10114.23,-18326.07"/>
<text text-anchor="middle" x="9841.94" y="-18355.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l1_e0_gpu0 -->
<g id="node64" class="node">
<title>expert_l1_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="626.44,-18201 170.44,-18201 170.44,-18133 626.44,-18133 626.44,-18201"/>
<text text-anchor="middle" x="398.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E0</text>
<text text-anchor="middle" x="398.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="398.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="398.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l1_e0_gpu0&#45;&gt;expert_l1_e0_gpu0 -->
<g id="edge81" class="edge">
<title>recv_l1_e0_gpu0&#45;&gt;expert_l1_e0_gpu0</title>
<path fill="none" stroke="black" d="M398.44,-18237.79C398.44,-18229.04 398.44,-18219.94 398.44,-18211.31"/>
<polygon fill="black" stroke="black" points="401.94,-18211.08 398.44,-18201.08 394.94,-18211.08 401.94,-18211.08"/>
</g>
<!-- send_l1_e0_gpu0 -->
<g id="node65" class="node">
<title>send_l1_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="398.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="398.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E0</text>
<text text-anchor="middle" x="398.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="398.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="398.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l1_e0_gpu0&#45;&gt;send_l1_e0_gpu0 -->
<g id="edge82" class="edge">
<title>expert_l1_e0_gpu0&#45;&gt;send_l1_e0_gpu0</title>
<path fill="none" stroke="black" d="M398.44,-18132.76C398.44,-18124.51 398.44,-18115.42 398.44,-18106.37"/>
<polygon fill="black" stroke="black" points="401.94,-18106.22 398.44,-18096.22 394.94,-18106.22 401.94,-18106.22"/>
</g>
<!-- agg_l1 -->
<g id="node111" class="node">
<title>agg_l1</title>
<polygon fill="lightgray" stroke="black" points="6180.33,-17962.83 5420.12,-17962.83 5224.55,-17826.83 5984.76,-17826.83 6180.33,-17962.83"/>
<text text-anchor="middle" x="5702.44" y="-17913.63" font-family="Times,serif" font-size="14.00">Expert Aggregation L1</text>
<text text-anchor="middle" x="5702.44" y="-17898.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-17883.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-17868.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l1_e0_gpu0&#45;&gt;agg_l1 -->
<g id="edge83" class="edge">
<title>send_l1_e0_gpu0&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M615.45,-18012.32C653.68,-18007.32 693.16,-18002.85 730.44,-17999.83 1618.88,-17927.8 4308.64,-17904.31 5316.01,-17897.91"/>
<polygon fill="black" stroke="black" points="5316.34,-17901.41 5326.32,-17897.85 5316.29,-17894.41 5316.34,-17901.41"/>
</g>
<!-- expert_l1_e1_gpu1 -->
<g id="node67" class="node">
<title>expert_l1_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1289.44,-18201 833.44,-18201 833.44,-18133 1289.44,-18133 1289.44,-18201"/>
<text text-anchor="middle" x="1061.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E1</text>
<text text-anchor="middle" x="1061.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1061.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1061.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l1_e1_gpu1&#45;&gt;expert_l1_e1_gpu1 -->
<g id="edge85" class="edge">
<title>recv_l1_e1_gpu1&#45;&gt;expert_l1_e1_gpu1</title>
<path fill="none" stroke="black" d="M1061.44,-18237.79C1061.44,-18229.04 1061.44,-18219.94 1061.44,-18211.31"/>
<polygon fill="black" stroke="black" points="1064.94,-18211.08 1061.44,-18201.08 1057.94,-18211.08 1064.94,-18211.08"/>
</g>
<!-- send_l1_e1_gpu1 -->
<g id="node68" class="node">
<title>send_l1_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1061.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1061.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E1</text>
<text text-anchor="middle" x="1061.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1061.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1061.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l1_e1_gpu1&#45;&gt;send_l1_e1_gpu1 -->
<g id="edge86" class="edge">
<title>expert_l1_e1_gpu1&#45;&gt;send_l1_e1_gpu1</title>
<path fill="none" stroke="black" d="M1061.44,-18132.76C1061.44,-18124.51 1061.44,-18115.42 1061.44,-18106.37"/>
<polygon fill="black" stroke="black" points="1064.94,-18106.22 1061.44,-18096.22 1057.94,-18106.22 1064.94,-18106.22"/>
</g>
<!-- send_l1_e1_gpu1&#45;&gt;agg_l1 -->
<g id="edge87" class="edge">
<title>send_l1_e1_gpu1&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M1278.91,-18012.37C1316.99,-18007.38 1356.31,-18002.9 1393.44,-17999.83 2149.27,-17937.33 4409.64,-17908.6 5318.13,-17899.35"/>
<polygon fill="black" stroke="black" points="5318.46,-17902.85 5328.42,-17899.24 5318.39,-17895.85 5318.46,-17902.85"/>
</g>
<!-- expert_l1_e2_gpu2 -->
<g id="node70" class="node">
<title>expert_l1_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="1952.44,-18201 1496.44,-18201 1496.44,-18133 1952.44,-18133 1952.44,-18201"/>
<text text-anchor="middle" x="1724.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E2</text>
<text text-anchor="middle" x="1724.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1724.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1724.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l1_e2_gpu2&#45;&gt;expert_l1_e2_gpu2 -->
<g id="edge89" class="edge">
<title>recv_l1_e2_gpu2&#45;&gt;expert_l1_e2_gpu2</title>
<path fill="none" stroke="black" d="M1724.44,-18237.79C1724.44,-18229.04 1724.44,-18219.94 1724.44,-18211.31"/>
<polygon fill="black" stroke="black" points="1727.94,-18211.08 1724.44,-18201.08 1720.94,-18211.08 1727.94,-18211.08"/>
</g>
<!-- send_l1_e2_gpu2 -->
<g id="node71" class="node">
<title>send_l1_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1724.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1724.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E2</text>
<text text-anchor="middle" x="1724.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1724.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1724.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l1_e2_gpu2&#45;&gt;send_l1_e2_gpu2 -->
<g id="edge90" class="edge">
<title>expert_l1_e2_gpu2&#45;&gt;send_l1_e2_gpu2</title>
<path fill="none" stroke="black" d="M1724.44,-18132.76C1724.44,-18124.51 1724.44,-18115.42 1724.44,-18106.37"/>
<polygon fill="black" stroke="black" points="1727.94,-18106.22 1724.44,-18096.22 1720.94,-18106.22 1727.94,-18106.22"/>
</g>
<!-- send_l1_e2_gpu2&#45;&gt;agg_l1 -->
<g id="edge91" class="edge">
<title>send_l1_e2_gpu2&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M1942.36,-18012.45C1980.31,-18007.46 2019.46,-18002.97 2056.44,-17999.83 2680.79,-17946.82 4518.71,-17913.62 5320.78,-17901.28"/>
<polygon fill="black" stroke="black" points="5321.1,-17904.77 5331.05,-17901.12 5320.99,-17897.77 5321.1,-17904.77"/>
</g>
<!-- expert_l1_e3_gpu3 -->
<g id="node73" class="node">
<title>expert_l1_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2615.44,-18201 2159.44,-18201 2159.44,-18133 2615.44,-18133 2615.44,-18201"/>
<text text-anchor="middle" x="2387.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E3</text>
<text text-anchor="middle" x="2387.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2387.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2387.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l1_e3_gpu3&#45;&gt;expert_l1_e3_gpu3 -->
<g id="edge93" class="edge">
<title>recv_l1_e3_gpu3&#45;&gt;expert_l1_e3_gpu3</title>
<path fill="none" stroke="black" d="M2387.44,-18237.79C2387.44,-18229.04 2387.44,-18219.94 2387.44,-18211.31"/>
<polygon fill="black" stroke="black" points="2390.94,-18211.08 2387.44,-18201.08 2383.94,-18211.08 2390.94,-18211.08"/>
</g>
<!-- send_l1_e3_gpu3 -->
<g id="node74" class="node">
<title>send_l1_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2387.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2387.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E3</text>
<text text-anchor="middle" x="2387.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2387.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2387.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l1_e3_gpu3&#45;&gt;send_l1_e3_gpu3 -->
<g id="edge94" class="edge">
<title>expert_l1_e3_gpu3&#45;&gt;send_l1_e3_gpu3</title>
<path fill="none" stroke="black" d="M2387.44,-18132.76C2387.44,-18124.51 2387.44,-18115.42 2387.44,-18106.37"/>
<polygon fill="black" stroke="black" points="2390.94,-18106.22 2387.44,-18096.22 2383.94,-18106.22 2390.94,-18106.22"/>
</g>
<!-- send_l1_e3_gpu3&#45;&gt;agg_l1 -->
<g id="edge95" class="edge">
<title>send_l1_e3_gpu3&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M2606.27,-18012.53C2643.94,-18007.57 2682.76,-18003.06 2719.44,-17999.83 3647.8,-17918.05 4744,-17899.85 5314.04,-17896.25"/>
<polygon fill="black" stroke="black" points="5314.08,-17899.75 5324.06,-17896.19 5314.04,-17892.75 5314.08,-17899.75"/>
</g>
<!-- expert_l1_e4_gpu4 -->
<g id="node76" class="node">
<title>expert_l1_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3278.44,-18201 2822.44,-18201 2822.44,-18133 3278.44,-18133 3278.44,-18201"/>
<text text-anchor="middle" x="3050.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E4</text>
<text text-anchor="middle" x="3050.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3050.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3050.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l1_e4_gpu4&#45;&gt;expert_l1_e4_gpu4 -->
<g id="edge97" class="edge">
<title>recv_l1_e4_gpu4&#45;&gt;expert_l1_e4_gpu4</title>
<path fill="none" stroke="black" d="M3050.44,-18237.79C3050.44,-18229.04 3050.44,-18219.94 3050.44,-18211.31"/>
<polygon fill="black" stroke="black" points="3053.94,-18211.08 3050.44,-18201.08 3046.94,-18211.08 3053.94,-18211.08"/>
</g>
<!-- send_l1_e4_gpu4 -->
<g id="node77" class="node">
<title>send_l1_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3050.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3050.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E4</text>
<text text-anchor="middle" x="3050.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3050.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3050.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l1_e4_gpu4&#45;&gt;send_l1_e4_gpu4 -->
<g id="edge98" class="edge">
<title>expert_l1_e4_gpu4&#45;&gt;send_l1_e4_gpu4</title>
<path fill="none" stroke="black" d="M3050.44,-18132.76C3050.44,-18124.51 3050.44,-18115.42 3050.44,-18106.37"/>
<polygon fill="black" stroke="black" points="3053.94,-18106.22 3050.44,-18096.22 3046.94,-18106.22 3053.94,-18106.22"/>
</g>
<!-- send_l1_e4_gpu4&#45;&gt;agg_l1 -->
<g id="edge99" class="edge">
<title>send_l1_e4_gpu4&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M3270.2,-18012.72C3307.58,-18007.77 3346.07,-18003.22 3382.44,-17999.83 4063.76,-17936.39 4861.37,-17911.36 5321.64,-17901.69"/>
<polygon fill="black" stroke="black" points="5321.85,-17905.19 5331.77,-17901.48 5321.7,-17898.19 5321.85,-17905.19"/>
</g>
<!-- expert_l1_e5_gpu5 -->
<g id="node79" class="node">
<title>expert_l1_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="3941.44,-18201 3485.44,-18201 3485.44,-18133 3941.44,-18133 3941.44,-18201"/>
<text text-anchor="middle" x="3713.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E5</text>
<text text-anchor="middle" x="3713.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3713.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3713.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l1_e5_gpu5&#45;&gt;expert_l1_e5_gpu5 -->
<g id="edge101" class="edge">
<title>recv_l1_e5_gpu5&#45;&gt;expert_l1_e5_gpu5</title>
<path fill="none" stroke="black" d="M3713.44,-18237.79C3713.44,-18229.04 3713.44,-18219.94 3713.44,-18211.31"/>
<polygon fill="black" stroke="black" points="3716.94,-18211.08 3713.44,-18201.08 3709.94,-18211.08 3716.94,-18211.08"/>
</g>
<!-- send_l1_e5_gpu5 -->
<g id="node80" class="node">
<title>send_l1_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3713.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3713.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E5</text>
<text text-anchor="middle" x="3713.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3713.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3713.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l1_e5_gpu5&#45;&gt;send_l1_e5_gpu5 -->
<g id="edge102" class="edge">
<title>expert_l1_e5_gpu5&#45;&gt;send_l1_e5_gpu5</title>
<path fill="none" stroke="black" d="M3713.44,-18132.76C3713.44,-18124.51 3713.44,-18115.42 3713.44,-18106.37"/>
<polygon fill="black" stroke="black" points="3716.94,-18106.22 3713.44,-18096.22 3709.94,-18106.22 3716.94,-18106.22"/>
</g>
<!-- send_l1_e5_gpu5&#45;&gt;agg_l1 -->
<g id="edge103" class="edge">
<title>send_l1_e5_gpu5&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M3935.49,-18012.97C3972.16,-18008.07 4009.82,-18003.47 4045.44,-17999.83 4487.29,-17954.7 4997.57,-17926.22 5333.81,-17910.7"/>
<polygon fill="black" stroke="black" points="5334.38,-17914.17 5344.2,-17910.22 5334.05,-17907.18 5334.38,-17914.17"/>
</g>
<!-- expert_l1_e6_gpu6 -->
<g id="node82" class="node">
<title>expert_l1_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4604.44,-18201 4148.44,-18201 4148.44,-18133 4604.44,-18133 4604.44,-18201"/>
<text text-anchor="middle" x="4376.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E6</text>
<text text-anchor="middle" x="4376.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4376.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4376.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l1_e6_gpu6&#45;&gt;expert_l1_e6_gpu6 -->
<g id="edge105" class="edge">
<title>recv_l1_e6_gpu6&#45;&gt;expert_l1_e6_gpu6</title>
<path fill="none" stroke="black" d="M4376.44,-18237.79C4376.44,-18229.04 4376.44,-18219.94 4376.44,-18211.31"/>
<polygon fill="black" stroke="black" points="4379.94,-18211.08 4376.44,-18201.08 4372.94,-18211.08 4379.94,-18211.08"/>
</g>
<!-- send_l1_e6_gpu6 -->
<g id="node83" class="node">
<title>send_l1_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4376.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4376.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E6</text>
<text text-anchor="middle" x="4376.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4376.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4376.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l1_e6_gpu6&#45;&gt;send_l1_e6_gpu6 -->
<g id="edge106" class="edge">
<title>expert_l1_e6_gpu6&#45;&gt;send_l1_e6_gpu6</title>
<path fill="none" stroke="black" d="M4376.44,-18132.76C4376.44,-18124.51 4376.44,-18115.42 4376.44,-18106.37"/>
<polygon fill="black" stroke="black" points="4379.94,-18106.22 4376.44,-18096.22 4372.94,-18106.22 4379.94,-18106.22"/>
</g>
<!-- send_l1_e6_gpu6&#45;&gt;agg_l1 -->
<g id="edge107" class="edge">
<title>send_l1_e6_gpu6&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M4603.1,-18013.64C4638.34,-18008.79 4674.35,-18004.03 4708.44,-17999.83 4924.57,-17973.21 5167.69,-17947.69 5359.39,-17928.6"/>
<polygon fill="black" stroke="black" points="5359.74,-17932.08 5369.34,-17927.61 5359.05,-17925.11 5359.74,-17932.08"/>
</g>
<!-- expert_l1_e7_gpu7 -->
<g id="node85" class="node">
<title>expert_l1_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5267.44,-18201 4811.44,-18201 4811.44,-18133 5267.44,-18133 5267.44,-18201"/>
<text text-anchor="middle" x="5039.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E7</text>
<text text-anchor="middle" x="5039.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5039.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5039.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l1_e7_gpu7&#45;&gt;expert_l1_e7_gpu7 -->
<g id="edge109" class="edge">
<title>recv_l1_e7_gpu7&#45;&gt;expert_l1_e7_gpu7</title>
<path fill="none" stroke="black" d="M5039.44,-18237.79C5039.44,-18229.04 5039.44,-18219.94 5039.44,-18211.31"/>
<polygon fill="black" stroke="black" points="5042.94,-18211.08 5039.44,-18201.08 5035.94,-18211.08 5042.94,-18211.08"/>
</g>
<!-- send_l1_e7_gpu7 -->
<g id="node86" class="node">
<title>send_l1_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5039.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5039.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E7</text>
<text text-anchor="middle" x="5039.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5039.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5039.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l1_e7_gpu7&#45;&gt;send_l1_e7_gpu7 -->
<g id="edge110" class="edge">
<title>expert_l1_e7_gpu7&#45;&gt;send_l1_e7_gpu7</title>
<path fill="none" stroke="black" d="M5039.44,-18132.76C5039.44,-18124.51 5039.44,-18115.42 5039.44,-18106.37"/>
<polygon fill="black" stroke="black" points="5042.94,-18106.22 5039.44,-18096.22 5035.94,-18106.22 5042.94,-18106.22"/>
</g>
<!-- send_l1_e7_gpu7&#45;&gt;agg_l1 -->
<g id="edge111" class="edge">
<title>send_l1_e7_gpu7&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M5213.2,-18007.32C5272.63,-17993.77 5340.87,-17978.22 5407.16,-17963.12"/>
<polygon fill="black" stroke="black" points="5407.95,-17966.53 5416.92,-17960.89 5406.39,-17959.7 5407.95,-17966.53"/>
</g>
<!-- expert_l1_e8_gpu8 -->
<g id="node88" class="node">
<title>expert_l1_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="5930.44,-18201 5474.44,-18201 5474.44,-18133 5930.44,-18133 5930.44,-18201"/>
<text text-anchor="middle" x="5702.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E8</text>
<text text-anchor="middle" x="5702.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l1_e8_gpu8&#45;&gt;expert_l1_e8_gpu8 -->
<g id="edge113" class="edge">
<title>recv_l1_e8_gpu8&#45;&gt;expert_l1_e8_gpu8</title>
<path fill="none" stroke="black" d="M5702.44,-18237.79C5702.44,-18229.04 5702.44,-18219.94 5702.44,-18211.31"/>
<polygon fill="black" stroke="black" points="5705.94,-18211.08 5702.44,-18201.08 5698.94,-18211.08 5705.94,-18211.08"/>
</g>
<!-- send_l1_e8_gpu8 -->
<g id="node89" class="node">
<title>send_l1_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5702.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5702.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E8</text>
<text text-anchor="middle" x="5702.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5702.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l1_e8_gpu8&#45;&gt;send_l1_e8_gpu8 -->
<g id="edge114" class="edge">
<title>expert_l1_e8_gpu8&#45;&gt;send_l1_e8_gpu8</title>
<path fill="none" stroke="black" d="M5702.44,-18132.76C5702.44,-18124.51 5702.44,-18115.42 5702.44,-18106.37"/>
<polygon fill="black" stroke="black" points="5705.94,-18106.22 5702.44,-18096.22 5698.94,-18106.22 5705.94,-18106.22"/>
</g>
<!-- send_l1_e8_gpu8&#45;&gt;agg_l1 -->
<g id="edge115" class="edge">
<title>send_l1_e8_gpu8&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M5702.44,-17999.52C5702.44,-17991.1 5702.44,-17982.13 5702.44,-17973.12"/>
<polygon fill="black" stroke="black" points="5705.94,-17972.97 5702.44,-17962.97 5698.94,-17972.97 5705.94,-17972.97"/>
</g>
<!-- expert_l1_e9_gpu9 -->
<g id="node91" class="node">
<title>expert_l1_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6593.44,-18201 6137.44,-18201 6137.44,-18133 6593.44,-18133 6593.44,-18201"/>
<text text-anchor="middle" x="6365.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E9</text>
<text text-anchor="middle" x="6365.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6365.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6365.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l1_e9_gpu9&#45;&gt;expert_l1_e9_gpu9 -->
<g id="edge117" class="edge">
<title>recv_l1_e9_gpu9&#45;&gt;expert_l1_e9_gpu9</title>
<path fill="none" stroke="black" d="M6365.44,-18237.79C6365.44,-18229.04 6365.44,-18219.94 6365.44,-18211.31"/>
<polygon fill="black" stroke="black" points="6368.94,-18211.08 6365.44,-18201.08 6361.94,-18211.08 6368.94,-18211.08"/>
</g>
<!-- send_l1_e9_gpu9 -->
<g id="node92" class="node">
<title>send_l1_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6365.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6365.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E9</text>
<text text-anchor="middle" x="6365.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6365.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6365.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l1_e9_gpu9&#45;&gt;send_l1_e9_gpu9 -->
<g id="edge118" class="edge">
<title>expert_l1_e9_gpu9&#45;&gt;send_l1_e9_gpu9</title>
<path fill="none" stroke="black" d="M6365.44,-18132.76C6365.44,-18124.51 6365.44,-18115.42 6365.44,-18106.37"/>
<polygon fill="black" stroke="black" points="6368.94,-18106.22 6365.44,-18096.22 6361.94,-18106.22 6368.94,-18106.22"/>
</g>
<!-- send_l1_e9_gpu9&#45;&gt;agg_l1 -->
<g id="edge119" class="edge">
<title>send_l1_e9_gpu9&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M6191.68,-18007.32C6134.84,-17994.36 6069.93,-17979.57 6006.39,-17965.09"/>
<polygon fill="black" stroke="black" points="6007.14,-17961.67 5996.61,-17962.86 6005.59,-17968.5 6007.14,-17961.67"/>
</g>
<!-- expert_l1_e10_gpu10 -->
<g id="node94" class="node">
<title>expert_l1_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7256.44,-18201 6800.44,-18201 6800.44,-18133 7256.44,-18133 7256.44,-18201"/>
<text text-anchor="middle" x="7028.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E10</text>
<text text-anchor="middle" x="7028.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7028.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7028.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l1_e10_gpu10&#45;&gt;expert_l1_e10_gpu10 -->
<g id="edge121" class="edge">
<title>recv_l1_e10_gpu10&#45;&gt;expert_l1_e10_gpu10</title>
<path fill="none" stroke="black" d="M7028.44,-18237.79C7028.44,-18229.04 7028.44,-18219.94 7028.44,-18211.31"/>
<polygon fill="black" stroke="black" points="7031.94,-18211.08 7028.44,-18201.08 7024.94,-18211.08 7031.94,-18211.08"/>
</g>
<!-- send_l1_e10_gpu10 -->
<g id="node95" class="node">
<title>send_l1_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7028.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7028.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E10</text>
<text text-anchor="middle" x="7028.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7028.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7028.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l1_e10_gpu10&#45;&gt;send_l1_e10_gpu10 -->
<g id="edge122" class="edge">
<title>expert_l1_e10_gpu10&#45;&gt;send_l1_e10_gpu10</title>
<path fill="none" stroke="black" d="M7028.44,-18132.76C7028.44,-18124.51 7028.44,-18115.42 7028.44,-18106.37"/>
<polygon fill="black" stroke="black" points="7031.94,-18106.22 7028.44,-18096.22 7024.94,-18106.22 7031.94,-18106.22"/>
</g>
<!-- send_l1_e10_gpu10&#45;&gt;agg_l1 -->
<g id="edge123" class="edge">
<title>send_l1_e10_gpu10&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M6801.78,-18013.64C6766.54,-18008.79 6730.53,-18004.03 6696.44,-17999.83 6520,-17978.09 6325.57,-17957.1 6155.81,-17939.73"/>
<polygon fill="black" stroke="black" points="6156,-17936.23 6145.69,-17938.7 6155.29,-17943.2 6156,-17936.23"/>
</g>
<!-- expert_l1_e11_gpu11 -->
<g id="node97" class="node">
<title>expert_l1_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="7919.44,-18201 7463.44,-18201 7463.44,-18133 7919.44,-18133 7919.44,-18201"/>
<text text-anchor="middle" x="7691.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E11</text>
<text text-anchor="middle" x="7691.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7691.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7691.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l1_e11_gpu11&#45;&gt;expert_l1_e11_gpu11 -->
<g id="edge125" class="edge">
<title>recv_l1_e11_gpu11&#45;&gt;expert_l1_e11_gpu11</title>
<path fill="none" stroke="black" d="M7691.44,-18237.79C7691.44,-18229.04 7691.44,-18219.94 7691.44,-18211.31"/>
<polygon fill="black" stroke="black" points="7694.94,-18211.08 7691.44,-18201.08 7687.94,-18211.08 7694.94,-18211.08"/>
</g>
<!-- send_l1_e11_gpu11 -->
<g id="node98" class="node">
<title>send_l1_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7691.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7691.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E11</text>
<text text-anchor="middle" x="7691.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7691.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7691.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l1_e11_gpu11&#45;&gt;send_l1_e11_gpu11 -->
<g id="edge126" class="edge">
<title>expert_l1_e11_gpu11&#45;&gt;send_l1_e11_gpu11</title>
<path fill="none" stroke="black" d="M7691.44,-18132.76C7691.44,-18124.51 7691.44,-18115.42 7691.44,-18106.37"/>
<polygon fill="black" stroke="black" points="7694.94,-18106.22 7691.44,-18096.22 7687.94,-18106.22 7694.94,-18106.22"/>
</g>
<!-- send_l1_e11_gpu11&#45;&gt;agg_l1 -->
<g id="edge127" class="edge">
<title>send_l1_e11_gpu11&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M7469.4,-18012.97C7432.72,-18008.07 7395.06,-18003.47 7359.44,-17999.83 6937.81,-17956.77 6453.87,-17928.86 6118.31,-17912.91"/>
<polygon fill="black" stroke="black" points="6118.08,-17909.39 6107.92,-17912.42 6117.75,-17916.39 6118.08,-17909.39"/>
</g>
<!-- expert_l1_e12_gpu12 -->
<g id="node100" class="node">
<title>expert_l1_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8582.44,-18201 8126.44,-18201 8126.44,-18133 8582.44,-18133 8582.44,-18201"/>
<text text-anchor="middle" x="8354.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E12</text>
<text text-anchor="middle" x="8354.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8354.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8354.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l1_e12_gpu12&#45;&gt;expert_l1_e12_gpu12 -->
<g id="edge129" class="edge">
<title>recv_l1_e12_gpu12&#45;&gt;expert_l1_e12_gpu12</title>
<path fill="none" stroke="black" d="M8354.44,-18237.79C8354.44,-18229.04 8354.44,-18219.94 8354.44,-18211.31"/>
<polygon fill="black" stroke="black" points="8357.94,-18211.08 8354.44,-18201.08 8350.94,-18211.08 8357.94,-18211.08"/>
</g>
<!-- send_l1_e12_gpu12 -->
<g id="node101" class="node">
<title>send_l1_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8354.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8354.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E12</text>
<text text-anchor="middle" x="8354.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8354.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8354.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l1_e12_gpu12&#45;&gt;send_l1_e12_gpu12 -->
<g id="edge130" class="edge">
<title>expert_l1_e12_gpu12&#45;&gt;send_l1_e12_gpu12</title>
<path fill="none" stroke="black" d="M8354.44,-18132.76C8354.44,-18124.51 8354.44,-18115.42 8354.44,-18106.37"/>
<polygon fill="black" stroke="black" points="8357.94,-18106.22 8354.44,-18096.22 8350.94,-18106.22 8357.94,-18106.22"/>
</g>
<!-- send_l1_e12_gpu12&#45;&gt;agg_l1 -->
<g id="edge131" class="edge">
<title>send_l1_e12_gpu12&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M8134.69,-18012.72C8097.3,-18007.77 8058.81,-18003.22 8022.44,-17999.83 7350.83,-17937.3 6566.23,-17912.08 6103.13,-17902.11"/>
<polygon fill="black" stroke="black" points="6103.01,-17898.61 6092.93,-17901.89 6102.86,-17905.61 6103.01,-17898.61"/>
</g>
<!-- expert_l1_e13_gpu13 -->
<g id="node103" class="node">
<title>expert_l1_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9245.44,-18201 8789.44,-18201 8789.44,-18133 9245.44,-18133 9245.44,-18201"/>
<text text-anchor="middle" x="9017.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E13</text>
<text text-anchor="middle" x="9017.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9017.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9017.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l1_e13_gpu13&#45;&gt;expert_l1_e13_gpu13 -->
<g id="edge133" class="edge">
<title>recv_l1_e13_gpu13&#45;&gt;expert_l1_e13_gpu13</title>
<path fill="none" stroke="black" d="M9017.44,-18237.79C9017.44,-18229.04 9017.44,-18219.94 9017.44,-18211.31"/>
<polygon fill="black" stroke="black" points="9020.94,-18211.08 9017.44,-18201.08 9013.94,-18211.08 9020.94,-18211.08"/>
</g>
<!-- send_l1_e13_gpu13 -->
<g id="node104" class="node">
<title>send_l1_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9017.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9017.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E13</text>
<text text-anchor="middle" x="9017.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9017.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9017.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l1_e13_gpu13&#45;&gt;send_l1_e13_gpu13 -->
<g id="edge134" class="edge">
<title>expert_l1_e13_gpu13&#45;&gt;send_l1_e13_gpu13</title>
<path fill="none" stroke="black" d="M9017.44,-18132.76C9017.44,-18124.51 9017.44,-18115.42 9017.44,-18106.37"/>
<polygon fill="black" stroke="black" points="9020.94,-18106.22 9017.44,-18096.22 9013.94,-18106.22 9020.94,-18106.22"/>
</g>
<!-- send_l1_e13_gpu13&#45;&gt;agg_l1 -->
<g id="edge135" class="edge">
<title>send_l1_e13_gpu13&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M8798.61,-18012.53C8760.94,-18007.57 8722.12,-18003.06 8685.44,-17999.83 7759.16,-17918.23 6665.8,-17899.93 6094.69,-17896.28"/>
<polygon fill="black" stroke="black" points="6094.67,-17892.78 6084.65,-17896.21 6094.63,-17899.78 6094.67,-17892.78"/>
</g>
<!-- expert_l1_e14_gpu14 -->
<g id="node106" class="node">
<title>expert_l1_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="9908.44,-18201 9452.44,-18201 9452.44,-18133 9908.44,-18133 9908.44,-18201"/>
<text text-anchor="middle" x="9680.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E14</text>
<text text-anchor="middle" x="9680.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9680.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9680.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l1_e14_gpu14&#45;&gt;expert_l1_e14_gpu14 -->
<g id="edge137" class="edge">
<title>recv_l1_e14_gpu14&#45;&gt;expert_l1_e14_gpu14</title>
<path fill="none" stroke="black" d="M9680.44,-18237.79C9680.44,-18229.04 9680.44,-18219.94 9680.44,-18211.31"/>
<polygon fill="black" stroke="black" points="9683.94,-18211.08 9680.44,-18201.08 9676.94,-18211.08 9683.94,-18211.08"/>
</g>
<!-- send_l1_e14_gpu14 -->
<g id="node107" class="node">
<title>send_l1_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9680.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9680.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E14</text>
<text text-anchor="middle" x="9680.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9680.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9680.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l1_e14_gpu14&#45;&gt;send_l1_e14_gpu14 -->
<g id="edge138" class="edge">
<title>expert_l1_e14_gpu14&#45;&gt;send_l1_e14_gpu14</title>
<path fill="none" stroke="black" d="M9680.44,-18132.76C9680.44,-18124.51 9680.44,-18115.42 9680.44,-18106.37"/>
<polygon fill="black" stroke="black" points="9683.94,-18106.22 9680.44,-18096.22 9676.94,-18106.22 9683.94,-18106.22"/>
</g>
<!-- send_l1_e14_gpu14&#45;&gt;agg_l1 -->
<g id="edge139" class="edge">
<title>send_l1_e14_gpu14&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M9462.52,-18012.45C9424.57,-18007.46 9385.42,-18002.97 9348.44,-17999.83 8728.73,-17947.22 6913.4,-17914.11 6102.14,-17901.56"/>
<polygon fill="black" stroke="black" points="6102.1,-17898.05 6092.05,-17901.4 6101.99,-17905.05 6102.1,-17898.05"/>
</g>
<!-- expert_l1_e15_gpu15 -->
<g id="node109" class="node">
<title>expert_l1_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10571.44,-18201 10115.44,-18201 10115.44,-18133 10571.44,-18133 10571.44,-18201"/>
<text text-anchor="middle" x="10343.44" y="-18185.8" font-family="Times,serif" font-size="14.00">Expert L1E15</text>
<text text-anchor="middle" x="10343.44" y="-18170.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10343.44" y="-18155.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10343.44" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l1_e15_gpu15&#45;&gt;expert_l1_e15_gpu15 -->
<g id="edge141" class="edge">
<title>recv_l1_e15_gpu15&#45;&gt;expert_l1_e15_gpu15</title>
<path fill="none" stroke="black" d="M10343.44,-18237.79C10343.44,-18229.04 10343.44,-18219.94 10343.44,-18211.31"/>
<polygon fill="black" stroke="black" points="10346.94,-18211.08 10343.44,-18201.08 10339.94,-18211.08 10346.94,-18211.08"/>
</g>
<!-- send_l1_e15_gpu15 -->
<g id="node110" class="node">
<title>send_l1_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10343.44" cy="-18047.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10343.44" y="-18066.71" font-family="Times,serif" font-size="14.00">Token Send L1E15</text>
<text text-anchor="middle" x="10343.44" y="-18051.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10343.44" y="-18036.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10343.44" y="-18021.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l1_e15_gpu15&#45;&gt;send_l1_e15_gpu15 -->
<g id="edge142" class="edge">
<title>expert_l1_e15_gpu15&#45;&gt;send_l1_e15_gpu15</title>
<path fill="none" stroke="black" d="M10343.44,-18132.76C10343.44,-18124.51 10343.44,-18115.42 10343.44,-18106.37"/>
<polygon fill="black" stroke="black" points="10346.94,-18106.22 10343.44,-18096.22 10339.94,-18106.22 10346.94,-18106.22"/>
</g>
<!-- send_l1_e15_gpu15&#45;&gt;agg_l1 -->
<g id="edge143" class="edge">
<title>send_l1_e15_gpu15&#45;&gt;agg_l1</title>
<path fill="none" stroke="black" d="M10125.97,-18012.37C10087.89,-18007.38 10048.57,-18002.9 10011.44,-17999.83 9259.12,-17937.62 7016.18,-17908.87 6099.48,-17899.48"/>
<polygon fill="black" stroke="black" points="6099.46,-17895.98 6089.43,-17899.38 6099.39,-17902.98 6099.46,-17895.98"/>
</g>
<!-- residual2_l1 -->
<g id="node112" class="node">
<title>residual2_l1</title>
<polygon fill="lightpink" stroke="black" points="5976.94,-17789.83 5541.94,-17789.83 5541.94,-17721.83 5976.94,-17721.83 5976.94,-17789.83"/>
<text text-anchor="middle" x="5759.44" y="-17774.63" font-family="Times,serif" font-size="14.00">ResidualAdd L1</text>
<text text-anchor="middle" x="5759.44" y="-17759.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5759.44" y="-17744.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5759.44" y="-17729.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l1&#45;&gt;residual2_l1 -->
<g id="edge144" class="edge">
<title>agg_l1&#45;&gt;residual2_l1</title>
<path fill="none" stroke="black" d="M5730.44,-17826.53C5734.29,-17817.29 5738.14,-17808.02 5741.73,-17799.39"/>
<polygon fill="black" stroke="black" points="5745.05,-17800.53 5745.66,-17789.96 5738.58,-17797.85 5745.05,-17800.53"/>
</g>
<!-- residual2_l1&#45;&gt;ln1_l2 -->
<g id="edge145" class="edge">
<title>residual2_l1&#45;&gt;ln1_l2</title>
<path fill="none" stroke="black" d="M5765.56,-17721.67C5767.13,-17713.13 5768.85,-17703.81 5770.51,-17694.84"/>
<polygon fill="black" stroke="black" points="5773.96,-17695.39 5772.34,-17684.92 5767.08,-17694.12 5773.96,-17695.39"/>
</g>
<!-- attn_l2 -->
<g id="node114" class="node">
<title>attn_l2</title>
<polygon fill="lightcoral" stroke="black" points="6008.44,-17579.83 5548.44,-17579.83 5548.44,-17511.83 6008.44,-17511.83 6008.44,-17579.83"/>
<text text-anchor="middle" x="5778.44" y="-17564.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L2</text>
<text text-anchor="middle" x="5778.44" y="-17549.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5778.44" y="-17534.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17519.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l2&#45;&gt;attn_l2 -->
<g id="edge148" class="edge">
<title>ln1_l2&#45;&gt;attn_l2</title>
<path fill="none" stroke="black" d="M5778.44,-17616.67C5778.44,-17608.22 5778.44,-17599.01 5778.44,-17590.13"/>
<polygon fill="black" stroke="black" points="5781.94,-17589.92 5778.44,-17579.92 5774.94,-17589.92 5781.94,-17589.92"/>
</g>
<!-- residual1_l2 -->
<g id="node115" class="node">
<title>residual1_l2</title>
<polygon fill="lightpink" stroke="black" points="5995.94,-17474.83 5560.94,-17474.83 5560.94,-17406.83 5995.94,-17406.83 5995.94,-17474.83"/>
<text text-anchor="middle" x="5778.44" y="-17459.63" font-family="Times,serif" font-size="14.00">ResidualAdd L2</text>
<text text-anchor="middle" x="5778.44" y="-17444.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17429.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17414.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l2&#45;&gt;residual1_l2 -->
<g id="edge149" class="edge">
<title>attn_l2&#45;&gt;residual1_l2</title>
<path fill="none" stroke="black" d="M5778.44,-17511.67C5778.44,-17503.22 5778.44,-17494.01 5778.44,-17485.13"/>
<polygon fill="black" stroke="black" points="5781.94,-17484.92 5778.44,-17474.92 5774.94,-17484.92 5781.94,-17484.92"/>
</g>
<!-- ln2_l2 -->
<g id="node116" class="node">
<title>ln2_l2</title>
<polygon fill="lightyellow" stroke="black" points="5995.94,-17369.83 5560.94,-17369.83 5560.94,-17301.83 5995.94,-17301.83 5995.94,-17369.83"/>
<text text-anchor="middle" x="5778.44" y="-17354.63" font-family="Times,serif" font-size="14.00">LayerNorm L2</text>
<text text-anchor="middle" x="5778.44" y="-17339.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17324.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17309.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l2&#45;&gt;ln2_l2 -->
<g id="edge150" class="edge">
<title>residual1_l2&#45;&gt;ln2_l2</title>
<path fill="none" stroke="black" d="M5778.44,-17406.67C5778.44,-17398.22 5778.44,-17389.01 5778.44,-17380.13"/>
<polygon fill="black" stroke="black" points="5781.94,-17379.92 5778.44,-17369.92 5774.94,-17379.92 5781.94,-17379.92"/>
</g>
<!-- ln2_l2&#45;&gt;route_l2 -->
<g id="edge151" class="edge">
<title>ln2_l2&#45;&gt;route_l2</title>
<path fill="none" stroke="black" d="M5778.44,-17301.67C5778.44,-17293.52 5778.44,-17284.46 5778.44,-17275.19"/>
<polygon fill="black" stroke="black" points="5781.94,-17275.06 5778.44,-17265.06 5774.94,-17275.06 5781.94,-17275.06"/>
</g>
<!-- recv_l2_e0_gpu0 -->
<g id="node118" class="node">
<title>recv_l2_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="474.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="474.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E0</text>
<text text-anchor="middle" x="474.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="474.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="474.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e0_gpu0 -->
<g id="edge152" class="edge">
<title>route_l2&#45;&gt;recv_l2_e0_gpu0</title>
<path fill="none" stroke="black" d="M5393.95,-17190.8C4656.68,-17180.53 2993.05,-17154.38 1593.44,-17110.83 1243.52,-17099.94 1155.06,-17109.78 806.44,-17077.83 773.33,-17074.79 738.47,-17070.77 704.29,-17066.35"/>
<polygon fill="black" stroke="black" points="704.56,-17062.86 694.19,-17065.03 703.65,-17069.8 704.56,-17062.86"/>
<text text-anchor="middle" x="1665.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l2_e1_gpu1 -->
<g id="node121" class="node">
<title>recv_l2_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1137.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1137.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E1</text>
<text text-anchor="middle" x="1137.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1137.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1137.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e1_gpu1 -->
<g id="edge156" class="edge">
<title>route_l2&#45;&gt;recv_l2_e1_gpu1</title>
<path fill="none" stroke="black" d="M5385.97,-17185.33C4792,-17169.41 3629.23,-17138.12 2641.44,-17110.83 2120.54,-17096.44 1988.68,-17121.82 1469.44,-17077.83 1435.78,-17074.98 1400.33,-17071 1365.62,-17066.55"/>
<polygon fill="black" stroke="black" points="1365.73,-17063.04 1355.36,-17065.22 1364.83,-17069.98 1365.73,-17063.04"/>
<text text-anchor="middle" x="2713.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l2_e2_gpu2 -->
<g id="node124" class="node">
<title>recv_l2_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1800.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1800.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E2</text>
<text text-anchor="middle" x="1800.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1800.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1800.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e2_gpu2 -->
<g id="edge160" class="edge">
<title>route_l2&#45;&gt;recv_l2_e2_gpu2</title>
<path fill="none" stroke="black" d="M5392.01,-17189.57C4721.91,-17177.85 3370.76,-17150.18 2898.44,-17110.83 2849.71,-17106.77 2838.18,-17099.84 2789.44,-17095.83 2498.31,-17071.88 2423.52,-17102.38 2132.44,-17077.83 2098.78,-17074.99 2063.33,-17071.02 2028.62,-17066.58"/>
<polygon fill="black" stroke="black" points="2028.73,-17063.06 2018.36,-17065.25 2027.83,-17070 2028.73,-17063.06"/>
<text text-anchor="middle" x="2970.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l2_e3_gpu3 -->
<g id="node127" class="node">
<title>recv_l2_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2463.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2463.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E3</text>
<text text-anchor="middle" x="2463.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2463.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2463.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e3_gpu3 -->
<g id="edge164" class="edge">
<title>route_l2&#45;&gt;recv_l2_e3_gpu3</title>
<path fill="none" stroke="black" d="M5380.18,-17181.13C4936.4,-17164.61 4197.54,-17136.73 3561.44,-17110.83 3220.96,-17096.97 3134.76,-17109.12 2795.44,-17077.83 2762.33,-17074.78 2727.47,-17070.74 2693.29,-17066.32"/>
<polygon fill="black" stroke="black" points="2693.56,-17062.82 2683.19,-17064.99 2692.65,-17069.76 2693.56,-17062.82"/>
<text text-anchor="middle" x="3633.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l2_e4_gpu4 -->
<g id="node130" class="node">
<title>recv_l2_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3126.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3126.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E4</text>
<text text-anchor="middle" x="3126.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3126.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3126.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e4_gpu4 -->
<g id="edge168" class="edge">
<title>route_l2&#45;&gt;recv_l2_e4_gpu4</title>
<path fill="none" stroke="black" d="M5388.2,-17186.7C4926.53,-17173.43 4135.13,-17142.89 3458.44,-17077.83 3425.61,-17074.67 3391.05,-17070.61 3357.13,-17066.19"/>
<polygon fill="black" stroke="black" points="3357.48,-17062.71 3347.11,-17064.87 3356.57,-17069.65 3357.48,-17062.71"/>
<text text-anchor="middle" x="3909.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l2_e5_gpu5 -->
<g id="node133" class="node">
<title>recv_l2_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3789.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3789.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E5</text>
<text text-anchor="middle" x="3789.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3789.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3789.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e5_gpu5 -->
<g id="edge172" class="edge">
<title>route_l2&#45;&gt;recv_l2_e5_gpu5</title>
<path fill="none" stroke="black" d="M5370.86,-17174.75C5035.03,-17155.48 4546.6,-17123.06 4121.44,-17077.83 4089.44,-17074.42 4055.78,-17070.29 4022.66,-17065.91"/>
<polygon fill="black" stroke="black" points="4022.78,-17062.4 4012.41,-17064.54 4021.86,-17069.34 4022.78,-17062.4"/>
<text text-anchor="middle" x="4510.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l2_e6_gpu6 -->
<g id="node136" class="node">
<title>recv_l2_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4452.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4452.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E6</text>
<text text-anchor="middle" x="4452.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4452.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4452.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e6_gpu6 -->
<g id="edge176" class="edge">
<title>route_l2&#45;&gt;recv_l2_e6_gpu6</title>
<path fill="none" stroke="black" d="M5328.2,-17144.57C5157.75,-17124.59 4962.04,-17100.96 4784.44,-17077.83 4754.1,-17073.88 4722.22,-17069.56 4690.71,-17065.2"/>
<polygon fill="black" stroke="black" points="4690.89,-17061.69 4680.5,-17063.79 4689.93,-17068.63 4690.89,-17061.69"/>
<text text-anchor="middle" x="5102.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l2_e7_gpu7 -->
<g id="node139" class="node">
<title>recv_l2_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5115.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5115.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E7</text>
<text text-anchor="middle" x="5115.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5115.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5115.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e7_gpu7 -->
<g id="edge180" class="edge">
<title>route_l2&#45;&gt;recv_l2_e7_gpu7</title>
<path fill="none" stroke="black" d="M5509.25,-17128.8C5434.71,-17110.24 5355.82,-17090.6 5288.37,-17073.81"/>
<polygon fill="black" stroke="black" points="5289.06,-17070.37 5278.51,-17071.35 5287.37,-17077.16 5289.06,-17070.37"/>
<text text-anchor="middle" x="5499.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l2_e8_gpu8 -->
<g id="node142" class="node">
<title>recv_l2_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5778.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5778.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E8</text>
<text text-anchor="middle" x="5778.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e8_gpu8 -->
<g id="edge184" class="edge">
<title>route_l2&#45;&gt;recv_l2_e8_gpu8</title>
<path fill="none" stroke="black" d="M5778.44,-17128.68C5778.44,-17115.3 5778.44,-17101.36 5778.44,-17088.33"/>
<polygon fill="black" stroke="black" points="5781.94,-17088.11 5778.44,-17078.11 5774.94,-17088.11 5781.94,-17088.11"/>
<text text-anchor="middle" x="5850.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l2_e9_gpu9 -->
<g id="node145" class="node">
<title>recv_l2_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6441.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6441.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E9</text>
<text text-anchor="middle" x="6441.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6441.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6441.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e9_gpu9 -->
<g id="edge188" class="edge">
<title>route_l2&#45;&gt;recv_l2_e9_gpu9</title>
<path fill="none" stroke="black" d="M6047.63,-17128.8C6122.17,-17110.24 6201.06,-17090.6 6268.51,-17073.81"/>
<polygon fill="black" stroke="black" points="6269.51,-17077.16 6278.37,-17071.35 6267.82,-17070.37 6269.51,-17077.16"/>
<text text-anchor="middle" x="6241.44" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l2_e10_gpu10 -->
<g id="node148" class="node">
<title>recv_l2_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7104.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7104.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E10</text>
<text text-anchor="middle" x="7104.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7104.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7104.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e10_gpu10 -->
<g id="edge192" class="edge">
<title>route_l2&#45;&gt;recv_l2_e10_gpu10</title>
<path fill="none" stroke="black" d="M6101.27,-17159.38C6295.83,-17136.95 6548.53,-17106.99 6772.44,-17077.83 6802.78,-17073.88 6834.66,-17069.56 6866.17,-17065.2"/>
<polygon fill="black" stroke="black" points="6866.96,-17068.63 6876.38,-17063.79 6865.99,-17061.69 6866.96,-17068.63"/>
<text text-anchor="middle" x="6686.94" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l2_e11_gpu11 -->
<g id="node151" class="node">
<title>recv_l2_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7767.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7767.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E11</text>
<text text-anchor="middle" x="7767.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7767.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7767.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e11_gpu11 -->
<g id="edge196" class="edge">
<title>route_l2&#45;&gt;recv_l2_e11_gpu11</title>
<path fill="none" stroke="black" d="M6127.79,-17178.05C6463.56,-17159.28 6985.01,-17125.75 7435.44,-17077.83 7467.44,-17074.42 7501.1,-17070.29 7534.22,-17065.91"/>
<polygon fill="black" stroke="black" points="7535.02,-17069.34 7544.47,-17064.54 7534.1,-17062.4 7535.02,-17069.34"/>
<text text-anchor="middle" x="7332.94" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l2_e12_gpu12 -->
<g id="node154" class="node">
<title>recv_l2_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8430.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8430.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E12</text>
<text text-anchor="middle" x="8430.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8430.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8430.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e12_gpu12 -->
<g id="edge200" class="edge">
<title>route_l2&#45;&gt;recv_l2_e12_gpu12</title>
<path fill="none" stroke="black" d="M6141.35,-17187.48C6598.61,-17174.64 7408.2,-17144.19 8098.44,-17077.83 8131.27,-17074.67 8165.83,-17070.61 8199.75,-17066.19"/>
<polygon fill="black" stroke="black" points="8200.32,-17069.65 8209.77,-17064.87 8199.4,-17062.71 8200.32,-17069.65"/>
<text text-anchor="middle" x="7924.94" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l2_e13_gpu13 -->
<g id="node157" class="node">
<title>recv_l2_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9093.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9093.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E13</text>
<text text-anchor="middle" x="9093.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9093.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9093.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e13_gpu13 -->
<g id="edge204" class="edge">
<title>route_l2&#45;&gt;recv_l2_e13_gpu13</title>
<path fill="none" stroke="black" d="M6134.76,-17182.83C6574.49,-17166.65 7345.1,-17137.84 8005.44,-17110.83 8341.48,-17097.08 8426.55,-17108.81 8761.44,-17077.83 8794.55,-17074.77 8829.41,-17070.73 8863.59,-17066.3"/>
<polygon fill="black" stroke="black" points="8864.23,-17069.74 8873.69,-17064.98 8863.32,-17062.8 8864.23,-17069.74"/>
<text text-anchor="middle" x="8590.94" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l2_e14_gpu14 -->
<g id="node160" class="node">
<title>recv_l2_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9756.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9756.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E14</text>
<text text-anchor="middle" x="9756.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9756.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9756.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e14_gpu14 -->
<g id="edge208" class="edge">
<title>route_l2&#45;&gt;recv_l2_e14_gpu14</title>
<path fill="none" stroke="black" d="M6140.16,-17186.88C6687.91,-17172.94 7760.53,-17144.17 8671.44,-17110.83 9006.2,-17098.58 9090.88,-17108.72 9424.44,-17077.83 9457.55,-17074.76 9492.41,-17070.72 9526.59,-17066.29"/>
<polygon fill="black" stroke="black" points="9527.23,-17069.74 9536.69,-17064.97 9526.32,-17062.8 9527.23,-17069.74"/>
<text text-anchor="middle" x="9254.94" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l2_e15_gpu15 -->
<g id="node163" class="node">
<title>recv_l2_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10419.44" cy="-17029.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10419.44" y="-17048.55" font-family="Times,serif" font-size="14.00">Token Receive L2E15</text>
<text text-anchor="middle" x="10419.44" y="-17033.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10419.44" y="-17018.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10419.44" y="-17003.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l2&#45;&gt;recv_l2_e15_gpu15 -->
<g id="edge212" class="edge">
<title>route_l2&#45;&gt;recv_l2_e15_gpu15</title>
<path fill="none" stroke="black" d="M6143.99,-17189.5C6788.66,-17177.8 8169.79,-17150.33 9335.44,-17110.83 9669.79,-17099.5 9754.32,-17108.69 10087.44,-17077.83 10120.55,-17074.76 10155.41,-17070.72 10189.59,-17066.29"/>
<polygon fill="black" stroke="black" points="10190.23,-17069.74 10199.69,-17064.97 10189.32,-17062.8 10190.23,-17069.74"/>
<text text-anchor="middle" x="9917.94" y="-17099.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l2_e0_gpu0 -->
<g id="node119" class="node">
<title>expert_l2_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="702.44,-16944.66 246.44,-16944.66 246.44,-16876.66 702.44,-16876.66 702.44,-16944.66"/>
<text text-anchor="middle" x="474.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E0</text>
<text text-anchor="middle" x="474.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="474.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="474.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l2_e0_gpu0&#45;&gt;expert_l2_e0_gpu0 -->
<g id="edge153" class="edge">
<title>recv_l2_e0_gpu0&#45;&gt;expert_l2_e0_gpu0</title>
<path fill="none" stroke="black" d="M474.44,-16981.46C474.44,-16972.71 474.44,-16963.61 474.44,-16954.98"/>
<polygon fill="black" stroke="black" points="477.94,-16954.74 474.44,-16944.74 470.94,-16954.74 477.94,-16954.74"/>
</g>
<!-- send_l2_e0_gpu0 -->
<g id="node120" class="node">
<title>send_l2_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="474.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="474.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E0</text>
<text text-anchor="middle" x="474.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="474.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="474.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l2_e0_gpu0&#45;&gt;send_l2_e0_gpu0 -->
<g id="edge154" class="edge">
<title>expert_l2_e0_gpu0&#45;&gt;send_l2_e0_gpu0</title>
<path fill="none" stroke="black" d="M474.44,-16876.42C474.44,-16868.17 474.44,-16859.09 474.44,-16850.04"/>
<polygon fill="black" stroke="black" points="477.94,-16849.89 474.44,-16839.89 470.94,-16849.89 477.94,-16849.89"/>
</g>
<!-- agg_l2 -->
<g id="node166" class="node">
<title>agg_l2</title>
<polygon fill="lightgray" stroke="black" points="6256.33,-16706.5 5496.12,-16706.5 5300.55,-16570.5 6060.76,-16570.5 6256.33,-16706.5"/>
<text text-anchor="middle" x="5778.44" y="-16657.3" font-family="Times,serif" font-size="14.00">Expert Aggregation L2</text>
<text text-anchor="middle" x="5778.44" y="-16642.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-16627.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-16612.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l2_e0_gpu0&#45;&gt;agg_l2 -->
<g id="edge155" class="edge">
<title>send_l2_e0_gpu0&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M691.45,-16755.99C729.68,-16750.99 769.16,-16746.52 806.44,-16743.5 1694.88,-16671.47 4384.64,-16647.97 5392.01,-16641.58"/>
<polygon fill="black" stroke="black" points="5392.34,-16645.08 5402.32,-16641.51 5392.29,-16638.08 5392.34,-16645.08"/>
</g>
<!-- expert_l2_e1_gpu1 -->
<g id="node122" class="node">
<title>expert_l2_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1365.44,-16944.66 909.44,-16944.66 909.44,-16876.66 1365.44,-16876.66 1365.44,-16944.66"/>
<text text-anchor="middle" x="1137.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E1</text>
<text text-anchor="middle" x="1137.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1137.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1137.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l2_e1_gpu1&#45;&gt;expert_l2_e1_gpu1 -->
<g id="edge157" class="edge">
<title>recv_l2_e1_gpu1&#45;&gt;expert_l2_e1_gpu1</title>
<path fill="none" stroke="black" d="M1137.44,-16981.46C1137.44,-16972.71 1137.44,-16963.61 1137.44,-16954.98"/>
<polygon fill="black" stroke="black" points="1140.94,-16954.74 1137.44,-16944.74 1133.94,-16954.74 1140.94,-16954.74"/>
</g>
<!-- send_l2_e1_gpu1 -->
<g id="node123" class="node">
<title>send_l2_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1137.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1137.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E1</text>
<text text-anchor="middle" x="1137.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1137.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1137.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l2_e1_gpu1&#45;&gt;send_l2_e1_gpu1 -->
<g id="edge158" class="edge">
<title>expert_l2_e1_gpu1&#45;&gt;send_l2_e1_gpu1</title>
<path fill="none" stroke="black" d="M1137.44,-16876.42C1137.44,-16868.17 1137.44,-16859.09 1137.44,-16850.04"/>
<polygon fill="black" stroke="black" points="1140.94,-16849.89 1137.44,-16839.89 1133.94,-16849.89 1140.94,-16849.89"/>
</g>
<!-- send_l2_e1_gpu1&#45;&gt;agg_l2 -->
<g id="edge159" class="edge">
<title>send_l2_e1_gpu1&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M1354.91,-16756.03C1392.99,-16751.04 1432.31,-16746.57 1469.44,-16743.5 2225.27,-16681 4485.64,-16652.27 5394.13,-16643.02"/>
<polygon fill="black" stroke="black" points="5394.46,-16646.51 5404.42,-16642.91 5394.39,-16639.51 5394.46,-16646.51"/>
</g>
<!-- expert_l2_e2_gpu2 -->
<g id="node125" class="node">
<title>expert_l2_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2028.44,-16944.66 1572.44,-16944.66 1572.44,-16876.66 2028.44,-16876.66 2028.44,-16944.66"/>
<text text-anchor="middle" x="1800.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E2</text>
<text text-anchor="middle" x="1800.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1800.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1800.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l2_e2_gpu2&#45;&gt;expert_l2_e2_gpu2 -->
<g id="edge161" class="edge">
<title>recv_l2_e2_gpu2&#45;&gt;expert_l2_e2_gpu2</title>
<path fill="none" stroke="black" d="M1800.44,-16981.46C1800.44,-16972.71 1800.44,-16963.61 1800.44,-16954.98"/>
<polygon fill="black" stroke="black" points="1803.94,-16954.74 1800.44,-16944.74 1796.94,-16954.74 1803.94,-16954.74"/>
</g>
<!-- send_l2_e2_gpu2 -->
<g id="node126" class="node">
<title>send_l2_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1800.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1800.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E2</text>
<text text-anchor="middle" x="1800.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1800.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1800.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l2_e2_gpu2&#45;&gt;send_l2_e2_gpu2 -->
<g id="edge162" class="edge">
<title>expert_l2_e2_gpu2&#45;&gt;send_l2_e2_gpu2</title>
<path fill="none" stroke="black" d="M1800.44,-16876.42C1800.44,-16868.17 1800.44,-16859.09 1800.44,-16850.04"/>
<polygon fill="black" stroke="black" points="1803.94,-16849.89 1800.44,-16839.89 1796.94,-16849.89 1803.94,-16849.89"/>
</g>
<!-- send_l2_e2_gpu2&#45;&gt;agg_l2 -->
<g id="edge163" class="edge">
<title>send_l2_e2_gpu2&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M2018.36,-16756.11C2056.31,-16751.13 2095.46,-16746.64 2132.44,-16743.5 2756.79,-16690.49 4594.71,-16657.28 5396.78,-16644.94"/>
<polygon fill="black" stroke="black" points="5397.1,-16648.44 5407.05,-16644.79 5396.99,-16641.44 5397.1,-16648.44"/>
</g>
<!-- expert_l2_e3_gpu3 -->
<g id="node128" class="node">
<title>expert_l2_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2691.44,-16944.66 2235.44,-16944.66 2235.44,-16876.66 2691.44,-16876.66 2691.44,-16944.66"/>
<text text-anchor="middle" x="2463.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E3</text>
<text text-anchor="middle" x="2463.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2463.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2463.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l2_e3_gpu3&#45;&gt;expert_l2_e3_gpu3 -->
<g id="edge165" class="edge">
<title>recv_l2_e3_gpu3&#45;&gt;expert_l2_e3_gpu3</title>
<path fill="none" stroke="black" d="M2463.44,-16981.46C2463.44,-16972.71 2463.44,-16963.61 2463.44,-16954.98"/>
<polygon fill="black" stroke="black" points="2466.94,-16954.74 2463.44,-16944.74 2459.94,-16954.74 2466.94,-16954.74"/>
</g>
<!-- send_l2_e3_gpu3 -->
<g id="node129" class="node">
<title>send_l2_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2463.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2463.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E3</text>
<text text-anchor="middle" x="2463.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2463.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2463.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l2_e3_gpu3&#45;&gt;send_l2_e3_gpu3 -->
<g id="edge166" class="edge">
<title>expert_l2_e3_gpu3&#45;&gt;send_l2_e3_gpu3</title>
<path fill="none" stroke="black" d="M2463.44,-16876.42C2463.44,-16868.17 2463.44,-16859.09 2463.44,-16850.04"/>
<polygon fill="black" stroke="black" points="2466.94,-16849.89 2463.44,-16839.89 2459.94,-16849.89 2466.94,-16849.89"/>
</g>
<!-- send_l2_e3_gpu3&#45;&gt;agg_l2 -->
<g id="edge167" class="edge">
<title>send_l2_e3_gpu3&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M2682.27,-16756.19C2719.94,-16751.24 2758.76,-16746.73 2795.44,-16743.5 3723.8,-16661.72 4820,-16643.51 5390.04,-16639.92"/>
<polygon fill="black" stroke="black" points="5390.08,-16643.42 5400.06,-16639.86 5390.04,-16636.42 5390.08,-16643.42"/>
</g>
<!-- expert_l2_e4_gpu4 -->
<g id="node131" class="node">
<title>expert_l2_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3354.44,-16944.66 2898.44,-16944.66 2898.44,-16876.66 3354.44,-16876.66 3354.44,-16944.66"/>
<text text-anchor="middle" x="3126.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E4</text>
<text text-anchor="middle" x="3126.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3126.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3126.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l2_e4_gpu4&#45;&gt;expert_l2_e4_gpu4 -->
<g id="edge169" class="edge">
<title>recv_l2_e4_gpu4&#45;&gt;expert_l2_e4_gpu4</title>
<path fill="none" stroke="black" d="M3126.44,-16981.46C3126.44,-16972.71 3126.44,-16963.61 3126.44,-16954.98"/>
<polygon fill="black" stroke="black" points="3129.94,-16954.74 3126.44,-16944.74 3122.94,-16954.74 3129.94,-16954.74"/>
</g>
<!-- send_l2_e4_gpu4 -->
<g id="node132" class="node">
<title>send_l2_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3126.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3126.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E4</text>
<text text-anchor="middle" x="3126.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3126.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3126.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l2_e4_gpu4&#45;&gt;send_l2_e4_gpu4 -->
<g id="edge170" class="edge">
<title>expert_l2_e4_gpu4&#45;&gt;send_l2_e4_gpu4</title>
<path fill="none" stroke="black" d="M3126.44,-16876.42C3126.44,-16868.17 3126.44,-16859.09 3126.44,-16850.04"/>
<polygon fill="black" stroke="black" points="3129.94,-16849.89 3126.44,-16839.89 3122.94,-16849.89 3129.94,-16849.89"/>
</g>
<!-- send_l2_e4_gpu4&#45;&gt;agg_l2 -->
<g id="edge171" class="edge">
<title>send_l2_e4_gpu4&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M3346.2,-16756.39C3383.58,-16751.44 3422.07,-16746.88 3458.44,-16743.5 4139.76,-16680.06 4937.37,-16655.03 5397.64,-16645.36"/>
<polygon fill="black" stroke="black" points="5397.85,-16648.85 5407.77,-16645.15 5397.7,-16641.85 5397.85,-16648.85"/>
</g>
<!-- expert_l2_e5_gpu5 -->
<g id="node134" class="node">
<title>expert_l2_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4017.44,-16944.66 3561.44,-16944.66 3561.44,-16876.66 4017.44,-16876.66 4017.44,-16944.66"/>
<text text-anchor="middle" x="3789.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E5</text>
<text text-anchor="middle" x="3789.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3789.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3789.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l2_e5_gpu5&#45;&gt;expert_l2_e5_gpu5 -->
<g id="edge173" class="edge">
<title>recv_l2_e5_gpu5&#45;&gt;expert_l2_e5_gpu5</title>
<path fill="none" stroke="black" d="M3789.44,-16981.46C3789.44,-16972.71 3789.44,-16963.61 3789.44,-16954.98"/>
<polygon fill="black" stroke="black" points="3792.94,-16954.74 3789.44,-16944.74 3785.94,-16954.74 3792.94,-16954.74"/>
</g>
<!-- send_l2_e5_gpu5 -->
<g id="node135" class="node">
<title>send_l2_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3789.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3789.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E5</text>
<text text-anchor="middle" x="3789.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3789.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3789.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l2_e5_gpu5&#45;&gt;send_l2_e5_gpu5 -->
<g id="edge174" class="edge">
<title>expert_l2_e5_gpu5&#45;&gt;send_l2_e5_gpu5</title>
<path fill="none" stroke="black" d="M3789.44,-16876.42C3789.44,-16868.17 3789.44,-16859.09 3789.44,-16850.04"/>
<polygon fill="black" stroke="black" points="3792.94,-16849.89 3789.44,-16839.89 3785.94,-16849.89 3792.94,-16849.89"/>
</g>
<!-- send_l2_e5_gpu5&#45;&gt;agg_l2 -->
<g id="edge175" class="edge">
<title>send_l2_e5_gpu5&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M4011.49,-16756.64C4048.16,-16751.74 4085.82,-16747.13 4121.44,-16743.5 4563.29,-16698.37 5073.57,-16669.89 5409.81,-16654.36"/>
<polygon fill="black" stroke="black" points="5410.38,-16657.84 5420.2,-16653.88 5410.05,-16650.85 5410.38,-16657.84"/>
</g>
<!-- expert_l2_e6_gpu6 -->
<g id="node137" class="node">
<title>expert_l2_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4680.44,-16944.66 4224.44,-16944.66 4224.44,-16876.66 4680.44,-16876.66 4680.44,-16944.66"/>
<text text-anchor="middle" x="4452.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E6</text>
<text text-anchor="middle" x="4452.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4452.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4452.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l2_e6_gpu6&#45;&gt;expert_l2_e6_gpu6 -->
<g id="edge177" class="edge">
<title>recv_l2_e6_gpu6&#45;&gt;expert_l2_e6_gpu6</title>
<path fill="none" stroke="black" d="M4452.44,-16981.46C4452.44,-16972.71 4452.44,-16963.61 4452.44,-16954.98"/>
<polygon fill="black" stroke="black" points="4455.94,-16954.74 4452.44,-16944.74 4448.94,-16954.74 4455.94,-16954.74"/>
</g>
<!-- send_l2_e6_gpu6 -->
<g id="node138" class="node">
<title>send_l2_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4452.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4452.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E6</text>
<text text-anchor="middle" x="4452.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4452.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4452.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l2_e6_gpu6&#45;&gt;send_l2_e6_gpu6 -->
<g id="edge178" class="edge">
<title>expert_l2_e6_gpu6&#45;&gt;send_l2_e6_gpu6</title>
<path fill="none" stroke="black" d="M4452.44,-16876.42C4452.44,-16868.17 4452.44,-16859.09 4452.44,-16850.04"/>
<polygon fill="black" stroke="black" points="4455.94,-16849.89 4452.44,-16839.89 4448.94,-16849.89 4455.94,-16849.89"/>
</g>
<!-- send_l2_e6_gpu6&#45;&gt;agg_l2 -->
<g id="edge179" class="edge">
<title>send_l2_e6_gpu6&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M4679.1,-16757.31C4714.34,-16752.46 4750.35,-16747.7 4784.44,-16743.5 5000.57,-16716.87 5243.69,-16691.36 5435.39,-16672.26"/>
<polygon fill="black" stroke="black" points="5435.74,-16675.75 5445.34,-16671.27 5435.05,-16668.78 5435.74,-16675.75"/>
</g>
<!-- expert_l2_e7_gpu7 -->
<g id="node140" class="node">
<title>expert_l2_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5343.44,-16944.66 4887.44,-16944.66 4887.44,-16876.66 5343.44,-16876.66 5343.44,-16944.66"/>
<text text-anchor="middle" x="5115.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E7</text>
<text text-anchor="middle" x="5115.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5115.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5115.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l2_e7_gpu7&#45;&gt;expert_l2_e7_gpu7 -->
<g id="edge181" class="edge">
<title>recv_l2_e7_gpu7&#45;&gt;expert_l2_e7_gpu7</title>
<path fill="none" stroke="black" d="M5115.44,-16981.46C5115.44,-16972.71 5115.44,-16963.61 5115.44,-16954.98"/>
<polygon fill="black" stroke="black" points="5118.94,-16954.74 5115.44,-16944.74 5111.94,-16954.74 5118.94,-16954.74"/>
</g>
<!-- send_l2_e7_gpu7 -->
<g id="node141" class="node">
<title>send_l2_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5115.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5115.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E7</text>
<text text-anchor="middle" x="5115.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5115.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5115.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l2_e7_gpu7&#45;&gt;send_l2_e7_gpu7 -->
<g id="edge182" class="edge">
<title>expert_l2_e7_gpu7&#45;&gt;send_l2_e7_gpu7</title>
<path fill="none" stroke="black" d="M5115.44,-16876.42C5115.44,-16868.17 5115.44,-16859.09 5115.44,-16850.04"/>
<polygon fill="black" stroke="black" points="5118.94,-16849.89 5115.44,-16839.89 5111.94,-16849.89 5118.94,-16849.89"/>
</g>
<!-- send_l2_e7_gpu7&#45;&gt;agg_l2 -->
<g id="edge183" class="edge">
<title>send_l2_e7_gpu7&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M5289.2,-16750.98C5348.63,-16737.44 5416.87,-16721.89 5483.16,-16706.79"/>
<polygon fill="black" stroke="black" points="5483.95,-16710.19 5492.92,-16704.56 5482.39,-16703.37 5483.95,-16710.19"/>
</g>
<!-- expert_l2_e8_gpu8 -->
<g id="node143" class="node">
<title>expert_l2_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6006.44,-16944.66 5550.44,-16944.66 5550.44,-16876.66 6006.44,-16876.66 6006.44,-16944.66"/>
<text text-anchor="middle" x="5778.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E8</text>
<text text-anchor="middle" x="5778.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l2_e8_gpu8&#45;&gt;expert_l2_e8_gpu8 -->
<g id="edge185" class="edge">
<title>recv_l2_e8_gpu8&#45;&gt;expert_l2_e8_gpu8</title>
<path fill="none" stroke="black" d="M5778.44,-16981.46C5778.44,-16972.71 5778.44,-16963.61 5778.44,-16954.98"/>
<polygon fill="black" stroke="black" points="5781.94,-16954.74 5778.44,-16944.74 5774.94,-16954.74 5781.94,-16954.74"/>
</g>
<!-- send_l2_e8_gpu8 -->
<g id="node144" class="node">
<title>send_l2_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5778.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5778.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E8</text>
<text text-anchor="middle" x="5778.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5778.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l2_e8_gpu8&#45;&gt;send_l2_e8_gpu8 -->
<g id="edge186" class="edge">
<title>expert_l2_e8_gpu8&#45;&gt;send_l2_e8_gpu8</title>
<path fill="none" stroke="black" d="M5778.44,-16876.42C5778.44,-16868.17 5778.44,-16859.09 5778.44,-16850.04"/>
<polygon fill="black" stroke="black" points="5781.94,-16849.89 5778.44,-16839.89 5774.94,-16849.89 5781.94,-16849.89"/>
</g>
<!-- send_l2_e8_gpu8&#45;&gt;agg_l2 -->
<g id="edge187" class="edge">
<title>send_l2_e8_gpu8&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M5778.44,-16743.19C5778.44,-16734.76 5778.44,-16725.79 5778.44,-16716.79"/>
<polygon fill="black" stroke="black" points="5781.94,-16716.64 5778.44,-16706.64 5774.94,-16716.64 5781.94,-16716.64"/>
</g>
<!-- expert_l2_e9_gpu9 -->
<g id="node146" class="node">
<title>expert_l2_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6669.44,-16944.66 6213.44,-16944.66 6213.44,-16876.66 6669.44,-16876.66 6669.44,-16944.66"/>
<text text-anchor="middle" x="6441.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E9</text>
<text text-anchor="middle" x="6441.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6441.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6441.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l2_e9_gpu9&#45;&gt;expert_l2_e9_gpu9 -->
<g id="edge189" class="edge">
<title>recv_l2_e9_gpu9&#45;&gt;expert_l2_e9_gpu9</title>
<path fill="none" stroke="black" d="M6441.44,-16981.46C6441.44,-16972.71 6441.44,-16963.61 6441.44,-16954.98"/>
<polygon fill="black" stroke="black" points="6444.94,-16954.74 6441.44,-16944.74 6437.94,-16954.74 6444.94,-16954.74"/>
</g>
<!-- send_l2_e9_gpu9 -->
<g id="node147" class="node">
<title>send_l2_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6441.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6441.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E9</text>
<text text-anchor="middle" x="6441.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6441.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6441.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l2_e9_gpu9&#45;&gt;send_l2_e9_gpu9 -->
<g id="edge190" class="edge">
<title>expert_l2_e9_gpu9&#45;&gt;send_l2_e9_gpu9</title>
<path fill="none" stroke="black" d="M6441.44,-16876.42C6441.44,-16868.17 6441.44,-16859.09 6441.44,-16850.04"/>
<polygon fill="black" stroke="black" points="6444.94,-16849.89 6441.44,-16839.89 6437.94,-16849.89 6444.94,-16849.89"/>
</g>
<!-- send_l2_e9_gpu9&#45;&gt;agg_l2 -->
<g id="edge191" class="edge">
<title>send_l2_e9_gpu9&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M6267.68,-16750.98C6210.84,-16738.03 6145.93,-16723.24 6082.39,-16708.76"/>
<polygon fill="black" stroke="black" points="6083.14,-16705.34 6072.61,-16706.53 6081.59,-16712.17 6083.14,-16705.34"/>
</g>
<!-- expert_l2_e10_gpu10 -->
<g id="node149" class="node">
<title>expert_l2_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7332.44,-16944.66 6876.44,-16944.66 6876.44,-16876.66 7332.44,-16876.66 7332.44,-16944.66"/>
<text text-anchor="middle" x="7104.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E10</text>
<text text-anchor="middle" x="7104.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7104.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7104.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l2_e10_gpu10&#45;&gt;expert_l2_e10_gpu10 -->
<g id="edge193" class="edge">
<title>recv_l2_e10_gpu10&#45;&gt;expert_l2_e10_gpu10</title>
<path fill="none" stroke="black" d="M7104.44,-16981.46C7104.44,-16972.71 7104.44,-16963.61 7104.44,-16954.98"/>
<polygon fill="black" stroke="black" points="7107.94,-16954.74 7104.44,-16944.74 7100.94,-16954.74 7107.94,-16954.74"/>
</g>
<!-- send_l2_e10_gpu10 -->
<g id="node150" class="node">
<title>send_l2_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7104.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7104.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E10</text>
<text text-anchor="middle" x="7104.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7104.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7104.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l2_e10_gpu10&#45;&gt;send_l2_e10_gpu10 -->
<g id="edge194" class="edge">
<title>expert_l2_e10_gpu10&#45;&gt;send_l2_e10_gpu10</title>
<path fill="none" stroke="black" d="M7104.44,-16876.42C7104.44,-16868.17 7104.44,-16859.09 7104.44,-16850.04"/>
<polygon fill="black" stroke="black" points="7107.94,-16849.89 7104.44,-16839.89 7100.94,-16849.89 7107.94,-16849.89"/>
</g>
<!-- send_l2_e10_gpu10&#45;&gt;agg_l2 -->
<g id="edge195" class="edge">
<title>send_l2_e10_gpu10&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M6877.78,-16757.31C6842.54,-16752.46 6806.53,-16747.7 6772.44,-16743.5 6596,-16721.76 6401.57,-16700.77 6231.81,-16683.4"/>
<polygon fill="black" stroke="black" points="6232,-16679.9 6221.69,-16682.36 6231.29,-16686.86 6232,-16679.9"/>
</g>
<!-- expert_l2_e11_gpu11 -->
<g id="node152" class="node">
<title>expert_l2_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="7995.44,-16944.66 7539.44,-16944.66 7539.44,-16876.66 7995.44,-16876.66 7995.44,-16944.66"/>
<text text-anchor="middle" x="7767.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E11</text>
<text text-anchor="middle" x="7767.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7767.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7767.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l2_e11_gpu11&#45;&gt;expert_l2_e11_gpu11 -->
<g id="edge197" class="edge">
<title>recv_l2_e11_gpu11&#45;&gt;expert_l2_e11_gpu11</title>
<path fill="none" stroke="black" d="M7767.44,-16981.46C7767.44,-16972.71 7767.44,-16963.61 7767.44,-16954.98"/>
<polygon fill="black" stroke="black" points="7770.94,-16954.74 7767.44,-16944.74 7763.94,-16954.74 7770.94,-16954.74"/>
</g>
<!-- send_l2_e11_gpu11 -->
<g id="node153" class="node">
<title>send_l2_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7767.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7767.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E11</text>
<text text-anchor="middle" x="7767.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7767.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7767.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l2_e11_gpu11&#45;&gt;send_l2_e11_gpu11 -->
<g id="edge198" class="edge">
<title>expert_l2_e11_gpu11&#45;&gt;send_l2_e11_gpu11</title>
<path fill="none" stroke="black" d="M7767.44,-16876.42C7767.44,-16868.17 7767.44,-16859.09 7767.44,-16850.04"/>
<polygon fill="black" stroke="black" points="7770.94,-16849.89 7767.44,-16839.89 7763.94,-16849.89 7770.94,-16849.89"/>
</g>
<!-- send_l2_e11_gpu11&#45;&gt;agg_l2 -->
<g id="edge199" class="edge">
<title>send_l2_e11_gpu11&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M7545.4,-16756.64C7508.72,-16751.74 7471.06,-16747.13 7435.44,-16743.5 7013.81,-16700.43 6529.87,-16672.53 6194.31,-16656.58"/>
<polygon fill="black" stroke="black" points="6194.08,-16653.06 6183.92,-16656.08 6193.75,-16660.05 6194.08,-16653.06"/>
</g>
<!-- expert_l2_e12_gpu12 -->
<g id="node155" class="node">
<title>expert_l2_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8658.44,-16944.66 8202.44,-16944.66 8202.44,-16876.66 8658.44,-16876.66 8658.44,-16944.66"/>
<text text-anchor="middle" x="8430.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E12</text>
<text text-anchor="middle" x="8430.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8430.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8430.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l2_e12_gpu12&#45;&gt;expert_l2_e12_gpu12 -->
<g id="edge201" class="edge">
<title>recv_l2_e12_gpu12&#45;&gt;expert_l2_e12_gpu12</title>
<path fill="none" stroke="black" d="M8430.44,-16981.46C8430.44,-16972.71 8430.44,-16963.61 8430.44,-16954.98"/>
<polygon fill="black" stroke="black" points="8433.94,-16954.74 8430.44,-16944.74 8426.94,-16954.74 8433.94,-16954.74"/>
</g>
<!-- send_l2_e12_gpu12 -->
<g id="node156" class="node">
<title>send_l2_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8430.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8430.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E12</text>
<text text-anchor="middle" x="8430.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8430.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8430.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l2_e12_gpu12&#45;&gt;send_l2_e12_gpu12 -->
<g id="edge202" class="edge">
<title>expert_l2_e12_gpu12&#45;&gt;send_l2_e12_gpu12</title>
<path fill="none" stroke="black" d="M8430.44,-16876.42C8430.44,-16868.17 8430.44,-16859.09 8430.44,-16850.04"/>
<polygon fill="black" stroke="black" points="8433.94,-16849.89 8430.44,-16839.89 8426.94,-16849.89 8433.94,-16849.89"/>
</g>
<!-- send_l2_e12_gpu12&#45;&gt;agg_l2 -->
<g id="edge203" class="edge">
<title>send_l2_e12_gpu12&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M8210.7,-16756.28C8173.31,-16751.34 8134.82,-16746.82 8098.44,-16743.5 7905.74,-16725.89 7856.76,-16733.91 7663.44,-16725.5 7159.59,-16703.58 6580.05,-16676.92 6198.07,-16659.15"/>
<polygon fill="black" stroke="black" points="6198.11,-16655.65 6187.95,-16658.68 6197.78,-16662.64 6198.11,-16655.65"/>
</g>
<!-- expert_l2_e13_gpu13 -->
<g id="node158" class="node">
<title>expert_l2_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9321.44,-16944.66 8865.44,-16944.66 8865.44,-16876.66 9321.44,-16876.66 9321.44,-16944.66"/>
<text text-anchor="middle" x="9093.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E13</text>
<text text-anchor="middle" x="9093.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9093.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9093.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l2_e13_gpu13&#45;&gt;expert_l2_e13_gpu13 -->
<g id="edge205" class="edge">
<title>recv_l2_e13_gpu13&#45;&gt;expert_l2_e13_gpu13</title>
<path fill="none" stroke="black" d="M9093.44,-16981.46C9093.44,-16972.71 9093.44,-16963.61 9093.44,-16954.98"/>
<polygon fill="black" stroke="black" points="9096.94,-16954.74 9093.44,-16944.74 9089.94,-16954.74 9096.94,-16954.74"/>
</g>
<!-- send_l2_e13_gpu13 -->
<g id="node159" class="node">
<title>send_l2_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9093.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9093.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E13</text>
<text text-anchor="middle" x="9093.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9093.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9093.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l2_e13_gpu13&#45;&gt;send_l2_e13_gpu13 -->
<g id="edge206" class="edge">
<title>expert_l2_e13_gpu13&#45;&gt;send_l2_e13_gpu13</title>
<path fill="none" stroke="black" d="M9093.44,-16876.42C9093.44,-16868.17 9093.44,-16859.09 9093.44,-16850.04"/>
<polygon fill="black" stroke="black" points="9096.94,-16849.89 9093.44,-16839.89 9089.94,-16849.89 9096.94,-16849.89"/>
</g>
<!-- send_l2_e13_gpu13&#45;&gt;agg_l2 -->
<g id="edge207" class="edge">
<title>send_l2_e13_gpu13&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M8876.43,-16755.94C8838.21,-16750.94 8798.72,-16746.49 8761.44,-16743.5 8348.03,-16710.32 8242.99,-16738.19 7828.44,-16725.5 7264.23,-16708.22 6613.04,-16679.38 6198.73,-16659.91"/>
<polygon fill="black" stroke="black" points="6198.83,-16656.41 6188.68,-16659.44 6198.51,-16663.41 6198.83,-16656.41"/>
</g>
<!-- expert_l2_e14_gpu14 -->
<g id="node161" class="node">
<title>expert_l2_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="9984.44,-16944.66 9528.44,-16944.66 9528.44,-16876.66 9984.44,-16876.66 9984.44,-16944.66"/>
<text text-anchor="middle" x="9756.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E14</text>
<text text-anchor="middle" x="9756.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9756.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9756.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l2_e14_gpu14&#45;&gt;expert_l2_e14_gpu14 -->
<g id="edge209" class="edge">
<title>recv_l2_e14_gpu14&#45;&gt;expert_l2_e14_gpu14</title>
<path fill="none" stroke="black" d="M9756.44,-16981.46C9756.44,-16972.71 9756.44,-16963.61 9756.44,-16954.98"/>
<polygon fill="black" stroke="black" points="9759.94,-16954.74 9756.44,-16944.74 9752.94,-16954.74 9759.94,-16954.74"/>
</g>
<!-- send_l2_e14_gpu14 -->
<g id="node162" class="node">
<title>send_l2_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9756.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9756.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E14</text>
<text text-anchor="middle" x="9756.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9756.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9756.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l2_e14_gpu14&#45;&gt;send_l2_e14_gpu14 -->
<g id="edge210" class="edge">
<title>expert_l2_e14_gpu14&#45;&gt;send_l2_e14_gpu14</title>
<path fill="none" stroke="black" d="M9756.44,-16876.42C9756.44,-16868.17 9756.44,-16859.09 9756.44,-16850.04"/>
<polygon fill="black" stroke="black" points="9759.94,-16849.89 9756.44,-16839.89 9752.94,-16849.89 9759.94,-16849.89"/>
</g>
<!-- send_l2_e14_gpu14&#45;&gt;agg_l2 -->
<g id="edge211" class="edge">
<title>send_l2_e14_gpu14&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M9538.52,-16756.11C9500.57,-16751.13 9461.42,-16746.64 9424.44,-16743.5 9109.26,-16716.74 7065.1,-16668.4 6182.82,-16648.46"/>
<polygon fill="black" stroke="black" points="6182.89,-16644.96 6172.82,-16648.24 6182.74,-16651.96 6182.89,-16644.96"/>
</g>
<!-- expert_l2_e15_gpu15 -->
<g id="node164" class="node">
<title>expert_l2_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10647.44,-16944.66 10191.44,-16944.66 10191.44,-16876.66 10647.44,-16876.66 10647.44,-16944.66"/>
<text text-anchor="middle" x="10419.44" y="-16929.46" font-family="Times,serif" font-size="14.00">Expert L2E15</text>
<text text-anchor="middle" x="10419.44" y="-16914.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10419.44" y="-16899.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10419.44" y="-16884.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l2_e15_gpu15&#45;&gt;expert_l2_e15_gpu15 -->
<g id="edge213" class="edge">
<title>recv_l2_e15_gpu15&#45;&gt;expert_l2_e15_gpu15</title>
<path fill="none" stroke="black" d="M10419.44,-16981.46C10419.44,-16972.71 10419.44,-16963.61 10419.44,-16954.98"/>
<polygon fill="black" stroke="black" points="10422.94,-16954.74 10419.44,-16944.74 10415.94,-16954.74 10422.94,-16954.74"/>
</g>
<!-- send_l2_e15_gpu15 -->
<g id="node165" class="node">
<title>send_l2_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10419.44" cy="-16791.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10419.44" y="-16810.38" font-family="Times,serif" font-size="14.00">Token Send L2E15</text>
<text text-anchor="middle" x="10419.44" y="-16795.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10419.44" y="-16780.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10419.44" y="-16765.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l2_e15_gpu15&#45;&gt;send_l2_e15_gpu15 -->
<g id="edge214" class="edge">
<title>expert_l2_e15_gpu15&#45;&gt;send_l2_e15_gpu15</title>
<path fill="none" stroke="black" d="M10419.44,-16876.42C10419.44,-16868.17 10419.44,-16859.09 10419.44,-16850.04"/>
<polygon fill="black" stroke="black" points="10422.94,-16849.89 10419.44,-16839.89 10415.94,-16849.89 10422.94,-16849.89"/>
</g>
<!-- send_l2_e15_gpu15&#45;&gt;agg_l2 -->
<g id="edge215" class="edge">
<title>send_l2_e15_gpu15&#45;&gt;agg_l2</title>
<path fill="none" stroke="black" d="M10201.97,-16756.03C10163.89,-16751.04 10124.57,-16746.57 10087.44,-16743.5 9335.12,-16681.29 7092.18,-16652.54 6175.48,-16643.15"/>
<polygon fill="black" stroke="black" points="6175.46,-16639.65 6165.43,-16643.04 6175.39,-16646.65 6175.46,-16639.65"/>
</g>
<!-- residual2_l2 -->
<g id="node167" class="node">
<title>residual2_l2</title>
<polygon fill="lightpink" stroke="black" points="6023.94,-16533.5 5588.94,-16533.5 5588.94,-16465.5 6023.94,-16465.5 6023.94,-16533.5"/>
<text text-anchor="middle" x="5806.44" y="-16518.3" font-family="Times,serif" font-size="14.00">ResidualAdd L2</text>
<text text-anchor="middle" x="5806.44" y="-16503.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5806.44" y="-16488.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5806.44" y="-16473.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l2&#45;&gt;residual2_l2 -->
<g id="edge216" class="edge">
<title>agg_l2&#45;&gt;residual2_l2</title>
<path fill="none" stroke="black" d="M5792.19,-16570.2C5794.04,-16561.16 5795.9,-16552.08 5797.63,-16543.61"/>
<polygon fill="black" stroke="black" points="5801.1,-16544.12 5799.67,-16533.62 5794.24,-16542.72 5801.1,-16544.12"/>
</g>
<!-- residual2_l2&#45;&gt;ln1_l3 -->
<g id="edge217" class="edge">
<title>residual2_l2&#45;&gt;ln1_l3</title>
<path fill="none" stroke="black" d="M5821.89,-16465.34C5825.96,-16456.61 5830.41,-16447.07 5834.67,-16437.93"/>
<polygon fill="black" stroke="black" points="5837.97,-16439.13 5839.02,-16428.59 5831.62,-16436.18 5837.97,-16439.13"/>
</g>
<!-- attn_l3 -->
<g id="node169" class="node">
<title>attn_l3</title>
<polygon fill="lightcoral" stroke="black" points="6084.44,-16323.5 5624.44,-16323.5 5624.44,-16255.5 6084.44,-16255.5 6084.44,-16323.5"/>
<text text-anchor="middle" x="5854.44" y="-16308.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L3</text>
<text text-anchor="middle" x="5854.44" y="-16293.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5854.44" y="-16278.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16263.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l3&#45;&gt;attn_l3 -->
<g id="edge220" class="edge">
<title>ln1_l3&#45;&gt;attn_l3</title>
<path fill="none" stroke="black" d="M5854.44,-16360.34C5854.44,-16351.89 5854.44,-16342.67 5854.44,-16333.79"/>
<polygon fill="black" stroke="black" points="5857.94,-16333.59 5854.44,-16323.59 5850.94,-16333.59 5857.94,-16333.59"/>
</g>
<!-- residual1_l3 -->
<g id="node170" class="node">
<title>residual1_l3</title>
<polygon fill="lightpink" stroke="black" points="6071.94,-16218.5 5636.94,-16218.5 5636.94,-16150.5 6071.94,-16150.5 6071.94,-16218.5"/>
<text text-anchor="middle" x="5854.44" y="-16203.3" font-family="Times,serif" font-size="14.00">ResidualAdd L3</text>
<text text-anchor="middle" x="5854.44" y="-16188.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16173.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16158.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l3&#45;&gt;residual1_l3 -->
<g id="edge221" class="edge">
<title>attn_l3&#45;&gt;residual1_l3</title>
<path fill="none" stroke="black" d="M5854.44,-16255.34C5854.44,-16246.89 5854.44,-16237.67 5854.44,-16228.79"/>
<polygon fill="black" stroke="black" points="5857.94,-16228.59 5854.44,-16218.59 5850.94,-16228.59 5857.94,-16228.59"/>
</g>
<!-- ln2_l3 -->
<g id="node171" class="node">
<title>ln2_l3</title>
<polygon fill="lightyellow" stroke="black" points="6071.94,-16113.5 5636.94,-16113.5 5636.94,-16045.5 6071.94,-16045.5 6071.94,-16113.5"/>
<text text-anchor="middle" x="5854.44" y="-16098.3" font-family="Times,serif" font-size="14.00">LayerNorm L3</text>
<text text-anchor="middle" x="5854.44" y="-16083.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16068.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-16053.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l3&#45;&gt;ln2_l3 -->
<g id="edge222" class="edge">
<title>residual1_l3&#45;&gt;ln2_l3</title>
<path fill="none" stroke="black" d="M5854.44,-16150.34C5854.44,-16141.89 5854.44,-16132.67 5854.44,-16123.79"/>
<polygon fill="black" stroke="black" points="5857.94,-16123.59 5854.44,-16113.59 5850.94,-16123.59 5857.94,-16123.59"/>
</g>
<!-- ln2_l3&#45;&gt;route_l3 -->
<g id="edge223" class="edge">
<title>ln2_l3&#45;&gt;route_l3</title>
<path fill="none" stroke="black" d="M5854.44,-16045.33C5854.44,-16037.19 5854.44,-16028.13 5854.44,-16018.85"/>
<polygon fill="black" stroke="black" points="5857.94,-16018.73 5854.44,-16008.73 5850.94,-16018.73 5857.94,-16018.73"/>
</g>
<!-- recv_l3_e0_gpu0 -->
<g id="node173" class="node">
<title>recv_l3_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="550.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="550.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E0</text>
<text text-anchor="middle" x="550.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="550.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="550.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e0_gpu0 -->
<g id="edge224" class="edge">
<title>route_l3&#45;&gt;recv_l3_e0_gpu0</title>
<path fill="none" stroke="black" d="M5470.34,-15934.81C4728.72,-15925.08 3048,-15899.74 1634.44,-15854.5 1300.07,-15843.79 1215.56,-15852.35 882.44,-15821.5 849.33,-15818.43 814.48,-15814.39 780.29,-15809.96"/>
<polygon fill="black" stroke="black" points="780.56,-15806.46 770.19,-15808.64 779.65,-15813.4 780.56,-15806.46"/>
<text text-anchor="middle" x="1706.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l3_e1_gpu1 -->
<g id="node176" class="node">
<title>recv_l3_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1213.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1213.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E1</text>
<text text-anchor="middle" x="1213.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1213.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1213.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e1_gpu1 -->
<g id="edge228" class="edge">
<title>route_l3&#45;&gt;recv_l3_e1_gpu1</title>
<path fill="none" stroke="black" d="M5467.4,-15932.62C4815.9,-15920.52 3458.87,-15892.97 2311.44,-15854.5 1970.87,-15843.08 1884.76,-15852.79 1545.44,-15821.5 1512.33,-15818.44 1477.47,-15814.41 1443.29,-15809.98"/>
<polygon fill="black" stroke="black" points="1443.56,-15806.49 1433.19,-15808.66 1442.65,-15813.43 1443.56,-15806.49"/>
<text text-anchor="middle" x="2383.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l3_e2_gpu2 -->
<g id="node179" class="node">
<title>recv_l3_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1876.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1876.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E2</text>
<text text-anchor="middle" x="1876.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1876.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1876.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e2_gpu2 -->
<g id="edge232" class="edge">
<title>route_l3&#45;&gt;recv_l3_e2_gpu2</title>
<path fill="none" stroke="black" d="M5463.09,-15929.63C4909.03,-15915.27 3864.24,-15886.79 2974.44,-15854.5 2633.9,-15842.14 2547.76,-15852.79 2208.44,-15821.5 2175.33,-15818.44 2140.47,-15814.41 2106.29,-15809.98"/>
<polygon fill="black" stroke="black" points="2106.56,-15806.49 2096.19,-15808.66 2105.65,-15813.43 2106.56,-15806.49"/>
<text text-anchor="middle" x="3046.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l3_e3_gpu3 -->
<g id="node182" class="node">
<title>recv_l3_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2539.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2539.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E3</text>
<text text-anchor="middle" x="2539.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2539.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2539.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e3_gpu3 -->
<g id="edge236" class="edge">
<title>route_l3&#45;&gt;recv_l3_e3_gpu3</title>
<path fill="none" stroke="black" d="M5456.18,-15924.79C5012.4,-15908.28 4273.54,-15880.39 3637.44,-15854.5 3296.96,-15840.64 3210.76,-15852.79 2871.44,-15821.5 2838.33,-15818.44 2803.47,-15814.41 2769.29,-15809.98"/>
<polygon fill="black" stroke="black" points="2769.56,-15806.49 2759.19,-15808.66 2768.65,-15813.43 2769.56,-15806.49"/>
<text text-anchor="middle" x="3709.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l3_e4_gpu4 -->
<g id="node185" class="node">
<title>recv_l3_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3202.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3202.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E4</text>
<text text-anchor="middle" x="3202.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3202.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3202.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e4_gpu4 -->
<g id="edge240" class="edge">
<title>route_l3&#45;&gt;recv_l3_e4_gpu4</title>
<path fill="none" stroke="black" d="M5464.2,-15930.37C5002.53,-15917.1 4211.13,-15886.55 3534.44,-15821.5 3501.61,-15818.34 3467.05,-15814.27 3433.13,-15809.86"/>
<polygon fill="black" stroke="black" points="3433.48,-15806.37 3423.11,-15808.54 3432.57,-15813.31 3433.48,-15806.37"/>
<text text-anchor="middle" x="3985.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l3_e5_gpu5 -->
<g id="node188" class="node">
<title>recv_l3_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3865.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3865.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E5</text>
<text text-anchor="middle" x="3865.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3865.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3865.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e5_gpu5 -->
<g id="edge244" class="edge">
<title>route_l3&#45;&gt;recv_l3_e5_gpu5</title>
<path fill="none" stroke="black" d="M5446.86,-15918.42C5111.03,-15899.14 4622.6,-15866.73 4197.44,-15821.5 4165.44,-15818.09 4131.78,-15813.96 4098.66,-15809.58"/>
<polygon fill="black" stroke="black" points="4098.78,-15806.06 4088.41,-15808.21 4097.86,-15813 4098.78,-15806.06"/>
<text text-anchor="middle" x="4586.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l3_e6_gpu6 -->
<g id="node191" class="node">
<title>recv_l3_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4528.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4528.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E6</text>
<text text-anchor="middle" x="4528.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4528.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4528.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e6_gpu6 -->
<g id="edge248" class="edge">
<title>route_l3&#45;&gt;recv_l3_e6_gpu6</title>
<path fill="none" stroke="black" d="M5404.2,-15888.24C5233.75,-15868.26 5038.04,-15844.63 4860.44,-15821.5 4830.1,-15817.54 4798.22,-15813.23 4766.71,-15808.87"/>
<polygon fill="black" stroke="black" points="4766.89,-15805.36 4756.5,-15807.45 4765.93,-15812.29 4766.89,-15805.36"/>
<text text-anchor="middle" x="5178.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l3_e7_gpu7 -->
<g id="node194" class="node">
<title>recv_l3_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5191.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5191.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E7</text>
<text text-anchor="middle" x="5191.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5191.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5191.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e7_gpu7 -->
<g id="edge252" class="edge">
<title>route_l3&#45;&gt;recv_l3_e7_gpu7</title>
<path fill="none" stroke="black" d="M5585.25,-15872.47C5510.71,-15853.91 5431.82,-15834.27 5364.37,-15817.47"/>
<polygon fill="black" stroke="black" points="5365.06,-15814.04 5354.51,-15815.02 5363.37,-15820.83 5365.06,-15814.04"/>
<text text-anchor="middle" x="5575.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l3_e8_gpu8 -->
<g id="node197" class="node">
<title>recv_l3_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5854.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5854.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E8</text>
<text text-anchor="middle" x="5854.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e8_gpu8 -->
<g id="edge256" class="edge">
<title>route_l3&#45;&gt;recv_l3_e8_gpu8</title>
<path fill="none" stroke="black" d="M5854.44,-15872.35C5854.44,-15858.97 5854.44,-15845.02 5854.44,-15832"/>
<polygon fill="black" stroke="black" points="5857.94,-15831.77 5854.44,-15821.77 5850.94,-15831.77 5857.94,-15831.77"/>
<text text-anchor="middle" x="5926.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l3_e9_gpu9 -->
<g id="node200" class="node">
<title>recv_l3_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6517.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6517.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E9</text>
<text text-anchor="middle" x="6517.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6517.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6517.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e9_gpu9 -->
<g id="edge260" class="edge">
<title>route_l3&#45;&gt;recv_l3_e9_gpu9</title>
<path fill="none" stroke="black" d="M6123.63,-15872.47C6198.17,-15853.91 6277.06,-15834.27 6344.51,-15817.47"/>
<polygon fill="black" stroke="black" points="6345.51,-15820.83 6354.37,-15815.02 6343.82,-15814.04 6345.51,-15820.83"/>
<text text-anchor="middle" x="6317.44" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l3_e10_gpu10 -->
<g id="node203" class="node">
<title>recv_l3_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7180.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7180.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E10</text>
<text text-anchor="middle" x="7180.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7180.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7180.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e10_gpu10 -->
<g id="edge264" class="edge">
<title>route_l3&#45;&gt;recv_l3_e10_gpu10</title>
<path fill="none" stroke="black" d="M6177.27,-15903.05C6371.83,-15880.62 6624.53,-15850.66 6848.44,-15821.5 6878.78,-15817.54 6910.66,-15813.23 6942.17,-15808.87"/>
<polygon fill="black" stroke="black" points="6942.96,-15812.29 6952.38,-15807.45 6941.99,-15805.36 6942.96,-15812.29"/>
<text text-anchor="middle" x="6762.94" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l3_e11_gpu11 -->
<g id="node206" class="node">
<title>recv_l3_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7843.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7843.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E11</text>
<text text-anchor="middle" x="7843.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7843.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7843.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e11_gpu11 -->
<g id="edge268" class="edge">
<title>route_l3&#45;&gt;recv_l3_e11_gpu11</title>
<path fill="none" stroke="black" d="M6203.79,-15921.72C6539.56,-15902.95 7061.01,-15869.41 7511.44,-15821.5 7543.44,-15818.09 7577.1,-15813.96 7610.22,-15809.58"/>
<polygon fill="black" stroke="black" points="7611.02,-15813 7620.47,-15808.21 7610.1,-15806.06 7611.02,-15813"/>
<text text-anchor="middle" x="7408.94" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l3_e12_gpu12 -->
<g id="node209" class="node">
<title>recv_l3_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8506.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8506.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E12</text>
<text text-anchor="middle" x="8506.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8506.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8506.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e12_gpu12 -->
<g id="edge272" class="edge">
<title>route_l3&#45;&gt;recv_l3_e12_gpu12</title>
<path fill="none" stroke="black" d="M6217.35,-15931.15C6674.61,-15918.31 7484.2,-15887.86 8174.44,-15821.5 8207.27,-15818.34 8241.83,-15814.27 8275.75,-15809.86"/>
<polygon fill="black" stroke="black" points="8276.32,-15813.31 8285.77,-15808.54 8275.4,-15806.37 8276.32,-15813.31"/>
<text text-anchor="middle" x="8000.94" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l3_e13_gpu13 -->
<g id="node212" class="node">
<title>recv_l3_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9169.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9169.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E13</text>
<text text-anchor="middle" x="9169.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9169.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9169.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e13_gpu13 -->
<g id="edge276" class="edge">
<title>route_l3&#45;&gt;recv_l3_e13_gpu13</title>
<path fill="none" stroke="black" d="M6210.76,-15926.5C6650.49,-15910.32 7421.1,-15881.51 8081.44,-15854.5 8417.48,-15840.75 8502.55,-15852.48 8837.44,-15821.5 8870.55,-15818.43 8905.41,-15814.39 8939.59,-15809.97"/>
<polygon fill="black" stroke="black" points="8940.23,-15813.41 8949.69,-15808.64 8939.32,-15806.47 8940.23,-15813.41"/>
<text text-anchor="middle" x="8666.94" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l3_e14_gpu14 -->
<g id="node215" class="node">
<title>recv_l3_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9832.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9832.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E14</text>
<text text-anchor="middle" x="9832.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9832.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9832.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e14_gpu14 -->
<g id="edge280" class="edge">
<title>route_l3&#45;&gt;recv_l3_e14_gpu14</title>
<path fill="none" stroke="black" d="M6216.16,-15930.54C6763.91,-15916.61 7836.53,-15887.84 8747.44,-15854.5 9082.2,-15842.24 9166.88,-15852.38 9500.44,-15821.5 9533.55,-15818.43 9568.41,-15814.39 9602.59,-15809.96"/>
<polygon fill="black" stroke="black" points="9603.23,-15813.41 9612.69,-15808.64 9602.32,-15806.47 9603.23,-15813.41"/>
<text text-anchor="middle" x="9330.94" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l3_e15_gpu15 -->
<g id="node218" class="node">
<title>recv_l3_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10495.44" cy="-15773.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10495.44" y="-15792.21" font-family="Times,serif" font-size="14.00">Token Receive L3E15</text>
<text text-anchor="middle" x="10495.44" y="-15777.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10495.44" y="-15762.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10495.44" y="-15747.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l3&#45;&gt;recv_l3_e15_gpu15 -->
<g id="edge284" class="edge">
<title>route_l3&#45;&gt;recv_l3_e15_gpu15</title>
<path fill="none" stroke="black" d="M6219.99,-15933.17C6864.66,-15921.47 8245.79,-15894 9411.44,-15854.5 9745.79,-15843.17 9830.32,-15852.35 10163.44,-15821.5 10196.55,-15818.43 10231.41,-15814.39 10265.59,-15809.96"/>
<polygon fill="black" stroke="black" points="10266.23,-15813.4 10275.69,-15808.64 10265.32,-15806.46 10266.23,-15813.4"/>
<text text-anchor="middle" x="9993.94" y="-15843.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l3_e0_gpu0 -->
<g id="node174" class="node">
<title>expert_l3_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="778.44,-15688.33 322.44,-15688.33 322.44,-15620.33 778.44,-15620.33 778.44,-15688.33"/>
<text text-anchor="middle" x="550.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E0</text>
<text text-anchor="middle" x="550.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="550.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="550.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l3_e0_gpu0&#45;&gt;expert_l3_e0_gpu0 -->
<g id="edge225" class="edge">
<title>recv_l3_e0_gpu0&#45;&gt;expert_l3_e0_gpu0</title>
<path fill="none" stroke="black" d="M550.44,-15725.13C550.44,-15716.37 550.44,-15707.27 550.44,-15698.64"/>
<polygon fill="black" stroke="black" points="553.94,-15698.41 550.44,-15688.41 546.94,-15698.41 553.94,-15698.41"/>
</g>
<!-- send_l3_e0_gpu0 -->
<g id="node175" class="node">
<title>send_l3_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="550.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="550.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E0</text>
<text text-anchor="middle" x="550.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="550.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="550.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l3_e0_gpu0&#45;&gt;send_l3_e0_gpu0 -->
<g id="edge226" class="edge">
<title>expert_l3_e0_gpu0&#45;&gt;send_l3_e0_gpu0</title>
<path fill="none" stroke="black" d="M550.44,-15620.09C550.44,-15611.84 550.44,-15602.76 550.44,-15593.71"/>
<polygon fill="black" stroke="black" points="553.94,-15593.55 550.44,-15583.55 546.94,-15593.55 553.94,-15593.55"/>
</g>
<!-- agg_l3 -->
<g id="node221" class="node">
<title>agg_l3</title>
<polygon fill="lightgray" stroke="black" points="6332.33,-15450.16 5572.12,-15450.16 5376.55,-15314.16 6136.76,-15314.16 6332.33,-15450.16"/>
<text text-anchor="middle" x="5854.44" y="-15400.96" font-family="Times,serif" font-size="14.00">Expert Aggregation L3</text>
<text text-anchor="middle" x="5854.44" y="-15385.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15370.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15355.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l3_e0_gpu0&#45;&gt;agg_l3 -->
<g id="edge227" class="edge">
<title>send_l3_e0_gpu0&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M767.45,-15499.66C805.68,-15494.66 845.16,-15490.19 882.44,-15487.16 1770.88,-15415.13 4460.64,-15391.64 5468.01,-15385.25"/>
<polygon fill="black" stroke="black" points="5468.34,-15388.74 5478.32,-15385.18 5468.29,-15381.74 5468.34,-15388.74"/>
</g>
<!-- expert_l3_e1_gpu1 -->
<g id="node177" class="node">
<title>expert_l3_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1441.44,-15688.33 985.44,-15688.33 985.44,-15620.33 1441.44,-15620.33 1441.44,-15688.33"/>
<text text-anchor="middle" x="1213.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E1</text>
<text text-anchor="middle" x="1213.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1213.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1213.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l3_e1_gpu1&#45;&gt;expert_l3_e1_gpu1 -->
<g id="edge229" class="edge">
<title>recv_l3_e1_gpu1&#45;&gt;expert_l3_e1_gpu1</title>
<path fill="none" stroke="black" d="M1213.44,-15725.13C1213.44,-15716.37 1213.44,-15707.27 1213.44,-15698.64"/>
<polygon fill="black" stroke="black" points="1216.94,-15698.41 1213.44,-15688.41 1209.94,-15698.41 1216.94,-15698.41"/>
</g>
<!-- send_l3_e1_gpu1 -->
<g id="node178" class="node">
<title>send_l3_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1213.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1213.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E1</text>
<text text-anchor="middle" x="1213.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1213.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1213.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l3_e1_gpu1&#45;&gt;send_l3_e1_gpu1 -->
<g id="edge230" class="edge">
<title>expert_l3_e1_gpu1&#45;&gt;send_l3_e1_gpu1</title>
<path fill="none" stroke="black" d="M1213.44,-15620.09C1213.44,-15611.84 1213.44,-15602.76 1213.44,-15593.71"/>
<polygon fill="black" stroke="black" points="1216.94,-15593.55 1213.44,-15583.55 1209.94,-15593.55 1216.94,-15593.55"/>
</g>
<!-- send_l3_e1_gpu1&#45;&gt;agg_l3 -->
<g id="edge231" class="edge">
<title>send_l3_e1_gpu1&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M1430.91,-15499.7C1468.99,-15494.71 1508.31,-15490.23 1545.44,-15487.16 2301.27,-15424.66 4561.64,-15395.94 5470.13,-15386.68"/>
<polygon fill="black" stroke="black" points="5470.46,-15390.18 5480.42,-15386.58 5470.39,-15383.18 5470.46,-15390.18"/>
</g>
<!-- expert_l3_e2_gpu2 -->
<g id="node180" class="node">
<title>expert_l3_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2104.44,-15688.33 1648.44,-15688.33 1648.44,-15620.33 2104.44,-15620.33 2104.44,-15688.33"/>
<text text-anchor="middle" x="1876.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E2</text>
<text text-anchor="middle" x="1876.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1876.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1876.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l3_e2_gpu2&#45;&gt;expert_l3_e2_gpu2 -->
<g id="edge233" class="edge">
<title>recv_l3_e2_gpu2&#45;&gt;expert_l3_e2_gpu2</title>
<path fill="none" stroke="black" d="M1876.44,-15725.13C1876.44,-15716.37 1876.44,-15707.27 1876.44,-15698.64"/>
<polygon fill="black" stroke="black" points="1879.94,-15698.41 1876.44,-15688.41 1872.94,-15698.41 1879.94,-15698.41"/>
</g>
<!-- send_l3_e2_gpu2 -->
<g id="node181" class="node">
<title>send_l3_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1876.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1876.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E2</text>
<text text-anchor="middle" x="1876.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1876.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1876.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l3_e2_gpu2&#45;&gt;send_l3_e2_gpu2 -->
<g id="edge234" class="edge">
<title>expert_l3_e2_gpu2&#45;&gt;send_l3_e2_gpu2</title>
<path fill="none" stroke="black" d="M1876.44,-15620.09C1876.44,-15611.84 1876.44,-15602.76 1876.44,-15593.71"/>
<polygon fill="black" stroke="black" points="1879.94,-15593.55 1876.44,-15583.55 1872.94,-15593.55 1879.94,-15593.55"/>
</g>
<!-- send_l3_e2_gpu2&#45;&gt;agg_l3 -->
<g id="edge235" class="edge">
<title>send_l3_e2_gpu2&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M2094.36,-15499.78C2132.31,-15494.8 2171.46,-15490.3 2208.44,-15487.16 2832.79,-15434.16 4670.71,-15400.95 5472.78,-15388.61"/>
<polygon fill="black" stroke="black" points="5473.1,-15392.11 5483.05,-15388.45 5472.99,-15385.11 5473.1,-15392.11"/>
</g>
<!-- expert_l3_e3_gpu3 -->
<g id="node183" class="node">
<title>expert_l3_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2767.44,-15688.33 2311.44,-15688.33 2311.44,-15620.33 2767.44,-15620.33 2767.44,-15688.33"/>
<text text-anchor="middle" x="2539.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E3</text>
<text text-anchor="middle" x="2539.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2539.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2539.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l3_e3_gpu3&#45;&gt;expert_l3_e3_gpu3 -->
<g id="edge237" class="edge">
<title>recv_l3_e3_gpu3&#45;&gt;expert_l3_e3_gpu3</title>
<path fill="none" stroke="black" d="M2539.44,-15725.13C2539.44,-15716.37 2539.44,-15707.27 2539.44,-15698.64"/>
<polygon fill="black" stroke="black" points="2542.94,-15698.41 2539.44,-15688.41 2535.94,-15698.41 2542.94,-15698.41"/>
</g>
<!-- send_l3_e3_gpu3 -->
<g id="node184" class="node">
<title>send_l3_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2539.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2539.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E3</text>
<text text-anchor="middle" x="2539.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2539.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2539.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l3_e3_gpu3&#45;&gt;send_l3_e3_gpu3 -->
<g id="edge238" class="edge">
<title>expert_l3_e3_gpu3&#45;&gt;send_l3_e3_gpu3</title>
<path fill="none" stroke="black" d="M2539.44,-15620.09C2539.44,-15611.84 2539.44,-15602.76 2539.44,-15593.71"/>
<polygon fill="black" stroke="black" points="2542.94,-15593.55 2539.44,-15583.55 2535.94,-15593.55 2542.94,-15593.55"/>
</g>
<!-- send_l3_e3_gpu3&#45;&gt;agg_l3 -->
<g id="edge239" class="edge">
<title>send_l3_e3_gpu3&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M2758.27,-15499.86C2795.94,-15494.9 2834.76,-15490.39 2871.44,-15487.16 3799.8,-15405.38 4896,-15387.18 5466.04,-15383.59"/>
<polygon fill="black" stroke="black" points="5466.08,-15387.09 5476.06,-15383.52 5466.04,-15380.09 5466.08,-15387.09"/>
</g>
<!-- expert_l3_e4_gpu4 -->
<g id="node186" class="node">
<title>expert_l3_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3430.44,-15688.33 2974.44,-15688.33 2974.44,-15620.33 3430.44,-15620.33 3430.44,-15688.33"/>
<text text-anchor="middle" x="3202.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E4</text>
<text text-anchor="middle" x="3202.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3202.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3202.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l3_e4_gpu4&#45;&gt;expert_l3_e4_gpu4 -->
<g id="edge241" class="edge">
<title>recv_l3_e4_gpu4&#45;&gt;expert_l3_e4_gpu4</title>
<path fill="none" stroke="black" d="M3202.44,-15725.13C3202.44,-15716.37 3202.44,-15707.27 3202.44,-15698.64"/>
<polygon fill="black" stroke="black" points="3205.94,-15698.41 3202.44,-15688.41 3198.94,-15698.41 3205.94,-15698.41"/>
</g>
<!-- send_l3_e4_gpu4 -->
<g id="node187" class="node">
<title>send_l3_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3202.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3202.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E4</text>
<text text-anchor="middle" x="3202.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3202.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3202.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l3_e4_gpu4&#45;&gt;send_l3_e4_gpu4 -->
<g id="edge242" class="edge">
<title>expert_l3_e4_gpu4&#45;&gt;send_l3_e4_gpu4</title>
<path fill="none" stroke="black" d="M3202.44,-15620.09C3202.44,-15611.84 3202.44,-15602.76 3202.44,-15593.71"/>
<polygon fill="black" stroke="black" points="3205.94,-15593.55 3202.44,-15583.55 3198.94,-15593.55 3205.94,-15593.55"/>
</g>
<!-- send_l3_e4_gpu4&#45;&gt;agg_l3 -->
<g id="edge243" class="edge">
<title>send_l3_e4_gpu4&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M3422.2,-15500.05C3459.58,-15495.1 3498.07,-15490.55 3534.44,-15487.16 4215.76,-15423.73 5013.37,-15398.69 5473.64,-15389.02"/>
<polygon fill="black" stroke="black" points="5473.85,-15392.52 5483.77,-15388.81 5473.7,-15385.52 5473.85,-15392.52"/>
</g>
<!-- expert_l3_e5_gpu5 -->
<g id="node189" class="node">
<title>expert_l3_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4093.44,-15688.33 3637.44,-15688.33 3637.44,-15620.33 4093.44,-15620.33 4093.44,-15688.33"/>
<text text-anchor="middle" x="3865.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E5</text>
<text text-anchor="middle" x="3865.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3865.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3865.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l3_e5_gpu5&#45;&gt;expert_l3_e5_gpu5 -->
<g id="edge245" class="edge">
<title>recv_l3_e5_gpu5&#45;&gt;expert_l3_e5_gpu5</title>
<path fill="none" stroke="black" d="M3865.44,-15725.13C3865.44,-15716.37 3865.44,-15707.27 3865.44,-15698.64"/>
<polygon fill="black" stroke="black" points="3868.94,-15698.41 3865.44,-15688.41 3861.94,-15698.41 3868.94,-15698.41"/>
</g>
<!-- send_l3_e5_gpu5 -->
<g id="node190" class="node">
<title>send_l3_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3865.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3865.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E5</text>
<text text-anchor="middle" x="3865.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3865.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3865.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l3_e5_gpu5&#45;&gt;send_l3_e5_gpu5 -->
<g id="edge246" class="edge">
<title>expert_l3_e5_gpu5&#45;&gt;send_l3_e5_gpu5</title>
<path fill="none" stroke="black" d="M3865.44,-15620.09C3865.44,-15611.84 3865.44,-15602.76 3865.44,-15593.71"/>
<polygon fill="black" stroke="black" points="3868.94,-15593.55 3865.44,-15583.55 3861.94,-15593.55 3868.94,-15593.55"/>
</g>
<!-- send_l3_e5_gpu5&#45;&gt;agg_l3 -->
<g id="edge247" class="edge">
<title>send_l3_e5_gpu5&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M4087.49,-15500.31C4124.16,-15495.41 4161.82,-15490.8 4197.44,-15487.16 4639.29,-15442.04 5149.57,-15413.55 5485.81,-15398.03"/>
<polygon fill="black" stroke="black" points="5486.38,-15401.51 5496.2,-15397.55 5486.05,-15394.52 5486.38,-15401.51"/>
</g>
<!-- expert_l3_e6_gpu6 -->
<g id="node192" class="node">
<title>expert_l3_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4756.44,-15688.33 4300.44,-15688.33 4300.44,-15620.33 4756.44,-15620.33 4756.44,-15688.33"/>
<text text-anchor="middle" x="4528.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E6</text>
<text text-anchor="middle" x="4528.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4528.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4528.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l3_e6_gpu6&#45;&gt;expert_l3_e6_gpu6 -->
<g id="edge249" class="edge">
<title>recv_l3_e6_gpu6&#45;&gt;expert_l3_e6_gpu6</title>
<path fill="none" stroke="black" d="M4528.44,-15725.13C4528.44,-15716.37 4528.44,-15707.27 4528.44,-15698.64"/>
<polygon fill="black" stroke="black" points="4531.94,-15698.41 4528.44,-15688.41 4524.94,-15698.41 4531.94,-15698.41"/>
</g>
<!-- send_l3_e6_gpu6 -->
<g id="node193" class="node">
<title>send_l3_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4528.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4528.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E6</text>
<text text-anchor="middle" x="4528.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4528.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4528.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l3_e6_gpu6&#45;&gt;send_l3_e6_gpu6 -->
<g id="edge250" class="edge">
<title>expert_l3_e6_gpu6&#45;&gt;send_l3_e6_gpu6</title>
<path fill="none" stroke="black" d="M4528.44,-15620.09C4528.44,-15611.84 4528.44,-15602.76 4528.44,-15593.71"/>
<polygon fill="black" stroke="black" points="4531.94,-15593.55 4528.44,-15583.55 4524.94,-15593.55 4531.94,-15593.55"/>
</g>
<!-- send_l3_e6_gpu6&#45;&gt;agg_l3 -->
<g id="edge251" class="edge">
<title>send_l3_e6_gpu6&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M4755.1,-15500.97C4790.34,-15496.13 4826.35,-15491.36 4860.44,-15487.16 5076.57,-15460.54 5319.69,-15435.02 5511.39,-15415.93"/>
<polygon fill="black" stroke="black" points="5511.74,-15419.41 5521.34,-15414.94 5511.05,-15412.45 5511.74,-15419.41"/>
</g>
<!-- expert_l3_e7_gpu7 -->
<g id="node195" class="node">
<title>expert_l3_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5419.44,-15688.33 4963.44,-15688.33 4963.44,-15620.33 5419.44,-15620.33 5419.44,-15688.33"/>
<text text-anchor="middle" x="5191.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E7</text>
<text text-anchor="middle" x="5191.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5191.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5191.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l3_e7_gpu7&#45;&gt;expert_l3_e7_gpu7 -->
<g id="edge253" class="edge">
<title>recv_l3_e7_gpu7&#45;&gt;expert_l3_e7_gpu7</title>
<path fill="none" stroke="black" d="M5191.44,-15725.13C5191.44,-15716.37 5191.44,-15707.27 5191.44,-15698.64"/>
<polygon fill="black" stroke="black" points="5194.94,-15698.41 5191.44,-15688.41 5187.94,-15698.41 5194.94,-15698.41"/>
</g>
<!-- send_l3_e7_gpu7 -->
<g id="node196" class="node">
<title>send_l3_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5191.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5191.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E7</text>
<text text-anchor="middle" x="5191.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5191.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5191.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l3_e7_gpu7&#45;&gt;send_l3_e7_gpu7 -->
<g id="edge254" class="edge">
<title>expert_l3_e7_gpu7&#45;&gt;send_l3_e7_gpu7</title>
<path fill="none" stroke="black" d="M5191.44,-15620.09C5191.44,-15611.84 5191.44,-15602.76 5191.44,-15593.71"/>
<polygon fill="black" stroke="black" points="5194.94,-15593.55 5191.44,-15583.55 5187.94,-15593.55 5194.94,-15593.55"/>
</g>
<!-- send_l3_e7_gpu7&#45;&gt;agg_l3 -->
<g id="edge255" class="edge">
<title>send_l3_e7_gpu7&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M5365.2,-15494.65C5424.63,-15481.11 5492.87,-15465.56 5559.16,-15450.45"/>
<polygon fill="black" stroke="black" points="5559.95,-15453.86 5568.92,-15448.23 5558.39,-15447.04 5559.95,-15453.86"/>
</g>
<!-- expert_l3_e8_gpu8 -->
<g id="node198" class="node">
<title>expert_l3_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6082.44,-15688.33 5626.44,-15688.33 5626.44,-15620.33 6082.44,-15620.33 6082.44,-15688.33"/>
<text text-anchor="middle" x="5854.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E8</text>
<text text-anchor="middle" x="5854.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l3_e8_gpu8&#45;&gt;expert_l3_e8_gpu8 -->
<g id="edge257" class="edge">
<title>recv_l3_e8_gpu8&#45;&gt;expert_l3_e8_gpu8</title>
<path fill="none" stroke="black" d="M5854.44,-15725.13C5854.44,-15716.37 5854.44,-15707.27 5854.44,-15698.64"/>
<polygon fill="black" stroke="black" points="5857.94,-15698.41 5854.44,-15688.41 5850.94,-15698.41 5857.94,-15698.41"/>
</g>
<!-- send_l3_e8_gpu8 -->
<g id="node199" class="node">
<title>send_l3_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5854.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5854.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E8</text>
<text text-anchor="middle" x="5854.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5854.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l3_e8_gpu8&#45;&gt;send_l3_e8_gpu8 -->
<g id="edge258" class="edge">
<title>expert_l3_e8_gpu8&#45;&gt;send_l3_e8_gpu8</title>
<path fill="none" stroke="black" d="M5854.44,-15620.09C5854.44,-15611.84 5854.44,-15602.76 5854.44,-15593.71"/>
<polygon fill="black" stroke="black" points="5857.94,-15593.55 5854.44,-15583.55 5850.94,-15593.55 5857.94,-15593.55"/>
</g>
<!-- send_l3_e8_gpu8&#45;&gt;agg_l3 -->
<g id="edge259" class="edge">
<title>send_l3_e8_gpu8&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M5854.44,-15486.86C5854.44,-15478.43 5854.44,-15469.46 5854.44,-15460.46"/>
<polygon fill="black" stroke="black" points="5857.94,-15460.31 5854.44,-15450.31 5850.94,-15460.31 5857.94,-15460.31"/>
</g>
<!-- expert_l3_e9_gpu9 -->
<g id="node201" class="node">
<title>expert_l3_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6745.44,-15688.33 6289.44,-15688.33 6289.44,-15620.33 6745.44,-15620.33 6745.44,-15688.33"/>
<text text-anchor="middle" x="6517.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E9</text>
<text text-anchor="middle" x="6517.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6517.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6517.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l3_e9_gpu9&#45;&gt;expert_l3_e9_gpu9 -->
<g id="edge261" class="edge">
<title>recv_l3_e9_gpu9&#45;&gt;expert_l3_e9_gpu9</title>
<path fill="none" stroke="black" d="M6517.44,-15725.13C6517.44,-15716.37 6517.44,-15707.27 6517.44,-15698.64"/>
<polygon fill="black" stroke="black" points="6520.94,-15698.41 6517.44,-15688.41 6513.94,-15698.41 6520.94,-15698.41"/>
</g>
<!-- send_l3_e9_gpu9 -->
<g id="node202" class="node">
<title>send_l3_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6517.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6517.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E9</text>
<text text-anchor="middle" x="6517.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6517.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6517.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l3_e9_gpu9&#45;&gt;send_l3_e9_gpu9 -->
<g id="edge262" class="edge">
<title>expert_l3_e9_gpu9&#45;&gt;send_l3_e9_gpu9</title>
<path fill="none" stroke="black" d="M6517.44,-15620.09C6517.44,-15611.84 6517.44,-15602.76 6517.44,-15593.71"/>
<polygon fill="black" stroke="black" points="6520.94,-15593.55 6517.44,-15583.55 6513.94,-15593.55 6520.94,-15593.55"/>
</g>
<!-- send_l3_e9_gpu9&#45;&gt;agg_l3 -->
<g id="edge263" class="edge">
<title>send_l3_e9_gpu9&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M6343.68,-15494.65C6286.84,-15481.7 6221.93,-15466.91 6158.39,-15452.43"/>
<polygon fill="black" stroke="black" points="6159.14,-15449.01 6148.61,-15450.2 6157.59,-15455.83 6159.14,-15449.01"/>
</g>
<!-- expert_l3_e10_gpu10 -->
<g id="node204" class="node">
<title>expert_l3_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7408.44,-15688.33 6952.44,-15688.33 6952.44,-15620.33 7408.44,-15620.33 7408.44,-15688.33"/>
<text text-anchor="middle" x="7180.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E10</text>
<text text-anchor="middle" x="7180.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7180.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7180.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l3_e10_gpu10&#45;&gt;expert_l3_e10_gpu10 -->
<g id="edge265" class="edge">
<title>recv_l3_e10_gpu10&#45;&gt;expert_l3_e10_gpu10</title>
<path fill="none" stroke="black" d="M7180.44,-15725.13C7180.44,-15716.37 7180.44,-15707.27 7180.44,-15698.64"/>
<polygon fill="black" stroke="black" points="7183.94,-15698.41 7180.44,-15688.41 7176.94,-15698.41 7183.94,-15698.41"/>
</g>
<!-- send_l3_e10_gpu10 -->
<g id="node205" class="node">
<title>send_l3_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7180.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7180.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E10</text>
<text text-anchor="middle" x="7180.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7180.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7180.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l3_e10_gpu10&#45;&gt;send_l3_e10_gpu10 -->
<g id="edge266" class="edge">
<title>expert_l3_e10_gpu10&#45;&gt;send_l3_e10_gpu10</title>
<path fill="none" stroke="black" d="M7180.44,-15620.09C7180.44,-15611.84 7180.44,-15602.76 7180.44,-15593.71"/>
<polygon fill="black" stroke="black" points="7183.94,-15593.55 7180.44,-15583.55 7176.94,-15593.55 7183.94,-15593.55"/>
</g>
<!-- send_l3_e10_gpu10&#45;&gt;agg_l3 -->
<g id="edge267" class="edge">
<title>send_l3_e10_gpu10&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M6953.78,-15500.97C6918.54,-15496.13 6882.53,-15491.36 6848.44,-15487.16 6672,-15465.43 6477.57,-15444.43 6307.81,-15427.07"/>
<polygon fill="black" stroke="black" points="6308,-15423.57 6297.69,-15426.03 6307.29,-15430.53 6308,-15423.57"/>
</g>
<!-- expert_l3_e11_gpu11 -->
<g id="node207" class="node">
<title>expert_l3_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8071.44,-15688.33 7615.44,-15688.33 7615.44,-15620.33 8071.44,-15620.33 8071.44,-15688.33"/>
<text text-anchor="middle" x="7843.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E11</text>
<text text-anchor="middle" x="7843.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7843.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7843.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l3_e11_gpu11&#45;&gt;expert_l3_e11_gpu11 -->
<g id="edge269" class="edge">
<title>recv_l3_e11_gpu11&#45;&gt;expert_l3_e11_gpu11</title>
<path fill="none" stroke="black" d="M7843.44,-15725.13C7843.44,-15716.37 7843.44,-15707.27 7843.44,-15698.64"/>
<polygon fill="black" stroke="black" points="7846.94,-15698.41 7843.44,-15688.41 7839.94,-15698.41 7846.94,-15698.41"/>
</g>
<!-- send_l3_e11_gpu11 -->
<g id="node208" class="node">
<title>send_l3_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7843.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7843.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E11</text>
<text text-anchor="middle" x="7843.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7843.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7843.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l3_e11_gpu11&#45;&gt;send_l3_e11_gpu11 -->
<g id="edge270" class="edge">
<title>expert_l3_e11_gpu11&#45;&gt;send_l3_e11_gpu11</title>
<path fill="none" stroke="black" d="M7843.44,-15620.09C7843.44,-15611.84 7843.44,-15602.76 7843.44,-15593.71"/>
<polygon fill="black" stroke="black" points="7846.94,-15593.55 7843.44,-15583.55 7839.94,-15593.55 7846.94,-15593.55"/>
</g>
<!-- send_l3_e11_gpu11&#45;&gt;agg_l3 -->
<g id="edge271" class="edge">
<title>send_l3_e11_gpu11&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M7621.4,-15500.31C7584.72,-15495.41 7547.06,-15490.8 7511.44,-15487.16 7089.81,-15444.1 6605.87,-15416.2 6270.31,-15400.24"/>
<polygon fill="black" stroke="black" points="6270.08,-15396.73 6259.92,-15399.75 6269.75,-15403.72 6270.08,-15396.73"/>
</g>
<!-- expert_l3_e12_gpu12 -->
<g id="node210" class="node">
<title>expert_l3_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8734.44,-15688.33 8278.44,-15688.33 8278.44,-15620.33 8734.44,-15620.33 8734.44,-15688.33"/>
<text text-anchor="middle" x="8506.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E12</text>
<text text-anchor="middle" x="8506.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8506.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8506.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l3_e12_gpu12&#45;&gt;expert_l3_e12_gpu12 -->
<g id="edge273" class="edge">
<title>recv_l3_e12_gpu12&#45;&gt;expert_l3_e12_gpu12</title>
<path fill="none" stroke="black" d="M8506.44,-15725.13C8506.44,-15716.37 8506.44,-15707.27 8506.44,-15698.64"/>
<polygon fill="black" stroke="black" points="8509.94,-15698.41 8506.44,-15688.41 8502.94,-15698.41 8509.94,-15698.41"/>
</g>
<!-- send_l3_e12_gpu12 -->
<g id="node211" class="node">
<title>send_l3_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8506.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8506.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E12</text>
<text text-anchor="middle" x="8506.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8506.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8506.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l3_e12_gpu12&#45;&gt;send_l3_e12_gpu12 -->
<g id="edge274" class="edge">
<title>expert_l3_e12_gpu12&#45;&gt;send_l3_e12_gpu12</title>
<path fill="none" stroke="black" d="M8506.44,-15620.09C8506.44,-15611.84 8506.44,-15602.76 8506.44,-15593.71"/>
<polygon fill="black" stroke="black" points="8509.94,-15593.55 8506.44,-15583.55 8502.94,-15593.55 8509.94,-15593.55"/>
</g>
<!-- send_l3_e12_gpu12&#45;&gt;agg_l3 -->
<g id="edge275" class="edge">
<title>send_l3_e12_gpu12&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M8286.69,-15500.05C8249.3,-15495.1 8210.81,-15490.55 8174.44,-15487.16 7502.83,-15424.63 6718.23,-15399.42 6255.13,-15389.45"/>
<polygon fill="black" stroke="black" points="6255.01,-15385.94 6244.93,-15389.23 6254.86,-15392.94 6255.01,-15385.94"/>
</g>
<!-- expert_l3_e13_gpu13 -->
<g id="node213" class="node">
<title>expert_l3_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9397.44,-15688.33 8941.44,-15688.33 8941.44,-15620.33 9397.44,-15620.33 9397.44,-15688.33"/>
<text text-anchor="middle" x="9169.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E13</text>
<text text-anchor="middle" x="9169.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9169.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9169.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l3_e13_gpu13&#45;&gt;expert_l3_e13_gpu13 -->
<g id="edge277" class="edge">
<title>recv_l3_e13_gpu13&#45;&gt;expert_l3_e13_gpu13</title>
<path fill="none" stroke="black" d="M9169.44,-15725.13C9169.44,-15716.37 9169.44,-15707.27 9169.44,-15698.64"/>
<polygon fill="black" stroke="black" points="9172.94,-15698.41 9169.44,-15688.41 9165.94,-15698.41 9172.94,-15698.41"/>
</g>
<!-- send_l3_e13_gpu13 -->
<g id="node214" class="node">
<title>send_l3_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9169.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9169.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E13</text>
<text text-anchor="middle" x="9169.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9169.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9169.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l3_e13_gpu13&#45;&gt;send_l3_e13_gpu13 -->
<g id="edge278" class="edge">
<title>expert_l3_e13_gpu13&#45;&gt;send_l3_e13_gpu13</title>
<path fill="none" stroke="black" d="M9169.44,-15620.09C9169.44,-15611.84 9169.44,-15602.76 9169.44,-15593.71"/>
<polygon fill="black" stroke="black" points="9172.94,-15593.55 9169.44,-15583.55 9165.94,-15593.55 9172.94,-15593.55"/>
</g>
<!-- send_l3_e13_gpu13&#45;&gt;agg_l3 -->
<g id="edge279" class="edge">
<title>send_l3_e13_gpu13&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M8950.61,-15499.86C8912.94,-15494.9 8874.12,-15490.39 8837.44,-15487.16 7911.16,-15405.57 6817.8,-15387.26 6246.69,-15383.61"/>
<polygon fill="black" stroke="black" points="6246.67,-15380.11 6236.65,-15383.55 6246.63,-15387.11 6246.67,-15380.11"/>
</g>
<!-- expert_l3_e14_gpu14 -->
<g id="node216" class="node">
<title>expert_l3_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10060.44,-15688.33 9604.44,-15688.33 9604.44,-15620.33 10060.44,-15620.33 10060.44,-15688.33"/>
<text text-anchor="middle" x="9832.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E14</text>
<text text-anchor="middle" x="9832.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9832.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9832.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l3_e14_gpu14&#45;&gt;expert_l3_e14_gpu14 -->
<g id="edge281" class="edge">
<title>recv_l3_e14_gpu14&#45;&gt;expert_l3_e14_gpu14</title>
<path fill="none" stroke="black" d="M9832.44,-15725.13C9832.44,-15716.37 9832.44,-15707.27 9832.44,-15698.64"/>
<polygon fill="black" stroke="black" points="9835.94,-15698.41 9832.44,-15688.41 9828.94,-15698.41 9835.94,-15698.41"/>
</g>
<!-- send_l3_e14_gpu14 -->
<g id="node217" class="node">
<title>send_l3_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9832.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9832.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E14</text>
<text text-anchor="middle" x="9832.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9832.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9832.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l3_e14_gpu14&#45;&gt;send_l3_e14_gpu14 -->
<g id="edge282" class="edge">
<title>expert_l3_e14_gpu14&#45;&gt;send_l3_e14_gpu14</title>
<path fill="none" stroke="black" d="M9832.44,-15620.09C9832.44,-15611.84 9832.44,-15602.76 9832.44,-15593.71"/>
<polygon fill="black" stroke="black" points="9835.94,-15593.55 9832.44,-15583.55 9828.94,-15593.55 9835.94,-15593.55"/>
</g>
<!-- send_l3_e14_gpu14&#45;&gt;agg_l3 -->
<g id="edge283" class="edge">
<title>send_l3_e14_gpu14&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M9614.52,-15499.78C9576.57,-15494.8 9537.42,-15490.3 9500.44,-15487.16 8880.73,-15434.55 7065.4,-15401.45 6254.14,-15388.89"/>
<polygon fill="black" stroke="black" points="6254.1,-15385.39 6244.05,-15388.73 6253.99,-15392.39 6254.1,-15385.39"/>
</g>
<!-- expert_l3_e15_gpu15 -->
<g id="node219" class="node">
<title>expert_l3_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10723.44,-15688.33 10267.44,-15688.33 10267.44,-15620.33 10723.44,-15620.33 10723.44,-15688.33"/>
<text text-anchor="middle" x="10495.44" y="-15673.13" font-family="Times,serif" font-size="14.00">Expert L3E15</text>
<text text-anchor="middle" x="10495.44" y="-15658.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10495.44" y="-15643.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10495.44" y="-15628.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l3_e15_gpu15&#45;&gt;expert_l3_e15_gpu15 -->
<g id="edge285" class="edge">
<title>recv_l3_e15_gpu15&#45;&gt;expert_l3_e15_gpu15</title>
<path fill="none" stroke="black" d="M10495.44,-15725.13C10495.44,-15716.37 10495.44,-15707.27 10495.44,-15698.64"/>
<polygon fill="black" stroke="black" points="10498.94,-15698.41 10495.44,-15688.41 10491.94,-15698.41 10498.94,-15698.41"/>
</g>
<!-- send_l3_e15_gpu15 -->
<g id="node220" class="node">
<title>send_l3_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10495.44" cy="-15535.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10495.44" y="-15554.05" font-family="Times,serif" font-size="14.00">Token Send L3E15</text>
<text text-anchor="middle" x="10495.44" y="-15539.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10495.44" y="-15524.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10495.44" y="-15509.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l3_e15_gpu15&#45;&gt;send_l3_e15_gpu15 -->
<g id="edge286" class="edge">
<title>expert_l3_e15_gpu15&#45;&gt;send_l3_e15_gpu15</title>
<path fill="none" stroke="black" d="M10495.44,-15620.09C10495.44,-15611.84 10495.44,-15602.76 10495.44,-15593.71"/>
<polygon fill="black" stroke="black" points="10498.94,-15593.55 10495.44,-15583.55 10491.94,-15593.55 10498.94,-15593.55"/>
</g>
<!-- send_l3_e15_gpu15&#45;&gt;agg_l3 -->
<g id="edge287" class="edge">
<title>send_l3_e15_gpu15&#45;&gt;agg_l3</title>
<path fill="none" stroke="black" d="M10277.97,-15499.7C10239.89,-15494.71 10200.57,-15490.23 10163.44,-15487.16 9411.12,-15424.95 7168.18,-15396.2 6251.48,-15386.81"/>
<polygon fill="black" stroke="black" points="6251.46,-15383.31 6241.43,-15386.71 6251.39,-15390.31 6251.46,-15383.31"/>
</g>
<!-- residual2_l3 -->
<g id="node222" class="node">
<title>residual2_l3</title>
<polygon fill="lightpink" stroke="black" points="6099.94,-15277.16 5664.94,-15277.16 5664.94,-15209.16 6099.94,-15209.16 6099.94,-15277.16"/>
<text text-anchor="middle" x="5882.44" y="-15261.96" font-family="Times,serif" font-size="14.00">ResidualAdd L3</text>
<text text-anchor="middle" x="5882.44" y="-15246.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5882.44" y="-15231.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5882.44" y="-15216.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l3&#45;&gt;residual2_l3 -->
<g id="edge288" class="edge">
<title>agg_l3&#45;&gt;residual2_l3</title>
<path fill="none" stroke="black" d="M5868.19,-15313.87C5870.04,-15304.82 5871.9,-15295.75 5873.63,-15287.28"/>
<polygon fill="black" stroke="black" points="5877.1,-15287.79 5875.67,-15277.29 5870.24,-15286.39 5877.1,-15287.79"/>
</g>
<!-- residual2_l3&#45;&gt;ln1_l4 -->
<g id="edge289" class="edge">
<title>residual2_l3&#45;&gt;ln1_l4</title>
<path fill="none" stroke="black" d="M5897.89,-15209.01C5901.96,-15200.28 5906.41,-15190.74 5910.67,-15181.59"/>
<polygon fill="black" stroke="black" points="5913.97,-15182.8 5915.02,-15172.26 5907.62,-15179.84 5913.97,-15182.8"/>
</g>
<!-- attn_l4 -->
<g id="node224" class="node">
<title>attn_l4</title>
<polygon fill="lightcoral" stroke="black" points="6160.44,-15067.16 5700.44,-15067.16 5700.44,-14999.16 6160.44,-14999.16 6160.44,-15067.16"/>
<text text-anchor="middle" x="5930.44" y="-15051.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L4</text>
<text text-anchor="middle" x="5930.44" y="-15036.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5930.44" y="-15021.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-15006.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l4&#45;&gt;attn_l4 -->
<g id="edge292" class="edge">
<title>ln1_l4&#45;&gt;attn_l4</title>
<path fill="none" stroke="black" d="M5930.44,-15104.01C5930.44,-15095.55 5930.44,-15086.34 5930.44,-15077.46"/>
<polygon fill="black" stroke="black" points="5933.94,-15077.26 5930.44,-15067.26 5926.94,-15077.26 5933.94,-15077.26"/>
</g>
<!-- residual1_l4 -->
<g id="node225" class="node">
<title>residual1_l4</title>
<polygon fill="lightpink" stroke="black" points="6147.94,-14962.16 5712.94,-14962.16 5712.94,-14894.16 6147.94,-14894.16 6147.94,-14962.16"/>
<text text-anchor="middle" x="5930.44" y="-14946.96" font-family="Times,serif" font-size="14.00">ResidualAdd L4</text>
<text text-anchor="middle" x="5930.44" y="-14931.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14916.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14901.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l4&#45;&gt;residual1_l4 -->
<g id="edge293" class="edge">
<title>attn_l4&#45;&gt;residual1_l4</title>
<path fill="none" stroke="black" d="M5930.44,-14999.01C5930.44,-14990.55 5930.44,-14981.34 5930.44,-14972.46"/>
<polygon fill="black" stroke="black" points="5933.94,-14972.26 5930.44,-14962.26 5926.94,-14972.26 5933.94,-14972.26"/>
</g>
<!-- ln2_l4 -->
<g id="node226" class="node">
<title>ln2_l4</title>
<polygon fill="lightyellow" stroke="black" points="6147.94,-14857.16 5712.94,-14857.16 5712.94,-14789.16 6147.94,-14789.16 6147.94,-14857.16"/>
<text text-anchor="middle" x="5930.44" y="-14841.96" font-family="Times,serif" font-size="14.00">LayerNorm L4</text>
<text text-anchor="middle" x="5930.44" y="-14826.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14811.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14796.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l4&#45;&gt;ln2_l4 -->
<g id="edge294" class="edge">
<title>residual1_l4&#45;&gt;ln2_l4</title>
<path fill="none" stroke="black" d="M5930.44,-14894.01C5930.44,-14885.55 5930.44,-14876.34 5930.44,-14867.46"/>
<polygon fill="black" stroke="black" points="5933.94,-14867.26 5930.44,-14857.26 5926.94,-14867.26 5933.94,-14867.26"/>
</g>
<!-- ln2_l4&#45;&gt;route_l4 -->
<g id="edge295" class="edge">
<title>ln2_l4&#45;&gt;route_l4</title>
<path fill="none" stroke="black" d="M5930.44,-14789C5930.44,-14780.86 5930.44,-14771.8 5930.44,-14762.52"/>
<polygon fill="black" stroke="black" points="5933.94,-14762.4 5930.44,-14752.4 5926.94,-14762.4 5933.94,-14762.4"/>
</g>
<!-- recv_l4_e0_gpu0 -->
<g id="node228" class="node">
<title>recv_l4_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="626.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="626.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E0</text>
<text text-anchor="middle" x="626.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e0_gpu0 -->
<g id="edge296" class="edge">
<title>route_l4&#45;&gt;recv_l4_e0_gpu0</title>
<path fill="none" stroke="black" d="M5546.34,-14678.47C4804.72,-14668.74 3124,-14643.41 1710.44,-14598.16 1376.07,-14587.46 1291.56,-14596.02 958.44,-14565.16 925.33,-14562.1 890.48,-14558.05 856.29,-14553.63"/>
<polygon fill="black" stroke="black" points="856.56,-14550.13 846.19,-14552.3 855.65,-14557.07 856.56,-14550.13"/>
<text text-anchor="middle" x="1782.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l4_e1_gpu1 -->
<g id="node231" class="node">
<title>recv_l4_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1289.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1289.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E1</text>
<text text-anchor="middle" x="1289.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1289.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1289.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e1_gpu1 -->
<g id="edge300" class="edge">
<title>route_l4&#45;&gt;recv_l4_e1_gpu1</title>
<path fill="none" stroke="black" d="M5543.4,-14676.29C4891.9,-14664.18 3534.87,-14636.64 2387.44,-14598.16 2046.87,-14586.74 1960.76,-14596.46 1621.44,-14565.16 1588.33,-14562.11 1553.47,-14558.08 1519.29,-14553.65"/>
<polygon fill="black" stroke="black" points="1519.56,-14550.16 1509.19,-14552.33 1518.65,-14557.1 1519.56,-14550.16"/>
<text text-anchor="middle" x="2459.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l4_e2_gpu2 -->
<g id="node234" class="node">
<title>recv_l4_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1952.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1952.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E2</text>
<text text-anchor="middle" x="1952.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1952.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1952.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e2_gpu2 -->
<g id="edge304" class="edge">
<title>route_l4&#45;&gt;recv_l4_e2_gpu2</title>
<path fill="none" stroke="black" d="M5539.09,-14673.29C4985.03,-14658.94 3940.24,-14630.46 3050.44,-14598.16 2709.9,-14585.8 2623.76,-14596.46 2284.44,-14565.16 2251.33,-14562.11 2216.47,-14558.08 2182.29,-14553.65"/>
<polygon fill="black" stroke="black" points="2182.56,-14550.16 2172.19,-14552.33 2181.65,-14557.1 2182.56,-14550.16"/>
<text text-anchor="middle" x="3122.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l4_e3_gpu3 -->
<g id="node237" class="node">
<title>recv_l4_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2615.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2615.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E3</text>
<text text-anchor="middle" x="2615.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2615.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2615.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e3_gpu3 -->
<g id="edge308" class="edge">
<title>route_l4&#45;&gt;recv_l4_e3_gpu3</title>
<path fill="none" stroke="black" d="M5532.18,-14668.46C5088.4,-14651.95 4349.54,-14624.06 3713.44,-14598.16 3372.96,-14584.3 3286.76,-14596.46 2947.44,-14565.16 2914.33,-14562.11 2879.47,-14558.08 2845.29,-14553.65"/>
<polygon fill="black" stroke="black" points="2845.56,-14550.16 2835.19,-14552.33 2844.65,-14557.1 2845.56,-14550.16"/>
<text text-anchor="middle" x="3785.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l4_e4_gpu4 -->
<g id="node240" class="node">
<title>recv_l4_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3278.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3278.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E4</text>
<text text-anchor="middle" x="3278.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3278.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3278.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e4_gpu4 -->
<g id="edge312" class="edge">
<title>route_l4&#45;&gt;recv_l4_e4_gpu4</title>
<path fill="none" stroke="black" d="M5540.2,-14674.04C5078.53,-14660.76 4287.13,-14630.22 3610.44,-14565.16 3577.61,-14562.01 3543.05,-14557.94 3509.13,-14553.52"/>
<polygon fill="black" stroke="black" points="3509.48,-14550.04 3499.11,-14552.21 3508.57,-14556.98 3509.48,-14550.04"/>
<text text-anchor="middle" x="4061.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l4_e5_gpu5 -->
<g id="node243" class="node">
<title>recv_l4_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3941.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3941.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E5</text>
<text text-anchor="middle" x="3941.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3941.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3941.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e5_gpu5 -->
<g id="edge316" class="edge">
<title>route_l4&#45;&gt;recv_l4_e5_gpu5</title>
<path fill="none" stroke="black" d="M5522.86,-14662.09C5187.03,-14642.81 4698.6,-14610.39 4273.44,-14565.16 4241.44,-14561.76 4207.78,-14557.63 4174.66,-14553.25"/>
<polygon fill="black" stroke="black" points="4174.78,-14549.73 4164.41,-14551.88 4173.86,-14556.67 4174.78,-14549.73"/>
<text text-anchor="middle" x="4662.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l4_e6_gpu6 -->
<g id="node246" class="node">
<title>recv_l4_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4604.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4604.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E6</text>
<text text-anchor="middle" x="4604.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4604.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4604.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e6_gpu6 -->
<g id="edge320" class="edge">
<title>route_l4&#45;&gt;recv_l4_e6_gpu6</title>
<path fill="none" stroke="black" d="M5480.2,-14631.91C5309.75,-14611.93 5114.04,-14588.3 4936.44,-14565.16 4906.1,-14561.21 4874.22,-14556.9 4842.71,-14552.54"/>
<polygon fill="black" stroke="black" points="4842.89,-14549.03 4832.5,-14551.12 4841.93,-14555.96 4842.89,-14549.03"/>
<text text-anchor="middle" x="5254.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l4_e7_gpu7 -->
<g id="node249" class="node">
<title>recv_l4_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5267.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5267.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E7</text>
<text text-anchor="middle" x="5267.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5267.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5267.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e7_gpu7 -->
<g id="edge324" class="edge">
<title>route_l4&#45;&gt;recv_l4_e7_gpu7</title>
<path fill="none" stroke="black" d="M5661.25,-14616.14C5586.71,-14597.58 5507.82,-14577.93 5440.37,-14561.14"/>
<polygon fill="black" stroke="black" points="5441.06,-14557.7 5430.51,-14558.68 5439.37,-14564.5 5441.06,-14557.7"/>
<text text-anchor="middle" x="5651.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l4_e8_gpu8 -->
<g id="node252" class="node">
<title>recv_l4_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5930.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5930.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E8</text>
<text text-anchor="middle" x="5930.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e8_gpu8 -->
<g id="edge328" class="edge">
<title>route_l4&#45;&gt;recv_l4_e8_gpu8</title>
<path fill="none" stroke="black" d="M5930.44,-14616.02C5930.44,-14602.63 5930.44,-14588.69 5930.44,-14575.66"/>
<polygon fill="black" stroke="black" points="5933.94,-14575.44 5930.44,-14565.44 5926.94,-14575.44 5933.94,-14575.44"/>
<text text-anchor="middle" x="6002.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l4_e9_gpu9 -->
<g id="node255" class="node">
<title>recv_l4_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6593.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6593.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E9</text>
<text text-anchor="middle" x="6593.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6593.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6593.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e9_gpu9 -->
<g id="edge332" class="edge">
<title>route_l4&#45;&gt;recv_l4_e9_gpu9</title>
<path fill="none" stroke="black" d="M6199.63,-14616.14C6274.17,-14597.58 6353.06,-14577.93 6420.51,-14561.14"/>
<polygon fill="black" stroke="black" points="6421.51,-14564.5 6430.37,-14558.68 6419.82,-14557.7 6421.51,-14564.5"/>
<text text-anchor="middle" x="6393.44" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l4_e10_gpu10 -->
<g id="node258" class="node">
<title>recv_l4_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7256.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7256.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E10</text>
<text text-anchor="middle" x="7256.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7256.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7256.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e10_gpu10 -->
<g id="edge336" class="edge">
<title>route_l4&#45;&gt;recv_l4_e10_gpu10</title>
<path fill="none" stroke="black" d="M6253.27,-14646.72C6447.83,-14624.29 6700.53,-14594.33 6924.44,-14565.16 6954.78,-14561.21 6986.66,-14556.9 7018.17,-14552.54"/>
<polygon fill="black" stroke="black" points="7018.96,-14555.96 7028.38,-14551.12 7017.99,-14549.03 7018.96,-14555.96"/>
<text text-anchor="middle" x="6838.94" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l4_e11_gpu11 -->
<g id="node261" class="node">
<title>recv_l4_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7919.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7919.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E11</text>
<text text-anchor="middle" x="7919.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7919.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7919.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e11_gpu11 -->
<g id="edge340" class="edge">
<title>route_l4&#45;&gt;recv_l4_e11_gpu11</title>
<path fill="none" stroke="black" d="M6279.79,-14665.38C6615.56,-14646.62 7137.01,-14613.08 7587.44,-14565.16 7619.44,-14561.76 7653.1,-14557.63 7686.22,-14553.25"/>
<polygon fill="black" stroke="black" points="7687.02,-14556.67 7696.47,-14551.88 7686.1,-14549.73 7687.02,-14556.67"/>
<text text-anchor="middle" x="7484.94" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l4_e12_gpu12 -->
<g id="node264" class="node">
<title>recv_l4_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8582.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8582.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E12</text>
<text text-anchor="middle" x="8582.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8582.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8582.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e12_gpu12 -->
<g id="edge344" class="edge">
<title>route_l4&#45;&gt;recv_l4_e12_gpu12</title>
<path fill="none" stroke="black" d="M6293.35,-14674.82C6750.61,-14661.97 7560.2,-14631.52 8250.44,-14565.16 8283.27,-14562.01 8317.83,-14557.94 8351.75,-14553.52"/>
<polygon fill="black" stroke="black" points="8352.32,-14556.98 8361.77,-14552.21 8351.4,-14550.04 8352.32,-14556.98"/>
<text text-anchor="middle" x="8076.94" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l4_e13_gpu13 -->
<g id="node267" class="node">
<title>recv_l4_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9245.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9245.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E13</text>
<text text-anchor="middle" x="9245.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9245.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9245.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e13_gpu13 -->
<g id="edge348" class="edge">
<title>route_l4&#45;&gt;recv_l4_e13_gpu13</title>
<path fill="none" stroke="black" d="M6286.76,-14670.16C6726.49,-14653.98 7497.1,-14625.18 8157.44,-14598.16 8493.48,-14584.42 8578.55,-14596.14 8913.44,-14565.16 8946.55,-14562.1 8981.41,-14558.06 9015.59,-14553.63"/>
<polygon fill="black" stroke="black" points="9016.23,-14557.08 9025.69,-14552.31 9015.32,-14550.14 9016.23,-14557.08"/>
<text text-anchor="middle" x="8742.94" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l4_e14_gpu14 -->
<g id="node270" class="node">
<title>recv_l4_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9908.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9908.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E14</text>
<text text-anchor="middle" x="9908.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9908.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9908.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e14_gpu14 -->
<g id="edge352" class="edge">
<title>route_l4&#45;&gt;recv_l4_e14_gpu14</title>
<path fill="none" stroke="black" d="M6292.16,-14674.21C6839.91,-14660.27 7912.53,-14631.5 8823.44,-14598.16 9158.2,-14585.91 9242.88,-14596.05 9576.44,-14565.16 9609.55,-14562.1 9644.41,-14558.06 9678.59,-14553.63"/>
<polygon fill="black" stroke="black" points="9679.23,-14557.07 9688.69,-14552.3 9678.32,-14550.13 9679.23,-14557.07"/>
<text text-anchor="middle" x="9406.94" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l4_e15_gpu15 -->
<g id="node273" class="node">
<title>recv_l4_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10571.44" cy="-14517.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10571.44" y="-14535.88" font-family="Times,serif" font-size="14.00">Token Receive L4E15</text>
<text text-anchor="middle" x="10571.44" y="-14520.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10571.44" y="-14505.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10571.44" y="-14490.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l4&#45;&gt;recv_l4_e15_gpu15 -->
<g id="edge356" class="edge">
<title>route_l4&#45;&gt;recv_l4_e15_gpu15</title>
<path fill="none" stroke="black" d="M6295.99,-14676.83C6940.66,-14665.13 8321.79,-14637.66 9487.44,-14598.16 9821.79,-14586.83 9906.32,-14596.02 10239.44,-14565.16 10272.55,-14562.1 10307.41,-14558.05 10341.59,-14553.63"/>
<polygon fill="black" stroke="black" points="10342.23,-14557.07 10351.69,-14552.3 10341.32,-14550.13 10342.23,-14557.07"/>
<text text-anchor="middle" x="10069.94" y="-14586.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l4_e0_gpu0 -->
<g id="node229" class="node">
<title>expert_l4_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="854.44,-14432 398.44,-14432 398.44,-14364 854.44,-14364 854.44,-14432"/>
<text text-anchor="middle" x="626.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E0</text>
<text text-anchor="middle" x="626.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l4_e0_gpu0&#45;&gt;expert_l4_e0_gpu0 -->
<g id="edge297" class="edge">
<title>recv_l4_e0_gpu0&#45;&gt;expert_l4_e0_gpu0</title>
<path fill="none" stroke="black" d="M626.44,-14468.8C626.44,-14460.04 626.44,-14450.94 626.44,-14442.31"/>
<polygon fill="black" stroke="black" points="629.94,-14442.08 626.44,-14432.08 622.94,-14442.08 629.94,-14442.08"/>
</g>
<!-- send_l4_e0_gpu0 -->
<g id="node230" class="node">
<title>send_l4_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="626.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="626.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E0</text>
<text text-anchor="middle" x="626.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="626.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l4_e0_gpu0&#45;&gt;send_l4_e0_gpu0 -->
<g id="edge298" class="edge">
<title>expert_l4_e0_gpu0&#45;&gt;send_l4_e0_gpu0</title>
<path fill="none" stroke="black" d="M626.44,-14363.76C626.44,-14355.51 626.44,-14346.42 626.44,-14337.37"/>
<polygon fill="black" stroke="black" points="629.94,-14337.22 626.44,-14327.22 622.94,-14337.22 629.94,-14337.22"/>
</g>
<!-- agg_l4 -->
<g id="node276" class="node">
<title>agg_l4</title>
<polygon fill="lightgray" stroke="black" points="6408.33,-14193.83 5648.12,-14193.83 5452.55,-14057.83 6212.76,-14057.83 6408.33,-14193.83"/>
<text text-anchor="middle" x="5930.44" y="-14144.63" font-family="Times,serif" font-size="14.00">Expert Aggregation L4</text>
<text text-anchor="middle" x="5930.44" y="-14129.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14114.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14099.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l4_e0_gpu0&#45;&gt;agg_l4 -->
<g id="edge299" class="edge">
<title>send_l4_e0_gpu0&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M843.45,-14243.33C881.68,-14238.32 921.16,-14233.85 958.44,-14230.83 1846.88,-14158.8 4536.64,-14135.31 5544.01,-14128.91"/>
<polygon fill="black" stroke="black" points="5544.34,-14132.41 5554.32,-14128.85 5544.29,-14125.41 5544.34,-14132.41"/>
</g>
<!-- expert_l4_e1_gpu1 -->
<g id="node232" class="node">
<title>expert_l4_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1517.44,-14432 1061.44,-14432 1061.44,-14364 1517.44,-14364 1517.44,-14432"/>
<text text-anchor="middle" x="1289.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E1</text>
<text text-anchor="middle" x="1289.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1289.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1289.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l4_e1_gpu1&#45;&gt;expert_l4_e1_gpu1 -->
<g id="edge301" class="edge">
<title>recv_l4_e1_gpu1&#45;&gt;expert_l4_e1_gpu1</title>
<path fill="none" stroke="black" d="M1289.44,-14468.8C1289.44,-14460.04 1289.44,-14450.94 1289.44,-14442.31"/>
<polygon fill="black" stroke="black" points="1292.94,-14442.08 1289.44,-14432.08 1285.94,-14442.08 1292.94,-14442.08"/>
</g>
<!-- send_l4_e1_gpu1 -->
<g id="node233" class="node">
<title>send_l4_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1289.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1289.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E1</text>
<text text-anchor="middle" x="1289.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1289.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1289.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l4_e1_gpu1&#45;&gt;send_l4_e1_gpu1 -->
<g id="edge302" class="edge">
<title>expert_l4_e1_gpu1&#45;&gt;send_l4_e1_gpu1</title>
<path fill="none" stroke="black" d="M1289.44,-14363.76C1289.44,-14355.51 1289.44,-14346.42 1289.44,-14337.37"/>
<polygon fill="black" stroke="black" points="1292.94,-14337.22 1289.44,-14327.22 1285.94,-14337.22 1292.94,-14337.22"/>
</g>
<!-- send_l4_e1_gpu1&#45;&gt;agg_l4 -->
<g id="edge303" class="edge">
<title>send_l4_e1_gpu1&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M1506.91,-14243.37C1544.99,-14238.38 1584.31,-14233.9 1621.44,-14230.83 2377.27,-14168.33 4637.64,-14139.6 5546.13,-14130.35"/>
<polygon fill="black" stroke="black" points="5546.46,-14133.85 5556.42,-14130.25 5546.39,-14126.85 5546.46,-14133.85"/>
</g>
<!-- expert_l4_e2_gpu2 -->
<g id="node235" class="node">
<title>expert_l4_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2180.44,-14432 1724.44,-14432 1724.44,-14364 2180.44,-14364 2180.44,-14432"/>
<text text-anchor="middle" x="1952.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E2</text>
<text text-anchor="middle" x="1952.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1952.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1952.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l4_e2_gpu2&#45;&gt;expert_l4_e2_gpu2 -->
<g id="edge305" class="edge">
<title>recv_l4_e2_gpu2&#45;&gt;expert_l4_e2_gpu2</title>
<path fill="none" stroke="black" d="M1952.44,-14468.8C1952.44,-14460.04 1952.44,-14450.94 1952.44,-14442.31"/>
<polygon fill="black" stroke="black" points="1955.94,-14442.08 1952.44,-14432.08 1948.94,-14442.08 1955.94,-14442.08"/>
</g>
<!-- send_l4_e2_gpu2 -->
<g id="node236" class="node">
<title>send_l4_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="1952.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1952.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E2</text>
<text text-anchor="middle" x="1952.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1952.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1952.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l4_e2_gpu2&#45;&gt;send_l4_e2_gpu2 -->
<g id="edge306" class="edge">
<title>expert_l4_e2_gpu2&#45;&gt;send_l4_e2_gpu2</title>
<path fill="none" stroke="black" d="M1952.44,-14363.76C1952.44,-14355.51 1952.44,-14346.42 1952.44,-14337.37"/>
<polygon fill="black" stroke="black" points="1955.94,-14337.22 1952.44,-14327.22 1948.94,-14337.22 1955.94,-14337.22"/>
</g>
<!-- send_l4_e2_gpu2&#45;&gt;agg_l4 -->
<g id="edge307" class="edge">
<title>send_l4_e2_gpu2&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M2170.36,-14243.45C2208.31,-14238.47 2247.46,-14233.97 2284.44,-14230.83 2908.79,-14177.82 4746.71,-14144.62 5548.78,-14132.28"/>
<polygon fill="black" stroke="black" points="5549.1,-14135.77 5559.05,-14132.12 5548.99,-14128.77 5549.1,-14135.77"/>
</g>
<!-- expert_l4_e3_gpu3 -->
<g id="node238" class="node">
<title>expert_l4_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2843.44,-14432 2387.44,-14432 2387.44,-14364 2843.44,-14364 2843.44,-14432"/>
<text text-anchor="middle" x="2615.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E3</text>
<text text-anchor="middle" x="2615.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2615.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2615.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l4_e3_gpu3&#45;&gt;expert_l4_e3_gpu3 -->
<g id="edge309" class="edge">
<title>recv_l4_e3_gpu3&#45;&gt;expert_l4_e3_gpu3</title>
<path fill="none" stroke="black" d="M2615.44,-14468.8C2615.44,-14460.04 2615.44,-14450.94 2615.44,-14442.31"/>
<polygon fill="black" stroke="black" points="2618.94,-14442.08 2615.44,-14432.08 2611.94,-14442.08 2618.94,-14442.08"/>
</g>
<!-- send_l4_e3_gpu3 -->
<g id="node239" class="node">
<title>send_l4_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2615.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2615.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E3</text>
<text text-anchor="middle" x="2615.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2615.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2615.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l4_e3_gpu3&#45;&gt;send_l4_e3_gpu3 -->
<g id="edge310" class="edge">
<title>expert_l4_e3_gpu3&#45;&gt;send_l4_e3_gpu3</title>
<path fill="none" stroke="black" d="M2615.44,-14363.76C2615.44,-14355.51 2615.44,-14346.42 2615.44,-14337.37"/>
<polygon fill="black" stroke="black" points="2618.94,-14337.22 2615.44,-14327.22 2611.94,-14337.22 2618.94,-14337.22"/>
</g>
<!-- send_l4_e3_gpu3&#45;&gt;agg_l4 -->
<g id="edge311" class="edge">
<title>send_l4_e3_gpu3&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M2834.27,-14243.53C2871.94,-14238.57 2910.76,-14234.06 2947.44,-14230.83 3875.8,-14149.05 4972,-14130.85 5542.04,-14127.25"/>
<polygon fill="black" stroke="black" points="5542.08,-14130.75 5552.06,-14127.19 5542.04,-14123.75 5542.08,-14130.75"/>
</g>
<!-- expert_l4_e4_gpu4 -->
<g id="node241" class="node">
<title>expert_l4_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3506.44,-14432 3050.44,-14432 3050.44,-14364 3506.44,-14364 3506.44,-14432"/>
<text text-anchor="middle" x="3278.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E4</text>
<text text-anchor="middle" x="3278.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3278.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3278.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l4_e4_gpu4&#45;&gt;expert_l4_e4_gpu4 -->
<g id="edge313" class="edge">
<title>recv_l4_e4_gpu4&#45;&gt;expert_l4_e4_gpu4</title>
<path fill="none" stroke="black" d="M3278.44,-14468.8C3278.44,-14460.04 3278.44,-14450.94 3278.44,-14442.31"/>
<polygon fill="black" stroke="black" points="3281.94,-14442.08 3278.44,-14432.08 3274.94,-14442.08 3281.94,-14442.08"/>
</g>
<!-- send_l4_e4_gpu4 -->
<g id="node242" class="node">
<title>send_l4_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3278.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3278.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E4</text>
<text text-anchor="middle" x="3278.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3278.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3278.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l4_e4_gpu4&#45;&gt;send_l4_e4_gpu4 -->
<g id="edge314" class="edge">
<title>expert_l4_e4_gpu4&#45;&gt;send_l4_e4_gpu4</title>
<path fill="none" stroke="black" d="M3278.44,-14363.76C3278.44,-14355.51 3278.44,-14346.42 3278.44,-14337.37"/>
<polygon fill="black" stroke="black" points="3281.94,-14337.22 3278.44,-14327.22 3274.94,-14337.22 3281.94,-14337.22"/>
</g>
<!-- send_l4_e4_gpu4&#45;&gt;agg_l4 -->
<g id="edge315" class="edge">
<title>send_l4_e4_gpu4&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M3498.2,-14243.72C3535.58,-14238.77 3574.07,-14234.22 3610.44,-14230.83 3658.28,-14226.38 4921.68,-14170.87 5563.51,-14142.83"/>
<polygon fill="black" stroke="black" points="5564.02,-14146.31 5573.86,-14142.38 5563.71,-14139.32 5564.02,-14146.31"/>
</g>
<!-- expert_l4_e5_gpu5 -->
<g id="node244" class="node">
<title>expert_l4_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4169.44,-14432 3713.44,-14432 3713.44,-14364 4169.44,-14364 4169.44,-14432"/>
<text text-anchor="middle" x="3941.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E5</text>
<text text-anchor="middle" x="3941.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3941.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3941.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l4_e5_gpu5&#45;&gt;expert_l4_e5_gpu5 -->
<g id="edge317" class="edge">
<title>recv_l4_e5_gpu5&#45;&gt;expert_l4_e5_gpu5</title>
<path fill="none" stroke="black" d="M3941.44,-14468.8C3941.44,-14460.04 3941.44,-14450.94 3941.44,-14442.31"/>
<polygon fill="black" stroke="black" points="3944.94,-14442.08 3941.44,-14432.08 3937.94,-14442.08 3944.94,-14442.08"/>
</g>
<!-- send_l4_e5_gpu5 -->
<g id="node245" class="node">
<title>send_l4_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="3941.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3941.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E5</text>
<text text-anchor="middle" x="3941.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3941.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3941.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l4_e5_gpu5&#45;&gt;send_l4_e5_gpu5 -->
<g id="edge318" class="edge">
<title>expert_l4_e5_gpu5&#45;&gt;send_l4_e5_gpu5</title>
<path fill="none" stroke="black" d="M3941.44,-14363.76C3941.44,-14355.51 3941.44,-14346.42 3941.44,-14337.37"/>
<polygon fill="black" stroke="black" points="3944.94,-14337.22 3941.44,-14327.22 3937.94,-14337.22 3944.94,-14337.22"/>
</g>
<!-- send_l4_e5_gpu5&#45;&gt;agg_l4 -->
<g id="edge319" class="edge">
<title>send_l4_e5_gpu5&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M4159.36,-14243.39C4197.31,-14238.41 4236.46,-14233.94 4273.44,-14230.83 4572.05,-14205.75 4648.26,-14229.9 4947.44,-14212.83 5161.47,-14200.62 5401.13,-14179.8 5590.23,-14161.7"/>
<polygon fill="black" stroke="black" points="5590.71,-14165.17 5600.33,-14160.73 5590.04,-14158.2 5590.71,-14165.17"/>
</g>
<!-- expert_l4_e6_gpu6 -->
<g id="node247" class="node">
<title>expert_l4_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4832.44,-14432 4376.44,-14432 4376.44,-14364 4832.44,-14364 4832.44,-14432"/>
<text text-anchor="middle" x="4604.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E6</text>
<text text-anchor="middle" x="4604.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4604.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4604.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l4_e6_gpu6&#45;&gt;expert_l4_e6_gpu6 -->
<g id="edge321" class="edge">
<title>recv_l4_e6_gpu6&#45;&gt;expert_l4_e6_gpu6</title>
<path fill="none" stroke="black" d="M4604.44,-14468.8C4604.44,-14460.04 4604.44,-14450.94 4604.44,-14442.31"/>
<polygon fill="black" stroke="black" points="4607.94,-14442.08 4604.44,-14432.08 4600.94,-14442.08 4607.94,-14442.08"/>
</g>
<!-- send_l4_e6_gpu6 -->
<g id="node248" class="node">
<title>send_l4_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4604.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4604.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E6</text>
<text text-anchor="middle" x="4604.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4604.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4604.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l4_e6_gpu6&#45;&gt;send_l4_e6_gpu6 -->
<g id="edge322" class="edge">
<title>expert_l4_e6_gpu6&#45;&gt;send_l4_e6_gpu6</title>
<path fill="none" stroke="black" d="M4604.44,-14363.76C4604.44,-14355.51 4604.44,-14346.42 4604.44,-14337.37"/>
<polygon fill="black" stroke="black" points="4607.94,-14337.22 4604.44,-14327.22 4600.94,-14337.22 4607.94,-14337.22"/>
</g>
<!-- send_l4_e6_gpu6&#45;&gt;agg_l4 -->
<g id="edge323" class="edge">
<title>send_l4_e6_gpu6&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M4823.28,-14243.53C4860.94,-14238.57 4899.76,-14234.06 4936.44,-14230.83 5164.14,-14210.75 5223.14,-14237.05 5450.44,-14212.83 5507.74,-14206.73 5568.5,-14197.79 5626.83,-14187.95"/>
<polygon fill="black" stroke="black" points="5627.65,-14191.36 5636.93,-14186.24 5626.48,-14184.46 5627.65,-14191.36"/>
</g>
<!-- expert_l4_e7_gpu7 -->
<g id="node250" class="node">
<title>expert_l4_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5495.44,-14432 5039.44,-14432 5039.44,-14364 5495.44,-14364 5495.44,-14432"/>
<text text-anchor="middle" x="5267.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E7</text>
<text text-anchor="middle" x="5267.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5267.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5267.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l4_e7_gpu7&#45;&gt;expert_l4_e7_gpu7 -->
<g id="edge325" class="edge">
<title>recv_l4_e7_gpu7&#45;&gt;expert_l4_e7_gpu7</title>
<path fill="none" stroke="black" d="M5267.44,-14468.8C5267.44,-14460.04 5267.44,-14450.94 5267.44,-14442.31"/>
<polygon fill="black" stroke="black" points="5270.94,-14442.08 5267.44,-14432.08 5263.94,-14442.08 5270.94,-14442.08"/>
</g>
<!-- send_l4_e7_gpu7 -->
<g id="node251" class="node">
<title>send_l4_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5267.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5267.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E7</text>
<text text-anchor="middle" x="5267.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5267.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5267.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l4_e7_gpu7&#45;&gt;send_l4_e7_gpu7 -->
<g id="edge326" class="edge">
<title>expert_l4_e7_gpu7&#45;&gt;send_l4_e7_gpu7</title>
<path fill="none" stroke="black" d="M5267.44,-14363.76C5267.44,-14355.51 5267.44,-14346.42 5267.44,-14337.37"/>
<polygon fill="black" stroke="black" points="5270.94,-14337.22 5267.44,-14327.22 5263.94,-14337.22 5270.94,-14337.22"/>
</g>
<!-- send_l4_e7_gpu7&#45;&gt;agg_l4 -->
<g id="edge327" class="edge">
<title>send_l4_e7_gpu7&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M5496.73,-14245.1C5603.51,-14229.72 5708.57,-14214.4 5714.44,-14212.83 5730.9,-14208.42 5747.8,-14203.13 5764.56,-14197.36"/>
<polygon fill="black" stroke="black" points="5766.12,-14200.52 5774.4,-14193.91 5763.81,-14193.92 5766.12,-14200.52"/>
</g>
<!-- expert_l4_e8_gpu8 -->
<g id="node253" class="node">
<title>expert_l4_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6158.44,-14432 5702.44,-14432 5702.44,-14364 6158.44,-14364 6158.44,-14432"/>
<text text-anchor="middle" x="5930.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E8</text>
<text text-anchor="middle" x="5930.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l4_e8_gpu8&#45;&gt;expert_l4_e8_gpu8 -->
<g id="edge329" class="edge">
<title>recv_l4_e8_gpu8&#45;&gt;expert_l4_e8_gpu8</title>
<path fill="none" stroke="black" d="M5930.44,-14468.8C5930.44,-14460.04 5930.44,-14450.94 5930.44,-14442.31"/>
<polygon fill="black" stroke="black" points="5933.94,-14442.08 5930.44,-14432.08 5926.94,-14442.08 5933.94,-14442.08"/>
</g>
<!-- send_l4_e8_gpu8 -->
<g id="node254" class="node">
<title>send_l4_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="5930.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5930.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E8</text>
<text text-anchor="middle" x="5930.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5930.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l4_e8_gpu8&#45;&gt;send_l4_e8_gpu8 -->
<g id="edge330" class="edge">
<title>expert_l4_e8_gpu8&#45;&gt;send_l4_e8_gpu8</title>
<path fill="none" stroke="black" d="M5930.44,-14363.76C5930.44,-14355.51 5930.44,-14346.42 5930.44,-14337.37"/>
<polygon fill="black" stroke="black" points="5933.94,-14337.22 5930.44,-14327.22 5926.94,-14337.22 5933.94,-14337.22"/>
</g>
<!-- send_l4_e8_gpu8&#45;&gt;agg_l4 -->
<g id="edge331" class="edge">
<title>send_l4_e8_gpu8&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M5930.44,-14230.52C5930.44,-14222.1 5930.44,-14213.13 5930.44,-14204.12"/>
<polygon fill="black" stroke="black" points="5933.94,-14203.97 5930.44,-14193.97 5926.94,-14203.97 5933.94,-14203.97"/>
</g>
<!-- expert_l4_e9_gpu9 -->
<g id="node256" class="node">
<title>expert_l4_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6821.44,-14432 6365.44,-14432 6365.44,-14364 6821.44,-14364 6821.44,-14432"/>
<text text-anchor="middle" x="6593.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E9</text>
<text text-anchor="middle" x="6593.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6593.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6593.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l4_e9_gpu9&#45;&gt;expert_l4_e9_gpu9 -->
<g id="edge333" class="edge">
<title>recv_l4_e9_gpu9&#45;&gt;expert_l4_e9_gpu9</title>
<path fill="none" stroke="black" d="M6593.44,-14468.8C6593.44,-14460.04 6593.44,-14450.94 6593.44,-14442.31"/>
<polygon fill="black" stroke="black" points="6596.94,-14442.08 6593.44,-14432.08 6589.94,-14442.08 6596.94,-14442.08"/>
</g>
<!-- send_l4_e9_gpu9 -->
<g id="node257" class="node">
<title>send_l4_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6593.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6593.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E9</text>
<text text-anchor="middle" x="6593.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6593.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6593.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l4_e9_gpu9&#45;&gt;send_l4_e9_gpu9 -->
<g id="edge334" class="edge">
<title>expert_l4_e9_gpu9&#45;&gt;send_l4_e9_gpu9</title>
<path fill="none" stroke="black" d="M6593.44,-14363.76C6593.44,-14355.51 6593.44,-14346.42 6593.44,-14337.37"/>
<polygon fill="black" stroke="black" points="6596.94,-14337.22 6593.44,-14327.22 6589.94,-14337.22 6596.94,-14337.22"/>
</g>
<!-- send_l4_e9_gpu9&#45;&gt;agg_l4 -->
<g id="edge335" class="edge">
<title>send_l4_e9_gpu9&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M6419.68,-14238.32C6362.84,-14225.36 6297.93,-14210.57 6234.39,-14196.09"/>
<polygon fill="black" stroke="black" points="6235.14,-14192.67 6224.61,-14193.87 6233.59,-14199.5 6235.14,-14192.67"/>
</g>
<!-- expert_l4_e10_gpu10 -->
<g id="node259" class="node">
<title>expert_l4_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7484.44,-14432 7028.44,-14432 7028.44,-14364 7484.44,-14364 7484.44,-14432"/>
<text text-anchor="middle" x="7256.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E10</text>
<text text-anchor="middle" x="7256.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7256.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7256.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l4_e10_gpu10&#45;&gt;expert_l4_e10_gpu10 -->
<g id="edge337" class="edge">
<title>recv_l4_e10_gpu10&#45;&gt;expert_l4_e10_gpu10</title>
<path fill="none" stroke="black" d="M7256.44,-14468.8C7256.44,-14460.04 7256.44,-14450.94 7256.44,-14442.31"/>
<polygon fill="black" stroke="black" points="7259.94,-14442.08 7256.44,-14432.08 7252.94,-14442.08 7259.94,-14442.08"/>
</g>
<!-- send_l4_e10_gpu10 -->
<g id="node260" class="node">
<title>send_l4_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7256.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7256.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E10</text>
<text text-anchor="middle" x="7256.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7256.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7256.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l4_e10_gpu10&#45;&gt;send_l4_e10_gpu10 -->
<g id="edge338" class="edge">
<title>expert_l4_e10_gpu10&#45;&gt;send_l4_e10_gpu10</title>
<path fill="none" stroke="black" d="M7256.44,-14363.76C7256.44,-14355.51 7256.44,-14346.42 7256.44,-14337.37"/>
<polygon fill="black" stroke="black" points="7259.94,-14337.22 7256.44,-14327.22 7252.94,-14337.22 7259.94,-14337.22"/>
</g>
<!-- send_l4_e10_gpu10&#45;&gt;agg_l4 -->
<g id="edge339" class="edge">
<title>send_l4_e10_gpu10&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M7029.78,-14244.64C6994.54,-14239.79 6958.53,-14235.03 6924.44,-14230.83 6748,-14209.1 6553.57,-14188.1 6383.81,-14170.73"/>
<polygon fill="black" stroke="black" points="6384,-14167.23 6373.69,-14169.7 6383.29,-14174.2 6384,-14167.23"/>
</g>
<!-- expert_l4_e11_gpu11 -->
<g id="node262" class="node">
<title>expert_l4_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8147.44,-14432 7691.44,-14432 7691.44,-14364 8147.44,-14364 8147.44,-14432"/>
<text text-anchor="middle" x="7919.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E11</text>
<text text-anchor="middle" x="7919.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7919.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7919.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l4_e11_gpu11&#45;&gt;expert_l4_e11_gpu11 -->
<g id="edge341" class="edge">
<title>recv_l4_e11_gpu11&#45;&gt;expert_l4_e11_gpu11</title>
<path fill="none" stroke="black" d="M7919.44,-14468.8C7919.44,-14460.04 7919.44,-14450.94 7919.44,-14442.31"/>
<polygon fill="black" stroke="black" points="7922.94,-14442.08 7919.44,-14432.08 7915.94,-14442.08 7922.94,-14442.08"/>
</g>
<!-- send_l4_e11_gpu11 -->
<g id="node263" class="node">
<title>send_l4_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7919.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7919.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E11</text>
<text text-anchor="middle" x="7919.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7919.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7919.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l4_e11_gpu11&#45;&gt;send_l4_e11_gpu11 -->
<g id="edge342" class="edge">
<title>expert_l4_e11_gpu11&#45;&gt;send_l4_e11_gpu11</title>
<path fill="none" stroke="black" d="M7919.44,-14363.76C7919.44,-14355.51 7919.44,-14346.42 7919.44,-14337.37"/>
<polygon fill="black" stroke="black" points="7922.94,-14337.22 7919.44,-14327.22 7915.94,-14337.22 7922.94,-14337.22"/>
</g>
<!-- send_l4_e11_gpu11&#45;&gt;agg_l4 -->
<g id="edge343" class="edge">
<title>send_l4_e11_gpu11&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M7697.4,-14243.98C7660.72,-14239.07 7623.06,-14234.47 7587.44,-14230.83 7165.81,-14187.77 6681.87,-14159.86 6346.31,-14143.91"/>
<polygon fill="black" stroke="black" points="6346.08,-14140.4 6335.92,-14143.42 6345.75,-14147.39 6346.08,-14140.4"/>
</g>
<!-- expert_l4_e12_gpu12 -->
<g id="node265" class="node">
<title>expert_l4_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8810.44,-14432 8354.44,-14432 8354.44,-14364 8810.44,-14364 8810.44,-14432"/>
<text text-anchor="middle" x="8582.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E12</text>
<text text-anchor="middle" x="8582.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8582.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8582.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l4_e12_gpu12&#45;&gt;expert_l4_e12_gpu12 -->
<g id="edge345" class="edge">
<title>recv_l4_e12_gpu12&#45;&gt;expert_l4_e12_gpu12</title>
<path fill="none" stroke="black" d="M8582.44,-14468.8C8582.44,-14460.04 8582.44,-14450.94 8582.44,-14442.31"/>
<polygon fill="black" stroke="black" points="8585.94,-14442.08 8582.44,-14432.08 8578.94,-14442.08 8585.94,-14442.08"/>
</g>
<!-- send_l4_e12_gpu12 -->
<g id="node266" class="node">
<title>send_l4_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8582.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8582.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E12</text>
<text text-anchor="middle" x="8582.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8582.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8582.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l4_e12_gpu12&#45;&gt;send_l4_e12_gpu12 -->
<g id="edge346" class="edge">
<title>expert_l4_e12_gpu12&#45;&gt;send_l4_e12_gpu12</title>
<path fill="none" stroke="black" d="M8582.44,-14363.76C8582.44,-14355.51 8582.44,-14346.42 8582.44,-14337.37"/>
<polygon fill="black" stroke="black" points="8585.94,-14337.22 8582.44,-14327.22 8578.94,-14337.22 8585.94,-14337.22"/>
</g>
<!-- send_l4_e12_gpu12&#45;&gt;agg_l4 -->
<g id="edge347" class="edge">
<title>send_l4_e12_gpu12&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M8364.51,-14243.47C8326.57,-14238.49 8287.42,-14233.98 8250.44,-14230.83 7978.42,-14207.63 7909.23,-14223.7 7636.44,-14212.83 7199.97,-14195.43 6700.98,-14169.58 6355.91,-14150.77"/>
<polygon fill="black" stroke="black" points="6355.92,-14147.26 6345.75,-14150.21 6355.54,-14154.25 6355.92,-14147.26"/>
</g>
<!-- expert_l4_e13_gpu13 -->
<g id="node268" class="node">
<title>expert_l4_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9473.44,-14432 9017.44,-14432 9017.44,-14364 9473.44,-14364 9473.44,-14432"/>
<text text-anchor="middle" x="9245.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E13</text>
<text text-anchor="middle" x="9245.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9245.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9245.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l4_e13_gpu13&#45;&gt;expert_l4_e13_gpu13 -->
<g id="edge349" class="edge">
<title>recv_l4_e13_gpu13&#45;&gt;expert_l4_e13_gpu13</title>
<path fill="none" stroke="black" d="M9245.44,-14468.8C9245.44,-14460.04 9245.44,-14450.94 9245.44,-14442.31"/>
<polygon fill="black" stroke="black" points="9248.94,-14442.08 9245.44,-14432.08 9241.94,-14442.08 9248.94,-14442.08"/>
</g>
<!-- send_l4_e13_gpu13 -->
<g id="node269" class="node">
<title>send_l4_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9245.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9245.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E13</text>
<text text-anchor="middle" x="9245.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9245.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9245.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l4_e13_gpu13&#45;&gt;send_l4_e13_gpu13 -->
<g id="edge350" class="edge">
<title>expert_l4_e13_gpu13&#45;&gt;send_l4_e13_gpu13</title>
<path fill="none" stroke="black" d="M9245.44,-14363.76C9245.44,-14355.51 9245.44,-14346.42 9245.44,-14337.37"/>
<polygon fill="black" stroke="black" points="9248.94,-14337.22 9245.44,-14327.22 9241.94,-14337.22 9248.94,-14337.22"/>
</g>
<!-- send_l4_e13_gpu13&#45;&gt;agg_l4 -->
<g id="edge351" class="edge">
<title>send_l4_e13_gpu13&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M9026.61,-14243.53C8988.94,-14238.57 8950.12,-14234.06 8913.44,-14230.83 7987.16,-14149.23 6893.8,-14130.93 6322.69,-14127.28"/>
<polygon fill="black" stroke="black" points="6322.67,-14123.78 6312.65,-14127.21 6322.63,-14130.78 6322.67,-14123.78"/>
</g>
<!-- expert_l4_e14_gpu14 -->
<g id="node271" class="node">
<title>expert_l4_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10136.44,-14432 9680.44,-14432 9680.44,-14364 10136.44,-14364 10136.44,-14432"/>
<text text-anchor="middle" x="9908.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E14</text>
<text text-anchor="middle" x="9908.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9908.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9908.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l4_e14_gpu14&#45;&gt;expert_l4_e14_gpu14 -->
<g id="edge353" class="edge">
<title>recv_l4_e14_gpu14&#45;&gt;expert_l4_e14_gpu14</title>
<path fill="none" stroke="black" d="M9908.44,-14468.8C9908.44,-14460.04 9908.44,-14450.94 9908.44,-14442.31"/>
<polygon fill="black" stroke="black" points="9911.94,-14442.08 9908.44,-14432.08 9904.94,-14442.08 9911.94,-14442.08"/>
</g>
<!-- send_l4_e14_gpu14 -->
<g id="node272" class="node">
<title>send_l4_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9908.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9908.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E14</text>
<text text-anchor="middle" x="9908.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9908.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9908.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l4_e14_gpu14&#45;&gt;send_l4_e14_gpu14 -->
<g id="edge354" class="edge">
<title>expert_l4_e14_gpu14&#45;&gt;send_l4_e14_gpu14</title>
<path fill="none" stroke="black" d="M9908.44,-14363.76C9908.44,-14355.51 9908.44,-14346.42 9908.44,-14337.37"/>
<polygon fill="black" stroke="black" points="9911.94,-14337.22 9908.44,-14327.22 9904.94,-14337.22 9911.94,-14337.22"/>
</g>
<!-- send_l4_e14_gpu14&#45;&gt;agg_l4 -->
<g id="edge355" class="edge">
<title>send_l4_e14_gpu14&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M9690.52,-14243.45C9652.57,-14238.47 9613.42,-14233.97 9576.44,-14230.83 8956.73,-14178.22 7141.4,-14145.11 6330.14,-14132.56"/>
<polygon fill="black" stroke="black" points="6330.1,-14129.06 6320.05,-14132.4 6329.99,-14136.05 6330.1,-14129.06"/>
</g>
<!-- expert_l4_e15_gpu15 -->
<g id="node274" class="node">
<title>expert_l4_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10799.44,-14432 10343.44,-14432 10343.44,-14364 10799.44,-14364 10799.44,-14432"/>
<text text-anchor="middle" x="10571.44" y="-14416.8" font-family="Times,serif" font-size="14.00">Expert L4E15</text>
<text text-anchor="middle" x="10571.44" y="-14401.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10571.44" y="-14386.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10571.44" y="-14371.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l4_e15_gpu15&#45;&gt;expert_l4_e15_gpu15 -->
<g id="edge357" class="edge">
<title>recv_l4_e15_gpu15&#45;&gt;expert_l4_e15_gpu15</title>
<path fill="none" stroke="black" d="M10571.44,-14468.8C10571.44,-14460.04 10571.44,-14450.94 10571.44,-14442.31"/>
<polygon fill="black" stroke="black" points="10574.94,-14442.08 10571.44,-14432.08 10567.94,-14442.08 10574.94,-14442.08"/>
</g>
<!-- send_l4_e15_gpu15 -->
<g id="node275" class="node">
<title>send_l4_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10571.44" cy="-14278.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10571.44" y="-14297.71" font-family="Times,serif" font-size="14.00">Token Send L4E15</text>
<text text-anchor="middle" x="10571.44" y="-14282.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10571.44" y="-14267.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10571.44" y="-14252.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l4_e15_gpu15&#45;&gt;send_l4_e15_gpu15 -->
<g id="edge358" class="edge">
<title>expert_l4_e15_gpu15&#45;&gt;send_l4_e15_gpu15</title>
<path fill="none" stroke="black" d="M10571.44,-14363.76C10571.44,-14355.51 10571.44,-14346.42 10571.44,-14337.37"/>
<polygon fill="black" stroke="black" points="10574.94,-14337.22 10571.44,-14327.22 10567.94,-14337.22 10574.94,-14337.22"/>
</g>
<!-- send_l4_e15_gpu15&#45;&gt;agg_l4 -->
<g id="edge359" class="edge">
<title>send_l4_e15_gpu15&#45;&gt;agg_l4</title>
<path fill="none" stroke="black" d="M10353.97,-14243.37C10315.89,-14238.38 10276.57,-14233.9 10239.44,-14230.83 9487.12,-14168.62 7244.18,-14139.87 6327.48,-14130.48"/>
<polygon fill="black" stroke="black" points="6327.46,-14126.98 6317.43,-14130.38 6327.39,-14133.98 6327.46,-14126.98"/>
</g>
<!-- residual2_l4 -->
<g id="node277" class="node">
<title>residual2_l4</title>
<polygon fill="lightpink" stroke="black" points="6204.94,-14020.83 5769.94,-14020.83 5769.94,-13952.83 6204.94,-13952.83 6204.94,-14020.83"/>
<text text-anchor="middle" x="5987.44" y="-14005.63" font-family="Times,serif" font-size="14.00">ResidualAdd L4</text>
<text text-anchor="middle" x="5987.44" y="-13990.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5987.44" y="-13975.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="5987.44" y="-13960.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l4&#45;&gt;residual2_l4 -->
<g id="edge360" class="edge">
<title>agg_l4&#45;&gt;residual2_l4</title>
<path fill="none" stroke="black" d="M5958.44,-14057.53C5962.29,-14048.29 5966.14,-14039.02 5969.73,-14030.39"/>
<polygon fill="black" stroke="black" points="5973.05,-14031.54 5973.66,-14020.96 5966.58,-14028.85 5973.05,-14031.54"/>
</g>
<!-- residual2_l4&#45;&gt;ln1_l5 -->
<g id="edge361" class="edge">
<title>residual2_l4&#45;&gt;ln1_l5</title>
<path fill="none" stroke="black" d="M5993.56,-13952.67C5995.13,-13944.13 5996.85,-13934.81 5998.51,-13925.84"/>
<polygon fill="black" stroke="black" points="6001.96,-13926.39 6000.34,-13915.92 5995.08,-13925.12 6001.96,-13926.39"/>
</g>
<!-- attn_l5 -->
<g id="node279" class="node">
<title>attn_l5</title>
<polygon fill="lightcoral" stroke="black" points="6236.44,-13810.83 5776.44,-13810.83 5776.44,-13742.83 6236.44,-13742.83 6236.44,-13810.83"/>
<text text-anchor="middle" x="6006.44" y="-13795.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L5</text>
<text text-anchor="middle" x="6006.44" y="-13780.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6006.44" y="-13765.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13750.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l5&#45;&gt;attn_l5 -->
<g id="edge364" class="edge">
<title>ln1_l5&#45;&gt;attn_l5</title>
<path fill="none" stroke="black" d="M6006.44,-13847.67C6006.44,-13839.22 6006.44,-13830.01 6006.44,-13821.13"/>
<polygon fill="black" stroke="black" points="6009.94,-13820.92 6006.44,-13810.92 6002.94,-13820.92 6009.94,-13820.92"/>
</g>
<!-- residual1_l5 -->
<g id="node280" class="node">
<title>residual1_l5</title>
<polygon fill="lightpink" stroke="black" points="6223.94,-13705.83 5788.94,-13705.83 5788.94,-13637.83 6223.94,-13637.83 6223.94,-13705.83"/>
<text text-anchor="middle" x="6006.44" y="-13690.63" font-family="Times,serif" font-size="14.00">ResidualAdd L5</text>
<text text-anchor="middle" x="6006.44" y="-13675.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13660.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13645.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l5&#45;&gt;residual1_l5 -->
<g id="edge365" class="edge">
<title>attn_l5&#45;&gt;residual1_l5</title>
<path fill="none" stroke="black" d="M6006.44,-13742.67C6006.44,-13734.22 6006.44,-13725.01 6006.44,-13716.13"/>
<polygon fill="black" stroke="black" points="6009.94,-13715.92 6006.44,-13705.92 6002.94,-13715.92 6009.94,-13715.92"/>
</g>
<!-- ln2_l5 -->
<g id="node281" class="node">
<title>ln2_l5</title>
<polygon fill="lightyellow" stroke="black" points="6223.94,-13600.83 5788.94,-13600.83 5788.94,-13532.83 6223.94,-13532.83 6223.94,-13600.83"/>
<text text-anchor="middle" x="6006.44" y="-13585.63" font-family="Times,serif" font-size="14.00">LayerNorm L5</text>
<text text-anchor="middle" x="6006.44" y="-13570.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13555.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13540.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l5&#45;&gt;ln2_l5 -->
<g id="edge366" class="edge">
<title>residual1_l5&#45;&gt;ln2_l5</title>
<path fill="none" stroke="black" d="M6006.44,-13637.67C6006.44,-13629.22 6006.44,-13620.01 6006.44,-13611.13"/>
<polygon fill="black" stroke="black" points="6009.94,-13610.92 6006.44,-13600.92 6002.94,-13610.92 6009.94,-13610.92"/>
</g>
<!-- ln2_l5&#45;&gt;route_l5 -->
<g id="edge367" class="edge">
<title>ln2_l5&#45;&gt;route_l5</title>
<path fill="none" stroke="black" d="M6006.44,-13532.67C6006.44,-13524.52 6006.44,-13515.47 6006.44,-13506.19"/>
<polygon fill="black" stroke="black" points="6009.94,-13506.06 6006.44,-13496.06 6002.94,-13506.06 6009.94,-13506.06"/>
</g>
<!-- recv_l5_e0_gpu0 -->
<g id="node283" class="node">
<title>recv_l5_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="702.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="702.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E0</text>
<text text-anchor="middle" x="702.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="702.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="702.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e0_gpu0 -->
<g id="edge368" class="edge">
<title>route_l5&#45;&gt;recv_l5_e0_gpu0</title>
<path fill="none" stroke="black" d="M5622.34,-13422.14C4880.72,-13412.41 3200,-13387.08 1786.44,-13341.83 1452.07,-13331.13 1367.56,-13339.69 1034.44,-13308.83 1001.33,-13305.76 966.48,-13301.72 932.29,-13297.29"/>
<polygon fill="black" stroke="black" points="932.56,-13293.8 922.19,-13295.97 931.65,-13300.74 932.56,-13293.8"/>
<text text-anchor="middle" x="1858.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l5_e1_gpu1 -->
<g id="node286" class="node">
<title>recv_l5_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1365.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1365.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E1</text>
<text text-anchor="middle" x="1365.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1365.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1365.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e1_gpu1 -->
<g id="edge372" class="edge">
<title>route_l5&#45;&gt;recv_l5_e1_gpu1</title>
<path fill="none" stroke="black" d="M5619.4,-13419.96C4967.9,-13407.85 3610.87,-13380.31 2463.44,-13341.83 2122.87,-13330.41 2036.76,-13340.12 1697.44,-13308.83 1664.33,-13305.78 1629.47,-13301.74 1595.29,-13297.32"/>
<polygon fill="black" stroke="black" points="1595.56,-13293.82 1585.19,-13295.99 1594.65,-13300.76 1595.56,-13293.82"/>
<text text-anchor="middle" x="2535.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l5_e2_gpu2 -->
<g id="node289" class="node">
<title>recv_l5_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2028.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2028.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E2</text>
<text text-anchor="middle" x="2028.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2028.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2028.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e2_gpu2 -->
<g id="edge376" class="edge">
<title>route_l5&#45;&gt;recv_l5_e2_gpu2</title>
<path fill="none" stroke="black" d="M5615.09,-13416.96C5061.03,-13402.6 4016.24,-13374.13 3126.44,-13341.83 2785.9,-13329.47 2699.76,-13340.12 2360.44,-13308.83 2327.33,-13305.78 2292.47,-13301.74 2258.29,-13297.32"/>
<polygon fill="black" stroke="black" points="2258.56,-13293.82 2248.19,-13295.99 2257.65,-13300.76 2258.56,-13293.82"/>
<text text-anchor="middle" x="3198.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l5_e3_gpu3 -->
<g id="node292" class="node">
<title>recv_l5_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2691.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2691.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E3</text>
<text text-anchor="middle" x="2691.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2691.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2691.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e3_gpu3 -->
<g id="edge380" class="edge">
<title>route_l5&#45;&gt;recv_l5_e3_gpu3</title>
<path fill="none" stroke="black" d="M5608.18,-13412.13C5164.4,-13395.61 4425.54,-13367.73 3789.44,-13341.83 3448.96,-13327.97 3362.76,-13340.12 3023.44,-13308.83 2990.33,-13305.78 2955.47,-13301.74 2921.29,-13297.32"/>
<polygon fill="black" stroke="black" points="2921.56,-13293.82 2911.19,-13295.99 2920.65,-13300.76 2921.56,-13293.82"/>
<text text-anchor="middle" x="3861.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l5_e4_gpu4 -->
<g id="node295" class="node">
<title>recv_l5_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3354.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3354.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E4</text>
<text text-anchor="middle" x="3354.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3354.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3354.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e4_gpu4 -->
<g id="edge384" class="edge">
<title>route_l5&#45;&gt;recv_l5_e4_gpu4</title>
<path fill="none" stroke="black" d="M5616.2,-13417.71C5154.53,-13404.43 4363.13,-13373.89 3686.44,-13308.83 3653.61,-13305.67 3619.05,-13301.61 3585.13,-13297.19"/>
<polygon fill="black" stroke="black" points="3585.48,-13293.71 3575.11,-13295.87 3584.57,-13300.65 3585.48,-13293.71"/>
<text text-anchor="middle" x="4137.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l5_e5_gpu5 -->
<g id="node298" class="node">
<title>recv_l5_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4017.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4017.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E5</text>
<text text-anchor="middle" x="4017.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4017.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4017.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e5_gpu5 -->
<g id="edge388" class="edge">
<title>route_l5&#45;&gt;recv_l5_e5_gpu5</title>
<path fill="none" stroke="black" d="M5598.86,-13405.75C5263.03,-13386.48 4774.6,-13354.06 4349.44,-13308.83 4317.44,-13305.43 4283.78,-13301.3 4250.66,-13296.91"/>
<polygon fill="black" stroke="black" points="4250.78,-13293.4 4240.41,-13295.55 4249.86,-13300.34 4250.78,-13293.4"/>
<text text-anchor="middle" x="4738.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l5_e6_gpu6 -->
<g id="node301" class="node">
<title>recv_l5_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4680.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4680.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E6</text>
<text text-anchor="middle" x="4680.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4680.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4680.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e6_gpu6 -->
<g id="edge392" class="edge">
<title>route_l5&#45;&gt;recv_l5_e6_gpu6</title>
<path fill="none" stroke="black" d="M5556.2,-13375.57C5385.75,-13355.59 5190.04,-13331.96 5012.44,-13308.83 4982.1,-13304.88 4950.22,-13300.56 4918.71,-13296.2"/>
<polygon fill="black" stroke="black" points="4918.89,-13292.69 4908.5,-13294.79 4917.93,-13299.63 4918.89,-13292.69"/>
<text text-anchor="middle" x="5330.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l5_e7_gpu7 -->
<g id="node304" class="node">
<title>recv_l5_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5343.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5343.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E7</text>
<text text-anchor="middle" x="5343.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5343.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5343.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e7_gpu7 -->
<g id="edge396" class="edge">
<title>route_l5&#45;&gt;recv_l5_e7_gpu7</title>
<path fill="none" stroke="black" d="M5737.25,-13359.8C5662.71,-13341.24 5583.82,-13321.6 5516.37,-13304.81"/>
<polygon fill="black" stroke="black" points="5517.06,-13301.37 5506.51,-13302.35 5515.37,-13308.16 5517.06,-13301.37"/>
<text text-anchor="middle" x="5727.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l5_e8_gpu8 -->
<g id="node307" class="node">
<title>recv_l5_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6006.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6006.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E8</text>
<text text-anchor="middle" x="6006.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e8_gpu8 -->
<g id="edge400" class="edge">
<title>route_l5&#45;&gt;recv_l5_e8_gpu8</title>
<path fill="none" stroke="black" d="M6006.44,-13359.68C6006.44,-13346.3 6006.44,-13332.36 6006.44,-13319.33"/>
<polygon fill="black" stroke="black" points="6009.94,-13319.11 6006.44,-13309.11 6002.94,-13319.11 6009.94,-13319.11"/>
<text text-anchor="middle" x="6078.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l5_e9_gpu9 -->
<g id="node310" class="node">
<title>recv_l5_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6669.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6669.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E9</text>
<text text-anchor="middle" x="6669.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6669.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6669.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e9_gpu9 -->
<g id="edge404" class="edge">
<title>route_l5&#45;&gt;recv_l5_e9_gpu9</title>
<path fill="none" stroke="black" d="M6275.63,-13359.8C6350.17,-13341.24 6429.06,-13321.6 6496.51,-13304.81"/>
<polygon fill="black" stroke="black" points="6497.51,-13308.16 6506.37,-13302.35 6495.82,-13301.37 6497.51,-13308.16"/>
<text text-anchor="middle" x="6469.44" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l5_e10_gpu10 -->
<g id="node313" class="node">
<title>recv_l5_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7332.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7332.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E10</text>
<text text-anchor="middle" x="7332.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7332.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7332.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e10_gpu10 -->
<g id="edge408" class="edge">
<title>route_l5&#45;&gt;recv_l5_e10_gpu10</title>
<path fill="none" stroke="black" d="M6329.27,-13390.39C6523.83,-13367.95 6776.53,-13337.99 7000.44,-13308.83 7030.78,-13304.88 7062.66,-13300.56 7094.17,-13296.2"/>
<polygon fill="black" stroke="black" points="7094.96,-13299.63 7104.38,-13294.79 7093.99,-13292.69 7094.96,-13299.63"/>
<text text-anchor="middle" x="6914.94" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l5_e11_gpu11 -->
<g id="node316" class="node">
<title>recv_l5_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7995.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7995.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E11</text>
<text text-anchor="middle" x="7995.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7995.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7995.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e11_gpu11 -->
<g id="edge412" class="edge">
<title>route_l5&#45;&gt;recv_l5_e11_gpu11</title>
<path fill="none" stroke="black" d="M6355.79,-13409.05C6691.56,-13390.29 7213.01,-13356.75 7663.44,-13308.83 7695.44,-13305.43 7729.1,-13301.3 7762.22,-13296.91"/>
<polygon fill="black" stroke="black" points="7763.02,-13300.34 7772.47,-13295.55 7762.1,-13293.4 7763.02,-13300.34"/>
<text text-anchor="middle" x="7560.94" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l5_e12_gpu12 -->
<g id="node319" class="node">
<title>recv_l5_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8658.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8658.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E12</text>
<text text-anchor="middle" x="8658.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8658.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8658.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e12_gpu12 -->
<g id="edge416" class="edge">
<title>route_l5&#45;&gt;recv_l5_e12_gpu12</title>
<path fill="none" stroke="black" d="M6369.35,-13418.48C6826.61,-13405.64 7636.2,-13375.19 8326.44,-13308.83 8359.27,-13305.67 8393.83,-13301.61 8427.75,-13297.19"/>
<polygon fill="black" stroke="black" points="8428.32,-13300.65 8437.77,-13295.87 8427.4,-13293.71 8428.32,-13300.65"/>
<text text-anchor="middle" x="8152.94" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l5_e13_gpu13 -->
<g id="node322" class="node">
<title>recv_l5_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9321.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9321.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E13</text>
<text text-anchor="middle" x="9321.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9321.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9321.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e13_gpu13 -->
<g id="edge420" class="edge">
<title>route_l5&#45;&gt;recv_l5_e13_gpu13</title>
<path fill="none" stroke="black" d="M6362.76,-13413.83C6802.49,-13397.65 7573.1,-13368.84 8233.44,-13341.83 8569.48,-13328.08 8654.55,-13339.81 8989.44,-13308.83 9022.55,-13305.77 9057.41,-13301.73 9091.59,-13297.3"/>
<polygon fill="black" stroke="black" points="9092.23,-13300.75 9101.69,-13295.98 9091.32,-13293.8 9092.23,-13300.75"/>
<text text-anchor="middle" x="8818.94" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l5_e14_gpu14 -->
<g id="node325" class="node">
<title>recv_l5_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9984.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9984.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E14</text>
<text text-anchor="middle" x="9984.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9984.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9984.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e14_gpu14 -->
<g id="edge424" class="edge">
<title>route_l5&#45;&gt;recv_l5_e14_gpu14</title>
<path fill="none" stroke="black" d="M6368.16,-13417.88C6915.91,-13403.94 7988.53,-13375.17 8899.44,-13341.83 9234.2,-13329.58 9318.88,-13339.72 9652.44,-13308.83 9685.55,-13305.76 9720.41,-13301.72 9754.59,-13297.29"/>
<polygon fill="black" stroke="black" points="9755.23,-13300.74 9764.69,-13295.97 9754.32,-13293.8 9755.23,-13300.74"/>
<text text-anchor="middle" x="9482.94" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l5_e15_gpu15 -->
<g id="node328" class="node">
<title>recv_l5_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10647.44" cy="-13260.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10647.44" y="-13279.55" font-family="Times,serif" font-size="14.00">Token Receive L5E15</text>
<text text-anchor="middle" x="10647.44" y="-13264.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10647.44" y="-13249.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10647.44" y="-13234.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l5&#45;&gt;recv_l5_e15_gpu15 -->
<g id="edge428" class="edge">
<title>route_l5&#45;&gt;recv_l5_e15_gpu15</title>
<path fill="none" stroke="black" d="M6371.99,-13420.5C7016.66,-13408.8 8397.79,-13381.33 9563.44,-13341.83 9897.79,-13330.5 9982.32,-13339.69 10315.44,-13308.83 10348.55,-13305.76 10383.41,-13301.72 10417.59,-13297.29"/>
<polygon fill="black" stroke="black" points="10418.23,-13300.74 10427.69,-13295.97 10417.32,-13293.8 10418.23,-13300.74"/>
<text text-anchor="middle" x="10145.94" y="-13330.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l5_e0_gpu0 -->
<g id="node284" class="node">
<title>expert_l5_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="930.44,-13175.66 474.44,-13175.66 474.44,-13107.66 930.44,-13107.66 930.44,-13175.66"/>
<text text-anchor="middle" x="702.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E0</text>
<text text-anchor="middle" x="702.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="702.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="702.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l5_e0_gpu0&#45;&gt;expert_l5_e0_gpu0 -->
<g id="edge369" class="edge">
<title>recv_l5_e0_gpu0&#45;&gt;expert_l5_e0_gpu0</title>
<path fill="none" stroke="black" d="M702.44,-13212.46C702.44,-13203.71 702.44,-13194.61 702.44,-13185.98"/>
<polygon fill="black" stroke="black" points="705.94,-13185.74 702.44,-13175.74 698.94,-13185.74 705.94,-13185.74"/>
</g>
<!-- send_l5_e0_gpu0 -->
<g id="node285" class="node">
<title>send_l5_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="702.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="702.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E0</text>
<text text-anchor="middle" x="702.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="702.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="702.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l5_e0_gpu0&#45;&gt;send_l5_e0_gpu0 -->
<g id="edge370" class="edge">
<title>expert_l5_e0_gpu0&#45;&gt;send_l5_e0_gpu0</title>
<path fill="none" stroke="black" d="M702.44,-13107.43C702.44,-13099.17 702.44,-13090.09 702.44,-13081.04"/>
<polygon fill="black" stroke="black" points="705.94,-13080.89 702.44,-13070.89 698.94,-13080.89 705.94,-13080.89"/>
</g>
<!-- agg_l5 -->
<g id="node331" class="node">
<title>agg_l5</title>
<polygon fill="lightgray" stroke="black" points="6484.33,-12937.5 5724.12,-12937.5 5528.55,-12801.5 6288.76,-12801.5 6484.33,-12937.5"/>
<text text-anchor="middle" x="6006.44" y="-12888.3" font-family="Times,serif" font-size="14.00">Expert Aggregation L5</text>
<text text-anchor="middle" x="6006.44" y="-12873.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-12858.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-12843.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l5_e0_gpu0&#45;&gt;agg_l5 -->
<g id="edge371" class="edge">
<title>send_l5_e0_gpu0&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M919.45,-12986.99C957.68,-12981.99 997.16,-12977.52 1034.44,-12974.5 1922.88,-12902.47 4612.64,-12878.97 5620.01,-12872.58"/>
<polygon fill="black" stroke="black" points="5620.34,-12876.08 5630.32,-12872.52 5620.29,-12869.08 5620.34,-12876.08"/>
</g>
<!-- expert_l5_e1_gpu1 -->
<g id="node287" class="node">
<title>expert_l5_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1593.44,-13175.66 1137.44,-13175.66 1137.44,-13107.66 1593.44,-13107.66 1593.44,-13175.66"/>
<text text-anchor="middle" x="1365.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E1</text>
<text text-anchor="middle" x="1365.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1365.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1365.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l5_e1_gpu1&#45;&gt;expert_l5_e1_gpu1 -->
<g id="edge373" class="edge">
<title>recv_l5_e1_gpu1&#45;&gt;expert_l5_e1_gpu1</title>
<path fill="none" stroke="black" d="M1365.44,-13212.46C1365.44,-13203.71 1365.44,-13194.61 1365.44,-13185.98"/>
<polygon fill="black" stroke="black" points="1368.94,-13185.74 1365.44,-13175.74 1361.94,-13185.74 1368.94,-13185.74"/>
</g>
<!-- send_l5_e1_gpu1 -->
<g id="node288" class="node">
<title>send_l5_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1365.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1365.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E1</text>
<text text-anchor="middle" x="1365.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1365.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1365.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l5_e1_gpu1&#45;&gt;send_l5_e1_gpu1 -->
<g id="edge374" class="edge">
<title>expert_l5_e1_gpu1&#45;&gt;send_l5_e1_gpu1</title>
<path fill="none" stroke="black" d="M1365.44,-13107.43C1365.44,-13099.17 1365.44,-13090.09 1365.44,-13081.04"/>
<polygon fill="black" stroke="black" points="1368.94,-13080.89 1365.44,-13070.89 1361.94,-13080.89 1368.94,-13080.89"/>
</g>
<!-- send_l5_e1_gpu1&#45;&gt;agg_l5 -->
<g id="edge375" class="edge">
<title>send_l5_e1_gpu1&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M1582.91,-12987.04C1620.99,-12982.05 1660.31,-12977.57 1697.44,-12974.5 2453.27,-12912 4713.64,-12883.27 5622.13,-12874.02"/>
<polygon fill="black" stroke="black" points="5622.46,-12877.51 5632.42,-12873.91 5622.39,-12870.51 5622.46,-12877.51"/>
</g>
<!-- expert_l5_e2_gpu2 -->
<g id="node290" class="node">
<title>expert_l5_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2256.44,-13175.66 1800.44,-13175.66 1800.44,-13107.66 2256.44,-13107.66 2256.44,-13175.66"/>
<text text-anchor="middle" x="2028.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E2</text>
<text text-anchor="middle" x="2028.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2028.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2028.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l5_e2_gpu2&#45;&gt;expert_l5_e2_gpu2 -->
<g id="edge377" class="edge">
<title>recv_l5_e2_gpu2&#45;&gt;expert_l5_e2_gpu2</title>
<path fill="none" stroke="black" d="M2028.44,-13212.46C2028.44,-13203.71 2028.44,-13194.61 2028.44,-13185.98"/>
<polygon fill="black" stroke="black" points="2031.94,-13185.74 2028.44,-13175.74 2024.94,-13185.74 2031.94,-13185.74"/>
</g>
<!-- send_l5_e2_gpu2 -->
<g id="node291" class="node">
<title>send_l5_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2028.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2028.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E2</text>
<text text-anchor="middle" x="2028.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2028.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2028.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l5_e2_gpu2&#45;&gt;send_l5_e2_gpu2 -->
<g id="edge378" class="edge">
<title>expert_l5_e2_gpu2&#45;&gt;send_l5_e2_gpu2</title>
<path fill="none" stroke="black" d="M2028.44,-13107.43C2028.44,-13099.17 2028.44,-13090.09 2028.44,-13081.04"/>
<polygon fill="black" stroke="black" points="2031.94,-13080.89 2028.44,-13070.89 2024.94,-13080.89 2031.94,-13080.89"/>
</g>
<!-- send_l5_e2_gpu2&#45;&gt;agg_l5 -->
<g id="edge379" class="edge">
<title>send_l5_e2_gpu2&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M2246.36,-12987.11C2284.31,-12982.13 2323.46,-12977.64 2360.44,-12974.5 2984.79,-12921.49 4822.71,-12888.29 5624.78,-12875.94"/>
<polygon fill="black" stroke="black" points="5625.1,-12879.44 5635.05,-12875.79 5624.99,-12872.44 5625.1,-12879.44"/>
</g>
<!-- expert_l5_e3_gpu3 -->
<g id="node293" class="node">
<title>expert_l5_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2919.44,-13175.66 2463.44,-13175.66 2463.44,-13107.66 2919.44,-13107.66 2919.44,-13175.66"/>
<text text-anchor="middle" x="2691.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E3</text>
<text text-anchor="middle" x="2691.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2691.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2691.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l5_e3_gpu3&#45;&gt;expert_l5_e3_gpu3 -->
<g id="edge381" class="edge">
<title>recv_l5_e3_gpu3&#45;&gt;expert_l5_e3_gpu3</title>
<path fill="none" stroke="black" d="M2691.44,-13212.46C2691.44,-13203.71 2691.44,-13194.61 2691.44,-13185.98"/>
<polygon fill="black" stroke="black" points="2694.94,-13185.74 2691.44,-13175.74 2687.94,-13185.74 2694.94,-13185.74"/>
</g>
<!-- send_l5_e3_gpu3 -->
<g id="node294" class="node">
<title>send_l5_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2691.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2691.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E3</text>
<text text-anchor="middle" x="2691.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2691.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2691.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l5_e3_gpu3&#45;&gt;send_l5_e3_gpu3 -->
<g id="edge382" class="edge">
<title>expert_l5_e3_gpu3&#45;&gt;send_l5_e3_gpu3</title>
<path fill="none" stroke="black" d="M2691.44,-13107.43C2691.44,-13099.17 2691.44,-13090.09 2691.44,-13081.04"/>
<polygon fill="black" stroke="black" points="2694.94,-13080.89 2691.44,-13070.89 2687.94,-13080.89 2694.94,-13080.89"/>
</g>
<!-- send_l5_e3_gpu3&#45;&gt;agg_l5 -->
<g id="edge383" class="edge">
<title>send_l5_e3_gpu3&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M2910.27,-12987.19C2947.94,-12982.24 2986.76,-12977.73 3023.44,-12974.5 3951.8,-12892.72 5048,-12874.51 5618.04,-12870.92"/>
<polygon fill="black" stroke="black" points="5618.08,-12874.42 5628.06,-12870.86 5618.04,-12867.42 5618.08,-12874.42"/>
</g>
<!-- expert_l5_e4_gpu4 -->
<g id="node296" class="node">
<title>expert_l5_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3582.44,-13175.66 3126.44,-13175.66 3126.44,-13107.66 3582.44,-13107.66 3582.44,-13175.66"/>
<text text-anchor="middle" x="3354.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E4</text>
<text text-anchor="middle" x="3354.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3354.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3354.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l5_e4_gpu4&#45;&gt;expert_l5_e4_gpu4 -->
<g id="edge385" class="edge">
<title>recv_l5_e4_gpu4&#45;&gt;expert_l5_e4_gpu4</title>
<path fill="none" stroke="black" d="M3354.44,-13212.46C3354.44,-13203.71 3354.44,-13194.61 3354.44,-13185.98"/>
<polygon fill="black" stroke="black" points="3357.94,-13185.74 3354.44,-13175.74 3350.94,-13185.74 3357.94,-13185.74"/>
</g>
<!-- send_l5_e4_gpu4 -->
<g id="node297" class="node">
<title>send_l5_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3354.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3354.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E4</text>
<text text-anchor="middle" x="3354.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3354.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3354.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l5_e4_gpu4&#45;&gt;send_l5_e4_gpu4 -->
<g id="edge386" class="edge">
<title>expert_l5_e4_gpu4&#45;&gt;send_l5_e4_gpu4</title>
<path fill="none" stroke="black" d="M3354.44,-13107.43C3354.44,-13099.17 3354.44,-13090.09 3354.44,-13081.04"/>
<polygon fill="black" stroke="black" points="3357.94,-13080.89 3354.44,-13070.89 3350.94,-13080.89 3357.94,-13080.89"/>
</g>
<!-- send_l5_e4_gpu4&#45;&gt;agg_l5 -->
<g id="edge387" class="edge">
<title>send_l5_e4_gpu4&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M3574.2,-12987.39C3611.58,-12982.44 3650.07,-12977.88 3686.44,-12974.5 4367.76,-12911.06 5165.37,-12886.03 5625.64,-12876.36"/>
<polygon fill="black" stroke="black" points="5625.85,-12879.85 5635.77,-12876.15 5625.7,-12872.86 5625.85,-12879.85"/>
</g>
<!-- expert_l5_e5_gpu5 -->
<g id="node299" class="node">
<title>expert_l5_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4245.44,-13175.66 3789.44,-13175.66 3789.44,-13107.66 4245.44,-13107.66 4245.44,-13175.66"/>
<text text-anchor="middle" x="4017.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E5</text>
<text text-anchor="middle" x="4017.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4017.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4017.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l5_e5_gpu5&#45;&gt;expert_l5_e5_gpu5 -->
<g id="edge389" class="edge">
<title>recv_l5_e5_gpu5&#45;&gt;expert_l5_e5_gpu5</title>
<path fill="none" stroke="black" d="M4017.44,-13212.46C4017.44,-13203.71 4017.44,-13194.61 4017.44,-13185.98"/>
<polygon fill="black" stroke="black" points="4020.94,-13185.74 4017.44,-13175.74 4013.94,-13185.74 4020.94,-13185.74"/>
</g>
<!-- send_l5_e5_gpu5 -->
<g id="node300" class="node">
<title>send_l5_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4017.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4017.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E5</text>
<text text-anchor="middle" x="4017.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4017.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4017.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l5_e5_gpu5&#45;&gt;send_l5_e5_gpu5 -->
<g id="edge390" class="edge">
<title>expert_l5_e5_gpu5&#45;&gt;send_l5_e5_gpu5</title>
<path fill="none" stroke="black" d="M4017.44,-13107.43C4017.44,-13099.17 4017.44,-13090.09 4017.44,-13081.04"/>
<polygon fill="black" stroke="black" points="4020.94,-13080.89 4017.44,-13070.89 4013.94,-13080.89 4020.94,-13080.89"/>
</g>
<!-- send_l5_e5_gpu5&#45;&gt;agg_l5 -->
<g id="edge391" class="edge">
<title>send_l5_e5_gpu5&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M4239.49,-12987.64C4276.16,-12982.74 4313.82,-12978.13 4349.44,-12974.5 4791.29,-12929.37 5301.57,-12900.89 5637.81,-12885.36"/>
<polygon fill="black" stroke="black" points="5638.38,-12888.84 5648.2,-12884.89 5638.05,-12881.85 5638.38,-12888.84"/>
</g>
<!-- expert_l5_e6_gpu6 -->
<g id="node302" class="node">
<title>expert_l5_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4908.44,-13175.66 4452.44,-13175.66 4452.44,-13107.66 4908.44,-13107.66 4908.44,-13175.66"/>
<text text-anchor="middle" x="4680.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E6</text>
<text text-anchor="middle" x="4680.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4680.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4680.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l5_e6_gpu6&#45;&gt;expert_l5_e6_gpu6 -->
<g id="edge393" class="edge">
<title>recv_l5_e6_gpu6&#45;&gt;expert_l5_e6_gpu6</title>
<path fill="none" stroke="black" d="M4680.44,-13212.46C4680.44,-13203.71 4680.44,-13194.61 4680.44,-13185.98"/>
<polygon fill="black" stroke="black" points="4683.94,-13185.74 4680.44,-13175.74 4676.94,-13185.74 4683.94,-13185.74"/>
</g>
<!-- send_l5_e6_gpu6 -->
<g id="node303" class="node">
<title>send_l5_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4680.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4680.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E6</text>
<text text-anchor="middle" x="4680.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4680.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4680.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l5_e6_gpu6&#45;&gt;send_l5_e6_gpu6 -->
<g id="edge394" class="edge">
<title>expert_l5_e6_gpu6&#45;&gt;send_l5_e6_gpu6</title>
<path fill="none" stroke="black" d="M4680.44,-13107.43C4680.44,-13099.17 4680.44,-13090.09 4680.44,-13081.04"/>
<polygon fill="black" stroke="black" points="4683.94,-13080.89 4680.44,-13070.89 4676.94,-13080.89 4683.94,-13080.89"/>
</g>
<!-- send_l5_e6_gpu6&#45;&gt;agg_l5 -->
<g id="edge395" class="edge">
<title>send_l5_e6_gpu6&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M4907.1,-12988.31C4942.34,-12983.46 4978.35,-12978.7 5012.44,-12974.5 5228.57,-12947.87 5471.69,-12922.36 5663.39,-12903.26"/>
<polygon fill="black" stroke="black" points="5663.74,-12906.75 5673.34,-12902.27 5663.05,-12899.78 5663.74,-12906.75"/>
</g>
<!-- expert_l5_e7_gpu7 -->
<g id="node305" class="node">
<title>expert_l5_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5571.44,-13175.66 5115.44,-13175.66 5115.44,-13107.66 5571.44,-13107.66 5571.44,-13175.66"/>
<text text-anchor="middle" x="5343.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E7</text>
<text text-anchor="middle" x="5343.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5343.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5343.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l5_e7_gpu7&#45;&gt;expert_l5_e7_gpu7 -->
<g id="edge397" class="edge">
<title>recv_l5_e7_gpu7&#45;&gt;expert_l5_e7_gpu7</title>
<path fill="none" stroke="black" d="M5343.44,-13212.46C5343.44,-13203.71 5343.44,-13194.61 5343.44,-13185.98"/>
<polygon fill="black" stroke="black" points="5346.94,-13185.74 5343.44,-13175.74 5339.94,-13185.74 5346.94,-13185.74"/>
</g>
<!-- send_l5_e7_gpu7 -->
<g id="node306" class="node">
<title>send_l5_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5343.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5343.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E7</text>
<text text-anchor="middle" x="5343.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5343.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5343.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l5_e7_gpu7&#45;&gt;send_l5_e7_gpu7 -->
<g id="edge398" class="edge">
<title>expert_l5_e7_gpu7&#45;&gt;send_l5_e7_gpu7</title>
<path fill="none" stroke="black" d="M5343.44,-13107.43C5343.44,-13099.17 5343.44,-13090.09 5343.44,-13081.04"/>
<polygon fill="black" stroke="black" points="5346.94,-13080.89 5343.44,-13070.89 5339.94,-13080.89 5346.94,-13080.89"/>
</g>
<!-- send_l5_e7_gpu7&#45;&gt;agg_l5 -->
<g id="edge399" class="edge">
<title>send_l5_e7_gpu7&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M5517.2,-12981.98C5576.63,-12968.44 5644.87,-12952.89 5711.16,-12937.79"/>
<polygon fill="black" stroke="black" points="5711.95,-12941.2 5720.92,-12935.56 5710.39,-12934.37 5711.95,-12941.2"/>
</g>
<!-- expert_l5_e8_gpu8 -->
<g id="node308" class="node">
<title>expert_l5_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6234.44,-13175.66 5778.44,-13175.66 5778.44,-13107.66 6234.44,-13107.66 6234.44,-13175.66"/>
<text text-anchor="middle" x="6006.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E8</text>
<text text-anchor="middle" x="6006.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l5_e8_gpu8&#45;&gt;expert_l5_e8_gpu8 -->
<g id="edge401" class="edge">
<title>recv_l5_e8_gpu8&#45;&gt;expert_l5_e8_gpu8</title>
<path fill="none" stroke="black" d="M6006.44,-13212.46C6006.44,-13203.71 6006.44,-13194.61 6006.44,-13185.98"/>
<polygon fill="black" stroke="black" points="6009.94,-13185.74 6006.44,-13175.74 6002.94,-13185.74 6009.94,-13185.74"/>
</g>
<!-- send_l5_e8_gpu8 -->
<g id="node309" class="node">
<title>send_l5_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6006.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6006.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E8</text>
<text text-anchor="middle" x="6006.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6006.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l5_e8_gpu8&#45;&gt;send_l5_e8_gpu8 -->
<g id="edge402" class="edge">
<title>expert_l5_e8_gpu8&#45;&gt;send_l5_e8_gpu8</title>
<path fill="none" stroke="black" d="M6006.44,-13107.43C6006.44,-13099.17 6006.44,-13090.09 6006.44,-13081.04"/>
<polygon fill="black" stroke="black" points="6009.94,-13080.89 6006.44,-13070.89 6002.94,-13080.89 6009.94,-13080.89"/>
</g>
<!-- send_l5_e8_gpu8&#45;&gt;agg_l5 -->
<g id="edge403" class="edge">
<title>send_l5_e8_gpu8&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M6006.44,-12974.19C6006.44,-12965.77 6006.44,-12956.8 6006.44,-12947.79"/>
<polygon fill="black" stroke="black" points="6009.94,-12947.64 6006.44,-12937.64 6002.94,-12947.64 6009.94,-12947.64"/>
</g>
<!-- expert_l5_e9_gpu9 -->
<g id="node311" class="node">
<title>expert_l5_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6897.44,-13175.66 6441.44,-13175.66 6441.44,-13107.66 6897.44,-13107.66 6897.44,-13175.66"/>
<text text-anchor="middle" x="6669.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E9</text>
<text text-anchor="middle" x="6669.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6669.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6669.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l5_e9_gpu9&#45;&gt;expert_l5_e9_gpu9 -->
<g id="edge405" class="edge">
<title>recv_l5_e9_gpu9&#45;&gt;expert_l5_e9_gpu9</title>
<path fill="none" stroke="black" d="M6669.44,-13212.46C6669.44,-13203.71 6669.44,-13194.61 6669.44,-13185.98"/>
<polygon fill="black" stroke="black" points="6672.94,-13185.74 6669.44,-13175.74 6665.94,-13185.74 6672.94,-13185.74"/>
</g>
<!-- send_l5_e9_gpu9 -->
<g id="node312" class="node">
<title>send_l5_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6669.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6669.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E9</text>
<text text-anchor="middle" x="6669.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6669.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6669.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l5_e9_gpu9&#45;&gt;send_l5_e9_gpu9 -->
<g id="edge406" class="edge">
<title>expert_l5_e9_gpu9&#45;&gt;send_l5_e9_gpu9</title>
<path fill="none" stroke="black" d="M6669.44,-13107.43C6669.44,-13099.17 6669.44,-13090.09 6669.44,-13081.04"/>
<polygon fill="black" stroke="black" points="6672.94,-13080.89 6669.44,-13070.89 6665.94,-13080.89 6672.94,-13080.89"/>
</g>
<!-- send_l5_e9_gpu9&#45;&gt;agg_l5 -->
<g id="edge407" class="edge">
<title>send_l5_e9_gpu9&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M6495.68,-12981.98C6438.84,-12969.03 6373.93,-12954.24 6310.39,-12939.76"/>
<polygon fill="black" stroke="black" points="6311.14,-12936.34 6300.61,-12937.53 6309.59,-12943.17 6311.14,-12936.34"/>
</g>
<!-- expert_l5_e10_gpu10 -->
<g id="node314" class="node">
<title>expert_l5_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7560.44,-13175.66 7104.44,-13175.66 7104.44,-13107.66 7560.44,-13107.66 7560.44,-13175.66"/>
<text text-anchor="middle" x="7332.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E10</text>
<text text-anchor="middle" x="7332.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7332.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7332.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l5_e10_gpu10&#45;&gt;expert_l5_e10_gpu10 -->
<g id="edge409" class="edge">
<title>recv_l5_e10_gpu10&#45;&gt;expert_l5_e10_gpu10</title>
<path fill="none" stroke="black" d="M7332.44,-13212.46C7332.44,-13203.71 7332.44,-13194.61 7332.44,-13185.98"/>
<polygon fill="black" stroke="black" points="7335.94,-13185.74 7332.44,-13175.74 7328.94,-13185.74 7335.94,-13185.74"/>
</g>
<!-- send_l5_e10_gpu10 -->
<g id="node315" class="node">
<title>send_l5_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7332.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7332.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E10</text>
<text text-anchor="middle" x="7332.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7332.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7332.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l5_e10_gpu10&#45;&gt;send_l5_e10_gpu10 -->
<g id="edge410" class="edge">
<title>expert_l5_e10_gpu10&#45;&gt;send_l5_e10_gpu10</title>
<path fill="none" stroke="black" d="M7332.44,-13107.43C7332.44,-13099.17 7332.44,-13090.09 7332.44,-13081.04"/>
<polygon fill="black" stroke="black" points="7335.94,-13080.89 7332.44,-13070.89 7328.94,-13080.89 7335.94,-13080.89"/>
</g>
<!-- send_l5_e10_gpu10&#45;&gt;agg_l5 -->
<g id="edge411" class="edge">
<title>send_l5_e10_gpu10&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M7105.78,-12988.31C7070.54,-12983.46 7034.53,-12978.7 7000.44,-12974.5 6824,-12952.76 6629.57,-12931.77 6459.81,-12914.4"/>
<polygon fill="black" stroke="black" points="6460,-12910.9 6449.69,-12913.37 6459.29,-12917.86 6460,-12910.9"/>
</g>
<!-- expert_l5_e11_gpu11 -->
<g id="node317" class="node">
<title>expert_l5_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8223.44,-13175.66 7767.44,-13175.66 7767.44,-13107.66 8223.44,-13107.66 8223.44,-13175.66"/>
<text text-anchor="middle" x="7995.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E11</text>
<text text-anchor="middle" x="7995.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7995.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7995.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l5_e11_gpu11&#45;&gt;expert_l5_e11_gpu11 -->
<g id="edge413" class="edge">
<title>recv_l5_e11_gpu11&#45;&gt;expert_l5_e11_gpu11</title>
<path fill="none" stroke="black" d="M7995.44,-13212.46C7995.44,-13203.71 7995.44,-13194.61 7995.44,-13185.98"/>
<polygon fill="black" stroke="black" points="7998.94,-13185.74 7995.44,-13175.74 7991.94,-13185.74 7998.94,-13185.74"/>
</g>
<!-- send_l5_e11_gpu11 -->
<g id="node318" class="node">
<title>send_l5_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="7995.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7995.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E11</text>
<text text-anchor="middle" x="7995.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7995.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7995.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l5_e11_gpu11&#45;&gt;send_l5_e11_gpu11 -->
<g id="edge414" class="edge">
<title>expert_l5_e11_gpu11&#45;&gt;send_l5_e11_gpu11</title>
<path fill="none" stroke="black" d="M7995.44,-13107.43C7995.44,-13099.17 7995.44,-13090.09 7995.44,-13081.04"/>
<polygon fill="black" stroke="black" points="7998.94,-13080.89 7995.44,-13070.89 7991.94,-13080.89 7998.94,-13080.89"/>
</g>
<!-- send_l5_e11_gpu11&#45;&gt;agg_l5 -->
<g id="edge415" class="edge">
<title>send_l5_e11_gpu11&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M7773.85,-12987.65C7737.03,-12982.73 7699.21,-12978.12 7663.44,-12974.5 7532.75,-12961.26 7499.54,-12964.64 7368.44,-12956.5 7056.76,-12937.15 6704.98,-12914.93 6437.01,-12897.92"/>
<polygon fill="black" stroke="black" points="6436.92,-12894.41 6426.72,-12897.26 6436.47,-12901.39 6436.92,-12894.41"/>
</g>
<!-- expert_l5_e12_gpu12 -->
<g id="node320" class="node">
<title>expert_l5_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8886.44,-13175.66 8430.44,-13175.66 8430.44,-13107.66 8886.44,-13107.66 8886.44,-13175.66"/>
<text text-anchor="middle" x="8658.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E12</text>
<text text-anchor="middle" x="8658.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8658.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8658.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l5_e12_gpu12&#45;&gt;expert_l5_e12_gpu12 -->
<g id="edge417" class="edge">
<title>recv_l5_e12_gpu12&#45;&gt;expert_l5_e12_gpu12</title>
<path fill="none" stroke="black" d="M8658.44,-13212.46C8658.44,-13203.71 8658.44,-13194.61 8658.44,-13185.98"/>
<polygon fill="black" stroke="black" points="8661.94,-13185.74 8658.44,-13175.74 8654.94,-13185.74 8661.94,-13185.74"/>
</g>
<!-- send_l5_e12_gpu12 -->
<g id="node321" class="node">
<title>send_l5_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8658.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8658.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E12</text>
<text text-anchor="middle" x="8658.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8658.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8658.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l5_e12_gpu12&#45;&gt;send_l5_e12_gpu12 -->
<g id="edge418" class="edge">
<title>expert_l5_e12_gpu12&#45;&gt;send_l5_e12_gpu12</title>
<path fill="none" stroke="black" d="M8658.44,-13107.43C8658.44,-13099.17 8658.44,-13090.09 8658.44,-13081.04"/>
<polygon fill="black" stroke="black" points="8661.94,-13080.89 8658.44,-13070.89 8654.94,-13080.89 8661.94,-13080.89"/>
</g>
<!-- send_l5_e12_gpu12&#45;&gt;agg_l5 -->
<g id="edge419" class="edge">
<title>send_l5_e12_gpu12&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M8438.69,-12987.39C8401.3,-12982.44 8362.81,-12977.88 8326.44,-12974.5 7654.83,-12911.97 6870.23,-12886.75 6407.13,-12876.78"/>
<polygon fill="black" stroke="black" points="6407.01,-12873.28 6396.93,-12876.56 6406.86,-12880.28 6407.01,-12873.28"/>
</g>
<!-- expert_l5_e13_gpu13 -->
<g id="node323" class="node">
<title>expert_l5_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9549.44,-13175.66 9093.44,-13175.66 9093.44,-13107.66 9549.44,-13107.66 9549.44,-13175.66"/>
<text text-anchor="middle" x="9321.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E13</text>
<text text-anchor="middle" x="9321.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9321.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9321.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l5_e13_gpu13&#45;&gt;expert_l5_e13_gpu13 -->
<g id="edge421" class="edge">
<title>recv_l5_e13_gpu13&#45;&gt;expert_l5_e13_gpu13</title>
<path fill="none" stroke="black" d="M9321.44,-13212.46C9321.44,-13203.71 9321.44,-13194.61 9321.44,-13185.98"/>
<polygon fill="black" stroke="black" points="9324.94,-13185.74 9321.44,-13175.74 9317.94,-13185.74 9324.94,-13185.74"/>
</g>
<!-- send_l5_e13_gpu13 -->
<g id="node324" class="node">
<title>send_l5_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9321.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9321.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E13</text>
<text text-anchor="middle" x="9321.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9321.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9321.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l5_e13_gpu13&#45;&gt;send_l5_e13_gpu13 -->
<g id="edge422" class="edge">
<title>expert_l5_e13_gpu13&#45;&gt;send_l5_e13_gpu13</title>
<path fill="none" stroke="black" d="M9321.44,-13107.43C9321.44,-13099.17 9321.44,-13090.09 9321.44,-13081.04"/>
<polygon fill="black" stroke="black" points="9324.94,-13080.89 9321.44,-13070.89 9317.94,-13080.89 9324.94,-13080.89"/>
</g>
<!-- send_l5_e13_gpu13&#45;&gt;agg_l5 -->
<g id="edge423" class="edge">
<title>send_l5_e13_gpu13&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M9102.61,-12987.19C9064.94,-12982.24 9026.12,-12977.73 8989.44,-12974.5 8063.16,-12892.9 6969.8,-12874.6 6398.69,-12870.94"/>
<polygon fill="black" stroke="black" points="6398.67,-12867.44 6388.65,-12870.88 6398.63,-12874.44 6398.67,-12867.44"/>
</g>
<!-- expert_l5_e14_gpu14 -->
<g id="node326" class="node">
<title>expert_l5_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10212.44,-13175.66 9756.44,-13175.66 9756.44,-13107.66 10212.44,-13107.66 10212.44,-13175.66"/>
<text text-anchor="middle" x="9984.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E14</text>
<text text-anchor="middle" x="9984.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9984.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9984.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l5_e14_gpu14&#45;&gt;expert_l5_e14_gpu14 -->
<g id="edge425" class="edge">
<title>recv_l5_e14_gpu14&#45;&gt;expert_l5_e14_gpu14</title>
<path fill="none" stroke="black" d="M9984.44,-13212.46C9984.44,-13203.71 9984.44,-13194.61 9984.44,-13185.98"/>
<polygon fill="black" stroke="black" points="9987.94,-13185.74 9984.44,-13175.74 9980.94,-13185.74 9987.94,-13185.74"/>
</g>
<!-- send_l5_e14_gpu14 -->
<g id="node327" class="node">
<title>send_l5_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="9984.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9984.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E14</text>
<text text-anchor="middle" x="9984.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9984.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9984.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l5_e14_gpu14&#45;&gt;send_l5_e14_gpu14 -->
<g id="edge426" class="edge">
<title>expert_l5_e14_gpu14&#45;&gt;send_l5_e14_gpu14</title>
<path fill="none" stroke="black" d="M9984.44,-13107.43C9984.44,-13099.17 9984.44,-13090.09 9984.44,-13081.04"/>
<polygon fill="black" stroke="black" points="9987.94,-13080.89 9984.44,-13070.89 9980.94,-13080.89 9987.94,-13080.89"/>
</g>
<!-- send_l5_e14_gpu14&#45;&gt;agg_l5 -->
<g id="edge427" class="edge">
<title>send_l5_e14_gpu14&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M9766.52,-12987.11C9728.57,-12982.13 9689.42,-12977.64 9652.44,-12974.5 9032.73,-12921.88 7217.4,-12888.78 6406.14,-12876.22"/>
<polygon fill="black" stroke="black" points="6406.1,-12872.72 6396.05,-12876.07 6405.99,-12879.72 6406.1,-12872.72"/>
</g>
<!-- expert_l5_e15_gpu15 -->
<g id="node329" class="node">
<title>expert_l5_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10875.44,-13175.66 10419.44,-13175.66 10419.44,-13107.66 10875.44,-13107.66 10875.44,-13175.66"/>
<text text-anchor="middle" x="10647.44" y="-13160.46" font-family="Times,serif" font-size="14.00">Expert L5E15</text>
<text text-anchor="middle" x="10647.44" y="-13145.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10647.44" y="-13130.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10647.44" y="-13115.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l5_e15_gpu15&#45;&gt;expert_l5_e15_gpu15 -->
<g id="edge429" class="edge">
<title>recv_l5_e15_gpu15&#45;&gt;expert_l5_e15_gpu15</title>
<path fill="none" stroke="black" d="M10647.44,-13212.46C10647.44,-13203.71 10647.44,-13194.61 10647.44,-13185.98"/>
<polygon fill="black" stroke="black" points="10650.94,-13185.74 10647.44,-13175.74 10643.94,-13185.74 10650.94,-13185.74"/>
</g>
<!-- send_l5_e15_gpu15 -->
<g id="node330" class="node">
<title>send_l5_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10647.44" cy="-13022.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10647.44" y="-13041.38" font-family="Times,serif" font-size="14.00">Token Send L5E15</text>
<text text-anchor="middle" x="10647.44" y="-13026.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10647.44" y="-13011.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10647.44" y="-12996.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l5_e15_gpu15&#45;&gt;send_l5_e15_gpu15 -->
<g id="edge430" class="edge">
<title>expert_l5_e15_gpu15&#45;&gt;send_l5_e15_gpu15</title>
<path fill="none" stroke="black" d="M10647.44,-13107.43C10647.44,-13099.17 10647.44,-13090.09 10647.44,-13081.04"/>
<polygon fill="black" stroke="black" points="10650.94,-13080.89 10647.44,-13070.89 10643.94,-13080.89 10650.94,-13080.89"/>
</g>
<!-- send_l5_e15_gpu15&#45;&gt;agg_l5 -->
<g id="edge431" class="edge">
<title>send_l5_e15_gpu15&#45;&gt;agg_l5</title>
<path fill="none" stroke="black" d="M10429.97,-12987.04C10391.89,-12982.05 10352.57,-12977.57 10315.44,-12974.5 9563.12,-12912.29 7320.18,-12883.54 6403.48,-12874.15"/>
<polygon fill="black" stroke="black" points="6403.46,-12870.65 6393.43,-12874.04 6403.39,-12877.65 6403.46,-12870.65"/>
</g>
<!-- residual2_l5 -->
<g id="node332" class="node">
<title>residual2_l5</title>
<polygon fill="lightpink" stroke="black" points="6271.94,-12764.5 5836.94,-12764.5 5836.94,-12696.5 6271.94,-12696.5 6271.94,-12764.5"/>
<text text-anchor="middle" x="6054.44" y="-12749.3" font-family="Times,serif" font-size="14.00">ResidualAdd L5</text>
<text text-anchor="middle" x="6054.44" y="-12734.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6054.44" y="-12719.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6054.44" y="-12704.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l5&#45;&gt;residual2_l5 -->
<g id="edge432" class="edge">
<title>agg_l5&#45;&gt;residual2_l5</title>
<path fill="none" stroke="black" d="M6030.02,-12801.2C6033.22,-12792.06 6036.44,-12782.88 6039.43,-12774.34"/>
<polygon fill="black" stroke="black" points="6042.83,-12775.22 6042.83,-12764.63 6036.22,-12772.91 6042.83,-12775.22"/>
</g>
<!-- residual2_l5&#45;&gt;ln1_l6 -->
<g id="edge433" class="edge">
<title>residual2_l5&#45;&gt;ln1_l6</title>
<path fill="none" stroke="black" d="M6063.45,-12696.34C6065.78,-12687.79 6068.31,-12678.47 6070.75,-12669.51"/>
<polygon fill="black" stroke="black" points="6074.2,-12670.16 6073.44,-12659.59 6067.44,-12668.32 6074.2,-12670.16"/>
</g>
<!-- attn_l6 -->
<g id="node334" class="node">
<title>attn_l6</title>
<polygon fill="lightcoral" stroke="black" points="6312.44,-12554.5 5852.44,-12554.5 5852.44,-12486.5 6312.44,-12486.5 6312.44,-12554.5"/>
<text text-anchor="middle" x="6082.44" y="-12539.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L6</text>
<text text-anchor="middle" x="6082.44" y="-12524.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6082.44" y="-12509.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12494.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l6&#45;&gt;attn_l6 -->
<g id="edge436" class="edge">
<title>ln1_l6&#45;&gt;attn_l6</title>
<path fill="none" stroke="black" d="M6082.44,-12591.34C6082.44,-12582.89 6082.44,-12573.67 6082.44,-12564.8"/>
<polygon fill="black" stroke="black" points="6085.94,-12564.59 6082.44,-12554.59 6078.94,-12564.59 6085.94,-12564.59"/>
</g>
<!-- residual1_l6 -->
<g id="node335" class="node">
<title>residual1_l6</title>
<polygon fill="lightpink" stroke="black" points="6299.94,-12449.5 5864.94,-12449.5 5864.94,-12381.5 6299.94,-12381.5 6299.94,-12449.5"/>
<text text-anchor="middle" x="6082.44" y="-12434.3" font-family="Times,serif" font-size="14.00">ResidualAdd L6</text>
<text text-anchor="middle" x="6082.44" y="-12419.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12404.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12389.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l6&#45;&gt;residual1_l6 -->
<g id="edge437" class="edge">
<title>attn_l6&#45;&gt;residual1_l6</title>
<path fill="none" stroke="black" d="M6082.44,-12486.34C6082.44,-12477.89 6082.44,-12468.67 6082.44,-12459.8"/>
<polygon fill="black" stroke="black" points="6085.94,-12459.59 6082.44,-12449.59 6078.94,-12459.59 6085.94,-12459.59"/>
</g>
<!-- ln2_l6 -->
<g id="node336" class="node">
<title>ln2_l6</title>
<polygon fill="lightyellow" stroke="black" points="6299.94,-12344.5 5864.94,-12344.5 5864.94,-12276.5 6299.94,-12276.5 6299.94,-12344.5"/>
<text text-anchor="middle" x="6082.44" y="-12329.3" font-family="Times,serif" font-size="14.00">LayerNorm L6</text>
<text text-anchor="middle" x="6082.44" y="-12314.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12299.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-12284.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l6&#45;&gt;ln2_l6 -->
<g id="edge438" class="edge">
<title>residual1_l6&#45;&gt;ln2_l6</title>
<path fill="none" stroke="black" d="M6082.44,-12381.34C6082.44,-12372.89 6082.44,-12363.67 6082.44,-12354.8"/>
<polygon fill="black" stroke="black" points="6085.94,-12354.59 6082.44,-12344.59 6078.94,-12354.59 6085.94,-12354.59"/>
</g>
<!-- ln2_l6&#45;&gt;route_l6 -->
<g id="edge439" class="edge">
<title>ln2_l6&#45;&gt;route_l6</title>
<path fill="none" stroke="black" d="M6082.44,-12276.33C6082.44,-12268.19 6082.44,-12259.13 6082.44,-12249.85"/>
<polygon fill="black" stroke="black" points="6085.94,-12249.73 6082.44,-12239.73 6078.94,-12249.73 6085.94,-12249.73"/>
</g>
<!-- recv_l6_e0_gpu0 -->
<g id="node338" class="node">
<title>recv_l6_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="778.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="778.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E0</text>
<text text-anchor="middle" x="778.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="778.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="778.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e0_gpu0 -->
<g id="edge440" class="edge">
<title>route_l6&#45;&gt;recv_l6_e0_gpu0</title>
<path fill="none" stroke="black" d="M5698.34,-12165.81C4956.72,-12156.08 3276,-12130.74 1862.44,-12085.5 1528.07,-12074.79 1443.56,-12083.35 1110.44,-12052.5 1077.33,-12049.43 1042.48,-12045.39 1008.29,-12040.96"/>
<polygon fill="black" stroke="black" points="1008.56,-12037.46 998.19,-12039.64 1007.65,-12044.41 1008.56,-12037.46"/>
<text text-anchor="middle" x="1934.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l6_e1_gpu1 -->
<g id="node341" class="node">
<title>recv_l6_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1441.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1441.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E1</text>
<text text-anchor="middle" x="1441.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1441.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1441.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e1_gpu1 -->
<g id="edge444" class="edge">
<title>route_l6&#45;&gt;recv_l6_e1_gpu1</title>
<path fill="none" stroke="black" d="M5695.4,-12163.63C5043.9,-12151.52 3686.87,-12123.97 2539.44,-12085.5 2198.87,-12074.08 2112.76,-12083.79 1773.44,-12052.5 1740.33,-12049.44 1705.47,-12045.41 1671.29,-12040.98"/>
<polygon fill="black" stroke="black" points="1671.56,-12037.49 1661.19,-12039.66 1670.65,-12044.43 1671.56,-12037.49"/>
<text text-anchor="middle" x="2611.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l6_e2_gpu2 -->
<g id="node344" class="node">
<title>recv_l6_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2104.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2104.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E2</text>
<text text-anchor="middle" x="2104.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2104.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2104.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e2_gpu2 -->
<g id="edge448" class="edge">
<title>route_l6&#45;&gt;recv_l6_e2_gpu2</title>
<path fill="none" stroke="black" d="M5691.09,-12160.63C5137.03,-12146.27 4092.24,-12117.79 3202.44,-12085.5 2861.9,-12073.14 2775.76,-12083.79 2436.44,-12052.5 2403.33,-12049.44 2368.47,-12045.41 2334.29,-12040.98"/>
<polygon fill="black" stroke="black" points="2334.56,-12037.49 2324.19,-12039.66 2333.65,-12044.43 2334.56,-12037.49"/>
<text text-anchor="middle" x="3274.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l6_e3_gpu3 -->
<g id="node347" class="node">
<title>recv_l6_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2767.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2767.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E3</text>
<text text-anchor="middle" x="2767.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2767.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2767.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e3_gpu3 -->
<g id="edge452" class="edge">
<title>route_l6&#45;&gt;recv_l6_e3_gpu3</title>
<path fill="none" stroke="black" d="M5684.18,-12155.8C5240.4,-12139.28 4501.54,-12111.39 3865.44,-12085.5 3524.96,-12071.64 3438.76,-12083.79 3099.44,-12052.5 3066.33,-12049.44 3031.47,-12045.41 2997.29,-12040.98"/>
<polygon fill="black" stroke="black" points="2997.56,-12037.49 2987.19,-12039.66 2996.65,-12044.43 2997.56,-12037.49"/>
<text text-anchor="middle" x="3937.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l6_e4_gpu4 -->
<g id="node350" class="node">
<title>recv_l6_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3430.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3430.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E4</text>
<text text-anchor="middle" x="3430.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3430.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3430.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e4_gpu4 -->
<g id="edge456" class="edge">
<title>route_l6&#45;&gt;recv_l6_e4_gpu4</title>
<path fill="none" stroke="black" d="M5692.2,-12161.37C5230.53,-12148.1 4439.13,-12117.56 3762.44,-12052.5 3729.61,-12049.34 3695.05,-12045.27 3661.13,-12040.86"/>
<polygon fill="black" stroke="black" points="3661.48,-12037.37 3651.11,-12039.54 3660.57,-12044.31 3661.48,-12037.37"/>
<text text-anchor="middle" x="4213.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l6_e5_gpu5 -->
<g id="node353" class="node">
<title>recv_l6_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4093.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4093.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E5</text>
<text text-anchor="middle" x="4093.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4093.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4093.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e5_gpu5 -->
<g id="edge460" class="edge">
<title>route_l6&#45;&gt;recv_l6_e5_gpu5</title>
<path fill="none" stroke="black" d="M5674.86,-12149.42C5339.03,-12130.14 4850.6,-12097.73 4425.44,-12052.5 4393.44,-12049.09 4359.78,-12044.96 4326.66,-12040.58"/>
<polygon fill="black" stroke="black" points="4326.78,-12037.06 4316.41,-12039.21 4325.86,-12044 4326.78,-12037.06"/>
<text text-anchor="middle" x="4814.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l6_e6_gpu6 -->
<g id="node356" class="node">
<title>recv_l6_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4756.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4756.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E6</text>
<text text-anchor="middle" x="4756.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4756.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4756.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e6_gpu6 -->
<g id="edge464" class="edge">
<title>route_l6&#45;&gt;recv_l6_e6_gpu6</title>
<path fill="none" stroke="black" d="M5632.2,-12119.24C5461.75,-12099.26 5266.04,-12075.63 5088.44,-12052.5 5058.1,-12048.54 5026.22,-12044.23 4994.71,-12039.87"/>
<polygon fill="black" stroke="black" points="4994.89,-12036.36 4984.5,-12038.45 4993.93,-12043.29 4994.89,-12036.36"/>
<text text-anchor="middle" x="5406.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l6_e7_gpu7 -->
<g id="node359" class="node">
<title>recv_l6_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5419.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5419.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E7</text>
<text text-anchor="middle" x="5419.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5419.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5419.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e7_gpu7 -->
<g id="edge468" class="edge">
<title>route_l6&#45;&gt;recv_l6_e7_gpu7</title>
<path fill="none" stroke="black" d="M5813.25,-12103.47C5738.71,-12084.91 5659.82,-12065.27 5592.37,-12048.47"/>
<polygon fill="black" stroke="black" points="5593.06,-12045.04 5582.51,-12046.02 5591.37,-12051.83 5593.06,-12045.04"/>
<text text-anchor="middle" x="5803.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l6_e8_gpu8 -->
<g id="node362" class="node">
<title>recv_l6_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6082.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6082.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E8</text>
<text text-anchor="middle" x="6082.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e8_gpu8 -->
<g id="edge472" class="edge">
<title>route_l6&#45;&gt;recv_l6_e8_gpu8</title>
<path fill="none" stroke="black" d="M6082.44,-12103.35C6082.44,-12089.97 6082.44,-12076.03 6082.44,-12063"/>
<polygon fill="black" stroke="black" points="6085.94,-12062.78 6082.44,-12052.78 6078.94,-12062.78 6085.94,-12062.78"/>
<text text-anchor="middle" x="6154.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l6_e9_gpu9 -->
<g id="node365" class="node">
<title>recv_l6_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6745.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6745.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E9</text>
<text text-anchor="middle" x="6745.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6745.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6745.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e9_gpu9 -->
<g id="edge476" class="edge">
<title>route_l6&#45;&gt;recv_l6_e9_gpu9</title>
<path fill="none" stroke="black" d="M6351.63,-12103.47C6426.17,-12084.91 6505.06,-12065.27 6572.51,-12048.47"/>
<polygon fill="black" stroke="black" points="6573.51,-12051.83 6582.37,-12046.02 6571.82,-12045.04 6573.51,-12051.83"/>
<text text-anchor="middle" x="6545.44" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l6_e10_gpu10 -->
<g id="node368" class="node">
<title>recv_l6_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7408.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7408.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E10</text>
<text text-anchor="middle" x="7408.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7408.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7408.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e10_gpu10 -->
<g id="edge480" class="edge">
<title>route_l6&#45;&gt;recv_l6_e10_gpu10</title>
<path fill="none" stroke="black" d="M6405.27,-12134.05C6599.83,-12111.62 6852.53,-12081.66 7076.44,-12052.5 7106.78,-12048.54 7138.66,-12044.23 7170.17,-12039.87"/>
<polygon fill="black" stroke="black" points="7170.96,-12043.29 7180.38,-12038.45 7169.99,-12036.36 7170.96,-12043.29"/>
<text text-anchor="middle" x="6990.94" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l6_e11_gpu11 -->
<g id="node371" class="node">
<title>recv_l6_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8071.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8071.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E11</text>
<text text-anchor="middle" x="8071.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8071.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8071.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e11_gpu11 -->
<g id="edge484" class="edge">
<title>route_l6&#45;&gt;recv_l6_e11_gpu11</title>
<path fill="none" stroke="black" d="M6431.79,-12152.72C6767.56,-12133.95 7289.01,-12100.42 7739.44,-12052.5 7771.44,-12049.09 7805.1,-12044.96 7838.22,-12040.58"/>
<polygon fill="black" stroke="black" points="7839.02,-12044 7848.47,-12039.21 7838.1,-12037.06 7839.02,-12044"/>
<text text-anchor="middle" x="7636.94" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l6_e12_gpu12 -->
<g id="node374" class="node">
<title>recv_l6_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8734.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8734.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E12</text>
<text text-anchor="middle" x="8734.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8734.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8734.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e12_gpu12 -->
<g id="edge488" class="edge">
<title>route_l6&#45;&gt;recv_l6_e12_gpu12</title>
<path fill="none" stroke="black" d="M6445.35,-12162.15C6902.61,-12149.31 7712.2,-12118.86 8402.44,-12052.5 8435.27,-12049.34 8469.83,-12045.27 8503.75,-12040.86"/>
<polygon fill="black" stroke="black" points="8504.32,-12044.31 8513.77,-12039.54 8503.4,-12037.37 8504.32,-12044.31"/>
<text text-anchor="middle" x="8228.94" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l6_e13_gpu13 -->
<g id="node377" class="node">
<title>recv_l6_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9397.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9397.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E13</text>
<text text-anchor="middle" x="9397.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9397.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9397.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e13_gpu13 -->
<g id="edge492" class="edge">
<title>route_l6&#45;&gt;recv_l6_e13_gpu13</title>
<path fill="none" stroke="black" d="M6438.76,-12157.5C6878.49,-12141.32 7649.1,-12112.51 8309.44,-12085.5 8645.48,-12071.75 8730.55,-12083.48 9065.44,-12052.5 9098.55,-12049.43 9133.41,-12045.39 9167.59,-12040.97"/>
<polygon fill="black" stroke="black" points="9168.23,-12044.41 9177.69,-12039.64 9167.32,-12037.47 9168.23,-12044.41"/>
<text text-anchor="middle" x="8894.94" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l6_e14_gpu14 -->
<g id="node380" class="node">
<title>recv_l6_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10060.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10060.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E14</text>
<text text-anchor="middle" x="10060.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10060.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10060.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e14_gpu14 -->
<g id="edge496" class="edge">
<title>route_l6&#45;&gt;recv_l6_e14_gpu14</title>
<path fill="none" stroke="black" d="M6444.16,-12161.54C6991.91,-12147.61 8064.53,-12118.84 8975.44,-12085.5 9310.2,-12073.24 9394.88,-12083.38 9728.44,-12052.5 9761.55,-12049.43 9796.41,-12045.39 9830.59,-12040.96"/>
<polygon fill="black" stroke="black" points="9831.23,-12044.41 9840.69,-12039.64 9830.32,-12037.47 9831.23,-12044.41"/>
<text text-anchor="middle" x="9558.94" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l6_e15_gpu15 -->
<g id="node383" class="node">
<title>recv_l6_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10723.44" cy="-12004.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10723.44" y="-12023.21" font-family="Times,serif" font-size="14.00">Token Receive L6E15</text>
<text text-anchor="middle" x="10723.44" y="-12008.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10723.44" y="-11993.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10723.44" y="-11978.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l6&#45;&gt;recv_l6_e15_gpu15 -->
<g id="edge500" class="edge">
<title>route_l6&#45;&gt;recv_l6_e15_gpu15</title>
<path fill="none" stroke="black" d="M6447.99,-12164.17C7092.66,-12152.47 8473.79,-12125 9639.44,-12085.5 9973.79,-12074.17 10058.32,-12083.35 10391.44,-12052.5 10424.55,-12049.43 10459.41,-12045.39 10493.59,-12040.96"/>
<polygon fill="black" stroke="black" points="10494.23,-12044.41 10503.69,-12039.64 10493.32,-12037.46 10494.23,-12044.41"/>
<text text-anchor="middle" x="10221.94" y="-12074.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l6_e0_gpu0 -->
<g id="node339" class="node">
<title>expert_l6_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1006.44,-11919.33 550.44,-11919.33 550.44,-11851.33 1006.44,-11851.33 1006.44,-11919.33"/>
<text text-anchor="middle" x="778.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E0</text>
<text text-anchor="middle" x="778.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="778.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="778.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l6_e0_gpu0&#45;&gt;expert_l6_e0_gpu0 -->
<g id="edge441" class="edge">
<title>recv_l6_e0_gpu0&#45;&gt;expert_l6_e0_gpu0</title>
<path fill="none" stroke="black" d="M778.44,-11956.13C778.44,-11947.38 778.44,-11938.27 778.44,-11929.65"/>
<polygon fill="black" stroke="black" points="781.94,-11929.41 778.44,-11919.41 774.94,-11929.41 781.94,-11929.41"/>
</g>
<!-- send_l6_e0_gpu0 -->
<g id="node340" class="node">
<title>send_l6_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="778.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="778.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E0</text>
<text text-anchor="middle" x="778.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="778.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="778.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l6_e0_gpu0&#45;&gt;send_l6_e0_gpu0 -->
<g id="edge442" class="edge">
<title>expert_l6_e0_gpu0&#45;&gt;send_l6_e0_gpu0</title>
<path fill="none" stroke="black" d="M778.44,-11851.09C778.44,-11842.84 778.44,-11833.76 778.44,-11824.71"/>
<polygon fill="black" stroke="black" points="781.94,-11824.55 778.44,-11814.55 774.94,-11824.55 781.94,-11824.55"/>
</g>
<!-- agg_l6 -->
<g id="node386" class="node">
<title>agg_l6</title>
<polygon fill="lightgray" stroke="black" points="6560.33,-11681.16 5800.12,-11681.16 5604.55,-11545.16 6364.76,-11545.16 6560.33,-11681.16"/>
<text text-anchor="middle" x="6082.44" y="-11631.96" font-family="Times,serif" font-size="14.00">Expert Aggregation L6</text>
<text text-anchor="middle" x="6082.44" y="-11616.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11601.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11586.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l6_e0_gpu0&#45;&gt;agg_l6 -->
<g id="edge443" class="edge">
<title>send_l6_e0_gpu0&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M995.45,-11730.66C1033.68,-11725.66 1073.16,-11721.19 1110.44,-11718.16 1998.88,-11646.14 4688.64,-11622.64 5696.01,-11616.25"/>
<polygon fill="black" stroke="black" points="5696.34,-11619.75 5706.32,-11616.18 5696.29,-11612.75 5696.34,-11619.75"/>
</g>
<!-- expert_l6_e1_gpu1 -->
<g id="node342" class="node">
<title>expert_l6_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1669.44,-11919.33 1213.44,-11919.33 1213.44,-11851.33 1669.44,-11851.33 1669.44,-11919.33"/>
<text text-anchor="middle" x="1441.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E1</text>
<text text-anchor="middle" x="1441.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1441.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1441.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l6_e1_gpu1&#45;&gt;expert_l6_e1_gpu1 -->
<g id="edge445" class="edge">
<title>recv_l6_e1_gpu1&#45;&gt;expert_l6_e1_gpu1</title>
<path fill="none" stroke="black" d="M1441.44,-11956.13C1441.44,-11947.38 1441.44,-11938.27 1441.44,-11929.65"/>
<polygon fill="black" stroke="black" points="1444.94,-11929.41 1441.44,-11919.41 1437.94,-11929.41 1444.94,-11929.41"/>
</g>
<!-- send_l6_e1_gpu1 -->
<g id="node343" class="node">
<title>send_l6_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1441.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1441.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E1</text>
<text text-anchor="middle" x="1441.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1441.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1441.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l6_e1_gpu1&#45;&gt;send_l6_e1_gpu1 -->
<g id="edge446" class="edge">
<title>expert_l6_e1_gpu1&#45;&gt;send_l6_e1_gpu1</title>
<path fill="none" stroke="black" d="M1441.44,-11851.09C1441.44,-11842.84 1441.44,-11833.76 1441.44,-11824.71"/>
<polygon fill="black" stroke="black" points="1444.94,-11824.55 1441.44,-11814.55 1437.94,-11824.55 1444.94,-11824.55"/>
</g>
<!-- send_l6_e1_gpu1&#45;&gt;agg_l6 -->
<g id="edge447" class="edge">
<title>send_l6_e1_gpu1&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M1658.91,-11730.7C1696.99,-11725.71 1736.31,-11721.23 1773.44,-11718.16 2529.27,-11655.66 4789.64,-11626.94 5698.13,-11617.68"/>
<polygon fill="black" stroke="black" points="5698.46,-11621.18 5708.42,-11617.58 5698.39,-11614.18 5698.46,-11621.18"/>
</g>
<!-- expert_l6_e2_gpu2 -->
<g id="node345" class="node">
<title>expert_l6_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2332.44,-11919.33 1876.44,-11919.33 1876.44,-11851.33 2332.44,-11851.33 2332.44,-11919.33"/>
<text text-anchor="middle" x="2104.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E2</text>
<text text-anchor="middle" x="2104.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2104.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2104.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l6_e2_gpu2&#45;&gt;expert_l6_e2_gpu2 -->
<g id="edge449" class="edge">
<title>recv_l6_e2_gpu2&#45;&gt;expert_l6_e2_gpu2</title>
<path fill="none" stroke="black" d="M2104.44,-11956.13C2104.44,-11947.38 2104.44,-11938.27 2104.44,-11929.65"/>
<polygon fill="black" stroke="black" points="2107.94,-11929.41 2104.44,-11919.41 2100.94,-11929.41 2107.94,-11929.41"/>
</g>
<!-- send_l6_e2_gpu2 -->
<g id="node346" class="node">
<title>send_l6_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2104.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2104.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E2</text>
<text text-anchor="middle" x="2104.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2104.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2104.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l6_e2_gpu2&#45;&gt;send_l6_e2_gpu2 -->
<g id="edge450" class="edge">
<title>expert_l6_e2_gpu2&#45;&gt;send_l6_e2_gpu2</title>
<path fill="none" stroke="black" d="M2104.44,-11851.09C2104.44,-11842.84 2104.44,-11833.76 2104.44,-11824.71"/>
<polygon fill="black" stroke="black" points="2107.94,-11824.55 2104.44,-11814.55 2100.94,-11824.55 2107.94,-11824.55"/>
</g>
<!-- send_l6_e2_gpu2&#45;&gt;agg_l6 -->
<g id="edge451" class="edge">
<title>send_l6_e2_gpu2&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M2322.36,-11730.78C2360.31,-11725.8 2399.46,-11721.3 2436.44,-11718.16 3060.79,-11665.16 4898.71,-11631.95 5700.78,-11619.61"/>
<polygon fill="black" stroke="black" points="5701.1,-11623.11 5711.05,-11619.45 5700.99,-11616.11 5701.1,-11623.11"/>
</g>
<!-- expert_l6_e3_gpu3 -->
<g id="node348" class="node">
<title>expert_l6_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="2995.44,-11919.33 2539.44,-11919.33 2539.44,-11851.33 2995.44,-11851.33 2995.44,-11919.33"/>
<text text-anchor="middle" x="2767.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E3</text>
<text text-anchor="middle" x="2767.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2767.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2767.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l6_e3_gpu3&#45;&gt;expert_l6_e3_gpu3 -->
<g id="edge453" class="edge">
<title>recv_l6_e3_gpu3&#45;&gt;expert_l6_e3_gpu3</title>
<path fill="none" stroke="black" d="M2767.44,-11956.13C2767.44,-11947.38 2767.44,-11938.27 2767.44,-11929.65"/>
<polygon fill="black" stroke="black" points="2770.94,-11929.41 2767.44,-11919.41 2763.94,-11929.41 2770.94,-11929.41"/>
</g>
<!-- send_l6_e3_gpu3 -->
<g id="node349" class="node">
<title>send_l6_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2767.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2767.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E3</text>
<text text-anchor="middle" x="2767.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2767.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2767.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l6_e3_gpu3&#45;&gt;send_l6_e3_gpu3 -->
<g id="edge454" class="edge">
<title>expert_l6_e3_gpu3&#45;&gt;send_l6_e3_gpu3</title>
<path fill="none" stroke="black" d="M2767.44,-11851.09C2767.44,-11842.84 2767.44,-11833.76 2767.44,-11824.71"/>
<polygon fill="black" stroke="black" points="2770.94,-11824.55 2767.44,-11814.55 2763.94,-11824.55 2770.94,-11824.55"/>
</g>
<!-- send_l6_e3_gpu3&#45;&gt;agg_l6 -->
<g id="edge455" class="edge">
<title>send_l6_e3_gpu3&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M2986.27,-11730.86C3023.94,-11725.9 3062.76,-11721.4 3099.44,-11718.16 4027.8,-11636.38 5124,-11618.18 5694.04,-11614.59"/>
<polygon fill="black" stroke="black" points="5694.08,-11618.09 5704.06,-11614.53 5694.04,-11611.09 5694.08,-11618.09"/>
</g>
<!-- expert_l6_e4_gpu4 -->
<g id="node351" class="node">
<title>expert_l6_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3658.44,-11919.33 3202.44,-11919.33 3202.44,-11851.33 3658.44,-11851.33 3658.44,-11919.33"/>
<text text-anchor="middle" x="3430.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E4</text>
<text text-anchor="middle" x="3430.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3430.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3430.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l6_e4_gpu4&#45;&gt;expert_l6_e4_gpu4 -->
<g id="edge457" class="edge">
<title>recv_l6_e4_gpu4&#45;&gt;expert_l6_e4_gpu4</title>
<path fill="none" stroke="black" d="M3430.44,-11956.13C3430.44,-11947.38 3430.44,-11938.27 3430.44,-11929.65"/>
<polygon fill="black" stroke="black" points="3433.94,-11929.41 3430.44,-11919.41 3426.94,-11929.41 3433.94,-11929.41"/>
</g>
<!-- send_l6_e4_gpu4 -->
<g id="node352" class="node">
<title>send_l6_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3430.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3430.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E4</text>
<text text-anchor="middle" x="3430.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3430.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3430.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l6_e4_gpu4&#45;&gt;send_l6_e4_gpu4 -->
<g id="edge458" class="edge">
<title>expert_l6_e4_gpu4&#45;&gt;send_l6_e4_gpu4</title>
<path fill="none" stroke="black" d="M3430.44,-11851.09C3430.44,-11842.84 3430.44,-11833.76 3430.44,-11824.71"/>
<polygon fill="black" stroke="black" points="3433.94,-11824.55 3430.44,-11814.55 3426.94,-11824.55 3433.94,-11824.55"/>
</g>
<!-- send_l6_e4_gpu4&#45;&gt;agg_l6 -->
<g id="edge459" class="edge">
<title>send_l6_e4_gpu4&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M3650.2,-11731.05C3687.58,-11726.11 3726.07,-11721.55 3762.44,-11718.16 4443.76,-11654.73 5241.37,-11629.69 5701.64,-11620.02"/>
<polygon fill="black" stroke="black" points="5701.85,-11623.52 5711.77,-11619.81 5701.7,-11616.52 5701.85,-11623.52"/>
</g>
<!-- expert_l6_e5_gpu5 -->
<g id="node354" class="node">
<title>expert_l6_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4321.44,-11919.33 3865.44,-11919.33 3865.44,-11851.33 4321.44,-11851.33 4321.44,-11919.33"/>
<text text-anchor="middle" x="4093.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E5</text>
<text text-anchor="middle" x="4093.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4093.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4093.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l6_e5_gpu5&#45;&gt;expert_l6_e5_gpu5 -->
<g id="edge461" class="edge">
<title>recv_l6_e5_gpu5&#45;&gt;expert_l6_e5_gpu5</title>
<path fill="none" stroke="black" d="M4093.44,-11956.13C4093.44,-11947.38 4093.44,-11938.27 4093.44,-11929.65"/>
<polygon fill="black" stroke="black" points="4096.94,-11929.41 4093.44,-11919.41 4089.94,-11929.41 4096.94,-11929.41"/>
</g>
<!-- send_l6_e5_gpu5 -->
<g id="node355" class="node">
<title>send_l6_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4093.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4093.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E5</text>
<text text-anchor="middle" x="4093.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4093.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4093.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l6_e5_gpu5&#45;&gt;send_l6_e5_gpu5 -->
<g id="edge462" class="edge">
<title>expert_l6_e5_gpu5&#45;&gt;send_l6_e5_gpu5</title>
<path fill="none" stroke="black" d="M4093.44,-11851.09C4093.44,-11842.84 4093.44,-11833.76 4093.44,-11824.71"/>
<polygon fill="black" stroke="black" points="4096.94,-11824.55 4093.44,-11814.55 4089.94,-11824.55 4096.94,-11824.55"/>
</g>
<!-- send_l6_e5_gpu5&#45;&gt;agg_l6 -->
<g id="edge463" class="edge">
<title>send_l6_e5_gpu5&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M4315.49,-11731.31C4352.16,-11726.41 4389.82,-11721.8 4425.44,-11718.16 4867.29,-11673.04 5377.57,-11644.56 5713.81,-11629.03"/>
<polygon fill="black" stroke="black" points="5714.38,-11632.51 5724.2,-11628.55 5714.05,-11625.52 5714.38,-11632.51"/>
</g>
<!-- expert_l6_e6_gpu6 -->
<g id="node357" class="node">
<title>expert_l6_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="4984.44,-11919.33 4528.44,-11919.33 4528.44,-11851.33 4984.44,-11851.33 4984.44,-11919.33"/>
<text text-anchor="middle" x="4756.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E6</text>
<text text-anchor="middle" x="4756.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4756.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4756.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l6_e6_gpu6&#45;&gt;expert_l6_e6_gpu6 -->
<g id="edge465" class="edge">
<title>recv_l6_e6_gpu6&#45;&gt;expert_l6_e6_gpu6</title>
<path fill="none" stroke="black" d="M4756.44,-11956.13C4756.44,-11947.38 4756.44,-11938.27 4756.44,-11929.65"/>
<polygon fill="black" stroke="black" points="4759.94,-11929.41 4756.44,-11919.41 4752.94,-11929.41 4759.94,-11929.41"/>
</g>
<!-- send_l6_e6_gpu6 -->
<g id="node358" class="node">
<title>send_l6_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4756.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4756.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E6</text>
<text text-anchor="middle" x="4756.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4756.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4756.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l6_e6_gpu6&#45;&gt;send_l6_e6_gpu6 -->
<g id="edge466" class="edge">
<title>expert_l6_e6_gpu6&#45;&gt;send_l6_e6_gpu6</title>
<path fill="none" stroke="black" d="M4756.44,-11851.09C4756.44,-11842.84 4756.44,-11833.76 4756.44,-11824.71"/>
<polygon fill="black" stroke="black" points="4759.94,-11824.55 4756.44,-11814.55 4752.94,-11824.55 4759.94,-11824.55"/>
</g>
<!-- send_l6_e6_gpu6&#45;&gt;agg_l6 -->
<g id="edge467" class="edge">
<title>send_l6_e6_gpu6&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M4983.1,-11731.97C5018.34,-11727.13 5054.35,-11722.36 5088.44,-11718.16 5304.57,-11691.54 5547.69,-11666.03 5739.39,-11646.93"/>
<polygon fill="black" stroke="black" points="5739.74,-11650.41 5749.34,-11645.94 5739.05,-11643.45 5739.74,-11650.41"/>
</g>
<!-- expert_l6_e7_gpu7 -->
<g id="node360" class="node">
<title>expert_l6_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5647.44,-11919.33 5191.44,-11919.33 5191.44,-11851.33 5647.44,-11851.33 5647.44,-11919.33"/>
<text text-anchor="middle" x="5419.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E7</text>
<text text-anchor="middle" x="5419.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5419.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5419.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l6_e7_gpu7&#45;&gt;expert_l6_e7_gpu7 -->
<g id="edge469" class="edge">
<title>recv_l6_e7_gpu7&#45;&gt;expert_l6_e7_gpu7</title>
<path fill="none" stroke="black" d="M5419.44,-11956.13C5419.44,-11947.38 5419.44,-11938.27 5419.44,-11929.65"/>
<polygon fill="black" stroke="black" points="5422.94,-11929.41 5419.44,-11919.41 5415.94,-11929.41 5422.94,-11929.41"/>
</g>
<!-- send_l6_e7_gpu7 -->
<g id="node361" class="node">
<title>send_l6_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5419.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5419.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E7</text>
<text text-anchor="middle" x="5419.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5419.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5419.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l6_e7_gpu7&#45;&gt;send_l6_e7_gpu7 -->
<g id="edge470" class="edge">
<title>expert_l6_e7_gpu7&#45;&gt;send_l6_e7_gpu7</title>
<path fill="none" stroke="black" d="M5419.44,-11851.09C5419.44,-11842.84 5419.44,-11833.76 5419.44,-11824.71"/>
<polygon fill="black" stroke="black" points="5422.94,-11824.55 5419.44,-11814.55 5415.94,-11824.55 5422.94,-11824.55"/>
</g>
<!-- send_l6_e7_gpu7&#45;&gt;agg_l6 -->
<g id="edge471" class="edge">
<title>send_l6_e7_gpu7&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M5593.2,-11725.65C5652.63,-11712.11 5720.87,-11696.56 5787.16,-11681.45"/>
<polygon fill="black" stroke="black" points="5787.95,-11684.86 5796.92,-11679.23 5786.39,-11678.04 5787.95,-11684.86"/>
</g>
<!-- expert_l6_e8_gpu8 -->
<g id="node363" class="node">
<title>expert_l6_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6310.44,-11919.33 5854.44,-11919.33 5854.44,-11851.33 6310.44,-11851.33 6310.44,-11919.33"/>
<text text-anchor="middle" x="6082.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E8</text>
<text text-anchor="middle" x="6082.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l6_e8_gpu8&#45;&gt;expert_l6_e8_gpu8 -->
<g id="edge473" class="edge">
<title>recv_l6_e8_gpu8&#45;&gt;expert_l6_e8_gpu8</title>
<path fill="none" stroke="black" d="M6082.44,-11956.13C6082.44,-11947.38 6082.44,-11938.27 6082.44,-11929.65"/>
<polygon fill="black" stroke="black" points="6085.94,-11929.41 6082.44,-11919.41 6078.94,-11929.41 6085.94,-11929.41"/>
</g>
<!-- send_l6_e8_gpu8 -->
<g id="node364" class="node">
<title>send_l6_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6082.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6082.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E8</text>
<text text-anchor="middle" x="6082.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6082.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l6_e8_gpu8&#45;&gt;send_l6_e8_gpu8 -->
<g id="edge474" class="edge">
<title>expert_l6_e8_gpu8&#45;&gt;send_l6_e8_gpu8</title>
<path fill="none" stroke="black" d="M6082.44,-11851.09C6082.44,-11842.84 6082.44,-11833.76 6082.44,-11824.71"/>
<polygon fill="black" stroke="black" points="6085.94,-11824.55 6082.44,-11814.55 6078.94,-11824.55 6085.94,-11824.55"/>
</g>
<!-- send_l6_e8_gpu8&#45;&gt;agg_l6 -->
<g id="edge475" class="edge">
<title>send_l6_e8_gpu8&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M6082.44,-11717.86C6082.44,-11709.43 6082.44,-11700.46 6082.44,-11691.46"/>
<polygon fill="black" stroke="black" points="6085.94,-11691.31 6082.44,-11681.31 6078.94,-11691.31 6085.94,-11691.31"/>
</g>
<!-- expert_l6_e9_gpu9 -->
<g id="node366" class="node">
<title>expert_l6_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="6973.44,-11919.33 6517.44,-11919.33 6517.44,-11851.33 6973.44,-11851.33 6973.44,-11919.33"/>
<text text-anchor="middle" x="6745.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E9</text>
<text text-anchor="middle" x="6745.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6745.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6745.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l6_e9_gpu9&#45;&gt;expert_l6_e9_gpu9 -->
<g id="edge477" class="edge">
<title>recv_l6_e9_gpu9&#45;&gt;expert_l6_e9_gpu9</title>
<path fill="none" stroke="black" d="M6745.44,-11956.13C6745.44,-11947.38 6745.44,-11938.27 6745.44,-11929.65"/>
<polygon fill="black" stroke="black" points="6748.94,-11929.41 6745.44,-11919.41 6741.94,-11929.41 6748.94,-11929.41"/>
</g>
<!-- send_l6_e9_gpu9 -->
<g id="node367" class="node">
<title>send_l6_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6745.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6745.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E9</text>
<text text-anchor="middle" x="6745.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6745.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6745.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l6_e9_gpu9&#45;&gt;send_l6_e9_gpu9 -->
<g id="edge478" class="edge">
<title>expert_l6_e9_gpu9&#45;&gt;send_l6_e9_gpu9</title>
<path fill="none" stroke="black" d="M6745.44,-11851.09C6745.44,-11842.84 6745.44,-11833.76 6745.44,-11824.71"/>
<polygon fill="black" stroke="black" points="6748.94,-11824.55 6745.44,-11814.55 6741.94,-11824.55 6748.94,-11824.55"/>
</g>
<!-- send_l6_e9_gpu9&#45;&gt;agg_l6 -->
<g id="edge479" class="edge">
<title>send_l6_e9_gpu9&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M6571.68,-11725.65C6514.84,-11712.7 6449.93,-11697.91 6386.39,-11683.43"/>
<polygon fill="black" stroke="black" points="6387.14,-11680.01 6376.61,-11681.2 6385.59,-11686.83 6387.14,-11680.01"/>
</g>
<!-- expert_l6_e10_gpu10 -->
<g id="node369" class="node">
<title>expert_l6_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7636.44,-11919.33 7180.44,-11919.33 7180.44,-11851.33 7636.44,-11851.33 7636.44,-11919.33"/>
<text text-anchor="middle" x="7408.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E10</text>
<text text-anchor="middle" x="7408.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7408.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7408.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l6_e10_gpu10&#45;&gt;expert_l6_e10_gpu10 -->
<g id="edge481" class="edge">
<title>recv_l6_e10_gpu10&#45;&gt;expert_l6_e10_gpu10</title>
<path fill="none" stroke="black" d="M7408.44,-11956.13C7408.44,-11947.38 7408.44,-11938.27 7408.44,-11929.65"/>
<polygon fill="black" stroke="black" points="7411.94,-11929.41 7408.44,-11919.41 7404.94,-11929.41 7411.94,-11929.41"/>
</g>
<!-- send_l6_e10_gpu10 -->
<g id="node370" class="node">
<title>send_l6_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7408.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7408.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E10</text>
<text text-anchor="middle" x="7408.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7408.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7408.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l6_e10_gpu10&#45;&gt;send_l6_e10_gpu10 -->
<g id="edge482" class="edge">
<title>expert_l6_e10_gpu10&#45;&gt;send_l6_e10_gpu10</title>
<path fill="none" stroke="black" d="M7408.44,-11851.09C7408.44,-11842.84 7408.44,-11833.76 7408.44,-11824.71"/>
<polygon fill="black" stroke="black" points="7411.94,-11824.55 7408.44,-11814.55 7404.94,-11824.55 7411.94,-11824.55"/>
</g>
<!-- send_l6_e10_gpu10&#45;&gt;agg_l6 -->
<g id="edge483" class="edge">
<title>send_l6_e10_gpu10&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M7181.78,-11731.97C7146.54,-11727.13 7110.53,-11722.36 7076.44,-11718.16 6900,-11696.43 6705.57,-11675.43 6535.81,-11658.07"/>
<polygon fill="black" stroke="black" points="6536,-11654.57 6525.69,-11657.03 6535.29,-11661.53 6536,-11654.57"/>
</g>
<!-- expert_l6_e11_gpu11 -->
<g id="node372" class="node">
<title>expert_l6_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8299.44,-11919.33 7843.44,-11919.33 7843.44,-11851.33 8299.44,-11851.33 8299.44,-11919.33"/>
<text text-anchor="middle" x="8071.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E11</text>
<text text-anchor="middle" x="8071.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8071.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8071.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l6_e11_gpu11&#45;&gt;expert_l6_e11_gpu11 -->
<g id="edge485" class="edge">
<title>recv_l6_e11_gpu11&#45;&gt;expert_l6_e11_gpu11</title>
<path fill="none" stroke="black" d="M8071.44,-11956.13C8071.44,-11947.38 8071.44,-11938.27 8071.44,-11929.65"/>
<polygon fill="black" stroke="black" points="8074.94,-11929.41 8071.44,-11919.41 8067.94,-11929.41 8074.94,-11929.41"/>
</g>
<!-- send_l6_e11_gpu11 -->
<g id="node373" class="node">
<title>send_l6_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8071.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8071.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E11</text>
<text text-anchor="middle" x="8071.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8071.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8071.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l6_e11_gpu11&#45;&gt;send_l6_e11_gpu11 -->
<g id="edge486" class="edge">
<title>expert_l6_e11_gpu11&#45;&gt;send_l6_e11_gpu11</title>
<path fill="none" stroke="black" d="M8071.44,-11851.09C8071.44,-11842.84 8071.44,-11833.76 8071.44,-11824.71"/>
<polygon fill="black" stroke="black" points="8074.94,-11824.55 8071.44,-11814.55 8067.94,-11824.55 8074.94,-11824.55"/>
</g>
<!-- send_l6_e11_gpu11&#45;&gt;agg_l6 -->
<g id="edge487" class="edge">
<title>send_l6_e11_gpu11&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M7849.4,-11731.31C7812.72,-11726.41 7775.06,-11721.8 7739.44,-11718.16 7317.81,-11675.1 6833.87,-11647.2 6498.31,-11631.24"/>
<polygon fill="black" stroke="black" points="6498.08,-11627.73 6487.92,-11630.75 6497.75,-11634.72 6498.08,-11627.73"/>
</g>
<!-- expert_l6_e12_gpu12 -->
<g id="node375" class="node">
<title>expert_l6_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="8962.44,-11919.33 8506.44,-11919.33 8506.44,-11851.33 8962.44,-11851.33 8962.44,-11919.33"/>
<text text-anchor="middle" x="8734.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E12</text>
<text text-anchor="middle" x="8734.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8734.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8734.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l6_e12_gpu12&#45;&gt;expert_l6_e12_gpu12 -->
<g id="edge489" class="edge">
<title>recv_l6_e12_gpu12&#45;&gt;expert_l6_e12_gpu12</title>
<path fill="none" stroke="black" d="M8734.44,-11956.13C8734.44,-11947.38 8734.44,-11938.27 8734.44,-11929.65"/>
<polygon fill="black" stroke="black" points="8737.94,-11929.41 8734.44,-11919.41 8730.94,-11929.41 8737.94,-11929.41"/>
</g>
<!-- send_l6_e12_gpu12 -->
<g id="node376" class="node">
<title>send_l6_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8734.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8734.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E12</text>
<text text-anchor="middle" x="8734.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8734.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8734.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l6_e12_gpu12&#45;&gt;send_l6_e12_gpu12 -->
<g id="edge490" class="edge">
<title>expert_l6_e12_gpu12&#45;&gt;send_l6_e12_gpu12</title>
<path fill="none" stroke="black" d="M8734.44,-11851.09C8734.44,-11842.84 8734.44,-11833.76 8734.44,-11824.71"/>
<polygon fill="black" stroke="black" points="8737.94,-11824.55 8734.44,-11814.55 8730.94,-11824.55 8737.94,-11824.55"/>
</g>
<!-- send_l6_e12_gpu12&#45;&gt;agg_l6 -->
<g id="edge491" class="edge">
<title>send_l6_e12_gpu12&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M8516.51,-11730.81C8478.57,-11725.82 8439.42,-11721.32 8402.44,-11718.16 8130.42,-11694.96 8061.23,-11711.04 7788.44,-11700.16 7351.97,-11682.77 6852.98,-11656.92 6507.91,-11638.1"/>
<polygon fill="black" stroke="black" points="6507.92,-11634.6 6497.75,-11637.55 6507.54,-11641.59 6507.92,-11634.6"/>
</g>
<!-- expert_l6_e13_gpu13 -->
<g id="node378" class="node">
<title>expert_l6_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9625.44,-11919.33 9169.44,-11919.33 9169.44,-11851.33 9625.44,-11851.33 9625.44,-11919.33"/>
<text text-anchor="middle" x="9397.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E13</text>
<text text-anchor="middle" x="9397.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9397.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9397.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l6_e13_gpu13&#45;&gt;expert_l6_e13_gpu13 -->
<g id="edge493" class="edge">
<title>recv_l6_e13_gpu13&#45;&gt;expert_l6_e13_gpu13</title>
<path fill="none" stroke="black" d="M9397.44,-11956.13C9397.44,-11947.38 9397.44,-11938.27 9397.44,-11929.65"/>
<polygon fill="black" stroke="black" points="9400.94,-11929.41 9397.44,-11919.41 9393.94,-11929.41 9400.94,-11929.41"/>
</g>
<!-- send_l6_e13_gpu13 -->
<g id="node379" class="node">
<title>send_l6_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9397.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9397.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E13</text>
<text text-anchor="middle" x="9397.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9397.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9397.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l6_e13_gpu13&#45;&gt;send_l6_e13_gpu13 -->
<g id="edge494" class="edge">
<title>expert_l6_e13_gpu13&#45;&gt;send_l6_e13_gpu13</title>
<path fill="none" stroke="black" d="M9397.44,-11851.09C9397.44,-11842.84 9397.44,-11833.76 9397.44,-11824.71"/>
<polygon fill="black" stroke="black" points="9400.94,-11824.55 9397.44,-11814.55 9393.94,-11824.55 9400.94,-11824.55"/>
</g>
<!-- send_l6_e13_gpu13&#45;&gt;agg_l6 -->
<g id="edge495" class="edge">
<title>send_l6_e13_gpu13&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M9178.61,-11730.86C9140.94,-11725.9 9102.12,-11721.4 9065.44,-11718.16 8139.16,-11636.57 7045.8,-11618.26 6474.69,-11614.61"/>
<polygon fill="black" stroke="black" points="6474.67,-11611.11 6464.65,-11614.55 6474.63,-11618.11 6474.67,-11611.11"/>
</g>
<!-- expert_l6_e14_gpu14 -->
<g id="node381" class="node">
<title>expert_l6_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10288.44,-11919.33 9832.44,-11919.33 9832.44,-11851.33 10288.44,-11851.33 10288.44,-11919.33"/>
<text text-anchor="middle" x="10060.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E14</text>
<text text-anchor="middle" x="10060.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10060.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10060.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l6_e14_gpu14&#45;&gt;expert_l6_e14_gpu14 -->
<g id="edge497" class="edge">
<title>recv_l6_e14_gpu14&#45;&gt;expert_l6_e14_gpu14</title>
<path fill="none" stroke="black" d="M10060.44,-11956.13C10060.44,-11947.38 10060.44,-11938.27 10060.44,-11929.65"/>
<polygon fill="black" stroke="black" points="10063.94,-11929.41 10060.44,-11919.41 10056.94,-11929.41 10063.94,-11929.41"/>
</g>
<!-- send_l6_e14_gpu14 -->
<g id="node382" class="node">
<title>send_l6_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10060.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10060.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E14</text>
<text text-anchor="middle" x="10060.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10060.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10060.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l6_e14_gpu14&#45;&gt;send_l6_e14_gpu14 -->
<g id="edge498" class="edge">
<title>expert_l6_e14_gpu14&#45;&gt;send_l6_e14_gpu14</title>
<path fill="none" stroke="black" d="M10060.44,-11851.09C10060.44,-11842.84 10060.44,-11833.76 10060.44,-11824.71"/>
<polygon fill="black" stroke="black" points="10063.94,-11824.55 10060.44,-11814.55 10056.94,-11824.55 10063.94,-11824.55"/>
</g>
<!-- send_l6_e14_gpu14&#45;&gt;agg_l6 -->
<g id="edge499" class="edge">
<title>send_l6_e14_gpu14&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M9842.52,-11730.78C9804.57,-11725.8 9765.42,-11721.3 9728.44,-11718.16 9108.73,-11665.55 7293.4,-11632.45 6482.14,-11619.89"/>
<polygon fill="black" stroke="black" points="6482.1,-11616.39 6472.05,-11619.73 6481.99,-11623.39 6482.1,-11616.39"/>
</g>
<!-- expert_l6_e15_gpu15 -->
<g id="node384" class="node">
<title>expert_l6_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="10951.44,-11919.33 10495.44,-11919.33 10495.44,-11851.33 10951.44,-11851.33 10951.44,-11919.33"/>
<text text-anchor="middle" x="10723.44" y="-11904.13" font-family="Times,serif" font-size="14.00">Expert L6E15</text>
<text text-anchor="middle" x="10723.44" y="-11889.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10723.44" y="-11874.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10723.44" y="-11859.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l6_e15_gpu15&#45;&gt;expert_l6_e15_gpu15 -->
<g id="edge501" class="edge">
<title>recv_l6_e15_gpu15&#45;&gt;expert_l6_e15_gpu15</title>
<path fill="none" stroke="black" d="M10723.44,-11956.13C10723.44,-11947.38 10723.44,-11938.27 10723.44,-11929.65"/>
<polygon fill="black" stroke="black" points="10726.94,-11929.41 10723.44,-11919.41 10719.94,-11929.41 10726.94,-11929.41"/>
</g>
<!-- send_l6_e15_gpu15 -->
<g id="node385" class="node">
<title>send_l6_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10723.44" cy="-11766.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10723.44" y="-11785.05" font-family="Times,serif" font-size="14.00">Token Send L6E15</text>
<text text-anchor="middle" x="10723.44" y="-11770.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10723.44" y="-11755.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10723.44" y="-11740.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l6_e15_gpu15&#45;&gt;send_l6_e15_gpu15 -->
<g id="edge502" class="edge">
<title>expert_l6_e15_gpu15&#45;&gt;send_l6_e15_gpu15</title>
<path fill="none" stroke="black" d="M10723.44,-11851.09C10723.44,-11842.84 10723.44,-11833.76 10723.44,-11824.71"/>
<polygon fill="black" stroke="black" points="10726.94,-11824.55 10723.44,-11814.55 10719.94,-11824.55 10726.94,-11824.55"/>
</g>
<!-- send_l6_e15_gpu15&#45;&gt;agg_l6 -->
<g id="edge503" class="edge">
<title>send_l6_e15_gpu15&#45;&gt;agg_l6</title>
<path fill="none" stroke="black" d="M10505.97,-11730.7C10467.89,-11725.71 10428.57,-11721.23 10391.44,-11718.16 9639.12,-11655.95 7396.18,-11627.2 6479.48,-11617.81"/>
<polygon fill="black" stroke="black" points="6479.46,-11614.31 6469.43,-11617.71 6479.39,-11621.31 6479.46,-11614.31"/>
</g>
<!-- residual2_l6 -->
<g id="node387" class="node">
<title>residual2_l6</title>
<polygon fill="lightpink" stroke="black" points="6318.94,-11508.16 5883.94,-11508.16 5883.94,-11440.16 6318.94,-11440.16 6318.94,-11508.16"/>
<text text-anchor="middle" x="6101.44" y="-11492.96" font-family="Times,serif" font-size="14.00">ResidualAdd L6</text>
<text text-anchor="middle" x="6101.44" y="-11477.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6101.44" y="-11462.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6101.44" y="-11447.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l6&#45;&gt;residual2_l6 -->
<g id="edge504" class="edge">
<title>agg_l6&#45;&gt;residual2_l6</title>
<path fill="none" stroke="black" d="M6091.77,-11544.87C6093.03,-11535.82 6094.29,-11526.75 6095.46,-11518.28"/>
<polygon fill="black" stroke="black" points="6098.94,-11518.68 6096.85,-11508.29 6092.01,-11517.72 6098.94,-11518.68"/>
</g>
<!-- residual2_l6&#45;&gt;ln1_l7 -->
<g id="edge505" class="edge">
<title>residual2_l6&#45;&gt;ln1_l7</title>
<path fill="none" stroke="black" d="M6119.79,-11440.01C6124.72,-11431.09 6130.12,-11421.34 6135.28,-11412.02"/>
<polygon fill="black" stroke="black" points="6138.35,-11413.7 6140.13,-11403.26 6132.22,-11410.31 6138.35,-11413.7"/>
</g>
<!-- attn_l7 -->
<g id="node389" class="node">
<title>attn_l7</title>
<polygon fill="lightcoral" stroke="black" points="6388.44,-11298.16 5928.44,-11298.16 5928.44,-11230.16 6388.44,-11230.16 6388.44,-11298.16"/>
<text text-anchor="middle" x="6158.44" y="-11282.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L7</text>
<text text-anchor="middle" x="6158.44" y="-11267.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6158.44" y="-11252.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11237.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l7&#45;&gt;attn_l7 -->
<g id="edge508" class="edge">
<title>ln1_l7&#45;&gt;attn_l7</title>
<path fill="none" stroke="black" d="M6158.44,-11335.01C6158.44,-11326.55 6158.44,-11317.34 6158.44,-11308.46"/>
<polygon fill="black" stroke="black" points="6161.94,-11308.26 6158.44,-11298.26 6154.94,-11308.26 6161.94,-11308.26"/>
</g>
<!-- residual1_l7 -->
<g id="node390" class="node">
<title>residual1_l7</title>
<polygon fill="lightpink" stroke="black" points="6375.94,-11193.16 5940.94,-11193.16 5940.94,-11125.16 6375.94,-11125.16 6375.94,-11193.16"/>
<text text-anchor="middle" x="6158.44" y="-11177.96" font-family="Times,serif" font-size="14.00">ResidualAdd L7</text>
<text text-anchor="middle" x="6158.44" y="-11162.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11147.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11132.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l7&#45;&gt;residual1_l7 -->
<g id="edge509" class="edge">
<title>attn_l7&#45;&gt;residual1_l7</title>
<path fill="none" stroke="black" d="M6158.44,-11230.01C6158.44,-11221.55 6158.44,-11212.34 6158.44,-11203.46"/>
<polygon fill="black" stroke="black" points="6161.94,-11203.26 6158.44,-11193.26 6154.94,-11203.26 6161.94,-11203.26"/>
</g>
<!-- ln2_l7 -->
<g id="node391" class="node">
<title>ln2_l7</title>
<polygon fill="lightyellow" stroke="black" points="6375.94,-11088.16 5940.94,-11088.16 5940.94,-11020.16 6375.94,-11020.16 6375.94,-11088.16"/>
<text text-anchor="middle" x="6158.44" y="-11072.96" font-family="Times,serif" font-size="14.00">LayerNorm L7</text>
<text text-anchor="middle" x="6158.44" y="-11057.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11042.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-11027.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l7&#45;&gt;ln2_l7 -->
<g id="edge510" class="edge">
<title>residual1_l7&#45;&gt;ln2_l7</title>
<path fill="none" stroke="black" d="M6158.44,-11125.01C6158.44,-11116.55 6158.44,-11107.34 6158.44,-11098.46"/>
<polygon fill="black" stroke="black" points="6161.94,-11098.26 6158.44,-11088.26 6154.94,-11098.26 6161.94,-11098.26"/>
</g>
<!-- ln2_l7&#45;&gt;route_l7 -->
<g id="edge511" class="edge">
<title>ln2_l7&#45;&gt;route_l7</title>
<path fill="none" stroke="black" d="M6158.44,-11020C6158.44,-11011.86 6158.44,-11002.8 6158.44,-10993.52"/>
<polygon fill="black" stroke="black" points="6161.94,-10993.4 6158.44,-10983.4 6154.94,-10993.4 6161.94,-10993.4"/>
</g>
<!-- recv_l7_e0_gpu0 -->
<g id="node393" class="node">
<title>recv_l7_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="854.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="854.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E0</text>
<text text-anchor="middle" x="854.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="854.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="854.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e0_gpu0 -->
<g id="edge512" class="edge">
<title>route_l7&#45;&gt;recv_l7_e0_gpu0</title>
<path fill="none" stroke="black" d="M5774.34,-10909.47C5032.72,-10899.74 3352,-10874.41 1938.44,-10829.16 1604.07,-10818.46 1519.56,-10827.02 1186.44,-10796.16 1153.33,-10793.1 1118.48,-10789.06 1084.29,-10784.63"/>
<polygon fill="black" stroke="black" points="1084.56,-10781.13 1074.19,-10783.3 1083.65,-10788.07 1084.56,-10781.13"/>
<text text-anchor="middle" x="2010.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l7_e1_gpu1 -->
<g id="node396" class="node">
<title>recv_l7_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1517.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1517.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E1</text>
<text text-anchor="middle" x="1517.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1517.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1517.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e1_gpu1 -->
<g id="edge516" class="edge">
<title>route_l7&#45;&gt;recv_l7_e1_gpu1</title>
<path fill="none" stroke="black" d="M5771.4,-10907.29C5119.9,-10895.19 3762.87,-10867.64 2615.44,-10829.16 2274.87,-10817.74 2188.76,-10827.46 1849.44,-10796.16 1816.33,-10793.11 1781.47,-10789.08 1747.29,-10784.65"/>
<polygon fill="black" stroke="black" points="1747.56,-10781.16 1737.19,-10783.33 1746.65,-10788.1 1747.56,-10781.16"/>
<text text-anchor="middle" x="2687.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l7_e2_gpu2 -->
<g id="node399" class="node">
<title>recv_l7_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2180.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2180.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E2</text>
<text text-anchor="middle" x="2180.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2180.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2180.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e2_gpu2 -->
<g id="edge520" class="edge">
<title>route_l7&#45;&gt;recv_l7_e2_gpu2</title>
<path fill="none" stroke="black" d="M5767.09,-10904.29C5213.03,-10889.94 4168.24,-10861.46 3278.44,-10829.16 2937.9,-10816.8 2851.76,-10827.46 2512.44,-10796.16 2479.33,-10793.11 2444.47,-10789.08 2410.29,-10784.65"/>
<polygon fill="black" stroke="black" points="2410.56,-10781.16 2400.19,-10783.33 2409.65,-10788.1 2410.56,-10781.16"/>
<text text-anchor="middle" x="3350.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l7_e3_gpu3 -->
<g id="node402" class="node">
<title>recv_l7_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2843.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2843.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E3</text>
<text text-anchor="middle" x="2843.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2843.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2843.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e3_gpu3 -->
<g id="edge524" class="edge">
<title>route_l7&#45;&gt;recv_l7_e3_gpu3</title>
<path fill="none" stroke="black" d="M5760.18,-10899.46C5316.4,-10882.95 4577.54,-10855.06 3941.44,-10829.16 3600.96,-10815.3 3514.76,-10827.46 3175.44,-10796.16 3142.33,-10793.11 3107.47,-10789.08 3073.29,-10784.65"/>
<polygon fill="black" stroke="black" points="3073.56,-10781.16 3063.19,-10783.33 3072.65,-10788.1 3073.56,-10781.16"/>
<text text-anchor="middle" x="4013.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l7_e4_gpu4 -->
<g id="node405" class="node">
<title>recv_l7_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3506.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3506.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E4</text>
<text text-anchor="middle" x="3506.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3506.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3506.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e4_gpu4 -->
<g id="edge528" class="edge">
<title>route_l7&#45;&gt;recv_l7_e4_gpu4</title>
<path fill="none" stroke="black" d="M5768.2,-10905.04C5306.53,-10891.77 4515.13,-10861.22 3838.44,-10796.16 3805.61,-10793.01 3771.05,-10788.94 3737.13,-10784.52"/>
<polygon fill="black" stroke="black" points="3737.48,-10781.04 3727.11,-10783.21 3736.57,-10787.98 3737.48,-10781.04"/>
<text text-anchor="middle" x="4289.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l7_e5_gpu5 -->
<g id="node408" class="node">
<title>recv_l7_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4169.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4169.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E5</text>
<text text-anchor="middle" x="4169.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4169.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4169.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e5_gpu5 -->
<g id="edge532" class="edge">
<title>route_l7&#45;&gt;recv_l7_e5_gpu5</title>
<path fill="none" stroke="black" d="M5750.86,-10893.09C5415.03,-10873.81 4926.6,-10841.39 4501.44,-10796.16 4469.44,-10792.76 4435.78,-10788.63 4402.66,-10784.25"/>
<polygon fill="black" stroke="black" points="4402.78,-10780.73 4392.41,-10782.88 4401.86,-10787.67 4402.78,-10780.73"/>
<text text-anchor="middle" x="4890.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l7_e6_gpu6 -->
<g id="node411" class="node">
<title>recv_l7_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4832.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4832.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E6</text>
<text text-anchor="middle" x="4832.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4832.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4832.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e6_gpu6 -->
<g id="edge536" class="edge">
<title>route_l7&#45;&gt;recv_l7_e6_gpu6</title>
<path fill="none" stroke="black" d="M5708.2,-10862.91C5537.75,-10842.93 5342.04,-10819.3 5164.44,-10796.16 5134.1,-10792.21 5102.22,-10787.9 5070.71,-10783.54"/>
<polygon fill="black" stroke="black" points="5070.89,-10780.03 5060.5,-10782.12 5069.93,-10786.96 5070.89,-10780.03"/>
<text text-anchor="middle" x="5482.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l7_e7_gpu7 -->
<g id="node414" class="node">
<title>recv_l7_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5495.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5495.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E7</text>
<text text-anchor="middle" x="5495.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5495.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5495.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e7_gpu7 -->
<g id="edge540" class="edge">
<title>route_l7&#45;&gt;recv_l7_e7_gpu7</title>
<path fill="none" stroke="black" d="M5889.25,-10847.14C5814.71,-10828.58 5735.82,-10808.93 5668.37,-10792.14"/>
<polygon fill="black" stroke="black" points="5669.06,-10788.7 5658.51,-10789.68 5667.37,-10795.5 5669.06,-10788.7"/>
<text text-anchor="middle" x="5879.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l7_e8_gpu8 -->
<g id="node417" class="node">
<title>recv_l7_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6158.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6158.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E8</text>
<text text-anchor="middle" x="6158.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e8_gpu8 -->
<g id="edge544" class="edge">
<title>route_l7&#45;&gt;recv_l7_e8_gpu8</title>
<path fill="none" stroke="black" d="M6158.44,-10847.02C6158.44,-10833.64 6158.44,-10819.69 6158.44,-10806.67"/>
<polygon fill="black" stroke="black" points="6161.94,-10806.44 6158.44,-10796.44 6154.94,-10806.44 6161.94,-10806.44"/>
<text text-anchor="middle" x="6230.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l7_e9_gpu9 -->
<g id="node420" class="node">
<title>recv_l7_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6821.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6821.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E9</text>
<text text-anchor="middle" x="6821.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6821.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6821.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e9_gpu9 -->
<g id="edge548" class="edge">
<title>route_l7&#45;&gt;recv_l7_e9_gpu9</title>
<path fill="none" stroke="black" d="M6427.63,-10847.14C6502.17,-10828.58 6581.06,-10808.93 6648.51,-10792.14"/>
<polygon fill="black" stroke="black" points="6649.51,-10795.5 6658.37,-10789.68 6647.82,-10788.7 6649.51,-10795.5"/>
<text text-anchor="middle" x="6621.44" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l7_e10_gpu10 -->
<g id="node423" class="node">
<title>recv_l7_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7484.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7484.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E10</text>
<text text-anchor="middle" x="7484.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7484.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7484.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e10_gpu10 -->
<g id="edge552" class="edge">
<title>route_l7&#45;&gt;recv_l7_e10_gpu10</title>
<path fill="none" stroke="black" d="M6481.27,-10877.72C6675.83,-10855.29 6928.53,-10825.33 7152.44,-10796.16 7182.78,-10792.21 7214.66,-10787.9 7246.17,-10783.54"/>
<polygon fill="black" stroke="black" points="7246.96,-10786.96 7256.38,-10782.12 7245.99,-10780.03 7246.96,-10786.96"/>
<text text-anchor="middle" x="7066.94" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l7_e11_gpu11 -->
<g id="node426" class="node">
<title>recv_l7_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8147.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8147.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E11</text>
<text text-anchor="middle" x="8147.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8147.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8147.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e11_gpu11 -->
<g id="edge556" class="edge">
<title>route_l7&#45;&gt;recv_l7_e11_gpu11</title>
<path fill="none" stroke="black" d="M6507.79,-10896.38C6843.56,-10877.62 7365.01,-10844.08 7815.44,-10796.16 7847.44,-10792.76 7881.1,-10788.63 7914.22,-10784.25"/>
<polygon fill="black" stroke="black" points="7915.02,-10787.67 7924.47,-10782.88 7914.1,-10780.73 7915.02,-10787.67"/>
<text text-anchor="middle" x="7712.94" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l7_e12_gpu12 -->
<g id="node429" class="node">
<title>recv_l7_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8810.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8810.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E12</text>
<text text-anchor="middle" x="8810.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8810.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8810.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e12_gpu12 -->
<g id="edge560" class="edge">
<title>route_l7&#45;&gt;recv_l7_e12_gpu12</title>
<path fill="none" stroke="black" d="M6521.35,-10905.82C6978.61,-10892.97 7788.2,-10862.53 8478.44,-10796.16 8511.27,-10793.01 8545.83,-10788.94 8579.75,-10784.52"/>
<polygon fill="black" stroke="black" points="8580.32,-10787.98 8589.77,-10783.21 8579.4,-10781.04 8580.32,-10787.98"/>
<text text-anchor="middle" x="8304.94" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l7_e13_gpu13 -->
<g id="node432" class="node">
<title>recv_l7_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9473.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9473.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E13</text>
<text text-anchor="middle" x="9473.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9473.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9473.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e13_gpu13 -->
<g id="edge564" class="edge">
<title>route_l7&#45;&gt;recv_l7_e13_gpu13</title>
<path fill="none" stroke="black" d="M6514.76,-10901.17C6954.49,-10884.98 7725.1,-10856.18 8385.44,-10829.16 8721.48,-10815.42 8806.55,-10827.15 9141.44,-10796.16 9174.55,-10793.1 9209.41,-10789.06 9243.59,-10784.63"/>
<polygon fill="black" stroke="black" points="9244.23,-10788.08 9253.69,-10783.31 9243.32,-10781.14 9244.23,-10788.08"/>
<text text-anchor="middle" x="8970.94" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l7_e14_gpu14 -->
<g id="node435" class="node">
<title>recv_l7_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10136.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10136.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E14</text>
<text text-anchor="middle" x="10136.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10136.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10136.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e14_gpu14 -->
<g id="edge568" class="edge">
<title>route_l7&#45;&gt;recv_l7_e14_gpu14</title>
<path fill="none" stroke="black" d="M6520.16,-10905.21C7067.91,-10891.28 8140.53,-10862.5 9051.44,-10829.16 9386.2,-10816.91 9470.88,-10827.05 9804.44,-10796.16 9837.55,-10793.1 9872.41,-10789.06 9906.59,-10784.63"/>
<polygon fill="black" stroke="black" points="9907.23,-10788.07 9916.69,-10783.31 9906.32,-10781.13 9907.23,-10788.07"/>
<text text-anchor="middle" x="9634.94" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l7_e15_gpu15 -->
<g id="node438" class="node">
<title>recv_l7_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10799.44" cy="-10748.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10799.44" y="-10766.88" font-family="Times,serif" font-size="14.00">Token Receive L7E15</text>
<text text-anchor="middle" x="10799.44" y="-10751.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10799.44" y="-10736.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10799.44" y="-10721.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l7&#45;&gt;recv_l7_e15_gpu15 -->
<g id="edge572" class="edge">
<title>route_l7&#45;&gt;recv_l7_e15_gpu15</title>
<path fill="none" stroke="black" d="M6523.99,-10907.83C7168.66,-10896.14 8549.79,-10868.66 9715.44,-10829.16 10049.79,-10817.83 10134.32,-10827.02 10467.44,-10796.16 10500.55,-10793.1 10535.41,-10789.06 10569.59,-10784.63"/>
<polygon fill="black" stroke="black" points="10570.23,-10788.07 10579.69,-10783.3 10569.32,-10781.13 10570.23,-10788.07"/>
<text text-anchor="middle" x="10297.94" y="-10817.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l7_e0_gpu0 -->
<g id="node394" class="node">
<title>expert_l7_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1082.44,-10663 626.44,-10663 626.44,-10595 1082.44,-10595 1082.44,-10663"/>
<text text-anchor="middle" x="854.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E0</text>
<text text-anchor="middle" x="854.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="854.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="854.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l7_e0_gpu0&#45;&gt;expert_l7_e0_gpu0 -->
<g id="edge513" class="edge">
<title>recv_l7_e0_gpu0&#45;&gt;expert_l7_e0_gpu0</title>
<path fill="none" stroke="black" d="M854.44,-10699.8C854.44,-10691.04 854.44,-10681.94 854.44,-10673.31"/>
<polygon fill="black" stroke="black" points="857.94,-10673.08 854.44,-10663.08 850.94,-10673.08 857.94,-10673.08"/>
</g>
<!-- send_l7_e0_gpu0 -->
<g id="node395" class="node">
<title>send_l7_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="854.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="854.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E0</text>
<text text-anchor="middle" x="854.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="854.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="854.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l7_e0_gpu0&#45;&gt;send_l7_e0_gpu0 -->
<g id="edge514" class="edge">
<title>expert_l7_e0_gpu0&#45;&gt;send_l7_e0_gpu0</title>
<path fill="none" stroke="black" d="M854.44,-10594.76C854.44,-10586.51 854.44,-10577.42 854.44,-10568.38"/>
<polygon fill="black" stroke="black" points="857.94,-10568.22 854.44,-10558.22 850.94,-10568.22 857.94,-10568.22"/>
</g>
<!-- agg_l7 -->
<g id="node441" class="node">
<title>agg_l7</title>
<polygon fill="lightgray" stroke="black" points="6636.33,-10424.83 5876.12,-10424.83 5680.55,-10288.83 6440.76,-10288.83 6636.33,-10424.83"/>
<text text-anchor="middle" x="6158.44" y="-10375.63" font-family="Times,serif" font-size="14.00">Expert Aggregation L7</text>
<text text-anchor="middle" x="6158.44" y="-10360.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10345.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10330.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l7_e0_gpu0&#45;&gt;agg_l7 -->
<g id="edge515" class="edge">
<title>send_l7_e0_gpu0&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M1071.45,-10474.33C1109.68,-10469.32 1149.16,-10464.85 1186.44,-10461.83 2074.88,-10389.8 4764.64,-10366.31 5772.01,-10359.91"/>
<polygon fill="black" stroke="black" points="5772.34,-10363.41 5782.32,-10359.85 5772.29,-10356.41 5772.34,-10363.41"/>
</g>
<!-- expert_l7_e1_gpu1 -->
<g id="node397" class="node">
<title>expert_l7_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1745.44,-10663 1289.44,-10663 1289.44,-10595 1745.44,-10595 1745.44,-10663"/>
<text text-anchor="middle" x="1517.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E1</text>
<text text-anchor="middle" x="1517.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1517.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1517.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l7_e1_gpu1&#45;&gt;expert_l7_e1_gpu1 -->
<g id="edge517" class="edge">
<title>recv_l7_e1_gpu1&#45;&gt;expert_l7_e1_gpu1</title>
<path fill="none" stroke="black" d="M1517.44,-10699.8C1517.44,-10691.04 1517.44,-10681.94 1517.44,-10673.31"/>
<polygon fill="black" stroke="black" points="1520.94,-10673.08 1517.44,-10663.08 1513.94,-10673.08 1520.94,-10673.08"/>
</g>
<!-- send_l7_e1_gpu1 -->
<g id="node398" class="node">
<title>send_l7_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1517.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1517.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E1</text>
<text text-anchor="middle" x="1517.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1517.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1517.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l7_e1_gpu1&#45;&gt;send_l7_e1_gpu1 -->
<g id="edge518" class="edge">
<title>expert_l7_e1_gpu1&#45;&gt;send_l7_e1_gpu1</title>
<path fill="none" stroke="black" d="M1517.44,-10594.76C1517.44,-10586.51 1517.44,-10577.42 1517.44,-10568.38"/>
<polygon fill="black" stroke="black" points="1520.94,-10568.22 1517.44,-10558.22 1513.94,-10568.22 1520.94,-10568.22"/>
</g>
<!-- send_l7_e1_gpu1&#45;&gt;agg_l7 -->
<g id="edge519" class="edge">
<title>send_l7_e1_gpu1&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M1734.91,-10474.37C1772.99,-10469.38 1812.31,-10464.9 1849.44,-10461.83 2605.27,-10399.33 4865.64,-10370.6 5774.13,-10361.35"/>
<polygon fill="black" stroke="black" points="5774.46,-10364.85 5784.42,-10361.25 5774.39,-10357.85 5774.46,-10364.85"/>
</g>
<!-- expert_l7_e2_gpu2 -->
<g id="node400" class="node">
<title>expert_l7_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2408.44,-10663 1952.44,-10663 1952.44,-10595 2408.44,-10595 2408.44,-10663"/>
<text text-anchor="middle" x="2180.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E2</text>
<text text-anchor="middle" x="2180.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2180.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2180.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l7_e2_gpu2&#45;&gt;expert_l7_e2_gpu2 -->
<g id="edge521" class="edge">
<title>recv_l7_e2_gpu2&#45;&gt;expert_l7_e2_gpu2</title>
<path fill="none" stroke="black" d="M2180.44,-10699.8C2180.44,-10691.04 2180.44,-10681.94 2180.44,-10673.31"/>
<polygon fill="black" stroke="black" points="2183.94,-10673.08 2180.44,-10663.08 2176.94,-10673.08 2183.94,-10673.08"/>
</g>
<!-- send_l7_e2_gpu2 -->
<g id="node401" class="node">
<title>send_l7_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2180.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2180.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E2</text>
<text text-anchor="middle" x="2180.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2180.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2180.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l7_e2_gpu2&#45;&gt;send_l7_e2_gpu2 -->
<g id="edge522" class="edge">
<title>expert_l7_e2_gpu2&#45;&gt;send_l7_e2_gpu2</title>
<path fill="none" stroke="black" d="M2180.44,-10594.76C2180.44,-10586.51 2180.44,-10577.42 2180.44,-10568.38"/>
<polygon fill="black" stroke="black" points="2183.94,-10568.22 2180.44,-10558.22 2176.94,-10568.22 2183.94,-10568.22"/>
</g>
<!-- send_l7_e2_gpu2&#45;&gt;agg_l7 -->
<g id="edge523" class="edge">
<title>send_l7_e2_gpu2&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M2398.36,-10474.45C2436.31,-10469.47 2475.46,-10464.97 2512.44,-10461.83 3136.79,-10408.82 4974.71,-10375.62 5776.78,-10363.28"/>
<polygon fill="black" stroke="black" points="5777.1,-10366.77 5787.05,-10363.12 5776.99,-10359.78 5777.1,-10366.77"/>
</g>
<!-- expert_l7_e3_gpu3 -->
<g id="node403" class="node">
<title>expert_l7_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3071.44,-10663 2615.44,-10663 2615.44,-10595 3071.44,-10595 3071.44,-10663"/>
<text text-anchor="middle" x="2843.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E3</text>
<text text-anchor="middle" x="2843.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2843.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2843.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l7_e3_gpu3&#45;&gt;expert_l7_e3_gpu3 -->
<g id="edge525" class="edge">
<title>recv_l7_e3_gpu3&#45;&gt;expert_l7_e3_gpu3</title>
<path fill="none" stroke="black" d="M2843.44,-10699.8C2843.44,-10691.04 2843.44,-10681.94 2843.44,-10673.31"/>
<polygon fill="black" stroke="black" points="2846.94,-10673.08 2843.44,-10663.08 2839.94,-10673.08 2846.94,-10673.08"/>
</g>
<!-- send_l7_e3_gpu3 -->
<g id="node404" class="node">
<title>send_l7_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2843.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2843.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E3</text>
<text text-anchor="middle" x="2843.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2843.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2843.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l7_e3_gpu3&#45;&gt;send_l7_e3_gpu3 -->
<g id="edge526" class="edge">
<title>expert_l7_e3_gpu3&#45;&gt;send_l7_e3_gpu3</title>
<path fill="none" stroke="black" d="M2843.44,-10594.76C2843.44,-10586.51 2843.44,-10577.42 2843.44,-10568.38"/>
<polygon fill="black" stroke="black" points="2846.94,-10568.22 2843.44,-10558.22 2839.94,-10568.22 2846.94,-10568.22"/>
</g>
<!-- send_l7_e3_gpu3&#45;&gt;agg_l7 -->
<g id="edge527" class="edge">
<title>send_l7_e3_gpu3&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M3062.27,-10474.53C3099.94,-10469.57 3138.76,-10465.06 3175.44,-10461.83 4103.8,-10380.05 5200,-10361.85 5770.04,-10358.25"/>
<polygon fill="black" stroke="black" points="5770.08,-10361.75 5780.06,-10358.19 5770.04,-10354.75 5770.08,-10361.75"/>
</g>
<!-- expert_l7_e4_gpu4 -->
<g id="node406" class="node">
<title>expert_l7_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3734.44,-10663 3278.44,-10663 3278.44,-10595 3734.44,-10595 3734.44,-10663"/>
<text text-anchor="middle" x="3506.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E4</text>
<text text-anchor="middle" x="3506.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3506.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3506.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l7_e4_gpu4&#45;&gt;expert_l7_e4_gpu4 -->
<g id="edge529" class="edge">
<title>recv_l7_e4_gpu4&#45;&gt;expert_l7_e4_gpu4</title>
<path fill="none" stroke="black" d="M3506.44,-10699.8C3506.44,-10691.04 3506.44,-10681.94 3506.44,-10673.31"/>
<polygon fill="black" stroke="black" points="3509.94,-10673.08 3506.44,-10663.08 3502.94,-10673.08 3509.94,-10673.08"/>
</g>
<!-- send_l7_e4_gpu4 -->
<g id="node407" class="node">
<title>send_l7_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3506.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3506.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E4</text>
<text text-anchor="middle" x="3506.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3506.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3506.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l7_e4_gpu4&#45;&gt;send_l7_e4_gpu4 -->
<g id="edge530" class="edge">
<title>expert_l7_e4_gpu4&#45;&gt;send_l7_e4_gpu4</title>
<path fill="none" stroke="black" d="M3506.44,-10594.76C3506.44,-10586.51 3506.44,-10577.42 3506.44,-10568.38"/>
<polygon fill="black" stroke="black" points="3509.94,-10568.22 3506.44,-10558.22 3502.94,-10568.22 3509.94,-10568.22"/>
</g>
<!-- send_l7_e4_gpu4&#45;&gt;agg_l7 -->
<g id="edge531" class="edge">
<title>send_l7_e4_gpu4&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M3726.2,-10474.72C3763.58,-10469.77 3802.07,-10465.22 3838.44,-10461.83 4519.76,-10398.4 5317.37,-10373.36 5777.64,-10363.69"/>
<polygon fill="black" stroke="black" points="5777.85,-10367.19 5787.77,-10363.48 5777.7,-10360.19 5777.85,-10367.19"/>
</g>
<!-- expert_l7_e5_gpu5 -->
<g id="node409" class="node">
<title>expert_l7_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4397.44,-10663 3941.44,-10663 3941.44,-10595 4397.44,-10595 4397.44,-10663"/>
<text text-anchor="middle" x="4169.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E5</text>
<text text-anchor="middle" x="4169.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4169.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4169.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l7_e5_gpu5&#45;&gt;expert_l7_e5_gpu5 -->
<g id="edge533" class="edge">
<title>recv_l7_e5_gpu5&#45;&gt;expert_l7_e5_gpu5</title>
<path fill="none" stroke="black" d="M4169.44,-10699.8C4169.44,-10691.04 4169.44,-10681.94 4169.44,-10673.31"/>
<polygon fill="black" stroke="black" points="4172.94,-10673.08 4169.44,-10663.08 4165.94,-10673.08 4172.94,-10673.08"/>
</g>
<!-- send_l7_e5_gpu5 -->
<g id="node410" class="node">
<title>send_l7_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4169.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4169.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E5</text>
<text text-anchor="middle" x="4169.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4169.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4169.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l7_e5_gpu5&#45;&gt;send_l7_e5_gpu5 -->
<g id="edge534" class="edge">
<title>expert_l7_e5_gpu5&#45;&gt;send_l7_e5_gpu5</title>
<path fill="none" stroke="black" d="M4169.44,-10594.76C4169.44,-10586.51 4169.44,-10577.42 4169.44,-10568.38"/>
<polygon fill="black" stroke="black" points="4172.94,-10568.22 4169.44,-10558.22 4165.94,-10568.22 4172.94,-10568.22"/>
</g>
<!-- send_l7_e5_gpu5&#45;&gt;agg_l7 -->
<g id="edge535" class="edge">
<title>send_l7_e5_gpu5&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M4391.49,-10474.98C4428.16,-10470.08 4465.82,-10465.47 4501.44,-10461.83 4943.29,-10416.7 5453.57,-10388.22 5789.81,-10372.7"/>
<polygon fill="black" stroke="black" points="5790.38,-10376.18 5800.2,-10372.22 5790.05,-10369.18 5790.38,-10376.18"/>
</g>
<!-- expert_l7_e6_gpu6 -->
<g id="node412" class="node">
<title>expert_l7_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5060.44,-10663 4604.44,-10663 4604.44,-10595 5060.44,-10595 5060.44,-10663"/>
<text text-anchor="middle" x="4832.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E6</text>
<text text-anchor="middle" x="4832.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4832.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4832.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l7_e6_gpu6&#45;&gt;expert_l7_e6_gpu6 -->
<g id="edge537" class="edge">
<title>recv_l7_e6_gpu6&#45;&gt;expert_l7_e6_gpu6</title>
<path fill="none" stroke="black" d="M4832.44,-10699.8C4832.44,-10691.04 4832.44,-10681.94 4832.44,-10673.31"/>
<polygon fill="black" stroke="black" points="4835.94,-10673.08 4832.44,-10663.08 4828.94,-10673.08 4835.94,-10673.08"/>
</g>
<!-- send_l7_e6_gpu6 -->
<g id="node413" class="node">
<title>send_l7_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4832.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4832.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E6</text>
<text text-anchor="middle" x="4832.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4832.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4832.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l7_e6_gpu6&#45;&gt;send_l7_e6_gpu6 -->
<g id="edge538" class="edge">
<title>expert_l7_e6_gpu6&#45;&gt;send_l7_e6_gpu6</title>
<path fill="none" stroke="black" d="M4832.44,-10594.76C4832.44,-10586.51 4832.44,-10577.42 4832.44,-10568.38"/>
<polygon fill="black" stroke="black" points="4835.94,-10568.22 4832.44,-10558.22 4828.94,-10568.22 4835.94,-10568.22"/>
</g>
<!-- send_l7_e6_gpu6&#45;&gt;agg_l7 -->
<g id="edge539" class="edge">
<title>send_l7_e6_gpu6&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M5059.1,-10475.64C5094.34,-10470.79 5130.35,-10466.03 5164.44,-10461.83 5380.57,-10435.21 5623.69,-10409.69 5815.39,-10390.6"/>
<polygon fill="black" stroke="black" points="5815.74,-10394.08 5825.34,-10389.61 5815.05,-10387.11 5815.74,-10394.08"/>
</g>
<!-- expert_l7_e7_gpu7 -->
<g id="node415" class="node">
<title>expert_l7_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5723.44,-10663 5267.44,-10663 5267.44,-10595 5723.44,-10595 5723.44,-10663"/>
<text text-anchor="middle" x="5495.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E7</text>
<text text-anchor="middle" x="5495.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5495.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5495.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l7_e7_gpu7&#45;&gt;expert_l7_e7_gpu7 -->
<g id="edge541" class="edge">
<title>recv_l7_e7_gpu7&#45;&gt;expert_l7_e7_gpu7</title>
<path fill="none" stroke="black" d="M5495.44,-10699.8C5495.44,-10691.04 5495.44,-10681.94 5495.44,-10673.31"/>
<polygon fill="black" stroke="black" points="5498.94,-10673.08 5495.44,-10663.08 5491.94,-10673.08 5498.94,-10673.08"/>
</g>
<!-- send_l7_e7_gpu7 -->
<g id="node416" class="node">
<title>send_l7_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5495.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5495.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E7</text>
<text text-anchor="middle" x="5495.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5495.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5495.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l7_e7_gpu7&#45;&gt;send_l7_e7_gpu7 -->
<g id="edge542" class="edge">
<title>expert_l7_e7_gpu7&#45;&gt;send_l7_e7_gpu7</title>
<path fill="none" stroke="black" d="M5495.44,-10594.76C5495.44,-10586.51 5495.44,-10577.42 5495.44,-10568.38"/>
<polygon fill="black" stroke="black" points="5498.94,-10568.22 5495.44,-10558.22 5491.94,-10568.22 5498.94,-10568.22"/>
</g>
<!-- send_l7_e7_gpu7&#45;&gt;agg_l7 -->
<g id="edge543" class="edge">
<title>send_l7_e7_gpu7&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M5669.2,-10469.32C5728.63,-10455.78 5796.87,-10440.23 5863.16,-10425.12"/>
<polygon fill="black" stroke="black" points="5863.95,-10428.53 5872.92,-10422.89 5862.39,-10421.7 5863.95,-10428.53"/>
</g>
<!-- expert_l7_e8_gpu8 -->
<g id="node418" class="node">
<title>expert_l7_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6386.44,-10663 5930.44,-10663 5930.44,-10595 6386.44,-10595 6386.44,-10663"/>
<text text-anchor="middle" x="6158.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E8</text>
<text text-anchor="middle" x="6158.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l7_e8_gpu8&#45;&gt;expert_l7_e8_gpu8 -->
<g id="edge545" class="edge">
<title>recv_l7_e8_gpu8&#45;&gt;expert_l7_e8_gpu8</title>
<path fill="none" stroke="black" d="M6158.44,-10699.8C6158.44,-10691.04 6158.44,-10681.94 6158.44,-10673.31"/>
<polygon fill="black" stroke="black" points="6161.94,-10673.08 6158.44,-10663.08 6154.94,-10673.08 6161.94,-10673.08"/>
</g>
<!-- send_l7_e8_gpu8 -->
<g id="node419" class="node">
<title>send_l7_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6158.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6158.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E8</text>
<text text-anchor="middle" x="6158.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6158.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l7_e8_gpu8&#45;&gt;send_l7_e8_gpu8 -->
<g id="edge546" class="edge">
<title>expert_l7_e8_gpu8&#45;&gt;send_l7_e8_gpu8</title>
<path fill="none" stroke="black" d="M6158.44,-10594.76C6158.44,-10586.51 6158.44,-10577.42 6158.44,-10568.38"/>
<polygon fill="black" stroke="black" points="6161.94,-10568.22 6158.44,-10558.22 6154.94,-10568.22 6161.94,-10568.22"/>
</g>
<!-- send_l7_e8_gpu8&#45;&gt;agg_l7 -->
<g id="edge547" class="edge">
<title>send_l7_e8_gpu8&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M6158.44,-10461.52C6158.44,-10453.1 6158.44,-10444.13 6158.44,-10435.13"/>
<polygon fill="black" stroke="black" points="6161.94,-10434.97 6158.44,-10424.97 6154.94,-10434.97 6161.94,-10434.97"/>
</g>
<!-- expert_l7_e9_gpu9 -->
<g id="node421" class="node">
<title>expert_l7_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7049.44,-10663 6593.44,-10663 6593.44,-10595 7049.44,-10595 7049.44,-10663"/>
<text text-anchor="middle" x="6821.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E9</text>
<text text-anchor="middle" x="6821.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6821.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6821.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l7_e9_gpu9&#45;&gt;expert_l7_e9_gpu9 -->
<g id="edge549" class="edge">
<title>recv_l7_e9_gpu9&#45;&gt;expert_l7_e9_gpu9</title>
<path fill="none" stroke="black" d="M6821.44,-10699.8C6821.44,-10691.04 6821.44,-10681.94 6821.44,-10673.31"/>
<polygon fill="black" stroke="black" points="6824.94,-10673.08 6821.44,-10663.08 6817.94,-10673.08 6824.94,-10673.08"/>
</g>
<!-- send_l7_e9_gpu9 -->
<g id="node422" class="node">
<title>send_l7_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6821.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6821.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E9</text>
<text text-anchor="middle" x="6821.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6821.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6821.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l7_e9_gpu9&#45;&gt;send_l7_e9_gpu9 -->
<g id="edge550" class="edge">
<title>expert_l7_e9_gpu9&#45;&gt;send_l7_e9_gpu9</title>
<path fill="none" stroke="black" d="M6821.44,-10594.76C6821.44,-10586.51 6821.44,-10577.42 6821.44,-10568.38"/>
<polygon fill="black" stroke="black" points="6824.94,-10568.22 6821.44,-10558.22 6817.94,-10568.22 6824.94,-10568.22"/>
</g>
<!-- send_l7_e9_gpu9&#45;&gt;agg_l7 -->
<g id="edge551" class="edge">
<title>send_l7_e9_gpu9&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M6647.68,-10469.32C6590.84,-10456.37 6525.93,-10441.57 6462.39,-10427.09"/>
<polygon fill="black" stroke="black" points="6463.14,-10423.68 6452.61,-10424.87 6461.59,-10430.5 6463.14,-10423.68"/>
</g>
<!-- expert_l7_e10_gpu10 -->
<g id="node424" class="node">
<title>expert_l7_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7712.44,-10663 7256.44,-10663 7256.44,-10595 7712.44,-10595 7712.44,-10663"/>
<text text-anchor="middle" x="7484.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E10</text>
<text text-anchor="middle" x="7484.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7484.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7484.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l7_e10_gpu10&#45;&gt;expert_l7_e10_gpu10 -->
<g id="edge553" class="edge">
<title>recv_l7_e10_gpu10&#45;&gt;expert_l7_e10_gpu10</title>
<path fill="none" stroke="black" d="M7484.44,-10699.8C7484.44,-10691.04 7484.44,-10681.94 7484.44,-10673.31"/>
<polygon fill="black" stroke="black" points="7487.94,-10673.08 7484.44,-10663.08 7480.94,-10673.08 7487.94,-10673.08"/>
</g>
<!-- send_l7_e10_gpu10 -->
<g id="node425" class="node">
<title>send_l7_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7484.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7484.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E10</text>
<text text-anchor="middle" x="7484.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7484.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7484.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l7_e10_gpu10&#45;&gt;send_l7_e10_gpu10 -->
<g id="edge554" class="edge">
<title>expert_l7_e10_gpu10&#45;&gt;send_l7_e10_gpu10</title>
<path fill="none" stroke="black" d="M7484.44,-10594.76C7484.44,-10586.51 7484.44,-10577.42 7484.44,-10568.38"/>
<polygon fill="black" stroke="black" points="7487.94,-10568.22 7484.44,-10558.22 7480.94,-10568.22 7487.94,-10568.22"/>
</g>
<!-- send_l7_e10_gpu10&#45;&gt;agg_l7 -->
<g id="edge555" class="edge">
<title>send_l7_e10_gpu10&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M7257.78,-10475.64C7222.54,-10470.79 7186.53,-10466.03 7152.44,-10461.83 6976,-10440.1 6781.57,-10419.1 6611.81,-10401.73"/>
<polygon fill="black" stroke="black" points="6612,-10398.23 6601.69,-10400.7 6611.29,-10405.2 6612,-10398.23"/>
</g>
<!-- expert_l7_e11_gpu11 -->
<g id="node427" class="node">
<title>expert_l7_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8375.44,-10663 7919.44,-10663 7919.44,-10595 8375.44,-10595 8375.44,-10663"/>
<text text-anchor="middle" x="8147.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E11</text>
<text text-anchor="middle" x="8147.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8147.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8147.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l7_e11_gpu11&#45;&gt;expert_l7_e11_gpu11 -->
<g id="edge557" class="edge">
<title>recv_l7_e11_gpu11&#45;&gt;expert_l7_e11_gpu11</title>
<path fill="none" stroke="black" d="M8147.44,-10699.8C8147.44,-10691.04 8147.44,-10681.94 8147.44,-10673.31"/>
<polygon fill="black" stroke="black" points="8150.94,-10673.08 8147.44,-10663.08 8143.94,-10673.08 8150.94,-10673.08"/>
</g>
<!-- send_l7_e11_gpu11 -->
<g id="node428" class="node">
<title>send_l7_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8147.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8147.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E11</text>
<text text-anchor="middle" x="8147.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8147.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8147.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l7_e11_gpu11&#45;&gt;send_l7_e11_gpu11 -->
<g id="edge558" class="edge">
<title>expert_l7_e11_gpu11&#45;&gt;send_l7_e11_gpu11</title>
<path fill="none" stroke="black" d="M8147.44,-10594.76C8147.44,-10586.51 8147.44,-10577.42 8147.44,-10568.38"/>
<polygon fill="black" stroke="black" points="8150.94,-10568.22 8147.44,-10558.22 8143.94,-10568.22 8150.94,-10568.22"/>
</g>
<!-- send_l7_e11_gpu11&#45;&gt;agg_l7 -->
<g id="edge559" class="edge">
<title>send_l7_e11_gpu11&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M7925.4,-10474.98C7888.72,-10470.08 7851.06,-10465.47 7815.44,-10461.83 7393.81,-10418.77 6909.87,-10390.86 6574.31,-10374.91"/>
<polygon fill="black" stroke="black" points="6574.08,-10371.4 6563.92,-10374.42 6573.75,-10378.39 6574.08,-10371.4"/>
</g>
<!-- expert_l7_e12_gpu12 -->
<g id="node430" class="node">
<title>expert_l7_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9038.44,-10663 8582.44,-10663 8582.44,-10595 9038.44,-10595 9038.44,-10663"/>
<text text-anchor="middle" x="8810.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E12</text>
<text text-anchor="middle" x="8810.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8810.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8810.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l7_e12_gpu12&#45;&gt;expert_l7_e12_gpu12 -->
<g id="edge561" class="edge">
<title>recv_l7_e12_gpu12&#45;&gt;expert_l7_e12_gpu12</title>
<path fill="none" stroke="black" d="M8810.44,-10699.8C8810.44,-10691.04 8810.44,-10681.94 8810.44,-10673.31"/>
<polygon fill="black" stroke="black" points="8813.94,-10673.08 8810.44,-10663.08 8806.94,-10673.08 8813.94,-10673.08"/>
</g>
<!-- send_l7_e12_gpu12 -->
<g id="node431" class="node">
<title>send_l7_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8810.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8810.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E12</text>
<text text-anchor="middle" x="8810.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8810.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8810.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l7_e12_gpu12&#45;&gt;send_l7_e12_gpu12 -->
<g id="edge562" class="edge">
<title>expert_l7_e12_gpu12&#45;&gt;send_l7_e12_gpu12</title>
<path fill="none" stroke="black" d="M8810.44,-10594.76C8810.44,-10586.51 8810.44,-10577.42 8810.44,-10568.38"/>
<polygon fill="black" stroke="black" points="8813.94,-10568.22 8810.44,-10558.22 8806.94,-10568.22 8813.94,-10568.22"/>
</g>
<!-- send_l7_e12_gpu12&#45;&gt;agg_l7 -->
<g id="edge563" class="edge">
<title>send_l7_e12_gpu12&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M8590.69,-10474.72C8553.3,-10469.77 8514.81,-10465.22 8478.44,-10461.83 7806.83,-10399.3 7022.23,-10374.08 6559.13,-10364.11"/>
<polygon fill="black" stroke="black" points="6559.01,-10360.61 6548.93,-10363.9 6558.86,-10367.61 6559.01,-10360.61"/>
</g>
<!-- expert_l7_e13_gpu13 -->
<g id="node433" class="node">
<title>expert_l7_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9701.44,-10663 9245.44,-10663 9245.44,-10595 9701.44,-10595 9701.44,-10663"/>
<text text-anchor="middle" x="9473.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E13</text>
<text text-anchor="middle" x="9473.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9473.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9473.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l7_e13_gpu13&#45;&gt;expert_l7_e13_gpu13 -->
<g id="edge565" class="edge">
<title>recv_l7_e13_gpu13&#45;&gt;expert_l7_e13_gpu13</title>
<path fill="none" stroke="black" d="M9473.44,-10699.8C9473.44,-10691.04 9473.44,-10681.94 9473.44,-10673.31"/>
<polygon fill="black" stroke="black" points="9476.94,-10673.08 9473.44,-10663.08 9469.94,-10673.08 9476.94,-10673.08"/>
</g>
<!-- send_l7_e13_gpu13 -->
<g id="node434" class="node">
<title>send_l7_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9473.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9473.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E13</text>
<text text-anchor="middle" x="9473.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9473.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9473.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l7_e13_gpu13&#45;&gt;send_l7_e13_gpu13 -->
<g id="edge566" class="edge">
<title>expert_l7_e13_gpu13&#45;&gt;send_l7_e13_gpu13</title>
<path fill="none" stroke="black" d="M9473.44,-10594.76C9473.44,-10586.51 9473.44,-10577.42 9473.44,-10568.38"/>
<polygon fill="black" stroke="black" points="9476.94,-10568.22 9473.44,-10558.22 9469.94,-10568.22 9476.94,-10568.22"/>
</g>
<!-- send_l7_e13_gpu13&#45;&gt;agg_l7 -->
<g id="edge567" class="edge">
<title>send_l7_e13_gpu13&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M9254.61,-10474.53C9216.94,-10469.57 9178.12,-10465.06 9141.44,-10461.83 8215.16,-10380.23 7121.8,-10361.93 6550.69,-10358.28"/>
<polygon fill="black" stroke="black" points="6550.67,-10354.78 6540.65,-10358.22 6550.63,-10361.78 6550.67,-10354.78"/>
</g>
<!-- expert_l7_e14_gpu14 -->
<g id="node436" class="node">
<title>expert_l7_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10364.44,-10663 9908.44,-10663 9908.44,-10595 10364.44,-10595 10364.44,-10663"/>
<text text-anchor="middle" x="10136.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E14</text>
<text text-anchor="middle" x="10136.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10136.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10136.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l7_e14_gpu14&#45;&gt;expert_l7_e14_gpu14 -->
<g id="edge569" class="edge">
<title>recv_l7_e14_gpu14&#45;&gt;expert_l7_e14_gpu14</title>
<path fill="none" stroke="black" d="M10136.44,-10699.8C10136.44,-10691.04 10136.44,-10681.94 10136.44,-10673.31"/>
<polygon fill="black" stroke="black" points="10139.94,-10673.08 10136.44,-10663.08 10132.94,-10673.08 10139.94,-10673.08"/>
</g>
<!-- send_l7_e14_gpu14 -->
<g id="node437" class="node">
<title>send_l7_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10136.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10136.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E14</text>
<text text-anchor="middle" x="10136.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10136.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10136.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l7_e14_gpu14&#45;&gt;send_l7_e14_gpu14 -->
<g id="edge570" class="edge">
<title>expert_l7_e14_gpu14&#45;&gt;send_l7_e14_gpu14</title>
<path fill="none" stroke="black" d="M10136.44,-10594.76C10136.44,-10586.51 10136.44,-10577.42 10136.44,-10568.38"/>
<polygon fill="black" stroke="black" points="10139.94,-10568.22 10136.44,-10558.22 10132.94,-10568.22 10139.94,-10568.22"/>
</g>
<!-- send_l7_e14_gpu14&#45;&gt;agg_l7 -->
<g id="edge571" class="edge">
<title>send_l7_e14_gpu14&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M9918.52,-10474.45C9880.57,-10469.47 9841.42,-10464.97 9804.44,-10461.83 9184.73,-10409.22 7369.4,-10376.11 6558.14,-10363.56"/>
<polygon fill="black" stroke="black" points="6558.1,-10360.06 6548.05,-10363.4 6557.99,-10367.06 6558.1,-10360.06"/>
</g>
<!-- expert_l7_e15_gpu15 -->
<g id="node439" class="node">
<title>expert_l7_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11027.44,-10663 10571.44,-10663 10571.44,-10595 11027.44,-10595 11027.44,-10663"/>
<text text-anchor="middle" x="10799.44" y="-10647.8" font-family="Times,serif" font-size="14.00">Expert L7E15</text>
<text text-anchor="middle" x="10799.44" y="-10632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10799.44" y="-10617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10799.44" y="-10602.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l7_e15_gpu15&#45;&gt;expert_l7_e15_gpu15 -->
<g id="edge573" class="edge">
<title>recv_l7_e15_gpu15&#45;&gt;expert_l7_e15_gpu15</title>
<path fill="none" stroke="black" d="M10799.44,-10699.8C10799.44,-10691.04 10799.44,-10681.94 10799.44,-10673.31"/>
<polygon fill="black" stroke="black" points="10802.94,-10673.08 10799.44,-10663.08 10795.94,-10673.08 10802.94,-10673.08"/>
</g>
<!-- send_l7_e15_gpu15 -->
<g id="node440" class="node">
<title>send_l7_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10799.44" cy="-10509.91" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10799.44" y="-10528.71" font-family="Times,serif" font-size="14.00">Token Send L7E15</text>
<text text-anchor="middle" x="10799.44" y="-10513.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10799.44" y="-10498.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10799.44" y="-10483.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l7_e15_gpu15&#45;&gt;send_l7_e15_gpu15 -->
<g id="edge574" class="edge">
<title>expert_l7_e15_gpu15&#45;&gt;send_l7_e15_gpu15</title>
<path fill="none" stroke="black" d="M10799.44,-10594.76C10799.44,-10586.51 10799.44,-10577.42 10799.44,-10568.38"/>
<polygon fill="black" stroke="black" points="10802.94,-10568.22 10799.44,-10558.22 10795.94,-10568.22 10802.94,-10568.22"/>
</g>
<!-- send_l7_e15_gpu15&#45;&gt;agg_l7 -->
<g id="edge575" class="edge">
<title>send_l7_e15_gpu15&#45;&gt;agg_l7</title>
<path fill="none" stroke="black" d="M10581.97,-10474.37C10543.89,-10469.38 10504.57,-10464.9 10467.44,-10461.83 9715.12,-10399.62 7472.18,-10370.87 6555.48,-10361.48"/>
<polygon fill="black" stroke="black" points="6555.46,-10357.98 6545.43,-10361.38 6555.39,-10364.98 6555.46,-10357.98"/>
</g>
<!-- residual2_l7 -->
<g id="node442" class="node">
<title>residual2_l7</title>
<polygon fill="lightpink" stroke="black" points="6423.94,-10251.83 5988.94,-10251.83 5988.94,-10183.83 6423.94,-10183.83 6423.94,-10251.83"/>
<text text-anchor="middle" x="6206.44" y="-10236.63" font-family="Times,serif" font-size="14.00">ResidualAdd L7</text>
<text text-anchor="middle" x="6206.44" y="-10221.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6206.44" y="-10206.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6206.44" y="-10191.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l7&#45;&gt;residual2_l7 -->
<g id="edge576" class="edge">
<title>agg_l7&#45;&gt;residual2_l7</title>
<path fill="none" stroke="black" d="M6182.02,-10288.53C6185.22,-10279.39 6188.44,-10270.22 6191.43,-10261.67"/>
<polygon fill="black" stroke="black" points="6194.83,-10262.55 6194.83,-10251.96 6188.22,-10260.24 6194.83,-10262.55"/>
</g>
<!-- residual2_l7&#45;&gt;ln1_l8 -->
<g id="edge577" class="edge">
<title>residual2_l7&#45;&gt;ln1_l8</title>
<path fill="none" stroke="black" d="M6215.45,-10183.67C6217.78,-10175.13 6220.31,-10165.81 6222.75,-10156.84"/>
<polygon fill="black" stroke="black" points="6226.2,-10157.49 6225.44,-10146.93 6219.44,-10155.66 6226.2,-10157.49"/>
</g>
<!-- attn_l8 -->
<g id="node444" class="node">
<title>attn_l8</title>
<polygon fill="lightcoral" stroke="black" points="6464.44,-10041.83 6004.44,-10041.83 6004.44,-9973.83 6464.44,-9973.83 6464.44,-10041.83"/>
<text text-anchor="middle" x="6234.44" y="-10026.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L8</text>
<text text-anchor="middle" x="6234.44" y="-10011.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6234.44" y="-9996.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9981.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l8&#45;&gt;attn_l8 -->
<g id="edge580" class="edge">
<title>ln1_l8&#45;&gt;attn_l8</title>
<path fill="none" stroke="black" d="M6234.44,-10078.67C6234.44,-10070.22 6234.44,-10061.01 6234.44,-10052.13"/>
<polygon fill="black" stroke="black" points="6237.94,-10051.93 6234.44,-10041.93 6230.94,-10051.93 6237.94,-10051.93"/>
</g>
<!-- residual1_l8 -->
<g id="node445" class="node">
<title>residual1_l8</title>
<polygon fill="lightpink" stroke="black" points="6451.94,-9936.83 6016.94,-9936.83 6016.94,-9868.83 6451.94,-9868.83 6451.94,-9936.83"/>
<text text-anchor="middle" x="6234.44" y="-9921.63" font-family="Times,serif" font-size="14.00">ResidualAdd L8</text>
<text text-anchor="middle" x="6234.44" y="-9906.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9891.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9876.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l8&#45;&gt;residual1_l8 -->
<g id="edge581" class="edge">
<title>attn_l8&#45;&gt;residual1_l8</title>
<path fill="none" stroke="black" d="M6234.44,-9973.67C6234.44,-9965.22 6234.44,-9956.01 6234.44,-9947.13"/>
<polygon fill="black" stroke="black" points="6237.94,-9946.93 6234.44,-9936.93 6230.94,-9946.93 6237.94,-9946.93"/>
</g>
<!-- ln2_l8 -->
<g id="node446" class="node">
<title>ln2_l8</title>
<polygon fill="lightyellow" stroke="black" points="6451.94,-9831.83 6016.94,-9831.83 6016.94,-9763.83 6451.94,-9763.83 6451.94,-9831.83"/>
<text text-anchor="middle" x="6234.44" y="-9816.63" font-family="Times,serif" font-size="14.00">LayerNorm L8</text>
<text text-anchor="middle" x="6234.44" y="-9801.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9786.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9771.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l8&#45;&gt;ln2_l8 -->
<g id="edge582" class="edge">
<title>residual1_l8&#45;&gt;ln2_l8</title>
<path fill="none" stroke="black" d="M6234.44,-9868.67C6234.44,-9860.22 6234.44,-9851.01 6234.44,-9842.13"/>
<polygon fill="black" stroke="black" points="6237.94,-9841.93 6234.44,-9831.93 6230.94,-9841.93 6237.94,-9841.93"/>
</g>
<!-- ln2_l8&#45;&gt;route_l8 -->
<g id="edge583" class="edge">
<title>ln2_l8&#45;&gt;route_l8</title>
<path fill="none" stroke="black" d="M6234.44,-9763.67C6234.44,-9755.53 6234.44,-9746.47 6234.44,-9737.19"/>
<polygon fill="black" stroke="black" points="6237.94,-9737.06 6234.44,-9727.06 6230.94,-9737.06 6237.94,-9737.06"/>
</g>
<!-- recv_l8_e0_gpu0 -->
<g id="node448" class="node">
<title>recv_l8_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="930.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="930.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E0</text>
<text text-anchor="middle" x="930.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="930.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="930.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e0_gpu0 -->
<g id="edge584" class="edge">
<title>route_l8&#45;&gt;recv_l8_e0_gpu0</title>
<path fill="none" stroke="black" d="M5850.34,-9653.14C5108.72,-9643.41 3428,-9618.08 2014.44,-9572.83 1680.07,-9562.13 1595.56,-9570.69 1262.44,-9539.83 1229.33,-9536.76 1194.48,-9532.72 1160.29,-9528.29"/>
<polygon fill="black" stroke="black" points="1160.56,-9524.8 1150.19,-9526.97 1159.65,-9531.74 1160.56,-9524.8"/>
<text text-anchor="middle" x="2086.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l8_e1_gpu1 -->
<g id="node451" class="node">
<title>recv_l8_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1593.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1593.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E1</text>
<text text-anchor="middle" x="1593.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1593.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1593.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e1_gpu1 -->
<g id="edge588" class="edge">
<title>route_l8&#45;&gt;recv_l8_e1_gpu1</title>
<path fill="none" stroke="black" d="M5847.4,-9650.96C5195.9,-9638.85 3838.87,-9611.31 2691.44,-9572.83 2350.87,-9561.41 2264.76,-9571.13 1925.44,-9539.83 1892.33,-9536.78 1857.47,-9532.74 1823.29,-9528.32"/>
<polygon fill="black" stroke="black" points="1823.56,-9524.82 1813.19,-9527 1822.65,-9531.76 1823.56,-9524.82"/>
<text text-anchor="middle" x="2763.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l8_e2_gpu2 -->
<g id="node454" class="node">
<title>recv_l8_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2256.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2256.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E2</text>
<text text-anchor="middle" x="2256.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2256.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2256.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e2_gpu2 -->
<g id="edge592" class="edge">
<title>route_l8&#45;&gt;recv_l8_e2_gpu2</title>
<path fill="none" stroke="black" d="M5843.09,-9647.96C5289.03,-9633.61 4244.24,-9605.13 3354.44,-9572.83 3013.9,-9560.47 2927.76,-9571.13 2588.44,-9539.83 2555.33,-9536.78 2520.47,-9532.74 2486.29,-9528.32"/>
<polygon fill="black" stroke="black" points="2486.56,-9524.82 2476.19,-9527 2485.65,-9531.76 2486.56,-9524.82"/>
<text text-anchor="middle" x="3426.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l8_e3_gpu3 -->
<g id="node457" class="node">
<title>recv_l8_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2919.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2919.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E3</text>
<text text-anchor="middle" x="2919.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2919.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2919.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e3_gpu3 -->
<g id="edge596" class="edge">
<title>route_l8&#45;&gt;recv_l8_e3_gpu3</title>
<path fill="none" stroke="black" d="M5836.18,-9643.13C5392.4,-9626.62 4653.54,-9598.73 4017.44,-9572.83 3676.96,-9558.97 3590.76,-9571.13 3251.44,-9539.83 3218.33,-9536.78 3183.47,-9532.74 3149.29,-9528.32"/>
<polygon fill="black" stroke="black" points="3149.56,-9524.82 3139.19,-9527 3148.65,-9531.76 3149.56,-9524.82"/>
<text text-anchor="middle" x="4089.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l8_e4_gpu4 -->
<g id="node460" class="node">
<title>recv_l8_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3582.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3582.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E4</text>
<text text-anchor="middle" x="3582.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3582.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3582.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e4_gpu4 -->
<g id="edge600" class="edge">
<title>route_l8&#45;&gt;recv_l8_e4_gpu4</title>
<path fill="none" stroke="black" d="M5844.2,-9648.71C5382.53,-9635.43 4591.13,-9604.89 3914.44,-9539.83 3881.61,-9536.67 3847.05,-9532.61 3813.13,-9528.19"/>
<polygon fill="black" stroke="black" points="3813.48,-9524.71 3803.11,-9526.87 3812.57,-9531.65 3813.48,-9524.71"/>
<text text-anchor="middle" x="4365.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l8_e5_gpu5 -->
<g id="node463" class="node">
<title>recv_l8_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4245.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4245.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E5</text>
<text text-anchor="middle" x="4245.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4245.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4245.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e5_gpu5 -->
<g id="edge604" class="edge">
<title>route_l8&#45;&gt;recv_l8_e5_gpu5</title>
<path fill="none" stroke="black" d="M5826.86,-9636.75C5491.03,-9617.48 5002.6,-9585.06 4577.44,-9539.83 4545.44,-9536.43 4511.78,-9532.3 4478.66,-9527.91"/>
<polygon fill="black" stroke="black" points="4478.78,-9524.4 4468.41,-9526.55 4477.86,-9531.34 4478.78,-9524.4"/>
<text text-anchor="middle" x="4966.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l8_e6_gpu6 -->
<g id="node466" class="node">
<title>recv_l8_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4908.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4908.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E6</text>
<text text-anchor="middle" x="4908.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4908.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4908.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e6_gpu6 -->
<g id="edge608" class="edge">
<title>route_l8&#45;&gt;recv_l8_e6_gpu6</title>
<path fill="none" stroke="black" d="M5784.2,-9606.57C5613.75,-9586.6 5418.04,-9562.96 5240.44,-9539.83 5210.1,-9535.88 5178.22,-9531.56 5146.71,-9527.2"/>
<polygon fill="black" stroke="black" points="5146.89,-9523.69 5136.5,-9525.79 5145.93,-9530.63 5146.89,-9523.69"/>
<text text-anchor="middle" x="5558.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l8_e7_gpu7 -->
<g id="node469" class="node">
<title>recv_l8_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5571.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5571.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E7</text>
<text text-anchor="middle" x="5571.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5571.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5571.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e7_gpu7 -->
<g id="edge612" class="edge">
<title>route_l8&#45;&gt;recv_l8_e7_gpu7</title>
<path fill="none" stroke="black" d="M5965.25,-9590.8C5890.71,-9572.24 5811.82,-9552.6 5744.37,-9535.81"/>
<polygon fill="black" stroke="black" points="5745.06,-9532.37 5734.51,-9533.35 5743.37,-9539.16 5745.06,-9532.37"/>
<text text-anchor="middle" x="5955.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l8_e8_gpu8 -->
<g id="node472" class="node">
<title>recv_l8_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6234.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6234.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E8</text>
<text text-anchor="middle" x="6234.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e8_gpu8 -->
<g id="edge616" class="edge">
<title>route_l8&#45;&gt;recv_l8_e8_gpu8</title>
<path fill="none" stroke="black" d="M6234.44,-9590.69C6234.44,-9577.3 6234.44,-9563.36 6234.44,-9550.33"/>
<polygon fill="black" stroke="black" points="6237.94,-9550.11 6234.44,-9540.11 6230.94,-9550.11 6237.94,-9550.11"/>
<text text-anchor="middle" x="6306.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l8_e9_gpu9 -->
<g id="node475" class="node">
<title>recv_l8_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6897.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6897.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E9</text>
<text text-anchor="middle" x="6897.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6897.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6897.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e9_gpu9 -->
<g id="edge620" class="edge">
<title>route_l8&#45;&gt;recv_l8_e9_gpu9</title>
<path fill="none" stroke="black" d="M6503.63,-9590.8C6578.17,-9572.24 6657.06,-9552.6 6724.51,-9535.81"/>
<polygon fill="black" stroke="black" points="6725.51,-9539.16 6734.37,-9533.35 6723.82,-9532.37 6725.51,-9539.16"/>
<text text-anchor="middle" x="6697.44" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l8_e10_gpu10 -->
<g id="node478" class="node">
<title>recv_l8_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7560.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7560.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E10</text>
<text text-anchor="middle" x="7560.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7560.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7560.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e10_gpu10 -->
<g id="edge624" class="edge">
<title>route_l8&#45;&gt;recv_l8_e10_gpu10</title>
<path fill="none" stroke="black" d="M6557.27,-9621.39C6751.83,-9598.95 7004.53,-9569 7228.44,-9539.83 7258.78,-9535.88 7290.66,-9531.56 7322.17,-9527.2"/>
<polygon fill="black" stroke="black" points="7322.96,-9530.63 7332.38,-9525.79 7321.99,-9523.69 7322.96,-9530.63"/>
<text text-anchor="middle" x="7142.94" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l8_e11_gpu11 -->
<g id="node481" class="node">
<title>recv_l8_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8223.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8223.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E11</text>
<text text-anchor="middle" x="8223.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8223.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8223.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e11_gpu11 -->
<g id="edge628" class="edge">
<title>route_l8&#45;&gt;recv_l8_e11_gpu11</title>
<path fill="none" stroke="black" d="M6583.79,-9640.05C6919.56,-9621.29 7441.01,-9587.75 7891.44,-9539.83 7923.44,-9536.43 7957.1,-9532.3 7990.22,-9527.91"/>
<polygon fill="black" stroke="black" points="7991.02,-9531.34 8000.47,-9526.55 7990.1,-9524.4 7991.02,-9531.34"/>
<text text-anchor="middle" x="7788.94" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l8_e12_gpu12 -->
<g id="node484" class="node">
<title>recv_l8_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8886.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8886.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E12</text>
<text text-anchor="middle" x="8886.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8886.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8886.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e12_gpu12 -->
<g id="edge632" class="edge">
<title>route_l8&#45;&gt;recv_l8_e12_gpu12</title>
<path fill="none" stroke="black" d="M6597.35,-9649.48C7054.61,-9636.64 7864.2,-9606.19 8554.44,-9539.83 8587.27,-9536.67 8621.83,-9532.61 8655.75,-9528.19"/>
<polygon fill="black" stroke="black" points="8656.32,-9531.65 8665.77,-9526.87 8655.4,-9524.71 8656.32,-9531.65"/>
<text text-anchor="middle" x="8380.94" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l8_e13_gpu13 -->
<g id="node487" class="node">
<title>recv_l8_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9549.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9549.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E13</text>
<text text-anchor="middle" x="9549.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9549.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9549.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e13_gpu13 -->
<g id="edge636" class="edge">
<title>route_l8&#45;&gt;recv_l8_e13_gpu13</title>
<path fill="none" stroke="black" d="M6590.76,-9644.83C7030.49,-9628.65 7801.1,-9599.84 8461.44,-9572.83 8797.48,-9559.08 8882.55,-9570.81 9217.44,-9539.83 9250.55,-9536.77 9285.41,-9532.73 9319.59,-9528.3"/>
<polygon fill="black" stroke="black" points="9320.23,-9531.75 9329.69,-9526.98 9319.32,-9524.81 9320.23,-9531.75"/>
<text text-anchor="middle" x="9046.94" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l8_e14_gpu14 -->
<g id="node490" class="node">
<title>recv_l8_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10212.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10212.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E14</text>
<text text-anchor="middle" x="10212.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10212.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10212.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e14_gpu14 -->
<g id="edge640" class="edge">
<title>route_l8&#45;&gt;recv_l8_e14_gpu14</title>
<path fill="none" stroke="black" d="M6596.16,-9648.88C7143.91,-9634.94 8216.53,-9606.17 9127.44,-9572.83 9462.2,-9560.58 9546.88,-9570.72 9880.44,-9539.83 9913.55,-9536.77 9948.41,-9532.72 9982.59,-9528.3"/>
<polygon fill="black" stroke="black" points="9983.23,-9531.74 9992.69,-9526.97 9982.32,-9524.8 9983.23,-9531.74"/>
<text text-anchor="middle" x="9710.94" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l8_e15_gpu15 -->
<g id="node493" class="node">
<title>recv_l8_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10875.44" cy="-9491.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10875.44" y="-9510.55" font-family="Times,serif" font-size="14.00">Token Receive L8E15</text>
<text text-anchor="middle" x="10875.44" y="-9495.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10875.44" y="-9480.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10875.44" y="-9465.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l8&#45;&gt;recv_l8_e15_gpu15 -->
<g id="edge644" class="edge">
<title>route_l8&#45;&gt;recv_l8_e15_gpu15</title>
<path fill="none" stroke="black" d="M6599.99,-9651.5C7244.66,-9639.8 8625.79,-9612.33 9791.44,-9572.83 10125.79,-9561.5 10210.32,-9570.69 10543.44,-9539.83 10576.55,-9536.76 10611.41,-9532.72 10645.59,-9528.29"/>
<polygon fill="black" stroke="black" points="10646.23,-9531.74 10655.69,-9526.97 10645.32,-9524.8 10646.23,-9531.74"/>
<text text-anchor="middle" x="10373.94" y="-9561.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l8_e0_gpu0 -->
<g id="node449" class="node">
<title>expert_l8_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1158.44,-9406.66 702.44,-9406.66 702.44,-9338.66 1158.44,-9338.66 1158.44,-9406.66"/>
<text text-anchor="middle" x="930.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E0</text>
<text text-anchor="middle" x="930.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="930.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="930.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l8_e0_gpu0&#45;&gt;expert_l8_e0_gpu0 -->
<g id="edge585" class="edge">
<title>recv_l8_e0_gpu0&#45;&gt;expert_l8_e0_gpu0</title>
<path fill="none" stroke="black" d="M930.44,-9443.46C930.44,-9434.71 930.44,-9425.61 930.44,-9416.98"/>
<polygon fill="black" stroke="black" points="933.94,-9416.74 930.44,-9406.75 926.94,-9416.75 933.94,-9416.74"/>
</g>
<!-- send_l8_e0_gpu0 -->
<g id="node450" class="node">
<title>send_l8_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="930.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="930.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E0</text>
<text text-anchor="middle" x="930.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="930.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="930.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l8_e0_gpu0&#45;&gt;send_l8_e0_gpu0 -->
<g id="edge586" class="edge">
<title>expert_l8_e0_gpu0&#45;&gt;send_l8_e0_gpu0</title>
<path fill="none" stroke="black" d="M930.44,-9338.43C930.44,-9330.17 930.44,-9321.09 930.44,-9312.04"/>
<polygon fill="black" stroke="black" points="933.94,-9311.89 930.44,-9301.89 926.94,-9311.89 933.94,-9311.89"/>
</g>
<!-- agg_l8 -->
<g id="node496" class="node">
<title>agg_l8</title>
<polygon fill="lightgray" stroke="black" points="6712.33,-9168.5 5952.12,-9168.5 5756.55,-9032.5 6516.76,-9032.5 6712.33,-9168.5"/>
<text text-anchor="middle" x="6234.44" y="-9119.3" font-family="Times,serif" font-size="14.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="6234.44" y="-9104.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9089.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9074.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l8_e0_gpu0&#45;&gt;agg_l8 -->
<g id="edge587" class="edge">
<title>send_l8_e0_gpu0&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M1147.45,-9217.99C1185.68,-9212.99 1225.16,-9208.52 1262.44,-9205.5 2150.88,-9133.47 4840.64,-9109.98 5848.01,-9103.58"/>
<polygon fill="black" stroke="black" points="5848.34,-9107.08 5858.32,-9103.52 5848.29,-9100.08 5848.34,-9107.08"/>
</g>
<!-- expert_l8_e1_gpu1 -->
<g id="node452" class="node">
<title>expert_l8_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1821.44,-9406.66 1365.44,-9406.66 1365.44,-9338.66 1821.44,-9338.66 1821.44,-9406.66"/>
<text text-anchor="middle" x="1593.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E1</text>
<text text-anchor="middle" x="1593.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1593.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1593.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l8_e1_gpu1&#45;&gt;expert_l8_e1_gpu1 -->
<g id="edge589" class="edge">
<title>recv_l8_e1_gpu1&#45;&gt;expert_l8_e1_gpu1</title>
<path fill="none" stroke="black" d="M1593.44,-9443.46C1593.44,-9434.71 1593.44,-9425.61 1593.44,-9416.98"/>
<polygon fill="black" stroke="black" points="1596.94,-9416.74 1593.44,-9406.75 1589.94,-9416.75 1596.94,-9416.74"/>
</g>
<!-- send_l8_e1_gpu1 -->
<g id="node453" class="node">
<title>send_l8_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1593.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1593.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E1</text>
<text text-anchor="middle" x="1593.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1593.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1593.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l8_e1_gpu1&#45;&gt;send_l8_e1_gpu1 -->
<g id="edge590" class="edge">
<title>expert_l8_e1_gpu1&#45;&gt;send_l8_e1_gpu1</title>
<path fill="none" stroke="black" d="M1593.44,-9338.43C1593.44,-9330.17 1593.44,-9321.09 1593.44,-9312.04"/>
<polygon fill="black" stroke="black" points="1596.94,-9311.89 1593.44,-9301.89 1589.94,-9311.89 1596.94,-9311.89"/>
</g>
<!-- send_l8_e1_gpu1&#45;&gt;agg_l8 -->
<g id="edge591" class="edge">
<title>send_l8_e1_gpu1&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M1810.91,-9218.04C1848.99,-9213.05 1888.31,-9208.57 1925.44,-9205.5 2681.27,-9143 4941.64,-9114.27 5850.13,-9105.02"/>
<polygon fill="black" stroke="black" points="5850.46,-9108.51 5860.42,-9104.91 5850.39,-9101.51 5850.46,-9108.51"/>
</g>
<!-- expert_l8_e2_gpu2 -->
<g id="node455" class="node">
<title>expert_l8_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2484.44,-9406.66 2028.44,-9406.66 2028.44,-9338.66 2484.44,-9338.66 2484.44,-9406.66"/>
<text text-anchor="middle" x="2256.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E2</text>
<text text-anchor="middle" x="2256.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2256.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2256.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l8_e2_gpu2&#45;&gt;expert_l8_e2_gpu2 -->
<g id="edge593" class="edge">
<title>recv_l8_e2_gpu2&#45;&gt;expert_l8_e2_gpu2</title>
<path fill="none" stroke="black" d="M2256.44,-9443.46C2256.44,-9434.71 2256.44,-9425.61 2256.44,-9416.98"/>
<polygon fill="black" stroke="black" points="2259.94,-9416.74 2256.44,-9406.75 2252.94,-9416.75 2259.94,-9416.74"/>
</g>
<!-- send_l8_e2_gpu2 -->
<g id="node456" class="node">
<title>send_l8_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2256.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2256.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E2</text>
<text text-anchor="middle" x="2256.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2256.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2256.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l8_e2_gpu2&#45;&gt;send_l8_e2_gpu2 -->
<g id="edge594" class="edge">
<title>expert_l8_e2_gpu2&#45;&gt;send_l8_e2_gpu2</title>
<path fill="none" stroke="black" d="M2256.44,-9338.43C2256.44,-9330.17 2256.44,-9321.09 2256.44,-9312.04"/>
<polygon fill="black" stroke="black" points="2259.94,-9311.89 2256.44,-9301.89 2252.94,-9311.89 2259.94,-9311.89"/>
</g>
<!-- send_l8_e2_gpu2&#45;&gt;agg_l8 -->
<g id="edge595" class="edge">
<title>send_l8_e2_gpu2&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M2474.36,-9218.11C2512.31,-9213.13 2551.46,-9208.64 2588.44,-9205.5 3212.79,-9152.49 5050.71,-9119.29 5852.78,-9106.95"/>
<polygon fill="black" stroke="black" points="5853.1,-9110.44 5863.05,-9106.79 5852.99,-9103.44 5853.1,-9110.44"/>
</g>
<!-- expert_l8_e3_gpu3 -->
<g id="node458" class="node">
<title>expert_l8_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3147.44,-9406.66 2691.44,-9406.66 2691.44,-9338.66 3147.44,-9338.66 3147.44,-9406.66"/>
<text text-anchor="middle" x="2919.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E3</text>
<text text-anchor="middle" x="2919.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2919.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2919.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l8_e3_gpu3&#45;&gt;expert_l8_e3_gpu3 -->
<g id="edge597" class="edge">
<title>recv_l8_e3_gpu3&#45;&gt;expert_l8_e3_gpu3</title>
<path fill="none" stroke="black" d="M2919.44,-9443.46C2919.44,-9434.71 2919.44,-9425.61 2919.44,-9416.98"/>
<polygon fill="black" stroke="black" points="2922.94,-9416.74 2919.44,-9406.75 2915.94,-9416.75 2922.94,-9416.74"/>
</g>
<!-- send_l8_e3_gpu3 -->
<g id="node459" class="node">
<title>send_l8_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2919.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2919.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E3</text>
<text text-anchor="middle" x="2919.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2919.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2919.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l8_e3_gpu3&#45;&gt;send_l8_e3_gpu3 -->
<g id="edge598" class="edge">
<title>expert_l8_e3_gpu3&#45;&gt;send_l8_e3_gpu3</title>
<path fill="none" stroke="black" d="M2919.44,-9338.43C2919.44,-9330.17 2919.44,-9321.09 2919.44,-9312.04"/>
<polygon fill="black" stroke="black" points="2922.94,-9311.89 2919.44,-9301.89 2915.94,-9311.89 2922.94,-9311.89"/>
</g>
<!-- send_l8_e3_gpu3&#45;&gt;agg_l8 -->
<g id="edge599" class="edge">
<title>send_l8_e3_gpu3&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M3138.27,-9218.2C3175.94,-9213.24 3214.76,-9208.73 3251.44,-9205.5 4179.8,-9123.72 5276,-9105.51 5846.04,-9101.92"/>
<polygon fill="black" stroke="black" points="5846.08,-9105.42 5856.06,-9101.86 5846.04,-9098.42 5846.08,-9105.42"/>
</g>
<!-- expert_l8_e4_gpu4 -->
<g id="node461" class="node">
<title>expert_l8_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3810.44,-9406.66 3354.44,-9406.66 3354.44,-9338.66 3810.44,-9338.66 3810.44,-9406.66"/>
<text text-anchor="middle" x="3582.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E4</text>
<text text-anchor="middle" x="3582.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3582.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3582.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l8_e4_gpu4&#45;&gt;expert_l8_e4_gpu4 -->
<g id="edge601" class="edge">
<title>recv_l8_e4_gpu4&#45;&gt;expert_l8_e4_gpu4</title>
<path fill="none" stroke="black" d="M3582.44,-9443.46C3582.44,-9434.71 3582.44,-9425.61 3582.44,-9416.98"/>
<polygon fill="black" stroke="black" points="3585.94,-9416.74 3582.44,-9406.75 3578.94,-9416.75 3585.94,-9416.74"/>
</g>
<!-- send_l8_e4_gpu4 -->
<g id="node462" class="node">
<title>send_l8_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3582.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3582.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E4</text>
<text text-anchor="middle" x="3582.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3582.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3582.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l8_e4_gpu4&#45;&gt;send_l8_e4_gpu4 -->
<g id="edge602" class="edge">
<title>expert_l8_e4_gpu4&#45;&gt;send_l8_e4_gpu4</title>
<path fill="none" stroke="black" d="M3582.44,-9338.43C3582.44,-9330.17 3582.44,-9321.09 3582.44,-9312.04"/>
<polygon fill="black" stroke="black" points="3585.94,-9311.89 3582.44,-9301.89 3578.94,-9311.89 3585.94,-9311.89"/>
</g>
<!-- send_l8_e4_gpu4&#45;&gt;agg_l8 -->
<g id="edge603" class="edge">
<title>send_l8_e4_gpu4&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M3802.2,-9218.39C3839.58,-9213.44 3878.07,-9208.88 3914.44,-9205.5 4595.76,-9142.06 5393.37,-9117.03 5853.64,-9107.36"/>
<polygon fill="black" stroke="black" points="5853.85,-9110.86 5863.77,-9107.15 5853.7,-9103.86 5853.85,-9110.86"/>
</g>
<!-- expert_l8_e5_gpu5 -->
<g id="node464" class="node">
<title>expert_l8_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4473.44,-9406.66 4017.44,-9406.66 4017.44,-9338.66 4473.44,-9338.66 4473.44,-9406.66"/>
<text text-anchor="middle" x="4245.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E5</text>
<text text-anchor="middle" x="4245.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4245.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4245.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l8_e5_gpu5&#45;&gt;expert_l8_e5_gpu5 -->
<g id="edge605" class="edge">
<title>recv_l8_e5_gpu5&#45;&gt;expert_l8_e5_gpu5</title>
<path fill="none" stroke="black" d="M4245.44,-9443.46C4245.44,-9434.71 4245.44,-9425.61 4245.44,-9416.98"/>
<polygon fill="black" stroke="black" points="4248.94,-9416.74 4245.44,-9406.75 4241.94,-9416.75 4248.94,-9416.74"/>
</g>
<!-- send_l8_e5_gpu5 -->
<g id="node465" class="node">
<title>send_l8_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4245.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4245.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E5</text>
<text text-anchor="middle" x="4245.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4245.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4245.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l8_e5_gpu5&#45;&gt;send_l8_e5_gpu5 -->
<g id="edge606" class="edge">
<title>expert_l8_e5_gpu5&#45;&gt;send_l8_e5_gpu5</title>
<path fill="none" stroke="black" d="M4245.44,-9338.43C4245.44,-9330.17 4245.44,-9321.09 4245.44,-9312.04"/>
<polygon fill="black" stroke="black" points="4248.94,-9311.89 4245.44,-9301.89 4241.94,-9311.89 4248.94,-9311.89"/>
</g>
<!-- send_l8_e5_gpu5&#45;&gt;agg_l8 -->
<g id="edge607" class="edge">
<title>send_l8_e5_gpu5&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M4467.49,-9218.64C4504.16,-9213.74 4541.82,-9209.14 4577.44,-9205.5 5019.29,-9160.37 5529.57,-9131.89 5865.81,-9116.36"/>
<polygon fill="black" stroke="black" points="5866.38,-9119.84 5876.2,-9115.89 5866.05,-9112.85 5866.38,-9119.84"/>
</g>
<!-- expert_l8_e6_gpu6 -->
<g id="node467" class="node">
<title>expert_l8_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5136.44,-9406.66 4680.44,-9406.66 4680.44,-9338.66 5136.44,-9338.66 5136.44,-9406.66"/>
<text text-anchor="middle" x="4908.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E6</text>
<text text-anchor="middle" x="4908.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4908.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4908.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l8_e6_gpu6&#45;&gt;expert_l8_e6_gpu6 -->
<g id="edge609" class="edge">
<title>recv_l8_e6_gpu6&#45;&gt;expert_l8_e6_gpu6</title>
<path fill="none" stroke="black" d="M4908.44,-9443.46C4908.44,-9434.71 4908.44,-9425.61 4908.44,-9416.98"/>
<polygon fill="black" stroke="black" points="4911.94,-9416.74 4908.44,-9406.75 4904.94,-9416.75 4911.94,-9416.74"/>
</g>
<!-- send_l8_e6_gpu6 -->
<g id="node468" class="node">
<title>send_l8_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4908.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4908.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E6</text>
<text text-anchor="middle" x="4908.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4908.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4908.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l8_e6_gpu6&#45;&gt;send_l8_e6_gpu6 -->
<g id="edge610" class="edge">
<title>expert_l8_e6_gpu6&#45;&gt;send_l8_e6_gpu6</title>
<path fill="none" stroke="black" d="M4908.44,-9338.43C4908.44,-9330.17 4908.44,-9321.09 4908.44,-9312.04"/>
<polygon fill="black" stroke="black" points="4911.94,-9311.89 4908.44,-9301.89 4904.94,-9311.89 4911.94,-9311.89"/>
</g>
<!-- send_l8_e6_gpu6&#45;&gt;agg_l8 -->
<g id="edge611" class="edge">
<title>send_l8_e6_gpu6&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M5135.1,-9219.31C5170.34,-9214.46 5206.35,-9209.7 5240.44,-9205.5 5456.57,-9178.87 5699.69,-9153.36 5891.39,-9134.26"/>
<polygon fill="black" stroke="black" points="5891.74,-9137.75 5901.34,-9133.27 5891.05,-9130.78 5891.74,-9137.75"/>
</g>
<!-- expert_l8_e7_gpu7 -->
<g id="node470" class="node">
<title>expert_l8_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5799.44,-9406.66 5343.44,-9406.66 5343.44,-9338.66 5799.44,-9338.66 5799.44,-9406.66"/>
<text text-anchor="middle" x="5571.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E7</text>
<text text-anchor="middle" x="5571.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5571.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5571.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l8_e7_gpu7&#45;&gt;expert_l8_e7_gpu7 -->
<g id="edge613" class="edge">
<title>recv_l8_e7_gpu7&#45;&gt;expert_l8_e7_gpu7</title>
<path fill="none" stroke="black" d="M5571.44,-9443.46C5571.44,-9434.71 5571.44,-9425.61 5571.44,-9416.98"/>
<polygon fill="black" stroke="black" points="5574.94,-9416.74 5571.44,-9406.75 5567.94,-9416.75 5574.94,-9416.74"/>
</g>
<!-- send_l8_e7_gpu7 -->
<g id="node471" class="node">
<title>send_l8_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5571.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5571.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E7</text>
<text text-anchor="middle" x="5571.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5571.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5571.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l8_e7_gpu7&#45;&gt;send_l8_e7_gpu7 -->
<g id="edge614" class="edge">
<title>expert_l8_e7_gpu7&#45;&gt;send_l8_e7_gpu7</title>
<path fill="none" stroke="black" d="M5571.44,-9338.43C5571.44,-9330.17 5571.44,-9321.09 5571.44,-9312.04"/>
<polygon fill="black" stroke="black" points="5574.94,-9311.89 5571.44,-9301.89 5567.94,-9311.89 5574.94,-9311.89"/>
</g>
<!-- send_l8_e7_gpu7&#45;&gt;agg_l8 -->
<g id="edge615" class="edge">
<title>send_l8_e7_gpu7&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M5745.2,-9212.98C5804.63,-9199.44 5872.87,-9183.89 5939.16,-9168.79"/>
<polygon fill="black" stroke="black" points="5939.95,-9172.2 5948.92,-9166.56 5938.39,-9165.37 5939.95,-9172.2"/>
</g>
<!-- expert_l8_e8_gpu8 -->
<g id="node473" class="node">
<title>expert_l8_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6462.44,-9406.66 6006.44,-9406.66 6006.44,-9338.66 6462.44,-9338.66 6462.44,-9406.66"/>
<text text-anchor="middle" x="6234.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E8</text>
<text text-anchor="middle" x="6234.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l8_e8_gpu8&#45;&gt;expert_l8_e8_gpu8 -->
<g id="edge617" class="edge">
<title>recv_l8_e8_gpu8&#45;&gt;expert_l8_e8_gpu8</title>
<path fill="none" stroke="black" d="M6234.44,-9443.46C6234.44,-9434.71 6234.44,-9425.61 6234.44,-9416.98"/>
<polygon fill="black" stroke="black" points="6237.94,-9416.74 6234.44,-9406.75 6230.94,-9416.75 6237.94,-9416.74"/>
</g>
<!-- send_l8_e8_gpu8 -->
<g id="node474" class="node">
<title>send_l8_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6234.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6234.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E8</text>
<text text-anchor="middle" x="6234.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6234.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l8_e8_gpu8&#45;&gt;send_l8_e8_gpu8 -->
<g id="edge618" class="edge">
<title>expert_l8_e8_gpu8&#45;&gt;send_l8_e8_gpu8</title>
<path fill="none" stroke="black" d="M6234.44,-9338.43C6234.44,-9330.17 6234.44,-9321.09 6234.44,-9312.04"/>
<polygon fill="black" stroke="black" points="6237.94,-9311.89 6234.44,-9301.89 6230.94,-9311.89 6237.94,-9311.89"/>
</g>
<!-- send_l8_e8_gpu8&#45;&gt;agg_l8 -->
<g id="edge619" class="edge">
<title>send_l8_e8_gpu8&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M6234.44,-9205.19C6234.44,-9196.77 6234.44,-9187.8 6234.44,-9178.79"/>
<polygon fill="black" stroke="black" points="6237.94,-9178.64 6234.44,-9168.64 6230.94,-9178.64 6237.94,-9178.64"/>
</g>
<!-- expert_l8_e9_gpu9 -->
<g id="node476" class="node">
<title>expert_l8_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7125.44,-9406.66 6669.44,-9406.66 6669.44,-9338.66 7125.44,-9338.66 7125.44,-9406.66"/>
<text text-anchor="middle" x="6897.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E9</text>
<text text-anchor="middle" x="6897.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6897.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6897.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l8_e9_gpu9&#45;&gt;expert_l8_e9_gpu9 -->
<g id="edge621" class="edge">
<title>recv_l8_e9_gpu9&#45;&gt;expert_l8_e9_gpu9</title>
<path fill="none" stroke="black" d="M6897.44,-9443.46C6897.44,-9434.71 6897.44,-9425.61 6897.44,-9416.98"/>
<polygon fill="black" stroke="black" points="6900.94,-9416.74 6897.44,-9406.75 6893.94,-9416.75 6900.94,-9416.74"/>
</g>
<!-- send_l8_e9_gpu9 -->
<g id="node477" class="node">
<title>send_l8_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6897.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6897.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E9</text>
<text text-anchor="middle" x="6897.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6897.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6897.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l8_e9_gpu9&#45;&gt;send_l8_e9_gpu9 -->
<g id="edge622" class="edge">
<title>expert_l8_e9_gpu9&#45;&gt;send_l8_e9_gpu9</title>
<path fill="none" stroke="black" d="M6897.44,-9338.43C6897.44,-9330.17 6897.44,-9321.09 6897.44,-9312.04"/>
<polygon fill="black" stroke="black" points="6900.94,-9311.89 6897.44,-9301.89 6893.94,-9311.89 6900.94,-9311.89"/>
</g>
<!-- send_l8_e9_gpu9&#45;&gt;agg_l8 -->
<g id="edge623" class="edge">
<title>send_l8_e9_gpu9&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M6723.68,-9212.98C6666.84,-9200.03 6601.93,-9185.24 6538.39,-9170.76"/>
<polygon fill="black" stroke="black" points="6539.14,-9167.34 6528.61,-9168.53 6537.59,-9174.17 6539.14,-9167.34"/>
</g>
<!-- expert_l8_e10_gpu10 -->
<g id="node479" class="node">
<title>expert_l8_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7788.44,-9406.66 7332.44,-9406.66 7332.44,-9338.66 7788.44,-9338.66 7788.44,-9406.66"/>
<text text-anchor="middle" x="7560.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E10</text>
<text text-anchor="middle" x="7560.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7560.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7560.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l8_e10_gpu10&#45;&gt;expert_l8_e10_gpu10 -->
<g id="edge625" class="edge">
<title>recv_l8_e10_gpu10&#45;&gt;expert_l8_e10_gpu10</title>
<path fill="none" stroke="black" d="M7560.44,-9443.46C7560.44,-9434.71 7560.44,-9425.61 7560.44,-9416.98"/>
<polygon fill="black" stroke="black" points="7563.94,-9416.74 7560.44,-9406.75 7556.94,-9416.75 7563.94,-9416.74"/>
</g>
<!-- send_l8_e10_gpu10 -->
<g id="node480" class="node">
<title>send_l8_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7560.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7560.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E10</text>
<text text-anchor="middle" x="7560.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7560.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7560.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l8_e10_gpu10&#45;&gt;send_l8_e10_gpu10 -->
<g id="edge626" class="edge">
<title>expert_l8_e10_gpu10&#45;&gt;send_l8_e10_gpu10</title>
<path fill="none" stroke="black" d="M7560.44,-9338.43C7560.44,-9330.17 7560.44,-9321.09 7560.44,-9312.04"/>
<polygon fill="black" stroke="black" points="7563.94,-9311.89 7560.44,-9301.89 7556.94,-9311.89 7563.94,-9311.89"/>
</g>
<!-- send_l8_e10_gpu10&#45;&gt;agg_l8 -->
<g id="edge627" class="edge">
<title>send_l8_e10_gpu10&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M7333.78,-9219.31C7298.54,-9214.46 7262.53,-9209.7 7228.44,-9205.5 7052,-9183.76 6857.57,-9162.77 6687.81,-9145.4"/>
<polygon fill="black" stroke="black" points="6688,-9141.9 6677.69,-9144.37 6687.29,-9148.86 6688,-9141.9"/>
</g>
<!-- expert_l8_e11_gpu11 -->
<g id="node482" class="node">
<title>expert_l8_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8451.44,-9406.66 7995.44,-9406.66 7995.44,-9338.66 8451.44,-9338.66 8451.44,-9406.66"/>
<text text-anchor="middle" x="8223.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E11</text>
<text text-anchor="middle" x="8223.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8223.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8223.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l8_e11_gpu11&#45;&gt;expert_l8_e11_gpu11 -->
<g id="edge629" class="edge">
<title>recv_l8_e11_gpu11&#45;&gt;expert_l8_e11_gpu11</title>
<path fill="none" stroke="black" d="M8223.44,-9443.46C8223.44,-9434.71 8223.44,-9425.61 8223.44,-9416.98"/>
<polygon fill="black" stroke="black" points="8226.94,-9416.74 8223.44,-9406.75 8219.94,-9416.75 8226.94,-9416.74"/>
</g>
<!-- send_l8_e11_gpu11 -->
<g id="node483" class="node">
<title>send_l8_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8223.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8223.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E11</text>
<text text-anchor="middle" x="8223.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8223.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8223.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l8_e11_gpu11&#45;&gt;send_l8_e11_gpu11 -->
<g id="edge630" class="edge">
<title>expert_l8_e11_gpu11&#45;&gt;send_l8_e11_gpu11</title>
<path fill="none" stroke="black" d="M8223.44,-9338.43C8223.44,-9330.17 8223.44,-9321.09 8223.44,-9312.04"/>
<polygon fill="black" stroke="black" points="8226.94,-9311.89 8223.44,-9301.89 8219.94,-9311.89 8226.94,-9311.89"/>
</g>
<!-- send_l8_e11_gpu11&#45;&gt;agg_l8 -->
<g id="edge631" class="edge">
<title>send_l8_e11_gpu11&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M8001.4,-9218.64C7964.72,-9213.74 7927.06,-9209.14 7891.44,-9205.5 7469.81,-9162.44 6985.87,-9134.53 6650.31,-9118.58"/>
<polygon fill="black" stroke="black" points="6650.08,-9115.06 6639.92,-9118.09 6649.75,-9122.06 6650.08,-9115.06"/>
</g>
<!-- expert_l8_e12_gpu12 -->
<g id="node485" class="node">
<title>expert_l8_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9114.44,-9406.66 8658.44,-9406.66 8658.44,-9338.66 9114.44,-9338.66 9114.44,-9406.66"/>
<text text-anchor="middle" x="8886.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E12</text>
<text text-anchor="middle" x="8886.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8886.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8886.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l8_e12_gpu12&#45;&gt;expert_l8_e12_gpu12 -->
<g id="edge633" class="edge">
<title>recv_l8_e12_gpu12&#45;&gt;expert_l8_e12_gpu12</title>
<path fill="none" stroke="black" d="M8886.44,-9443.46C8886.44,-9434.71 8886.44,-9425.61 8886.44,-9416.98"/>
<polygon fill="black" stroke="black" points="8889.94,-9416.74 8886.44,-9406.75 8882.94,-9416.75 8889.94,-9416.74"/>
</g>
<!-- send_l8_e12_gpu12 -->
<g id="node486" class="node">
<title>send_l8_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8886.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8886.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E12</text>
<text text-anchor="middle" x="8886.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8886.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8886.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l8_e12_gpu12&#45;&gt;send_l8_e12_gpu12 -->
<g id="edge634" class="edge">
<title>expert_l8_e12_gpu12&#45;&gt;send_l8_e12_gpu12</title>
<path fill="none" stroke="black" d="M8886.44,-9338.43C8886.44,-9330.17 8886.44,-9321.09 8886.44,-9312.04"/>
<polygon fill="black" stroke="black" points="8889.94,-9311.89 8886.44,-9301.89 8882.94,-9311.89 8889.94,-9311.89"/>
</g>
<!-- send_l8_e12_gpu12&#45;&gt;agg_l8 -->
<g id="edge635" class="edge">
<title>send_l8_e12_gpu12&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M8666.69,-9218.39C8629.3,-9213.44 8590.81,-9208.88 8554.44,-9205.5 7882.83,-9142.97 7098.23,-9117.75 6635.13,-9107.78"/>
<polygon fill="black" stroke="black" points="6635.01,-9104.28 6624.93,-9107.56 6634.86,-9111.28 6635.01,-9104.28"/>
</g>
<!-- expert_l8_e13_gpu13 -->
<g id="node488" class="node">
<title>expert_l8_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9777.44,-9406.66 9321.44,-9406.66 9321.44,-9338.66 9777.44,-9338.66 9777.44,-9406.66"/>
<text text-anchor="middle" x="9549.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E13</text>
<text text-anchor="middle" x="9549.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9549.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9549.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l8_e13_gpu13&#45;&gt;expert_l8_e13_gpu13 -->
<g id="edge637" class="edge">
<title>recv_l8_e13_gpu13&#45;&gt;expert_l8_e13_gpu13</title>
<path fill="none" stroke="black" d="M9549.44,-9443.46C9549.44,-9434.71 9549.44,-9425.61 9549.44,-9416.98"/>
<polygon fill="black" stroke="black" points="9552.94,-9416.74 9549.44,-9406.75 9545.94,-9416.75 9552.94,-9416.74"/>
</g>
<!-- send_l8_e13_gpu13 -->
<g id="node489" class="node">
<title>send_l8_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9549.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9549.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E13</text>
<text text-anchor="middle" x="9549.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9549.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9549.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l8_e13_gpu13&#45;&gt;send_l8_e13_gpu13 -->
<g id="edge638" class="edge">
<title>expert_l8_e13_gpu13&#45;&gt;send_l8_e13_gpu13</title>
<path fill="none" stroke="black" d="M9549.44,-9338.43C9549.44,-9330.17 9549.44,-9321.09 9549.44,-9312.04"/>
<polygon fill="black" stroke="black" points="9552.94,-9311.89 9549.44,-9301.89 9545.94,-9311.89 9552.94,-9311.89"/>
</g>
<!-- send_l8_e13_gpu13&#45;&gt;agg_l8 -->
<g id="edge639" class="edge">
<title>send_l8_e13_gpu13&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M9330.61,-9218.2C9292.94,-9213.24 9254.12,-9208.73 9217.44,-9205.5 8291.16,-9123.9 7197.8,-9105.6 6626.69,-9101.95"/>
<polygon fill="black" stroke="black" points="6626.67,-9098.45 6616.65,-9101.88 6626.63,-9105.45 6626.67,-9098.45"/>
</g>
<!-- expert_l8_e14_gpu14 -->
<g id="node491" class="node">
<title>expert_l8_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10440.44,-9406.66 9984.44,-9406.66 9984.44,-9338.66 10440.44,-9338.66 10440.44,-9406.66"/>
<text text-anchor="middle" x="10212.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E14</text>
<text text-anchor="middle" x="10212.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10212.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10212.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l8_e14_gpu14&#45;&gt;expert_l8_e14_gpu14 -->
<g id="edge641" class="edge">
<title>recv_l8_e14_gpu14&#45;&gt;expert_l8_e14_gpu14</title>
<path fill="none" stroke="black" d="M10212.44,-9443.46C10212.44,-9434.71 10212.44,-9425.61 10212.44,-9416.98"/>
<polygon fill="black" stroke="black" points="10215.94,-9416.74 10212.44,-9406.75 10208.94,-9416.75 10215.94,-9416.74"/>
</g>
<!-- send_l8_e14_gpu14 -->
<g id="node492" class="node">
<title>send_l8_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10212.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10212.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E14</text>
<text text-anchor="middle" x="10212.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10212.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10212.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l8_e14_gpu14&#45;&gt;send_l8_e14_gpu14 -->
<g id="edge642" class="edge">
<title>expert_l8_e14_gpu14&#45;&gt;send_l8_e14_gpu14</title>
<path fill="none" stroke="black" d="M10212.44,-9338.43C10212.44,-9330.17 10212.44,-9321.09 10212.44,-9312.04"/>
<polygon fill="black" stroke="black" points="10215.94,-9311.89 10212.44,-9301.89 10208.94,-9311.89 10215.94,-9311.89"/>
</g>
<!-- send_l8_e14_gpu14&#45;&gt;agg_l8 -->
<g id="edge643" class="edge">
<title>send_l8_e14_gpu14&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M9994.52,-9218.11C9956.57,-9213.13 9917.42,-9208.64 9880.44,-9205.5 9260.73,-9152.88 7445.4,-9119.78 6634.14,-9107.22"/>
<polygon fill="black" stroke="black" points="6634.1,-9103.72 6624.05,-9107.07 6633.99,-9110.72 6634.1,-9103.72"/>
</g>
<!-- expert_l8_e15_gpu15 -->
<g id="node494" class="node">
<title>expert_l8_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11103.44,-9406.66 10647.44,-9406.66 10647.44,-9338.66 11103.44,-9338.66 11103.44,-9406.66"/>
<text text-anchor="middle" x="10875.44" y="-9391.46" font-family="Times,serif" font-size="14.00">Expert L8E15</text>
<text text-anchor="middle" x="10875.44" y="-9376.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10875.44" y="-9361.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10875.44" y="-9346.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l8_e15_gpu15&#45;&gt;expert_l8_e15_gpu15 -->
<g id="edge645" class="edge">
<title>recv_l8_e15_gpu15&#45;&gt;expert_l8_e15_gpu15</title>
<path fill="none" stroke="black" d="M10875.44,-9443.46C10875.44,-9434.71 10875.44,-9425.61 10875.44,-9416.98"/>
<polygon fill="black" stroke="black" points="10878.94,-9416.74 10875.44,-9406.75 10871.94,-9416.75 10878.94,-9416.74"/>
</g>
<!-- send_l8_e15_gpu15 -->
<g id="node495" class="node">
<title>send_l8_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10875.44" cy="-9253.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10875.44" y="-9272.38" font-family="Times,serif" font-size="14.00">Token Send L8E15</text>
<text text-anchor="middle" x="10875.44" y="-9257.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10875.44" y="-9242.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10875.44" y="-9227.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l8_e15_gpu15&#45;&gt;send_l8_e15_gpu15 -->
<g id="edge646" class="edge">
<title>expert_l8_e15_gpu15&#45;&gt;send_l8_e15_gpu15</title>
<path fill="none" stroke="black" d="M10875.44,-9338.43C10875.44,-9330.17 10875.44,-9321.09 10875.44,-9312.04"/>
<polygon fill="black" stroke="black" points="10878.94,-9311.89 10875.44,-9301.89 10871.94,-9311.89 10878.94,-9311.89"/>
</g>
<!-- send_l8_e15_gpu15&#45;&gt;agg_l8 -->
<g id="edge647" class="edge">
<title>send_l8_e15_gpu15&#45;&gt;agg_l8</title>
<path fill="none" stroke="black" d="M10657.97,-9218.04C10619.89,-9213.05 10580.57,-9208.57 10543.44,-9205.5 9791.12,-9143.29 7548.18,-9114.54 6631.48,-9105.15"/>
<polygon fill="black" stroke="black" points="6631.46,-9101.65 6621.43,-9105.04 6631.39,-9108.65 6631.46,-9101.65"/>
</g>
<!-- residual2_l8 -->
<g id="node497" class="node">
<title>residual2_l8</title>
<polygon fill="lightpink" stroke="black" points="6499.94,-8995.5 6064.94,-8995.5 6064.94,-8927.5 6499.94,-8927.5 6499.94,-8995.5"/>
<text text-anchor="middle" x="6282.44" y="-8980.3" font-family="Times,serif" font-size="14.00">ResidualAdd L8</text>
<text text-anchor="middle" x="6282.44" y="-8965.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6282.44" y="-8950.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6282.44" y="-8935.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l8&#45;&gt;residual2_l8 -->
<g id="edge648" class="edge">
<title>agg_l8&#45;&gt;residual2_l8</title>
<path fill="none" stroke="black" d="M6258.02,-9032.2C6261.22,-9023.06 6264.44,-9013.89 6267.43,-9005.34"/>
<polygon fill="black" stroke="black" points="6270.83,-9006.22 6270.83,-8995.63 6264.22,-9003.91 6270.83,-9006.22"/>
</g>
<!-- residual2_l8&#45;&gt;ln1_l9 -->
<g id="edge649" class="edge">
<title>residual2_l8&#45;&gt;ln1_l9</title>
<path fill="none" stroke="black" d="M6291.45,-8927.34C6293.78,-8918.8 6296.31,-8909.47 6298.75,-8900.51"/>
<polygon fill="black" stroke="black" points="6302.2,-8901.16 6301.44,-8890.59 6295.44,-8899.32 6302.2,-8901.16"/>
</g>
<!-- attn_l9 -->
<g id="node499" class="node">
<title>attn_l9</title>
<polygon fill="lightcoral" stroke="black" points="6540.44,-8785.5 6080.44,-8785.5 6080.44,-8717.5 6540.44,-8717.5 6540.44,-8785.5"/>
<text text-anchor="middle" x="6310.44" y="-8770.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L9</text>
<text text-anchor="middle" x="6310.44" y="-8755.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6310.44" y="-8740.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8725.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l9&#45;&gt;attn_l9 -->
<g id="edge652" class="edge">
<title>ln1_l9&#45;&gt;attn_l9</title>
<path fill="none" stroke="black" d="M6310.44,-8822.34C6310.44,-8813.89 6310.44,-8804.67 6310.44,-8795.8"/>
<polygon fill="black" stroke="black" points="6313.94,-8795.59 6310.44,-8785.59 6306.94,-8795.59 6313.94,-8795.59"/>
</g>
<!-- residual1_l9 -->
<g id="node500" class="node">
<title>residual1_l9</title>
<polygon fill="lightpink" stroke="black" points="6527.94,-8680.5 6092.94,-8680.5 6092.94,-8612.5 6527.94,-8612.5 6527.94,-8680.5"/>
<text text-anchor="middle" x="6310.44" y="-8665.3" font-family="Times,serif" font-size="14.00">ResidualAdd L9</text>
<text text-anchor="middle" x="6310.44" y="-8650.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8635.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8620.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l9&#45;&gt;residual1_l9 -->
<g id="edge653" class="edge">
<title>attn_l9&#45;&gt;residual1_l9</title>
<path fill="none" stroke="black" d="M6310.44,-8717.34C6310.44,-8708.89 6310.44,-8699.67 6310.44,-8690.8"/>
<polygon fill="black" stroke="black" points="6313.94,-8690.59 6310.44,-8680.59 6306.94,-8690.59 6313.94,-8690.59"/>
</g>
<!-- ln2_l9 -->
<g id="node501" class="node">
<title>ln2_l9</title>
<polygon fill="lightyellow" stroke="black" points="6527.94,-8575.5 6092.94,-8575.5 6092.94,-8507.5 6527.94,-8507.5 6527.94,-8575.5"/>
<text text-anchor="middle" x="6310.44" y="-8560.3" font-family="Times,serif" font-size="14.00">LayerNorm L9</text>
<text text-anchor="middle" x="6310.44" y="-8545.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8530.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8515.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l9&#45;&gt;ln2_l9 -->
<g id="edge654" class="edge">
<title>residual1_l9&#45;&gt;ln2_l9</title>
<path fill="none" stroke="black" d="M6310.44,-8612.34C6310.44,-8603.89 6310.44,-8594.67 6310.44,-8585.8"/>
<polygon fill="black" stroke="black" points="6313.94,-8585.59 6310.44,-8575.59 6306.94,-8585.59 6313.94,-8585.59"/>
</g>
<!-- ln2_l9&#45;&gt;route_l9 -->
<g id="edge655" class="edge">
<title>ln2_l9&#45;&gt;route_l9</title>
<path fill="none" stroke="black" d="M6310.44,-8507.33C6310.44,-8499.19 6310.44,-8490.13 6310.44,-8480.85"/>
<polygon fill="black" stroke="black" points="6313.94,-8480.73 6310.44,-8470.73 6306.94,-8480.73 6313.94,-8480.73"/>
</g>
<!-- recv_l9_e0_gpu0 -->
<g id="node503" class="node">
<title>recv_l9_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1006.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1006.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E0</text>
<text text-anchor="middle" x="1006.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1006.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1006.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e0_gpu0 -->
<g id="edge656" class="edge">
<title>route_l9&#45;&gt;recv_l9_e0_gpu0</title>
<path fill="none" stroke="black" d="M5926.34,-8396.81C5184.72,-8387.08 3504,-8361.74 2090.44,-8316.5 1756.07,-8305.8 1671.56,-8314.35 1338.44,-8283.5 1305.33,-8280.43 1270.48,-8276.39 1236.29,-8271.96"/>
<polygon fill="black" stroke="black" points="1236.56,-8268.47 1226.19,-8270.64 1235.65,-8275.41 1236.56,-8268.47"/>
<text text-anchor="middle" x="2162.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l9_e1_gpu1 -->
<g id="node506" class="node">
<title>recv_l9_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1669.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1669.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E1</text>
<text text-anchor="middle" x="1669.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1669.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1669.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e1_gpu1 -->
<g id="edge660" class="edge">
<title>route_l9&#45;&gt;recv_l9_e1_gpu1</title>
<path fill="none" stroke="black" d="M5923.4,-8394.63C5271.9,-8382.52 3914.87,-8354.97 2767.44,-8316.5 2426.87,-8305.08 2340.76,-8314.79 2001.44,-8283.5 1968.33,-8280.44 1933.47,-8276.41 1899.29,-8271.98"/>
<polygon fill="black" stroke="black" points="1899.56,-8268.49 1889.19,-8270.66 1898.65,-8275.43 1899.56,-8268.49"/>
<text text-anchor="middle" x="2839.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l9_e2_gpu2 -->
<g id="node509" class="node">
<title>recv_l9_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2332.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2332.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E2</text>
<text text-anchor="middle" x="2332.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2332.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2332.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e2_gpu2 -->
<g id="edge664" class="edge">
<title>route_l9&#45;&gt;recv_l9_e2_gpu2</title>
<path fill="none" stroke="black" d="M5919.09,-8391.63C5365.03,-8377.27 4320.24,-8348.79 3430.44,-8316.5 3089.9,-8304.14 3003.76,-8314.79 2664.44,-8283.5 2631.33,-8280.44 2596.47,-8276.41 2562.29,-8271.98"/>
<polygon fill="black" stroke="black" points="2562.56,-8268.49 2552.19,-8270.66 2561.65,-8275.43 2562.56,-8268.49"/>
<text text-anchor="middle" x="3502.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l9_e3_gpu3 -->
<g id="node512" class="node">
<title>recv_l9_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2995.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2995.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E3</text>
<text text-anchor="middle" x="2995.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2995.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2995.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e3_gpu3 -->
<g id="edge668" class="edge">
<title>route_l9&#45;&gt;recv_l9_e3_gpu3</title>
<path fill="none" stroke="black" d="M5912.18,-8386.8C5468.4,-8370.28 4729.54,-8342.39 4093.44,-8316.5 3752.96,-8302.64 3666.76,-8314.79 3327.44,-8283.5 3294.33,-8280.44 3259.47,-8276.41 3225.29,-8271.98"/>
<polygon fill="black" stroke="black" points="3225.56,-8268.49 3215.19,-8270.66 3224.65,-8275.43 3225.56,-8268.49"/>
<text text-anchor="middle" x="4165.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l9_e4_gpu4 -->
<g id="node515" class="node">
<title>recv_l9_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3658.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3658.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E4</text>
<text text-anchor="middle" x="3658.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3658.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3658.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e4_gpu4 -->
<g id="edge672" class="edge">
<title>route_l9&#45;&gt;recv_l9_e4_gpu4</title>
<path fill="none" stroke="black" d="M5920.2,-8392.37C5458.53,-8379.1 4667.13,-8348.56 3990.44,-8283.5 3957.61,-8280.34 3923.05,-8276.28 3889.13,-8271.86"/>
<polygon fill="black" stroke="black" points="3889.48,-8268.37 3879.11,-8270.54 3888.57,-8275.31 3889.48,-8268.37"/>
<text text-anchor="middle" x="4441.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l9_e5_gpu5 -->
<g id="node518" class="node">
<title>recv_l9_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4321.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4321.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E5</text>
<text text-anchor="middle" x="4321.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4321.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4321.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e5_gpu5 -->
<g id="edge676" class="edge">
<title>route_l9&#45;&gt;recv_l9_e5_gpu5</title>
<path fill="none" stroke="black" d="M5902.86,-8380.42C5567.03,-8361.14 5078.6,-8328.73 4653.44,-8283.5 4621.44,-8280.09 4587.78,-8275.96 4554.66,-8271.58"/>
<polygon fill="black" stroke="black" points="4554.78,-8268.07 4544.41,-8270.21 4553.86,-8275 4554.78,-8268.07"/>
<text text-anchor="middle" x="5042.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l9_e6_gpu6 -->
<g id="node521" class="node">
<title>recv_l9_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4984.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4984.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E6</text>
<text text-anchor="middle" x="4984.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4984.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4984.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e6_gpu6 -->
<g id="edge680" class="edge">
<title>route_l9&#45;&gt;recv_l9_e6_gpu6</title>
<path fill="none" stroke="black" d="M5860.2,-8350.24C5689.75,-8330.26 5494.04,-8306.63 5316.44,-8283.5 5286.1,-8279.55 5254.22,-8275.23 5222.71,-8270.87"/>
<polygon fill="black" stroke="black" points="5222.89,-8267.36 5212.5,-8269.45 5221.93,-8274.3 5222.89,-8267.36"/>
<text text-anchor="middle" x="5634.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l9_e7_gpu7 -->
<g id="node524" class="node">
<title>recv_l9_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5647.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5647.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E7</text>
<text text-anchor="middle" x="5647.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5647.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5647.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e7_gpu7 -->
<g id="edge684" class="edge">
<title>route_l9&#45;&gt;recv_l9_e7_gpu7</title>
<path fill="none" stroke="black" d="M6041.25,-8334.47C5966.71,-8315.91 5887.82,-8296.27 5820.37,-8279.47"/>
<polygon fill="black" stroke="black" points="5821.06,-8276.04 5810.51,-8277.02 5819.37,-8282.83 5821.06,-8276.04"/>
<text text-anchor="middle" x="6031.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l9_e8_gpu8 -->
<g id="node527" class="node">
<title>recv_l9_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6310.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6310.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E8</text>
<text text-anchor="middle" x="6310.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e8_gpu8 -->
<g id="edge688" class="edge">
<title>route_l9&#45;&gt;recv_l9_e8_gpu8</title>
<path fill="none" stroke="black" d="M6310.44,-8334.35C6310.44,-8320.97 6310.44,-8307.03 6310.44,-8294"/>
<polygon fill="black" stroke="black" points="6313.94,-8293.78 6310.44,-8283.78 6306.94,-8293.78 6313.94,-8293.78"/>
<text text-anchor="middle" x="6382.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l9_e9_gpu9 -->
<g id="node530" class="node">
<title>recv_l9_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6973.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6973.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E9</text>
<text text-anchor="middle" x="6973.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6973.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6973.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e9_gpu9 -->
<g id="edge692" class="edge">
<title>route_l9&#45;&gt;recv_l9_e9_gpu9</title>
<path fill="none" stroke="black" d="M6579.63,-8334.47C6654.17,-8315.91 6733.06,-8296.27 6800.51,-8279.47"/>
<polygon fill="black" stroke="black" points="6801.51,-8282.83 6810.37,-8277.02 6799.82,-8276.04 6801.51,-8282.83"/>
<text text-anchor="middle" x="6773.44" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l9_e10_gpu10 -->
<g id="node533" class="node">
<title>recv_l9_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7636.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7636.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E10</text>
<text text-anchor="middle" x="7636.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7636.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7636.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e10_gpu10 -->
<g id="edge696" class="edge">
<title>route_l9&#45;&gt;recv_l9_e10_gpu10</title>
<path fill="none" stroke="black" d="M6633.27,-8365.05C6827.83,-8342.62 7080.53,-8312.66 7304.44,-8283.5 7334.78,-8279.55 7366.66,-8275.23 7398.17,-8270.87"/>
<polygon fill="black" stroke="black" points="7398.96,-8274.3 7408.38,-8269.45 7397.99,-8267.36 7398.96,-8274.3"/>
<text text-anchor="middle" x="7218.94" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l9_e11_gpu11 -->
<g id="node536" class="node">
<title>recv_l9_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8299.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8299.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E11</text>
<text text-anchor="middle" x="8299.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8299.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8299.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e11_gpu11 -->
<g id="edge700" class="edge">
<title>route_l9&#45;&gt;recv_l9_e11_gpu11</title>
<path fill="none" stroke="black" d="M6659.79,-8383.72C6995.56,-8364.95 7517.01,-8331.42 7967.44,-8283.5 7999.44,-8280.09 8033.1,-8275.96 8066.22,-8271.58"/>
<polygon fill="black" stroke="black" points="8067.02,-8275 8076.47,-8270.21 8066.1,-8268.07 8067.02,-8275"/>
<text text-anchor="middle" x="7864.94" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l9_e12_gpu12 -->
<g id="node539" class="node">
<title>recv_l9_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8962.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8962.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E12</text>
<text text-anchor="middle" x="8962.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8962.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8962.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e12_gpu12 -->
<g id="edge704" class="edge">
<title>route_l9&#45;&gt;recv_l9_e12_gpu12</title>
<path fill="none" stroke="black" d="M6673.35,-8393.15C7130.61,-8380.31 7940.2,-8349.86 8630.44,-8283.5 8663.27,-8280.34 8697.83,-8276.28 8731.75,-8271.86"/>
<polygon fill="black" stroke="black" points="8732.32,-8275.31 8741.77,-8270.54 8731.4,-8268.37 8732.32,-8275.31"/>
<text text-anchor="middle" x="8456.94" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l9_e13_gpu13 -->
<g id="node542" class="node">
<title>recv_l9_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9625.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9625.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E13</text>
<text text-anchor="middle" x="9625.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9625.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9625.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e13_gpu13 -->
<g id="edge708" class="edge">
<title>route_l9&#45;&gt;recv_l9_e13_gpu13</title>
<path fill="none" stroke="black" d="M6666.76,-8388.5C7106.49,-8372.32 7877.1,-8343.51 8537.44,-8316.5 8873.48,-8302.75 8958.55,-8314.48 9293.44,-8283.5 9326.55,-8280.44 9361.41,-8276.4 9395.59,-8271.97"/>
<polygon fill="black" stroke="black" points="9396.23,-8275.41 9405.69,-8270.65 9395.32,-8268.47 9396.23,-8275.41"/>
<text text-anchor="middle" x="9122.94" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l9_e14_gpu14 -->
<g id="node545" class="node">
<title>recv_l9_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10288.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10288.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E14</text>
<text text-anchor="middle" x="10288.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10288.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10288.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e14_gpu14 -->
<g id="edge712" class="edge">
<title>route_l9&#45;&gt;recv_l9_e14_gpu14</title>
<path fill="none" stroke="black" d="M6672.16,-8392.55C7219.91,-8378.61 8292.53,-8349.84 9203.44,-8316.5 9538.2,-8304.25 9622.88,-8314.39 9956.44,-8283.5 9989.55,-8280.43 10024.41,-8276.39 10058.59,-8271.96"/>
<polygon fill="black" stroke="black" points="10059.23,-8275.41 10068.69,-8270.64 10058.32,-8268.47 10059.23,-8275.41"/>
<text text-anchor="middle" x="9786.94" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l9_e15_gpu15 -->
<g id="node548" class="node">
<title>recv_l9_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10951.44" cy="-8235.41" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10951.44" y="-8254.21" font-family="Times,serif" font-size="14.00">Token Receive L9E15</text>
<text text-anchor="middle" x="10951.44" y="-8239.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10951.44" y="-8224.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10951.44" y="-8209.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l9&#45;&gt;recv_l9_e15_gpu15 -->
<g id="edge716" class="edge">
<title>route_l9&#45;&gt;recv_l9_e15_gpu15</title>
<path fill="none" stroke="black" d="M6675.99,-8395.17C7320.66,-8383.47 8701.79,-8356 9867.44,-8316.5 10201.79,-8305.17 10286.32,-8314.35 10619.44,-8283.5 10652.55,-8280.43 10687.41,-8276.39 10721.59,-8271.96"/>
<polygon fill="black" stroke="black" points="10722.23,-8275.41 10731.69,-8270.64 10721.32,-8268.47 10722.23,-8275.41"/>
<text text-anchor="middle" x="10449.94" y="-8305.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l9_e0_gpu0 -->
<g id="node504" class="node">
<title>expert_l9_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1234.44,-8150.33 778.44,-8150.33 778.44,-8082.33 1234.44,-8082.33 1234.44,-8150.33"/>
<text text-anchor="middle" x="1006.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E0</text>
<text text-anchor="middle" x="1006.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1006.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1006.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l9_e0_gpu0&#45;&gt;expert_l9_e0_gpu0 -->
<g id="edge657" class="edge">
<title>recv_l9_e0_gpu0&#45;&gt;expert_l9_e0_gpu0</title>
<path fill="none" stroke="black" d="M1006.44,-8187.13C1006.44,-8178.38 1006.44,-8169.27 1006.44,-8160.65"/>
<polygon fill="black" stroke="black" points="1009.94,-8160.41 1006.44,-8150.41 1002.94,-8160.41 1009.94,-8160.41"/>
</g>
<!-- send_l9_e0_gpu0 -->
<g id="node505" class="node">
<title>send_l9_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1006.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1006.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E0</text>
<text text-anchor="middle" x="1006.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1006.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1006.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l9_e0_gpu0&#45;&gt;send_l9_e0_gpu0 -->
<g id="edge658" class="edge">
<title>expert_l9_e0_gpu0&#45;&gt;send_l9_e0_gpu0</title>
<path fill="none" stroke="black" d="M1006.44,-8082.09C1006.44,-8073.84 1006.44,-8064.76 1006.44,-8055.71"/>
<polygon fill="black" stroke="black" points="1009.94,-8055.55 1006.44,-8045.55 1002.94,-8055.55 1009.94,-8055.55"/>
</g>
<!-- agg_l9 -->
<g id="node551" class="node">
<title>agg_l9</title>
<polygon fill="lightgray" stroke="black" points="6788.33,-7912.16 6028.12,-7912.16 5832.55,-7776.16 6592.76,-7776.16 6788.33,-7912.16"/>
<text text-anchor="middle" x="6310.44" y="-7862.96" font-family="Times,serif" font-size="14.00">Expert Aggregation L9</text>
<text text-anchor="middle" x="6310.44" y="-7847.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-7832.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-7817.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l9_e0_gpu0&#45;&gt;agg_l9 -->
<g id="edge659" class="edge">
<title>send_l9_e0_gpu0&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M1223.45,-7961.66C1261.68,-7956.66 1301.16,-7952.19 1338.44,-7949.16 2226.88,-7877.14 4916.64,-7853.64 5924.01,-7847.25"/>
<polygon fill="black" stroke="black" points="5924.34,-7850.75 5934.32,-7847.18 5924.29,-7843.75 5924.34,-7850.75"/>
</g>
<!-- expert_l9_e1_gpu1 -->
<g id="node507" class="node">
<title>expert_l9_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1897.44,-8150.33 1441.44,-8150.33 1441.44,-8082.33 1897.44,-8082.33 1897.44,-8150.33"/>
<text text-anchor="middle" x="1669.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E1</text>
<text text-anchor="middle" x="1669.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1669.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1669.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l9_e1_gpu1&#45;&gt;expert_l9_e1_gpu1 -->
<g id="edge661" class="edge">
<title>recv_l9_e1_gpu1&#45;&gt;expert_l9_e1_gpu1</title>
<path fill="none" stroke="black" d="M1669.44,-8187.13C1669.44,-8178.38 1669.44,-8169.27 1669.44,-8160.65"/>
<polygon fill="black" stroke="black" points="1672.94,-8160.41 1669.44,-8150.41 1665.94,-8160.41 1672.94,-8160.41"/>
</g>
<!-- send_l9_e1_gpu1 -->
<g id="node508" class="node">
<title>send_l9_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1669.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1669.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E1</text>
<text text-anchor="middle" x="1669.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1669.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1669.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l9_e1_gpu1&#45;&gt;send_l9_e1_gpu1 -->
<g id="edge662" class="edge">
<title>expert_l9_e1_gpu1&#45;&gt;send_l9_e1_gpu1</title>
<path fill="none" stroke="black" d="M1669.44,-8082.09C1669.44,-8073.84 1669.44,-8064.76 1669.44,-8055.71"/>
<polygon fill="black" stroke="black" points="1672.94,-8055.55 1669.44,-8045.55 1665.94,-8055.55 1672.94,-8055.55"/>
</g>
<!-- send_l9_e1_gpu1&#45;&gt;agg_l9 -->
<g id="edge663" class="edge">
<title>send_l9_e1_gpu1&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M1886.91,-7961.7C1924.99,-7956.71 1964.31,-7952.24 2001.44,-7949.16 2757.27,-7886.66 5017.64,-7857.94 5926.13,-7848.68"/>
<polygon fill="black" stroke="black" points="5926.46,-7852.18 5936.42,-7848.58 5926.39,-7845.18 5926.46,-7852.18"/>
</g>
<!-- expert_l9_e2_gpu2 -->
<g id="node510" class="node">
<title>expert_l9_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2560.44,-8150.33 2104.44,-8150.33 2104.44,-8082.33 2560.44,-8082.33 2560.44,-8150.33"/>
<text text-anchor="middle" x="2332.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E2</text>
<text text-anchor="middle" x="2332.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2332.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2332.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l9_e2_gpu2&#45;&gt;expert_l9_e2_gpu2 -->
<g id="edge665" class="edge">
<title>recv_l9_e2_gpu2&#45;&gt;expert_l9_e2_gpu2</title>
<path fill="none" stroke="black" d="M2332.44,-8187.13C2332.44,-8178.38 2332.44,-8169.27 2332.44,-8160.65"/>
<polygon fill="black" stroke="black" points="2335.94,-8160.41 2332.44,-8150.41 2328.94,-8160.41 2335.94,-8160.41"/>
</g>
<!-- send_l9_e2_gpu2 -->
<g id="node511" class="node">
<title>send_l9_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2332.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2332.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E2</text>
<text text-anchor="middle" x="2332.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2332.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2332.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l9_e2_gpu2&#45;&gt;send_l9_e2_gpu2 -->
<g id="edge666" class="edge">
<title>expert_l9_e2_gpu2&#45;&gt;send_l9_e2_gpu2</title>
<path fill="none" stroke="black" d="M2332.44,-8082.09C2332.44,-8073.84 2332.44,-8064.76 2332.44,-8055.71"/>
<polygon fill="black" stroke="black" points="2335.94,-8055.55 2332.44,-8045.55 2328.94,-8055.55 2335.94,-8055.55"/>
</g>
<!-- send_l9_e2_gpu2&#45;&gt;agg_l9 -->
<g id="edge667" class="edge">
<title>send_l9_e2_gpu2&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M2550.36,-7961.78C2588.31,-7956.8 2627.46,-7952.3 2664.44,-7949.16 3288.79,-7896.16 5126.71,-7862.95 5928.78,-7850.61"/>
<polygon fill="black" stroke="black" points="5929.1,-7854.11 5939.05,-7850.45 5928.99,-7847.11 5929.1,-7854.11"/>
</g>
<!-- expert_l9_e3_gpu3 -->
<g id="node513" class="node">
<title>expert_l9_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3223.44,-8150.33 2767.44,-8150.33 2767.44,-8082.33 3223.44,-8082.33 3223.44,-8150.33"/>
<text text-anchor="middle" x="2995.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E3</text>
<text text-anchor="middle" x="2995.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2995.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2995.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l9_e3_gpu3&#45;&gt;expert_l9_e3_gpu3 -->
<g id="edge669" class="edge">
<title>recv_l9_e3_gpu3&#45;&gt;expert_l9_e3_gpu3</title>
<path fill="none" stroke="black" d="M2995.44,-8187.13C2995.44,-8178.38 2995.44,-8169.27 2995.44,-8160.65"/>
<polygon fill="black" stroke="black" points="2998.94,-8160.41 2995.44,-8150.41 2991.94,-8160.41 2998.94,-8160.41"/>
</g>
<!-- send_l9_e3_gpu3 -->
<g id="node514" class="node">
<title>send_l9_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="2995.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2995.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E3</text>
<text text-anchor="middle" x="2995.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2995.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2995.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l9_e3_gpu3&#45;&gt;send_l9_e3_gpu3 -->
<g id="edge670" class="edge">
<title>expert_l9_e3_gpu3&#45;&gt;send_l9_e3_gpu3</title>
<path fill="none" stroke="black" d="M2995.44,-8082.09C2995.44,-8073.84 2995.44,-8064.76 2995.44,-8055.71"/>
<polygon fill="black" stroke="black" points="2998.94,-8055.55 2995.44,-8045.55 2991.94,-8055.55 2998.94,-8055.55"/>
</g>
<!-- send_l9_e3_gpu3&#45;&gt;agg_l9 -->
<g id="edge671" class="edge">
<title>send_l9_e3_gpu3&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M3214.27,-7961.86C3251.94,-7956.9 3290.76,-7952.4 3327.44,-7949.16 4255.8,-7867.38 5352,-7849.18 5922.04,-7845.59"/>
<polygon fill="black" stroke="black" points="5922.08,-7849.09 5932.06,-7845.53 5922.04,-7842.09 5922.08,-7849.09"/>
</g>
<!-- expert_l9_e4_gpu4 -->
<g id="node516" class="node">
<title>expert_l9_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3886.44,-8150.33 3430.44,-8150.33 3430.44,-8082.33 3886.44,-8082.33 3886.44,-8150.33"/>
<text text-anchor="middle" x="3658.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E4</text>
<text text-anchor="middle" x="3658.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3658.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3658.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l9_e4_gpu4&#45;&gt;expert_l9_e4_gpu4 -->
<g id="edge673" class="edge">
<title>recv_l9_e4_gpu4&#45;&gt;expert_l9_e4_gpu4</title>
<path fill="none" stroke="black" d="M3658.44,-8187.13C3658.44,-8178.38 3658.44,-8169.27 3658.44,-8160.65"/>
<polygon fill="black" stroke="black" points="3661.94,-8160.41 3658.44,-8150.41 3654.94,-8160.41 3661.94,-8160.41"/>
</g>
<!-- send_l9_e4_gpu4 -->
<g id="node517" class="node">
<title>send_l9_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3658.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3658.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E4</text>
<text text-anchor="middle" x="3658.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3658.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3658.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l9_e4_gpu4&#45;&gt;send_l9_e4_gpu4 -->
<g id="edge674" class="edge">
<title>expert_l9_e4_gpu4&#45;&gt;send_l9_e4_gpu4</title>
<path fill="none" stroke="black" d="M3658.44,-8082.09C3658.44,-8073.84 3658.44,-8064.76 3658.44,-8055.71"/>
<polygon fill="black" stroke="black" points="3661.94,-8055.55 3658.44,-8045.55 3654.94,-8055.55 3661.94,-8055.55"/>
</g>
<!-- send_l9_e4_gpu4&#45;&gt;agg_l9 -->
<g id="edge675" class="edge">
<title>send_l9_e4_gpu4&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M3878.2,-7962.05C3915.58,-7957.11 3954.07,-7952.55 3990.44,-7949.16 4671.76,-7885.73 5469.37,-7860.7 5929.64,-7851.03"/>
<polygon fill="black" stroke="black" points="5929.85,-7854.52 5939.77,-7850.81 5929.7,-7847.52 5929.85,-7854.52"/>
</g>
<!-- expert_l9_e5_gpu5 -->
<g id="node519" class="node">
<title>expert_l9_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4549.44,-8150.33 4093.44,-8150.33 4093.44,-8082.33 4549.44,-8082.33 4549.44,-8150.33"/>
<text text-anchor="middle" x="4321.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E5</text>
<text text-anchor="middle" x="4321.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4321.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4321.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l9_e5_gpu5&#45;&gt;expert_l9_e5_gpu5 -->
<g id="edge677" class="edge">
<title>recv_l9_e5_gpu5&#45;&gt;expert_l9_e5_gpu5</title>
<path fill="none" stroke="black" d="M4321.44,-8187.13C4321.44,-8178.38 4321.44,-8169.27 4321.44,-8160.65"/>
<polygon fill="black" stroke="black" points="4324.94,-8160.41 4321.44,-8150.41 4317.94,-8160.41 4324.94,-8160.41"/>
</g>
<!-- send_l9_e5_gpu5 -->
<g id="node520" class="node">
<title>send_l9_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4321.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4321.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E5</text>
<text text-anchor="middle" x="4321.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4321.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4321.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l9_e5_gpu5&#45;&gt;send_l9_e5_gpu5 -->
<g id="edge678" class="edge">
<title>expert_l9_e5_gpu5&#45;&gt;send_l9_e5_gpu5</title>
<path fill="none" stroke="black" d="M4321.44,-8082.09C4321.44,-8073.84 4321.44,-8064.76 4321.44,-8055.71"/>
<polygon fill="black" stroke="black" points="4324.94,-8055.55 4321.44,-8045.55 4317.94,-8055.55 4324.94,-8055.55"/>
</g>
<!-- send_l9_e5_gpu5&#45;&gt;agg_l9 -->
<g id="edge679" class="edge">
<title>send_l9_e5_gpu5&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M4543.49,-7962.31C4580.16,-7957.41 4617.82,-7952.8 4653.44,-7949.16 5095.29,-7904.04 5605.57,-7875.56 5941.81,-7860.03"/>
<polygon fill="black" stroke="black" points="5942.38,-7863.51 5952.2,-7859.55 5942.05,-7856.52 5942.38,-7863.51"/>
</g>
<!-- expert_l9_e6_gpu6 -->
<g id="node522" class="node">
<title>expert_l9_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5212.44,-8150.33 4756.44,-8150.33 4756.44,-8082.33 5212.44,-8082.33 5212.44,-8150.33"/>
<text text-anchor="middle" x="4984.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E6</text>
<text text-anchor="middle" x="4984.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4984.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4984.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l9_e6_gpu6&#45;&gt;expert_l9_e6_gpu6 -->
<g id="edge681" class="edge">
<title>recv_l9_e6_gpu6&#45;&gt;expert_l9_e6_gpu6</title>
<path fill="none" stroke="black" d="M4984.44,-8187.13C4984.44,-8178.38 4984.44,-8169.27 4984.44,-8160.65"/>
<polygon fill="black" stroke="black" points="4987.94,-8160.41 4984.44,-8150.41 4980.94,-8160.41 4987.94,-8160.41"/>
</g>
<!-- send_l9_e6_gpu6 -->
<g id="node523" class="node">
<title>send_l9_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="4984.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4984.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E6</text>
<text text-anchor="middle" x="4984.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4984.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4984.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l9_e6_gpu6&#45;&gt;send_l9_e6_gpu6 -->
<g id="edge682" class="edge">
<title>expert_l9_e6_gpu6&#45;&gt;send_l9_e6_gpu6</title>
<path fill="none" stroke="black" d="M4984.44,-8082.09C4984.44,-8073.84 4984.44,-8064.76 4984.44,-8055.71"/>
<polygon fill="black" stroke="black" points="4987.94,-8055.55 4984.44,-8045.55 4980.94,-8055.55 4987.94,-8055.55"/>
</g>
<!-- send_l9_e6_gpu6&#45;&gt;agg_l9 -->
<g id="edge683" class="edge">
<title>send_l9_e6_gpu6&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M5211.1,-7962.97C5246.34,-7958.13 5282.35,-7953.36 5316.44,-7949.16 5532.57,-7922.54 5775.69,-7897.03 5967.39,-7877.93"/>
<polygon fill="black" stroke="black" points="5967.74,-7881.41 5977.34,-7876.94 5967.05,-7874.45 5967.74,-7881.41"/>
</g>
<!-- expert_l9_e7_gpu7 -->
<g id="node525" class="node">
<title>expert_l9_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5875.44,-8150.33 5419.44,-8150.33 5419.44,-8082.33 5875.44,-8082.33 5875.44,-8150.33"/>
<text text-anchor="middle" x="5647.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E7</text>
<text text-anchor="middle" x="5647.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5647.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5647.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l9_e7_gpu7&#45;&gt;expert_l9_e7_gpu7 -->
<g id="edge685" class="edge">
<title>recv_l9_e7_gpu7&#45;&gt;expert_l9_e7_gpu7</title>
<path fill="none" stroke="black" d="M5647.44,-8187.13C5647.44,-8178.38 5647.44,-8169.27 5647.44,-8160.65"/>
<polygon fill="black" stroke="black" points="5650.94,-8160.41 5647.44,-8150.41 5643.94,-8160.41 5650.94,-8160.41"/>
</g>
<!-- send_l9_e7_gpu7 -->
<g id="node526" class="node">
<title>send_l9_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5647.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5647.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E7</text>
<text text-anchor="middle" x="5647.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5647.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5647.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l9_e7_gpu7&#45;&gt;send_l9_e7_gpu7 -->
<g id="edge686" class="edge">
<title>expert_l9_e7_gpu7&#45;&gt;send_l9_e7_gpu7</title>
<path fill="none" stroke="black" d="M5647.44,-8082.09C5647.44,-8073.84 5647.44,-8064.76 5647.44,-8055.71"/>
<polygon fill="black" stroke="black" points="5650.94,-8055.55 5647.44,-8045.55 5643.94,-8055.55 5650.94,-8055.55"/>
</g>
<!-- send_l9_e7_gpu7&#45;&gt;agg_l9 -->
<g id="edge687" class="edge">
<title>send_l9_e7_gpu7&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M5821.2,-7956.65C5880.63,-7943.11 5948.87,-7927.56 6015.16,-7912.45"/>
<polygon fill="black" stroke="black" points="6015.95,-7915.86 6024.92,-7910.23 6014.39,-7909.04 6015.95,-7915.86"/>
</g>
<!-- expert_l9_e8_gpu8 -->
<g id="node528" class="node">
<title>expert_l9_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6538.44,-8150.33 6082.44,-8150.33 6082.44,-8082.33 6538.44,-8082.33 6538.44,-8150.33"/>
<text text-anchor="middle" x="6310.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E8</text>
<text text-anchor="middle" x="6310.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l9_e8_gpu8&#45;&gt;expert_l9_e8_gpu8 -->
<g id="edge689" class="edge">
<title>recv_l9_e8_gpu8&#45;&gt;expert_l9_e8_gpu8</title>
<path fill="none" stroke="black" d="M6310.44,-8187.13C6310.44,-8178.38 6310.44,-8169.27 6310.44,-8160.65"/>
<polygon fill="black" stroke="black" points="6313.94,-8160.41 6310.44,-8150.41 6306.94,-8160.41 6313.94,-8160.41"/>
</g>
<!-- send_l9_e8_gpu8 -->
<g id="node529" class="node">
<title>send_l9_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6310.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6310.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E8</text>
<text text-anchor="middle" x="6310.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6310.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l9_e8_gpu8&#45;&gt;send_l9_e8_gpu8 -->
<g id="edge690" class="edge">
<title>expert_l9_e8_gpu8&#45;&gt;send_l9_e8_gpu8</title>
<path fill="none" stroke="black" d="M6310.44,-8082.09C6310.44,-8073.84 6310.44,-8064.76 6310.44,-8055.71"/>
<polygon fill="black" stroke="black" points="6313.94,-8055.55 6310.44,-8045.55 6306.94,-8055.55 6313.94,-8055.55"/>
</g>
<!-- send_l9_e8_gpu8&#45;&gt;agg_l9 -->
<g id="edge691" class="edge">
<title>send_l9_e8_gpu8&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M6310.44,-7948.86C6310.44,-7940.43 6310.44,-7931.46 6310.44,-7922.46"/>
<polygon fill="black" stroke="black" points="6313.94,-7922.31 6310.44,-7912.31 6306.94,-7922.31 6313.94,-7922.31"/>
</g>
<!-- expert_l9_e9_gpu9 -->
<g id="node531" class="node">
<title>expert_l9_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7201.44,-8150.33 6745.44,-8150.33 6745.44,-8082.33 7201.44,-8082.33 7201.44,-8150.33"/>
<text text-anchor="middle" x="6973.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E9</text>
<text text-anchor="middle" x="6973.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6973.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6973.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l9_e9_gpu9&#45;&gt;expert_l9_e9_gpu9 -->
<g id="edge693" class="edge">
<title>recv_l9_e9_gpu9&#45;&gt;expert_l9_e9_gpu9</title>
<path fill="none" stroke="black" d="M6973.44,-8187.13C6973.44,-8178.38 6973.44,-8169.27 6973.44,-8160.65"/>
<polygon fill="black" stroke="black" points="6976.94,-8160.41 6973.44,-8150.41 6969.94,-8160.41 6976.94,-8160.41"/>
</g>
<!-- send_l9_e9_gpu9 -->
<g id="node532" class="node">
<title>send_l9_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="6973.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6973.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E9</text>
<text text-anchor="middle" x="6973.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6973.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6973.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l9_e9_gpu9&#45;&gt;send_l9_e9_gpu9 -->
<g id="edge694" class="edge">
<title>expert_l9_e9_gpu9&#45;&gt;send_l9_e9_gpu9</title>
<path fill="none" stroke="black" d="M6973.44,-8082.09C6973.44,-8073.84 6973.44,-8064.76 6973.44,-8055.71"/>
<polygon fill="black" stroke="black" points="6976.94,-8055.55 6973.44,-8045.55 6969.94,-8055.55 6976.94,-8055.55"/>
</g>
<!-- send_l9_e9_gpu9&#45;&gt;agg_l9 -->
<g id="edge695" class="edge">
<title>send_l9_e9_gpu9&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M6799.68,-7956.65C6742.84,-7943.7 6677.93,-7928.91 6614.39,-7914.43"/>
<polygon fill="black" stroke="black" points="6615.14,-7911.01 6604.61,-7912.2 6613.59,-7917.83 6615.14,-7911.01"/>
</g>
<!-- expert_l9_e10_gpu10 -->
<g id="node534" class="node">
<title>expert_l9_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7864.44,-8150.33 7408.44,-8150.33 7408.44,-8082.33 7864.44,-8082.33 7864.44,-8150.33"/>
<text text-anchor="middle" x="7636.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E10</text>
<text text-anchor="middle" x="7636.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7636.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7636.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l9_e10_gpu10&#45;&gt;expert_l9_e10_gpu10 -->
<g id="edge697" class="edge">
<title>recv_l9_e10_gpu10&#45;&gt;expert_l9_e10_gpu10</title>
<path fill="none" stroke="black" d="M7636.44,-8187.13C7636.44,-8178.38 7636.44,-8169.27 7636.44,-8160.65"/>
<polygon fill="black" stroke="black" points="7639.94,-8160.41 7636.44,-8150.41 7632.94,-8160.41 7639.94,-8160.41"/>
</g>
<!-- send_l9_e10_gpu10 -->
<g id="node535" class="node">
<title>send_l9_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7636.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7636.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E10</text>
<text text-anchor="middle" x="7636.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7636.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7636.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l9_e10_gpu10&#45;&gt;send_l9_e10_gpu10 -->
<g id="edge698" class="edge">
<title>expert_l9_e10_gpu10&#45;&gt;send_l9_e10_gpu10</title>
<path fill="none" stroke="black" d="M7636.44,-8082.09C7636.44,-8073.84 7636.44,-8064.76 7636.44,-8055.71"/>
<polygon fill="black" stroke="black" points="7639.94,-8055.55 7636.44,-8045.55 7632.94,-8055.55 7639.94,-8055.55"/>
</g>
<!-- send_l9_e10_gpu10&#45;&gt;agg_l9 -->
<g id="edge699" class="edge">
<title>send_l9_e10_gpu10&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M7409.78,-7962.97C7374.54,-7958.13 7338.53,-7953.36 7304.44,-7949.16 7128,-7927.43 6933.57,-7906.43 6763.81,-7889.07"/>
<polygon fill="black" stroke="black" points="6764,-7885.57 6753.69,-7888.03 6763.29,-7892.53 6764,-7885.57"/>
</g>
<!-- expert_l9_e11_gpu11 -->
<g id="node537" class="node">
<title>expert_l9_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8527.44,-8150.33 8071.44,-8150.33 8071.44,-8082.33 8527.44,-8082.33 8527.44,-8150.33"/>
<text text-anchor="middle" x="8299.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E11</text>
<text text-anchor="middle" x="8299.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8299.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8299.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l9_e11_gpu11&#45;&gt;expert_l9_e11_gpu11 -->
<g id="edge701" class="edge">
<title>recv_l9_e11_gpu11&#45;&gt;expert_l9_e11_gpu11</title>
<path fill="none" stroke="black" d="M8299.44,-8187.13C8299.44,-8178.38 8299.44,-8169.27 8299.44,-8160.65"/>
<polygon fill="black" stroke="black" points="8302.94,-8160.41 8299.44,-8150.41 8295.94,-8160.41 8302.94,-8160.41"/>
</g>
<!-- send_l9_e11_gpu11 -->
<g id="node538" class="node">
<title>send_l9_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8299.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8299.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E11</text>
<text text-anchor="middle" x="8299.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8299.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8299.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l9_e11_gpu11&#45;&gt;send_l9_e11_gpu11 -->
<g id="edge702" class="edge">
<title>expert_l9_e11_gpu11&#45;&gt;send_l9_e11_gpu11</title>
<path fill="none" stroke="black" d="M8299.44,-8082.09C8299.44,-8073.84 8299.44,-8064.76 8299.44,-8055.71"/>
<polygon fill="black" stroke="black" points="8302.94,-8055.55 8299.44,-8045.55 8295.94,-8055.55 8302.94,-8055.55"/>
</g>
<!-- send_l9_e11_gpu11&#45;&gt;agg_l9 -->
<g id="edge703" class="edge">
<title>send_l9_e11_gpu11&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M8077.4,-7962.31C8040.72,-7957.41 8003.06,-7952.8 7967.44,-7949.16 7545.81,-7906.1 7061.87,-7878.2 6726.31,-7862.24"/>
<polygon fill="black" stroke="black" points="6726.08,-7858.73 6715.92,-7861.75 6725.75,-7865.72 6726.08,-7858.73"/>
</g>
<!-- expert_l9_e12_gpu12 -->
<g id="node540" class="node">
<title>expert_l9_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9190.44,-8150.33 8734.44,-8150.33 8734.44,-8082.33 9190.44,-8082.33 9190.44,-8150.33"/>
<text text-anchor="middle" x="8962.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E12</text>
<text text-anchor="middle" x="8962.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8962.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8962.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l9_e12_gpu12&#45;&gt;expert_l9_e12_gpu12 -->
<g id="edge705" class="edge">
<title>recv_l9_e12_gpu12&#45;&gt;expert_l9_e12_gpu12</title>
<path fill="none" stroke="black" d="M8962.44,-8187.13C8962.44,-8178.38 8962.44,-8169.27 8962.44,-8160.65"/>
<polygon fill="black" stroke="black" points="8965.94,-8160.41 8962.44,-8150.41 8958.94,-8160.41 8965.94,-8160.41"/>
</g>
<!-- send_l9_e12_gpu12 -->
<g id="node541" class="node">
<title>send_l9_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="8962.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8962.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E12</text>
<text text-anchor="middle" x="8962.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8962.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8962.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l9_e12_gpu12&#45;&gt;send_l9_e12_gpu12 -->
<g id="edge706" class="edge">
<title>expert_l9_e12_gpu12&#45;&gt;send_l9_e12_gpu12</title>
<path fill="none" stroke="black" d="M8962.44,-8082.09C8962.44,-8073.84 8962.44,-8064.76 8962.44,-8055.71"/>
<polygon fill="black" stroke="black" points="8965.94,-8055.55 8962.44,-8045.55 8958.94,-8055.55 8965.94,-8055.55"/>
</g>
<!-- send_l9_e12_gpu12&#45;&gt;agg_l9 -->
<g id="edge707" class="edge">
<title>send_l9_e12_gpu12&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M8742.69,-7962.05C8705.3,-7957.11 8666.81,-7952.55 8630.44,-7949.16 7958.83,-7886.63 7174.23,-7861.42 6711.13,-7851.45"/>
<polygon fill="black" stroke="black" points="6711.01,-7847.95 6700.93,-7851.23 6710.86,-7854.94 6711.01,-7847.95"/>
</g>
<!-- expert_l9_e13_gpu13 -->
<g id="node543" class="node">
<title>expert_l9_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9853.44,-8150.33 9397.44,-8150.33 9397.44,-8082.33 9853.44,-8082.33 9853.44,-8150.33"/>
<text text-anchor="middle" x="9625.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E13</text>
<text text-anchor="middle" x="9625.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9625.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9625.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l9_e13_gpu13&#45;&gt;expert_l9_e13_gpu13 -->
<g id="edge709" class="edge">
<title>recv_l9_e13_gpu13&#45;&gt;expert_l9_e13_gpu13</title>
<path fill="none" stroke="black" d="M9625.44,-8187.13C9625.44,-8178.38 9625.44,-8169.27 9625.44,-8160.65"/>
<polygon fill="black" stroke="black" points="9628.94,-8160.41 9625.44,-8150.41 9621.94,-8160.41 9628.94,-8160.41"/>
</g>
<!-- send_l9_e13_gpu13 -->
<g id="node544" class="node">
<title>send_l9_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9625.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9625.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E13</text>
<text text-anchor="middle" x="9625.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9625.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9625.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l9_e13_gpu13&#45;&gt;send_l9_e13_gpu13 -->
<g id="edge710" class="edge">
<title>expert_l9_e13_gpu13&#45;&gt;send_l9_e13_gpu13</title>
<path fill="none" stroke="black" d="M9625.44,-8082.09C9625.44,-8073.84 9625.44,-8064.76 9625.44,-8055.71"/>
<polygon fill="black" stroke="black" points="9628.94,-8055.55 9625.44,-8045.55 9621.94,-8055.55 9628.94,-8055.55"/>
</g>
<!-- send_l9_e13_gpu13&#45;&gt;agg_l9 -->
<g id="edge711" class="edge">
<title>send_l9_e13_gpu13&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M9406.61,-7961.86C9368.94,-7956.9 9330.12,-7952.4 9293.44,-7949.16 8367.16,-7867.57 7273.8,-7849.26 6702.69,-7845.61"/>
<polygon fill="black" stroke="black" points="6702.67,-7842.11 6692.65,-7845.55 6702.63,-7849.11 6702.67,-7842.11"/>
</g>
<!-- expert_l9_e14_gpu14 -->
<g id="node546" class="node">
<title>expert_l9_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10516.44,-8150.33 10060.44,-8150.33 10060.44,-8082.33 10516.44,-8082.33 10516.44,-8150.33"/>
<text text-anchor="middle" x="10288.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E14</text>
<text text-anchor="middle" x="10288.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10288.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10288.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l9_e14_gpu14&#45;&gt;expert_l9_e14_gpu14 -->
<g id="edge713" class="edge">
<title>recv_l9_e14_gpu14&#45;&gt;expert_l9_e14_gpu14</title>
<path fill="none" stroke="black" d="M10288.44,-8187.13C10288.44,-8178.38 10288.44,-8169.27 10288.44,-8160.65"/>
<polygon fill="black" stroke="black" points="10291.94,-8160.41 10288.44,-8150.41 10284.94,-8160.41 10291.94,-8160.41"/>
</g>
<!-- send_l9_e14_gpu14 -->
<g id="node547" class="node">
<title>send_l9_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10288.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10288.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E14</text>
<text text-anchor="middle" x="10288.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10288.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10288.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l9_e14_gpu14&#45;&gt;send_l9_e14_gpu14 -->
<g id="edge714" class="edge">
<title>expert_l9_e14_gpu14&#45;&gt;send_l9_e14_gpu14</title>
<path fill="none" stroke="black" d="M10288.44,-8082.09C10288.44,-8073.84 10288.44,-8064.76 10288.44,-8055.71"/>
<polygon fill="black" stroke="black" points="10291.94,-8055.55 10288.44,-8045.55 10284.94,-8055.55 10291.94,-8055.55"/>
</g>
<!-- send_l9_e14_gpu14&#45;&gt;agg_l9 -->
<g id="edge715" class="edge">
<title>send_l9_e14_gpu14&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M10070.52,-7961.78C10032.57,-7956.8 9993.42,-7952.3 9956.44,-7949.16 9336.73,-7896.55 7521.4,-7863.45 6710.14,-7850.89"/>
<polygon fill="black" stroke="black" points="6710.1,-7847.39 6700.05,-7850.74 6709.99,-7854.39 6710.1,-7847.39"/>
</g>
<!-- expert_l9_e15_gpu15 -->
<g id="node549" class="node">
<title>expert_l9_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11179.44,-8150.33 10723.44,-8150.33 10723.44,-8082.33 11179.44,-8082.33 11179.44,-8150.33"/>
<text text-anchor="middle" x="10951.44" y="-8135.13" font-family="Times,serif" font-size="14.00">Expert L9E15</text>
<text text-anchor="middle" x="10951.44" y="-8120.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10951.44" y="-8105.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10951.44" y="-8090.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l9_e15_gpu15&#45;&gt;expert_l9_e15_gpu15 -->
<g id="edge717" class="edge">
<title>recv_l9_e15_gpu15&#45;&gt;expert_l9_e15_gpu15</title>
<path fill="none" stroke="black" d="M10951.44,-8187.13C10951.44,-8178.38 10951.44,-8169.27 10951.44,-8160.65"/>
<polygon fill="black" stroke="black" points="10954.94,-8160.41 10951.44,-8150.41 10947.94,-8160.41 10954.94,-8160.41"/>
</g>
<!-- send_l9_e15_gpu15 -->
<g id="node550" class="node">
<title>send_l9_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="10951.44" cy="-7997.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10951.44" y="-8016.05" font-family="Times,serif" font-size="14.00">Token Send L9E15</text>
<text text-anchor="middle" x="10951.44" y="-8001.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10951.44" y="-7986.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10951.44" y="-7971.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l9_e15_gpu15&#45;&gt;send_l9_e15_gpu15 -->
<g id="edge718" class="edge">
<title>expert_l9_e15_gpu15&#45;&gt;send_l9_e15_gpu15</title>
<path fill="none" stroke="black" d="M10951.44,-8082.09C10951.44,-8073.84 10951.44,-8064.76 10951.44,-8055.71"/>
<polygon fill="black" stroke="black" points="10954.94,-8055.55 10951.44,-8045.55 10947.94,-8055.55 10954.94,-8055.55"/>
</g>
<!-- send_l9_e15_gpu15&#45;&gt;agg_l9 -->
<g id="edge719" class="edge">
<title>send_l9_e15_gpu15&#45;&gt;agg_l9</title>
<path fill="none" stroke="black" d="M10733.97,-7961.7C10695.89,-7956.71 10656.57,-7952.24 10619.44,-7949.16 9867.12,-7886.95 7624.18,-7858.2 6707.48,-7848.81"/>
<polygon fill="black" stroke="black" points="6707.46,-7845.31 6697.43,-7848.71 6707.39,-7852.31 6707.46,-7845.31"/>
</g>
<!-- residual2_l9 -->
<g id="node552" class="node">
<title>residual2_l9</title>
<polygon fill="lightpink" stroke="black" points="6574.94,-7739.16 6139.94,-7739.16 6139.94,-7671.16 6574.94,-7671.16 6574.94,-7739.16"/>
<text text-anchor="middle" x="6357.44" y="-7723.96" font-family="Times,serif" font-size="14.00">ResidualAdd L9</text>
<text text-anchor="middle" x="6357.44" y="-7708.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6357.44" y="-7693.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6357.44" y="-7678.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l9&#45;&gt;residual2_l9 -->
<g id="edge720" class="edge">
<title>agg_l9&#45;&gt;residual2_l9</title>
<path fill="none" stroke="black" d="M6333.53,-7775.87C6336.66,-7766.73 6339.81,-7757.55 6342.74,-7749"/>
<polygon fill="black" stroke="black" points="6346.14,-7749.89 6346.08,-7739.29 6339.52,-7747.62 6346.14,-7749.89"/>
</g>
<!-- residual2_l9&#45;&gt;ln1_l10 -->
<g id="edge721" class="edge">
<title>residual2_l9&#45;&gt;ln1_l10</title>
<path fill="none" stroke="black" d="M6366.78,-7671.01C6369.18,-7662.46 6371.81,-7653.14 6374.33,-7644.17"/>
<polygon fill="black" stroke="black" points="6377.78,-7644.83 6377.12,-7634.26 6371.04,-7642.94 6377.78,-7644.83"/>
</g>
<!-- attn_l10 -->
<g id="node554" class="node">
<title>attn_l10</title>
<polygon fill="lightcoral" stroke="black" points="6616.44,-7529.16 6156.44,-7529.16 6156.44,-7461.16 6616.44,-7461.16 6616.44,-7529.16"/>
<text text-anchor="middle" x="6386.44" y="-7513.96" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L10</text>
<text text-anchor="middle" x="6386.44" y="-7498.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6386.44" y="-7483.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7468.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l10&#45;&gt;attn_l10 -->
<g id="edge724" class="edge">
<title>ln1_l10&#45;&gt;attn_l10</title>
<path fill="none" stroke="black" d="M6386.44,-7566.01C6386.44,-7557.55 6386.44,-7548.34 6386.44,-7539.46"/>
<polygon fill="black" stroke="black" points="6389.94,-7539.26 6386.44,-7529.26 6382.94,-7539.26 6389.94,-7539.26"/>
</g>
<!-- residual1_l10 -->
<g id="node555" class="node">
<title>residual1_l10</title>
<polygon fill="lightpink" stroke="black" points="6603.94,-7424.16 6168.94,-7424.16 6168.94,-7356.16 6603.94,-7356.16 6603.94,-7424.16"/>
<text text-anchor="middle" x="6386.44" y="-7408.96" font-family="Times,serif" font-size="14.00">ResidualAdd L10</text>
<text text-anchor="middle" x="6386.44" y="-7393.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7378.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7363.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l10&#45;&gt;residual1_l10 -->
<g id="edge725" class="edge">
<title>attn_l10&#45;&gt;residual1_l10</title>
<path fill="none" stroke="black" d="M6386.44,-7461.01C6386.44,-7452.55 6386.44,-7443.34 6386.44,-7434.46"/>
<polygon fill="black" stroke="black" points="6389.94,-7434.26 6386.44,-7424.26 6382.94,-7434.26 6389.94,-7434.26"/>
</g>
<!-- ln2_l10 -->
<g id="node556" class="node">
<title>ln2_l10</title>
<polygon fill="lightyellow" stroke="black" points="6603.94,-7319.16 6168.94,-7319.16 6168.94,-7251.16 6603.94,-7251.16 6603.94,-7319.16"/>
<text text-anchor="middle" x="6386.44" y="-7303.96" font-family="Times,serif" font-size="14.00">LayerNorm L10</text>
<text text-anchor="middle" x="6386.44" y="-7288.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7273.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-7258.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l10&#45;&gt;ln2_l10 -->
<g id="edge726" class="edge">
<title>residual1_l10&#45;&gt;ln2_l10</title>
<path fill="none" stroke="black" d="M6386.44,-7356.01C6386.44,-7347.55 6386.44,-7338.34 6386.44,-7329.46"/>
<polygon fill="black" stroke="black" points="6389.94,-7329.26 6386.44,-7319.26 6382.94,-7329.26 6389.94,-7329.26"/>
</g>
<!-- ln2_l10&#45;&gt;route_l10 -->
<g id="edge727" class="edge">
<title>ln2_l10&#45;&gt;route_l10</title>
<path fill="none" stroke="black" d="M6386.44,-7251C6386.44,-7242.86 6386.44,-7233.8 6386.44,-7224.52"/>
<polygon fill="black" stroke="black" points="6389.94,-7224.4 6386.44,-7214.4 6382.94,-7224.4 6389.94,-7224.4"/>
</g>
<!-- recv_l10_e0_gpu0 -->
<g id="node558" class="node">
<title>recv_l10_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1082.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1082.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E0</text>
<text text-anchor="middle" x="1082.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1082.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1082.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e0_gpu0 -->
<g id="edge728" class="edge">
<title>route_l10&#45;&gt;recv_l10_e0_gpu0</title>
<path fill="none" stroke="black" d="M6002.34,-7140.48C5260.72,-7130.75 3580,-7105.41 2166.44,-7060.16 1832.07,-7049.46 1747.56,-7058.02 1414.44,-7027.16 1381.33,-7024.1 1346.48,-7020.06 1312.29,-7015.63"/>
<polygon fill="black" stroke="black" points="1312.56,-7012.13 1302.19,-7014.3 1311.65,-7019.07 1312.56,-7012.13"/>
<text text-anchor="middle" x="2238.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l10_e1_gpu1 -->
<g id="node561" class="node">
<title>recv_l10_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1745.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1745.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E1</text>
<text text-anchor="middle" x="1745.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1745.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1745.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e1_gpu1 -->
<g id="edge732" class="edge">
<title>route_l10&#45;&gt;recv_l10_e1_gpu1</title>
<path fill="none" stroke="black" d="M5999.4,-7138.29C5347.9,-7126.19 3990.87,-7098.64 2843.44,-7060.16 2502.87,-7048.74 2416.76,-7058.46 2077.44,-7027.16 2044.33,-7024.11 2009.47,-7020.08 1975.29,-7015.65"/>
<polygon fill="black" stroke="black" points="1975.56,-7012.16 1965.19,-7014.33 1974.65,-7019.1 1975.56,-7012.16"/>
<text text-anchor="middle" x="2915.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l10_e2_gpu2 -->
<g id="node564" class="node">
<title>recv_l10_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2408.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2408.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E2</text>
<text text-anchor="middle" x="2408.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2408.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2408.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e2_gpu2 -->
<g id="edge736" class="edge">
<title>route_l10&#45;&gt;recv_l10_e2_gpu2</title>
<path fill="none" stroke="black" d="M5995.09,-7135.3C5441.03,-7120.94 4396.24,-7092.46 3506.44,-7060.16 3165.9,-7047.8 3079.76,-7058.46 2740.44,-7027.16 2707.33,-7024.11 2672.47,-7020.08 2638.29,-7015.65"/>
<polygon fill="black" stroke="black" points="2638.56,-7012.16 2628.19,-7014.33 2637.65,-7019.1 2638.56,-7012.16"/>
<text text-anchor="middle" x="3578.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l10_e3_gpu3 -->
<g id="node567" class="node">
<title>recv_l10_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3071.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3071.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E3</text>
<text text-anchor="middle" x="3071.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3071.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3071.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e3_gpu3 -->
<g id="edge740" class="edge">
<title>route_l10&#45;&gt;recv_l10_e3_gpu3</title>
<path fill="none" stroke="black" d="M5988.18,-7130.46C5544.4,-7113.95 4805.54,-7086.06 4169.44,-7060.16 3828.96,-7046.3 3742.76,-7058.46 3403.44,-7027.16 3370.33,-7024.11 3335.47,-7020.08 3301.29,-7015.65"/>
<polygon fill="black" stroke="black" points="3301.56,-7012.16 3291.19,-7014.33 3300.65,-7019.1 3301.56,-7012.16"/>
<text text-anchor="middle" x="4241.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l10_e4_gpu4 -->
<g id="node570" class="node">
<title>recv_l10_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3734.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3734.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E4</text>
<text text-anchor="middle" x="3734.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3734.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3734.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e4_gpu4 -->
<g id="edge744" class="edge">
<title>route_l10&#45;&gt;recv_l10_e4_gpu4</title>
<path fill="none" stroke="black" d="M5996.2,-7136.04C5534.53,-7122.77 4743.13,-7092.22 4066.44,-7027.16 4033.61,-7024.01 3999.05,-7019.94 3965.13,-7015.53"/>
<polygon fill="black" stroke="black" points="3965.48,-7012.04 3955.11,-7014.21 3964.57,-7018.98 3965.48,-7012.04"/>
<text text-anchor="middle" x="4517.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l10_e5_gpu5 -->
<g id="node573" class="node">
<title>recv_l10_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4397.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4397.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E5</text>
<text text-anchor="middle" x="4397.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4397.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4397.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e5_gpu5 -->
<g id="edge748" class="edge">
<title>route_l10&#45;&gt;recv_l10_e5_gpu5</title>
<path fill="none" stroke="black" d="M5978.86,-7124.09C5643.03,-7104.81 5154.6,-7072.39 4729.44,-7027.16 4697.44,-7023.76 4663.78,-7019.63 4630.66,-7015.25"/>
<polygon fill="black" stroke="black" points="4630.78,-7011.73 4620.41,-7013.88 4629.86,-7018.67 4630.78,-7011.73"/>
<text text-anchor="middle" x="5118.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l10_e6_gpu6 -->
<g id="node576" class="node">
<title>recv_l10_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5060.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5060.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E6</text>
<text text-anchor="middle" x="5060.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5060.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5060.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e6_gpu6 -->
<g id="edge752" class="edge">
<title>route_l10&#45;&gt;recv_l10_e6_gpu6</title>
<path fill="none" stroke="black" d="M5936.2,-7093.91C5765.75,-7073.93 5570.04,-7050.3 5392.44,-7027.16 5362.1,-7023.21 5330.22,-7018.9 5298.71,-7014.54"/>
<polygon fill="black" stroke="black" points="5298.89,-7011.03 5288.5,-7013.12 5297.93,-7017.96 5298.89,-7011.03"/>
<text text-anchor="middle" x="5710.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l10_e7_gpu7 -->
<g id="node579" class="node">
<title>recv_l10_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5723.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5723.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E7</text>
<text text-anchor="middle" x="5723.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5723.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5723.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e7_gpu7 -->
<g id="edge756" class="edge">
<title>route_l10&#45;&gt;recv_l10_e7_gpu7</title>
<path fill="none" stroke="black" d="M6117.25,-7078.14C6042.71,-7059.58 5963.82,-7039.93 5896.37,-7023.14"/>
<polygon fill="black" stroke="black" points="5897.06,-7019.7 5886.51,-7020.68 5895.37,-7026.5 5897.06,-7019.7"/>
<text text-anchor="middle" x="6107.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l10_e8_gpu8 -->
<g id="node582" class="node">
<title>recv_l10_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6386.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6386.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E8</text>
<text text-anchor="middle" x="6386.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e8_gpu8 -->
<g id="edge760" class="edge">
<title>route_l10&#45;&gt;recv_l10_e8_gpu8</title>
<path fill="none" stroke="black" d="M6386.44,-7078.02C6386.44,-7064.64 6386.44,-7050.69 6386.44,-7037.67"/>
<polygon fill="black" stroke="black" points="6389.94,-7037.44 6386.44,-7027.44 6382.94,-7037.44 6389.94,-7037.44"/>
<text text-anchor="middle" x="6458.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l10_e9_gpu9 -->
<g id="node585" class="node">
<title>recv_l10_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7049.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7049.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E9</text>
<text text-anchor="middle" x="7049.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7049.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7049.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e9_gpu9 -->
<g id="edge764" class="edge">
<title>route_l10&#45;&gt;recv_l10_e9_gpu9</title>
<path fill="none" stroke="black" d="M6655.63,-7078.14C6730.17,-7059.58 6809.06,-7039.93 6876.51,-7023.14"/>
<polygon fill="black" stroke="black" points="6877.51,-7026.5 6886.37,-7020.68 6875.82,-7019.7 6877.51,-7026.5"/>
<text text-anchor="middle" x="6849.44" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l10_e10_gpu10 -->
<g id="node588" class="node">
<title>recv_l10_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7712.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7712.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E10</text>
<text text-anchor="middle" x="7712.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7712.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7712.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e10_gpu10 -->
<g id="edge768" class="edge">
<title>route_l10&#45;&gt;recv_l10_e10_gpu10</title>
<path fill="none" stroke="black" d="M6709.27,-7108.72C6903.83,-7086.29 7156.53,-7056.33 7380.44,-7027.16 7410.78,-7023.21 7442.66,-7018.9 7474.17,-7014.54"/>
<polygon fill="black" stroke="black" points="7474.96,-7017.96 7484.38,-7013.12 7473.99,-7011.03 7474.96,-7017.96"/>
<text text-anchor="middle" x="7294.94" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l10_e11_gpu11 -->
<g id="node591" class="node">
<title>recv_l10_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8375.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8375.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E11</text>
<text text-anchor="middle" x="8375.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8375.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8375.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e11_gpu11 -->
<g id="edge772" class="edge">
<title>route_l10&#45;&gt;recv_l10_e11_gpu11</title>
<path fill="none" stroke="black" d="M6735.79,-7127.39C7071.56,-7108.62 7593.01,-7075.08 8043.44,-7027.16 8075.44,-7023.76 8109.1,-7019.63 8142.22,-7015.25"/>
<polygon fill="black" stroke="black" points="8143.02,-7018.67 8152.47,-7013.88 8142.1,-7011.73 8143.02,-7018.67"/>
<text text-anchor="middle" x="7940.94" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l10_e12_gpu12 -->
<g id="node594" class="node">
<title>recv_l10_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9038.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9038.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E12</text>
<text text-anchor="middle" x="9038.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9038.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9038.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e12_gpu12 -->
<g id="edge776" class="edge">
<title>route_l10&#45;&gt;recv_l10_e12_gpu12</title>
<path fill="none" stroke="black" d="M6749.35,-7136.82C7206.61,-7123.98 8016.2,-7093.53 8706.44,-7027.16 8739.27,-7024.01 8773.83,-7019.94 8807.75,-7015.53"/>
<polygon fill="black" stroke="black" points="8808.32,-7018.98 8817.77,-7014.21 8807.4,-7012.04 8808.32,-7018.98"/>
<text text-anchor="middle" x="8532.94" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l10_e13_gpu13 -->
<g id="node597" class="node">
<title>recv_l10_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9701.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9701.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E13</text>
<text text-anchor="middle" x="9701.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9701.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9701.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e13_gpu13 -->
<g id="edge780" class="edge">
<title>route_l10&#45;&gt;recv_l10_e13_gpu13</title>
<path fill="none" stroke="black" d="M6742.76,-7132.17C7182.49,-7115.99 7953.1,-7087.18 8613.44,-7060.16 8949.48,-7046.42 9034.55,-7058.15 9369.44,-7027.16 9402.55,-7024.1 9437.41,-7020.06 9471.59,-7015.63"/>
<polygon fill="black" stroke="black" points="9472.23,-7019.08 9481.69,-7014.31 9471.32,-7012.14 9472.23,-7019.08"/>
<text text-anchor="middle" x="9198.94" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l10_e14_gpu14 -->
<g id="node600" class="node">
<title>recv_l10_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10364.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10364.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E14</text>
<text text-anchor="middle" x="10364.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10364.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10364.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e14_gpu14 -->
<g id="edge784" class="edge">
<title>route_l10&#45;&gt;recv_l10_e14_gpu14</title>
<path fill="none" stroke="black" d="M6748.16,-7136.21C7295.91,-7122.28 8368.53,-7093.51 9279.44,-7060.16 9614.2,-7047.91 9698.88,-7058.05 10032.44,-7027.16 10065.55,-7024.1 10100.41,-7020.06 10134.59,-7015.63"/>
<polygon fill="black" stroke="black" points="10135.23,-7019.08 10144.69,-7014.31 10134.32,-7012.13 10135.23,-7019.08"/>
<text text-anchor="middle" x="9862.94" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l10_e15_gpu15 -->
<g id="node603" class="node">
<title>recv_l10_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11027.44" cy="-6979.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11027.44" y="-6997.88" font-family="Times,serif" font-size="14.00">Token Receive L10E15</text>
<text text-anchor="middle" x="11027.44" y="-6982.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11027.44" y="-6967.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11027.44" y="-6952.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l10&#45;&gt;recv_l10_e15_gpu15 -->
<g id="edge788" class="edge">
<title>route_l10&#45;&gt;recv_l10_e15_gpu15</title>
<path fill="none" stroke="black" d="M6751.99,-7138.84C7396.66,-7127.14 8777.79,-7099.66 9943.44,-7060.16 10277.79,-7048.83 10362.32,-7058.02 10695.44,-7027.16 10728.55,-7024.1 10763.41,-7020.06 10797.59,-7015.63"/>
<polygon fill="black" stroke="black" points="10798.23,-7019.07 10807.69,-7014.3 10797.32,-7012.13 10798.23,-7019.07"/>
<text text-anchor="middle" x="10525.94" y="-7048.96" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l10_e0_gpu0 -->
<g id="node559" class="node">
<title>expert_l10_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1310.44,-6894 854.44,-6894 854.44,-6826 1310.44,-6826 1310.44,-6894"/>
<text text-anchor="middle" x="1082.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E0</text>
<text text-anchor="middle" x="1082.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1082.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1082.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l10_e0_gpu0&#45;&gt;expert_l10_e0_gpu0 -->
<g id="edge729" class="edge">
<title>recv_l10_e0_gpu0&#45;&gt;expert_l10_e0_gpu0</title>
<path fill="none" stroke="black" d="M1082.44,-6930.8C1082.44,-6922.04 1082.44,-6912.94 1082.44,-6904.31"/>
<polygon fill="black" stroke="black" points="1085.94,-6904.08 1082.44,-6894.08 1078.94,-6904.08 1085.94,-6904.08"/>
</g>
<!-- send_l10_e0_gpu0 -->
<g id="node560" class="node">
<title>send_l10_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1082.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1082.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E0</text>
<text text-anchor="middle" x="1082.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1082.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1082.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l10_e0_gpu0&#45;&gt;send_l10_e0_gpu0 -->
<g id="edge730" class="edge">
<title>expert_l10_e0_gpu0&#45;&gt;send_l10_e0_gpu0</title>
<path fill="none" stroke="black" d="M1082.44,-6825.76C1082.44,-6817.51 1082.44,-6808.42 1082.44,-6799.38"/>
<polygon fill="black" stroke="black" points="1085.94,-6799.22 1082.44,-6789.22 1078.94,-6799.22 1085.94,-6799.22"/>
</g>
<!-- agg_l10 -->
<g id="node606" class="node">
<title>agg_l10</title>
<polygon fill="lightgray" stroke="black" points="6864.33,-6655.83 6104.12,-6655.83 5908.55,-6519.83 6668.76,-6519.83 6864.33,-6655.83"/>
<text text-anchor="middle" x="6386.44" y="-6606.63" font-family="Times,serif" font-size="14.00">Expert Aggregation L10</text>
<text text-anchor="middle" x="6386.44" y="-6591.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6576.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6561.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l10_e0_gpu0&#45;&gt;agg_l10 -->
<g id="edge731" class="edge">
<title>send_l10_e0_gpu0&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M1299.45,-6705.33C1337.68,-6700.33 1377.16,-6695.85 1414.44,-6692.83 2302.88,-6620.8 4992.64,-6597.31 6000.01,-6590.92"/>
<polygon fill="black" stroke="black" points="6000.34,-6594.41 6010.32,-6590.85 6000.29,-6587.41 6000.34,-6594.41"/>
</g>
<!-- expert_l10_e1_gpu1 -->
<g id="node562" class="node">
<title>expert_l10_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="1973.44,-6894 1517.44,-6894 1517.44,-6826 1973.44,-6826 1973.44,-6894"/>
<text text-anchor="middle" x="1745.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E1</text>
<text text-anchor="middle" x="1745.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1745.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1745.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l10_e1_gpu1&#45;&gt;expert_l10_e1_gpu1 -->
<g id="edge733" class="edge">
<title>recv_l10_e1_gpu1&#45;&gt;expert_l10_e1_gpu1</title>
<path fill="none" stroke="black" d="M1745.44,-6930.8C1745.44,-6922.04 1745.44,-6912.94 1745.44,-6904.31"/>
<polygon fill="black" stroke="black" points="1748.94,-6904.08 1745.44,-6894.08 1741.94,-6904.08 1748.94,-6904.08"/>
</g>
<!-- send_l10_e1_gpu1 -->
<g id="node563" class="node">
<title>send_l10_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1745.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1745.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E1</text>
<text text-anchor="middle" x="1745.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1745.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1745.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l10_e1_gpu1&#45;&gt;send_l10_e1_gpu1 -->
<g id="edge734" class="edge">
<title>expert_l10_e1_gpu1&#45;&gt;send_l10_e1_gpu1</title>
<path fill="none" stroke="black" d="M1745.44,-6825.76C1745.44,-6817.51 1745.44,-6808.42 1745.44,-6799.38"/>
<polygon fill="black" stroke="black" points="1748.94,-6799.22 1745.44,-6789.22 1741.94,-6799.22 1748.94,-6799.22"/>
</g>
<!-- send_l10_e1_gpu1&#45;&gt;agg_l10 -->
<g id="edge735" class="edge">
<title>send_l10_e1_gpu1&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M1962.91,-6705.37C2000.99,-6700.38 2040.31,-6695.9 2077.44,-6692.83 2833.27,-6630.33 5093.64,-6601.6 6002.13,-6592.35"/>
<polygon fill="black" stroke="black" points="6002.46,-6595.85 6012.42,-6592.25 6002.39,-6588.85 6002.46,-6595.85"/>
</g>
<!-- expert_l10_e2_gpu2 -->
<g id="node565" class="node">
<title>expert_l10_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2636.44,-6894 2180.44,-6894 2180.44,-6826 2636.44,-6826 2636.44,-6894"/>
<text text-anchor="middle" x="2408.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E2</text>
<text text-anchor="middle" x="2408.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2408.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2408.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l10_e2_gpu2&#45;&gt;expert_l10_e2_gpu2 -->
<g id="edge737" class="edge">
<title>recv_l10_e2_gpu2&#45;&gt;expert_l10_e2_gpu2</title>
<path fill="none" stroke="black" d="M2408.44,-6930.8C2408.44,-6922.04 2408.44,-6912.94 2408.44,-6904.31"/>
<polygon fill="black" stroke="black" points="2411.94,-6904.08 2408.44,-6894.08 2404.94,-6904.08 2411.94,-6904.08"/>
</g>
<!-- send_l10_e2_gpu2 -->
<g id="node566" class="node">
<title>send_l10_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2408.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2408.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E2</text>
<text text-anchor="middle" x="2408.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2408.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2408.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l10_e2_gpu2&#45;&gt;send_l10_e2_gpu2 -->
<g id="edge738" class="edge">
<title>expert_l10_e2_gpu2&#45;&gt;send_l10_e2_gpu2</title>
<path fill="none" stroke="black" d="M2408.44,-6825.76C2408.44,-6817.51 2408.44,-6808.42 2408.44,-6799.38"/>
<polygon fill="black" stroke="black" points="2411.94,-6799.22 2408.44,-6789.22 2404.94,-6799.22 2411.94,-6799.22"/>
</g>
<!-- send_l10_e2_gpu2&#45;&gt;agg_l10 -->
<g id="edge739" class="edge">
<title>send_l10_e2_gpu2&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M2626.36,-6705.45C2664.31,-6700.47 2703.46,-6695.97 2740.44,-6692.83 3364.79,-6639.82 5202.71,-6606.62 6004.78,-6594.28"/>
<polygon fill="black" stroke="black" points="6005.1,-6597.78 6015.05,-6594.12 6004.99,-6590.78 6005.1,-6597.78"/>
</g>
<!-- expert_l10_e3_gpu3 -->
<g id="node568" class="node">
<title>expert_l10_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3299.44,-6894 2843.44,-6894 2843.44,-6826 3299.44,-6826 3299.44,-6894"/>
<text text-anchor="middle" x="3071.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E3</text>
<text text-anchor="middle" x="3071.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3071.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3071.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l10_e3_gpu3&#45;&gt;expert_l10_e3_gpu3 -->
<g id="edge741" class="edge">
<title>recv_l10_e3_gpu3&#45;&gt;expert_l10_e3_gpu3</title>
<path fill="none" stroke="black" d="M3071.44,-6930.8C3071.44,-6922.04 3071.44,-6912.94 3071.44,-6904.31"/>
<polygon fill="black" stroke="black" points="3074.94,-6904.08 3071.44,-6894.08 3067.94,-6904.08 3074.94,-6904.08"/>
</g>
<!-- send_l10_e3_gpu3 -->
<g id="node569" class="node">
<title>send_l10_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3071.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3071.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E3</text>
<text text-anchor="middle" x="3071.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3071.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3071.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l10_e3_gpu3&#45;&gt;send_l10_e3_gpu3 -->
<g id="edge742" class="edge">
<title>expert_l10_e3_gpu3&#45;&gt;send_l10_e3_gpu3</title>
<path fill="none" stroke="black" d="M3071.44,-6825.76C3071.44,-6817.51 3071.44,-6808.42 3071.44,-6799.38"/>
<polygon fill="black" stroke="black" points="3074.94,-6799.22 3071.44,-6789.22 3067.94,-6799.22 3074.94,-6799.22"/>
</g>
<!-- send_l10_e3_gpu3&#45;&gt;agg_l10 -->
<g id="edge743" class="edge">
<title>send_l10_e3_gpu3&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M3290.27,-6705.53C3327.94,-6700.57 3366.76,-6696.06 3403.44,-6692.83 4331.8,-6611.05 5428,-6592.85 5998.04,-6589.26"/>
<polygon fill="black" stroke="black" points="5998.08,-6592.76 6008.06,-6589.19 5998.04,-6585.76 5998.08,-6592.76"/>
</g>
<!-- expert_l10_e4_gpu4 -->
<g id="node571" class="node">
<title>expert_l10_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="3962.44,-6894 3506.44,-6894 3506.44,-6826 3962.44,-6826 3962.44,-6894"/>
<text text-anchor="middle" x="3734.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E4</text>
<text text-anchor="middle" x="3734.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3734.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3734.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l10_e4_gpu4&#45;&gt;expert_l10_e4_gpu4 -->
<g id="edge745" class="edge">
<title>recv_l10_e4_gpu4&#45;&gt;expert_l10_e4_gpu4</title>
<path fill="none" stroke="black" d="M3734.44,-6930.8C3734.44,-6922.04 3734.44,-6912.94 3734.44,-6904.31"/>
<polygon fill="black" stroke="black" points="3737.94,-6904.08 3734.44,-6894.08 3730.94,-6904.08 3737.94,-6904.08"/>
</g>
<!-- send_l10_e4_gpu4 -->
<g id="node572" class="node">
<title>send_l10_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3734.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3734.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E4</text>
<text text-anchor="middle" x="3734.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3734.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3734.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l10_e4_gpu4&#45;&gt;send_l10_e4_gpu4 -->
<g id="edge746" class="edge">
<title>expert_l10_e4_gpu4&#45;&gt;send_l10_e4_gpu4</title>
<path fill="none" stroke="black" d="M3734.44,-6825.76C3734.44,-6817.51 3734.44,-6808.42 3734.44,-6799.38"/>
<polygon fill="black" stroke="black" points="3737.94,-6799.22 3734.44,-6789.22 3730.94,-6799.22 3737.94,-6799.22"/>
</g>
<!-- send_l10_e4_gpu4&#45;&gt;agg_l10 -->
<g id="edge747" class="edge">
<title>send_l10_e4_gpu4&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M3954.2,-6705.72C3991.58,-6700.77 4030.07,-6696.22 4066.44,-6692.83 4747.76,-6629.4 5545.37,-6604.36 6005.64,-6594.69"/>
<polygon fill="black" stroke="black" points="6005.85,-6598.19 6015.77,-6594.48 6005.7,-6591.19 6005.85,-6598.19"/>
</g>
<!-- expert_l10_e5_gpu5 -->
<g id="node574" class="node">
<title>expert_l10_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4625.44,-6894 4169.44,-6894 4169.44,-6826 4625.44,-6826 4625.44,-6894"/>
<text text-anchor="middle" x="4397.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E5</text>
<text text-anchor="middle" x="4397.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4397.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4397.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l10_e5_gpu5&#45;&gt;expert_l10_e5_gpu5 -->
<g id="edge749" class="edge">
<title>recv_l10_e5_gpu5&#45;&gt;expert_l10_e5_gpu5</title>
<path fill="none" stroke="black" d="M4397.44,-6930.8C4397.44,-6922.04 4397.44,-6912.94 4397.44,-6904.31"/>
<polygon fill="black" stroke="black" points="4400.94,-6904.08 4397.44,-6894.08 4393.94,-6904.08 4400.94,-6904.08"/>
</g>
<!-- send_l10_e5_gpu5 -->
<g id="node575" class="node">
<title>send_l10_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4397.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4397.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E5</text>
<text text-anchor="middle" x="4397.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4397.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4397.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l10_e5_gpu5&#45;&gt;send_l10_e5_gpu5 -->
<g id="edge750" class="edge">
<title>expert_l10_e5_gpu5&#45;&gt;send_l10_e5_gpu5</title>
<path fill="none" stroke="black" d="M4397.44,-6825.76C4397.44,-6817.51 4397.44,-6808.42 4397.44,-6799.38"/>
<polygon fill="black" stroke="black" points="4400.94,-6799.22 4397.44,-6789.22 4393.94,-6799.22 4400.94,-6799.22"/>
</g>
<!-- send_l10_e5_gpu5&#45;&gt;agg_l10 -->
<g id="edge751" class="edge">
<title>send_l10_e5_gpu5&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M4619.49,-6705.98C4656.16,-6701.08 4693.82,-6696.47 4729.44,-6692.83 5171.29,-6647.7 5681.57,-6619.22 6017.81,-6603.7"/>
<polygon fill="black" stroke="black" points="6018.38,-6607.18 6028.2,-6603.22 6018.05,-6600.18 6018.38,-6607.18"/>
</g>
<!-- expert_l10_e6_gpu6 -->
<g id="node577" class="node">
<title>expert_l10_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5288.44,-6894 4832.44,-6894 4832.44,-6826 5288.44,-6826 5288.44,-6894"/>
<text text-anchor="middle" x="5060.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E6</text>
<text text-anchor="middle" x="5060.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5060.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5060.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l10_e6_gpu6&#45;&gt;expert_l10_e6_gpu6 -->
<g id="edge753" class="edge">
<title>recv_l10_e6_gpu6&#45;&gt;expert_l10_e6_gpu6</title>
<path fill="none" stroke="black" d="M5060.44,-6930.8C5060.44,-6922.04 5060.44,-6912.94 5060.44,-6904.31"/>
<polygon fill="black" stroke="black" points="5063.94,-6904.08 5060.44,-6894.08 5056.94,-6904.08 5063.94,-6904.08"/>
</g>
<!-- send_l10_e6_gpu6 -->
<g id="node578" class="node">
<title>send_l10_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5060.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5060.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E6</text>
<text text-anchor="middle" x="5060.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5060.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5060.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l10_e6_gpu6&#45;&gt;send_l10_e6_gpu6 -->
<g id="edge754" class="edge">
<title>expert_l10_e6_gpu6&#45;&gt;send_l10_e6_gpu6</title>
<path fill="none" stroke="black" d="M5060.44,-6825.76C5060.44,-6817.51 5060.44,-6808.42 5060.44,-6799.38"/>
<polygon fill="black" stroke="black" points="5063.94,-6799.22 5060.44,-6789.22 5056.94,-6799.22 5063.94,-6799.22"/>
</g>
<!-- send_l10_e6_gpu6&#45;&gt;agg_l10 -->
<g id="edge755" class="edge">
<title>send_l10_e6_gpu6&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M5287.1,-6706.64C5322.34,-6701.8 5358.35,-6697.03 5392.44,-6692.83 5608.57,-6666.21 5851.69,-6640.69 6043.39,-6621.6"/>
<polygon fill="black" stroke="black" points="6043.74,-6625.08 6053.34,-6620.61 6043.05,-6618.12 6043.74,-6625.08"/>
</g>
<!-- expert_l10_e7_gpu7 -->
<g id="node580" class="node">
<title>expert_l10_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="5951.44,-6894 5495.44,-6894 5495.44,-6826 5951.44,-6826 5951.44,-6894"/>
<text text-anchor="middle" x="5723.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E7</text>
<text text-anchor="middle" x="5723.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5723.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5723.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l10_e7_gpu7&#45;&gt;expert_l10_e7_gpu7 -->
<g id="edge757" class="edge">
<title>recv_l10_e7_gpu7&#45;&gt;expert_l10_e7_gpu7</title>
<path fill="none" stroke="black" d="M5723.44,-6930.8C5723.44,-6922.04 5723.44,-6912.94 5723.44,-6904.31"/>
<polygon fill="black" stroke="black" points="5726.94,-6904.08 5723.44,-6894.08 5719.94,-6904.08 5726.94,-6904.08"/>
</g>
<!-- send_l10_e7_gpu7 -->
<g id="node581" class="node">
<title>send_l10_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5723.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5723.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E7</text>
<text text-anchor="middle" x="5723.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5723.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5723.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l10_e7_gpu7&#45;&gt;send_l10_e7_gpu7 -->
<g id="edge758" class="edge">
<title>expert_l10_e7_gpu7&#45;&gt;send_l10_e7_gpu7</title>
<path fill="none" stroke="black" d="M5723.44,-6825.76C5723.44,-6817.51 5723.44,-6808.42 5723.44,-6799.38"/>
<polygon fill="black" stroke="black" points="5726.94,-6799.22 5723.44,-6789.22 5719.94,-6799.22 5726.94,-6799.22"/>
</g>
<!-- send_l10_e7_gpu7&#45;&gt;agg_l10 -->
<g id="edge759" class="edge">
<title>send_l10_e7_gpu7&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M5897.2,-6700.32C5956.63,-6686.78 6024.87,-6671.23 6091.16,-6656.12"/>
<polygon fill="black" stroke="black" points="6091.95,-6659.53 6100.92,-6653.9 6090.39,-6652.71 6091.95,-6659.53"/>
</g>
<!-- expert_l10_e8_gpu8 -->
<g id="node583" class="node">
<title>expert_l10_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6614.44,-6894 6158.44,-6894 6158.44,-6826 6614.44,-6826 6614.44,-6894"/>
<text text-anchor="middle" x="6386.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E8</text>
<text text-anchor="middle" x="6386.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l10_e8_gpu8&#45;&gt;expert_l10_e8_gpu8 -->
<g id="edge761" class="edge">
<title>recv_l10_e8_gpu8&#45;&gt;expert_l10_e8_gpu8</title>
<path fill="none" stroke="black" d="M6386.44,-6930.8C6386.44,-6922.04 6386.44,-6912.94 6386.44,-6904.31"/>
<polygon fill="black" stroke="black" points="6389.94,-6904.08 6386.44,-6894.08 6382.94,-6904.08 6389.94,-6904.08"/>
</g>
<!-- send_l10_e8_gpu8 -->
<g id="node584" class="node">
<title>send_l10_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6386.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6386.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E8</text>
<text text-anchor="middle" x="6386.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6386.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l10_e8_gpu8&#45;&gt;send_l10_e8_gpu8 -->
<g id="edge762" class="edge">
<title>expert_l10_e8_gpu8&#45;&gt;send_l10_e8_gpu8</title>
<path fill="none" stroke="black" d="M6386.44,-6825.76C6386.44,-6817.51 6386.44,-6808.42 6386.44,-6799.38"/>
<polygon fill="black" stroke="black" points="6389.94,-6799.22 6386.44,-6789.22 6382.94,-6799.22 6389.94,-6799.22"/>
</g>
<!-- send_l10_e8_gpu8&#45;&gt;agg_l10 -->
<g id="edge763" class="edge">
<title>send_l10_e8_gpu8&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M6386.44,-6692.53C6386.44,-6684.1 6386.44,-6675.13 6386.44,-6666.13"/>
<polygon fill="black" stroke="black" points="6389.94,-6665.97 6386.44,-6655.97 6382.94,-6665.97 6389.94,-6665.97"/>
</g>
<!-- expert_l10_e9_gpu9 -->
<g id="node586" class="node">
<title>expert_l10_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7277.44,-6894 6821.44,-6894 6821.44,-6826 7277.44,-6826 7277.44,-6894"/>
<text text-anchor="middle" x="7049.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E9</text>
<text text-anchor="middle" x="7049.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7049.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7049.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l10_e9_gpu9&#45;&gt;expert_l10_e9_gpu9 -->
<g id="edge765" class="edge">
<title>recv_l10_e9_gpu9&#45;&gt;expert_l10_e9_gpu9</title>
<path fill="none" stroke="black" d="M7049.44,-6930.8C7049.44,-6922.04 7049.44,-6912.94 7049.44,-6904.31"/>
<polygon fill="black" stroke="black" points="7052.94,-6904.08 7049.44,-6894.08 7045.94,-6904.08 7052.94,-6904.08"/>
</g>
<!-- send_l10_e9_gpu9 -->
<g id="node587" class="node">
<title>send_l10_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7049.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7049.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E9</text>
<text text-anchor="middle" x="7049.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7049.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7049.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l10_e9_gpu9&#45;&gt;send_l10_e9_gpu9 -->
<g id="edge766" class="edge">
<title>expert_l10_e9_gpu9&#45;&gt;send_l10_e9_gpu9</title>
<path fill="none" stroke="black" d="M7049.44,-6825.76C7049.44,-6817.51 7049.44,-6808.42 7049.44,-6799.38"/>
<polygon fill="black" stroke="black" points="7052.94,-6799.22 7049.44,-6789.22 7045.94,-6799.22 7052.94,-6799.22"/>
</g>
<!-- send_l10_e9_gpu9&#45;&gt;agg_l10 -->
<g id="edge767" class="edge">
<title>send_l10_e9_gpu9&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M6875.68,-6700.32C6818.84,-6687.37 6753.93,-6672.58 6690.39,-6658.09"/>
<polygon fill="black" stroke="black" points="6691.14,-6654.68 6680.61,-6655.87 6689.59,-6661.5 6691.14,-6654.68"/>
</g>
<!-- expert_l10_e10_gpu10 -->
<g id="node589" class="node">
<title>expert_l10_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="7940.44,-6894 7484.44,-6894 7484.44,-6826 7940.44,-6826 7940.44,-6894"/>
<text text-anchor="middle" x="7712.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E10</text>
<text text-anchor="middle" x="7712.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7712.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7712.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l10_e10_gpu10&#45;&gt;expert_l10_e10_gpu10 -->
<g id="edge769" class="edge">
<title>recv_l10_e10_gpu10&#45;&gt;expert_l10_e10_gpu10</title>
<path fill="none" stroke="black" d="M7712.44,-6930.8C7712.44,-6922.04 7712.44,-6912.94 7712.44,-6904.31"/>
<polygon fill="black" stroke="black" points="7715.94,-6904.08 7712.44,-6894.08 7708.94,-6904.08 7715.94,-6904.08"/>
</g>
<!-- send_l10_e10_gpu10 -->
<g id="node590" class="node">
<title>send_l10_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7712.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7712.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E10</text>
<text text-anchor="middle" x="7712.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7712.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7712.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l10_e10_gpu10&#45;&gt;send_l10_e10_gpu10 -->
<g id="edge770" class="edge">
<title>expert_l10_e10_gpu10&#45;&gt;send_l10_e10_gpu10</title>
<path fill="none" stroke="black" d="M7712.44,-6825.76C7712.44,-6817.51 7712.44,-6808.42 7712.44,-6799.38"/>
<polygon fill="black" stroke="black" points="7715.94,-6799.22 7712.44,-6789.22 7708.94,-6799.22 7715.94,-6799.22"/>
</g>
<!-- send_l10_e10_gpu10&#45;&gt;agg_l10 -->
<g id="edge771" class="edge">
<title>send_l10_e10_gpu10&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M7485.78,-6706.64C7450.54,-6701.8 7414.53,-6697.03 7380.44,-6692.83 7204,-6671.1 7009.57,-6650.1 6839.81,-6632.73"/>
<polygon fill="black" stroke="black" points="6840,-6629.24 6829.69,-6631.7 6839.29,-6636.2 6840,-6629.24"/>
</g>
<!-- expert_l10_e11_gpu11 -->
<g id="node592" class="node">
<title>expert_l10_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8603.44,-6894 8147.44,-6894 8147.44,-6826 8603.44,-6826 8603.44,-6894"/>
<text text-anchor="middle" x="8375.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E11</text>
<text text-anchor="middle" x="8375.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8375.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8375.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l10_e11_gpu11&#45;&gt;expert_l10_e11_gpu11 -->
<g id="edge773" class="edge">
<title>recv_l10_e11_gpu11&#45;&gt;expert_l10_e11_gpu11</title>
<path fill="none" stroke="black" d="M8375.44,-6930.8C8375.44,-6922.04 8375.44,-6912.94 8375.44,-6904.31"/>
<polygon fill="black" stroke="black" points="8378.94,-6904.08 8375.44,-6894.08 8371.94,-6904.08 8378.94,-6904.08"/>
</g>
<!-- send_l10_e11_gpu11 -->
<g id="node593" class="node">
<title>send_l10_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8375.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8375.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E11</text>
<text text-anchor="middle" x="8375.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8375.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8375.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l10_e11_gpu11&#45;&gt;send_l10_e11_gpu11 -->
<g id="edge774" class="edge">
<title>expert_l10_e11_gpu11&#45;&gt;send_l10_e11_gpu11</title>
<path fill="none" stroke="black" d="M8375.44,-6825.76C8375.44,-6817.51 8375.44,-6808.42 8375.44,-6799.38"/>
<polygon fill="black" stroke="black" points="8378.94,-6799.22 8375.44,-6789.22 8371.94,-6799.22 8378.94,-6799.22"/>
</g>
<!-- send_l10_e11_gpu11&#45;&gt;agg_l10 -->
<g id="edge775" class="edge">
<title>send_l10_e11_gpu11&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M8153.4,-6705.98C8116.72,-6701.08 8079.06,-6696.47 8043.44,-6692.83 7621.81,-6649.77 7137.87,-6621.86 6802.31,-6605.91"/>
<polygon fill="black" stroke="black" points="6802.08,-6602.4 6791.92,-6605.42 6801.75,-6609.39 6802.08,-6602.4"/>
</g>
<!-- expert_l10_e12_gpu12 -->
<g id="node595" class="node">
<title>expert_l10_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9266.44,-6894 8810.44,-6894 8810.44,-6826 9266.44,-6826 9266.44,-6894"/>
<text text-anchor="middle" x="9038.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E12</text>
<text text-anchor="middle" x="9038.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9038.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9038.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l10_e12_gpu12&#45;&gt;expert_l10_e12_gpu12 -->
<g id="edge777" class="edge">
<title>recv_l10_e12_gpu12&#45;&gt;expert_l10_e12_gpu12</title>
<path fill="none" stroke="black" d="M9038.44,-6930.8C9038.44,-6922.04 9038.44,-6912.94 9038.44,-6904.31"/>
<polygon fill="black" stroke="black" points="9041.94,-6904.08 9038.44,-6894.08 9034.94,-6904.08 9041.94,-6904.08"/>
</g>
<!-- send_l10_e12_gpu12 -->
<g id="node596" class="node">
<title>send_l10_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9038.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9038.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E12</text>
<text text-anchor="middle" x="9038.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9038.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9038.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l10_e12_gpu12&#45;&gt;send_l10_e12_gpu12 -->
<g id="edge778" class="edge">
<title>expert_l10_e12_gpu12&#45;&gt;send_l10_e12_gpu12</title>
<path fill="none" stroke="black" d="M9038.44,-6825.76C9038.44,-6817.51 9038.44,-6808.42 9038.44,-6799.38"/>
<polygon fill="black" stroke="black" points="9041.94,-6799.22 9038.44,-6789.22 9034.94,-6799.22 9041.94,-6799.22"/>
</g>
<!-- send_l10_e12_gpu12&#45;&gt;agg_l10 -->
<g id="edge779" class="edge">
<title>send_l10_e12_gpu12&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M8818.69,-6705.72C8781.3,-6700.77 8742.81,-6696.22 8706.44,-6692.83 8034.83,-6630.3 7250.23,-6605.08 6787.13,-6595.12"/>
<polygon fill="black" stroke="black" points="6787.01,-6591.61 6776.93,-6594.9 6786.86,-6598.61 6787.01,-6591.61"/>
</g>
<!-- expert_l10_e13_gpu13 -->
<g id="node598" class="node">
<title>expert_l10_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="9929.44,-6894 9473.44,-6894 9473.44,-6826 9929.44,-6826 9929.44,-6894"/>
<text text-anchor="middle" x="9701.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E13</text>
<text text-anchor="middle" x="9701.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9701.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9701.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l10_e13_gpu13&#45;&gt;expert_l10_e13_gpu13 -->
<g id="edge781" class="edge">
<title>recv_l10_e13_gpu13&#45;&gt;expert_l10_e13_gpu13</title>
<path fill="none" stroke="black" d="M9701.44,-6930.8C9701.44,-6922.04 9701.44,-6912.94 9701.44,-6904.31"/>
<polygon fill="black" stroke="black" points="9704.94,-6904.08 9701.44,-6894.08 9697.94,-6904.08 9704.94,-6904.08"/>
</g>
<!-- send_l10_e13_gpu13 -->
<g id="node599" class="node">
<title>send_l10_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9701.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9701.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E13</text>
<text text-anchor="middle" x="9701.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9701.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9701.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l10_e13_gpu13&#45;&gt;send_l10_e13_gpu13 -->
<g id="edge782" class="edge">
<title>expert_l10_e13_gpu13&#45;&gt;send_l10_e13_gpu13</title>
<path fill="none" stroke="black" d="M9701.44,-6825.76C9701.44,-6817.51 9701.44,-6808.42 9701.44,-6799.38"/>
<polygon fill="black" stroke="black" points="9704.94,-6799.22 9701.44,-6789.22 9697.94,-6799.22 9704.94,-6799.22"/>
</g>
<!-- send_l10_e13_gpu13&#45;&gt;agg_l10 -->
<g id="edge783" class="edge">
<title>send_l10_e13_gpu13&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M9482.61,-6705.53C9444.94,-6700.57 9406.12,-6696.06 9369.44,-6692.83 8443.16,-6611.24 7349.8,-6592.93 6778.69,-6589.28"/>
<polygon fill="black" stroke="black" points="6778.67,-6585.78 6768.65,-6589.22 6778.63,-6592.78 6778.67,-6585.78"/>
</g>
<!-- expert_l10_e14_gpu14 -->
<g id="node601" class="node">
<title>expert_l10_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10592.44,-6894 10136.44,-6894 10136.44,-6826 10592.44,-6826 10592.44,-6894"/>
<text text-anchor="middle" x="10364.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E14</text>
<text text-anchor="middle" x="10364.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10364.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10364.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l10_e14_gpu14&#45;&gt;expert_l10_e14_gpu14 -->
<g id="edge785" class="edge">
<title>recv_l10_e14_gpu14&#45;&gt;expert_l10_e14_gpu14</title>
<path fill="none" stroke="black" d="M10364.44,-6930.8C10364.44,-6922.04 10364.44,-6912.94 10364.44,-6904.31"/>
<polygon fill="black" stroke="black" points="10367.94,-6904.08 10364.44,-6894.08 10360.94,-6904.08 10367.94,-6904.08"/>
</g>
<!-- send_l10_e14_gpu14 -->
<g id="node602" class="node">
<title>send_l10_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10364.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10364.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E14</text>
<text text-anchor="middle" x="10364.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10364.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10364.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l10_e14_gpu14&#45;&gt;send_l10_e14_gpu14 -->
<g id="edge786" class="edge">
<title>expert_l10_e14_gpu14&#45;&gt;send_l10_e14_gpu14</title>
<path fill="none" stroke="black" d="M10364.44,-6825.76C10364.44,-6817.51 10364.44,-6808.42 10364.44,-6799.38"/>
<polygon fill="black" stroke="black" points="10367.94,-6799.22 10364.44,-6789.22 10360.94,-6799.22 10367.94,-6799.22"/>
</g>
<!-- send_l10_e14_gpu14&#45;&gt;agg_l10 -->
<g id="edge787" class="edge">
<title>send_l10_e14_gpu14&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M10146.52,-6705.45C10108.57,-6700.47 10069.42,-6695.97 10032.44,-6692.83 9412.73,-6640.22 7597.4,-6607.11 6786.14,-6594.56"/>
<polygon fill="black" stroke="black" points="6786.1,-6591.06 6776.05,-6594.4 6785.99,-6598.06 6786.1,-6591.06"/>
</g>
<!-- expert_l10_e15_gpu15 -->
<g id="node604" class="node">
<title>expert_l10_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11255.44,-6894 10799.44,-6894 10799.44,-6826 11255.44,-6826 11255.44,-6894"/>
<text text-anchor="middle" x="11027.44" y="-6878.8" font-family="Times,serif" font-size="14.00">Expert L10E15</text>
<text text-anchor="middle" x="11027.44" y="-6863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11027.44" y="-6848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11027.44" y="-6833.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l10_e15_gpu15&#45;&gt;expert_l10_e15_gpu15 -->
<g id="edge789" class="edge">
<title>recv_l10_e15_gpu15&#45;&gt;expert_l10_e15_gpu15</title>
<path fill="none" stroke="black" d="M11027.44,-6930.8C11027.44,-6922.04 11027.44,-6912.94 11027.44,-6904.31"/>
<polygon fill="black" stroke="black" points="11030.94,-6904.08 11027.44,-6894.08 11023.94,-6904.08 11030.94,-6904.08"/>
</g>
<!-- send_l10_e15_gpu15 -->
<g id="node605" class="node">
<title>send_l10_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11027.44" cy="-6740.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11027.44" y="-6759.72" font-family="Times,serif" font-size="14.00">Token Send L10E15</text>
<text text-anchor="middle" x="11027.44" y="-6744.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11027.44" y="-6729.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11027.44" y="-6714.72" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l10_e15_gpu15&#45;&gt;send_l10_e15_gpu15 -->
<g id="edge790" class="edge">
<title>expert_l10_e15_gpu15&#45;&gt;send_l10_e15_gpu15</title>
<path fill="none" stroke="black" d="M11027.44,-6825.76C11027.44,-6817.51 11027.44,-6808.42 11027.44,-6799.38"/>
<polygon fill="black" stroke="black" points="11030.94,-6799.22 11027.44,-6789.22 11023.94,-6799.22 11030.94,-6799.22"/>
</g>
<!-- send_l10_e15_gpu15&#45;&gt;agg_l10 -->
<g id="edge791" class="edge">
<title>send_l10_e15_gpu15&#45;&gt;agg_l10</title>
<path fill="none" stroke="black" d="M10809.97,-6705.37C10771.89,-6700.38 10732.57,-6695.9 10695.44,-6692.83 9943.12,-6630.62 7700.18,-6601.87 6783.48,-6592.48"/>
<polygon fill="black" stroke="black" points="6783.46,-6588.98 6773.43,-6592.38 6783.39,-6595.98 6783.46,-6588.98"/>
</g>
<!-- residual2_l10 -->
<g id="node607" class="node">
<title>residual2_l10</title>
<polygon fill="lightpink" stroke="black" points="6632.94,-6482.83 6197.94,-6482.83 6197.94,-6414.83 6632.94,-6414.83 6632.94,-6482.83"/>
<text text-anchor="middle" x="6415.44" y="-6467.63" font-family="Times,serif" font-size="14.00">ResidualAdd L10</text>
<text text-anchor="middle" x="6415.44" y="-6452.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6415.44" y="-6437.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6415.44" y="-6422.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l10&#45;&gt;residual2_l10 -->
<g id="edge792" class="edge">
<title>agg_l10&#45;&gt;residual2_l10</title>
<path fill="none" stroke="black" d="M6400.69,-6519.54C6402.6,-6510.49 6404.52,-6501.42 6406.31,-6492.95"/>
<polygon fill="black" stroke="black" points="6409.78,-6493.47 6408.43,-6482.96 6402.93,-6492.02 6409.78,-6493.47"/>
</g>
<!-- residual2_l10&#45;&gt;ln1_l11 -->
<g id="edge793" class="edge">
<title>residual2_l10&#45;&gt;ln1_l11</title>
<path fill="none" stroke="black" d="M6430.57,-6414.67C6434.55,-6405.95 6438.91,-6396.41 6443.08,-6387.26"/>
<polygon fill="black" stroke="black" points="6446.37,-6388.48 6447.34,-6377.93 6440,-6385.57 6446.37,-6388.48"/>
</g>
<!-- attn_l11 -->
<g id="node609" class="node">
<title>attn_l11</title>
<polygon fill="lightcoral" stroke="black" points="6692.44,-6272.83 6232.44,-6272.83 6232.44,-6204.83 6692.44,-6204.83 6692.44,-6272.83"/>
<text text-anchor="middle" x="6462.44" y="-6257.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L11</text>
<text text-anchor="middle" x="6462.44" y="-6242.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6462.44" y="-6227.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6212.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l11&#45;&gt;attn_l11 -->
<g id="edge796" class="edge">
<title>ln1_l11&#45;&gt;attn_l11</title>
<path fill="none" stroke="black" d="M6462.44,-6309.67C6462.44,-6301.22 6462.44,-6292.01 6462.44,-6283.13"/>
<polygon fill="black" stroke="black" points="6465.94,-6282.93 6462.44,-6272.93 6458.94,-6282.93 6465.94,-6282.93"/>
</g>
<!-- residual1_l11 -->
<g id="node610" class="node">
<title>residual1_l11</title>
<polygon fill="lightpink" stroke="black" points="6679.94,-6167.83 6244.94,-6167.83 6244.94,-6099.83 6679.94,-6099.83 6679.94,-6167.83"/>
<text text-anchor="middle" x="6462.44" y="-6152.63" font-family="Times,serif" font-size="14.00">ResidualAdd L11</text>
<text text-anchor="middle" x="6462.44" y="-6137.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6122.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6107.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l11&#45;&gt;residual1_l11 -->
<g id="edge797" class="edge">
<title>attn_l11&#45;&gt;residual1_l11</title>
<path fill="none" stroke="black" d="M6462.44,-6204.67C6462.44,-6196.22 6462.44,-6187.01 6462.44,-6178.13"/>
<polygon fill="black" stroke="black" points="6465.94,-6177.93 6462.44,-6167.93 6458.94,-6177.93 6465.94,-6177.93"/>
</g>
<!-- ln2_l11 -->
<g id="node611" class="node">
<title>ln2_l11</title>
<polygon fill="lightyellow" stroke="black" points="6679.94,-6062.83 6244.94,-6062.83 6244.94,-5994.83 6679.94,-5994.83 6679.94,-6062.83"/>
<text text-anchor="middle" x="6462.44" y="-6047.63" font-family="Times,serif" font-size="14.00">LayerNorm L11</text>
<text text-anchor="middle" x="6462.44" y="-6032.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6017.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-6002.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l11&#45;&gt;ln2_l11 -->
<g id="edge798" class="edge">
<title>residual1_l11&#45;&gt;ln2_l11</title>
<path fill="none" stroke="black" d="M6462.44,-6099.67C6462.44,-6091.22 6462.44,-6082.01 6462.44,-6073.13"/>
<polygon fill="black" stroke="black" points="6465.94,-6072.93 6462.44,-6062.93 6458.94,-6072.93 6465.94,-6072.93"/>
</g>
<!-- ln2_l11&#45;&gt;route_l11 -->
<g id="edge799" class="edge">
<title>ln2_l11&#45;&gt;route_l11</title>
<path fill="none" stroke="black" d="M6462.44,-5994.67C6462.44,-5986.53 6462.44,-5977.47 6462.44,-5968.19"/>
<polygon fill="black" stroke="black" points="6465.94,-5968.06 6462.44,-5958.06 6458.94,-5968.07 6465.94,-5968.06"/>
</g>
<!-- recv_l11_e0_gpu0 -->
<g id="node613" class="node">
<title>recv_l11_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1158.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1158.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E0</text>
<text text-anchor="middle" x="1158.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1158.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1158.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e0_gpu0 -->
<g id="edge800" class="edge">
<title>route_l11&#45;&gt;recv_l11_e0_gpu0</title>
<path fill="none" stroke="black" d="M6078.34,-5884.14C5336.72,-5874.41 3656,-5849.08 2242.44,-5803.83 1908.07,-5793.13 1823.56,-5801.69 1490.44,-5770.83 1457.33,-5767.77 1422.48,-5763.72 1388.29,-5759.29"/>
<polygon fill="black" stroke="black" points="1388.56,-5755.8 1378.19,-5757.97 1387.65,-5762.74 1388.56,-5755.8"/>
<text text-anchor="middle" x="2314.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l11_e1_gpu1 -->
<g id="node616" class="node">
<title>recv_l11_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1821.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1821.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E1</text>
<text text-anchor="middle" x="1821.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1821.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1821.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e1_gpu1 -->
<g id="edge804" class="edge">
<title>route_l11&#45;&gt;recv_l11_e1_gpu1</title>
<path fill="none" stroke="black" d="M6075.4,-5881.96C5423.9,-5869.85 4066.87,-5842.31 2919.44,-5803.83 2578.87,-5792.41 2492.76,-5802.13 2153.44,-5770.83 2120.33,-5767.78 2085.47,-5763.74 2051.29,-5759.32"/>
<polygon fill="black" stroke="black" points="2051.56,-5755.82 2041.19,-5758 2050.65,-5762.76 2051.56,-5755.82"/>
<text text-anchor="middle" x="2991.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l11_e2_gpu2 -->
<g id="node619" class="node">
<title>recv_l11_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2484.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2484.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E2</text>
<text text-anchor="middle" x="2484.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2484.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2484.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e2_gpu2 -->
<g id="edge808" class="edge">
<title>route_l11&#45;&gt;recv_l11_e2_gpu2</title>
<path fill="none" stroke="black" d="M6071.09,-5878.96C5517.03,-5864.61 4472.24,-5836.13 3582.44,-5803.83 3241.9,-5791.47 3155.76,-5802.13 2816.44,-5770.83 2783.33,-5767.78 2748.47,-5763.74 2714.29,-5759.32"/>
<polygon fill="black" stroke="black" points="2714.56,-5755.82 2704.19,-5758 2713.65,-5762.76 2714.56,-5755.82"/>
<text text-anchor="middle" x="3654.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l11_e3_gpu3 -->
<g id="node622" class="node">
<title>recv_l11_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3147.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3147.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E3</text>
<text text-anchor="middle" x="3147.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3147.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3147.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e3_gpu3 -->
<g id="edge812" class="edge">
<title>route_l11&#45;&gt;recv_l11_e3_gpu3</title>
<path fill="none" stroke="black" d="M6064.18,-5874.13C5620.4,-5857.62 4881.54,-5829.73 4245.44,-5803.83 3904.96,-5789.97 3818.76,-5802.13 3479.44,-5770.83 3446.33,-5767.78 3411.47,-5763.74 3377.29,-5759.32"/>
<polygon fill="black" stroke="black" points="3377.56,-5755.82 3367.19,-5758 3376.65,-5762.76 3377.56,-5755.82"/>
<text text-anchor="middle" x="4317.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l11_e4_gpu4 -->
<g id="node625" class="node">
<title>recv_l11_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3810.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3810.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E4</text>
<text text-anchor="middle" x="3810.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3810.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3810.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e4_gpu4 -->
<g id="edge816" class="edge">
<title>route_l11&#45;&gt;recv_l11_e4_gpu4</title>
<path fill="none" stroke="black" d="M6072.2,-5879.71C5610.53,-5866.43 4819.13,-5835.89 4142.44,-5770.83 4109.61,-5767.68 4075.05,-5763.61 4041.13,-5759.19"/>
<polygon fill="black" stroke="black" points="4041.48,-5755.71 4031.11,-5757.87 4040.57,-5762.65 4041.48,-5755.71"/>
<text text-anchor="middle" x="4593.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l11_e5_gpu5 -->
<g id="node628" class="node">
<title>recv_l11_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4473.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4473.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E5</text>
<text text-anchor="middle" x="4473.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4473.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4473.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e5_gpu5 -->
<g id="edge820" class="edge">
<title>route_l11&#45;&gt;recv_l11_e5_gpu5</title>
<path fill="none" stroke="black" d="M6054.86,-5867.75C5719.03,-5848.48 5230.6,-5816.06 4805.44,-5770.83 4773.44,-5767.43 4739.78,-5763.3 4706.66,-5758.91"/>
<polygon fill="black" stroke="black" points="4706.78,-5755.4 4696.41,-5757.55 4705.86,-5762.34 4706.78,-5755.4"/>
<text text-anchor="middle" x="5194.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l11_e6_gpu6 -->
<g id="node631" class="node">
<title>recv_l11_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5136.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5136.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E6</text>
<text text-anchor="middle" x="5136.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5136.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5136.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e6_gpu6 -->
<g id="edge824" class="edge">
<title>route_l11&#45;&gt;recv_l11_e6_gpu6</title>
<path fill="none" stroke="black" d="M6012.2,-5837.58C5841.75,-5817.6 5646.04,-5793.96 5468.44,-5770.83 5438.1,-5766.88 5406.22,-5762.57 5374.71,-5758.2"/>
<polygon fill="black" stroke="black" points="5374.89,-5754.7 5364.5,-5756.79 5373.93,-5761.63 5374.89,-5754.7"/>
<text text-anchor="middle" x="5786.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l11_e7_gpu7 -->
<g id="node634" class="node">
<title>recv_l11_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5799.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5799.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E7</text>
<text text-anchor="middle" x="5799.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5799.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5799.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e7_gpu7 -->
<g id="edge828" class="edge">
<title>route_l11&#45;&gt;recv_l11_e7_gpu7</title>
<path fill="none" stroke="black" d="M6193.25,-5821.81C6118.71,-5803.25 6039.82,-5783.6 5972.37,-5766.81"/>
<polygon fill="black" stroke="black" points="5973.06,-5763.37 5962.51,-5764.35 5971.37,-5770.16 5973.06,-5763.37"/>
<text text-anchor="middle" x="6183.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l11_e8_gpu8 -->
<g id="node637" class="node">
<title>recv_l11_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6462.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6462.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E8</text>
<text text-anchor="middle" x="6462.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e8_gpu8 -->
<g id="edge832" class="edge">
<title>route_l11&#45;&gt;recv_l11_e8_gpu8</title>
<path fill="none" stroke="black" d="M6462.44,-5821.69C6462.44,-5808.3 6462.44,-5794.36 6462.44,-5781.33"/>
<polygon fill="black" stroke="black" points="6465.94,-5781.11 6462.44,-5771.11 6458.94,-5781.11 6465.94,-5781.11"/>
<text text-anchor="middle" x="6534.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l11_e9_gpu9 -->
<g id="node640" class="node">
<title>recv_l11_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7125.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7125.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E9</text>
<text text-anchor="middle" x="7125.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7125.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7125.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e9_gpu9 -->
<g id="edge836" class="edge">
<title>route_l11&#45;&gt;recv_l11_e9_gpu9</title>
<path fill="none" stroke="black" d="M6731.63,-5821.81C6806.17,-5803.25 6885.06,-5783.6 6952.51,-5766.81"/>
<polygon fill="black" stroke="black" points="6953.51,-5770.16 6962.37,-5764.35 6951.82,-5763.37 6953.51,-5770.16"/>
<text text-anchor="middle" x="6925.44" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l11_e10_gpu10 -->
<g id="node643" class="node">
<title>recv_l11_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7788.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7788.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E10</text>
<text text-anchor="middle" x="7788.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7788.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7788.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e10_gpu10 -->
<g id="edge840" class="edge">
<title>route_l11&#45;&gt;recv_l11_e10_gpu10</title>
<path fill="none" stroke="black" d="M6785.27,-5852.39C6979.83,-5829.95 7232.53,-5800 7456.44,-5770.83 7486.78,-5766.88 7518.66,-5762.57 7550.17,-5758.2"/>
<polygon fill="black" stroke="black" points="7550.96,-5761.63 7560.38,-5756.79 7549.99,-5754.7 7550.96,-5761.63"/>
<text text-anchor="middle" x="7370.94" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l11_e11_gpu11 -->
<g id="node646" class="node">
<title>recv_l11_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8451.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8451.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E11</text>
<text text-anchor="middle" x="8451.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8451.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8451.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e11_gpu11 -->
<g id="edge844" class="edge">
<title>route_l11&#45;&gt;recv_l11_e11_gpu11</title>
<path fill="none" stroke="black" d="M6811.79,-5871.05C7147.56,-5852.29 7669.01,-5818.75 8119.44,-5770.83 8151.44,-5767.43 8185.1,-5763.3 8218.22,-5758.91"/>
<polygon fill="black" stroke="black" points="8219.02,-5762.34 8228.47,-5757.55 8218.1,-5755.4 8219.02,-5762.34"/>
<text text-anchor="middle" x="8016.94" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l11_e12_gpu12 -->
<g id="node649" class="node">
<title>recv_l11_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9114.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9114.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E12</text>
<text text-anchor="middle" x="9114.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9114.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9114.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e12_gpu12 -->
<g id="edge848" class="edge">
<title>route_l11&#45;&gt;recv_l11_e12_gpu12</title>
<path fill="none" stroke="black" d="M6825.35,-5880.48C7282.61,-5867.64 8092.2,-5837.19 8782.44,-5770.83 8815.27,-5767.68 8849.83,-5763.61 8883.75,-5759.19"/>
<polygon fill="black" stroke="black" points="8884.32,-5762.65 8893.77,-5757.87 8883.4,-5755.71 8884.32,-5762.65"/>
<text text-anchor="middle" x="8608.94" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l11_e13_gpu13 -->
<g id="node652" class="node">
<title>recv_l11_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9777.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9777.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E13</text>
<text text-anchor="middle" x="9777.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9777.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9777.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e13_gpu13 -->
<g id="edge852" class="edge">
<title>route_l11&#45;&gt;recv_l11_e13_gpu13</title>
<path fill="none" stroke="black" d="M6818.76,-5875.83C7258.49,-5859.65 8029.1,-5830.85 8689.44,-5803.83 9025.48,-5790.08 9110.55,-5801.81 9445.44,-5770.83 9478.55,-5767.77 9513.41,-5763.73 9547.59,-5759.3"/>
<polygon fill="black" stroke="black" points="9548.23,-5762.75 9557.69,-5757.98 9547.32,-5755.81 9548.23,-5762.75"/>
<text text-anchor="middle" x="9274.94" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l11_e14_gpu14 -->
<g id="node655" class="node">
<title>recv_l11_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10440.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10440.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E14</text>
<text text-anchor="middle" x="10440.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10440.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10440.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e14_gpu14 -->
<g id="edge856" class="edge">
<title>route_l11&#45;&gt;recv_l11_e14_gpu14</title>
<path fill="none" stroke="black" d="M6824.16,-5879.88C7371.91,-5865.94 8444.53,-5837.17 9355.44,-5803.83 9690.2,-5791.58 9774.88,-5801.72 10108.44,-5770.83 10141.55,-5767.77 10176.41,-5763.72 10210.59,-5759.3"/>
<polygon fill="black" stroke="black" points="10211.23,-5762.74 10220.69,-5757.97 10210.32,-5755.8 10211.23,-5762.74"/>
<text text-anchor="middle" x="9938.94" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l11_e15_gpu15 -->
<g id="node658" class="node">
<title>recv_l11_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11103.44" cy="-5722.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11103.44" y="-5741.55" font-family="Times,serif" font-size="14.00">Token Receive L11E15</text>
<text text-anchor="middle" x="11103.44" y="-5726.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11103.44" y="-5711.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11103.44" y="-5696.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l11&#45;&gt;recv_l11_e15_gpu15 -->
<g id="edge860" class="edge">
<title>route_l11&#45;&gt;recv_l11_e15_gpu15</title>
<path fill="none" stroke="black" d="M6827.99,-5882.5C7472.66,-5870.8 8853.79,-5843.33 10019.44,-5803.83 10353.79,-5792.5 10438.32,-5801.69 10771.44,-5770.83 10804.55,-5767.77 10839.41,-5763.72 10873.59,-5759.29"/>
<polygon fill="black" stroke="black" points="10874.23,-5762.74 10883.69,-5757.97 10873.32,-5755.8 10874.23,-5762.74"/>
<text text-anchor="middle" x="10601.94" y="-5792.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l11_e0_gpu0 -->
<g id="node614" class="node">
<title>expert_l11_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1386.44,-5637.67 930.44,-5637.67 930.44,-5569.67 1386.44,-5569.67 1386.44,-5637.67"/>
<text text-anchor="middle" x="1158.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E0</text>
<text text-anchor="middle" x="1158.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1158.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1158.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l11_e0_gpu0&#45;&gt;expert_l11_e0_gpu0 -->
<g id="edge801" class="edge">
<title>recv_l11_e0_gpu0&#45;&gt;expert_l11_e0_gpu0</title>
<path fill="none" stroke="black" d="M1158.44,-5674.46C1158.44,-5665.71 1158.44,-5656.61 1158.44,-5647.98"/>
<polygon fill="black" stroke="black" points="1161.94,-5647.75 1158.44,-5637.75 1154.94,-5647.75 1161.94,-5647.75"/>
</g>
<!-- send_l11_e0_gpu0 -->
<g id="node615" class="node">
<title>send_l11_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1158.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1158.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E0</text>
<text text-anchor="middle" x="1158.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1158.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1158.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l11_e0_gpu0&#45;&gt;send_l11_e0_gpu0 -->
<g id="edge802" class="edge">
<title>expert_l11_e0_gpu0&#45;&gt;send_l11_e0_gpu0</title>
<path fill="none" stroke="black" d="M1158.44,-5569.43C1158.44,-5561.17 1158.44,-5552.09 1158.44,-5543.04"/>
<polygon fill="black" stroke="black" points="1161.94,-5542.89 1158.44,-5532.89 1154.94,-5542.89 1161.94,-5542.89"/>
</g>
<!-- agg_l11 -->
<g id="node661" class="node">
<title>agg_l11</title>
<polygon fill="lightgray" stroke="black" points="6940.33,-5399.5 6180.12,-5399.5 5984.55,-5263.5 6744.76,-5263.5 6940.33,-5399.5"/>
<text text-anchor="middle" x="6462.44" y="-5350.3" font-family="Times,serif" font-size="14.00">Expert Aggregation L11</text>
<text text-anchor="middle" x="6462.44" y="-5335.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5320.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5305.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l11_e0_gpu0&#45;&gt;agg_l11 -->
<g id="edge803" class="edge">
<title>send_l11_e0_gpu0&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M1375.45,-5448.99C1413.68,-5443.99 1453.16,-5439.52 1490.44,-5436.5 2378.88,-5364.47 5068.64,-5340.98 6076.01,-5334.58"/>
<polygon fill="black" stroke="black" points="6076.34,-5338.08 6086.32,-5334.52 6076.29,-5331.08 6076.34,-5338.08"/>
</g>
<!-- expert_l11_e1_gpu1 -->
<g id="node617" class="node">
<title>expert_l11_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="2049.44,-5637.67 1593.44,-5637.67 1593.44,-5569.67 2049.44,-5569.67 2049.44,-5637.67"/>
<text text-anchor="middle" x="1821.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E1</text>
<text text-anchor="middle" x="1821.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1821.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1821.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l11_e1_gpu1&#45;&gt;expert_l11_e1_gpu1 -->
<g id="edge805" class="edge">
<title>recv_l11_e1_gpu1&#45;&gt;expert_l11_e1_gpu1</title>
<path fill="none" stroke="black" d="M1821.44,-5674.46C1821.44,-5665.71 1821.44,-5656.61 1821.44,-5647.98"/>
<polygon fill="black" stroke="black" points="1824.94,-5647.75 1821.44,-5637.75 1817.94,-5647.75 1824.94,-5647.75"/>
</g>
<!-- send_l11_e1_gpu1 -->
<g id="node618" class="node">
<title>send_l11_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1821.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1821.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E1</text>
<text text-anchor="middle" x="1821.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1821.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1821.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l11_e1_gpu1&#45;&gt;send_l11_e1_gpu1 -->
<g id="edge806" class="edge">
<title>expert_l11_e1_gpu1&#45;&gt;send_l11_e1_gpu1</title>
<path fill="none" stroke="black" d="M1821.44,-5569.43C1821.44,-5561.17 1821.44,-5552.09 1821.44,-5543.04"/>
<polygon fill="black" stroke="black" points="1824.94,-5542.89 1821.44,-5532.89 1817.94,-5542.89 1824.94,-5542.89"/>
</g>
<!-- send_l11_e1_gpu1&#45;&gt;agg_l11 -->
<g id="edge807" class="edge">
<title>send_l11_e1_gpu1&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M2038.91,-5449.04C2076.99,-5444.05 2116.31,-5439.57 2153.44,-5436.5 2909.27,-5374 5169.64,-5345.27 6078.13,-5336.02"/>
<polygon fill="black" stroke="black" points="6078.46,-5339.52 6088.42,-5335.91 6078.39,-5332.52 6078.46,-5339.52"/>
</g>
<!-- expert_l11_e2_gpu2 -->
<g id="node620" class="node">
<title>expert_l11_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2712.44,-5637.67 2256.44,-5637.67 2256.44,-5569.67 2712.44,-5569.67 2712.44,-5637.67"/>
<text text-anchor="middle" x="2484.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E2</text>
<text text-anchor="middle" x="2484.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2484.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2484.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l11_e2_gpu2&#45;&gt;expert_l11_e2_gpu2 -->
<g id="edge809" class="edge">
<title>recv_l11_e2_gpu2&#45;&gt;expert_l11_e2_gpu2</title>
<path fill="none" stroke="black" d="M2484.44,-5674.46C2484.44,-5665.71 2484.44,-5656.61 2484.44,-5647.98"/>
<polygon fill="black" stroke="black" points="2487.94,-5647.75 2484.44,-5637.75 2480.94,-5647.75 2487.94,-5647.75"/>
</g>
<!-- send_l11_e2_gpu2 -->
<g id="node621" class="node">
<title>send_l11_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2484.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2484.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E2</text>
<text text-anchor="middle" x="2484.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2484.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2484.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l11_e2_gpu2&#45;&gt;send_l11_e2_gpu2 -->
<g id="edge810" class="edge">
<title>expert_l11_e2_gpu2&#45;&gt;send_l11_e2_gpu2</title>
<path fill="none" stroke="black" d="M2484.44,-5569.43C2484.44,-5561.17 2484.44,-5552.09 2484.44,-5543.04"/>
<polygon fill="black" stroke="black" points="2487.94,-5542.89 2484.44,-5532.89 2480.94,-5542.89 2487.94,-5542.89"/>
</g>
<!-- send_l11_e2_gpu2&#45;&gt;agg_l11 -->
<g id="edge811" class="edge">
<title>send_l11_e2_gpu2&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M2702.36,-5449.12C2740.31,-5444.13 2779.46,-5439.64 2816.44,-5436.5 3440.79,-5383.49 5278.71,-5350.29 6080.78,-5337.95"/>
<polygon fill="black" stroke="black" points="6081.1,-5341.44 6091.05,-5337.79 6080.99,-5334.44 6081.1,-5341.44"/>
</g>
<!-- expert_l11_e3_gpu3 -->
<g id="node623" class="node">
<title>expert_l11_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3375.44,-5637.67 2919.44,-5637.67 2919.44,-5569.67 3375.44,-5569.67 3375.44,-5637.67"/>
<text text-anchor="middle" x="3147.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E3</text>
<text text-anchor="middle" x="3147.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3147.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3147.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l11_e3_gpu3&#45;&gt;expert_l11_e3_gpu3 -->
<g id="edge813" class="edge">
<title>recv_l11_e3_gpu3&#45;&gt;expert_l11_e3_gpu3</title>
<path fill="none" stroke="black" d="M3147.44,-5674.46C3147.44,-5665.71 3147.44,-5656.61 3147.44,-5647.98"/>
<polygon fill="black" stroke="black" points="3150.94,-5647.75 3147.44,-5637.75 3143.94,-5647.75 3150.94,-5647.75"/>
</g>
<!-- send_l11_e3_gpu3 -->
<g id="node624" class="node">
<title>send_l11_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3147.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3147.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E3</text>
<text text-anchor="middle" x="3147.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3147.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3147.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l11_e3_gpu3&#45;&gt;send_l11_e3_gpu3 -->
<g id="edge814" class="edge">
<title>expert_l11_e3_gpu3&#45;&gt;send_l11_e3_gpu3</title>
<path fill="none" stroke="black" d="M3147.44,-5569.43C3147.44,-5561.17 3147.44,-5552.09 3147.44,-5543.04"/>
<polygon fill="black" stroke="black" points="3150.94,-5542.89 3147.44,-5532.89 3143.94,-5542.89 3150.94,-5542.89"/>
</g>
<!-- send_l11_e3_gpu3&#45;&gt;agg_l11 -->
<g id="edge815" class="edge">
<title>send_l11_e3_gpu3&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M3366.27,-5449.2C3403.94,-5444.24 3442.76,-5439.73 3479.44,-5436.5 4407.8,-5354.72 5504,-5336.52 6074.04,-5332.92"/>
<polygon fill="black" stroke="black" points="6074.08,-5336.42 6084.06,-5332.86 6074.04,-5329.42 6074.08,-5336.42"/>
</g>
<!-- expert_l11_e4_gpu4 -->
<g id="node626" class="node">
<title>expert_l11_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="4038.44,-5637.67 3582.44,-5637.67 3582.44,-5569.67 4038.44,-5569.67 4038.44,-5637.67"/>
<text text-anchor="middle" x="3810.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E4</text>
<text text-anchor="middle" x="3810.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3810.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3810.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l11_e4_gpu4&#45;&gt;expert_l11_e4_gpu4 -->
<g id="edge817" class="edge">
<title>recv_l11_e4_gpu4&#45;&gt;expert_l11_e4_gpu4</title>
<path fill="none" stroke="black" d="M3810.44,-5674.46C3810.44,-5665.71 3810.44,-5656.61 3810.44,-5647.98"/>
<polygon fill="black" stroke="black" points="3813.94,-5647.75 3810.44,-5637.75 3806.94,-5647.75 3813.94,-5647.75"/>
</g>
<!-- send_l11_e4_gpu4 -->
<g id="node627" class="node">
<title>send_l11_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3810.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3810.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E4</text>
<text text-anchor="middle" x="3810.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3810.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3810.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l11_e4_gpu4&#45;&gt;send_l11_e4_gpu4 -->
<g id="edge818" class="edge">
<title>expert_l11_e4_gpu4&#45;&gt;send_l11_e4_gpu4</title>
<path fill="none" stroke="black" d="M3810.44,-5569.43C3810.44,-5561.17 3810.44,-5552.09 3810.44,-5543.04"/>
<polygon fill="black" stroke="black" points="3813.94,-5542.89 3810.44,-5532.89 3806.94,-5542.89 3813.94,-5542.89"/>
</g>
<!-- send_l11_e4_gpu4&#45;&gt;agg_l11 -->
<g id="edge819" class="edge">
<title>send_l11_e4_gpu4&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M4030.2,-5449.39C4067.58,-5444.44 4106.07,-5439.89 4142.44,-5436.5 4823.76,-5373.06 5621.37,-5348.03 6081.64,-5338.36"/>
<polygon fill="black" stroke="black" points="6081.85,-5341.86 6091.77,-5338.15 6081.7,-5334.86 6081.85,-5341.86"/>
</g>
<!-- expert_l11_e5_gpu5 -->
<g id="node629" class="node">
<title>expert_l11_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4701.44,-5637.67 4245.44,-5637.67 4245.44,-5569.67 4701.44,-5569.67 4701.44,-5637.67"/>
<text text-anchor="middle" x="4473.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E5</text>
<text text-anchor="middle" x="4473.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4473.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4473.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l11_e5_gpu5&#45;&gt;expert_l11_e5_gpu5 -->
<g id="edge821" class="edge">
<title>recv_l11_e5_gpu5&#45;&gt;expert_l11_e5_gpu5</title>
<path fill="none" stroke="black" d="M4473.44,-5674.46C4473.44,-5665.71 4473.44,-5656.61 4473.44,-5647.98"/>
<polygon fill="black" stroke="black" points="4476.94,-5647.75 4473.44,-5637.75 4469.94,-5647.75 4476.94,-5647.75"/>
</g>
<!-- send_l11_e5_gpu5 -->
<g id="node630" class="node">
<title>send_l11_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4473.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4473.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E5</text>
<text text-anchor="middle" x="4473.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4473.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4473.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l11_e5_gpu5&#45;&gt;send_l11_e5_gpu5 -->
<g id="edge822" class="edge">
<title>expert_l11_e5_gpu5&#45;&gt;send_l11_e5_gpu5</title>
<path fill="none" stroke="black" d="M4473.44,-5569.43C4473.44,-5561.17 4473.44,-5552.09 4473.44,-5543.04"/>
<polygon fill="black" stroke="black" points="4476.94,-5542.89 4473.44,-5532.89 4469.94,-5542.89 4476.94,-5542.89"/>
</g>
<!-- send_l11_e5_gpu5&#45;&gt;agg_l11 -->
<g id="edge823" class="edge">
<title>send_l11_e5_gpu5&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M4695.49,-5449.64C4732.16,-5444.74 4769.82,-5440.14 4805.44,-5436.5 5247.29,-5391.37 5757.57,-5362.89 6093.81,-5347.37"/>
<polygon fill="black" stroke="black" points="6094.38,-5350.84 6104.2,-5346.89 6094.05,-5343.85 6094.38,-5350.84"/>
</g>
<!-- expert_l11_e6_gpu6 -->
<g id="node632" class="node">
<title>expert_l11_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5364.44,-5637.67 4908.44,-5637.67 4908.44,-5569.67 5364.44,-5569.67 5364.44,-5637.67"/>
<text text-anchor="middle" x="5136.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E6</text>
<text text-anchor="middle" x="5136.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5136.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5136.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l11_e6_gpu6&#45;&gt;expert_l11_e6_gpu6 -->
<g id="edge825" class="edge">
<title>recv_l11_e6_gpu6&#45;&gt;expert_l11_e6_gpu6</title>
<path fill="none" stroke="black" d="M5136.44,-5674.46C5136.44,-5665.71 5136.44,-5656.61 5136.44,-5647.98"/>
<polygon fill="black" stroke="black" points="5139.94,-5647.75 5136.44,-5637.75 5132.94,-5647.75 5139.94,-5647.75"/>
</g>
<!-- send_l11_e6_gpu6 -->
<g id="node633" class="node">
<title>send_l11_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5136.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5136.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E6</text>
<text text-anchor="middle" x="5136.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5136.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5136.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l11_e6_gpu6&#45;&gt;send_l11_e6_gpu6 -->
<g id="edge826" class="edge">
<title>expert_l11_e6_gpu6&#45;&gt;send_l11_e6_gpu6</title>
<path fill="none" stroke="black" d="M5136.44,-5569.43C5136.44,-5561.17 5136.44,-5552.09 5136.44,-5543.04"/>
<polygon fill="black" stroke="black" points="5139.94,-5542.89 5136.44,-5532.89 5132.94,-5542.89 5139.94,-5542.89"/>
</g>
<!-- send_l11_e6_gpu6&#45;&gt;agg_l11 -->
<g id="edge827" class="edge">
<title>send_l11_e6_gpu6&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M5363.1,-5450.31C5398.34,-5445.46 5434.35,-5440.7 5468.44,-5436.5 5684.57,-5409.88 5927.69,-5384.36 6119.39,-5365.27"/>
<polygon fill="black" stroke="black" points="6119.74,-5368.75 6129.34,-5364.28 6119.05,-5361.78 6119.74,-5368.75"/>
</g>
<!-- expert_l11_e7_gpu7 -->
<g id="node635" class="node">
<title>expert_l11_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="6027.44,-5637.67 5571.44,-5637.67 5571.44,-5569.67 6027.44,-5569.67 6027.44,-5637.67"/>
<text text-anchor="middle" x="5799.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E7</text>
<text text-anchor="middle" x="5799.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5799.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5799.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l11_e7_gpu7&#45;&gt;expert_l11_e7_gpu7 -->
<g id="edge829" class="edge">
<title>recv_l11_e7_gpu7&#45;&gt;expert_l11_e7_gpu7</title>
<path fill="none" stroke="black" d="M5799.44,-5674.46C5799.44,-5665.71 5799.44,-5656.61 5799.44,-5647.98"/>
<polygon fill="black" stroke="black" points="5802.94,-5647.75 5799.44,-5637.75 5795.94,-5647.75 5802.94,-5647.75"/>
</g>
<!-- send_l11_e7_gpu7 -->
<g id="node636" class="node">
<title>send_l11_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5799.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5799.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E7</text>
<text text-anchor="middle" x="5799.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5799.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5799.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l11_e7_gpu7&#45;&gt;send_l11_e7_gpu7 -->
<g id="edge830" class="edge">
<title>expert_l11_e7_gpu7&#45;&gt;send_l11_e7_gpu7</title>
<path fill="none" stroke="black" d="M5799.44,-5569.43C5799.44,-5561.17 5799.44,-5552.09 5799.44,-5543.04"/>
<polygon fill="black" stroke="black" points="5802.94,-5542.89 5799.44,-5532.89 5795.94,-5542.89 5802.94,-5542.89"/>
</g>
<!-- send_l11_e7_gpu7&#45;&gt;agg_l11 -->
<g id="edge831" class="edge">
<title>send_l11_e7_gpu7&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M5973.2,-5443.99C6032.63,-5430.44 6100.87,-5414.89 6167.16,-5399.79"/>
<polygon fill="black" stroke="black" points="6167.95,-5403.2 6176.92,-5397.56 6166.39,-5396.37 6167.95,-5403.2"/>
</g>
<!-- expert_l11_e8_gpu8 -->
<g id="node638" class="node">
<title>expert_l11_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6690.44,-5637.67 6234.44,-5637.67 6234.44,-5569.67 6690.44,-5569.67 6690.44,-5637.67"/>
<text text-anchor="middle" x="6462.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E8</text>
<text text-anchor="middle" x="6462.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l11_e8_gpu8&#45;&gt;expert_l11_e8_gpu8 -->
<g id="edge833" class="edge">
<title>recv_l11_e8_gpu8&#45;&gt;expert_l11_e8_gpu8</title>
<path fill="none" stroke="black" d="M6462.44,-5674.46C6462.44,-5665.71 6462.44,-5656.61 6462.44,-5647.98"/>
<polygon fill="black" stroke="black" points="6465.94,-5647.75 6462.44,-5637.75 6458.94,-5647.75 6465.94,-5647.75"/>
</g>
<!-- send_l11_e8_gpu8 -->
<g id="node639" class="node">
<title>send_l11_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6462.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6462.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E8</text>
<text text-anchor="middle" x="6462.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6462.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l11_e8_gpu8&#45;&gt;send_l11_e8_gpu8 -->
<g id="edge834" class="edge">
<title>expert_l11_e8_gpu8&#45;&gt;send_l11_e8_gpu8</title>
<path fill="none" stroke="black" d="M6462.44,-5569.43C6462.44,-5561.17 6462.44,-5552.09 6462.44,-5543.04"/>
<polygon fill="black" stroke="black" points="6465.94,-5542.89 6462.44,-5532.89 6458.94,-5542.89 6465.94,-5542.89"/>
</g>
<!-- send_l11_e8_gpu8&#45;&gt;agg_l11 -->
<g id="edge835" class="edge">
<title>send_l11_e8_gpu8&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M6462.44,-5436.19C6462.44,-5427.77 6462.44,-5418.8 6462.44,-5409.79"/>
<polygon fill="black" stroke="black" points="6465.94,-5409.64 6462.44,-5399.64 6458.94,-5409.64 6465.94,-5409.64"/>
</g>
<!-- expert_l11_e9_gpu9 -->
<g id="node641" class="node">
<title>expert_l11_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7353.44,-5637.67 6897.44,-5637.67 6897.44,-5569.67 7353.44,-5569.67 7353.44,-5637.67"/>
<text text-anchor="middle" x="7125.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E9</text>
<text text-anchor="middle" x="7125.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7125.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7125.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l11_e9_gpu9&#45;&gt;expert_l11_e9_gpu9 -->
<g id="edge837" class="edge">
<title>recv_l11_e9_gpu9&#45;&gt;expert_l11_e9_gpu9</title>
<path fill="none" stroke="black" d="M7125.44,-5674.46C7125.44,-5665.71 7125.44,-5656.61 7125.44,-5647.98"/>
<polygon fill="black" stroke="black" points="7128.94,-5647.75 7125.44,-5637.75 7121.94,-5647.75 7128.94,-5647.75"/>
</g>
<!-- send_l11_e9_gpu9 -->
<g id="node642" class="node">
<title>send_l11_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7125.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7125.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E9</text>
<text text-anchor="middle" x="7125.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7125.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7125.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l11_e9_gpu9&#45;&gt;send_l11_e9_gpu9 -->
<g id="edge838" class="edge">
<title>expert_l11_e9_gpu9&#45;&gt;send_l11_e9_gpu9</title>
<path fill="none" stroke="black" d="M7125.44,-5569.43C7125.44,-5561.17 7125.44,-5552.09 7125.44,-5543.04"/>
<polygon fill="black" stroke="black" points="7128.94,-5542.89 7125.44,-5532.89 7121.94,-5542.89 7128.94,-5542.89"/>
</g>
<!-- send_l11_e9_gpu9&#45;&gt;agg_l11 -->
<g id="edge839" class="edge">
<title>send_l11_e9_gpu9&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M6951.68,-5443.99C6894.84,-5431.03 6829.93,-5416.24 6766.39,-5401.76"/>
<polygon fill="black" stroke="black" points="6767.14,-5398.34 6756.61,-5399.53 6765.59,-5405.17 6767.14,-5398.34"/>
</g>
<!-- expert_l11_e10_gpu10 -->
<g id="node644" class="node">
<title>expert_l11_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="8016.44,-5637.67 7560.44,-5637.67 7560.44,-5569.67 8016.44,-5569.67 8016.44,-5637.67"/>
<text text-anchor="middle" x="7788.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E10</text>
<text text-anchor="middle" x="7788.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7788.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7788.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l11_e10_gpu10&#45;&gt;expert_l11_e10_gpu10 -->
<g id="edge841" class="edge">
<title>recv_l11_e10_gpu10&#45;&gt;expert_l11_e10_gpu10</title>
<path fill="none" stroke="black" d="M7788.44,-5674.46C7788.44,-5665.71 7788.44,-5656.61 7788.44,-5647.98"/>
<polygon fill="black" stroke="black" points="7791.94,-5647.75 7788.44,-5637.75 7784.94,-5647.75 7791.94,-5647.75"/>
</g>
<!-- send_l11_e10_gpu10 -->
<g id="node645" class="node">
<title>send_l11_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7788.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7788.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E10</text>
<text text-anchor="middle" x="7788.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7788.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7788.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l11_e10_gpu10&#45;&gt;send_l11_e10_gpu10 -->
<g id="edge842" class="edge">
<title>expert_l11_e10_gpu10&#45;&gt;send_l11_e10_gpu10</title>
<path fill="none" stroke="black" d="M7788.44,-5569.43C7788.44,-5561.17 7788.44,-5552.09 7788.44,-5543.04"/>
<polygon fill="black" stroke="black" points="7791.94,-5542.89 7788.44,-5532.89 7784.94,-5542.89 7791.94,-5542.89"/>
</g>
<!-- send_l11_e10_gpu10&#45;&gt;agg_l11 -->
<g id="edge843" class="edge">
<title>send_l11_e10_gpu10&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M7561.78,-5450.31C7526.54,-5445.46 7490.53,-5440.7 7456.44,-5436.5 7280,-5414.76 7085.57,-5393.77 6915.81,-5376.4"/>
<polygon fill="black" stroke="black" points="6916,-5372.9 6905.69,-5375.37 6915.29,-5379.87 6916,-5372.9"/>
</g>
<!-- expert_l11_e11_gpu11 -->
<g id="node647" class="node">
<title>expert_l11_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8679.44,-5637.67 8223.44,-5637.67 8223.44,-5569.67 8679.44,-5569.67 8679.44,-5637.67"/>
<text text-anchor="middle" x="8451.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E11</text>
<text text-anchor="middle" x="8451.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8451.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8451.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l11_e11_gpu11&#45;&gt;expert_l11_e11_gpu11 -->
<g id="edge845" class="edge">
<title>recv_l11_e11_gpu11&#45;&gt;expert_l11_e11_gpu11</title>
<path fill="none" stroke="black" d="M8451.44,-5674.46C8451.44,-5665.71 8451.44,-5656.61 8451.44,-5647.98"/>
<polygon fill="black" stroke="black" points="8454.94,-5647.75 8451.44,-5637.75 8447.94,-5647.75 8454.94,-5647.75"/>
</g>
<!-- send_l11_e11_gpu11 -->
<g id="node648" class="node">
<title>send_l11_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8451.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8451.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E11</text>
<text text-anchor="middle" x="8451.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8451.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8451.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l11_e11_gpu11&#45;&gt;send_l11_e11_gpu11 -->
<g id="edge846" class="edge">
<title>expert_l11_e11_gpu11&#45;&gt;send_l11_e11_gpu11</title>
<path fill="none" stroke="black" d="M8451.44,-5569.43C8451.44,-5561.17 8451.44,-5552.09 8451.44,-5543.04"/>
<polygon fill="black" stroke="black" points="8454.94,-5542.89 8451.44,-5532.89 8447.94,-5542.89 8454.94,-5542.89"/>
</g>
<!-- send_l11_e11_gpu11&#45;&gt;agg_l11 -->
<g id="edge847" class="edge">
<title>send_l11_e11_gpu11&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M8229.4,-5449.64C8192.72,-5444.74 8155.06,-5440.14 8119.44,-5436.5 7697.81,-5393.44 7213.87,-5365.53 6878.31,-5349.58"/>
<polygon fill="black" stroke="black" points="6878.08,-5346.06 6867.92,-5349.09 6877.75,-5353.06 6878.08,-5346.06"/>
</g>
<!-- expert_l11_e12_gpu12 -->
<g id="node650" class="node">
<title>expert_l11_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9342.44,-5637.67 8886.44,-5637.67 8886.44,-5569.67 9342.44,-5569.67 9342.44,-5637.67"/>
<text text-anchor="middle" x="9114.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E12</text>
<text text-anchor="middle" x="9114.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9114.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9114.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l11_e12_gpu12&#45;&gt;expert_l11_e12_gpu12 -->
<g id="edge849" class="edge">
<title>recv_l11_e12_gpu12&#45;&gt;expert_l11_e12_gpu12</title>
<path fill="none" stroke="black" d="M9114.44,-5674.46C9114.44,-5665.71 9114.44,-5656.61 9114.44,-5647.98"/>
<polygon fill="black" stroke="black" points="9117.94,-5647.75 9114.44,-5637.75 9110.94,-5647.75 9117.94,-5647.75"/>
</g>
<!-- send_l11_e12_gpu12 -->
<g id="node651" class="node">
<title>send_l11_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9114.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9114.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E12</text>
<text text-anchor="middle" x="9114.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9114.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9114.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l11_e12_gpu12&#45;&gt;send_l11_e12_gpu12 -->
<g id="edge850" class="edge">
<title>expert_l11_e12_gpu12&#45;&gt;send_l11_e12_gpu12</title>
<path fill="none" stroke="black" d="M9114.44,-5569.43C9114.44,-5561.17 9114.44,-5552.09 9114.44,-5543.04"/>
<polygon fill="black" stroke="black" points="9117.94,-5542.89 9114.44,-5532.89 9110.94,-5542.89 9117.94,-5542.89"/>
</g>
<!-- send_l11_e12_gpu12&#45;&gt;agg_l11 -->
<g id="edge851" class="edge">
<title>send_l11_e12_gpu12&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M8894.69,-5449.39C8857.3,-5444.44 8818.81,-5439.89 8782.44,-5436.5 8110.83,-5373.97 7326.23,-5348.75 6863.13,-5338.78"/>
<polygon fill="black" stroke="black" points="6863.01,-5335.28 6852.93,-5338.56 6862.86,-5342.28 6863.01,-5335.28"/>
</g>
<!-- expert_l11_e13_gpu13 -->
<g id="node653" class="node">
<title>expert_l11_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="10005.44,-5637.67 9549.44,-5637.67 9549.44,-5569.67 10005.44,-5569.67 10005.44,-5637.67"/>
<text text-anchor="middle" x="9777.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E13</text>
<text text-anchor="middle" x="9777.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9777.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9777.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l11_e13_gpu13&#45;&gt;expert_l11_e13_gpu13 -->
<g id="edge853" class="edge">
<title>recv_l11_e13_gpu13&#45;&gt;expert_l11_e13_gpu13</title>
<path fill="none" stroke="black" d="M9777.44,-5674.46C9777.44,-5665.71 9777.44,-5656.61 9777.44,-5647.98"/>
<polygon fill="black" stroke="black" points="9780.94,-5647.75 9777.44,-5637.75 9773.94,-5647.75 9780.94,-5647.75"/>
</g>
<!-- send_l11_e13_gpu13 -->
<g id="node654" class="node">
<title>send_l11_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9777.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9777.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E13</text>
<text text-anchor="middle" x="9777.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9777.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9777.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l11_e13_gpu13&#45;&gt;send_l11_e13_gpu13 -->
<g id="edge854" class="edge">
<title>expert_l11_e13_gpu13&#45;&gt;send_l11_e13_gpu13</title>
<path fill="none" stroke="black" d="M9777.44,-5569.43C9777.44,-5561.17 9777.44,-5552.09 9777.44,-5543.04"/>
<polygon fill="black" stroke="black" points="9780.94,-5542.89 9777.44,-5532.89 9773.94,-5542.89 9780.94,-5542.89"/>
</g>
<!-- send_l11_e13_gpu13&#45;&gt;agg_l11 -->
<g id="edge855" class="edge">
<title>send_l11_e13_gpu13&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M9558.61,-5449.2C9520.94,-5444.24 9482.12,-5439.73 9445.44,-5436.5 8519.16,-5354.9 7425.8,-5336.6 6854.69,-5332.95"/>
<polygon fill="black" stroke="black" points="6854.67,-5329.45 6844.65,-5332.88 6854.63,-5336.45 6854.67,-5329.45"/>
</g>
<!-- expert_l11_e14_gpu14 -->
<g id="node656" class="node">
<title>expert_l11_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10668.44,-5637.67 10212.44,-5637.67 10212.44,-5569.67 10668.44,-5569.67 10668.44,-5637.67"/>
<text text-anchor="middle" x="10440.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E14</text>
<text text-anchor="middle" x="10440.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10440.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10440.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l11_e14_gpu14&#45;&gt;expert_l11_e14_gpu14 -->
<g id="edge857" class="edge">
<title>recv_l11_e14_gpu14&#45;&gt;expert_l11_e14_gpu14</title>
<path fill="none" stroke="black" d="M10440.44,-5674.46C10440.44,-5665.71 10440.44,-5656.61 10440.44,-5647.98"/>
<polygon fill="black" stroke="black" points="10443.94,-5647.75 10440.44,-5637.75 10436.94,-5647.75 10443.94,-5647.75"/>
</g>
<!-- send_l11_e14_gpu14 -->
<g id="node657" class="node">
<title>send_l11_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10440.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10440.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E14</text>
<text text-anchor="middle" x="10440.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10440.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10440.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l11_e14_gpu14&#45;&gt;send_l11_e14_gpu14 -->
<g id="edge858" class="edge">
<title>expert_l11_e14_gpu14&#45;&gt;send_l11_e14_gpu14</title>
<path fill="none" stroke="black" d="M10440.44,-5569.43C10440.44,-5561.17 10440.44,-5552.09 10440.44,-5543.04"/>
<polygon fill="black" stroke="black" points="10443.94,-5542.89 10440.44,-5532.89 10436.94,-5542.89 10443.94,-5542.89"/>
</g>
<!-- send_l11_e14_gpu14&#45;&gt;agg_l11 -->
<g id="edge859" class="edge">
<title>send_l11_e14_gpu14&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M10222.52,-5449.12C10184.57,-5444.13 10145.42,-5439.64 10108.44,-5436.5 9488.73,-5383.88 7673.4,-5350.78 6862.14,-5338.22"/>
<polygon fill="black" stroke="black" points="6862.1,-5334.72 6852.05,-5338.07 6861.99,-5341.72 6862.1,-5334.72"/>
</g>
<!-- expert_l11_e15_gpu15 -->
<g id="node659" class="node">
<title>expert_l11_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11331.44,-5637.67 10875.44,-5637.67 10875.44,-5569.67 11331.44,-5569.67 11331.44,-5637.67"/>
<text text-anchor="middle" x="11103.44" y="-5622.47" font-family="Times,serif" font-size="14.00">Expert L11E15</text>
<text text-anchor="middle" x="11103.44" y="-5607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11103.44" y="-5592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11103.44" y="-5577.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l11_e15_gpu15&#45;&gt;expert_l11_e15_gpu15 -->
<g id="edge861" class="edge">
<title>recv_l11_e15_gpu15&#45;&gt;expert_l11_e15_gpu15</title>
<path fill="none" stroke="black" d="M11103.44,-5674.46C11103.44,-5665.71 11103.44,-5656.61 11103.44,-5647.98"/>
<polygon fill="black" stroke="black" points="11106.94,-5647.75 11103.44,-5637.75 11099.94,-5647.75 11106.94,-5647.75"/>
</g>
<!-- send_l11_e15_gpu15 -->
<g id="node660" class="node">
<title>send_l11_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11103.44" cy="-5484.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11103.44" y="-5503.38" font-family="Times,serif" font-size="14.00">Token Send L11E15</text>
<text text-anchor="middle" x="11103.44" y="-5488.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11103.44" y="-5473.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11103.44" y="-5458.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l11_e15_gpu15&#45;&gt;send_l11_e15_gpu15 -->
<g id="edge862" class="edge">
<title>expert_l11_e15_gpu15&#45;&gt;send_l11_e15_gpu15</title>
<path fill="none" stroke="black" d="M11103.44,-5569.43C11103.44,-5561.17 11103.44,-5552.09 11103.44,-5543.04"/>
<polygon fill="black" stroke="black" points="11106.94,-5542.89 11103.44,-5532.89 11099.94,-5542.89 11106.94,-5542.89"/>
</g>
<!-- send_l11_e15_gpu15&#45;&gt;agg_l11 -->
<g id="edge863" class="edge">
<title>send_l11_e15_gpu15&#45;&gt;agg_l11</title>
<path fill="none" stroke="black" d="M10885.97,-5449.04C10847.89,-5444.05 10808.57,-5439.57 10771.44,-5436.5 10019.12,-5374.29 7776.18,-5345.54 6859.48,-5336.15"/>
<polygon fill="black" stroke="black" points="6859.46,-5332.65 6849.43,-5336.05 6859.39,-5339.65 6859.46,-5332.65"/>
</g>
<!-- residual2_l11 -->
<g id="node662" class="node">
<title>residual2_l11</title>
<polygon fill="lightpink" stroke="black" points="6727.94,-5226.5 6292.94,-5226.5 6292.94,-5158.5 6727.94,-5158.5 6727.94,-5226.5"/>
<text text-anchor="middle" x="6510.44" y="-5211.3" font-family="Times,serif" font-size="14.00">ResidualAdd L11</text>
<text text-anchor="middle" x="6510.44" y="-5196.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6510.44" y="-5181.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6510.44" y="-5166.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l11&#45;&gt;residual2_l11 -->
<g id="edge864" class="edge">
<title>agg_l11&#45;&gt;residual2_l11</title>
<path fill="none" stroke="black" d="M6486.02,-5263.2C6489.22,-5254.06 6492.44,-5244.89 6495.43,-5236.34"/>
<polygon fill="black" stroke="black" points="6498.83,-5237.22 6498.83,-5226.63 6492.22,-5234.91 6498.83,-5237.22"/>
</g>
<!-- residual2_l11&#45;&gt;ln1_l12 -->
<g id="edge865" class="edge">
<title>residual2_l11&#45;&gt;ln1_l12</title>
<path fill="none" stroke="black" d="M6519.45,-5158.34C6521.78,-5149.8 6524.31,-5140.48 6526.75,-5131.51"/>
<polygon fill="black" stroke="black" points="6530.2,-5132.16 6529.44,-5121.59 6523.44,-5130.33 6530.2,-5132.16"/>
</g>
<!-- attn_l12 -->
<g id="node664" class="node">
<title>attn_l12</title>
<polygon fill="lightcoral" stroke="black" points="6768.44,-5016.5 6308.44,-5016.5 6308.44,-4948.5 6768.44,-4948.5 6768.44,-5016.5"/>
<text text-anchor="middle" x="6538.44" y="-5001.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L12</text>
<text text-anchor="middle" x="6538.44" y="-4986.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6538.44" y="-4971.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4956.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l12&#45;&gt;attn_l12 -->
<g id="edge868" class="edge">
<title>ln1_l12&#45;&gt;attn_l12</title>
<path fill="none" stroke="black" d="M6538.44,-5053.34C6538.44,-5044.89 6538.44,-5035.68 6538.44,-5026.8"/>
<polygon fill="black" stroke="black" points="6541.94,-5026.59 6538.44,-5016.59 6534.94,-5026.59 6541.94,-5026.59"/>
</g>
<!-- residual1_l12 -->
<g id="node665" class="node">
<title>residual1_l12</title>
<polygon fill="lightpink" stroke="black" points="6755.94,-4911.5 6320.94,-4911.5 6320.94,-4843.5 6755.94,-4843.5 6755.94,-4911.5"/>
<text text-anchor="middle" x="6538.44" y="-4896.3" font-family="Times,serif" font-size="14.00">ResidualAdd L12</text>
<text text-anchor="middle" x="6538.44" y="-4881.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4866.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4851.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l12&#45;&gt;residual1_l12 -->
<g id="edge869" class="edge">
<title>attn_l12&#45;&gt;residual1_l12</title>
<path fill="none" stroke="black" d="M6538.44,-4948.34C6538.44,-4939.89 6538.44,-4930.68 6538.44,-4921.8"/>
<polygon fill="black" stroke="black" points="6541.94,-4921.59 6538.44,-4911.59 6534.94,-4921.59 6541.94,-4921.59"/>
</g>
<!-- ln2_l12 -->
<g id="node666" class="node">
<title>ln2_l12</title>
<polygon fill="lightyellow" stroke="black" points="6755.94,-4806.5 6320.94,-4806.5 6320.94,-4738.5 6755.94,-4738.5 6755.94,-4806.5"/>
<text text-anchor="middle" x="6538.44" y="-4791.3" font-family="Times,serif" font-size="14.00">LayerNorm L12</text>
<text text-anchor="middle" x="6538.44" y="-4776.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4761.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4746.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l12&#45;&gt;ln2_l12 -->
<g id="edge870" class="edge">
<title>residual1_l12&#45;&gt;ln2_l12</title>
<path fill="none" stroke="black" d="M6538.44,-4843.34C6538.44,-4834.89 6538.44,-4825.68 6538.44,-4816.8"/>
<polygon fill="black" stroke="black" points="6541.94,-4816.59 6538.44,-4806.59 6534.94,-4816.59 6541.94,-4816.59"/>
</g>
<!-- ln2_l12&#45;&gt;route_l12 -->
<g id="edge871" class="edge">
<title>ln2_l12&#45;&gt;route_l12</title>
<path fill="none" stroke="black" d="M6538.44,-4738.33C6538.44,-4730.19 6538.44,-4721.13 6538.44,-4711.85"/>
<polygon fill="black" stroke="black" points="6541.94,-4711.73 6538.44,-4701.73 6534.94,-4711.73 6541.94,-4711.73"/>
</g>
<!-- recv_l12_e0_gpu0 -->
<g id="node668" class="node">
<title>recv_l12_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1234.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1234.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E0</text>
<text text-anchor="middle" x="1234.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1234.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1234.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e0_gpu0 -->
<g id="edge872" class="edge">
<title>route_l12&#45;&gt;recv_l12_e0_gpu0</title>
<path fill="none" stroke="black" d="M6154.34,-4627.81C5412.72,-4618.08 3732,-4592.74 2318.44,-4547.5 1984.07,-4536.8 1899.56,-4545.36 1566.44,-4514.5 1533.33,-4511.43 1498.48,-4507.39 1464.29,-4502.96"/>
<polygon fill="black" stroke="black" points="1464.56,-4499.47 1454.19,-4501.64 1463.65,-4506.41 1464.56,-4499.47"/>
<text text-anchor="middle" x="2390.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l12_e1_gpu1 -->
<g id="node671" class="node">
<title>recv_l12_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1897.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1897.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E1</text>
<text text-anchor="middle" x="1897.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1897.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1897.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e1_gpu1 -->
<g id="edge876" class="edge">
<title>route_l12&#45;&gt;recv_l12_e1_gpu1</title>
<path fill="none" stroke="black" d="M6151.4,-4625.63C5499.9,-4613.52 4142.87,-4585.98 2995.44,-4547.5 2654.87,-4536.08 2568.76,-4545.79 2229.44,-4514.5 2196.33,-4511.45 2161.47,-4507.41 2127.29,-4502.99"/>
<polygon fill="black" stroke="black" points="2127.56,-4499.49 2117.19,-4501.66 2126.65,-4506.43 2127.56,-4499.49"/>
<text text-anchor="middle" x="3067.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l12_e2_gpu2 -->
<g id="node674" class="node">
<title>recv_l12_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2560.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2560.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E2</text>
<text text-anchor="middle" x="2560.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2560.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2560.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e2_gpu2 -->
<g id="edge880" class="edge">
<title>route_l12&#45;&gt;recv_l12_e2_gpu2</title>
<path fill="none" stroke="black" d="M6147.09,-4622.63C5593.03,-4608.27 4548.24,-4579.79 3658.44,-4547.5 3317.9,-4535.14 3231.76,-4545.79 2892.44,-4514.5 2859.33,-4511.45 2824.47,-4507.41 2790.29,-4502.99"/>
<polygon fill="black" stroke="black" points="2790.56,-4499.49 2780.19,-4501.66 2789.65,-4506.43 2790.56,-4499.49"/>
<text text-anchor="middle" x="3730.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l12_e3_gpu3 -->
<g id="node677" class="node">
<title>recv_l12_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3223.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3223.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E3</text>
<text text-anchor="middle" x="3223.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3223.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3223.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e3_gpu3 -->
<g id="edge884" class="edge">
<title>route_l12&#45;&gt;recv_l12_e3_gpu3</title>
<path fill="none" stroke="black" d="M6140.18,-4617.8C5696.4,-4601.28 4957.54,-4573.39 4321.44,-4547.5 3980.96,-4533.64 3894.76,-4545.79 3555.44,-4514.5 3522.33,-4511.45 3487.47,-4507.41 3453.29,-4502.99"/>
<polygon fill="black" stroke="black" points="3453.56,-4499.49 3443.19,-4501.66 3452.65,-4506.43 3453.56,-4499.49"/>
<text text-anchor="middle" x="4393.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l12_e4_gpu4 -->
<g id="node680" class="node">
<title>recv_l12_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3886.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3886.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E4</text>
<text text-anchor="middle" x="3886.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3886.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3886.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e4_gpu4 -->
<g id="edge888" class="edge">
<title>route_l12&#45;&gt;recv_l12_e4_gpu4</title>
<path fill="none" stroke="black" d="M6148.2,-4623.37C5686.53,-4610.1 4895.13,-4579.56 4218.44,-4514.5 4185.61,-4511.34 4151.05,-4507.28 4117.13,-4502.86"/>
<polygon fill="black" stroke="black" points="4117.48,-4499.37 4107.11,-4501.54 4116.57,-4506.31 4117.48,-4499.37"/>
<text text-anchor="middle" x="4669.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l12_e5_gpu5 -->
<g id="node683" class="node">
<title>recv_l12_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4549.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4549.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E5</text>
<text text-anchor="middle" x="4549.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4549.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4549.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e5_gpu5 -->
<g id="edge892" class="edge">
<title>route_l12&#45;&gt;recv_l12_e5_gpu5</title>
<path fill="none" stroke="black" d="M6130.86,-4611.42C5795.03,-4592.15 5306.6,-4559.73 4881.44,-4514.5 4849.44,-4511.09 4815.78,-4506.96 4782.66,-4502.58"/>
<polygon fill="black" stroke="black" points="4782.78,-4499.07 4772.41,-4501.21 4781.86,-4506.01 4782.78,-4499.07"/>
<text text-anchor="middle" x="5270.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l12_e6_gpu6 -->
<g id="node686" class="node">
<title>recv_l12_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5212.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5212.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E6</text>
<text text-anchor="middle" x="5212.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5212.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5212.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e6_gpu6 -->
<g id="edge896" class="edge">
<title>route_l12&#45;&gt;recv_l12_e6_gpu6</title>
<path fill="none" stroke="black" d="M6088.2,-4581.24C5917.75,-4561.26 5722.04,-4537.63 5544.44,-4514.5 5514.1,-4510.55 5482.22,-4506.23 5450.71,-4501.87"/>
<polygon fill="black" stroke="black" points="5450.89,-4498.36 5440.5,-4500.45 5449.93,-4505.3 5450.89,-4498.36"/>
<text text-anchor="middle" x="5862.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l12_e7_gpu7 -->
<g id="node689" class="node">
<title>recv_l12_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5875.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5875.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E7</text>
<text text-anchor="middle" x="5875.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5875.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5875.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e7_gpu7 -->
<g id="edge900" class="edge">
<title>route_l12&#45;&gt;recv_l12_e7_gpu7</title>
<path fill="none" stroke="black" d="M6269.25,-4565.47C6194.71,-4546.91 6115.82,-4527.27 6048.37,-4510.48"/>
<polygon fill="black" stroke="black" points="6049.06,-4507.04 6038.51,-4508.02 6047.37,-4513.83 6049.06,-4507.04"/>
<text text-anchor="middle" x="6259.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l12_e8_gpu8 -->
<g id="node692" class="node">
<title>recv_l12_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6538.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6538.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E8</text>
<text text-anchor="middle" x="6538.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e8_gpu8 -->
<g id="edge904" class="edge">
<title>route_l12&#45;&gt;recv_l12_e8_gpu8</title>
<path fill="none" stroke="black" d="M6538.44,-4565.35C6538.44,-4551.97 6538.44,-4538.03 6538.44,-4525"/>
<polygon fill="black" stroke="black" points="6541.94,-4524.78 6538.44,-4514.78 6534.94,-4524.78 6541.94,-4524.78"/>
<text text-anchor="middle" x="6610.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l12_e9_gpu9 -->
<g id="node695" class="node">
<title>recv_l12_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7201.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7201.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E9</text>
<text text-anchor="middle" x="7201.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7201.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7201.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e9_gpu9 -->
<g id="edge908" class="edge">
<title>route_l12&#45;&gt;recv_l12_e9_gpu9</title>
<path fill="none" stroke="black" d="M6807.63,-4565.47C6882.17,-4546.91 6961.06,-4527.27 7028.51,-4510.48"/>
<polygon fill="black" stroke="black" points="7029.51,-4513.83 7038.37,-4508.02 7027.82,-4507.04 7029.51,-4513.83"/>
<text text-anchor="middle" x="7001.44" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l12_e10_gpu10 -->
<g id="node698" class="node">
<title>recv_l12_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7864.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7864.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E10</text>
<text text-anchor="middle" x="7864.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7864.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7864.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e10_gpu10 -->
<g id="edge912" class="edge">
<title>route_l12&#45;&gt;recv_l12_e10_gpu10</title>
<path fill="none" stroke="black" d="M6861.27,-4596.05C7055.83,-4573.62 7308.53,-4543.66 7532.44,-4514.5 7562.78,-4510.55 7594.66,-4506.23 7626.17,-4501.87"/>
<polygon fill="black" stroke="black" points="7626.96,-4505.3 7636.38,-4500.45 7625.99,-4498.36 7626.96,-4505.3"/>
<text text-anchor="middle" x="7446.94" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l12_e11_gpu11 -->
<g id="node701" class="node">
<title>recv_l12_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8527.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8527.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E11</text>
<text text-anchor="middle" x="8527.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8527.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8527.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e11_gpu11 -->
<g id="edge916" class="edge">
<title>route_l12&#45;&gt;recv_l12_e11_gpu11</title>
<path fill="none" stroke="black" d="M6887.79,-4614.72C7223.56,-4595.95 7745.01,-4562.42 8195.44,-4514.5 8227.44,-4511.09 8261.1,-4506.96 8294.22,-4502.58"/>
<polygon fill="black" stroke="black" points="8295.02,-4506.01 8304.47,-4501.21 8294.1,-4499.07 8295.02,-4506.01"/>
<text text-anchor="middle" x="8092.94" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l12_e12_gpu12 -->
<g id="node704" class="node">
<title>recv_l12_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9190.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9190.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E12</text>
<text text-anchor="middle" x="9190.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9190.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9190.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e12_gpu12 -->
<g id="edge920" class="edge">
<title>route_l12&#45;&gt;recv_l12_e12_gpu12</title>
<path fill="none" stroke="black" d="M6901.35,-4624.15C7358.61,-4611.31 8168.2,-4580.86 8858.44,-4514.5 8891.27,-4511.34 8925.83,-4507.28 8959.75,-4502.86"/>
<polygon fill="black" stroke="black" points="8960.32,-4506.31 8969.77,-4501.54 8959.4,-4499.37 8960.32,-4506.31"/>
<text text-anchor="middle" x="8684.94" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l12_e13_gpu13 -->
<g id="node707" class="node">
<title>recv_l12_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9853.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9853.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E13</text>
<text text-anchor="middle" x="9853.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9853.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9853.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e13_gpu13 -->
<g id="edge924" class="edge">
<title>route_l12&#45;&gt;recv_l12_e13_gpu13</title>
<path fill="none" stroke="black" d="M6894.76,-4619.5C7334.49,-4603.32 8105.1,-4574.51 8765.44,-4547.5 9101.48,-4533.75 9186.55,-4545.48 9521.44,-4514.5 9554.55,-4511.44 9589.41,-4507.4 9623.59,-4502.97"/>
<polygon fill="black" stroke="black" points="9624.23,-4506.41 9633.69,-4501.65 9623.32,-4499.47 9624.23,-4506.41"/>
<text text-anchor="middle" x="9350.94" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l12_e14_gpu14 -->
<g id="node710" class="node">
<title>recv_l12_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10516.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10516.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E14</text>
<text text-anchor="middle" x="10516.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10516.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10516.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e14_gpu14 -->
<g id="edge928" class="edge">
<title>route_l12&#45;&gt;recv_l12_e14_gpu14</title>
<path fill="none" stroke="black" d="M6900.16,-4623.55C7447.91,-4609.61 8520.53,-4580.84 9431.44,-4547.5 9766.2,-4535.25 9850.88,-4545.39 10184.44,-4514.5 10217.55,-4511.43 10252.41,-4507.39 10286.59,-4502.96"/>
<polygon fill="black" stroke="black" points="10287.23,-4506.41 10296.69,-4501.64 10286.32,-4499.47 10287.23,-4506.41"/>
<text text-anchor="middle" x="10014.94" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l12_e15_gpu15 -->
<g id="node713" class="node">
<title>recv_l12_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11179.44" cy="-4466.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11179.44" y="-4485.22" font-family="Times,serif" font-size="14.00">Token Receive L12E15</text>
<text text-anchor="middle" x="11179.44" y="-4470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11179.44" y="-4455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11179.44" y="-4440.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l12&#45;&gt;recv_l12_e15_gpu15 -->
<g id="edge932" class="edge">
<title>route_l12&#45;&gt;recv_l12_e15_gpu15</title>
<path fill="none" stroke="black" d="M6903.99,-4626.17C7548.66,-4614.47 8929.79,-4587 10095.44,-4547.5 10429.79,-4536.17 10514.32,-4545.36 10847.44,-4514.5 10880.55,-4511.43 10915.41,-4507.39 10949.59,-4502.96"/>
<polygon fill="black" stroke="black" points="10950.23,-4506.41 10959.69,-4501.64 10949.32,-4499.47 10950.23,-4506.41"/>
<text text-anchor="middle" x="10676.94" y="-4536.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l12_e0_gpu0 -->
<g id="node669" class="node">
<title>expert_l12_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1462.44,-4381.33 1006.44,-4381.33 1006.44,-4313.33 1462.44,-4313.33 1462.44,-4381.33"/>
<text text-anchor="middle" x="1234.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E0</text>
<text text-anchor="middle" x="1234.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1234.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1234.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l12_e0_gpu0&#45;&gt;expert_l12_e0_gpu0 -->
<g id="edge873" class="edge">
<title>recv_l12_e0_gpu0&#45;&gt;expert_l12_e0_gpu0</title>
<path fill="none" stroke="black" d="M1234.44,-4418.13C1234.44,-4409.38 1234.44,-4400.27 1234.44,-4391.65"/>
<polygon fill="black" stroke="black" points="1237.94,-4391.41 1234.44,-4381.41 1230.94,-4391.41 1237.94,-4391.41"/>
</g>
<!-- send_l12_e0_gpu0 -->
<g id="node670" class="node">
<title>send_l12_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1234.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1234.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E0</text>
<text text-anchor="middle" x="1234.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1234.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1234.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l12_e0_gpu0&#45;&gt;send_l12_e0_gpu0 -->
<g id="edge874" class="edge">
<title>expert_l12_e0_gpu0&#45;&gt;send_l12_e0_gpu0</title>
<path fill="none" stroke="black" d="M1234.44,-4313.09C1234.44,-4304.84 1234.44,-4295.76 1234.44,-4286.71"/>
<polygon fill="black" stroke="black" points="1237.94,-4286.55 1234.44,-4276.55 1230.94,-4286.55 1237.94,-4286.55"/>
</g>
<!-- agg_l12 -->
<g id="node716" class="node">
<title>agg_l12</title>
<polygon fill="lightgray" stroke="black" points="7016.33,-4143.17 6256.12,-4143.17 6060.55,-4007.17 6820.76,-4007.17 7016.33,-4143.17"/>
<text text-anchor="middle" x="6538.44" y="-4093.97" font-family="Times,serif" font-size="14.00">Expert Aggregation L12</text>
<text text-anchor="middle" x="6538.44" y="-4078.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4063.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4048.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l12_e0_gpu0&#45;&gt;agg_l12 -->
<g id="edge875" class="edge">
<title>send_l12_e0_gpu0&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M1451.45,-4192.66C1489.68,-4187.66 1529.16,-4183.19 1566.44,-4180.17 2454.88,-4108.14 5144.64,-4084.64 6152.01,-4078.25"/>
<polygon fill="black" stroke="black" points="6152.34,-4081.75 6162.32,-4078.18 6152.29,-4074.75 6152.34,-4081.75"/>
</g>
<!-- expert_l12_e1_gpu1 -->
<g id="node672" class="node">
<title>expert_l12_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="2125.44,-4381.33 1669.44,-4381.33 1669.44,-4313.33 2125.44,-4313.33 2125.44,-4381.33"/>
<text text-anchor="middle" x="1897.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E1</text>
<text text-anchor="middle" x="1897.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1897.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1897.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l12_e1_gpu1&#45;&gt;expert_l12_e1_gpu1 -->
<g id="edge877" class="edge">
<title>recv_l12_e1_gpu1&#45;&gt;expert_l12_e1_gpu1</title>
<path fill="none" stroke="black" d="M1897.44,-4418.13C1897.44,-4409.38 1897.44,-4400.27 1897.44,-4391.65"/>
<polygon fill="black" stroke="black" points="1900.94,-4391.41 1897.44,-4381.41 1893.94,-4391.41 1900.94,-4391.41"/>
</g>
<!-- send_l12_e1_gpu1 -->
<g id="node673" class="node">
<title>send_l12_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1897.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1897.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E1</text>
<text text-anchor="middle" x="1897.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1897.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1897.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l12_e1_gpu1&#45;&gt;send_l12_e1_gpu1 -->
<g id="edge878" class="edge">
<title>expert_l12_e1_gpu1&#45;&gt;send_l12_e1_gpu1</title>
<path fill="none" stroke="black" d="M1897.44,-4313.09C1897.44,-4304.84 1897.44,-4295.76 1897.44,-4286.71"/>
<polygon fill="black" stroke="black" points="1900.94,-4286.55 1897.44,-4276.55 1893.94,-4286.55 1900.94,-4286.55"/>
</g>
<!-- send_l12_e1_gpu1&#45;&gt;agg_l12 -->
<g id="edge879" class="edge">
<title>send_l12_e1_gpu1&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M2114.91,-4192.7C2152.99,-4187.71 2192.31,-4183.24 2229.44,-4180.17 2985.27,-4117.66 5245.64,-4088.94 6154.13,-4079.69"/>
<polygon fill="black" stroke="black" points="6154.46,-4083.18 6164.42,-4079.58 6154.39,-4076.18 6154.46,-4083.18"/>
</g>
<!-- expert_l12_e2_gpu2 -->
<g id="node675" class="node">
<title>expert_l12_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2788.44,-4381.33 2332.44,-4381.33 2332.44,-4313.33 2788.44,-4313.33 2788.44,-4381.33"/>
<text text-anchor="middle" x="2560.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E2</text>
<text text-anchor="middle" x="2560.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2560.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2560.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l12_e2_gpu2&#45;&gt;expert_l12_e2_gpu2 -->
<g id="edge881" class="edge">
<title>recv_l12_e2_gpu2&#45;&gt;expert_l12_e2_gpu2</title>
<path fill="none" stroke="black" d="M2560.44,-4418.13C2560.44,-4409.38 2560.44,-4400.27 2560.44,-4391.65"/>
<polygon fill="black" stroke="black" points="2563.94,-4391.41 2560.44,-4381.41 2556.94,-4391.41 2563.94,-4391.41"/>
</g>
<!-- send_l12_e2_gpu2 -->
<g id="node676" class="node">
<title>send_l12_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2560.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2560.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E2</text>
<text text-anchor="middle" x="2560.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2560.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2560.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l12_e2_gpu2&#45;&gt;send_l12_e2_gpu2 -->
<g id="edge882" class="edge">
<title>expert_l12_e2_gpu2&#45;&gt;send_l12_e2_gpu2</title>
<path fill="none" stroke="black" d="M2560.44,-4313.09C2560.44,-4304.84 2560.44,-4295.76 2560.44,-4286.71"/>
<polygon fill="black" stroke="black" points="2563.94,-4286.55 2560.44,-4276.55 2556.94,-4286.55 2563.94,-4286.55"/>
</g>
<!-- send_l12_e2_gpu2&#45;&gt;agg_l12 -->
<g id="edge883" class="edge">
<title>send_l12_e2_gpu2&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M2778.36,-4192.78C2816.31,-4187.8 2855.46,-4183.31 2892.44,-4180.17 3516.79,-4127.16 5354.71,-4093.95 6156.78,-4081.61"/>
<polygon fill="black" stroke="black" points="6157.1,-4085.11 6167.05,-4081.46 6156.99,-4078.11 6157.1,-4085.11"/>
</g>
<!-- expert_l12_e3_gpu3 -->
<g id="node678" class="node">
<title>expert_l12_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3451.44,-4381.33 2995.44,-4381.33 2995.44,-4313.33 3451.44,-4313.33 3451.44,-4381.33"/>
<text text-anchor="middle" x="3223.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E3</text>
<text text-anchor="middle" x="3223.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3223.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3223.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l12_e3_gpu3&#45;&gt;expert_l12_e3_gpu3 -->
<g id="edge885" class="edge">
<title>recv_l12_e3_gpu3&#45;&gt;expert_l12_e3_gpu3</title>
<path fill="none" stroke="black" d="M3223.44,-4418.13C3223.44,-4409.38 3223.44,-4400.27 3223.44,-4391.65"/>
<polygon fill="black" stroke="black" points="3226.94,-4391.41 3223.44,-4381.41 3219.94,-4391.41 3226.94,-4391.41"/>
</g>
<!-- send_l12_e3_gpu3 -->
<g id="node679" class="node">
<title>send_l12_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3223.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3223.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E3</text>
<text text-anchor="middle" x="3223.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3223.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3223.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l12_e3_gpu3&#45;&gt;send_l12_e3_gpu3 -->
<g id="edge886" class="edge">
<title>expert_l12_e3_gpu3&#45;&gt;send_l12_e3_gpu3</title>
<path fill="none" stroke="black" d="M3223.44,-4313.09C3223.44,-4304.84 3223.44,-4295.76 3223.44,-4286.71"/>
<polygon fill="black" stroke="black" points="3226.94,-4286.55 3223.44,-4276.55 3219.94,-4286.55 3226.94,-4286.55"/>
</g>
<!-- send_l12_e3_gpu3&#45;&gt;agg_l12 -->
<g id="edge887" class="edge">
<title>send_l12_e3_gpu3&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M3442.27,-4192.86C3479.94,-4187.91 3518.76,-4183.4 3555.44,-4180.17 4483.8,-4098.39 5580,-4080.18 6150.04,-4076.59"/>
<polygon fill="black" stroke="black" points="6150.08,-4080.09 6160.06,-4076.53 6150.04,-4073.09 6150.08,-4080.09"/>
</g>
<!-- expert_l12_e4_gpu4 -->
<g id="node681" class="node">
<title>expert_l12_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="4114.44,-4381.33 3658.44,-4381.33 3658.44,-4313.33 4114.44,-4313.33 4114.44,-4381.33"/>
<text text-anchor="middle" x="3886.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E4</text>
<text text-anchor="middle" x="3886.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3886.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3886.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l12_e4_gpu4&#45;&gt;expert_l12_e4_gpu4 -->
<g id="edge889" class="edge">
<title>recv_l12_e4_gpu4&#45;&gt;expert_l12_e4_gpu4</title>
<path fill="none" stroke="black" d="M3886.44,-4418.13C3886.44,-4409.38 3886.44,-4400.27 3886.44,-4391.65"/>
<polygon fill="black" stroke="black" points="3889.94,-4391.41 3886.44,-4381.41 3882.94,-4391.41 3889.94,-4391.41"/>
</g>
<!-- send_l12_e4_gpu4 -->
<g id="node682" class="node">
<title>send_l12_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3886.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3886.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E4</text>
<text text-anchor="middle" x="3886.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3886.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3886.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l12_e4_gpu4&#45;&gt;send_l12_e4_gpu4 -->
<g id="edge890" class="edge">
<title>expert_l12_e4_gpu4&#45;&gt;send_l12_e4_gpu4</title>
<path fill="none" stroke="black" d="M3886.44,-4313.09C3886.44,-4304.84 3886.44,-4295.76 3886.44,-4286.71"/>
<polygon fill="black" stroke="black" points="3889.94,-4286.55 3886.44,-4276.55 3882.94,-4286.55 3889.94,-4286.55"/>
</g>
<!-- send_l12_e4_gpu4&#45;&gt;agg_l12 -->
<g id="edge891" class="edge">
<title>send_l12_e4_gpu4&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M4106.2,-4193.05C4143.58,-4188.11 4182.07,-4183.55 4218.44,-4180.17 4899.76,-4116.73 5697.37,-4091.7 6157.64,-4082.03"/>
<polygon fill="black" stroke="black" points="6157.85,-4085.52 6167.77,-4081.81 6157.7,-4078.52 6157.85,-4085.52"/>
</g>
<!-- expert_l12_e5_gpu5 -->
<g id="node684" class="node">
<title>expert_l12_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4777.44,-4381.33 4321.44,-4381.33 4321.44,-4313.33 4777.44,-4313.33 4777.44,-4381.33"/>
<text text-anchor="middle" x="4549.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E5</text>
<text text-anchor="middle" x="4549.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4549.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4549.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l12_e5_gpu5&#45;&gt;expert_l12_e5_gpu5 -->
<g id="edge893" class="edge">
<title>recv_l12_e5_gpu5&#45;&gt;expert_l12_e5_gpu5</title>
<path fill="none" stroke="black" d="M4549.44,-4418.13C4549.44,-4409.38 4549.44,-4400.27 4549.44,-4391.65"/>
<polygon fill="black" stroke="black" points="4552.94,-4391.41 4549.44,-4381.41 4545.94,-4391.41 4552.94,-4391.41"/>
</g>
<!-- send_l12_e5_gpu5 -->
<g id="node685" class="node">
<title>send_l12_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4549.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4549.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E5</text>
<text text-anchor="middle" x="4549.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4549.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4549.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l12_e5_gpu5&#45;&gt;send_l12_e5_gpu5 -->
<g id="edge894" class="edge">
<title>expert_l12_e5_gpu5&#45;&gt;send_l12_e5_gpu5</title>
<path fill="none" stroke="black" d="M4549.44,-4313.09C4549.44,-4304.84 4549.44,-4295.76 4549.44,-4286.71"/>
<polygon fill="black" stroke="black" points="4552.94,-4286.55 4549.44,-4276.55 4545.94,-4286.55 4552.94,-4286.55"/>
</g>
<!-- send_l12_e5_gpu5&#45;&gt;agg_l12 -->
<g id="edge895" class="edge">
<title>send_l12_e5_gpu5&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M4771.49,-4193.31C4808.16,-4188.41 4845.82,-4183.8 4881.44,-4180.17 5323.29,-4135.04 5833.57,-4106.56 6169.81,-4091.03"/>
<polygon fill="black" stroke="black" points="6170.38,-4094.51 6180.2,-4090.55 6170.05,-4087.52 6170.38,-4094.51"/>
</g>
<!-- expert_l12_e6_gpu6 -->
<g id="node687" class="node">
<title>expert_l12_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5440.44,-4381.33 4984.44,-4381.33 4984.44,-4313.33 5440.44,-4313.33 5440.44,-4381.33"/>
<text text-anchor="middle" x="5212.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E6</text>
<text text-anchor="middle" x="5212.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5212.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5212.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l12_e6_gpu6&#45;&gt;expert_l12_e6_gpu6 -->
<g id="edge897" class="edge">
<title>recv_l12_e6_gpu6&#45;&gt;expert_l12_e6_gpu6</title>
<path fill="none" stroke="black" d="M5212.44,-4418.13C5212.44,-4409.38 5212.44,-4400.27 5212.44,-4391.65"/>
<polygon fill="black" stroke="black" points="5215.94,-4391.41 5212.44,-4381.41 5208.94,-4391.41 5215.94,-4391.41"/>
</g>
<!-- send_l12_e6_gpu6 -->
<g id="node688" class="node">
<title>send_l12_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5212.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5212.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E6</text>
<text text-anchor="middle" x="5212.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5212.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5212.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l12_e6_gpu6&#45;&gt;send_l12_e6_gpu6 -->
<g id="edge898" class="edge">
<title>expert_l12_e6_gpu6&#45;&gt;send_l12_e6_gpu6</title>
<path fill="none" stroke="black" d="M5212.44,-4313.09C5212.44,-4304.84 5212.44,-4295.76 5212.44,-4286.71"/>
<polygon fill="black" stroke="black" points="5215.94,-4286.55 5212.44,-4276.55 5208.94,-4286.55 5215.94,-4286.55"/>
</g>
<!-- send_l12_e6_gpu6&#45;&gt;agg_l12 -->
<g id="edge899" class="edge">
<title>send_l12_e6_gpu6&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M5439.1,-4193.98C5474.34,-4189.13 5510.35,-4184.36 5544.44,-4180.17 5760.57,-4153.54 6003.69,-4128.03 6195.39,-4108.93"/>
<polygon fill="black" stroke="black" points="6195.74,-4112.42 6205.34,-4107.94 6195.05,-4105.45 6195.74,-4112.42"/>
</g>
<!-- expert_l12_e7_gpu7 -->
<g id="node690" class="node">
<title>expert_l12_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="6103.44,-4381.33 5647.44,-4381.33 5647.44,-4313.33 6103.44,-4313.33 6103.44,-4381.33"/>
<text text-anchor="middle" x="5875.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E7</text>
<text text-anchor="middle" x="5875.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5875.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5875.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l12_e7_gpu7&#45;&gt;expert_l12_e7_gpu7 -->
<g id="edge901" class="edge">
<title>recv_l12_e7_gpu7&#45;&gt;expert_l12_e7_gpu7</title>
<path fill="none" stroke="black" d="M5875.44,-4418.13C5875.44,-4409.38 5875.44,-4400.27 5875.44,-4391.65"/>
<polygon fill="black" stroke="black" points="5878.94,-4391.41 5875.44,-4381.41 5871.94,-4391.41 5878.94,-4391.41"/>
</g>
<!-- send_l12_e7_gpu7 -->
<g id="node691" class="node">
<title>send_l12_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5875.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5875.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E7</text>
<text text-anchor="middle" x="5875.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5875.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5875.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l12_e7_gpu7&#45;&gt;send_l12_e7_gpu7 -->
<g id="edge902" class="edge">
<title>expert_l12_e7_gpu7&#45;&gt;send_l12_e7_gpu7</title>
<path fill="none" stroke="black" d="M5875.44,-4313.09C5875.44,-4304.84 5875.44,-4295.76 5875.44,-4286.71"/>
<polygon fill="black" stroke="black" points="5878.94,-4286.55 5875.44,-4276.55 5871.94,-4286.55 5878.94,-4286.55"/>
</g>
<!-- send_l12_e7_gpu7&#45;&gt;agg_l12 -->
<g id="edge903" class="edge">
<title>send_l12_e7_gpu7&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M6049.2,-4187.65C6108.63,-4174.11 6176.87,-4158.56 6243.16,-4143.45"/>
<polygon fill="black" stroke="black" points="6243.95,-4146.86 6252.92,-4141.23 6242.39,-4140.04 6243.95,-4146.86"/>
</g>
<!-- expert_l12_e8_gpu8 -->
<g id="node693" class="node">
<title>expert_l12_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6766.44,-4381.33 6310.44,-4381.33 6310.44,-4313.33 6766.44,-4313.33 6766.44,-4381.33"/>
<text text-anchor="middle" x="6538.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E8</text>
<text text-anchor="middle" x="6538.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l12_e8_gpu8&#45;&gt;expert_l12_e8_gpu8 -->
<g id="edge905" class="edge">
<title>recv_l12_e8_gpu8&#45;&gt;expert_l12_e8_gpu8</title>
<path fill="none" stroke="black" d="M6538.44,-4418.13C6538.44,-4409.38 6538.44,-4400.27 6538.44,-4391.65"/>
<polygon fill="black" stroke="black" points="6541.94,-4391.41 6538.44,-4381.41 6534.94,-4391.41 6541.94,-4391.41"/>
</g>
<!-- send_l12_e8_gpu8 -->
<g id="node694" class="node">
<title>send_l12_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6538.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6538.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E8</text>
<text text-anchor="middle" x="6538.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6538.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l12_e8_gpu8&#45;&gt;send_l12_e8_gpu8 -->
<g id="edge906" class="edge">
<title>expert_l12_e8_gpu8&#45;&gt;send_l12_e8_gpu8</title>
<path fill="none" stroke="black" d="M6538.44,-4313.09C6538.44,-4304.84 6538.44,-4295.76 6538.44,-4286.71"/>
<polygon fill="black" stroke="black" points="6541.94,-4286.55 6538.44,-4276.55 6534.94,-4286.55 6541.94,-4286.55"/>
</g>
<!-- send_l12_e8_gpu8&#45;&gt;agg_l12 -->
<g id="edge907" class="edge">
<title>send_l12_e8_gpu8&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M6538.44,-4179.86C6538.44,-4171.43 6538.44,-4162.46 6538.44,-4153.46"/>
<polygon fill="black" stroke="black" points="6541.94,-4153.31 6538.44,-4143.31 6534.94,-4153.31 6541.94,-4153.31"/>
</g>
<!-- expert_l12_e9_gpu9 -->
<g id="node696" class="node">
<title>expert_l12_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7429.44,-4381.33 6973.44,-4381.33 6973.44,-4313.33 7429.44,-4313.33 7429.44,-4381.33"/>
<text text-anchor="middle" x="7201.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E9</text>
<text text-anchor="middle" x="7201.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7201.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7201.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l12_e9_gpu9&#45;&gt;expert_l12_e9_gpu9 -->
<g id="edge909" class="edge">
<title>recv_l12_e9_gpu9&#45;&gt;expert_l12_e9_gpu9</title>
<path fill="none" stroke="black" d="M7201.44,-4418.13C7201.44,-4409.38 7201.44,-4400.27 7201.44,-4391.65"/>
<polygon fill="black" stroke="black" points="7204.94,-4391.41 7201.44,-4381.41 7197.94,-4391.41 7204.94,-4391.41"/>
</g>
<!-- send_l12_e9_gpu9 -->
<g id="node697" class="node">
<title>send_l12_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7201.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7201.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E9</text>
<text text-anchor="middle" x="7201.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7201.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7201.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l12_e9_gpu9&#45;&gt;send_l12_e9_gpu9 -->
<g id="edge910" class="edge">
<title>expert_l12_e9_gpu9&#45;&gt;send_l12_e9_gpu9</title>
<path fill="none" stroke="black" d="M7201.44,-4313.09C7201.44,-4304.84 7201.44,-4295.76 7201.44,-4286.71"/>
<polygon fill="black" stroke="black" points="7204.94,-4286.55 7201.44,-4276.55 7197.94,-4286.55 7204.94,-4286.55"/>
</g>
<!-- send_l12_e9_gpu9&#45;&gt;agg_l12 -->
<g id="edge911" class="edge">
<title>send_l12_e9_gpu9&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M7027.68,-4187.65C6970.84,-4174.7 6905.93,-4159.91 6842.39,-4145.43"/>
<polygon fill="black" stroke="black" points="6843.14,-4142.01 6832.61,-4143.2 6841.59,-4148.84 6843.14,-4142.01"/>
</g>
<!-- expert_l12_e10_gpu10 -->
<g id="node699" class="node">
<title>expert_l12_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="8092.44,-4381.33 7636.44,-4381.33 7636.44,-4313.33 8092.44,-4313.33 8092.44,-4381.33"/>
<text text-anchor="middle" x="7864.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E10</text>
<text text-anchor="middle" x="7864.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7864.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7864.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l12_e10_gpu10&#45;&gt;expert_l12_e10_gpu10 -->
<g id="edge913" class="edge">
<title>recv_l12_e10_gpu10&#45;&gt;expert_l12_e10_gpu10</title>
<path fill="none" stroke="black" d="M7864.44,-4418.13C7864.44,-4409.38 7864.44,-4400.27 7864.44,-4391.65"/>
<polygon fill="black" stroke="black" points="7867.94,-4391.41 7864.44,-4381.41 7860.94,-4391.41 7867.94,-4391.41"/>
</g>
<!-- send_l12_e10_gpu10 -->
<g id="node700" class="node">
<title>send_l12_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7864.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7864.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E10</text>
<text text-anchor="middle" x="7864.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7864.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7864.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l12_e10_gpu10&#45;&gt;send_l12_e10_gpu10 -->
<g id="edge914" class="edge">
<title>expert_l12_e10_gpu10&#45;&gt;send_l12_e10_gpu10</title>
<path fill="none" stroke="black" d="M7864.44,-4313.09C7864.44,-4304.84 7864.44,-4295.76 7864.44,-4286.71"/>
<polygon fill="black" stroke="black" points="7867.94,-4286.55 7864.44,-4276.55 7860.94,-4286.55 7867.94,-4286.55"/>
</g>
<!-- send_l12_e10_gpu10&#45;&gt;agg_l12 -->
<g id="edge915" class="edge">
<title>send_l12_e10_gpu10&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M7637.78,-4193.98C7602.54,-4189.13 7566.53,-4184.36 7532.44,-4180.17 7356,-4158.43 7161.57,-4137.44 6991.81,-4120.07"/>
<polygon fill="black" stroke="black" points="6992,-4116.57 6981.69,-4119.03 6991.29,-4123.53 6992,-4116.57"/>
</g>
<!-- expert_l12_e11_gpu11 -->
<g id="node702" class="node">
<title>expert_l12_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8755.44,-4381.33 8299.44,-4381.33 8299.44,-4313.33 8755.44,-4313.33 8755.44,-4381.33"/>
<text text-anchor="middle" x="8527.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E11</text>
<text text-anchor="middle" x="8527.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8527.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8527.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l12_e11_gpu11&#45;&gt;expert_l12_e11_gpu11 -->
<g id="edge917" class="edge">
<title>recv_l12_e11_gpu11&#45;&gt;expert_l12_e11_gpu11</title>
<path fill="none" stroke="black" d="M8527.44,-4418.13C8527.44,-4409.38 8527.44,-4400.27 8527.44,-4391.65"/>
<polygon fill="black" stroke="black" points="8530.94,-4391.41 8527.44,-4381.41 8523.94,-4391.41 8530.94,-4391.41"/>
</g>
<!-- send_l12_e11_gpu11 -->
<g id="node703" class="node">
<title>send_l12_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8527.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8527.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E11</text>
<text text-anchor="middle" x="8527.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8527.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8527.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l12_e11_gpu11&#45;&gt;send_l12_e11_gpu11 -->
<g id="edge918" class="edge">
<title>expert_l12_e11_gpu11&#45;&gt;send_l12_e11_gpu11</title>
<path fill="none" stroke="black" d="M8527.44,-4313.09C8527.44,-4304.84 8527.44,-4295.76 8527.44,-4286.71"/>
<polygon fill="black" stroke="black" points="8530.94,-4286.55 8527.44,-4276.55 8523.94,-4286.55 8530.94,-4286.55"/>
</g>
<!-- send_l12_e11_gpu11&#45;&gt;agg_l12 -->
<g id="edge919" class="edge">
<title>send_l12_e11_gpu11&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M8305.4,-4193.31C8268.72,-4188.41 8231.06,-4183.8 8195.44,-4180.17 7773.81,-4137.1 7289.87,-4109.2 6954.31,-4093.25"/>
<polygon fill="black" stroke="black" points="6954.08,-4089.73 6943.92,-4092.75 6953.75,-4096.72 6954.08,-4089.73"/>
</g>
<!-- expert_l12_e12_gpu12 -->
<g id="node705" class="node">
<title>expert_l12_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9418.44,-4381.33 8962.44,-4381.33 8962.44,-4313.33 9418.44,-4313.33 9418.44,-4381.33"/>
<text text-anchor="middle" x="9190.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E12</text>
<text text-anchor="middle" x="9190.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9190.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9190.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l12_e12_gpu12&#45;&gt;expert_l12_e12_gpu12 -->
<g id="edge921" class="edge">
<title>recv_l12_e12_gpu12&#45;&gt;expert_l12_e12_gpu12</title>
<path fill="none" stroke="black" d="M9190.44,-4418.13C9190.44,-4409.38 9190.44,-4400.27 9190.44,-4391.65"/>
<polygon fill="black" stroke="black" points="9193.94,-4391.41 9190.44,-4381.41 9186.94,-4391.41 9193.94,-4391.41"/>
</g>
<!-- send_l12_e12_gpu12 -->
<g id="node706" class="node">
<title>send_l12_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9190.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9190.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E12</text>
<text text-anchor="middle" x="9190.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9190.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9190.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l12_e12_gpu12&#45;&gt;send_l12_e12_gpu12 -->
<g id="edge922" class="edge">
<title>expert_l12_e12_gpu12&#45;&gt;send_l12_e12_gpu12</title>
<path fill="none" stroke="black" d="M9190.44,-4313.09C9190.44,-4304.84 9190.44,-4295.76 9190.44,-4286.71"/>
<polygon fill="black" stroke="black" points="9193.94,-4286.55 9190.44,-4276.55 9186.94,-4286.55 9193.94,-4286.55"/>
</g>
<!-- send_l12_e12_gpu12&#45;&gt;agg_l12 -->
<g id="edge923" class="edge">
<title>send_l12_e12_gpu12&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M8970.69,-4193.05C8933.3,-4188.11 8894.81,-4183.55 8858.44,-4180.17 8186.83,-4117.64 7402.23,-4092.42 6939.13,-4082.45"/>
<polygon fill="black" stroke="black" points="6939.01,-4078.95 6928.93,-4082.23 6938.86,-4085.94 6939.01,-4078.95"/>
</g>
<!-- expert_l12_e13_gpu13 -->
<g id="node708" class="node">
<title>expert_l12_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="10081.44,-4381.33 9625.44,-4381.33 9625.44,-4313.33 10081.44,-4313.33 10081.44,-4381.33"/>
<text text-anchor="middle" x="9853.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E13</text>
<text text-anchor="middle" x="9853.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9853.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9853.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l12_e13_gpu13&#45;&gt;expert_l12_e13_gpu13 -->
<g id="edge925" class="edge">
<title>recv_l12_e13_gpu13&#45;&gt;expert_l12_e13_gpu13</title>
<path fill="none" stroke="black" d="M9853.44,-4418.13C9853.44,-4409.38 9853.44,-4400.27 9853.44,-4391.65"/>
<polygon fill="black" stroke="black" points="9856.94,-4391.41 9853.44,-4381.41 9849.94,-4391.41 9856.94,-4391.41"/>
</g>
<!-- send_l12_e13_gpu13 -->
<g id="node709" class="node">
<title>send_l12_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9853.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9853.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E13</text>
<text text-anchor="middle" x="9853.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9853.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9853.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l12_e13_gpu13&#45;&gt;send_l12_e13_gpu13 -->
<g id="edge926" class="edge">
<title>expert_l12_e13_gpu13&#45;&gt;send_l12_e13_gpu13</title>
<path fill="none" stroke="black" d="M9853.44,-4313.09C9853.44,-4304.84 9853.44,-4295.76 9853.44,-4286.71"/>
<polygon fill="black" stroke="black" points="9856.94,-4286.55 9853.44,-4276.55 9849.94,-4286.55 9856.94,-4286.55"/>
</g>
<!-- send_l12_e13_gpu13&#45;&gt;agg_l12 -->
<g id="edge927" class="edge">
<title>send_l12_e13_gpu13&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M9634.61,-4192.86C9596.94,-4187.91 9558.12,-4183.4 9521.44,-4180.17 8595.16,-4098.57 7501.8,-4080.26 6930.69,-4076.61"/>
<polygon fill="black" stroke="black" points="6930.67,-4073.11 6920.65,-4076.55 6930.63,-4080.11 6930.67,-4073.11"/>
</g>
<!-- expert_l12_e14_gpu14 -->
<g id="node711" class="node">
<title>expert_l12_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10744.44,-4381.33 10288.44,-4381.33 10288.44,-4313.33 10744.44,-4313.33 10744.44,-4381.33"/>
<text text-anchor="middle" x="10516.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E14</text>
<text text-anchor="middle" x="10516.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10516.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10516.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l12_e14_gpu14&#45;&gt;expert_l12_e14_gpu14 -->
<g id="edge929" class="edge">
<title>recv_l12_e14_gpu14&#45;&gt;expert_l12_e14_gpu14</title>
<path fill="none" stroke="black" d="M10516.44,-4418.13C10516.44,-4409.38 10516.44,-4400.27 10516.44,-4391.65"/>
<polygon fill="black" stroke="black" points="10519.94,-4391.41 10516.44,-4381.41 10512.94,-4391.41 10519.94,-4391.41"/>
</g>
<!-- send_l12_e14_gpu14 -->
<g id="node712" class="node">
<title>send_l12_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10516.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10516.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E14</text>
<text text-anchor="middle" x="10516.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10516.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10516.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l12_e14_gpu14&#45;&gt;send_l12_e14_gpu14 -->
<g id="edge930" class="edge">
<title>expert_l12_e14_gpu14&#45;&gt;send_l12_e14_gpu14</title>
<path fill="none" stroke="black" d="M10516.44,-4313.09C10516.44,-4304.84 10516.44,-4295.76 10516.44,-4286.71"/>
<polygon fill="black" stroke="black" points="10519.94,-4286.55 10516.44,-4276.55 10512.94,-4286.55 10519.94,-4286.55"/>
</g>
<!-- send_l12_e14_gpu14&#45;&gt;agg_l12 -->
<g id="edge931" class="edge">
<title>send_l12_e14_gpu14&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M10298.52,-4192.78C10260.57,-4187.8 10221.42,-4183.31 10184.44,-4180.17 9564.73,-4127.55 7749.4,-4094.45 6938.14,-4081.89"/>
<polygon fill="black" stroke="black" points="6938.1,-4078.39 6928.05,-4081.74 6937.99,-4085.39 6938.1,-4078.39"/>
</g>
<!-- expert_l12_e15_gpu15 -->
<g id="node714" class="node">
<title>expert_l12_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11407.44,-4381.33 10951.44,-4381.33 10951.44,-4313.33 11407.44,-4313.33 11407.44,-4381.33"/>
<text text-anchor="middle" x="11179.44" y="-4366.13" font-family="Times,serif" font-size="14.00">Expert L12E15</text>
<text text-anchor="middle" x="11179.44" y="-4351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11179.44" y="-4336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11179.44" y="-4321.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l12_e15_gpu15&#45;&gt;expert_l12_e15_gpu15 -->
<g id="edge933" class="edge">
<title>recv_l12_e15_gpu15&#45;&gt;expert_l12_e15_gpu15</title>
<path fill="none" stroke="black" d="M11179.44,-4418.13C11179.44,-4409.38 11179.44,-4400.27 11179.44,-4391.65"/>
<polygon fill="black" stroke="black" points="11182.94,-4391.41 11179.44,-4381.41 11175.94,-4391.41 11182.94,-4391.41"/>
</g>
<!-- send_l12_e15_gpu15 -->
<g id="node715" class="node">
<title>send_l12_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11179.44" cy="-4228.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11179.44" y="-4247.05" font-family="Times,serif" font-size="14.00">Token Send L12E15</text>
<text text-anchor="middle" x="11179.44" y="-4232.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11179.44" y="-4217.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11179.44" y="-4202.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l12_e15_gpu15&#45;&gt;send_l12_e15_gpu15 -->
<g id="edge934" class="edge">
<title>expert_l12_e15_gpu15&#45;&gt;send_l12_e15_gpu15</title>
<path fill="none" stroke="black" d="M11179.44,-4313.09C11179.44,-4304.84 11179.44,-4295.76 11179.44,-4286.71"/>
<polygon fill="black" stroke="black" points="11182.94,-4286.55 11179.44,-4276.55 11175.94,-4286.55 11182.94,-4286.55"/>
</g>
<!-- send_l12_e15_gpu15&#45;&gt;agg_l12 -->
<g id="edge935" class="edge">
<title>send_l12_e15_gpu15&#45;&gt;agg_l12</title>
<path fill="none" stroke="black" d="M10961.97,-4192.7C10923.89,-4187.71 10884.57,-4183.24 10847.44,-4180.17 10095.12,-4117.95 7852.18,-4089.21 6935.48,-4079.82"/>
<polygon fill="black" stroke="black" points="6935.46,-4076.32 6925.43,-4079.71 6935.39,-4083.31 6935.46,-4076.32"/>
</g>
<!-- residual2_l12 -->
<g id="node717" class="node">
<title>residual2_l12</title>
<polygon fill="lightpink" stroke="black" points="6803.94,-3970.17 6368.94,-3970.17 6368.94,-3902.17 6803.94,-3902.17 6803.94,-3970.17"/>
<text text-anchor="middle" x="6586.44" y="-3954.97" font-family="Times,serif" font-size="14.00">ResidualAdd L12</text>
<text text-anchor="middle" x="6586.44" y="-3939.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6586.44" y="-3924.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6586.44" y="-3909.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l12&#45;&gt;residual2_l12 -->
<g id="edge936" class="edge">
<title>agg_l12&#45;&gt;residual2_l12</title>
<path fill="none" stroke="black" d="M6562.02,-4006.87C6565.22,-3997.73 6568.44,-3988.55 6571.43,-3980"/>
<polygon fill="black" stroke="black" points="6574.83,-3980.89 6574.83,-3970.29 6568.22,-3978.57 6574.83,-3980.89"/>
</g>
<!-- residual2_l12&#45;&gt;ln1_l13 -->
<g id="edge937" class="edge">
<title>residual2_l12&#45;&gt;ln1_l13</title>
<path fill="none" stroke="black" d="M6595.45,-3902.01C6597.78,-3893.46 6600.31,-3884.14 6602.75,-3875.17"/>
<polygon fill="black" stroke="black" points="6606.2,-3875.83 6605.44,-3865.26 6599.44,-3873.99 6606.2,-3875.83"/>
</g>
<!-- attn_l13 -->
<g id="node719" class="node">
<title>attn_l13</title>
<polygon fill="lightcoral" stroke="black" points="6844.44,-3760.17 6384.44,-3760.17 6384.44,-3692.17 6844.44,-3692.17 6844.44,-3760.17"/>
<text text-anchor="middle" x="6614.44" y="-3744.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L13</text>
<text text-anchor="middle" x="6614.44" y="-3729.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6614.44" y="-3714.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3699.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l13&#45;&gt;attn_l13 -->
<g id="edge940" class="edge">
<title>ln1_l13&#45;&gt;attn_l13</title>
<path fill="none" stroke="black" d="M6614.44,-3797.01C6614.44,-3788.56 6614.44,-3779.34 6614.44,-3770.46"/>
<polygon fill="black" stroke="black" points="6617.94,-3770.26 6614.44,-3760.26 6610.94,-3770.26 6617.94,-3770.26"/>
</g>
<!-- residual1_l13 -->
<g id="node720" class="node">
<title>residual1_l13</title>
<polygon fill="lightpink" stroke="black" points="6831.94,-3655.17 6396.94,-3655.17 6396.94,-3587.17 6831.94,-3587.17 6831.94,-3655.17"/>
<text text-anchor="middle" x="6614.44" y="-3639.97" font-family="Times,serif" font-size="14.00">ResidualAdd L13</text>
<text text-anchor="middle" x="6614.44" y="-3624.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3609.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3594.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l13&#45;&gt;residual1_l13 -->
<g id="edge941" class="edge">
<title>attn_l13&#45;&gt;residual1_l13</title>
<path fill="none" stroke="black" d="M6614.44,-3692.01C6614.44,-3683.56 6614.44,-3674.34 6614.44,-3665.46"/>
<polygon fill="black" stroke="black" points="6617.94,-3665.26 6614.44,-3655.26 6610.94,-3665.26 6617.94,-3665.26"/>
</g>
<!-- ln2_l13 -->
<g id="node721" class="node">
<title>ln2_l13</title>
<polygon fill="lightyellow" stroke="black" points="6831.94,-3550.17 6396.94,-3550.17 6396.94,-3482.17 6831.94,-3482.17 6831.94,-3550.17"/>
<text text-anchor="middle" x="6614.44" y="-3534.97" font-family="Times,serif" font-size="14.00">LayerNorm L13</text>
<text text-anchor="middle" x="6614.44" y="-3519.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3504.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3489.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l13&#45;&gt;ln2_l13 -->
<g id="edge942" class="edge">
<title>residual1_l13&#45;&gt;ln2_l13</title>
<path fill="none" stroke="black" d="M6614.44,-3587.01C6614.44,-3578.56 6614.44,-3569.34 6614.44,-3560.46"/>
<polygon fill="black" stroke="black" points="6617.94,-3560.26 6614.44,-3550.26 6610.94,-3560.26 6617.94,-3560.26"/>
</g>
<!-- ln2_l13&#45;&gt;route_l13 -->
<g id="edge943" class="edge">
<title>ln2_l13&#45;&gt;route_l13</title>
<path fill="none" stroke="black" d="M6614.44,-3482C6614.44,-3473.86 6614.44,-3464.8 6614.44,-3455.52"/>
<polygon fill="black" stroke="black" points="6617.94,-3455.4 6614.44,-3445.4 6610.94,-3455.4 6617.94,-3455.4"/>
</g>
<!-- recv_l13_e0_gpu0 -->
<g id="node723" class="node">
<title>recv_l13_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1310.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1310.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E0</text>
<text text-anchor="middle" x="1310.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1310.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1310.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e0_gpu0 -->
<g id="edge944" class="edge">
<title>route_l13&#45;&gt;recv_l13_e0_gpu0</title>
<path fill="none" stroke="black" d="M6230.34,-3371.48C5488.72,-3361.75 3808,-3336.41 2394.44,-3291.17 2060.07,-3280.46 1975.56,-3289.02 1642.44,-3258.17 1609.33,-3255.1 1574.48,-3251.06 1540.29,-3246.63"/>
<polygon fill="black" stroke="black" points="1540.56,-3243.13 1530.19,-3245.31 1539.65,-3250.07 1540.56,-3243.13"/>
<text text-anchor="middle" x="2466.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l13_e1_gpu1 -->
<g id="node726" class="node">
<title>recv_l13_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1973.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1973.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E1</text>
<text text-anchor="middle" x="1973.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1973.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1973.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e1_gpu1 -->
<g id="edge948" class="edge">
<title>route_l13&#45;&gt;recv_l13_e1_gpu1</title>
<path fill="none" stroke="black" d="M6227.4,-3369.29C5575.9,-3357.19 4218.87,-3329.64 3071.44,-3291.17 2730.87,-3279.75 2644.76,-3289.46 2305.44,-3258.17 2272.33,-3255.11 2237.47,-3251.08 2203.29,-3246.65"/>
<polygon fill="black" stroke="black" points="2203.56,-3243.16 2193.19,-3245.33 2202.65,-3250.1 2203.56,-3243.16"/>
<text text-anchor="middle" x="3143.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l13_e2_gpu2 -->
<g id="node729" class="node">
<title>recv_l13_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2636.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2636.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E2</text>
<text text-anchor="middle" x="2636.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2636.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2636.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e2_gpu2 -->
<g id="edge952" class="edge">
<title>route_l13&#45;&gt;recv_l13_e2_gpu2</title>
<path fill="none" stroke="black" d="M6223.09,-3366.3C5669.03,-3351.94 4624.24,-3323.46 3734.44,-3291.17 3393.9,-3278.81 3307.76,-3289.46 2968.44,-3258.17 2935.33,-3255.11 2900.47,-3251.08 2866.29,-3246.65"/>
<polygon fill="black" stroke="black" points="2866.56,-3243.16 2856.19,-3245.33 2865.65,-3250.1 2866.56,-3243.16"/>
<text text-anchor="middle" x="3806.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l13_e3_gpu3 -->
<g id="node732" class="node">
<title>recv_l13_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3299.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3299.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E3</text>
<text text-anchor="middle" x="3299.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3299.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3299.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e3_gpu3 -->
<g id="edge956" class="edge">
<title>route_l13&#45;&gt;recv_l13_e3_gpu3</title>
<path fill="none" stroke="black" d="M6216.18,-3361.46C5772.4,-3344.95 5033.54,-3317.06 4397.44,-3291.17 4056.96,-3277.3 3970.76,-3289.46 3631.44,-3258.17 3598.33,-3255.11 3563.47,-3251.08 3529.29,-3246.65"/>
<polygon fill="black" stroke="black" points="3529.56,-3243.16 3519.19,-3245.33 3528.65,-3250.1 3529.56,-3243.16"/>
<text text-anchor="middle" x="4469.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l13_e4_gpu4 -->
<g id="node735" class="node">
<title>recv_l13_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3962.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3962.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E4</text>
<text text-anchor="middle" x="3962.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3962.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3962.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e4_gpu4 -->
<g id="edge960" class="edge">
<title>route_l13&#45;&gt;recv_l13_e4_gpu4</title>
<path fill="none" stroke="black" d="M6224.2,-3367.04C5762.53,-3353.77 4971.13,-3323.22 4294.44,-3258.17 4261.61,-3255.01 4227.05,-3250.94 4193.13,-3246.53"/>
<polygon fill="black" stroke="black" points="4193.48,-3243.04 4183.11,-3245.21 4192.57,-3249.98 4193.48,-3243.04"/>
<text text-anchor="middle" x="4745.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l13_e5_gpu5 -->
<g id="node738" class="node">
<title>recv_l13_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4625.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4625.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E5</text>
<text text-anchor="middle" x="4625.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4625.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4625.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e5_gpu5 -->
<g id="edge964" class="edge">
<title>route_l13&#45;&gt;recv_l13_e5_gpu5</title>
<path fill="none" stroke="black" d="M6206.86,-3355.09C5871.03,-3335.81 5382.6,-3303.4 4957.44,-3258.17 4925.44,-3254.76 4891.78,-3250.63 4858.66,-3246.25"/>
<polygon fill="black" stroke="black" points="4858.78,-3242.73 4848.41,-3244.88 4857.86,-3249.67 4858.78,-3242.73"/>
<text text-anchor="middle" x="5346.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l13_e6_gpu6 -->
<g id="node741" class="node">
<title>recv_l13_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5288.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5288.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E6</text>
<text text-anchor="middle" x="5288.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5288.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5288.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e6_gpu6 -->
<g id="edge968" class="edge">
<title>route_l13&#45;&gt;recv_l13_e6_gpu6</title>
<path fill="none" stroke="black" d="M6164.2,-3324.91C5993.75,-3304.93 5798.04,-3281.3 5620.44,-3258.17 5590.1,-3254.21 5558.22,-3249.9 5526.71,-3245.54"/>
<polygon fill="black" stroke="black" points="5526.89,-3242.03 5516.5,-3244.12 5525.93,-3248.96 5526.89,-3242.03"/>
<text text-anchor="middle" x="5938.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l13_e7_gpu7 -->
<g id="node744" class="node">
<title>recv_l13_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5951.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5951.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E7</text>
<text text-anchor="middle" x="5951.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5951.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5951.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e7_gpu7 -->
<g id="edge972" class="edge">
<title>route_l13&#45;&gt;recv_l13_e7_gpu7</title>
<path fill="none" stroke="black" d="M6345.25,-3309.14C6270.71,-3290.58 6191.82,-3270.93 6124.37,-3254.14"/>
<polygon fill="black" stroke="black" points="6125.06,-3250.71 6114.51,-3251.69 6123.37,-3257.5 6125.06,-3250.71"/>
<text text-anchor="middle" x="6335.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l13_e8_gpu8 -->
<g id="node747" class="node">
<title>recv_l13_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6614.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6614.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E8</text>
<text text-anchor="middle" x="6614.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e8_gpu8 -->
<g id="edge976" class="edge">
<title>route_l13&#45;&gt;recv_l13_e8_gpu8</title>
<path fill="none" stroke="black" d="M6614.44,-3309.02C6614.44,-3295.64 6614.44,-3281.69 6614.44,-3268.67"/>
<polygon fill="black" stroke="black" points="6617.94,-3268.44 6614.44,-3258.44 6610.94,-3268.44 6617.94,-3268.44"/>
<text text-anchor="middle" x="6686.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l13_e9_gpu9 -->
<g id="node750" class="node">
<title>recv_l13_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7277.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7277.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E9</text>
<text text-anchor="middle" x="7277.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7277.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7277.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e9_gpu9 -->
<g id="edge980" class="edge">
<title>route_l13&#45;&gt;recv_l13_e9_gpu9</title>
<path fill="none" stroke="black" d="M6883.63,-3309.14C6958.17,-3290.58 7037.06,-3270.93 7104.51,-3254.14"/>
<polygon fill="black" stroke="black" points="7105.51,-3257.5 7114.37,-3251.69 7103.82,-3250.71 7105.51,-3257.5"/>
<text text-anchor="middle" x="7077.44" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l13_e10_gpu10 -->
<g id="node753" class="node">
<title>recv_l13_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7940.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7940.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E10</text>
<text text-anchor="middle" x="7940.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7940.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7940.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e10_gpu10 -->
<g id="edge984" class="edge">
<title>route_l13&#45;&gt;recv_l13_e10_gpu10</title>
<path fill="none" stroke="black" d="M6937.27,-3339.72C7131.83,-3317.29 7384.53,-3287.33 7608.44,-3258.17 7638.78,-3254.21 7670.66,-3249.9 7702.17,-3245.54"/>
<polygon fill="black" stroke="black" points="7702.96,-3248.96 7712.38,-3244.12 7701.99,-3242.03 7702.96,-3248.96"/>
<text text-anchor="middle" x="7522.94" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l13_e11_gpu11 -->
<g id="node756" class="node">
<title>recv_l13_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8603.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8603.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E11</text>
<text text-anchor="middle" x="8603.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8603.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8603.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e11_gpu11 -->
<g id="edge988" class="edge">
<title>route_l13&#45;&gt;recv_l13_e11_gpu11</title>
<path fill="none" stroke="black" d="M6963.79,-3358.39C7299.56,-3339.62 7821.01,-3306.08 8271.44,-3258.17 8303.44,-3254.76 8337.1,-3250.63 8370.22,-3246.25"/>
<polygon fill="black" stroke="black" points="8371.02,-3249.67 8380.47,-3244.88 8370.1,-3242.73 8371.02,-3249.67"/>
<text text-anchor="middle" x="8168.94" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l13_e12_gpu12 -->
<g id="node759" class="node">
<title>recv_l13_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9266.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9266.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E12</text>
<text text-anchor="middle" x="9266.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9266.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9266.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e12_gpu12 -->
<g id="edge992" class="edge">
<title>route_l13&#45;&gt;recv_l13_e12_gpu12</title>
<path fill="none" stroke="black" d="M6977.35,-3367.82C7434.61,-3354.98 8244.2,-3324.53 8934.44,-3258.17 8967.27,-3255.01 9001.83,-3250.94 9035.75,-3246.53"/>
<polygon fill="black" stroke="black" points="9036.32,-3249.98 9045.77,-3245.21 9035.4,-3243.04 9036.32,-3249.98"/>
<text text-anchor="middle" x="8760.94" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l13_e13_gpu13 -->
<g id="node762" class="node">
<title>recv_l13_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9929.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9929.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E13</text>
<text text-anchor="middle" x="9929.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9929.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9929.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e13_gpu13 -->
<g id="edge996" class="edge">
<title>route_l13&#45;&gt;recv_l13_e13_gpu13</title>
<path fill="none" stroke="black" d="M6970.76,-3363.17C7410.49,-3346.99 8181.1,-3318.18 8841.44,-3291.17 9177.48,-3277.42 9262.55,-3289.15 9597.44,-3258.17 9630.55,-3255.1 9665.41,-3251.06 9699.59,-3246.64"/>
<polygon fill="black" stroke="black" points="9700.23,-3250.08 9709.69,-3245.31 9699.32,-3243.14 9700.23,-3250.08"/>
<text text-anchor="middle" x="9426.94" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l13_e14_gpu14 -->
<g id="node765" class="node">
<title>recv_l13_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10592.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10592.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E14</text>
<text text-anchor="middle" x="10592.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10592.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10592.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e14_gpu14 -->
<g id="edge1000" class="edge">
<title>route_l13&#45;&gt;recv_l13_e14_gpu14</title>
<path fill="none" stroke="black" d="M6976.16,-3367.21C7523.91,-3353.28 8596.53,-3324.51 9507.44,-3291.17 9842.2,-3278.91 9926.88,-3289.05 10260.44,-3258.17 10293.55,-3255.1 10328.41,-3251.06 10362.59,-3246.63"/>
<polygon fill="black" stroke="black" points="10363.23,-3250.08 10372.69,-3245.31 10362.32,-3243.14 10363.23,-3250.08"/>
<text text-anchor="middle" x="10090.94" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l13_e15_gpu15 -->
<g id="node768" class="node">
<title>recv_l13_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11255.44" cy="-3210.08" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11255.44" y="-3228.88" font-family="Times,serif" font-size="14.00">Token Receive L13E15</text>
<text text-anchor="middle" x="11255.44" y="-3213.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11255.44" y="-3198.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11255.44" y="-3183.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l13&#45;&gt;recv_l13_e15_gpu15 -->
<g id="edge1004" class="edge">
<title>route_l13&#45;&gt;recv_l13_e15_gpu15</title>
<path fill="none" stroke="black" d="M6979.99,-3369.84C7624.66,-3358.14 9005.79,-3330.67 10171.44,-3291.17 10505.79,-3279.84 10590.32,-3289.02 10923.44,-3258.17 10956.55,-3255.1 10991.41,-3251.06 11025.59,-3246.63"/>
<polygon fill="black" stroke="black" points="11026.23,-3250.07 11035.69,-3245.31 11025.32,-3243.13 11026.23,-3250.07"/>
<text text-anchor="middle" x="10752.94" y="-3279.97" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l13_e0_gpu0 -->
<g id="node724" class="node">
<title>expert_l13_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1538.44,-3125 1082.44,-3125 1082.44,-3057 1538.44,-3057 1538.44,-3125"/>
<text text-anchor="middle" x="1310.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E0</text>
<text text-anchor="middle" x="1310.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1310.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1310.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l13_e0_gpu0&#45;&gt;expert_l13_e0_gpu0 -->
<g id="edge945" class="edge">
<title>recv_l13_e0_gpu0&#45;&gt;expert_l13_e0_gpu0</title>
<path fill="none" stroke="black" d="M1310.44,-3161.8C1310.44,-3153.04 1310.44,-3143.94 1310.44,-3135.31"/>
<polygon fill="black" stroke="black" points="1313.94,-3135.08 1310.44,-3125.08 1306.94,-3135.08 1313.94,-3135.08"/>
</g>
<!-- send_l13_e0_gpu0 -->
<g id="node725" class="node">
<title>send_l13_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1310.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1310.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E0</text>
<text text-anchor="middle" x="1310.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1310.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1310.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l13_e0_gpu0&#45;&gt;send_l13_e0_gpu0 -->
<g id="edge946" class="edge">
<title>expert_l13_e0_gpu0&#45;&gt;send_l13_e0_gpu0</title>
<path fill="none" stroke="black" d="M1310.44,-3056.76C1310.44,-3048.51 1310.44,-3039.43 1310.44,-3030.38"/>
<polygon fill="black" stroke="black" points="1313.94,-3030.22 1310.44,-3020.22 1306.94,-3030.22 1313.94,-3030.22"/>
</g>
<!-- agg_l13 -->
<g id="node771" class="node">
<title>agg_l13</title>
<polygon fill="lightgray" stroke="black" points="7092.33,-2886.83 6332.12,-2886.83 6136.55,-2750.83 6896.76,-2750.83 7092.33,-2886.83"/>
<text text-anchor="middle" x="6614.44" y="-2837.63" font-family="Times,serif" font-size="14.00">Expert Aggregation L13</text>
<text text-anchor="middle" x="6614.44" y="-2822.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-2807.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-2792.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l13_e0_gpu0&#45;&gt;agg_l13 -->
<g id="edge947" class="edge">
<title>send_l13_e0_gpu0&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M1527.45,-2936.33C1565.68,-2931.33 1605.16,-2926.86 1642.44,-2923.83 2530.88,-2851.8 5220.64,-2828.31 6228.01,-2821.92"/>
<polygon fill="black" stroke="black" points="6228.34,-2825.41 6238.32,-2821.85 6228.29,-2818.41 6228.34,-2825.41"/>
</g>
<!-- expert_l13_e1_gpu1 -->
<g id="node727" class="node">
<title>expert_l13_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="2201.44,-3125 1745.44,-3125 1745.44,-3057 2201.44,-3057 2201.44,-3125"/>
<text text-anchor="middle" x="1973.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E1</text>
<text text-anchor="middle" x="1973.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1973.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1973.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l13_e1_gpu1&#45;&gt;expert_l13_e1_gpu1 -->
<g id="edge949" class="edge">
<title>recv_l13_e1_gpu1&#45;&gt;expert_l13_e1_gpu1</title>
<path fill="none" stroke="black" d="M1973.44,-3161.8C1973.44,-3153.04 1973.44,-3143.94 1973.44,-3135.31"/>
<polygon fill="black" stroke="black" points="1976.94,-3135.08 1973.44,-3125.08 1969.94,-3135.08 1976.94,-3135.08"/>
</g>
<!-- send_l13_e1_gpu1 -->
<g id="node728" class="node">
<title>send_l13_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="1973.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1973.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E1</text>
<text text-anchor="middle" x="1973.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1973.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1973.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l13_e1_gpu1&#45;&gt;send_l13_e1_gpu1 -->
<g id="edge950" class="edge">
<title>expert_l13_e1_gpu1&#45;&gt;send_l13_e1_gpu1</title>
<path fill="none" stroke="black" d="M1973.44,-3056.76C1973.44,-3048.51 1973.44,-3039.43 1973.44,-3030.38"/>
<polygon fill="black" stroke="black" points="1976.94,-3030.22 1973.44,-3020.22 1969.94,-3030.22 1976.94,-3030.22"/>
</g>
<!-- send_l13_e1_gpu1&#45;&gt;agg_l13 -->
<g id="edge951" class="edge">
<title>send_l13_e1_gpu1&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M2190.91,-2936.37C2228.99,-2931.38 2268.31,-2926.9 2305.44,-2923.83 3061.27,-2861.33 5321.64,-2832.61 6230.13,-2823.35"/>
<polygon fill="black" stroke="black" points="6230.46,-2826.85 6240.42,-2823.25 6230.39,-2819.85 6230.46,-2826.85"/>
</g>
<!-- expert_l13_e2_gpu2 -->
<g id="node730" class="node">
<title>expert_l13_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2864.44,-3125 2408.44,-3125 2408.44,-3057 2864.44,-3057 2864.44,-3125"/>
<text text-anchor="middle" x="2636.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E2</text>
<text text-anchor="middle" x="2636.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2636.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2636.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l13_e2_gpu2&#45;&gt;expert_l13_e2_gpu2 -->
<g id="edge953" class="edge">
<title>recv_l13_e2_gpu2&#45;&gt;expert_l13_e2_gpu2</title>
<path fill="none" stroke="black" d="M2636.44,-3161.8C2636.44,-3153.04 2636.44,-3143.94 2636.44,-3135.31"/>
<polygon fill="black" stroke="black" points="2639.94,-3135.08 2636.44,-3125.08 2632.94,-3135.08 2639.94,-3135.08"/>
</g>
<!-- send_l13_e2_gpu2 -->
<g id="node731" class="node">
<title>send_l13_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2636.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2636.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E2</text>
<text text-anchor="middle" x="2636.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2636.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2636.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l13_e2_gpu2&#45;&gt;send_l13_e2_gpu2 -->
<g id="edge954" class="edge">
<title>expert_l13_e2_gpu2&#45;&gt;send_l13_e2_gpu2</title>
<path fill="none" stroke="black" d="M2636.44,-3056.76C2636.44,-3048.51 2636.44,-3039.43 2636.44,-3030.38"/>
<polygon fill="black" stroke="black" points="2639.94,-3030.22 2636.44,-3020.22 2632.94,-3030.22 2639.94,-3030.22"/>
</g>
<!-- send_l13_e2_gpu2&#45;&gt;agg_l13 -->
<g id="edge955" class="edge">
<title>send_l13_e2_gpu2&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M2854.36,-2936.45C2892.31,-2931.47 2931.46,-2926.97 2968.44,-2923.83 3592.79,-2870.83 5430.71,-2837.62 6232.78,-2825.28"/>
<polygon fill="black" stroke="black" points="6233.1,-2828.78 6243.05,-2825.12 6232.99,-2821.78 6233.1,-2828.78"/>
</g>
<!-- expert_l13_e3_gpu3 -->
<g id="node733" class="node">
<title>expert_l13_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3527.44,-3125 3071.44,-3125 3071.44,-3057 3527.44,-3057 3527.44,-3125"/>
<text text-anchor="middle" x="3299.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E3</text>
<text text-anchor="middle" x="3299.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3299.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3299.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l13_e3_gpu3&#45;&gt;expert_l13_e3_gpu3 -->
<g id="edge957" class="edge">
<title>recv_l13_e3_gpu3&#45;&gt;expert_l13_e3_gpu3</title>
<path fill="none" stroke="black" d="M3299.44,-3161.8C3299.44,-3153.04 3299.44,-3143.94 3299.44,-3135.31"/>
<polygon fill="black" stroke="black" points="3302.94,-3135.08 3299.44,-3125.08 3295.94,-3135.08 3302.94,-3135.08"/>
</g>
<!-- send_l13_e3_gpu3 -->
<g id="node734" class="node">
<title>send_l13_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3299.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3299.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E3</text>
<text text-anchor="middle" x="3299.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3299.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3299.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l13_e3_gpu3&#45;&gt;send_l13_e3_gpu3 -->
<g id="edge958" class="edge">
<title>expert_l13_e3_gpu3&#45;&gt;send_l13_e3_gpu3</title>
<path fill="none" stroke="black" d="M3299.44,-3056.76C3299.44,-3048.51 3299.44,-3039.43 3299.44,-3030.38"/>
<polygon fill="black" stroke="black" points="3302.94,-3030.22 3299.44,-3020.22 3295.94,-3030.22 3302.94,-3030.22"/>
</g>
<!-- send_l13_e3_gpu3&#45;&gt;agg_l13 -->
<g id="edge959" class="edge">
<title>send_l13_e3_gpu3&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M3518.27,-2936.53C3555.94,-2931.57 3594.76,-2927.06 3631.44,-2923.83 4559.8,-2842.05 5656,-2823.85 6226.04,-2820.26"/>
<polygon fill="black" stroke="black" points="6226.08,-2823.76 6236.06,-2820.19 6226.04,-2816.76 6226.08,-2823.76"/>
</g>
<!-- expert_l13_e4_gpu4 -->
<g id="node736" class="node">
<title>expert_l13_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="4190.44,-3125 3734.44,-3125 3734.44,-3057 4190.44,-3057 4190.44,-3125"/>
<text text-anchor="middle" x="3962.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E4</text>
<text text-anchor="middle" x="3962.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3962.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3962.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l13_e4_gpu4&#45;&gt;expert_l13_e4_gpu4 -->
<g id="edge961" class="edge">
<title>recv_l13_e4_gpu4&#45;&gt;expert_l13_e4_gpu4</title>
<path fill="none" stroke="black" d="M3962.44,-3161.8C3962.44,-3153.04 3962.44,-3143.94 3962.44,-3135.31"/>
<polygon fill="black" stroke="black" points="3965.94,-3135.08 3962.44,-3125.08 3958.94,-3135.08 3965.94,-3135.08"/>
</g>
<!-- send_l13_e4_gpu4 -->
<g id="node737" class="node">
<title>send_l13_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="3962.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3962.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E4</text>
<text text-anchor="middle" x="3962.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3962.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3962.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l13_e4_gpu4&#45;&gt;send_l13_e4_gpu4 -->
<g id="edge962" class="edge">
<title>expert_l13_e4_gpu4&#45;&gt;send_l13_e4_gpu4</title>
<path fill="none" stroke="black" d="M3962.44,-3056.76C3962.44,-3048.51 3962.44,-3039.43 3962.44,-3030.38"/>
<polygon fill="black" stroke="black" points="3965.94,-3030.22 3962.44,-3020.22 3958.94,-3030.22 3965.94,-3030.22"/>
</g>
<!-- send_l13_e4_gpu4&#45;&gt;agg_l13 -->
<g id="edge963" class="edge">
<title>send_l13_e4_gpu4&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M4182.2,-2936.72C4219.58,-2931.77 4258.07,-2927.22 4294.44,-2923.83 4975.76,-2860.4 5773.37,-2835.36 6233.64,-2825.69"/>
<polygon fill="black" stroke="black" points="6233.85,-2829.19 6243.77,-2825.48 6233.7,-2822.19 6233.85,-2829.19"/>
</g>
<!-- expert_l13_e5_gpu5 -->
<g id="node739" class="node">
<title>expert_l13_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4853.44,-3125 4397.44,-3125 4397.44,-3057 4853.44,-3057 4853.44,-3125"/>
<text text-anchor="middle" x="4625.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E5</text>
<text text-anchor="middle" x="4625.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4625.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4625.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l13_e5_gpu5&#45;&gt;expert_l13_e5_gpu5 -->
<g id="edge965" class="edge">
<title>recv_l13_e5_gpu5&#45;&gt;expert_l13_e5_gpu5</title>
<path fill="none" stroke="black" d="M4625.44,-3161.8C4625.44,-3153.04 4625.44,-3143.94 4625.44,-3135.31"/>
<polygon fill="black" stroke="black" points="4628.94,-3135.08 4625.44,-3125.08 4621.94,-3135.08 4628.94,-3135.08"/>
</g>
<!-- send_l13_e5_gpu5 -->
<g id="node740" class="node">
<title>send_l13_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4625.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4625.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E5</text>
<text text-anchor="middle" x="4625.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4625.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4625.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l13_e5_gpu5&#45;&gt;send_l13_e5_gpu5 -->
<g id="edge966" class="edge">
<title>expert_l13_e5_gpu5&#45;&gt;send_l13_e5_gpu5</title>
<path fill="none" stroke="black" d="M4625.44,-3056.76C4625.44,-3048.51 4625.44,-3039.43 4625.44,-3030.38"/>
<polygon fill="black" stroke="black" points="4628.94,-3030.22 4625.44,-3020.22 4621.94,-3030.22 4628.94,-3030.22"/>
</g>
<!-- send_l13_e5_gpu5&#45;&gt;agg_l13 -->
<g id="edge967" class="edge">
<title>send_l13_e5_gpu5&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M4847.49,-2936.98C4884.16,-2932.08 4921.82,-2927.47 4957.44,-2923.83 5399.29,-2878.7 5909.57,-2850.22 6245.81,-2834.7"/>
<polygon fill="black" stroke="black" points="6246.38,-2838.18 6256.2,-2834.22 6246.05,-2831.18 6246.38,-2838.18"/>
</g>
<!-- expert_l13_e6_gpu6 -->
<g id="node742" class="node">
<title>expert_l13_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5516.44,-3125 5060.44,-3125 5060.44,-3057 5516.44,-3057 5516.44,-3125"/>
<text text-anchor="middle" x="5288.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E6</text>
<text text-anchor="middle" x="5288.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5288.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5288.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l13_e6_gpu6&#45;&gt;expert_l13_e6_gpu6 -->
<g id="edge969" class="edge">
<title>recv_l13_e6_gpu6&#45;&gt;expert_l13_e6_gpu6</title>
<path fill="none" stroke="black" d="M5288.44,-3161.8C5288.44,-3153.04 5288.44,-3143.94 5288.44,-3135.31"/>
<polygon fill="black" stroke="black" points="5291.94,-3135.08 5288.44,-3125.08 5284.94,-3135.08 5291.94,-3135.08"/>
</g>
<!-- send_l13_e6_gpu6 -->
<g id="node743" class="node">
<title>send_l13_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5288.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5288.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E6</text>
<text text-anchor="middle" x="5288.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5288.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5288.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l13_e6_gpu6&#45;&gt;send_l13_e6_gpu6 -->
<g id="edge970" class="edge">
<title>expert_l13_e6_gpu6&#45;&gt;send_l13_e6_gpu6</title>
<path fill="none" stroke="black" d="M5288.44,-3056.76C5288.44,-3048.51 5288.44,-3039.43 5288.44,-3030.38"/>
<polygon fill="black" stroke="black" points="5291.94,-3030.22 5288.44,-3020.22 5284.94,-3030.22 5291.94,-3030.22"/>
</g>
<!-- send_l13_e6_gpu6&#45;&gt;agg_l13 -->
<g id="edge971" class="edge">
<title>send_l13_e6_gpu6&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M5515.1,-2937.64C5550.34,-2932.8 5586.35,-2928.03 5620.44,-2923.83 5836.57,-2897.21 6079.69,-2871.69 6271.39,-2852.6"/>
<polygon fill="black" stroke="black" points="6271.74,-2856.08 6281.34,-2851.61 6271.05,-2849.12 6271.74,-2856.08"/>
</g>
<!-- expert_l13_e7_gpu7 -->
<g id="node745" class="node">
<title>expert_l13_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="6179.44,-3125 5723.44,-3125 5723.44,-3057 6179.44,-3057 6179.44,-3125"/>
<text text-anchor="middle" x="5951.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E7</text>
<text text-anchor="middle" x="5951.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5951.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5951.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l13_e7_gpu7&#45;&gt;expert_l13_e7_gpu7 -->
<g id="edge973" class="edge">
<title>recv_l13_e7_gpu7&#45;&gt;expert_l13_e7_gpu7</title>
<path fill="none" stroke="black" d="M5951.44,-3161.8C5951.44,-3153.04 5951.44,-3143.94 5951.44,-3135.31"/>
<polygon fill="black" stroke="black" points="5954.94,-3135.08 5951.44,-3125.08 5947.94,-3135.08 5954.94,-3135.08"/>
</g>
<!-- send_l13_e7_gpu7 -->
<g id="node746" class="node">
<title>send_l13_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="5951.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5951.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E7</text>
<text text-anchor="middle" x="5951.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5951.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5951.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l13_e7_gpu7&#45;&gt;send_l13_e7_gpu7 -->
<g id="edge974" class="edge">
<title>expert_l13_e7_gpu7&#45;&gt;send_l13_e7_gpu7</title>
<path fill="none" stroke="black" d="M5951.44,-3056.76C5951.44,-3048.51 5951.44,-3039.43 5951.44,-3030.38"/>
<polygon fill="black" stroke="black" points="5954.94,-3030.22 5951.44,-3020.22 5947.94,-3030.22 5954.94,-3030.22"/>
</g>
<!-- send_l13_e7_gpu7&#45;&gt;agg_l13 -->
<g id="edge975" class="edge">
<title>send_l13_e7_gpu7&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M6125.2,-2931.32C6184.63,-2917.78 6252.87,-2902.23 6319.16,-2887.12"/>
<polygon fill="black" stroke="black" points="6319.95,-2890.53 6328.92,-2884.9 6318.39,-2883.71 6319.95,-2890.53"/>
</g>
<!-- expert_l13_e8_gpu8 -->
<g id="node748" class="node">
<title>expert_l13_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6842.44,-3125 6386.44,-3125 6386.44,-3057 6842.44,-3057 6842.44,-3125"/>
<text text-anchor="middle" x="6614.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E8</text>
<text text-anchor="middle" x="6614.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l13_e8_gpu8&#45;&gt;expert_l13_e8_gpu8 -->
<g id="edge977" class="edge">
<title>recv_l13_e8_gpu8&#45;&gt;expert_l13_e8_gpu8</title>
<path fill="none" stroke="black" d="M6614.44,-3161.8C6614.44,-3153.04 6614.44,-3143.94 6614.44,-3135.31"/>
<polygon fill="black" stroke="black" points="6617.94,-3135.08 6614.44,-3125.08 6610.94,-3135.08 6617.94,-3135.08"/>
</g>
<!-- send_l13_e8_gpu8 -->
<g id="node749" class="node">
<title>send_l13_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6614.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6614.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E8</text>
<text text-anchor="middle" x="6614.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6614.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l13_e8_gpu8&#45;&gt;send_l13_e8_gpu8 -->
<g id="edge978" class="edge">
<title>expert_l13_e8_gpu8&#45;&gt;send_l13_e8_gpu8</title>
<path fill="none" stroke="black" d="M6614.44,-3056.76C6614.44,-3048.51 6614.44,-3039.43 6614.44,-3030.38"/>
<polygon fill="black" stroke="black" points="6617.94,-3030.22 6614.44,-3020.22 6610.94,-3030.22 6617.94,-3030.22"/>
</g>
<!-- send_l13_e8_gpu8&#45;&gt;agg_l13 -->
<g id="edge979" class="edge">
<title>send_l13_e8_gpu8&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M6614.44,-2923.53C6614.44,-2915.1 6614.44,-2906.13 6614.44,-2897.13"/>
<polygon fill="black" stroke="black" points="6617.94,-2896.97 6614.44,-2886.97 6610.94,-2896.97 6617.94,-2896.97"/>
</g>
<!-- expert_l13_e9_gpu9 -->
<g id="node751" class="node">
<title>expert_l13_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7505.44,-3125 7049.44,-3125 7049.44,-3057 7505.44,-3057 7505.44,-3125"/>
<text text-anchor="middle" x="7277.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E9</text>
<text text-anchor="middle" x="7277.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7277.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7277.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l13_e9_gpu9&#45;&gt;expert_l13_e9_gpu9 -->
<g id="edge981" class="edge">
<title>recv_l13_e9_gpu9&#45;&gt;expert_l13_e9_gpu9</title>
<path fill="none" stroke="black" d="M7277.44,-3161.8C7277.44,-3153.04 7277.44,-3143.94 7277.44,-3135.31"/>
<polygon fill="black" stroke="black" points="7280.94,-3135.08 7277.44,-3125.08 7273.94,-3135.08 7280.94,-3135.08"/>
</g>
<!-- send_l13_e9_gpu9 -->
<g id="node752" class="node">
<title>send_l13_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7277.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7277.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E9</text>
<text text-anchor="middle" x="7277.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7277.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7277.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l13_e9_gpu9&#45;&gt;send_l13_e9_gpu9 -->
<g id="edge982" class="edge">
<title>expert_l13_e9_gpu9&#45;&gt;send_l13_e9_gpu9</title>
<path fill="none" stroke="black" d="M7277.44,-3056.76C7277.44,-3048.51 7277.44,-3039.43 7277.44,-3030.38"/>
<polygon fill="black" stroke="black" points="7280.94,-3030.22 7277.44,-3020.22 7273.94,-3030.22 7280.94,-3030.22"/>
</g>
<!-- send_l13_e9_gpu9&#45;&gt;agg_l13 -->
<g id="edge983" class="edge">
<title>send_l13_e9_gpu9&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M7103.68,-2931.32C7046.84,-2918.37 6981.93,-2903.58 6918.39,-2889.1"/>
<polygon fill="black" stroke="black" points="6919.14,-2885.68 6908.61,-2886.87 6917.59,-2892.5 6919.14,-2885.68"/>
</g>
<!-- expert_l13_e10_gpu10 -->
<g id="node754" class="node">
<title>expert_l13_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="8168.44,-3125 7712.44,-3125 7712.44,-3057 8168.44,-3057 8168.44,-3125"/>
<text text-anchor="middle" x="7940.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E10</text>
<text text-anchor="middle" x="7940.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7940.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7940.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l13_e10_gpu10&#45;&gt;expert_l13_e10_gpu10 -->
<g id="edge985" class="edge">
<title>recv_l13_e10_gpu10&#45;&gt;expert_l13_e10_gpu10</title>
<path fill="none" stroke="black" d="M7940.44,-3161.8C7940.44,-3153.04 7940.44,-3143.94 7940.44,-3135.31"/>
<polygon fill="black" stroke="black" points="7943.94,-3135.08 7940.44,-3125.08 7936.94,-3135.08 7943.94,-3135.08"/>
</g>
<!-- send_l13_e10_gpu10 -->
<g id="node755" class="node">
<title>send_l13_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="7940.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7940.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E10</text>
<text text-anchor="middle" x="7940.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7940.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7940.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l13_e10_gpu10&#45;&gt;send_l13_e10_gpu10 -->
<g id="edge986" class="edge">
<title>expert_l13_e10_gpu10&#45;&gt;send_l13_e10_gpu10</title>
<path fill="none" stroke="black" d="M7940.44,-3056.76C7940.44,-3048.51 7940.44,-3039.43 7940.44,-3030.38"/>
<polygon fill="black" stroke="black" points="7943.94,-3030.22 7940.44,-3020.22 7936.94,-3030.22 7943.94,-3030.22"/>
</g>
<!-- send_l13_e10_gpu10&#45;&gt;agg_l13 -->
<g id="edge987" class="edge">
<title>send_l13_e10_gpu10&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M7713.78,-2937.64C7678.54,-2932.8 7642.53,-2928.03 7608.44,-2923.83 7432,-2902.1 7237.57,-2881.1 7067.81,-2863.73"/>
<polygon fill="black" stroke="black" points="7068,-2860.24 7057.69,-2862.7 7067.29,-2867.2 7068,-2860.24"/>
</g>
<!-- expert_l13_e11_gpu11 -->
<g id="node757" class="node">
<title>expert_l13_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8831.44,-3125 8375.44,-3125 8375.44,-3057 8831.44,-3057 8831.44,-3125"/>
<text text-anchor="middle" x="8603.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E11</text>
<text text-anchor="middle" x="8603.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8603.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8603.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l13_e11_gpu11&#45;&gt;expert_l13_e11_gpu11 -->
<g id="edge989" class="edge">
<title>recv_l13_e11_gpu11&#45;&gt;expert_l13_e11_gpu11</title>
<path fill="none" stroke="black" d="M8603.44,-3161.8C8603.44,-3153.04 8603.44,-3143.94 8603.44,-3135.31"/>
<polygon fill="black" stroke="black" points="8606.94,-3135.08 8603.44,-3125.08 8599.94,-3135.08 8606.94,-3135.08"/>
</g>
<!-- send_l13_e11_gpu11 -->
<g id="node758" class="node">
<title>send_l13_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8603.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8603.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E11</text>
<text text-anchor="middle" x="8603.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8603.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8603.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l13_e11_gpu11&#45;&gt;send_l13_e11_gpu11 -->
<g id="edge990" class="edge">
<title>expert_l13_e11_gpu11&#45;&gt;send_l13_e11_gpu11</title>
<path fill="none" stroke="black" d="M8603.44,-3056.76C8603.44,-3048.51 8603.44,-3039.43 8603.44,-3030.38"/>
<polygon fill="black" stroke="black" points="8606.94,-3030.22 8603.44,-3020.22 8599.94,-3030.22 8606.94,-3030.22"/>
</g>
<!-- send_l13_e11_gpu11&#45;&gt;agg_l13 -->
<g id="edge991" class="edge">
<title>send_l13_e11_gpu11&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M8381.85,-2936.98C8345.03,-2932.07 8307.21,-2927.45 8271.44,-2923.83 8140.75,-2910.6 8107.54,-2913.97 7976.44,-2905.83 7664.76,-2886.48 7312.98,-2864.26 7045.01,-2847.25"/>
<polygon fill="black" stroke="black" points="7044.92,-2843.74 7034.72,-2846.6 7044.47,-2850.73 7044.92,-2843.74"/>
</g>
<!-- expert_l13_e12_gpu12 -->
<g id="node760" class="node">
<title>expert_l13_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9494.44,-3125 9038.44,-3125 9038.44,-3057 9494.44,-3057 9494.44,-3125"/>
<text text-anchor="middle" x="9266.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E12</text>
<text text-anchor="middle" x="9266.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9266.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9266.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l13_e12_gpu12&#45;&gt;expert_l13_e12_gpu12 -->
<g id="edge993" class="edge">
<title>recv_l13_e12_gpu12&#45;&gt;expert_l13_e12_gpu12</title>
<path fill="none" stroke="black" d="M9266.44,-3161.8C9266.44,-3153.04 9266.44,-3143.94 9266.44,-3135.31"/>
<polygon fill="black" stroke="black" points="9269.94,-3135.08 9266.44,-3125.08 9262.94,-3135.08 9269.94,-3135.08"/>
</g>
<!-- send_l13_e12_gpu12 -->
<g id="node761" class="node">
<title>send_l13_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9266.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9266.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E12</text>
<text text-anchor="middle" x="9266.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9266.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9266.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l13_e12_gpu12&#45;&gt;send_l13_e12_gpu12 -->
<g id="edge994" class="edge">
<title>expert_l13_e12_gpu12&#45;&gt;send_l13_e12_gpu12</title>
<path fill="none" stroke="black" d="M9266.44,-3056.76C9266.44,-3048.51 9266.44,-3039.43 9266.44,-3030.38"/>
<polygon fill="black" stroke="black" points="9269.94,-3030.22 9266.44,-3020.22 9262.94,-3030.22 9269.94,-3030.22"/>
</g>
<!-- send_l13_e12_gpu12&#45;&gt;agg_l13 -->
<g id="edge995" class="edge">
<title>send_l13_e12_gpu12&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M9046.69,-2936.72C9009.3,-2931.77 8970.81,-2927.22 8934.44,-2923.83 8262.83,-2861.3 7478.23,-2836.08 7015.13,-2826.12"/>
<polygon fill="black" stroke="black" points="7015.01,-2822.61 7004.93,-2825.9 7014.86,-2829.61 7015.01,-2822.61"/>
</g>
<!-- expert_l13_e13_gpu13 -->
<g id="node763" class="node">
<title>expert_l13_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="10157.44,-3125 9701.44,-3125 9701.44,-3057 10157.44,-3057 10157.44,-3125"/>
<text text-anchor="middle" x="9929.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E13</text>
<text text-anchor="middle" x="9929.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9929.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9929.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l13_e13_gpu13&#45;&gt;expert_l13_e13_gpu13 -->
<g id="edge997" class="edge">
<title>recv_l13_e13_gpu13&#45;&gt;expert_l13_e13_gpu13</title>
<path fill="none" stroke="black" d="M9929.44,-3161.8C9929.44,-3153.04 9929.44,-3143.94 9929.44,-3135.31"/>
<polygon fill="black" stroke="black" points="9932.94,-3135.08 9929.44,-3125.08 9925.94,-3135.08 9932.94,-3135.08"/>
</g>
<!-- send_l13_e13_gpu13 -->
<g id="node764" class="node">
<title>send_l13_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="9929.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9929.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E13</text>
<text text-anchor="middle" x="9929.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9929.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9929.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l13_e13_gpu13&#45;&gt;send_l13_e13_gpu13 -->
<g id="edge998" class="edge">
<title>expert_l13_e13_gpu13&#45;&gt;send_l13_e13_gpu13</title>
<path fill="none" stroke="black" d="M9929.44,-3056.76C9929.44,-3048.51 9929.44,-3039.43 9929.44,-3030.38"/>
<polygon fill="black" stroke="black" points="9932.94,-3030.22 9929.44,-3020.22 9925.94,-3030.22 9932.94,-3030.22"/>
</g>
<!-- send_l13_e13_gpu13&#45;&gt;agg_l13 -->
<g id="edge999" class="edge">
<title>send_l13_e13_gpu13&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M9710.61,-2936.53C9672.94,-2931.57 9634.12,-2927.06 9597.44,-2923.83 8671.16,-2842.24 7577.8,-2823.93 7006.69,-2820.28"/>
<polygon fill="black" stroke="black" points="7006.67,-2816.78 6996.65,-2820.22 7006.63,-2823.78 7006.67,-2816.78"/>
</g>
<!-- expert_l13_e14_gpu14 -->
<g id="node766" class="node">
<title>expert_l13_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10820.44,-3125 10364.44,-3125 10364.44,-3057 10820.44,-3057 10820.44,-3125"/>
<text text-anchor="middle" x="10592.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E14</text>
<text text-anchor="middle" x="10592.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10592.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10592.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l13_e14_gpu14&#45;&gt;expert_l13_e14_gpu14 -->
<g id="edge1001" class="edge">
<title>recv_l13_e14_gpu14&#45;&gt;expert_l13_e14_gpu14</title>
<path fill="none" stroke="black" d="M10592.44,-3161.8C10592.44,-3153.04 10592.44,-3143.94 10592.44,-3135.31"/>
<polygon fill="black" stroke="black" points="10595.94,-3135.08 10592.44,-3125.08 10588.94,-3135.08 10595.94,-3135.08"/>
</g>
<!-- send_l13_e14_gpu14 -->
<g id="node767" class="node">
<title>send_l13_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10592.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10592.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E14</text>
<text text-anchor="middle" x="10592.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10592.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10592.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l13_e14_gpu14&#45;&gt;send_l13_e14_gpu14 -->
<g id="edge1002" class="edge">
<title>expert_l13_e14_gpu14&#45;&gt;send_l13_e14_gpu14</title>
<path fill="none" stroke="black" d="M10592.44,-3056.76C10592.44,-3048.51 10592.44,-3039.43 10592.44,-3030.38"/>
<polygon fill="black" stroke="black" points="10595.94,-3030.22 10592.44,-3020.22 10588.94,-3030.22 10595.94,-3030.22"/>
</g>
<!-- send_l13_e14_gpu14&#45;&gt;agg_l13 -->
<g id="edge1003" class="edge">
<title>send_l13_e14_gpu14&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M10374.52,-2936.45C10336.57,-2931.47 10297.42,-2926.97 10260.44,-2923.83 9640.73,-2871.22 7825.4,-2838.12 7014.14,-2825.56"/>
<polygon fill="black" stroke="black" points="7014.1,-2822.06 7004.05,-2825.4 7013.99,-2829.06 7014.1,-2822.06"/>
</g>
<!-- expert_l13_e15_gpu15 -->
<g id="node769" class="node">
<title>expert_l13_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11483.44,-3125 11027.44,-3125 11027.44,-3057 11483.44,-3057 11483.44,-3125"/>
<text text-anchor="middle" x="11255.44" y="-3109.8" font-family="Times,serif" font-size="14.00">Expert L13E15</text>
<text text-anchor="middle" x="11255.44" y="-3094.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11255.44" y="-3079.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11255.44" y="-3064.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l13_e15_gpu15&#45;&gt;expert_l13_e15_gpu15 -->
<g id="edge1005" class="edge">
<title>recv_l13_e15_gpu15&#45;&gt;expert_l13_e15_gpu15</title>
<path fill="none" stroke="black" d="M11255.44,-3161.8C11255.44,-3153.04 11255.44,-3143.94 11255.44,-3135.31"/>
<polygon fill="black" stroke="black" points="11258.94,-3135.08 11255.44,-3125.08 11251.94,-3135.08 11258.94,-3135.08"/>
</g>
<!-- send_l13_e15_gpu15 -->
<g id="node770" class="node">
<title>send_l13_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11255.44" cy="-2971.92" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11255.44" y="-2990.72" font-family="Times,serif" font-size="14.00">Token Send L13E15</text>
<text text-anchor="middle" x="11255.44" y="-2975.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11255.44" y="-2960.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11255.44" y="-2945.72" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l13_e15_gpu15&#45;&gt;send_l13_e15_gpu15 -->
<g id="edge1006" class="edge">
<title>expert_l13_e15_gpu15&#45;&gt;send_l13_e15_gpu15</title>
<path fill="none" stroke="black" d="M11255.44,-3056.76C11255.44,-3048.51 11255.44,-3039.43 11255.44,-3030.38"/>
<polygon fill="black" stroke="black" points="11258.94,-3030.22 11255.44,-3020.22 11251.94,-3030.22 11258.94,-3030.22"/>
</g>
<!-- send_l13_e15_gpu15&#45;&gt;agg_l13 -->
<g id="edge1007" class="edge">
<title>send_l13_e15_gpu15&#45;&gt;agg_l13</title>
<path fill="none" stroke="black" d="M11037.97,-2936.37C10999.89,-2931.38 10960.57,-2926.9 10923.44,-2923.83 10171.12,-2861.62 7928.18,-2832.87 7011.48,-2823.48"/>
<polygon fill="black" stroke="black" points="7011.46,-2819.98 7001.43,-2823.38 7011.39,-2826.98 7011.46,-2819.98"/>
</g>
<!-- residual2_l13 -->
<g id="node772" class="node">
<title>residual2_l13</title>
<polygon fill="lightpink" stroke="black" points="6879.94,-2713.83 6444.94,-2713.83 6444.94,-2645.83 6879.94,-2645.83 6879.94,-2713.83"/>
<text text-anchor="middle" x="6662.44" y="-2698.63" font-family="Times,serif" font-size="14.00">ResidualAdd L13</text>
<text text-anchor="middle" x="6662.44" y="-2683.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6662.44" y="-2668.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6662.44" y="-2653.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l13&#45;&gt;residual2_l13 -->
<g id="edge1008" class="edge">
<title>agg_l13&#45;&gt;residual2_l13</title>
<path fill="none" stroke="black" d="M6638.02,-2750.54C6641.22,-2741.39 6644.44,-2732.22 6647.43,-2723.67"/>
<polygon fill="black" stroke="black" points="6650.83,-2724.56 6650.83,-2713.96 6644.22,-2722.24 6650.83,-2724.56"/>
</g>
<!-- residual2_l13&#45;&gt;ln1_l14 -->
<g id="edge1009" class="edge">
<title>residual2_l13&#45;&gt;ln1_l14</title>
<path fill="none" stroke="black" d="M6671.45,-2645.68C6673.78,-2637.13 6676.31,-2627.81 6678.75,-2618.84"/>
<polygon fill="black" stroke="black" points="6682.2,-2619.5 6681.44,-2608.93 6675.44,-2617.66 6682.2,-2619.5"/>
</g>
<!-- attn_l14 -->
<g id="node774" class="node">
<title>attn_l14</title>
<polygon fill="lightcoral" stroke="black" points="6920.44,-2503.83 6460.44,-2503.83 6460.44,-2435.83 6920.44,-2435.83 6920.44,-2503.83"/>
<text text-anchor="middle" x="6690.44" y="-2488.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L14</text>
<text text-anchor="middle" x="6690.44" y="-2473.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6690.44" y="-2458.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2443.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l14&#45;&gt;attn_l14 -->
<g id="edge1012" class="edge">
<title>ln1_l14&#45;&gt;attn_l14</title>
<path fill="none" stroke="black" d="M6690.44,-2540.68C6690.44,-2532.22 6690.44,-2523.01 6690.44,-2514.13"/>
<polygon fill="black" stroke="black" points="6693.94,-2513.93 6690.44,-2503.93 6686.94,-2513.93 6693.94,-2513.93"/>
</g>
<!-- residual1_l14 -->
<g id="node775" class="node">
<title>residual1_l14</title>
<polygon fill="lightpink" stroke="black" points="6907.94,-2398.83 6472.94,-2398.83 6472.94,-2330.83 6907.94,-2330.83 6907.94,-2398.83"/>
<text text-anchor="middle" x="6690.44" y="-2383.63" font-family="Times,serif" font-size="14.00">ResidualAdd L14</text>
<text text-anchor="middle" x="6690.44" y="-2368.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2353.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2338.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l14&#45;&gt;residual1_l14 -->
<g id="edge1013" class="edge">
<title>attn_l14&#45;&gt;residual1_l14</title>
<path fill="none" stroke="black" d="M6690.44,-2435.68C6690.44,-2427.22 6690.44,-2418.01 6690.44,-2409.13"/>
<polygon fill="black" stroke="black" points="6693.94,-2408.93 6690.44,-2398.93 6686.94,-2408.93 6693.94,-2408.93"/>
</g>
<!-- ln2_l14 -->
<g id="node776" class="node">
<title>ln2_l14</title>
<polygon fill="lightyellow" stroke="black" points="6907.94,-2293.83 6472.94,-2293.83 6472.94,-2225.83 6907.94,-2225.83 6907.94,-2293.83"/>
<text text-anchor="middle" x="6690.44" y="-2278.63" font-family="Times,serif" font-size="14.00">LayerNorm L14</text>
<text text-anchor="middle" x="6690.44" y="-2263.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2248.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-2233.63" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l14&#45;&gt;ln2_l14 -->
<g id="edge1014" class="edge">
<title>residual1_l14&#45;&gt;ln2_l14</title>
<path fill="none" stroke="black" d="M6690.44,-2330.68C6690.44,-2322.22 6690.44,-2313.01 6690.44,-2304.13"/>
<polygon fill="black" stroke="black" points="6693.94,-2303.93 6690.44,-2293.93 6686.94,-2303.93 6693.94,-2303.93"/>
</g>
<!-- ln2_l14&#45;&gt;route_l14 -->
<g id="edge1015" class="edge">
<title>ln2_l14&#45;&gt;route_l14</title>
<path fill="none" stroke="black" d="M6690.44,-2225.67C6690.44,-2217.53 6690.44,-2208.47 6690.44,-2199.19"/>
<polygon fill="black" stroke="black" points="6693.94,-2199.07 6690.44,-2189.07 6686.94,-2199.07 6693.94,-2199.07"/>
</g>
<!-- recv_l14_e0_gpu0 -->
<g id="node778" class="node">
<title>recv_l14_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1386.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1386.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E0</text>
<text text-anchor="middle" x="1386.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1386.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1386.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e0_gpu0 -->
<g id="edge1016" class="edge">
<title>route_l14&#45;&gt;recv_l14_e0_gpu0</title>
<path fill="none" stroke="black" d="M6306.34,-2115.14C5564.72,-2105.41 3884,-2080.08 2470.44,-2034.83 2136.07,-2024.13 2051.56,-2032.69 1718.44,-2001.83 1685.33,-1998.77 1650.48,-1994.72 1616.29,-1990.3"/>
<polygon fill="black" stroke="black" points="1616.56,-1986.8 1606.19,-1988.97 1615.65,-1993.74 1616.56,-1986.8"/>
<text text-anchor="middle" x="2542.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l14_e1_gpu1 -->
<g id="node781" class="node">
<title>recv_l14_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="2049.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2049.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E1</text>
<text text-anchor="middle" x="2049.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2049.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2049.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e1_gpu1 -->
<g id="edge1020" class="edge">
<title>route_l14&#45;&gt;recv_l14_e1_gpu1</title>
<path fill="none" stroke="black" d="M6303.4,-2112.96C5651.9,-2100.85 4294.87,-2073.31 3147.44,-2034.83 2806.87,-2023.41 2720.76,-2033.13 2381.44,-2001.83 2348.33,-1998.78 2313.47,-1994.74 2279.29,-1990.32"/>
<polygon fill="black" stroke="black" points="2279.56,-1986.82 2269.19,-1989 2278.65,-1993.77 2279.56,-1986.82"/>
<text text-anchor="middle" x="3219.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l14_e2_gpu2 -->
<g id="node784" class="node">
<title>recv_l14_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2712.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2712.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E2</text>
<text text-anchor="middle" x="2712.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2712.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2712.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e2_gpu2 -->
<g id="edge1024" class="edge">
<title>route_l14&#45;&gt;recv_l14_e2_gpu2</title>
<path fill="none" stroke="black" d="M6299.09,-2109.96C5745.03,-2095.61 4700.24,-2067.13 3810.44,-2034.83 3469.9,-2022.47 3383.76,-2033.13 3044.44,-2001.83 3011.33,-1998.78 2976.47,-1994.74 2942.29,-1990.32"/>
<polygon fill="black" stroke="black" points="2942.56,-1986.82 2932.19,-1989 2941.65,-1993.77 2942.56,-1986.82"/>
<text text-anchor="middle" x="3882.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l14_e3_gpu3 -->
<g id="node787" class="node">
<title>recv_l14_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3375.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3375.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E3</text>
<text text-anchor="middle" x="3375.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3375.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3375.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e3_gpu3 -->
<g id="edge1028" class="edge">
<title>route_l14&#45;&gt;recv_l14_e3_gpu3</title>
<path fill="none" stroke="black" d="M6292.18,-2105.13C5848.4,-2088.62 5109.54,-2060.73 4473.44,-2034.83 4132.96,-2020.97 4046.76,-2033.13 3707.44,-2001.83 3674.33,-1998.78 3639.47,-1994.74 3605.29,-1990.32"/>
<polygon fill="black" stroke="black" points="3605.56,-1986.82 3595.19,-1989 3604.65,-1993.77 3605.56,-1986.82"/>
<text text-anchor="middle" x="4545.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l14_e4_gpu4 -->
<g id="node790" class="node">
<title>recv_l14_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="4038.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4038.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E4</text>
<text text-anchor="middle" x="4038.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4038.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4038.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e4_gpu4 -->
<g id="edge1032" class="edge">
<title>route_l14&#45;&gt;recv_l14_e4_gpu4</title>
<path fill="none" stroke="black" d="M6300.2,-2110.71C5838.53,-2097.43 5047.13,-2066.89 4370.44,-2001.83 4337.61,-1998.68 4303.05,-1994.61 4269.13,-1990.19"/>
<polygon fill="black" stroke="black" points="4269.48,-1986.71 4259.11,-1988.87 4268.57,-1993.65 4269.48,-1986.71"/>
<text text-anchor="middle" x="4821.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l14_e5_gpu5 -->
<g id="node793" class="node">
<title>recv_l14_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4701.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4701.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E5</text>
<text text-anchor="middle" x="4701.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4701.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4701.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e5_gpu5 -->
<g id="edge1036" class="edge">
<title>route_l14&#45;&gt;recv_l14_e5_gpu5</title>
<path fill="none" stroke="black" d="M6282.86,-2098.75C5947.03,-2079.48 5458.6,-2047.06 5033.44,-2001.83 5001.44,-1998.43 4967.78,-1994.3 4934.66,-1989.92"/>
<polygon fill="black" stroke="black" points="4934.78,-1986.4 4924.41,-1988.55 4933.86,-1993.34 4934.78,-1986.4"/>
<text text-anchor="middle" x="5422.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l14_e6_gpu6 -->
<g id="node796" class="node">
<title>recv_l14_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5364.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5364.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E6</text>
<text text-anchor="middle" x="5364.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5364.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5364.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e6_gpu6 -->
<g id="edge1040" class="edge">
<title>route_l14&#45;&gt;recv_l14_e6_gpu6</title>
<path fill="none" stroke="black" d="M6240.2,-2068.58C6069.75,-2048.6 5874.04,-2024.96 5696.44,-2001.83 5666.1,-1997.88 5634.22,-1993.57 5602.71,-1989.21"/>
<polygon fill="black" stroke="black" points="5602.89,-1985.7 5592.5,-1987.79 5601.93,-1992.63 5602.89,-1985.7"/>
<text text-anchor="middle" x="6014.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l14_e7_gpu7 -->
<g id="node799" class="node">
<title>recv_l14_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="6027.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6027.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E7</text>
<text text-anchor="middle" x="6027.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6027.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6027.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e7_gpu7 -->
<g id="edge1044" class="edge">
<title>route_l14&#45;&gt;recv_l14_e7_gpu7</title>
<path fill="none" stroke="black" d="M6421.25,-2052.81C6346.71,-2034.25 6267.82,-2014.6 6200.37,-1997.81"/>
<polygon fill="black" stroke="black" points="6201.06,-1994.37 6190.51,-1995.35 6199.37,-2001.17 6201.06,-1994.37"/>
<text text-anchor="middle" x="6411.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l14_e8_gpu8 -->
<g id="node802" class="node">
<title>recv_l14_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6690.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6690.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E8</text>
<text text-anchor="middle" x="6690.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e8_gpu8 -->
<g id="edge1048" class="edge">
<title>route_l14&#45;&gt;recv_l14_e8_gpu8</title>
<path fill="none" stroke="black" d="M6690.44,-2052.69C6690.44,-2039.3 6690.44,-2025.36 6690.44,-2012.33"/>
<polygon fill="black" stroke="black" points="6693.94,-2012.11 6690.44,-2002.11 6686.94,-2012.11 6693.94,-2012.11"/>
<text text-anchor="middle" x="6762.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l14_e9_gpu9 -->
<g id="node805" class="node">
<title>recv_l14_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7353.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7353.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E9</text>
<text text-anchor="middle" x="7353.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7353.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7353.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e9_gpu9 -->
<g id="edge1052" class="edge">
<title>route_l14&#45;&gt;recv_l14_e9_gpu9</title>
<path fill="none" stroke="black" d="M6959.63,-2052.81C7034.17,-2034.25 7113.06,-2014.6 7180.51,-1997.81"/>
<polygon fill="black" stroke="black" points="7181.51,-2001.17 7190.37,-1995.35 7179.82,-1994.37 7181.51,-2001.17"/>
<text text-anchor="middle" x="7153.44" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l14_e10_gpu10 -->
<g id="node808" class="node">
<title>recv_l14_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="8016.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8016.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E10</text>
<text text-anchor="middle" x="8016.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8016.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8016.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e10_gpu10 -->
<g id="edge1056" class="edge">
<title>route_l14&#45;&gt;recv_l14_e10_gpu10</title>
<path fill="none" stroke="black" d="M7013.27,-2083.39C7207.83,-2060.96 7460.53,-2031 7684.44,-2001.83 7714.78,-1997.88 7746.66,-1993.57 7778.17,-1989.21"/>
<polygon fill="black" stroke="black" points="7778.96,-1992.63 7788.38,-1987.79 7777.99,-1985.7 7778.96,-1992.63"/>
<text text-anchor="middle" x="7598.94" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l14_e11_gpu11 -->
<g id="node811" class="node">
<title>recv_l14_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8679.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8679.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E11</text>
<text text-anchor="middle" x="8679.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8679.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8679.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e11_gpu11 -->
<g id="edge1060" class="edge">
<title>route_l14&#45;&gt;recv_l14_e11_gpu11</title>
<path fill="none" stroke="black" d="M7039.79,-2102.05C7375.56,-2083.29 7897.01,-2049.75 8347.44,-2001.83 8379.44,-1998.43 8413.1,-1994.3 8446.22,-1989.92"/>
<polygon fill="black" stroke="black" points="8447.02,-1993.34 8456.47,-1988.55 8446.1,-1986.4 8447.02,-1993.34"/>
<text text-anchor="middle" x="8244.94" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l14_e12_gpu12 -->
<g id="node814" class="node">
<title>recv_l14_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9342.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9342.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E12</text>
<text text-anchor="middle" x="9342.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9342.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9342.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e12_gpu12 -->
<g id="edge1064" class="edge">
<title>route_l14&#45;&gt;recv_l14_e12_gpu12</title>
<path fill="none" stroke="black" d="M7053.35,-2111.48C7510.61,-2098.64 8320.2,-2068.19 9010.44,-2001.83 9043.27,-1998.68 9077.83,-1994.61 9111.75,-1990.19"/>
<polygon fill="black" stroke="black" points="9112.32,-1993.65 9121.77,-1988.87 9111.4,-1986.71 9112.32,-1993.65"/>
<text text-anchor="middle" x="8836.94" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l14_e13_gpu13 -->
<g id="node817" class="node">
<title>recv_l14_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="10005.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10005.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E13</text>
<text text-anchor="middle" x="10005.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10005.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10005.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e13_gpu13 -->
<g id="edge1068" class="edge">
<title>route_l14&#45;&gt;recv_l14_e13_gpu13</title>
<path fill="none" stroke="black" d="M7046.76,-2106.83C7486.49,-2090.65 8257.1,-2061.85 8917.44,-2034.83 9253.48,-2021.09 9338.55,-2032.81 9673.44,-2001.83 9706.55,-1998.77 9741.41,-1994.73 9775.59,-1990.3"/>
<polygon fill="black" stroke="black" points="9776.23,-1993.75 9785.69,-1988.98 9775.32,-1986.81 9776.23,-1993.75"/>
<text text-anchor="middle" x="9502.94" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l14_e14_gpu14 -->
<g id="node820" class="node">
<title>recv_l14_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10668.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10668.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E14</text>
<text text-anchor="middle" x="10668.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10668.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10668.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e14_gpu14 -->
<g id="edge1072" class="edge">
<title>route_l14&#45;&gt;recv_l14_e14_gpu14</title>
<path fill="none" stroke="black" d="M7052.16,-2110.88C7599.91,-2096.94 8672.53,-2068.17 9583.44,-2034.83 9750.82,-2028.71 10169.66,-2017.28 10336.44,-2001.83 10369.55,-1998.77 10404.41,-1994.73 10438.59,-1990.3"/>
<polygon fill="black" stroke="black" points="10439.23,-1993.74 10448.69,-1988.97 10438.32,-1986.8 10439.23,-1993.74"/>
<text text-anchor="middle" x="10071.94" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l14_e15_gpu15 -->
<g id="node823" class="node">
<title>recv_l14_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11331.44" cy="-1953.75" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11331.44" y="-1972.55" font-family="Times,serif" font-size="14.00">Token Receive L14E15</text>
<text text-anchor="middle" x="11331.44" y="-1957.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11331.44" y="-1942.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11331.44" y="-1927.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l14&#45;&gt;recv_l14_e15_gpu15 -->
<g id="edge1076" class="edge">
<title>route_l14&#45;&gt;recv_l14_e15_gpu15</title>
<path fill="none" stroke="black" d="M7054.66,-2112.61C7685.64,-2099.72 9022.9,-2070.7 10152.44,-2034.83 10528.98,-2022.88 10624.23,-2035.66 10999.44,-2001.83 11032.69,-1998.84 11067.7,-1994.82 11102.01,-1990.39"/>
<polygon fill="black" stroke="black" points="11102.69,-1993.83 11112.15,-1989.07 11101.78,-1986.89 11102.69,-1993.83"/>
<text text-anchor="middle" x="10829.94" y="-2023.63" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l14_e0_gpu0 -->
<g id="node779" class="node">
<title>expert_l14_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="1614.44,-1868.67 1158.44,-1868.67 1158.44,-1800.67 1614.44,-1800.67 1614.44,-1868.67"/>
<text text-anchor="middle" x="1386.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E0</text>
<text text-anchor="middle" x="1386.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1386.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1386.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l14_e0_gpu0&#45;&gt;expert_l14_e0_gpu0 -->
<g id="edge1017" class="edge">
<title>recv_l14_e0_gpu0&#45;&gt;expert_l14_e0_gpu0</title>
<path fill="none" stroke="black" d="M1386.44,-1905.46C1386.44,-1896.71 1386.44,-1887.61 1386.44,-1878.98"/>
<polygon fill="black" stroke="black" points="1389.94,-1878.75 1386.44,-1868.75 1382.94,-1878.75 1389.94,-1878.75"/>
</g>
<!-- send_l14_e0_gpu0 -->
<g id="node780" class="node">
<title>send_l14_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="1386.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="1386.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E0</text>
<text text-anchor="middle" x="1386.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1386.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="1386.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l14_e0_gpu0&#45;&gt;send_l14_e0_gpu0 -->
<g id="edge1018" class="edge">
<title>expert_l14_e0_gpu0&#45;&gt;send_l14_e0_gpu0</title>
<path fill="none" stroke="black" d="M1386.44,-1800.43C1386.44,-1792.18 1386.44,-1783.09 1386.44,-1774.04"/>
<polygon fill="black" stroke="black" points="1389.94,-1773.89 1386.44,-1763.89 1382.94,-1773.89 1389.94,-1773.89"/>
</g>
<!-- agg_l14 -->
<g id="node826" class="node">
<title>agg_l14</title>
<polygon fill="lightgray" stroke="black" points="7168.33,-1630.5 6408.12,-1630.5 6212.55,-1494.5 6972.76,-1494.5 7168.33,-1630.5"/>
<text text-anchor="middle" x="6690.44" y="-1581.3" font-family="Times,serif" font-size="14.00">Expert Aggregation L14</text>
<text text-anchor="middle" x="6690.44" y="-1566.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1551.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1536.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l14_e0_gpu0&#45;&gt;agg_l14 -->
<g id="edge1019" class="edge">
<title>send_l14_e0_gpu0&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M1603.45,-1680C1641.68,-1674.99 1681.16,-1670.52 1718.44,-1667.5 2606.88,-1595.47 5296.64,-1571.98 6304.01,-1565.58"/>
<polygon fill="black" stroke="black" points="6304.34,-1569.08 6314.32,-1565.52 6304.29,-1562.08 6304.34,-1569.08"/>
</g>
<!-- expert_l14_e1_gpu1 -->
<g id="node782" class="node">
<title>expert_l14_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="2277.44,-1868.67 1821.44,-1868.67 1821.44,-1800.67 2277.44,-1800.67 2277.44,-1868.67"/>
<text text-anchor="middle" x="2049.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E1</text>
<text text-anchor="middle" x="2049.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2049.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2049.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l14_e1_gpu1&#45;&gt;expert_l14_e1_gpu1 -->
<g id="edge1021" class="edge">
<title>recv_l14_e1_gpu1&#45;&gt;expert_l14_e1_gpu1</title>
<path fill="none" stroke="black" d="M2049.44,-1905.46C2049.44,-1896.71 2049.44,-1887.61 2049.44,-1878.98"/>
<polygon fill="black" stroke="black" points="2052.94,-1878.75 2049.44,-1868.75 2045.94,-1878.75 2052.94,-1878.75"/>
</g>
<!-- send_l14_e1_gpu1 -->
<g id="node783" class="node">
<title>send_l14_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="2049.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2049.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E1</text>
<text text-anchor="middle" x="2049.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2049.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2049.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l14_e1_gpu1&#45;&gt;send_l14_e1_gpu1 -->
<g id="edge1022" class="edge">
<title>expert_l14_e1_gpu1&#45;&gt;send_l14_e1_gpu1</title>
<path fill="none" stroke="black" d="M2049.44,-1800.43C2049.44,-1792.18 2049.44,-1783.09 2049.44,-1774.04"/>
<polygon fill="black" stroke="black" points="2052.94,-1773.89 2049.44,-1763.89 2045.94,-1773.89 2052.94,-1773.89"/>
</g>
<!-- send_l14_e1_gpu1&#45;&gt;agg_l14 -->
<g id="edge1023" class="edge">
<title>send_l14_e1_gpu1&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M2266.91,-1680.04C2304.99,-1675.05 2344.31,-1670.57 2381.44,-1667.5 3137.27,-1605 5397.64,-1576.27 6306.13,-1567.02"/>
<polygon fill="black" stroke="black" points="6306.46,-1570.52 6316.42,-1566.91 6306.39,-1563.52 6306.46,-1570.52"/>
</g>
<!-- expert_l14_e2_gpu2 -->
<g id="node785" class="node">
<title>expert_l14_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="2940.44,-1868.67 2484.44,-1868.67 2484.44,-1800.67 2940.44,-1800.67 2940.44,-1868.67"/>
<text text-anchor="middle" x="2712.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E2</text>
<text text-anchor="middle" x="2712.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2712.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2712.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l14_e2_gpu2&#45;&gt;expert_l14_e2_gpu2 -->
<g id="edge1025" class="edge">
<title>recv_l14_e2_gpu2&#45;&gt;expert_l14_e2_gpu2</title>
<path fill="none" stroke="black" d="M2712.44,-1905.46C2712.44,-1896.71 2712.44,-1887.61 2712.44,-1878.98"/>
<polygon fill="black" stroke="black" points="2715.94,-1878.75 2712.44,-1868.75 2708.94,-1878.75 2715.94,-1878.75"/>
</g>
<!-- send_l14_e2_gpu2 -->
<g id="node786" class="node">
<title>send_l14_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="2712.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="2712.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E2</text>
<text text-anchor="middle" x="2712.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2712.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="2712.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l14_e2_gpu2&#45;&gt;send_l14_e2_gpu2 -->
<g id="edge1026" class="edge">
<title>expert_l14_e2_gpu2&#45;&gt;send_l14_e2_gpu2</title>
<path fill="none" stroke="black" d="M2712.44,-1800.43C2712.44,-1792.18 2712.44,-1783.09 2712.44,-1774.04"/>
<polygon fill="black" stroke="black" points="2715.94,-1773.89 2712.44,-1763.89 2708.94,-1773.89 2715.94,-1773.89"/>
</g>
<!-- send_l14_e2_gpu2&#45;&gt;agg_l14 -->
<g id="edge1027" class="edge">
<title>send_l14_e2_gpu2&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M2930.36,-1680.12C2968.31,-1675.13 3007.46,-1670.64 3044.44,-1667.5 3668.79,-1614.49 5506.71,-1581.29 6308.78,-1568.95"/>
<polygon fill="black" stroke="black" points="6309.1,-1572.44 6319.05,-1568.79 6308.99,-1565.44 6309.1,-1572.44"/>
</g>
<!-- expert_l14_e3_gpu3 -->
<g id="node788" class="node">
<title>expert_l14_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="3603.44,-1868.67 3147.44,-1868.67 3147.44,-1800.67 3603.44,-1800.67 3603.44,-1868.67"/>
<text text-anchor="middle" x="3375.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E3</text>
<text text-anchor="middle" x="3375.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3375.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3375.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l14_e3_gpu3&#45;&gt;expert_l14_e3_gpu3 -->
<g id="edge1029" class="edge">
<title>recv_l14_e3_gpu3&#45;&gt;expert_l14_e3_gpu3</title>
<path fill="none" stroke="black" d="M3375.44,-1905.46C3375.44,-1896.71 3375.44,-1887.61 3375.44,-1878.98"/>
<polygon fill="black" stroke="black" points="3378.94,-1878.75 3375.44,-1868.75 3371.94,-1878.75 3378.94,-1878.75"/>
</g>
<!-- send_l14_e3_gpu3 -->
<g id="node789" class="node">
<title>send_l14_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="3375.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="3375.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E3</text>
<text text-anchor="middle" x="3375.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3375.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="3375.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l14_e3_gpu3&#45;&gt;send_l14_e3_gpu3 -->
<g id="edge1030" class="edge">
<title>expert_l14_e3_gpu3&#45;&gt;send_l14_e3_gpu3</title>
<path fill="none" stroke="black" d="M3375.44,-1800.43C3375.44,-1792.18 3375.44,-1783.09 3375.44,-1774.04"/>
<polygon fill="black" stroke="black" points="3378.94,-1773.89 3375.44,-1763.89 3371.94,-1773.89 3378.94,-1773.89"/>
</g>
<!-- send_l14_e3_gpu3&#45;&gt;agg_l14 -->
<g id="edge1031" class="edge">
<title>send_l14_e3_gpu3&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M3594.27,-1680.2C3631.94,-1675.24 3670.76,-1670.73 3707.44,-1667.5 4635.8,-1585.72 5732,-1567.52 6302.04,-1563.92"/>
<polygon fill="black" stroke="black" points="6302.08,-1567.42 6312.06,-1563.86 6302.04,-1560.42 6302.08,-1567.42"/>
</g>
<!-- expert_l14_e4_gpu4 -->
<g id="node791" class="node">
<title>expert_l14_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="4266.44,-1868.67 3810.44,-1868.67 3810.44,-1800.67 4266.44,-1800.67 4266.44,-1868.67"/>
<text text-anchor="middle" x="4038.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E4</text>
<text text-anchor="middle" x="4038.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4038.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4038.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l14_e4_gpu4&#45;&gt;expert_l14_e4_gpu4 -->
<g id="edge1033" class="edge">
<title>recv_l14_e4_gpu4&#45;&gt;expert_l14_e4_gpu4</title>
<path fill="none" stroke="black" d="M4038.44,-1905.46C4038.44,-1896.71 4038.44,-1887.61 4038.44,-1878.98"/>
<polygon fill="black" stroke="black" points="4041.94,-1878.75 4038.44,-1868.75 4034.94,-1878.75 4041.94,-1878.75"/>
</g>
<!-- send_l14_e4_gpu4 -->
<g id="node792" class="node">
<title>send_l14_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="4038.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4038.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E4</text>
<text text-anchor="middle" x="4038.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4038.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4038.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l14_e4_gpu4&#45;&gt;send_l14_e4_gpu4 -->
<g id="edge1034" class="edge">
<title>expert_l14_e4_gpu4&#45;&gt;send_l14_e4_gpu4</title>
<path fill="none" stroke="black" d="M4038.44,-1800.43C4038.44,-1792.18 4038.44,-1783.09 4038.44,-1774.04"/>
<polygon fill="black" stroke="black" points="4041.94,-1773.89 4038.44,-1763.89 4034.94,-1773.89 4041.94,-1773.89"/>
</g>
<!-- send_l14_e4_gpu4&#45;&gt;agg_l14 -->
<g id="edge1035" class="edge">
<title>send_l14_e4_gpu4&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M4258.2,-1680.39C4295.58,-1675.44 4334.07,-1670.89 4370.44,-1667.5 5051.76,-1604.07 5849.37,-1579.03 6309.64,-1569.36"/>
<polygon fill="black" stroke="black" points="6309.85,-1572.86 6319.77,-1569.15 6309.7,-1565.86 6309.85,-1572.86"/>
</g>
<!-- expert_l14_e5_gpu5 -->
<g id="node794" class="node">
<title>expert_l14_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="4929.44,-1868.67 4473.44,-1868.67 4473.44,-1800.67 4929.44,-1800.67 4929.44,-1868.67"/>
<text text-anchor="middle" x="4701.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E5</text>
<text text-anchor="middle" x="4701.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4701.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4701.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l14_e5_gpu5&#45;&gt;expert_l14_e5_gpu5 -->
<g id="edge1037" class="edge">
<title>recv_l14_e5_gpu5&#45;&gt;expert_l14_e5_gpu5</title>
<path fill="none" stroke="black" d="M4701.44,-1905.46C4701.44,-1896.71 4701.44,-1887.61 4701.44,-1878.98"/>
<polygon fill="black" stroke="black" points="4704.94,-1878.75 4701.44,-1868.75 4697.94,-1878.75 4704.94,-1878.75"/>
</g>
<!-- send_l14_e5_gpu5 -->
<g id="node795" class="node">
<title>send_l14_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="4701.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="4701.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E5</text>
<text text-anchor="middle" x="4701.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4701.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="4701.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l14_e5_gpu5&#45;&gt;send_l14_e5_gpu5 -->
<g id="edge1038" class="edge">
<title>expert_l14_e5_gpu5&#45;&gt;send_l14_e5_gpu5</title>
<path fill="none" stroke="black" d="M4701.44,-1800.43C4701.44,-1792.18 4701.44,-1783.09 4701.44,-1774.04"/>
<polygon fill="black" stroke="black" points="4704.94,-1773.89 4701.44,-1763.89 4697.94,-1773.89 4704.94,-1773.89"/>
</g>
<!-- send_l14_e5_gpu5&#45;&gt;agg_l14 -->
<g id="edge1039" class="edge">
<title>send_l14_e5_gpu5&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M4923.49,-1680.65C4960.16,-1675.74 4997.82,-1671.14 5033.44,-1667.5 5475.29,-1622.37 5985.57,-1593.89 6321.81,-1578.37"/>
<polygon fill="black" stroke="black" points="6322.38,-1581.84 6332.2,-1577.89 6322.05,-1574.85 6322.38,-1581.84"/>
</g>
<!-- expert_l14_e6_gpu6 -->
<g id="node797" class="node">
<title>expert_l14_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="5592.44,-1868.67 5136.44,-1868.67 5136.44,-1800.67 5592.44,-1800.67 5592.44,-1868.67"/>
<text text-anchor="middle" x="5364.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E6</text>
<text text-anchor="middle" x="5364.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5364.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5364.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l14_e6_gpu6&#45;&gt;expert_l14_e6_gpu6 -->
<g id="edge1041" class="edge">
<title>recv_l14_e6_gpu6&#45;&gt;expert_l14_e6_gpu6</title>
<path fill="none" stroke="black" d="M5364.44,-1905.46C5364.44,-1896.71 5364.44,-1887.61 5364.44,-1878.98"/>
<polygon fill="black" stroke="black" points="5367.94,-1878.75 5364.44,-1868.75 5360.94,-1878.75 5367.94,-1878.75"/>
</g>
<!-- send_l14_e6_gpu6 -->
<g id="node798" class="node">
<title>send_l14_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="5364.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="5364.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E6</text>
<text text-anchor="middle" x="5364.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5364.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="5364.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l14_e6_gpu6&#45;&gt;send_l14_e6_gpu6 -->
<g id="edge1042" class="edge">
<title>expert_l14_e6_gpu6&#45;&gt;send_l14_e6_gpu6</title>
<path fill="none" stroke="black" d="M5364.44,-1800.43C5364.44,-1792.18 5364.44,-1783.09 5364.44,-1774.04"/>
<polygon fill="black" stroke="black" points="5367.94,-1773.89 5364.44,-1763.89 5360.94,-1773.89 5367.94,-1773.89"/>
</g>
<!-- send_l14_e6_gpu6&#45;&gt;agg_l14 -->
<g id="edge1043" class="edge">
<title>send_l14_e6_gpu6&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M5591.1,-1681.31C5626.34,-1676.46 5662.35,-1671.7 5696.44,-1667.5 5912.57,-1640.88 6155.69,-1615.36 6347.39,-1596.27"/>
<polygon fill="black" stroke="black" points="6347.74,-1599.75 6357.34,-1595.28 6347.05,-1592.78 6347.74,-1599.75"/>
</g>
<!-- expert_l14_e7_gpu7 -->
<g id="node800" class="node">
<title>expert_l14_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="6255.44,-1868.67 5799.44,-1868.67 5799.44,-1800.67 6255.44,-1800.67 6255.44,-1868.67"/>
<text text-anchor="middle" x="6027.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E7</text>
<text text-anchor="middle" x="6027.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6027.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6027.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l14_e7_gpu7&#45;&gt;expert_l14_e7_gpu7 -->
<g id="edge1045" class="edge">
<title>recv_l14_e7_gpu7&#45;&gt;expert_l14_e7_gpu7</title>
<path fill="none" stroke="black" d="M6027.44,-1905.46C6027.44,-1896.71 6027.44,-1887.61 6027.44,-1878.98"/>
<polygon fill="black" stroke="black" points="6030.94,-1878.75 6027.44,-1868.75 6023.94,-1878.75 6030.94,-1878.75"/>
</g>
<!-- send_l14_e7_gpu7 -->
<g id="node801" class="node">
<title>send_l14_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="6027.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6027.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E7</text>
<text text-anchor="middle" x="6027.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6027.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6027.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l14_e7_gpu7&#45;&gt;send_l14_e7_gpu7 -->
<g id="edge1046" class="edge">
<title>expert_l14_e7_gpu7&#45;&gt;send_l14_e7_gpu7</title>
<path fill="none" stroke="black" d="M6027.44,-1800.43C6027.44,-1792.18 6027.44,-1783.09 6027.44,-1774.04"/>
<polygon fill="black" stroke="black" points="6030.94,-1773.89 6027.44,-1763.89 6023.94,-1773.89 6030.94,-1773.89"/>
</g>
<!-- send_l14_e7_gpu7&#45;&gt;agg_l14 -->
<g id="edge1047" class="edge">
<title>send_l14_e7_gpu7&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M6201.2,-1674.99C6260.63,-1661.44 6328.87,-1645.89 6395.16,-1630.79"/>
<polygon fill="black" stroke="black" points="6395.95,-1634.2 6404.92,-1628.56 6394.39,-1627.37 6395.95,-1634.2"/>
</g>
<!-- expert_l14_e8_gpu8 -->
<g id="node803" class="node">
<title>expert_l14_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="6918.44,-1868.67 6462.44,-1868.67 6462.44,-1800.67 6918.44,-1800.67 6918.44,-1868.67"/>
<text text-anchor="middle" x="6690.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E8</text>
<text text-anchor="middle" x="6690.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l14_e8_gpu8&#45;&gt;expert_l14_e8_gpu8 -->
<g id="edge1049" class="edge">
<title>recv_l14_e8_gpu8&#45;&gt;expert_l14_e8_gpu8</title>
<path fill="none" stroke="black" d="M6690.44,-1905.46C6690.44,-1896.71 6690.44,-1887.61 6690.44,-1878.98"/>
<polygon fill="black" stroke="black" points="6693.94,-1878.75 6690.44,-1868.75 6686.94,-1878.75 6693.94,-1878.75"/>
</g>
<!-- send_l14_e8_gpu8 -->
<g id="node804" class="node">
<title>send_l14_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="6690.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6690.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E8</text>
<text text-anchor="middle" x="6690.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6690.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l14_e8_gpu8&#45;&gt;send_l14_e8_gpu8 -->
<g id="edge1050" class="edge">
<title>expert_l14_e8_gpu8&#45;&gt;send_l14_e8_gpu8</title>
<path fill="none" stroke="black" d="M6690.44,-1800.43C6690.44,-1792.18 6690.44,-1783.09 6690.44,-1774.04"/>
<polygon fill="black" stroke="black" points="6693.94,-1773.89 6690.44,-1763.89 6686.94,-1773.89 6693.94,-1773.89"/>
</g>
<!-- send_l14_e8_gpu8&#45;&gt;agg_l14 -->
<g id="edge1051" class="edge">
<title>send_l14_e8_gpu8&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M6690.44,-1667.19C6690.44,-1658.77 6690.44,-1649.8 6690.44,-1640.79"/>
<polygon fill="black" stroke="black" points="6693.94,-1640.64 6690.44,-1630.64 6686.94,-1640.64 6693.94,-1640.64"/>
</g>
<!-- expert_l14_e9_gpu9 -->
<g id="node806" class="node">
<title>expert_l14_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="7581.44,-1868.67 7125.44,-1868.67 7125.44,-1800.67 7581.44,-1800.67 7581.44,-1868.67"/>
<text text-anchor="middle" x="7353.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E9</text>
<text text-anchor="middle" x="7353.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7353.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7353.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l14_e9_gpu9&#45;&gt;expert_l14_e9_gpu9 -->
<g id="edge1053" class="edge">
<title>recv_l14_e9_gpu9&#45;&gt;expert_l14_e9_gpu9</title>
<path fill="none" stroke="black" d="M7353.44,-1905.46C7353.44,-1896.71 7353.44,-1887.61 7353.44,-1878.98"/>
<polygon fill="black" stroke="black" points="7356.94,-1878.75 7353.44,-1868.75 7349.94,-1878.75 7356.94,-1878.75"/>
</g>
<!-- send_l14_e9_gpu9 -->
<g id="node807" class="node">
<title>send_l14_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="7353.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7353.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E9</text>
<text text-anchor="middle" x="7353.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7353.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7353.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l14_e9_gpu9&#45;&gt;send_l14_e9_gpu9 -->
<g id="edge1054" class="edge">
<title>expert_l14_e9_gpu9&#45;&gt;send_l14_e9_gpu9</title>
<path fill="none" stroke="black" d="M7353.44,-1800.43C7353.44,-1792.18 7353.44,-1783.09 7353.44,-1774.04"/>
<polygon fill="black" stroke="black" points="7356.94,-1773.89 7353.44,-1763.89 7349.94,-1773.89 7356.94,-1773.89"/>
</g>
<!-- send_l14_e9_gpu9&#45;&gt;agg_l14 -->
<g id="edge1055" class="edge">
<title>send_l14_e9_gpu9&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M7179.68,-1674.99C7122.84,-1662.03 7057.93,-1647.24 6994.39,-1632.76"/>
<polygon fill="black" stroke="black" points="6995.14,-1629.34 6984.61,-1630.54 6993.59,-1636.17 6995.14,-1629.34"/>
</g>
<!-- expert_l14_e10_gpu10 -->
<g id="node809" class="node">
<title>expert_l14_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="8244.44,-1868.67 7788.44,-1868.67 7788.44,-1800.67 8244.44,-1800.67 8244.44,-1868.67"/>
<text text-anchor="middle" x="8016.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E10</text>
<text text-anchor="middle" x="8016.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8016.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8016.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l14_e10_gpu10&#45;&gt;expert_l14_e10_gpu10 -->
<g id="edge1057" class="edge">
<title>recv_l14_e10_gpu10&#45;&gt;expert_l14_e10_gpu10</title>
<path fill="none" stroke="black" d="M8016.44,-1905.46C8016.44,-1896.71 8016.44,-1887.61 8016.44,-1878.98"/>
<polygon fill="black" stroke="black" points="8019.94,-1878.75 8016.44,-1868.75 8012.94,-1878.75 8019.94,-1878.75"/>
</g>
<!-- send_l14_e10_gpu10 -->
<g id="node810" class="node">
<title>send_l14_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="8016.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8016.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E10</text>
<text text-anchor="middle" x="8016.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8016.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8016.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l14_e10_gpu10&#45;&gt;send_l14_e10_gpu10 -->
<g id="edge1058" class="edge">
<title>expert_l14_e10_gpu10&#45;&gt;send_l14_e10_gpu10</title>
<path fill="none" stroke="black" d="M8016.44,-1800.43C8016.44,-1792.18 8016.44,-1783.09 8016.44,-1774.04"/>
<polygon fill="black" stroke="black" points="8019.94,-1773.89 8016.44,-1763.89 8012.94,-1773.89 8019.94,-1773.89"/>
</g>
<!-- send_l14_e10_gpu10&#45;&gt;agg_l14 -->
<g id="edge1059" class="edge">
<title>send_l14_e10_gpu10&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M7789.78,-1681.31C7754.54,-1676.46 7718.53,-1671.7 7684.44,-1667.5 7508,-1645.77 7313.57,-1624.77 7143.81,-1607.4"/>
<polygon fill="black" stroke="black" points="7144,-1603.9 7133.69,-1606.37 7143.29,-1610.87 7144,-1603.9"/>
</g>
<!-- expert_l14_e11_gpu11 -->
<g id="node812" class="node">
<title>expert_l14_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="8907.44,-1868.67 8451.44,-1868.67 8451.44,-1800.67 8907.44,-1800.67 8907.44,-1868.67"/>
<text text-anchor="middle" x="8679.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E11</text>
<text text-anchor="middle" x="8679.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8679.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8679.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l14_e11_gpu11&#45;&gt;expert_l14_e11_gpu11 -->
<g id="edge1061" class="edge">
<title>recv_l14_e11_gpu11&#45;&gt;expert_l14_e11_gpu11</title>
<path fill="none" stroke="black" d="M8679.44,-1905.46C8679.44,-1896.71 8679.44,-1887.61 8679.44,-1878.98"/>
<polygon fill="black" stroke="black" points="8682.94,-1878.75 8679.44,-1868.75 8675.94,-1878.75 8682.94,-1878.75"/>
</g>
<!-- send_l14_e11_gpu11 -->
<g id="node813" class="node">
<title>send_l14_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="8679.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8679.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E11</text>
<text text-anchor="middle" x="8679.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8679.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8679.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l14_e11_gpu11&#45;&gt;send_l14_e11_gpu11 -->
<g id="edge1062" class="edge">
<title>expert_l14_e11_gpu11&#45;&gt;send_l14_e11_gpu11</title>
<path fill="none" stroke="black" d="M8679.44,-1800.43C8679.44,-1792.18 8679.44,-1783.09 8679.44,-1774.04"/>
<polygon fill="black" stroke="black" points="8682.94,-1773.89 8679.44,-1763.89 8675.94,-1773.89 8682.94,-1773.89"/>
</g>
<!-- send_l14_e11_gpu11&#45;&gt;agg_l14 -->
<g id="edge1063" class="edge">
<title>send_l14_e11_gpu11&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M8457.4,-1680.65C8420.72,-1675.74 8383.06,-1671.14 8347.44,-1667.5 7925.81,-1624.44 7441.87,-1596.53 7106.31,-1580.58"/>
<polygon fill="black" stroke="black" points="7106.08,-1577.07 7095.92,-1580.09 7105.75,-1584.06 7106.08,-1577.07"/>
</g>
<!-- expert_l14_e12_gpu12 -->
<g id="node815" class="node">
<title>expert_l14_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="9570.44,-1868.67 9114.44,-1868.67 9114.44,-1800.67 9570.44,-1800.67 9570.44,-1868.67"/>
<text text-anchor="middle" x="9342.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E12</text>
<text text-anchor="middle" x="9342.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9342.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9342.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l14_e12_gpu12&#45;&gt;expert_l14_e12_gpu12 -->
<g id="edge1065" class="edge">
<title>recv_l14_e12_gpu12&#45;&gt;expert_l14_e12_gpu12</title>
<path fill="none" stroke="black" d="M9342.44,-1905.46C9342.44,-1896.71 9342.44,-1887.61 9342.44,-1878.98"/>
<polygon fill="black" stroke="black" points="9345.94,-1878.75 9342.44,-1868.75 9338.94,-1878.75 9345.94,-1878.75"/>
</g>
<!-- send_l14_e12_gpu12 -->
<g id="node816" class="node">
<title>send_l14_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="9342.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9342.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E12</text>
<text text-anchor="middle" x="9342.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9342.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9342.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l14_e12_gpu12&#45;&gt;send_l14_e12_gpu12 -->
<g id="edge1066" class="edge">
<title>expert_l14_e12_gpu12&#45;&gt;send_l14_e12_gpu12</title>
<path fill="none" stroke="black" d="M9342.44,-1800.43C9342.44,-1792.18 9342.44,-1783.09 9342.44,-1774.04"/>
<polygon fill="black" stroke="black" points="9345.94,-1773.89 9342.44,-1763.89 9338.94,-1773.89 9345.94,-1773.89"/>
</g>
<!-- send_l14_e12_gpu12&#45;&gt;agg_l14 -->
<g id="edge1067" class="edge">
<title>send_l14_e12_gpu12&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M9122.69,-1680.39C9085.3,-1675.44 9046.81,-1670.89 9010.44,-1667.5 8338.83,-1604.97 7554.23,-1579.75 7091.13,-1569.78"/>
<polygon fill="black" stroke="black" points="7091.01,-1566.28 7080.93,-1569.57 7090.86,-1573.28 7091.01,-1566.28"/>
</g>
<!-- expert_l14_e13_gpu13 -->
<g id="node818" class="node">
<title>expert_l14_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="10233.44,-1868.67 9777.44,-1868.67 9777.44,-1800.67 10233.44,-1800.67 10233.44,-1868.67"/>
<text text-anchor="middle" x="10005.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E13</text>
<text text-anchor="middle" x="10005.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10005.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10005.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l14_e13_gpu13&#45;&gt;expert_l14_e13_gpu13 -->
<g id="edge1069" class="edge">
<title>recv_l14_e13_gpu13&#45;&gt;expert_l14_e13_gpu13</title>
<path fill="none" stroke="black" d="M10005.44,-1905.46C10005.44,-1896.71 10005.44,-1887.61 10005.44,-1878.98"/>
<polygon fill="black" stroke="black" points="10008.94,-1878.75 10005.44,-1868.75 10001.94,-1878.75 10008.94,-1878.75"/>
</g>
<!-- send_l14_e13_gpu13 -->
<g id="node819" class="node">
<title>send_l14_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="10005.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10005.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E13</text>
<text text-anchor="middle" x="10005.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10005.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10005.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l14_e13_gpu13&#45;&gt;send_l14_e13_gpu13 -->
<g id="edge1070" class="edge">
<title>expert_l14_e13_gpu13&#45;&gt;send_l14_e13_gpu13</title>
<path fill="none" stroke="black" d="M10005.44,-1800.43C10005.44,-1792.18 10005.44,-1783.09 10005.44,-1774.04"/>
<polygon fill="black" stroke="black" points="10008.94,-1773.89 10005.44,-1763.89 10001.94,-1773.89 10008.94,-1773.89"/>
</g>
<!-- send_l14_e13_gpu13&#45;&gt;agg_l14 -->
<g id="edge1071" class="edge">
<title>send_l14_e13_gpu13&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M9786.61,-1680.2C9748.94,-1675.24 9710.12,-1670.73 9673.44,-1667.5 8747.16,-1585.9 7653.8,-1567.6 7082.69,-1563.95"/>
<polygon fill="black" stroke="black" points="7082.67,-1560.45 7072.65,-1563.88 7082.63,-1567.45 7082.67,-1560.45"/>
</g>
<!-- expert_l14_e14_gpu14 -->
<g id="node821" class="node">
<title>expert_l14_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="10896.44,-1868.67 10440.44,-1868.67 10440.44,-1800.67 10896.44,-1800.67 10896.44,-1868.67"/>
<text text-anchor="middle" x="10668.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E14</text>
<text text-anchor="middle" x="10668.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10668.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10668.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l14_e14_gpu14&#45;&gt;expert_l14_e14_gpu14 -->
<g id="edge1073" class="edge">
<title>recv_l14_e14_gpu14&#45;&gt;expert_l14_e14_gpu14</title>
<path fill="none" stroke="black" d="M10668.44,-1905.46C10668.44,-1896.71 10668.44,-1887.61 10668.44,-1878.98"/>
<polygon fill="black" stroke="black" points="10671.94,-1878.75 10668.44,-1868.75 10664.94,-1878.75 10671.94,-1878.75"/>
</g>
<!-- send_l14_e14_gpu14 -->
<g id="node822" class="node">
<title>send_l14_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="10668.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10668.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E14</text>
<text text-anchor="middle" x="10668.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10668.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10668.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l14_e14_gpu14&#45;&gt;send_l14_e14_gpu14 -->
<g id="edge1074" class="edge">
<title>expert_l14_e14_gpu14&#45;&gt;send_l14_e14_gpu14</title>
<path fill="none" stroke="black" d="M10668.44,-1800.43C10668.44,-1792.18 10668.44,-1783.09 10668.44,-1774.04"/>
<polygon fill="black" stroke="black" points="10671.94,-1773.89 10668.44,-1763.89 10664.94,-1773.89 10671.94,-1773.89"/>
</g>
<!-- send_l14_e14_gpu14&#45;&gt;agg_l14 -->
<g id="edge1075" class="edge">
<title>send_l14_e14_gpu14&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M10450.52,-1680.12C10412.57,-1675.13 10373.42,-1670.64 10336.44,-1667.5 9716.73,-1614.89 7901.4,-1581.78 7090.14,-1569.23"/>
<polygon fill="black" stroke="black" points="7090.1,-1565.72 7080.05,-1569.07 7089.99,-1572.72 7090.1,-1565.72"/>
</g>
<!-- expert_l14_e15_gpu15 -->
<g id="node824" class="node">
<title>expert_l14_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="11559.44,-1868.67 11103.44,-1868.67 11103.44,-1800.67 11559.44,-1800.67 11559.44,-1868.67"/>
<text text-anchor="middle" x="11331.44" y="-1853.47" font-family="Times,serif" font-size="14.00">Expert L14E15</text>
<text text-anchor="middle" x="11331.44" y="-1838.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11331.44" y="-1823.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11331.44" y="-1808.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l14_e15_gpu15&#45;&gt;expert_l14_e15_gpu15 -->
<g id="edge1077" class="edge">
<title>recv_l14_e15_gpu15&#45;&gt;expert_l14_e15_gpu15</title>
<path fill="none" stroke="black" d="M11331.44,-1905.46C11331.44,-1896.71 11331.44,-1887.61 11331.44,-1878.98"/>
<polygon fill="black" stroke="black" points="11334.94,-1878.75 11331.44,-1868.75 11327.94,-1878.75 11334.94,-1878.75"/>
</g>
<!-- send_l14_e15_gpu15 -->
<g id="node825" class="node">
<title>send_l14_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="11331.44" cy="-1715.58" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11331.44" y="-1734.38" font-family="Times,serif" font-size="14.00">Token Send L14E15</text>
<text text-anchor="middle" x="11331.44" y="-1719.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11331.44" y="-1704.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11331.44" y="-1689.38" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l14_e15_gpu15&#45;&gt;send_l14_e15_gpu15 -->
<g id="edge1078" class="edge">
<title>expert_l14_e15_gpu15&#45;&gt;send_l14_e15_gpu15</title>
<path fill="none" stroke="black" d="M11331.44,-1800.43C11331.44,-1792.18 11331.44,-1783.09 11331.44,-1774.04"/>
<polygon fill="black" stroke="black" points="11334.94,-1773.89 11331.44,-1763.89 11327.94,-1773.89 11334.94,-1773.89"/>
</g>
<!-- send_l14_e15_gpu15&#45;&gt;agg_l14 -->
<g id="edge1079" class="edge">
<title>send_l14_e15_gpu15&#45;&gt;agg_l14</title>
<path fill="none" stroke="black" d="M11113.97,-1680.04C11075.89,-1675.05 11036.57,-1670.57 10999.44,-1667.5 10247.12,-1605.29 8004.18,-1576.54 7087.48,-1567.15"/>
<polygon fill="black" stroke="black" points="7087.46,-1563.65 7077.43,-1567.05 7087.39,-1570.65 7087.46,-1563.65"/>
</g>
<!-- residual2_l14 -->
<g id="node827" class="node">
<title>residual2_l14</title>
<polygon fill="lightpink" stroke="black" points="10467.94,-1457.5 10032.94,-1457.5 10032.94,-1389.5 10467.94,-1389.5 10467.94,-1457.5"/>
<text text-anchor="middle" x="10250.44" y="-1442.3" font-family="Times,serif" font-size="14.00">ResidualAdd L14</text>
<text text-anchor="middle" x="10250.44" y="-1427.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="10250.44" y="-1412.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="10250.44" y="-1397.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l14&#45;&gt;residual2_l14 -->
<g id="edge1080" class="edge">
<title>agg_l14&#45;&gt;residual2_l14</title>
<path fill="none" stroke="black" d="M7049.32,-1547.69C7779.51,-1519.59 9419.83,-1456.46 10022.62,-1433.27"/>
<polygon fill="black" stroke="black" points="10022.87,-1436.76 10032.73,-1432.88 10022.6,-1429.77 10022.87,-1436.76"/>
</g>
<!-- residual2_l14&#45;&gt;ln1_l15 -->
<g id="edge1081" class="edge">
<title>residual2_l14&#45;&gt;ln1_l15</title>
<path fill="none" stroke="black" d="M10467.99,-1404C10684.14,-1385.61 11014.24,-1357.54 11233.84,-1338.86"/>
<polygon fill="black" stroke="black" points="11234.22,-1342.34 11243.89,-1338 11233.63,-1335.36 11234.22,-1342.34"/>
</g>
<!-- attn_l15 -->
<g id="node829" class="node">
<title>attn_l15</title>
<polygon fill="lightcoral" stroke="black" points="11691.44,-1247.5 11231.44,-1247.5 11231.44,-1179.5 11691.44,-1179.5 11691.44,-1247.5"/>
<text text-anchor="middle" x="11461.44" y="-1232.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention L15</text>
<text text-anchor="middle" x="11461.44" y="-1217.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11461.44" y="-1202.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11461.44" y="-1187.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_l15&#45;&gt;attn_l15 -->
<g id="edge1084" class="edge">
<title>ln1_l15&#45;&gt;attn_l15</title>
<path fill="none" stroke="black" d="M11461.44,-1284.34C11461.44,-1275.89 11461.44,-1266.68 11461.44,-1257.8"/>
<polygon fill="black" stroke="black" points="11464.94,-1257.59 11461.44,-1247.59 11457.94,-1257.59 11464.94,-1257.59"/>
</g>
<!-- residual1_l15 -->
<g id="node830" class="node">
<title>residual1_l15</title>
<polygon fill="lightpink" stroke="black" points="11687.94,-1142.5 11252.94,-1142.5 11252.94,-1074.5 11687.94,-1074.5 11687.94,-1142.5"/>
<text text-anchor="middle" x="11470.44" y="-1127.3" font-family="Times,serif" font-size="14.00">ResidualAdd L15</text>
<text text-anchor="middle" x="11470.44" y="-1112.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11470.44" y="-1097.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11470.44" y="-1082.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn_l15&#45;&gt;residual1_l15 -->
<g id="edge1085" class="edge">
<title>attn_l15&#45;&gt;residual1_l15</title>
<path fill="none" stroke="black" d="M11464.34,-1179.34C11465.08,-1170.89 11465.88,-1161.68 11466.66,-1152.8"/>
<polygon fill="black" stroke="black" points="11470.17,-1152.86 11467.55,-1142.59 11463.19,-1152.25 11470.17,-1152.86"/>
</g>
<!-- ln2_l15 -->
<g id="node831" class="node">
<title>ln2_l15</title>
<polygon fill="lightyellow" stroke="black" points="11690.94,-1037.5 11255.94,-1037.5 11255.94,-969.5 11690.94,-969.5 11690.94,-1037.5"/>
<text text-anchor="middle" x="11473.44" y="-1022.3" font-family="Times,serif" font-size="14.00">LayerNorm L15</text>
<text text-anchor="middle" x="11473.44" y="-1007.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11473.44" y="-992.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11473.44" y="-977.3" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1_l15&#45;&gt;ln2_l15 -->
<g id="edge1086" class="edge">
<title>residual1_l15&#45;&gt;ln2_l15</title>
<path fill="none" stroke="black" d="M11471.41,-1074.34C11471.65,-1065.89 11471.92,-1056.68 11472.18,-1047.8"/>
<polygon fill="black" stroke="black" points="11475.68,-1047.69 11472.48,-1037.59 11468.69,-1047.49 11475.68,-1047.69"/>
</g>
<!-- ln2_l15&#45;&gt;route_l15 -->
<g id="edge1087" class="edge">
<title>ln2_l15&#45;&gt;route_l15</title>
<path fill="none" stroke="black" d="M11503.22,-969.34C11511.23,-960.41 11520.22,-950.39 11529.39,-940.18"/>
<polygon fill="black" stroke="black" points="11532,-942.51 11536.08,-932.73 11526.79,-937.84 11532,-942.51"/>
</g>
<!-- recv_l15_e0_gpu0 -->
<g id="node833" class="node">
<title>recv_l15_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="6624.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6624.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E0</text>
<text text-anchor="middle" x="6624.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6624.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6624.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e0_gpu0 -->
<g id="edge1088" class="edge">
<title>route_l15&#45;&gt;recv_l15_e0_gpu0</title>
<path fill="none" stroke="black" d="M11210.72,-857.77C10513.5,-846.81 8997.06,-820.19 7718.44,-778.5 7379.64,-767.45 7293.99,-776.67 6956.44,-745.5 6923.33,-742.44 6888.47,-738.41 6854.29,-733.98"/>
<polygon fill="black" stroke="black" points="6854.56,-730.48 6844.19,-732.66 6853.65,-737.43 6854.56,-730.48"/>
<text text-anchor="middle" x="7790.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_0</text>
</g>
<!-- recv_l15_e1_gpu1 -->
<g id="node836" class="node">
<title>recv_l15_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="7287.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7287.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E1</text>
<text text-anchor="middle" x="7287.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7287.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7287.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e1_gpu1 -->
<g id="edge1092" class="edge">
<title>route_l15&#45;&gt;recv_l15_e1_gpu1</title>
<path fill="none" stroke="black" d="M11207.54,-855.42C10601.75,-842.35 9396.09,-814.36 8373.44,-778.5 8038.21,-766.74 7953.44,-776.42 7619.44,-745.5 7586.33,-742.43 7551.48,-738.39 7517.29,-733.97"/>
<polygon fill="black" stroke="black" points="7517.56,-730.47 7507.19,-732.64 7516.65,-737.41 7517.56,-730.47"/>
<text text-anchor="middle" x="8445.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_1</text>
</g>
<!-- recv_l15_e2_gpu2 -->
<g id="node839" class="node">
<title>recv_l15_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="7950.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7950.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E2</text>
<text text-anchor="middle" x="7950.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7950.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7950.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e2_gpu2 -->
<g id="edge1096" class="edge">
<title>route_l15&#45;&gt;recv_l15_e2_gpu2</title>
<path fill="none" stroke="black" d="M11202.66,-852.05C10695.97,-836.97 9788.51,-808.8 9012.44,-778.5 8687.91,-765.83 8605.81,-775.67 8282.44,-745.5 8249.47,-742.42 8214.76,-738.39 8180.71,-733.98"/>
<polygon fill="black" stroke="black" points="8181.01,-730.49 8170.64,-732.66 8180.1,-737.43 8181.01,-730.49"/>
<text text-anchor="middle" x="9084.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_2</text>
</g>
<!-- recv_l15_e3_gpu3 -->
<g id="node842" class="node">
<title>recv_l15_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="8613.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8613.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E3</text>
<text text-anchor="middle" x="8613.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8613.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8613.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e3_gpu3 -->
<g id="edge1100" class="edge">
<title>route_l15&#45;&gt;recv_l15_e3_gpu3</title>
<path fill="none" stroke="black" d="M11211.22,-858.06C10694.6,-848.09 9749.18,-820.46 8945.44,-745.5 8912.47,-742.42 8877.76,-738.39 8843.71,-733.98"/>
<polygon fill="black" stroke="black" points="8844.01,-730.49 8833.64,-732.66 8843.1,-737.43 8844.01,-730.49"/>
<text text-anchor="middle" x="9377.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_3</text>
</g>
<!-- recv_l15_e4_gpu4 -->
<g id="node845" class="node">
<title>recv_l15_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="9276.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9276.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E4</text>
<text text-anchor="middle" x="9276.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9276.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9276.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e4_gpu4 -->
<g id="edge1104" class="edge">
<title>route_l15&#45;&gt;recv_l15_e4_gpu4</title>
<path fill="none" stroke="black" d="M11199.17,-849.46C10797.32,-833.02 10158.65,-800.75 9608.44,-745.5 9575.89,-742.23 9541.62,-738.13 9507.97,-733.71"/>
<polygon fill="black" stroke="black" points="9508.4,-730.24 9498.03,-732.4 9507.48,-737.18 9508.4,-730.24"/>
<text text-anchor="middle" x="10005.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_4</text>
</g>
<!-- recv_l15_e5_gpu5 -->
<g id="node848" class="node">
<title>recv_l15_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="9939.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9939.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E5</text>
<text text-anchor="middle" x="9939.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9939.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9939.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e5_gpu5 -->
<g id="edge1108" class="edge">
<title>route_l15&#45;&gt;recv_l15_e5_gpu5</title>
<path fill="none" stroke="black" d="M11173.31,-831.46C10912.87,-810.34 10572.42,-780.22 10271.44,-745.5 10239.99,-741.87 10206.93,-737.66 10174.35,-733.28"/>
<polygon fill="black" stroke="black" points="10174.64,-729.79 10164.26,-731.91 10173.7,-736.72 10174.64,-729.79"/>
<text text-anchor="middle" x="10632.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_5</text>
</g>
<!-- recv_l15_e6_gpu6 -->
<g id="node851" class="node">
<title>recv_l15_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="10602.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10602.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E6</text>
<text text-anchor="middle" x="10602.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10602.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10602.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e6_gpu6 -->
<g id="edge1112" class="edge">
<title>route_l15&#45;&gt;recv_l15_e6_gpu6</title>
<path fill="none" stroke="black" d="M11192.86,-796.47C11067.17,-775.6 10933.21,-753.35 10824.72,-735.33"/>
<polygon fill="black" stroke="black" points="10825.07,-731.84 10814.63,-733.66 10823.92,-738.75 10825.07,-731.84"/>
<text text-anchor="middle" x="11141.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_6</text>
</g>
<!-- recv_l15_e7_gpu7 -->
<g id="node854" class="node">
<title>recv_l15_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="11265.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11265.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E7</text>
<text text-anchor="middle" x="11265.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11265.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11265.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e7_gpu7 -->
<g id="edge1116" class="edge">
<title>route_l15&#45;&gt;recv_l15_e7_gpu7</title>
<path fill="none" stroke="black" d="M11461.81,-796.35C11429.69,-780.34 11395.97,-763.52 11365.71,-748.42"/>
<polygon fill="black" stroke="black" points="11366.95,-745.13 11356.44,-743.8 11363.82,-751.39 11366.95,-745.13"/>
<text text-anchor="middle" x="11492.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_7</text>
</g>
<!-- recv_l15_e8_gpu8 -->
<g id="node857" class="node">
<title>recv_l15_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="11928.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11928.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E8</text>
<text text-anchor="middle" x="11928.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11928.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11928.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e8_gpu8 -->
<g id="edge1120" class="edge">
<title>route_l15&#45;&gt;recv_l15_e8_gpu8</title>
<path fill="none" stroke="black" d="M11731.48,-796.35C11763.69,-780.34 11797.52,-763.52 11827.87,-748.42"/>
<polygon fill="black" stroke="black" points="11829.78,-751.39 11837.17,-743.8 11826.66,-745.12 11829.78,-751.39"/>
<text text-anchor="middle" x="11863.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_8</text>
</g>
<!-- recv_l15_e9_gpu9 -->
<g id="node860" class="node">
<title>recv_l15_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="12591.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="12591.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E9</text>
<text text-anchor="middle" x="12591.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="12591.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="12591.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e9_gpu9 -->
<g id="edge1124" class="edge">
<title>route_l15&#45;&gt;recv_l15_e9_gpu9</title>
<path fill="none" stroke="black" d="M11899.7,-813.18C12050.98,-788.09 12230.69,-758.27 12369.02,-735.32"/>
<polygon fill="black" stroke="black" points="12369.61,-738.77 12378.9,-733.68 12368.46,-731.86 12369.61,-738.77"/>
<text text-anchor="middle" x="12254.44" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_9</text>
</g>
<!-- recv_l15_e10_gpu10 -->
<g id="node863" class="node">
<title>recv_l15_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="13254.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="13254.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E10</text>
<text text-anchor="middle" x="13254.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13254.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13254.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e10_gpu10 -->
<g id="edge1128" class="edge">
<title>route_l15&#45;&gt;recv_l15_e10_gpu10</title>
<path fill="none" stroke="black" d="M11935.18,-838.25C12203.41,-817.07 12587.37,-784.14 12922.44,-745.5 12953.89,-741.87 12986.95,-737.66 13019.53,-733.28"/>
<polygon fill="black" stroke="black" points="13020.18,-736.72 13029.62,-731.92 13019.25,-729.79 13020.18,-736.72"/>
<text text-anchor="middle" x="12818.94" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_10</text>
</g>
<!-- recv_l15_e11_gpu11 -->
<g id="node866" class="node">
<title>recv_l15_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="13917.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="13917.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E11</text>
<text text-anchor="middle" x="13917.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13917.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13917.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e11_gpu11 -->
<g id="edge1132" class="edge">
<title>route_l15&#45;&gt;recv_l15_e11_gpu11</title>
<path fill="none" stroke="black" d="M11953.29,-851.11C12351.91,-835.23 13016.02,-802.67 13585.44,-745.5 13618,-742.23 13652.26,-738.13 13685.91,-733.72"/>
<polygon fill="black" stroke="black" points="13686.4,-737.18 13695.85,-732.4 13685.48,-730.24 13686.4,-737.18"/>
<text text-anchor="middle" x="13445.94" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_11</text>
</g>
<!-- recv_l15_e12_gpu12 -->
<g id="node869" class="node">
<title>recv_l15_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="14580.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="14580.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E12</text>
<text text-anchor="middle" x="14580.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="14580.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="14580.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e12_gpu12 -->
<g id="edge1136" class="edge">
<title>route_l15&#45;&gt;recv_l15_e12_gpu12</title>
<path fill="none" stroke="black" d="M11963.74,-858.48C12476.35,-848.89 13434.95,-821.6 14248.44,-745.5 14281.41,-742.42 14316.12,-738.38 14350.17,-733.96"/>
<polygon fill="black" stroke="black" points="14350.78,-737.41 14360.24,-732.64 14349.87,-730.47 14350.78,-737.41"/>
<text text-anchor="middle" x="14109.94" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_12</text>
</g>
<!-- recv_l15_e13_gpu13 -->
<g id="node872" class="node">
<title>recv_l15_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="15243.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="15243.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E13</text>
<text text-anchor="middle" x="15243.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15243.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15243.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e13_gpu13 -->
<g id="edge1140" class="edge">
<title>route_l15&#45;&gt;recv_l15_e13_gpu13</title>
<path fill="none" stroke="black" d="M11956.32,-853.18C12457.22,-838.49 13392.95,-809.81 14190.44,-778.5 14510.97,-765.91 14592.06,-775.39 14911.44,-745.5 14944.41,-742.41 14979.12,-738.38 15013.17,-733.96"/>
<polygon fill="black" stroke="black" points="15013.78,-737.41 15023.24,-732.64 15012.87,-730.47 15013.78,-737.41"/>
<text text-anchor="middle" x="14737.94" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_13</text>
</g>
<!-- recv_l15_e14_gpu14 -->
<g id="node875" class="node">
<title>recv_l15_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="15906.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="15906.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E14</text>
<text text-anchor="middle" x="15906.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15906.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15906.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e14_gpu14 -->
<g id="edge1144" class="edge">
<title>route_l15&#45;&gt;recv_l15_e14_gpu14</title>
<path fill="none" stroke="black" d="M11960.41,-855.94C12557.4,-843.09 13781.95,-814.79 14818.44,-778.5 15154.55,-766.73 15239.55,-776.48 15574.44,-745.5 15607.55,-742.44 15642.41,-738.4 15676.59,-733.97"/>
<polygon fill="black" stroke="black" points="15677.23,-737.42 15686.69,-732.65 15676.32,-730.47 15677.23,-737.42"/>
<text text-anchor="middle" x="15402.94" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_14</text>
</g>
<!-- recv_l15_e15_gpu15 -->
<g id="node878" class="node">
<title>recv_l15_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="16569.44" cy="-697.42" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="16569.44" y="-716.22" font-family="Times,serif" font-size="14.00">Token Receive L15E15</text>
<text text-anchor="middle" x="16569.44" y="-701.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="16569.44" y="-686.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="16569.44" y="-671.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_l15&#45;&gt;recv_l15_e15_gpu15 -->
<g id="edge1148" class="edge">
<title>route_l15&#45;&gt;recv_l15_e15_gpu15</title>
<path fill="none" stroke="black" d="M11963.28,-858.15C12652.87,-847.5 14189.64,-820.95 15483.44,-778.5 15818.69,-767.5 15903.44,-776.42 16237.44,-745.5 16270.55,-742.43 16305.41,-738.39 16339.59,-733.97"/>
<polygon fill="black" stroke="black" points="16340.23,-737.41 16349.69,-732.64 16339.32,-730.47 16340.23,-737.41"/>
<text text-anchor="middle" x="16066.94" y="-767.3" font-family="Times,serif" font-size="14.00">tokens_for_expert_15</text>
</g>
<!-- expert_l15_e0_gpu0 -->
<g id="node834" class="node">
<title>expert_l15_e0_gpu0</title>
<polygon fill="lightsalmon" stroke="black" points="6852.44,-612.33 6396.44,-612.33 6396.44,-544.33 6852.44,-544.33 6852.44,-612.33"/>
<text text-anchor="middle" x="6624.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E0</text>
<text text-anchor="middle" x="6624.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6624.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6624.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- recv_l15_e0_gpu0&#45;&gt;expert_l15_e0_gpu0 -->
<g id="edge1089" class="edge">
<title>recv_l15_e0_gpu0&#45;&gt;expert_l15_e0_gpu0</title>
<path fill="none" stroke="black" d="M6624.44,-649.13C6624.44,-640.38 6624.44,-631.28 6624.44,-622.65"/>
<polygon fill="black" stroke="black" points="6627.94,-622.41 6624.44,-612.41 6620.94,-622.41 6627.94,-622.41"/>
</g>
<!-- send_l15_e0_gpu0 -->
<g id="node835" class="node">
<title>send_l15_e0_gpu0</title>
<ellipse fill="lightgreen" stroke="black" cx="6624.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="6624.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E0</text>
<text text-anchor="middle" x="6624.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6624.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="6624.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_l15_e0_gpu0&#45;&gt;send_l15_e0_gpu0 -->
<g id="edge1090" class="edge">
<title>expert_l15_e0_gpu0&#45;&gt;send_l15_e0_gpu0</title>
<path fill="none" stroke="black" d="M6624.44,-544.09C6624.44,-535.84 6624.44,-526.76 6624.44,-517.71"/>
<polygon fill="black" stroke="black" points="6627.94,-517.56 6624.44,-507.56 6620.94,-517.56 6627.94,-517.56"/>
</g>
<!-- agg_l15 -->
<g id="node881" class="node">
<title>agg_l15</title>
<polygon fill="lightgray" stroke="black" points="11914.33,-374.17 11154.12,-374.17 10958.55,-238.17 11718.76,-238.17 11914.33,-374.17"/>
<text text-anchor="middle" x="11436.44" y="-324.97" font-family="Times,serif" font-size="14.00">Expert Aggregation L15</text>
<text text-anchor="middle" x="11436.44" y="-309.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, k=2, d_model=4096]</text>
<text text-anchor="middle" x="11436.44" y="-294.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11436.44" y="-279.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- send_l15_e0_gpu0&#45;&gt;agg_l15 -->
<g id="edge1091" class="edge">
<title>send_l15_e0_gpu0&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M6841.9,-423.68C6879.99,-418.69 6919.31,-414.22 6956.44,-411.17 7746.35,-346.21 10116.78,-318.77 11051.48,-310.28"/>
<polygon fill="black" stroke="black" points="11051.76,-313.78 11061.73,-310.18 11051.69,-306.78 11051.76,-313.78"/>
</g>
<!-- expert_l15_e1_gpu1 -->
<g id="node837" class="node">
<title>expert_l15_e1_gpu1</title>
<polygon fill="lightsalmon" stroke="black" points="7515.44,-612.33 7059.44,-612.33 7059.44,-544.33 7515.44,-544.33 7515.44,-612.33"/>
<text text-anchor="middle" x="7287.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E1</text>
<text text-anchor="middle" x="7287.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7287.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7287.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- recv_l15_e1_gpu1&#45;&gt;expert_l15_e1_gpu1 -->
<g id="edge1093" class="edge">
<title>recv_l15_e1_gpu1&#45;&gt;expert_l15_e1_gpu1</title>
<path fill="none" stroke="black" d="M7287.44,-649.13C7287.44,-640.38 7287.44,-631.28 7287.44,-622.65"/>
<polygon fill="black" stroke="black" points="7290.94,-622.41 7287.44,-612.41 7283.94,-622.41 7290.94,-622.41"/>
</g>
<!-- send_l15_e1_gpu1 -->
<g id="node838" class="node">
<title>send_l15_e1_gpu1</title>
<ellipse fill="lightgreen" stroke="black" cx="7287.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7287.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E1</text>
<text text-anchor="middle" x="7287.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7287.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7287.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_l15_e1_gpu1&#45;&gt;send_l15_e1_gpu1 -->
<g id="edge1094" class="edge">
<title>expert_l15_e1_gpu1&#45;&gt;send_l15_e1_gpu1</title>
<path fill="none" stroke="black" d="M7287.44,-544.09C7287.44,-535.84 7287.44,-526.76 7287.44,-517.71"/>
<polygon fill="black" stroke="black" points="7290.94,-517.56 7287.44,-507.56 7283.94,-517.56 7290.94,-517.56"/>
</g>
<!-- send_l15_e1_gpu1&#45;&gt;agg_l15 -->
<g id="edge1095" class="edge">
<title>send_l15_e1_gpu1&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M7505.36,-423.74C7543.31,-418.77 7582.46,-414.28 7619.44,-411.17 8277.67,-355.71 10224.22,-323.57 11054.37,-312.05"/>
<polygon fill="black" stroke="black" points="11054.44,-315.55 11064.39,-311.91 11054.34,-308.55 11054.44,-315.55"/>
</g>
<!-- expert_l15_e2_gpu2 -->
<g id="node840" class="node">
<title>expert_l15_e2_gpu2</title>
<polygon fill="lightsalmon" stroke="black" points="8178.44,-612.33 7722.44,-612.33 7722.44,-544.33 8178.44,-544.33 8178.44,-612.33"/>
<text text-anchor="middle" x="7950.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E2</text>
<text text-anchor="middle" x="7950.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7950.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7950.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- recv_l15_e2_gpu2&#45;&gt;expert_l15_e2_gpu2 -->
<g id="edge1097" class="edge">
<title>recv_l15_e2_gpu2&#45;&gt;expert_l15_e2_gpu2</title>
<path fill="none" stroke="black" d="M7950.44,-649.13C7950.44,-640.38 7950.44,-631.28 7950.44,-622.65"/>
<polygon fill="black" stroke="black" points="7953.94,-622.41 7950.44,-612.41 7946.94,-622.41 7953.94,-622.41"/>
</g>
<!-- send_l15_e2_gpu2 -->
<g id="node841" class="node">
<title>send_l15_e2_gpu2</title>
<ellipse fill="lightgreen" stroke="black" cx="7950.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="7950.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E2</text>
<text text-anchor="middle" x="7950.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7950.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="7950.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_l15_e2_gpu2&#45;&gt;send_l15_e2_gpu2 -->
<g id="edge1098" class="edge">
<title>expert_l15_e2_gpu2&#45;&gt;send_l15_e2_gpu2</title>
<path fill="none" stroke="black" d="M7950.44,-544.09C7950.44,-535.84 7950.44,-526.76 7950.44,-517.71"/>
<polygon fill="black" stroke="black" points="7953.94,-517.56 7950.44,-507.56 7946.94,-517.56 7953.94,-517.56"/>
</g>
<!-- send_l15_e2_gpu2&#45;&gt;agg_l15 -->
<g id="edge1099" class="edge">
<title>send_l15_e2_gpu2&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M8168.82,-423.86C8206.63,-418.89 8245.61,-414.38 8282.44,-411.17 9275.47,-324.63 10450.1,-308.57 11046.61,-306.52"/>
<polygon fill="black" stroke="black" points="11046.67,-310.02 11056.66,-306.48 11046.65,-303.02 11046.67,-310.02"/>
</g>
<!-- expert_l15_e3_gpu3 -->
<g id="node843" class="node">
<title>expert_l15_e3_gpu3</title>
<polygon fill="lightsalmon" stroke="black" points="8841.44,-612.33 8385.44,-612.33 8385.44,-544.33 8841.44,-544.33 8841.44,-612.33"/>
<text text-anchor="middle" x="8613.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E3</text>
<text text-anchor="middle" x="8613.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8613.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8613.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- recv_l15_e3_gpu3&#45;&gt;expert_l15_e3_gpu3 -->
<g id="edge1101" class="edge">
<title>recv_l15_e3_gpu3&#45;&gt;expert_l15_e3_gpu3</title>
<path fill="none" stroke="black" d="M8613.44,-649.13C8613.44,-640.38 8613.44,-631.28 8613.44,-622.65"/>
<polygon fill="black" stroke="black" points="8616.94,-622.41 8613.44,-612.41 8609.94,-622.41 8616.94,-622.41"/>
</g>
<!-- send_l15_e3_gpu3 -->
<g id="node844" class="node">
<title>send_l15_e3_gpu3</title>
<ellipse fill="lightgreen" stroke="black" cx="8613.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="8613.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E3</text>
<text text-anchor="middle" x="8613.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8613.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="8613.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_l15_e3_gpu3&#45;&gt;send_l15_e3_gpu3 -->
<g id="edge1102" class="edge">
<title>expert_l15_e3_gpu3&#45;&gt;send_l15_e3_gpu3</title>
<path fill="none" stroke="black" d="M8613.44,-544.09C8613.44,-535.84 8613.44,-526.76 8613.44,-517.71"/>
<polygon fill="black" stroke="black" points="8616.94,-517.56 8613.44,-507.56 8609.94,-517.56 8616.94,-517.56"/>
</g>
<!-- send_l15_e3_gpu3&#45;&gt;agg_l15 -->
<g id="edge1103" class="edge">
<title>send_l15_e3_gpu3&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M8833.19,-423.96C8870.57,-419.02 8909.06,-414.5 8945.44,-411.17 9689.92,-343 10563.71,-319.48 11053.45,-311.38"/>
<polygon fill="black" stroke="black" points="11053.56,-314.88 11063.5,-311.22 11053.45,-307.88 11053.56,-314.88"/>
</g>
<!-- expert_l15_e4_gpu4 -->
<g id="node846" class="node">
<title>expert_l15_e4_gpu4</title>
<polygon fill="lightsalmon" stroke="black" points="9504.44,-612.33 9048.44,-612.33 9048.44,-544.33 9504.44,-544.33 9504.44,-612.33"/>
<text text-anchor="middle" x="9276.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E4</text>
<text text-anchor="middle" x="9276.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9276.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9276.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- recv_l15_e4_gpu4&#45;&gt;expert_l15_e4_gpu4 -->
<g id="edge1105" class="edge">
<title>recv_l15_e4_gpu4&#45;&gt;expert_l15_e4_gpu4</title>
<path fill="none" stroke="black" d="M9276.44,-649.13C9276.44,-640.38 9276.44,-631.28 9276.44,-622.65"/>
<polygon fill="black" stroke="black" points="9279.94,-622.41 9276.44,-612.41 9272.94,-622.41 9279.94,-622.41"/>
</g>
<!-- send_l15_e4_gpu4 -->
<g id="node847" class="node">
<title>send_l15_e4_gpu4</title>
<ellipse fill="lightgreen" stroke="black" cx="9276.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9276.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E4</text>
<text text-anchor="middle" x="9276.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9276.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9276.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_l15_e4_gpu4&#45;&gt;send_l15_e4_gpu4 -->
<g id="edge1106" class="edge">
<title>expert_l15_e4_gpu4&#45;&gt;send_l15_e4_gpu4</title>
<path fill="none" stroke="black" d="M9276.44,-544.09C9276.44,-535.84 9276.44,-526.76 9276.44,-517.71"/>
<polygon fill="black" stroke="black" points="9279.94,-517.56 9276.44,-507.56 9272.94,-517.56 9279.94,-517.56"/>
</g>
<!-- send_l15_e4_gpu4&#45;&gt;agg_l15 -->
<g id="edge1107" class="edge">
<title>send_l15_e4_gpu4&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M9497.57,-424.25C9534.53,-419.33 9572.52,-414.73 9608.44,-411.17 10111.16,-361.31 10694.21,-333.27 11064.1,-319.18"/>
<polygon fill="black" stroke="black" points="11064.3,-322.68 11074.16,-318.8 11064.04,-315.68 11064.3,-322.68"/>
</g>
<!-- expert_l15_e5_gpu5 -->
<g id="node849" class="node">
<title>expert_l15_e5_gpu5</title>
<polygon fill="lightsalmon" stroke="black" points="10167.44,-612.33 9711.44,-612.33 9711.44,-544.33 10167.44,-544.33 10167.44,-612.33"/>
<text text-anchor="middle" x="9939.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E5</text>
<text text-anchor="middle" x="9939.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9939.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9939.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- recv_l15_e5_gpu5&#45;&gt;expert_l15_e5_gpu5 -->
<g id="edge1109" class="edge">
<title>recv_l15_e5_gpu5&#45;&gt;expert_l15_e5_gpu5</title>
<path fill="none" stroke="black" d="M9939.44,-649.13C9939.44,-640.38 9939.44,-631.28 9939.44,-622.65"/>
<polygon fill="black" stroke="black" points="9942.94,-622.41 9939.44,-612.41 9935.94,-622.41 9942.94,-622.41"/>
</g>
<!-- send_l15_e5_gpu5 -->
<g id="node850" class="node">
<title>send_l15_e5_gpu5</title>
<ellipse fill="lightgreen" stroke="black" cx="9939.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="9939.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E5</text>
<text text-anchor="middle" x="9939.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9939.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="9939.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_l15_e5_gpu5&#45;&gt;send_l15_e5_gpu5 -->
<g id="edge1110" class="edge">
<title>expert_l15_e5_gpu5&#45;&gt;send_l15_e5_gpu5</title>
<path fill="none" stroke="black" d="M9939.44,-544.09C9939.44,-535.84 9939.44,-526.76 9939.44,-517.71"/>
<polygon fill="black" stroke="black" points="9942.94,-517.56 9939.44,-507.56 9935.94,-517.56 9942.94,-517.56"/>
</g>
<!-- send_l15_e5_gpu5&#45;&gt;agg_l15 -->
<g id="edge1111" class="edge">
<title>send_l15_e5_gpu5&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M10164.26,-424.76C10200.07,-419.89 10236.74,-415.17 10271.44,-411.17 10543.87,-379.71 10853.1,-352.5 11084.47,-333.81"/>
<polygon fill="black" stroke="black" points="11085.05,-337.27 11094.74,-332.98 11084.49,-330.3 11085.05,-337.27"/>
</g>
<!-- expert_l15_e6_gpu6 -->
<g id="node852" class="node">
<title>expert_l15_e6_gpu6</title>
<polygon fill="lightsalmon" stroke="black" points="10830.44,-612.33 10374.44,-612.33 10374.44,-544.33 10830.44,-544.33 10830.44,-612.33"/>
<text text-anchor="middle" x="10602.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E6</text>
<text text-anchor="middle" x="10602.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10602.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10602.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- recv_l15_e6_gpu6&#45;&gt;expert_l15_e6_gpu6 -->
<g id="edge1113" class="edge">
<title>recv_l15_e6_gpu6&#45;&gt;expert_l15_e6_gpu6</title>
<path fill="none" stroke="black" d="M10602.44,-649.13C10602.44,-640.38 10602.44,-631.28 10602.44,-622.65"/>
<polygon fill="black" stroke="black" points="10605.94,-622.41 10602.44,-612.41 10598.94,-622.41 10605.94,-622.41"/>
</g>
<!-- send_l15_e6_gpu6 -->
<g id="node853" class="node">
<title>send_l15_e6_gpu6</title>
<ellipse fill="lightgreen" stroke="black" cx="10602.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="10602.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E6</text>
<text text-anchor="middle" x="10602.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10602.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="10602.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_l15_e6_gpu6&#45;&gt;send_l15_e6_gpu6 -->
<g id="edge1114" class="edge">
<title>expert_l15_e6_gpu6&#45;&gt;send_l15_e6_gpu6</title>
<path fill="none" stroke="black" d="M10602.44,-544.09C10602.44,-535.84 10602.44,-526.76 10602.44,-517.71"/>
<polygon fill="black" stroke="black" points="10605.94,-517.56 10602.44,-507.56 10598.94,-517.56 10605.94,-517.56"/>
</g>
<!-- send_l15_e6_gpu6&#45;&gt;agg_l15 -->
<g id="edge1115" class="edge">
<title>send_l15_e6_gpu6&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M10804.06,-421.72C10900.59,-404.24 11018.35,-382.91 11125.96,-363.41"/>
<polygon fill="black" stroke="black" points="11126.79,-366.82 11136.01,-361.59 11125.55,-359.93 11126.79,-366.82"/>
</g>
<!-- expert_l15_e7_gpu7 -->
<g id="node855" class="node">
<title>expert_l15_e7_gpu7</title>
<polygon fill="lightsalmon" stroke="black" points="11493.44,-612.33 11037.44,-612.33 11037.44,-544.33 11493.44,-544.33 11493.44,-612.33"/>
<text text-anchor="middle" x="11265.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E7</text>
<text text-anchor="middle" x="11265.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11265.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11265.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- recv_l15_e7_gpu7&#45;&gt;expert_l15_e7_gpu7 -->
<g id="edge1117" class="edge">
<title>recv_l15_e7_gpu7&#45;&gt;expert_l15_e7_gpu7</title>
<path fill="none" stroke="black" d="M11265.44,-649.13C11265.44,-640.38 11265.44,-631.28 11265.44,-622.65"/>
<polygon fill="black" stroke="black" points="11268.94,-622.41 11265.44,-612.41 11261.94,-622.41 11268.94,-622.41"/>
</g>
<!-- send_l15_e7_gpu7 -->
<g id="node856" class="node">
<title>send_l15_e7_gpu7</title>
<ellipse fill="lightgreen" stroke="black" cx="11265.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11265.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E7</text>
<text text-anchor="middle" x="11265.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11265.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11265.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_l15_e7_gpu7&#45;&gt;send_l15_e7_gpu7 -->
<g id="edge1118" class="edge">
<title>expert_l15_e7_gpu7&#45;&gt;send_l15_e7_gpu7</title>
<path fill="none" stroke="black" d="M11265.44,-544.09C11265.44,-535.84 11265.44,-526.76 11265.44,-517.71"/>
<polygon fill="black" stroke="black" points="11268.94,-517.56 11265.44,-507.56 11261.94,-517.56 11268.94,-517.56"/>
</g>
<!-- send_l15_e7_gpu7&#45;&gt;agg_l15 -->
<g id="edge1119" class="edge">
<title>send_l15_e7_gpu7&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M11318.14,-411.69C11329.09,-402.01 11340.88,-391.59 11352.63,-381.21"/>
<polygon fill="black" stroke="black" points="11355.16,-383.65 11360.34,-374.4 11350.53,-378.4 11355.16,-383.65"/>
</g>
<!-- expert_l15_e8_gpu8 -->
<g id="node858" class="node">
<title>expert_l15_e8_gpu8</title>
<polygon fill="lightsalmon" stroke="black" points="12156.44,-612.33 11700.44,-612.33 11700.44,-544.33 12156.44,-544.33 12156.44,-612.33"/>
<text text-anchor="middle" x="11928.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E8</text>
<text text-anchor="middle" x="11928.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11928.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11928.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- recv_l15_e8_gpu8&#45;&gt;expert_l15_e8_gpu8 -->
<g id="edge1121" class="edge">
<title>recv_l15_e8_gpu8&#45;&gt;expert_l15_e8_gpu8</title>
<path fill="none" stroke="black" d="M11928.44,-649.13C11928.44,-640.38 11928.44,-631.28 11928.44,-622.65"/>
<polygon fill="black" stroke="black" points="11931.94,-622.41 11928.44,-612.41 11924.94,-622.41 11931.94,-622.41"/>
</g>
<!-- send_l15_e8_gpu8 -->
<g id="node859" class="node">
<title>send_l15_e8_gpu8</title>
<ellipse fill="lightgreen" stroke="black" cx="11928.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="11928.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E8</text>
<text text-anchor="middle" x="11928.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11928.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="11928.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_l15_e8_gpu8&#45;&gt;send_l15_e8_gpu8 -->
<g id="edge1122" class="edge">
<title>expert_l15_e8_gpu8&#45;&gt;send_l15_e8_gpu8</title>
<path fill="none" stroke="black" d="M11928.44,-544.09C11928.44,-535.84 11928.44,-526.76 11928.44,-517.71"/>
<polygon fill="black" stroke="black" points="11931.94,-517.56 11928.44,-507.56 11924.94,-517.56 11931.94,-517.56"/>
</g>
<!-- send_l15_e8_gpu8&#45;&gt;agg_l15 -->
<g id="edge1123" class="edge">
<title>send_l15_e8_gpu8&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M11790.08,-415.76C11750.97,-403.75 11707.35,-390.36 11664.45,-377.18"/>
<polygon fill="black" stroke="black" points="11665.32,-373.79 11654.73,-374.2 11663.27,-380.48 11665.32,-373.79"/>
</g>
<!-- expert_l15_e9_gpu9 -->
<g id="node861" class="node">
<title>expert_l15_e9_gpu9</title>
<polygon fill="lightsalmon" stroke="black" points="12819.44,-612.33 12363.44,-612.33 12363.44,-544.33 12819.44,-544.33 12819.44,-612.33"/>
<text text-anchor="middle" x="12591.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E9</text>
<text text-anchor="middle" x="12591.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="12591.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="12591.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- recv_l15_e9_gpu9&#45;&gt;expert_l15_e9_gpu9 -->
<g id="edge1125" class="edge">
<title>recv_l15_e9_gpu9&#45;&gt;expert_l15_e9_gpu9</title>
<path fill="none" stroke="black" d="M12591.44,-649.13C12591.44,-640.38 12591.44,-631.28 12591.44,-622.65"/>
<polygon fill="black" stroke="black" points="12594.94,-622.41 12591.44,-612.41 12587.94,-622.41 12594.94,-622.41"/>
</g>
<!-- send_l15_e9_gpu9 -->
<g id="node862" class="node">
<title>send_l15_e9_gpu9</title>
<ellipse fill="lightgreen" stroke="black" cx="12591.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="12591.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E9</text>
<text text-anchor="middle" x="12591.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="12591.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="12591.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_l15_e9_gpu9&#45;&gt;send_l15_e9_gpu9 -->
<g id="edge1126" class="edge">
<title>expert_l15_e9_gpu9&#45;&gt;send_l15_e9_gpu9</title>
<path fill="none" stroke="black" d="M12591.44,-544.09C12591.44,-535.84 12591.44,-526.76 12591.44,-517.71"/>
<polygon fill="black" stroke="black" points="12594.94,-517.56 12591.44,-507.56 12587.94,-517.56 12594.94,-517.56"/>
</g>
<!-- send_l15_e9_gpu9&#45;&gt;agg_l15 -->
<g id="edge1127" class="edge">
<title>send_l15_e9_gpu9&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M12362.45,-425.31C12327.94,-420.48 12292.76,-415.63 12259.44,-411.17 12146.57,-396.03 12024.92,-380.33 11910.66,-365.84"/>
<polygon fill="black" stroke="black" points="11911.05,-362.37 11900.69,-364.58 11910.17,-369.31 11911.05,-362.37"/>
</g>
<!-- expert_l15_e10_gpu10 -->
<g id="node864" class="node">
<title>expert_l15_e10_gpu10</title>
<polygon fill="lightsalmon" stroke="black" points="13482.44,-612.33 13026.44,-612.33 13026.44,-544.33 13482.44,-544.33 13482.44,-612.33"/>
<text text-anchor="middle" x="13254.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E10</text>
<text text-anchor="middle" x="13254.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13254.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13254.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- recv_l15_e10_gpu10&#45;&gt;expert_l15_e10_gpu10 -->
<g id="edge1129" class="edge">
<title>recv_l15_e10_gpu10&#45;&gt;expert_l15_e10_gpu10</title>
<path fill="none" stroke="black" d="M13254.44,-649.13C13254.44,-640.38 13254.44,-631.28 13254.44,-622.65"/>
<polygon fill="black" stroke="black" points="13257.94,-622.41 13254.44,-612.41 13250.94,-622.41 13257.94,-622.41"/>
</g>
<!-- send_l15_e10_gpu10 -->
<g id="node865" class="node">
<title>send_l15_e10_gpu10</title>
<ellipse fill="lightgreen" stroke="black" cx="13254.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="13254.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E10</text>
<text text-anchor="middle" x="13254.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13254.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13254.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_l15_e10_gpu10&#45;&gt;send_l15_e10_gpu10 -->
<g id="edge1130" class="edge">
<title>expert_l15_e10_gpu10&#45;&gt;send_l15_e10_gpu10</title>
<path fill="none" stroke="black" d="M13254.44,-544.09C13254.44,-535.84 13254.44,-526.76 13254.44,-517.71"/>
<polygon fill="black" stroke="black" points="13257.94,-517.56 13254.44,-507.56 13250.94,-517.56 13257.94,-517.56"/>
</g>
<!-- send_l15_e10_gpu10&#45;&gt;agg_l15 -->
<g id="edge1131" class="edge">
<title>send_l15_e10_gpu10&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M13031.48,-424.41C12995.09,-419.53 12957.76,-414.9 12922.44,-411.17 12564.36,-373.29 12156.23,-345.85 11858.4,-328.7"/>
<polygon fill="black" stroke="black" points="11858.48,-325.2 11848.3,-328.12 11858.08,-332.19 11858.48,-325.2"/>
</g>
<!-- expert_l15_e11_gpu11 -->
<g id="node867" class="node">
<title>expert_l15_e11_gpu11</title>
<polygon fill="lightsalmon" stroke="black" points="14145.44,-612.33 13689.44,-612.33 13689.44,-544.33 14145.44,-544.33 14145.44,-612.33"/>
<text text-anchor="middle" x="13917.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E11</text>
<text text-anchor="middle" x="13917.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13917.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13917.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- recv_l15_e11_gpu11&#45;&gt;expert_l15_e11_gpu11 -->
<g id="edge1133" class="edge">
<title>recv_l15_e11_gpu11&#45;&gt;expert_l15_e11_gpu11</title>
<path fill="none" stroke="black" d="M13917.44,-649.13C13917.44,-640.38 13917.44,-631.28 13917.44,-622.65"/>
<polygon fill="black" stroke="black" points="13920.94,-622.41 13917.44,-612.41 13913.94,-622.41 13920.94,-622.41"/>
</g>
<!-- send_l15_e11_gpu11 -->
<g id="node868" class="node">
<title>send_l15_e11_gpu11</title>
<ellipse fill="lightgreen" stroke="black" cx="13917.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="13917.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E11</text>
<text text-anchor="middle" x="13917.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13917.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="13917.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_l15_e11_gpu11&#45;&gt;send_l15_e11_gpu11 -->
<g id="edge1134" class="edge">
<title>expert_l15_e11_gpu11&#45;&gt;send_l15_e11_gpu11</title>
<path fill="none" stroke="black" d="M13917.44,-544.09C13917.44,-535.84 13917.44,-526.76 13917.44,-517.71"/>
<polygon fill="black" stroke="black" points="13920.94,-517.56 13917.44,-507.56 13913.94,-517.56 13920.94,-517.56"/>
</g>
<!-- send_l15_e11_gpu11&#45;&gt;agg_l15 -->
<g id="edge1135" class="edge">
<title>send_l15_e11_gpu11&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M13697.23,-424.11C13659.99,-419.17 13621.66,-414.6 13585.44,-411.17 12978.75,-353.59 12272.5,-327.16 11840.02,-315.56"/>
<polygon fill="black" stroke="black" points="11839.94,-312.06 11829.85,-315.29 11839.76,-319.06 11839.94,-312.06"/>
</g>
<!-- expert_l15_e12_gpu12 -->
<g id="node870" class="node">
<title>expert_l15_e12_gpu12</title>
<polygon fill="lightsalmon" stroke="black" points="14808.44,-612.33 14352.44,-612.33 14352.44,-544.33 14808.44,-544.33 14808.44,-612.33"/>
<text text-anchor="middle" x="14580.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E12</text>
<text text-anchor="middle" x="14580.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="14580.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="14580.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_l15_e12_gpu12&#45;&gt;expert_l15_e12_gpu12 -->
<g id="edge1137" class="edge">
<title>recv_l15_e12_gpu12&#45;&gt;expert_l15_e12_gpu12</title>
<path fill="none" stroke="black" d="M14580.44,-649.13C14580.44,-640.38 14580.44,-631.28 14580.44,-622.65"/>
<polygon fill="black" stroke="black" points="14583.94,-622.41 14580.44,-612.41 14576.94,-622.41 14583.94,-622.41"/>
</g>
<!-- send_l15_e12_gpu12 -->
<g id="node871" class="node">
<title>send_l15_e12_gpu12</title>
<ellipse fill="lightgreen" stroke="black" cx="14580.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="14580.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E12</text>
<text text-anchor="middle" x="14580.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="14580.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="14580.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l15_e12_gpu12&#45;&gt;send_l15_e12_gpu12 -->
<g id="edge1138" class="edge">
<title>expert_l15_e12_gpu12&#45;&gt;send_l15_e12_gpu12</title>
<path fill="none" stroke="black" d="M14580.44,-544.09C14580.44,-535.84 14580.44,-526.76 14580.44,-517.71"/>
<polygon fill="black" stroke="black" points="14583.94,-517.56 14580.44,-507.56 14576.94,-517.56 14583.94,-517.56"/>
</g>
<!-- send_l15_e12_gpu12&#45;&gt;agg_l15 -->
<g id="edge1139" class="edge">
<title>send_l15_e12_gpu12&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M14361.6,-423.93C14323.94,-418.96 14285.12,-414.44 14248.44,-411.17 13388.4,-334.49 12375.53,-314.11 11830.81,-308.85"/>
<polygon fill="black" stroke="black" points="11830.47,-305.35 11820.43,-308.75 11830.4,-312.35 11830.47,-305.35"/>
</g>
<!-- expert_l15_e13_gpu13 -->
<g id="node873" class="node">
<title>expert_l15_e13_gpu13</title>
<polygon fill="lightsalmon" stroke="black" points="15471.44,-612.33 15015.44,-612.33 15015.44,-544.33 15471.44,-544.33 15471.44,-612.33"/>
<text text-anchor="middle" x="15243.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E13</text>
<text text-anchor="middle" x="15243.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15243.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15243.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_l15_e13_gpu13&#45;&gt;expert_l15_e13_gpu13 -->
<g id="edge1141" class="edge">
<title>recv_l15_e13_gpu13&#45;&gt;expert_l15_e13_gpu13</title>
<path fill="none" stroke="black" d="M15243.44,-649.13C15243.44,-640.38 15243.44,-631.28 15243.44,-622.65"/>
<polygon fill="black" stroke="black" points="15246.94,-622.41 15243.44,-612.41 15239.94,-622.41 15246.94,-622.41"/>
</g>
<!-- send_l15_e13_gpu13 -->
<g id="node874" class="node">
<title>send_l15_e13_gpu13</title>
<ellipse fill="lightgreen" stroke="black" cx="15243.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="15243.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E13</text>
<text text-anchor="middle" x="15243.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15243.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15243.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l15_e13_gpu13&#45;&gt;send_l15_e13_gpu13 -->
<g id="edge1142" class="edge">
<title>expert_l15_e13_gpu13&#45;&gt;send_l15_e13_gpu13</title>
<path fill="none" stroke="black" d="M15243.44,-544.09C15243.44,-535.84 15243.44,-526.76 15243.44,-517.71"/>
<polygon fill="black" stroke="black" points="15246.94,-517.56 15243.44,-507.56 15239.94,-517.56 15246.94,-517.56"/>
</g>
<!-- send_l15_e13_gpu13&#45;&gt;agg_l15 -->
<g id="edge1143" class="edge">
<title>send_l15_e13_gpu13&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M15025.07,-423.77C14987.26,-418.81 14948.27,-414.32 14911.44,-411.17 14325.74,-361.03 12619.46,-326.98 11836.99,-313.56"/>
<polygon fill="black" stroke="black" points="11837.03,-310.06 11826.97,-313.39 11836.91,-317.06 11837.03,-310.06"/>
</g>
<!-- expert_l15_e14_gpu14 -->
<g id="node876" class="node">
<title>expert_l15_e14_gpu14</title>
<polygon fill="lightsalmon" stroke="black" points="16134.44,-612.33 15678.44,-612.33 15678.44,-544.33 16134.44,-544.33 16134.44,-612.33"/>
<text text-anchor="middle" x="15906.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E14</text>
<text text-anchor="middle" x="15906.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15906.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15906.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_l15_e14_gpu14&#45;&gt;expert_l15_e14_gpu14 -->
<g id="edge1145" class="edge">
<title>recv_l15_e14_gpu14&#45;&gt;expert_l15_e14_gpu14</title>
<path fill="none" stroke="black" d="M15906.44,-649.13C15906.44,-640.38 15906.44,-631.28 15906.44,-622.65"/>
<polygon fill="black" stroke="black" points="15909.94,-622.41 15906.44,-612.41 15902.94,-622.41 15909.94,-622.41"/>
</g>
<!-- send_l15_e14_gpu14 -->
<g id="node877" class="node">
<title>send_l15_e14_gpu14</title>
<ellipse fill="lightgreen" stroke="black" cx="15906.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="15906.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E14</text>
<text text-anchor="middle" x="15906.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15906.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="15906.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l15_e14_gpu14&#45;&gt;send_l15_e14_gpu14 -->
<g id="edge1146" class="edge">
<title>expert_l15_e14_gpu14&#45;&gt;send_l15_e14_gpu14</title>
<path fill="none" stroke="black" d="M15906.44,-544.09C15906.44,-535.84 15906.44,-526.76 15906.44,-517.71"/>
<polygon fill="black" stroke="black" points="15909.94,-517.56 15906.44,-507.56 15902.94,-517.56 15909.94,-517.56"/>
</g>
<!-- send_l15_e14_gpu14&#45;&gt;agg_l15 -->
<g id="edge1147" class="edge">
<title>send_l15_e14_gpu14&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M15688.97,-423.74C15650.89,-418.74 15611.57,-414.26 15574.44,-411.17 14856.42,-351.43 12724.45,-321.47 11834.09,-311.29"/>
<polygon fill="black" stroke="black" points="11834.03,-307.79 11823.99,-311.17 11833.95,-314.79 11834.03,-307.79"/>
</g>
<!-- expert_l15_e15_gpu15 -->
<g id="node879" class="node">
<title>expert_l15_e15_gpu15</title>
<polygon fill="lightsalmon" stroke="black" points="16797.44,-612.33 16341.44,-612.33 16341.44,-544.33 16797.44,-544.33 16797.44,-612.33"/>
<text text-anchor="middle" x="16569.44" y="-597.13" font-family="Times,serif" font-size="14.00">Expert L15E15</text>
<text text-anchor="middle" x="16569.44" y="-582.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="16569.44" y="-567.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="16569.44" y="-552.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_l15_e15_gpu15&#45;&gt;expert_l15_e15_gpu15 -->
<g id="edge1149" class="edge">
<title>recv_l15_e15_gpu15&#45;&gt;expert_l15_e15_gpu15</title>
<path fill="none" stroke="black" d="M16569.44,-649.13C16569.44,-640.38 16569.44,-631.28 16569.44,-622.65"/>
<polygon fill="black" stroke="black" points="16572.94,-622.41 16569.44,-612.41 16565.94,-622.41 16572.94,-622.41"/>
</g>
<!-- send_l15_e15_gpu15 -->
<g id="node880" class="node">
<title>send_l15_e15_gpu15</title>
<ellipse fill="lightgreen" stroke="black" cx="16569.44" cy="-459.25" rx="322.38" ry="48.17"/>
<text text-anchor="middle" x="16569.44" y="-478.05" font-family="Times,serif" font-size="14.00">Token Send L15E15</text>
<text text-anchor="middle" x="16569.44" y="-463.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="16569.44" y="-448.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, tokens_per_expert, d_model=4096]</text>
<text text-anchor="middle" x="16569.44" y="-433.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l15_e15_gpu15&#45;&gt;send_l15_e15_gpu15 -->
<g id="edge1150" class="edge">
<title>expert_l15_e15_gpu15&#45;&gt;send_l15_e15_gpu15</title>
<path fill="none" stroke="black" d="M16569.44,-544.09C16569.44,-535.84 16569.44,-526.76 16569.44,-517.71"/>
<polygon fill="black" stroke="black" points="16572.94,-517.56 16569.44,-507.56 16565.94,-517.56 16572.94,-517.56"/>
</g>
<!-- send_l15_e15_gpu15&#45;&gt;agg_l15 -->
<g id="edge1151" class="edge">
<title>send_l15_e15_gpu15&#45;&gt;agg_l15</title>
<path fill="none" stroke="black" d="M16352.43,-423.69C16314.2,-418.68 16274.72,-414.2 16237.44,-411.17 15386.04,-341.82 12821.39,-316.86 11831.87,-309.65"/>
<polygon fill="black" stroke="black" points="11831.77,-306.15 11821.74,-309.58 11831.71,-313.15 11831.77,-306.15"/>
</g>
<!-- residual2_l15 -->
<g id="node882" class="node">
<title>residual2_l15</title>
<polygon fill="lightpink" stroke="black" points="11653.94,-201.17 11218.94,-201.17 11218.94,-133.17 11653.94,-133.17 11653.94,-201.17"/>
<text text-anchor="middle" x="11436.44" y="-185.97" font-family="Times,serif" font-size="14.00">ResidualAdd L15</text>
<text text-anchor="middle" x="11436.44" y="-170.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11436.44" y="-155.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11436.44" y="-140.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- agg_l15&#45;&gt;residual2_l15 -->
<g id="edge1152" class="edge">
<title>agg_l15&#45;&gt;residual2_l15</title>
<path fill="none" stroke="black" d="M11436.44,-237.87C11436.44,-228.93 11436.44,-219.95 11436.44,-211.56"/>
<polygon fill="black" stroke="black" points="11439.94,-211.29 11436.44,-201.29 11432.94,-211.29 11439.94,-211.29"/>
</g>
<!-- output -->
<g id="node883" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="11436.44" cy="-48.08" rx="307.68" ry="48.17"/>
<text text-anchor="middle" x="11436.44" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="11436.44" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11436.44" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="11436.44" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual2_l15&#45;&gt;output -->
<g id="edge1153" class="edge">
<title>residual2_l15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11436.44,-132.93C11436.44,-124.68 11436.44,-115.59 11436.44,-106.54"/>
<polygon fill="black" stroke="black" points="11439.94,-106.39 11436.44,-96.39 11432.94,-106.39 11439.94,-106.39"/>
</g>
</g>
</svg>
