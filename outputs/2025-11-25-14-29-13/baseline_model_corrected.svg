<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Baseline_TP8_PP2 Pages: 1 -->
<svg width="1383pt" height="2141pt"
 viewBox="0.00 0.00 1383.35 2140.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2136.91)">
<title>MoE_Baseline_TP8_PP2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2136.91 1379.35,-2136.91 1379.35,4 -4,4"/>
<text text-anchor="middle" x="687.67" y="-2112.91" font-family="Times,serif" font-size="20.00">MoE Baseline Model DAG (TP=8, PP=2): 16 Layers, Shared Experts</text>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="372,-1176.91 372,-2094.91 1060,-2094.91 1060,-1176.91 372,-1176.91"/>
<text text-anchor="middle" x="716" y="-2074.91" font-family="Times,serif" font-size="20.00">Stage 0</text>
<text text-anchor="middle" x="716" y="-2052.91" font-family="Times,serif" font-size="20.00">Layers 0&#45;7</text>
<text text-anchor="middle" x="716" y="-2030.91" font-family="Times,serif" font-size="20.00">GPUs: 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_template_s0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="608,-1184.91 608,-2012.91 1052,-2012.91 1052,-1184.91 608,-1184.91"/>
<text text-anchor="middle" x="830" y="-1992.91" font-family="Times,serif" font-size="20.00">Layer Template (All Layers 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-115.95 8,-1033.95 696,-1033.95 696,-115.95 8,-115.95"/>
<text text-anchor="middle" x="352" y="-1013.95" font-family="Times,serif" font-size="20.00">Stage 1</text>
<text text-anchor="middle" x="352" y="-991.95" font-family="Times,serif" font-size="20.00">Layers 8&#45;15</text>
<text text-anchor="middle" x="352" y="-969.95" font-family="Times,serif" font-size="20.00">GPUs: 8&#45;15</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_template_s1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="244,-123.95 244,-951.95 688,-951.95 688,-123.95 244,-123.95"/>
<text text-anchor="middle" x="466" y="-931.95" font-family="Times,serif" font-size="20.00">Layer Template (All Layers 8&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="1072" cy="-37.48" rx="303.2" ry="37.45"/>
<text text-anchor="middle" x="1072" y="-48.78" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1072" y="-33.78" font-family="Times,serif" font-size="14.00">Shape: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="1072" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_s0 -->
<g id="node2" class="node">
<title>ln1_s0</title>
<path fill="lightyellow" stroke="black" d="M977,-1974.91C977,-1974.91 795,-1974.91 795,-1974.91 789,-1974.91 783,-1968.91 783,-1962.91 783,-1962.91 783,-1933.91 783,-1933.91 783,-1927.91 789,-1921.91 795,-1921.91 795,-1921.91 977,-1921.91 977,-1921.91 983,-1921.91 989,-1927.91 989,-1933.91 989,-1933.91 989,-1962.91 989,-1962.91 989,-1968.91 983,-1974.91 977,-1974.91"/>
<text text-anchor="middle" x="886" y="-1959.71" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="886" y="-1944.71" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="886" y="-1929.71" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- input&#45;&gt;ln1_s0 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;ln1_s0</title>
<path fill="none" stroke="black" d="M1072,-75.25C1072,-104.66 1072,-146.95 1072,-183.95 1072,-1851.91 1072,-1851.91 1072,-1851.91 1072,-1891.64 1037.99,-1914.86 999.05,-1928.42"/>
<polygon fill="black" stroke="black" points="997.49,-1925.24 989.06,-1931.66 999.66,-1931.9 997.49,-1925.24"/>
</g>
<!-- attn_s0 -->
<g id="node3" class="node">
<title>attn_s0</title>
<path fill="lightcoral" stroke="black" d="M956,-1884.91C956,-1884.91 774,-1884.91 774,-1884.91 768,-1884.91 762,-1878.91 762,-1872.91 762,-1872.91 762,-1828.91 762,-1828.91 762,-1822.91 768,-1816.91 774,-1816.91 774,-1816.91 956,-1816.91 956,-1816.91 962,-1816.91 968,-1822.91 968,-1828.91 968,-1828.91 968,-1872.91 968,-1872.91 968,-1878.91 962,-1884.91 956,-1884.91"/>
<text text-anchor="middle" x="865" y="-1869.71" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="865" y="-1854.71" font-family="Times,serif" font-size="14.00">Heads: 32, d_k: 128</text>
<text text-anchor="middle" x="865" y="-1839.71" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="865" y="-1824.71" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- ln1_s0&#45;&gt;attn_s0 -->
<g id="edge1" class="edge">
<title>ln1_s0&#45;&gt;attn_s0</title>
<path fill="none" stroke="black" d="M880.37,-1921.81C878.55,-1913.54 876.48,-1904.12 874.46,-1894.94"/>
<polygon fill="black" stroke="black" points="877.87,-1894.14 872.31,-1885.13 871.03,-1895.65 877.87,-1894.14"/>
</g>
<!-- residual1_s0 -->
<g id="node4" class="node">
<title>residual1_s0</title>
<path fill="lightgray" stroke="black" d="M1031.64,-1779.91C1031.64,-1779.91 715.79,-1779.91 715.79,-1779.91 709.79,-1779.91 699.97,-1775.28 696.15,-1770.65 696.15,-1770.65 623.99,-1683.16 623.99,-1683.16 620.18,-1678.54 622.36,-1673.91 628.36,-1673.91 628.36,-1673.91 944.21,-1673.91 944.21,-1673.91 950.21,-1673.91 960.03,-1678.54 963.85,-1683.16 963.85,-1683.16 1036.01,-1770.65 1036.01,-1770.65 1039.82,-1775.28 1037.64,-1779.91 1031.64,-1779.91"/>
<text text-anchor="middle" x="830" y="-1738.21" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="830" y="-1723.21" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="830" y="-1708.21" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- attn_s0&#45;&gt;residual1_s0 -->
<g id="edge2" class="edge">
<title>attn_s0&#45;&gt;residual1_s0</title>
<path fill="none" stroke="black" d="M855.53,-1816.89C853.12,-1808.51 850.46,-1799.23 847.79,-1789.92"/>
<polygon fill="black" stroke="black" points="851.14,-1788.89 845.01,-1780.24 844.41,-1790.82 851.14,-1788.89"/>
</g>
<!-- ln2_s0 -->
<g id="node5" class="node">
<title>ln2_s0</title>
<path fill="lightyellow" stroke="black" d="M921,-1636.91C921,-1636.91 739,-1636.91 739,-1636.91 733,-1636.91 727,-1630.91 727,-1624.91 727,-1624.91 727,-1595.91 727,-1595.91 727,-1589.91 733,-1583.91 739,-1583.91 739,-1583.91 921,-1583.91 921,-1583.91 927,-1583.91 933,-1589.91 933,-1595.91 933,-1595.91 933,-1624.91 933,-1624.91 933,-1630.91 927,-1636.91 921,-1636.91"/>
<text text-anchor="middle" x="830" y="-1621.71" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="830" y="-1606.71" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="830" y="-1591.71" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- residual1_s0&#45;&gt;ln2_s0 -->
<g id="edge3" class="edge">
<title>residual1_s0&#45;&gt;ln2_s0</title>
<path fill="none" stroke="black" d="M830,-1673.68C830,-1664.72 830,-1655.6 830,-1647.2"/>
<polygon fill="black" stroke="black" points="833.5,-1647.01 830,-1637.01 826.5,-1647.01 833.5,-1647.01"/>
</g>
<!-- gate_s0 -->
<g id="node6" class="node">
<title>gate_s0</title>
<path fill="lightgreen" stroke="black" d="M1031.64,-1546.91C1031.64,-1546.91 715.79,-1546.91 715.79,-1546.91 709.79,-1546.91 699.97,-1542.28 696.15,-1537.65 696.15,-1537.65 623.99,-1450.16 623.99,-1450.16 620.18,-1445.54 622.36,-1440.91 628.36,-1440.91 628.36,-1440.91 944.21,-1440.91 944.21,-1440.91 950.21,-1440.91 960.03,-1445.54 963.85,-1450.16 963.85,-1450.16 1036.01,-1537.65 1036.01,-1537.65 1039.82,-1542.28 1037.64,-1546.91 1031.64,-1546.91"/>
<text text-anchor="middle" x="830" y="-1505.21" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="830" y="-1490.21" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="830" y="-1475.21" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- ln2_s0&#45;&gt;gate_s0 -->
<g id="edge4" class="edge">
<title>ln2_s0&#45;&gt;gate_s0</title>
<path fill="none" stroke="black" d="M830,-1583.71C830,-1575.77 830,-1566.65 830,-1557.35"/>
<polygon fill="black" stroke="black" points="833.5,-1557.23 830,-1547.23 826.5,-1557.23 833.5,-1557.23"/>
</g>
<!-- experts_s0 -->
<g id="node7" class="node">
<title>experts_s0</title>
<path fill="lightpink" stroke="black" d="M1000,-1403.91C1000,-1403.91 660,-1403.91 660,-1403.91 654,-1403.91 648,-1397.91 648,-1391.91 648,-1391.91 648,-1347.91 648,-1347.91 648,-1341.91 654,-1335.91 660,-1335.91 660,-1335.91 1000,-1335.91 1000,-1335.91 1006,-1335.91 1012,-1341.91 1012,-1347.91 1012,-1347.91 1012,-1391.91 1012,-1391.91 1012,-1397.91 1006,-1403.91 1000,-1403.91"/>
<text text-anchor="middle" x="830" y="-1388.71" font-family="Times,serif" font-size="14.00">16 Shared Experts</text>
<text text-anchor="middle" x="830" y="-1373.71" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 16384]→[128, 10000, 4096]</text>
<text text-anchor="middle" x="830" y="-1358.71" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
<text text-anchor="middle" x="830" y="-1343.71" font-family="Times,serif" font-size="14.00">Memory: 256MB/expert</text>
</g>
<!-- gate_s0&#45;&gt;experts_s0 -->
<g id="edge5" class="edge">
<title>gate_s0&#45;&gt;experts_s0</title>
<path fill="none" stroke="black" d="M830,-1440.81C830,-1431.97 830,-1422.88 830,-1414.29"/>
<polygon fill="black" stroke="black" points="833.5,-1414.12 830,-1404.12 826.5,-1414.12 833.5,-1414.12"/>
</g>
<!-- residual2_s0 -->
<g id="node8" class="node">
<title>residual2_s0</title>
<path fill="lightgray" stroke="black" d="M1031.64,-1298.91C1031.64,-1298.91 715.79,-1298.91 715.79,-1298.91 709.79,-1298.91 699.97,-1294.28 696.15,-1289.65 696.15,-1289.65 623.99,-1202.16 623.99,-1202.16 620.18,-1197.54 622.36,-1192.91 628.36,-1192.91 628.36,-1192.91 944.21,-1192.91 944.21,-1192.91 950.21,-1192.91 960.03,-1197.54 963.85,-1202.16 963.85,-1202.16 1036.01,-1289.65 1036.01,-1289.65 1039.82,-1294.28 1037.64,-1298.91 1031.64,-1298.91"/>
<text text-anchor="middle" x="830" y="-1257.21" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="830" y="-1242.21" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="830" y="-1227.21" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- experts_s0&#45;&gt;residual2_s0 -->
<g id="edge6" class="edge">
<title>experts_s0&#45;&gt;residual2_s0</title>
<path fill="none" stroke="black" d="M830,-1335.89C830,-1327.69 830,-1318.62 830,-1309.51"/>
<polygon fill="black" stroke="black" points="833.5,-1309.24 830,-1299.24 826.5,-1309.24 833.5,-1309.24"/>
</g>
<!-- pipeline_comm -->
<g id="node18" class="node">
<title>pipeline_comm</title>
<ellipse fill="orange" stroke="black" cx="774" cy="-1098.43" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="774" y="-1109.73" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="774" y="-1094.73" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="774" y="-1079.73" font-family="Times,serif" font-size="14.00">Between Stage 0 &amp; 1</text>
</g>
<!-- residual2_s0&#45;&gt;pipeline_comm -->
<g id="edge14" class="edge">
<title>residual2_s0&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M809.94,-1192.8C804.02,-1177.41 797.58,-1160.69 791.81,-1145.7"/>
<polygon fill="black" stroke="black" points="794.99,-1144.21 788.13,-1136.14 788.46,-1146.73 794.99,-1144.21"/>
<text text-anchor="middle" x="850" y="-1157.71" font-family="Times,serif" font-size="14.00">After 8 layers</text>
</g>
<!-- note_s0 -->
<g id="node9" class="node">
<title>note_s0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="593.5,-1974.91 380.5,-1974.91 380.5,-1921.91 599.5,-1921.91 599.5,-1968.91 593.5,-1974.91"/>
<polyline fill="none" stroke="black" stroke-dasharray="1,5" points="593.5,-1974.91 593.5,-1968.91 "/>
<polyline fill="none" stroke="black" stroke-dasharray="1,5" points="599.5,-1968.91 593.5,-1968.91 "/>
<text text-anchor="middle" x="490" y="-1959.71" font-family="Times,serif" font-size="14.00">16 Layers (0&#45;7)</text>
<text text-anchor="middle" x="490" y="-1944.71" font-family="Times,serif" font-size="14.00">Each Layer: Same Structure</text>
<text text-anchor="middle" x="490" y="-1929.71" font-family="Times,serif" font-size="14.00">Tensor Parallelism: 8&#45;way</text>
</g>
<!-- ln1_s1 -->
<g id="node10" class="node">
<title>ln1_s1</title>
<path fill="lightyellow" stroke="black" d="M640,-913.95C640,-913.95 458,-913.95 458,-913.95 452,-913.95 446,-907.95 446,-901.95 446,-901.95 446,-872.95 446,-872.95 446,-866.95 452,-860.95 458,-860.95 458,-860.95 640,-860.95 640,-860.95 646,-860.95 652,-866.95 652,-872.95 652,-872.95 652,-901.95 652,-901.95 652,-907.95 646,-913.95 640,-913.95"/>
<text text-anchor="middle" x="549" y="-898.75" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="549" y="-883.75" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="549" y="-868.75" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- attn_s1 -->
<g id="node11" class="node">
<title>attn_s1</title>
<path fill="lightcoral" stroke="black" d="M626,-823.95C626,-823.95 444,-823.95 444,-823.95 438,-823.95 432,-817.95 432,-811.95 432,-811.95 432,-767.95 432,-767.95 432,-761.95 438,-755.95 444,-755.95 444,-755.95 626,-755.95 626,-755.95 632,-755.95 638,-761.95 638,-767.95 638,-767.95 638,-811.95 638,-811.95 638,-817.95 632,-823.95 626,-823.95"/>
<text text-anchor="middle" x="535" y="-808.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="535" y="-793.75" font-family="Times,serif" font-size="14.00">Heads: 32, d_k: 128</text>
<text text-anchor="middle" x="535" y="-778.75" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="535" y="-763.75" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- ln1_s1&#45;&gt;attn_s1 -->
<g id="edge7" class="edge">
<title>ln1_s1&#45;&gt;attn_s1</title>
<path fill="none" stroke="black" d="M545.25,-860.86C544.05,-852.67 542.68,-843.37 541.35,-834.28"/>
<polygon fill="black" stroke="black" points="544.78,-833.56 539.87,-824.17 537.86,-834.58 544.78,-833.56"/>
</g>
<!-- residual1_s1 -->
<g id="node12" class="node">
<title>residual1_s1</title>
<path fill="lightgray" stroke="black" d="M667.64,-718.95C667.64,-718.95 351.79,-718.95 351.79,-718.95 345.79,-718.95 335.97,-714.32 332.15,-709.7 332.15,-709.7 259.99,-622.21 259.99,-622.21 256.18,-617.58 258.36,-612.95 264.36,-612.95 264.36,-612.95 580.21,-612.95 580.21,-612.95 586.21,-612.95 596.03,-617.58 599.85,-622.21 599.85,-622.21 672.01,-709.7 672.01,-709.7 675.82,-714.32 673.64,-718.95 667.64,-718.95"/>
<text text-anchor="middle" x="466" y="-677.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="466" y="-662.25" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="466" y="-647.25" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- attn_s1&#45;&gt;residual1_s1 -->
<g id="edge8" class="edge">
<title>attn_s1&#45;&gt;residual1_s1</title>
<path fill="none" stroke="black" d="M516.33,-755.94C511.44,-747.29 506.01,-737.69 500.57,-728.09"/>
<polygon fill="black" stroke="black" points="503.57,-726.27 495.6,-719.29 497.48,-729.72 503.57,-726.27"/>
</g>
<!-- ln2_s1 -->
<g id="node13" class="node">
<title>ln2_s1</title>
<path fill="lightyellow" stroke="black" d="M557,-575.95C557,-575.95 375,-575.95 375,-575.95 369,-575.95 363,-569.95 363,-563.95 363,-563.95 363,-534.95 363,-534.95 363,-528.95 369,-522.95 375,-522.95 375,-522.95 557,-522.95 557,-522.95 563,-522.95 569,-528.95 569,-534.95 569,-534.95 569,-563.95 569,-563.95 569,-569.95 563,-575.95 557,-575.95"/>
<text text-anchor="middle" x="466" y="-560.75" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="466" y="-545.75" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="466" y="-530.75" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- residual1_s1&#45;&gt;ln2_s1 -->
<g id="edge9" class="edge">
<title>residual1_s1&#45;&gt;ln2_s1</title>
<path fill="none" stroke="black" d="M466,-612.73C466,-603.77 466,-594.65 466,-586.25"/>
<polygon fill="black" stroke="black" points="469.5,-586.06 466,-576.06 462.5,-586.06 469.5,-586.06"/>
</g>
<!-- gate_s1 -->
<g id="node14" class="node">
<title>gate_s1</title>
<path fill="lightgreen" stroke="black" d="M667.64,-485.95C667.64,-485.95 351.79,-485.95 351.79,-485.95 345.79,-485.95 335.97,-481.32 332.15,-476.7 332.15,-476.7 259.99,-389.21 259.99,-389.21 256.18,-384.58 258.36,-379.95 264.36,-379.95 264.36,-379.95 580.21,-379.95 580.21,-379.95 586.21,-379.95 596.03,-384.58 599.85,-389.21 599.85,-389.21 672.01,-476.7 672.01,-476.7 675.82,-481.32 673.64,-485.95 667.64,-485.95"/>
<text text-anchor="middle" x="466" y="-444.25" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="466" y="-429.25" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="466" y="-414.25" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- ln2_s1&#45;&gt;gate_s1 -->
<g id="edge10" class="edge">
<title>ln2_s1&#45;&gt;gate_s1</title>
<path fill="none" stroke="black" d="M466,-522.76C466,-514.82 466,-505.7 466,-496.39"/>
<polygon fill="black" stroke="black" points="469.5,-496.27 466,-486.27 462.5,-496.27 469.5,-496.27"/>
</g>
<!-- experts_s1 -->
<g id="node15" class="node">
<title>experts_s1</title>
<path fill="lightpink" stroke="black" d="M636,-342.95C636,-342.95 296,-342.95 296,-342.95 290,-342.95 284,-336.95 284,-330.95 284,-330.95 284,-286.95 284,-286.95 284,-280.95 290,-274.95 296,-274.95 296,-274.95 636,-274.95 636,-274.95 642,-274.95 648,-280.95 648,-286.95 648,-286.95 648,-330.95 648,-330.95 648,-336.95 642,-342.95 636,-342.95"/>
<text text-anchor="middle" x="466" y="-327.75" font-family="Times,serif" font-size="14.00">16 Shared Experts</text>
<text text-anchor="middle" x="466" y="-312.75" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 16384]→[128, 10000, 4096]</text>
<text text-anchor="middle" x="466" y="-297.75" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
<text text-anchor="middle" x="466" y="-282.75" font-family="Times,serif" font-size="14.00">Memory: 256MB/expert</text>
</g>
<!-- gate_s1&#45;&gt;experts_s1 -->
<g id="edge11" class="edge">
<title>gate_s1&#45;&gt;experts_s1</title>
<path fill="none" stroke="black" d="M466,-379.86C466,-371.02 466,-361.92 466,-353.34"/>
<polygon fill="black" stroke="black" points="469.5,-353.17 466,-343.17 462.5,-353.17 469.5,-353.17"/>
</g>
<!-- residual2_s1 -->
<g id="node16" class="node">
<title>residual2_s1</title>
<path fill="lightgray" stroke="black" d="M667.64,-237.95C667.64,-237.95 351.79,-237.95 351.79,-237.95 345.79,-237.95 335.97,-233.32 332.15,-228.7 332.15,-228.7 259.99,-141.21 259.99,-141.21 256.18,-136.58 258.36,-131.95 264.36,-131.95 264.36,-131.95 580.21,-131.95 580.21,-131.95 586.21,-131.95 596.03,-136.58 599.85,-141.21 599.85,-141.21 672.01,-228.7 672.01,-228.7 675.82,-233.32 673.64,-237.95 667.64,-237.95"/>
<text text-anchor="middle" x="466" y="-196.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="466" y="-181.25" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="466" y="-166.25" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- experts_s1&#45;&gt;residual2_s1 -->
<g id="edge12" class="edge">
<title>experts_s1&#45;&gt;residual2_s1</title>
<path fill="none" stroke="black" d="M466,-274.94C466,-266.73 466,-257.67 466,-248.56"/>
<polygon fill="black" stroke="black" points="469.5,-248.29 466,-238.29 462.5,-248.29 469.5,-248.29"/>
</g>
<!-- output -->
<g id="node19" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="447" cy="-37.48" rx="303.2" ry="37.45"/>
<text text-anchor="middle" x="447" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="447" y="-33.78" font-family="Times,serif" font-size="14.00">Shape: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="447" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual2_s1&#45;&gt;output -->
<g id="edge16" class="edge">
<title>residual2_s1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M459.19,-131.84C457.2,-116.61 455.04,-100.06 453.1,-85.18"/>
<polygon fill="black" stroke="black" points="456.56,-84.64 451.79,-75.18 449.62,-85.55 456.56,-84.64"/>
<text text-anchor="middle" x="509.5" y="-96.75" font-family="Times,serif" font-size="14.00">After 16 layers</text>
</g>
<!-- note_s1 -->
<g id="node17" class="node">
<title>note_s1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="229.5,-913.95 16.5,-913.95 16.5,-860.95 235.5,-860.95 235.5,-907.95 229.5,-913.95"/>
<polyline fill="none" stroke="black" stroke-dasharray="1,5" points="229.5,-913.95 229.5,-907.95 "/>
<polyline fill="none" stroke="black" stroke-dasharray="1,5" points="235.5,-907.95 229.5,-907.95 "/>
<text text-anchor="middle" x="126" y="-898.75" font-family="Times,serif" font-size="14.00">16 Layers (8&#45;15)</text>
<text text-anchor="middle" x="126" y="-883.75" font-family="Times,serif" font-size="14.00">Each Layer: Same Structure</text>
<text text-anchor="middle" x="126" y="-868.75" font-family="Times,serif" font-size="14.00">Tensor Parallelism: 8&#45;way</text>
</g>
<!-- pipeline_comm&#45;&gt;ln1_s1 -->
<g id="edge15" class="edge">
<title>pipeline_comm&#45;&gt;ln1_s1</title>
<path fill="none" stroke="black" d="M736.09,-1062.22C693.64,-1022.79 625.42,-959.43 584.14,-921.09"/>
<polygon fill="black" stroke="black" points="586.46,-918.47 576.76,-914.23 581.7,-923.6 586.46,-918.47"/>
</g>
</g>
</svg>
