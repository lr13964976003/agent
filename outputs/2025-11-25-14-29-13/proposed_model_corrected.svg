<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Proposed_EP16 Pages: 1 -->
<svg width="5226pt" height="1309pt"
 viewBox="0.00 0.00 5226.35 1309.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1305.07)">
<title>MoE_Proposed_EP16</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1305.07 5222.35,-1305.07 5222.35,4 -4,4"/>
<text text-anchor="middle" x="2609.17" y="-1281.07" font-family="Times,serif" font-size="20.00">MoE Proposed Model DAG (EP=16): 16 Layers, Expert Parallelism</text>
<g id="clust1" class="cluster">
<title>cluster_layer_template</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-117.95 8,-1263.07 4903,-1263.07 4903,-117.95 8,-117.95"/>
<text text-anchor="middle" x="2455.5" y="-1243.07" font-family="Times,serif" font-size="20.00">Layer Template (All 16 Layers)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_expert_distribution</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="16,-372.91 16,-486.91 4895,-486.91 4895,-372.91 16,-372.91"/>
<text text-anchor="middle" x="2455.5" y="-466.91" font-family="Times,serif" font-size="20.00">Expert Distribution (16 Experts Across GPUs)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="4915" cy="-37.48" rx="303.2" ry="37.45"/>
<text text-anchor="middle" x="4915" y="-48.78" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4915" y="-33.78" font-family="Times,serif" font-size="14.00">Shape: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="4915" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<path fill="lightyellow" stroke="black" d="M4867,-1225.07C4867,-1225.07 4685,-1225.07 4685,-1225.07 4679,-1225.07 4673,-1219.07 4673,-1213.07 4673,-1213.07 4673,-1184.07 4673,-1184.07 4673,-1178.07 4679,-1172.07 4685,-1172.07 4685,-1172.07 4867,-1172.07 4867,-1172.07 4873,-1172.07 4879,-1178.07 4879,-1184.07 4879,-1184.07 4879,-1213.07 4879,-1213.07 4879,-1219.07 4873,-1225.07 4867,-1225.07"/>
<text text-anchor="middle" x="4776" y="-1209.87" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4776" y="-1194.87" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="4776" y="-1179.87" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge39" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M4915,-75.18C4915,-103.31 4915,-143.08 4915,-177.95 4915,-1102.07 4915,-1102.07 4915,-1102.07 4915,-1131.53 4893.52,-1152.59 4867.46,-1167.3"/>
<polygon fill="black" stroke="black" points="4865.67,-1164.28 4858.46,-1172.04 4868.94,-1170.47 4865.67,-1164.28"/>
</g>
<!-- attn -->
<g id="node3" class="node">
<title>attn</title>
<path fill="lightcoral" stroke="black" d="M4820,-1135.07C4820,-1135.07 4638,-1135.07 4638,-1135.07 4632,-1135.07 4626,-1129.07 4626,-1123.07 4626,-1123.07 4626,-1079.07 4626,-1079.07 4626,-1073.07 4632,-1067.07 4638,-1067.07 4638,-1067.07 4820,-1067.07 4820,-1067.07 4826,-1067.07 4832,-1073.07 4832,-1079.07 4832,-1079.07 4832,-1123.07 4832,-1123.07 4832,-1129.07 4826,-1135.07 4820,-1135.07"/>
<text text-anchor="middle" x="4729" y="-1119.87" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4729" y="-1104.87" font-family="Times,serif" font-size="14.00">Heads: 32, d_k: 128</text>
<text text-anchor="middle" x="4729" y="-1089.87" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="4729" y="-1074.87" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1&#45;&gt;attn -->
<g id="edge1" class="edge">
<title>ln1&#45;&gt;attn</title>
<path fill="none" stroke="black" d="M4763.4,-1171.98C4759.24,-1163.53 4754.5,-1153.88 4749.89,-1144.52"/>
<polygon fill="black" stroke="black" points="4752.91,-1142.72 4745.35,-1135.29 4746.63,-1145.81 4752.91,-1142.72"/>
</g>
<!-- residual1 -->
<g id="node4" class="node">
<title>residual1</title>
<path fill="lightgray" stroke="black" d="M3842.64,-1030.07C3842.64,-1030.07 3526.79,-1030.07 3526.79,-1030.07 3520.79,-1030.07 3510.97,-1025.44 3507.15,-1020.82 3507.15,-1020.82 3434.99,-933.33 3434.99,-933.33 3431.18,-928.7 3433.36,-924.07 3439.36,-924.07 3439.36,-924.07 3755.21,-924.07 3755.21,-924.07 3761.21,-924.07 3771.03,-928.7 3774.85,-933.33 3774.85,-933.33 3847.01,-1020.82 3847.01,-1020.82 3850.82,-1025.44 3848.64,-1030.07 3842.64,-1030.07"/>
<text text-anchor="middle" x="3641" y="-988.37" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3641" y="-973.37" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="3641" y="-958.37" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- attn&#45;&gt;residual1 -->
<g id="edge2" class="edge">
<title>attn&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M4625.66,-1088.49C4445.54,-1068.29 4071.21,-1026.31 3839.52,-1000.33"/>
<polygon fill="black" stroke="black" points="3839.61,-996.82 3829.28,-999.19 3838.83,-1003.78 3839.61,-996.82"/>
</g>
<!-- ln2 -->
<g id="node5" class="node">
<title>ln2</title>
<path fill="lightyellow" stroke="black" d="M3184,-887.07C3184,-887.07 3002,-887.07 3002,-887.07 2996,-887.07 2990,-881.07 2990,-875.07 2990,-875.07 2990,-846.07 2990,-846.07 2990,-840.07 2996,-834.07 3002,-834.07 3002,-834.07 3184,-834.07 3184,-834.07 3190,-834.07 3196,-840.07 3196,-846.07 3196,-846.07 3196,-875.07 3196,-875.07 3196,-881.07 3190,-887.07 3184,-887.07"/>
<text text-anchor="middle" x="3093" y="-871.87" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3093" y="-856.87" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="3093" y="-841.87" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual1&#45;&gt;ln2 -->
<g id="edge3" class="edge">
<title>residual1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M3434.61,-932.95C3357.12,-916.76 3271.94,-898.96 3206.02,-885.19"/>
<polygon fill="black" stroke="black" points="3206.53,-881.72 3196.03,-883.1 3205.1,-888.57 3206.53,-881.72"/>
</g>
<!-- gate -->
<g id="node6" class="node">
<title>gate</title>
<path fill="lightgreen" stroke="black" d="M2971.64,-797.07C2971.64,-797.07 2655.79,-797.07 2655.79,-797.07 2649.79,-797.07 2640.54,-792.03 2637.3,-786.98 2637.3,-786.98 2562.85,-671.17 2562.85,-671.17 2559.6,-666.12 2562.36,-661.07 2568.36,-661.07 2568.36,-661.07 2884.21,-661.07 2884.21,-661.07 2890.21,-661.07 2899.46,-666.12 2902.7,-671.17 2902.7,-671.17 2977.15,-786.98 2977.15,-786.98 2980.4,-792.03 2977.64,-797.07 2971.64,-797.07"/>
<text text-anchor="middle" x="2770" y="-747.87" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="2770" y="-732.87" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2770" y="-717.87" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2770" y="-702.87" font-family="Times,serif" font-size="14.00">Top&#45;K=2</text>
</g>
<!-- ln2&#45;&gt;gate -->
<g id="edge4" class="edge">
<title>ln2&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M3029.19,-833.99C3005.05,-824.31 2976.25,-812.76 2946.76,-800.94"/>
<polygon fill="black" stroke="black" points="2947.75,-797.57 2937.17,-797.1 2945.15,-804.07 2947.75,-797.57"/>
</g>
<!-- route_tokens -->
<g id="node23" class="node">
<title>route_tokens</title>
<ellipse fill="orange" stroke="black" cx="2608" cy="-575.99" rx="122.16" ry="48.17"/>
<text text-anchor="middle" x="2608" y="-594.79" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="2608" y="-579.79" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]</text>
<text text-anchor="middle" x="2608" y="-564.79" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2608" y="-549.79" font-family="Times,serif" font-size="14.00">Async: Enabled</text>
</g>
<!-- gate&#45;&gt;route_tokens -->
<g id="edge5" class="edge">
<title>gate&#45;&gt;route_tokens</title>
<path fill="none" stroke="black" d="M2698,-660.93C2685.94,-649.68 2673.61,-638.18 2662.09,-627.44"/>
<polygon fill="black" stroke="black" points="2664.36,-624.76 2654.66,-620.5 2659.58,-629.88 2664.36,-624.76"/>
</g>
<!-- expert_0 -->
<g id="node7" class="node">
<title>expert_0</title>
<path fill="lightpink" stroke="black" d="M299.5,-448.91C299.5,-448.91 36.5,-448.91 36.5,-448.91 30.5,-448.91 24.5,-442.91 24.5,-436.91 24.5,-436.91 24.5,-392.91 24.5,-392.91 24.5,-386.91 30.5,-380.91 36.5,-380.91 36.5,-380.91 299.5,-380.91 299.5,-380.91 305.5,-380.91 311.5,-386.91 311.5,-392.91 311.5,-392.91 311.5,-436.91 311.5,-436.91 311.5,-442.91 305.5,-448.91 299.5,-448.91"/>
<text text-anchor="middle" x="168" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="168" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="168" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="168" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- aggregate_tokens -->
<g id="node24" class="node">
<title>aggregate_tokens</title>
<ellipse fill="orange" stroke="black" cx="2418" cy="-306.43" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="2418" y="-317.73" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="2418" y="-302.73" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2418" y="-287.73" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- expert_0&#45;&gt;aggregate_tokens -->
<g id="edge22" class="edge">
<title>expert_0&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279.35,-380.89C293.27,-377.7 307.4,-374.91 321,-372.91 695.19,-317.69 1842.43,-308.97 2262.12,-307.65"/>
<polygon fill="black" stroke="black" points="2262.21,-311.15 2272.2,-307.61 2262.19,-304.15 2262.21,-311.15"/>
</g>
<!-- expert_1 -->
<g id="node8" class="node">
<title>expert_1</title>
<path fill="lightpink" stroke="black" d="M604.5,-448.91C604.5,-448.91 341.5,-448.91 341.5,-448.91 335.5,-448.91 329.5,-442.91 329.5,-436.91 329.5,-436.91 329.5,-392.91 329.5,-392.91 329.5,-386.91 335.5,-380.91 341.5,-380.91 341.5,-380.91 604.5,-380.91 604.5,-380.91 610.5,-380.91 616.5,-386.91 616.5,-392.91 616.5,-392.91 616.5,-436.91 616.5,-436.91 616.5,-442.91 610.5,-448.91 604.5,-448.91"/>
<text text-anchor="middle" x="473" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="473" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="473" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="473" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_1&#45;&gt;aggregate_tokens -->
<g id="edge23" class="edge">
<title>expert_1&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M584.77,-380.86C598.56,-377.7 612.54,-374.93 626,-372.91 939.18,-325.84 1886.45,-312.23 2262.1,-308.62"/>
<polygon fill="black" stroke="black" points="2262.27,-312.12 2272.23,-308.53 2262.2,-305.12 2262.27,-312.12"/>
</g>
<!-- expert_2 -->
<g id="node9" class="node">
<title>expert_2</title>
<path fill="lightpink" stroke="black" d="M909.5,-448.91C909.5,-448.91 646.5,-448.91 646.5,-448.91 640.5,-448.91 634.5,-442.91 634.5,-436.91 634.5,-436.91 634.5,-392.91 634.5,-392.91 634.5,-386.91 640.5,-380.91 646.5,-380.91 646.5,-380.91 909.5,-380.91 909.5,-380.91 915.5,-380.91 921.5,-386.91 921.5,-392.91 921.5,-392.91 921.5,-436.91 921.5,-436.91 921.5,-442.91 915.5,-448.91 909.5,-448.91"/>
<text text-anchor="middle" x="778" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="778" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="778" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="778" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_2&#45;&gt;aggregate_tokens -->
<g id="edge24" class="edge">
<title>expert_2&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M890.21,-380.86C903.86,-377.73 917.68,-374.96 931,-372.91 1183.85,-333.94 1935.18,-316.08 2262.59,-309.99"/>
<polygon fill="black" stroke="black" points="2262.7,-313.49 2272.63,-309.8 2262.57,-306.49 2262.7,-313.49"/>
</g>
<!-- expert_3 -->
<g id="node10" class="node">
<title>expert_3</title>
<path fill="lightpink" stroke="black" d="M1214.5,-448.91C1214.5,-448.91 951.5,-448.91 951.5,-448.91 945.5,-448.91 939.5,-442.91 939.5,-436.91 939.5,-436.91 939.5,-392.91 939.5,-392.91 939.5,-386.91 945.5,-380.91 951.5,-380.91 951.5,-380.91 1214.5,-380.91 1214.5,-380.91 1220.5,-380.91 1226.5,-386.91 1226.5,-392.91 1226.5,-392.91 1226.5,-436.91 1226.5,-436.91 1226.5,-442.91 1220.5,-448.91 1214.5,-448.91"/>
<text text-anchor="middle" x="1083" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1083" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="1083" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1083" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_3&#45;&gt;aggregate_tokens -->
<g id="edge25" class="edge">
<title>expert_3&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1196.07,-380.82C1209.44,-377.74 1222.97,-374.99 1236,-372.91 1429.33,-341.99 1989.57,-320.83 2263.51,-312.02"/>
<polygon fill="black" stroke="black" points="2263.65,-315.52 2273.54,-311.7 2263.43,-308.52 2263.65,-315.52"/>
</g>
<!-- expert_4 -->
<g id="node11" class="node">
<title>expert_4</title>
<path fill="lightpink" stroke="black" d="M1519.5,-448.91C1519.5,-448.91 1256.5,-448.91 1256.5,-448.91 1250.5,-448.91 1244.5,-442.91 1244.5,-436.91 1244.5,-436.91 1244.5,-392.91 1244.5,-392.91 1244.5,-386.91 1250.5,-380.91 1256.5,-380.91 1256.5,-380.91 1519.5,-380.91 1519.5,-380.91 1525.5,-380.91 1531.5,-386.91 1531.5,-392.91 1531.5,-392.91 1531.5,-436.91 1531.5,-436.91 1531.5,-442.91 1525.5,-448.91 1519.5,-448.91"/>
<text text-anchor="middle" x="1388" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1388" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="1388" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1388" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_4&#45;&gt;aggregate_tokens -->
<g id="edge26" class="edge">
<title>expert_4&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1501.94,-380.87C1515.04,-377.82 1528.26,-375.07 1541,-372.91 1791.28,-330.41 2086.41,-315.5 2262.55,-310.26"/>
<polygon fill="black" stroke="black" points="2262.78,-313.76 2272.67,-309.97 2262.57,-306.76 2262.78,-313.76"/>
</g>
<!-- expert_5 -->
<g id="node12" class="node">
<title>expert_5</title>
<path fill="lightpink" stroke="black" d="M1824.5,-448.91C1824.5,-448.91 1561.5,-448.91 1561.5,-448.91 1555.5,-448.91 1549.5,-442.91 1549.5,-436.91 1549.5,-436.91 1549.5,-392.91 1549.5,-392.91 1549.5,-386.91 1555.5,-380.91 1561.5,-380.91 1561.5,-380.91 1824.5,-380.91 1824.5,-380.91 1830.5,-380.91 1836.5,-386.91 1836.5,-392.91 1836.5,-392.91 1836.5,-436.91 1836.5,-436.91 1836.5,-442.91 1830.5,-448.91 1824.5,-448.91"/>
<text text-anchor="middle" x="1693" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1693" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="1693" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1693" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_5&#45;&gt;aggregate_tokens -->
<g id="edge27" class="edge">
<title>expert_5&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1809.12,-380.87C1821.51,-377.92 1833.98,-375.19 1846,-372.91 1988.29,-345.85 2152.76,-328.45 2268.71,-318.44"/>
<polygon fill="black" stroke="black" points="2269.06,-321.92 2278.72,-317.58 2268.46,-314.94 2269.06,-321.92"/>
</g>
<!-- expert_6 -->
<g id="node13" class="node">
<title>expert_6</title>
<path fill="lightpink" stroke="black" d="M2129.5,-448.91C2129.5,-448.91 1866.5,-448.91 1866.5,-448.91 1860.5,-448.91 1854.5,-442.91 1854.5,-436.91 1854.5,-436.91 1854.5,-392.91 1854.5,-392.91 1854.5,-386.91 1860.5,-380.91 1866.5,-380.91 1866.5,-380.91 2129.5,-380.91 2129.5,-380.91 2135.5,-380.91 2141.5,-386.91 2141.5,-392.91 2141.5,-392.91 2141.5,-436.91 2141.5,-436.91 2141.5,-442.91 2135.5,-448.91 2129.5,-448.91"/>
<text text-anchor="middle" x="1998" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1998" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="1998" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1998" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_6&#45;&gt;aggregate_tokens -->
<g id="edge28" class="edge">
<title>expert_6&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2120.28,-380.89C2130.67,-378.16 2141.01,-375.47 2151,-372.91 2200.85,-360.12 2256.08,-346.48 2303.31,-334.99"/>
<polygon fill="black" stroke="black" points="2304.37,-338.33 2313.26,-332.57 2302.71,-331.53 2304.37,-338.33"/>
</g>
<!-- expert_7 -->
<g id="node14" class="node">
<title>expert_7</title>
<path fill="lightpink" stroke="black" d="M2434.5,-448.91C2434.5,-448.91 2171.5,-448.91 2171.5,-448.91 2165.5,-448.91 2159.5,-442.91 2159.5,-436.91 2159.5,-436.91 2159.5,-392.91 2159.5,-392.91 2159.5,-386.91 2165.5,-380.91 2171.5,-380.91 2171.5,-380.91 2434.5,-380.91 2434.5,-380.91 2440.5,-380.91 2446.5,-386.91 2446.5,-392.91 2446.5,-392.91 2446.5,-436.91 2446.5,-436.91 2446.5,-442.91 2440.5,-448.91 2434.5,-448.91"/>
<text text-anchor="middle" x="2303" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2303" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="2303" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2303" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_7&#45;&gt;aggregate_tokens -->
<g id="edge29" class="edge">
<title>expert_7&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2338.76,-380.8C2349.36,-370.98 2361.13,-360.09 2372.28,-349.76"/>
<polygon fill="black" stroke="black" points="2374.91,-352.09 2379.87,-342.73 2370.16,-346.96 2374.91,-352.09"/>
</g>
<!-- expert_8 -->
<g id="node15" class="node">
<title>expert_8</title>
<path fill="lightpink" stroke="black" d="M2739.5,-448.91C2739.5,-448.91 2476.5,-448.91 2476.5,-448.91 2470.5,-448.91 2464.5,-442.91 2464.5,-436.91 2464.5,-436.91 2464.5,-392.91 2464.5,-392.91 2464.5,-386.91 2470.5,-380.91 2476.5,-380.91 2476.5,-380.91 2739.5,-380.91 2739.5,-380.91 2745.5,-380.91 2751.5,-386.91 2751.5,-392.91 2751.5,-392.91 2751.5,-436.91 2751.5,-436.91 2751.5,-442.91 2745.5,-448.91 2739.5,-448.91"/>
<text text-anchor="middle" x="2608" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="2608" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="2608" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2608" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_8&#45;&gt;aggregate_tokens -->
<g id="edge30" class="edge">
<title>expert_8&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2548.92,-380.8C2529.09,-369.69 2506.81,-357.2 2486.33,-345.72"/>
<polygon fill="black" stroke="black" points="2487.8,-342.53 2477.37,-340.7 2484.38,-348.64 2487.8,-342.53"/>
</g>
<!-- expert_9 -->
<g id="node16" class="node">
<title>expert_9</title>
<path fill="lightpink" stroke="black" d="M3044.5,-448.91C3044.5,-448.91 2781.5,-448.91 2781.5,-448.91 2775.5,-448.91 2769.5,-442.91 2769.5,-436.91 2769.5,-436.91 2769.5,-392.91 2769.5,-392.91 2769.5,-386.91 2775.5,-380.91 2781.5,-380.91 2781.5,-380.91 3044.5,-380.91 3044.5,-380.91 3050.5,-380.91 3056.5,-386.91 3056.5,-392.91 3056.5,-392.91 3056.5,-436.91 3056.5,-436.91 3056.5,-442.91 3050.5,-448.91 3044.5,-448.91"/>
<text text-anchor="middle" x="2913" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2913" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="2913" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2913" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_9&#45;&gt;aggregate_tokens -->
<g id="edge31" class="edge">
<title>expert_9&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2793.73,-380.83C2782.69,-378.04 2771.65,-375.36 2761,-372.91 2690.9,-356.78 2612.1,-341.54 2547.72,-329.83"/>
<polygon fill="black" stroke="black" points="2547.98,-326.32 2537.51,-327.98 2546.73,-333.2 2547.98,-326.32"/>
</g>
<!-- expert_10 -->
<g id="node17" class="node">
<title>expert_10</title>
<path fill="lightpink" stroke="black" d="M3349.5,-448.91C3349.5,-448.91 3086.5,-448.91 3086.5,-448.91 3080.5,-448.91 3074.5,-442.91 3074.5,-436.91 3074.5,-436.91 3074.5,-392.91 3074.5,-392.91 3074.5,-386.91 3080.5,-380.91 3086.5,-380.91 3086.5,-380.91 3349.5,-380.91 3349.5,-380.91 3355.5,-380.91 3361.5,-386.91 3361.5,-392.91 3361.5,-392.91 3361.5,-436.91 3361.5,-436.91 3361.5,-442.91 3355.5,-448.91 3349.5,-448.91"/>
<text text-anchor="middle" x="3218" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="3218" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="3218" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3218" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_10&#45;&gt;aggregate_tokens -->
<g id="edge32" class="edge">
<title>expert_10&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3103.51,-380.9C3090.92,-377.91 3078.23,-375.16 3066,-372.91 2897.74,-341.93 2702.01,-324.69 2570.06,-315.78"/>
<polygon fill="black" stroke="black" points="2570.09,-312.28 2559.88,-315.1 2569.62,-319.26 2570.09,-312.28"/>
</g>
<!-- expert_11 -->
<g id="node18" class="node">
<title>expert_11</title>
<path fill="lightpink" stroke="black" d="M3654.5,-448.91C3654.5,-448.91 3391.5,-448.91 3391.5,-448.91 3385.5,-448.91 3379.5,-442.91 3379.5,-436.91 3379.5,-436.91 3379.5,-392.91 3379.5,-392.91 3379.5,-386.91 3385.5,-380.91 3391.5,-380.91 3391.5,-380.91 3654.5,-380.91 3654.5,-380.91 3660.5,-380.91 3666.5,-386.91 3666.5,-392.91 3666.5,-392.91 3666.5,-436.91 3666.5,-436.91 3666.5,-442.91 3660.5,-448.91 3654.5,-448.91"/>
<text text-anchor="middle" x="3523" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3523" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="3523" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="3523" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_11&#45;&gt;aggregate_tokens -->
<g id="edge33" class="edge">
<title>expert_11&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3410.24,-380.89C3397.09,-377.81 3383.8,-375.05 3371,-372.91 3092.61,-326.26 2763.14,-312.69 2573.57,-308.84"/>
<polygon fill="black" stroke="black" points="2573.59,-305.34 2563.53,-308.65 2573.46,-312.34 2573.59,-305.34"/>
</g>
<!-- expert_12 -->
<g id="node19" class="node">
<title>expert_12</title>
<path fill="lightpink" stroke="black" d="M3959.5,-448.91C3959.5,-448.91 3696.5,-448.91 3696.5,-448.91 3690.5,-448.91 3684.5,-442.91 3684.5,-436.91 3684.5,-436.91 3684.5,-392.91 3684.5,-392.91 3684.5,-386.91 3690.5,-380.91 3696.5,-380.91 3696.5,-380.91 3959.5,-380.91 3959.5,-380.91 3965.5,-380.91 3971.5,-386.91 3971.5,-392.91 3971.5,-392.91 3971.5,-436.91 3971.5,-436.91 3971.5,-442.91 3965.5,-448.91 3959.5,-448.91"/>
<text text-anchor="middle" x="3828" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3828" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="3828" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="3828" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_12&#45;&gt;aggregate_tokens -->
<g id="edge34" class="edge">
<title>expert_12&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3716.1,-380.87C3702.68,-377.75 3689.09,-374.99 3676,-372.91 3467.95,-339.82 2860.59,-319.45 2572.75,-311.39"/>
<polygon fill="black" stroke="black" points="2572.74,-307.89 2562.64,-311.11 2572.54,-314.89 2572.74,-307.89"/>
</g>
<!-- expert_13 -->
<g id="node20" class="node">
<title>expert_13</title>
<path fill="lightpink" stroke="black" d="M4264.5,-448.91C4264.5,-448.91 4001.5,-448.91 4001.5,-448.91 3995.5,-448.91 3989.5,-442.91 3989.5,-436.91 3989.5,-436.91 3989.5,-392.91 3989.5,-392.91 3989.5,-386.91 3995.5,-380.91 4001.5,-380.91 4001.5,-380.91 4264.5,-380.91 4264.5,-380.91 4270.5,-380.91 4276.5,-386.91 4276.5,-392.91 4276.5,-392.91 4276.5,-436.91 4276.5,-436.91 4276.5,-442.91 4270.5,-448.91 4264.5,-448.91"/>
<text text-anchor="middle" x="4133" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="4133" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="4133" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="4133" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_13&#45;&gt;aggregate_tokens -->
<g id="edge35" class="edge">
<title>expert_13&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4021.54,-380.83C4007.98,-377.7 3994.24,-374.94 3981,-372.91 3713.18,-331.7 2913.23,-314.95 2573.44,-309.57"/>
<polygon fill="black" stroke="black" points="2573.33,-306.06 2563.27,-309.41 2573.22,-313.06 2573.33,-306.06"/>
</g>
<!-- expert_14 -->
<g id="node21" class="node">
<title>expert_14</title>
<path fill="lightpink" stroke="black" d="M4569.5,-448.91C4569.5,-448.91 4306.5,-448.91 4306.5,-448.91 4300.5,-448.91 4294.5,-442.91 4294.5,-436.91 4294.5,-436.91 4294.5,-392.91 4294.5,-392.91 4294.5,-386.91 4300.5,-380.91 4306.5,-380.91 4306.5,-380.91 4569.5,-380.91 4569.5,-380.91 4575.5,-380.91 4581.5,-386.91 4581.5,-392.91 4581.5,-392.91 4581.5,-436.91 4581.5,-436.91 4581.5,-442.91 4575.5,-448.91 4569.5,-448.91"/>
<text text-anchor="middle" x="4438" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4438" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="4438" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="4438" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_14&#45;&gt;aggregate_tokens -->
<g id="edge36" class="edge">
<title>expert_14&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4326.97,-380.84C4313.27,-377.69 4299.38,-374.92 4286,-372.91 3957.69,-323.54 2960.76,-311.26 2573.84,-308.32"/>
<polygon fill="black" stroke="black" points="2573.72,-304.82 2563.69,-308.24 2573.67,-311.82 2573.72,-304.82"/>
</g>
<!-- expert_15 -->
<g id="node22" class="node">
<title>expert_15</title>
<path fill="lightpink" stroke="black" d="M4874.5,-448.91C4874.5,-448.91 4611.5,-448.91 4611.5,-448.91 4605.5,-448.91 4599.5,-442.91 4599.5,-436.91 4599.5,-436.91 4599.5,-392.91 4599.5,-392.91 4599.5,-386.91 4605.5,-380.91 4611.5,-380.91 4611.5,-380.91 4874.5,-380.91 4874.5,-380.91 4880.5,-380.91 4886.5,-386.91 4886.5,-392.91 4886.5,-392.91 4886.5,-436.91 4886.5,-436.91 4886.5,-442.91 4880.5,-448.91 4874.5,-448.91"/>
<text text-anchor="middle" x="4743" y="-433.71" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="4743" y="-418.71" font-family="Times,serif" font-size="14.00">Shape: [tokens, 4096]→[tokens, 4096]</text>
<text text-anchor="middle" x="4743" y="-403.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="4743" y="-388.71" font-family="Times,serif" font-size="14.00">Memory: 4GB</text>
</g>
<!-- expert_15&#45;&gt;aggregate_tokens -->
<g id="edge37" class="edge">
<title>expert_15&#45;&gt;aggregate_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4632.39,-380.87C4618.56,-377.69 4604.52,-374.91 4591,-372.91 4201.56,-315.33 3003.9,-308.11 2573.81,-307.41"/>
<polygon fill="black" stroke="black" points="2573.79,-303.91 2563.79,-307.4 2573.78,-310.91 2573.79,-303.91"/>
</g>
<!-- route_tokens&#45;&gt;expert_0 -->
<g id="edge6" class="edge">
<title>route_tokens&#45;&gt;expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2485.59,-573.47C2169.78,-569.03 1301.71,-553.5 580,-509.91 464.65,-502.94 432.63,-516.79 321,-486.91 292.03,-479.15 261.75,-466.24 235.84,-453.53"/>
<polygon fill="black" stroke="black" points="237.38,-450.39 226.87,-449.06 234.26,-456.65 237.38,-450.39"/>
<text text-anchor="middle" x="629" y="-498.71" font-family="Times,serif" font-size="14.00">Top&#45;K routing</text>
</g>
<!-- route_tokens&#45;&gt;expert_1 -->
<g id="edge7" class="edge">
<title>route_tokens&#45;&gt;expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2485.57,-575.75C2110.48,-577.09 981.21,-573.62 626,-486.91 596.35,-479.67 565.49,-466.56 539.31,-453.56"/>
<polygon fill="black" stroke="black" points="540.76,-450.37 530.26,-448.97 537.6,-456.61 540.76,-450.37"/>
</g>
<!-- route_tokens&#45;&gt;expert_2 -->
<g id="edge8" class="edge">
<title>route_tokens&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2487.15,-568.18C2153.05,-549.35 1237.17,-497.81 1172,-494.91 1118.47,-492.53 983.13,-499.32 931,-486.91 901.19,-479.81 870.18,-466.64 843.93,-453.56"/>
<polygon fill="black" stroke="black" points="845.36,-450.36 834.86,-448.95 842.19,-456.6 845.36,-450.36"/>
</g>
<!-- route_tokens&#45;&gt;expert_3 -->
<g id="edge9" class="edge">
<title>route_tokens&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2487.06,-568.25C2299.39,-557.53 1926.77,-535.2 1611,-509.91 1540.69,-504.28 1523.39,-499.54 1453,-494.91 1404.85,-491.74 1282.92,-498.17 1236,-486.91 1206.33,-479.78 1175.46,-466.69 1149.28,-453.67"/>
<polygon fill="black" stroke="black" points="1150.73,-450.48 1140.23,-449.08 1147.57,-456.73 1150.73,-450.48"/>
</g>
<!-- route_tokens&#45;&gt;expert_4 -->
<g id="edge10" class="edge">
<title>route_tokens&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2488.17,-566.23C2218.96,-546.39 1586.18,-498.85 1541,-486.91 1511.88,-479.21 1481.45,-466.23 1455.48,-453.46"/>
<polygon fill="black" stroke="black" points="1456.99,-450.31 1446.48,-448.96 1453.86,-456.57 1456.99,-450.31"/>
</g>
<!-- route_tokens&#45;&gt;expert_5 -->
<g id="edge11" class="edge">
<title>route_tokens&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2485.93,-572.8C2333.49,-567.38 2065.98,-548.92 1846,-486.91 1817.51,-478.87 1787.66,-466.12 1761.97,-453.61"/>
<polygon fill="black" stroke="black" points="1763.22,-450.33 1752.71,-449.03 1760.12,-456.6 1763.22,-450.33"/>
</g>
<!-- route_tokens&#45;&gt;expert_6 -->
<g id="edge12" class="edge">
<title>route_tokens&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2491.95,-560.61C2398.39,-547.12 2264.22,-523.48 2151,-486.91 2123.58,-478.05 2094.63,-465.51 2069.38,-453.43"/>
<polygon fill="black" stroke="black" points="2070.78,-450.21 2060.25,-449 2067.72,-456.51 2070.78,-450.21"/>
</g>
<!-- route_tokens&#45;&gt;expert_7 -->
<g id="edge13" class="edge">
<title>route_tokens&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2535.33,-537.09C2487,-511.88 2423.76,-478.89 2375.47,-453.71"/>
<polygon fill="black" stroke="black" points="2376.81,-450.46 2366.33,-448.94 2373.57,-456.66 2376.81,-450.46"/>
</g>
<!-- route_tokens&#45;&gt;expert_8 -->
<g id="edge14" class="edge">
<title>route_tokens&#45;&gt;expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2608,-527.69C2608,-505.97 2608,-480.38 2608,-459.17"/>
<polygon fill="black" stroke="black" points="2611.5,-459.15 2608,-449.15 2604.5,-459.15 2611.5,-459.15"/>
</g>
<!-- route_tokens&#45;&gt;expert_9 -->
<g id="edge15" class="edge">
<title>route_tokens&#45;&gt;expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2680.67,-537.09C2729,-511.88 2792.24,-478.89 2840.53,-453.71"/>
<polygon fill="black" stroke="black" points="2842.43,-456.66 2849.67,-448.94 2839.19,-450.46 2842.43,-456.66"/>
</g>
<!-- route_tokens&#45;&gt;expert_10 -->
<g id="edge16" class="edge">
<title>route_tokens&#45;&gt;expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2724.33,-560.71C2818.11,-547.29 2952.58,-523.68 3066,-486.91 3093.27,-478.07 3122.03,-465.53 3147.12,-453.45"/>
<polygon fill="black" stroke="black" points="3148.73,-456.55 3156.18,-449.02 3145.66,-450.26 3148.73,-456.55"/>
</g>
<!-- route_tokens&#45;&gt;expert_11 -->
<g id="edge17" class="edge">
<title>route_tokens&#45;&gt;expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2730.26,-572.91C2882.92,-567.6 3150.81,-549.26 3371,-486.91 3399.33,-478.88 3428.98,-466.13 3454.5,-453.63"/>
<polygon fill="black" stroke="black" points="3456.32,-456.63 3463.71,-449.04 3453.2,-450.37 3456.32,-456.63"/>
</g>
<!-- route_tokens&#45;&gt;expert_12 -->
<g id="edge18" class="edge">
<title>route_tokens&#45;&gt;expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2729.77,-570.36C2970.75,-560.31 3500.35,-533.57 3676,-486.91 3704.96,-479.21 3735.19,-466.24 3760.99,-453.47"/>
<polygon fill="black" stroke="black" points="3762.57,-456.59 3769.92,-448.97 3759.42,-450.34 3762.57,-456.59"/>
</g>
<!-- route_tokens&#45;&gt;expert_13 -->
<g id="edge19" class="edge">
<title>route_tokens&#45;&gt;expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2730.25,-572.95C3020.85,-567.17 3746.2,-546.99 3981,-486.91 4010.15,-479.45 4040.53,-466.44 4066.4,-453.59"/>
<polygon fill="black" stroke="black" points="4068.01,-456.69 4075.35,-449.05 4064.85,-450.45 4068.01,-456.69"/>
</g>
<!-- route_tokens&#45;&gt;expert_14 -->
<g id="edge20" class="edge">
<title>route_tokens&#45;&gt;expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2729.28,-569.39C2959.62,-558.66 3476.23,-534.1 3911,-509.91 4077.72,-500.63 4124.17,-528.08 4286,-486.91 4315.29,-479.46 4345.81,-466.38 4371.75,-453.46"/>
<polygon fill="black" stroke="black" points="4373.39,-456.56 4380.72,-448.91 4370.22,-450.31 4373.39,-456.56"/>
</g>
<!-- route_tokens&#45;&gt;expert_15 -->
<g id="edge21" class="edge">
<title>route_tokens&#45;&gt;expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2729.58,-569.69C2982.1,-558.67 3581.78,-532.43 4085,-509.91 4309.9,-499.84 4372.4,-540.68 4591,-486.91 4620.47,-479.66 4651.14,-466.54 4677.14,-453.54"/>
<polygon fill="black" stroke="black" points="4678.82,-456.62 4686.14,-448.96 4675.64,-450.38 4678.82,-456.62"/>
</g>
<!-- residual2 -->
<g id="node25" class="node">
<title>residual2</title>
<path fill="lightgray" stroke="black" d="M2619.64,-231.95C2619.64,-231.95 2303.79,-231.95 2303.79,-231.95 2297.79,-231.95 2287.97,-227.32 2284.15,-222.7 2284.15,-222.7 2211.99,-135.21 2211.99,-135.21 2208.18,-130.58 2210.36,-125.95 2216.36,-125.95 2216.36,-125.95 2532.21,-125.95 2532.21,-125.95 2538.21,-125.95 2548.03,-130.58 2551.85,-135.21 2551.85,-135.21 2624.01,-222.7 2624.01,-222.7 2627.82,-227.32 2625.64,-231.95 2619.64,-231.95"/>
<text text-anchor="middle" x="2418" y="-190.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2418" y="-175.25" font-family="Times,serif" font-size="14.00">Shape: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2418" y="-160.25" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- aggregate_tokens&#45;&gt;residual2 -->
<g id="edge38" class="edge">
<title>aggregate_tokens&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M2418,-268.8C2418,-260.5 2418,-251.45 2418,-242.41"/>
<polygon fill="black" stroke="black" points="2421.5,-242.25 2418,-232.25 2414.5,-242.25 2421.5,-242.25"/>
</g>
<!-- output -->
<g id="node27" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="2418" cy="-37.48" rx="303.2" ry="37.45"/>
<text text-anchor="middle" x="2418" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2418" y="-33.78" font-family="Times,serif" font-size="14.00">Shape: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="2418" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- residual2&#45;&gt;output -->
<g id="edge40" class="edge">
<title>residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2418,-125.62C2418,-112.32 2418,-98.13 2418,-85.13"/>
<polygon fill="black" stroke="black" points="2421.5,-85.01 2418,-75.01 2414.5,-85.01 2421.5,-85.01"/>
<text text-anchor="middle" x="2471.5" y="-96.75" font-family="Times,serif" font-size="14.00">After 16 layers</text>
</g>
<!-- layer_note -->
<g id="node26" class="node">
<title>layer_note</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="5187,-1225.07 4927,-1225.07 4927,-1172.07 5193,-1172.07 5193,-1219.07 5187,-1225.07"/>
<polyline fill="none" stroke="black" stroke-dasharray="1,5" points="5187,-1225.07 5187,-1219.07 "/>
<polyline fill="none" stroke="black" stroke-dasharray="1,5" points="5193,-1219.07 5187,-1219.07 "/>
<text text-anchor="middle" x="5060" y="-1209.87" font-family="Times,serif" font-size="14.00">16 Layers Total</text>
<text text-anchor="middle" x="5060" y="-1194.87" font-family="Times,serif" font-size="14.00">Each Layer: Same EP&#45;16 Structure</text>
<text text-anchor="middle" x="5060" y="-1179.87" font-family="Times,serif" font-size="14.00">1 Expert per GPU per Layer</text>
</g>
</g>
</svg>
