<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_moe_dag Pages: 1 -->
<svg width="1800pt" height="408pt"
 viewBox="0.00 0.00 1800.00 408.05" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.1 0.1) rotate(0) translate(4 4061.91)">
<title>proposed_moe_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4061.91 17931.5,-4061.91 17931.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="8845.5" cy="-4020.43" rx="306.77" ry="37.45"/>
<text text-anchor="middle" x="8845.5" y="-4031.73" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="8845.5" y="-4016.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8845.5" y="-4001.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_qkv_gpu0 -->
<g id="node2" class="node">
<title>l0_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2515,-3946.95 2034,-3946.95 2034,-3878.95 2515,-3878.95 2515,-3946.95"/>
<text text-anchor="middle" x="2274.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2274.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2274.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2274.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M8539.35,-4017.8C7474.78,-4011.83 3937.48,-3989.2 2802.5,-3946.95 2712.03,-3943.59 2612.94,-3937.92 2525.29,-3932.22"/>
<polygon fill="black" stroke="black" points="2525.41,-3928.72 2515.21,-3931.56 2524.96,-3935.71 2525.41,-3928.72"/>
</g>
<!-- l0_mha_res_add_gpu0 -->
<g id="node5" class="node">
<title>l0_mha_res_add_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="1565.5,-3634.95 1131.5,-3634.95 1131.5,-3566.95 1565.5,-3566.95 1565.5,-3634.95"/>
<text text-anchor="middle" x="1348.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1348.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1348.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1348.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu0 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M8538.7,-4018.26C7370.01,-4013.48 3248.44,-3993.4 2972.5,-3946.95 2733.7,-3906.76 2689.91,-3835.73 2455.5,-3774.95 2213.84,-3712.3 2150.16,-3709.48 1903.5,-3670.95 1796.04,-3654.17 1676.35,-3638.86 1575.72,-3626.95"/>
<polygon fill="black" stroke="black" points="1576.07,-3623.47 1565.73,-3625.77 1575.25,-3630.42 1576.07,-3623.47"/>
</g>
<!-- l0_mha_qkv_gpu1 -->
<g id="node10" class="node">
<title>l0_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3462,-3946.95 2981,-3946.95 2981,-3878.95 3462,-3878.95 3462,-3946.95"/>
<text text-anchor="middle" x="3221.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3221.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3221.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3221.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu1 -->
<g id="edge27" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M8538.42,-4019.94C7552.07,-4020.85 4471,-4017.78 3476.5,-3946.95 3475,-3946.85 3473.5,-3946.74 3472,-3946.63"/>
<polygon fill="black" stroke="black" points="3472.25,-3943.13 3462.01,-3945.85 3471.71,-3950.11 3472.25,-3943.13"/>
</g>
<!-- l0_mha_res_add_gpu1 -->
<g id="node13" class="node">
<title>l0_mha_res_add_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="2649.5,-3634.95 2215.5,-3634.95 2215.5,-3566.95 2649.5,-3566.95 2649.5,-3634.95"/>
<text text-anchor="middle" x="2432.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2432.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2432.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2432.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu1 -->
<g id="edge31" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M8538.79,-4018.48C7434.89,-4014.62 3723.28,-3997.9 3610.5,-3946.95 3459.67,-3878.81 3509.21,-3743.61 3360.5,-3670.95 3299.15,-3640.98 2914.14,-3620.5 2659.69,-3610.05"/>
<polygon fill="black" stroke="black" points="2659.7,-3606.55 2649.57,-3609.64 2659.42,-3613.54 2659.7,-3606.55"/>
</g>
<!-- l0_mha_qkv_gpu2 -->
<g id="node18" class="node">
<title>l0_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4100,-3946.95 3619,-3946.95 3619,-3878.95 4100,-3878.95 4100,-3946.95"/>
<text text-anchor="middle" x="3859.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3859.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3859.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3859.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu2 -->
<g id="edge53" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M8538.84,-4018.15C7641.76,-4013.85 5032.29,-3997.26 4180.5,-3946.95 4157.75,-3945.61 4134.12,-3943.86 4110.46,-3941.87"/>
<polygon fill="black" stroke="black" points="4110.59,-3938.36 4100.33,-3941 4109.99,-3945.34 4110.59,-3938.36"/>
</g>
<!-- l0_mha_res_add_gpu2 -->
<g id="node21" class="node">
<title>l0_mha_res_add_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="3733.5,-3634.95 3299.5,-3634.95 3299.5,-3566.95 3733.5,-3566.95 3733.5,-3634.95"/>
<text text-anchor="middle" x="3516.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3516.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3516.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3516.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu2 -->
<g id="edge57" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M8539.32,-4017.7C7597.78,-4011.93 4797.16,-3991.12 4606.5,-3946.95 4324.87,-3881.71 4294.72,-3752.94 4017.5,-3670.95 3929.84,-3645.03 3830.62,-3628.78 3743.74,-3618.62"/>
<polygon fill="black" stroke="black" points="3744.08,-3615.14 3733.75,-3617.48 3743.28,-3622.09 3744.08,-3615.14"/>
</g>
<!-- l0_mha_qkv_gpu3 -->
<g id="node26" class="node">
<title>l0_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5096,-3946.95 4615,-3946.95 4615,-3878.95 5096,-3878.95 5096,-3946.95"/>
<text text-anchor="middle" x="4855.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4855.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4855.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4855.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu3 -->
<g id="edge79" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M8545.02,-4012.76C8011.56,-4000.75 6864.02,-3974.22 5895.5,-3946.95 5625.89,-3939.36 5317.01,-3929.4 5106.38,-3922.42"/>
<polygon fill="black" stroke="black" points="5106.22,-3918.91 5096.11,-3922.08 5105.99,-3925.91 5106.22,-3918.91"/>
</g>
<!-- l0_mha_res_add_gpu3 -->
<g id="node29" class="node">
<title>l0_mha_res_add_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="4779.5,-3634.95 4345.5,-3634.95 4345.5,-3566.95 4779.5,-3566.95 4779.5,-3634.95"/>
<text text-anchor="middle" x="4562.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4562.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4562.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4562.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu3 -->
<g id="edge83" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M8538.91,-4018.53C7930.96,-4015.53 6592.04,-4002.61 6135.5,-3946.95 6064.56,-3938.3 5103.3,-3723.35 4719.32,-3637.19"/>
<polygon fill="black" stroke="black" points="4720.05,-3633.76 4709.52,-3634.99 4718.51,-3640.59 4720.05,-3633.76"/>
</g>
<!-- l0_mha_qkv_gpu4 -->
<g id="node34" class="node">
<title>l0_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6625,-3946.95 6144,-3946.95 6144,-3878.95 6625,-3878.95 6625,-3946.95"/>
<text text-anchor="middle" x="6384.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6384.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="6384.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6384.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu4 -->
<g id="edge105" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M8540.05,-4016.62C8120.61,-4011.07 7343.02,-3994.71 6681.5,-3946.95 6666.43,-3945.87 6650.95,-3944.6 6635.34,-3943.21"/>
<polygon fill="black" stroke="black" points="6635.34,-3939.69 6625.07,-3942.27 6634.71,-3946.66 6635.34,-3939.69"/>
</g>
<!-- l0_mha_res_add_gpu4 -->
<g id="node37" class="node">
<title>l0_mha_res_add_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5787.5,-3634.95 5353.5,-3634.95 5353.5,-3566.95 5787.5,-3566.95 5787.5,-3634.95"/>
<text text-anchor="middle" x="5570.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5570.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5570.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5570.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu4 -->
<g id="edge109" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M8538.58,-4019.07C8015.98,-4016.86 6994.66,-4005.06 6840.5,-3946.95 6659.02,-3878.55 6682.66,-3742.77 6502.5,-3670.95 6378.99,-3621.72 6031.62,-3607.24 5797.65,-3603.2"/>
<polygon fill="black" stroke="black" points="5797.7,-3599.7 5787.64,-3603.03 5797.58,-3606.7 5797.7,-3599.7"/>
</g>
<!-- l0_mha_qkv_gpu5 -->
<g id="node42" class="node">
<title>l0_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="7330,-3946.95 6849,-3946.95 6849,-3878.95 7330,-3878.95 7330,-3946.95"/>
<text text-anchor="middle" x="7089.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7089.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="7089.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7089.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu5 -->
<g id="edge131" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M8550.49,-4010.1C8255.34,-3999.52 7788.51,-3979.39 7385.5,-3946.95 7370.7,-3945.76 7355.5,-3944.42 7340.17,-3942.98"/>
<polygon fill="black" stroke="black" points="7340.37,-3939.49 7330.08,-3942.03 7339.71,-3946.46 7340.37,-3939.49"/>
</g>
<!-- l0_mha_res_add_gpu5 -->
<g id="node45" class="node">
<title>l0_mha_res_add_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6795.5,-3634.95 6361.5,-3634.95 6361.5,-3566.95 6795.5,-3566.95 6795.5,-3634.95"/>
<text text-anchor="middle" x="6578.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6578.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6578.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6578.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu5 -->
<g id="edge135" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M8541.39,-4015.12C8181.21,-4008.07 7618.7,-3990.24 7530.5,-3946.95 7394.51,-3880.21 7459.91,-3749.7 7330.5,-3670.95 7286.28,-3644.05 7010.48,-3624.08 6805.62,-3612.73"/>
<polygon fill="black" stroke="black" points="6805.79,-3609.23 6795.61,-3612.18 6805.41,-3616.22 6805.79,-3609.23"/>
</g>
<!-- l0_mha_qkv_gpu6 -->
<g id="node50" class="node">
<title>l0_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="8020,-3946.95 7539,-3946.95 7539,-3878.95 8020,-3878.95 8020,-3946.95"/>
<text text-anchor="middle" x="7779.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7779.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7779.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7779.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu6 -->
<g id="edge157" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M8610.9,-3996.22C8439.07,-3979.22 8206.19,-3956.17 8030.61,-3938.8"/>
<polygon fill="black" stroke="black" points="8030.74,-3935.3 8020.45,-3937.79 8030.06,-3942.26 8030.74,-3935.3"/>
</g>
<!-- l0_mha_res_add_gpu6 -->
<g id="node53" class="node">
<title>l0_mha_res_add_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7803.5,-3634.95 7369.5,-3634.95 7369.5,-3566.95 7803.5,-3566.95 7803.5,-3634.95"/>
<text text-anchor="middle" x="7586.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7586.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7586.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7586.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu6 -->
<g id="edge161" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M8560.53,-4006.43C8416.09,-3996.15 8257.89,-3978.12 8193.5,-3946.95 8038.2,-3871.78 8072.14,-3753.26 7920.5,-3670.95 7887.66,-3653.13 7850.71,-3639.9 7813.68,-3630.08"/>
<polygon fill="black" stroke="black" points="7814.31,-3626.63 7803.75,-3627.53 7812.56,-3633.41 7814.31,-3626.63"/>
</g>
<!-- l0_mha_qkv_gpu7 -->
<g id="node58" class="node">
<title>l0_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8683,-3946.95 8202,-3946.95 8202,-3878.95 8683,-3878.95 8683,-3946.95"/>
<text text-anchor="middle" x="8442.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8442.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8442.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8442.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu7 -->
<g id="edge183" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M8718.82,-3986.27C8674.21,-3974.6 8623.89,-3961.43 8578.54,-3949.56"/>
<polygon fill="black" stroke="black" points="8579.2,-3946.11 8568.64,-3946.97 8577.43,-3952.89 8579.2,-3946.11"/>
</g>
<!-- l0_mha_res_add_gpu7 -->
<g id="node61" class="node">
<title>l0_mha_res_add_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8659.5,-3634.95 8225.5,-3634.95 8225.5,-3566.95 8659.5,-3566.95 8659.5,-3634.95"/>
<text text-anchor="middle" x="8442.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8442.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8442.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8442.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu7 -->
<g id="edge187" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8769.64,-3983.99C8754.98,-3973.94 8741.18,-3961.64 8731.5,-3946.95 8663.07,-3843.2 8769.24,-3763.7 8686.5,-3670.95 8675.41,-3658.52 8649.56,-3647.41 8618.64,-3637.93"/>
<polygon fill="black" stroke="black" points="8619.47,-3634.53 8608.89,-3635.04 8617.48,-3641.24 8619.47,-3634.53"/>
</g>
<!-- l0_mha_qkv_gpu8 -->
<g id="node66" class="node">
<title>l0_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="9221,-3946.95 8740,-3946.95 8740,-3878.95 9221,-3878.95 9221,-3946.95"/>
<text text-anchor="middle" x="8980.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8980.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="8980.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8980.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu8 -->
<g id="edge209" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M8891.96,-3983.13C8904.22,-3973.55 8917.51,-3963.16 8929.98,-3953.42"/>
<polygon fill="black" stroke="black" points="8932.31,-3956.05 8938.03,-3947.13 8928,-3950.53 8932.31,-3956.05"/>
</g>
<!-- l0_mha_res_add_gpu8 -->
<g id="node69" class="node">
<title>l0_mha_res_add_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="9466.5,-3634.95 9032.5,-3634.95 9032.5,-3566.95 9466.5,-3566.95 9466.5,-3634.95"/>
<text text-anchor="middle" x="9249.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9249.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9249.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9249.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu8 -->
<g id="edge213" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M9089.37,-3997.66C9152.99,-3986.84 9209.62,-3970.77 9230.5,-3946.95 9304.48,-3862.59 9280.49,-3717.32 9262.21,-3645.19"/>
<polygon fill="black" stroke="black" points="9265.48,-3643.88 9259.56,-3635.1 9258.71,-3645.66 9265.48,-3643.88"/>
</g>
<!-- l0_mha_qkv_gpu9 -->
<g id="node74" class="node">
<title>l0_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="9918,-3946.95 9437,-3946.95 9437,-3878.95 9918,-3878.95 9918,-3946.95"/>
<text text-anchor="middle" x="9677.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9677.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9677.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9677.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu9 -->
<g id="edge235" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M9054.37,-3992.95C9167.44,-3978.62 9307.92,-3960.81 9426.86,-3945.73"/>
<polygon fill="black" stroke="black" points="9427.36,-3949.19 9436.84,-3944.46 9426.48,-3942.25 9427.36,-3949.19"/>
</g>
<!-- l0_mha_res_add_gpu9 -->
<g id="node77" class="node">
<title>l0_mha_res_add_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="10789.5,-3634.95 10355.5,-3634.95 10355.5,-3566.95 10789.5,-3566.95 10789.5,-3634.95"/>
<text text-anchor="middle" x="10572.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10572.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10572.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10572.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu9 -->
<g id="edge239" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M9143.03,-4011.16C9411.07,-4001.59 9784.32,-3982.38 9927.5,-3946.95 10037.98,-3919.62 10060.25,-3894.93 10161.5,-3842.95 10289.04,-3777.48 10432.27,-3690.19 10511.49,-3640.64"/>
<polygon fill="black" stroke="black" points="10513.74,-3643.36 10520.36,-3635.08 10510.03,-3637.43 10513.74,-3643.36"/>
</g>
<!-- l0_mha_qkv_gpu10 -->
<g id="node82" class="node">
<title>l0_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="11083,-3946.95 10602,-3946.95 10602,-3878.95 11083,-3878.95 11083,-3946.95"/>
<text text-anchor="middle" x="10842.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10842.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10842.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10842.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu10 -->
<g id="edge261" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M9137.78,-4009.01C9455.58,-3996.98 9978.37,-3975.19 10428.5,-3946.95 10481.34,-3943.64 10537.93,-3939.51 10591.77,-3935.31"/>
<polygon fill="black" stroke="black" points="10592.09,-3938.79 10601.79,-3934.52 10591.55,-3931.81 10592.09,-3938.79"/>
</g>
<!-- l0_mha_res_add_gpu10 -->
<g id="node85" class="node">
<title>l0_mha_res_add_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="11331.5,-3634.95 10897.5,-3634.95 10897.5,-3566.95 11331.5,-3566.95 11331.5,-3634.95"/>
<text text-anchor="middle" x="11114.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11114.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11114.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11114.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu10 -->
<g id="edge265" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M9152.63,-4020.32C9751.72,-4020.58 11024.06,-4013.28 11092.5,-3946.95 11173.7,-3868.27 11147.3,-3718.56 11127.7,-3644.97"/>
<polygon fill="black" stroke="black" points="11131.01,-3643.82 11124.99,-3635.11 11124.26,-3645.68 11131.01,-3643.82"/>
</g>
<!-- l0_mha_qkv_gpu11 -->
<g id="node90" class="node">
<title>l0_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="11858,-3946.95 11377,-3946.95 11377,-3878.95 11858,-3878.95 11858,-3946.95"/>
<text text-anchor="middle" x="11617.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11617.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="11617.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11617.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu11 -->
<g id="edge287" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M9147.09,-4013.28C9584.1,-4003.59 10418.8,-3982.15 11128.5,-3946.95 11205.97,-3943.11 11290.27,-3937.82 11366.72,-3932.6"/>
<polygon fill="black" stroke="black" points="11367.23,-3936.07 11376.96,-3931.9 11366.75,-3929.09 11367.23,-3936.07"/>
</g>
<!-- l0_mha_res_add_gpu11 -->
<g id="node93" class="node">
<title>l0_mha_res_add_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="12805.5,-3634.95 12371.5,-3634.95 12371.5,-3566.95 12805.5,-3566.95 12805.5,-3634.95"/>
<text text-anchor="middle" x="12588.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12588.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12588.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12588.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu11 -->
<g id="edge291" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M9152.39,-4019.65C9812.52,-4018.88 11349.48,-4010.11 11867.5,-3946.95 12079.01,-3921.17 12147.49,-3943.21 12335.5,-3842.95 12429.69,-3792.73 12513.93,-3697.68 12557.4,-3643.16"/>
<polygon fill="black" stroke="black" points="12560.31,-3645.12 12563.76,-3635.1 12554.82,-3640.78 12560.31,-3645.12"/>
</g>
<!-- l0_mha_qkv_gpu12 -->
<g id="node98" class="node">
<title>l0_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13011,-3946.95 12530,-3946.95 12530,-3878.95 13011,-3878.95 13011,-3946.95"/>
<text text-anchor="middle" x="12770.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12770.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12770.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12770.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu12 -->
<g id="edge313" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M9151.26,-4017.1C9905.65,-4010.74 11841.08,-3990.58 12485.5,-3946.95 12496.65,-3946.2 12508.03,-3945.32 12519.52,-3944.35"/>
<polygon fill="black" stroke="black" points="12519.98,-3947.83 12529.64,-3943.48 12519.37,-3940.85 12519.98,-3947.83"/>
</g>
<!-- l0_mha_res_add_gpu12 -->
<g id="node101" class="node">
<title>l0_mha_res_add_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="13461.5,-3634.95 13027.5,-3634.95 13027.5,-3566.95 13461.5,-3566.95 13461.5,-3634.95"/>
<text text-anchor="middle" x="13244.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13244.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13244.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13244.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu12 -->
<g id="edge317" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M9151.74,-4017.94C10101.06,-4012.85 12936.08,-3993.75 13020.5,-3946.95 13139.6,-3880.93 13205.56,-3721.85 13231.46,-3644.97"/>
<polygon fill="black" stroke="black" points="13234.89,-3645.72 13234.7,-3635.13 13228.25,-3643.53 13234.89,-3645.72"/>
</g>
<!-- l0_mha_qkv_gpu13 -->
<g id="node106" class="node">
<title>l0_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13842,-3946.95 13361,-3946.95 13361,-3878.95 13842,-3878.95 13842,-3946.95"/>
<text text-anchor="middle" x="13601.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13601.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13601.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13601.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu13 -->
<g id="edge339" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M9151.52,-4017.24C10010.73,-4010.63 12434.29,-3988.74 13229.5,-3946.95 13268.68,-3944.89 13310.12,-3941.96 13350.57,-3938.69"/>
<polygon fill="black" stroke="black" points="13350.87,-3942.18 13360.55,-3937.88 13350.3,-3935.2 13350.87,-3942.18"/>
</g>
<!-- l0_mha_res_add_gpu13 -->
<g id="node109" class="node">
<title>l0_mha_res_add_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="14935.5,-3634.95 14501.5,-3634.95 14501.5,-3566.95 14935.5,-3566.95 14935.5,-3634.95"/>
<text text-anchor="middle" x="14718.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14718.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14718.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14718.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu13 -->
<g id="edge343" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M9152.06,-4018.06C10204.89,-4012.94 13620.97,-3992.87 13851.5,-3946.95 14162.63,-3884.99 14505.08,-3715.95 14648.88,-3639.91"/>
<polygon fill="black" stroke="black" points="14650.87,-3642.81 14658.06,-3635.03 14647.59,-3636.63 14650.87,-3642.81"/>
</g>
<!-- l0_mha_qkv_gpu14 -->
<g id="node114" class="node">
<title>l0_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="14850,-3946.95 14369,-3946.95 14369,-3878.95 14850,-3878.95 14850,-3946.95"/>
<text text-anchor="middle" x="14609.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14609.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14609.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14609.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu14 -->
<g id="edge365" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M9151.97,-4018.34C9938.27,-4014.82 12091.45,-4000.64 13884.5,-3946.95 14042.08,-3942.23 14218.81,-3934.25 14358.33,-3927.31"/>
<polygon fill="black" stroke="black" points="14358.92,-3930.79 14368.73,-3926.79 14358.57,-3923.79 14358.92,-3930.79"/>
</g>
<!-- l0_mha_res_add_gpu14 -->
<g id="node117" class="node">
<title>l0_mha_res_add_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="15477.5,-3634.95 15043.5,-3634.95 15043.5,-3566.95 15477.5,-3566.95 15477.5,-3634.95"/>
<text text-anchor="middle" x="15260.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15260.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15260.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15260.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu14 -->
<g id="edge369" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M9152.45,-4019.16C10339.7,-4017.66 14578.94,-4008.03 14859.5,-3946.95 14971.1,-3922.66 15006.57,-3915.84 15094.5,-3842.95 15162.02,-3786.98 15213.97,-3696.9 15240.64,-3644.17"/>
<polygon fill="black" stroke="black" points="15243.83,-3645.6 15245.16,-3635.09 15237.57,-3642.48 15243.83,-3645.6"/>
</g>
<!-- l0_mha_qkv_gpu15 -->
<g id="node122" class="node">
<title>l0_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16246,-3946.95 15765,-3946.95 15765,-3878.95 16246,-3878.95 16246,-3946.95"/>
<text text-anchor="middle" x="16005.5" y="-3931.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16005.5" y="-3916.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16005.5" y="-3901.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16005.5" y="-3886.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu15 -->
<g id="edge391" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M9152.37,-4018.72C10063.41,-4016 12831.93,-4003.33 15127.5,-3946.95 15338.98,-3941.76 15579,-3932.51 15754.57,-3925.12"/>
<polygon fill="black" stroke="black" points="15754.88,-3928.61 15764.72,-3924.69 15754.58,-3921.62 15754.88,-3928.61"/>
</g>
<!-- l0_mha_res_add_gpu15 -->
<g id="node125" class="node">
<title>l0_mha_res_add_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17027.5,-3634.95 16593.5,-3634.95 16593.5,-3566.95 17027.5,-3566.95 17027.5,-3634.95"/>
<text text-anchor="middle" x="16810.5" y="-3619.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16810.5" y="-3604.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16810.5" y="-3589.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16810.5" y="-3574.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res_add_gpu15 -->
<g id="edge395" class="edge">
<title>input&#45;&gt;l0_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M9152.33,-4018.68C10529.7,-4015.05 16082.41,-3997.29 16255.5,-3946.95 16467,-3885.45 16676.9,-3718.82 16765.99,-3641.88"/>
<polygon fill="black" stroke="black" points="16768.47,-3644.36 16773.72,-3635.16 16763.88,-3639.08 16768.47,-3644.36"/>
</g>
<!-- l0_mha_attn_gpu0 -->
<g id="node3" class="node">
<title>l0_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2447,-3842.95 1966,-3842.95 1966,-3774.95 2447,-3774.95 2447,-3842.95"/>
<text text-anchor="middle" x="2206.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2206.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2206.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2206.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu0&#45;&gt;l0_mha_attn_gpu0 -->
<g id="edge2" class="edge">
<title>l0_mha_qkv_gpu0&#45;&gt;l0_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M2252.42,-3878.84C2246.66,-3870.2 2240.38,-3860.77 2234.36,-3851.75"/>
<polygon fill="black" stroke="black" points="2237.16,-3849.63 2228.7,-3843.25 2231.33,-3853.51 2237.16,-3849.63"/>
</g>
<!-- l0_mha_out_gpu0 -->
<g id="node4" class="node">
<title>l0_mha_out_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1895,-3738.95 1426,-3738.95 1426,-3670.95 1895,-3670.95 1895,-3738.95"/>
<text text-anchor="middle" x="1660.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1660.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1660.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1660.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu0&#45;&gt;l0_mha_out_gpu0 -->
<g id="edge3" class="edge">
<title>l0_mha_attn_gpu0&#45;&gt;l0_mha_out_gpu0</title>
<path fill="none" stroke="black" d="M2029.61,-3774.91C1971.45,-3764.04 1906.63,-3751.93 1847.74,-3740.93"/>
<polygon fill="black" stroke="black" points="1848.05,-3737.43 1837.58,-3739.03 1846.77,-3744.31 1848.05,-3737.43"/>
</g>
<!-- l0_mha_out_gpu0&#45;&gt;l0_mha_res_add_gpu0 -->
<g id="edge4" class="edge">
<title>l0_mha_out_gpu0&#45;&gt;l0_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M1559.2,-3670.84C1527.22,-3660.38 1491.72,-3648.78 1459.12,-3638.12"/>
<polygon fill="black" stroke="black" points="1460.15,-3634.77 1449.56,-3634.99 1457.97,-3641.43 1460.15,-3634.77"/>
</g>
<!-- l0_expert_0_gpu0 -->
<g id="node6" class="node">
<title>l0_expert_0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="5673.5,-3358.95 5239.5,-3358.95 5239.5,-3290.95 5673.5,-3290.95 5673.5,-3358.95"/>
<text text-anchor="middle" x="5456.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5456.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5456.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5456.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu0&#45;&gt;l0_expert_0_gpu0 -->
<g id="edge8" class="edge">
<title>l0_mha_res_add_gpu0&#45;&gt;l0_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M1131.44,-3596.2C1019.48,-3589.18 899.04,-3571.9 863.5,-3530.95 823.88,-3485.3 821.08,-3438.01 863.5,-3394.95 902.22,-3355.65 4308.52,-3332.72 5229.27,-3327.24"/>
<polygon fill="black" stroke="black" points="5229.34,-3330.74 5239.32,-3327.18 5229.3,-3323.74 5229.34,-3330.74"/>
</g>
<!-- l0_gate_gpu0 -->
<g id="node7" class="node">
<title>l0_gate_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="1824.24,-3530.95 1067.44,-3530.95 872.76,-3394.95 1629.56,-3394.95 1824.24,-3530.95"/>
<text text-anchor="middle" x="1348.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1348.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1348.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1348.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu0&#45;&gt;l0_gate_gpu0 -->
<g id="edge6" class="edge">
<title>l0_mha_res_add_gpu0&#45;&gt;l0_gate_gpu0</title>
<path fill="none" stroke="black" d="M1348.5,-3566.68C1348.5,-3558.86 1348.5,-3550.19 1348.5,-3541.31"/>
<polygon fill="black" stroke="black" points="1352,-3541.22 1348.5,-3531.22 1345,-3541.22 1352,-3541.22"/>
</g>
<!-- l0_res2_gpu0 -->
<g id="node9" class="node">
<title>l0_res2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="993.5,-3082.95 559.5,-3082.95 559.5,-3014.95 993.5,-3014.95 993.5,-3082.95"/>
<text text-anchor="middle" x="776.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="776.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="776.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="776.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu0&#45;&gt;l0_res2_gpu0 -->
<g id="edge26" class="edge">
<title>l0_mha_res_add_gpu0&#45;&gt;l0_res2_gpu0</title>
<path fill="none" stroke="black" d="M1131.35,-3588.6C972.29,-3578 779.9,-3559.47 754.5,-3530.95 643.89,-3406.75 718.5,-3185.07 757.24,-3092.45"/>
<polygon fill="black" stroke="black" points="760.51,-3093.69 761.2,-3083.11 754.07,-3090.95 760.51,-3093.69"/>
</g>
<!-- l0_expert_agg_gpu0 -->
<g id="node8" class="node">
<title>l0_expert_agg_gpu0</title>
<polygon fill="yellow" stroke="black" points="2530.4,-3254.95 1814.71,-3254.95 1630.6,-3118.95 2346.29,-3118.95 2530.4,-3254.95"/>
<text text-anchor="middle" x="2080.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2080.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2080.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2080.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge9" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5239.39,-3320.34C4608.84,-3309.63 2805.33,-3277.42 2539.5,-3254.95 2539.39,-3254.94 2539.29,-3254.94 2539.18,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.5,-3251.44 2529.23,-3254.06 2538.89,-3258.41 2539.5,-3251.44"/>
</g>
<!-- l0_expert_agg_gpu1 -->
<g id="node16" class="node">
<title>l0_expert_agg_gpu1</title>
<polygon fill="yellow" stroke="black" points="3448.4,-3254.95 2732.71,-3254.95 2548.6,-3118.95 3264.29,-3118.95 3448.4,-3254.95"/>
<text text-anchor="middle" x="2998.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2998.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2998.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2998.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge10" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5239.34,-3324.3C4871.75,-3323.12 4103.82,-3313.1 3457.5,-3254.95 3457.39,-3254.94 3457.29,-3254.93 3457.18,-3254.92"/>
<polygon fill="black" stroke="black" points="3457.51,-3251.44 3447.23,-3254.01 3456.87,-3258.41 3457.51,-3251.44"/>
</g>
<!-- l0_expert_agg_gpu2 -->
<g id="node24" class="node">
<title>l0_expert_agg_gpu2</title>
<polygon fill="yellow" stroke="black" points="4366.4,-3254.95 3650.71,-3254.95 3466.6,-3118.95 4182.29,-3118.95 4366.4,-3254.95"/>
<text text-anchor="middle" x="3916.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3916.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3916.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3916.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge11" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5239.43,-3315.28C5020.85,-3305.34 4674.17,-3286.23 4375.5,-3254.95 4375.39,-3254.94 4375.28,-3254.93 4375.17,-3254.92"/>
<polygon fill="black" stroke="black" points="4375.26,-3251.41 4364.95,-3253.83 4374.52,-3258.37 4375.26,-3251.41"/>
</g>
<!-- l0_expert_agg_gpu3 -->
<g id="node32" class="node">
<title>l0_expert_agg_gpu3</title>
<polygon fill="yellow" stroke="black" points="5284.4,-3254.95 4568.71,-3254.95 4384.6,-3118.95 5100.29,-3118.95 5284.4,-3254.95"/>
<text text-anchor="middle" x="4834.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4834.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4834.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4834.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge12" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5305.53,-3290.94C5258.57,-3280.68 5204.91,-3268.94 5151.03,-3257.16"/>
<polygon fill="black" stroke="black" points="5151.48,-3253.68 5140.96,-3254.96 5149.99,-3260.52 5151.48,-3253.68"/>
</g>
<!-- l0_expert_agg_gpu4 -->
<g id="node40" class="node">
<title>l0_expert_agg_gpu4</title>
<polygon fill="yellow" stroke="black" points="6202.4,-3254.95 5486.71,-3254.95 5302.6,-3118.95 6018.29,-3118.95 6202.4,-3254.95"/>
<text text-anchor="middle" x="5752.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5752.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5752.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5752.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge13" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5528.53,-3290.86C5549.55,-3281.2 5573.37,-3270.26 5597.44,-3259.2"/>
<polygon fill="black" stroke="black" points="5599.04,-3262.31 5606.67,-3254.96 5596.12,-3255.95 5599.04,-3262.31"/>
</g>
<!-- l0_expert_agg_gpu5 -->
<g id="node48" class="node">
<title>l0_expert_agg_gpu5</title>
<polygon fill="yellow" stroke="black" points="7120.4,-3254.95 6404.71,-3254.95 6220.6,-3118.95 6936.29,-3118.95 7120.4,-3254.95"/>
<text text-anchor="middle" x="6670.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6670.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6670.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6670.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge14" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M5673.57,-3291.93C5676.57,-3291.6 5679.54,-3291.27 5682.5,-3290.95 5916.82,-3265.91 5977.18,-3279.99 6211.5,-3254.95 6261.71,-3249.59 6314.87,-3242.83 6366.51,-3235.69"/>
<polygon fill="black" stroke="black" points="6367.05,-3239.14 6376.48,-3234.3 6366.09,-3232.21 6367.05,-3239.14"/>
</g>
<!-- l0_expert_agg_gpu6 -->
<g id="node56" class="node">
<title>l0_expert_agg_gpu6</title>
<polygon fill="yellow" stroke="black" points="8038.4,-3254.95 7322.71,-3254.95 7138.6,-3118.95 7854.29,-3118.95 8038.4,-3254.95"/>
<text text-anchor="middle" x="7588.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7588.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7588.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7588.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge15" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M5673.55,-3291.75C5676.55,-3291.47 5679.54,-3291.21 5682.5,-3290.95 6323.49,-3236.38 6488.51,-3309.51 7129.5,-3254.95 7180.48,-3250.61 7234.42,-3244.3 7286.72,-3237.26"/>
<polygon fill="black" stroke="black" points="7287.37,-3240.71 7296.81,-3235.9 7286.43,-3233.77 7287.37,-3240.71"/>
</g>
<!-- l0_expert_agg_gpu7 -->
<g id="node64" class="node">
<title>l0_expert_agg_gpu7</title>
<polygon fill="yellow" stroke="black" points="8956.4,-3254.95 8240.71,-3254.95 8056.6,-3118.95 8772.29,-3118.95 8956.4,-3254.95"/>
<text text-anchor="middle" x="8506.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8506.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8506.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8506.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge16" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M5673.55,-3291.71C5676.55,-3291.44 5679.54,-3291.19 5682.5,-3290.95 6730.36,-3206.83 6999.64,-3339.05 8047.5,-3254.95 8098.59,-3250.85 8152.65,-3244.65 8205.05,-3237.64"/>
<polygon fill="black" stroke="black" points="8205.71,-3241.09 8215.15,-3236.28 8204.77,-3234.15 8205.71,-3241.09"/>
</g>
<!-- l0_expert_agg_gpu8 -->
<g id="node72" class="node">
<title>l0_expert_agg_gpu8</title>
<polygon fill="yellow" stroke="black" points="9874.4,-3254.95 9158.71,-3254.95 8974.6,-3118.95 9690.29,-3118.95 9874.4,-3254.95"/>
<text text-anchor="middle" x="9424.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9424.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9424.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9424.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge17" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M5673.55,-3291.69C5676.55,-3291.43 5679.54,-3291.18 5682.5,-3290.95 6409.88,-3234.12 8238.12,-3311.77 8965.5,-3254.95 9016.7,-3250.95 9070.86,-3244.79 9123.35,-3237.79"/>
<polygon fill="black" stroke="black" points="9124.03,-3241.23 9133.48,-3236.42 9123.1,-3234.29 9124.03,-3241.23"/>
</g>
<!-- l0_expert_agg_gpu9 -->
<g id="node80" class="node">
<title>l0_expert_agg_gpu9</title>
<polygon fill="yellow" stroke="black" points="10792.4,-3254.95 10076.71,-3254.95 9892.6,-3118.95 10608.29,-3118.95 10792.4,-3254.95"/>
<text text-anchor="middle" x="10342.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10342.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10342.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10342.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge18" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M5673.55,-3291.68C5676.55,-3291.42 5679.53,-3291.18 5682.5,-3290.95 6613.34,-3219.34 8952.66,-3326.54 9883.5,-3254.95 9934.7,-3251.02 9988.87,-3244.88 10041.36,-3237.89"/>
<polygon fill="black" stroke="black" points="10042.04,-3241.33 10051.48,-3236.53 10041.11,-3234.39 10042.04,-3241.33"/>
</g>
<!-- l0_expert_agg_gpu10 -->
<g id="node88" class="node">
<title>l0_expert_agg_gpu10</title>
<polygon fill="yellow" stroke="black" points="11710.4,-3254.95 10994.71,-3254.95 10810.6,-3118.95 11526.29,-3118.95 11710.4,-3254.95"/>
<text text-anchor="middle" x="11260.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11260.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11260.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11260.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge19" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M5673.55,-3291.68C5676.55,-3291.42 5679.53,-3291.18 5682.5,-3290.95 6816.8,-3204.57 9667.2,-3341.31 10801.5,-3254.95 10852.8,-3251.05 10907.08,-3244.92 10959.65,-3237.92"/>
<polygon fill="black" stroke="black" points="10960.35,-3241.36 10969.8,-3236.56 10959.42,-3234.42 10960.35,-3241.36"/>
</g>
<!-- l0_expert_agg_gpu11 -->
<g id="node96" class="node">
<title>l0_expert_agg_gpu11</title>
<polygon fill="yellow" stroke="black" points="12628.4,-3254.95 11912.71,-3254.95 11728.6,-3118.95 12444.29,-3118.95 12628.4,-3254.95"/>
<text text-anchor="middle" x="12178.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12178.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12178.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12178.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge20" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M5673.55,-3291.67C5676.55,-3291.42 5679.53,-3291.18 5682.5,-3290.95 7020.26,-3189.79 10381.74,-3356.09 11719.5,-3254.95 11770.8,-3251.08 11825.08,-3244.96 11877.66,-3237.97"/>
<polygon fill="black" stroke="black" points="11878.35,-3241.4 11887.8,-3236.6 11877.42,-3234.47 11878.35,-3241.4"/>
</g>
<!-- l0_expert_agg_gpu12 -->
<g id="node104" class="node">
<title>l0_expert_agg_gpu12</title>
<polygon fill="yellow" stroke="black" points="13546.4,-3254.95 12830.71,-3254.95 12646.6,-3118.95 13362.29,-3118.95 13546.4,-3254.95"/>
<text text-anchor="middle" x="13096.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13096.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13096.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13096.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge21" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M5673.55,-3291.67C5676.55,-3291.41 5679.53,-3291.18 5682.5,-3290.95 6453.11,-3232.98 11866.89,-3312.91 12637.5,-3254.95 12688.8,-3251.1 12743.08,-3244.99 12795.66,-3238"/>
<polygon fill="black" stroke="black" points="12796.36,-3241.44 12805.8,-3236.64 12795.43,-3234.5 12796.36,-3241.44"/>
</g>
<!-- l0_expert_agg_gpu13 -->
<g id="node112" class="node">
<title>l0_expert_agg_gpu13</title>
<polygon fill="yellow" stroke="black" points="14464.4,-3254.95 13748.71,-3254.95 13564.6,-3118.95 14280.29,-3118.95 14464.4,-3254.95"/>
<text text-anchor="middle" x="14014.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14014.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14014.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14014.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge22" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M5673.55,-3291.66C5676.55,-3291.41 5679.53,-3291.18 5682.5,-3290.95 6554.84,-3225.6 12683.16,-3320.29 13555.5,-3254.95 13606.8,-3251.11 13661.08,-3245.01 13713.66,-3238.03"/>
<polygon fill="black" stroke="black" points="13714.36,-3241.46 13723.8,-3236.67 13713.43,-3234.53 13714.36,-3241.46"/>
</g>
<!-- l0_expert_agg_gpu14 -->
<g id="node120" class="node">
<title>l0_expert_agg_gpu14</title>
<polygon fill="yellow" stroke="black" points="15382.4,-3254.95 14666.71,-3254.95 14482.6,-3118.95 15198.29,-3118.95 15382.4,-3254.95"/>
<text text-anchor="middle" x="14932.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14932.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14932.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14932.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge23" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M5673.55,-3291.66C5676.55,-3291.41 5679.53,-3291.17 5682.5,-3290.95 6656.57,-3218.21 13499.42,-3327.68 14473.5,-3254.95 14524.8,-3251.12 14579.08,-3245.03 14631.66,-3238.05"/>
<polygon fill="black" stroke="black" points="14632.36,-3241.49 14641.81,-3236.69 14631.43,-3234.55 14632.36,-3241.49"/>
</g>
<!-- l0_expert_agg_gpu15 -->
<g id="node128" class="node">
<title>l0_expert_agg_gpu15</title>
<polygon fill="yellow" stroke="black" points="16300.4,-3254.95 15584.71,-3254.95 15400.6,-3118.95 16116.29,-3118.95 16300.4,-3254.95"/>
<text text-anchor="middle" x="15850.5" y="-3205.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15850.5" y="-3190.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="15850.5" y="-3175.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15850.5" y="-3160.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge24" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M5673.55,-3291.66C5676.55,-3291.41 5679.53,-3291.17 5682.5,-3290.95 6758.3,-3210.82 14315.69,-3335.06 15391.5,-3254.95 15442.8,-3251.13 15497.09,-3245.05 15549.66,-3238.06"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.5 15559.81,-3236.7 15549.43,-3234.56 15550.36,-3241.5"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_0_gpu0 -->
<g id="edge7" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1660.99,-3416.69C1731.72,-3408.01 1806.58,-3400.05 1876.5,-3394.95 2532.24,-3347.17 4548.57,-3331.24 5229.31,-3327.15"/>
<polygon fill="black" stroke="black" points="5229.5,-3330.65 5239.48,-3327.09 5229.46,-3323.65 5229.5,-3330.65"/>
</g>
<!-- l0_expert_agg_gpu0&#45;&gt;l0_res2_gpu0 -->
<g id="edge25" class="edge">
<title>l0_expert_agg_gpu0&#45;&gt;l0_res2_gpu0</title>
<path fill="none" stroke="black" d="M1662.08,-3142.31C1443.68,-3119.54 1185,-3092.56 1003.79,-3073.66"/>
<polygon fill="black" stroke="black" points="1003.91,-3070.15 993.6,-3072.6 1003.18,-3077.11 1003.91,-3070.15"/>
</g>
<!-- l1_mha_qkv_gpu0 -->
<g id="node130" class="node">
<title>l1_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="771,-2978.95 290,-2978.95 290,-2910.95 771,-2910.95 771,-2978.95"/>
<text text-anchor="middle" x="530.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="530.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="530.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="530.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu0&#45;&gt;l1_mha_qkv_gpu0 -->
<g id="edge417" class="edge">
<title>l0_res2_gpu0&#45;&gt;l1_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M696.63,-3014.84C672.12,-3004.68 645,-2993.43 619.9,-2983.02"/>
<polygon fill="black" stroke="black" points="620.97,-2979.68 610.39,-2979.08 618.29,-2986.14 620.97,-2979.68"/>
</g>
<!-- l1_mha_res_add_gpu0 -->
<g id="node133" class="node">
<title>l1_mha_res_add_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="761.5,-2666.95 327.5,-2666.95 327.5,-2598.95 761.5,-2598.95 761.5,-2666.95"/>
<text text-anchor="middle" x="544.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="544.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="544.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="544.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu0&#45;&gt;l1_mha_res_add_gpu0 -->
<g id="edge421" class="edge">
<title>l0_res2_gpu0&#45;&gt;l1_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M788.46,-3014.81C810.23,-2948.04 847.86,-2795.8 776.5,-2702.95 766.91,-2690.48 743.08,-2679.39 714.15,-2669.96"/>
<polygon fill="black" stroke="black" points="715.18,-2666.61 704.59,-2666.95 713.08,-2673.29 715.18,-2666.61"/>
</g>
<!-- l0_mha_attn_gpu1 -->
<g id="node11" class="node">
<title>l0_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3394,-3842.95 2913,-3842.95 2913,-3774.95 3394,-3774.95 3394,-3842.95"/>
<text text-anchor="middle" x="3153.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3153.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3153.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3153.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu1&#45;&gt;l0_mha_attn_gpu1 -->
<g id="edge28" class="edge">
<title>l0_mha_qkv_gpu1&#45;&gt;l0_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M3199.42,-3878.84C3193.66,-3870.2 3187.38,-3860.77 3181.36,-3851.75"/>
<polygon fill="black" stroke="black" points="3184.16,-3849.63 3175.7,-3843.25 3178.33,-3853.51 3184.16,-3849.63"/>
</g>
<!-- l0_mha_out_gpu1 -->
<g id="node12" class="node">
<title>l0_mha_out_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3351,-3738.95 2882,-3738.95 2882,-3670.95 3351,-3670.95 3351,-3738.95"/>
<text text-anchor="middle" x="3116.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3116.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3116.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3116.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu1&#45;&gt;l0_mha_out_gpu1 -->
<g id="edge29" class="edge">
<title>l0_mha_attn_gpu1&#45;&gt;l0_mha_out_gpu1</title>
<path fill="none" stroke="black" d="M3141.49,-3774.84C3138.48,-3766.55 3135.22,-3757.55 3132.07,-3748.86"/>
<polygon fill="black" stroke="black" points="3135.28,-3747.46 3128.58,-3739.25 3128.7,-3749.85 3135.28,-3747.46"/>
</g>
<!-- l0_mha_out_gpu1&#45;&gt;l0_mha_res_add_gpu1 -->
<g id="edge30" class="edge">
<title>l0_mha_out_gpu1&#45;&gt;l0_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M2894.9,-3670.91C2819.65,-3659.69 2735.49,-3647.14 2659.81,-3635.85"/>
<polygon fill="black" stroke="black" points="2660.07,-3632.35 2649.66,-3634.34 2659.04,-3639.27 2660.07,-3632.35"/>
</g>
<!-- l0_expert_1_gpu1 -->
<g id="node14" class="node">
<title>l0_expert_1_gpu1</title>
<polygon fill="lightpink" stroke="black" points="6125.5,-3358.95 5691.5,-3358.95 5691.5,-3290.95 6125.5,-3290.95 6125.5,-3358.95"/>
<text text-anchor="middle" x="5908.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5908.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5908.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5908.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu1&#45;&gt;l0_expert_1_gpu1 -->
<g id="edge34" class="edge">
<title>l0_mha_res_add_gpu1&#45;&gt;l0_expert_1_gpu1</title>
<path fill="none" stroke="black" d="M2215.44,-3596.2C2103.48,-3589.18 1983.04,-3571.9 1947.5,-3530.95 1907.88,-3485.3 1904.97,-3437.9 1947.5,-3394.95 1983.15,-3358.96 5461.82,-3362.76 5681.37,-3358.54"/>
<polygon fill="black" stroke="black" points="5681.57,-3362.03 5691.45,-3358.22 5681.35,-3355.04 5681.57,-3362.03"/>
</g>
<!-- l0_gate_gpu1 -->
<g id="node15" class="node">
<title>l0_gate_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="2908.24,-3530.95 2151.44,-3530.95 1956.76,-3394.95 2713.56,-3394.95 2908.24,-3530.95"/>
<text text-anchor="middle" x="2432.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2432.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2432.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2432.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu1&#45;&gt;l0_gate_gpu1 -->
<g id="edge32" class="edge">
<title>l0_mha_res_add_gpu1&#45;&gt;l0_gate_gpu1</title>
<path fill="none" stroke="black" d="M2432.5,-3566.68C2432.5,-3558.86 2432.5,-3550.19 2432.5,-3541.31"/>
<polygon fill="black" stroke="black" points="2436,-3541.22 2432.5,-3531.22 2429,-3541.22 2436,-3541.22"/>
</g>
<!-- l0_res2_gpu1 -->
<g id="node17" class="node">
<title>l0_res2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="1843.5,-3082.95 1409.5,-3082.95 1409.5,-3014.95 1843.5,-3014.95 1843.5,-3082.95"/>
<text text-anchor="middle" x="1626.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1626.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1626.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1626.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu1&#45;&gt;l0_res2_gpu1 -->
<g id="edge52" class="edge">
<title>l0_mha_res_add_gpu1&#45;&gt;l0_res2_gpu1</title>
<path fill="none" stroke="black" d="M2215.32,-3591.55C1778.9,-3574.55 836.42,-3537.13 830.5,-3530.95 703.84,-3398.72 706.74,-3253.91 830.5,-3118.95 849.71,-3098 1170.75,-3075.59 1399.17,-3062.18"/>
<polygon fill="black" stroke="black" points="1399.51,-3065.66 1409.29,-3061.59 1399.1,-3058.68 1399.51,-3065.66"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge35" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5691.45,-3291.69C5688.45,-3291.43 5685.46,-3291.19 5682.5,-3290.95 4986.15,-3236.37 3235.86,-3309.52 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.78,-3251.47 2529.53,-3254.15 2539.21,-3258.44 2539.78,-3251.47"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge36" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5691.45,-3291.71C5688.45,-3291.45 5685.46,-3291.19 5682.5,-3290.95 4696.69,-3211.34 4443.31,-3334.54 3457.5,-3254.95 3457.4,-3254.94 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.79,-3251.47 3447.53,-3254.13 3457.21,-3258.44 3457.79,-3251.47"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge37" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5691.45,-3291.76C5688.45,-3291.48 5685.46,-3291.21 5682.5,-3290.95 5103.55,-3240.89 4954.45,-3305.01 4375.5,-3254.95 4375.39,-3254.94 4375.29,-3254.93 4375.18,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.5,-3251.44 4365.23,-3254.04 4374.88,-3258.41 4375.5,-3251.44"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge38" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5691.42,-3292.03C5688.43,-3291.67 5685.45,-3291.31 5682.5,-3290.95 5510.09,-3270.4 5465.91,-3275.5 5293.5,-3254.95 5293.28,-3254.93 5293.05,-3254.9 5292.83,-3254.87"/>
<polygon fill="black" stroke="black" points="5293.01,-3251.37 5282.66,-3253.65 5292.17,-3258.32 5293.01,-3251.37"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge39" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5870.34,-3290.68C5860.2,-3281.85 5848.84,-3271.94 5837.27,-3261.86"/>
<polygon fill="black" stroke="black" points="5839.49,-3259.15 5829.65,-3255.22 5834.89,-3264.43 5839.49,-3259.15"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge40" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6093.45,-3290.94C6177.47,-3275.95 6278.98,-3257.83 6373.29,-3241"/>
<polygon fill="black" stroke="black" points="6374.04,-3244.42 6383.27,-3239.22 6372.81,-3237.53 6374.04,-3244.42"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge41" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6125.56,-3291.8C6128.56,-3291.5 6131.54,-3291.22 6134.5,-3290.95 6575.2,-3250.93 6688.8,-3294.97 7129.5,-3254.95 7180.26,-3250.34 7233.99,-3243.92 7286.1,-3236.86"/>
<polygon fill="black" stroke="black" points="7286.72,-3240.3 7296.15,-3235.48 7285.77,-3233.37 7286.72,-3240.3"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge42" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6125.55,-3291.72C6128.55,-3291.45 6131.54,-3291.2 6134.5,-3290.95 6982.02,-3221.38 7199.98,-3324.51 8047.5,-3254.95 8098.59,-3250.76 8152.64,-3244.51 8205.03,-3237.49"/>
<polygon fill="black" stroke="black" points="8205.7,-3240.93 8215.14,-3236.12 8204.76,-3233.99 8205.7,-3240.93"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge43" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6125.55,-3291.7C6128.55,-3291.44 6131.54,-3291.19 6134.5,-3290.95 7388.91,-3191.83 7711.08,-3354.05 8965.5,-3254.95 9016.69,-3250.91 9070.86,-3244.72 9123.34,-3237.71"/>
<polygon fill="black" stroke="black" points="9124.03,-3241.15 9133.47,-3236.35 9123.09,-3234.22 9124.03,-3241.15"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge44" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6125.55,-3291.69C6128.55,-3291.43 6131.53,-3291.18 6134.5,-3290.95 6965.16,-3226.62 9052.84,-3319.27 9883.5,-3254.95 9934.7,-3250.99 9988.87,-3244.84 10041.35,-3237.85"/>
<polygon fill="black" stroke="black" points="10042.04,-3241.29 10051.48,-3236.48 10041.1,-3234.35 10042.04,-3241.29"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge45" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6125.55,-3291.68C6128.55,-3291.42 6131.53,-3291.18 6134.5,-3290.95 7168.62,-3211.84 9767.38,-3334.04 10801.5,-3254.95 10852.7,-3251.04 10906.87,-3244.92 10959.36,-3237.93"/>
<polygon fill="black" stroke="black" points="10960.04,-3241.37 10969.49,-3236.57 10959.11,-3234.43 10960.04,-3241.37"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge46" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6125.55,-3291.67C6128.55,-3291.42 6131.53,-3291.18 6134.5,-3290.95 7372.08,-3197.06 10481.92,-3348.81 11719.5,-3254.95 11770.8,-3251.06 11825.08,-3244.94 11877.65,-3237.95"/>
<polygon fill="black" stroke="black" points="11878.35,-3241.38 11887.8,-3236.58 11877.42,-3234.45 11878.35,-3241.38"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge47" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6125.55,-3291.67C6128.55,-3291.42 6131.53,-3291.18 6134.5,-3290.95 6855.02,-3236.62 11916.98,-3309.27 12637.5,-3254.95 12688.8,-3251.09 12743.08,-3244.98 12795.66,-3237.99"/>
<polygon fill="black" stroke="black" points="12796.36,-3241.42 12805.8,-3236.62 12795.42,-3234.49 12796.36,-3241.42"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge48" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6125.55,-3291.67C6128.55,-3291.41 6131.53,-3291.18 6134.5,-3290.95 6956.75,-3229.23 12733.25,-3316.65 13555.5,-3254.95 13606.8,-3251.1 13661.08,-3245 13713.66,-3238.01"/>
<polygon fill="black" stroke="black" points="13714.36,-3241.45 13723.8,-3236.65 13713.43,-3234.51 13714.36,-3241.45"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge49" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6125.55,-3291.66C6128.55,-3291.41 6131.53,-3291.18 6134.5,-3290.95 7058.48,-3221.84 13549.52,-3324.04 14473.5,-3254.95 14524.8,-3251.12 14579.08,-3245.02 14631.66,-3238.04"/>
<polygon fill="black" stroke="black" points="14632.36,-3241.48 14641.81,-3236.68 14631.43,-3234.54 14632.36,-3241.48"/>
</g>
<!-- l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge50" class="edge">
<title>l0_expert_1_gpu1&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6125.55,-3291.66C6128.55,-3291.41 6131.53,-3291.17 6134.5,-3290.95 7160.21,-3214.46 14365.78,-3331.43 15391.5,-3254.95 15442.8,-3251.13 15497.09,-3245.04 15549.66,-3238.06"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.49 15559.81,-3236.7 15549.43,-3234.56 15550.36,-3241.49"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_1_gpu1 -->
<g id="edge33" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2744.62,-3416.42C2815.45,-3407.74 2890.45,-3399.85 2960.5,-3394.95 4164.06,-3310.9 4474.66,-3453.76 5681.24,-3359.01"/>
<polygon fill="black" stroke="black" points="5681.76,-3362.48 5691.45,-3358.21 5681.21,-3355.5 5681.76,-3362.48"/>
</g>
<!-- l0_expert_agg_gpu1&#45;&gt;l0_res2_gpu1 -->
<g id="edge51" class="edge">
<title>l0_expert_agg_gpu1&#45;&gt;l0_res2_gpu1</title>
<path fill="none" stroke="black" d="M2550.05,-3120.13C2546.52,-3119.73 2543,-3119.34 2539.5,-3118.95 2306.4,-3093.16 2038.74,-3074.18 1853.77,-3062.73"/>
<polygon fill="black" stroke="black" points="1853.84,-3059.23 1843.65,-3062.1 1853.41,-3066.21 1853.84,-3059.23"/>
</g>
<!-- l1_mha_qkv_gpu1 -->
<g id="node138" class="node">
<title>l1_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1733,-2978.95 1252,-2978.95 1252,-2910.95 1733,-2910.95 1733,-2978.95"/>
<text text-anchor="middle" x="1492.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1492.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1492.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1492.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu1&#45;&gt;l1_mha_qkv_gpu1 -->
<g id="edge443" class="edge">
<title>l0_res2_gpu1&#45;&gt;l1_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1582.99,-3014.84C1570.71,-3005.48 1557.21,-2995.21 1544.48,-2985.52"/>
<polygon fill="black" stroke="black" points="1546.32,-2982.52 1536.25,-2979.25 1542.08,-2988.09 1546.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu1 -->
<g id="node141" class="node">
<title>l1_mha_res_add_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="1845.5,-2666.95 1411.5,-2666.95 1411.5,-2598.95 1845.5,-2598.95 1845.5,-2666.95"/>
<text text-anchor="middle" x="1628.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1628.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1628.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1628.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu1&#45;&gt;l1_mha_res_add_gpu1 -->
<g id="edge447" class="edge">
<title>l0_res2_gpu1&#45;&gt;l1_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M1706.53,-3014.87C1720.53,-3005.38 1733.24,-2993.54 1741.5,-2978.95 1801.94,-2872.2 1799.42,-2809.43 1738.5,-2702.95 1731.9,-2691.41 1722.5,-2681.53 1711.95,-2673.15"/>
<polygon fill="black" stroke="black" points="1713.8,-2670.17 1703.68,-2667.03 1709.64,-2675.8 1713.8,-2670.17"/>
</g>
<!-- l0_mha_attn_gpu2 -->
<g id="node19" class="node">
<title>l0_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4034,-3842.95 3553,-3842.95 3553,-3774.95 4034,-3774.95 4034,-3842.95"/>
<text text-anchor="middle" x="3793.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3793.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3793.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3793.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu2&#45;&gt;l0_mha_attn_gpu2 -->
<g id="edge54" class="edge">
<title>l0_mha_qkv_gpu2&#45;&gt;l0_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M3838.07,-3878.84C3832.48,-3870.2 3826.38,-3860.77 3820.54,-3851.75"/>
<polygon fill="black" stroke="black" points="3823.42,-3849.75 3815.05,-3843.25 3817.54,-3853.55 3823.42,-3849.75"/>
</g>
<!-- l0_mha_out_gpu2 -->
<g id="node20" class="node">
<title>l0_mha_out_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4008,-3738.95 3539,-3738.95 3539,-3670.95 4008,-3670.95 4008,-3738.95"/>
<text text-anchor="middle" x="3773.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3773.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3773.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3773.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu2&#45;&gt;l0_mha_out_gpu2 -->
<g id="edge55" class="edge">
<title>l0_mha_attn_gpu2&#45;&gt;l0_mha_out_gpu2</title>
<path fill="none" stroke="black" d="M3787.01,-3774.84C3785.4,-3766.64 3783.65,-3757.74 3781.97,-3749.15"/>
<polygon fill="black" stroke="black" points="3785.39,-3748.39 3780.03,-3739.25 3778.52,-3749.74 3785.39,-3748.39"/>
</g>
<!-- l0_mha_out_gpu2&#45;&gt;l0_mha_res_add_gpu2 -->
<g id="edge56" class="edge">
<title>l0_mha_out_gpu2&#45;&gt;l0_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M3690.06,-3670.84C3664.34,-3660.63 3635.87,-3649.33 3609.55,-3638.88"/>
<polygon fill="black" stroke="black" points="3610.55,-3635.51 3599.96,-3635.08 3607.96,-3642.02 3610.55,-3635.51"/>
</g>
<!-- l0_expert_2_gpu2 -->
<g id="node22" class="node">
<title>l0_expert_2_gpu2</title>
<polygon fill="lightpink" stroke="black" points="6577.5,-3358.95 6143.5,-3358.95 6143.5,-3290.95 6577.5,-3290.95 6577.5,-3358.95"/>
<text text-anchor="middle" x="6360.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6360.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6360.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6360.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu2&#45;&gt;l0_expert_2_gpu2 -->
<g id="edge60" class="edge">
<title>l0_mha_res_add_gpu2&#45;&gt;l0_expert_2_gpu2</title>
<path fill="none" stroke="black" d="M3299.44,-3596.2C3187.48,-3589.18 3067.04,-3571.9 3031.5,-3530.95 2991.88,-3485.3 2989.01,-3437.94 3031.5,-3394.95 3061,-3365.11 5933.85,-3362.45 6133.24,-3358.53"/>
<polygon fill="black" stroke="black" points="6133.57,-3362.03 6143.45,-3358.21 6133.35,-3355.03 6133.57,-3362.03"/>
</g>
<!-- l0_gate_gpu2 -->
<g id="node23" class="node">
<title>l0_gate_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="3992.24,-3530.95 3235.44,-3530.95 3040.76,-3394.95 3797.56,-3394.95 3992.24,-3530.95"/>
<text text-anchor="middle" x="3516.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3516.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3516.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3516.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu2&#45;&gt;l0_gate_gpu2 -->
<g id="edge58" class="edge">
<title>l0_mha_res_add_gpu2&#45;&gt;l0_gate_gpu2</title>
<path fill="none" stroke="black" d="M3516.5,-3566.68C3516.5,-3558.86 3516.5,-3550.19 3516.5,-3541.31"/>
<polygon fill="black" stroke="black" points="3520,-3541.22 3516.5,-3531.22 3513,-3541.22 3520,-3541.22"/>
</g>
<!-- l0_res2_gpu2 -->
<g id="node25" class="node">
<title>l0_res2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="2927.5,-3082.95 2493.5,-3082.95 2493.5,-3014.95 2927.5,-3014.95 2927.5,-3082.95"/>
<text text-anchor="middle" x="2710.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2710.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2710.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2710.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu2&#45;&gt;l0_res2_gpu2 -->
<g id="edge78" class="edge">
<title>l0_mha_res_add_gpu2&#45;&gt;l0_res2_gpu2</title>
<path fill="none" stroke="black" d="M3299.23,-3590.49C3125.8,-3583.21 2876.61,-3573.33 2658.5,-3566.95 2608.65,-3565.49 898.41,-3566.57 863.5,-3530.95 697.25,-3361.33 1068.25,-3213.57 1436.5,-3118.95 1534.7,-3093.72 2144.07,-3069.29 2483.22,-3057.42"/>
<polygon fill="black" stroke="black" points="2483.55,-3060.91 2493.43,-3057.06 2483.31,-3053.91 2483.55,-3060.91"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge61" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6143.45,-3291.69C6140.45,-3291.43 6137.46,-3291.18 6134.5,-3290.95 5337.97,-3229.1 3336.03,-3316.79 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.78,-3251.47 2529.53,-3254.15 2539.22,-3258.44 2539.78,-3251.47"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge62" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6143.45,-3291.7C6140.45,-3291.44 6137.46,-3291.19 6134.5,-3290.95 4948.35,-3196.79 4643.66,-3349.09 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.78,-3251.47 3447.53,-3254.14 3457.21,-3258.44 3457.78,-3251.47"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge63" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6143.45,-3291.73C6140.45,-3291.46 6137.46,-3291.2 6134.5,-3290.95 5355.23,-3226.34 5154.77,-3319.55 4375.5,-3254.95 4375.39,-3254.94 4375.29,-3254.94 4375.18,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.49,-3251.44 4365.23,-3254.08 4374.9,-3258.42 4375.49,-3251.44"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge64" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6143.44,-3291.82C6140.44,-3291.52 6137.46,-3291.23 6134.5,-3290.95 5762.03,-3255.88 5665.97,-3290.02 5293.5,-3254.95 5293.39,-3254.94 5293.29,-3254.93 5293.18,-3254.92"/>
<polygon fill="black" stroke="black" points="5293.53,-3251.44 5283.24,-3253.97 5292.86,-3258.41 5293.53,-3251.44"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge65" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6212.93,-3290.94C6167.02,-3280.68 6114.57,-3268.94 6061.9,-3257.16"/>
<polygon fill="black" stroke="black" points="6062.59,-3253.73 6052.07,-3254.96 6061.06,-3260.56 6062.59,-3253.73"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge66" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6435.94,-3290.86C6458.05,-3281.16 6483.11,-3270.16 6508.44,-3259.05"/>
<polygon fill="black" stroke="black" points="6510.02,-3262.18 6517.77,-3254.96 6507.21,-3255.77 6510.02,-3262.18"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge67" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6577.57,-3291.92C6580.56,-3291.59 6583.54,-3291.27 6586.5,-3290.95 6827.02,-3265.46 6888.98,-3280.44 7129.5,-3254.95 7179.81,-3249.62 7233.08,-3242.87 7284.81,-3235.72"/>
<polygon fill="black" stroke="black" points="7285.37,-3239.18 7294.79,-3234.33 7284.41,-3232.24 7285.37,-3239.18"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge68" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6577.55,-3291.75C6580.55,-3291.47 6583.54,-3291.21 6586.5,-3290.95 7233.7,-3235.93 7400.3,-3309.96 8047.5,-3254.95 8098.48,-3250.62 8152.42,-3244.31 8204.72,-3237.27"/>
<polygon fill="black" stroke="black" points="8205.37,-3240.72 8214.81,-3235.91 8204.43,-3233.78 8205.37,-3240.72"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge69" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6577.55,-3291.71C6580.55,-3291.44 6583.54,-3291.19 6586.5,-3290.95 7640.57,-3206.38 7911.43,-3339.5 8965.5,-3254.95 9016.59,-3250.86 9070.65,-3244.65 9123.05,-3237.65"/>
<polygon fill="black" stroke="black" points="9123.71,-3241.09 9133.15,-3236.28 9122.78,-3234.15 9123.71,-3241.09"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge70" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6577.55,-3291.69C6580.55,-3291.43 6583.54,-3291.18 6586.5,-3290.95 7316.99,-3233.89 9153.01,-3312 9883.5,-3254.95 9934.7,-3250.96 9988.86,-3244.79 10041.35,-3237.79"/>
<polygon fill="black" stroke="black" points="10042.03,-3241.23 10051.48,-3236.43 10041.1,-3234.29 10042.03,-3241.23"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge71" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6577.55,-3291.68C6580.55,-3291.42 6583.53,-3291.18 6586.5,-3290.95 7520.44,-3219.12 9867.56,-3326.77 10801.5,-3254.95 10852.7,-3251.02 10906.87,-3244.88 10959.36,-3237.89"/>
<polygon fill="black" stroke="black" points="10960.04,-3241.33 10969.48,-3236.53 10959.11,-3234.4 10960.04,-3241.33"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge72" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6577.55,-3291.67C6580.55,-3291.42 6583.53,-3291.18 6586.5,-3290.95 7723.9,-3204.34 10582.1,-3341.54 11719.5,-3254.95 11770.8,-3251.05 11825.08,-3244.92 11877.65,-3237.92"/>
<polygon fill="black" stroke="black" points="11878.35,-3241.36 11887.8,-3236.56 11877.42,-3234.42 11878.35,-3241.36"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge73" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6577.55,-3291.67C6580.55,-3291.42 6583.53,-3291.18 6586.5,-3290.95 7927.36,-3189.56 11296.63,-3356.31 12637.5,-3254.95 12688.8,-3251.08 12743.08,-3244.96 12795.66,-3237.97"/>
<polygon fill="black" stroke="black" points="12796.35,-3241.4 12805.8,-3236.6 12795.42,-3234.47 12796.35,-3241.4"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge74" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6577.55,-3291.67C6580.55,-3291.41 6583.53,-3291.18 6586.5,-3290.95 7358.66,-3232.87 12783.34,-3313.02 13555.5,-3254.95 13606.8,-3251.1 13661.08,-3244.99 13713.66,-3238"/>
<polygon fill="black" stroke="black" points="13714.36,-3241.44 13723.8,-3236.64 13713.43,-3234.5 13714.36,-3241.44"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge75" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6577.55,-3291.66C6580.55,-3291.41 6583.53,-3291.18 6586.5,-3290.95 7460.39,-3225.48 13599.61,-3320.4 14473.5,-3254.95 14524.8,-3251.11 14579.08,-3245.01 14631.66,-3238.03"/>
<polygon fill="black" stroke="black" points="14632.36,-3241.47 14641.8,-3236.67 14631.43,-3234.53 14632.36,-3241.47"/>
</g>
<!-- l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge76" class="edge">
<title>l0_expert_2_gpu2&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6577.55,-3291.66C6580.55,-3291.41 6583.53,-3291.17 6586.5,-3290.95 7562.12,-3218.09 14415.87,-3327.79 15391.5,-3254.95 15442.8,-3251.12 15497.08,-3245.03 15549.66,-3238.05"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.49 15559.81,-3236.69 15549.43,-3234.55 15550.36,-3241.49"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_2_gpu2 -->
<g id="edge59" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3824.99,-3414.09C3885.06,-3406.38 3947.64,-3399.46 4006.5,-3394.95 4946.31,-3323.01 5189.96,-3434.65 6133.37,-3359"/>
<polygon fill="black" stroke="black" points="6133.76,-3362.48 6143.45,-3358.19 6133.2,-3355.51 6133.76,-3362.48"/>
</g>
<!-- l0_expert_agg_gpu2&#45;&gt;l0_res2_gpu2 -->
<g id="edge77" class="edge">
<title>l0_expert_agg_gpu2&#45;&gt;l0_res2_gpu2</title>
<path fill="none" stroke="black" d="M3468.34,-3120.26C3464.71,-3119.82 3461.1,-3119.38 3457.5,-3118.95 3283.51,-3098.23 3086.09,-3080.24 2937.92,-3067.82"/>
<polygon fill="black" stroke="black" points="2938.04,-3064.32 2927.78,-3066.97 2937.46,-3071.29 2938.04,-3064.32"/>
</g>
<!-- l1_mha_qkv_gpu2 -->
<g id="node146" class="node">
<title>l1_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2817,-2978.95 2336,-2978.95 2336,-2910.95 2817,-2910.95 2817,-2978.95"/>
<text text-anchor="middle" x="2576.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2576.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2576.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2576.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu2&#45;&gt;l1_mha_qkv_gpu2 -->
<g id="edge469" class="edge">
<title>l0_res2_gpu2&#45;&gt;l1_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2666.99,-3014.84C2654.71,-3005.48 2641.21,-2995.21 2628.48,-2985.52"/>
<polygon fill="black" stroke="black" points="2630.32,-2982.52 2620.25,-2979.25 2626.08,-2988.09 2630.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu2 -->
<g id="node149" class="node">
<title>l1_mha_res_add_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="2929.5,-2666.95 2495.5,-2666.95 2495.5,-2598.95 2929.5,-2598.95 2929.5,-2666.95"/>
<text text-anchor="middle" x="2712.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2712.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2712.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2712.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu2&#45;&gt;l1_mha_res_add_gpu2 -->
<g id="edge473" class="edge">
<title>l0_res2_gpu2&#45;&gt;l1_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M2791.5,-3014.79C2805.51,-3005.33 2818.22,-2993.52 2826.5,-2978.95 2887.15,-2872.31 2883.94,-2809.14 2822.5,-2702.95 2815.84,-2691.45 2806.42,-2681.58 2795.85,-2673.21"/>
<polygon fill="black" stroke="black" points="2797.7,-2670.22 2787.57,-2667.1 2793.54,-2675.85 2797.7,-2670.22"/>
</g>
<!-- l0_mha_attn_gpu3 -->
<g id="node27" class="node">
<title>l0_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5034,-3842.95 4553,-3842.95 4553,-3774.95 5034,-3774.95 5034,-3842.95"/>
<text text-anchor="middle" x="4793.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4793.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4793.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4793.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu3&#45;&gt;l0_mha_attn_gpu3 -->
<g id="edge80" class="edge">
<title>l0_mha_qkv_gpu3&#45;&gt;l0_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M4835.37,-3878.84C4830.17,-3870.29 4824.51,-3860.97 4819.07,-3852.03"/>
<polygon fill="black" stroke="black" points="4821.93,-3849.98 4813.74,-3843.25 4815.94,-3853.62 4821.93,-3849.98"/>
</g>
<!-- l0_mha_out_gpu3 -->
<g id="node28" class="node">
<title>l0_mha_out_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4860,-3738.95 4391,-3738.95 4391,-3670.95 4860,-3670.95 4860,-3738.95"/>
<text text-anchor="middle" x="4625.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4625.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4625.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4625.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu3&#45;&gt;l0_mha_out_gpu3 -->
<g id="edge81" class="edge">
<title>l0_mha_attn_gpu3&#45;&gt;l0_mha_out_gpu3</title>
<path fill="none" stroke="black" d="M4738.96,-3774.84C4723.03,-3765.17 4705.49,-3754.52 4689.06,-3744.54"/>
<polygon fill="black" stroke="black" points="4690.42,-3741.28 4680.06,-3739.08 4686.79,-3747.26 4690.42,-3741.28"/>
</g>
<!-- l0_mha_out_gpu3&#45;&gt;l0_mha_res_add_gpu3 -->
<g id="edge82" class="edge">
<title>l0_mha_out_gpu3&#45;&gt;l0_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M4605.05,-3670.84C4599.76,-3662.29 4594.01,-3652.97 4588.49,-3644.03"/>
<polygon fill="black" stroke="black" points="4591.3,-3641.92 4583.07,-3635.25 4585.34,-3645.6 4591.3,-3641.92"/>
</g>
<!-- l0_expert_3_gpu3 -->
<g id="node30" class="node">
<title>l0_expert_3_gpu3</title>
<polygon fill="lightpink" stroke="black" points="7029.5,-3358.95 6595.5,-3358.95 6595.5,-3290.95 7029.5,-3290.95 7029.5,-3358.95"/>
<text text-anchor="middle" x="6812.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6812.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6812.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6812.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu3&#45;&gt;l0_expert_3_gpu3 -->
<g id="edge86" class="edge">
<title>l0_mha_res_add_gpu3&#45;&gt;l0_expert_3_gpu3</title>
<path fill="none" stroke="black" d="M4345.44,-3596.2C4233.48,-3589.18 4113.04,-3571.9 4077.5,-3530.95 4037.88,-3485.3 4035.07,-3438 4077.5,-3394.95 4125.21,-3346.55 6399.41,-3363.59 6585.36,-3358.63"/>
<polygon fill="black" stroke="black" points="6585.61,-3362.12 6595.45,-3358.2 6585.31,-3355.12 6585.61,-3362.12"/>
</g>
<!-- l0_gate_gpu3 -->
<g id="node31" class="node">
<title>l0_gate_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="5038.24,-3530.95 4281.44,-3530.95 4086.76,-3394.95 4843.56,-3394.95 5038.24,-3530.95"/>
<text text-anchor="middle" x="4562.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4562.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4562.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4562.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu3&#45;&gt;l0_gate_gpu3 -->
<g id="edge84" class="edge">
<title>l0_mha_res_add_gpu3&#45;&gt;l0_gate_gpu3</title>
<path fill="none" stroke="black" d="M4562.5,-3566.68C4562.5,-3558.86 4562.5,-3550.19 4562.5,-3541.31"/>
<polygon fill="black" stroke="black" points="4566,-3541.22 4562.5,-3531.22 4559,-3541.22 4566,-3541.22"/>
</g>
<!-- l0_res2_gpu3 -->
<g id="node33" class="node">
<title>l0_res2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="3973.5,-3082.95 3539.5,-3082.95 3539.5,-3014.95 3973.5,-3014.95 3973.5,-3082.95"/>
<text text-anchor="middle" x="3756.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3756.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3756.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3756.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu3&#45;&gt;l0_res2_gpu3 -->
<g id="edge104" class="edge">
<title>l0_mha_res_add_gpu3&#45;&gt;l0_res2_gpu3</title>
<path fill="none" stroke="black" d="M4345.44,-3589.97C4180.18,-3582.68 3947.04,-3573.03 3742.5,-3566.95 3690.4,-3565.41 1907.16,-3563.56 1866.5,-3530.95 1817.98,-3492.04 1879.94,-3436.33 1833.5,-3394.95 1735.86,-3307.98 1650.77,-3430.78 1541.5,-3358.95 1496.72,-3329.52 1494.55,-3306.67 1480.5,-3254.95 1464.66,-3196.62 1438.29,-3162.22 1480.5,-3118.95 1508.75,-3089.99 2896.06,-3084.27 2936.5,-3082.95 3136.83,-3076.45 3364.61,-3067.13 3529.18,-3060.05"/>
<polygon fill="black" stroke="black" points="3529.59,-3063.53 3539.43,-3059.61 3529.29,-3056.54 3529.59,-3063.53"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge87" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6595.45,-3291.68C6592.45,-3291.43 6589.47,-3291.18 6586.5,-3290.95 5689.79,-3221.82 3436.21,-3324.07 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.16 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge88" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6595.45,-3291.69C6592.45,-3291.43 6589.46,-3291.19 6586.5,-3290.95 5893.25,-3236.6 4150.75,-3309.29 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.78,-3251.47 3447.53,-3254.15 3457.21,-3258.44 3457.78,-3251.47"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge89" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6595.45,-3291.71C6592.45,-3291.45 6589.46,-3291.19 6586.5,-3290.95 5606.9,-3211.79 5355.11,-3334.09 4375.5,-3254.95 4375.4,-3254.94 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.79,-3251.47 4365.53,-3254.12 4375.21,-3258.44 4375.79,-3251.47"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge90" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6595.45,-3291.76C6592.45,-3291.48 6589.46,-3291.21 6586.5,-3290.95 6013.76,-3241.34 5866.25,-3304.56 5293.5,-3254.95 5293.39,-3254.94 5293.29,-3254.93 5293.18,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.5,-3251.44 5283.23,-3254.04 5292.88,-3258.41 5293.5,-3251.44"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge91" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6595.42,-3292.05C6592.43,-3291.67 6589.45,-3291.31 6586.5,-3290.95 6420.28,-3270.85 6377.72,-3275.05 6211.5,-3254.95 6211.28,-3254.93 6211.05,-3254.9 6210.83,-3254.87"/>
<polygon fill="black" stroke="black" points="6211.01,-3251.37 6200.66,-3253.63 6210.17,-3258.32 6211.01,-3251.37"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge92" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6777.76,-3290.68C6768.62,-3281.93 6758.39,-3272.13 6747.97,-3262.15"/>
<polygon fill="black" stroke="black" points="6750.37,-3259.61 6740.73,-3255.22 6745.53,-3264.66 6750.37,-3259.61"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge93" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7000.84,-3290.94C7087.69,-3275.72 7192.88,-3257.29 7290.13,-3240.25"/>
<polygon fill="black" stroke="black" points="7290.87,-3243.67 7300.12,-3238.49 7289.66,-3236.77 7290.87,-3243.67"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge94" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7029.56,-3291.79C7032.56,-3291.5 7035.54,-3291.22 7038.5,-3290.95 7485.4,-3250.48 7600.6,-3295.42 8047.5,-3254.95 8098.27,-3250.36 8151.99,-3243.94 8204.1,-3236.88"/>
<polygon fill="black" stroke="black" points="8204.72,-3240.32 8214.15,-3235.5 8203.77,-3233.39 8204.72,-3240.32"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge95" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7029.55,-3291.72C7032.55,-3291.45 7035.54,-3291.2 7038.5,-3290.95 7892.23,-3220.93 8111.77,-3324.96 8965.5,-3254.95 9016.59,-3250.76 9070.64,-3244.52 9123.03,-3237.49"/>
<polygon fill="black" stroke="black" points="9123.7,-3240.94 9133.14,-3236.13 9122.76,-3234 9123.7,-3240.94"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge96" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7029.55,-3291.7C7032.55,-3291.44 7035.54,-3291.19 7038.5,-3290.95 8299.12,-3191.38 8622.88,-3354.5 9883.5,-3254.95 9934.69,-3250.91 9988.86,-3244.73 10041.34,-3237.72"/>
<polygon fill="black" stroke="black" points="10042.03,-3241.16 10051.47,-3236.35 10041.09,-3234.22 10042.03,-3241.16"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge97" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7029.55,-3291.69C7032.55,-3291.43 7035.53,-3291.18 7038.5,-3290.95 7872.26,-3226.39 9967.73,-3319.5 10801.5,-3254.95 10852.7,-3250.99 10906.87,-3244.84 10959.35,-3237.85"/>
<polygon fill="black" stroke="black" points="10960.04,-3241.29 10969.48,-3236.49 10959.1,-3234.35 10960.04,-3241.29"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge98" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7029.55,-3291.68C7032.55,-3291.42 7035.53,-3291.18 7038.5,-3290.95 8075.72,-3211.62 10682.28,-3334.27 11719.5,-3254.95 11770.7,-3251.04 11824.87,-3244.92 11877.36,-3237.93"/>
<polygon fill="black" stroke="black" points="11878.04,-3241.37 11887.49,-3236.57 11877.11,-3234.43 11878.04,-3241.37"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge99" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7029.55,-3291.67C7032.55,-3291.42 7035.53,-3291.18 7038.5,-3290.95 8279.18,-3196.84 11396.81,-3349.04 12637.5,-3254.95 12688.8,-3251.06 12743.08,-3244.94 12795.65,-3237.95"/>
<polygon fill="black" stroke="black" points="12796.35,-3241.38 12805.8,-3236.58 12795.42,-3234.45 12796.35,-3241.38"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge100" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7029.55,-3291.67C7032.55,-3291.42 7035.53,-3291.18 7038.5,-3290.95 7760.57,-3236.51 12833.43,-3309.38 13555.5,-3254.95 13606.8,-3251.09 13661.08,-3244.98 13713.66,-3237.99"/>
<polygon fill="black" stroke="black" points="13714.36,-3241.42 13723.8,-3236.62 13713.42,-3234.49 13714.36,-3241.42"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge101" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7029.55,-3291.67C7032.55,-3291.41 7035.53,-3291.18 7038.5,-3290.95 7862.3,-3229.12 13649.7,-3316.77 14473.5,-3254.95 14524.8,-3251.1 14579.08,-3245 14631.66,-3238.02"/>
<polygon fill="black" stroke="black" points="14632.36,-3241.45 14641.8,-3236.65 14631.43,-3234.52 14632.36,-3241.45"/>
</g>
<!-- l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge102" class="edge">
<title>l0_expert_3_gpu3&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7029.55,-3291.66C7032.55,-3291.41 7035.53,-3291.18 7038.5,-3290.95 7964.03,-3221.73 14465.96,-3324.15 15391.5,-3254.95 15442.8,-3251.12 15497.08,-3245.02 15549.66,-3238.04"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.48 15559.81,-3236.68 15549.43,-3234.54 15550.36,-3241.48"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_3_gpu3 -->
<g id="edge85" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4871.35,-3414.35C4931.31,-3406.63 4993.76,-3399.64 5052.5,-3394.95 5728.98,-3340.94 5905.23,-3415.59 6585.4,-3359.01"/>
<polygon fill="black" stroke="black" points="6585.77,-3362.49 6595.45,-3358.16 6585.19,-3355.51 6585.77,-3362.49"/>
</g>
<!-- l0_expert_agg_gpu3&#45;&gt;l0_res2_gpu3 -->
<g id="edge103" class="edge">
<title>l0_expert_agg_gpu3&#45;&gt;l0_res2_gpu3</title>
<path fill="none" stroke="black" d="M4386.33,-3120.35C4382.7,-3119.88 4379.09,-3119.42 4375.5,-3118.95 4246.02,-3102.29 4100.99,-3086 3983.88,-3073.43"/>
<polygon fill="black" stroke="black" points="3984.03,-3069.93 3973.72,-3072.34 3983.29,-3076.89 3984.03,-3069.93"/>
</g>
<!-- l1_mha_qkv_gpu3 -->
<g id="node154" class="node">
<title>l1_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3863,-2978.95 3382,-2978.95 3382,-2910.95 3863,-2910.95 3863,-2978.95"/>
<text text-anchor="middle" x="3622.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3622.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3622.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3622.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu3&#45;&gt;l1_mha_qkv_gpu3 -->
<g id="edge495" class="edge">
<title>l0_res2_gpu3&#45;&gt;l1_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M3712.99,-3014.84C3700.71,-3005.48 3687.21,-2995.21 3674.48,-2985.52"/>
<polygon fill="black" stroke="black" points="3676.32,-2982.52 3666.25,-2979.25 3672.08,-2988.09 3676.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu3 -->
<g id="node157" class="node">
<title>l1_mha_res_add_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="3975.5,-2666.95 3541.5,-2666.95 3541.5,-2598.95 3975.5,-2598.95 3975.5,-2666.95"/>
<text text-anchor="middle" x="3758.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3758.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3758.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3758.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu3&#45;&gt;l1_mha_res_add_gpu3 -->
<g id="edge499" class="edge">
<title>l0_res2_gpu3&#45;&gt;l1_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M3837.5,-3014.79C3851.51,-3005.33 3864.22,-2993.52 3872.5,-2978.95 3933.14,-2872.32 3930.64,-2809.31 3869.5,-2702.95 3862.88,-2691.43 3853.47,-2681.57 3842.91,-2673.21"/>
<polygon fill="black" stroke="black" points="3844.76,-2670.23 3834.63,-2667.11 3840.61,-2675.86 3844.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu4 -->
<g id="node35" class="node">
<title>l0_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6584,-3842.95 6103,-3842.95 6103,-3774.95 6584,-3774.95 6584,-3842.95"/>
<text text-anchor="middle" x="6343.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6343.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="6343.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6343.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu4&#45;&gt;l0_mha_attn_gpu4 -->
<g id="edge106" class="edge">
<title>l0_mha_qkv_gpu4&#45;&gt;l0_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M6371.19,-3878.84C6367.82,-3870.46 6364.16,-3861.35 6360.64,-3852.58"/>
<polygon fill="black" stroke="black" points="6363.86,-3851.23 6356.89,-3843.25 6357.37,-3853.84 6363.86,-3851.23"/>
</g>
<!-- l0_mha_out_gpu4 -->
<g id="node36" class="node">
<title>l0_mha_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6493,-3738.95 6024,-3738.95 6024,-3670.95 6493,-3670.95 6493,-3738.95"/>
<text text-anchor="middle" x="6258.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6258.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="6258.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6258.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu4&#45;&gt;l0_mha_out_gpu4 -->
<g id="edge107" class="edge">
<title>l0_mha_attn_gpu4&#45;&gt;l0_mha_out_gpu4</title>
<path fill="none" stroke="black" d="M6315.9,-3774.84C6308.55,-3766.02 6300.53,-3756.38 6292.86,-3747.19"/>
<polygon fill="black" stroke="black" points="6295.34,-3744.69 6286.25,-3739.25 6289.96,-3749.18 6295.34,-3744.69"/>
</g>
<!-- l0_mha_out_gpu4&#45;&gt;l0_mha_res_add_gpu4 -->
<g id="edge108" class="edge">
<title>l0_mha_out_gpu4&#45;&gt;l0_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M6035.6,-3670.91C5959.54,-3659.63 5874.42,-3647.01 5798,-3635.68"/>
<polygon fill="black" stroke="black" points="5798.17,-3632.17 5787.76,-3634.16 5797.14,-3639.09 5798.17,-3632.17"/>
</g>
<!-- l0_expert_4_gpu4 -->
<g id="node38" class="node">
<title>l0_expert_4_gpu4</title>
<polygon fill="lightpink" stroke="black" points="7481.5,-3358.95 7047.5,-3358.95 7047.5,-3290.95 7481.5,-3290.95 7481.5,-3358.95"/>
<text text-anchor="middle" x="7264.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7264.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7264.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7264.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu4&#45;&gt;l0_expert_4_gpu4 -->
<g id="edge112" class="edge">
<title>l0_mha_res_add_gpu4&#45;&gt;l0_expert_4_gpu4</title>
<path fill="none" stroke="black" d="M5353.44,-3596.2C5241.48,-3589.18 5121.04,-3571.9 5085.5,-3530.95 5045.88,-3485.3 5043.16,-3438.09 5085.5,-3394.95 5122.4,-3357.37 6876.95,-3363 7037.37,-3358.61"/>
<polygon fill="black" stroke="black" points="7037.61,-3362.1 7047.45,-3358.18 7037.31,-3355.11 7037.61,-3362.1"/>
</g>
<!-- l0_gate_gpu4 -->
<g id="node39" class="node">
<title>l0_gate_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="6046.24,-3530.95 5289.44,-3530.95 5094.76,-3394.95 5851.56,-3394.95 6046.24,-3530.95"/>
<text text-anchor="middle" x="5570.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5570.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5570.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5570.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu4&#45;&gt;l0_gate_gpu4 -->
<g id="edge110" class="edge">
<title>l0_mha_res_add_gpu4&#45;&gt;l0_gate_gpu4</title>
<path fill="none" stroke="black" d="M5570.5,-3566.68C5570.5,-3558.86 5570.5,-3550.19 5570.5,-3541.31"/>
<polygon fill="black" stroke="black" points="5574,-3541.22 5570.5,-3531.22 5567,-3541.22 5574,-3541.22"/>
</g>
<!-- l0_res2_gpu4 -->
<g id="node41" class="node">
<title>l0_res2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5621.5,-3082.95 5187.5,-3082.95 5187.5,-3014.95 5621.5,-3014.95 5621.5,-3082.95"/>
<text text-anchor="middle" x="5404.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5404.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5404.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5404.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu4&#45;&gt;l0_res2_gpu4 -->
<g id="edge130" class="edge">
<title>l0_mha_res_add_gpu4&#45;&gt;l0_res2_gpu4</title>
<path fill="none" stroke="black" d="M5353.14,-3589.06C5196.26,-3581.62 4979.35,-3572.19 4788.5,-3566.95 4709.61,-3564.79 2015.87,-3570.38 1947.5,-3530.95 1886.56,-3495.8 1920.08,-3440.55 1866.5,-3394.95 1737.66,-3285.3 1607.63,-3394.87 1512.5,-3254.95 1478.52,-3204.97 1470.07,-3162 1512.5,-3118.95 1536.58,-3094.52 3948.2,-3083.6 3982.5,-3082.95 4404.27,-3074.99 4896.33,-3062.96 5177.08,-3055.84"/>
<polygon fill="black" stroke="black" points="5177.48,-3059.33 5187.39,-3055.57 5177.3,-3052.33 5177.48,-3059.33"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge113" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7047.45,-3291.68C7044.45,-3291.42 7041.47,-3291.18 7038.5,-3290.95 6041.61,-3214.55 3536.39,-3331.34 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.16 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge114" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7047.45,-3291.69C7044.45,-3291.43 7041.46,-3291.18 7038.5,-3290.95 6245.07,-3229.32 4250.93,-3316.57 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.78,-3251.47 3447.53,-3254.15 3457.22,-3258.44 3457.78,-3251.47"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge115" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7047.45,-3291.7C7044.45,-3291.44 7041.46,-3291.19 7038.5,-3290.95 5858.55,-3197.24 5555.45,-3348.64 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.78,-3251.47 4365.53,-3254.14 4375.21,-3258.44 4375.78,-3251.47"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge116" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7047.45,-3291.73C7044.45,-3291.46 7041.46,-3291.2 7038.5,-3290.95 6265.44,-3226.79 6066.56,-3319.1 5293.5,-3254.95 5293.39,-3254.94 5293.29,-3254.94 5293.18,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.49,-3251.44 5283.23,-3254.08 5292.9,-3258.42 5293.49,-3251.44"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge117" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7047.44,-3291.83C7044.44,-3291.52 7041.46,-3291.23 7038.5,-3290.95 6672.23,-3256.33 6577.77,-3289.57 6211.5,-3254.95 6211.39,-3254.94 6211.29,-3254.93 6211.18,-3254.92"/>
<polygon fill="black" stroke="black" points="6211.53,-3251.44 6201.24,-3253.96 6210.86,-3258.41 6211.53,-3251.44"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge118" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7120.33,-3290.94C7075.57,-3280.7 7024.45,-3268.99 6973.1,-3257.24"/>
<polygon fill="black" stroke="black" points="6973.7,-3253.78 6963.17,-3254.96 6972.14,-3260.61 6973.7,-3253.78"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge119" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7343.35,-3290.86C7366.55,-3281.12 7392.88,-3270.06 7419.47,-3258.91"/>
<polygon fill="black" stroke="black" points="7421.01,-3262.05 7428.87,-3254.96 7418.3,-3255.6 7421.01,-3262.05"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge120" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7481.57,-3291.92C7484.56,-3291.59 7487.54,-3291.26 7490.5,-3290.95 7737.21,-3265.01 7800.79,-3280.89 8047.5,-3254.95 8097.82,-3249.66 8151.08,-3242.93 8202.82,-3235.79"/>
<polygon fill="black" stroke="black" points="8203.38,-3239.25 8212.8,-3234.41 8202.41,-3232.31 8203.38,-3239.25"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge121" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7481.55,-3291.75C7484.55,-3291.47 7487.54,-3291.2 7490.5,-3290.95 8143.9,-3235.48 8312.1,-3310.41 8965.5,-3254.95 9016.48,-3250.63 9070.42,-3244.32 9122.72,-3237.28"/>
<polygon fill="black" stroke="black" points="9123.37,-3240.73 9132.81,-3235.92 9122.43,-3233.79 9123.37,-3240.73"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge122" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7481.55,-3291.71C7484.55,-3291.44 7487.54,-3291.19 7490.5,-3290.95 8550.77,-3205.93 8823.23,-3339.95 9883.5,-3254.95 9934.59,-3250.86 9988.65,-3244.66 10041.05,-3237.65"/>
<polygon fill="black" stroke="black" points="10041.71,-3241.09 10051.15,-3236.29 10040.78,-3234.16 10041.71,-3241.09"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge123" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7481.55,-3291.69C7484.55,-3291.43 7487.54,-3291.18 7490.5,-3290.95 8224.09,-3233.67 10067.91,-3312.22 10801.5,-3254.95 10852.7,-3250.96 10906.87,-3244.79 10959.35,-3237.79"/>
<polygon fill="black" stroke="black" points="10960.03,-3241.23 10969.48,-3236.43 10959.1,-3234.3 10960.03,-3241.23"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge124" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7481.55,-3291.68C7484.55,-3291.42 7487.53,-3291.18 7490.5,-3290.95 8427.54,-3218.89 10782.45,-3326.99 11719.5,-3254.95 11770.7,-3251.02 11824.87,-3244.88 11877.36,-3237.89"/>
<polygon fill="black" stroke="black" points="11878.04,-3241.33 11887.48,-3236.53 11877.11,-3234.4 11878.04,-3241.33"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge125" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7481.55,-3291.67C7484.55,-3291.42 7487.53,-3291.18 7490.5,-3290.95 8631,-3204.11 11496.99,-3341.76 12637.5,-3254.95 12688.8,-3251.05 12743.08,-3244.92 12795.65,-3237.92"/>
<polygon fill="black" stroke="black" points="12796.35,-3241.36 12805.8,-3236.56 12795.42,-3234.42 12796.35,-3241.36"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge126" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7481.55,-3291.67C7484.55,-3291.42 7487.53,-3291.18 7490.5,-3290.95 8834.47,-3189.34 12211.53,-3356.54 13555.5,-3254.95 13606.8,-3251.08 13661.08,-3244.96 13713.66,-3237.97"/>
<polygon fill="black" stroke="black" points="13714.35,-3241.41 13723.8,-3236.61 13713.42,-3234.47 13714.35,-3241.41"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge127" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7481.55,-3291.67C7484.55,-3291.41 7487.53,-3291.18 7490.5,-3290.95 8264.21,-3232.76 13699.78,-3313.13 14473.5,-3254.95 14524.8,-3251.1 14579.08,-3244.99 14631.66,-3238"/>
<polygon fill="black" stroke="black" points="14632.36,-3241.44 14641.8,-3236.64 14631.43,-3234.5 14632.36,-3241.44"/>
</g>
<!-- l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge128" class="edge">
<title>l0_expert_4_gpu4&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7481.55,-3291.66C7484.55,-3291.41 7487.53,-3291.18 7490.5,-3290.95 8365.94,-3225.37 14516.05,-3320.52 15391.5,-3254.95 15442.8,-3251.11 15497.08,-3245.01 15549.66,-3238.03"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.47 15559.8,-3236.67 15549.43,-3234.53 15550.36,-3241.47"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_4_gpu4 -->
<g id="edge111" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5880.38,-3414.85C5940.04,-3407.13 6002.12,-3400.01 6060.5,-3394.95 6490.56,-3357.73 6603.63,-3397.82 7037.46,-3359.01"/>
<polygon fill="black" stroke="black" points="7037.8,-3362.49 7047.44,-3358.11 7037.17,-3355.52 7037.8,-3362.49"/>
</g>
<!-- l0_expert_agg_gpu4&#45;&gt;l0_res2_gpu4 -->
<g id="edge129" class="edge">
<title>l0_expert_agg_gpu4&#45;&gt;l0_res2_gpu4</title>
<path fill="none" stroke="black" d="M5581.05,-3118.95C5552.75,-3107.89 5524.37,-3096.8 5498.88,-3086.84"/>
<polygon fill="black" stroke="black" points="5499.86,-3083.46 5489.27,-3083.08 5497.31,-3089.98 5499.86,-3083.46"/>
</g>
<!-- l1_mha_qkv_gpu4 -->
<g id="node162" class="node">
<title>l1_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5510,-2978.95 5029,-2978.95 5029,-2910.95 5510,-2910.95 5510,-2978.95"/>
<text text-anchor="middle" x="5269.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5269.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5269.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5269.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu4&#45;&gt;l1_mha_qkv_gpu4 -->
<g id="edge521" class="edge">
<title>l0_res2_gpu4&#45;&gt;l1_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M5360.67,-3014.84C5348.29,-3005.48 5334.7,-2995.21 5321.87,-2985.52"/>
<polygon fill="black" stroke="black" points="5323.66,-2982.49 5313.57,-2979.25 5319.44,-2988.07 5323.66,-2982.49"/>
</g>
<!-- l1_mha_res_add_gpu4 -->
<g id="node165" class="node">
<title>l1_mha_res_add_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5622.5,-2666.95 5188.5,-2666.95 5188.5,-2598.95 5622.5,-2598.95 5622.5,-2666.95"/>
<text text-anchor="middle" x="5405.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5405.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5405.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5405.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu4&#45;&gt;l1_mha_res_add_gpu4 -->
<g id="edge525" class="edge">
<title>l0_res2_gpu4&#45;&gt;l1_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M5484.53,-3014.87C5498.53,-3005.38 5511.24,-2993.54 5519.5,-2978.95 5579.94,-2872.2 5577.64,-2809.31 5516.5,-2702.95 5509.88,-2691.43 5500.47,-2681.57 5489.91,-2673.21"/>
<polygon fill="black" stroke="black" points="5491.76,-2670.23 5481.63,-2667.11 5487.61,-2675.86 5491.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu5 -->
<g id="node43" class="node">
<title>l0_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="7330,-3842.95 6849,-3842.95 6849,-3774.95 7330,-3774.95 7330,-3842.95"/>
<text text-anchor="middle" x="7089.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7089.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="7089.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7089.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu5&#45;&gt;l0_mha_attn_gpu5 -->
<g id="edge132" class="edge">
<title>l0_mha_qkv_gpu5&#45;&gt;l0_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M7089.5,-3878.84C7089.5,-3870.73 7089.5,-3861.94 7089.5,-3853.43"/>
<polygon fill="black" stroke="black" points="7093,-3853.25 7089.5,-3843.25 7086,-3853.25 7093,-3853.25"/>
</g>
<!-- l0_mha_out_gpu5 -->
<g id="node44" class="node">
<title>l0_mha_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="7321,-3738.95 6852,-3738.95 6852,-3670.95 7321,-3670.95 7321,-3738.95"/>
<text text-anchor="middle" x="7086.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7086.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="7086.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7086.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu5&#45;&gt;l0_mha_out_gpu5 -->
<g id="edge133" class="edge">
<title>l0_mha_attn_gpu5&#45;&gt;l0_mha_out_gpu5</title>
<path fill="none" stroke="black" d="M7088.53,-3774.84C7088.29,-3766.73 7088.03,-3757.94 7087.78,-3749.43"/>
<polygon fill="black" stroke="black" points="7091.27,-3749.15 7087.48,-3739.25 7084.27,-3749.35 7091.27,-3749.15"/>
</g>
<!-- l0_mha_out_gpu5&#45;&gt;l0_mha_res_add_gpu5 -->
<g id="edge134" class="edge">
<title>l0_mha_out_gpu5&#45;&gt;l0_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6921.92,-3670.91C6868.04,-3660.09 6808,-3648.03 6753.39,-3637.07"/>
<polygon fill="black" stroke="black" points="6753.75,-3633.57 6743.26,-3635.03 6752.37,-3640.43 6753.75,-3633.57"/>
</g>
<!-- l0_expert_5_gpu5 -->
<g id="node46" class="node">
<title>l0_expert_5_gpu5</title>
<polygon fill="lightpink" stroke="black" points="7933.5,-3358.95 7499.5,-3358.95 7499.5,-3290.95 7933.5,-3290.95 7933.5,-3358.95"/>
<text text-anchor="middle" x="7716.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="7716.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="7716.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7716.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu5&#45;&gt;l0_expert_5_gpu5 -->
<g id="edge138" class="edge">
<title>l0_mha_res_add_gpu5&#45;&gt;l0_expert_5_gpu5</title>
<path fill="none" stroke="black" d="M6361.44,-3596.2C6249.48,-3589.18 6129.04,-3571.9 6093.5,-3530.95 6053.88,-3485.3 6051.31,-3438.24 6093.5,-3394.95 6119.61,-3368.16 7357.32,-3362.65 7489.38,-3358.6"/>
<polygon fill="black" stroke="black" points="7489.61,-3362.1 7499.45,-3358.15 7489.3,-3355.1 7489.61,-3362.1"/>
</g>
<!-- l0_gate_gpu5 -->
<g id="node47" class="node">
<title>l0_gate_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="7054.24,-3530.95 6297.44,-3530.95 6102.76,-3394.95 6859.56,-3394.95 7054.24,-3530.95"/>
<text text-anchor="middle" x="6578.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6578.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6578.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6578.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu5&#45;&gt;l0_gate_gpu5 -->
<g id="edge136" class="edge">
<title>l0_mha_res_add_gpu5&#45;&gt;l0_gate_gpu5</title>
<path fill="none" stroke="black" d="M6578.5,-3566.68C6578.5,-3558.86 6578.5,-3550.19 6578.5,-3541.31"/>
<polygon fill="black" stroke="black" points="6582,-3541.22 6578.5,-3531.22 6575,-3541.22 6582,-3541.22"/>
</g>
<!-- l0_res2_gpu5 -->
<g id="node49" class="node">
<title>l0_res2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6628.5,-3082.95 6194.5,-3082.95 6194.5,-3014.95 6628.5,-3014.95 6628.5,-3082.95"/>
<text text-anchor="middle" x="6411.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6411.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6411.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6411.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu5&#45;&gt;l0_res2_gpu5 -->
<g id="edge156" class="edge">
<title>l0_mha_res_add_gpu5&#45;&gt;l0_res2_gpu5</title>
<path fill="none" stroke="black" d="M6361.14,-3589.07C6204.26,-3581.63 5987.35,-3572.21 5796.5,-3566.95 5718.8,-3564.81 3065.83,-3569.79 2998.5,-3530.95 2937.56,-3495.8 2976.81,-3432.79 2917.5,-3394.95 2901.41,-3384.69 1563.29,-3269.12 1550.5,-3254.95 1510,-3210.09 1507.95,-3161.88 1550.5,-3118.95 1590.39,-3078.71 5573.85,-3084.4 5630.5,-3082.95 5817.02,-3078.19 6028.45,-3069.03 6184.24,-3061.56"/>
<polygon fill="black" stroke="black" points="6184.6,-3065.05 6194.42,-3061.07 6184.26,-3058.06 6184.6,-3065.05"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge139" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7499.45,-3291.68C7496.45,-3291.42 7493.47,-3291.18 7490.5,-3290.95 6393.44,-3207.27 3636.57,-3338.61 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.17 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge140" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7499.45,-3291.68C7496.45,-3291.43 7493.47,-3291.18 7490.5,-3290.95 6596.89,-3222.05 4351.11,-3323.84 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.16 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge141" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7499.45,-3291.69C7496.45,-3291.43 7493.46,-3291.19 7490.5,-3290.95 6800.35,-3236.82 5065.65,-3309.07 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.78,-3251.47 4365.53,-3254.15 4375.21,-3258.44 4375.78,-3251.47"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge142" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7499.45,-3291.71C7496.45,-3291.45 7493.46,-3291.19 7490.5,-3290.95 6517.1,-3212.24 6266.9,-3333.64 5293.5,-3254.95 5293.4,-3254.94 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.79,-3251.47 5283.53,-3254.12 5293.21,-3258.44 5293.79,-3251.47"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge143" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7499.45,-3291.76C7496.45,-3291.48 7493.46,-3291.21 7490.5,-3290.95 6923.96,-3241.79 6778.04,-3304.11 6211.5,-3254.95 6211.39,-3254.94 6211.29,-3254.93 6211.18,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.5,-3251.44 6201.23,-3254.04 6210.88,-3258.41 6211.5,-3251.44"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge144" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7499.41,-3292.06C7496.42,-3291.69 7493.45,-3291.32 7490.5,-3290.95 7330.46,-3271.3 7289.54,-3274.6 7129.5,-3254.95 7129.28,-3254.93 7129.05,-3254.9 7128.83,-3254.87"/>
<polygon fill="black" stroke="black" points="7129.02,-3251.37 7118.66,-3253.61 7128.16,-3258.31 7129.02,-3251.37"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge145" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7685.19,-3290.68C7677.11,-3282.1 7668.08,-3272.5 7658.87,-3262.72"/>
<polygon fill="black" stroke="black" points="7661.21,-3260.1 7651.81,-3255.22 7656.11,-3264.9 7661.21,-3260.1"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge146" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7908.24,-3290.94C7997.96,-3275.5 8106.91,-3256.74 8207.12,-3239.49"/>
<polygon fill="black" stroke="black" points="8207.84,-3242.92 8217.1,-3237.77 8206.66,-3236.02 8207.84,-3242.92"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge147" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7933.56,-3291.79C7936.56,-3291.5 7939.54,-3291.22 7942.5,-3290.95 8395.6,-3250.02 8512.4,-3295.87 8965.5,-3254.95 9016.27,-3250.37 9069.99,-3243.96 9122.1,-3236.9"/>
<polygon fill="black" stroke="black" points="9122.72,-3240.35 9132.16,-3235.53 9121.77,-3233.41 9122.72,-3240.35"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge148" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7933.55,-3291.72C7936.55,-3291.45 7939.54,-3291.2 7942.5,-3290.95 8802.43,-3220.48 9023.57,-3325.41 9883.5,-3254.95 9934.59,-3250.77 9988.64,-3244.52 10041.03,-3237.5"/>
<polygon fill="black" stroke="black" points="10041.7,-3240.94 10051.14,-3236.13 10040.76,-3234 10041.7,-3240.94"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge149" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7933.55,-3291.7C7936.55,-3291.44 7939.54,-3291.19 7942.5,-3290.95 9209.32,-3190.93 9534.67,-3354.95 10801.5,-3254.95 10852.69,-3250.91 10906.86,-3244.73 10959.34,-3237.72"/>
<polygon fill="black" stroke="black" points="10960.03,-3241.16 10969.47,-3236.35 10959.09,-3234.22 10960.03,-3241.16"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge150" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7933.55,-3291.69C7936.55,-3291.43 7939.53,-3291.18 7942.5,-3290.95 8779.37,-3226.17 10882.63,-3319.72 11719.5,-3254.95 11770.7,-3250.99 11824.87,-3244.85 11877.35,-3237.85"/>
<polygon fill="black" stroke="black" points="11878.04,-3241.29 11887.48,-3236.49 11877.1,-3234.35 11878.04,-3241.29"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge151" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7933.55,-3291.68C7936.55,-3291.42 7939.53,-3291.18 7942.5,-3290.95 8982.83,-3211.39 11597.17,-3334.49 12637.5,-3254.95 12688.7,-3251.04 12742.87,-3244.92 12795.36,-3237.93"/>
<polygon fill="black" stroke="black" points="12796.04,-3241.37 12805.49,-3236.57 12795.11,-3234.43 12796.04,-3241.37"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge152" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7933.55,-3291.67C7936.55,-3291.42 7939.53,-3291.18 7942.5,-3290.95 9186.29,-3196.61 12311.71,-3349.26 13555.5,-3254.95 13606.8,-3251.06 13661.08,-3244.94 13713.66,-3237.95"/>
<polygon fill="black" stroke="black" points="13714.35,-3241.38 13723.8,-3236.58 13713.42,-3234.45 13714.35,-3241.38"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge153" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7933.55,-3291.67C7936.55,-3291.42 7939.53,-3291.18 7942.5,-3290.95 8666.12,-3236.4 13749.87,-3309.49 14473.5,-3254.95 14524.8,-3251.09 14579.08,-3244.98 14631.66,-3237.99"/>
<polygon fill="black" stroke="black" points="14632.36,-3241.42 14641.8,-3236.62 14631.42,-3234.49 14632.36,-3241.42"/>
</g>
<!-- l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge154" class="edge">
<title>l0_expert_5_gpu5&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7933.55,-3291.67C7936.55,-3291.41 7939.53,-3291.18 7942.5,-3290.95 8767.85,-3229.01 14566.14,-3316.88 15391.5,-3254.95 15442.8,-3251.1 15497.08,-3245 15549.66,-3238.02"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.45 15559.8,-3236.65 15549.43,-3234.52 15550.36,-3241.45"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_5_gpu5 -->
<g id="edge137" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.9,-3416.82C6949.83,-3408.99 7011,-3401.33 7068.5,-3394.95 7252.3,-3374.56 7301.78,-3380.35 7489.23,-3359.07"/>
<polygon fill="black" stroke="black" points="7489.89,-3362.52 7499.42,-3357.9 7489.09,-3355.57 7489.89,-3362.52"/>
</g>
<!-- l0_expert_agg_gpu5&#45;&gt;l0_res2_gpu5 -->
<g id="edge155" class="edge">
<title>l0_expert_agg_gpu5&#45;&gt;l0_res2_gpu5</title>
<path fill="none" stroke="black" d="M6542.9,-3118.95C6522.49,-3108.23 6502.01,-3097.48 6483.51,-3087.76"/>
<polygon fill="black" stroke="black" points="6485.07,-3084.63 6474.59,-3083.08 6481.81,-3090.83 6485.07,-3084.63"/>
</g>
<!-- l1_mha_qkv_gpu5 -->
<g id="node170" class="node">
<title>l1_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6518,-2978.95 6037,-2978.95 6037,-2910.95 6518,-2910.95 6518,-2978.95"/>
<text text-anchor="middle" x="6277.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6277.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6277.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6277.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu5&#45;&gt;l1_mha_qkv_gpu5 -->
<g id="edge547" class="edge">
<title>l0_res2_gpu5&#45;&gt;l1_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M6367.99,-3014.84C6355.71,-3005.48 6342.21,-2995.21 6329.48,-2985.52"/>
<polygon fill="black" stroke="black" points="6331.32,-2982.52 6321.25,-2979.25 6327.08,-2988.09 6331.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu5 -->
<g id="node173" class="node">
<title>l1_mha_res_add_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6630.5,-2666.95 6196.5,-2666.95 6196.5,-2598.95 6630.5,-2598.95 6630.5,-2666.95"/>
<text text-anchor="middle" x="6413.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6413.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6413.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6413.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu5&#45;&gt;l1_mha_res_add_gpu5 -->
<g id="edge551" class="edge">
<title>l0_res2_gpu5&#45;&gt;l1_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6492.5,-3014.79C6506.51,-3005.33 6519.22,-2993.52 6527.5,-2978.95 6588.14,-2872.32 6585.64,-2809.31 6524.5,-2702.95 6517.88,-2691.43 6508.47,-2681.57 6497.91,-2673.21"/>
<polygon fill="black" stroke="black" points="6499.76,-2670.23 6489.63,-2667.11 6495.61,-2675.86 6499.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu6 -->
<g id="node51" class="node">
<title>l0_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7930,-3842.95 7449,-3842.95 7449,-3774.95 7930,-3774.95 7930,-3842.95"/>
<text text-anchor="middle" x="7689.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7689.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7689.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7689.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu6&#45;&gt;l0_mha_attn_gpu6 -->
<g id="edge158" class="edge">
<title>l0_mha_qkv_gpu6&#45;&gt;l0_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M7750.28,-3878.84C7742.42,-3869.93 7733.83,-3860.19 7725.64,-3850.91"/>
<polygon fill="black" stroke="black" points="7728.12,-3848.44 7718.88,-3843.25 7722.87,-3853.07 7728.12,-3848.44"/>
</g>
<!-- l0_mha_out_gpu6 -->
<g id="node52" class="node">
<title>l0_mha_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7911,-3738.95 7442,-3738.95 7442,-3670.95 7911,-3670.95 7911,-3738.95"/>
<text text-anchor="middle" x="7676.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7676.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7676.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7676.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu6&#45;&gt;l0_mha_out_gpu6 -->
<g id="edge159" class="edge">
<title>l0_mha_attn_gpu6&#45;&gt;l0_mha_out_gpu6</title>
<path fill="none" stroke="black" d="M7685.28,-3774.84C7684.25,-3766.73 7683.13,-3757.94 7682.04,-3749.43"/>
<polygon fill="black" stroke="black" points="7685.48,-3748.73 7680.74,-3739.25 7678.54,-3749.61 7685.48,-3748.73"/>
</g>
<!-- l0_mha_out_gpu6&#45;&gt;l0_mha_res_add_gpu6 -->
<g id="edge160" class="edge">
<title>l0_mha_out_gpu6&#45;&gt;l0_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7647.28,-3670.84C7639.42,-3661.93 7630.83,-3652.19 7622.64,-3642.91"/>
<polygon fill="black" stroke="black" points="7625.12,-3640.44 7615.88,-3635.25 7619.87,-3645.07 7625.12,-3640.44"/>
</g>
<!-- l0_expert_6_gpu6 -->
<g id="node54" class="node">
<title>l0_expert_6_gpu6</title>
<polygon fill="lightpink" stroke="black" points="8385.5,-3358.95 7951.5,-3358.95 7951.5,-3290.95 8385.5,-3290.95 8385.5,-3358.95"/>
<text text-anchor="middle" x="8168.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8168.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="8168.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8168.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu6&#45;&gt;l0_expert_6_gpu6 -->
<g id="edge164" class="edge">
<title>l0_mha_res_add_gpu6&#45;&gt;l0_expert_6_gpu6</title>
<path fill="none" stroke="black" d="M7369.44,-3596.2C7257.48,-3589.18 7137.04,-3571.9 7101.5,-3530.95 7061.88,-3485.3 7059.68,-3438.6 7101.5,-3394.95 7132.53,-3362.57 7834.65,-3363.22 7941.14,-3358.69"/>
<polygon fill="black" stroke="black" points="7941.67,-3362.17 7951.44,-3358.08 7941.25,-3355.18 7941.67,-3362.17"/>
</g>
<!-- l0_gate_gpu6 -->
<g id="node55" class="node">
<title>l0_gate_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="8062.24,-3530.95 7305.44,-3530.95 7110.76,-3394.95 7867.56,-3394.95 8062.24,-3530.95"/>
<text text-anchor="middle" x="7586.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7586.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7586.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7586.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu6&#45;&gt;l0_gate_gpu6 -->
<g id="edge162" class="edge">
<title>l0_mha_res_add_gpu6&#45;&gt;l0_gate_gpu6</title>
<path fill="none" stroke="black" d="M7586.5,-3566.68C7586.5,-3558.86 7586.5,-3550.19 7586.5,-3541.31"/>
<polygon fill="black" stroke="black" points="7590,-3541.22 7586.5,-3531.22 7583,-3541.22 7590,-3541.22"/>
</g>
<!-- l0_res2_gpu6 -->
<g id="node57" class="node">
<title>l0_res2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7623.5,-3082.95 7189.5,-3082.95 7189.5,-3014.95 7623.5,-3014.95 7623.5,-3082.95"/>
<text text-anchor="middle" x="7406.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7406.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7406.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7406.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu6&#45;&gt;l0_res2_gpu6 -->
<g id="edge182" class="edge">
<title>l0_mha_res_add_gpu6&#45;&gt;l0_res2_gpu6</title>
<path fill="none" stroke="black" d="M7369.14,-3588.88C7212.26,-3581.35 6995.35,-3571.89 6804.5,-3566.95 6752.11,-3565.6 3075.27,-3559.78 3031.5,-3530.95 2976.33,-3494.61 3024.96,-3433.76 2971.5,-3394.95 2906.97,-3348.11 2693.49,-3369.86 2614.5,-3358.95 2441.51,-3335.07 2400.98,-3311 2227.5,-3290.95 2156.64,-3282.77 1635.51,-3306.79 1586.5,-3254.95 1544.97,-3211.03 1543.91,-3161.85 1586.5,-3118.95 1611.21,-3094.06 6602.43,-3083.83 6637.5,-3082.95 6819.85,-3078.39 7026.38,-3069.31 7179.45,-3061.83"/>
<polygon fill="black" stroke="black" points="7179.64,-3065.33 7189.46,-3061.34 7179.3,-3058.33 7179.64,-3065.33"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge165" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7951.45,-3291.67C7948.45,-3291.42 7945.47,-3291.18 7942.5,-3290.95 6745.26,-3199.99 3736.75,-3345.88 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.17 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge166" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7951.45,-3291.68C7948.45,-3291.42 7945.47,-3291.18 7942.5,-3290.95 6948.72,-3214.77 4451.28,-3331.11 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.16 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge167" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7951.45,-3291.69C7948.45,-3291.43 7945.46,-3291.18 7942.5,-3290.95 7152.17,-3229.55 5165.83,-3316.34 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.78,-3251.47 4365.53,-3254.15 4375.22,-3258.44 4375.78,-3251.47"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge168" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7951.45,-3291.7C7948.45,-3291.44 7945.46,-3291.19 7942.5,-3290.95 6768.76,-3197.69 6467.24,-3348.19 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.78,-3251.47 5283.53,-3254.14 5293.21,-3258.44 5293.78,-3251.47"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge169" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7951.45,-3291.73C7948.45,-3291.46 7945.46,-3291.2 7942.5,-3290.95 7175.64,-3227.24 6978.36,-3318.65 6211.5,-3254.95 6211.39,-3254.94 6211.29,-3254.94 6211.18,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.49,-3251.44 6201.23,-3254.08 6210.89,-3258.42 6211.49,-3251.44"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge170" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7951.44,-3291.83C7948.44,-3291.53 7945.46,-3291.23 7942.5,-3290.95 7582.43,-3256.78 7489.57,-3289.12 7129.5,-3254.95 7129.39,-3254.94 7129.29,-3254.93 7129.18,-3254.92"/>
<polygon fill="black" stroke="black" points="7129.53,-3251.44 7119.24,-3253.96 7128.86,-3258.41 7129.53,-3251.44"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge171" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8027.73,-3290.94C7984.11,-3280.72 7934.31,-3269.04 7884.28,-3257.31"/>
<polygon fill="black" stroke="black" points="7884.81,-3253.84 7874.27,-3254.96 7883.21,-3260.65 7884.81,-3253.84"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge172" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8250.75,-3290.86C8275.07,-3281.07 8302.67,-3269.97 8330.53,-3258.76"/>
<polygon fill="black" stroke="black" points="8332.01,-3261.94 8339.98,-3254.96 8329.39,-3255.44 8332.01,-3261.94"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge173" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8385.57,-3291.91C8388.56,-3291.58 8391.54,-3291.26 8394.5,-3290.95 8647.41,-3264.56 8712.59,-3281.34 8965.5,-3254.95 9015.82,-3249.7 9069.09,-3242.99 9120.82,-3235.86"/>
<polygon fill="black" stroke="black" points="9121.38,-3239.32 9130.81,-3234.48 9120.42,-3232.38 9121.38,-3239.32"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge174" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8385.55,-3291.75C8388.55,-3291.47 8391.54,-3291.2 8394.5,-3290.95 9054.1,-3235.03 9223.89,-3310.86 9883.5,-3254.95 9934.48,-3250.63 9988.42,-3244.33 10040.72,-3237.29"/>
<polygon fill="black" stroke="black" points="10041.37,-3240.74 10050.81,-3235.93 10040.43,-3233.8 10041.37,-3240.74"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge175" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8385.55,-3291.71C8388.55,-3291.44 8391.54,-3291.19 8394.5,-3290.95 9460.98,-3205.48 9735.02,-3340.4 10801.5,-3254.95 10852.59,-3250.86 10906.65,-3244.66 10959.05,-3237.65"/>
<polygon fill="black" stroke="black" points="10959.71,-3241.1 10969.15,-3236.29 10958.78,-3234.16 10959.71,-3241.1"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge176" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8385.55,-3291.69C8388.55,-3291.43 8391.54,-3291.18 8394.5,-3290.95 9131.19,-3233.44 10982.81,-3312.45 11719.5,-3254.95 11770.7,-3250.96 11824.87,-3244.8 11877.35,-3237.79"/>
<polygon fill="black" stroke="black" points="11878.03,-3241.23 11887.48,-3236.43 11877.1,-3234.3 11878.03,-3241.23"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge177" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8385.55,-3291.68C8388.55,-3291.42 8391.53,-3291.18 8394.5,-3290.95 9334.65,-3218.67 11697.35,-3327.22 12637.5,-3254.95 12688.7,-3251.02 12742.87,-3244.89 12795.36,-3237.9"/>
<polygon fill="black" stroke="black" points="12796.04,-3241.34 12805.48,-3236.53 12795.11,-3234.4 12796.04,-3241.34"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge178" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8385.55,-3291.67C8388.55,-3291.42 8391.53,-3291.18 8394.5,-3290.95 9538.11,-3203.89 12411.89,-3341.99 13555.5,-3254.95 13606.8,-3251.05 13661.08,-3244.92 13713.65,-3237.92"/>
<polygon fill="black" stroke="black" points="13714.35,-3241.36 13723.8,-3236.56 13713.42,-3234.42 13714.35,-3241.36"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge179" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8385.55,-3291.67C8388.55,-3291.42 8391.53,-3291.18 8394.5,-3290.95 9741.57,-3189.11 13126.43,-3356.76 14473.5,-3254.95 14524.8,-3251.08 14579.08,-3244.96 14631.66,-3237.97"/>
<polygon fill="black" stroke="black" points="14632.35,-3241.41 14641.8,-3236.61 14631.42,-3234.47 14632.35,-3241.41"/>
</g>
<!-- l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge180" class="edge">
<title>l0_expert_6_gpu6&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8385.55,-3291.67C8388.55,-3291.41 8391.53,-3291.18 8394.5,-3290.95 9169.77,-3232.65 14616.23,-3313.24 15391.5,-3254.95 15442.8,-3251.1 15497.08,-3244.99 15549.66,-3238"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.44 15559.8,-3236.64 15549.43,-3234.5 15550.36,-3241.44"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_6_gpu6 -->
<g id="edge163" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7868.98,-3395.95C7920.11,-3384 7971.59,-3371.97 8017.1,-3361.33"/>
<polygon fill="black" stroke="black" points="8018.08,-3364.7 8027.02,-3359.01 8016.49,-3357.88 8018.08,-3364.7"/>
</g>
<!-- l0_expert_agg_gpu6&#45;&gt;l0_res2_gpu6 -->
<g id="edge181" class="edge">
<title>l0_expert_agg_gpu6&#45;&gt;l0_res2_gpu6</title>
<path fill="none" stroke="black" d="M7498.83,-3118.95C7485.14,-3108.72 7471.41,-3098.46 7458.88,-3089.1"/>
<polygon fill="black" stroke="black" points="7460.94,-3086.26 7450.83,-3083.08 7456.75,-3091.87 7460.94,-3086.26"/>
</g>
<!-- l1_mha_qkv_gpu6 -->
<g id="node178" class="node">
<title>l1_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7526,-2978.95 7045,-2978.95 7045,-2910.95 7526,-2910.95 7526,-2978.95"/>
<text text-anchor="middle" x="7285.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7285.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7285.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7285.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu6&#45;&gt;l1_mha_qkv_gpu6 -->
<g id="edge573" class="edge">
<title>l0_res2_gpu6&#45;&gt;l1_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M7367.21,-3014.84C7356.23,-3005.57 7344.17,-2995.41 7332.77,-2985.8"/>
<polygon fill="black" stroke="black" points="7334.9,-2983.02 7325,-2979.25 7330.39,-2988.37 7334.9,-2983.02"/>
</g>
<!-- l1_mha_res_add_gpu6 -->
<g id="node181" class="node">
<title>l1_mha_res_add_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7638.5,-2666.95 7204.5,-2666.95 7204.5,-2598.95 7638.5,-2598.95 7638.5,-2666.95"/>
<text text-anchor="middle" x="7421.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7421.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7421.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7421.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu6&#45;&gt;l1_mha_res_add_gpu6 -->
<g id="edge577" class="edge">
<title>l0_res2_gpu6&#45;&gt;l1_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7498.67,-3014.94C7513.36,-3005.58 7526.62,-2993.77 7535.5,-2978.95 7598.55,-2873.72 7593.64,-2809.31 7532.5,-2702.95 7525.88,-2691.43 7516.47,-2681.57 7505.91,-2673.21"/>
<polygon fill="black" stroke="black" points="7507.76,-2670.23 7497.63,-2667.11 7503.61,-2675.86 7507.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu7 -->
<g id="node59" class="node">
<title>l0_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8683,-3842.95 8202,-3842.95 8202,-3774.95 8683,-3774.95 8683,-3842.95"/>
<text text-anchor="middle" x="8442.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8442.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8442.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8442.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu7&#45;&gt;l0_mha_attn_gpu7 -->
<g id="edge184" class="edge">
<title>l0_mha_qkv_gpu7&#45;&gt;l0_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M8442.5,-3878.84C8442.5,-3870.73 8442.5,-3861.94 8442.5,-3853.43"/>
<polygon fill="black" stroke="black" points="8446,-3853.25 8442.5,-3843.25 8439,-3853.25 8446,-3853.25"/>
</g>
<!-- l0_mha_out_gpu7 -->
<g id="node60" class="node">
<title>l0_mha_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8677,-3738.95 8208,-3738.95 8208,-3670.95 8677,-3670.95 8677,-3738.95"/>
<text text-anchor="middle" x="8442.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8442.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8442.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8442.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu7&#45;&gt;l0_mha_out_gpu7 -->
<g id="edge185" class="edge">
<title>l0_mha_attn_gpu7&#45;&gt;l0_mha_out_gpu7</title>
<path fill="none" stroke="black" d="M8442.5,-3774.84C8442.5,-3766.73 8442.5,-3757.94 8442.5,-3749.43"/>
<polygon fill="black" stroke="black" points="8446,-3749.25 8442.5,-3739.25 8439,-3749.25 8446,-3749.25"/>
</g>
<!-- l0_mha_out_gpu7&#45;&gt;l0_mha_res_add_gpu7 -->
<g id="edge186" class="edge">
<title>l0_mha_out_gpu7&#45;&gt;l0_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8442.5,-3670.84C8442.5,-3662.73 8442.5,-3653.94 8442.5,-3645.43"/>
<polygon fill="black" stroke="black" points="8446,-3645.25 8442.5,-3635.25 8439,-3645.25 8446,-3645.25"/>
</g>
<!-- l0_expert_7_gpu7 -->
<g id="node62" class="node">
<title>l0_expert_7_gpu7</title>
<polygon fill="lightpink" stroke="black" points="8837.5,-3358.95 8403.5,-3358.95 8403.5,-3290.95 8837.5,-3290.95 8837.5,-3358.95"/>
<text text-anchor="middle" x="8620.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8620.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8620.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8620.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu7&#45;&gt;l0_expert_7_gpu7 -->
<g id="edge190" class="edge">
<title>l0_mha_res_add_gpu7&#45;&gt;l0_expert_7_gpu7</title>
<path fill="none" stroke="black" d="M8225.19,-3576.53C8172.41,-3566.2 8126.27,-3551.56 8109.5,-3530.95 8071.34,-3484.08 8069.53,-3440.29 8109.5,-3394.95 8149.82,-3349.22 8315.39,-3365.86 8393.05,-3358.89"/>
<polygon fill="black" stroke="black" points="8393.85,-3362.32 8403.4,-3357.74 8393.08,-3355.36 8393.85,-3362.32"/>
</g>
<!-- l0_gate_gpu7 -->
<g id="node63" class="node">
<title>l0_gate_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="9070.24,-3530.95 8313.44,-3530.95 8118.76,-3394.95 8875.56,-3394.95 9070.24,-3530.95"/>
<text text-anchor="middle" x="8594.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8594.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8594.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8594.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu7&#45;&gt;l0_gate_gpu7 -->
<g id="edge188" class="edge">
<title>l0_mha_res_add_gpu7&#45;&gt;l0_gate_gpu7</title>
<path fill="none" stroke="black" d="M8479.68,-3566.68C8489.47,-3557.93 8500.42,-3548.13 8511.58,-3538.15"/>
<polygon fill="black" stroke="black" points="8514.2,-3540.49 8519.32,-3531.22 8509.54,-3535.28 8514.2,-3540.49"/>
</g>
<!-- l0_res2_gpu7 -->
<g id="node65" class="node">
<title>l0_res2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8587.5,-3082.95 8153.5,-3082.95 8153.5,-3014.95 8587.5,-3014.95 8587.5,-3082.95"/>
<text text-anchor="middle" x="8370.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8370.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8370.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8370.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu7&#45;&gt;l0_res2_gpu7 -->
<g id="edge208" class="edge">
<title>l0_mha_res_add_gpu7&#45;&gt;l0_res2_gpu7</title>
<path fill="none" stroke="black" d="M8225.38,-3586.29C8103.98,-3579.23 7949.89,-3571.21 7812.5,-3566.95 7760.65,-3565.35 4122.12,-3557.42 4077.5,-3530.95 4017.95,-3495.63 4059.87,-3432.2 4001.5,-3394.95 3740.95,-3228.67 2923.11,-3308.11 2614.5,-3290.95 2559.38,-3287.89 1659.82,-3294.69 1621.5,-3254.95 1579.54,-3211.45 1578.89,-3161.82 1621.5,-3118.95 1650.93,-3089.35 7590.77,-3084.01 7632.5,-3082.95 7803.72,-3078.61 7997.13,-3069.82 8142.99,-3062.4"/>
<polygon fill="black" stroke="black" points="8143.6,-3065.88 8153.41,-3061.87 8143.25,-3058.89 8143.6,-3065.88"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge191" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8403.45,-3291.67C8400.45,-3291.42 8397.47,-3291.18 8394.5,-3290.95 7097.08,-3192.72 3836.92,-3353.16 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.17 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge192" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8403.45,-3291.68C8400.45,-3291.42 8397.47,-3291.18 8394.5,-3290.95 7300.54,-3207.5 4551.46,-3338.39 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.17 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge193" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8403.45,-3291.68C8400.45,-3291.43 8397.47,-3291.18 8394.5,-3290.95 7504,-3222.27 5266,-3323.61 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.16 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge194" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8403.45,-3291.69C8400.45,-3291.43 8397.46,-3291.19 8394.5,-3290.95 7020.41,-3183.14 6667.59,-3362.73 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.78,-3251.47 5283.53,-3254.15 5293.21,-3258.44 5293.78,-3251.47"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge195" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8403.45,-3291.71C8400.45,-3291.45 8397.46,-3291.19 8394.5,-3290.95 7427.31,-3212.69 7178.69,-3333.19 6211.5,-3254.95 6211.4,-3254.94 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.79,-3251.47 6201.53,-3254.12 6211.21,-3258.44 6211.79,-3251.47"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge196" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8403.45,-3291.76C8400.45,-3291.48 8397.46,-3291.21 8394.5,-3290.95 7834.16,-3242.24 7689.84,-3303.66 7129.5,-3254.95 7129.39,-3254.94 7129.29,-3254.93 7129.18,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.5,-3251.44 7119.23,-3254.04 7128.88,-3258.41 7129.5,-3251.44"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge197" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8403.41,-3292.08C8400.42,-3291.7 8397.45,-3291.32 8394.5,-3290.95 8240.64,-3271.75 8201.36,-3274.16 8047.5,-3254.95 8047.28,-3254.93 8047.05,-3254.9 8046.83,-3254.87"/>
<polygon fill="black" stroke="black" points="8047.03,-3251.37 8036.67,-3253.59 8046.15,-3258.31 8047.03,-3251.37"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge198" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8592.61,-3290.68C8585.49,-3282.18 8577.53,-3272.69 8569.41,-3263.01"/>
<polygon fill="black" stroke="black" points="8571.99,-3260.63 8562.88,-3255.22 8566.62,-3265.13 8571.99,-3260.63"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge199" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8815.64,-3290.94C8908.28,-3275.27 9021.06,-3256.2 9124.27,-3238.74"/>
<polygon fill="black" stroke="black" points="9124.95,-3242.17 9134.23,-3237.05 9123.78,-3235.27 9124.95,-3242.17"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge200" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8837.56,-3291.79C8840.56,-3291.5 8843.54,-3291.22 8846.5,-3290.95 9305.81,-3249.57 9424.19,-3296.32 9883.5,-3254.95 9934.27,-3250.38 9987.99,-3243.97 10040.1,-3236.92"/>
<polygon fill="black" stroke="black" points="10040.72,-3240.37 10050.16,-3235.55 10039.78,-3233.43 10040.72,-3240.37"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge201" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8837.55,-3291.72C8840.55,-3291.45 8843.54,-3291.2 8846.5,-3290.95 9712.64,-3220.03 9935.36,-3325.86 10801.5,-3254.95 10852.59,-3250.77 10906.64,-3244.53 10959.03,-3237.51"/>
<polygon fill="black" stroke="black" points="10959.7,-3240.95 10969.14,-3236.14 10958.76,-3234.01 10959.7,-3240.95"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge202" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8837.55,-3291.7C8840.55,-3291.44 8843.54,-3291.19 8846.5,-3290.95 10119.53,-3190.48 10446.47,-3355.4 11719.5,-3254.95 11770.69,-3250.91 11824.86,-3244.73 11877.34,-3237.72"/>
<polygon fill="black" stroke="black" points="11878.03,-3241.16 11887.47,-3236.36 11877.09,-3234.22 11878.03,-3241.16"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge203" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8837.55,-3291.69C8840.55,-3291.43 8843.53,-3291.18 8846.5,-3290.95 9686.47,-3225.94 11797.53,-3319.95 12637.5,-3254.95 12688.7,-3250.99 12742.87,-3244.85 12795.35,-3237.85"/>
<polygon fill="black" stroke="black" points="12796.04,-3241.29 12805.48,-3236.49 12795.1,-3234.35 12796.04,-3241.29"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge204" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8837.55,-3291.68C8840.55,-3291.42 8843.53,-3291.18 8846.5,-3290.95 9889.93,-3211.17 12512.07,-3334.72 13555.5,-3254.95 13606.7,-3251.04 13660.87,-3244.92 13713.36,-3237.93"/>
<polygon fill="black" stroke="black" points="13714.04,-3241.37 13723.49,-3236.57 13713.11,-3234.43 13714.04,-3241.37"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge205" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8837.55,-3291.67C8840.55,-3291.42 8843.53,-3291.18 8846.5,-3290.95 10093.39,-3196.39 13226.61,-3349.49 14473.5,-3254.95 14524.8,-3251.06 14579.08,-3244.94 14631.66,-3237.95"/>
<polygon fill="black" stroke="black" points="14632.35,-3241.39 14641.8,-3236.58 14631.42,-3234.45 14632.35,-3241.39"/>
</g>
<!-- l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge206" class="edge">
<title>l0_expert_7_gpu7&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8837.55,-3291.67C8840.55,-3291.42 8843.53,-3291.18 8846.5,-3290.95 9571.68,-3236.28 14666.32,-3309.61 15391.5,-3254.95 15442.8,-3251.09 15497.08,-3244.98 15549.66,-3237.99"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.42 15559.8,-3236.62 15549.42,-3234.49 15550.36,-3241.42"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_7_gpu7 -->
<g id="edge189" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8607.35,-3394.75C8609.02,-3386 8610.7,-3377.23 8612.27,-3369.02"/>
<polygon fill="black" stroke="black" points="8615.75,-3369.45 8614.19,-3358.97 8608.87,-3368.13 8615.75,-3369.45"/>
</g>
<!-- l0_expert_agg_gpu7&#45;&gt;l0_res2_gpu7 -->
<g id="edge207" class="edge">
<title>l0_expert_agg_gpu7&#45;&gt;l0_res2_gpu7</title>
<path fill="none" stroke="black" d="M8439.3,-3118.75C8429.57,-3109.03 8419.83,-3099.28 8410.85,-3090.31"/>
<polygon fill="black" stroke="black" points="8413.06,-3087.57 8403.52,-3082.97 8408.11,-3092.52 8413.06,-3087.57"/>
</g>
<!-- l1_mha_qkv_gpu7 -->
<g id="node186" class="node">
<title>l1_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8534,-2978.95 8053,-2978.95 8053,-2910.95 8534,-2910.95 8534,-2978.95"/>
<text text-anchor="middle" x="8293.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8293.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8293.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8293.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu7&#45;&gt;l1_mha_qkv_gpu7 -->
<g id="edge599" class="edge">
<title>l0_res2_gpu7&#45;&gt;l1_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M8345.5,-3014.84C8338.91,-3006.11 8331.72,-2996.58 8324.84,-2987.47"/>
<polygon fill="black" stroke="black" points="8327.46,-2985.13 8318.64,-2979.25 8321.87,-2989.34 8327.46,-2985.13"/>
</g>
<!-- l1_mha_res_add_gpu7 -->
<g id="node189" class="node">
<title>l1_mha_res_add_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8646.5,-2666.95 8212.5,-2666.95 8212.5,-2598.95 8646.5,-2598.95 8646.5,-2666.95"/>
<text text-anchor="middle" x="8429.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8429.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8429.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8429.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu7&#45;&gt;l1_mha_res_add_gpu7 -->
<g id="edge603" class="edge">
<title>l0_res2_gpu7&#45;&gt;l1_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8503.68,-3014.86C8519.35,-3005.68 8533.34,-2993.94 8543.5,-2978.95 8612.33,-2877.41 8601.64,-2809.31 8540.5,-2702.95 8533.88,-2691.43 8524.47,-2681.57 8513.91,-2673.21"/>
<polygon fill="black" stroke="black" points="8515.76,-2670.23 8505.63,-2667.11 8511.61,-2675.86 8515.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu8 -->
<g id="node67" class="node">
<title>l0_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="9221,-3842.95 8740,-3842.95 8740,-3774.95 9221,-3774.95 9221,-3842.95"/>
<text text-anchor="middle" x="8980.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8980.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="8980.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8980.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu8&#45;&gt;l0_mha_attn_gpu8 -->
<g id="edge210" class="edge">
<title>l0_mha_qkv_gpu8&#45;&gt;l0_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M8980.5,-3878.84C8980.5,-3870.73 8980.5,-3861.94 8980.5,-3853.43"/>
<polygon fill="black" stroke="black" points="8984,-3853.25 8980.5,-3843.25 8977,-3853.25 8984,-3853.25"/>
</g>
<!-- l0_mha_out_gpu8 -->
<g id="node68" class="node">
<title>l0_mha_out_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="9218,-3738.95 8749,-3738.95 8749,-3670.95 9218,-3670.95 9218,-3738.95"/>
<text text-anchor="middle" x="8983.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8983.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="8983.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8983.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu8&#45;&gt;l0_mha_out_gpu8 -->
<g id="edge211" class="edge">
<title>l0_mha_attn_gpu8&#45;&gt;l0_mha_out_gpu8</title>
<path fill="none" stroke="black" d="M8981.47,-3774.84C8981.71,-3766.73 8981.97,-3757.94 8982.22,-3749.43"/>
<polygon fill="black" stroke="black" points="8985.73,-3749.35 8982.52,-3739.25 8978.73,-3749.15 8985.73,-3749.35"/>
</g>
<!-- l0_mha_out_gpu8&#45;&gt;l0_mha_res_add_gpu8 -->
<g id="edge212" class="edge">
<title>l0_mha_out_gpu8&#45;&gt;l0_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M9069.86,-3670.84C9096.6,-3660.59 9126.21,-3649.23 9153.55,-3638.75"/>
<polygon fill="black" stroke="black" points="9155.03,-3641.93 9163.12,-3635.08 9152.53,-3635.39 9155.03,-3641.93"/>
</g>
<!-- l0_expert_8_gpu8 -->
<g id="node70" class="node">
<title>l0_expert_8_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9289.5,-3358.95 8855.5,-3358.95 8855.5,-3290.95 9289.5,-3290.95 9289.5,-3358.95"/>
<text text-anchor="middle" x="9072.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="9072.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9072.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9072.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu8&#45;&gt;l0_expert_8_gpu8 -->
<g id="edge216" class="edge">
<title>l0_mha_res_add_gpu8&#45;&gt;l0_expert_8_gpu8</title>
<path fill="none" stroke="black" d="M9159.8,-3566.78C9143.77,-3557.34 9128.65,-3545.54 9117.5,-3530.95 9098.42,-3505.98 9084.62,-3421.59 9077.65,-3369.19"/>
<polygon fill="black" stroke="black" points="9081.1,-3368.62 9076.35,-3359.16 9074.16,-3369.53 9081.1,-3368.62"/>
</g>
<!-- l0_gate_gpu8 -->
<g id="node71" class="node">
<title>l0_gate_gpu8</title>
<polygon fill="lightcyan" stroke="black" points="10078.24,-3530.95 9321.44,-3530.95 9126.76,-3394.95 9883.56,-3394.95 10078.24,-3530.95"/>
<text text-anchor="middle" x="9602.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9602.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9602.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9602.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu8&#45;&gt;l0_gate_gpu8 -->
<g id="edge214" class="edge">
<title>l0_mha_res_add_gpu8&#45;&gt;l0_gate_gpu8</title>
<path fill="none" stroke="black" d="M9335.4,-3566.86C9360.91,-3557.03 9389.87,-3545.87 9419.09,-3534.61"/>
<polygon fill="black" stroke="black" points="9420.51,-3537.82 9428.59,-3530.96 9418,-3531.29 9420.51,-3537.82"/>
</g>
<!-- l0_res2_gpu8 -->
<g id="node73" class="node">
<title>l0_res2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="10156.5,-3082.95 9722.5,-3082.95 9722.5,-3014.95 10156.5,-3014.95 10156.5,-3082.95"/>
<text text-anchor="middle" x="9939.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9939.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9939.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9939.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu8&#45;&gt;l0_res2_gpu8 -->
<g id="edge234" class="edge">
<title>l0_mha_res_add_gpu8&#45;&gt;l0_res2_gpu8</title>
<path fill="none" stroke="black" d="M9466.72,-3592.34C9688.02,-3584.83 10041.12,-3573.56 10346.5,-3566.95 10384.37,-3566.13 13043.09,-3553.54 13073.5,-3530.95 13124.39,-3493.15 13069.28,-3437.25 13116.5,-3394.95 13293.04,-3236.83 13403.81,-3315.77 13639.5,-3290.95 13713.27,-3283.19 16257.41,-3307.75 16309.5,-3254.95 16351.95,-3211.93 16352.09,-3161.84 16309.5,-3118.95 16284.33,-3093.61 11201.22,-3083.56 11165.5,-3082.95 10816.93,-3077.04 10412.73,-3065.19 10166.65,-3057.42"/>
<polygon fill="black" stroke="black" points="10166.61,-3053.92 10156.51,-3057.1 10166.39,-3060.91 10166.61,-3053.92"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge217" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8855.45,-3291.67C8852.45,-3291.42 8849.47,-3291.18 8846.5,-3290.95 7448.9,-3185.44 3937.1,-3360.43 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge218" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8855.45,-3291.67C8852.45,-3291.42 8849.47,-3291.18 8846.5,-3290.95 7652.36,-3200.22 4651.64,-3345.66 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.17 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge219" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8855.45,-3291.68C8852.45,-3291.42 8849.47,-3291.18 8846.5,-3290.95 7855.82,-3215 5366.18,-3330.89 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.16 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge220" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8855.45,-3291.69C8852.45,-3291.43 8849.46,-3291.18 8846.5,-3290.95 8059.28,-3229.77 6080.72,-3316.12 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.78,-3251.47 5283.53,-3254.15 5293.22,-3258.44 5293.78,-3251.47"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge221" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8855.45,-3291.7C8852.45,-3291.44 8849.46,-3291.19 8846.5,-3290.95 7678.96,-3198.14 7379.04,-3347.74 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.78,-3251.47 6201.53,-3254.14 6211.21,-3258.44 6211.78,-3251.47"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge222" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8855.45,-3291.73C8852.45,-3291.46 8849.46,-3291.2 8846.5,-3290.95 8085.85,-3227.69 7890.15,-3318.2 7129.5,-3254.95 7129.39,-3254.94 7129.29,-3254.94 7129.18,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.49,-3251.44 7119.23,-3254.08 7128.89,-3258.42 7129.49,-3251.44"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge223" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8855.44,-3291.83C8852.44,-3291.53 8849.46,-3291.24 8846.5,-3290.95 8492.63,-3257.23 8401.37,-3288.67 8047.5,-3254.95 8047.39,-3254.94 8047.29,-3254.93 8047.18,-3254.92"/>
<polygon fill="black" stroke="black" points="8047.53,-3251.44 8037.24,-3253.96 8046.85,-3258.41 8047.53,-3251.44"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge224" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8935.13,-3290.94C8892.57,-3280.72 8843.96,-3269.04 8795.14,-3257.31"/>
<polygon fill="black" stroke="black" points="8795.91,-3253.89 8785.37,-3254.96 8794.28,-3260.7 8795.91,-3253.89"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge225" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9158.16,-3290.86C9183.59,-3281.03 9212.48,-3269.87 9241.61,-3258.61"/>
<polygon fill="black" stroke="black" points="9243.01,-3261.83 9251.08,-3254.96 9240.49,-3255.3 9243.01,-3261.83"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge226" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9289.57,-3291.9C9292.56,-3291.58 9295.54,-3291.26 9298.5,-3290.95 9557.61,-3264.11 9624.39,-3281.79 9883.5,-3254.95 9933.83,-3249.74 9987.09,-3243.05 10038.83,-3235.92"/>
<polygon fill="black" stroke="black" points="10039.39,-3239.38 10048.81,-3234.54 10038.43,-3232.45 10039.39,-3239.38"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge227" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9289.55,-3291.75C9292.55,-3291.47 9295.54,-3291.2 9298.5,-3290.95 9964.31,-3234.58 10135.69,-3311.31 10801.5,-3254.95 10852.48,-3250.64 10906.43,-3244.34 10958.72,-3237.3"/>
<polygon fill="black" stroke="black" points="10959.38,-3240.75 10968.81,-3235.94 10958.43,-3233.81 10959.38,-3240.75"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge228" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9289.55,-3291.71C9292.55,-3291.44 9295.54,-3291.19 9298.5,-3290.95 10371.18,-3205.03 10646.81,-3340.85 11719.5,-3254.95 11770.59,-3250.86 11824.65,-3244.66 11877.05,-3237.66"/>
<polygon fill="black" stroke="black" points="11877.71,-3241.1 11887.15,-3236.29 11876.78,-3234.16 11877.71,-3241.1"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge229" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9289.55,-3291.69C9292.55,-3291.43 9295.54,-3291.18 9298.5,-3290.95 10038.29,-3233.22 11897.71,-3312.67 12637.5,-3254.95 12688.7,-3250.96 12742.87,-3244.8 12795.35,-3237.8"/>
<polygon fill="black" stroke="black" points="12796.03,-3241.24 12805.48,-3236.43 12795.1,-3234.3 12796.03,-3241.24"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge230" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9289.55,-3291.68C9292.55,-3291.42 9295.53,-3291.18 9298.5,-3290.95 10241.75,-3218.44 12612.25,-3327.44 13555.5,-3254.95 13606.7,-3251.02 13660.87,-3244.89 13713.36,-3237.9"/>
<polygon fill="black" stroke="black" points="13714.04,-3241.34 13723.48,-3236.54 13713.11,-3234.4 13714.04,-3241.34"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge231" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9289.55,-3291.67C9292.55,-3291.42 9295.53,-3291.18 9298.5,-3290.95 10445.21,-3203.66 13326.79,-3342.22 14473.5,-3254.95 14524.8,-3251.05 14579.08,-3244.92 14631.65,-3237.92"/>
<polygon fill="black" stroke="black" points="14632.35,-3241.36 14641.8,-3236.56 14631.42,-3234.42 14632.35,-3241.36"/>
</g>
<!-- l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge232" class="edge">
<title>l0_expert_8_gpu8&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9289.55,-3291.67C9292.55,-3291.42 9295.53,-3291.18 9298.5,-3290.95 10648.67,-3188.89 14041.33,-3356.99 15391.5,-3254.95 15442.8,-3251.08 15497.08,-3244.96 15549.66,-3237.97"/>
<polygon fill="black" stroke="black" points="15550.36,-3241.41 15559.8,-3236.61 15549.42,-3234.47 15550.36,-3241.41"/>
</g>
<!-- l0_gate_gpu8&#45;&gt;l0_expert_8_gpu8 -->
<g id="edge215" class="edge">
<title>l0_gate_gpu8&#45;&gt;l0_expert_8_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9341.38,-3394.95C9296.36,-3383.4 9251.19,-3371.81 9211.08,-3361.51"/>
<polygon fill="black" stroke="black" points="9211.81,-3358.09 9201.26,-3358.99 9210.07,-3364.87 9211.81,-3358.09"/>
</g>
<!-- l0_expert_agg_gpu8&#45;&gt;l0_res2_gpu8 -->
<g id="edge233" class="edge">
<title>l0_expert_agg_gpu8&#45;&gt;l0_res2_gpu8</title>
<path fill="none" stroke="black" d="M9678.23,-3118.95C9721.88,-3107.42 9765.68,-3095.86 9804.6,-3085.58"/>
<polygon fill="black" stroke="black" points="9805.61,-3088.93 9814.39,-3082.99 9803.82,-3082.16 9805.61,-3088.93"/>
</g>
<!-- l1_mha_qkv_gpu8 -->
<g id="node194" class="node">
<title>l1_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10046,-2978.95 9565,-2978.95 9565,-2910.95 10046,-2910.95 10046,-2978.95"/>
<text text-anchor="middle" x="9805.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9805.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9805.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9805.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu8&#45;&gt;l1_mha_qkv_gpu8 -->
<g id="edge625" class="edge">
<title>l0_res2_gpu8&#45;&gt;l1_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M9895.99,-3014.84C9883.71,-3005.48 9870.21,-2995.21 9857.48,-2985.52"/>
<polygon fill="black" stroke="black" points="9859.32,-2982.52 9849.25,-2979.25 9855.08,-2988.09 9859.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu8 -->
<g id="node197" class="node">
<title>l1_mha_res_add_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="10158.5,-2666.95 9724.5,-2666.95 9724.5,-2598.95 10158.5,-2598.95 10158.5,-2666.95"/>
<text text-anchor="middle" x="9941.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9941.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9941.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9941.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu8&#45;&gt;l1_mha_res_add_gpu8 -->
<g id="edge629" class="edge">
<title>l0_res2_gpu8&#45;&gt;l1_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M10020.5,-3014.79C10034.51,-3005.33 10047.22,-2993.52 10055.5,-2978.95 10116.14,-2872.32 10113.64,-2809.31 10052.5,-2702.95 10045.88,-2691.43 10036.47,-2681.57 10025.91,-2673.21"/>
<polygon fill="black" stroke="black" points="10027.76,-2670.23 10017.63,-2667.11 10023.61,-2675.86 10027.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu9 -->
<g id="node75" class="node">
<title>l0_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="10152,-3842.95 9671,-3842.95 9671,-3774.95 10152,-3774.95 10152,-3842.95"/>
<text text-anchor="middle" x="9911.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9911.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9911.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9911.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu9&#45;&gt;l0_mha_attn_gpu9 -->
<g id="edge236" class="edge">
<title>l0_mha_qkv_gpu9&#45;&gt;l0_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M9753.47,-3878.84C9776.68,-3868.72 9802.36,-3857.53 9826.14,-3847.16"/>
<polygon fill="black" stroke="black" points="9827.74,-3850.28 9835.51,-3843.08 9824.94,-3843.87 9827.74,-3850.28"/>
</g>
<!-- l0_mha_out_gpu9 -->
<g id="node76" class="node">
<title>l0_mha_out_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="10266,-3738.95 9797,-3738.95 9797,-3670.95 10266,-3670.95 10266,-3738.95"/>
<text text-anchor="middle" x="10031.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10031.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10031.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="10031.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu9&#45;&gt;l0_mha_out_gpu9 -->
<g id="edge237" class="edge">
<title>l0_mha_attn_gpu9&#45;&gt;l0_mha_out_gpu9</title>
<path fill="none" stroke="black" d="M9950.46,-3774.84C9961.36,-3765.57 9973.32,-3755.41 9984.62,-3745.8"/>
<polygon fill="black" stroke="black" points="9986.97,-3748.4 9992.32,-3739.25 9982.44,-3743.06 9986.97,-3748.4"/>
</g>
<!-- l0_mha_out_gpu9&#45;&gt;l0_mha_res_add_gpu9 -->
<g id="edge238" class="edge">
<title>l0_mha_out_gpu9&#45;&gt;l0_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M10206.77,-3670.91C10264.39,-3660.04 10328.62,-3647.93 10386.98,-3636.93"/>
<polygon fill="black" stroke="black" points="10387.86,-3640.33 10397.04,-3635.03 10386.57,-3633.45 10387.86,-3640.33"/>
</g>
<!-- l0_expert_9_gpu9 -->
<g id="node78" class="node">
<title>l0_expert_9_gpu9</title>
<polygon fill="lightpink" stroke="black" points="9741.5,-3358.95 9307.5,-3358.95 9307.5,-3290.95 9741.5,-3290.95 9741.5,-3358.95"/>
<text text-anchor="middle" x="9524.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="9524.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9524.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9524.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu9&#45;&gt;l0_expert_9_gpu9 -->
<g id="edge242" class="edge">
<title>l0_mha_res_add_gpu9&#45;&gt;l0_expert_9_gpu9</title>
<path fill="none" stroke="black" d="M10789.52,-3575.46C10914.23,-3560.32 11048.11,-3541.77 11057.5,-3530.95 11097.12,-3485.3 11099.65,-3438.28 11057.5,-3394.95 11008.38,-3344.46 9893.52,-3363.93 9751.91,-3358.71"/>
<polygon fill="black" stroke="black" points="9751.73,-3355.19 9741.55,-3358.15 9751.35,-3362.18 9751.73,-3355.19"/>
</g>
<!-- l0_gate_gpu9 -->
<g id="node79" class="node">
<title>l0_gate_gpu9</title>
<polygon fill="lightcyan" stroke="black" points="11048.24,-3530.95 10291.44,-3530.95 10096.76,-3394.95 10853.56,-3394.95 11048.24,-3530.95"/>
<text text-anchor="middle" x="10572.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10572.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10572.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10572.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu9&#45;&gt;l0_gate_gpu9 -->
<g id="edge240" class="edge">
<title>l0_mha_res_add_gpu9&#45;&gt;l0_gate_gpu9</title>
<path fill="none" stroke="black" d="M10572.5,-3566.68C10572.5,-3558.86 10572.5,-3550.19 10572.5,-3541.31"/>
<polygon fill="black" stroke="black" points="10576,-3541.22 10572.5,-3531.22 10569,-3541.22 10576,-3541.22"/>
</g>
<!-- l0_res2_gpu9 -->
<g id="node81" class="node">
<title>l0_res2_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="11608.5,-3082.95 11174.5,-3082.95 11174.5,-3014.95 11608.5,-3014.95 11608.5,-3082.95"/>
<text text-anchor="middle" x="11391.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11391.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11391.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11391.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu9&#45;&gt;l0_res2_gpu9 -->
<g id="edge260" class="edge">
<title>l0_mha_res_add_gpu9&#45;&gt;l0_res2_gpu9</title>
<path fill="none" stroke="black" d="M10789.88,-3574.72C10822.88,-3571.62 10856.57,-3568.88 10888.5,-3566.95 10950.06,-3563.25 13058.68,-3567.31 13108.5,-3530.95 13160.04,-3493.34 13103.91,-3433.84 13154.5,-3394.95 13189.13,-3368.33 14679.86,-3292.88 14723.5,-3290.95 14768.33,-3288.97 16307.13,-3287.03 16338.5,-3254.95 16380.76,-3211.74 16381.07,-3161.86 16338.5,-3118.95 16293.4,-3073.5 11792.44,-3086.33 11728.5,-3082.95 11693.08,-3081.08 11655.65,-3078.26 11619.1,-3075.04"/>
<polygon fill="black" stroke="black" points="11619.1,-3071.53 11608.82,-3074.13 11618.47,-3078.5 11619.1,-3071.53"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge243" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9307.45,-3291.67C9304.45,-3291.42 9301.47,-3291.18 9298.5,-3290.95 8549.61,-3234.56 3288.39,-3311.33 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge244" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9307.45,-3291.67C9304.45,-3291.42 9301.47,-3291.18 9298.5,-3290.95 8004.18,-3192.94 4751.82,-3352.93 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.17 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge245" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9307.45,-3291.68C9304.45,-3291.42 9301.47,-3291.18 9298.5,-3290.95 8207.64,-3207.72 5466.36,-3338.16 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.17 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge246" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9307.45,-3291.68C9304.45,-3291.43 9301.47,-3291.18 9298.5,-3290.95 8411.1,-3222.5 6180.9,-3323.39 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.16 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge247" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9307.45,-3291.69C9304.45,-3291.43 9301.46,-3291.19 9298.5,-3290.95 7930.61,-3183.59 7579.39,-3362.28 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.78,-3251.47 6201.53,-3254.15 6211.21,-3258.44 6211.78,-3251.47"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge248" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9307.45,-3291.72C9304.45,-3291.45 9301.46,-3291.19 9298.5,-3290.95 8337.51,-3213.14 8090.49,-3332.74 7129.5,-3254.95 7129.4,-3254.94 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.79,-3251.47 7119.53,-3254.12 7129.21,-3258.44 7129.79,-3251.47"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge249" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9307.45,-3291.77C9304.45,-3291.48 9301.46,-3291.21 9298.5,-3290.95 8744.37,-3242.69 8601.63,-3303.21 8047.5,-3254.95 8047.39,-3254.94 8047.29,-3254.93 8047.18,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.5,-3251.44 8037.23,-3254.04 8046.88,-3258.41 8047.5,-3251.44"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge250" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9307.41,-3292.1C9304.42,-3291.71 9301.45,-3291.33 9298.5,-3290.95 9150.82,-3272.2 9113.18,-3273.71 8965.5,-3254.95 8965.28,-3254.92 8965.05,-3254.9 8964.83,-3254.87"/>
<polygon fill="black" stroke="black" points="8965.03,-3251.37 8954.67,-3253.57 8964.15,-3258.31 8965.03,-3251.37"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge251" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9500.04,-3290.68C9493.85,-3282.27 9486.95,-3272.88 9479.9,-3263.3"/>
<polygon fill="black" stroke="black" points="9482.7,-3261.2 9473.96,-3255.22 9477.06,-3265.35 9482.7,-3261.2"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge252" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9723.04,-3290.94C9818.65,-3275.05 9935.35,-3255.65 10041.57,-3237.99"/>
<polygon fill="black" stroke="black" points="10042.19,-3241.43 10051.48,-3236.34 10041.05,-3234.52 10042.19,-3241.43"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge253" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9741.56,-3291.79C9744.56,-3291.5 9747.54,-3291.22 9750.5,-3290.95 10216.01,-3249.12 10335.99,-3296.77 10801.5,-3254.95 10852.27,-3250.39 10905.99,-3243.99 10958.11,-3236.94"/>
<polygon fill="black" stroke="black" points="10958.72,-3240.39 10968.16,-3235.57 10957.78,-3233.45 10958.72,-3240.39"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge254" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9741.55,-3291.72C9744.55,-3291.45 9747.54,-3291.2 9750.5,-3290.95 10622.84,-3219.58 10847.16,-3326.31 11719.5,-3254.95 11770.59,-3250.77 11824.64,-3244.53 11877.03,-3237.51"/>
<polygon fill="black" stroke="black" points="11877.7,-3240.95 11887.14,-3236.14 11876.76,-3234.02 11877.7,-3240.95"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge255" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9741.55,-3291.7C9744.55,-3291.44 9747.54,-3291.19 9750.5,-3290.95 11029.74,-3190.03 11358.26,-3355.85 12637.5,-3254.95 12688.69,-3250.92 12742.86,-3244.73 12795.34,-3237.72"/>
<polygon fill="black" stroke="black" points="12796.03,-3241.16 12805.47,-3236.36 12795.09,-3234.23 12796.03,-3241.16"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge256" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9741.55,-3291.69C9744.55,-3291.43 9747.53,-3291.18 9750.5,-3290.95 10593.57,-3225.72 12712.43,-3320.17 13555.5,-3254.95 13606.7,-3250.99 13660.87,-3244.85 13713.35,-3237.85"/>
<polygon fill="black" stroke="black" points="13714.04,-3241.29 13723.48,-3236.49 13713.1,-3234.36 13714.04,-3241.29"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge257" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9741.55,-3291.68C9744.55,-3291.42 9747.53,-3291.18 9750.5,-3290.95 10797.03,-3210.94 13426.97,-3334.94 14473.5,-3254.95 14524.7,-3251.04 14578.87,-3244.92 14631.36,-3237.93"/>
<polygon fill="black" stroke="black" points="14632.04,-3241.37 14641.49,-3236.57 14631.11,-3234.44 14632.04,-3241.37"/>
</g>
<!-- l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge258" class="edge">
<title>l0_expert_9_gpu9&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9741.55,-3291.67C9744.55,-3291.42 9747.53,-3291.18 9750.5,-3290.95 11000.49,-3196.16 14141.51,-3349.71 15391.5,-3254.95 15442.8,-3251.06 15497.08,-3244.94 15549.66,-3237.95"/>
<polygon fill="black" stroke="black" points="15550.35,-3241.39 15559.8,-3236.59 15549.42,-3234.45 15550.35,-3241.39"/>
</g>
<!-- l0_gate_gpu9&#45;&gt;l0_expert_9_gpu9 -->
<g id="edge241" class="edge">
<title>l0_gate_gpu9&#45;&gt;l0_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10098.62,-3396.32C10094.9,-3395.86 10091.19,-3395.41 10087.5,-3394.95 9941.2,-3377.04 9901.63,-3377.8 9751.63,-3359.08"/>
<polygon fill="black" stroke="black" points="9751.95,-3355.59 9741.59,-3357.82 9751.07,-3362.54 9751.95,-3355.59"/>
</g>
<!-- l0_expert_agg_gpu9&#45;&gt;l0_res2_gpu9 -->
<g id="edge259" class="edge">
<title>l0_expert_agg_gpu9&#45;&gt;l0_res2_gpu9</title>
<path fill="none" stroke="black" d="M10638.93,-3141.42C10692.98,-3133.66 10748.9,-3125.87 10801.5,-3118.95 10920.98,-3103.25 11054.31,-3087.51 11163.96,-3075.03"/>
<polygon fill="black" stroke="black" points="11164.62,-3078.48 11174.16,-3073.87 11163.82,-3071.52 11164.62,-3078.48"/>
</g>
<!-- l1_mha_qkv_gpu9 -->
<g id="node202" class="node">
<title>l1_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11521,-2978.95 11040,-2978.95 11040,-2910.95 11521,-2910.95 11521,-2978.95"/>
<text text-anchor="middle" x="11280.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11280.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11280.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11280.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu9&#45;&gt;l1_mha_qkv_gpu9 -->
<g id="edge651" class="edge">
<title>l0_res2_gpu9&#45;&gt;l1_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M11355.46,-3014.84C11345.48,-3005.66 11334.53,-2995.6 11324.16,-2986.08"/>
<polygon fill="black" stroke="black" points="11326.47,-2983.44 11316.74,-2979.25 11321.73,-2988.6 11326.47,-2983.44"/>
</g>
<!-- l1_mha_res_add_gpu9 -->
<g id="node205" class="node">
<title>l1_mha_res_add_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="11632.5,-2666.95 11198.5,-2666.95 11198.5,-2598.95 11632.5,-2598.95 11632.5,-2666.95"/>
<text text-anchor="middle" x="11415.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11415.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11415.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11415.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu9&#45;&gt;l1_mha_res_add_gpu9 -->
<g id="edge655" class="edge">
<title>l0_res2_gpu9&#45;&gt;l1_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11492.76,-3014.89C11507.77,-3005.61 11521.27,-2993.84 11530.5,-2978.95 11562.82,-2926.82 11558.18,-2756.07 11527.5,-2702.95 11520.81,-2691.37 11511.32,-2681.48 11500.66,-2673.1"/>
<polygon fill="black" stroke="black" points="11502.44,-2670.07 11492.3,-2666.99 11498.31,-2675.72 11502.44,-2670.07"/>
</g>
<!-- l0_mha_attn_gpu10 -->
<g id="node83" class="node">
<title>l0_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="11084,-3842.95 10603,-3842.95 10603,-3774.95 11084,-3774.95 11084,-3842.95"/>
<text text-anchor="middle" x="10843.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10843.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10843.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="10843.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu10&#45;&gt;l0_mha_attn_gpu10 -->
<g id="edge262" class="edge">
<title>l0_mha_qkv_gpu10&#45;&gt;l0_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M10842.82,-3878.84C10842.9,-3870.73 10842.99,-3861.94 10843.07,-3853.43"/>
<polygon fill="black" stroke="black" points="10846.58,-3853.29 10843.17,-3843.25 10839.58,-3853.22 10846.58,-3853.29"/>
</g>
<!-- l0_mha_out_gpu10 -->
<g id="node84" class="node">
<title>l0_mha_out_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="11082,-3738.95 10613,-3738.95 10613,-3670.95 11082,-3670.95 11082,-3738.95"/>
<text text-anchor="middle" x="10847.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10847.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10847.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="10847.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu10&#45;&gt;l0_mha_out_gpu10 -->
<g id="edge263" class="edge">
<title>l0_mha_attn_gpu10&#45;&gt;l0_mha_out_gpu10</title>
<path fill="none" stroke="black" d="M10844.8,-3774.84C10845.12,-3766.73 10845.46,-3757.94 10845.8,-3749.43"/>
<polygon fill="black" stroke="black" points="10849.3,-3749.38 10846.19,-3739.25 10842.3,-3749.11 10849.3,-3749.38"/>
</g>
<!-- l0_mha_out_gpu10&#45;&gt;l0_mha_res_add_gpu10 -->
<g id="edge264" class="edge">
<title>l0_mha_out_gpu10&#45;&gt;l0_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M10934.19,-3670.84C10961.02,-3660.59 10990.74,-3649.23 11018.19,-3638.75"/>
<polygon fill="black" stroke="black" points="11019.7,-3641.92 11027.79,-3635.08 11017.2,-3635.38 11019.7,-3641.92"/>
</g>
<!-- l0_expert_10_gpu10 -->
<g id="node86" class="node">
<title>l0_expert_10_gpu10</title>
<polygon fill="lightpink" stroke="black" points="10193.5,-3358.95 9759.5,-3358.95 9759.5,-3290.95 10193.5,-3290.95 10193.5,-3358.95"/>
<text text-anchor="middle" x="9976.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="9976.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="9976.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9976.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu10&#45;&gt;l0_expert_10_gpu10 -->
<g id="edge268" class="edge">
<title>l0_mha_res_add_gpu10&#45;&gt;l0_expert_10_gpu10</title>
<path fill="none" stroke="black" d="M11121.4,-3566.82C11128.84,-3520.74 11133.94,-3438.09 11086.5,-3394.95 11051.55,-3363.18 10312.67,-3363.44 10203.64,-3358.7"/>
<polygon fill="black" stroke="black" points="10203.75,-3355.2 10193.56,-3358.09 10203.33,-3362.18 10203.75,-3355.2"/>
</g>
<!-- l0_gate_gpu10 -->
<g id="node87" class="node">
<title>l0_gate_gpu10</title>
<polygon fill="lightcyan" stroke="black" points="12094.24,-3530.95 11337.44,-3530.95 11142.76,-3394.95 11899.56,-3394.95 12094.24,-3530.95"/>
<text text-anchor="middle" x="11618.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11618.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11618.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11618.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu10&#45;&gt;l0_gate_gpu10 -->
<g id="edge266" class="edge">
<title>l0_mha_res_add_gpu10&#45;&gt;l0_gate_gpu10</title>
<path fill="none" stroke="black" d="M11236.83,-3566.94C11274.41,-3556.8 11317.28,-3545.23 11360.39,-3533.6"/>
<polygon fill="black" stroke="black" points="11361.43,-3536.95 11370.17,-3530.96 11359.61,-3530.19 11361.43,-3536.95"/>
</g>
<!-- l0_res2_gpu10 -->
<g id="node89" class="node">
<title>l0_res2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="12171.5,-3082.95 11737.5,-3082.95 11737.5,-3014.95 12171.5,-3014.95 12171.5,-3082.95"/>
<text text-anchor="middle" x="11954.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11954.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11954.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11954.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu10&#45;&gt;l0_res2_gpu10 -->
<g id="edge286" class="edge">
<title>l0_mha_res_add_gpu10&#45;&gt;l0_res2_gpu10</title>
<path fill="none" stroke="black" d="M11331.73,-3593.7C11851.46,-3578.59 13125.23,-3540.62 13145.5,-3530.95 13217.73,-3496.5 13191.39,-3429.65 13263.5,-3394.95 13352.08,-3352.33 14049.29,-3363.25 14147.5,-3358.95 14162.92,-3358.28 16356.85,-3266.12 16367.5,-3254.95 16409.23,-3211.22 16410,-3161.94 16367.5,-3118.95 16336.74,-3087.84 13261.25,-3083.77 13217.5,-3082.95 12855.14,-3076.15 12434.39,-3064.38 12181.58,-3056.89"/>
<polygon fill="black" stroke="black" points="12181.64,-3053.39 12171.54,-3056.59 12181.43,-3060.39 12181.64,-3053.39"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge269" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9759.45,-3291.67C9756.45,-3291.41 9753.47,-3291.18 9750.5,-3290.95 8951.52,-3230.92 3338.48,-3314.96 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.22,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge270" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9759.45,-3291.67C9756.45,-3291.42 9753.47,-3291.18 9750.5,-3290.95 8356,-3185.67 4852,-3360.2 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.18 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge271" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9759.45,-3291.67C9756.45,-3291.42 9753.47,-3291.18 9750.5,-3290.95 8559.46,-3200.45 5566.54,-3345.43 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.17 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge272" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9759.45,-3291.68C9756.45,-3291.42 9753.47,-3291.18 9750.5,-3290.95 8762.92,-3215.22 6281.08,-3330.66 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.16 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge273" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9759.45,-3291.69C9756.45,-3291.43 9753.46,-3291.18 9750.5,-3290.95 8966.38,-3230 6995.62,-3315.89 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.78,-3251.47 6201.53,-3254.15 6211.22,-3258.44 6211.78,-3251.47"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge274" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9759.45,-3291.7C9756.45,-3291.44 9753.46,-3291.19 9750.5,-3290.95 8589.17,-3198.59 8290.83,-3347.29 7129.5,-3254.95 7129.4,-3254.95 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.78,-3251.47 7119.53,-3254.14 7129.21,-3258.44 7129.78,-3251.47"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge275" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9759.45,-3291.73C9756.45,-3291.46 9753.46,-3291.2 9750.5,-3290.95 8996.05,-3228.14 8801.95,-3317.75 8047.5,-3254.95 8047.39,-3254.94 8047.29,-3254.94 8047.18,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.49,-3251.44 8037.23,-3254.07 8046.89,-3258.42 8047.49,-3251.44"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge276" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9759.44,-3291.84C9756.44,-3291.53 9753.46,-3291.24 9750.5,-3290.95 9402.83,-3257.68 9313.17,-3288.22 8965.5,-3254.95 8965.39,-3254.94 8965.29,-3254.93 8965.18,-3254.92"/>
<polygon fill="black" stroke="black" points="8965.53,-3251.44 8955.24,-3253.95 8964.85,-3258.41 8965.53,-3251.44"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge277" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9842.52,-3290.94C9801.1,-3280.74 9753.81,-3269.09 9706.3,-3257.38"/>
<polygon fill="black" stroke="black" points="9707.02,-3253.96 9696.48,-3254.96 9705.35,-3260.75 9707.02,-3253.96"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge278" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10065.57,-3290.86C10092.12,-3280.99 10122.3,-3269.77 10152.73,-3258.47"/>
<polygon fill="black" stroke="black" points="10154.03,-3261.72 10162.18,-3254.96 10151.59,-3255.16 10154.03,-3261.72"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge279" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10193.57,-3291.9C10196.56,-3291.57 10199.54,-3291.26 10202.5,-3290.95 10467.8,-3263.66 10536.2,-3282.24 10801.5,-3254.95 10851.83,-3249.78 10905.1,-3243.11 10956.84,-3235.99"/>
<polygon fill="black" stroke="black" points="10957.4,-3239.44 10966.82,-3234.6 10956.44,-3232.51 10957.4,-3239.44"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge280" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10193.55,-3291.74C10196.55,-3291.47 10199.54,-3291.2 10202.5,-3290.95 10874.51,-3234.13 11047.48,-3311.76 11719.5,-3254.95 11770.48,-3250.64 11824.43,-3244.35 11876.72,-3237.31"/>
<polygon fill="black" stroke="black" points="11877.38,-3240.76 11886.82,-3235.95 11876.44,-3233.82 11877.38,-3240.76"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge281" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10193.55,-3291.71C10196.55,-3291.44 10199.54,-3291.19 10202.5,-3290.95 11281.39,-3204.58 11558.61,-3341.3 12637.5,-3254.95 12688.59,-3250.86 12742.65,-3244.67 12795.05,-3237.66"/>
<polygon fill="black" stroke="black" points="12795.71,-3241.1 12805.15,-3236.3 12794.78,-3234.17 12795.71,-3241.1"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge282" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10193.55,-3291.69C10196.55,-3291.43 10199.54,-3291.18 10202.5,-3290.95 10945.4,-3232.99 12812.6,-3312.9 13555.5,-3254.95 13606.7,-3250.96 13660.87,-3244.8 13713.35,-3237.8"/>
<polygon fill="black" stroke="black" points="13714.03,-3241.24 13723.48,-3236.43 13713.1,-3234.3 13714.03,-3241.24"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge283" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10193.55,-3291.68C10196.55,-3291.42 10199.53,-3291.18 10202.5,-3290.95 11148.85,-3218.21 13527.14,-3327.67 14473.5,-3254.95 14524.7,-3251.02 14578.87,-3244.89 14631.36,-3237.9"/>
<polygon fill="black" stroke="black" points="14632.04,-3241.34 14641.48,-3236.54 14631.11,-3234.4 14632.04,-3241.34"/>
</g>
<!-- l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge284" class="edge">
<title>l0_expert_10_gpu10&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10193.55,-3291.67C10196.55,-3291.42 10199.53,-3291.18 10202.5,-3290.95 11352.31,-3203.44 14241.68,-3342.44 15391.5,-3254.95 15442.8,-3251.05 15497.08,-3244.92 15549.65,-3237.92"/>
<polygon fill="black" stroke="black" points="15550.35,-3241.36 15559.8,-3236.56 15549.42,-3234.42 15550.35,-3241.36"/>
</g>
<!-- l0_gate_gpu10&#45;&gt;l0_expert_10_gpu10 -->
<g id="edge267" class="edge">
<title>l0_gate_gpu10&#45;&gt;l0_expert_10_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11144.63,-3396.41C11139.22,-3395.91 11133.85,-3395.42 11128.5,-3394.95 10721.51,-3359.3 10614.35,-3396.16 10203.63,-3359.02"/>
<polygon fill="black" stroke="black" points="10203.84,-3355.52 10193.56,-3358.1 10203.2,-3362.49 10203.84,-3355.52"/>
</g>
<!-- l0_expert_agg_gpu10&#45;&gt;l0_res2_gpu10 -->
<g id="edge285" class="edge">
<title>l0_expert_agg_gpu10&#45;&gt;l0_res2_gpu10</title>
<path fill="none" stroke="black" d="M11542.28,-3130.73C11621.18,-3115.27 11704.74,-3098.9 11775.86,-3084.96"/>
<polygon fill="black" stroke="black" points="11776.67,-3088.37 11785.81,-3083.01 11775.32,-3081.5 11776.67,-3088.37"/>
</g>
<!-- l1_mha_qkv_gpu10 -->
<g id="node210" class="node">
<title>l1_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12061,-2978.95 11580,-2978.95 11580,-2910.95 12061,-2910.95 12061,-2978.95"/>
<text text-anchor="middle" x="11820.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11820.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11820.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11820.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu10&#45;&gt;l1_mha_qkv_gpu10 -->
<g id="edge677" class="edge">
<title>l0_res2_gpu10&#45;&gt;l1_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M11910.99,-3014.84C11898.71,-3005.48 11885.21,-2995.21 11872.48,-2985.52"/>
<polygon fill="black" stroke="black" points="11874.32,-2982.52 11864.25,-2979.25 11870.08,-2988.09 11874.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu10 -->
<g id="node213" class="node">
<title>l1_mha_res_add_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="12174.5,-2666.95 11740.5,-2666.95 11740.5,-2598.95 12174.5,-2598.95 12174.5,-2666.95"/>
<text text-anchor="middle" x="11957.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11957.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11957.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11957.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu10&#45;&gt;l1_mha_res_add_gpu10 -->
<g id="edge681" class="edge">
<title>l0_res2_gpu10&#45;&gt;l1_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M12035.5,-3014.79C12049.51,-3005.33 12062.22,-2993.52 12070.5,-2978.95 12131.14,-2872.32 12128.42,-2809.43 12067.5,-2702.95 12060.9,-2691.41 12051.5,-2681.53 12040.95,-2673.15"/>
<polygon fill="black" stroke="black" points="12042.8,-2670.17 12032.68,-2667.03 12038.64,-2675.8 12042.8,-2670.17"/>
</g>
<!-- l0_mha_attn_gpu11 -->
<g id="node91" class="node">
<title>l0_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="12326,-3842.95 11845,-3842.95 11845,-3774.95 12326,-3774.95 12326,-3842.95"/>
<text text-anchor="middle" x="12085.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="12085.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12085.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="12085.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu11&#45;&gt;l0_mha_attn_gpu11 -->
<g id="edge288" class="edge">
<title>l0_mha_qkv_gpu11&#45;&gt;l0_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M11769.12,-3878.91C11818.56,-3868.13 11873.61,-3856.13 11923.76,-3845.2"/>
<polygon fill="black" stroke="black" points="11924.69,-3848.58 11933.72,-3843.03 11923.2,-3841.74 11924.69,-3848.58"/>
</g>
<!-- l0_mha_out_gpu11 -->
<g id="node92" class="node">
<title>l0_mha_out_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="12381,-3738.95 11912,-3738.95 11912,-3670.95 12381,-3670.95 12381,-3738.95"/>
<text text-anchor="middle" x="12146.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12146.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12146.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="12146.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu11&#45;&gt;l0_mha_out_gpu11 -->
<g id="edge289" class="edge">
<title>l0_mha_attn_gpu11&#45;&gt;l0_mha_out_gpu11</title>
<path fill="none" stroke="black" d="M12105.3,-3774.84C12110.42,-3766.29 12115.99,-3756.97 12121.34,-3748.03"/>
<polygon fill="black" stroke="black" points="12124.46,-3749.63 12126.59,-3739.25 12118.45,-3746.04 12124.46,-3749.63"/>
</g>
<!-- l0_mha_out_gpu11&#45;&gt;l0_mha_res_add_gpu11 -->
<g id="edge290" class="edge">
<title>l0_mha_out_gpu11&#45;&gt;l0_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M12289.7,-3670.91C12336.19,-3660.18 12387.95,-3648.23 12435.15,-3637.34"/>
<polygon fill="black" stroke="black" points="12436.19,-3640.69 12445.15,-3635.03 12434.62,-3633.87 12436.19,-3640.69"/>
</g>
<!-- l0_expert_11_gpu11 -->
<g id="node94" class="node">
<title>l0_expert_11_gpu11</title>
<polygon fill="lightpink" stroke="black" points="10645.5,-3358.95 10211.5,-3358.95 10211.5,-3290.95 10645.5,-3290.95 10645.5,-3358.95"/>
<text text-anchor="middle" x="10428.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="10428.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10428.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10428.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu11&#45;&gt;l0_expert_11_gpu11 -->
<g id="edge294" class="edge">
<title>l0_mha_res_add_gpu11&#45;&gt;l0_expert_11_gpu11</title>
<path fill="none" stroke="black" d="M12805.56,-3596.2C12917.52,-3589.18 13037.96,-3571.9 13073.5,-3530.95 13113.12,-3485.3 13115.92,-3438.01 13073.5,-3394.95 13027.53,-3348.3 10837.07,-3363.49 10655.57,-3358.62"/>
<polygon fill="black" stroke="black" points="10655.69,-3355.12 10645.55,-3358.2 10655.39,-3362.12 10655.69,-3355.12"/>
</g>
<!-- l0_gate_gpu11 -->
<g id="node95" class="node">
<title>l0_gate_gpu11</title>
<polygon fill="lightcyan" stroke="black" points="13064.24,-3530.95 12307.44,-3530.95 12112.76,-3394.95 12869.56,-3394.95 13064.24,-3530.95"/>
<text text-anchor="middle" x="12588.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12588.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12588.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12588.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu11&#45;&gt;l0_gate_gpu11 -->
<g id="edge292" class="edge">
<title>l0_mha_res_add_gpu11&#45;&gt;l0_gate_gpu11</title>
<path fill="none" stroke="black" d="M12588.5,-3566.68C12588.5,-3558.86 12588.5,-3550.19 12588.5,-3541.31"/>
<polygon fill="black" stroke="black" points="12592,-3541.22 12588.5,-3531.22 12585,-3541.22 12592,-3541.22"/>
</g>
<!-- l0_res2_gpu11 -->
<g id="node97" class="node">
<title>l0_res2_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="13660.5,-3082.95 13226.5,-3082.95 13226.5,-3014.95 13660.5,-3014.95 13660.5,-3082.95"/>
<text text-anchor="middle" x="13443.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13443.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13443.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13443.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu11&#45;&gt;l0_res2_gpu11 -->
<g id="edge312" class="edge">
<title>l0_mha_res_add_gpu11&#45;&gt;l0_res2_gpu11</title>
<path fill="none" stroke="black" d="M12805.72,-3580.73C12873.79,-3575.39 12949.22,-3570.18 13018.5,-3566.95 13139.77,-3561.31 15093.91,-3583.19 15203.5,-3530.95 15274.7,-3497.02 15248.33,-3432.84 15317.5,-3394.95 15423.53,-3336.88 16316.7,-3345.77 16396.5,-3254.95 16436.4,-3209.55 16438.94,-3162 16396.5,-3118.95 16371.76,-3093.86 13894.7,-3084.6 13859.5,-3082.95 13798.23,-3080.09 13731.99,-3075.51 13670.76,-3070.67"/>
<polygon fill="black" stroke="black" points="13670.83,-3067.16 13660.59,-3069.86 13670.28,-3074.14 13670.83,-3067.16"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge295" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10211.45,-3291.67C10208.45,-3291.41 10205.47,-3291.18 10202.5,-3290.95 9353.43,-3227.29 3388.57,-3318.6 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.23,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge296" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10211.45,-3291.67C10208.45,-3291.42 10205.47,-3291.18 10202.5,-3290.95 9455.16,-3234.67 4204.84,-3311.22 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.18 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge297" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10211.45,-3291.67C10208.45,-3291.42 10205.47,-3291.18 10202.5,-3290.95 8911.28,-3193.17 5666.72,-3352.71 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.17 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge298" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10211.45,-3291.68C10208.45,-3291.42 10205.47,-3291.18 10202.5,-3290.95 9114.74,-3207.95 6381.26,-3337.94 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.17 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge299" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10211.45,-3291.68C10208.45,-3291.43 10205.47,-3291.18 10202.5,-3290.95 9318.2,-3222.72 7095.8,-3323.16 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.77,-3251.46 6201.53,-3254.16 6211.22,-3258.44 6211.77,-3251.46"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge300" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10211.45,-3291.69C10208.45,-3291.43 10205.46,-3291.19 10202.5,-3290.95 8840.82,-3184.04 8491.18,-3361.83 7129.5,-3254.95 7129.4,-3254.95 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.78,-3251.47 7119.53,-3254.15 7129.21,-3258.44 7129.78,-3251.47"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge301" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10211.45,-3291.72C10208.45,-3291.45 10205.46,-3291.19 10202.5,-3290.95 9247.72,-3213.59 9002.28,-3332.29 8047.5,-3254.95 8047.4,-3254.94 8047.29,-3254.94 8047.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.79,-3251.47 8037.53,-3254.12 8047.21,-3258.44 8047.79,-3251.47"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge302" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10211.45,-3291.77C10208.45,-3291.48 10205.46,-3291.21 10202.5,-3290.95 9654.57,-3243.14 9513.43,-3302.75 8965.5,-3254.95 8965.39,-3254.94 8965.29,-3254.93 8965.18,-3254.93"/>
<polygon fill="black" stroke="black" points="8965.5,-3251.44 8955.23,-3254.04 8964.88,-3258.41 8965.5,-3251.44"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge303" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10211.41,-3292.12C10208.42,-3291.72 10205.45,-3291.33 10202.5,-3290.95 10061,-3272.64 10025,-3273.26 9883.5,-3254.95 9883.28,-3254.92 9883.05,-3254.9 9882.83,-3254.87"/>
<polygon fill="black" stroke="black" points="9883.04,-3251.36 9872.67,-3253.55 9882.14,-3258.31 9883.04,-3251.36"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge304" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10407.46,-3290.68C10402.25,-3282.44 10396.44,-3273.26 10390.51,-3263.87"/>
<polygon fill="black" stroke="black" points="10393.34,-3261.8 10385.03,-3255.22 10387.42,-3265.54 10393.34,-3261.8"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge305" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10630.43,-3290.94C10728.85,-3274.86 10849.23,-3255.18 10958.3,-3237.35"/>
<polygon fill="black" stroke="black" points="10959.18,-3240.75 10968.48,-3235.69 10958.05,-3233.85 10959.18,-3240.75"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge306" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10645.56,-3291.79C10648.56,-3291.5 10651.54,-3291.22 10654.5,-3290.95 11126.21,-3248.67 11247.79,-3297.22 11719.5,-3254.95 11770.27,-3250.4 11823.99,-3244.01 11876.11,-3236.96"/>
<polygon fill="black" stroke="black" points="11876.73,-3240.41 11886.16,-3235.59 11875.78,-3233.47 11876.73,-3240.41"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge307" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10645.55,-3291.72C10648.55,-3291.45 10651.54,-3291.2 10654.5,-3290.95 11533.05,-3219.13 11758.95,-3326.76 12637.5,-3254.95 12688.59,-3250.78 12742.64,-3244.54 12795.04,-3237.52"/>
<polygon fill="black" stroke="black" points="12795.7,-3240.96 12805.14,-3236.15 12794.76,-3234.02 12795.7,-3240.96"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge308" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10645.55,-3291.7C10648.55,-3291.44 10651.54,-3291.19 10654.5,-3290.95 11939.94,-3189.58 12270.06,-3356.3 13555.5,-3254.95 13606.69,-3250.92 13660.86,-3244.74 13713.34,-3237.73"/>
<polygon fill="black" stroke="black" points="13714.03,-3241.17 13723.47,-3236.36 13713.09,-3234.23 13714.03,-3241.17"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge309" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10645.55,-3291.69C10648.55,-3291.43 10651.53,-3291.18 10654.5,-3290.95 11500.68,-3225.49 13627.32,-3320.4 14473.5,-3254.95 14524.7,-3250.99 14578.87,-3244.85 14631.36,-3237.86"/>
<polygon fill="black" stroke="black" points="14632.04,-3241.3 14641.48,-3236.49 14631.1,-3234.36 14632.04,-3241.3"/>
</g>
<!-- l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge310" class="edge">
<title>l0_expert_11_gpu11&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10645.55,-3291.68C10648.55,-3291.42 10651.53,-3291.18 10654.5,-3290.95 11704.13,-3210.71 14341.86,-3335.17 15391.5,-3254.95 15442.7,-3251.04 15496.87,-3244.92 15549.36,-3237.93"/>
<polygon fill="black" stroke="black" points="15550.04,-3241.37 15559.49,-3236.57 15549.11,-3234.44 15550.04,-3241.37"/>
</g>
<!-- l0_gate_gpu11&#45;&gt;l0_expert_11_gpu11 -->
<g id="edge293" class="edge">
<title>l0_gate_gpu11&#45;&gt;l0_expert_11_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12113.7,-3395.8C12110.29,-3395.51 12106.89,-3395.23 12103.5,-3394.95 11464.71,-3343.06 11298.08,-3412.87 10655.53,-3359"/>
<polygon fill="black" stroke="black" points="10655.81,-3355.51 10645.55,-3358.16 10655.22,-3362.49 10655.81,-3355.51"/>
</g>
<!-- l0_expert_agg_gpu11&#45;&gt;l0_res2_gpu11 -->
<g id="edge311" class="edge">
<title>l0_expert_agg_gpu11&#45;&gt;l0_res2_gpu11</title>
<path fill="none" stroke="black" d="M12473.22,-3140.28C12527.77,-3132.59 12584.3,-3125.11 12637.5,-3118.95 12832.4,-3096.41 13054.6,-3077.92 13216.27,-3065.78"/>
<polygon fill="black" stroke="black" points="13216.64,-3069.26 13226.35,-3065.02 13216.11,-3062.28 13216.64,-3069.26"/>
</g>
<!-- l1_mha_qkv_gpu11 -->
<g id="node218" class="node">
<title>l1_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13573,-2978.95 13092,-2978.95 13092,-2910.95 13573,-2910.95 13573,-2978.95"/>
<text text-anchor="middle" x="13332.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13332.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13332.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13332.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu11&#45;&gt;l1_mha_qkv_gpu11 -->
<g id="edge703" class="edge">
<title>l0_res2_gpu11&#45;&gt;l1_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M13407.46,-3014.84C13397.48,-3005.66 13386.53,-2995.6 13376.16,-2986.08"/>
<polygon fill="black" stroke="black" points="13378.47,-2983.44 13368.74,-2979.25 13373.73,-2988.6 13378.47,-2983.44"/>
</g>
<!-- l1_mha_res_add_gpu11 -->
<g id="node221" class="node">
<title>l1_mha_res_add_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="13762.5,-2666.95 13328.5,-2666.95 13328.5,-2598.95 13762.5,-2598.95 13762.5,-2666.95"/>
<text text-anchor="middle" x="13545.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13545.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13545.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13545.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu11&#45;&gt;l1_mha_res_add_gpu11 -->
<g id="edge707" class="edge">
<title>l0_res2_gpu11&#45;&gt;l1_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M13544.76,-3014.89C13559.77,-3005.61 13573.27,-2993.84 13582.5,-2978.95 13647.14,-2874.69 13609.06,-2822.01 13579.5,-2702.95 13577.28,-2694.01 13573.78,-2684.87 13569.86,-2676.29"/>
<polygon fill="black" stroke="black" points="13572.99,-2674.72 13565.48,-2667.24 13566.69,-2677.77 13572.99,-2674.72"/>
</g>
<!-- l0_mha_attn_gpu12 -->
<g id="node99" class="node">
<title>l0_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13070,-3842.95 12589,-3842.95 12589,-3774.95 13070,-3774.95 13070,-3842.95"/>
<text text-anchor="middle" x="12829.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="12829.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12829.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="12829.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu12&#45;&gt;l0_mha_attn_gpu12 -->
<g id="edge314" class="edge">
<title>l0_mha_qkv_gpu12&#45;&gt;l0_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M12789.66,-3878.84C12794.6,-3870.29 12799.99,-3860.97 12805.16,-3852.03"/>
<polygon fill="black" stroke="black" points="12808.26,-3853.66 12810.24,-3843.25 12802.2,-3850.16 12808.26,-3853.66"/>
</g>
<!-- l0_mha_out_gpu12 -->
<g id="node100" class="node">
<title>l0_mha_out_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13125,-3738.95 12656,-3738.95 12656,-3670.95 13125,-3670.95 13125,-3738.95"/>
<text text-anchor="middle" x="12890.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12890.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12890.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="12890.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu12&#45;&gt;l0_mha_out_gpu12 -->
<g id="edge315" class="edge">
<title>l0_mha_attn_gpu12&#45;&gt;l0_mha_out_gpu12</title>
<path fill="none" stroke="black" d="M12849.3,-3774.84C12854.42,-3766.29 12859.99,-3756.97 12865.34,-3748.03"/>
<polygon fill="black" stroke="black" points="12868.46,-3749.63 12870.59,-3739.25 12862.45,-3746.04 12868.46,-3749.63"/>
</g>
<!-- l0_mha_out_gpu12&#45;&gt;l0_mha_res_add_gpu12 -->
<g id="edge316" class="edge">
<title>l0_mha_out_gpu12&#45;&gt;l0_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M13005.43,-3670.84C13042.04,-3660.29 13082.69,-3648.58 13119.94,-3637.84"/>
<polygon fill="black" stroke="black" points="13121.2,-3641.12 13129.84,-3634.99 13119.26,-3634.4 13121.2,-3641.12"/>
</g>
<!-- l0_expert_12_gpu12 -->
<g id="node102" class="node">
<title>l0_expert_12_gpu12</title>
<polygon fill="lightpink" stroke="black" points="11097.5,-3358.95 10663.5,-3358.95 10663.5,-3290.95 11097.5,-3290.95 11097.5,-3358.95"/>
<text text-anchor="middle" x="10880.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10880.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="10880.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10880.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu12&#45;&gt;l0_expert_12_gpu12 -->
<g id="edge320" class="edge">
<title>l0_mha_res_add_gpu12&#45;&gt;l0_expert_12_gpu12</title>
<path fill="none" stroke="black" d="M13232.71,-3566.6C13213.73,-3518.62 13171.4,-3431.84 13102.5,-3394.95 13006.87,-3343.76 11294.78,-3366.91 11107.81,-3358.78"/>
<polygon fill="black" stroke="black" points="11107.74,-3355.27 11097.55,-3358.19 11107.33,-3362.26 11107.74,-3355.27"/>
</g>
<!-- l0_gate_gpu12 -->
<g id="node103" class="node">
<title>l0_gate_gpu12</title>
<polygon fill="lightcyan" stroke="black" points="14224.24,-3530.95 13467.44,-3530.95 13272.76,-3394.95 14029.56,-3394.95 14224.24,-3530.95"/>
<text text-anchor="middle" x="13748.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="13748.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13748.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13748.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu12&#45;&gt;l0_gate_gpu12 -->
<g id="edge318" class="edge">
<title>l0_mha_res_add_gpu12&#45;&gt;l0_gate_gpu12</title>
<path fill="none" stroke="black" d="M13366.83,-3566.94C13404.41,-3556.8 13447.28,-3545.23 13490.39,-3533.6"/>
<polygon fill="black" stroke="black" points="13491.43,-3536.95 13500.17,-3530.96 13489.61,-3530.19 13491.43,-3536.95"/>
</g>
<!-- l0_res2_gpu12 -->
<g id="node105" class="node">
<title>l0_res2_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14302.5,-3082.95 13868.5,-3082.95 13868.5,-3014.95 14302.5,-3014.95 14302.5,-3082.95"/>
<text text-anchor="middle" x="14085.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14085.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14085.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14085.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu12&#45;&gt;l0_res2_gpu12 -->
<g id="edge338" class="edge">
<title>l0_mha_res_add_gpu12&#45;&gt;l0_res2_gpu12</title>
<path fill="none" stroke="black" d="M13461.77,-3593.79C13710.75,-3586.82 14131.04,-3575.36 14492.5,-3566.95 14542.36,-3565.79 16248.08,-3561.5 16287.5,-3530.95 16337.11,-3492.51 16294.73,-3449.65 16325.5,-3394.95 16367.27,-3320.68 16425.2,-3334.21 16456.5,-3254.95 16478.7,-3198.73 16498.61,-3162.31 16456.5,-3118.95 16447.23,-3109.4 14904.6,-3070.23 14312.9,-3055.55"/>
<polygon fill="black" stroke="black" points="14312.62,-3052.04 14302.53,-3055.29 14312.45,-3059.04 14312.62,-3052.04"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge321" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10663.45,-3291.66C10660.45,-3291.41 10657.47,-3291.18 10654.5,-3290.95 9755.34,-3223.65 3438.66,-3322.24 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.23,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge322" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10663.45,-3291.67C10660.45,-3291.41 10657.47,-3291.18 10654.5,-3290.95 9857.07,-3231.04 4254.93,-3314.85 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.18 3457.22,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge323" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10663.45,-3291.67C10660.45,-3291.42 10657.47,-3291.18 10654.5,-3290.95 9263.1,-3185.89 5766.9,-3359.98 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.18 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge324" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10663.45,-3291.67C10660.45,-3291.42 10657.47,-3291.18 10654.5,-3290.95 9466.57,-3200.67 6481.44,-3345.21 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.17 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge325" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10663.45,-3291.68C10660.45,-3291.42 10657.47,-3291.18 10654.5,-3290.95 9670.03,-3215.45 7195.98,-3330.44 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.77,-3251.46 6201.53,-3254.16 6211.22,-3258.44 6211.77,-3251.46"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge326" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10663.45,-3291.69C10660.45,-3291.43 10657.46,-3291.18 10654.5,-3290.95 9873.48,-3230.22 7910.52,-3315.67 7129.5,-3254.95 7129.4,-3254.95 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.78,-3251.47 7119.53,-3254.15 7129.22,-3258.44 7129.78,-3251.47"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge327" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10663.45,-3291.7C10660.45,-3291.44 10657.46,-3291.19 10654.5,-3290.95 9499.37,-3199.04 9202.63,-3346.84 8047.5,-3254.95 8047.4,-3254.95 8047.29,-3254.94 8047.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.78,-3251.47 8037.53,-3254.14 8047.21,-3258.44 8047.78,-3251.47"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge328" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10663.45,-3291.73C10660.45,-3291.46 10657.46,-3291.2 10654.5,-3290.95 9906.26,-3228.59 9713.74,-3317.3 8965.5,-3254.95 8965.39,-3254.94 8965.29,-3254.94 8965.18,-3254.93"/>
<polygon fill="black" stroke="black" points="8965.49,-3251.44 8955.23,-3254.07 8964.89,-3258.42 8965.49,-3251.44"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge329" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10663.44,-3291.84C10660.44,-3291.53 10657.46,-3291.24 10654.5,-3290.95 10313.03,-3258.13 10224.97,-3287.77 9883.5,-3254.95 9883.39,-3254.94 9883.29,-3254.93 9883.18,-3254.92"/>
<polygon fill="black" stroke="black" points="9883.53,-3251.44 9873.24,-3253.95 9882.85,-3258.41 9883.53,-3251.44"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge330" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10749.92,-3290.94C10709.64,-3280.76 10663.65,-3269.14 10617.44,-3257.45"/>
<polygon fill="black" stroke="black" points="10618.13,-3254.02 10607.58,-3254.96 10616.41,-3260.81 10618.13,-3254.02"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge331" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10972.97,-3290.86C11000.55,-3280.99 11031.88,-3269.77 11063.48,-3258.47"/>
<polygon fill="black" stroke="black" points="11065.05,-3261.62 11073.28,-3254.96 11062.69,-3255.03 11065.05,-3261.62"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge332" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11097.57,-3291.89C11100.56,-3291.57 11103.54,-3291.26 11106.5,-3290.95 11378,-3263.21 11448,-3282.69 11719.5,-3254.95 11769.93,-3249.8 11823.3,-3243.13 11875.13,-3236"/>
<polygon fill="black" stroke="black" points="11875.71,-3239.46 11885.13,-3234.62 11874.75,-3232.52 11875.71,-3239.46"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge333" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11097.55,-3291.74C11100.55,-3291.47 11103.54,-3291.2 11106.5,-3290.95 11784.72,-3233.68 11959.28,-3312.21 12637.5,-3254.95 12688.48,-3250.65 12742.43,-3244.35 12794.73,-3237.32"/>
<polygon fill="black" stroke="black" points="12795.38,-3240.77 12804.82,-3235.96 12794.44,-3233.83 12795.38,-3240.77"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge334" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11097.55,-3291.71C11100.55,-3291.44 11103.54,-3291.19 11106.5,-3290.95 12191.59,-3204.13 12470.4,-3341.75 13555.5,-3254.95 13606.59,-3250.87 13660.65,-3244.67 13713.05,-3237.67"/>
<polygon fill="black" stroke="black" points="13713.71,-3241.11 13723.16,-3236.3 13712.78,-3234.17 13713.71,-3241.11"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge335" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11097.55,-3291.69C11100.55,-3291.43 11103.54,-3291.18 11106.5,-3290.95 11852.5,-3232.77 13727.5,-3313.12 14473.5,-3254.95 14524.7,-3250.96 14578.87,-3244.8 14631.35,-3237.8"/>
<polygon fill="black" stroke="black" points="14632.03,-3241.24 14641.48,-3236.44 14631.1,-3234.3 14632.03,-3241.24"/>
</g>
<!-- l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge336" class="edge">
<title>l0_expert_12_gpu12&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11097.55,-3291.68C11100.55,-3291.42 11103.53,-3291.18 11106.5,-3290.95 12055.96,-3217.99 14442.04,-3327.89 15391.5,-3254.95 15442.7,-3251.02 15496.87,-3244.89 15549.36,-3237.9"/>
<polygon fill="black" stroke="black" points="15550.04,-3241.34 15559.48,-3236.54 15549.11,-3234.4 15550.04,-3241.34"/>
</g>
<!-- l0_gate_gpu12&#45;&gt;l0_expert_12_gpu12 -->
<g id="edge319" class="edge">
<title>l0_gate_gpu12&#45;&gt;l0_expert_12_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13274.32,-3396.21C13269.02,-3395.77 13263.74,-3395.35 13258.5,-3394.95 12308.08,-3322.29 12061.69,-3435.41 11107.74,-3359.01"/>
<polygon fill="black" stroke="black" points="11107.8,-3355.51 11097.55,-3358.19 11107.24,-3362.48 11107.8,-3355.51"/>
</g>
<!-- l0_expert_agg_gpu12&#45;&gt;l0_res2_gpu12 -->
<g id="edge337" class="edge">
<title>l0_expert_agg_gpu12&#45;&gt;l0_res2_gpu12</title>
<path fill="none" stroke="black" d="M13393.62,-3141.9C13447.47,-3134.11 13503.15,-3126.18 13555.5,-3118.95 13654.72,-3105.25 13764.49,-3090.84 13858.28,-3078.75"/>
<polygon fill="black" stroke="black" points="13859,-3082.19 13868.47,-3077.44 13858.11,-3075.24 13859,-3082.19"/>
</g>
<!-- l1_mha_qkv_gpu12 -->
<g id="node226" class="node">
<title>l1_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14192,-2978.95 13711,-2978.95 13711,-2910.95 14192,-2910.95 14192,-2978.95"/>
<text text-anchor="middle" x="13951.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13951.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13951.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13951.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu12&#45;&gt;l1_mha_qkv_gpu12 -->
<g id="edge729" class="edge">
<title>l0_res2_gpu12&#45;&gt;l1_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M14041.99,-3014.84C14029.71,-3005.48 14016.21,-2995.21 14003.48,-2985.52"/>
<polygon fill="black" stroke="black" points="14005.32,-2982.52 13995.25,-2979.25 14001.08,-2988.09 14005.32,-2982.52"/>
</g>
<!-- l1_mha_res_add_gpu12 -->
<g id="node229" class="node">
<title>l1_mha_res_add_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14304.5,-2666.95 13870.5,-2666.95 13870.5,-2598.95 14304.5,-2598.95 14304.5,-2666.95"/>
<text text-anchor="middle" x="14087.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14087.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14087.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14087.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu12&#45;&gt;l1_mha_res_add_gpu12 -->
<g id="edge733" class="edge">
<title>l0_res2_gpu12&#45;&gt;l1_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M14166.5,-3014.79C14180.51,-3005.33 14193.22,-2993.52 14201.5,-2978.95 14262.14,-2872.32 14259.64,-2809.31 14198.5,-2702.95 14191.88,-2691.43 14182.47,-2681.57 14171.91,-2673.21"/>
<polygon fill="black" stroke="black" points="14173.76,-2670.23 14163.63,-2667.11 14169.61,-2675.86 14173.76,-2670.23"/>
</g>
<!-- l0_mha_attn_gpu13 -->
<g id="node107" class="node">
<title>l0_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13842,-3842.95 13361,-3842.95 13361,-3774.95 13842,-3774.95 13842,-3842.95"/>
<text text-anchor="middle" x="13601.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13601.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13601.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13601.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu13&#45;&gt;l0_mha_attn_gpu13 -->
<g id="edge340" class="edge">
<title>l0_mha_qkv_gpu13&#45;&gt;l0_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M13601.5,-3878.84C13601.5,-3870.73 13601.5,-3861.94 13601.5,-3853.43"/>
<polygon fill="black" stroke="black" points="13605,-3853.25 13601.5,-3843.25 13598,-3853.25 13605,-3853.25"/>
</g>
<!-- l0_mha_out_gpu13 -->
<g id="node108" class="node">
<title>l0_mha_out_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13839,-3738.95 13370,-3738.95 13370,-3670.95 13839,-3670.95 13839,-3738.95"/>
<text text-anchor="middle" x="13604.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13604.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13604.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13604.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu13&#45;&gt;l0_mha_out_gpu13 -->
<g id="edge341" class="edge">
<title>l0_mha_attn_gpu13&#45;&gt;l0_mha_out_gpu13</title>
<path fill="none" stroke="black" d="M13602.47,-3774.84C13602.71,-3766.73 13602.97,-3757.94 13603.22,-3749.43"/>
<polygon fill="black" stroke="black" points="13606.73,-3749.35 13603.52,-3739.25 13599.73,-3749.15 13606.73,-3749.35"/>
</g>
<!-- l0_mha_out_gpu13&#45;&gt;l0_mha_res_add_gpu13 -->
<g id="edge342" class="edge">
<title>l0_mha_out_gpu13&#45;&gt;l0_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M13839.2,-3672.83C13845.02,-3672.18 13850.8,-3671.55 13856.5,-3670.95 14071.43,-3648.29 14317.21,-3629.3 14491.19,-3617.01"/>
<polygon fill="black" stroke="black" points="14491.51,-3620.5 14501.24,-3616.31 14491.01,-3613.52 14491.51,-3620.5"/>
</g>
<!-- l0_expert_13_gpu13 -->
<g id="node110" class="node">
<title>l0_expert_13_gpu13</title>
<polygon fill="lightpink" stroke="black" points="11549.5,-3358.95 11115.5,-3358.95 11115.5,-3290.95 11549.5,-3290.95 11549.5,-3358.95"/>
<text text-anchor="middle" x="11332.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11332.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11332.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11332.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu13&#45;&gt;l0_expert_13_gpu13 -->
<g id="edge346" class="edge">
<title>l0_mha_res_add_gpu13&#45;&gt;l0_expert_13_gpu13</title>
<path fill="none" stroke="black" d="M14935.52,-3575.46C15060.23,-3560.32 15194.11,-3541.77 15203.5,-3530.95 15243.12,-3485.3 15246.03,-3437.9 15203.5,-3394.95 15168.73,-3359.84 11777.26,-3362.71 11559.73,-3358.54"/>
<polygon fill="black" stroke="black" points="11559.65,-3355.04 11549.55,-3358.22 11559.43,-3362.03 11559.65,-3355.04"/>
</g>
<!-- l0_gate_gpu13 -->
<g id="node111" class="node">
<title>l0_gate_gpu13</title>
<polygon fill="lightcyan" stroke="black" points="15194.24,-3530.95 14437.44,-3530.95 14242.76,-3394.95 14999.56,-3394.95 15194.24,-3530.95"/>
<text text-anchor="middle" x="14718.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="14718.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14718.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14718.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu13&#45;&gt;l0_gate_gpu13 -->
<g id="edge344" class="edge">
<title>l0_mha_res_add_gpu13&#45;&gt;l0_gate_gpu13</title>
<path fill="none" stroke="black" d="M14718.5,-3566.68C14718.5,-3558.86 14718.5,-3550.19 14718.5,-3541.31"/>
<polygon fill="black" stroke="black" points="14722,-3541.22 14718.5,-3531.22 14715,-3541.22 14722,-3541.22"/>
</g>
<!-- l0_res2_gpu13 -->
<g id="node113" class="node">
<title>l0_res2_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15835.5,-3082.95 15401.5,-3082.95 15401.5,-3014.95 15835.5,-3014.95 15835.5,-3082.95"/>
<text text-anchor="middle" x="15618.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15618.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15618.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15618.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu13&#45;&gt;l0_res2_gpu13 -->
<g id="edge364" class="edge">
<title>l0_mha_res_add_gpu13&#45;&gt;l0_res2_gpu13</title>
<path fill="none" stroke="black" d="M14935.88,-3574.71C14968.88,-3571.61 15002.57,-3568.87 15034.5,-3566.95 15097.2,-3563.19 17251.44,-3575.72 17295.5,-3530.95 17337.9,-3487.87 17330.71,-3444.09 17295.5,-3394.95 17073.24,-3084.78 16856.87,-3192.83 16482.5,-3118.95 16230.85,-3069.29 16162,-3105.56 15906.5,-3082.95 15886.79,-3081.21 15866.34,-3079.22 15845.85,-3077.11"/>
<polygon fill="black" stroke="black" points="15846.09,-3073.62 15835.78,-3076.06 15845.37,-3080.58 15846.09,-3073.62"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge347" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11115.45,-3291.66C11112.45,-3291.41 11109.47,-3291.17 11106.5,-3290.95 10157.25,-3220.01 3488.75,-3325.87 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.23,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge348" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11115.45,-3291.67C11112.45,-3291.41 11109.47,-3291.18 11106.5,-3290.95 10258.98,-3227.4 4305.02,-3318.49 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.18 3457.23,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge349" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11115.45,-3291.67C11112.45,-3291.42 11109.47,-3291.18 11106.5,-3290.95 10360.71,-3234.79 5121.29,-3311.1 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.18 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge350" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11115.45,-3291.67C11112.45,-3291.42 11109.47,-3291.18 11106.5,-3290.95 9818.39,-3193.4 6581.62,-3352.48 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.17 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge351" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11115.45,-3291.68C11112.45,-3291.42 11109.47,-3291.18 11106.5,-3290.95 10021.85,-3208.17 7296.15,-3337.71 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.77,-3251.46 6201.53,-3254.17 6211.22,-3258.44 6211.77,-3251.46"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge352" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11115.45,-3291.68C11112.45,-3291.43 11109.47,-3291.18 11106.5,-3290.95 10225.31,-3222.95 8010.7,-3322.94 7129.5,-3254.95 7129.4,-3254.95 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.77,-3251.46 7119.53,-3254.16 7129.22,-3258.44 7129.77,-3251.46"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge353" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11115.45,-3291.69C11112.45,-3291.43 11109.46,-3291.19 11106.5,-3290.95 9751.02,-3184.49 9402.98,-3361.38 8047.5,-3254.95 8047.4,-3254.95 8047.29,-3254.94 8047.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.78,-3251.47 8037.53,-3254.15 8047.21,-3258.44 8047.78,-3251.47"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge354" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11115.45,-3291.72C11112.45,-3291.45 11109.46,-3291.19 11106.5,-3290.95 10157.92,-3214.04 9914.08,-3331.84 8965.5,-3254.95 8965.4,-3254.94 8965.29,-3254.94 8965.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8965.79,-3251.47 8955.53,-3254.12 8965.2,-3258.44 8965.79,-3251.47"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge355" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11115.45,-3291.77C11112.45,-3291.48 11109.46,-3291.21 11106.5,-3290.95 10564.78,-3243.59 10425.23,-3302.3 9883.5,-3254.95 9883.39,-3254.94 9883.29,-3254.93 9883.18,-3254.93"/>
<polygon fill="black" stroke="black" points="9883.51,-3251.44 9873.23,-3254.03 9882.88,-3258.41 9883.51,-3251.44"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge356" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11115.4,-3292.14C11112.42,-3291.74 11109.45,-3291.34 11106.5,-3290.95 10971.18,-3273.09 10936.82,-3272.81 10801.5,-3254.95 10801.28,-3254.92 10801.05,-3254.89 10800.83,-3254.86"/>
<polygon fill="black" stroke="black" points="10801.05,-3251.36 10790.68,-3253.52 10800.13,-3258.3 10801.05,-3251.36"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge357" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11314.89,-3290.68C11310.56,-3282.52 11305.76,-3273.44 11300.84,-3264.16"/>
<polygon fill="black" stroke="black" points="11303.88,-3262.42 11296.11,-3255.22 11297.7,-3265.69 11303.88,-3262.42"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge358" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11537.83,-3290.94C11639.19,-3274.65 11763.46,-3254.67 11875.49,-3236.66"/>
<polygon fill="black" stroke="black" points="11876.28,-3240.08 11885.6,-3235.04 11875.17,-3233.17 11876.28,-3240.08"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge359" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11549.56,-3291.79C11552.56,-3291.5 11555.54,-3291.22 11558.5,-3290.95 12036.42,-3248.22 12159.58,-3297.67 12637.5,-3254.95 12688.27,-3250.42 12742,-3244.03 12794.11,-3236.98"/>
<polygon fill="black" stroke="black" points="12794.73,-3240.42 12804.16,-3235.61 12793.78,-3233.49 12794.73,-3240.42"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge360" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11549.55,-3291.72C11552.55,-3291.45 11555.54,-3291.2 11558.5,-3290.95 12443.25,-3218.68 12670.75,-3327.21 13555.5,-3254.95 13606.59,-3250.78 13660.64,-3244.54 13713.04,-3237.52"/>
<polygon fill="black" stroke="black" points="13713.7,-3240.96 13723.14,-3236.16 13712.76,-3234.03 13713.7,-3240.96"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge361" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11549.55,-3291.7C11552.55,-3291.44 11555.54,-3291.19 11558.5,-3290.95 12850.15,-3189.13 13181.85,-3356.75 14473.5,-3254.95 14524.69,-3250.92 14578.86,-3244.74 14631.35,-3237.73"/>
<polygon fill="black" stroke="black" points="14632.03,-3241.17 14641.47,-3236.36 14631.09,-3234.23 14632.03,-3241.17"/>
</g>
<!-- l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge362" class="edge">
<title>l0_expert_13_gpu13&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11549.55,-3291.68C11552.55,-3291.43 11555.53,-3291.18 11558.5,-3290.95 12407.78,-3225.26 14542.22,-3320.62 15391.5,-3254.95 15442.7,-3250.99 15496.87,-3244.85 15549.36,-3237.86"/>
<polygon fill="black" stroke="black" points="15550.04,-3241.3 15559.48,-3236.49 15549.1,-3234.36 15550.04,-3241.3"/>
</g>
<!-- l0_gate_gpu13&#45;&gt;l0_expert_13_gpu13 -->
<g id="edge345" class="edge">
<title>l0_gate_gpu13&#45;&gt;l0_expert_13_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14243.71,-3395.75C14240.29,-3395.47 14236.89,-3395.21 14233.5,-3394.95 13051.21,-3305.68 12745.48,-3452.23 11559.59,-3359"/>
<polygon fill="black" stroke="black" points="11559.79,-3355.5 11549.55,-3358.2 11559.24,-3362.48 11559.79,-3355.5"/>
</g>
<!-- l0_expert_agg_gpu13&#45;&gt;l0_res2_gpu13 -->
<g id="edge363" class="edge">
<title>l0_expert_agg_gpu13&#45;&gt;l0_res2_gpu13</title>
<path fill="none" stroke="black" d="M14308.18,-3139.31C14363.02,-3131.67 14419.93,-3124.47 14473.5,-3118.95 14791.06,-3086.27 15159.88,-3067.46 15391.25,-3057.97"/>
<polygon fill="black" stroke="black" points="15391.63,-3061.46 15401.48,-3057.55 15391.34,-3054.46 15391.63,-3061.46"/>
</g>
<!-- l1_mha_qkv_gpu13 -->
<g id="node234" class="node">
<title>l1_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15641,-2978.95 15160,-2978.95 15160,-2910.95 15641,-2910.95 15641,-2978.95"/>
<text text-anchor="middle" x="15400.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15400.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15400.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15400.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu13&#45;&gt;l1_mha_qkv_gpu13 -->
<g id="edge755" class="edge">
<title>l0_res2_gpu13&#45;&gt;l1_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M15547.72,-3014.84C15526.29,-3004.81 15502.6,-2993.73 15480.61,-2983.43"/>
<polygon fill="black" stroke="black" points="15481.84,-2980.15 15471.3,-2979.08 15478.87,-2986.49 15481.84,-2980.15"/>
</g>
<!-- l1_mha_res_add_gpu13 -->
<g id="node237" class="node">
<title>l1_mha_res_add_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15778.5,-2666.95 15344.5,-2666.95 15344.5,-2598.95 15778.5,-2598.95 15778.5,-2666.95"/>
<text text-anchor="middle" x="15561.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15561.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15561.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15561.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu13&#45;&gt;l1_mha_res_add_gpu13 -->
<g id="edge759" class="edge">
<title>l0_res2_gpu13&#45;&gt;l1_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M15637.34,-3014.94C15642.69,-3003.86 15647.8,-2991.2 15650.5,-2978.95 15676.93,-2859.16 15702.15,-2812.78 15647.5,-2702.95 15642.1,-2692.11 15634.12,-2682.41 15625.16,-2673.95"/>
<polygon fill="black" stroke="black" points="15627.25,-2671.13 15617.44,-2667.14 15622.62,-2676.38 15627.25,-2671.13"/>
</g>
<!-- l0_mha_attn_gpu14 -->
<g id="node115" class="node">
<title>l0_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15085,-3842.95 14604,-3842.95 14604,-3774.95 15085,-3774.95 15085,-3842.95"/>
<text text-anchor="middle" x="14844.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="14844.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14844.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="14844.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu14&#45;&gt;l0_mha_attn_gpu14 -->
<g id="edge366" class="edge">
<title>l0_mha_qkv_gpu14&#45;&gt;l0_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M14685.8,-3878.84C14709.11,-3868.72 14734.89,-3857.53 14758.78,-3847.16"/>
<polygon fill="black" stroke="black" points="14760.4,-3850.27 14768.18,-3843.08 14757.62,-3843.85 14760.4,-3850.27"/>
</g>
<!-- l0_mha_out_gpu14 -->
<g id="node116" class="node">
<title>l0_mha_out_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15082,-3738.95 14613,-3738.95 14613,-3670.95 15082,-3670.95 15082,-3738.95"/>
<text text-anchor="middle" x="14847.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14847.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14847.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="14847.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu14&#45;&gt;l0_mha_out_gpu14 -->
<g id="edge367" class="edge">
<title>l0_mha_attn_gpu14&#45;&gt;l0_mha_out_gpu14</title>
<path fill="none" stroke="black" d="M14845.47,-3774.84C14845.71,-3766.73 14845.97,-3757.94 14846.22,-3749.43"/>
<polygon fill="black" stroke="black" points="14849.73,-3749.35 14846.52,-3739.25 14842.73,-3749.15 14849.73,-3749.35"/>
</g>
<!-- l0_mha_out_gpu14&#45;&gt;l0_mha_res_add_gpu14 -->
<g id="edge368" class="edge">
<title>l0_mha_out_gpu14&#45;&gt;l0_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M14981.3,-3670.91C15024.56,-3660.22 15072.7,-3648.33 15116.66,-3637.48"/>
<polygon fill="black" stroke="black" points="15117.69,-3640.83 15126.56,-3635.03 15116.01,-3634.03 15117.69,-3640.83"/>
</g>
<!-- l0_expert_14_gpu14 -->
<g id="node118" class="node">
<title>l0_expert_14_gpu14</title>
<polygon fill="lightpink" stroke="black" points="12001.5,-3358.95 11567.5,-3358.95 11567.5,-3290.95 12001.5,-3290.95 12001.5,-3358.95"/>
<text text-anchor="middle" x="11784.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11784.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11784.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11784.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu14&#45;&gt;l0_expert_14_gpu14 -->
<g id="edge372" class="edge">
<title>l0_mha_res_add_gpu14&#45;&gt;l0_expert_14_gpu14</title>
<path fill="none" stroke="black" d="M15267.57,-3566.63C15275.22,-3520.31 15280.57,-3437.38 15232.5,-3394.95 15199.81,-3366.11 12215.75,-3362.61 12011.81,-3358.54"/>
<polygon fill="black" stroke="black" points="12011.65,-3355.03 12001.55,-3358.21 12011.43,-3362.03 12011.65,-3355.03"/>
</g>
<!-- l0_gate_gpu14 -->
<g id="node119" class="node">
<title>l0_gate_gpu14</title>
<polygon fill="lightcyan" stroke="black" points="16278.24,-3530.95 15521.44,-3530.95 15326.76,-3394.95 16083.56,-3394.95 16278.24,-3530.95"/>
<text text-anchor="middle" x="15802.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="15802.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15802.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15802.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu14&#45;&gt;l0_gate_gpu14 -->
<g id="edge370" class="edge">
<title>l0_mha_res_add_gpu14&#45;&gt;l0_gate_gpu14</title>
<path fill="none" stroke="black" d="M15392.05,-3566.94C15432.64,-3556.76 15478.96,-3545.14 15525.52,-3533.45"/>
<polygon fill="black" stroke="black" points="15526.6,-3536.79 15535.45,-3530.96 15524.9,-3530 15526.6,-3536.79"/>
</g>
<!-- l0_res2_gpu14 -->
<g id="node121" class="node">
<title>l0_res2_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16349.5,-3082.95 15915.5,-3082.95 15915.5,-3014.95 16349.5,-3014.95 16349.5,-3082.95"/>
<text text-anchor="middle" x="16132.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16132.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16132.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16132.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu14&#45;&gt;l0_res2_gpu14 -->
<g id="edge390" class="edge">
<title>l0_mha_res_add_gpu14&#45;&gt;l0_res2_gpu14</title>
<path fill="none" stroke="black" d="M15477.9,-3594.65C16005.63,-3581.54 17312.56,-3547.43 17328.5,-3530.95 17392.15,-3465.14 17391.35,-3185.53 17328.5,-3118.95 17295.82,-3084.33 16697.75,-3063.93 16360,-3055.12"/>
<polygon fill="black" stroke="black" points="16359.93,-3051.62 16349.84,-3054.86 16359.75,-3058.62 16359.93,-3051.62"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge373" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11567.45,-3291.66C11564.45,-3291.41 11561.47,-3291.17 11558.5,-3290.95 10559.16,-3216.37 3538.84,-3329.51 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.23,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge374" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11567.45,-3291.66C11564.45,-3291.41 11561.47,-3291.18 11558.5,-3290.95 10660.89,-3223.76 4355.11,-3322.13 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.18 3457.23,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge375" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11567.45,-3291.67C11564.45,-3291.41 11561.47,-3291.18 11558.5,-3290.95 10762.62,-3231.15 5171.38,-3314.74 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.18 4375.22,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge376" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11567.45,-3291.67C11564.45,-3291.42 11561.47,-3291.18 11558.5,-3290.95 10170.21,-3186.12 6681.8,-3359.75 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.18 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge377" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11567.45,-3291.67C11564.45,-3291.42 11561.47,-3291.18 11558.5,-3290.95 10373.67,-3200.9 7396.33,-3344.98 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.77,-3251.46 6201.53,-3254.17 6211.22,-3258.44 6211.77,-3251.46"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge378" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11567.45,-3291.68C11564.45,-3291.42 11561.47,-3291.18 11558.5,-3290.95 10577.13,-3215.67 8110.87,-3330.21 7129.5,-3254.95 7129.4,-3254.95 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.77,-3251.46 7119.53,-3254.16 7129.22,-3258.44 7129.77,-3251.46"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge379" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11567.45,-3291.69C11564.45,-3291.43 11561.46,-3291.18 11558.5,-3290.95 10780.59,-3230.45 8825.42,-3315.44 8047.5,-3254.95 8047.4,-3254.95 8047.29,-3254.94 8047.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.78,-3251.47 8037.53,-3254.15 8047.22,-3258.44 8047.78,-3251.47"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge380" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11567.45,-3291.7C11564.45,-3291.44 11561.46,-3291.19 11558.5,-3290.95 10409.58,-3199.49 10114.42,-3346.39 8965.5,-3254.95 8965.4,-3254.95 8965.29,-3254.94 8965.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8965.78,-3251.47 8955.53,-3254.14 8965.21,-3258.44 8965.78,-3251.47"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge381" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11567.45,-3291.74C11564.45,-3291.46 11561.46,-3291.2 11558.5,-3290.95 10816.46,-3229.04 10625.54,-3316.85 9883.5,-3254.95 9883.39,-3254.94 9883.29,-3254.94 9883.18,-3254.93"/>
<polygon fill="black" stroke="black" points="9883.49,-3251.44 9873.23,-3254.07 9882.89,-3258.41 9883.49,-3251.44"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge382" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11567.44,-3291.84C11564.44,-3291.54 11561.46,-3291.24 11558.5,-3290.95 11223.23,-3258.58 11136.77,-3287.32 10801.5,-3254.95 10801.39,-3254.94 10801.29,-3254.93 10801.18,-3254.92"/>
<polygon fill="black" stroke="black" points="10801.54,-3251.44 10791.24,-3253.94 10800.85,-3258.41 10801.54,-3251.44"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge383" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11657.32,-3290.94C11618.16,-3280.78 11573.48,-3269.19 11528.57,-3257.53"/>
<polygon fill="black" stroke="black" points="11529.24,-3254.09 11518.68,-3254.96 11527.48,-3260.86 11529.24,-3254.09"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge384" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11880.13,-3290.94C11908.84,-3281.03 11941.5,-3269.76 11974.42,-3258.4"/>
<polygon fill="black" stroke="black" points="11975.87,-3261.6 11984.18,-3255.03 11973.58,-3254.98 11975.87,-3261.6"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge385" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12001.57,-3291.89C12004.56,-3291.56 12007.54,-3291.25 12010.5,-3290.95 12288.2,-3262.76 12359.8,-3283.14 12637.5,-3254.95 12687.93,-3249.83 12741.31,-3243.18 12793.14,-3236.06"/>
<polygon fill="black" stroke="black" points="12793.71,-3239.52 12803.14,-3234.68 12792.76,-3232.58 12793.71,-3239.52"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge386" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12001.55,-3291.74C12004.55,-3291.47 12007.54,-3291.2 12010.5,-3290.95 12694.92,-3233.23 12871.08,-3312.66 13555.5,-3254.95 13606.48,-3250.65 13660.43,-3244.36 13712.73,-3237.33"/>
<polygon fill="black" stroke="black" points="13713.38,-3240.78 13722.82,-3235.96 13712.44,-3233.84 13713.38,-3240.78"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge387" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12001.55,-3291.71C12004.55,-3291.44 12007.54,-3291.19 12010.5,-3290.95 13101.8,-3203.68 13382.2,-3342.2 14473.5,-3254.95 14524.59,-3250.87 14578.65,-3244.67 14631.05,-3237.67"/>
<polygon fill="black" stroke="black" points="14631.71,-3241.11 14641.16,-3236.31 14630.78,-3234.17 14631.71,-3241.11"/>
</g>
<!-- l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge388" class="edge">
<title>l0_expert_14_gpu14&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12001.55,-3291.69C12004.55,-3291.43 12007.54,-3291.18 12010.5,-3290.95 12759.6,-3232.54 14642.4,-3313.35 15391.5,-3254.95 15442.7,-3250.96 15496.87,-3244.8 15549.35,-3237.8"/>
<polygon fill="black" stroke="black" points="15550.03,-3241.24 15559.48,-3236.44 15549.1,-3234.3 15550.03,-3241.24"/>
</g>
<!-- l0_gate_gpu14&#45;&gt;l0_expert_14_gpu14 -->
<g id="edge371" class="edge">
<title>l0_gate_gpu14&#45;&gt;l0_expert_14_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15333.16,-3399.56C15313.36,-3397.83 15293.74,-3396.28 15274.5,-3394.95 14554.1,-3345.44 12750.06,-3414.85 12011.53,-3358.98"/>
<polygon fill="black" stroke="black" points="12011.79,-3355.49 12001.55,-3358.21 12011.25,-3362.47 12011.79,-3355.49"/>
</g>
<!-- l0_expert_agg_gpu14&#45;&gt;l0_res2_gpu14 -->
<g id="edge389" class="edge">
<title>l0_expert_agg_gpu14&#45;&gt;l0_res2_gpu14</title>
<path fill="none" stroke="black" d="M15226.89,-3140.06C15281.53,-3132.37 15338.18,-3124.96 15391.5,-3118.95 15592.2,-3096.36 15643.48,-3102.45 15844.5,-3082.95 15864.19,-3081.04 15884.63,-3078.94 15905.12,-3076.75"/>
<polygon fill="black" stroke="black" points="15905.61,-3080.22 15915.18,-3075.67 15904.86,-3073.26 15905.61,-3080.22"/>
</g>
<!-- l1_mha_qkv_gpu14 -->
<g id="node242" class="node">
<title>l1_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="16272,-2978.95 15791,-2978.95 15791,-2910.95 16272,-2910.95 16272,-2978.95"/>
<text text-anchor="middle" x="16031.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16031.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16031.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16031.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu14&#45;&gt;l1_mha_qkv_gpu14 -->
<g id="edge781" class="edge">
<title>l0_res2_gpu14&#45;&gt;l1_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M16099.71,-3014.84C16090.8,-3005.84 16081.05,-2995.99 16071.78,-2986.63"/>
<polygon fill="black" stroke="black" points="16074,-2983.9 16064.47,-2979.25 16069.02,-2988.82 16074,-2983.9"/>
</g>
<!-- l1_mha_res_add_gpu14 -->
<g id="node245" class="node">
<title>l1_mha_res_add_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16358.5,-2666.95 15924.5,-2666.95 15924.5,-2598.95 16358.5,-2598.95 16358.5,-2666.95"/>
<text text-anchor="middle" x="16141.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16141.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16141.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16141.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu14&#45;&gt;l1_mha_res_add_gpu14 -->
<g id="edge785" class="edge">
<title>l0_res2_gpu14&#45;&gt;l1_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M16243.12,-3014.79C16258.34,-3005.57 16271.98,-2993.85 16281.5,-2978.95 16347.55,-2875.58 16344.34,-2806.46 16278.5,-2702.95 16270.91,-2691.02 16260.57,-2681.07 16248.95,-2672.79"/>
<polygon fill="black" stroke="black" points="16250.56,-2669.65 16240.29,-2667.05 16246.69,-2675.49 16250.56,-2669.65"/>
</g>
<!-- l0_mha_attn_gpu15 -->
<g id="node123" class="node">
<title>l0_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16325,-3842.95 15844,-3842.95 15844,-3774.95 16325,-3774.95 16325,-3842.95"/>
<text text-anchor="middle" x="16084.5" y="-3827.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="16084.5" y="-3812.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16084.5" y="-3797.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="16084.5" y="-3782.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu15&#45;&gt;l0_mha_attn_gpu15 -->
<g id="edge392" class="edge">
<title>l0_mha_qkv_gpu15&#45;&gt;l0_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M16031.15,-3878.84C16037.98,-3870.02 16045.44,-3860.38 16052.56,-3851.19"/>
<polygon fill="black" stroke="black" points="16055.35,-3853.3 16058.71,-3843.25 16049.82,-3849.02 16055.35,-3853.3"/>
</g>
<!-- l0_mha_out_gpu15 -->
<g id="node124" class="node">
<title>l0_mha_out_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16398,-3738.95 15929,-3738.95 15929,-3670.95 16398,-3670.95 16398,-3738.95"/>
<text text-anchor="middle" x="16163.5" y="-3723.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16163.5" y="-3708.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16163.5" y="-3693.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="16163.5" y="-3678.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_attn_gpu15&#45;&gt;l0_mha_out_gpu15 -->
<g id="edge393" class="edge">
<title>l0_mha_attn_gpu15&#45;&gt;l0_mha_out_gpu15</title>
<path fill="none" stroke="black" d="M16110.15,-3774.84C16116.98,-3766.02 16124.44,-3756.38 16131.56,-3747.19"/>
<polygon fill="black" stroke="black" points="16134.35,-3749.3 16137.71,-3739.25 16128.82,-3745.02 16134.35,-3749.3"/>
</g>
<!-- l0_mha_out_gpu15&#45;&gt;l0_mha_res_add_gpu15 -->
<g id="edge394" class="edge">
<title>l0_mha_out_gpu15&#45;&gt;l0_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M16373.12,-3670.91C16442.82,-3659.92 16520.62,-3647.65 16591.05,-3636.55"/>
<polygon fill="black" stroke="black" points="16591.61,-3640.01 16600.94,-3634.99 16590.52,-3633.09 16591.61,-3640.01"/>
</g>
<!-- l0_expert_15_gpu15 -->
<g id="node126" class="node">
<title>l0_expert_15_gpu15</title>
<polygon fill="lightpink" stroke="black" points="12453.5,-3358.95 12019.5,-3358.95 12019.5,-3290.95 12453.5,-3290.95 12453.5,-3358.95"/>
<text text-anchor="middle" x="12236.5" y="-3343.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12236.5" y="-3328.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12236.5" y="-3313.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12236.5" y="-3298.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu15&#45;&gt;l0_expert_15_gpu15 -->
<g id="edge398" class="edge">
<title>l0_mha_res_add_gpu15&#45;&gt;l0_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M17027.56,-3596.2C17139.52,-3589.18 17259.96,-3571.9 17295.5,-3530.95 17335.12,-3485.3 17337.95,-3437.98 17295.5,-3394.95 17252.5,-3351.37 13443.87,-3331.35 12464.2,-3326.92"/>
<polygon fill="black" stroke="black" points="12463.88,-3323.42 12453.87,-3326.88 12463.85,-3330.42 12463.88,-3323.42"/>
</g>
<!-- l0_gate_gpu15 -->
<g id="node127" class="node">
<title>l0_gate_gpu15</title>
<polygon fill="lightcyan" stroke="black" points="17286.24,-3530.95 16529.44,-3530.95 16334.76,-3394.95 17091.56,-3394.95 17286.24,-3530.95"/>
<text text-anchor="middle" x="16810.5" y="-3481.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="16810.5" y="-3466.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16810.5" y="-3451.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16810.5" y="-3436.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_mha_res_add_gpu15&#45;&gt;l0_gate_gpu15 -->
<g id="edge396" class="edge">
<title>l0_mha_res_add_gpu15&#45;&gt;l0_gate_gpu15</title>
<path fill="none" stroke="black" d="M16810.5,-3566.68C16810.5,-3558.86 16810.5,-3550.19 16810.5,-3541.31"/>
<polygon fill="black" stroke="black" points="16814,-3541.22 16810.5,-3531.22 16807,-3541.22 16814,-3541.22"/>
</g>
<!-- l0_res2_gpu15 -->
<g id="node129" class="node">
<title>l0_res2_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17643.5,-3082.95 17209.5,-3082.95 17209.5,-3014.95 17643.5,-3014.95 17643.5,-3082.95"/>
<text text-anchor="middle" x="17426.5" y="-3067.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17426.5" y="-3052.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17426.5" y="-3037.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17426.5" y="-3022.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_res_add_gpu15&#45;&gt;l0_res2_gpu15 -->
<g id="edge416" class="edge">
<title>l0_mha_res_add_gpu15&#45;&gt;l0_res2_gpu15</title>
<path fill="none" stroke="black" d="M17027.71,-3588.26C17186.49,-3577.47 17378.48,-3558.86 17404.5,-3530.95 17517.94,-3409.28 17468.31,-3186.12 17440.59,-3092.78"/>
<polygon fill="black" stroke="black" points="17443.9,-3091.66 17437.65,-3083.1 17437.2,-3093.69 17443.9,-3091.66"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge399" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M12019.45,-3291.66C12016.45,-3291.41 12013.47,-3291.17 12010.5,-3290.95 10961.07,-3212.73 3588.93,-3333.15 2539.5,-3254.95 2539.4,-3254.95 2539.29,-3254.94 2539.19,-3254.93"/>
<polygon fill="black" stroke="black" points="2539.77,-3251.46 2529.53,-3254.18 2539.23,-3258.44 2539.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge400" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M12019.45,-3291.66C12016.45,-3291.41 12013.47,-3291.17 12010.5,-3290.95 11062.8,-3220.12 4405.2,-3325.76 3457.5,-3254.95 3457.4,-3254.95 3457.29,-3254.94 3457.19,-3254.93"/>
<polygon fill="black" stroke="black" points="3457.77,-3251.46 3447.53,-3254.18 3457.23,-3258.44 3457.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge401" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M12019.45,-3291.67C12016.45,-3291.41 12013.47,-3291.18 12010.5,-3290.95 11164.53,-3227.51 5221.47,-3318.38 4375.5,-3254.95 4375.4,-3254.95 4375.29,-3254.94 4375.19,-3254.93"/>
<polygon fill="black" stroke="black" points="4375.77,-3251.46 4365.53,-3254.18 4375.23,-3258.44 4375.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge402" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12019.45,-3291.67C12016.45,-3291.42 12013.47,-3291.18 12010.5,-3290.95 11266.26,-3234.9 6037.74,-3310.99 5293.5,-3254.95 5293.4,-3254.95 5293.29,-3254.94 5293.19,-3254.93"/>
<polygon fill="black" stroke="black" points="5293.77,-3251.46 5283.53,-3254.18 5293.22,-3258.44 5293.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge403" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M12019.45,-3291.67C12016.45,-3291.42 12013.47,-3291.18 12010.5,-3290.95 10725.49,-3193.62 7496.51,-3352.26 6211.5,-3254.95 6211.4,-3254.95 6211.29,-3254.94 6211.19,-3254.93"/>
<polygon fill="black" stroke="black" points="6211.77,-3251.46 6201.53,-3254.17 6211.22,-3258.44 6211.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge404" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M12019.45,-3291.68C12016.45,-3291.42 12013.47,-3291.18 12010.5,-3290.95 10928.95,-3208.4 8211.05,-3337.48 7129.5,-3254.95 7129.4,-3254.95 7129.29,-3254.94 7129.19,-3254.93"/>
<polygon fill="black" stroke="black" points="7129.77,-3251.46 7119.53,-3254.17 7129.22,-3258.44 7129.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge405" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M12019.45,-3291.68C12016.45,-3291.43 12013.47,-3291.18 12010.5,-3290.95 11132.41,-3223.17 8925.59,-3322.71 8047.5,-3254.95 8047.4,-3254.95 8047.29,-3254.94 8047.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8047.77,-3251.46 8037.53,-3254.16 8047.22,-3258.44 8047.77,-3251.46"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge406" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M12019.45,-3291.7C12016.45,-3291.43 12013.46,-3291.19 12010.5,-3290.95 10661.23,-3184.94 10314.77,-3360.93 8965.5,-3254.95 8965.4,-3254.95 8965.29,-3254.94 8965.19,-3254.93"/>
<polygon fill="black" stroke="black" points="8965.78,-3251.47 8955.53,-3254.15 8965.21,-3258.44 8965.78,-3251.47"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu8 -->
<g id="edge407" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M12019.45,-3291.72C12016.45,-3291.45 12013.46,-3291.19 12010.5,-3290.95 11068.13,-3214.49 10825.87,-3331.39 9883.5,-3254.95 9883.4,-3254.94 9883.29,-3254.94 9883.19,-3254.93"/>
<polygon fill="black" stroke="black" points="9883.79,-3251.47 9873.53,-3254.12 9883.2,-3258.44 9883.79,-3251.47"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu9 -->
<g id="edge408" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M12019.45,-3291.77C12016.45,-3291.49 12013.46,-3291.21 12010.5,-3290.95 11474.98,-3244.04 11337.02,-3301.85 10801.5,-3254.95 10801.39,-3254.94 10801.29,-3254.93 10801.18,-3254.93"/>
<polygon fill="black" stroke="black" points="10801.51,-3251.44 10791.23,-3254.03 10800.88,-3258.41 10801.51,-3251.44"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu10 -->
<g id="edge409" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M12019.4,-3292.16C12016.42,-3291.75 12013.45,-3291.35 12010.5,-3290.95 11881.35,-3273.54 11848.65,-3272.37 11719.5,-3254.95 11719.15,-3254.91 11718.81,-3254.86 11718.46,-3254.81"/>
<polygon fill="black" stroke="black" points="11718.76,-3251.32 11708.38,-3253.45 11717.82,-3258.26 11718.76,-3251.32"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu11 -->
<g id="edge410" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12222.31,-3290.68C12218.87,-3282.6 12215.04,-3273.63 12211.12,-3264.45"/>
<polygon fill="black" stroke="black" points="12214.33,-3263.04 12207.19,-3255.22 12207.89,-3265.79 12214.33,-3263.04"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu12 -->
<g id="edge411" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12445.23,-3290.94C12549.57,-3274.44 12677.81,-3254.16 12792.82,-3235.98"/>
<polygon fill="black" stroke="black" points="12793.51,-3239.41 12802.84,-3234.39 12792.41,-3232.5 12793.51,-3239.41"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu13 -->
<g id="edge412" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12453.66,-3315.04C12771.57,-3301.58 13348.34,-3275.45 13555.5,-3254.95 13606.04,-3249.95 13659.53,-3243.35 13711.45,-3236.24"/>
<polygon fill="black" stroke="black" points="13712.04,-3239.69 13721.47,-3234.86 13711.09,-3232.76 13712.04,-3239.69"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu14 -->
<g id="edge413" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12453.67,-3314.64C12623.68,-3307.55 12866.12,-3297.86 13078.5,-3290.95 13698.38,-3270.81 13855.55,-3307.84 14473.5,-3254.95 14524.48,-3250.59 14578.42,-3244.27 14630.72,-3237.22"/>
<polygon fill="black" stroke="black" points="14631.37,-3240.67 14640.81,-3235.85 14630.43,-3233.73 14631.37,-3240.67"/>
</g>
<!-- l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu15 -->
<g id="edge414" class="edge">
<title>l0_expert_15_gpu15&#45;&gt;l0_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12453.65,-3314.03C12623.66,-3306.61 12866.09,-3296.77 13078.5,-3290.95 13592.37,-3276.89 14879.09,-3296.16 15391.5,-3254.95 15442.59,-3250.84 15496.65,-3244.64 15549.04,-3237.63"/>
<polygon fill="black" stroke="black" points="15549.71,-3241.07 15559.15,-3236.26 15548.77,-3234.13 15549.71,-3241.07"/>
</g>
<!-- l0_gate_gpu15&#45;&gt;l0_expert_15_gpu15 -->
<g id="edge397" class="edge">
<title>l0_gate_gpu15&#45;&gt;l0_expert_15_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16340.67,-3399.26C16322.73,-3397.67 16304.96,-3396.22 16287.5,-3394.95 15535.72,-3340.56 13203.56,-3328.88 12463.96,-3326.52"/>
<polygon fill="black" stroke="black" points="12463.74,-3323.02 12453.73,-3326.49 12463.72,-3330.02 12463.74,-3323.02"/>
</g>
<!-- l0_expert_agg_gpu15&#45;&gt;l0_res2_gpu15 -->
<g id="edge415" class="edge">
<title>l0_expert_agg_gpu15&#45;&gt;l0_res2_gpu15</title>
<path fill="none" stroke="black" d="M16169.9,-3158.39C16475.43,-3132.03 16928.55,-3092.92 17199.02,-3069.58"/>
<polygon fill="black" stroke="black" points="17199.7,-3073.04 17209.36,-3068.69 17199.1,-3066.06 17199.7,-3073.04"/>
</g>
<!-- l1_mha_qkv_gpu15 -->
<g id="node250" class="node">
<title>l1_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17664,-2978.95 17183,-2978.95 17183,-2910.95 17664,-2910.95 17664,-2978.95"/>
<text text-anchor="middle" x="17423.5" y="-2963.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17423.5" y="-2948.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17423.5" y="-2933.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17423.5" y="-2918.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l0_res2_gpu15&#45;&gt;l1_mha_qkv_gpu15 -->
<g id="edge807" class="edge">
<title>l0_res2_gpu15&#45;&gt;l1_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M17425.53,-3014.84C17425.29,-3006.73 17425.03,-2997.94 17424.78,-2989.43"/>
<polygon fill="black" stroke="black" points="17428.27,-2989.15 17424.48,-2979.25 17421.27,-2989.35 17428.27,-2989.15"/>
</g>
<!-- l1_mha_res_add_gpu15 -->
<g id="node253" class="node">
<title>l1_mha_res_add_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17908.5,-2666.95 17474.5,-2666.95 17474.5,-2598.95 17908.5,-2598.95 17908.5,-2666.95"/>
<text text-anchor="middle" x="17691.5" y="-2651.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17691.5" y="-2636.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17691.5" y="-2621.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17691.5" y="-2606.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res2_gpu15&#45;&gt;l1_mha_res_add_gpu15 -->
<g id="edge811" class="edge">
<title>l0_res2_gpu15&#45;&gt;l1_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M17599.48,-3014.94C17633.54,-3005.03 17662.26,-2992.98 17673.5,-2978.95 17743.45,-2891.61 17721,-2748.33 17703.68,-2677.04"/>
<polygon fill="black" stroke="black" points="17707,-2675.91 17701.17,-2667.06 17700.21,-2677.61 17707,-2675.91"/>
</g>
<!-- l1_mha_attn_gpu0 -->
<g id="node131" class="node">
<title>l1_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="771,-2874.95 290,-2874.95 290,-2806.95 771,-2806.95 771,-2874.95"/>
<text text-anchor="middle" x="530.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="530.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="530.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="530.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu0&#45;&gt;l1_mha_attn_gpu0 -->
<g id="edge418" class="edge">
<title>l1_mha_qkv_gpu0&#45;&gt;l1_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M530.5,-2910.84C530.5,-2902.73 530.5,-2893.94 530.5,-2885.43"/>
<polygon fill="black" stroke="black" points="534,-2885.25 530.5,-2875.25 527,-2885.25 534,-2885.25"/>
</g>
<!-- l1_mha_out_gpu0 -->
<g id="node132" class="node">
<title>l1_mha_out_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="768,-2770.95 299,-2770.95 299,-2702.95 768,-2702.95 768,-2770.95"/>
<text text-anchor="middle" x="533.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="533.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="533.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="533.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu0&#45;&gt;l1_mha_out_gpu0 -->
<g id="edge419" class="edge">
<title>l1_mha_attn_gpu0&#45;&gt;l1_mha_out_gpu0</title>
<path fill="none" stroke="black" d="M531.47,-2806.84C531.71,-2798.73 531.97,-2789.94 532.22,-2781.43"/>
<polygon fill="black" stroke="black" points="535.73,-2781.35 532.52,-2771.25 528.73,-2781.15 535.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu0&#45;&gt;l1_mha_res_add_gpu0 -->
<g id="edge420" class="edge">
<title>l1_mha_out_gpu0&#45;&gt;l1_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M537.07,-2702.84C537.95,-2694.73 538.89,-2685.94 539.81,-2677.43"/>
<polygon fill="black" stroke="black" points="543.32,-2677.57 540.91,-2667.25 536.36,-2676.82 543.32,-2677.57"/>
</g>
<!-- l1_expert_0_gpu0 -->
<g id="node134" class="node">
<title>l1_expert_0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="6012.5,-2390.95 5578.5,-2390.95 5578.5,-2322.95 6012.5,-2322.95 6012.5,-2390.95"/>
<text text-anchor="middle" x="5795.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5795.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5795.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5795.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu0&#45;&gt;l1_expert_0_gpu0 -->
<g id="edge424" class="edge">
<title>l1_mha_res_add_gpu0&#45;&gt;l1_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M542.66,-2598.82C542.08,-2551.93 548.97,-2467.42 601.5,-2426.95 651.4,-2388.51 4573.61,-2364.6 5568.23,-2359.15"/>
<polygon fill="black" stroke="black" points="5568.38,-2362.65 5578.36,-2359.09 5568.34,-2355.65 5568.38,-2362.65"/>
</g>
<!-- l1_gate_gpu0 -->
<g id="node135" class="node">
<title>l1_gate_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="1562.24,-2562.95 805.44,-2562.95 610.76,-2426.95 1367.56,-2426.95 1562.24,-2562.95"/>
<text text-anchor="middle" x="1086.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1086.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1086.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1086.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu0&#45;&gt;l1_gate_gpu0 -->
<g id="edge422" class="edge">
<title>l1_mha_res_add_gpu0&#45;&gt;l1_gate_gpu0</title>
<path fill="none" stroke="black" d="M676.05,-2598.94C716.64,-2588.76 762.96,-2577.14 809.52,-2565.45"/>
<polygon fill="black" stroke="black" points="810.6,-2568.79 819.45,-2562.96 808.9,-2562 810.6,-2568.79"/>
</g>
<!-- l1_res2_gpu0 -->
<g id="node137" class="node">
<title>l1_res2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="791.5,-2114.95 357.5,-2114.95 357.5,-2046.95 791.5,-2046.95 791.5,-2114.95"/>
<text text-anchor="middle" x="574.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="574.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="574.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="574.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu0&#45;&gt;l1_res2_gpu0 -->
<g id="edge442" class="edge">
<title>l1_mha_res_add_gpu0&#45;&gt;l1_res2_gpu0</title>
<path fill="none" stroke="black" d="M512.67,-2598.69C504.48,-2588.08 496.78,-2575.76 492.5,-2562.95 434.39,-2389.31 415.23,-2316.96 492.5,-2150.95 497.53,-2140.15 505.18,-2130.43 513.82,-2121.93"/>
<polygon fill="black" stroke="black" points="516.28,-2124.42 521.27,-2115.08 511.54,-2119.27 516.28,-2124.42"/>
</g>
<!-- l1_expert_agg_gpu0 -->
<g id="node136" class="node">
<title>l1_expert_agg_gpu0</title>
<polygon fill="yellow" stroke="black" points="2689.4,-2286.95 1973.71,-2286.95 1789.6,-2150.95 2505.29,-2150.95 2689.4,-2286.95"/>
<text text-anchor="middle" x="2239.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2239.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2239.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2239.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge425" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5578.39,-2354.58C4970.4,-2350.2 3258.88,-2333.92 2698.5,-2286.95 2698.39,-2286.94 2698.29,-2286.94 2698.18,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.49,-2283.44 2688.23,-2286.07 2697.89,-2290.41 2698.49,-2283.44"/>
</g>
<!-- l1_expert_agg_gpu1 -->
<g id="node144" class="node">
<title>l1_expert_agg_gpu1</title>
<polygon fill="yellow" stroke="black" points="3607.4,-2286.95 2891.71,-2286.95 2707.6,-2150.95 3423.29,-2150.95 3607.4,-2286.95"/>
<text text-anchor="middle" x="3157.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3157.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3157.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3157.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge426" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5578.44,-2352.21C5105.12,-2343.54 3992.45,-2320.24 3616.5,-2286.95 3616.39,-2286.94 3616.29,-2286.93 3616.18,-2286.92"/>
<polygon fill="black" stroke="black" points="3616.51,-2283.44 3606.23,-2286.02 3615.88,-2290.41 3616.51,-2283.44"/>
</g>
<!-- l1_expert_agg_gpu2 -->
<g id="node152" class="node">
<title>l1_expert_agg_gpu2</title>
<polygon fill="yellow" stroke="black" points="4525.4,-2286.95 3809.71,-2286.95 3625.6,-2150.95 4341.29,-2150.95 4525.4,-2286.95"/>
<text text-anchor="middle" x="4075.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4075.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4075.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4075.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge427" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5578.32,-2350.03C5326.67,-2341.78 4899.78,-2323.53 4534.5,-2286.95 4534.39,-2286.94 4534.29,-2286.93 4534.18,-2286.92"/>
<polygon fill="black" stroke="black" points="4534.55,-2283.44 4524.24,-2285.91 4533.84,-2290.4 4534.55,-2283.44"/>
</g>
<!-- l1_expert_agg_gpu3 -->
<g id="node160" class="node">
<title>l1_expert_agg_gpu3</title>
<polygon fill="yellow" stroke="black" points="5443.4,-2286.95 4727.71,-2286.95 4543.6,-2150.95 5259.29,-2150.95 5443.4,-2286.95"/>
<text text-anchor="middle" x="4993.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4993.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4993.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4993.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge428" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5600.85,-2322.94C5539.41,-2312.53 5469.09,-2300.6 5398.6,-2288.65"/>
<polygon fill="black" stroke="black" points="5399.1,-2285.18 5388.65,-2286.96 5397.93,-2292.08 5399.1,-2285.18"/>
</g>
<!-- l1_expert_agg_gpu4 -->
<g id="node168" class="node">
<title>l1_expert_agg_gpu4</title>
<polygon fill="yellow" stroke="black" points="6361.4,-2286.95 5645.71,-2286.95 5461.6,-2150.95 6177.29,-2150.95 6361.4,-2286.95"/>
<text text-anchor="middle" x="5911.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5911.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5911.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5911.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge429" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5823.88,-2322.68C5831.13,-2314.18 5839.22,-2304.69 5847.48,-2295.01"/>
<polygon fill="black" stroke="black" points="5850.3,-2297.1 5854.13,-2287.22 5844.98,-2292.55 5850.3,-2297.1"/>
</g>
<!-- l1_expert_agg_gpu5 -->
<g id="node176" class="node">
<title>l1_expert_agg_gpu5</title>
<polygon fill="yellow" stroke="black" points="7279.4,-2286.95 6563.71,-2286.95 6379.6,-2150.95 7095.29,-2150.95 7279.4,-2286.95"/>
<text text-anchor="middle" x="6829.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6829.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6829.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6829.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge430" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6012.59,-2324.08C6015.58,-2323.7 6018.55,-2323.32 6021.5,-2322.95 6176.24,-2303.68 6215.76,-2306.22 6370.5,-2286.95 6420.04,-2280.79 6472.5,-2273.68 6523.57,-2266.44"/>
<polygon fill="black" stroke="black" points="6524.35,-2269.87 6533.76,-2264.99 6523.37,-2262.94 6524.35,-2269.87"/>
</g>
<!-- l1_expert_agg_gpu6 -->
<g id="node184" class="node">
<title>l1_expert_agg_gpu6</title>
<polygon fill="yellow" stroke="black" points="8197.4,-2286.95 7481.71,-2286.95 7297.6,-2150.95 8013.29,-2150.95 8197.4,-2286.95"/>
<text text-anchor="middle" x="7747.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7747.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7747.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7747.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge431" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6012.55,-2323.76C6015.55,-2323.48 6018.54,-2323.21 6021.5,-2322.95 6582.72,-2274.17 6727.28,-2335.72 7288.5,-2286.95 7339.38,-2282.53 7393.21,-2276.19 7445.42,-2269.15"/>
<polygon fill="black" stroke="black" points="7446.05,-2272.6 7455.49,-2267.78 7445.11,-2265.66 7446.05,-2272.6"/>
</g>
<!-- l1_expert_agg_gpu7 -->
<g id="node192" class="node">
<title>l1_expert_agg_gpu7</title>
<polygon fill="yellow" stroke="black" points="9115.4,-2286.95 8399.71,-2286.95 8215.6,-2150.95 8931.29,-2150.95 9115.4,-2286.95"/>
<text text-anchor="middle" x="8665.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8665.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8665.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8665.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge432" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6012.55,-2323.71C6015.55,-2323.45 6018.54,-2323.19 6021.5,-2322.95 6989.58,-2244.63 7238.42,-2365.26 8206.5,-2286.95 8257.59,-2282.82 8311.65,-2276.6 8364.04,-2269.59"/>
<polygon fill="black" stroke="black" points="8364.71,-2273.03 8374.15,-2268.22 8363.77,-2266.09 8364.71,-2273.03"/>
</g>
<!-- l1_expert_agg_gpu8 -->
<g id="node200" class="node">
<title>l1_expert_agg_gpu8</title>
<polygon fill="yellow" stroke="black" points="10033.4,-2286.95 9317.71,-2286.95 9133.6,-2150.95 9849.29,-2150.95 10033.4,-2286.95"/>
<text text-anchor="middle" x="9583.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9583.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9583.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9583.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge433" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6012.55,-2323.69C6015.55,-2323.43 6018.54,-2323.19 6021.5,-2322.95 7396.48,-2215.08 7749.52,-2394.8 9124.5,-2286.95 9175.69,-2282.94 9229.86,-2276.77 9282.35,-2269.76"/>
<polygon fill="black" stroke="black" points="9283.03,-2273.2 9292.47,-2268.4 9282.1,-2266.26 9283.03,-2273.2"/>
</g>
<!-- l1_expert_agg_gpu9 -->
<g id="node208" class="node">
<title>l1_expert_agg_gpu9</title>
<polygon fill="yellow" stroke="black" points="10951.4,-2286.95 10235.71,-2286.95 10051.6,-2150.95 10767.29,-2150.95 10951.4,-2286.95"/>
<text text-anchor="middle" x="10501.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10501.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10501.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10501.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge434" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6012.55,-2323.68C6015.55,-2323.43 6018.53,-2323.18 6021.5,-2322.95 6912.45,-2254.24 9151.55,-2355.65 10042.5,-2286.95 10093.7,-2283.01 10147.87,-2276.87 10200.36,-2269.88"/>
<polygon fill="black" stroke="black" points="10201.04,-2273.32 10210.48,-2268.51 10200.1,-2266.38 10201.04,-2273.32"/>
</g>
<!-- l1_expert_agg_gpu10 -->
<g id="node216" class="node">
<title>l1_expert_agg_gpu10</title>
<polygon fill="yellow" stroke="black" points="11869.4,-2286.95 11153.71,-2286.95 10969.6,-2150.95 11685.29,-2150.95 11869.4,-2286.95"/>
<text text-anchor="middle" x="11419.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11419.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11419.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11419.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge435" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6012.55,-2323.68C6015.55,-2323.42 6018.53,-2323.18 6021.5,-2322.95 7115.9,-2239.46 9866.09,-2370.42 10960.5,-2286.95 11011.7,-2283.05 11065.88,-2276.93 11118.36,-2269.95"/>
<polygon fill="black" stroke="black" points="11119.04,-2273.39 11128.49,-2268.59 11118.11,-2266.45 11119.04,-2273.39"/>
</g>
<!-- l1_expert_agg_gpu11 -->
<g id="node224" class="node">
<title>l1_expert_agg_gpu11</title>
<polygon fill="yellow" stroke="black" points="12787.4,-2286.95 12071.71,-2286.95 11887.6,-2150.95 12603.29,-2150.95 12787.4,-2286.95"/>
<text text-anchor="middle" x="12337.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12337.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12337.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12337.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge436" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6012.55,-2323.67C6015.55,-2323.42 6018.53,-2323.18 6021.5,-2322.95 7319.37,-2224.69 10580.63,-2385.19 11878.5,-2286.95 11929.8,-2283.07 11984.08,-2276.95 12036.66,-2269.96"/>
<polygon fill="black" stroke="black" points="12037.35,-2273.4 12046.8,-2268.6 12036.42,-2266.46 12037.35,-2273.4"/>
</g>
<!-- l1_expert_agg_gpu12 -->
<g id="node232" class="node">
<title>l1_expert_agg_gpu12</title>
<polygon fill="yellow" stroke="black" points="13705.4,-2286.95 12989.71,-2286.95 12805.6,-2150.95 13521.29,-2150.95 13705.4,-2286.95"/>
<text text-anchor="middle" x="13255.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13255.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13255.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13255.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge437" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6012.55,-2323.67C6015.55,-2323.42 6018.53,-2323.18 6021.5,-2322.95 6772.16,-2266.43 12045.84,-2343.46 12796.5,-2286.95 12847.8,-2283.09 12902.08,-2276.99 12954.66,-2269.99"/>
<polygon fill="black" stroke="black" points="12955.36,-2273.43 12964.8,-2268.63 12954.42,-2266.49 12955.36,-2273.43"/>
</g>
<!-- l1_expert_agg_gpu13 -->
<g id="node240" class="node">
<title>l1_expert_agg_gpu13</title>
<polygon fill="yellow" stroke="black" points="14623.4,-2286.95 13907.71,-2286.95 13723.6,-2150.95 14439.29,-2150.95 14623.4,-2286.95"/>
<text text-anchor="middle" x="14173.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14173.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14173.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14173.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge438" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6012.55,-2323.67C6015.55,-2323.41 6018.53,-2323.18 6021.5,-2322.95 6873.89,-2259.04 12862.1,-2350.84 13714.5,-2286.95 13765.8,-2283.11 13820.08,-2277.01 13872.66,-2270.02"/>
<polygon fill="black" stroke="black" points="13873.36,-2273.46 13882.8,-2268.66 13872.43,-2266.52 13873.36,-2273.46"/>
</g>
<!-- l1_expert_agg_gpu14 -->
<g id="node248" class="node">
<title>l1_expert_agg_gpu14</title>
<polygon fill="yellow" stroke="black" points="15541.4,-2286.95 14825.71,-2286.95 14641.6,-2150.95 15357.29,-2150.95 15541.4,-2286.95"/>
<text text-anchor="middle" x="15091.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15091.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15091.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15091.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge439" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6012.55,-2323.66C6015.55,-2323.41 6018.53,-2323.17 6021.5,-2322.95 6975.63,-2251.66 13678.37,-2358.23 14632.5,-2286.95 14683.8,-2283.12 14738.08,-2277.03 14790.66,-2270.04"/>
<polygon fill="black" stroke="black" points="14791.36,-2273.48 14800.81,-2268.68 14790.43,-2266.54 14791.36,-2273.48"/>
</g>
<!-- l1_expert_agg_gpu15 -->
<g id="node256" class="node">
<title>l1_expert_agg_gpu15</title>
<polygon fill="yellow" stroke="black" points="16459.4,-2286.95 15743.71,-2286.95 15559.6,-2150.95 16275.29,-2150.95 16459.4,-2286.95"/>
<text text-anchor="middle" x="16009.5" y="-2237.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16009.5" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16009.5" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16009.5" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge440" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6012.55,-2323.66C6015.55,-2323.41 6018.53,-2323.17 6021.5,-2322.95 7077.36,-2244.27 14494.64,-2365.61 15550.5,-2286.95 15601.8,-2283.13 15656.09,-2277.04 15708.66,-2270.06"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.5 15718.81,-2268.7 15708.43,-2266.56 15709.36,-2273.5"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_0_gpu0 -->
<g id="edge423" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1398.63,-2448.59C1469.46,-2439.9 1544.45,-2431.96 1614.5,-2426.95 2393.02,-2371.3 4813.41,-2360.46 5568.28,-2358.41"/>
<polygon fill="black" stroke="black" points="5568.46,-2361.91 5578.45,-2358.39 5568.44,-2354.91 5568.46,-2361.91"/>
</g>
<!-- l1_expert_agg_gpu0&#45;&gt;l1_res2_gpu0 -->
<g id="edge441" class="edge">
<title>l1_expert_agg_gpu0&#45;&gt;l1_res2_gpu0</title>
<path fill="none" stroke="black" d="M1835.39,-2184.94C1510.98,-2158.45 1067.29,-2122.21 801.94,-2100.53"/>
<polygon fill="black" stroke="black" points="802.04,-2097.03 791.79,-2099.7 801.47,-2104 802.04,-2097.03"/>
</g>
<!-- l2_mha_qkv_gpu0 -->
<g id="node258" class="node">
<title>l2_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="621,-2010.95 140,-2010.95 140,-1942.95 621,-1942.95 621,-2010.95"/>
<text text-anchor="middle" x="380.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="380.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="380.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="380.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu0&#45;&gt;l2_mha_qkv_gpu0 -->
<g id="edge833" class="edge">
<title>l1_res2_gpu0&#45;&gt;l2_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M511.51,-2046.84C492.7,-2036.94 471.93,-2026.02 452.58,-2015.85"/>
<polygon fill="black" stroke="black" points="453.98,-2012.63 443.5,-2011.08 450.72,-2018.83 453.98,-2012.63"/>
</g>
<!-- l2_mha_res_add_gpu0 -->
<g id="node261" class="node">
<title>l2_mha_res_add_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="733.5,-1698.95 299.5,-1698.95 299.5,-1630.95 733.5,-1630.95 733.5,-1698.95"/>
<text text-anchor="middle" x="516.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="516.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="516.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="516.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu0&#45;&gt;l2_mha_res_add_gpu0 -->
<g id="edge837" class="edge">
<title>l1_res2_gpu0&#45;&gt;l2_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M608.43,-2046.6C616.98,-2036.08 625,-2023.82 629.5,-2010.95 670,-1895.16 687.42,-1841.43 626.5,-1734.95 619.9,-1723.41 610.5,-1713.53 599.95,-1705.15"/>
<polygon fill="black" stroke="black" points="601.8,-1702.17 591.68,-1699.03 597.64,-1707.8 601.8,-1702.17"/>
</g>
<!-- l1_mha_attn_gpu1 -->
<g id="node139" class="node">
<title>l1_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1733,-2874.95 1252,-2874.95 1252,-2806.95 1733,-2806.95 1733,-2874.95"/>
<text text-anchor="middle" x="1492.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1492.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1492.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1492.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu1&#45;&gt;l1_mha_attn_gpu1 -->
<g id="edge444" class="edge">
<title>l1_mha_qkv_gpu1&#45;&gt;l1_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M1492.5,-2910.84C1492.5,-2902.73 1492.5,-2893.94 1492.5,-2885.43"/>
<polygon fill="black" stroke="black" points="1496,-2885.25 1492.5,-2875.25 1489,-2885.25 1496,-2885.25"/>
</g>
<!-- l1_mha_out_gpu1 -->
<g id="node140" class="node">
<title>l1_mha_out_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1730,-2770.95 1261,-2770.95 1261,-2702.95 1730,-2702.95 1730,-2770.95"/>
<text text-anchor="middle" x="1495.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1495.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1495.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1495.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu1&#45;&gt;l1_mha_out_gpu1 -->
<g id="edge445" class="edge">
<title>l1_mha_attn_gpu1&#45;&gt;l1_mha_out_gpu1</title>
<path fill="none" stroke="black" d="M1493.47,-2806.84C1493.71,-2798.73 1493.97,-2789.94 1494.22,-2781.43"/>
<polygon fill="black" stroke="black" points="1497.73,-2781.35 1494.52,-2771.25 1490.73,-2781.15 1497.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu1&#45;&gt;l1_mha_res_add_gpu1 -->
<g id="edge446" class="edge">
<title>l1_mha_out_gpu1&#45;&gt;l1_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M1538.68,-2702.84C1550.88,-2693.48 1564.27,-2683.21 1576.91,-2673.52"/>
<polygon fill="black" stroke="black" points="1579.28,-2676.12 1585.08,-2667.25 1575.02,-2670.56 1579.28,-2676.12"/>
</g>
<!-- l1_expert_1_gpu1 -->
<g id="node142" class="node">
<title>l1_expert_1_gpu1</title>
<polygon fill="lightpink" stroke="black" points="6464.5,-2390.95 6030.5,-2390.95 6030.5,-2322.95 6464.5,-2322.95 6464.5,-2390.95"/>
<text text-anchor="middle" x="6247.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6247.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6247.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6247.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu1&#45;&gt;l1_expert_1_gpu1 -->
<g id="edge450" class="edge">
<title>l1_mha_res_add_gpu1&#45;&gt;l1_expert_1_gpu1</title>
<path fill="none" stroke="black" d="M1626.63,-2598.78C1626.02,-2551.85 1632.87,-2467.29 1685.5,-2426.95 1732.27,-2391.1 5781.7,-2395.36 6020.33,-2390.56"/>
<polygon fill="black" stroke="black" points="6020.57,-2394.05 6030.45,-2390.23 6020.34,-2387.05 6020.57,-2394.05"/>
</g>
<!-- l1_gate_gpu1 -->
<g id="node143" class="node">
<title>l1_gate_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="2646.24,-2562.95 1889.44,-2562.95 1694.76,-2426.95 2451.56,-2426.95 2646.24,-2562.95"/>
<text text-anchor="middle" x="2170.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2170.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2170.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2170.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu1&#45;&gt;l1_gate_gpu1 -->
<g id="edge448" class="edge">
<title>l1_mha_res_add_gpu1&#45;&gt;l1_gate_gpu1</title>
<path fill="none" stroke="black" d="M1760.05,-2598.94C1800.64,-2588.76 1846.96,-2577.14 1893.52,-2565.45"/>
<polygon fill="black" stroke="black" points="1894.6,-2568.79 1903.45,-2562.96 1892.9,-2562 1894.6,-2568.79"/>
</g>
<!-- l1_res2_gpu1 -->
<g id="node145" class="node">
<title>l1_res2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="1815.5,-2114.95 1381.5,-2114.95 1381.5,-2046.95 1815.5,-2046.95 1815.5,-2114.95"/>
<text text-anchor="middle" x="1598.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1598.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1598.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1598.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu1&#45;&gt;l1_res2_gpu1 -->
<g id="edge468" class="edge">
<title>l1_mha_res_add_gpu1&#45;&gt;l1_res2_gpu1</title>
<path fill="none" stroke="black" d="M1411.2,-2625.33C1109.39,-2615.04 596.87,-2593.23 568.5,-2562.95 505.9,-2496.14 505.96,-2217.82 568.5,-2150.95 595.53,-2122.05 1075.72,-2100.18 1370.79,-2089.4"/>
<polygon fill="black" stroke="black" points="1371.34,-2092.88 1381.21,-2089.02 1371.09,-2085.89 1371.34,-2092.88"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge451" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6030.45,-2323.69C6027.45,-2323.43 6024.46,-2323.18 6021.5,-2322.95 5285.25,-2265.47 3434.75,-2344.42 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.78,-2283.47 2688.53,-2286.15 2698.22,-2290.44 2698.78,-2283.47"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge452" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6030.45,-2323.71C6027.45,-2323.44 6024.46,-2323.19 6021.5,-2322.95 4955.91,-2237.54 4682.09,-2372.34 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.78,-2283.47 3606.53,-2286.13 3616.21,-2290.44 3616.78,-2283.47"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge453" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6030.45,-2323.75C6027.45,-2323.47 6024.46,-2323.2 6021.5,-2322.95 5362.78,-2267.09 5193.22,-2342.8 4534.5,-2286.95 4534.39,-2286.94 4534.29,-2286.94 4534.18,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.5,-2283.44 4524.23,-2286.06 4533.89,-2290.41 4534.5,-2283.44"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge454" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6030.43,-2323.91C6027.44,-2323.58 6024.46,-2323.26 6021.5,-2322.95 5769.48,-2296.63 5704.52,-2313.28 5452.5,-2286.95 5452.39,-2286.94 5452.28,-2286.93 5452.17,-2286.92"/>
<polygon fill="black" stroke="black" points="5452.26,-2283.41 5441.95,-2285.83 5451.52,-2290.37 5452.26,-2283.41"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge455" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6165.73,-2322.86C6141.56,-2313.07 6114.12,-2301.97 6086.43,-2290.76"/>
<polygon fill="black" stroke="black" points="6087.62,-2287.46 6077.04,-2286.96 6084.99,-2293.95 6087.62,-2287.46"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge456" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6388.76,-2322.94C6437.16,-2311.63 6493.16,-2298.55 6548.66,-2285.58"/>
<polygon fill="black" stroke="black" points="6549.71,-2288.93 6558.65,-2283.24 6548.12,-2282.11 6549.71,-2288.93"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge457" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6464.56,-2323.83C6467.56,-2323.53 6470.54,-2323.23 6473.5,-2322.95 6834.46,-2288.72 6927.54,-2321.18 7288.5,-2286.95 7339.15,-2282.15 7392.76,-2275.64 7444.78,-2268.55"/>
<polygon fill="black" stroke="black" points="7445.38,-2272 7454.81,-2267.17 7444.43,-2265.07 7445.38,-2272"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge458" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6464.55,-2323.73C6467.55,-2323.46 6470.54,-2323.2 6473.5,-2322.95 7241.24,-2259.18 7438.75,-2350.71 8206.5,-2286.95 8257.49,-2282.72 8311.44,-2276.46 8363.74,-2269.44"/>
<polygon fill="black" stroke="black" points="8364.39,-2272.89 8373.83,-2268.08 8363.45,-2265.95 8364.39,-2272.89"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge459" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6464.55,-2323.7C6467.55,-2323.44 6470.54,-2323.19 6473.5,-2322.95 7648.13,-2229.63 7949.87,-2380.25 9124.5,-2286.95 9175.69,-2282.89 9229.86,-2276.69 9282.34,-2269.68"/>
<polygon fill="black" stroke="black" points="9283.02,-2273.12 9292.47,-2268.31 9282.09,-2266.18 9283.02,-2273.12"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge460" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6464.55,-2323.69C6467.55,-2323.43 6470.54,-2323.18 6473.5,-2322.95 7264.27,-2261.51 9251.73,-2348.37 10042.5,-2286.95 10093.7,-2282.98 10147.87,-2276.82 10200.35,-2269.83"/>
<polygon fill="black" stroke="black" points="10201.03,-2273.27 10210.48,-2268.46 10200.1,-2266.33 10201.03,-2273.27"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge461" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6464.55,-2323.68C6467.55,-2323.42 6470.53,-2323.18 6473.5,-2322.95 7467.73,-2246.74 9966.27,-2363.14 10960.5,-2286.95 11011.7,-2283.03 11065.87,-2276.9 11118.36,-2269.92"/>
<polygon fill="black" stroke="black" points="11119.04,-2273.36 11128.49,-2268.55 11118.11,-2266.42 11119.04,-2273.36"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge462" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6464.55,-2323.67C6467.55,-2323.42 6470.53,-2323.18 6473.5,-2322.95 7671.19,-2231.96 10680.81,-2377.92 11878.5,-2286.95 11929.8,-2283.06 11984.08,-2276.93 12036.65,-2269.94"/>
<polygon fill="black" stroke="black" points="12037.35,-2273.37 12046.8,-2268.57 12036.42,-2266.44 12037.35,-2273.37"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge463" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6464.55,-2323.67C6467.55,-2323.42 6470.53,-2323.18 6473.5,-2322.95 7874.65,-2217.19 11395.35,-2392.69 12796.5,-2286.95 12847.8,-2283.08 12902.08,-2276.97 12954.66,-2269.98"/>
<polygon fill="black" stroke="black" points="12955.36,-2273.42 12964.8,-2268.62 12954.42,-2266.48 12955.36,-2273.42"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge464" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6464.55,-2323.67C6467.55,-2323.41 6470.53,-2323.18 6473.5,-2322.95 7275.8,-2262.68 12912.19,-2347.21 13714.5,-2286.95 13765.8,-2283.1 13820.08,-2277 13872.66,-2270.01"/>
<polygon fill="black" stroke="black" points="13873.36,-2273.45 13882.8,-2268.65 13872.43,-2266.51 13873.36,-2273.45"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge465" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6464.55,-2323.66C6467.55,-2323.41 6470.53,-2323.18 6473.5,-2322.95 7377.54,-2255.29 13728.46,-2354.59 14632.5,-2286.95 14683.8,-2283.11 14738.08,-2277.02 14790.66,-2270.03"/>
<polygon fill="black" stroke="black" points="14791.36,-2273.47 14800.8,-2268.67 14790.43,-2266.53 14791.36,-2273.47"/>
</g>
<!-- l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge466" class="edge">
<title>l1_expert_1_gpu1&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6464.55,-2323.66C6467.55,-2323.41 6470.53,-2323.17 6473.5,-2322.95 7479.27,-2247.91 14544.73,-2361.98 15550.5,-2286.95 15601.8,-2283.13 15656.08,-2277.04 15708.66,-2270.05"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.49 15718.81,-2268.69 15708.43,-2266.55 15709.36,-2273.49"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_1_gpu1 -->
<g id="edge449" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2482.26,-2448.34C2553.2,-2439.65 2628.32,-2431.77 2698.5,-2426.95 3431.93,-2376.62 5268.56,-2447.78 6020.29,-2391"/>
<polygon fill="black" stroke="black" points="6020.75,-2394.47 6030.45,-2390.22 6020.21,-2387.49 6020.75,-2394.47"/>
</g>
<!-- l1_expert_agg_gpu1&#45;&gt;l1_res2_gpu1 -->
<g id="edge467" class="edge">
<title>l1_expert_agg_gpu1&#45;&gt;l1_res2_gpu1</title>
<path fill="none" stroke="black" d="M2709.05,-2152.07C2705.52,-2151.69 2702,-2151.32 2698.5,-2150.95 2397.55,-2119.6 2048.68,-2100.66 1825.92,-2090.75"/>
<polygon fill="black" stroke="black" points="1825.89,-2087.25 1815.74,-2090.3 1825.58,-2094.24 1825.89,-2087.25"/>
</g>
<!-- l2_mha_qkv_gpu1 -->
<g id="node266" class="node">
<title>l2_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1705,-2010.95 1224,-2010.95 1224,-1942.95 1705,-1942.95 1705,-2010.95"/>
<text text-anchor="middle" x="1464.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1464.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1464.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1464.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu1&#45;&gt;l2_mha_qkv_gpu1 -->
<g id="edge859" class="edge">
<title>l1_res2_gpu1&#45;&gt;l2_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1554.99,-2046.84C1542.71,-2037.48 1529.21,-2027.21 1516.48,-2017.52"/>
<polygon fill="black" stroke="black" points="1518.32,-2014.52 1508.25,-2011.25 1514.08,-2020.09 1518.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu1 -->
<g id="node269" class="node">
<title>l2_mha_res_add_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="1817.5,-1698.95 1383.5,-1698.95 1383.5,-1630.95 1817.5,-1630.95 1817.5,-1698.95"/>
<text text-anchor="middle" x="1600.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1600.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1600.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1600.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu1&#45;&gt;l2_mha_res_add_gpu1 -->
<g id="edge863" class="edge">
<title>l1_res2_gpu1&#45;&gt;l2_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M1678.53,-2046.87C1692.53,-2037.38 1705.24,-2025.54 1713.5,-2010.95 1773.94,-1904.2 1771.42,-1841.43 1710.5,-1734.95 1703.9,-1723.41 1694.5,-1713.53 1683.95,-1705.15"/>
<polygon fill="black" stroke="black" points="1685.8,-1702.17 1675.68,-1699.03 1681.64,-1707.8 1685.8,-1702.17"/>
</g>
<!-- l1_mha_attn_gpu2 -->
<g id="node147" class="node">
<title>l1_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2817,-2874.95 2336,-2874.95 2336,-2806.95 2817,-2806.95 2817,-2874.95"/>
<text text-anchor="middle" x="2576.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2576.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2576.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2576.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu2&#45;&gt;l1_mha_attn_gpu2 -->
<g id="edge470" class="edge">
<title>l1_mha_qkv_gpu2&#45;&gt;l1_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M2576.5,-2910.84C2576.5,-2902.73 2576.5,-2893.94 2576.5,-2885.43"/>
<polygon fill="black" stroke="black" points="2580,-2885.25 2576.5,-2875.25 2573,-2885.25 2580,-2885.25"/>
</g>
<!-- l1_mha_out_gpu2 -->
<g id="node148" class="node">
<title>l1_mha_out_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2814,-2770.95 2345,-2770.95 2345,-2702.95 2814,-2702.95 2814,-2770.95"/>
<text text-anchor="middle" x="2579.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2579.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2579.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2579.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu2&#45;&gt;l1_mha_out_gpu2 -->
<g id="edge471" class="edge">
<title>l1_mha_attn_gpu2&#45;&gt;l1_mha_out_gpu2</title>
<path fill="none" stroke="black" d="M2577.47,-2806.84C2577.71,-2798.73 2577.97,-2789.94 2578.22,-2781.43"/>
<polygon fill="black" stroke="black" points="2581.73,-2781.35 2578.52,-2771.25 2574.73,-2781.15 2581.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu2&#45;&gt;l1_mha_res_add_gpu2 -->
<g id="edge472" class="edge">
<title>l1_mha_out_gpu2&#45;&gt;l1_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M2622.68,-2702.84C2634.88,-2693.48 2648.27,-2683.21 2660.91,-2673.52"/>
<polygon fill="black" stroke="black" points="2663.28,-2676.12 2669.08,-2667.25 2659.02,-2670.56 2663.28,-2676.12"/>
</g>
<!-- l1_expert_2_gpu2 -->
<g id="node150" class="node">
<title>l1_expert_2_gpu2</title>
<polygon fill="lightpink" stroke="black" points="6916.5,-2390.95 6482.5,-2390.95 6482.5,-2322.95 6916.5,-2322.95 6916.5,-2390.95"/>
<text text-anchor="middle" x="6699.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6699.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6699.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6699.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu2&#45;&gt;l1_expert_2_gpu2 -->
<g id="edge476" class="edge">
<title>l1_mha_res_add_gpu2&#45;&gt;l1_expert_2_gpu2</title>
<path fill="none" stroke="black" d="M2710.64,-2598.79C2710.04,-2551.87 2716.9,-2467.33 2769.5,-2426.95 2809.35,-2396.36 6254.86,-2394.98 6472.45,-2390.55"/>
<polygon fill="black" stroke="black" points="6472.57,-2394.04 6482.45,-2390.22 6472.34,-2387.05 6472.57,-2394.04"/>
</g>
<!-- l1_gate_gpu2 -->
<g id="node151" class="node">
<title>l1_gate_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="3730.24,-2562.95 2973.44,-2562.95 2778.76,-2426.95 3535.56,-2426.95 3730.24,-2562.95"/>
<text text-anchor="middle" x="3254.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3254.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3254.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3254.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu2&#45;&gt;l1_gate_gpu2 -->
<g id="edge474" class="edge">
<title>l1_mha_res_add_gpu2&#45;&gt;l1_gate_gpu2</title>
<path fill="none" stroke="black" d="M2844.05,-2598.94C2884.64,-2588.76 2930.96,-2577.14 2977.52,-2565.45"/>
<polygon fill="black" stroke="black" points="2978.6,-2568.79 2987.45,-2562.96 2976.9,-2562 2978.6,-2568.79"/>
</g>
<!-- l1_res2_gpu2 -->
<g id="node153" class="node">
<title>l1_res2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="2899.5,-2114.95 2465.5,-2114.95 2465.5,-2046.95 2899.5,-2046.95 2899.5,-2114.95"/>
<text text-anchor="middle" x="2682.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2682.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2682.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2682.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu2&#45;&gt;l1_res2_gpu2 -->
<g id="edge494" class="edge">
<title>l1_mha_res_add_gpu2&#45;&gt;l1_res2_gpu2</title>
<path fill="none" stroke="black" d="M2495.21,-2623.01C2321.78,-2616.02 2072.58,-2606.28 1854.5,-2598.95 1819.7,-2597.78 625.77,-2587.93 601.5,-2562.95 559.38,-2519.6 565.04,-2475.16 601.5,-2426.95 873.14,-2067.74 1132.56,-2226.74 1576.5,-2150.95 1877.44,-2099.58 2230.26,-2085.38 2455.01,-2082.01"/>
<polygon fill="black" stroke="black" points="2455.33,-2085.51 2465.28,-2081.87 2455.23,-2078.51 2455.33,-2085.51"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge477" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6482.45,-2323.69C6479.45,-2323.43 6476.47,-2323.18 6473.5,-2322.95 5637.08,-2258.2 3534.93,-2351.69 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.16 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge478" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6482.45,-2323.7C6479.45,-2323.44 6476.46,-2323.19 6473.5,-2322.95 5207.56,-2222.99 4882.44,-2386.88 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.78,-2283.47 3606.53,-2286.14 3616.21,-2290.44 3616.78,-2283.47"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge479" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6482.45,-2323.72C6479.45,-2323.45 6476.46,-2323.2 6473.5,-2322.95 5614.45,-2252.54 5393.55,-2357.34 4534.5,-2286.95 4534.4,-2286.94 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.79,-2283.47 4524.53,-2286.11 4534.2,-2290.44 4534.79,-2283.47"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge480" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6482.44,-2323.79C6479.44,-2323.5 6476.46,-2323.22 6473.5,-2322.95 6021.28,-2282.09 5904.72,-2327.81 5452.5,-2286.95 5452.39,-2286.94 5452.29,-2286.93 5452.18,-2286.92"/>
<polygon fill="black" stroke="black" points="5452.51,-2283.44 5442.24,-2286.01 5451.87,-2290.41 5452.51,-2283.44"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge481" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6508.24,-2322.94C6448,-2312.55 6379.07,-2300.65 6309.95,-2288.72"/>
<polygon fill="black" stroke="black" points="6310.2,-2285.21 6299.75,-2286.96 6309.01,-2292.11 6310.2,-2285.21"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge482" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6731.3,-2322.68C6739.51,-2314.1 6748.68,-2304.5 6758.03,-2294.72"/>
<polygon fill="black" stroke="black" points="6760.82,-2296.86 6765.2,-2287.22 6755.76,-2292.03 6760.82,-2296.86"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge483" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6916.59,-2324.06C6919.58,-2323.68 6922.55,-2323.32 6925.5,-2322.95 7086.42,-2303.24 7127.58,-2306.67 7288.5,-2286.95 7338.15,-2280.87 7390.72,-2273.8 7441.88,-2266.57"/>
<polygon fill="black" stroke="black" points="7442.68,-2269.99 7452.09,-2265.12 7441.7,-2263.06 7442.68,-2269.99"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge484" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6916.55,-2323.76C6919.55,-2323.48 6922.54,-2323.21 6925.5,-2322.95 7492.93,-2273.72 7639.07,-2336.17 8206.5,-2286.95 8257.38,-2282.54 8311.21,-2276.2 8363.42,-2269.16"/>
<polygon fill="black" stroke="black" points="8364.05,-2272.61 8373.49,-2267.8 8363.11,-2265.67 8364.05,-2272.61"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge485" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6916.55,-2323.71C6919.55,-2323.45 6922.54,-2323.19 6925.5,-2322.95 7899.78,-2244.18 8150.21,-2365.71 9124.5,-2286.95 9175.59,-2282.82 9229.65,-2276.61 9282.04,-2269.59"/>
<polygon fill="black" stroke="black" points="9282.71,-2273.04 9292.15,-2268.23 9281.77,-2266.1 9282.71,-2273.04"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge486" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6916.55,-2323.69C6919.55,-2323.43 6922.54,-2323.19 6925.5,-2322.95 7616.09,-2268.79 9351.91,-2341.1 10042.5,-2286.95 10093.69,-2282.94 10147.86,-2276.77 10200.35,-2269.76"/>
<polygon fill="black" stroke="black" points="10201.03,-2273.2 10210.47,-2268.4 10200.1,-2266.27 10201.03,-2273.2"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge487" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6916.55,-2323.68C6919.55,-2323.43 6922.53,-2323.18 6925.5,-2322.95 7819.55,-2254.01 10066.45,-2355.87 10960.5,-2286.95 11011.7,-2283.01 11065.87,-2276.87 11118.36,-2269.88"/>
<polygon fill="black" stroke="black" points="11119.04,-2273.32 11128.48,-2268.51 11118.11,-2266.38 11119.04,-2273.32"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge488" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6916.55,-2323.68C6919.55,-2323.42 6922.53,-2323.18 6925.5,-2322.95 8023.01,-2239.24 10780.99,-2370.64 11878.5,-2286.95 11929.7,-2283.05 11983.88,-2276.93 12036.36,-2269.95"/>
<polygon fill="black" stroke="black" points="12037.04,-2273.39 12046.49,-2268.59 12036.11,-2266.45 12037.04,-2273.39"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge489" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6916.55,-2323.67C6919.55,-2323.42 6922.53,-2323.18 6925.5,-2322.95 8226.47,-2224.46 11495.53,-2385.41 12796.5,-2286.95 12847.8,-2283.07 12902.08,-2276.95 12954.66,-2269.96"/>
<polygon fill="black" stroke="black" points="12955.35,-2273.4 12964.8,-2268.6 12954.42,-2266.46 12955.35,-2273.4"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge490" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6916.55,-2323.67C6919.55,-2323.42 6922.53,-2323.18 6925.5,-2322.95 7677.71,-2266.32 12962.28,-2343.57 13714.5,-2286.95 13765.8,-2283.09 13820.08,-2276.99 13872.66,-2270"/>
<polygon fill="black" stroke="black" points="13873.36,-2273.43 13882.8,-2268.63 13872.43,-2266.5 13873.36,-2273.43"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge491" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6916.55,-2323.67C6919.55,-2323.41 6922.53,-2323.18 6925.5,-2322.95 7779.45,-2258.93 13778.55,-2350.96 14632.5,-2286.95 14683.8,-2283.11 14738.08,-2277.01 14790.66,-2270.02"/>
<polygon fill="black" stroke="black" points="14791.36,-2273.46 14800.8,-2268.66 14790.43,-2266.52 14791.36,-2273.46"/>
</g>
<!-- l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge492" class="edge">
<title>l1_expert_2_gpu2&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6916.55,-2323.66C6919.55,-2323.41 6922.53,-2323.17 6925.5,-2322.95 7881.18,-2251.54 14594.82,-2358.34 15550.5,-2286.95 15601.8,-2283.12 15656.08,-2277.03 15708.66,-2270.04"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.48 15718.81,-2268.68 15708.43,-2266.54 15709.36,-2273.48"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_2_gpu2 -->
<g id="edge475" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3562.98,-2445.91C3623.05,-2438.22 3685.63,-2431.35 3744.5,-2426.95 4950.73,-2336.87 5262.55,-2485.95 6472.21,-2391.01"/>
<polygon fill="black" stroke="black" points="6472.76,-2394.48 6482.45,-2390.21 6472.21,-2387.5 6472.76,-2394.48"/>
</g>
<!-- l1_expert_agg_gpu2&#45;&gt;l1_res2_gpu2 -->
<g id="edge493" class="edge">
<title>l1_expert_agg_gpu2&#45;&gt;l1_res2_gpu2</title>
<path fill="none" stroke="black" d="M3627.05,-2152.13C3623.52,-2151.73 3620,-2151.34 3616.5,-2150.95 3375.94,-2124.54 3099.39,-2105.52 2910.02,-2094.22"/>
<polygon fill="black" stroke="black" points="2910.12,-2090.72 2899.93,-2093.62 2909.71,-2097.71 2910.12,-2090.72"/>
</g>
<!-- l2_mha_qkv_gpu2 -->
<g id="node274" class="node">
<title>l2_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2789,-2010.95 2308,-2010.95 2308,-1942.95 2789,-1942.95 2789,-2010.95"/>
<text text-anchor="middle" x="2548.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2548.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2548.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2548.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu2&#45;&gt;l2_mha_qkv_gpu2 -->
<g id="edge885" class="edge">
<title>l1_res2_gpu2&#45;&gt;l2_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2638.99,-2046.84C2626.71,-2037.48 2613.21,-2027.21 2600.48,-2017.52"/>
<polygon fill="black" stroke="black" points="2602.32,-2014.52 2592.25,-2011.25 2598.08,-2020.09 2602.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu2 -->
<g id="node277" class="node">
<title>l2_mha_res_add_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="2901.5,-1698.95 2467.5,-1698.95 2467.5,-1630.95 2901.5,-1630.95 2901.5,-1698.95"/>
<text text-anchor="middle" x="2684.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2684.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2684.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2684.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu2&#45;&gt;l2_mha_res_add_gpu2 -->
<g id="edge889" class="edge">
<title>l1_res2_gpu2&#45;&gt;l2_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M2762.53,-2046.87C2776.53,-2037.38 2789.24,-2025.54 2797.5,-2010.95 2857.94,-1904.2 2855.42,-1841.43 2794.5,-1734.95 2787.9,-1723.41 2778.5,-1713.53 2767.95,-1705.15"/>
<polygon fill="black" stroke="black" points="2769.8,-1702.17 2759.68,-1699.03 2765.64,-1707.8 2769.8,-1702.17"/>
</g>
<!-- l1_mha_attn_gpu3 -->
<g id="node155" class="node">
<title>l1_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3863,-2874.95 3382,-2874.95 3382,-2806.95 3863,-2806.95 3863,-2874.95"/>
<text text-anchor="middle" x="3622.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3622.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3622.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3622.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu3&#45;&gt;l1_mha_attn_gpu3 -->
<g id="edge496" class="edge">
<title>l1_mha_qkv_gpu3&#45;&gt;l1_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M3622.5,-2910.84C3622.5,-2902.73 3622.5,-2893.94 3622.5,-2885.43"/>
<polygon fill="black" stroke="black" points="3626,-2885.25 3622.5,-2875.25 3619,-2885.25 3626,-2885.25"/>
</g>
<!-- l1_mha_out_gpu3 -->
<g id="node156" class="node">
<title>l1_mha_out_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3860,-2770.95 3391,-2770.95 3391,-2702.95 3860,-2702.95 3860,-2770.95"/>
<text text-anchor="middle" x="3625.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3625.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3625.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3625.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu3&#45;&gt;l1_mha_out_gpu3 -->
<g id="edge497" class="edge">
<title>l1_mha_attn_gpu3&#45;&gt;l1_mha_out_gpu3</title>
<path fill="none" stroke="black" d="M3623.47,-2806.84C3623.71,-2798.73 3623.97,-2789.94 3624.22,-2781.43"/>
<polygon fill="black" stroke="black" points="3627.73,-2781.35 3624.52,-2771.25 3620.73,-2781.15 3627.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu3&#45;&gt;l1_mha_res_add_gpu3 -->
<g id="edge498" class="edge">
<title>l1_mha_out_gpu3&#45;&gt;l1_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M3668.68,-2702.84C3680.88,-2693.48 3694.27,-2683.21 3706.91,-2673.52"/>
<polygon fill="black" stroke="black" points="3709.28,-2676.12 3715.08,-2667.25 3705.02,-2670.56 3709.28,-2676.12"/>
</g>
<!-- l1_expert_3_gpu3 -->
<g id="node158" class="node">
<title>l1_expert_3_gpu3</title>
<polygon fill="lightpink" stroke="black" points="7368.5,-2390.95 6934.5,-2390.95 6934.5,-2322.95 7368.5,-2322.95 7368.5,-2390.95"/>
<text text-anchor="middle" x="7151.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7151.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="7151.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7151.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu3&#45;&gt;l1_expert_3_gpu3 -->
<g id="edge502" class="edge">
<title>l1_mha_res_add_gpu3&#45;&gt;l1_expert_3_gpu3</title>
<path fill="none" stroke="black" d="M3800.08,-2598.87C3864.2,-2550.16 3993.07,-2461.22 4119.5,-2426.95 4267.48,-2386.85 6687.72,-2402.69 6924.35,-2390.83"/>
<polygon fill="black" stroke="black" points="6924.69,-2394.32 6934.45,-2390.21 6924.25,-2387.33 6924.69,-2394.32"/>
</g>
<!-- l1_gate_gpu3 -->
<g id="node159" class="node">
<title>l1_gate_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="5080.24,-2562.95 4323.44,-2562.95 4128.76,-2426.95 4885.56,-2426.95 5080.24,-2562.95"/>
<text text-anchor="middle" x="4604.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4604.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4604.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4604.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu3&#45;&gt;l1_gate_gpu3 -->
<g id="edge500" class="edge">
<title>l1_mha_res_add_gpu3&#45;&gt;l1_gate_gpu3</title>
<path fill="none" stroke="black" d="M3963.83,-2598.94C4061.05,-2583.32 4179.36,-2564.3 4287.73,-2546.88"/>
<polygon fill="black" stroke="black" points="4288.53,-2550.29 4297.84,-2545.25 4287.42,-2543.38 4288.53,-2550.29"/>
</g>
<!-- l1_res2_gpu3 -->
<g id="node161" class="node">
<title>l1_res2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="3945.5,-2114.95 3511.5,-2114.95 3511.5,-2046.95 3945.5,-2046.95 3945.5,-2114.95"/>
<text text-anchor="middle" x="3728.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3728.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3728.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3728.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu3&#45;&gt;l1_res2_gpu3 -->
<g id="edge520" class="edge">
<title>l1_mha_res_add_gpu3&#45;&gt;l1_res2_gpu3</title>
<path fill="none" stroke="black" d="M3541.42,-2622.47C3376.15,-2615.43 3143.01,-2605.89 2938.5,-2598.95 2902.26,-2597.72 1659.38,-2588.35 1633.5,-2562.95 1568.14,-2498.82 1563.29,-2216.23 1627.5,-2150.95 1652.46,-2125.58 2872.92,-2116.17 2908.5,-2114.95 3108.82,-2108.11 3336.6,-2098.82 3501.17,-2091.84"/>
<polygon fill="black" stroke="black" points="3501.58,-2095.33 3511.42,-2091.41 3501.28,-2088.33 3501.58,-2095.33"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge503" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6934.45,-2323.68C6931.45,-2323.42 6928.47,-2323.18 6925.5,-2322.95 5988.9,-2250.92 3635.1,-2358.96 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.16 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge504" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6934.45,-2323.69C6931.45,-2323.43 6928.46,-2323.18 6925.5,-2322.95 6192.36,-2265.7 4349.65,-2344.19 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.78,-2283.47 3606.53,-2286.15 3616.21,-2290.44 3616.78,-2283.47"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge505" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6934.45,-2323.71C6931.45,-2323.44 6928.46,-2323.19 6925.5,-2322.95 5866.11,-2238 5593.89,-2371.89 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.78,-2283.47 4524.53,-2286.13 4534.21,-2290.44 4534.78,-2283.47"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge506" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6934.45,-2323.75C6931.45,-2323.47 6928.46,-2323.2 6925.5,-2322.95 6272.99,-2267.54 6105.02,-2342.35 5452.5,-2286.95 5452.39,-2286.94 5452.29,-2286.94 5452.18,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.5,-2283.44 5442.23,-2286.06 5451.89,-2290.41 5452.5,-2283.44"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge507" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6934.43,-2323.92C6931.44,-2323.59 6928.46,-2323.26 6925.5,-2322.95 6679.67,-2297.08 6616.33,-2312.83 6370.5,-2286.95 6370.39,-2286.94 6370.28,-2286.93 6370.17,-2286.92"/>
<polygon fill="black" stroke="black" points="6370.26,-2283.41 6359.95,-2285.83 6369.52,-2290.37 6370.26,-2283.41"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge508" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7073.14,-2322.86C7050.08,-2313.12 7023.91,-2302.06 6997.49,-2290.91"/>
<polygon fill="black" stroke="black" points="6998.71,-2287.62 6988.14,-2286.96 6995.99,-2294.07 6998.71,-2287.62"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge509" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7296.16,-2322.94C7347.23,-2311.29 7406.57,-2297.75 7465.1,-2284.39"/>
<polygon fill="black" stroke="black" points="7465.9,-2287.8 7474.87,-2282.16 7464.34,-2280.98 7465.9,-2287.8"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge510" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7368.56,-2323.83C7371.56,-2323.52 7374.54,-2323.23 7377.5,-2322.95 7744.66,-2288.27 7839.34,-2321.63 8206.5,-2286.95 8257.15,-2282.17 8310.76,-2275.67 8362.78,-2268.58"/>
<polygon fill="black" stroke="black" points="8363.38,-2272.03 8372.82,-2267.21 8362.43,-2265.1 8363.38,-2272.03"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge511" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7368.55,-2323.73C7371.55,-2323.46 7374.54,-2323.2 7377.5,-2322.95 8151.45,-2258.72 8350.55,-2351.16 9124.5,-2286.95 9175.49,-2282.72 9229.44,-2276.47 9281.74,-2269.45"/>
<polygon fill="black" stroke="black" points="9282.39,-2272.89 9291.83,-2268.08 9281.45,-2265.96 9282.39,-2272.89"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge512" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7368.55,-2323.7C7371.55,-2323.44 7374.54,-2323.19 7377.5,-2322.95 8558.33,-2229.18 8861.66,-2380.7 10042.5,-2286.95 10093.69,-2282.89 10147.86,-2276.69 10200.34,-2269.68"/>
<polygon fill="black" stroke="black" points="10201.02,-2273.12 10210.47,-2268.31 10200.09,-2266.18 10201.02,-2273.12"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge513" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7368.55,-2323.69C7371.55,-2323.43 7374.54,-2323.18 7377.5,-2322.95 8171.37,-2261.29 10166.63,-2348.6 10960.5,-2286.95 11011.7,-2282.98 11065.87,-2276.83 11118.35,-2269.83"/>
<polygon fill="black" stroke="black" points="11119.04,-2273.27 11128.48,-2268.47 11118.1,-2266.33 11119.04,-2273.27"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge514" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7368.55,-2323.68C7371.55,-2323.42 7374.53,-2323.18 7377.5,-2322.95 8374.83,-2246.51 10881.17,-2363.37 11878.5,-2286.95 11929.7,-2283.03 11983.87,-2276.9 12036.36,-2269.92"/>
<polygon fill="black" stroke="black" points="12037.04,-2273.36 12046.49,-2268.56 12036.11,-2266.42 12037.04,-2273.36"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge515" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7368.55,-2323.67C7371.55,-2323.42 7374.53,-2323.18 7377.5,-2322.95 8578.29,-2231.74 11595.71,-2378.14 12796.5,-2286.95 12847.8,-2283.06 12902.08,-2276.93 12954.65,-2269.94"/>
<polygon fill="black" stroke="black" points="12955.35,-2273.37 12964.8,-2268.57 12954.42,-2266.44 12955.35,-2273.37"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge516" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7368.55,-2323.67C7371.55,-2323.42 7374.53,-2323.18 7377.5,-2322.95 8781.75,-2216.96 12310.25,-2392.91 13714.5,-2286.95 13765.8,-2283.08 13820.08,-2276.97 13872.66,-2269.98"/>
<polygon fill="black" stroke="black" points="13873.36,-2273.42 13882.8,-2268.62 13872.42,-2266.48 13873.36,-2273.42"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge517" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7368.55,-2323.67C7371.55,-2323.41 7374.53,-2323.18 7377.5,-2322.95 8181.36,-2262.57 13828.64,-2347.32 14632.5,-2286.95 14683.8,-2283.1 14738.08,-2277 14790.66,-2270.01"/>
<polygon fill="black" stroke="black" points="14791.36,-2273.45 14800.8,-2268.65 14790.43,-2266.51 14791.36,-2273.45"/>
</g>
<!-- l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge518" class="edge">
<title>l1_expert_3_gpu3&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7368.55,-2323.66C7371.55,-2323.41 7374.53,-2323.18 7377.5,-2322.95 8283.09,-2255.18 14644.91,-2354.7 15550.5,-2286.95 15601.8,-2283.12 15656.08,-2277.02 15708.66,-2270.03"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.47 15718.8,-2268.67 15708.43,-2266.53 15709.36,-2273.47"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_3_gpu3 -->
<g id="edge501" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4934.93,-2461.28C5075.53,-2448.55 5241.4,-2435.1 5391.5,-2426.95 6069.14,-2390.19 6244.25,-2447.76 6924.4,-2391.01"/>
<polygon fill="black" stroke="black" points="6924.78,-2394.49 6934.45,-2390.16 6924.19,-2387.51 6924.78,-2394.49"/>
</g>
<!-- l1_expert_agg_gpu3&#45;&gt;l1_res2_gpu3 -->
<g id="edge519" class="edge">
<title>l1_expert_agg_gpu3&#45;&gt;l1_res2_gpu3</title>
<path fill="none" stroke="black" d="M4545.04,-2152.18C4541.51,-2151.77 4538,-2151.36 4534.5,-2150.95 4339.6,-2128.41 4117.4,-2109.92 3955.73,-2097.78"/>
<polygon fill="black" stroke="black" points="3955.89,-2094.28 3945.65,-2097.02 3955.36,-2101.26 3955.89,-2094.28"/>
</g>
<!-- l2_mha_qkv_gpu3 -->
<g id="node282" class="node">
<title>l2_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3835,-2010.95 3354,-2010.95 3354,-1942.95 3835,-1942.95 3835,-2010.95"/>
<text text-anchor="middle" x="3594.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3594.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3594.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3594.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu3&#45;&gt;l2_mha_qkv_gpu3 -->
<g id="edge911" class="edge">
<title>l1_res2_gpu3&#45;&gt;l2_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M3684.99,-2046.84C3672.71,-2037.48 3659.21,-2027.21 3646.48,-2017.52"/>
<polygon fill="black" stroke="black" points="3648.32,-2014.52 3638.25,-2011.25 3644.08,-2020.09 3648.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu3 -->
<g id="node285" class="node">
<title>l2_mha_res_add_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="3947.5,-1698.95 3513.5,-1698.95 3513.5,-1630.95 3947.5,-1630.95 3947.5,-1698.95"/>
<text text-anchor="middle" x="3730.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3730.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3730.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3730.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu3&#45;&gt;l2_mha_res_add_gpu3 -->
<g id="edge915" class="edge">
<title>l1_res2_gpu3&#45;&gt;l2_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M3809.5,-2046.79C3823.51,-2037.33 3836.22,-2025.52 3844.5,-2010.95 3905.14,-1904.32 3902.64,-1841.31 3841.5,-1734.95 3834.88,-1723.43 3825.47,-1713.57 3814.91,-1705.21"/>
<polygon fill="black" stroke="black" points="3816.76,-1702.23 3806.63,-1699.11 3812.61,-1707.86 3816.76,-1702.23"/>
</g>
<!-- l1_mha_attn_gpu4 -->
<g id="node163" class="node">
<title>l1_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5510,-2874.95 5029,-2874.95 5029,-2806.95 5510,-2806.95 5510,-2874.95"/>
<text text-anchor="middle" x="5269.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5269.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5269.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5269.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu4&#45;&gt;l1_mha_attn_gpu4 -->
<g id="edge522" class="edge">
<title>l1_mha_qkv_gpu4&#45;&gt;l1_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M5269.5,-2910.84C5269.5,-2902.73 5269.5,-2893.94 5269.5,-2885.43"/>
<polygon fill="black" stroke="black" points="5273,-2885.25 5269.5,-2875.25 5266,-2885.25 5273,-2885.25"/>
</g>
<!-- l1_mha_out_gpu4 -->
<g id="node164" class="node">
<title>l1_mha_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5507,-2770.95 5038,-2770.95 5038,-2702.95 5507,-2702.95 5507,-2770.95"/>
<text text-anchor="middle" x="5272.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5272.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5272.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5272.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu4&#45;&gt;l1_mha_out_gpu4 -->
<g id="edge523" class="edge">
<title>l1_mha_attn_gpu4&#45;&gt;l1_mha_out_gpu4</title>
<path fill="none" stroke="black" d="M5270.47,-2806.84C5270.71,-2798.73 5270.97,-2789.94 5271.22,-2781.43"/>
<polygon fill="black" stroke="black" points="5274.73,-2781.35 5271.52,-2771.25 5267.73,-2781.15 5274.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu4&#45;&gt;l1_mha_res_add_gpu4 -->
<g id="edge524" class="edge">
<title>l1_mha_out_gpu4&#45;&gt;l1_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M5315.68,-2702.84C5327.88,-2693.48 5341.27,-2683.21 5353.91,-2673.52"/>
<polygon fill="black" stroke="black" points="5356.28,-2676.12 5362.08,-2667.25 5352.02,-2670.56 5356.28,-2676.12"/>
</g>
<!-- l1_expert_4_gpu4 -->
<g id="node166" class="node">
<title>l1_expert_4_gpu4</title>
<polygon fill="lightpink" stroke="black" points="7820.5,-2390.95 7386.5,-2390.95 7386.5,-2322.95 7820.5,-2322.95 7820.5,-2390.95"/>
<text text-anchor="middle" x="7603.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7603.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7603.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7603.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu4&#45;&gt;l1_expert_4_gpu4 -->
<g id="edge528" class="edge">
<title>l1_mha_res_add_gpu4&#45;&gt;l1_expert_4_gpu4</title>
<path fill="none" stroke="black" d="M5396.82,-2598.9C5386.96,-2552.91 5377.75,-2470.37 5424.5,-2426.95 5463.09,-2391.11 7216.05,-2395.1 7376.38,-2390.61"/>
<polygon fill="black" stroke="black" points="7376.61,-2394.11 7386.45,-2390.18 7376.31,-2387.11 7376.61,-2394.11"/>
</g>
<!-- l1_gate_gpu4 -->
<g id="node167" class="node">
<title>l1_gate_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="6385.24,-2562.95 5628.44,-2562.95 5433.76,-2426.95 6190.56,-2426.95 6385.24,-2562.95"/>
<text text-anchor="middle" x="5909.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5909.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5909.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5909.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu4&#45;&gt;l1_gate_gpu4 -->
<g id="edge526" class="edge">
<title>l1_mha_res_add_gpu4&#45;&gt;l1_gate_gpu4</title>
<path fill="none" stroke="black" d="M5527.83,-2598.94C5565.41,-2588.8 5608.28,-2577.23 5651.39,-2565.6"/>
<polygon fill="black" stroke="black" points="5652.43,-2568.95 5661.17,-2562.96 5650.61,-2562.19 5652.43,-2568.95"/>
</g>
<!-- l1_res2_gpu4 -->
<g id="node169" class="node">
<title>l1_res2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5639.5,-2114.95 5205.5,-2114.95 5205.5,-2046.95 5639.5,-2046.95 5639.5,-2114.95"/>
<text text-anchor="middle" x="5422.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5422.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5422.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5422.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu4&#45;&gt;l1_res2_gpu4 -->
<g id="edge546" class="edge">
<title>l1_mha_res_add_gpu4&#45;&gt;l1_res2_gpu4</title>
<path fill="none" stroke="black" d="M5188.24,-2626.4C4909.49,-2619.39 4411.02,-2607.25 3984.5,-2598.95 3952.57,-2598.33 1708.47,-2585.14 1685.5,-2562.95 1619.6,-2499.32 1607.24,-2216.24 1671.5,-2150.95 1693.75,-2128.35 3922.79,-2115.56 3954.5,-2114.95 4393.74,-2106.55 4906.85,-2094.51 5195.33,-2087.53"/>
<polygon fill="black" stroke="black" points="5195.58,-2091.03 5205.5,-2087.29 5195.41,-2084.03 5195.58,-2091.03"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge529" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7386.45,-2323.68C7383.45,-2323.42 7380.47,-2323.18 7377.5,-2322.95 6340.72,-2243.65 3735.28,-2366.23 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.17 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge530" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7386.45,-2323.69C7383.45,-2323.43 7380.47,-2323.18 7377.5,-2322.95 6544.18,-2258.42 4449.82,-2351.46 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.16 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge531" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7386.45,-2323.7C7383.45,-2323.44 7380.46,-2323.19 7377.5,-2322.95 6117.77,-2223.45 5794.24,-2386.43 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.78,-2283.47 4524.53,-2286.14 4534.21,-2290.44 4534.78,-2283.47"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge532" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7386.45,-2323.72C7383.45,-2323.45 7380.46,-2323.2 7377.5,-2322.95 6524.66,-2253 6305.34,-2356.89 5452.5,-2286.95 5452.4,-2286.94 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.79,-2283.47 5442.53,-2286.11 5452.2,-2290.44 5452.79,-2283.47"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge533" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7386.44,-2323.8C7383.44,-2323.5 7380.46,-2323.22 7377.5,-2322.95 6931.49,-2282.54 6816.52,-2327.36 6370.5,-2286.95 6370.39,-2286.94 6370.29,-2286.93 6370.18,-2286.92"/>
<polygon fill="black" stroke="black" points="6370.52,-2283.44 6360.24,-2286 6369.87,-2290.41 6370.52,-2283.44"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge534" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7415.64,-2322.94C7356.47,-2312.55 7288.76,-2300.65 7220.87,-2288.72"/>
<polygon fill="black" stroke="black" points="7221.31,-2285.25 7210.86,-2286.96 7220.1,-2292.14 7221.31,-2285.25"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge535" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7638.73,-2322.68C7647.99,-2313.93 7658.37,-2304.13 7668.94,-2294.15"/>
<polygon fill="black" stroke="black" points="7671.41,-2296.63 7676.28,-2287.22 7666.61,-2291.54 7671.41,-2296.63"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge536" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7820.58,-2324.04C7823.57,-2323.67 7826.55,-2323.31 7829.5,-2322.95 7996.61,-2302.79 8039.39,-2307.12 8206.5,-2286.95 8256.16,-2280.96 8308.74,-2273.93 8359.9,-2266.73"/>
<polygon fill="black" stroke="black" points="8360.7,-2270.15 8370.11,-2265.28 8359.72,-2263.22 8360.7,-2270.15"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge537" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7820.55,-2323.76C7823.55,-2323.48 7826.54,-2323.21 7829.5,-2322.95 8403.13,-2273.27 8550.87,-2336.62 9124.5,-2286.95 9175.38,-2282.55 9229.21,-2276.21 9281.42,-2269.18"/>
<polygon fill="black" stroke="black" points="9282.05,-2272.62 9291.49,-2267.81 9281.11,-2265.69 9282.05,-2272.62"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge538" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7820.55,-2323.71C7823.55,-2323.45 7826.54,-2323.19 7829.5,-2322.95 8809.99,-2243.73 9062.01,-2366.16 10042.5,-2286.95 10093.59,-2282.83 10147.65,-2276.61 10200.04,-2269.6"/>
<polygon fill="black" stroke="black" points="10200.71,-2273.04 10210.15,-2268.23 10199.77,-2266.1 10200.71,-2273.04"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge539" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7820.55,-2323.69C7823.55,-2323.43 7826.54,-2323.19 7829.5,-2322.95 8523.19,-2268.56 10266.8,-2341.33 10960.5,-2286.95 11011.69,-2282.94 11065.86,-2276.77 11118.35,-2269.77"/>
<polygon fill="black" stroke="black" points="11119.03,-2273.21 11128.47,-2268.4 11118.1,-2266.27 11119.03,-2273.21"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge540" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7820.55,-2323.68C7823.55,-2323.43 7826.53,-2323.18 7829.5,-2322.95 8726.65,-2253.79 10981.35,-2356.1 11878.5,-2286.95 11929.7,-2283.01 11983.87,-2276.87 12036.36,-2269.88"/>
<polygon fill="black" stroke="black" points="12037.04,-2273.32 12046.48,-2268.52 12036.11,-2266.38 12037.04,-2273.32"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge541" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7820.55,-2323.68C7823.55,-2323.42 7826.53,-2323.18 7829.5,-2322.95 8930.11,-2239.01 11695.89,-2370.87 12796.5,-2286.95 12847.7,-2283.05 12901.88,-2276.93 12954.36,-2269.95"/>
<polygon fill="black" stroke="black" points="12955.04,-2273.39 12964.49,-2268.59 12954.11,-2266.45 12955.04,-2273.39"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge542" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7820.55,-2323.67C7823.55,-2323.42 7826.53,-2323.18 7829.5,-2322.95 9133.57,-2224.24 12410.43,-2385.64 13714.5,-2286.95 13765.8,-2283.07 13820.08,-2276.95 13872.66,-2269.96"/>
<polygon fill="black" stroke="black" points="13873.35,-2273.4 13882.8,-2268.6 13872.42,-2266.46 13873.35,-2273.4"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge543" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7820.55,-2323.67C7823.55,-2323.42 7826.53,-2323.18 7829.5,-2322.95 8583.27,-2266.21 13878.73,-2343.68 14632.5,-2286.95 14683.8,-2283.09 14738.08,-2276.99 14790.66,-2270"/>
<polygon fill="black" stroke="black" points="14791.36,-2273.43 14800.8,-2268.63 14790.43,-2266.5 14791.36,-2273.43"/>
</g>
<!-- l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge544" class="edge">
<title>l1_expert_4_gpu4&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7820.55,-2323.67C7823.55,-2323.41 7826.53,-2323.18 7829.5,-2322.95 8685,-2258.82 14695,-2351.07 15550.5,-2286.95 15601.8,-2283.11 15656.08,-2277.01 15708.66,-2270.02"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.46 15718.8,-2268.66 15708.43,-2266.52 15709.36,-2273.46"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_4_gpu4 -->
<g id="edge527" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6219.38,-2446.85C6279.04,-2439.13 6341.12,-2432.01 6399.5,-2426.95 6829.56,-2389.73 6942.63,-2429.82 7376.46,-2391.01"/>
<polygon fill="black" stroke="black" points="7376.8,-2394.49 7386.44,-2390.11 7376.17,-2387.52 7376.8,-2394.49"/>
</g>
<!-- l1_expert_agg_gpu4&#45;&gt;l1_res2_gpu4 -->
<g id="edge545" class="edge">
<title>l1_expert_agg_gpu4&#45;&gt;l1_res2_gpu4</title>
<path fill="none" stroke="black" d="M5670.58,-2150.95C5629.31,-2139.47 5587.9,-2127.95 5551.06,-2117.71"/>
<polygon fill="black" stroke="black" points="5551.87,-2114.3 5541.3,-2114.99 5549.99,-2121.04 5551.87,-2114.3"/>
</g>
<!-- l2_mha_qkv_gpu4 -->
<g id="node290" class="node">
<title>l2_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5529,-2010.95 5048,-2010.95 5048,-1942.95 5529,-1942.95 5529,-2010.95"/>
<text text-anchor="middle" x="5288.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5288.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5288.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5288.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu4&#45;&gt;l2_mha_qkv_gpu4 -->
<g id="edge937" class="edge">
<title>l1_res2_gpu4&#45;&gt;l2_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M5378.99,-2046.84C5366.71,-2037.48 5353.21,-2027.21 5340.48,-2017.52"/>
<polygon fill="black" stroke="black" points="5342.32,-2014.52 5332.25,-2011.25 5338.08,-2020.09 5342.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu4 -->
<g id="node293" class="node">
<title>l2_mha_res_add_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5641.5,-1698.95 5207.5,-1698.95 5207.5,-1630.95 5641.5,-1630.95 5641.5,-1698.95"/>
<text text-anchor="middle" x="5424.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5424.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5424.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5424.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu4&#45;&gt;l2_mha_res_add_gpu4 -->
<g id="edge941" class="edge">
<title>l1_res2_gpu4&#45;&gt;l2_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M5503.5,-2046.79C5517.51,-2037.33 5530.22,-2025.52 5538.5,-2010.95 5599.14,-1904.32 5596.64,-1841.31 5535.5,-1734.95 5528.88,-1723.43 5519.47,-1713.57 5508.91,-1705.21"/>
<polygon fill="black" stroke="black" points="5510.76,-1702.23 5500.63,-1699.11 5506.61,-1707.86 5510.76,-1702.23"/>
</g>
<!-- l1_mha_attn_gpu5 -->
<g id="node171" class="node">
<title>l1_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6518,-2874.95 6037,-2874.95 6037,-2806.95 6518,-2806.95 6518,-2874.95"/>
<text text-anchor="middle" x="6277.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6277.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6277.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6277.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu5&#45;&gt;l1_mha_attn_gpu5 -->
<g id="edge548" class="edge">
<title>l1_mha_qkv_gpu5&#45;&gt;l1_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M6277.5,-2910.84C6277.5,-2902.73 6277.5,-2893.94 6277.5,-2885.43"/>
<polygon fill="black" stroke="black" points="6281,-2885.25 6277.5,-2875.25 6274,-2885.25 6281,-2885.25"/>
</g>
<!-- l1_mha_out_gpu5 -->
<g id="node172" class="node">
<title>l1_mha_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6515,-2770.95 6046,-2770.95 6046,-2702.95 6515,-2702.95 6515,-2770.95"/>
<text text-anchor="middle" x="6280.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6280.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6280.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6280.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu5&#45;&gt;l1_mha_out_gpu5 -->
<g id="edge549" class="edge">
<title>l1_mha_attn_gpu5&#45;&gt;l1_mha_out_gpu5</title>
<path fill="none" stroke="black" d="M6278.47,-2806.84C6278.71,-2798.73 6278.97,-2789.94 6279.22,-2781.43"/>
<polygon fill="black" stroke="black" points="6282.73,-2781.35 6279.52,-2771.25 6275.73,-2781.15 6282.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu5&#45;&gt;l1_mha_res_add_gpu5 -->
<g id="edge550" class="edge">
<title>l1_mha_out_gpu5&#45;&gt;l1_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6323.68,-2702.84C6335.88,-2693.48 6349.27,-2683.21 6361.91,-2673.52"/>
<polygon fill="black" stroke="black" points="6364.28,-2676.12 6370.08,-2667.25 6360.02,-2670.56 6364.28,-2676.12"/>
</g>
<!-- l1_expert_5_gpu5 -->
<g id="node174" class="node">
<title>l1_expert_5_gpu5</title>
<polygon fill="lightpink" stroke="black" points="8272.5,-2390.95 7838.5,-2390.95 7838.5,-2322.95 8272.5,-2322.95 8272.5,-2390.95"/>
<text text-anchor="middle" x="8055.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8055.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8055.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8055.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu5&#45;&gt;l1_expert_5_gpu5 -->
<g id="edge554" class="edge">
<title>l1_mha_res_add_gpu5&#45;&gt;l1_expert_5_gpu5</title>
<path fill="none" stroke="black" d="M6404.86,-2598.95C6395.05,-2553.01 6385.91,-2470.54 6432.5,-2426.95 6487.59,-2375.42 7681.58,-2396.3 7828.34,-2390.71"/>
<polygon fill="black" stroke="black" points="7828.65,-2394.2 7838.45,-2390.15 7828.27,-2387.21 7828.65,-2394.2"/>
</g>
<!-- l1_gate_gpu5 -->
<g id="node175" class="node">
<title>l1_gate_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="7393.24,-2562.95 6636.44,-2562.95 6441.76,-2426.95 7198.56,-2426.95 7393.24,-2562.95"/>
<text text-anchor="middle" x="6917.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6917.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6917.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6917.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu5&#45;&gt;l1_gate_gpu5 -->
<g id="edge552" class="edge">
<title>l1_mha_res_add_gpu5&#45;&gt;l1_gate_gpu5</title>
<path fill="none" stroke="black" d="M6535.83,-2598.94C6573.41,-2588.8 6616.28,-2577.23 6659.39,-2565.6"/>
<polygon fill="black" stroke="black" points="6660.43,-2568.95 6669.17,-2562.96 6658.61,-2562.19 6660.43,-2568.95"/>
</g>
<!-- l1_res2_gpu5 -->
<g id="node177" class="node">
<title>l1_res2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6648.5,-2114.95 6214.5,-2114.95 6214.5,-2046.95 6648.5,-2046.95 6648.5,-2114.95"/>
<text text-anchor="middle" x="6431.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6431.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6431.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6431.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu5&#45;&gt;l1_res2_gpu5 -->
<g id="edge572" class="edge">
<title>l1_mha_res_add_gpu5&#45;&gt;l1_res2_gpu5</title>
<path fill="none" stroke="black" d="M6196.14,-2621.05C6039.26,-2613.6 5822.35,-2604.17 5631.5,-2598.95 5551.11,-2596.76 2806.17,-2603.13 2736.5,-2562.95 2675.55,-2527.81 2713.95,-2466.11 2655.5,-2426.95 2567.22,-2367.81 1778.92,-2367.4 1709.5,-2286.95 1670.01,-2241.19 1666.96,-2193.89 1709.5,-2150.95 1748.01,-2112.09 5593.81,-2116.36 5648.5,-2114.95 5835.66,-2110.16 6047.84,-2100.98 6204.07,-2093.52"/>
<polygon fill="black" stroke="black" points="6204.46,-2097.01 6214.28,-2093.03 6204.13,-2090.01 6204.46,-2097.01"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge555" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7838.45,-2323.67C7835.45,-2323.42 7832.47,-2323.18 7829.5,-2322.95 6692.54,-2236.37 3835.46,-2373.51 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.17 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge556" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7838.45,-2323.68C7835.45,-2323.42 7832.47,-2323.18 7829.5,-2322.95 6896,-2251.15 4550,-2358.74 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.16 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge557" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7838.45,-2323.69C7835.45,-2323.43 7832.46,-2323.18 7829.5,-2322.95 7099.46,-2265.92 5264.54,-2343.97 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.78,-2283.47 4524.53,-2286.15 4534.21,-2290.44 4534.78,-2283.47"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge558" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7838.45,-2323.71C7835.45,-2323.44 7832.46,-2323.19 7829.5,-2322.95 6776.32,-2238.45 6505.68,-2371.44 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.78,-2283.47 5442.53,-2286.13 5452.21,-2290.44 5452.78,-2283.47"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge559" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7838.45,-2323.75C7835.45,-2323.47 7832.46,-2323.21 7829.5,-2322.95 7183.19,-2267.99 7016.81,-2341.9 6370.5,-2286.95 6370.39,-2286.94 6370.29,-2286.94 6370.18,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.5,-2283.44 6360.23,-2286.06 6369.89,-2290.41 6370.5,-2283.44"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge560" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7838.43,-2323.92C7835.44,-2323.59 7832.46,-2323.27 7829.5,-2322.95 7589.87,-2297.52 7528.13,-2312.38 7288.5,-2286.95 7288.39,-2286.94 7288.28,-2286.93 7288.17,-2286.92"/>
<polygon fill="black" stroke="black" points="7288.26,-2283.41 7277.95,-2285.82 7287.52,-2290.37 7288.26,-2283.41"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge561" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7980.55,-2322.86C7958.58,-2313.16 7933.68,-2302.16 7908.52,-2291.05"/>
<polygon fill="black" stroke="black" points="7909.8,-2287.79 7899.24,-2286.96 7906.98,-2294.2 7909.8,-2287.79"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge562" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8203.55,-2322.94C8257.36,-2310.95 8320.12,-2296.96 8381.73,-2283.22"/>
<polygon fill="black" stroke="black" points="8382.6,-2286.61 8391.6,-2281.02 8381.08,-2279.78 8382.6,-2286.61"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge563" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8272.56,-2323.82C8275.56,-2323.52 8278.54,-2323.23 8281.5,-2322.95 8654.86,-2287.82 8751.14,-2322.08 9124.5,-2286.95 9175.15,-2282.19 9228.76,-2275.69 9280.78,-2268.61"/>
<polygon fill="black" stroke="black" points="9281.39,-2272.06 9290.82,-2267.24 9280.44,-2265.13 9281.39,-2272.06"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge564" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8272.55,-2323.73C8275.55,-2323.46 8278.54,-2323.2 8281.5,-2322.95 9061.65,-2258.27 9262.34,-2351.61 10042.5,-2286.95 10093.49,-2282.73 10147.44,-2276.47 10199.74,-2269.46"/>
<polygon fill="black" stroke="black" points="10200.39,-2272.9 10209.83,-2268.09 10199.45,-2265.96 10200.39,-2272.9"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge565" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8272.55,-2323.7C8275.55,-2323.44 8278.54,-2323.19 8281.5,-2322.95 9468.54,-2228.72 9773.46,-2381.15 10960.5,-2286.95 11011.69,-2282.89 11065.86,-2276.7 11118.34,-2269.68"/>
<polygon fill="black" stroke="black" points="11119.02,-2273.12 11128.47,-2268.32 11118.09,-2266.18 11119.02,-2273.12"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge566" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8272.55,-2323.69C8275.55,-2323.43 8278.54,-2323.18 8281.5,-2322.95 9078.47,-2261.06 11081.52,-2348.82 11878.5,-2286.95 11929.7,-2282.98 11983.87,-2276.83 12036.35,-2269.83"/>
<polygon fill="black" stroke="black" points="12037.04,-2273.27 12046.48,-2268.47 12036.1,-2266.33 12037.04,-2273.27"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge567" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8272.55,-2323.68C8275.55,-2323.42 8278.53,-2323.18 8281.5,-2322.95 9281.93,-2246.29 11796.07,-2363.6 12796.5,-2286.95 12847.7,-2283.03 12901.87,-2276.91 12954.36,-2269.92"/>
<polygon fill="black" stroke="black" points="12955.04,-2273.36 12964.49,-2268.56 12954.11,-2266.42 12955.04,-2273.36"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge568" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8272.55,-2323.67C8275.55,-2323.42 8278.53,-2323.18 8281.5,-2322.95 9485.39,-2231.51 12510.61,-2378.37 13714.5,-2286.95 13765.8,-2283.06 13820.08,-2276.93 13872.65,-2269.94"/>
<polygon fill="black" stroke="black" points="13873.35,-2273.38 13882.8,-2268.57 13872.42,-2266.44 13873.35,-2273.38"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge569" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8272.55,-2323.67C8275.55,-2323.42 8278.53,-2323.18 8281.5,-2322.95 9688.85,-2216.74 13225.14,-2393.14 14632.5,-2286.95 14683.8,-2283.08 14738.08,-2276.97 14790.66,-2269.98"/>
<polygon fill="black" stroke="black" points="14791.36,-2273.42 14800.8,-2268.62 14790.42,-2266.48 14791.36,-2273.42"/>
</g>
<!-- l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge570" class="edge">
<title>l1_expert_5_gpu5&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8272.55,-2323.67C8275.55,-2323.41 8278.53,-2323.18 8281.5,-2322.95 9086.91,-2262.46 14745.09,-2347.43 15550.5,-2286.95 15601.8,-2283.1 15656.08,-2277 15708.66,-2270.01"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.45 15718.8,-2268.65 15708.43,-2266.51 15709.36,-2273.45"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_5_gpu5 -->
<g id="edge553" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7229.9,-2448.82C7288.83,-2440.99 7350,-2433.33 7407.5,-2426.95 7591.3,-2406.56 7640.78,-2412.35 7828.23,-2391.07"/>
<polygon fill="black" stroke="black" points="7828.89,-2394.52 7838.42,-2389.9 7828.09,-2387.57 7828.89,-2394.52"/>
</g>
<!-- l1_expert_agg_gpu5&#45;&gt;l1_res2_gpu5 -->
<g id="edge571" class="edge">
<title>l1_expert_agg_gpu5&#45;&gt;l1_res2_gpu5</title>
<path fill="none" stroke="black" d="M6633.41,-2150.95C6600.39,-2139.67 6567.27,-2128.35 6537.67,-2118.23"/>
<polygon fill="black" stroke="black" points="6538.78,-2114.91 6528.19,-2114.99 6536.52,-2121.54 6538.78,-2114.91"/>
</g>
<!-- l2_mha_qkv_gpu5 -->
<g id="node298" class="node">
<title>l2_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6537,-2010.95 6056,-2010.95 6056,-1942.95 6537,-1942.95 6537,-2010.95"/>
<text text-anchor="middle" x="6296.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6296.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6296.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6296.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu5&#45;&gt;l2_mha_qkv_gpu5 -->
<g id="edge963" class="edge">
<title>l1_res2_gpu5&#45;&gt;l2_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M6387.67,-2046.84C6375.29,-2037.48 6361.7,-2027.21 6348.87,-2017.52"/>
<polygon fill="black" stroke="black" points="6350.66,-2014.49 6340.57,-2011.25 6346.44,-2020.07 6350.66,-2014.49"/>
</g>
<!-- l2_mha_res_add_gpu5 -->
<g id="node301" class="node">
<title>l2_mha_res_add_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6649.5,-1698.95 6215.5,-1698.95 6215.5,-1630.95 6649.5,-1630.95 6649.5,-1698.95"/>
<text text-anchor="middle" x="6432.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6432.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6432.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6432.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu5&#45;&gt;l2_mha_res_add_gpu5 -->
<g id="edge967" class="edge">
<title>l1_res2_gpu5&#45;&gt;l2_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6511.53,-2046.87C6525.53,-2037.38 6538.24,-2025.54 6546.5,-2010.95 6606.94,-1904.2 6604.64,-1841.31 6543.5,-1734.95 6536.88,-1723.43 6527.47,-1713.57 6516.91,-1705.21"/>
<polygon fill="black" stroke="black" points="6518.76,-1702.23 6508.63,-1699.11 6514.61,-1707.86 6518.76,-1702.23"/>
</g>
<!-- l1_mha_attn_gpu6 -->
<g id="node179" class="node">
<title>l1_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7526,-2874.95 7045,-2874.95 7045,-2806.95 7526,-2806.95 7526,-2874.95"/>
<text text-anchor="middle" x="7285.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7285.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7285.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7285.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu6&#45;&gt;l1_mha_attn_gpu6 -->
<g id="edge574" class="edge">
<title>l1_mha_qkv_gpu6&#45;&gt;l1_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M7285.5,-2910.84C7285.5,-2902.73 7285.5,-2893.94 7285.5,-2885.43"/>
<polygon fill="black" stroke="black" points="7289,-2885.25 7285.5,-2875.25 7282,-2885.25 7289,-2885.25"/>
</g>
<!-- l1_mha_out_gpu6 -->
<g id="node180" class="node">
<title>l1_mha_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7523,-2770.95 7054,-2770.95 7054,-2702.95 7523,-2702.95 7523,-2770.95"/>
<text text-anchor="middle" x="7288.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7288.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7288.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7288.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu6&#45;&gt;l1_mha_out_gpu6 -->
<g id="edge575" class="edge">
<title>l1_mha_attn_gpu6&#45;&gt;l1_mha_out_gpu6</title>
<path fill="none" stroke="black" d="M7286.47,-2806.84C7286.71,-2798.73 7286.97,-2789.94 7287.22,-2781.43"/>
<polygon fill="black" stroke="black" points="7290.73,-2781.35 7287.52,-2771.25 7283.73,-2781.15 7290.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu6&#45;&gt;l1_mha_res_add_gpu6 -->
<g id="edge576" class="edge">
<title>l1_mha_out_gpu6&#45;&gt;l1_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7331.68,-2702.84C7343.88,-2693.48 7357.27,-2683.21 7369.91,-2673.52"/>
<polygon fill="black" stroke="black" points="7372.28,-2676.12 7378.08,-2667.25 7368.02,-2670.56 7372.28,-2676.12"/>
</g>
<!-- l1_expert_6_gpu6 -->
<g id="node182" class="node">
<title>l1_expert_6_gpu6</title>
<polygon fill="lightpink" stroke="black" points="8724.5,-2390.95 8290.5,-2390.95 8290.5,-2322.95 8724.5,-2322.95 8724.5,-2390.95"/>
<text text-anchor="middle" x="8507.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8507.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="8507.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8507.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu6&#45;&gt;l1_expert_6_gpu6 -->
<g id="edge580" class="edge">
<title>l1_mha_res_add_gpu6&#45;&gt;l1_expert_6_gpu6</title>
<path fill="none" stroke="black" d="M7412.88,-2598.67C7403.23,-2552.79 7394.41,-2470.81 7440.5,-2426.95 7472.99,-2396.04 8173.77,-2395.34 8280.15,-2390.7"/>
<polygon fill="black" stroke="black" points="8280.67,-2394.18 8290.44,-2390.08 8280.25,-2387.19 8280.67,-2394.18"/>
</g>
<!-- l1_gate_gpu6 -->
<g id="node183" class="node">
<title>l1_gate_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="8401.24,-2562.95 7644.44,-2562.95 7449.76,-2426.95 8206.56,-2426.95 8401.24,-2562.95"/>
<text text-anchor="middle" x="7925.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7925.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7925.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7925.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu6&#45;&gt;l1_gate_gpu6 -->
<g id="edge578" class="edge">
<title>l1_mha_res_add_gpu6&#45;&gt;l1_gate_gpu6</title>
<path fill="none" stroke="black" d="M7543.83,-2598.94C7581.41,-2588.8 7624.28,-2577.23 7667.39,-2565.6"/>
<polygon fill="black" stroke="black" points="7668.43,-2568.95 7677.17,-2562.96 7666.61,-2562.19 7668.43,-2568.95"/>
</g>
<!-- l1_res2_gpu6 -->
<g id="node185" class="node">
<title>l1_res2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7656.5,-2114.95 7222.5,-2114.95 7222.5,-2046.95 7656.5,-2046.95 7656.5,-2114.95"/>
<text text-anchor="middle" x="7439.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7439.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7439.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7439.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu6&#45;&gt;l1_res2_gpu6 -->
<g id="edge598" class="edge">
<title>l1_mha_res_add_gpu6&#45;&gt;l1_res2_gpu6</title>
<path fill="none" stroke="black" d="M7204.14,-2620.86C7047.26,-2613.33 6830.35,-2603.87 6639.5,-2598.95 6585.77,-2597.57 2814.3,-2592.65 2769.5,-2562.95 2714.58,-2526.55 2762.01,-2468.04 2710.5,-2426.95 2514.32,-2270.45 2404.12,-2357.13 2155.5,-2322.95 2110.41,-2316.75 1778.23,-2320.52 1747.5,-2286.95 1706.68,-2242.37 1704.92,-2193.85 1747.5,-2150.95 1771.52,-2126.75 6623.41,-2115.8 6657.5,-2114.95 6844.26,-2110.33 7055.96,-2101.15 7211.95,-2093.65"/>
<polygon fill="black" stroke="black" points="7212.33,-2097.14 7222.15,-2093.16 7211.99,-2090.14 7212.33,-2097.14"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge581" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8290.45,-2323.67C8287.45,-2323.42 8284.47,-2323.18 8281.5,-2322.95 7044.36,-2229.1 3935.64,-2380.78 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.17 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge582" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8290.45,-2323.68C8287.45,-2323.42 8284.47,-2323.18 8281.5,-2322.95 7247.82,-2243.87 4650.18,-2366.01 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.17 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge583" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8290.45,-2323.69C8287.45,-2323.43 8284.47,-2323.18 8281.5,-2322.95 7451.28,-2258.65 5364.72,-2351.24 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.16 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge584" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8290.45,-2323.7C8287.45,-2323.44 8284.46,-2323.19 8281.5,-2322.95 7027.97,-2223.9 6706.03,-2385.98 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.78,-2283.47 5442.53,-2286.14 5452.21,-2290.44 5452.78,-2283.47"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge585" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8290.45,-2323.72C8287.45,-2323.45 8284.46,-2323.2 8281.5,-2322.95 7434.86,-2253.45 7217.14,-2356.44 6370.5,-2286.95 6370.39,-2286.94 6370.29,-2286.94 6370.18,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.49,-2283.44 6360.23,-2286.09 6369.9,-2290.42 6370.49,-2283.44"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge586" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8290.44,-2323.8C8287.44,-2323.5 8284.46,-2323.22 8281.5,-2322.95 7841.69,-2282.99 7728.31,-2326.91 7288.5,-2286.95 7288.39,-2286.94 7288.29,-2286.93 7288.18,-2286.92"/>
<polygon fill="black" stroke="black" points="7288.52,-2283.44 7278.24,-2286 7287.87,-2290.41 7288.52,-2283.44"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge587" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8323.04,-2322.94C8265.06,-2312.57 8198.73,-2300.7 8132.2,-2288.8"/>
<polygon fill="black" stroke="black" points="8132.42,-2285.28 8121.96,-2286.96 8131.19,-2292.17 8132.42,-2285.28"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge588" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8546.15,-2322.68C8556.42,-2313.85 8567.93,-2303.94 8579.64,-2293.86"/>
<polygon fill="black" stroke="black" points="8582.06,-2296.39 8587.36,-2287.22 8577.49,-2291.09 8582.06,-2296.39"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge589" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8724.58,-2324.03C8727.57,-2323.66 8730.55,-2323.3 8733.5,-2322.95 8906.79,-2302.34 8951.21,-2307.56 9124.5,-2286.95 9174.37,-2281.02 9227.17,-2274.01 9278.53,-2266.78"/>
<polygon fill="black" stroke="black" points="9279.02,-2270.25 9288.44,-2265.39 9278.05,-2263.32 9279.02,-2270.25"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge590" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8724.55,-2323.76C8727.55,-2323.48 8730.54,-2323.21 8733.5,-2322.95 9313.33,-2272.82 9462.66,-2337.07 10042.5,-2286.95 10093.38,-2282.56 10147.21,-2276.23 10199.42,-2269.19"/>
<polygon fill="black" stroke="black" points="10200.06,-2272.64 10209.49,-2267.82 10199.11,-2265.7 10200.06,-2272.64"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge591" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8724.55,-2323.71C8727.55,-2323.45 8730.54,-2323.19 8733.5,-2322.95 9720.2,-2243.27 9973.8,-2366.61 10960.5,-2286.95 11011.59,-2282.83 11065.65,-2276.61 11118.04,-2269.6"/>
<polygon fill="black" stroke="black" points="11118.71,-2273.04 11128.15,-2268.24 11117.77,-2266.11 11118.71,-2273.04"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge592" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8724.55,-2323.69C8727.55,-2323.43 8730.54,-2323.19 8733.5,-2322.95 9430.3,-2268.34 11181.7,-2341.55 11878.5,-2286.95 11929.69,-2282.94 11983.86,-2276.77 12036.35,-2269.77"/>
<polygon fill="black" stroke="black" points="12037.03,-2273.21 12046.47,-2268.4 12036.1,-2266.27 12037.03,-2273.21"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge593" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8724.55,-2323.68C8727.55,-2323.43 8730.53,-2323.18 8733.5,-2322.95 9633.75,-2253.56 11896.24,-2356.32 12796.5,-2286.95 12847.7,-2283.01 12901.87,-2276.87 12954.36,-2269.88"/>
<polygon fill="black" stroke="black" points="12955.04,-2273.32 12964.48,-2268.52 12954.11,-2266.38 12955.04,-2273.32"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge594" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8724.55,-2323.68C8727.55,-2323.42 8730.53,-2323.18 8733.5,-2322.95 9837.21,-2238.79 12610.78,-2371.09 13714.5,-2286.95 13765.7,-2283.05 13819.88,-2276.93 13872.36,-2269.95"/>
<polygon fill="black" stroke="black" points="13873.04,-2273.39 13882.49,-2268.59 13872.11,-2266.45 13873.04,-2273.39"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge595" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8724.55,-2323.67C8727.55,-2323.42 8730.53,-2323.18 8733.5,-2322.95 10040.67,-2224.01 13325.32,-2385.86 14632.5,-2286.95 14683.8,-2283.07 14738.08,-2276.95 14790.66,-2269.96"/>
<polygon fill="black" stroke="black" points="14791.35,-2273.4 14800.8,-2268.6 14790.42,-2266.46 14791.35,-2273.4"/>
</g>
<!-- l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge596" class="edge">
<title>l1_expert_6_gpu6&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8724.55,-2323.67C8727.55,-2323.42 8730.53,-2323.18 8733.5,-2322.95 9488.82,-2266.09 14795.18,-2343.79 15550.5,-2286.95 15601.8,-2283.09 15656.08,-2276.99 15708.66,-2270"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.43 15718.8,-2268.63 15708.43,-2266.5 15709.36,-2273.43"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_6_gpu6 -->
<g id="edge579" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8207.98,-2427.95C8259.11,-2416 8310.59,-2403.97 8356.1,-2393.33"/>
<polygon fill="black" stroke="black" points="8357.08,-2396.7 8366.02,-2391.01 8355.49,-2389.88 8357.08,-2396.7"/>
</g>
<!-- l1_expert_agg_gpu6&#45;&gt;l1_res2_gpu6 -->
<g id="edge597" class="edge">
<title>l1_expert_agg_gpu6&#45;&gt;l1_res2_gpu6</title>
<path fill="none" stroke="black" d="M7595.76,-2150.95C7571.04,-2140.04 7546.25,-2129.09 7523.93,-2119.23"/>
<polygon fill="black" stroke="black" points="7525.09,-2115.92 7514.52,-2115.08 7522.26,-2122.32 7525.09,-2115.92"/>
</g>
<!-- l2_mha_qkv_gpu6 -->
<g id="node306" class="node">
<title>l2_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7545,-2010.95 7064,-2010.95 7064,-1942.95 7545,-1942.95 7545,-2010.95"/>
<text text-anchor="middle" x="7304.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7304.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7304.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7304.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu6&#45;&gt;l2_mha_qkv_gpu6 -->
<g id="edge989" class="edge">
<title>l1_res2_gpu6&#45;&gt;l2_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M7395.67,-2046.84C7383.29,-2037.48 7369.7,-2027.21 7356.87,-2017.52"/>
<polygon fill="black" stroke="black" points="7358.66,-2014.49 7348.57,-2011.25 7354.44,-2020.07 7358.66,-2014.49"/>
</g>
<!-- l2_mha_res_add_gpu6 -->
<g id="node309" class="node">
<title>l2_mha_res_add_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7657.5,-1698.95 7223.5,-1698.95 7223.5,-1630.95 7657.5,-1630.95 7657.5,-1698.95"/>
<text text-anchor="middle" x="7440.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7440.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7440.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7440.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu6&#45;&gt;l2_mha_res_add_gpu6 -->
<g id="edge993" class="edge">
<title>l1_res2_gpu6&#45;&gt;l2_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7519.53,-2046.87C7533.53,-2037.38 7546.24,-2025.54 7554.5,-2010.95 7614.94,-1904.2 7612.64,-1841.31 7551.5,-1734.95 7544.88,-1723.43 7535.47,-1713.57 7524.91,-1705.21"/>
<polygon fill="black" stroke="black" points="7526.76,-1702.23 7516.63,-1699.11 7522.61,-1707.86 7526.76,-1702.23"/>
</g>
<!-- l1_mha_attn_gpu7 -->
<g id="node187" class="node">
<title>l1_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8534,-2874.95 8053,-2874.95 8053,-2806.95 8534,-2806.95 8534,-2874.95"/>
<text text-anchor="middle" x="8293.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8293.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8293.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8293.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu7&#45;&gt;l1_mha_attn_gpu7 -->
<g id="edge600" class="edge">
<title>l1_mha_qkv_gpu7&#45;&gt;l1_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M8293.5,-2910.84C8293.5,-2902.73 8293.5,-2893.94 8293.5,-2885.43"/>
<polygon fill="black" stroke="black" points="8297,-2885.25 8293.5,-2875.25 8290,-2885.25 8297,-2885.25"/>
</g>
<!-- l1_mha_out_gpu7 -->
<g id="node188" class="node">
<title>l1_mha_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8531,-2770.95 8062,-2770.95 8062,-2702.95 8531,-2702.95 8531,-2770.95"/>
<text text-anchor="middle" x="8296.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8296.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8296.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8296.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu7&#45;&gt;l1_mha_out_gpu7 -->
<g id="edge601" class="edge">
<title>l1_mha_attn_gpu7&#45;&gt;l1_mha_out_gpu7</title>
<path fill="none" stroke="black" d="M8294.47,-2806.84C8294.71,-2798.73 8294.97,-2789.94 8295.22,-2781.43"/>
<polygon fill="black" stroke="black" points="8298.73,-2781.35 8295.52,-2771.25 8291.73,-2781.15 8298.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu7&#45;&gt;l1_mha_res_add_gpu7 -->
<g id="edge602" class="edge">
<title>l1_mha_out_gpu7&#45;&gt;l1_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8339.68,-2702.84C8351.88,-2693.48 8365.27,-2683.21 8377.91,-2673.52"/>
<polygon fill="black" stroke="black" points="8380.28,-2676.12 8386.08,-2667.25 8376.02,-2670.56 8380.28,-2676.12"/>
</g>
<!-- l1_expert_7_gpu7 -->
<g id="node190" class="node">
<title>l1_expert_7_gpu7</title>
<polygon fill="lightpink" stroke="black" points="9176.5,-2390.95 8742.5,-2390.95 8742.5,-2322.95 9176.5,-2322.95 9176.5,-2390.95"/>
<text text-anchor="middle" x="8959.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8959.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8959.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8959.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu7&#45;&gt;l1_expert_7_gpu7 -->
<g id="edge606" class="edge">
<title>l1_mha_res_add_gpu7&#45;&gt;l1_expert_7_gpu7</title>
<path fill="none" stroke="black" d="M8421.32,-2598.81C8412.31,-2553.47 8404.39,-2472.55 8448.5,-2426.95 8490.89,-2383.13 8654.58,-2398.03 8732.06,-2390.9"/>
<polygon fill="black" stroke="black" points="8732.85,-2394.33 8742.4,-2389.74 8732.07,-2387.37 8732.85,-2394.33"/>
</g>
<!-- l1_gate_gpu7 -->
<g id="node191" class="node">
<title>l1_gate_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="9409.24,-2562.95 8652.44,-2562.95 8457.76,-2426.95 9214.56,-2426.95 9409.24,-2562.95"/>
<text text-anchor="middle" x="8933.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8933.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8933.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8933.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu7&#45;&gt;l1_gate_gpu7 -->
<g id="edge604" class="edge">
<title>l1_mha_res_add_gpu7&#45;&gt;l1_gate_gpu7</title>
<path fill="none" stroke="black" d="M8551.83,-2598.94C8589.41,-2588.8 8632.28,-2577.23 8675.39,-2565.6"/>
<polygon fill="black" stroke="black" points="8676.43,-2568.95 8685.17,-2562.96 8674.61,-2562.19 8676.43,-2568.95"/>
</g>
<!-- l1_res2_gpu7 -->
<g id="node193" class="node">
<title>l1_res2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8664.5,-2114.95 8230.5,-2114.95 8230.5,-2046.95 8664.5,-2046.95 8664.5,-2114.95"/>
<text text-anchor="middle" x="8447.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8447.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8447.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8447.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu7&#45;&gt;l1_res2_gpu7 -->
<g id="edge624" class="edge">
<title>l1_mha_res_add_gpu7&#45;&gt;l1_res2_gpu7</title>
<path fill="none" stroke="black" d="M8212.14,-2620.92C8055.26,-2613.4 7838.35,-2603.95 7647.5,-2598.95 7451.56,-2593.82 4312.45,-2597.46 4119.5,-2562.95 3942.92,-2531.38 3914.89,-2464.57 3739.5,-2426.95 3165.4,-2303.84 3008.32,-2362.5 2422.5,-2322.95 2386.86,-2320.55 1805.04,-2312.91 1780.5,-2286.95 1738.97,-2243.03 1737.89,-2193.82 1780.5,-2150.95 1809.31,-2121.97 7624.64,-2115.94 7665.5,-2114.95 7852.26,-2110.44 8063.96,-2101.26 8219.95,-2093.72"/>
<polygon fill="black" stroke="black" points="8220.33,-2097.21 8230.15,-2093.23 8219.99,-2090.22 8220.33,-2097.21"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge607" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8742.45,-2323.67C8739.45,-2323.42 8736.47,-2323.18 8733.5,-2322.95 7396.18,-2221.82 4035.82,-2388.05 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.17 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge608" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8742.45,-2323.68C8739.45,-2323.42 8736.47,-2323.18 8733.5,-2322.95 7599.64,-2236.6 4750.36,-2373.28 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.17 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge609" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8742.45,-2323.68C8739.45,-2323.42 8736.47,-2323.18 8733.5,-2322.95 7803.1,-2251.37 5464.9,-2358.51 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.16 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge610" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8742.45,-2323.69C8739.45,-2323.43 8736.46,-2323.18 8733.5,-2322.95 8006.56,-2266.15 6179.44,-2343.74 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.78,-2283.47 5442.53,-2286.15 5452.21,-2290.44 5452.78,-2283.47"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge611" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8742.45,-2323.71C8739.45,-2323.44 8736.46,-2323.19 8733.5,-2322.95 7686.52,-2238.9 7417.48,-2370.99 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.78,-2283.47 6360.53,-2286.13 6370.21,-2290.44 6370.78,-2283.47"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge612" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8742.45,-2323.75C8739.45,-2323.47 8736.46,-2323.21 8733.5,-2322.95 8093.4,-2268.44 7928.61,-2341.45 7288.5,-2286.95 7288.39,-2286.94 7288.29,-2286.94 7288.18,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.5,-2283.44 7278.23,-2286.06 7287.89,-2290.41 7288.5,-2283.44"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge613" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8742.43,-2323.93C8739.43,-2323.6 8736.46,-2323.27 8733.5,-2322.95 8500.06,-2297.97 8439.94,-2311.93 8206.5,-2286.95 8206.39,-2286.94 8206.28,-2286.93 8206.17,-2286.92"/>
<polygon fill="black" stroke="black" points="8206.27,-2283.41 8195.95,-2285.81 8205.51,-2290.37 8206.27,-2283.41"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge614" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8887.96,-2322.86C8867.08,-2313.2 8843.42,-2302.26 8819.51,-2291.2"/>
<polygon fill="black" stroke="black" points="8820.89,-2287.98 8810.35,-2286.96 8817.95,-2294.33 8820.89,-2287.98"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge615" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9110.95,-2322.94C9167.39,-2310.64 9233.47,-2296.24 9298.02,-2282.17"/>
<polygon fill="black" stroke="black" points="9298.92,-2285.56 9307.95,-2280.01 9297.43,-2278.72 9298.92,-2285.56"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge616" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9176.56,-2323.82C9179.56,-2323.52 9182.54,-2323.23 9185.5,-2322.95 9565.06,-2287.37 9662.94,-2322.53 10042.5,-2286.95 10093.16,-2282.2 10146.77,-2275.72 10198.78,-2268.64"/>
<polygon fill="black" stroke="black" points="10199.39,-2272.09 10208.82,-2267.27 10198.44,-2265.16 10199.39,-2272.09"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge617" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9176.55,-2323.73C9179.55,-2323.46 9182.54,-2323.2 9185.5,-2322.95 9971.86,-2257.82 10174.14,-2352.06 10960.5,-2286.95 11011.49,-2282.73 11065.44,-2276.48 11117.74,-2269.46"/>
<polygon fill="black" stroke="black" points="11118.39,-2272.91 11127.83,-2268.1 11117.45,-2265.97 11118.39,-2272.91"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge618" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9176.55,-2323.7C9179.55,-2323.44 9182.54,-2323.19 9185.5,-2322.95 10378.75,-2228.27 10685.25,-2381.6 11878.5,-2286.95 11929.69,-2282.89 11983.86,-2276.7 12036.34,-2269.68"/>
<polygon fill="black" stroke="black" points="12037.02,-2273.12 12046.47,-2268.32 12036.09,-2266.19 12037.02,-2273.12"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge619" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9176.55,-2323.69C9179.55,-2323.43 9182.54,-2323.18 9185.5,-2322.95 9985.58,-2260.84 11996.42,-2349.05 12796.5,-2286.95 12847.7,-2282.98 12901.87,-2276.83 12954.35,-2269.83"/>
<polygon fill="black" stroke="black" points="12955.04,-2273.27 12964.48,-2268.47 12954.1,-2266.33 12955.04,-2273.27"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge620" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9176.55,-2323.68C9179.55,-2323.42 9182.53,-2323.18 9185.5,-2322.95 10189.03,-2246.06 12710.96,-2363.82 13714.5,-2286.95 13765.7,-2283.03 13819.87,-2276.91 13872.36,-2269.92"/>
<polygon fill="black" stroke="black" points="13873.04,-2273.36 13882.49,-2268.56 13872.11,-2266.42 13873.04,-2273.36"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge621" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9176.55,-2323.67C9179.55,-2323.42 9182.53,-2323.18 9185.5,-2322.95 10392.49,-2231.29 13425.5,-2378.59 14632.5,-2286.95 14683.8,-2283.06 14738.08,-2276.94 14790.65,-2269.94"/>
<polygon fill="black" stroke="black" points="14791.35,-2273.38 14800.8,-2268.58 14790.42,-2266.44 14791.35,-2273.38"/>
</g>
<!-- l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge622" class="edge">
<title>l1_expert_7_gpu7&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9176.55,-2323.67C9179.55,-2323.42 9182.53,-2323.18 9185.5,-2322.95 10595.96,-2216.51 14140.04,-2393.36 15550.5,-2286.95 15601.8,-2283.08 15656.08,-2276.97 15708.66,-2269.98"/>
<polygon fill="black" stroke="black" points="15709.36,-2273.42 15718.8,-2268.62 15708.42,-2266.48 15709.36,-2273.42"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_7_gpu7 -->
<g id="edge605" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8946.35,-2426.75C8948.02,-2418 8949.7,-2409.23 8951.27,-2401.02"/>
<polygon fill="black" stroke="black" points="8954.75,-2401.45 8953.19,-2390.97 8947.87,-2400.13 8954.75,-2401.45"/>
</g>
<!-- l1_expert_agg_gpu7&#45;&gt;l1_res2_gpu7 -->
<g id="edge623" class="edge">
<title>l1_expert_agg_gpu7&#45;&gt;l1_res2_gpu7</title>
<path fill="none" stroke="black" d="M8558.1,-2150.95C8541.39,-2140.52 8524.63,-2130.07 8509.39,-2120.56"/>
<polygon fill="black" stroke="black" points="8510.94,-2117.4 8500.6,-2115.08 8507.23,-2123.34 8510.94,-2117.4"/>
</g>
<!-- l2_mha_qkv_gpu7 -->
<g id="node314" class="node">
<title>l2_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8553,-2010.95 8072,-2010.95 8072,-1942.95 8553,-1942.95 8553,-2010.95"/>
<text text-anchor="middle" x="8312.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8312.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8312.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8312.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu7&#45;&gt;l2_mha_qkv_gpu7 -->
<g id="edge1015" class="edge">
<title>l1_res2_gpu7&#45;&gt;l2_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M8403.67,-2046.84C8391.29,-2037.48 8377.7,-2027.21 8364.87,-2017.52"/>
<polygon fill="black" stroke="black" points="8366.66,-2014.49 8356.57,-2011.25 8362.44,-2020.07 8366.66,-2014.49"/>
</g>
<!-- l2_mha_res_add_gpu7 -->
<g id="node317" class="node">
<title>l2_mha_res_add_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8665.5,-1698.95 8231.5,-1698.95 8231.5,-1630.95 8665.5,-1630.95 8665.5,-1698.95"/>
<text text-anchor="middle" x="8448.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8448.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8448.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8448.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu7&#45;&gt;l2_mha_res_add_gpu7 -->
<g id="edge1019" class="edge">
<title>l1_res2_gpu7&#45;&gt;l2_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8527.53,-2046.87C8541.53,-2037.38 8554.24,-2025.54 8562.5,-2010.95 8622.94,-1904.2 8620.64,-1841.31 8559.5,-1734.95 8552.88,-1723.43 8543.47,-1713.57 8532.91,-1705.21"/>
<polygon fill="black" stroke="black" points="8534.76,-1702.23 8524.63,-1699.11 8530.61,-1707.86 8534.76,-1702.23"/>
</g>
<!-- l1_mha_attn_gpu8 -->
<g id="node195" class="node">
<title>l1_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10046,-2874.95 9565,-2874.95 9565,-2806.95 10046,-2806.95 10046,-2874.95"/>
<text text-anchor="middle" x="9805.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9805.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9805.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9805.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu8&#45;&gt;l1_mha_attn_gpu8 -->
<g id="edge626" class="edge">
<title>l1_mha_qkv_gpu8&#45;&gt;l1_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M9805.5,-2910.84C9805.5,-2902.73 9805.5,-2893.94 9805.5,-2885.43"/>
<polygon fill="black" stroke="black" points="9809,-2885.25 9805.5,-2875.25 9802,-2885.25 9809,-2885.25"/>
</g>
<!-- l1_mha_out_gpu8 -->
<g id="node196" class="node">
<title>l1_mha_out_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10043,-2770.95 9574,-2770.95 9574,-2702.95 10043,-2702.95 10043,-2770.95"/>
<text text-anchor="middle" x="9808.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9808.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9808.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9808.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu8&#45;&gt;l1_mha_out_gpu8 -->
<g id="edge627" class="edge">
<title>l1_mha_attn_gpu8&#45;&gt;l1_mha_out_gpu8</title>
<path fill="none" stroke="black" d="M9806.47,-2806.84C9806.71,-2798.73 9806.97,-2789.94 9807.22,-2781.43"/>
<polygon fill="black" stroke="black" points="9810.73,-2781.35 9807.52,-2771.25 9803.73,-2781.15 9810.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu8&#45;&gt;l1_mha_res_add_gpu8 -->
<g id="edge628" class="edge">
<title>l1_mha_out_gpu8&#45;&gt;l1_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M9851.68,-2702.84C9863.88,-2693.48 9877.27,-2683.21 9889.91,-2673.52"/>
<polygon fill="black" stroke="black" points="9892.28,-2676.12 9898.08,-2667.25 9888.02,-2670.56 9892.28,-2676.12"/>
</g>
<!-- l1_expert_8_gpu8 -->
<g id="node198" class="node">
<title>l1_expert_8_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9628.5,-2390.95 9194.5,-2390.95 9194.5,-2322.95 9628.5,-2322.95 9628.5,-2390.95"/>
<text text-anchor="middle" x="9411.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="9411.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9411.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9411.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu8&#45;&gt;l1_expert_8_gpu8 -->
<g id="edge632" class="edge">
<title>l1_mha_res_add_gpu8&#45;&gt;l1_expert_8_gpu8</title>
<path fill="none" stroke="black" d="M9724.36,-2624.89C9614.35,-2616.75 9495.85,-2599.47 9456.5,-2562.95 9444.68,-2551.99 9427.7,-2458.2 9418.34,-2401.35"/>
<polygon fill="black" stroke="black" points="9421.74,-2400.5 9416.68,-2391.2 9414.84,-2401.63 9421.74,-2400.5"/>
</g>
<!-- l1_gate_gpu8 -->
<g id="node199" class="node">
<title>l1_gate_gpu8</title>
<polygon fill="lightcyan" stroke="black" points="10417.24,-2562.95 9660.44,-2562.95 9465.76,-2426.95 10222.56,-2426.95 10417.24,-2562.95"/>
<text text-anchor="middle" x="9941.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9941.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9941.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9941.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu8&#45;&gt;l1_gate_gpu8 -->
<g id="edge630" class="edge">
<title>l1_mha_res_add_gpu8&#45;&gt;l1_gate_gpu8</title>
<path fill="none" stroke="black" d="M9941.5,-2598.68C9941.5,-2590.86 9941.5,-2582.19 9941.5,-2573.31"/>
<polygon fill="black" stroke="black" points="9945,-2573.22 9941.5,-2563.22 9938,-2573.22 9945,-2573.22"/>
</g>
<!-- l1_res2_gpu8 -->
<g id="node201" class="node">
<title>l1_res2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="10175.5,-2114.95 9741.5,-2114.95 9741.5,-2046.95 10175.5,-2046.95 10175.5,-2114.95"/>
<text text-anchor="middle" x="9958.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9958.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9958.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9958.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu8&#45;&gt;l1_res2_gpu8 -->
<g id="edge650" class="edge">
<title>l1_mha_res_add_gpu8&#45;&gt;l1_res2_gpu8</title>
<path fill="none" stroke="black" d="M10158.76,-2625.53C10407.74,-2618.33 10828.03,-2606.66 11189.5,-2598.95 11251.24,-2597.64 13364.26,-2601.52 13412.5,-2562.95 13461.08,-2524.11 13414.53,-2480.89 13445.5,-2426.95 13478.68,-2369.16 13491.85,-2348.25 13553.5,-2322.95 13628.41,-2292.21 16411.59,-2344.57 16468.5,-2286.95 16510.98,-2243.95 16511.09,-2193.84 16468.5,-2150.95 16442.66,-2124.93 11224.17,-2115.57 11187.5,-2114.95 10837.94,-2109.07 10432.58,-2097.21 10185.92,-2089.42"/>
<polygon fill="black" stroke="black" points="10185.86,-2085.92 10175.76,-2089.1 10185.64,-2092.92 10185.86,-2085.92"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge633" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9194.45,-2323.67C9191.45,-2323.42 9188.47,-2323.18 9185.5,-2322.95 8466.75,-2268.75 3417.25,-2341.14 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge634" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9194.45,-2323.67C9191.45,-2323.42 9188.47,-2323.18 9185.5,-2322.95 7951.47,-2229.32 4850.54,-2380.56 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.17 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge635" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9194.45,-2323.68C9191.45,-2323.42 9188.47,-2323.18 9185.5,-2322.95 8154.93,-2244.1 5565.08,-2365.78 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.17 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge636" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9194.45,-2323.69C9191.45,-2323.43 9188.47,-2323.18 9185.5,-2322.95 8358.38,-2258.87 6279.62,-2351.01 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.78,-2283.46 5442.53,-2286.16 5452.22,-2290.44 5452.78,-2283.46"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge637" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9194.45,-2323.7C9191.45,-2323.44 9188.46,-2323.19 9185.5,-2322.95 7938.18,-2224.35 7617.82,-2385.53 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.78,-2283.47 6360.53,-2286.14 6370.21,-2290.44 6370.78,-2283.47"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge638" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9194.45,-2323.73C9191.45,-2323.45 9188.46,-2323.2 9185.5,-2322.95 8345.07,-2253.9 8128.93,-2355.99 7288.5,-2286.95 7288.39,-2286.94 7288.29,-2286.94 7288.18,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.49,-2283.44 7278.23,-2286.09 7287.9,-2290.42 7288.49,-2283.44"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge639" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9194.44,-2323.8C9191.44,-2323.51 9188.46,-2323.22 9185.5,-2322.95 8751.89,-2283.44 8640.11,-2326.46 8206.5,-2286.95 8206.39,-2286.94 8206.29,-2286.93 8206.18,-2286.92"/>
<polygon fill="black" stroke="black" points="8206.52,-2283.44 8196.24,-2286 8205.87,-2290.41 8206.52,-2283.44"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge640" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9230.44,-2322.94C9173.52,-2312.57 9108.41,-2300.7 9043.12,-2288.8"/>
<polygon fill="black" stroke="black" points="9043.53,-2285.31 9033.06,-2286.96 9042.27,-2292.2 9043.53,-2285.31"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge641" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9453.58,-2322.68C9464.86,-2313.76 9477.52,-2303.75 9490.4,-2293.57"/>
<polygon fill="black" stroke="black" points="9492.76,-2296.16 9498.43,-2287.22 9488.42,-2290.67 9492.76,-2296.16"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge642" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9628.58,-2324.02C9631.57,-2323.65 9634.55,-2323.3 9637.5,-2322.95 9816.98,-2301.89 9863.02,-2308.01 10042.5,-2286.95 10092.37,-2281.1 10145.19,-2274.12 10196.54,-2266.92"/>
<polygon fill="black" stroke="black" points="10197.04,-2270.38 10206.45,-2265.52 10196.06,-2263.45 10197.04,-2270.38"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge643" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9628.55,-2323.76C9631.55,-2323.48 9634.54,-2323.21 9637.5,-2322.95 10223.54,-2272.37 10374.46,-2337.52 10960.5,-2286.95 11011.38,-2282.56 11065.22,-2276.24 11117.42,-2269.2"/>
<polygon fill="black" stroke="black" points="11118.06,-2272.65 11127.49,-2267.83 11117.11,-2265.71 11118.06,-2272.65"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge644" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9628.55,-2323.71C9631.55,-2323.45 9634.54,-2323.19 9637.5,-2322.95 10630.4,-2242.82 10885.6,-2367.06 11878.5,-2286.95 11929.59,-2282.83 11983.65,-2276.62 12036.04,-2269.61"/>
<polygon fill="black" stroke="black" points="12036.71,-2273.05 12046.15,-2268.24 12035.77,-2266.11 12036.71,-2273.05"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge645" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9628.55,-2323.69C9631.55,-2323.43 9634.54,-2323.19 9637.5,-2322.95 10337.4,-2268.11 12096.6,-2341.78 12796.5,-2286.95 12847.69,-2282.94 12901.86,-2276.77 12954.35,-2269.77"/>
<polygon fill="black" stroke="black" points="12955.03,-2273.21 12964.47,-2268.41 12954.1,-2266.27 12955.03,-2273.21"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge646" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9628.55,-2323.68C9631.55,-2323.43 9634.53,-2323.18 9637.5,-2322.95 10540.86,-2253.34 12811.14,-2356.55 13714.5,-2286.95 13765.7,-2283.01 13819.87,-2276.87 13872.36,-2269.88"/>
<polygon fill="black" stroke="black" points="13873.04,-2273.32 13882.48,-2268.52 13872.11,-2266.38 13873.04,-2273.32"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge647" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9628.55,-2323.68C9631.55,-2323.42 9634.53,-2323.18 9637.5,-2322.95 10744.32,-2238.56 13525.68,-2371.32 14632.5,-2286.95 14683.7,-2283.05 14737.88,-2276.93 14790.36,-2269.95"/>
<polygon fill="black" stroke="black" points="14791.04,-2273.39 14800.49,-2268.59 14790.11,-2266.45 14791.04,-2273.39"/>
</g>
<!-- l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge648" class="edge">
<title>l1_expert_8_gpu8&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9628.55,-2323.67C9631.55,-2323.42 9634.53,-2323.18 9637.5,-2322.95 10947.78,-2223.79 14240.22,-2386.09 15550.5,-2286.95 15601.8,-2283.07 15656.08,-2276.96 15708.66,-2269.96"/>
<polygon fill="black" stroke="black" points="15709.35,-2273.4 15718.8,-2268.6 15708.42,-2266.46 15709.35,-2273.4"/>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert_8_gpu8 -->
<g id="edge631" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert_8_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9680.38,-2426.95C9635.36,-2415.4 9590.19,-2403.81 9550.08,-2393.51"/>
<polygon fill="black" stroke="black" points="9550.81,-2390.09 9540.26,-2390.99 9549.07,-2396.87 9550.81,-2390.09"/>
</g>
<!-- l1_expert_agg_gpu8&#45;&gt;l1_res2_gpu8 -->
<g id="edge649" class="edge">
<title>l1_expert_agg_gpu8&#45;&gt;l1_res2_gpu8</title>
<path fill="none" stroke="black" d="M9768.25,-2150.95C9799.01,-2139.79 9829.87,-2128.6 9857.52,-2118.58"/>
<polygon fill="black" stroke="black" points="9858.95,-2121.78 9867.16,-2115.08 9856.56,-2115.2 9858.95,-2121.78"/>
</g>
<!-- l2_mha_qkv_gpu8 -->
<g id="node322" class="node">
<title>l2_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10065,-2010.95 9584,-2010.95 9584,-1942.95 10065,-1942.95 10065,-2010.95"/>
<text text-anchor="middle" x="9824.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9824.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9824.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9824.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu8&#45;&gt;l2_mha_qkv_gpu8 -->
<g id="edge1041" class="edge">
<title>l1_res2_gpu8&#45;&gt;l2_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M9914.99,-2046.84C9902.71,-2037.48 9889.21,-2027.21 9876.48,-2017.52"/>
<polygon fill="black" stroke="black" points="9878.32,-2014.52 9868.25,-2011.25 9874.08,-2020.09 9878.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu8 -->
<g id="node325" class="node">
<title>l2_mha_res_add_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="10177.5,-1698.95 9743.5,-1698.95 9743.5,-1630.95 10177.5,-1630.95 10177.5,-1698.95"/>
<text text-anchor="middle" x="9960.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9960.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9960.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9960.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu8&#45;&gt;l2_mha_res_add_gpu8 -->
<g id="edge1045" class="edge">
<title>l1_res2_gpu8&#45;&gt;l2_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M10039.5,-2046.79C10053.51,-2037.33 10066.22,-2025.52 10074.5,-2010.95 10135.14,-1904.32 10132.64,-1841.31 10071.5,-1734.95 10064.88,-1723.43 10055.47,-1713.57 10044.91,-1705.21"/>
<polygon fill="black" stroke="black" points="10046.76,-1702.23 10036.63,-1699.11 10042.61,-1707.86 10046.76,-1702.23"/>
</g>
<!-- l1_mha_attn_gpu9 -->
<g id="node203" class="node">
<title>l1_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11521,-2874.95 11040,-2874.95 11040,-2806.95 11521,-2806.95 11521,-2874.95"/>
<text text-anchor="middle" x="11280.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11280.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11280.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11280.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu9&#45;&gt;l1_mha_attn_gpu9 -->
<g id="edge652" class="edge">
<title>l1_mha_qkv_gpu9&#45;&gt;l1_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M11280.5,-2910.84C11280.5,-2902.73 11280.5,-2893.94 11280.5,-2885.43"/>
<polygon fill="black" stroke="black" points="11284,-2885.25 11280.5,-2875.25 11277,-2885.25 11284,-2885.25"/>
</g>
<!-- l1_mha_out_gpu9 -->
<g id="node204" class="node">
<title>l1_mha_out_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11518,-2770.95 11049,-2770.95 11049,-2702.95 11518,-2702.95 11518,-2770.95"/>
<text text-anchor="middle" x="11283.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11283.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11283.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11283.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu9&#45;&gt;l1_mha_out_gpu9 -->
<g id="edge653" class="edge">
<title>l1_mha_attn_gpu9&#45;&gt;l1_mha_out_gpu9</title>
<path fill="none" stroke="black" d="M11281.47,-2806.84C11281.71,-2798.73 11281.97,-2789.94 11282.22,-2781.43"/>
<polygon fill="black" stroke="black" points="11285.73,-2781.35 11282.52,-2771.25 11278.73,-2781.15 11285.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu9&#45;&gt;l1_mha_res_add_gpu9 -->
<g id="edge654" class="edge">
<title>l1_mha_out_gpu9&#45;&gt;l1_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11326.36,-2702.84C11338.46,-2693.48 11351.75,-2683.21 11364.29,-2673.52"/>
<polygon fill="black" stroke="black" points="11366.63,-2676.14 11372.41,-2667.25 11362.35,-2670.6 11366.63,-2676.14"/>
</g>
<!-- l1_expert_9_gpu9 -->
<g id="node206" class="node">
<title>l1_expert_9_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10080.5,-2390.95 9646.5,-2390.95 9646.5,-2322.95 10080.5,-2322.95 10080.5,-2390.95"/>
<text text-anchor="middle" x="9863.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="9863.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9863.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9863.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu9&#45;&gt;l1_expert_9_gpu9 -->
<g id="edge658" class="edge">
<title>l1_mha_res_add_gpu9&#45;&gt;l1_expert_9_gpu9</title>
<path fill="none" stroke="black" d="M11424.21,-2598.57C11433.97,-2552.57 11442.92,-2470.46 11396.5,-2426.95 11345.1,-2378.79 10232.38,-2396.07 10090.9,-2390.72"/>
<polygon fill="black" stroke="black" points="10090.73,-2387.2 10080.55,-2390.15 10090.35,-2394.19 10090.73,-2387.2"/>
</g>
<!-- l1_gate_gpu9 -->
<g id="node207" class="node">
<title>l1_gate_gpu9</title>
<polygon fill="lightcyan" stroke="black" points="11387.24,-2562.95 10630.44,-2562.95 10435.76,-2426.95 11192.56,-2426.95 11387.24,-2562.95"/>
<text text-anchor="middle" x="10911.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10911.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10911.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10911.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu9&#45;&gt;l1_gate_gpu9 -->
<g id="edge656" class="edge">
<title>l1_mha_res_add_gpu9&#45;&gt;l1_gate_gpu9</title>
<path fill="none" stroke="black" d="M11293.17,-2598.94C11255.59,-2588.8 11212.72,-2577.23 11169.61,-2565.6"/>
<polygon fill="black" stroke="black" points="11170.39,-2562.19 11159.83,-2562.96 11168.57,-2568.95 11170.39,-2562.19"/>
</g>
<!-- l1_res2_gpu9 -->
<g id="node209" class="node">
<title>l1_res2_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="11630.5,-2114.95 11196.5,-2114.95 11196.5,-2046.95 11630.5,-2046.95 11630.5,-2114.95"/>
<text text-anchor="middle" x="11413.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11413.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11413.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11413.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu9&#45;&gt;l1_res2_gpu9 -->
<g id="edge676" class="edge">
<title>l1_mha_res_add_gpu9&#45;&gt;l1_res2_gpu9</title>
<path fill="none" stroke="black" d="M11632.89,-2606.86C11665.89,-2603.74 11699.57,-2600.95 11731.5,-2598.95 11779.03,-2595.98 13406.92,-2590.86 13445.5,-2562.95 13497.43,-2525.38 13442.43,-2465.69 13493.5,-2426.95 13771.92,-2215.8 14713.43,-2338.88 15062.5,-2322.95 15102.44,-2321.13 16473.58,-2315.58 16501.5,-2286.95 16543.7,-2243.68 16544.08,-2193.86 16501.5,-2150.95 16455.65,-2104.74 11879.53,-2117.87 11814.5,-2114.95 11758.13,-2112.42 11697.41,-2108.2 11640.7,-2103.61"/>
<polygon fill="black" stroke="black" points="11640.78,-2100.11 11630.53,-2102.78 11640.21,-2107.08 11640.78,-2100.11"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge659" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9646.45,-2323.67C9643.45,-2323.41 9640.47,-2323.18 9637.5,-2322.95 8868.66,-2265.11 3467.34,-2344.78 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.22,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge660" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9646.45,-2323.67C9643.45,-2323.42 9640.47,-2323.18 9637.5,-2322.95 8303.29,-2222.05 4950.72,-2387.83 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.17 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge661" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9646.45,-2323.68C9643.45,-2323.42 9640.47,-2323.18 9637.5,-2322.95 8506.75,-2236.82 5665.25,-2373.06 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.17 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge662" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9646.45,-2323.68C9643.45,-2323.42 9640.47,-2323.18 9637.5,-2322.95 8710.21,-2251.6 6379.79,-2358.29 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.16 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge663" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9646.45,-2323.69C9643.45,-2323.43 9640.46,-2323.19 9637.5,-2322.95 8913.66,-2266.37 7094.34,-2343.51 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.78,-2283.47 6360.53,-2286.15 6370.21,-2290.44 6370.78,-2283.47"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge664" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9646.45,-2323.71C9643.45,-2323.44 9640.46,-2323.19 9637.5,-2322.95 8596.73,-2239.35 8329.27,-2370.53 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.78,-2283.47 7278.53,-2286.13 7288.21,-2290.44 7288.78,-2283.47"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge665" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9646.45,-2323.75C9643.45,-2323.47 9640.46,-2323.21 9637.5,-2322.95 9003.6,-2268.9 8840.4,-2341 8206.5,-2286.95 8206.39,-2286.94 8206.29,-2286.94 8206.18,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.5,-2283.44 8196.23,-2286.06 8205.89,-2290.41 8206.5,-2283.44"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge666" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9646.43,-2323.94C9643.43,-2323.6 9640.46,-2323.27 9637.5,-2322.95 9410.26,-2298.42 9351.74,-2311.48 9124.5,-2286.95 9124.39,-2286.94 9124.28,-2286.93 9124.17,-2286.92"/>
<polygon fill="black" stroke="black" points="9124.27,-2283.41 9113.95,-2285.8 9123.51,-2290.37 9124.27,-2283.41"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge667" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9795.36,-2322.86C9775.57,-2313.24 9753.15,-2302.35 9730.48,-2291.34"/>
<polygon fill="black" stroke="black" points="9731.97,-2288.18 9721.45,-2286.96 9728.91,-2294.47 9731.97,-2288.18"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge668" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10018.35,-2322.94C10077.58,-2310.32 10147.19,-2295.48 10214.84,-2281.06"/>
<polygon fill="black" stroke="black" points="10215.76,-2284.44 10224.81,-2278.93 10214.3,-2277.6 10215.76,-2284.44"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge669" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10080.56,-2323.82C10083.56,-2323.52 10086.54,-2323.23 10089.5,-2322.95 10475.26,-2286.92 10574.74,-2322.98 10960.5,-2286.95 11011.16,-2282.22 11064.77,-2275.75 11116.79,-2268.67"/>
<polygon fill="black" stroke="black" points="11117.39,-2272.12 11126.82,-2267.3 11116.44,-2265.19 11117.39,-2272.12"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge670" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10080.55,-2323.73C10083.55,-2323.46 10086.54,-2323.2 10089.5,-2322.95 10882.06,-2257.37 11085.93,-2352.52 11878.5,-2286.95 11929.49,-2282.74 11983.44,-2276.48 12035.74,-2269.47"/>
<polygon fill="black" stroke="black" points="12036.39,-2272.91 12045.83,-2268.1 12035.45,-2265.98 12036.39,-2272.91"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge671" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10080.55,-2323.7C10083.55,-2323.44 10086.54,-2323.19 10089.5,-2322.95 11288.95,-2227.82 11597.05,-2382.05 12796.5,-2286.95 12847.69,-2282.89 12901.86,-2276.7 12954.34,-2269.69"/>
<polygon fill="black" stroke="black" points="12955.03,-2273.13 12964.47,-2268.32 12954.09,-2266.19 12955.03,-2273.13"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge672" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10080.55,-2323.69C10083.55,-2323.43 10086.54,-2323.18 10089.5,-2322.95 10892.68,-2260.61 12911.32,-2349.27 13714.5,-2286.95 13765.7,-2282.98 13819.87,-2276.83 13872.35,-2269.83"/>
<polygon fill="black" stroke="black" points="13873.04,-2273.27 13882.48,-2268.47 13872.1,-2266.34 13873.04,-2273.27"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge673" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10080.55,-2323.68C10083.55,-2323.42 10086.53,-2323.18 10089.5,-2322.95 11096.14,-2245.84 13625.86,-2364.05 14632.5,-2286.95 14683.7,-2283.03 14737.87,-2276.91 14790.36,-2269.92"/>
<polygon fill="black" stroke="black" points="14791.04,-2273.36 14800.49,-2268.56 14790.11,-2266.42 14791.04,-2273.36"/>
</g>
<!-- l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge674" class="edge">
<title>l1_expert_9_gpu9&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10080.55,-2323.67C10083.55,-2323.42 10086.53,-2323.18 10089.5,-2322.95 11299.6,-2231.06 14340.4,-2378.82 15550.5,-2286.95 15601.8,-2283.06 15656.08,-2276.94 15708.65,-2269.94"/>
<polygon fill="black" stroke="black" points="15709.35,-2273.38 15718.8,-2268.58 15708.42,-2266.44 15709.35,-2273.38"/>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert_9_gpu9 -->
<g id="edge657" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10437.62,-2428.32C10433.9,-2427.86 10430.19,-2427.41 10426.5,-2426.95 10280.2,-2409.04 10240.63,-2409.8 10090.63,-2391.08"/>
<polygon fill="black" stroke="black" points="10090.95,-2387.59 10080.59,-2389.82 10090.07,-2394.54 10090.95,-2387.59"/>
</g>
<!-- l1_expert_agg_gpu9&#45;&gt;l1_res2_gpu9 -->
<g id="edge675" class="edge">
<title>l1_expert_agg_gpu9&#45;&gt;l1_res2_gpu9</title>
<path fill="none" stroke="black" d="M10798.23,-2173.7C10924.29,-2154.91 11068.91,-2133.34 11186.26,-2115.84"/>
<polygon fill="black" stroke="black" points="11187.08,-2119.26 11196.45,-2114.32 11186.05,-2112.33 11187.08,-2119.26"/>
</g>
<!-- l2_mha_qkv_gpu9 -->
<g id="node330" class="node">
<title>l2_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11541,-2010.95 11060,-2010.95 11060,-1942.95 11541,-1942.95 11541,-2010.95"/>
<text text-anchor="middle" x="11300.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11300.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11300.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11300.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu9&#45;&gt;l2_mha_qkv_gpu9 -->
<g id="edge1067" class="edge">
<title>l1_res2_gpu9&#45;&gt;l2_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M11376.81,-2046.84C11366.65,-2037.66 11355.5,-2027.6 11344.95,-2018.08"/>
<polygon fill="black" stroke="black" points="11347.16,-2015.36 11337.39,-2011.25 11342.47,-2020.55 11347.16,-2015.36"/>
</g>
<!-- l2_mha_res_add_gpu9 -->
<g id="node333" class="node">
<title>l2_mha_res_add_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="11651.5,-1698.95 11217.5,-1698.95 11217.5,-1630.95 11651.5,-1630.95 11651.5,-1698.95"/>
<text text-anchor="middle" x="11434.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11434.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11434.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11434.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu9&#45;&gt;l2_mha_res_add_gpu9 -->
<g id="edge1071" class="edge">
<title>l1_res2_gpu9&#45;&gt;l2_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11512.99,-2046.86C11527.92,-2037.57 11541.35,-2025.8 11550.5,-2010.95 11614.84,-1906.51 11609.06,-1841.06 11547.5,-1734.95 11540.79,-1723.39 11531.29,-1713.52 11520.63,-1705.16"/>
<polygon fill="black" stroke="black" points="11522.41,-1702.13 11512.27,-1699.07 11518.29,-1707.79 11522.41,-1702.13"/>
</g>
<!-- l1_mha_attn_gpu10 -->
<g id="node211" class="node">
<title>l1_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12061,-2874.95 11580,-2874.95 11580,-2806.95 12061,-2806.95 12061,-2874.95"/>
<text text-anchor="middle" x="11820.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11820.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11820.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11820.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu10&#45;&gt;l1_mha_attn_gpu10 -->
<g id="edge678" class="edge">
<title>l1_mha_qkv_gpu10&#45;&gt;l1_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M11820.5,-2910.84C11820.5,-2902.73 11820.5,-2893.94 11820.5,-2885.43"/>
<polygon fill="black" stroke="black" points="11824,-2885.25 11820.5,-2875.25 11817,-2885.25 11824,-2885.25"/>
</g>
<!-- l1_mha_out_gpu10 -->
<g id="node212" class="node">
<title>l1_mha_out_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12058,-2770.95 11589,-2770.95 11589,-2702.95 12058,-2702.95 12058,-2770.95"/>
<text text-anchor="middle" x="11823.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11823.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11823.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11823.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu10&#45;&gt;l1_mha_out_gpu10 -->
<g id="edge679" class="edge">
<title>l1_mha_attn_gpu10&#45;&gt;l1_mha_out_gpu10</title>
<path fill="none" stroke="black" d="M11821.47,-2806.84C11821.71,-2798.73 11821.97,-2789.94 11822.22,-2781.43"/>
<polygon fill="black" stroke="black" points="11825.73,-2781.35 11822.52,-2771.25 11818.73,-2781.15 11825.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu10&#45;&gt;l1_mha_res_add_gpu10 -->
<g id="edge680" class="edge">
<title>l1_mha_out_gpu10&#45;&gt;l1_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M11867.01,-2702.84C11879.29,-2693.48 11892.79,-2683.21 11905.52,-2673.52"/>
<polygon fill="black" stroke="black" points="11907.92,-2676.09 11913.75,-2667.25 11903.68,-2670.52 11907.92,-2676.09"/>
</g>
<!-- l1_expert_10_gpu10 -->
<g id="node214" class="node">
<title>l1_expert_10_gpu10</title>
<polygon fill="lightpink" stroke="black" points="10532.5,-2390.95 10098.5,-2390.95 10098.5,-2322.95 10532.5,-2322.95 10532.5,-2390.95"/>
<text text-anchor="middle" x="10315.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="10315.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10315.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10315.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu10&#45;&gt;l1_expert_10_gpu10 -->
<g id="edge684" class="edge">
<title>l1_mha_res_add_gpu10&#45;&gt;l1_expert_10_gpu10</title>
<path fill="none" stroke="black" d="M11740.18,-2606.19C11616.3,-2590.64 11483.45,-2572.11 11472.5,-2562.95 11423.65,-2522.12 11478.34,-2465.28 11427.5,-2426.95 11389.7,-2398.46 10651.71,-2395.7 10542.65,-2390.71"/>
<polygon fill="black" stroke="black" points="10542.76,-2387.21 10532.56,-2390.09 10542.33,-2394.2 10542.76,-2387.21"/>
</g>
<!-- l1_gate_gpu10 -->
<g id="node215" class="node">
<title>l1_gate_gpu10</title>
<polygon fill="lightcyan" stroke="black" points="12433.24,-2562.95 11676.44,-2562.95 11481.76,-2426.95 12238.56,-2426.95 12433.24,-2562.95"/>
<text text-anchor="middle" x="11957.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11957.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11957.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11957.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu10&#45;&gt;l1_gate_gpu10 -->
<g id="edge682" class="edge">
<title>l1_mha_res_add_gpu10&#45;&gt;l1_gate_gpu10</title>
<path fill="none" stroke="black" d="M11957.5,-2598.68C11957.5,-2590.86 11957.5,-2582.19 11957.5,-2573.31"/>
<polygon fill="black" stroke="black" points="11961,-2573.22 11957.5,-2563.22 11954,-2573.22 11961,-2573.22"/>
</g>
<!-- l1_res2_gpu10 -->
<g id="node217" class="node">
<title>l1_res2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="12257.5,-2114.95 11823.5,-2114.95 11823.5,-2046.95 12257.5,-2046.95 12257.5,-2114.95"/>
<text text-anchor="middle" x="12040.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12040.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12040.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12040.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu10&#45;&gt;l1_res2_gpu10 -->
<g id="edge702" class="edge">
<title>l1_mha_res_add_gpu10&#45;&gt;l1_res2_gpu10</title>
<path fill="none" stroke="black" d="M12174.82,-2631.52C12568.3,-2629.36 13368.83,-2618.14 13483.5,-2562.95 13555.87,-2528.12 13530.19,-2461.91 13602.5,-2426.95 13605.84,-2425.34 15730.8,-2323.13 15734.5,-2322.95 15778.72,-2320.87 16499.91,-2318.95 16530.5,-2286.95 16572.26,-2243.26 16573,-2193.93 16530.5,-2150.95 16499.12,-2119.22 13362.12,-2115.78 13317.5,-2114.95 12950.03,-2108.15 12523.17,-2096.32 12267.82,-2088.83"/>
<polygon fill="black" stroke="black" points="12267.77,-2085.33 12257.67,-2088.53 12267.57,-2092.33 12267.77,-2085.33"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge685" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10098.45,-2323.67C10095.45,-2323.41 10092.47,-2323.18 10089.5,-2322.95 9270.57,-2261.47 3517.43,-2348.41 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.23,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge686" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10098.45,-2323.67C10095.45,-2323.42 10092.47,-2323.18 10089.5,-2322.95 9372.3,-2268.86 4333.7,-2341.03 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.18 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge687" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10098.45,-2323.67C10095.45,-2323.42 10092.47,-2323.18 10089.5,-2322.95 8858.57,-2229.55 5765.43,-2380.33 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.17 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge688" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10098.45,-2323.68C10095.45,-2323.42 10092.47,-2323.18 10089.5,-2322.95 9062.03,-2244.32 6479.97,-2365.56 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.17 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge689" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10098.45,-2323.69C10095.45,-2323.43 10092.47,-2323.18 10089.5,-2322.95 9265.49,-2259.1 7194.51,-2350.79 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.78,-2283.46 6360.53,-2286.16 6370.22,-2290.44 6370.78,-2283.46"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge690" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10098.45,-2323.7C10095.45,-2323.44 10092.46,-2323.19 10089.5,-2322.95 8848.38,-2224.8 8529.62,-2385.08 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.78,-2283.47 7278.53,-2286.14 7288.21,-2290.44 7288.78,-2283.47"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge691" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10098.45,-2323.73C10095.45,-2323.45 10092.46,-2323.2 10089.5,-2322.95 9255.27,-2254.35 9040.73,-2355.54 8206.5,-2286.95 8206.39,-2286.94 8206.29,-2286.94 8206.18,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.49,-2283.44 8196.23,-2286.08 8205.9,-2290.42 8206.49,-2283.44"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge692" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10098.44,-2323.8C10095.44,-2323.51 10092.46,-2323.22 10089.5,-2322.95 9662.09,-2283.89 9551.91,-2326.01 9124.5,-2286.95 9124.39,-2286.94 9124.29,-2286.93 9124.18,-2286.92"/>
<polygon fill="black" stroke="black" points="9124.52,-2283.44 9114.24,-2286 9123.87,-2290.41 9124.52,-2283.44"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge693" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10137.84,-2322.94C10081.99,-2312.57 10018.1,-2300.7 9954.03,-2288.8"/>
<polygon fill="black" stroke="black" points="9954.63,-2285.35 9944.16,-2286.96 9953.36,-2292.23 9954.63,-2285.35"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge694" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10361,-2322.68C10373.32,-2313.68 10387.15,-2303.56 10401.21,-2293.28"/>
<polygon fill="black" stroke="black" points="10403.5,-2295.94 10409.51,-2287.22 10399.37,-2290.29 10403.5,-2295.94"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge695" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10532.58,-2324C10535.57,-2323.65 10538.55,-2323.3 10541.5,-2322.95 10727.17,-2301.44 10774.83,-2308.46 10960.5,-2286.95 11010.48,-2281.16 11063.4,-2274.21 11114.85,-2267"/>
<polygon fill="black" stroke="black" points="11115.36,-2270.47 11124.78,-2265.61 11114.39,-2263.54 11115.36,-2270.47"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge696" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10532.55,-2323.76C10535.55,-2323.48 10538.54,-2323.21 10541.5,-2322.95 11133.74,-2271.92 11286.26,-2337.97 11878.5,-2286.95 11929.38,-2282.57 11983.22,-2276.25 12035.42,-2269.22"/>
<polygon fill="black" stroke="black" points="12036.06,-2272.66 12045.5,-2267.85 12035.12,-2265.72 12036.06,-2272.66"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge697" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10532.55,-2323.71C10535.55,-2323.45 10538.54,-2323.19 10541.5,-2322.95 11540.61,-2242.37 11797.39,-2367.51 12796.5,-2286.95 12847.59,-2282.83 12901.65,-2276.62 12954.04,-2269.61"/>
<polygon fill="black" stroke="black" points="12954.71,-2273.05 12964.15,-2268.25 12953.77,-2266.12 12954.71,-2273.05"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge698" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10532.55,-2323.69C10535.55,-2323.43 10538.54,-2323.19 10541.5,-2322.95 11244.5,-2267.89 13011.5,-2342 13714.5,-2286.95 13765.69,-2282.94 13819.86,-2276.78 13872.35,-2269.77"/>
<polygon fill="black" stroke="black" points="13873.03,-2273.21 13882.47,-2268.41 13872.1,-2266.27 13873.03,-2273.21"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge699" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10532.55,-2323.68C10535.55,-2323.43 10538.53,-2323.18 10541.5,-2322.95 11447.96,-2253.11 13726.04,-2356.77 14632.5,-2286.95 14683.7,-2283.01 14737.87,-2276.87 14790.36,-2269.88"/>
<polygon fill="black" stroke="black" points="14791.04,-2273.32 14800.48,-2268.52 14790.11,-2266.38 14791.04,-2273.32"/>
</g>
<!-- l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge700" class="edge">
<title>l1_expert_10_gpu10&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10532.55,-2323.68C10535.55,-2323.42 10538.53,-2323.18 10541.5,-2322.95 11651.42,-2238.34 14440.58,-2371.54 15550.5,-2286.95 15601.7,-2283.05 15655.88,-2276.94 15708.36,-2269.95"/>
<polygon fill="black" stroke="black" points="15709.04,-2273.39 15718.49,-2268.59 15708.11,-2266.45 15709.04,-2273.39"/>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert_10_gpu10 -->
<g id="edge683" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert_10_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11483.63,-2428.41C11478.22,-2427.91 11472.85,-2427.42 11467.5,-2426.95 11060.51,-2391.3 10953.35,-2428.16 10542.63,-2391.02"/>
<polygon fill="black" stroke="black" points="10542.84,-2387.52 10532.56,-2390.1 10542.2,-2394.49 10542.84,-2387.52"/>
</g>
<!-- l1_expert_agg_gpu10&#45;&gt;l1_res2_gpu10 -->
<g id="edge701" class="edge">
<title>l1_expert_agg_gpu10&#45;&gt;l1_res2_gpu10</title>
<path fill="none" stroke="black" d="M11694.59,-2157.71C11757.79,-2143.87 11822.97,-2129.59 11879.48,-2117.22"/>
<polygon fill="black" stroke="black" points="11880.54,-2120.57 11889.56,-2115.01 11879.05,-2113.73 11880.54,-2120.57"/>
</g>
<!-- l2_mha_qkv_gpu10 -->
<g id="node338" class="node">
<title>l2_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12147,-2010.95 11666,-2010.95 11666,-1942.95 12147,-1942.95 12147,-2010.95"/>
<text text-anchor="middle" x="11906.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11906.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11906.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11906.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu10&#45;&gt;l2_mha_qkv_gpu10 -->
<g id="edge1093" class="edge">
<title>l1_res2_gpu10&#45;&gt;l2_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M11996.99,-2046.84C11984.71,-2037.48 11971.21,-2027.21 11958.48,-2017.52"/>
<polygon fill="black" stroke="black" points="11960.32,-2014.52 11950.25,-2011.25 11956.08,-2020.09 11960.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu10 -->
<g id="node341" class="node">
<title>l2_mha_res_add_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="12193.5,-1698.95 11759.5,-1698.95 11759.5,-1630.95 12193.5,-1630.95 12193.5,-1698.95"/>
<text text-anchor="middle" x="11976.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11976.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11976.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11976.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu10&#45;&gt;l2_mha_res_add_gpu10 -->
<g id="edge1097" class="edge">
<title>l1_res2_gpu10&#45;&gt;l2_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M12121.5,-2046.79C12135.51,-2037.33 12148.22,-2025.52 12156.5,-2010.95 12217.14,-1904.32 12224.17,-1835.22 12153.5,-1734.95 12144.93,-1722.8 12133.89,-1712.78 12121.51,-1704.53"/>
<polygon fill="black" stroke="black" points="12123.09,-1701.39 12112.74,-1699.1 12119.4,-1707.34 12123.09,-1701.39"/>
</g>
<!-- l1_mha_attn_gpu11 -->
<g id="node219" class="node">
<title>l1_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13573,-2874.95 13092,-2874.95 13092,-2806.95 13573,-2806.95 13573,-2874.95"/>
<text text-anchor="middle" x="13332.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13332.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13332.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13332.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu11&#45;&gt;l1_mha_attn_gpu11 -->
<g id="edge704" class="edge">
<title>l1_mha_qkv_gpu11&#45;&gt;l1_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M13332.5,-2910.84C13332.5,-2902.73 13332.5,-2893.94 13332.5,-2885.43"/>
<polygon fill="black" stroke="black" points="13336,-2885.25 13332.5,-2875.25 13329,-2885.25 13336,-2885.25"/>
</g>
<!-- l1_mha_out_gpu11 -->
<g id="node220" class="node">
<title>l1_mha_out_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13570,-2770.95 13101,-2770.95 13101,-2702.95 13570,-2702.95 13570,-2770.95"/>
<text text-anchor="middle" x="13335.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13335.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13335.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13335.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu11&#45;&gt;l1_mha_out_gpu11 -->
<g id="edge705" class="edge">
<title>l1_mha_attn_gpu11&#45;&gt;l1_mha_out_gpu11</title>
<path fill="none" stroke="black" d="M13333.47,-2806.84C13333.71,-2798.73 13333.97,-2789.94 13334.22,-2781.43"/>
<polygon fill="black" stroke="black" points="13337.73,-2781.35 13334.52,-2771.25 13330.73,-2781.15 13337.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu11&#45;&gt;l1_mha_res_add_gpu11 -->
<g id="edge706" class="edge">
<title>l1_mha_out_gpu11&#45;&gt;l1_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M13403.68,-2702.84C13424.23,-2692.85 13446.94,-2681.83 13468.05,-2671.57"/>
<polygon fill="black" stroke="black" points="13469.84,-2674.6 13477.3,-2667.08 13466.78,-2668.3 13469.84,-2674.6"/>
</g>
<!-- l1_expert_11_gpu11 -->
<g id="node222" class="node">
<title>l1_expert_11_gpu11</title>
<polygon fill="lightpink" stroke="black" points="10984.5,-2390.95 10550.5,-2390.95 10550.5,-2322.95 10984.5,-2322.95 10984.5,-2390.95"/>
<text text-anchor="middle" x="10767.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="10767.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10767.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10767.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu11&#45;&gt;l1_expert_11_gpu11 -->
<g id="edge710" class="edge">
<title>l1_mha_res_add_gpu11&#45;&gt;l1_expert_11_gpu11</title>
<path fill="none" stroke="black" d="M13535.11,-2598.65C13518.15,-2550.72 13479.51,-2464.01 13412.5,-2426.95 13355.18,-2395.26 11175.5,-2396.25 10994.55,-2390.65"/>
<polygon fill="black" stroke="black" points="10994.7,-2387.15 10984.55,-2390.2 10994.38,-2394.15 10994.7,-2387.15"/>
</g>
<!-- l1_gate_gpu11 -->
<g id="node223" class="node">
<title>l1_gate_gpu11</title>
<polygon fill="lightcyan" stroke="black" points="13403.24,-2562.95 12646.44,-2562.95 12451.76,-2426.95 13208.56,-2426.95 13403.24,-2562.95"/>
<text text-anchor="middle" x="12927.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12927.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12927.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12927.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu11&#45;&gt;l1_gate_gpu11 -->
<g id="edge708" class="edge">
<title>l1_mha_res_add_gpu11&#45;&gt;l1_gate_gpu11</title>
<path fill="none" stroke="black" d="M13395.51,-2598.94C13348.84,-2588.68 13295.53,-2576.94 13241.99,-2565.16"/>
<polygon fill="black" stroke="black" points="13242.51,-2561.69 13231.99,-2562.96 13241.01,-2568.53 13242.51,-2561.69"/>
</g>
<!-- l1_res2_gpu11 -->
<g id="node225" class="node">
<title>l1_res2_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="13760.5,-2114.95 13326.5,-2114.95 13326.5,-2046.95 13760.5,-2046.95 13760.5,-2114.95"/>
<text text-anchor="middle" x="13543.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13543.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13543.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13543.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu11&#45;&gt;l1_res2_gpu11 -->
<g id="edge728" class="edge">
<title>l1_mha_res_add_gpu11&#45;&gt;l1_res2_gpu11</title>
<path fill="none" stroke="black" d="M13762.89,-2606.87C13795.89,-2603.75 13829.57,-2600.96 13861.5,-2598.95 13954.73,-2593.1 15458.28,-2603.36 15542.5,-2562.95 15613.61,-2528.84 15587.74,-2465.59 15656.5,-2426.95 16017.44,-2224.1 16307.63,-2600.95 16577.5,-2286.95 16616.9,-2241.11 16619.95,-2193.99 16577.5,-2150.95 16551.82,-2124.92 13981.03,-2116.7 13944.5,-2114.95 13888.14,-2112.25 13827.42,-2107.97 13770.71,-2103.37"/>
<polygon fill="black" stroke="black" points="13770.79,-2099.87 13760.54,-2102.54 13770.22,-2106.85 13770.79,-2099.87"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge711" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10550.45,-2323.66C10547.45,-2323.41 10544.47,-2323.18 10541.5,-2322.95 9672.48,-2257.84 3567.52,-2352.05 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.23,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge712" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10550.45,-2323.67C10547.45,-2323.41 10544.47,-2323.18 10541.5,-2322.95 9774.21,-2265.22 4383.79,-2344.66 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.18 3616.22,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge713" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10550.45,-2323.67C10547.45,-2323.42 10544.47,-2323.18 10541.5,-2322.95 9210.39,-2222.27 5865.61,-2387.6 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.17 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge714" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10550.45,-2323.68C10547.45,-2323.42 10544.47,-2323.18 10541.5,-2322.95 9413.85,-2237.05 6580.15,-2372.83 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.17 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge715" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10550.45,-2323.68C10547.45,-2323.42 10544.47,-2323.18 10541.5,-2322.95 9617.31,-2251.82 7294.69,-2358.06 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.77,-2283.46 6360.53,-2286.16 6370.22,-2290.44 6370.77,-2283.46"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge716" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10550.45,-2323.69C10547.45,-2323.43 10544.46,-2323.19 10541.5,-2322.95 9820.77,-2266.6 8009.23,-2343.29 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.78,-2283.47 7278.53,-2286.15 7288.21,-2290.44 7288.78,-2283.47"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge717" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10550.45,-2323.71C10547.45,-2323.44 10544.46,-2323.19 10541.5,-2322.95 9506.94,-2239.8 9241.07,-2370.08 8206.5,-2286.95 8206.4,-2286.95 8206.29,-2286.94 8206.19,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.78,-2283.47 8196.53,-2286.13 8206.21,-2290.44 8206.78,-2283.47"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge718" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10550.45,-2323.75C10547.45,-2323.47 10544.46,-2323.21 10541.5,-2322.95 9913.8,-2269.35 9752.2,-2340.55 9124.5,-2286.95 9124.39,-2286.94 9124.29,-2286.94 9124.18,-2286.93"/>
<polygon fill="black" stroke="black" points="9124.5,-2283.44 9114.23,-2286.05 9123.89,-2290.41 9124.5,-2283.44"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge719" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10550.43,-2323.95C10547.43,-2323.61 10544.46,-2323.28 10541.5,-2322.95 10320.45,-2298.87 10263.55,-2311.03 10042.5,-2286.95 10042.39,-2286.94 10042.28,-2286.93 10042.17,-2286.92"/>
<polygon fill="black" stroke="black" points="10042.27,-2283.41 10031.95,-2285.79 10041.51,-2290.37 10042.27,-2283.41"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge720" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10702.77,-2322.86C10684.13,-2313.33 10663.04,-2302.55 10641.7,-2291.64"/>
<polygon fill="black" stroke="black" points="10643.05,-2288.39 10632.55,-2286.96 10639.86,-2294.63 10643.05,-2288.39"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge721" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10925.75,-2322.94C10987.66,-2310.03 11060.68,-2294.8 11131.29,-2280.07"/>
<polygon fill="black" stroke="black" points="11132.16,-2283.46 11141.24,-2278 11130.73,-2276.61 11132.16,-2283.46"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge722" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10984.56,-2323.82C10987.56,-2323.52 10990.54,-2323.23 10993.5,-2322.95 11385.46,-2286.46 11486.54,-2323.43 11878.5,-2286.95 11929.16,-2282.24 11982.77,-2275.77 12034.79,-2268.7"/>
<polygon fill="black" stroke="black" points="12035.39,-2272.15 12044.83,-2267.33 12034.44,-2265.22 12035.39,-2272.15"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge723" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10984.55,-2323.73C10987.55,-2323.46 10990.54,-2323.2 10993.5,-2322.95 11792.27,-2256.92 11997.73,-2352.97 12796.5,-2286.95 12847.58,-2282.73 12901.64,-2276.47 12954.03,-2269.44"/>
<polygon fill="black" stroke="black" points="12954.7,-2272.88 12964.14,-2268.07 12953.76,-2265.94 12954.7,-2272.88"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge724" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10984.55,-2323.7C10987.55,-2323.44 10990.54,-2323.19 10993.5,-2322.95 12199.16,-2227.37 12508.84,-2382.51 13714.5,-2286.95 13765.69,-2282.9 13819.86,-2276.7 13872.34,-2269.69"/>
<polygon fill="black" stroke="black" points="13873.03,-2273.13 13882.47,-2268.32 13872.09,-2266.19 13873.03,-2273.13"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge725" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10984.55,-2323.69C10987.55,-2323.43 10990.53,-2323.18 10993.5,-2322.95 11799.78,-2260.39 13826.22,-2349.5 14632.5,-2286.95 14683.7,-2282.98 14737.87,-2276.83 14790.35,-2269.84"/>
<polygon fill="black" stroke="black" points="14791.04,-2273.27 14800.48,-2268.47 14790.1,-2266.34 14791.04,-2273.27"/>
</g>
<!-- l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge726" class="edge">
<title>l1_expert_11_gpu11&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10984.55,-2323.68C10987.55,-2323.42 10990.53,-2323.18 10993.5,-2322.95 12003.24,-2245.61 14540.76,-2364.27 15550.5,-2286.95 15601.7,-2283.03 15655.87,-2276.91 15708.36,-2269.92"/>
<polygon fill="black" stroke="black" points="15709.04,-2273.36 15718.49,-2268.56 15708.11,-2266.42 15709.04,-2273.36"/>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert_11_gpu11 -->
<g id="edge709" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert_11_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12452.7,-2427.8C12449.29,-2427.51 12445.89,-2427.23 12442.5,-2426.95 11803.71,-2375.06 11637.08,-2444.87 10994.53,-2391"/>
<polygon fill="black" stroke="black" points="10994.81,-2387.51 10984.55,-2390.16 10994.22,-2394.49 10994.81,-2387.51"/>
</g>
<!-- l1_expert_agg_gpu11&#45;&gt;l1_res2_gpu11 -->
<g id="edge727" class="edge">
<title>l1_expert_agg_gpu11&#45;&gt;l1_res2_gpu11</title>
<path fill="none" stroke="black" d="M12632.57,-2172.53C12687.01,-2164.82 12743.42,-2157.27 12796.5,-2150.95 12970.49,-2130.23 13167.91,-2112.24 13316.08,-2099.82"/>
<polygon fill="black" stroke="black" points="13316.54,-2103.29 13326.22,-2098.97 13315.96,-2096.32 13316.54,-2103.29"/>
</g>
<!-- l2_mha_qkv_gpu11 -->
<g id="node346" class="node">
<title>l2_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13671,-2010.95 13190,-2010.95 13190,-1942.95 13671,-1942.95 13671,-2010.95"/>
<text text-anchor="middle" x="13430.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13430.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13430.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13430.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu11&#45;&gt;l2_mha_qkv_gpu11 -->
<g id="edge1119" class="edge">
<title>l1_res2_gpu11&#45;&gt;l2_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M13506.81,-2046.84C13496.65,-2037.66 13485.5,-2027.6 13474.95,-2018.08"/>
<polygon fill="black" stroke="black" points="13477.16,-2015.36 13467.39,-2011.25 13472.47,-2020.55 13477.16,-2015.36"/>
</g>
<!-- l2_mha_res_add_gpu11 -->
<g id="node349" class="node">
<title>l2_mha_res_add_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="13781.5,-1698.95 13347.5,-1698.95 13347.5,-1630.95 13781.5,-1630.95 13781.5,-1698.95"/>
<text text-anchor="middle" x="13564.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13564.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13564.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13564.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu11&#45;&gt;l2_mha_res_add_gpu11 -->
<g id="edge1123" class="edge">
<title>l1_res2_gpu11&#45;&gt;l2_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M13642.99,-2046.86C13657.92,-2037.57 13671.35,-2025.8 13680.5,-2010.95 13744.84,-1906.51 13739.06,-1841.06 13677.5,-1734.95 13670.79,-1723.39 13661.29,-1713.52 13650.63,-1705.16"/>
<polygon fill="black" stroke="black" points="13652.41,-1702.13 13642.27,-1699.07 13648.29,-1707.79 13652.41,-1702.13"/>
</g>
<!-- l1_mha_attn_gpu12 -->
<g id="node227" class="node">
<title>l1_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14192,-2874.95 13711,-2874.95 13711,-2806.95 14192,-2806.95 14192,-2874.95"/>
<text text-anchor="middle" x="13951.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13951.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13951.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13951.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu12&#45;&gt;l1_mha_attn_gpu12 -->
<g id="edge730" class="edge">
<title>l1_mha_qkv_gpu12&#45;&gt;l1_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M13951.5,-2910.84C13951.5,-2902.73 13951.5,-2893.94 13951.5,-2885.43"/>
<polygon fill="black" stroke="black" points="13955,-2885.25 13951.5,-2875.25 13948,-2885.25 13955,-2885.25"/>
</g>
<!-- l1_mha_out_gpu12 -->
<g id="node228" class="node">
<title>l1_mha_out_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14189,-2770.95 13720,-2770.95 13720,-2702.95 14189,-2702.95 14189,-2770.95"/>
<text text-anchor="middle" x="13954.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13954.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13954.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13954.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu12&#45;&gt;l1_mha_out_gpu12 -->
<g id="edge731" class="edge">
<title>l1_mha_attn_gpu12&#45;&gt;l1_mha_out_gpu12</title>
<path fill="none" stroke="black" d="M13952.47,-2806.84C13952.71,-2798.73 13952.97,-2789.94 13953.22,-2781.43"/>
<polygon fill="black" stroke="black" points="13956.73,-2781.35 13953.52,-2771.25 13949.73,-2781.15 13956.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu12&#45;&gt;l1_mha_res_add_gpu12 -->
<g id="edge732" class="edge">
<title>l1_mha_out_gpu12&#45;&gt;l1_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M13997.68,-2702.84C14009.88,-2693.48 14023.27,-2683.21 14035.91,-2673.52"/>
<polygon fill="black" stroke="black" points="14038.28,-2676.12 14044.08,-2667.25 14034.02,-2670.56 14038.28,-2676.12"/>
</g>
<!-- l1_expert_12_gpu12 -->
<g id="node230" class="node">
<title>l1_expert_12_gpu12</title>
<polygon fill="lightpink" stroke="black" points="11436.5,-2390.95 11002.5,-2390.95 11002.5,-2322.95 11436.5,-2322.95 11436.5,-2390.95"/>
<text text-anchor="middle" x="11219.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="11219.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11219.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11219.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu12&#45;&gt;l1_expert_12_gpu12 -->
<g id="edge736" class="edge">
<title>l1_mha_res_add_gpu12&#45;&gt;l1_expert_12_gpu12</title>
<path fill="none" stroke="black" d="M13870.44,-2607.93C13753.04,-2593.72 13627.05,-2576 13602.5,-2562.95 13530.53,-2524.71 13553.69,-2460.68 13479.5,-2426.95 13378.82,-2381.19 11635.49,-2399.31 11446.7,-2390.79"/>
<polygon fill="black" stroke="black" points="11446.74,-2387.28 11436.55,-2390.19 11446.33,-2394.27 11446.74,-2387.28"/>
</g>
<!-- l1_gate_gpu12 -->
<g id="node231" class="node">
<title>l1_gate_gpu12</title>
<polygon fill="lightcyan" stroke="black" points="14563.24,-2562.95 13806.44,-2562.95 13611.76,-2426.95 14368.56,-2426.95 14563.24,-2562.95"/>
<text text-anchor="middle" x="14087.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="14087.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14087.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14087.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu12&#45;&gt;l1_gate_gpu12 -->
<g id="edge734" class="edge">
<title>l1_mha_res_add_gpu12&#45;&gt;l1_gate_gpu12</title>
<path fill="none" stroke="black" d="M14087.5,-2598.68C14087.5,-2590.86 14087.5,-2582.19 14087.5,-2573.31"/>
<polygon fill="black" stroke="black" points="14091,-2573.22 14087.5,-2563.22 14084,-2573.22 14091,-2573.22"/>
</g>
<!-- l1_res2_gpu12 -->
<g id="node233" class="node">
<title>l1_res2_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14387.5,-2114.95 13953.5,-2114.95 13953.5,-2046.95 14387.5,-2046.95 14387.5,-2114.95"/>
<text text-anchor="middle" x="14170.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14170.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14170.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14170.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu12&#45;&gt;l1_res2_gpu12 -->
<g id="edge754" class="edge">
<title>l1_mha_res_add_gpu12&#45;&gt;l1_res2_gpu12</title>
<path fill="none" stroke="black" d="M14304.67,-2626.17C14919.05,-2609.81 16625.24,-2564.25 16626.5,-2562.95 16653.84,-2534.86 16646.62,-2189.25 16606.5,-2150.95 16578.34,-2124.08 15244.41,-2116.07 15205.5,-2114.95 14927.47,-2106.95 14607.46,-2096.57 14397.77,-2089.6"/>
<polygon fill="black" stroke="black" points="14397.67,-2086.1 14387.56,-2089.26 14397.44,-2093.09 14397.67,-2086.1"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge737" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11002.45,-2323.66C10999.45,-2323.41 10996.47,-2323.18 10993.5,-2322.95 10074.39,-2254.2 3617.61,-2355.69 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.23,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge738" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11002.45,-2323.67C10999.45,-2323.41 10996.47,-2323.18 10993.5,-2322.95 10176.12,-2261.59 4433.88,-2348.3 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.18 3616.23,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge739" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11002.45,-2323.67C10999.45,-2323.42 10996.47,-2323.18 10993.5,-2322.95 9562.21,-2215 5965.79,-2394.88 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.18 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge740" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11002.45,-2323.67C10999.45,-2323.42 10996.47,-2323.18 10993.5,-2322.95 9765.67,-2229.77 6680.33,-2380.1 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.17 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge741" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11002.45,-2323.68C10999.45,-2323.42 10996.47,-2323.18 10993.5,-2322.95 9969.13,-2244.55 7394.87,-2365.33 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.77,-2283.46 6360.53,-2286.17 6370.22,-2290.44 6370.77,-2283.46"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge742" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11002.45,-2323.69C10999.45,-2323.43 10996.47,-2323.18 10993.5,-2322.95 10172.59,-2259.33 8109.41,-2350.56 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.78,-2283.46 7278.53,-2286.16 7288.22,-2290.44 7288.78,-2283.46"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge743" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11002.45,-2323.7C10999.45,-2323.44 10996.46,-2323.19 10993.5,-2322.95 9758.59,-2225.25 9441.41,-2384.63 8206.5,-2286.95 8206.4,-2286.95 8206.29,-2286.94 8206.19,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.78,-2283.47 8196.53,-2286.14 8206.21,-2290.44 8206.78,-2283.47"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge744" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11002.45,-2323.73C10999.45,-2323.46 10996.46,-2323.2 10993.5,-2322.95 10165.48,-2254.8 9952.52,-2355.09 9124.5,-2286.95 9124.39,-2286.94 9124.29,-2286.94 9124.18,-2286.93"/>
<polygon fill="black" stroke="black" points="9124.49,-2283.44 9114.23,-2286.08 9123.9,-2290.42 9124.49,-2283.44"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge745" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11002.44,-2323.8C10999.44,-2323.51 10996.46,-2323.22 10993.5,-2322.95 10572.3,-2284.34 10463.7,-2325.56 10042.5,-2286.95 10042.39,-2286.94 10042.29,-2286.93 10042.18,-2286.92"/>
<polygon fill="black" stroke="black" points="10042.52,-2283.44 10032.24,-2285.99 10041.87,-2290.41 10042.52,-2283.44"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge746" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11045.23,-2322.94C10990.57,-2312.59 10928.05,-2300.75 10865.33,-2288.87"/>
<polygon fill="black" stroke="black" points="10865.74,-2285.38 10855.26,-2286.96 10864.44,-2292.26 10865.74,-2285.38"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge747" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11268.17,-2322.86C11281.63,-2313.7 11296.8,-2303.39 11312.2,-2292.92"/>
<polygon fill="black" stroke="black" points="11314.47,-2295.61 11320.77,-2287.09 11310.53,-2289.82 11314.47,-2295.61"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge748" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11436.58,-2323.99C11439.57,-2323.64 11442.55,-2323.29 11445.5,-2322.95 11637.36,-2300.99 11686.64,-2308.91 11878.5,-2286.95 11928.48,-2281.23 11981.41,-2274.31 12032.86,-2267.12"/>
<polygon fill="black" stroke="black" points="12033.37,-2270.59 12042.79,-2265.73 12032.4,-2263.65 12033.37,-2270.59"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge749" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11436.55,-2323.76C11439.55,-2323.48 11442.54,-2323.21 11445.5,-2322.95 12043.95,-2271.47 12198.05,-2338.42 12796.5,-2286.95 12847.38,-2282.58 12901.22,-2276.26 12953.42,-2269.23"/>
<polygon fill="black" stroke="black" points="12954.06,-2272.67 12963.5,-2267.86 12953.12,-2265.74 12954.06,-2272.67"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge750" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11436.55,-2323.71C11439.55,-2323.45 11442.54,-2323.19 11445.5,-2322.95 12450.81,-2241.92 12709.19,-2367.96 13714.5,-2286.95 13765.59,-2282.84 13819.65,-2276.63 13872.04,-2269.62"/>
<polygon fill="black" stroke="black" points="13872.71,-2273.06 13882.15,-2268.25 13871.77,-2266.12 13872.71,-2273.06"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge751" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11436.55,-2323.69C11439.55,-2323.43 11442.54,-2323.19 11445.5,-2322.95 12151.61,-2267.66 13926.39,-2342.23 14632.5,-2286.95 14683.69,-2282.95 14737.86,-2276.78 14790.35,-2269.77"/>
<polygon fill="black" stroke="black" points="14791.03,-2273.21 14800.47,-2268.41 14790.1,-2266.28 14791.03,-2273.21"/>
</g>
<!-- l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge752" class="edge">
<title>l1_expert_12_gpu12&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11436.55,-2323.68C11439.55,-2323.43 11442.53,-2323.18 11445.5,-2322.95 12355.06,-2252.89 14640.94,-2357 15550.5,-2286.95 15601.7,-2283.01 15655.87,-2276.87 15708.36,-2269.88"/>
<polygon fill="black" stroke="black" points="15709.04,-2273.32 15718.48,-2268.52 15708.11,-2266.39 15709.04,-2273.32"/>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert_12_gpu12 -->
<g id="edge735" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert_12_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13613.32,-2428.21C13608.02,-2427.77 13602.74,-2427.35 13597.5,-2426.95 12647.08,-2354.29 12400.69,-2467.41 11446.74,-2391.01"/>
<polygon fill="black" stroke="black" points="11446.8,-2387.51 11436.55,-2390.19 11446.24,-2394.48 11446.8,-2387.51"/>
</g>
<!-- l1_expert_agg_gpu12&#45;&gt;l1_res2_gpu12 -->
<g id="edge753" class="edge">
<title>l1_expert_agg_gpu12&#45;&gt;l1_res2_gpu12</title>
<path fill="none" stroke="black" d="M13552.57,-2173.8C13679.34,-2154.96 13824.91,-2133.32 13942.91,-2115.78"/>
<polygon fill="black" stroke="black" points="13943.78,-2119.19 13953.16,-2114.26 13942.75,-2112.27 13943.78,-2119.19"/>
</g>
<!-- l2_mha_qkv_gpu12 -->
<g id="node354" class="node">
<title>l2_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14277,-2010.95 13796,-2010.95 13796,-1942.95 14277,-1942.95 14277,-2010.95"/>
<text text-anchor="middle" x="14036.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14036.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14036.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14036.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu12&#45;&gt;l2_mha_qkv_gpu12 -->
<g id="edge1145" class="edge">
<title>l1_res2_gpu12&#45;&gt;l2_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M14126.99,-2046.84C14114.71,-2037.48 14101.21,-2027.21 14088.48,-2017.52"/>
<polygon fill="black" stroke="black" points="14090.32,-2014.52 14080.25,-2011.25 14086.08,-2020.09 14090.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu12 -->
<g id="node357" class="node">
<title>l2_mha_res_add_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14323.5,-1698.95 13889.5,-1698.95 13889.5,-1630.95 14323.5,-1630.95 14323.5,-1698.95"/>
<text text-anchor="middle" x="14106.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14106.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14106.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14106.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu12&#45;&gt;l2_mha_res_add_gpu12 -->
<g id="edge1149" class="edge">
<title>l1_res2_gpu12&#45;&gt;l2_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M14251.5,-2046.79C14265.51,-2037.33 14278.22,-2025.52 14286.5,-2010.95 14347.14,-1904.32 14354.17,-1835.22 14283.5,-1734.95 14274.93,-1722.8 14263.89,-1712.78 14251.51,-1704.53"/>
<polygon fill="black" stroke="black" points="14253.09,-1701.39 14242.74,-1699.1 14249.4,-1707.34 14253.09,-1701.39"/>
</g>
<!-- l1_mha_attn_gpu13 -->
<g id="node235" class="node">
<title>l1_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15641,-2874.95 15160,-2874.95 15160,-2806.95 15641,-2806.95 15641,-2874.95"/>
<text text-anchor="middle" x="15400.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15400.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15400.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15400.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu13&#45;&gt;l1_mha_attn_gpu13 -->
<g id="edge756" class="edge">
<title>l1_mha_qkv_gpu13&#45;&gt;l1_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M15400.5,-2910.84C15400.5,-2902.73 15400.5,-2893.94 15400.5,-2885.43"/>
<polygon fill="black" stroke="black" points="15404,-2885.25 15400.5,-2875.25 15397,-2885.25 15404,-2885.25"/>
</g>
<!-- l1_mha_out_gpu13 -->
<g id="node236" class="node">
<title>l1_mha_out_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15638,-2770.95 15169,-2770.95 15169,-2702.95 15638,-2702.95 15638,-2770.95"/>
<text text-anchor="middle" x="15403.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15403.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15403.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15403.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu13&#45;&gt;l1_mha_out_gpu13 -->
<g id="edge757" class="edge">
<title>l1_mha_attn_gpu13&#45;&gt;l1_mha_out_gpu13</title>
<path fill="none" stroke="black" d="M15401.47,-2806.84C15401.71,-2798.73 15401.97,-2789.94 15402.22,-2781.43"/>
<polygon fill="black" stroke="black" points="15405.73,-2781.35 15402.52,-2771.25 15398.73,-2781.15 15405.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu13&#45;&gt;l1_mha_res_add_gpu13 -->
<g id="edge758" class="edge">
<title>l1_mha_out_gpu13&#45;&gt;l1_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M15454.8,-2702.84C15469.78,-2693.17 15486.27,-2682.52 15501.73,-2672.54"/>
<polygon fill="black" stroke="black" points="15503.69,-2675.44 15510.19,-2667.08 15499.89,-2669.56 15503.69,-2675.44"/>
</g>
<!-- l1_expert_13_gpu13 -->
<g id="node238" class="node">
<title>l1_expert_13_gpu13</title>
<polygon fill="lightpink" stroke="black" points="11888.5,-2390.95 11454.5,-2390.95 11454.5,-2322.95 11888.5,-2322.95 11888.5,-2390.95"/>
<text text-anchor="middle" x="11671.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11671.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11671.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11671.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu13&#45;&gt;l1_expert_13_gpu13 -->
<g id="edge762" class="edge">
<title>l1_mha_res_add_gpu13&#45;&gt;l1_expert_13_gpu13</title>
<path fill="none" stroke="black" d="M15570.24,-2598.85C15580.16,-2552.78 15589.44,-2470.17 15542.5,-2426.95 15506.15,-2393.48 12116.18,-2394.78 11898.72,-2390.54"/>
<polygon fill="black" stroke="black" points="11898.65,-2387.04 11888.55,-2390.22 11898.43,-2394.03 11898.65,-2387.04"/>
</g>
<!-- l1_gate_gpu13 -->
<g id="node239" class="node">
<title>l1_gate_gpu13</title>
<polygon fill="lightcyan" stroke="black" points="15533.24,-2562.95 14776.44,-2562.95 14581.76,-2426.95 15338.56,-2426.95 15533.24,-2562.95"/>
<text text-anchor="middle" x="15057.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="15057.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15057.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15057.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu13&#45;&gt;l1_gate_gpu13 -->
<g id="edge760" class="edge">
<title>l1_mha_res_add_gpu13&#45;&gt;l1_gate_gpu13</title>
<path fill="none" stroke="black" d="M15439.17,-2598.94C15401.59,-2588.8 15358.72,-2577.23 15315.61,-2565.6"/>
<polygon fill="black" stroke="black" points="15316.39,-2562.19 15305.83,-2562.96 15314.57,-2568.95 15316.39,-2562.19"/>
</g>
<!-- l1_res2_gpu13 -->
<g id="node241" class="node">
<title>l1_res2_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15648.5,-2114.95 15214.5,-2114.95 15214.5,-2046.95 15648.5,-2046.95 15648.5,-2114.95"/>
<text text-anchor="middle" x="15431.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15431.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15431.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15431.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu13&#45;&gt;l1_res2_gpu13 -->
<g id="edge780" class="edge">
<title>l1_mha_res_add_gpu13&#45;&gt;l1_res2_gpu13</title>
<path fill="none" stroke="black" d="M15778.95,-2609.19C15824.05,-2605.17 15871.28,-2601.47 15915.5,-2598.95 15963.18,-2596.24 17601.08,-2597.08 17634.5,-2562.95 17676.79,-2519.77 17671.11,-2475.05 17634.5,-2426.95 17398.82,-2117.33 16299.93,-2137.96 15911.5,-2114.95 15829.04,-2110.07 15738.65,-2104.03 15658.78,-2098.47"/>
<polygon fill="black" stroke="black" points="15658.81,-2094.96 15648.59,-2097.75 15658.32,-2101.94 15658.81,-2094.96"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge763" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11454.45,-2323.66C11451.45,-2323.41 11448.47,-2323.17 11445.5,-2322.95 10476.3,-2250.56 3667.7,-2359.32 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.23,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge764" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11454.45,-2323.66C11451.45,-2323.41 11448.47,-2323.18 11445.5,-2322.95 10578.03,-2257.95 4483.97,-2351.94 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.18 3616.23,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge765" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11454.45,-2323.67C11451.45,-2323.41 11448.47,-2323.18 11445.5,-2322.95 10679.77,-2265.34 5300.24,-2344.55 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.18 4534.22,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge766" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11454.45,-2323.67C11451.45,-2323.42 11448.47,-2323.18 11445.5,-2322.95 10117.49,-2222.5 6780.51,-2387.38 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.17 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge767" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11454.45,-2323.68C11451.45,-2323.42 11448.47,-2323.18 11445.5,-2322.95 10320.95,-2237.27 7495.05,-2372.61 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.77,-2283.46 6360.53,-2286.17 6370.22,-2290.44 6370.77,-2283.46"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge768" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11454.45,-2323.68C11451.45,-2323.42 11448.47,-2323.18 11445.5,-2322.95 10524.41,-2252.05 8209.59,-2357.84 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.77,-2283.46 7278.53,-2286.16 7288.22,-2290.44 7288.77,-2283.46"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge769" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11454.45,-2323.69C11451.45,-2323.43 11448.46,-2323.19 11445.5,-2322.95 10727.87,-2266.83 8924.13,-2343.06 8206.5,-2286.95 8206.4,-2286.95 8206.29,-2286.94 8206.19,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.78,-2283.47 8196.53,-2286.15 8206.21,-2290.44 8206.78,-2283.47"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge770" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11454.45,-2323.71C11451.45,-2323.44 11448.46,-2323.19 11445.5,-2322.95 10417.14,-2240.25 10152.86,-2369.63 9124.5,-2286.95 9124.4,-2286.94 9124.29,-2286.94 9124.19,-2286.93"/>
<polygon fill="black" stroke="black" points="9124.78,-2283.47 9114.53,-2286.13 9124.21,-2290.44 9124.78,-2283.47"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge771" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11454.45,-2323.75C11451.45,-2323.47 11448.46,-2323.21 11445.5,-2322.95 10824.01,-2269.8 10663.99,-2340.1 10042.5,-2286.95 10042.39,-2286.94 10042.29,-2286.94 10042.18,-2286.93"/>
<polygon fill="black" stroke="black" points="10042.5,-2283.44 10032.23,-2286.05 10041.89,-2290.41 10042.5,-2283.44"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge772" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11454.43,-2323.96C11451.43,-2323.61 11448.46,-2323.28 11445.5,-2322.95 11230.65,-2299.32 11175.35,-2310.58 10960.5,-2286.95 10960.39,-2286.94 10960.28,-2286.93 10960.17,-2286.92"/>
<polygon fill="black" stroke="black" points="10960.28,-2283.41 10949.95,-2285.78 10959.5,-2290.36 10960.28,-2283.41"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge773" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11610.18,-2322.86C11592.6,-2313.37 11572.72,-2302.64 11552.6,-2291.78"/>
<polygon fill="black" stroke="black" points="11554.12,-2288.63 11543.65,-2286.96 11550.79,-2294.79 11554.12,-2288.63"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge774" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11833.14,-2322.94C11897.9,-2309.72 11974.54,-2294.07 12048.27,-2279.02"/>
<polygon fill="black" stroke="black" points="12049.08,-2282.42 12058.18,-2276.99 12047.68,-2275.56 12049.08,-2282.42"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge775" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11888.56,-2323.81C11891.56,-2323.51 11894.54,-2323.23 11897.5,-2322.95 12295.67,-2286.01 12398.33,-2323.88 12796.5,-2286.95 12847.16,-2282.25 12900.77,-2275.79 12952.79,-2268.73"/>
<polygon fill="black" stroke="black" points="12953.4,-2272.18 12962.83,-2267.35 12952.45,-2265.24 12953.4,-2272.18"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge776" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11888.55,-2323.73C11891.55,-2323.46 11894.54,-2323.2 11897.5,-2322.95 12702.47,-2256.47 12909.53,-2353.42 13714.5,-2286.95 13765.58,-2282.74 13819.64,-2276.47 13872.03,-2269.44"/>
<polygon fill="black" stroke="black" points="13872.7,-2272.89 13882.14,-2268.08 13871.76,-2265.95 13872.7,-2272.89"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge777" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11888.55,-2323.7C11891.55,-2323.44 11894.54,-2323.19 11897.5,-2322.95 13109.36,-2226.92 13420.64,-2382.96 14632.5,-2286.95 14683.69,-2282.9 14737.86,-2276.71 14790.34,-2269.69"/>
<polygon fill="black" stroke="black" points="14791.03,-2273.13 14800.47,-2268.33 14790.09,-2266.2 14791.03,-2273.13"/>
</g>
<!-- l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge778" class="edge">
<title>l1_expert_13_gpu13&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11888.55,-2323.69C11891.55,-2323.43 11894.53,-2323.18 11897.5,-2322.95 12706.89,-2260.16 14741.11,-2349.73 15550.5,-2286.95 15601.7,-2282.98 15655.87,-2276.83 15708.35,-2269.84"/>
<polygon fill="black" stroke="black" points="15709.04,-2273.28 15718.48,-2268.47 15708.1,-2266.34 15709.04,-2273.28"/>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert_13_gpu13 -->
<g id="edge761" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert_13_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14582.71,-2427.75C14579.29,-2427.47 14575.89,-2427.21 14572.5,-2426.95 13390.21,-2337.68 13084.48,-2484.23 11898.59,-2391"/>
<polygon fill="black" stroke="black" points="11898.79,-2387.5 11888.55,-2390.2 11898.24,-2394.48 11898.79,-2387.5"/>
</g>
<!-- l1_expert_agg_gpu13&#45;&gt;l1_res2_gpu13 -->
<g id="edge779" class="edge">
<title>l1_expert_agg_gpu13&#45;&gt;l1_res2_gpu13</title>
<path fill="none" stroke="black" d="M14468.23,-2172.32C14522.77,-2164.61 14579.3,-2157.13 14632.5,-2150.95 14824.86,-2128.63 15044.05,-2110.19 15204.14,-2098.01"/>
<polygon fill="black" stroke="black" points="15204.41,-2101.5 15214.12,-2097.26 15203.88,-2094.52 15204.41,-2101.5"/>
</g>
<!-- l2_mha_qkv_gpu13 -->
<g id="node362" class="node">
<title>l2_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15629,-2010.95 15148,-2010.95 15148,-1942.95 15629,-1942.95 15629,-2010.95"/>
<text text-anchor="middle" x="15388.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15388.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15388.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15388.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu13&#45;&gt;l2_mha_qkv_gpu13 -->
<g id="edge1171" class="edge">
<title>l1_res2_gpu13&#45;&gt;l2_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M15417.54,-2046.84C15414.01,-2038.46 15410.17,-2029.35 15406.47,-2020.58"/>
<polygon fill="black" stroke="black" points="15409.65,-2019.11 15402.54,-2011.25 15403.2,-2021.83 15409.65,-2019.11"/>
</g>
<!-- l2_mha_res_add_gpu13 -->
<g id="node365" class="node">
<title>l2_mha_res_add_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15797.5,-1698.95 15363.5,-1698.95 15363.5,-1630.95 15797.5,-1630.95 15797.5,-1698.95"/>
<text text-anchor="middle" x="15580.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15580.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15580.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15580.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu13&#45;&gt;l2_mha_res_add_gpu13 -->
<g id="edge1175" class="edge">
<title>l1_res2_gpu13&#45;&gt;l2_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M15597.85,-2046.82C15613.66,-2037.59 15627.76,-2025.86 15638.5,-2010.95 15710.23,-1911.44 15677.67,-1850.15 15635.5,-1734.95 15631.91,-1725.14 15626.33,-1715.66 15620.07,-1707.03"/>
<polygon fill="black" stroke="black" points="15622.78,-1704.82 15613.91,-1699.03 15617.24,-1709.09 15622.78,-1704.82"/>
</g>
<!-- l1_mha_attn_gpu14 -->
<g id="node243" class="node">
<title>l1_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="16272,-2874.95 15791,-2874.95 15791,-2806.95 16272,-2806.95 16272,-2874.95"/>
<text text-anchor="middle" x="16031.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="16031.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16031.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="16031.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu14&#45;&gt;l1_mha_attn_gpu14 -->
<g id="edge782" class="edge">
<title>l1_mha_qkv_gpu14&#45;&gt;l1_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M16031.5,-2910.84C16031.5,-2902.73 16031.5,-2893.94 16031.5,-2885.43"/>
<polygon fill="black" stroke="black" points="16035,-2885.25 16031.5,-2875.25 16028,-2885.25 16035,-2885.25"/>
</g>
<!-- l1_mha_out_gpu14 -->
<g id="node244" class="node">
<title>l1_mha_out_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="16269,-2770.95 15800,-2770.95 15800,-2702.95 16269,-2702.95 16269,-2770.95"/>
<text text-anchor="middle" x="16034.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16034.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16034.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="16034.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu14&#45;&gt;l1_mha_out_gpu14 -->
<g id="edge783" class="edge">
<title>l1_mha_attn_gpu14&#45;&gt;l1_mha_out_gpu14</title>
<path fill="none" stroke="black" d="M16032.47,-2806.84C16032.71,-2798.73 16032.97,-2789.94 16033.22,-2781.43"/>
<polygon fill="black" stroke="black" points="16036.73,-2781.35 16033.52,-2771.25 16029.73,-2781.15 16036.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu14&#45;&gt;l1_mha_res_add_gpu14 -->
<g id="edge784" class="edge">
<title>l1_mha_out_gpu14&#45;&gt;l1_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M16069.24,-2702.84C16078.77,-2693.75 16089.21,-2683.8 16099.12,-2674.35"/>
<polygon fill="black" stroke="black" points="16101.75,-2676.69 16106.57,-2667.25 16096.92,-2671.62 16101.75,-2676.69"/>
</g>
<!-- l1_expert_14_gpu14 -->
<g id="node246" class="node">
<title>l1_expert_14_gpu14</title>
<polygon fill="lightpink" stroke="black" points="12340.5,-2390.95 11906.5,-2390.95 11906.5,-2322.95 12340.5,-2322.95 12340.5,-2390.95"/>
<text text-anchor="middle" x="12123.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12123.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12123.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12123.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu14&#45;&gt;l1_expert_14_gpu14 -->
<g id="edge788" class="edge">
<title>l1_mha_res_add_gpu14&#45;&gt;l1_expert_14_gpu14</title>
<path fill="none" stroke="black" d="M15924.17,-2609.62C15806.22,-2595.98 15679.77,-2578.27 15656.5,-2562.95 15597.35,-2524.02 15635.06,-2461.95 15573.5,-2426.95 15497.28,-2383.61 12565.84,-2397.32 12350.59,-2390.67"/>
<polygon fill="black" stroke="black" points="12350.7,-2387.17 12340.55,-2390.21 12350.38,-2394.17 12350.7,-2387.17"/>
</g>
<!-- l1_gate_gpu14 -->
<g id="node247" class="node">
<title>l1_gate_gpu14</title>
<polygon fill="lightcyan" stroke="black" points="16617.24,-2562.95 15860.44,-2562.95 15665.76,-2426.95 16422.56,-2426.95 16617.24,-2562.95"/>
<text text-anchor="middle" x="16141.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="16141.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16141.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16141.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu14&#45;&gt;l1_gate_gpu14 -->
<g id="edge786" class="edge">
<title>l1_mha_res_add_gpu14&#45;&gt;l1_gate_gpu14</title>
<path fill="none" stroke="black" d="M16141.5,-2598.68C16141.5,-2590.86 16141.5,-2582.19 16141.5,-2573.31"/>
<polygon fill="black" stroke="black" points="16145,-2573.22 16141.5,-2563.22 16138,-2573.22 16145,-2573.22"/>
</g>
<!-- l1_res2_gpu14 -->
<g id="node249" class="node">
<title>l1_res2_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16354.5,-2114.95 15920.5,-2114.95 15920.5,-2046.95 16354.5,-2046.95 16354.5,-2114.95"/>
<text text-anchor="middle" x="16137.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16137.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16137.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16137.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu14&#45;&gt;l1_res2_gpu14 -->
<g id="edge806" class="edge">
<title>l1_mha_res_add_gpu14&#45;&gt;l1_res2_gpu14</title>
<path fill="none" stroke="black" d="M16358.85,-2629.95C16769.63,-2625.1 17623.06,-2609.44 17667.5,-2562.95 17730.76,-2496.77 17730.76,-2217.14 17667.5,-2150.95 17623.28,-2104.69 16779.92,-2088.98 16364.65,-2084.04"/>
<polygon fill="black" stroke="black" points="16364.66,-2080.54 16354.62,-2083.92 16364.58,-2087.54 16364.66,-2080.54"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge789" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11906.45,-2323.66C11903.45,-2323.41 11900.47,-2323.17 11897.5,-2322.95 10878.21,-2246.92 3717.79,-2362.96 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.18 2698.23,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge790" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11906.45,-2323.66C11903.45,-2323.41 11900.47,-2323.18 11897.5,-2322.95 10979.94,-2254.31 4534.06,-2355.57 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.18 3616.23,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge791" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11906.45,-2323.67C11903.45,-2323.41 11900.47,-2323.18 11897.5,-2322.95 11081.68,-2261.7 5350.33,-2348.19 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.18 4534.23,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge792" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11906.45,-2323.67C11903.45,-2323.42 11900.47,-2323.18 11897.5,-2322.95 10469.31,-2215.22 6880.69,-2394.65 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.18 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge793" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11906.45,-2323.67C11903.45,-2323.42 11900.47,-2323.18 11897.5,-2322.95 10672.77,-2230 7595.23,-2379.88 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.77,-2283.46 6360.53,-2286.17 6370.22,-2290.44 6370.77,-2283.46"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge794" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11906.45,-2323.68C11903.45,-2323.42 11900.47,-2323.18 11897.5,-2322.95 10876.23,-2244.77 8309.77,-2365.11 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.77,-2283.46 7278.53,-2286.17 7288.22,-2290.44 7288.77,-2283.46"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge795" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11906.45,-2323.69C11903.45,-2323.43 11900.47,-2323.18 11897.5,-2322.95 11079.69,-2259.55 9024.31,-2350.34 8206.5,-2286.95 8206.4,-2286.95 8206.29,-2286.94 8206.19,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.78,-2283.47 8196.53,-2286.16 8206.22,-2290.44 8206.78,-2283.47"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge796" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11906.45,-2323.7C11903.45,-2323.44 11900.46,-2323.19 11897.5,-2322.95 10668.79,-2225.7 10353.21,-2384.18 9124.5,-2286.95 9124.4,-2286.95 9124.29,-2286.94 9124.19,-2286.93"/>
<polygon fill="black" stroke="black" points="9124.78,-2283.47 9114.53,-2286.14 9124.21,-2290.44 9124.78,-2283.47"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge797" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11906.45,-2323.73C11903.45,-2323.46 11900.46,-2323.2 11897.5,-2322.95 11075.68,-2255.25 10864.32,-2354.64 10042.5,-2286.95 10042.39,-2286.94 10042.29,-2286.94 10042.18,-2286.93"/>
<polygon fill="black" stroke="black" points="10042.49,-2283.44 10032.23,-2286.08 10041.9,-2290.42 10042.49,-2283.44"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge798" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11906.44,-2323.81C11903.44,-2323.51 11900.46,-2323.23 11897.5,-2322.95 11482.5,-2284.79 11375.5,-2325.11 10960.5,-2286.95 10960.39,-2286.94 10960.29,-2286.93 10960.18,-2286.92"/>
<polygon fill="black" stroke="black" points="10960.52,-2283.44 10950.24,-2285.99 10959.87,-2290.41 10960.52,-2283.44"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge799" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11952.63,-2322.94C11899.03,-2312.59 11837.73,-2300.75 11776.24,-2288.87"/>
<polygon fill="black" stroke="black" points="11776.85,-2285.42 11766.37,-2286.96 11775.52,-2292.29 11776.85,-2285.42"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge800" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12175.58,-2322.86C12190.12,-2313.62 12206.51,-2303.2 12223.14,-2292.63"/>
<polygon fill="black" stroke="black" points="12225.29,-2295.41 12231.86,-2287.09 12221.54,-2289.5 12225.29,-2295.41"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge801" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12340.58,-2323.98C12343.57,-2323.63 12346.54,-2323.29 12349.5,-2322.95 12547.55,-2300.54 12598.45,-2309.36 12796.5,-2286.95 12846.49,-2281.3 12899.42,-2274.41 12950.87,-2267.23"/>
<polygon fill="black" stroke="black" points="12951.38,-2270.7 12960.8,-2265.84 12950.41,-2263.76 12951.38,-2270.7"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge802" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12340.55,-2323.76C12343.55,-2323.48 12346.54,-2323.21 12349.5,-2322.95 12954.15,-2271.02 13109.85,-2338.87 13714.5,-2286.95 13765.47,-2282.58 13819.42,-2276.25 13871.72,-2269.2"/>
<polygon fill="black" stroke="black" points="13872.37,-2272.64 13881.81,-2267.83 13871.43,-2265.71 13872.37,-2272.64"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge803" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12340.55,-2323.71C12343.55,-2323.45 12346.54,-2323.19 12349.5,-2322.95 13361.02,-2241.47 13620.98,-2368.41 14632.5,-2286.95 14683.59,-2282.84 14737.65,-2276.63 14790.04,-2269.62"/>
<polygon fill="black" stroke="black" points="14790.71,-2273.06 14800.15,-2268.25 14789.77,-2266.12 14790.71,-2273.06"/>
</g>
<!-- l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge804" class="edge">
<title>l1_expert_14_gpu14&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12340.55,-2323.69C12343.55,-2323.43 12346.54,-2323.19 12349.5,-2322.95 13058.71,-2267.44 14841.29,-2342.45 15550.5,-2286.95 15601.7,-2282.95 15655.86,-2276.78 15708.35,-2269.78"/>
<polygon fill="black" stroke="black" points="15709.03,-2273.22 15718.47,-2268.41 15708.1,-2266.28 15709.03,-2273.22"/>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert_14_gpu14 -->
<g id="edge787" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert_14_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15672.16,-2431.56C15652.36,-2429.83 15632.74,-2428.28 15613.5,-2426.95 14893.1,-2377.44 13089.06,-2446.85 12350.53,-2390.98"/>
<polygon fill="black" stroke="black" points="12350.79,-2387.49 12340.55,-2390.21 12350.25,-2394.47 12350.79,-2387.49"/>
</g>
<!-- l1_expert_agg_gpu14&#45;&gt;l1_res2_gpu14 -->
<g id="edge805" class="edge">
<title>l1_expert_agg_gpu14&#45;&gt;l1_res2_gpu14</title>
<path fill="none" stroke="black" d="M15387.93,-2173.44C15441.98,-2165.68 15497.9,-2157.88 15550.5,-2150.95 15669.01,-2135.34 15801.21,-2119.65 15910.1,-2107.19"/>
<polygon fill="black" stroke="black" points="15910.69,-2110.64 15920.23,-2106.03 15909.89,-2103.69 15910.69,-2110.64"/>
</g>
<!-- l2_mha_qkv_gpu14 -->
<g id="node370" class="node">
<title>l2_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="16244,-2010.95 15763,-2010.95 15763,-1942.95 16244,-1942.95 16244,-2010.95"/>
<text text-anchor="middle" x="16003.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16003.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16003.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16003.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu14&#45;&gt;l2_mha_qkv_gpu14 -->
<g id="edge1197" class="edge">
<title>l1_res2_gpu14&#45;&gt;l2_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M16093.99,-2046.84C16081.71,-2037.48 16068.21,-2027.21 16055.48,-2017.52"/>
<polygon fill="black" stroke="black" points="16057.32,-2014.52 16047.25,-2011.25 16053.08,-2020.09 16057.32,-2014.52"/>
</g>
<!-- l2_mha_res_add_gpu14 -->
<g id="node373" class="node">
<title>l2_mha_res_add_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16377.5,-1698.95 15943.5,-1698.95 15943.5,-1630.95 16377.5,-1630.95 16377.5,-1698.95"/>
<text text-anchor="middle" x="16160.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16160.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16160.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16160.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu14&#45;&gt;l2_mha_res_add_gpu14 -->
<g id="edge1201" class="edge">
<title>l1_res2_gpu14&#45;&gt;l2_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M16218.5,-2046.79C16232.51,-2037.33 16245.22,-2025.52 16253.5,-2010.95 16314.14,-1904.32 16306.36,-1844.17 16250.5,-1734.95 16244.84,-1723.89 16236.5,-1714.08 16227.14,-1705.59"/>
<polygon fill="black" stroke="black" points="16229.34,-1702.87 16219.46,-1699.07 16224.81,-1708.21 16229.34,-1702.87"/>
</g>
<!-- l1_mha_attn_gpu15 -->
<g id="node251" class="node">
<title>l1_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17664,-2874.95 17183,-2874.95 17183,-2806.95 17664,-2806.95 17664,-2874.95"/>
<text text-anchor="middle" x="17423.5" y="-2859.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="17423.5" y="-2844.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17423.5" y="-2829.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="17423.5" y="-2814.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_mha_qkv_gpu15&#45;&gt;l1_mha_attn_gpu15 -->
<g id="edge808" class="edge">
<title>l1_mha_qkv_gpu15&#45;&gt;l1_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M17423.5,-2910.84C17423.5,-2902.73 17423.5,-2893.94 17423.5,-2885.43"/>
<polygon fill="black" stroke="black" points="17427,-2885.25 17423.5,-2875.25 17420,-2885.25 17427,-2885.25"/>
</g>
<!-- l1_mha_out_gpu15 -->
<g id="node252" class="node">
<title>l1_mha_out_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17661,-2770.95 17192,-2770.95 17192,-2702.95 17661,-2702.95 17661,-2770.95"/>
<text text-anchor="middle" x="17426.5" y="-2755.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17426.5" y="-2740.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17426.5" y="-2725.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="17426.5" y="-2710.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_attn_gpu15&#45;&gt;l1_mha_out_gpu15 -->
<g id="edge809" class="edge">
<title>l1_mha_attn_gpu15&#45;&gt;l1_mha_out_gpu15</title>
<path fill="none" stroke="black" d="M17424.47,-2806.84C17424.71,-2798.73 17424.97,-2789.94 17425.22,-2781.43"/>
<polygon fill="black" stroke="black" points="17428.73,-2781.35 17425.52,-2771.25 17421.73,-2781.15 17428.73,-2781.35"/>
</g>
<!-- l1_mha_out_gpu15&#45;&gt;l1_mha_res_add_gpu15 -->
<g id="edge810" class="edge">
<title>l1_mha_out_gpu15&#45;&gt;l1_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M17512.54,-2702.84C17539.17,-2692.59 17568.67,-2681.23 17595.91,-2670.75"/>
<polygon fill="black" stroke="black" points="17597.37,-2673.94 17605.44,-2667.08 17594.85,-2667.4 17597.37,-2673.94"/>
</g>
<!-- l1_expert_15_gpu15 -->
<g id="node254" class="node">
<title>l1_expert_15_gpu15</title>
<polygon fill="lightpink" stroke="black" points="12792.5,-2390.95 12358.5,-2390.95 12358.5,-2322.95 12792.5,-2322.95 12792.5,-2390.95"/>
<text text-anchor="middle" x="12575.5" y="-2375.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12575.5" y="-2360.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12575.5" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12575.5" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu15&#45;&gt;l1_expert_15_gpu15 -->
<g id="edge814" class="edge">
<title>l1_mha_res_add_gpu15&#45;&gt;l1_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M17693.34,-2598.82C17693.91,-2551.93 17687.02,-2467.43 17634.5,-2426.95 17586.01,-2389.58 13781.46,-2364.95 12802.93,-2359.23"/>
<polygon fill="black" stroke="black" points="12802.63,-2355.73 12792.61,-2359.17 12802.59,-2362.73 12802.63,-2355.73"/>
</g>
<!-- l1_gate_gpu15 -->
<g id="node255" class="node">
<title>l1_gate_gpu15</title>
<polygon fill="lightcyan" stroke="black" points="17625.24,-2562.95 16868.44,-2562.95 16673.76,-2426.95 17430.56,-2426.95 17625.24,-2562.95"/>
<text text-anchor="middle" x="17149.5" y="-2513.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="17149.5" y="-2498.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17149.5" y="-2483.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17149.5" y="-2468.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l1_mha_res_add_gpu15&#45;&gt;l1_gate_gpu15 -->
<g id="edge812" class="edge">
<title>l1_mha_res_add_gpu15&#45;&gt;l1_gate_gpu15</title>
<path fill="none" stroke="black" d="M17559.95,-2598.94C17519.36,-2588.76 17473.04,-2577.14 17426.48,-2565.45"/>
<polygon fill="black" stroke="black" points="17427.1,-2562 17416.55,-2562.96 17425.4,-2568.79 17427.1,-2562"/>
</g>
<!-- l1_res2_gpu15 -->
<g id="node257" class="node">
<title>l1_res2_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17871.5,-2114.95 17437.5,-2114.95 17437.5,-2046.95 17871.5,-2046.95 17871.5,-2114.95"/>
<text text-anchor="middle" x="17654.5" y="-2099.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17654.5" y="-2084.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17654.5" y="-2069.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17654.5" y="-2054.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_mha_res_add_gpu15&#45;&gt;l1_res2_gpu15 -->
<g id="edge832" class="edge">
<title>l1_mha_res_add_gpu15&#45;&gt;l1_res2_gpu15</title>
<path fill="none" stroke="black" d="M17700.78,-2598.9C17721.55,-2518.64 17765.22,-2308.49 17702.5,-2150.95 17698.78,-2141.6 17693.57,-2132.27 17687.96,-2123.64"/>
<polygon fill="black" stroke="black" points="17690.77,-2121.56 17682.24,-2115.27 17684.99,-2125.5 17690.77,-2121.56"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge815" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M12358.45,-2323.66C12355.45,-2323.41 12352.47,-2323.17 12349.5,-2322.95 11280.12,-2243.29 3767.88,-2366.6 2698.5,-2286.95 2698.4,-2286.95 2698.29,-2286.94 2698.19,-2286.93"/>
<polygon fill="black" stroke="black" points="2698.77,-2283.46 2688.53,-2286.19 2698.23,-2290.44 2698.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge816" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M12358.45,-2323.66C12355.45,-2323.41 12352.47,-2323.17 12349.5,-2322.95 11381.85,-2250.67 4584.15,-2359.21 3616.5,-2286.95 3616.4,-2286.95 3616.29,-2286.94 3616.19,-2286.93"/>
<polygon fill="black" stroke="black" points="3616.77,-2283.46 3606.53,-2286.18 3616.23,-2290.44 3616.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge817" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M12358.45,-2323.66C12355.45,-2323.41 12352.47,-2323.18 12349.5,-2322.95 11483.59,-2258.06 5400.42,-2351.82 4534.5,-2286.95 4534.4,-2286.95 4534.29,-2286.94 4534.19,-2286.93"/>
<polygon fill="black" stroke="black" points="4534.77,-2283.46 4524.53,-2286.18 4534.23,-2290.44 4534.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge818" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12358.45,-2323.67C12355.45,-2323.41 12352.47,-2323.18 12349.5,-2322.95 11585.32,-2265.45 6216.68,-2344.44 5452.5,-2286.95 5452.4,-2286.95 5452.29,-2286.94 5452.19,-2286.93"/>
<polygon fill="black" stroke="black" points="5452.77,-2283.46 5442.53,-2286.18 5452.22,-2290.44 5452.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge819" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M12358.45,-2323.67C12355.45,-2323.42 12352.47,-2323.18 12349.5,-2322.95 11024.6,-2222.72 7695.41,-2387.15 6370.5,-2286.95 6370.4,-2286.95 6370.29,-2286.94 6370.19,-2286.93"/>
<polygon fill="black" stroke="black" points="6370.77,-2283.46 6360.53,-2286.17 6370.22,-2290.44 6370.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge820" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M12358.45,-2323.68C12355.45,-2323.42 12352.47,-2323.18 12349.5,-2322.95 11228.06,-2237.5 8409.95,-2372.38 7288.5,-2286.95 7288.4,-2286.95 7288.29,-2286.94 7288.19,-2286.93"/>
<polygon fill="black" stroke="black" points="7288.77,-2283.46 7278.53,-2286.17 7288.22,-2290.44 7288.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge821" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M12358.45,-2323.68C12355.45,-2323.42 12352.47,-2323.18 12349.5,-2322.95 11431.52,-2252.28 9124.49,-2357.61 8206.5,-2286.95 8206.4,-2286.95 8206.29,-2286.94 8206.19,-2286.93"/>
<polygon fill="black" stroke="black" points="8206.77,-2283.46 8196.53,-2286.16 8206.22,-2290.44 8206.77,-2283.46"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge822" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M12358.45,-2323.69C12355.45,-2323.43 12352.46,-2323.19 12349.5,-2322.95 11634.97,-2267.05 9839.03,-2342.84 9124.5,-2286.95 9124.4,-2286.95 9124.29,-2286.94 9124.19,-2286.93"/>
<polygon fill="black" stroke="black" points="9124.78,-2283.47 9114.53,-2286.15 9124.21,-2290.44 9124.78,-2283.47"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge823" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M12358.45,-2323.71C12355.45,-2323.44 12352.46,-2323.19 12349.5,-2322.95 11327.35,-2240.7 11064.66,-2369.18 10042.5,-2286.95 10042.4,-2286.94 10042.29,-2286.94 10042.19,-2286.93"/>
<polygon fill="black" stroke="black" points="10042.78,-2283.47 10032.53,-2286.13 10042.21,-2290.44 10042.78,-2283.47"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge824" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M12358.45,-2323.75C12355.45,-2323.47 12352.46,-2323.21 12349.5,-2322.95 11734.21,-2270.25 11575.79,-2339.65 10960.5,-2286.95 10960.39,-2286.94 10960.29,-2286.94 10960.18,-2286.93"/>
<polygon fill="black" stroke="black" points="10960.5,-2283.44 10950.23,-2286.05 10959.89,-2290.41 10960.5,-2283.44"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge825" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M12358.43,-2323.96C12355.43,-2323.62 12352.46,-2323.28 12349.5,-2322.95 12140.84,-2299.77 12087.16,-2310.13 11878.5,-2286.95 11878.39,-2286.94 11878.28,-2286.93 11878.17,-2286.92"/>
<polygon fill="black" stroke="black" points="11878.28,-2283.41 11867.95,-2285.77 11877.5,-2290.36 11878.28,-2283.41"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge826" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12517.58,-2322.86C12501.19,-2313.49 12482.68,-2302.91 12463.92,-2292.19"/>
<polygon fill="black" stroke="black" points="12465.41,-2289.01 12454.99,-2287.09 12461.94,-2295.09 12465.41,-2289.01"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge827" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12740.54,-2322.94C12808.02,-2309.45 12888.14,-2293.43 12964.83,-2278.09"/>
<polygon fill="black" stroke="black" points="12965.53,-2281.52 12974.65,-2276.12 12964.16,-2274.65 12965.53,-2281.52"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge828" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12792.71,-2348.25C13022.22,-2338.84 13394.52,-2319.94 13714.5,-2286.95 13764.83,-2281.77 13818.1,-2275.09 13869.84,-2267.97"/>
<polygon fill="black" stroke="black" points="13870.39,-2271.42 13879.82,-2266.58 13869.43,-2264.49 13870.39,-2271.42"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge829" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12792.67,-2346.87C12962.7,-2339.9 13205.14,-2330.26 13417.5,-2322.95 13957.42,-2304.37 14094.32,-2334.05 14632.5,-2286.95 14683.37,-2282.5 14737.21,-2276.14 14789.41,-2269.1"/>
<polygon fill="black" stroke="black" points="14790.05,-2272.54 14799.49,-2267.73 14789.1,-2265.61 14790.05,-2272.54"/>
</g>
<!-- l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge830" class="edge">
<title>l1_expert_15_gpu15&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12792.65,-2346.11C12962.66,-2338.73 13205.09,-2328.91 13417.5,-2322.95 13891.38,-2309.67 15077.98,-2325.27 15550.5,-2286.95 15601.59,-2282.81 15655.65,-2276.59 15708.04,-2269.57"/>
<polygon fill="black" stroke="black" points="15708.71,-2273.01 15718.15,-2268.21 15707.77,-2266.08 15708.71,-2273.01"/>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert_15_gpu15 -->
<g id="edge813" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert_15_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16679.67,-2431.26C16661.73,-2429.67 16643.96,-2428.22 16626.5,-2426.95 15874.72,-2372.56 13542.56,-2360.88 12802.96,-2358.52"/>
<polygon fill="black" stroke="black" points="12802.74,-2355.02 12792.73,-2358.49 12802.72,-2362.02 12802.74,-2355.02"/>
</g>
<!-- l1_expert_agg_gpu15&#45;&gt;l1_res2_gpu15 -->
<g id="edge831" class="edge">
<title>l1_expert_agg_gpu15&#45;&gt;l1_res2_gpu15</title>
<path fill="none" stroke="black" d="M16330.58,-2191.41C16653.3,-2164.73 17142.57,-2124.28 17427.18,-2100.75"/>
<polygon fill="black" stroke="black" points="17427.54,-2104.23 17437.22,-2099.92 17426.96,-2097.25 17427.54,-2104.23"/>
</g>
<!-- l2_mha_qkv_gpu15 -->
<g id="node378" class="node">
<title>l2_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17815,-2010.95 17334,-2010.95 17334,-1942.95 17815,-1942.95 17815,-2010.95"/>
<text text-anchor="middle" x="17574.5" y="-1995.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17574.5" y="-1980.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17574.5" y="-1965.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17574.5" y="-1950.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l1_res2_gpu15&#45;&gt;l2_mha_qkv_gpu15 -->
<g id="edge1223" class="edge">
<title>l1_res2_gpu15&#45;&gt;l2_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M17628.53,-2046.84C17621.61,-2038.02 17614.05,-2028.38 17606.84,-2019.19"/>
<polygon fill="black" stroke="black" points="17609.54,-2016.96 17600.62,-2011.25 17604.03,-2021.28 17609.54,-2016.96"/>
</g>
<!-- l2_mha_res_add_gpu15 -->
<g id="node381" class="node">
<title>l2_mha_res_add_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17927.5,-1698.95 17493.5,-1698.95 17493.5,-1630.95 17927.5,-1630.95 17927.5,-1698.95"/>
<text text-anchor="middle" x="17710.5" y="-1683.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17710.5" y="-1668.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17710.5" y="-1653.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17710.5" y="-1638.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l1_res2_gpu15&#45;&gt;l2_mha_res_add_gpu15 -->
<g id="edge1227" class="edge">
<title>l1_res2_gpu15&#45;&gt;l2_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M17785,-2046.75C17800.55,-2037.58 17814.45,-2025.88 17824.5,-2010.95 17893.02,-1909.2 17882.64,-1841.31 17821.5,-1734.95 17814.88,-1723.43 17805.47,-1713.57 17794.91,-1705.21"/>
<polygon fill="black" stroke="black" points="17796.76,-1702.23 17786.63,-1699.11 17792.61,-1707.86 17796.76,-1702.23"/>
</g>
<!-- l2_mha_attn_gpu0 -->
<g id="node259" class="node">
<title>l2_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="621,-1906.95 140,-1906.95 140,-1838.95 621,-1838.95 621,-1906.95"/>
<text text-anchor="middle" x="380.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="380.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="380.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="380.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu0&#45;&gt;l2_mha_attn_gpu0 -->
<g id="edge834" class="edge">
<title>l2_mha_qkv_gpu0&#45;&gt;l2_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M380.5,-1942.84C380.5,-1934.73 380.5,-1925.94 380.5,-1917.43"/>
<polygon fill="black" stroke="black" points="384,-1917.25 380.5,-1907.25 377,-1917.25 384,-1917.25"/>
</g>
<!-- l2_mha_out_gpu0 -->
<g id="node260" class="node">
<title>l2_mha_out_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="618,-1802.95 149,-1802.95 149,-1734.95 618,-1734.95 618,-1802.95"/>
<text text-anchor="middle" x="383.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="383.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="383.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="383.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu0&#45;&gt;l2_mha_out_gpu0 -->
<g id="edge835" class="edge">
<title>l2_mha_attn_gpu0&#45;&gt;l2_mha_out_gpu0</title>
<path fill="none" stroke="black" d="M381.47,-1838.84C381.71,-1830.73 381.97,-1821.94 382.22,-1813.43"/>
<polygon fill="black" stroke="black" points="385.73,-1813.35 382.52,-1803.25 378.73,-1813.15 385.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu0&#45;&gt;l2_mha_res_add_gpu0 -->
<g id="edge836" class="edge">
<title>l2_mha_out_gpu0&#45;&gt;l2_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M426.68,-1734.84C438.88,-1725.48 452.27,-1715.21 464.91,-1705.52"/>
<polygon fill="black" stroke="black" points="467.28,-1708.12 473.08,-1699.25 463.02,-1702.56 467.28,-1708.12"/>
</g>
<!-- l2_expert_0_gpu0 -->
<g id="node262" class="node">
<title>l2_expert_0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="6031.5,-1422.95 5597.5,-1422.95 5597.5,-1354.95 6031.5,-1354.95 6031.5,-1422.95"/>
<text text-anchor="middle" x="5814.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5814.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5814.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5814.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu0&#45;&gt;l2_expert_0_gpu0 -->
<g id="edge840" class="edge">
<title>l2_mha_res_add_gpu0&#45;&gt;l2_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M514.66,-1630.82C514.08,-1583.92 520.97,-1499.42 573.5,-1458.95 623.89,-1420.14 4587.07,-1396.48 5587.26,-1391.12"/>
<polygon fill="black" stroke="black" points="5587.47,-1394.62 5597.45,-1391.07 5587.43,-1387.62 5587.47,-1394.62"/>
</g>
<!-- l2_gate_gpu0 -->
<g id="node263" class="node">
<title>l2_gate_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="1534.24,-1594.95 777.44,-1594.95 582.76,-1458.95 1339.56,-1458.95 1534.24,-1594.95"/>
<text text-anchor="middle" x="1058.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1058.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1058.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1058.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu0&#45;&gt;l2_gate_gpu0 -->
<g id="edge838" class="edge">
<title>l2_mha_res_add_gpu0&#45;&gt;l2_gate_gpu0</title>
<path fill="none" stroke="black" d="M648.05,-1630.94C688.64,-1620.76 734.96,-1609.14 781.52,-1597.45"/>
<polygon fill="black" stroke="black" points="782.6,-1600.79 791.45,-1594.96 780.9,-1594 782.6,-1600.79"/>
</g>
<!-- l2_res2_gpu0 -->
<g id="node265" class="node">
<title>l2_res2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="659.5,-1146.95 225.5,-1146.95 225.5,-1078.95 659.5,-1078.95 659.5,-1146.95"/>
<text text-anchor="middle" x="442.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="442.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="442.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="442.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu0&#45;&gt;l2_res2_gpu0 -->
<g id="edge858" class="edge">
<title>l2_mha_res_add_gpu0&#45;&gt;l2_res2_gpu0</title>
<path fill="none" stroke="black" d="M485.31,-1630.92C477.03,-1620.23 469.13,-1607.8 464.5,-1594.95 409.3,-1441.73 425.38,-1243.13 436.21,-1156.97"/>
<polygon fill="black" stroke="black" points="439.69,-1157.4 437.5,-1147.03 432.75,-1156.5 439.69,-1157.4"/>
</g>
<!-- l2_expert_agg_gpu0 -->
<g id="node264" class="node">
<title>l2_expert_agg_gpu0</title>
<polygon fill="yellow" stroke="black" points="2677.4,-1318.95 1961.71,-1318.95 1777.6,-1182.95 2493.29,-1182.95 2677.4,-1318.95"/>
<text text-anchor="middle" x="2227.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2227.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2227.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2227.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge841" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5597.41,-1386.64C4985.27,-1382.38 3253.17,-1366.38 2686.5,-1318.95 2686.39,-1318.94 2686.29,-1318.94 2686.18,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.49,-1315.44 2676.23,-1318.07 2685.89,-1322.41 2686.49,-1315.44"/>
</g>
<!-- l2_expert_agg_gpu1 -->
<g id="node272" class="node">
<title>l2_expert_agg_gpu1</title>
<polygon fill="yellow" stroke="black" points="3595.4,-1318.95 2879.71,-1318.95 2695.6,-1182.95 3411.29,-1182.95 3595.4,-1318.95"/>
<text text-anchor="middle" x="3145.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3145.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3145.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3145.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge842" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5597.06,-1384.32C5118.54,-1375.8 3986.52,-1352.69 3604.5,-1318.95 3604.39,-1318.94 3604.29,-1318.93 3604.18,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.51,-1315.44 3594.23,-1318.03 3603.88,-1322.41 3604.51,-1315.44"/>
</g>
<!-- l2_expert_agg_gpu2 -->
<g id="node280" class="node">
<title>l2_expert_agg_gpu2</title>
<polygon fill="yellow" stroke="black" points="4513.4,-1318.95 3797.71,-1318.95 3613.6,-1182.95 4329.29,-1182.95 4513.4,-1318.95"/>
<text text-anchor="middle" x="4063.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4063.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4063.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4063.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge843" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5597.44,-1382.43C5340.35,-1374.48 4899.41,-1356.45 4522.5,-1318.95 4522.39,-1318.94 4522.29,-1318.93 4522.18,-1318.92"/>
<polygon fill="black" stroke="black" points="4522.55,-1315.44 4512.24,-1317.92 4521.84,-1322.41 4522.55,-1315.44"/>
</g>
<!-- l2_expert_agg_gpu3 -->
<g id="node288" class="node">
<title>l2_expert_agg_gpu3</title>
<polygon fill="yellow" stroke="black" points="5431.4,-1318.95 4715.71,-1318.95 4531.6,-1182.95 5247.29,-1182.95 5431.4,-1318.95"/>
<text text-anchor="middle" x="4981.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4981.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4981.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4981.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge844" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5612.32,-1354.94C5548.38,-1344.51 5475.17,-1332.55 5401.81,-1320.58"/>
<polygon fill="black" stroke="black" points="5402.36,-1317.12 5391.93,-1318.96 5401.23,-1324.03 5402.36,-1317.12"/>
</g>
<!-- l2_expert_agg_gpu4 -->
<g id="node296" class="node">
<title>l2_expert_agg_gpu4</title>
<polygon fill="yellow" stroke="black" points="6349.4,-1318.95 5633.71,-1318.95 5449.6,-1182.95 6165.29,-1182.95 6349.4,-1318.95"/>
<text text-anchor="middle" x="5899.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5899.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5899.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5899.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge845" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5835.29,-1354.68C5840.45,-1346.44 5846.19,-1337.26 5852.05,-1327.87"/>
<polygon fill="black" stroke="black" points="5855.13,-1329.55 5857.46,-1319.22 5849.19,-1325.84 5855.13,-1329.55"/>
</g>
<!-- l2_expert_agg_gpu5 -->
<g id="node304" class="node">
<title>l2_expert_agg_gpu5</title>
<polygon fill="yellow" stroke="black" points="7267.4,-1318.95 6551.71,-1318.95 6367.6,-1182.95 7083.29,-1182.95 7267.4,-1318.95"/>
<text text-anchor="middle" x="6817.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6817.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6817.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6817.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge846" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6031.59,-1356.12C6034.58,-1355.72 6037.55,-1355.34 6040.5,-1354.95 6181.56,-1336.68 6217.44,-1337.23 6358.5,-1318.95 6407.92,-1312.55 6460.26,-1305.33 6511.23,-1298.06"/>
<polygon fill="black" stroke="black" points="6512,-1301.48 6521.4,-1296.6 6511.01,-1294.56 6512,-1301.48"/>
</g>
<!-- l2_expert_agg_gpu6 -->
<g id="node312" class="node">
<title>l2_expert_agg_gpu6</title>
<polygon fill="yellow" stroke="black" points="8185.4,-1318.95 7469.71,-1318.95 7285.6,-1182.95 8001.29,-1182.95 8185.4,-1318.95"/>
<text text-anchor="middle" x="7735.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7735.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7735.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7735.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge847" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6031.55,-1355.77C6034.55,-1355.48 6037.54,-1355.21 6040.5,-1354.95 6587.99,-1307.17 6729.01,-1366.72 7276.5,-1318.95 7327.37,-1314.51 7381.21,-1308.16 7433.41,-1301.12"/>
<polygon fill="black" stroke="black" points="7434.05,-1304.57 7443.49,-1299.75 7433.11,-1297.63 7434.05,-1304.57"/>
</g>
<!-- l2_expert_agg_gpu7 -->
<g id="node320" class="node">
<title>l2_expert_agg_gpu7</title>
<polygon fill="yellow" stroke="black" points="9103.4,-1318.95 8387.71,-1318.95 8203.6,-1182.95 8919.29,-1182.95 9103.4,-1318.95"/>
<text text-anchor="middle" x="8653.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8653.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8653.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8653.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge848" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6031.55,-1355.72C6034.55,-1355.45 6037.54,-1355.19 6040.5,-1354.95 6994.84,-1277.62 7240.16,-1396.26 8194.5,-1318.95 8245.59,-1314.81 8299.65,-1308.59 8352.04,-1301.58"/>
<polygon fill="black" stroke="black" points="8352.71,-1305.02 8362.15,-1300.21 8351.77,-1298.08 8352.71,-1305.02"/>
</g>
<!-- l2_expert_agg_gpu8 -->
<g id="node328" class="node">
<title>l2_expert_agg_gpu8</title>
<polygon fill="yellow" stroke="black" points="10021.4,-1318.95 9305.71,-1318.95 9121.6,-1182.95 9837.29,-1182.95 10021.4,-1318.95"/>
<text text-anchor="middle" x="9571.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9571.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9571.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9571.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge849" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6031.55,-1355.69C6034.55,-1355.43 6037.54,-1355.19 6040.5,-1354.95 7401.74,-1248.07 7751.26,-1425.8 9112.5,-1318.95 9163.69,-1314.93 9217.86,-1308.76 9270.35,-1301.76"/>
<polygon fill="black" stroke="black" points="9271.03,-1305.2 9280.47,-1300.39 9270.1,-1298.26 9271.03,-1305.2"/>
</g>
<!-- l2_expert_agg_gpu9 -->
<g id="node336" class="node">
<title>l2_expert_agg_gpu9</title>
<polygon fill="yellow" stroke="black" points="10939.4,-1318.95 10223.71,-1318.95 10039.6,-1182.95 10755.29,-1182.95 10939.4,-1318.95"/>
<text text-anchor="middle" x="10489.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10489.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10489.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10489.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge850" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6031.55,-1355.68C6034.55,-1355.43 6037.53,-1355.18 6040.5,-1354.95 6924.57,-1286.74 9146.42,-1387.15 10030.5,-1318.95 10081.7,-1315 10135.87,-1308.87 10188.36,-1301.87"/>
<polygon fill="black" stroke="black" points="10189.04,-1305.31 10198.48,-1300.51 10188.1,-1298.38 10189.04,-1305.31"/>
</g>
<!-- l2_expert_agg_gpu10 -->
<g id="node344" class="node">
<title>l2_expert_agg_gpu10</title>
<polygon fill="yellow" stroke="black" points="11857.4,-1318.95 11141.71,-1318.95 10957.6,-1182.95 11673.29,-1182.95 11857.4,-1318.95"/>
<text text-anchor="middle" x="11407.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11407.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11407.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11407.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge851" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6031.55,-1355.68C6034.55,-1355.42 6037.53,-1355.18 6040.5,-1354.95 7128.03,-1271.96 9860.96,-1401.92 10948.5,-1318.95 10999.7,-1315.05 11053.88,-1308.93 11106.36,-1301.95"/>
<polygon fill="black" stroke="black" points="11107.04,-1305.39 11116.49,-1300.58 11106.11,-1298.45 11107.04,-1305.39"/>
</g>
<!-- l2_expert_agg_gpu11 -->
<g id="node352" class="node">
<title>l2_expert_agg_gpu11</title>
<polygon fill="yellow" stroke="black" points="12775.4,-1318.95 12059.71,-1318.95 11875.6,-1182.95 12591.29,-1182.95 12775.4,-1318.95"/>
<text text-anchor="middle" x="12325.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12325.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12325.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12325.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge852" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6031.55,-1355.67C6034.55,-1355.42 6037.53,-1355.18 6040.5,-1354.95 7331.49,-1257.19 10575.5,-1416.69 11866.5,-1318.95 11917.8,-1315.07 11972.08,-1308.95 12024.66,-1301.96"/>
<polygon fill="black" stroke="black" points="12025.35,-1305.4 12034.8,-1300.59 12024.42,-1298.46 12025.35,-1305.4"/>
</g>
<!-- l2_expert_agg_gpu12 -->
<g id="node360" class="node">
<title>l2_expert_agg_gpu12</title>
<polygon fill="yellow" stroke="black" points="13693.4,-1318.95 12977.71,-1318.95 12793.6,-1182.95 13509.29,-1182.95 13693.4,-1318.95"/>
<text text-anchor="middle" x="13243.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13243.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13243.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13243.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge853" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6031.55,-1355.67C6034.55,-1355.42 6037.53,-1355.18 6040.5,-1354.95 6787.73,-1298.68 12037.27,-1375.21 12784.5,-1318.95 12835.8,-1315.09 12890.08,-1308.98 12942.66,-1301.99"/>
<polygon fill="black" stroke="black" points="12943.36,-1305.43 12952.8,-1300.63 12942.42,-1298.49 12943.36,-1305.43"/>
</g>
<!-- l2_expert_agg_gpu13 -->
<g id="node368" class="node">
<title>l2_expert_agg_gpu13</title>
<polygon fill="yellow" stroke="black" points="14611.4,-1318.95 13895.71,-1318.95 13711.6,-1182.95 14427.29,-1182.95 14611.4,-1318.95"/>
<text text-anchor="middle" x="14161.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14161.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14161.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14161.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge854" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6031.55,-1355.67C6034.55,-1355.41 6037.53,-1355.18 6040.5,-1354.95 6889.46,-1291.29 12853.54,-1382.59 13702.5,-1318.95 13753.8,-1315.11 13808.08,-1309.01 13860.66,-1302.02"/>
<polygon fill="black" stroke="black" points="13861.36,-1305.46 13870.8,-1300.66 13860.43,-1298.52 13861.36,-1305.46"/>
</g>
<!-- l2_expert_agg_gpu14 -->
<g id="node376" class="node">
<title>l2_expert_agg_gpu14</title>
<polygon fill="yellow" stroke="black" points="15529.4,-1318.95 14813.71,-1318.95 14629.6,-1182.95 15345.29,-1182.95 15529.4,-1318.95"/>
<text text-anchor="middle" x="15079.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15079.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15079.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15079.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge855" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6031.55,-1355.66C6034.55,-1355.41 6037.53,-1355.17 6040.5,-1354.95 6991.19,-1283.91 13669.81,-1389.98 14620.5,-1318.95 14671.8,-1315.12 14726.08,-1309.03 14778.66,-1302.04"/>
<polygon fill="black" stroke="black" points="14779.36,-1305.48 14788.81,-1300.68 14778.43,-1298.54 14779.36,-1305.48"/>
</g>
<!-- l2_expert_agg_gpu15 -->
<g id="node384" class="node">
<title>l2_expert_agg_gpu15</title>
<polygon fill="yellow" stroke="black" points="16447.4,-1318.95 15731.71,-1318.95 15547.6,-1182.95 16263.29,-1182.95 16447.4,-1318.95"/>
<text text-anchor="middle" x="15997.5" y="-1269.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15997.5" y="-1254.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="15997.5" y="-1239.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15997.5" y="-1224.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge856" class="edge">
<title>l2_expert_0_gpu0&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6031.55,-1355.66C6034.55,-1355.41 6037.53,-1355.17 6040.5,-1354.95 7092.92,-1276.52 14486.08,-1397.36 15538.5,-1318.95 15589.8,-1315.13 15644.09,-1309.04 15696.66,-1302.06"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.5 15706.81,-1300.7 15696.43,-1298.56 15697.36,-1305.5"/>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert_0_gpu0 -->
<g id="edge839" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1370.63,-1480.58C1441.46,-1471.89 1516.45,-1463.95 1586.5,-1458.95 2374.57,-1402.69 4826.33,-1392.26 5587.04,-1390.37"/>
<polygon fill="black" stroke="black" points="5587.3,-1393.86 5597.29,-1390.34 5587.28,-1386.86 5587.3,-1393.86"/>
</g>
<!-- l2_expert_agg_gpu0&#45;&gt;l2_res2_gpu0 -->
<g id="edge857" class="edge">
<title>l2_expert_agg_gpu0&#45;&gt;l2_res2_gpu0</title>
<path fill="none" stroke="black" d="M1826.91,-1219.43C1470.22,-1192.26 961.1,-1153.47 670.01,-1131.29"/>
<polygon fill="black" stroke="black" points="669.99,-1127.78 659.75,-1130.51 669.45,-1134.76 669.99,-1127.78"/>
</g>
<!-- l3_mha_qkv_gpu0 -->
<g id="node386" class="node">
<title>l3_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="481,-1042.95 0,-1042.95 0,-974.95 481,-974.95 481,-1042.95"/>
<text text-anchor="middle" x="240.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="240.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="240.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="240.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu0&#45;&gt;l3_mha_qkv_gpu0 -->
<g id="edge1249" class="edge">
<title>l2_res2_gpu0&#45;&gt;l3_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M376.92,-1078.84C357.24,-1068.9 335.5,-1057.92 315.27,-1047.71"/>
<polygon fill="black" stroke="black" points="316.6,-1044.46 306.1,-1043.08 313.45,-1050.71 316.6,-1044.46"/>
</g>
<!-- l3_mha_res_add_gpu0 -->
<g id="node389" class="node">
<title>l3_mha_res_add_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="467.5,-730.95 33.5,-730.95 33.5,-662.95 467.5,-662.95 467.5,-730.95"/>
<text text-anchor="middle" x="250.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="250.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="250.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="250.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu0&#45;&gt;l3_mha_res_add_gpu0 -->
<g id="edge1253" class="edge">
<title>l2_res2_gpu0&#45;&gt;l3_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M471.06,-1078.62C478.55,-1067.92 485.61,-1055.56 489.5,-1042.95 525.63,-925.72 561.48,-864.05 486.5,-766.95 476.82,-754.42 452.91,-743.35 423.85,-733.95"/>
<polygon fill="black" stroke="black" points="424.83,-730.59 414.24,-730.96 422.75,-737.28 424.83,-730.59"/>
</g>
<!-- l2_mha_attn_gpu1 -->
<g id="node267" class="node">
<title>l2_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1705,-1906.95 1224,-1906.95 1224,-1838.95 1705,-1838.95 1705,-1906.95"/>
<text text-anchor="middle" x="1464.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1464.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1464.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1464.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu1&#45;&gt;l2_mha_attn_gpu1 -->
<g id="edge860" class="edge">
<title>l2_mha_qkv_gpu1&#45;&gt;l2_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M1464.5,-1942.84C1464.5,-1934.73 1464.5,-1925.94 1464.5,-1917.43"/>
<polygon fill="black" stroke="black" points="1468,-1917.25 1464.5,-1907.25 1461,-1917.25 1468,-1917.25"/>
</g>
<!-- l2_mha_out_gpu1 -->
<g id="node268" class="node">
<title>l2_mha_out_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1702,-1802.95 1233,-1802.95 1233,-1734.95 1702,-1734.95 1702,-1802.95"/>
<text text-anchor="middle" x="1467.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1467.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1467.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1467.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu1&#45;&gt;l2_mha_out_gpu1 -->
<g id="edge861" class="edge">
<title>l2_mha_attn_gpu1&#45;&gt;l2_mha_out_gpu1</title>
<path fill="none" stroke="black" d="M1465.47,-1838.84C1465.71,-1830.73 1465.97,-1821.94 1466.22,-1813.43"/>
<polygon fill="black" stroke="black" points="1469.73,-1813.35 1466.52,-1803.25 1462.73,-1813.15 1469.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu1&#45;&gt;l2_mha_res_add_gpu1 -->
<g id="edge862" class="edge">
<title>l2_mha_out_gpu1&#45;&gt;l2_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M1510.68,-1734.84C1522.88,-1725.48 1536.27,-1715.21 1548.91,-1705.52"/>
<polygon fill="black" stroke="black" points="1551.28,-1708.12 1557.08,-1699.25 1547.02,-1702.56 1551.28,-1708.12"/>
</g>
<!-- l2_expert_1_gpu1 -->
<g id="node270" class="node">
<title>l2_expert_1_gpu1</title>
<polygon fill="lightpink" stroke="black" points="6483.5,-1422.95 6049.5,-1422.95 6049.5,-1354.95 6483.5,-1354.95 6483.5,-1422.95"/>
<text text-anchor="middle" x="6266.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6266.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6266.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6266.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu1&#45;&gt;l2_expert_1_gpu1 -->
<g id="edge866" class="edge">
<title>l2_mha_res_add_gpu1&#45;&gt;l2_expert_1_gpu1</title>
<path fill="none" stroke="black" d="M1598.63,-1630.78C1598.02,-1583.85 1604.87,-1499.29 1657.5,-1458.95 1704.78,-1422.72 5798.1,-1427.39 6039.23,-1422.56"/>
<polygon fill="black" stroke="black" points="6039.57,-1426.05 6049.45,-1422.23 6039.34,-1419.05 6039.57,-1426.05"/>
</g>
<!-- l2_gate_gpu1 -->
<g id="node271" class="node">
<title>l2_gate_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="2618.24,-1594.95 1861.44,-1594.95 1666.76,-1458.95 2423.56,-1458.95 2618.24,-1594.95"/>
<text text-anchor="middle" x="2142.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2142.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2142.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2142.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu1&#45;&gt;l2_gate_gpu1 -->
<g id="edge864" class="edge">
<title>l2_mha_res_add_gpu1&#45;&gt;l2_gate_gpu1</title>
<path fill="none" stroke="black" d="M1732.05,-1630.94C1772.64,-1620.76 1818.96,-1609.14 1865.52,-1597.45"/>
<polygon fill="black" stroke="black" points="1866.6,-1600.79 1875.45,-1594.96 1864.9,-1594 1866.6,-1600.79"/>
</g>
<!-- l2_res2_gpu1 -->
<g id="node273" class="node">
<title>l2_res2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="1549.5,-1146.95 1115.5,-1146.95 1115.5,-1078.95 1549.5,-1078.95 1549.5,-1146.95"/>
<text text-anchor="middle" x="1332.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1332.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1332.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1332.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu1&#45;&gt;l2_res2_gpu1 -->
<g id="edge884" class="edge">
<title>l2_mha_res_add_gpu1&#45;&gt;l2_res2_gpu1</title>
<path fill="none" stroke="black" d="M1383.2,-1657.33C1081.39,-1647.04 568.87,-1625.23 540.5,-1594.95 477.9,-1528.14 478.63,-1250.44 540.5,-1182.95 578.25,-1141.78 884.97,-1125.08 1105.39,-1118.38"/>
<polygon fill="black" stroke="black" points="1105.6,-1121.87 1115.49,-1118.08 1105.39,-1114.88 1105.6,-1121.87"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge867" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6049.45,-1355.69C6046.45,-1355.43 6043.46,-1355.18 6040.5,-1354.95 5297.38,-1296.97 3429.62,-1376.91 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.78,-1315.47 2676.53,-1318.15 2686.22,-1322.44 2686.78,-1315.47"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge868" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6049.45,-1355.71C6046.45,-1355.44 6043.46,-1355.19 6040.5,-1354.95 4961.17,-1268.55 4683.83,-1405.33 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.78,-1315.47 3594.53,-1318.13 3604.21,-1322.44 3604.78,-1315.47"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge869" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6049.45,-1355.74C6046.45,-1355.47 6043.46,-1355.2 6040.5,-1354.95 5368.04,-1298.1 5194.96,-1375.8 4522.5,-1318.95 4522.39,-1318.94 4522.29,-1318.94 4522.18,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.5,-1315.44 4512.23,-1318.06 4521.89,-1322.41 4522.5,-1315.44"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge870" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6049.43,-1355.9C6046.44,-1355.57 6043.46,-1355.26 6040.5,-1354.95 5774.75,-1327.63 5706.25,-1346.27 5440.5,-1318.95 5440.39,-1318.94 5440.28,-1318.93 5440.17,-1318.92"/>
<polygon fill="black" stroke="black" points="5440.25,-1315.41 5429.94,-1317.85 5439.53,-1322.37 5440.25,-1315.41"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge871" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6177.19,-1354.86C6150.56,-1344.99 6120.3,-1333.77 6089.78,-1322.47"/>
<polygon fill="black" stroke="black" points="6090.9,-1319.15 6080.31,-1318.96 6088.47,-1325.71 6090.9,-1319.15"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge872" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6400.23,-1354.94C6442.79,-1344.44 6491.54,-1332.41 6540.36,-1320.36"/>
<polygon fill="black" stroke="black" points="6541.26,-1323.74 6550.13,-1317.95 6539.58,-1316.95 6541.26,-1323.74"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge873" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6483.56,-1355.84C6486.56,-1355.53 6489.54,-1355.24 6492.5,-1354.95 6839.72,-1321.71 6929.28,-1352.19 7276.5,-1318.95 7327.15,-1314.11 7380.75,-1307.57 7432.77,-1300.48"/>
<polygon fill="black" stroke="black" points="7433.37,-1303.93 7442.81,-1299.1 7432.42,-1296.99 7433.37,-1303.93"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge874" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6483.55,-1355.73C6486.55,-1355.46 6489.54,-1355.2 6492.5,-1354.95 7246.5,-1292.17 7440.49,-1381.72 8194.5,-1318.95 8245.49,-1314.71 8299.43,-1308.45 8351.73,-1301.43"/>
<polygon fill="black" stroke="black" points="8352.38,-1304.87 8361.82,-1300.06 8351.45,-1297.93 8352.38,-1304.87"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge875" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6483.55,-1355.7C6486.55,-1355.44 6489.54,-1355.19 6492.5,-1354.95 7653.39,-1262.62 7951.61,-1411.26 9112.5,-1318.95 9163.6,-1314.89 9217.66,-1308.71 9270.05,-1301.71"/>
<polygon fill="black" stroke="black" points="9270.72,-1305.15 9280.16,-1300.34 9269.78,-1298.21 9270.72,-1305.15"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge876" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6483.55,-1355.69C6486.55,-1355.43 6489.54,-1355.18 6492.5,-1354.95 7276.4,-1294.01 9246.6,-1379.88 10030.5,-1318.95 10081.7,-1314.97 10135.87,-1308.82 10188.35,-1301.82"/>
<polygon fill="black" stroke="black" points="10189.03,-1305.26 10198.48,-1300.46 10188.1,-1298.33 10189.03,-1305.26"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge877" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6483.55,-1355.68C6486.55,-1355.42 6489.53,-1355.18 6492.5,-1354.95 7479.86,-1279.24 9961.14,-1394.65 10948.5,-1318.95 10999.7,-1315.03 11053.87,-1308.9 11106.36,-1301.91"/>
<polygon fill="black" stroke="black" points="11107.04,-1305.35 11116.49,-1300.55 11106.11,-1298.42 11107.04,-1305.35"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge878" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6483.55,-1355.67C6486.55,-1355.42 6489.53,-1355.18 6492.5,-1354.95 7683.32,-1264.46 10675.68,-1409.42 11866.5,-1318.95 11917.8,-1315.06 11972.08,-1308.93 12024.65,-1301.93"/>
<polygon fill="black" stroke="black" points="12025.35,-1305.37 12034.8,-1300.57 12024.42,-1298.43 12025.35,-1305.37"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge879" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6483.55,-1355.67C6486.55,-1355.42 6489.53,-1355.18 6492.5,-1354.95 7886.78,-1249.69 11390.22,-1424.19 12784.5,-1318.95 12835.8,-1315.08 12890.08,-1308.97 12942.66,-1301.98"/>
<polygon fill="black" stroke="black" points="12943.36,-1305.41 12952.8,-1300.61 12942.42,-1298.48 12943.36,-1305.41"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge880" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6483.55,-1355.67C6486.55,-1355.41 6489.53,-1355.18 6492.5,-1354.95 7291.37,-1294.93 12903.63,-1378.96 13702.5,-1318.95 13753.8,-1315.1 13808.08,-1309 13860.66,-1302.01"/>
<polygon fill="black" stroke="black" points="13861.36,-1305.45 13870.8,-1300.65 13860.43,-1298.51 13861.36,-1305.45"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge881" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6483.55,-1355.66C6486.55,-1355.41 6489.53,-1355.18 6492.5,-1354.95 7393.1,-1287.54 13719.9,-1386.34 14620.5,-1318.95 14671.8,-1315.11 14726.08,-1309.02 14778.66,-1302.03"/>
<polygon fill="black" stroke="black" points="14779.36,-1305.47 14788.8,-1300.67 14778.43,-1298.53 14779.36,-1305.47"/>
</g>
<!-- l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge882" class="edge">
<title>l2_expert_1_gpu1&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6483.55,-1355.66C6486.55,-1355.41 6489.53,-1355.17 6492.5,-1354.95 7494.83,-1280.15 14536.17,-1393.73 15538.5,-1318.95 15589.8,-1315.13 15644.08,-1309.04 15696.66,-1302.05"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.49 15706.81,-1300.69 15696.43,-1298.55 15697.36,-1305.49"/>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert_1_gpu1 -->
<g id="edge865" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert_1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2454.26,-1480.33C2525.2,-1471.64 2600.32,-1463.76 2670.5,-1458.95 3414.39,-1407.95 5277.37,-1480.55 6039.43,-1422.99"/>
<polygon fill="black" stroke="black" points="6039.75,-1426.47 6049.45,-1422.22 6039.21,-1419.49 6039.75,-1426.47"/>
</g>
<!-- l2_expert_agg_gpu1&#45;&gt;l2_res2_gpu1 -->
<g id="edge883" class="edge">
<title>l2_expert_agg_gpu1&#45;&gt;l2_res2_gpu1</title>
<path fill="none" stroke="black" d="M2696.76,-1183.98C2693.33,-1183.63 2689.91,-1183.29 2686.5,-1182.95 2474.8,-1162.15 1887.04,-1136.33 1559.81,-1122.94"/>
<polygon fill="black" stroke="black" points="1559.86,-1119.44 1549.72,-1122.53 1559.57,-1126.44 1559.86,-1119.44"/>
</g>
<!-- l3_mha_qkv_gpu1 -->
<g id="node394" class="node">
<title>l3_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1439,-1042.95 958,-1042.95 958,-974.95 1439,-974.95 1439,-1042.95"/>
<text text-anchor="middle" x="1198.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1198.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1198.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1198.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu1&#45;&gt;l3_mha_qkv_gpu1 -->
<g id="edge1275" class="edge">
<title>l2_res2_gpu1&#45;&gt;l3_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1288.99,-1078.84C1276.71,-1069.48 1263.21,-1059.21 1250.48,-1049.52"/>
<polygon fill="black" stroke="black" points="1252.32,-1046.52 1242.25,-1043.25 1248.08,-1052.09 1252.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu1 -->
<g id="node397" class="node">
<title>l3_mha_res_add_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="1551.5,-730.95 1117.5,-730.95 1117.5,-662.95 1551.5,-662.95 1551.5,-730.95"/>
<text text-anchor="middle" x="1334.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1334.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1334.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1334.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu1&#45;&gt;l3_mha_res_add_gpu1 -->
<g id="edge1279" class="edge">
<title>l2_res2_gpu1&#45;&gt;l3_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M1412.53,-1078.87C1426.53,-1069.38 1439.24,-1057.54 1447.5,-1042.95 1507.94,-936.2 1505.42,-873.43 1444.5,-766.95 1437.9,-755.41 1428.5,-745.53 1417.95,-737.15"/>
<polygon fill="black" stroke="black" points="1419.8,-734.17 1409.68,-731.03 1415.64,-739.8 1419.8,-734.17"/>
</g>
<!-- l2_mha_attn_gpu2 -->
<g id="node275" class="node">
<title>l2_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2789,-1906.95 2308,-1906.95 2308,-1838.95 2789,-1838.95 2789,-1906.95"/>
<text text-anchor="middle" x="2548.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2548.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2548.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2548.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu2&#45;&gt;l2_mha_attn_gpu2 -->
<g id="edge886" class="edge">
<title>l2_mha_qkv_gpu2&#45;&gt;l2_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M2548.5,-1942.84C2548.5,-1934.73 2548.5,-1925.94 2548.5,-1917.43"/>
<polygon fill="black" stroke="black" points="2552,-1917.25 2548.5,-1907.25 2545,-1917.25 2552,-1917.25"/>
</g>
<!-- l2_mha_out_gpu2 -->
<g id="node276" class="node">
<title>l2_mha_out_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2786,-1802.95 2317,-1802.95 2317,-1734.95 2786,-1734.95 2786,-1802.95"/>
<text text-anchor="middle" x="2551.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2551.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2551.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2551.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu2&#45;&gt;l2_mha_out_gpu2 -->
<g id="edge887" class="edge">
<title>l2_mha_attn_gpu2&#45;&gt;l2_mha_out_gpu2</title>
<path fill="none" stroke="black" d="M2549.47,-1838.84C2549.71,-1830.73 2549.97,-1821.94 2550.22,-1813.43"/>
<polygon fill="black" stroke="black" points="2553.73,-1813.35 2550.52,-1803.25 2546.73,-1813.15 2553.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu2&#45;&gt;l2_mha_res_add_gpu2 -->
<g id="edge888" class="edge">
<title>l2_mha_out_gpu2&#45;&gt;l2_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M2594.68,-1734.84C2606.88,-1725.48 2620.27,-1715.21 2632.91,-1705.52"/>
<polygon fill="black" stroke="black" points="2635.28,-1708.12 2641.08,-1699.25 2631.02,-1702.56 2635.28,-1708.12"/>
</g>
<!-- l2_expert_2_gpu2 -->
<g id="node278" class="node">
<title>l2_expert_2_gpu2</title>
<polygon fill="lightpink" stroke="black" points="6935.5,-1422.95 6501.5,-1422.95 6501.5,-1354.95 6935.5,-1354.95 6935.5,-1422.95"/>
<text text-anchor="middle" x="6718.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6718.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6718.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6718.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu2&#45;&gt;l2_expert_2_gpu2 -->
<g id="edge892" class="edge">
<title>l2_mha_res_add_gpu2&#45;&gt;l2_expert_2_gpu2</title>
<path fill="none" stroke="black" d="M2682.64,-1630.79C2682.04,-1583.87 2688.9,-1499.32 2741.5,-1458.95 2781.86,-1427.98 6271.09,-1427.01 6491.34,-1422.55"/>
<polygon fill="black" stroke="black" points="6491.57,-1426.04 6501.45,-1422.22 6491.34,-1419.05 6491.57,-1426.04"/>
</g>
<!-- l2_gate_gpu2 -->
<g id="node279" class="node">
<title>l2_gate_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="3702.24,-1594.95 2945.44,-1594.95 2750.76,-1458.95 3507.56,-1458.95 3702.24,-1594.95"/>
<text text-anchor="middle" x="3226.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3226.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3226.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3226.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu2&#45;&gt;l2_gate_gpu2 -->
<g id="edge890" class="edge">
<title>l2_mha_res_add_gpu2&#45;&gt;l2_gate_gpu2</title>
<path fill="none" stroke="black" d="M2816.05,-1630.94C2856.64,-1620.76 2902.96,-1609.14 2949.52,-1597.45"/>
<polygon fill="black" stroke="black" points="2950.6,-1600.79 2959.45,-1594.96 2948.9,-1594 2950.6,-1600.79"/>
</g>
<!-- l2_res2_gpu2 -->
<g id="node281" class="node">
<title>l2_res2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="2633.5,-1146.95 2199.5,-1146.95 2199.5,-1078.95 2633.5,-1078.95 2633.5,-1146.95"/>
<text text-anchor="middle" x="2416.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2416.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2416.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2416.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu2&#45;&gt;l2_res2_gpu2 -->
<g id="edge910" class="edge">
<title>l2_mha_res_add_gpu2&#45;&gt;l2_res2_gpu2</title>
<path fill="none" stroke="black" d="M2467.21,-1655.01C2293.78,-1648.02 2044.58,-1638.28 1826.5,-1630.95 1791.7,-1629.78 597.77,-1619.93 573.5,-1594.95 531.38,-1551.6 537.04,-1507.16 573.5,-1458.95 845.14,-1099.74 1105.22,-1262.51 1548.5,-1182.95 1763.79,-1144.31 2013,-1127.31 2189.01,-1119.83"/>
<polygon fill="black" stroke="black" points="2189.33,-1123.32 2199.18,-1119.4 2189.04,-1116.32 2189.33,-1123.32"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge893" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6501.45,-1355.69C6498.45,-1355.43 6495.47,-1355.18 6492.5,-1354.95 5649.21,-1289.7 3529.8,-1384.19 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.16 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge894" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6501.45,-1355.7C6498.45,-1355.44 6495.46,-1355.19 6492.5,-1354.95 5212.82,-1254 4884.18,-1419.88 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.78,-1315.47 3594.53,-1318.14 3604.21,-1322.44 3604.78,-1315.47"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge895" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6501.45,-1355.72C6498.45,-1355.45 6495.46,-1355.2 6492.5,-1354.95 5619.71,-1283.55 5395.29,-1390.34 4522.5,-1318.95 4522.4,-1318.94 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.79,-1315.47 4512.53,-1318.12 4522.2,-1322.44 4522.79,-1315.47"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge896" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6501.44,-1355.79C6498.44,-1355.5 6495.46,-1355.22 6492.5,-1354.95 6026.55,-1313.09 5906.45,-1360.8 5440.5,-1318.95 5440.39,-1318.94 5440.29,-1318.93 5440.18,-1318.92"/>
<polygon fill="black" stroke="black" points="5440.51,-1315.44 5430.23,-1318.01 5439.87,-1322.41 5440.51,-1315.44"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge897" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6519.72,-1354.94C6456.98,-1344.53 6385.17,-1332.6 6313.19,-1320.65"/>
<polygon fill="black" stroke="black" points="6313.47,-1317.15 6303.03,-1318.96 6312.32,-1324.05 6313.47,-1317.15"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge898" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6742.72,-1354.68C6748.78,-1346.35 6755.54,-1337.07 6762.45,-1327.58"/>
<polygon fill="black" stroke="black" points="6765.48,-1329.36 6768.54,-1319.22 6759.82,-1325.24 6765.48,-1329.36"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge899" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6935.59,-1356.1C6938.58,-1355.71 6941.55,-1355.33 6944.5,-1354.95 7091.73,-1336.23 7129.27,-1337.68 7276.5,-1318.95 7325.93,-1312.67 7378.28,-1305.51 7429.25,-1298.26"/>
<polygon fill="black" stroke="black" points="7430.02,-1301.69 7439.43,-1296.81 7429.03,-1294.76 7430.02,-1301.69"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge900" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6935.55,-1355.77C6938.55,-1355.48 6941.54,-1355.21 6944.5,-1354.95 7498.19,-1306.72 7640.81,-1367.17 8194.5,-1318.95 8245.38,-1314.52 8299.21,-1308.18 8351.42,-1301.13"/>
<polygon fill="black" stroke="black" points="8352.05,-1304.58 8361.49,-1299.76 8351.11,-1297.64 8352.05,-1304.58"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge901" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6935.55,-1355.72C6938.55,-1355.45 6941.54,-1355.19 6944.5,-1354.95 7905.04,-1277.17 8151.95,-1396.71 9112.5,-1318.95 9163.59,-1314.82 9217.65,-1308.6 9270.04,-1301.58"/>
<polygon fill="black" stroke="black" points="9270.71,-1305.03 9280.15,-1300.22 9269.77,-1298.09 9270.71,-1305.03"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge902" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6935.55,-1355.69C6938.55,-1355.43 6941.54,-1355.19 6944.5,-1354.95 8311.94,-1247.62 8663.05,-1426.25 10030.5,-1318.95 10081.69,-1314.94 10135.86,-1308.76 10188.35,-1301.76"/>
<polygon fill="black" stroke="black" points="10189.03,-1305.2 10198.47,-1300.39 10188.1,-1298.26 10189.03,-1305.2"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge903" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6935.55,-1355.68C6938.55,-1355.43 6941.53,-1355.18 6944.5,-1354.95 7831.68,-1286.51 10061.32,-1387.37 10948.5,-1318.95 10999.7,-1315 11053.87,-1308.87 11106.36,-1301.87"/>
<polygon fill="black" stroke="black" points="11107.04,-1305.31 11116.48,-1300.51 11106.1,-1298.38 11107.04,-1305.31"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge904" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6935.55,-1355.68C6938.55,-1355.42 6941.53,-1355.18 6944.5,-1354.95 8035.14,-1271.74 10775.86,-1402.14 11866.5,-1318.95 11917.7,-1315.05 11971.88,-1308.93 12024.36,-1301.95"/>
<polygon fill="black" stroke="black" points="12025.04,-1305.39 12034.49,-1300.59 12024.11,-1298.45 12025.04,-1305.39"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge905" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6935.55,-1355.67C6938.55,-1355.42 6941.53,-1355.18 6944.5,-1354.95 8238.6,-1256.96 11490.4,-1416.92 12784.5,-1318.95 12835.8,-1315.07 12890.08,-1308.95 12942.66,-1301.96"/>
<polygon fill="black" stroke="black" points="12943.35,-1305.4 12952.8,-1300.59 12942.42,-1298.46 12943.35,-1305.4"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge906" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6935.55,-1355.67C6938.55,-1355.42 6941.53,-1355.18 6944.5,-1354.95 7693.28,-1298.57 12953.72,-1375.32 13702.5,-1318.95 13753.8,-1315.09 13808.08,-1308.98 13860.66,-1301.99"/>
<polygon fill="black" stroke="black" points="13861.36,-1305.43 13870.8,-1300.63 13860.42,-1298.49 13861.36,-1305.43"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge907" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6935.55,-1355.67C6938.55,-1355.41 6941.53,-1355.18 6944.5,-1354.95 7795.01,-1291.18 13769.99,-1382.71 14620.5,-1318.95 14671.8,-1315.11 14726.08,-1309.01 14778.66,-1302.02"/>
<polygon fill="black" stroke="black" points="14779.36,-1305.46 14788.8,-1300.66 14778.43,-1298.52 14779.36,-1305.46"/>
</g>
<!-- l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge908" class="edge">
<title>l2_expert_2_gpu2&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6935.55,-1355.66C6938.55,-1355.41 6941.53,-1355.17 6944.5,-1354.95 7896.74,-1283.79 14586.26,-1390.09 15538.5,-1318.95 15589.8,-1315.12 15644.08,-1309.03 15696.66,-1302.04"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.48 15706.81,-1300.68 15696.43,-1298.54 15697.36,-1305.48"/>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert_2_gpu2 -->
<g id="edge891" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert_2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3534.98,-1477.9C3595.05,-1470.21 3657.63,-1463.34 3716.5,-1458.95 4943.51,-1367.46 5260.69,-1519.45 6491.04,-1423.03"/>
<polygon fill="black" stroke="black" points="6491.76,-1426.48 6501.45,-1422.21 6491.21,-1419.5 6491.76,-1426.48"/>
</g>
<!-- l2_expert_agg_gpu2&#45;&gt;l2_res2_gpu2 -->
<g id="edge909" class="edge">
<title>l2_expert_agg_gpu2&#45;&gt;l2_res2_gpu2</title>
<path fill="none" stroke="black" d="M3615.06,-1184.05C3611.52,-1183.67 3608.01,-1183.31 3604.5,-1182.95 3271.18,-1149.01 2883.43,-1130.38 2643.96,-1121.29"/>
<polygon fill="black" stroke="black" points="2643.86,-1117.78 2633.73,-1120.9 2643.59,-1124.78 2643.86,-1117.78"/>
</g>
<!-- l3_mha_qkv_gpu2 -->
<g id="node402" class="node">
<title>l3_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2523,-1042.95 2042,-1042.95 2042,-974.95 2523,-974.95 2523,-1042.95"/>
<text text-anchor="middle" x="2282.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2282.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2282.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2282.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu2&#45;&gt;l3_mha_qkv_gpu2 -->
<g id="edge1301" class="edge">
<title>l2_res2_gpu2&#45;&gt;l3_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2372.99,-1078.84C2360.71,-1069.48 2347.21,-1059.21 2334.48,-1049.52"/>
<polygon fill="black" stroke="black" points="2336.32,-1046.52 2326.25,-1043.25 2332.08,-1052.09 2336.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu2 -->
<g id="node405" class="node">
<title>l3_mha_res_add_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="2635.5,-730.95 2201.5,-730.95 2201.5,-662.95 2635.5,-662.95 2635.5,-730.95"/>
<text text-anchor="middle" x="2418.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2418.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2418.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2418.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu2&#45;&gt;l3_mha_res_add_gpu2 -->
<g id="edge1305" class="edge">
<title>l2_res2_gpu2&#45;&gt;l3_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M2496.53,-1078.87C2510.53,-1069.38 2523.24,-1057.54 2531.5,-1042.95 2591.94,-936.2 2589.42,-873.43 2528.5,-766.95 2521.9,-755.41 2512.5,-745.53 2501.95,-737.15"/>
<polygon fill="black" stroke="black" points="2503.8,-734.17 2493.68,-731.03 2499.64,-739.8 2503.8,-734.17"/>
</g>
<!-- l2_mha_attn_gpu3 -->
<g id="node283" class="node">
<title>l2_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3835,-1906.95 3354,-1906.95 3354,-1838.95 3835,-1838.95 3835,-1906.95"/>
<text text-anchor="middle" x="3594.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3594.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3594.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3594.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu3&#45;&gt;l2_mha_attn_gpu3 -->
<g id="edge912" class="edge">
<title>l2_mha_qkv_gpu3&#45;&gt;l2_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M3594.5,-1942.84C3594.5,-1934.73 3594.5,-1925.94 3594.5,-1917.43"/>
<polygon fill="black" stroke="black" points="3598,-1917.25 3594.5,-1907.25 3591,-1917.25 3598,-1917.25"/>
</g>
<!-- l2_mha_out_gpu3 -->
<g id="node284" class="node">
<title>l2_mha_out_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3832,-1802.95 3363,-1802.95 3363,-1734.95 3832,-1734.95 3832,-1802.95"/>
<text text-anchor="middle" x="3597.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3597.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3597.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3597.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu3&#45;&gt;l2_mha_out_gpu3 -->
<g id="edge913" class="edge">
<title>l2_mha_attn_gpu3&#45;&gt;l2_mha_out_gpu3</title>
<path fill="none" stroke="black" d="M3595.47,-1838.84C3595.71,-1830.73 3595.97,-1821.94 3596.22,-1813.43"/>
<polygon fill="black" stroke="black" points="3599.73,-1813.35 3596.52,-1803.25 3592.73,-1813.15 3599.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu3&#45;&gt;l2_mha_res_add_gpu3 -->
<g id="edge914" class="edge">
<title>l2_mha_out_gpu3&#45;&gt;l2_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M3640.68,-1734.84C3652.88,-1725.48 3666.27,-1715.21 3678.91,-1705.52"/>
<polygon fill="black" stroke="black" points="3681.28,-1708.12 3687.08,-1699.25 3677.02,-1702.56 3681.28,-1708.12"/>
</g>
<!-- l2_expert_3_gpu3 -->
<g id="node286" class="node">
<title>l2_expert_3_gpu3</title>
<polygon fill="lightpink" stroke="black" points="7387.5,-1422.95 6953.5,-1422.95 6953.5,-1354.95 7387.5,-1354.95 7387.5,-1422.95"/>
<text text-anchor="middle" x="7170.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7170.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="7170.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7170.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu3&#45;&gt;l2_expert_3_gpu3 -->
<g id="edge918" class="edge">
<title>l2_mha_res_add_gpu3&#45;&gt;l2_expert_3_gpu3</title>
<path fill="none" stroke="black" d="M3777.19,-1630.84C3849.03,-1582.09 3992.85,-1493.11 4130.5,-1458.95 4279.73,-1421.93 6706.07,-1434.83 6943.33,-1422.84"/>
<polygon fill="black" stroke="black" points="6943.69,-1426.32 6953.45,-1422.21 6943.25,-1419.33 6943.69,-1426.32"/>
</g>
<!-- l2_gate_gpu3 -->
<g id="node287" class="node">
<title>l2_gate_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="5091.24,-1594.95 4334.44,-1594.95 4139.76,-1458.95 4896.56,-1458.95 5091.24,-1594.95"/>
<text text-anchor="middle" x="4615.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4615.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4615.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4615.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu3&#45;&gt;l2_gate_gpu3 -->
<g id="edge916" class="edge">
<title>l2_mha_res_add_gpu3&#45;&gt;l2_gate_gpu3</title>
<path fill="none" stroke="black" d="M3945.3,-1630.94C4050.56,-1614.77 4179.46,-1594.96 4295.99,-1577.05"/>
<polygon fill="black" stroke="black" points="4296.79,-1580.47 4306.15,-1575.49 4295.73,-1573.55 4296.79,-1580.47"/>
</g>
<!-- l2_res2_gpu3 -->
<g id="node289" class="node">
<title>l2_res2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="3679.5,-1146.95 3245.5,-1146.95 3245.5,-1078.95 3679.5,-1078.95 3679.5,-1146.95"/>
<text text-anchor="middle" x="3462.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3462.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3462.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3462.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu3&#45;&gt;l2_res2_gpu3 -->
<g id="edge936" class="edge">
<title>l2_mha_res_add_gpu3&#45;&gt;l2_res2_gpu3</title>
<path fill="none" stroke="black" d="M3513.42,-1654.49C3348.15,-1647.47 3115.01,-1637.93 2910.5,-1630.95 2874.78,-1629.73 1649.64,-1620.36 1624.5,-1594.95 1596.22,-1566.37 1590.21,-1215.36 1621.5,-1182.95 1660.92,-1142.12 2585.78,-1149.09 2642.5,-1146.95 2842.79,-1139.39 3070.58,-1130.18 3235.15,-1123.41"/>
<polygon fill="black" stroke="black" points="3235.56,-1126.89 3245.41,-1122.98 3235.27,-1119.9 3235.56,-1126.89"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge919" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6953.45,-1355.68C6950.45,-1355.42 6947.47,-1355.18 6944.5,-1354.95 6001.03,-1282.42 3629.97,-1391.46 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.16 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge920" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6953.45,-1355.69C6950.45,-1355.43 6947.46,-1355.18 6944.5,-1354.95 6204.48,-1297.2 4344.52,-1376.69 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.78,-1315.47 3594.53,-1318.15 3604.22,-1322.44 3604.78,-1315.47"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge921" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6953.45,-1355.71C6950.45,-1355.44 6947.46,-1355.19 6944.5,-1354.95 5871.37,-1269 5595.63,-1404.88 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.78,-1315.47 4512.53,-1318.13 4522.21,-1322.44 4522.78,-1315.47"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge922" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6953.45,-1355.75C6950.45,-1355.47 6947.46,-1355.2 6944.5,-1354.95 6278.25,-1298.55 6106.75,-1375.35 5440.5,-1318.95 5440.39,-1318.94 5440.29,-1318.94 5440.18,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.5,-1315.44 5430.23,-1318.06 5439.89,-1322.41 5440.5,-1315.44"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge923" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6953.43,-1355.9C6950.44,-1355.58 6947.46,-1355.26 6944.5,-1354.95 6684.95,-1328.08 6618.05,-1345.82 6358.5,-1318.95 6358.39,-1318.94 6358.28,-1318.93 6358.17,-1318.92"/>
<polygon fill="black" stroke="black" points="6358.26,-1315.41 6347.95,-1317.84 6357.52,-1322.37 6358.26,-1315.41"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge924" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7084.6,-1354.86C7059.09,-1345.03 7030.13,-1333.87 7000.91,-1322.61"/>
<polygon fill="black" stroke="black" points="7002,-1319.29 6991.41,-1318.96 6999.49,-1325.82 7002,-1319.29"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge925" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7307.63,-1354.94C7352.74,-1344.09 7404.64,-1331.59 7456.39,-1319.14"/>
<polygon fill="black" stroke="black" points="7457.49,-1322.47 7466.39,-1316.73 7455.85,-1315.67 7457.49,-1322.47"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge926" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7387.56,-1355.83C7390.56,-1355.53 7393.54,-1355.24 7396.5,-1354.95 7749.93,-1321.26 7841.07,-1352.64 8194.5,-1318.95 8245.15,-1314.13 8298.75,-1307.6 8350.77,-1300.51"/>
<polygon fill="black" stroke="black" points="8351.38,-1303.96 8360.81,-1299.13 8350.43,-1297.03 8351.38,-1303.96"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge927" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7387.55,-1355.73C7390.55,-1355.46 7393.54,-1355.2 7396.5,-1354.95 8156.71,-1291.72 8352.29,-1382.17 9112.5,-1318.95 9163.49,-1314.71 9217.43,-1308.45 9269.73,-1301.43"/>
<polygon fill="black" stroke="black" points="9270.39,-1304.88 9279.83,-1300.07 9269.45,-1297.94 9270.39,-1304.88"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge928" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7387.55,-1355.7C7390.55,-1355.44 7393.54,-1355.19 7396.5,-1354.95 8563.59,-1262.17 8863.4,-1411.71 10030.5,-1318.95 10081.6,-1314.89 10135.66,-1308.71 10188.05,-1301.71"/>
<polygon fill="black" stroke="black" points="10188.72,-1305.15 10198.16,-1300.35 10187.78,-1298.22 10188.72,-1305.15"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge929" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7387.55,-1355.69C7390.55,-1355.43 7393.54,-1355.18 7396.5,-1354.95 8183.5,-1293.79 10161.5,-1380.1 10948.5,-1318.95 10999.7,-1314.98 11053.87,-1308.82 11106.35,-1301.82"/>
<polygon fill="black" stroke="black" points="11107.03,-1305.26 11116.48,-1300.46 11106.1,-1298.33 11107.03,-1305.26"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge930" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7387.55,-1355.68C7390.55,-1355.42 7393.53,-1355.18 7396.5,-1354.95 8386.96,-1279.01 10876.04,-1394.87 11866.5,-1318.95 11917.7,-1315.03 11971.87,-1308.9 12024.36,-1301.91"/>
<polygon fill="black" stroke="black" points="12025.04,-1305.35 12034.49,-1300.55 12024.11,-1298.42 12025.04,-1305.35"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge931" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7387.55,-1355.67C7390.55,-1355.42 7393.53,-1355.18 7396.5,-1354.95 8590.42,-1264.24 11590.58,-1409.64 12784.5,-1318.95 12835.8,-1315.06 12890.08,-1308.93 12942.65,-1301.94"/>
<polygon fill="black" stroke="black" points="12943.35,-1305.37 12952.8,-1300.57 12942.42,-1298.44 12943.35,-1305.37"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge932" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7387.55,-1355.67C7390.55,-1355.42 7393.53,-1355.18 7396.5,-1354.95 8793.88,-1249.46 12305.12,-1424.41 13702.5,-1318.95 13753.8,-1315.08 13808.08,-1308.97 13860.66,-1301.98"/>
<polygon fill="black" stroke="black" points="13861.36,-1305.42 13870.8,-1300.62 13860.42,-1298.48 13861.36,-1305.42"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge933" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7387.55,-1355.67C7390.55,-1355.41 7393.53,-1355.18 7396.5,-1354.95 8196.92,-1294.82 13820.08,-1379.07 14620.5,-1318.95 14671.8,-1315.1 14726.08,-1309 14778.66,-1302.01"/>
<polygon fill="black" stroke="black" points="14779.36,-1305.45 14788.8,-1300.65 14778.43,-1298.51 14779.36,-1305.45"/>
</g>
<!-- l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge934" class="edge">
<title>l2_expert_3_gpu3&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7387.55,-1355.66C7390.55,-1355.41 7393.53,-1355.18 7396.5,-1354.95 8298.65,-1287.43 14636.35,-1386.46 15538.5,-1318.95 15589.8,-1315.11 15644.08,-1309.02 15696.66,-1302.03"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.47 15706.8,-1300.67 15696.43,-1298.53 15697.36,-1305.47"/>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert_3_gpu3 -->
<g id="edge917" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert_3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4946.39,-1493.55C5089.04,-1480.76 5257.84,-1467.17 5410.5,-1458.95 6088.15,-1422.48 6263.25,-1479.76 6943.4,-1423.01"/>
<polygon fill="black" stroke="black" points="6943.78,-1426.49 6953.45,-1422.16 6943.19,-1419.51 6943.78,-1426.49"/>
</g>
<!-- l2_expert_agg_gpu3&#45;&gt;l2_res2_gpu3 -->
<g id="edge935" class="edge">
<title>l2_expert_agg_gpu3&#45;&gt;l2_res2_gpu3</title>
<path fill="none" stroke="black" d="M4533.05,-1184.08C4529.52,-1183.7 4526,-1183.32 4522.5,-1182.95 4236.12,-1152.78 3904.74,-1133.74 3689.79,-1123.49"/>
<polygon fill="black" stroke="black" points="3689.8,-1119.98 3679.65,-1123 3689.47,-1126.97 3689.8,-1119.98"/>
</g>
<!-- l3_mha_qkv_gpu3 -->
<g id="node410" class="node">
<title>l3_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3569,-1042.95 3088,-1042.95 3088,-974.95 3569,-974.95 3569,-1042.95"/>
<text text-anchor="middle" x="3328.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3328.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3328.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3328.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu3&#45;&gt;l3_mha_qkv_gpu3 -->
<g id="edge1327" class="edge">
<title>l2_res2_gpu3&#45;&gt;l3_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M3418.99,-1078.84C3406.71,-1069.48 3393.21,-1059.21 3380.48,-1049.52"/>
<polygon fill="black" stroke="black" points="3382.32,-1046.52 3372.25,-1043.25 3378.08,-1052.09 3382.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu3 -->
<g id="node413" class="node">
<title>l3_mha_res_add_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="3681.5,-730.95 3247.5,-730.95 3247.5,-662.95 3681.5,-662.95 3681.5,-730.95"/>
<text text-anchor="middle" x="3464.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3464.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3464.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3464.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu3&#45;&gt;l3_mha_res_add_gpu3 -->
<g id="edge1331" class="edge">
<title>l2_res2_gpu3&#45;&gt;l3_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M3543.5,-1078.79C3557.51,-1069.33 3570.22,-1057.52 3578.5,-1042.95 3639.14,-936.32 3636.64,-873.31 3575.5,-766.95 3568.88,-755.43 3559.47,-745.57 3548.91,-737.21"/>
<polygon fill="black" stroke="black" points="3550.76,-734.23 3540.63,-731.11 3546.61,-739.86 3550.76,-734.23"/>
</g>
<!-- l2_mha_attn_gpu4 -->
<g id="node291" class="node">
<title>l2_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5529,-1906.95 5048,-1906.95 5048,-1838.95 5529,-1838.95 5529,-1906.95"/>
<text text-anchor="middle" x="5288.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5288.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5288.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5288.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu4&#45;&gt;l2_mha_attn_gpu4 -->
<g id="edge938" class="edge">
<title>l2_mha_qkv_gpu4&#45;&gt;l2_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M5288.5,-1942.84C5288.5,-1934.73 5288.5,-1925.94 5288.5,-1917.43"/>
<polygon fill="black" stroke="black" points="5292,-1917.25 5288.5,-1907.25 5285,-1917.25 5292,-1917.25"/>
</g>
<!-- l2_mha_out_gpu4 -->
<g id="node292" class="node">
<title>l2_mha_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5526,-1802.95 5057,-1802.95 5057,-1734.95 5526,-1734.95 5526,-1802.95"/>
<text text-anchor="middle" x="5291.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5291.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5291.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5291.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu4&#45;&gt;l2_mha_out_gpu4 -->
<g id="edge939" class="edge">
<title>l2_mha_attn_gpu4&#45;&gt;l2_mha_out_gpu4</title>
<path fill="none" stroke="black" d="M5289.47,-1838.84C5289.71,-1830.73 5289.97,-1821.94 5290.22,-1813.43"/>
<polygon fill="black" stroke="black" points="5293.73,-1813.35 5290.52,-1803.25 5286.73,-1813.15 5293.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu4&#45;&gt;l2_mha_res_add_gpu4 -->
<g id="edge940" class="edge">
<title>l2_mha_out_gpu4&#45;&gt;l2_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M5334.68,-1734.84C5346.88,-1725.48 5360.27,-1715.21 5372.91,-1705.52"/>
<polygon fill="black" stroke="black" points="5375.28,-1708.12 5381.08,-1699.25 5371.02,-1702.56 5375.28,-1708.12"/>
</g>
<!-- l2_expert_4_gpu4 -->
<g id="node294" class="node">
<title>l2_expert_4_gpu4</title>
<polygon fill="lightpink" stroke="black" points="7839.5,-1422.95 7405.5,-1422.95 7405.5,-1354.95 7839.5,-1354.95 7839.5,-1422.95"/>
<text text-anchor="middle" x="7622.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7622.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7622.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7622.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu4&#45;&gt;l2_expert_4_gpu4 -->
<g id="edge944" class="edge">
<title>l2_mha_res_add_gpu4&#45;&gt;l2_expert_4_gpu4</title>
<path fill="none" stroke="black" d="M5415.82,-1630.9C5405.96,-1584.91 5396.75,-1502.37 5443.5,-1458.95 5482.09,-1423.11 7235.05,-1427.1 7395.38,-1422.61"/>
<polygon fill="black" stroke="black" points="7395.61,-1426.11 7405.45,-1422.18 7395.31,-1419.11 7395.61,-1426.11"/>
</g>
<!-- l2_gate_gpu4 -->
<g id="node295" class="node">
<title>l2_gate_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="6404.24,-1594.95 5647.44,-1594.95 5452.76,-1458.95 6209.56,-1458.95 6404.24,-1594.95"/>
<text text-anchor="middle" x="5928.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5928.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5928.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5928.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu4&#45;&gt;l2_gate_gpu4 -->
<g id="edge942" class="edge">
<title>l2_mha_res_add_gpu4&#45;&gt;l2_gate_gpu4</title>
<path fill="none" stroke="black" d="M5546.83,-1630.94C5584.41,-1620.8 5627.28,-1609.23 5670.39,-1597.6"/>
<polygon fill="black" stroke="black" points="5671.43,-1600.95 5680.17,-1594.96 5669.61,-1594.19 5671.43,-1600.95"/>
</g>
<!-- l2_res2_gpu4 -->
<g id="node297" class="node">
<title>l2_res2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5316.5,-1146.95 4882.5,-1146.95 4882.5,-1078.95 5316.5,-1078.95 5316.5,-1146.95"/>
<text text-anchor="middle" x="5099.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5099.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5099.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5099.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu4&#45;&gt;l2_res2_gpu4 -->
<g id="edge962" class="edge">
<title>l2_mha_res_add_gpu4&#45;&gt;l2_res2_gpu4</title>
<path fill="none" stroke="black" d="M5207.5,-1658.61C4921.03,-1651.67 4400.95,-1639.43 3956.5,-1630.95 3924.57,-1630.34 1679.9,-1617.71 1657.5,-1594.95 1634.2,-1571.28 1613.76,-1229.18 1659.5,-1182.95 1699.15,-1142.89 3632.14,-1148.11 3688.5,-1146.95 4106.08,-1138.37 4593.14,-1126.58 4872.02,-1119.67"/>
<polygon fill="black" stroke="black" points="4872.35,-1123.16 4882.26,-1119.41 4872.18,-1116.16 4872.35,-1123.16"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge945" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7405.45,-1355.68C7402.45,-1355.42 7399.47,-1355.18 7396.5,-1354.95 6352.85,-1275.15 3730.15,-1398.73 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.17 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge946" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7405.45,-1355.69C7402.45,-1355.43 7399.47,-1355.18 7396.5,-1354.95 6556.31,-1289.92 4444.69,-1383.96 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.16 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge947" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7405.45,-1355.7C7402.45,-1355.44 7399.46,-1355.19 7396.5,-1354.95 6123.03,-1254.45 5795.98,-1419.43 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.78,-1315.47 4512.53,-1318.14 4522.21,-1322.44 4522.78,-1315.47"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge948" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7405.45,-1355.72C7402.45,-1355.45 7399.46,-1355.2 7396.5,-1354.95 6529.92,-1284 6307.08,-1389.89 5440.5,-1318.95 5440.4,-1318.94 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.79,-1315.47 5430.53,-1318.11 5440.2,-1322.44 5440.79,-1315.47"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge949" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7405.44,-1355.79C7402.44,-1355.5 7399.46,-1355.22 7396.5,-1354.95 6936.75,-1313.54 6818.25,-1360.35 6358.5,-1318.95 6358.39,-1318.94 6358.29,-1318.93 6358.18,-1318.92"/>
<polygon fill="black" stroke="black" points="6358.51,-1315.44 6348.23,-1318.01 6357.87,-1322.41 6358.51,-1315.44"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge950" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7427.12,-1354.94C7365.45,-1344.53 7294.87,-1332.6 7224.11,-1320.65"/>
<polygon fill="black" stroke="black" points="7224.57,-1317.18 7214.13,-1318.96 7223.41,-1324.08 7224.57,-1317.18"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge951" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7650.14,-1354.68C7657.21,-1346.18 7665.09,-1336.69 7673.14,-1327.01"/>
<polygon fill="black" stroke="black" points="7675.91,-1329.14 7679.61,-1319.22 7670.53,-1324.67 7675.91,-1329.14"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge952" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7839.59,-1356.08C7842.58,-1355.7 7845.55,-1355.32 7848.5,-1354.95 8001.91,-1335.78 8041.09,-1338.12 8194.5,-1318.95 8244.04,-1312.76 8296.5,-1305.64 8347.57,-1298.4"/>
<polygon fill="black" stroke="black" points="8348.35,-1301.83 8357.76,-1296.96 8347.36,-1294.9 8348.35,-1301.83"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge953" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7839.55,-1355.76C7842.55,-1355.48 7845.54,-1355.21 7848.5,-1354.95 8408.39,-1306.27 8552.61,-1367.62 9112.5,-1318.95 9163.38,-1314.53 9217.21,-1308.19 9269.42,-1301.15"/>
<polygon fill="black" stroke="black" points="9270.05,-1304.59 9279.49,-1299.78 9269.11,-1297.66 9270.05,-1304.59"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge954" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7839.55,-1355.71C7842.55,-1355.45 7845.54,-1355.19 7848.5,-1354.95 8815.25,-1276.72 9063.75,-1397.16 10030.5,-1318.95 10081.59,-1314.82 10135.65,-1308.6 10188.04,-1301.59"/>
<polygon fill="black" stroke="black" points="10188.71,-1305.03 10198.15,-1300.22 10187.77,-1298.09 10188.71,-1305.03"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge955" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7839.55,-1355.69C7842.55,-1355.43 7845.54,-1355.19 7848.5,-1354.95 9222.15,-1247.17 9574.85,-1426.7 10948.5,-1318.95 10999.69,-1314.94 11053.86,-1308.77 11106.35,-1301.76"/>
<polygon fill="black" stroke="black" points="11107.03,-1305.2 11116.47,-1300.4 11106.1,-1298.26 11107.03,-1305.2"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge956" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7839.55,-1355.68C7842.55,-1355.43 7845.53,-1355.18 7848.5,-1354.95 8738.78,-1286.29 10976.22,-1387.6 11866.5,-1318.95 11917.7,-1315.01 11971.87,-1308.87 12024.36,-1301.88"/>
<polygon fill="black" stroke="black" points="12025.04,-1305.32 12034.48,-1300.51 12024.1,-1298.38 12025.04,-1305.32"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge957" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7839.55,-1355.68C7842.55,-1355.42 7845.53,-1355.18 7848.5,-1354.95 8942.24,-1271.51 11690.76,-1402.37 12784.5,-1318.95 12835.7,-1315.05 12889.88,-1308.93 12942.36,-1301.95"/>
<polygon fill="black" stroke="black" points="12943.04,-1305.39 12952.49,-1300.59 12942.11,-1298.45 12943.04,-1305.39"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge958" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7839.55,-1355.67C7842.55,-1355.42 7845.53,-1355.18 7848.5,-1354.95 9145.7,-1256.74 12405.3,-1417.14 13702.5,-1318.95 13753.8,-1315.07 13808.08,-1308.95 13860.66,-1301.96"/>
<polygon fill="black" stroke="black" points="13861.35,-1305.4 13870.8,-1300.6 13860.42,-1298.46 13861.35,-1305.4"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge959" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7839.55,-1355.67C7842.55,-1355.42 7845.53,-1355.18 7848.5,-1354.95 8598.83,-1298.46 13870.17,-1375.43 14620.5,-1318.95 14671.8,-1315.09 14726.08,-1308.99 14778.66,-1301.99"/>
<polygon fill="black" stroke="black" points="14779.36,-1305.43 14788.8,-1300.63 14778.42,-1298.49 14779.36,-1305.43"/>
</g>
<!-- l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge960" class="edge">
<title>l2_expert_4_gpu4&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7839.55,-1355.67C7842.55,-1355.41 7845.53,-1355.18 7848.5,-1354.95 8700.56,-1291.07 14686.44,-1382.82 15538.5,-1318.95 15589.8,-1315.11 15644.08,-1309.01 15696.66,-1302.02"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.46 15706.8,-1300.66 15696.43,-1298.52 15697.36,-1305.46"/>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert_4_gpu4 -->
<g id="edge943" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert_4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6238.38,-1478.85C6298.04,-1471.13 6360.12,-1464.01 6418.5,-1458.95 6848.56,-1421.73 6961.63,-1461.82 7395.46,-1423.01"/>
<polygon fill="black" stroke="black" points="7395.8,-1426.49 7405.44,-1422.11 7395.17,-1419.52 7395.8,-1426.49"/>
</g>
<!-- l2_expert_agg_gpu4&#45;&gt;l2_res2_gpu4 -->
<g id="edge961" class="edge">
<title>l2_expert_agg_gpu4&#45;&gt;l2_res2_gpu4</title>
<path fill="none" stroke="black" d="M5505.36,-1182.95C5435.68,-1171.1 5365.77,-1159.22 5304.08,-1148.73"/>
<polygon fill="black" stroke="black" points="5304.3,-1145.22 5293.85,-1146.99 5303.12,-1152.12 5304.3,-1145.22"/>
</g>
<!-- l3_mha_qkv_gpu4 -->
<g id="node418" class="node">
<title>l3_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5206,-1042.95 4725,-1042.95 4725,-974.95 5206,-974.95 5206,-1042.95"/>
<text text-anchor="middle" x="4965.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4965.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4965.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4965.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu4&#45;&gt;l3_mha_qkv_gpu4 -->
<g id="edge1353" class="edge">
<title>l2_res2_gpu4&#45;&gt;l3_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M5055.99,-1078.84C5043.71,-1069.48 5030.21,-1059.21 5017.48,-1049.52"/>
<polygon fill="black" stroke="black" points="5019.32,-1046.52 5009.25,-1043.25 5015.08,-1052.09 5019.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu4 -->
<g id="node421" class="node">
<title>l3_mha_res_add_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5318.5,-730.95 4884.5,-730.95 4884.5,-662.95 5318.5,-662.95 5318.5,-730.95"/>
<text text-anchor="middle" x="5101.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5101.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5101.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5101.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu4&#45;&gt;l3_mha_res_add_gpu4 -->
<g id="edge1357" class="edge">
<title>l2_res2_gpu4&#45;&gt;l3_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M5180.5,-1078.79C5194.51,-1069.33 5207.22,-1057.52 5215.5,-1042.95 5276.14,-936.32 5273.64,-873.31 5212.5,-766.95 5205.88,-755.43 5196.47,-745.57 5185.91,-737.21"/>
<polygon fill="black" stroke="black" points="5187.76,-734.23 5177.63,-731.11 5183.61,-739.86 5187.76,-734.23"/>
</g>
<!-- l2_mha_attn_gpu5 -->
<g id="node299" class="node">
<title>l2_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6537,-1906.95 6056,-1906.95 6056,-1838.95 6537,-1838.95 6537,-1906.95"/>
<text text-anchor="middle" x="6296.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6296.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6296.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6296.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu5&#45;&gt;l2_mha_attn_gpu5 -->
<g id="edge964" class="edge">
<title>l2_mha_qkv_gpu5&#45;&gt;l2_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M6296.5,-1942.84C6296.5,-1934.73 6296.5,-1925.94 6296.5,-1917.43"/>
<polygon fill="black" stroke="black" points="6300,-1917.25 6296.5,-1907.25 6293,-1917.25 6300,-1917.25"/>
</g>
<!-- l2_mha_out_gpu5 -->
<g id="node300" class="node">
<title>l2_mha_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6534,-1802.95 6065,-1802.95 6065,-1734.95 6534,-1734.95 6534,-1802.95"/>
<text text-anchor="middle" x="6299.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6299.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6299.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6299.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu5&#45;&gt;l2_mha_out_gpu5 -->
<g id="edge965" class="edge">
<title>l2_mha_attn_gpu5&#45;&gt;l2_mha_out_gpu5</title>
<path fill="none" stroke="black" d="M6297.47,-1838.84C6297.71,-1830.73 6297.97,-1821.94 6298.22,-1813.43"/>
<polygon fill="black" stroke="black" points="6301.73,-1813.35 6298.52,-1803.25 6294.73,-1813.15 6301.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu5&#45;&gt;l2_mha_res_add_gpu5 -->
<g id="edge966" class="edge">
<title>l2_mha_out_gpu5&#45;&gt;l2_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6342.68,-1734.84C6354.88,-1725.48 6368.27,-1715.21 6380.91,-1705.52"/>
<polygon fill="black" stroke="black" points="6383.28,-1708.12 6389.08,-1699.25 6379.02,-1702.56 6383.28,-1708.12"/>
</g>
<!-- l2_expert_5_gpu5 -->
<g id="node302" class="node">
<title>l2_expert_5_gpu5</title>
<polygon fill="lightpink" stroke="black" points="8291.5,-1422.95 7857.5,-1422.95 7857.5,-1354.95 8291.5,-1354.95 8291.5,-1422.95"/>
<text text-anchor="middle" x="8074.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8074.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8074.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8074.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu5&#45;&gt;l2_expert_5_gpu5 -->
<g id="edge970" class="edge">
<title>l2_mha_res_add_gpu5&#45;&gt;l2_expert_5_gpu5</title>
<path fill="none" stroke="black" d="M6423.86,-1630.95C6414.05,-1585.01 6404.91,-1502.54 6451.5,-1458.95 6506.59,-1407.42 7700.58,-1428.3 7847.34,-1422.71"/>
<polygon fill="black" stroke="black" points="7847.65,-1426.2 7857.45,-1422.15 7847.27,-1419.21 7847.65,-1426.2"/>
</g>
<!-- l2_gate_gpu5 -->
<g id="node303" class="node">
<title>l2_gate_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="7412.24,-1594.95 6655.44,-1594.95 6460.76,-1458.95 7217.56,-1458.95 7412.24,-1594.95"/>
<text text-anchor="middle" x="6936.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6936.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6936.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6936.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu5&#45;&gt;l2_gate_gpu5 -->
<g id="edge968" class="edge">
<title>l2_mha_res_add_gpu5&#45;&gt;l2_gate_gpu5</title>
<path fill="none" stroke="black" d="M6554.83,-1630.94C6592.41,-1620.8 6635.28,-1609.23 6678.39,-1597.6"/>
<polygon fill="black" stroke="black" points="6679.43,-1600.95 6688.17,-1594.96 6677.61,-1594.19 6679.43,-1600.95"/>
</g>
<!-- l2_res2_gpu5 -->
<g id="node305" class="node">
<title>l2_res2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6324.5,-1146.95 5890.5,-1146.95 5890.5,-1078.95 6324.5,-1078.95 6324.5,-1146.95"/>
<text text-anchor="middle" x="6107.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6107.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6107.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6107.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu5&#45;&gt;l2_res2_gpu5 -->
<g id="edge988" class="edge">
<title>l2_mha_res_add_gpu5&#45;&gt;l2_res2_gpu5</title>
<path fill="none" stroke="black" d="M6215.14,-1653.03C6058.26,-1645.58 5841.35,-1636.15 5650.5,-1630.95 5568.8,-1628.73 2779.31,-1635.77 2708.5,-1594.95 2647.55,-1559.82 2687.21,-1496.16 2627.5,-1458.95 2543.49,-1406.6 2281.44,-1437.34 2183.5,-1422.95 1964.96,-1390.85 1836.39,-1490.71 1697.5,-1318.95 1659.49,-1271.95 1654.97,-1225.91 1697.5,-1182.95 1732.95,-1147.14 5275.13,-1148.27 5325.5,-1146.95 5512.25,-1142.09 5723.95,-1132.93 5879.95,-1125.49"/>
<polygon fill="black" stroke="black" points="5880.32,-1128.98 5890.14,-1125.01 5879.99,-1121.99 5880.32,-1128.98"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge971" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7857.45,-1355.67C7854.45,-1355.42 7851.47,-1355.18 7848.5,-1354.95 6704.67,-1267.87 3830.33,-1406.01 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.17 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge972" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7857.45,-1355.68C7854.45,-1355.42 7851.47,-1355.18 7848.5,-1354.95 6908.13,-1282.65 4544.87,-1391.23 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.16 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge973" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7857.45,-1355.69C7854.45,-1355.43 7851.46,-1355.18 7848.5,-1354.95 7111.59,-1297.43 5259.41,-1376.46 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.78,-1315.47 4512.53,-1318.15 4522.22,-1322.44 4522.78,-1315.47"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge974" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7857.45,-1355.71C7854.45,-1355.44 7851.46,-1355.19 7848.5,-1354.95 6781.58,-1269.45 6507.42,-1404.43 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.78,-1315.47 5430.53,-1318.13 5440.21,-1322.44 5440.78,-1315.47"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge975" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7857.45,-1355.75C7854.45,-1355.47 7851.46,-1355.2 7848.5,-1354.95 7188.45,-1299 7018.55,-1374.89 6358.5,-1318.95 6358.39,-1318.94 6358.29,-1318.94 6358.18,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.5,-1315.44 6348.23,-1318.06 6357.89,-1322.41 6358.5,-1315.44"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge976" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7857.43,-1355.91C7854.44,-1355.58 7851.46,-1355.26 7848.5,-1354.95 7595.15,-1328.53 7529.85,-1345.37 7276.5,-1318.95 7276.39,-1318.94 7276.28,-1318.93 7276.17,-1318.92"/>
<polygon fill="black" stroke="black" points="7276.26,-1315.41 7265.95,-1317.84 7275.52,-1322.37 7276.26,-1315.41"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge977" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7992,-1354.86C7967.62,-1345.07 7939.93,-1333.97 7912,-1322.76"/>
<polygon fill="black" stroke="black" points="7913.1,-1319.43 7902.52,-1318.96 7910.49,-1325.93 7913.1,-1319.43"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge978" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8215.03,-1354.94C8262.87,-1343.71 8318.16,-1330.72 8373.02,-1317.83"/>
<polygon fill="black" stroke="black" points="8373.96,-1321.21 8382.9,-1315.51 8372.36,-1314.39 8373.96,-1321.21"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge979" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8291.56,-1355.83C8294.56,-1355.53 8297.54,-1355.23 8300.5,-1354.95 8660.13,-1320.81 8752.87,-1353.09 9112.5,-1318.95 9163.15,-1314.15 9216.76,-1307.63 9268.78,-1300.54"/>
<polygon fill="black" stroke="black" points="9269.38,-1303.99 9278.81,-1299.17 9268.43,-1297.06 9269.38,-1303.99"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge980" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8291.55,-1355.73C8294.55,-1355.46 8297.54,-1355.2 8300.5,-1354.95 9066.91,-1291.27 9264.08,-1382.62 10030.5,-1318.95 10081.49,-1314.72 10135.44,-1308.46 10187.74,-1301.44"/>
<polygon fill="black" stroke="black" points="10188.39,-1304.88 10197.83,-1300.07 10187.45,-1297.95 10188.39,-1304.88"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge981" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8291.55,-1355.7C8294.55,-1355.44 8297.54,-1355.19 8300.5,-1354.95 9473.8,-1261.72 9775.2,-1412.16 10948.5,-1318.95 10999.69,-1314.89 11053.86,-1308.69 11106.34,-1301.67"/>
<polygon fill="black" stroke="black" points="11107.02,-1305.11 11116.47,-1300.31 11106.09,-1298.18 11107.02,-1305.11"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge982" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8291.55,-1355.69C8294.55,-1355.43 8297.54,-1355.18 8300.5,-1354.95 9090.6,-1293.56 11076.4,-1380.33 11866.5,-1318.95 11917.7,-1314.98 11971.87,-1308.82 12024.35,-1301.83"/>
<polygon fill="black" stroke="black" points="12025.03,-1305.27 12034.48,-1300.46 12024.1,-1298.33 12025.03,-1305.27"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge983" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8291.55,-1355.68C8294.55,-1355.42 8297.53,-1355.18 8300.5,-1354.95 9294.06,-1278.79 11790.94,-1395.1 12784.5,-1318.95 12835.7,-1315.03 12889.87,-1308.9 12942.36,-1301.92"/>
<polygon fill="black" stroke="black" points="12943.04,-1305.36 12952.49,-1300.55 12942.11,-1298.42 12943.04,-1305.36"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge984" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8291.55,-1355.67C8294.55,-1355.42 8297.53,-1355.18 8300.5,-1354.95 9497.52,-1264.01 12505.48,-1409.87 13702.5,-1318.95 13753.8,-1315.06 13808.08,-1308.93 13860.65,-1301.94"/>
<polygon fill="black" stroke="black" points="13861.35,-1305.37 13870.8,-1300.57 13860.42,-1298.44 13861.35,-1305.37"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge985" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8291.55,-1355.67C8294.55,-1355.42 8297.53,-1355.18 8300.5,-1354.95 9700.98,-1249.23 13220.01,-1424.64 14620.5,-1318.95 14671.8,-1315.08 14726.08,-1308.97 14778.66,-1301.98"/>
<polygon fill="black" stroke="black" points="14779.36,-1305.42 14788.8,-1300.62 14778.42,-1298.48 14779.36,-1305.42"/>
</g>
<!-- l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge986" class="edge">
<title>l2_expert_5_gpu5&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8291.55,-1355.67C8294.55,-1355.41 8297.53,-1355.18 8300.5,-1354.95 9102.47,-1294.71 14736.53,-1379.18 15538.5,-1318.95 15589.8,-1315.1 15644.08,-1309 15696.66,-1302.01"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.45 15706.8,-1300.65 15696.43,-1298.51 15697.36,-1305.45"/>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert_5_gpu5 -->
<g id="edge969" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert_5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7248.9,-1480.82C7307.83,-1472.99 7369,-1465.33 7426.5,-1458.95 7610.3,-1438.56 7659.78,-1444.35 7847.23,-1423.07"/>
<polygon fill="black" stroke="black" points="7847.89,-1426.52 7857.42,-1421.9 7847.09,-1419.57 7847.89,-1426.52"/>
</g>
<!-- l2_expert_agg_gpu5&#45;&gt;l2_res2_gpu5 -->
<g id="edge987" class="edge">
<title>l2_expert_agg_gpu5&#45;&gt;l2_res2_gpu5</title>
<path fill="none" stroke="black" d="M6467.7,-1182.95C6406.24,-1171.18 6344.58,-1159.37 6290.08,-1148.93"/>
<polygon fill="black" stroke="black" points="6290.47,-1145.44 6279.99,-1146.99 6289.15,-1152.31 6290.47,-1145.44"/>
</g>
<!-- l3_mha_qkv_gpu5 -->
<g id="node426" class="node">
<title>l3_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6214,-1042.95 5733,-1042.95 5733,-974.95 6214,-974.95 6214,-1042.95"/>
<text text-anchor="middle" x="5973.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5973.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5973.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5973.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu5&#45;&gt;l3_mha_qkv_gpu5 -->
<g id="edge1379" class="edge">
<title>l2_res2_gpu5&#45;&gt;l3_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M6063.99,-1078.84C6051.71,-1069.48 6038.21,-1059.21 6025.48,-1049.52"/>
<polygon fill="black" stroke="black" points="6027.32,-1046.52 6017.25,-1043.25 6023.08,-1052.09 6027.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu5 -->
<g id="node429" class="node">
<title>l3_mha_res_add_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6326.5,-730.95 5892.5,-730.95 5892.5,-662.95 6326.5,-662.95 6326.5,-730.95"/>
<text text-anchor="middle" x="6109.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6109.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6109.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6109.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu5&#45;&gt;l3_mha_res_add_gpu5 -->
<g id="edge1383" class="edge">
<title>l2_res2_gpu5&#45;&gt;l3_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6188.5,-1078.79C6202.51,-1069.33 6215.22,-1057.52 6223.5,-1042.95 6284.14,-936.32 6281.64,-873.31 6220.5,-766.95 6213.88,-755.43 6204.47,-745.57 6193.91,-737.21"/>
<polygon fill="black" stroke="black" points="6195.76,-734.23 6185.63,-731.11 6191.61,-739.86 6195.76,-734.23"/>
</g>
<!-- l2_mha_attn_gpu6 -->
<g id="node307" class="node">
<title>l2_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7545,-1906.95 7064,-1906.95 7064,-1838.95 7545,-1838.95 7545,-1906.95"/>
<text text-anchor="middle" x="7304.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7304.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7304.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7304.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu6&#45;&gt;l2_mha_attn_gpu6 -->
<g id="edge990" class="edge">
<title>l2_mha_qkv_gpu6&#45;&gt;l2_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M7304.5,-1942.84C7304.5,-1934.73 7304.5,-1925.94 7304.5,-1917.43"/>
<polygon fill="black" stroke="black" points="7308,-1917.25 7304.5,-1907.25 7301,-1917.25 7308,-1917.25"/>
</g>
<!-- l2_mha_out_gpu6 -->
<g id="node308" class="node">
<title>l2_mha_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7542,-1802.95 7073,-1802.95 7073,-1734.95 7542,-1734.95 7542,-1802.95"/>
<text text-anchor="middle" x="7307.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7307.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7307.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7307.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu6&#45;&gt;l2_mha_out_gpu6 -->
<g id="edge991" class="edge">
<title>l2_mha_attn_gpu6&#45;&gt;l2_mha_out_gpu6</title>
<path fill="none" stroke="black" d="M7305.47,-1838.84C7305.71,-1830.73 7305.97,-1821.94 7306.22,-1813.43"/>
<polygon fill="black" stroke="black" points="7309.73,-1813.35 7306.52,-1803.25 7302.73,-1813.15 7309.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu6&#45;&gt;l2_mha_res_add_gpu6 -->
<g id="edge992" class="edge">
<title>l2_mha_out_gpu6&#45;&gt;l2_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7350.68,-1734.84C7362.88,-1725.48 7376.27,-1715.21 7388.91,-1705.52"/>
<polygon fill="black" stroke="black" points="7391.28,-1708.12 7397.08,-1699.25 7387.02,-1702.56 7391.28,-1708.12"/>
</g>
<!-- l2_expert_6_gpu6 -->
<g id="node310" class="node">
<title>l2_expert_6_gpu6</title>
<polygon fill="lightpink" stroke="black" points="8743.5,-1422.95 8309.5,-1422.95 8309.5,-1354.95 8743.5,-1354.95 8743.5,-1422.95"/>
<text text-anchor="middle" x="8526.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8526.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="8526.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8526.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu6&#45;&gt;l2_expert_6_gpu6 -->
<g id="edge996" class="edge">
<title>l2_mha_res_add_gpu6&#45;&gt;l2_expert_6_gpu6</title>
<path fill="none" stroke="black" d="M7431.88,-1630.67C7422.23,-1584.79 7413.41,-1502.81 7459.5,-1458.95 7491.99,-1428.04 8192.77,-1427.34 8299.15,-1422.7"/>
<polygon fill="black" stroke="black" points="8299.67,-1426.18 8309.44,-1422.08 8299.25,-1419.19 8299.67,-1426.18"/>
</g>
<!-- l2_gate_gpu6 -->
<g id="node311" class="node">
<title>l2_gate_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="8420.24,-1594.95 7663.44,-1594.95 7468.76,-1458.95 8225.56,-1458.95 8420.24,-1594.95"/>
<text text-anchor="middle" x="7944.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7944.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7944.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7944.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu6&#45;&gt;l2_gate_gpu6 -->
<g id="edge994" class="edge">
<title>l2_mha_res_add_gpu6&#45;&gt;l2_gate_gpu6</title>
<path fill="none" stroke="black" d="M7562.83,-1630.94C7600.41,-1620.8 7643.28,-1609.23 7686.39,-1597.6"/>
<polygon fill="black" stroke="black" points="7687.43,-1600.95 7696.17,-1594.96 7685.61,-1594.19 7687.43,-1600.95"/>
</g>
<!-- l2_res2_gpu6 -->
<g id="node313" class="node">
<title>l2_res2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7332.5,-1146.95 6898.5,-1146.95 6898.5,-1078.95 7332.5,-1078.95 7332.5,-1146.95"/>
<text text-anchor="middle" x="7115.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7115.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7115.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7115.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu6&#45;&gt;l2_res2_gpu6 -->
<g id="edge1014" class="edge">
<title>l2_mha_res_add_gpu6&#45;&gt;l2_res2_gpu6</title>
<path fill="none" stroke="black" d="M7223.14,-1652.86C7066.26,-1645.32 6849.36,-1635.86 6658.5,-1630.95 6604.11,-1629.56 2786.85,-1625.01 2741.5,-1594.95 2686.58,-1558.55 2734.79,-1499.04 2682.5,-1458.95 2679.86,-1456.93 1737.67,-1321.47 1735.5,-1318.95 1696.01,-1273.19 1692.93,-1225.86 1735.5,-1182.95 1757.99,-1160.29 6301.58,-1147.75 6333.5,-1146.95 6520.26,-1142.28 6731.96,-1133.11 6887.95,-1125.62"/>
<polygon fill="black" stroke="black" points="6888.32,-1129.11 6898.14,-1125.13 6887.99,-1122.11 6888.32,-1129.11"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge997" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8309.45,-1355.67C8306.45,-1355.42 8303.47,-1355.18 8300.5,-1354.95 7056.49,-1260.6 3930.51,-1413.28 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.17 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge998" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8309.45,-1355.68C8306.45,-1355.42 8303.47,-1355.18 8300.5,-1354.95 7259.95,-1275.37 4645.05,-1398.51 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.17 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge999" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8309.45,-1355.69C8306.45,-1355.43 8303.47,-1355.18 8300.5,-1354.95 7463.41,-1290.15 5359.59,-1383.74 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.16 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1000" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8309.45,-1355.7C8306.45,-1355.44 8303.46,-1355.19 8300.5,-1354.95 7033.23,-1254.9 6707.77,-1418.98 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.78,-1315.47 5430.53,-1318.14 5440.21,-1322.44 5440.78,-1315.47"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1001" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8309.45,-1355.72C8306.45,-1355.45 8303.46,-1355.2 8300.5,-1354.95 7440.12,-1284.45 7218.88,-1389.44 6358.5,-1318.95 6358.4,-1318.94 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.79,-1315.47 6348.53,-1318.11 6358.2,-1322.44 6358.79,-1315.47"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1002" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8309.44,-1355.79C8306.44,-1355.5 8303.46,-1355.22 8300.5,-1354.95 7846.95,-1313.99 7730.05,-1359.9 7276.5,-1318.95 7276.39,-1318.94 7276.29,-1318.93 7276.18,-1318.92"/>
<polygon fill="black" stroke="black" points="7276.51,-1315.44 7266.24,-1318.01 7275.87,-1322.41 7276.51,-1315.44"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1003" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8334.52,-1354.94C8274.04,-1344.55 8204.85,-1332.65 8135.47,-1320.72"/>
<polygon fill="black" stroke="black" points="8135.68,-1317.21 8125.23,-1318.96 8134.49,-1324.11 8135.68,-1317.21"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1004" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8557.57,-1354.68C8565.58,-1346.1 8574.54,-1336.5 8583.68,-1326.72"/>
<polygon fill="black" stroke="black" points="8586.42,-1328.91 8590.69,-1319.22 8581.3,-1324.14 8586.42,-1328.91"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1005" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8743.59,-1356.06C8746.58,-1355.69 8749.55,-1355.32 8752.5,-1354.95 8912.1,-1335.33 8952.9,-1338.57 9112.5,-1318.95 9162.14,-1312.85 9214.72,-1305.77 9265.88,-1298.53"/>
<polygon fill="black" stroke="black" points="9266.68,-1301.96 9276.09,-1297.09 9265.69,-1295.02 9266.68,-1301.96"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1006" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8743.55,-1355.76C8746.55,-1355.48 8749.54,-1355.21 8752.5,-1354.95 9318.6,-1305.82 9464.4,-1368.07 10030.5,-1318.95 10081.38,-1314.54 10135.21,-1308.2 10187.42,-1301.16"/>
<polygon fill="black" stroke="black" points="10188.05,-1304.61 10197.49,-1299.79 10187.11,-1297.67 10188.05,-1304.61"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1007" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8743.55,-1355.71C8746.55,-1355.45 8749.54,-1355.19 8752.5,-1354.95 9725.45,-1276.27 9975.54,-1397.61 10948.5,-1318.95 10999.59,-1314.82 11053.65,-1308.6 11106.04,-1301.59"/>
<polygon fill="black" stroke="black" points="11106.71,-1305.03 11116.15,-1300.23 11105.77,-1298.1 11106.71,-1305.03"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1008" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8743.55,-1355.69C8746.55,-1355.43 8749.54,-1355.19 8752.5,-1354.95 9442.43,-1300.84 11176.57,-1373.05 11866.5,-1318.95 11917.69,-1314.94 11971.86,-1308.77 12024.35,-1301.76"/>
<polygon fill="black" stroke="black" points="12025.03,-1305.2 12034.47,-1300.4 12024.1,-1298.27 12025.03,-1305.2"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1009" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8743.55,-1355.68C8746.55,-1355.43 8749.53,-1355.18 8752.5,-1354.95 9645.88,-1286.06 11891.11,-1387.82 12784.5,-1318.95 12835.7,-1315.01 12889.87,-1308.87 12942.36,-1301.88"/>
<polygon fill="black" stroke="black" points="12943.04,-1305.32 12952.48,-1300.51 12942.11,-1298.38 12943.04,-1305.32"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1010" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8743.55,-1355.68C8746.55,-1355.42 8749.53,-1355.18 8752.5,-1354.95 9849.34,-1271.29 12605.66,-1402.59 13702.5,-1318.95 13753.7,-1315.05 13807.88,-1308.93 13860.36,-1301.95"/>
<polygon fill="black" stroke="black" points="13861.04,-1305.39 13870.49,-1300.59 13860.11,-1298.45 13861.04,-1305.39"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1011" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8743.55,-1355.67C8746.55,-1355.42 8749.53,-1355.18 8752.5,-1354.95 10052.8,-1256.51 13320.19,-1417.37 14620.5,-1318.95 14671.8,-1315.07 14726.08,-1308.95 14778.66,-1301.96"/>
<polygon fill="black" stroke="black" points="14779.35,-1305.4 14788.8,-1300.6 14778.42,-1298.46 14779.35,-1305.4"/>
</g>
<!-- l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1012" class="edge">
<title>l2_expert_6_gpu6&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8743.55,-1355.67C8746.55,-1355.42 8749.53,-1355.18 8752.5,-1354.95 9504.38,-1298.34 14786.62,-1375.55 15538.5,-1318.95 15589.8,-1315.09 15644.08,-1308.99 15696.66,-1302"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.43 15706.8,-1300.63 15696.42,-1298.5 15697.36,-1305.43"/>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert_6_gpu6 -->
<g id="edge995" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert_6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8226.98,-1459.95C8278.11,-1448 8329.59,-1435.97 8375.1,-1425.33"/>
<polygon fill="black" stroke="black" points="8376.08,-1428.7 8385.02,-1423.01 8374.49,-1421.88 8376.08,-1428.7"/>
</g>
<!-- l2_expert_agg_gpu6&#45;&gt;l2_res2_gpu6 -->
<g id="edge1013" class="edge">
<title>l2_expert_agg_gpu6&#45;&gt;l2_res2_gpu6</title>
<path fill="none" stroke="black" d="M7430.04,-1182.95C7376.82,-1171.28 7323.42,-1159.56 7276.12,-1149.19"/>
<polygon fill="black" stroke="black" points="7276.64,-1145.72 7266.12,-1146.99 7275.14,-1152.55 7276.64,-1145.72"/>
</g>
<!-- l3_mha_qkv_gpu6 -->
<g id="node434" class="node">
<title>l3_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7222,-1042.95 6741,-1042.95 6741,-974.95 7222,-974.95 7222,-1042.95"/>
<text text-anchor="middle" x="6981.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6981.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="6981.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6981.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu6&#45;&gt;l3_mha_qkv_gpu6 -->
<g id="edge1405" class="edge">
<title>l2_res2_gpu6&#45;&gt;l3_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M7071.99,-1078.84C7059.71,-1069.48 7046.21,-1059.21 7033.48,-1049.52"/>
<polygon fill="black" stroke="black" points="7035.32,-1046.52 7025.25,-1043.25 7031.08,-1052.09 7035.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu6 -->
<g id="node437" class="node">
<title>l3_mha_res_add_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7334.5,-730.95 6900.5,-730.95 6900.5,-662.95 7334.5,-662.95 7334.5,-730.95"/>
<text text-anchor="middle" x="7117.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7117.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7117.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7117.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu6&#45;&gt;l3_mha_res_add_gpu6 -->
<g id="edge1409" class="edge">
<title>l2_res2_gpu6&#45;&gt;l3_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7196.5,-1078.79C7210.51,-1069.33 7223.22,-1057.52 7231.5,-1042.95 7292.14,-936.32 7289.64,-873.31 7228.5,-766.95 7221.88,-755.43 7212.47,-745.57 7201.91,-737.21"/>
<polygon fill="black" stroke="black" points="7203.76,-734.23 7193.63,-731.11 7199.61,-739.86 7203.76,-734.23"/>
</g>
<!-- l2_mha_attn_gpu7 -->
<g id="node315" class="node">
<title>l2_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8553,-1906.95 8072,-1906.95 8072,-1838.95 8553,-1838.95 8553,-1906.95"/>
<text text-anchor="middle" x="8312.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8312.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8312.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8312.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu7&#45;&gt;l2_mha_attn_gpu7 -->
<g id="edge1016" class="edge">
<title>l2_mha_qkv_gpu7&#45;&gt;l2_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M8312.5,-1942.84C8312.5,-1934.73 8312.5,-1925.94 8312.5,-1917.43"/>
<polygon fill="black" stroke="black" points="8316,-1917.25 8312.5,-1907.25 8309,-1917.25 8316,-1917.25"/>
</g>
<!-- l2_mha_out_gpu7 -->
<g id="node316" class="node">
<title>l2_mha_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8550,-1802.95 8081,-1802.95 8081,-1734.95 8550,-1734.95 8550,-1802.95"/>
<text text-anchor="middle" x="8315.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8315.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8315.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="8315.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu7&#45;&gt;l2_mha_out_gpu7 -->
<g id="edge1017" class="edge">
<title>l2_mha_attn_gpu7&#45;&gt;l2_mha_out_gpu7</title>
<path fill="none" stroke="black" d="M8313.47,-1838.84C8313.71,-1830.73 8313.97,-1821.94 8314.22,-1813.43"/>
<polygon fill="black" stroke="black" points="8317.73,-1813.35 8314.52,-1803.25 8310.73,-1813.15 8317.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu7&#45;&gt;l2_mha_res_add_gpu7 -->
<g id="edge1018" class="edge">
<title>l2_mha_out_gpu7&#45;&gt;l2_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8358.68,-1734.84C8370.88,-1725.48 8384.27,-1715.21 8396.91,-1705.52"/>
<polygon fill="black" stroke="black" points="8399.28,-1708.12 8405.08,-1699.25 8395.02,-1702.56 8399.28,-1708.12"/>
</g>
<!-- l2_expert_7_gpu7 -->
<g id="node318" class="node">
<title>l2_expert_7_gpu7</title>
<polygon fill="lightpink" stroke="black" points="9195.5,-1422.95 8761.5,-1422.95 8761.5,-1354.95 9195.5,-1354.95 9195.5,-1422.95"/>
<text text-anchor="middle" x="8978.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8978.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8978.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8978.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu7&#45;&gt;l2_expert_7_gpu7 -->
<g id="edge1022" class="edge">
<title>l2_mha_res_add_gpu7&#45;&gt;l2_expert_7_gpu7</title>
<path fill="none" stroke="black" d="M8440.32,-1630.81C8431.31,-1585.47 8423.39,-1504.55 8467.5,-1458.95 8509.89,-1415.13 8673.58,-1430.03 8751.06,-1422.9"/>
<polygon fill="black" stroke="black" points="8751.85,-1426.33 8761.4,-1421.74 8751.07,-1419.37 8751.85,-1426.33"/>
</g>
<!-- l2_gate_gpu7 -->
<g id="node319" class="node">
<title>l2_gate_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="9428.24,-1594.95 8671.44,-1594.95 8476.76,-1458.95 9233.56,-1458.95 9428.24,-1594.95"/>
<text text-anchor="middle" x="8952.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8952.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8952.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8952.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu7&#45;&gt;l2_gate_gpu7 -->
<g id="edge1020" class="edge">
<title>l2_mha_res_add_gpu7&#45;&gt;l2_gate_gpu7</title>
<path fill="none" stroke="black" d="M8570.83,-1630.94C8608.41,-1620.8 8651.28,-1609.23 8694.39,-1597.6"/>
<polygon fill="black" stroke="black" points="8695.43,-1600.95 8704.17,-1594.96 8693.61,-1594.19 8695.43,-1600.95"/>
</g>
<!-- l2_res2_gpu7 -->
<g id="node321" class="node">
<title>l2_res2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8340.5,-1146.95 7906.5,-1146.95 7906.5,-1078.95 8340.5,-1078.95 8340.5,-1146.95"/>
<text text-anchor="middle" x="8123.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8123.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8123.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8123.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu7&#45;&gt;l2_res2_gpu7 -->
<g id="edge1040" class="edge">
<title>l2_mha_res_add_gpu7&#45;&gt;l2_res2_gpu7</title>
<path fill="none" stroke="black" d="M8231.14,-1652.91C8074.26,-1645.4 7857.35,-1635.95 7666.5,-1630.95 7470.11,-1625.81 4324.38,-1626.64 4130.5,-1594.95 3937.28,-1563.37 3903.66,-1496.49 3711.5,-1458.95 3704.86,-1457.66 1773.11,-1323.91 1768.5,-1318.95 1727.32,-1274.7 1725.9,-1225.83 1768.5,-1182.95 1795.78,-1155.5 7302.81,-1147.89 7341.5,-1146.95 7528.26,-1142.41 7739.96,-1133.23 7895.95,-1125.7"/>
<polygon fill="black" stroke="black" points="7896.33,-1129.19 7906.15,-1125.21 7895.99,-1122.2 7896.33,-1129.19"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1023" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8761.45,-1355.67C8758.45,-1355.42 8755.47,-1355.18 8752.5,-1354.95 7408.31,-1253.32 4030.69,-1420.55 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.17 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1024" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8761.45,-1355.67C8758.45,-1355.42 8755.47,-1355.18 8752.5,-1354.95 7611.77,-1268.1 4745.23,-1405.78 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.17 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1025" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8761.45,-1355.68C8758.45,-1355.42 8755.47,-1355.18 8752.5,-1354.95 7815.23,-1282.87 5459.77,-1391.01 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.16 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1026" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8761.45,-1355.69C8758.45,-1355.43 8755.46,-1355.18 8752.5,-1354.95 8018.69,-1297.65 6174.31,-1376.24 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.78,-1315.47 5430.53,-1318.15 5440.21,-1322.44 5440.78,-1315.47"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1027" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8761.45,-1355.71C8758.45,-1355.44 8755.46,-1355.19 8752.5,-1354.95 7691.78,-1269.9 7419.22,-1403.98 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.78,-1315.47 6348.53,-1318.13 6358.21,-1322.44 6358.78,-1315.47"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1028" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8761.45,-1355.75C8758.45,-1355.47 8755.46,-1355.2 8752.5,-1354.95 8098.66,-1299.45 7930.34,-1374.44 7276.5,-1318.95 7276.39,-1318.94 7276.29,-1318.94 7276.18,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.5,-1315.44 7266.23,-1318.06 7275.89,-1322.41 7276.5,-1315.44"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1029" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8761.43,-1355.92C8758.44,-1355.59 8755.46,-1355.26 8752.5,-1354.95 8505.35,-1328.98 8441.66,-1344.92 8194.5,-1318.95 8194.39,-1318.94 8194.28,-1318.93 8194.17,-1318.92"/>
<polygon fill="black" stroke="black" points="8194.26,-1315.41 8183.95,-1317.83 8193.52,-1322.37 8194.26,-1315.41"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1030" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8899.41,-1354.86C8876.13,-1345.12 8849.72,-1334.06 8823.06,-1322.91"/>
<polygon fill="black" stroke="black" points="8824.19,-1319.59 8813.62,-1318.96 8821.49,-1326.05 8824.19,-1319.59"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1031" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9122.43,-1354.94C9172.9,-1343.37 9231.48,-1329.93 9289.33,-1316.67"/>
<polygon fill="black" stroke="black" points="9290.39,-1320.01 9299.36,-1314.37 9288.83,-1313.19 9290.39,-1320.01"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1032" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9195.56,-1355.83C9198.56,-1355.53 9201.54,-1355.23 9204.5,-1354.95 9570.33,-1320.36 9664.67,-1353.54 10030.5,-1318.95 10081.15,-1314.17 10134.76,-1307.66 10186.78,-1300.58"/>
<polygon fill="black" stroke="black" points="10187.38,-1304.03 10196.81,-1299.2 10186.43,-1297.09 10187.38,-1304.03"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1033" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9195.55,-1355.73C9198.55,-1355.46 9201.54,-1355.2 9204.5,-1354.95 9977.12,-1290.82 10175.88,-1383.07 10948.5,-1318.95 10999.49,-1314.72 11053.44,-1308.46 11105.74,-1301.45"/>
<polygon fill="black" stroke="black" points="11106.39,-1304.89 11115.83,-1300.08 11105.45,-1297.95 11106.39,-1304.89"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1034" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9195.55,-1355.7C9198.55,-1355.44 9201.54,-1355.19 9204.5,-1354.95 10384,-1261.27 10686.99,-1412.61 11866.5,-1318.95 11917.69,-1314.89 11971.86,-1308.69 12024.34,-1301.68"/>
<polygon fill="black" stroke="black" points="12025.02,-1305.12 12034.47,-1300.31 12024.09,-1298.18 12025.02,-1305.12"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1035" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9195.55,-1355.69C9198.55,-1355.43 9201.54,-1355.18 9204.5,-1354.95 9997.71,-1293.34 11991.29,-1380.55 12784.5,-1318.95 12835.7,-1314.98 12889.87,-1308.83 12942.35,-1301.83"/>
<polygon fill="black" stroke="black" points="12943.04,-1305.27 12952.48,-1300.46 12942.1,-1298.33 12943.04,-1305.27"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1036" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9195.55,-1355.68C9198.55,-1355.42 9201.53,-1355.18 9204.5,-1354.95 10201.16,-1278.56 12705.83,-1395.32 13702.5,-1318.95 13753.7,-1315.03 13807.87,-1308.9 13860.36,-1301.92"/>
<polygon fill="black" stroke="black" points="13861.04,-1305.36 13870.49,-1300.56 13860.11,-1298.42 13861.04,-1305.36"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1037" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9195.55,-1355.67C9198.55,-1355.42 9201.53,-1355.18 9204.5,-1354.95 10404.62,-1263.79 13420.37,-1410.09 14620.5,-1318.95 14671.8,-1315.06 14726.08,-1308.93 14778.65,-1301.94"/>
<polygon fill="black" stroke="black" points="14779.35,-1305.37 14788.8,-1300.57 14778.42,-1298.44 14779.35,-1305.37"/>
</g>
<!-- l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1038" class="edge">
<title>l2_expert_7_gpu7&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9195.55,-1355.67C9198.55,-1355.42 9201.53,-1355.18 9204.5,-1354.95 10608.09,-1249.01 14134.91,-1424.86 15538.5,-1318.95 15589.8,-1315.08 15644.08,-1308.97 15696.66,-1301.98"/>
<polygon fill="black" stroke="black" points="15697.36,-1305.42 15706.8,-1300.62 15696.42,-1298.48 15697.36,-1305.42"/>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert_7_gpu7 -->
<g id="edge1021" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert_7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8965.35,-1458.75C8967.02,-1450 8968.7,-1441.23 8970.27,-1433.02"/>
<polygon fill="black" stroke="black" points="8973.75,-1433.45 8972.19,-1422.97 8966.87,-1432.13 8973.75,-1433.45"/>
</g>
<!-- l2_expert_agg_gpu7&#45;&gt;l2_res2_gpu7 -->
<g id="edge1039" class="edge">
<title>l2_expert_agg_gpu7&#45;&gt;l2_res2_gpu7</title>
<path fill="none" stroke="black" d="M8392.38,-1182.95C8347.36,-1171.4 8302.19,-1159.81 8262.08,-1149.51"/>
<polygon fill="black" stroke="black" points="8262.81,-1146.09 8252.26,-1146.99 8261.07,-1152.87 8262.81,-1146.09"/>
</g>
<!-- l3_mha_qkv_gpu7 -->
<g id="node442" class="node">
<title>l3_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8230,-1042.95 7749,-1042.95 7749,-974.95 8230,-974.95 8230,-1042.95"/>
<text text-anchor="middle" x="7989.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7989.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="7989.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7989.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu7&#45;&gt;l3_mha_qkv_gpu7 -->
<g id="edge1431" class="edge">
<title>l2_res2_gpu7&#45;&gt;l3_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M8079.99,-1078.84C8067.71,-1069.48 8054.21,-1059.21 8041.48,-1049.52"/>
<polygon fill="black" stroke="black" points="8043.32,-1046.52 8033.25,-1043.25 8039.08,-1052.09 8043.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu7 -->
<g id="node445" class="node">
<title>l3_mha_res_add_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8342.5,-730.95 7908.5,-730.95 7908.5,-662.95 8342.5,-662.95 8342.5,-730.95"/>
<text text-anchor="middle" x="8125.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8125.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8125.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8125.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu7&#45;&gt;l3_mha_res_add_gpu7 -->
<g id="edge1435" class="edge">
<title>l2_res2_gpu7&#45;&gt;l3_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8204.5,-1078.79C8218.51,-1069.33 8231.22,-1057.52 8239.5,-1042.95 8300.14,-936.32 8297.64,-873.31 8236.5,-766.95 8229.88,-755.43 8220.47,-745.57 8209.91,-737.21"/>
<polygon fill="black" stroke="black" points="8211.76,-734.23 8201.63,-731.11 8207.61,-739.86 8211.76,-734.23"/>
</g>
<!-- l2_mha_attn_gpu8 -->
<g id="node323" class="node">
<title>l2_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10065,-1906.95 9584,-1906.95 9584,-1838.95 10065,-1838.95 10065,-1906.95"/>
<text text-anchor="middle" x="9824.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9824.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9824.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9824.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu8&#45;&gt;l2_mha_attn_gpu8 -->
<g id="edge1042" class="edge">
<title>l2_mha_qkv_gpu8&#45;&gt;l2_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M9824.5,-1942.84C9824.5,-1934.73 9824.5,-1925.94 9824.5,-1917.43"/>
<polygon fill="black" stroke="black" points="9828,-1917.25 9824.5,-1907.25 9821,-1917.25 9828,-1917.25"/>
</g>
<!-- l2_mha_out_gpu8 -->
<g id="node324" class="node">
<title>l2_mha_out_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10062,-1802.95 9593,-1802.95 9593,-1734.95 10062,-1734.95 10062,-1802.95"/>
<text text-anchor="middle" x="9827.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9827.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9827.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9827.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu8&#45;&gt;l2_mha_out_gpu8 -->
<g id="edge1043" class="edge">
<title>l2_mha_attn_gpu8&#45;&gt;l2_mha_out_gpu8</title>
<path fill="none" stroke="black" d="M9825.47,-1838.84C9825.71,-1830.73 9825.97,-1821.94 9826.22,-1813.43"/>
<polygon fill="black" stroke="black" points="9829.73,-1813.35 9826.52,-1803.25 9822.73,-1813.15 9829.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu8&#45;&gt;l2_mha_res_add_gpu8 -->
<g id="edge1044" class="edge">
<title>l2_mha_out_gpu8&#45;&gt;l2_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M9870.68,-1734.84C9882.88,-1725.48 9896.27,-1715.21 9908.91,-1705.52"/>
<polygon fill="black" stroke="black" points="9911.28,-1708.12 9917.08,-1699.25 9907.02,-1702.56 9911.28,-1708.12"/>
</g>
<!-- l2_expert_8_gpu8 -->
<g id="node326" class="node">
<title>l2_expert_8_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9647.5,-1422.95 9213.5,-1422.95 9213.5,-1354.95 9647.5,-1354.95 9647.5,-1422.95"/>
<text text-anchor="middle" x="9430.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="9430.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9430.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9430.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu8&#45;&gt;l2_expert_8_gpu8 -->
<g id="edge1048" class="edge">
<title>l2_mha_res_add_gpu8&#45;&gt;l2_expert_8_gpu8</title>
<path fill="none" stroke="black" d="M9743.36,-1656.89C9633.35,-1648.75 9514.85,-1631.47 9475.5,-1594.95 9463.68,-1583.99 9446.7,-1490.2 9437.34,-1433.35"/>
<polygon fill="black" stroke="black" points="9440.74,-1432.5 9435.68,-1423.2 9433.84,-1433.63 9440.74,-1432.5"/>
</g>
<!-- l2_gate_gpu8 -->
<g id="node327" class="node">
<title>l2_gate_gpu8</title>
<polygon fill="lightcyan" stroke="black" points="10436.24,-1594.95 9679.44,-1594.95 9484.76,-1458.95 10241.56,-1458.95 10436.24,-1594.95"/>
<text text-anchor="middle" x="9960.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9960.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9960.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9960.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu8&#45;&gt;l2_gate_gpu8 -->
<g id="edge1046" class="edge">
<title>l2_mha_res_add_gpu8&#45;&gt;l2_gate_gpu8</title>
<path fill="none" stroke="black" d="M9960.5,-1630.68C9960.5,-1622.86 9960.5,-1614.19 9960.5,-1605.31"/>
<polygon fill="black" stroke="black" points="9964,-1605.22 9960.5,-1595.22 9957,-1605.22 9964,-1605.22"/>
</g>
<!-- l2_res2_gpu8 -->
<g id="node329" class="node">
<title>l2_res2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="9854.5,-1146.95 9420.5,-1146.95 9420.5,-1078.95 9854.5,-1078.95 9854.5,-1146.95"/>
<text text-anchor="middle" x="9637.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9637.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9637.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9637.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu8&#45;&gt;l2_res2_gpu8 -->
<g id="edge1066" class="edge">
<title>l2_mha_res_add_gpu8&#45;&gt;l2_res2_gpu8</title>
<path fill="none" stroke="black" d="M10177.76,-1657.53C10426.74,-1650.33 10847.03,-1638.66 11208.5,-1630.95 11270.24,-1629.64 13381.98,-1631.85 13431.5,-1594.95 13482.33,-1557.08 13427.28,-1501.25 13474.5,-1458.95 13651.04,-1300.83 13761.82,-1379.9 13997.5,-1354.95 14065.43,-1347.76 16408.55,-1367.61 16456.5,-1318.95 16498.93,-1275.9 16499.11,-1225.83 16456.5,-1182.95 16428.56,-1154.84 10789.13,-1147.67 10749.5,-1146.95 10443.18,-1141.44 10089.53,-1130.09 9864.81,-1122.25"/>
<polygon fill="black" stroke="black" points="9864.66,-1118.75 9854.54,-1121.89 9864.41,-1125.74 9864.66,-1118.75"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1049" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9213.45,-1355.67C9210.45,-1355.42 9207.47,-1355.18 9204.5,-1354.95 8482.32,-1300.5 3408.68,-1373.39 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1050" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9213.45,-1355.67C9210.45,-1355.42 9207.47,-1355.18 9204.5,-1354.95 7963.59,-1260.82 4845.41,-1413.05 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.17 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1051" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9213.45,-1355.68C9210.45,-1355.42 9207.47,-1355.18 9204.5,-1354.95 8167.06,-1275.6 5559.95,-1398.28 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.17 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1052" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9213.45,-1355.69C9210.45,-1355.43 9207.47,-1355.18 9204.5,-1354.95 8370.51,-1290.38 6274.49,-1383.51 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.16 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1053" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9213.45,-1355.7C9210.45,-1355.44 9207.46,-1355.19 9204.5,-1354.95 7943.44,-1255.35 7619.56,-1418.53 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.78,-1315.47 6348.53,-1318.14 6358.21,-1322.44 6358.78,-1315.47"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1054" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9213.45,-1355.72C9210.45,-1355.45 9207.46,-1355.2 9204.5,-1354.95 8350.33,-1284.9 8130.67,-1388.99 7276.5,-1318.95 7276.4,-1318.94 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.79,-1315.47 7266.53,-1318.11 7276.2,-1322.44 7276.79,-1315.47"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1055" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9213.44,-1355.79C9210.44,-1355.5 9207.46,-1355.22 9204.5,-1354.95 8757.16,-1314.44 8641.84,-1359.45 8194.5,-1318.95 8194.39,-1318.94 8194.29,-1318.93 8194.18,-1318.92"/>
<polygon fill="black" stroke="black" points="8194.52,-1315.44 8184.24,-1318 8193.87,-1322.41 8194.52,-1315.44"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1056" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9241.91,-1354.94C9182.51,-1344.55 9114.54,-1332.65 9046.39,-1320.72"/>
<polygon fill="black" stroke="black" points="9046.79,-1317.24 9036.33,-1318.96 9045.58,-1324.13 9046.79,-1317.24"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1057" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9464.99,-1354.68C9473.98,-1346.01 9484.04,-1336.32 9494.28,-1326.43"/>
<polygon fill="black" stroke="black" points="9497,-1328.68 9501.76,-1319.22 9492.14,-1323.64 9497,-1328.68"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1058" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9647.58,-1356.05C9650.57,-1355.68 9653.55,-1355.31 9656.5,-1354.95 9822.28,-1334.88 9864.72,-1339.02 10030.5,-1318.95 10080.16,-1312.94 10132.73,-1305.91 10183.9,-1298.69"/>
<polygon fill="black" stroke="black" points="10184.7,-1302.11 10194.11,-1297.25 10183.72,-1295.18 10184.7,-1302.11"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1059" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9647.55,-1355.76C9650.55,-1355.48 9653.54,-1355.21 9656.5,-1354.95 10228.8,-1305.37 10376.2,-1368.52 10948.5,-1318.95 10999.38,-1314.55 11053.21,-1308.21 11105.42,-1301.17"/>
<polygon fill="black" stroke="black" points="11106.05,-1304.62 11115.49,-1299.81 11105.11,-1297.68 11106.05,-1304.62"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1060" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9647.55,-1355.71C9650.55,-1355.45 9653.54,-1355.19 9656.5,-1354.95 10635.66,-1275.82 10887.34,-1398.06 11866.5,-1318.95 11917.59,-1314.83 11971.65,-1308.61 12024.04,-1301.6"/>
<polygon fill="black" stroke="black" points="12024.71,-1305.04 12034.15,-1300.23 12023.77,-1298.1 12024.71,-1305.04"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1061" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9647.55,-1355.69C9650.55,-1355.43 9653.54,-1355.19 9656.5,-1354.95 10349.53,-1300.61 12091.47,-1373.28 12784.5,-1318.95 12835.69,-1314.94 12889.86,-1308.77 12942.35,-1301.77"/>
<polygon fill="black" stroke="black" points="12943.03,-1305.2 12952.47,-1300.4 12942.1,-1298.27 12943.03,-1305.2"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1062" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9647.55,-1355.68C9650.55,-1355.43 9653.53,-1355.18 9656.5,-1354.95 10552.99,-1285.84 12806.01,-1388.05 13702.5,-1318.95 13753.7,-1315.01 13807.87,-1308.87 13860.36,-1301.88"/>
<polygon fill="black" stroke="black" points="13861.04,-1305.32 13870.48,-1300.52 13860.11,-1298.38 13861.04,-1305.32"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1063" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9647.55,-1355.68C9650.55,-1355.42 9653.53,-1355.18 9656.5,-1354.95 10756.45,-1271.06 13520.55,-1402.82 14620.5,-1318.95 14671.7,-1315.05 14725.88,-1308.93 14778.36,-1301.95"/>
<polygon fill="black" stroke="black" points="14779.04,-1305.39 14788.49,-1300.59 14778.11,-1298.45 14779.04,-1305.39"/>
</g>
<!-- l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1064" class="edge">
<title>l2_expert_8_gpu8&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9647.55,-1355.67C9650.55,-1355.42 9653.53,-1355.18 9656.5,-1354.95 10959.91,-1256.28 14235.09,-1417.59 15538.5,-1318.95 15589.8,-1315.07 15644.08,-1308.95 15696.66,-1301.96"/>
<polygon fill="black" stroke="black" points="15697.35,-1305.4 15706.8,-1300.6 15696.42,-1298.46 15697.35,-1305.4"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_8_gpu8 -->
<g id="edge1047" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_8_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9699.38,-1458.95C9654.36,-1447.4 9609.19,-1435.81 9569.08,-1425.51"/>
<polygon fill="black" stroke="black" points="9569.81,-1422.09 9559.26,-1422.99 9568.07,-1428.87 9569.81,-1422.09"/>
</g>
<!-- l2_expert_agg_gpu8&#45;&gt;l2_res2_gpu8 -->
<g id="edge1065" class="edge">
<title>l2_expert_agg_gpu8&#45;&gt;l2_res2_gpu8</title>
<path fill="none" stroke="black" d="M9604.11,-1182.75C9608.5,-1173.71 9612.9,-1164.64 9617,-1156.2"/>
<polygon fill="black" stroke="black" points="9620.26,-1157.49 9621.48,-1146.97 9613.96,-1154.44 9620.26,-1157.49"/>
</g>
<!-- l3_mha_qkv_gpu8 -->
<g id="node450" class="node">
<title>l3_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="9743,-1042.95 9262,-1042.95 9262,-974.95 9743,-974.95 9743,-1042.95"/>
<text text-anchor="middle" x="9502.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9502.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9502.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9502.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu8&#45;&gt;l3_mha_qkv_gpu8 -->
<g id="edge1457" class="edge">
<title>l2_res2_gpu8&#45;&gt;l3_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M9593.67,-1078.84C9581.29,-1069.48 9567.7,-1059.21 9554.87,-1049.52"/>
<polygon fill="black" stroke="black" points="9556.66,-1046.49 9546.57,-1043.25 9552.44,-1052.07 9556.66,-1046.49"/>
</g>
<!-- l3_mha_res_add_gpu8 -->
<g id="node453" class="node">
<title>l3_mha_res_add_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="9854.5,-730.95 9420.5,-730.95 9420.5,-662.95 9854.5,-662.95 9854.5,-730.95"/>
<text text-anchor="middle" x="9637.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9637.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9637.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9637.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu8&#45;&gt;l3_mha_res_add_gpu8 -->
<g id="edge1461" class="edge">
<title>l2_res2_gpu8&#45;&gt;l3_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M9717.53,-1078.87C9731.53,-1069.38 9744.24,-1057.54 9752.5,-1042.95 9790.16,-976.43 9753.6,-947.39 9752.5,-870.95 9751.83,-824.72 9772.63,-807 9749.5,-766.95 9742.81,-755.37 9733.32,-745.48 9722.66,-737.1"/>
<polygon fill="black" stroke="black" points="9724.44,-734.07 9714.3,-730.99 9720.31,-739.72 9724.44,-734.07"/>
</g>
<!-- l2_mha_attn_gpu9 -->
<g id="node331" class="node">
<title>l2_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11541,-1906.95 11060,-1906.95 11060,-1838.95 11541,-1838.95 11541,-1906.95"/>
<text text-anchor="middle" x="11300.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11300.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11300.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11300.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu9&#45;&gt;l2_mha_attn_gpu9 -->
<g id="edge1068" class="edge">
<title>l2_mha_qkv_gpu9&#45;&gt;l2_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M11300.5,-1942.84C11300.5,-1934.73 11300.5,-1925.94 11300.5,-1917.43"/>
<polygon fill="black" stroke="black" points="11304,-1917.25 11300.5,-1907.25 11297,-1917.25 11304,-1917.25"/>
</g>
<!-- l2_mha_out_gpu9 -->
<g id="node332" class="node">
<title>l2_mha_out_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11538,-1802.95 11069,-1802.95 11069,-1734.95 11538,-1734.95 11538,-1802.95"/>
<text text-anchor="middle" x="11303.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11303.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11303.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11303.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu9&#45;&gt;l2_mha_out_gpu9 -->
<g id="edge1069" class="edge">
<title>l2_mha_attn_gpu9&#45;&gt;l2_mha_out_gpu9</title>
<path fill="none" stroke="black" d="M11301.47,-1838.84C11301.71,-1830.73 11301.97,-1821.94 11302.22,-1813.43"/>
<polygon fill="black" stroke="black" points="11305.73,-1813.35 11302.52,-1803.25 11298.73,-1813.15 11305.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu9&#45;&gt;l2_mha_res_add_gpu9 -->
<g id="edge1070" class="edge">
<title>l2_mha_out_gpu9&#45;&gt;l2_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11346.03,-1734.84C11358.04,-1725.48 11371.24,-1715.21 11383.68,-1705.52"/>
<polygon fill="black" stroke="black" points="11385.99,-1708.16 11391.73,-1699.25 11381.69,-1702.63 11385.99,-1708.16"/>
</g>
<!-- l2_expert_9_gpu9 -->
<g id="node334" class="node">
<title>l2_expert_9_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10099.5,-1422.95 9665.5,-1422.95 9665.5,-1354.95 10099.5,-1354.95 10099.5,-1422.95"/>
<text text-anchor="middle" x="9882.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="9882.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9882.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9882.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu9&#45;&gt;l2_expert_9_gpu9 -->
<g id="edge1074" class="edge">
<title>l2_mha_res_add_gpu9&#45;&gt;l2_expert_9_gpu9</title>
<path fill="none" stroke="black" d="M11443.21,-1630.57C11452.97,-1584.57 11461.92,-1502.46 11415.5,-1458.95 11364.1,-1410.79 10251.38,-1428.07 10109.9,-1422.72"/>
<polygon fill="black" stroke="black" points="10109.73,-1419.2 10099.55,-1422.15 10109.35,-1426.19 10109.73,-1419.2"/>
</g>
<!-- l2_gate_gpu9 -->
<g id="node335" class="node">
<title>l2_gate_gpu9</title>
<polygon fill="lightcyan" stroke="black" points="11406.24,-1594.95 10649.44,-1594.95 10454.76,-1458.95 11211.56,-1458.95 11406.24,-1594.95"/>
<text text-anchor="middle" x="10930.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10930.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10930.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10930.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu9&#45;&gt;l2_gate_gpu9 -->
<g id="edge1072" class="edge">
<title>l2_mha_res_add_gpu9&#45;&gt;l2_gate_gpu9</title>
<path fill="none" stroke="black" d="M11312.17,-1630.94C11274.59,-1620.8 11231.72,-1609.23 11188.61,-1597.6"/>
<polygon fill="black" stroke="black" points="11189.39,-1594.19 11178.83,-1594.96 11187.57,-1600.95 11189.39,-1594.19"/>
</g>
<!-- l2_res2_gpu9 -->
<g id="node337" class="node">
<title>l2_res2_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="11192.5,-1146.95 10758.5,-1146.95 10758.5,-1078.95 11192.5,-1078.95 11192.5,-1146.95"/>
<text text-anchor="middle" x="10975.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10975.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10975.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10975.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu9&#45;&gt;l2_res2_gpu9 -->
<g id="edge1092" class="edge">
<title>l2_mha_res_add_gpu9&#45;&gt;l2_res2_gpu9</title>
<path fill="none" stroke="black" d="M11651.89,-1638.85C11684.89,-1635.74 11718.57,-1632.95 11750.5,-1630.95 11798.08,-1627.97 13428.05,-1623.15 13466.5,-1594.95 13517.95,-1557.22 13461.91,-1497.84 13512.5,-1458.95 13547.13,-1432.33 15037.87,-1356.96 15081.5,-1354.95 15120.47,-1353.16 16458.27,-1346.89 16485.5,-1318.95 16527.69,-1275.67 16528.09,-1225.84 16485.5,-1182.95 16460.08,-1157.36 11327.51,-1148.95 11291.5,-1146.95 11262.8,-1145.36 11232.69,-1143.05 11202.94,-1140.37"/>
<polygon fill="black" stroke="black" points="11203.14,-1136.88 11192.86,-1139.45 11202.5,-1143.85 11203.14,-1136.88"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1075" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9665.45,-1355.67C9662.45,-1355.41 9659.47,-1355.18 9656.5,-1354.95 8884.23,-1296.86 3458.77,-1377.03 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.22,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1076" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9665.45,-1355.67C9662.45,-1355.42 9659.47,-1355.18 9656.5,-1354.95 8315.42,-1253.55 4945.59,-1420.33 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.17 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1077" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9665.45,-1355.67C9662.45,-1355.42 9659.47,-1355.18 9656.5,-1354.95 8518.88,-1268.32 5660.13,-1405.56 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.17 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1078" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9665.45,-1355.68C9662.45,-1355.42 9659.47,-1355.18 9656.5,-1354.95 8722.34,-1283.1 6374.67,-1390.78 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.16 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1079" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9665.45,-1355.69C9662.45,-1355.43 9659.46,-1355.18 9656.5,-1354.95 8925.79,-1297.88 7089.21,-1376.01 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.78,-1315.47 6348.53,-1318.15 6358.21,-1322.44 6358.78,-1315.47"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1080" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9665.45,-1355.71C9662.45,-1355.44 9659.46,-1355.19 9656.5,-1354.95 8601.99,-1270.35 8331.01,-1403.53 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.78,-1315.47 7266.53,-1318.13 7276.21,-1322.44 7276.78,-1315.47"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1081" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9665.45,-1355.75C9662.45,-1355.47 9659.46,-1355.21 9656.5,-1354.95 9008.86,-1299.9 8842.14,-1373.99 8194.5,-1318.95 8194.39,-1318.94 8194.29,-1318.94 8194.18,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.5,-1315.44 8184.23,-1318.06 8193.89,-1322.41 8194.5,-1315.44"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1082" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9665.43,-1355.92C9662.44,-1355.59 9659.46,-1355.27 9656.5,-1354.95 9415.54,-1329.43 9353.46,-1344.47 9112.5,-1318.95 9112.39,-1318.94 9112.28,-1318.93 9112.17,-1318.92"/>
<polygon fill="black" stroke="black" points="9112.26,-1315.41 9101.95,-1317.82 9111.52,-1322.37 9112.26,-1315.41"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1083" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9806.82,-1354.86C9784.64,-1345.16 9759.49,-1334.16 9734.09,-1323.05"/>
<polygon fill="black" stroke="black" points="9735.29,-1319.76 9724.72,-1318.96 9732.48,-1326.17 9735.29,-1319.76"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1084" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10029.83,-1354.94C10083.03,-1343.02 10145.05,-1329.13 10205.98,-1315.48"/>
<polygon fill="black" stroke="black" points="10206.76,-1318.89 10215.75,-1313.29 10205.22,-1312.06 10206.76,-1318.89"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1085" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10099.56,-1355.82C10102.56,-1355.52 10105.54,-1355.23 10108.5,-1354.95 10480.53,-1319.91 10576.47,-1353.99 10948.5,-1318.95 10999.15,-1314.18 11052.76,-1307.69 11104.78,-1300.61"/>
<polygon fill="black" stroke="black" points="11105.39,-1304.06 11114.82,-1299.23 11104.44,-1297.12 11105.39,-1304.06"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1086" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10099.55,-1355.73C10102.55,-1355.46 10105.54,-1355.2 10108.5,-1354.95 10887.32,-1290.37 11087.67,-1383.52 11866.5,-1318.95 11917.49,-1314.73 11971.44,-1308.47 12023.74,-1301.45"/>
<polygon fill="black" stroke="black" points="12024.39,-1304.9 12033.83,-1300.09 12023.45,-1297.96 12024.39,-1304.9"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1087" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10099.55,-1355.7C10102.55,-1355.44 10105.54,-1355.19 10108.5,-1354.95 11294.21,-1260.82 11598.79,-1413.06 12784.5,-1318.95 12835.69,-1314.89 12889.86,-1308.69 12942.34,-1301.68"/>
<polygon fill="black" stroke="black" points="12943.02,-1305.12 12952.47,-1300.31 12942.09,-1298.18 12943.02,-1305.12"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1088" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10099.55,-1355.69C10102.55,-1355.43 10105.54,-1355.18 10108.5,-1354.95 10904.81,-1293.11 12906.19,-1380.78 13702.5,-1318.95 13753.7,-1314.98 13807.87,-1308.83 13860.35,-1301.83"/>
<polygon fill="black" stroke="black" points="13861.04,-1305.27 13870.48,-1300.47 13860.1,-1298.33 13861.04,-1305.27"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1089" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10099.55,-1355.68C10102.55,-1355.42 10105.53,-1355.18 10108.5,-1354.95 11108.27,-1278.34 13620.73,-1395.55 14620.5,-1318.95 14671.7,-1315.03 14725.87,-1308.91 14778.36,-1301.92"/>
<polygon fill="black" stroke="black" points="14779.04,-1305.36 14788.49,-1300.56 14778.11,-1298.42 14779.04,-1305.36"/>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1090" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10099.55,-1355.67C10102.55,-1355.42 10105.53,-1355.18 10108.5,-1354.95 11311.73,-1263.56 14335.27,-1410.32 15538.5,-1318.95 15589.8,-1315.06 15644.08,-1308.93 15696.65,-1301.94"/>
<polygon fill="black" stroke="black" points="15697.35,-1305.38 15706.8,-1300.57 15696.42,-1298.44 15697.35,-1305.38"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_9_gpu9 -->
<g id="edge1073" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10456.62,-1460.32C10452.9,-1459.86 10449.19,-1459.41 10445.5,-1458.95 10299.2,-1441.04 10259.63,-1441.8 10109.63,-1423.08"/>
<polygon fill="black" stroke="black" points="10109.95,-1419.59 10099.59,-1421.82 10109.07,-1426.54 10109.95,-1419.59"/>
</g>
<!-- l2_expert_agg_gpu9&#45;&gt;l2_res2_gpu9 -->
<g id="edge1091" class="edge">
<title>l2_expert_agg_gpu9&#45;&gt;l2_res2_gpu9</title>
<path fill="none" stroke="black" d="M10728.94,-1182.95C10769.96,-1171.47 10811.12,-1159.95 10847.73,-1149.71"/>
<polygon fill="black" stroke="black" points="10848.75,-1153.06 10857.43,-1146.99 10846.86,-1146.32 10848.75,-1153.06"/>
</g>
<!-- l3_mha_qkv_gpu9 -->
<g id="node458" class="node">
<title>l3_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11151,-1042.95 10670,-1042.95 10670,-974.95 11151,-974.95 11151,-1042.95"/>
<text text-anchor="middle" x="10910.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10910.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10910.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10910.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu9&#45;&gt;l3_mha_qkv_gpu9 -->
<g id="edge1483" class="edge">
<title>l2_res2_gpu9&#45;&gt;l3_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M10954.4,-1078.84C10948.89,-1070.2 10942.88,-1060.77 10937.13,-1051.75"/>
<polygon fill="black" stroke="black" points="10940.05,-1049.8 10931.72,-1043.25 10934.14,-1053.57 10940.05,-1049.8"/>
</g>
<!-- l3_mha_res_add_gpu9 -->
<g id="node461" class="node">
<title>l3_mha_res_add_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="11328.5,-730.95 10894.5,-730.95 10894.5,-662.95 11328.5,-662.95 11328.5,-730.95"/>
<text text-anchor="middle" x="11111.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11111.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11111.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11111.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu9&#45;&gt;l3_mha_res_add_gpu9 -->
<g id="edge1487" class="edge">
<title>l2_res2_gpu9&#45;&gt;l3_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11120.45,-1078.75C11136.14,-1069.58 11150.14,-1057.88 11160.5,-1042.95 11230.46,-942.19 11194.74,-883.84 11157.5,-766.95 11154.52,-757.59 11149.85,-748.31 11144.61,-739.74"/>
<polygon fill="black" stroke="black" points="11147.38,-737.57 11139,-731.09 11141.51,-741.38 11147.38,-737.57"/>
</g>
<!-- l2_mha_attn_gpu10 -->
<g id="node339" class="node">
<title>l2_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12147,-1906.95 11666,-1906.95 11666,-1838.95 12147,-1838.95 12147,-1906.95"/>
<text text-anchor="middle" x="11906.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11906.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11906.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11906.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu10&#45;&gt;l2_mha_attn_gpu10 -->
<g id="edge1094" class="edge">
<title>l2_mha_qkv_gpu10&#45;&gt;l2_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M11906.5,-1942.84C11906.5,-1934.73 11906.5,-1925.94 11906.5,-1917.43"/>
<polygon fill="black" stroke="black" points="11910,-1917.25 11906.5,-1907.25 11903,-1917.25 11910,-1917.25"/>
</g>
<!-- l2_mha_out_gpu10 -->
<g id="node340" class="node">
<title>l2_mha_out_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12144,-1802.95 11675,-1802.95 11675,-1734.95 12144,-1734.95 12144,-1802.95"/>
<text text-anchor="middle" x="11909.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11909.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11909.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11909.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu10&#45;&gt;l2_mha_out_gpu10 -->
<g id="edge1095" class="edge">
<title>l2_mha_attn_gpu10&#45;&gt;l2_mha_out_gpu10</title>
<path fill="none" stroke="black" d="M11907.47,-1838.84C11907.71,-1830.73 11907.97,-1821.94 11908.22,-1813.43"/>
<polygon fill="black" stroke="black" points="11911.73,-1813.35 11908.52,-1803.25 11904.73,-1813.15 11911.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu10&#45;&gt;l2_mha_res_add_gpu10 -->
<g id="edge1096" class="edge">
<title>l2_mha_out_gpu10&#45;&gt;l2_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M11931.25,-1734.84C11936.93,-1726.2 11943.12,-1716.77 11949.05,-1707.75"/>
<polygon fill="black" stroke="black" points="11952.06,-1709.53 11954.63,-1699.25 11946.21,-1705.69 11952.06,-1709.53"/>
</g>
<!-- l2_expert_10_gpu10 -->
<g id="node342" class="node">
<title>l2_expert_10_gpu10</title>
<polygon fill="lightpink" stroke="black" points="10551.5,-1422.95 10117.5,-1422.95 10117.5,-1354.95 10551.5,-1354.95 10551.5,-1422.95"/>
<text text-anchor="middle" x="10334.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="10334.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10334.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10334.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu10&#45;&gt;l2_expert_10_gpu10 -->
<g id="edge1100" class="edge">
<title>l2_mha_res_add_gpu10&#45;&gt;l2_expert_10_gpu10</title>
<path fill="none" stroke="black" d="M11759.18,-1638.19C11635.3,-1622.64 11502.45,-1604.11 11491.5,-1594.95 11442.65,-1554.12 11497.34,-1497.28 11446.5,-1458.95 11408.7,-1430.46 10670.71,-1427.7 10561.65,-1422.71"/>
<polygon fill="black" stroke="black" points="10561.76,-1419.21 10551.56,-1422.09 10561.33,-1426.2 10561.76,-1419.21"/>
</g>
<!-- l2_gate_gpu10 -->
<g id="node343" class="node">
<title>l2_gate_gpu10</title>
<polygon fill="lightcyan" stroke="black" points="12452.24,-1594.95 11695.44,-1594.95 11500.76,-1458.95 12257.56,-1458.95 12452.24,-1594.95"/>
<text text-anchor="middle" x="11976.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11976.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11976.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11976.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu10&#45;&gt;l2_gate_gpu10 -->
<g id="edge1098" class="edge">
<title>l2_mha_res_add_gpu10&#45;&gt;l2_gate_gpu10</title>
<path fill="none" stroke="black" d="M11976.5,-1630.68C11976.5,-1622.86 11976.5,-1614.19 11976.5,-1605.31"/>
<polygon fill="black" stroke="black" points="11980,-1605.22 11976.5,-1595.22 11973,-1605.22 11980,-1605.22"/>
</g>
<!-- l2_res2_gpu10 -->
<g id="node345" class="node">
<title>l2_res2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="11734.5,-1146.95 11300.5,-1146.95 11300.5,-1078.95 11734.5,-1078.95 11734.5,-1146.95"/>
<text text-anchor="middle" x="11517.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11517.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11517.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11517.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu10&#45;&gt;l2_res2_gpu10 -->
<g id="edge1118" class="edge">
<title>l2_mha_res_add_gpu10&#45;&gt;l2_res2_gpu10</title>
<path fill="none" stroke="black" d="M12193.59,-1663.57C12587.23,-1661.51 13388.84,-1650.43 13503.5,-1594.95 13575.54,-1560.1 13549.39,-1493.65 13621.5,-1458.95 13710.08,-1416.33 14407.31,-1427.63 14505.5,-1422.95 15059.47,-1396.56 15197.61,-1383.13 15751.5,-1354.95 15793.88,-1352.8 16485.21,-1349.66 16514.5,-1318.95 16556.22,-1275.22 16557.03,-1225.91 16514.5,-1182.95 16479.42,-1147.52 12974.36,-1147.79 12924.5,-1146.95 12508.37,-1139.99 12023.11,-1127.68 11744.93,-1120.23"/>
<polygon fill="black" stroke="black" points="11744.8,-1116.72 11734.71,-1119.95 11744.62,-1123.72 11744.8,-1116.72"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1101" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10117.45,-1355.67C10114.45,-1355.41 10111.47,-1355.18 10108.5,-1354.95 9286.14,-1293.22 3508.86,-1380.66 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.23,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1102" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10117.45,-1355.67C10114.45,-1355.42 10111.47,-1355.18 10108.5,-1354.95 9387.87,-1300.61 4325.13,-1373.28 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.18 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1103" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10117.45,-1355.67C10114.45,-1355.42 10111.47,-1355.18 10108.5,-1354.95 8870.7,-1261.05 5760.3,-1412.83 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.17 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1104" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10117.45,-1355.68C10114.45,-1355.42 10111.47,-1355.18 10108.5,-1354.95 9074.16,-1275.82 6474.84,-1398.06 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.17 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1105" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10117.45,-1355.69C10114.45,-1355.43 10111.47,-1355.18 10108.5,-1354.95 9277.62,-1290.6 7189.38,-1383.29 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.77,-1315.46 6348.53,-1318.16 6358.22,-1322.44 6358.77,-1315.46"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1106" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10117.45,-1355.7C10114.45,-1355.44 10111.46,-1355.19 10108.5,-1354.95 8853.64,-1255.8 8531.36,-1418.08 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.78,-1315.47 7266.53,-1318.14 7276.21,-1322.44 7276.78,-1315.47"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1107" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10117.45,-1355.72C10114.45,-1355.45 10111.46,-1355.2 10108.5,-1354.95 9260.53,-1285.35 9042.47,-1388.54 8194.5,-1318.95 8194.39,-1318.94 8194.29,-1318.94 8194.18,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.49,-1315.44 8184.23,-1318.09 8193.9,-1322.42 8194.49,-1315.44"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1108" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10117.44,-1355.8C10114.44,-1355.5 10111.46,-1355.22 10108.5,-1354.95 9667.36,-1314.89 9553.64,-1359 9112.5,-1318.95 9112.39,-1318.94 9112.29,-1318.93 9112.18,-1318.92"/>
<polygon fill="black" stroke="black" points="9112.52,-1315.44 9102.24,-1318 9111.87,-1322.41 9112.52,-1315.44"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1109" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10149.31,-1354.94C10090.98,-1344.55 10024.23,-1332.65 9957.31,-1320.72"/>
<polygon fill="black" stroke="black" points="9957.9,-1317.27 9947.44,-1318.96 9956.67,-1324.16 9957.9,-1317.27"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1110" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10372.42,-1354.68C10382.49,-1345.85 10393.78,-1335.94 10405.27,-1325.86"/>
<polygon fill="black" stroke="black" points="10407.63,-1328.44 10412.84,-1319.22 10403.01,-1323.18 10407.63,-1328.44"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1111" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10551.58,-1356.03C10554.57,-1355.67 10557.55,-1355.31 10560.5,-1354.95 10732.47,-1334.43 10776.53,-1339.47 10948.5,-1318.95 10998.36,-1313 11051.17,-1305.98 11102.52,-1298.75"/>
<polygon fill="black" stroke="black" points="11103.02,-1302.22 11112.43,-1297.35 11102.04,-1295.29 11103.02,-1302.22"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1112" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10551.55,-1355.76C10554.55,-1355.48 10557.54,-1355.21 10560.5,-1354.95 11139.01,-1304.92 11287.99,-1368.97 11866.5,-1318.95 11917.38,-1314.55 11971.21,-1308.22 12023.42,-1301.19"/>
<polygon fill="black" stroke="black" points="12024.06,-1304.63 12033.49,-1299.82 12023.11,-1297.7 12024.06,-1304.63"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1113" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10551.55,-1355.71C10554.55,-1355.45 10557.54,-1355.19 10560.5,-1354.95 11545.87,-1275.37 11799.13,-1398.51 12784.5,-1318.95 12835.59,-1314.83 12889.65,-1308.61 12942.04,-1301.6"/>
<polygon fill="black" stroke="black" points="12942.71,-1305.04 12952.15,-1300.24 12941.77,-1298.11 12942.71,-1305.04"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1114" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10551.55,-1355.69C10554.55,-1355.43 10557.54,-1355.19 10560.5,-1354.95 11256.63,-1300.39 13006.37,-1373.5 13702.5,-1318.95 13753.69,-1314.94 13807.86,-1308.77 13860.35,-1301.77"/>
<polygon fill="black" stroke="black" points="13861.03,-1305.21 13870.47,-1300.4 13860.1,-1298.27 13861.03,-1305.21"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1115" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10551.55,-1355.68C10554.55,-1355.43 10557.53,-1355.18 10560.5,-1354.95 11460.09,-1285.61 13720.91,-1388.27 14620.5,-1318.95 14671.7,-1315.01 14725.87,-1308.87 14778.36,-1301.88"/>
<polygon fill="black" stroke="black" points="14779.04,-1305.32 14788.48,-1300.52 14778.11,-1298.38 14779.04,-1305.32"/>
</g>
<!-- l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1116" class="edge">
<title>l2_expert_10_gpu10&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10551.55,-1355.68C10554.55,-1355.42 10557.53,-1355.18 10560.5,-1354.95 11663.55,-1270.84 14435.45,-1403.05 15538.5,-1318.95 15589.7,-1315.05 15643.88,-1308.93 15696.36,-1301.95"/>
<polygon fill="black" stroke="black" points="15697.04,-1305.39 15706.49,-1300.59 15696.11,-1298.45 15697.04,-1305.39"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_10_gpu10 -->
<g id="edge1099" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_10_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11502.63,-1460.41C11497.22,-1459.91 11491.85,-1459.42 11486.5,-1458.95 11079.51,-1423.3 10972.35,-1460.16 10561.63,-1423.02"/>
<polygon fill="black" stroke="black" points="10561.84,-1419.52 10551.56,-1422.1 10561.2,-1426.49 10561.84,-1419.52"/>
</g>
<!-- l2_expert_agg_gpu10&#45;&gt;l2_res2_gpu10 -->
<g id="edge1117" class="edge">
<title>l2_expert_agg_gpu10&#45;&gt;l2_res2_gpu10</title>
<path fill="none" stroke="black" d="M11461.86,-1182.75C11469.56,-1173.22 11477.29,-1163.67 11484.42,-1154.85"/>
<polygon fill="black" stroke="black" points="11487.23,-1156.95 11490.8,-1146.97 11481.79,-1152.54 11487.23,-1156.95"/>
</g>
<!-- l3_mha_qkv_gpu10 -->
<g id="node466" class="node">
<title>l3_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="11713,-1042.95 11232,-1042.95 11232,-974.95 11713,-974.95 11713,-1042.95"/>
<text text-anchor="middle" x="11472.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11472.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11472.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11472.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu10&#45;&gt;l3_mha_qkv_gpu10 -->
<g id="edge1509" class="edge">
<title>l2_res2_gpu10&#45;&gt;l3_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M11502.89,-1078.84C11499.2,-1070.46 11495.18,-1061.35 11491.31,-1052.58"/>
<polygon fill="black" stroke="black" points="11494.43,-1050.99 11487.19,-1043.25 11488.03,-1053.81 11494.43,-1050.99"/>
</g>
<!-- l3_mha_res_add_gpu10 -->
<g id="node469" class="node">
<title>l3_mha_res_add_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="11870.5,-730.95 11436.5,-730.95 11436.5,-662.95 11870.5,-662.95 11870.5,-730.95"/>
<text text-anchor="middle" x="11653.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11653.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11653.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11653.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu10&#45;&gt;l3_mha_res_add_gpu10 -->
<g id="edge1513" class="edge">
<title>l2_res2_gpu10&#45;&gt;l3_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M11681.78,-1078.88C11697.63,-1069.65 11711.76,-1057.9 11722.5,-1042.95 11794.08,-943.33 11766.82,-880.13 11719.5,-766.95 11715.24,-756.77 11708.73,-747.21 11701.43,-738.64"/>
<polygon fill="black" stroke="black" points="11703.86,-736.11 11694.54,-731.07 11698.68,-740.82 11703.86,-736.11"/>
</g>
<!-- l2_mha_attn_gpu11 -->
<g id="node347" class="node">
<title>l2_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13671,-1906.95 13190,-1906.95 13190,-1838.95 13671,-1838.95 13671,-1906.95"/>
<text text-anchor="middle" x="13430.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13430.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13430.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13430.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu11&#45;&gt;l2_mha_attn_gpu11 -->
<g id="edge1120" class="edge">
<title>l2_mha_qkv_gpu11&#45;&gt;l2_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M13430.5,-1942.84C13430.5,-1934.73 13430.5,-1925.94 13430.5,-1917.43"/>
<polygon fill="black" stroke="black" points="13434,-1917.25 13430.5,-1907.25 13427,-1917.25 13434,-1917.25"/>
</g>
<!-- l2_mha_out_gpu11 -->
<g id="node348" class="node">
<title>l2_mha_out_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13668,-1802.95 13199,-1802.95 13199,-1734.95 13668,-1734.95 13668,-1802.95"/>
<text text-anchor="middle" x="13433.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13433.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13433.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13433.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu11&#45;&gt;l2_mha_out_gpu11 -->
<g id="edge1121" class="edge">
<title>l2_mha_attn_gpu11&#45;&gt;l2_mha_out_gpu11</title>
<path fill="none" stroke="black" d="M13431.47,-1838.84C13431.71,-1830.73 13431.97,-1821.94 13432.22,-1813.43"/>
<polygon fill="black" stroke="black" points="13435.73,-1813.35 13432.52,-1803.25 13428.73,-1813.15 13435.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu11&#45;&gt;l2_mha_res_add_gpu11 -->
<g id="edge1122" class="edge">
<title>l2_mha_out_gpu11&#45;&gt;l2_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M13476.03,-1734.84C13488.04,-1725.48 13501.24,-1715.21 13513.68,-1705.52"/>
<polygon fill="black" stroke="black" points="13515.99,-1708.16 13521.73,-1699.25 13511.69,-1702.63 13515.99,-1708.16"/>
</g>
<!-- l2_expert_11_gpu11 -->
<g id="node350" class="node">
<title>l2_expert_11_gpu11</title>
<polygon fill="lightpink" stroke="black" points="11003.5,-1422.95 10569.5,-1422.95 10569.5,-1354.95 11003.5,-1354.95 11003.5,-1422.95"/>
<text text-anchor="middle" x="10786.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="10786.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10786.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10786.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu11&#45;&gt;l2_expert_11_gpu11 -->
<g id="edge1126" class="edge">
<title>l2_mha_res_add_gpu11&#45;&gt;l2_expert_11_gpu11</title>
<path fill="none" stroke="black" d="M13554.11,-1630.65C13537.15,-1582.72 13498.51,-1496.01 13431.5,-1458.95 13374.18,-1427.26 11194.5,-1428.25 11013.55,-1422.65"/>
<polygon fill="black" stroke="black" points="11013.7,-1419.15 11003.55,-1422.2 11013.38,-1426.15 11013.7,-1419.15"/>
</g>
<!-- l2_gate_gpu11 -->
<g id="node351" class="node">
<title>l2_gate_gpu11</title>
<polygon fill="lightcyan" stroke="black" points="13422.24,-1594.95 12665.44,-1594.95 12470.76,-1458.95 13227.56,-1458.95 13422.24,-1594.95"/>
<text text-anchor="middle" x="12946.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12946.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12946.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12946.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu11&#45;&gt;l2_gate_gpu11 -->
<g id="edge1124" class="edge">
<title>l2_mha_res_add_gpu11&#45;&gt;l2_gate_gpu11</title>
<path fill="none" stroke="black" d="M13414.51,-1630.94C13367.84,-1620.68 13314.53,-1608.94 13260.99,-1597.16"/>
<polygon fill="black" stroke="black" points="13261.51,-1593.69 13250.99,-1594.96 13260.01,-1600.53 13261.51,-1593.69"/>
</g>
<!-- l2_res2_gpu11 -->
<g id="node353" class="node">
<title>l2_res2_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="13367.5,-1146.95 12933.5,-1146.95 12933.5,-1078.95 13367.5,-1078.95 13367.5,-1146.95"/>
<text text-anchor="middle" x="13150.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13150.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13150.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13150.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu11&#45;&gt;l2_res2_gpu11 -->
<g id="edge1144" class="edge">
<title>l2_mha_res_add_gpu11&#45;&gt;l2_res2_gpu11</title>
<path fill="none" stroke="black" d="M13781.89,-1638.87C13814.89,-1635.75 13848.57,-1632.96 13880.5,-1630.95 13973.73,-1625.1 15477.28,-1635.36 15561.5,-1594.95 15632.61,-1560.84 15606.84,-1497.77 15675.5,-1458.95 16024.06,-1261.87 16305.29,-1623.3 16565.5,-1318.95 16604.78,-1273.01 16607.98,-1225.95 16565.5,-1182.95 16536.75,-1153.85 13661.37,-1148.64 13620.5,-1146.95 13541.4,-1143.7 13454.94,-1138.18 13377.98,-1132.59"/>
<polygon fill="black" stroke="black" points="13377.9,-1129.08 13367.68,-1131.84 13377.39,-1136.06 13377.9,-1129.08"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1127" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10569.45,-1355.66C10566.45,-1355.41 10563.47,-1355.18 10560.5,-1354.95 9688.05,-1289.59 3558.95,-1384.3 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.23,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1128" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10569.45,-1355.67C10566.45,-1355.41 10563.47,-1355.18 10560.5,-1354.95 9789.78,-1296.98 4375.22,-1376.91 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.18 3604.22,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1129" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10569.45,-1355.67C10566.45,-1355.42 10563.47,-1355.18 10560.5,-1354.95 9222.52,-1253.77 5860.48,-1420.1 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.17 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1130" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10569.45,-1355.68C10566.45,-1355.42 10563.47,-1355.18 10560.5,-1354.95 9425.98,-1268.55 6575.02,-1405.33 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.17 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1131" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10569.45,-1355.68C10566.45,-1355.42 10563.47,-1355.18 10560.5,-1354.95 9629.44,-1283.33 7289.56,-1390.56 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.77,-1315.46 6348.53,-1318.16 6358.22,-1322.44 6358.77,-1315.46"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1132" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10569.45,-1355.69C10566.45,-1355.43 10563.46,-1355.18 10560.5,-1354.95 9832.9,-1298.1 8004.11,-1375.79 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.78,-1315.47 7266.53,-1318.15 7276.21,-1322.44 7276.78,-1315.47"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1133" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10569.45,-1355.71C10566.45,-1355.44 10563.46,-1355.19 10560.5,-1354.95 9512.2,-1270.8 9242.81,-1403.08 8194.5,-1318.95 8194.4,-1318.95 8194.29,-1318.94 8194.19,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.78,-1315.47 8184.53,-1318.13 8194.21,-1322.44 8194.78,-1315.47"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1134" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10569.45,-1355.75C10566.45,-1355.47 10563.46,-1355.21 10560.5,-1354.95 9919.07,-1300.35 9753.94,-1373.54 9112.5,-1318.95 9112.39,-1318.94 9112.29,-1318.94 9112.18,-1318.93"/>
<polygon fill="black" stroke="black" points="9112.5,-1315.44 9102.23,-1318.06 9111.89,-1322.41 9112.5,-1315.44"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1135" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10569.43,-1355.93C10566.43,-1355.59 10563.46,-1355.27 10560.5,-1354.95 10325.74,-1329.88 10265.26,-1344.02 10030.5,-1318.95 10030.39,-1318.94 10030.28,-1318.93 10030.17,-1318.92"/>
<polygon fill="black" stroke="black" points="10030.27,-1315.41 10019.95,-1317.81 10029.51,-1322.37 10030.27,-1315.41"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1136" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10714.23,-1354.86C10693.14,-1345.2 10669.24,-1334.26 10645.09,-1323.2"/>
<polygon fill="black" stroke="black" points="10646.37,-1319.94 10635.82,-1318.96 10643.46,-1326.3 10646.37,-1319.94"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1137" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10937.22,-1354.94C10993.14,-1342.7 11058.55,-1328.37 11122.51,-1314.37"/>
<polygon fill="black" stroke="black" points="11123.33,-1317.77 11132.35,-1312.21 11121.83,-1310.93 11123.33,-1317.77"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1138" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11003.56,-1355.82C11006.56,-1355.52 11009.54,-1355.23 11012.5,-1354.95 11390.73,-1319.46 11488.27,-1354.44 11866.5,-1318.95 11917.16,-1314.2 11970.77,-1307.71 12022.78,-1300.64"/>
<polygon fill="black" stroke="black" points="12023.39,-1304.09 12032.82,-1299.26 12022.44,-1297.15 12023.39,-1304.09"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1139" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11003.55,-1355.73C11006.55,-1355.46 11009.54,-1355.2 11012.5,-1354.95 11797.53,-1289.92 11999.47,-1383.97 12784.5,-1318.95 12835.49,-1314.73 12889.44,-1308.48 12941.74,-1301.46"/>
<polygon fill="black" stroke="black" points="12942.39,-1304.91 12951.83,-1300.1 12941.45,-1297.97 12942.39,-1304.91"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1140" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11003.55,-1355.7C11006.55,-1355.44 11009.54,-1355.19 11012.5,-1354.95 12204.42,-1260.37 12510.58,-1413.51 13702.5,-1318.95 13753.69,-1314.89 13807.86,-1308.7 13860.34,-1301.68"/>
<polygon fill="black" stroke="black" points="13861.02,-1305.12 13870.47,-1300.32 13860.09,-1298.19 13861.02,-1305.12"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1141" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11003.55,-1355.69C11006.55,-1355.43 11009.54,-1355.18 11012.5,-1354.95 11811.91,-1292.89 13821.09,-1381 14620.5,-1318.95 14671.7,-1314.98 14725.87,-1308.83 14778.35,-1301.83"/>
<polygon fill="black" stroke="black" points="14779.04,-1305.27 14788.48,-1300.47 14778.1,-1298.33 14779.04,-1305.27"/>
</g>
<!-- l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1142" class="edge">
<title>l2_expert_11_gpu11&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11003.55,-1355.68C11006.55,-1355.42 11009.53,-1355.18 11012.5,-1354.95 12015.37,-1278.11 14535.63,-1395.77 15538.5,-1318.95 15589.7,-1315.03 15643.87,-1308.91 15696.36,-1301.92"/>
<polygon fill="black" stroke="black" points="15697.04,-1305.36 15706.49,-1300.56 15696.11,-1298.42 15697.04,-1305.36"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_11_gpu11 -->
<g id="edge1125" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_11_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12471.7,-1459.8C12468.29,-1459.51 12464.89,-1459.23 12461.5,-1458.95 11822.71,-1407.06 11656.08,-1476.87 11013.53,-1423"/>
<polygon fill="black" stroke="black" points="11013.81,-1419.51 11003.55,-1422.16 11013.22,-1426.49 11013.81,-1419.51"/>
</g>
<!-- l2_expert_agg_gpu11&#45;&gt;l2_res2_gpu11 -->
<g id="edge1143" class="edge">
<title>l2_expert_agg_gpu11&#45;&gt;l2_res2_gpu11</title>
<path fill="none" stroke="black" d="M12617.23,-1201.86C12723.8,-1184.29 12842.16,-1164.78 12940.25,-1148.61"/>
<polygon fill="black" stroke="black" points="12940.98,-1152.04 12950.28,-1146.96 12939.84,-1145.13 12940.98,-1152.04"/>
</g>
<!-- l3_mha_qkv_gpu11 -->
<g id="node474" class="node">
<title>l3_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13282,-1042.95 12801,-1042.95 12801,-974.95 13282,-974.95 13282,-1042.95"/>
<text text-anchor="middle" x="13041.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13041.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13041.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13041.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu11&#45;&gt;l3_mha_qkv_gpu11 -->
<g id="edge1535" class="edge">
<title>l2_res2_gpu11&#45;&gt;l3_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M13115.11,-1078.84C13105.4,-1069.75 13094.77,-1059.8 13084.67,-1050.35"/>
<polygon fill="black" stroke="black" points="13086.78,-1047.53 13077.08,-1043.25 13081.99,-1052.64 13086.78,-1047.53"/>
</g>
<!-- l3_mha_res_add_gpu11 -->
<g id="node477" class="node">
<title>l3_mha_res_add_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="13458.5,-730.95 13024.5,-730.95 13024.5,-662.95 13458.5,-662.95 13458.5,-730.95"/>
<text text-anchor="middle" x="13241.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13241.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13241.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13241.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu11&#45;&gt;l3_mha_res_add_gpu11 -->
<g id="edge1539" class="edge">
<title>l2_res2_gpu11&#45;&gt;l3_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M13253.54,-1078.92C13268.63,-1069.65 13282.19,-1057.87 13291.5,-1042.95 13356.44,-938.88 13326.32,-883.65 13288.5,-766.95 13285.42,-757.44 13280.58,-748.04 13275.16,-739.39"/>
<polygon fill="black" stroke="black" points="13278.04,-737.4 13269.59,-731.01 13272.21,-741.27 13278.04,-737.4"/>
</g>
<!-- l2_mha_attn_gpu12 -->
<g id="node355" class="node">
<title>l2_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14277,-1906.95 13796,-1906.95 13796,-1838.95 14277,-1838.95 14277,-1906.95"/>
<text text-anchor="middle" x="14036.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="14036.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14036.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="14036.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu12&#45;&gt;l2_mha_attn_gpu12 -->
<g id="edge1146" class="edge">
<title>l2_mha_qkv_gpu12&#45;&gt;l2_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M14036.5,-1942.84C14036.5,-1934.73 14036.5,-1925.94 14036.5,-1917.43"/>
<polygon fill="black" stroke="black" points="14040,-1917.25 14036.5,-1907.25 14033,-1917.25 14040,-1917.25"/>
</g>
<!-- l2_mha_out_gpu12 -->
<g id="node356" class="node">
<title>l2_mha_out_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14274,-1802.95 13805,-1802.95 13805,-1734.95 14274,-1734.95 14274,-1802.95"/>
<text text-anchor="middle" x="14039.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14039.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14039.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="14039.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu12&#45;&gt;l2_mha_out_gpu12 -->
<g id="edge1147" class="edge">
<title>l2_mha_attn_gpu12&#45;&gt;l2_mha_out_gpu12</title>
<path fill="none" stroke="black" d="M14037.47,-1838.84C14037.71,-1830.73 14037.97,-1821.94 14038.22,-1813.43"/>
<polygon fill="black" stroke="black" points="14041.73,-1813.35 14038.52,-1803.25 14034.73,-1813.15 14041.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu12&#45;&gt;l2_mha_res_add_gpu12 -->
<g id="edge1148" class="edge">
<title>l2_mha_out_gpu12&#45;&gt;l2_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M14061.25,-1734.84C14066.93,-1726.2 14073.12,-1716.77 14079.05,-1707.75"/>
<polygon fill="black" stroke="black" points="14082.06,-1709.53 14084.63,-1699.25 14076.21,-1705.69 14082.06,-1709.53"/>
</g>
<!-- l2_expert_12_gpu12 -->
<g id="node358" class="node">
<title>l2_expert_12_gpu12</title>
<polygon fill="lightpink" stroke="black" points="11455.5,-1422.95 11021.5,-1422.95 11021.5,-1354.95 11455.5,-1354.95 11455.5,-1422.95"/>
<text text-anchor="middle" x="11238.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="11238.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11238.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11238.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu12&#45;&gt;l2_expert_12_gpu12 -->
<g id="edge1152" class="edge">
<title>l2_mha_res_add_gpu12&#45;&gt;l2_expert_12_gpu12</title>
<path fill="none" stroke="black" d="M13889.44,-1639.93C13772.04,-1625.72 13646.05,-1608 13621.5,-1594.95 13549.53,-1556.71 13572.69,-1492.68 13498.5,-1458.95 13397.82,-1413.19 11654.49,-1431.31 11465.7,-1422.79"/>
<polygon fill="black" stroke="black" points="11465.74,-1419.28 11455.55,-1422.19 11465.33,-1426.27 11465.74,-1419.28"/>
</g>
<!-- l2_gate_gpu12 -->
<g id="node359" class="node">
<title>l2_gate_gpu12</title>
<polygon fill="lightcyan" stroke="black" points="14582.24,-1594.95 13825.44,-1594.95 13630.76,-1458.95 14387.56,-1458.95 14582.24,-1594.95"/>
<text text-anchor="middle" x="14106.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="14106.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14106.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14106.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu12&#45;&gt;l2_gate_gpu12 -->
<g id="edge1150" class="edge">
<title>l2_mha_res_add_gpu12&#45;&gt;l2_gate_gpu12</title>
<path fill="none" stroke="black" d="M14106.5,-1630.68C14106.5,-1622.86 14106.5,-1614.19 14106.5,-1605.31"/>
<polygon fill="black" stroke="black" points="14110,-1605.22 14106.5,-1595.22 14103,-1605.22 14110,-1605.22"/>
</g>
<!-- l2_res2_gpu12 -->
<g id="node361" class="node">
<title>l2_res2_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14063.5,-1146.95 13629.5,-1146.95 13629.5,-1078.95 14063.5,-1078.95 14063.5,-1146.95"/>
<text text-anchor="middle" x="13846.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13846.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13846.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13846.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu12&#45;&gt;l2_res2_gpu12 -->
<g id="edge1170" class="edge">
<title>l2_mha_res_add_gpu12&#45;&gt;l2_res2_gpu12</title>
<path fill="none" stroke="black" d="M14323.67,-1658.17C14938.05,-1641.81 16644.24,-1596.25 16645.5,-1594.95 16687.66,-1551.64 16650.06,-1519.23 16645.5,-1458.95 16636.14,-1335.23 16696.72,-1264.85 16603.5,-1182.95 16569.12,-1152.75 15002.25,-1148.13 14956.5,-1146.95 14651.02,-1139.07 14298.3,-1128.3 14073.95,-1121.24"/>
<polygon fill="black" stroke="black" points="14073.8,-1117.73 14063.69,-1120.92 14073.58,-1124.73 14073.8,-1117.73"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1153" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11021.45,-1355.66C11018.45,-1355.41 11015.47,-1355.18 11012.5,-1354.95 10089.96,-1285.95 3609.04,-1387.94 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.23,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1154" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11021.45,-1355.67C11018.45,-1355.41 11015.47,-1355.18 11012.5,-1354.95 10191.69,-1293.34 4425.31,-1380.55 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.18 3604.23,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1155" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11021.45,-1355.67C11018.45,-1355.42 11015.47,-1355.18 11012.5,-1354.95 10293.42,-1300.73 5241.58,-1373.16 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.18 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1156" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11021.45,-1355.67C11018.45,-1355.42 11015.47,-1355.18 11012.5,-1354.95 9777.8,-1261.27 6675.2,-1412.6 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.17 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1157" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11021.45,-1355.68C11018.45,-1355.42 11015.47,-1355.18 11012.5,-1354.95 9981.26,-1276.05 7389.74,-1397.83 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.77,-1315.46 6348.53,-1318.17 6358.22,-1322.44 6358.77,-1315.46"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1158" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11021.45,-1355.69C11018.45,-1355.43 11015.47,-1355.18 11012.5,-1354.95 10184.72,-1290.83 8104.28,-1383.06 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.78,-1315.46 7266.53,-1318.16 7276.22,-1322.44 7276.78,-1315.46"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1159" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11021.45,-1355.7C11018.45,-1355.44 11015.46,-1355.19 11012.5,-1354.95 9763.85,-1256.25 9443.15,-1417.63 8194.5,-1318.95 8194.4,-1318.95 8194.29,-1318.94 8194.19,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.78,-1315.47 8184.53,-1318.14 8194.21,-1322.44 8194.78,-1315.47"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1160" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11021.45,-1355.72C11018.45,-1355.45 11015.46,-1355.2 11012.5,-1354.95 10170.74,-1285.8 9954.26,-1388.09 9112.5,-1318.95 9112.39,-1318.94 9112.29,-1318.94 9112.18,-1318.93"/>
<polygon fill="black" stroke="black" points="9112.49,-1315.44 9102.23,-1318.09 9111.9,-1322.42 9112.49,-1315.44"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1161" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11021.44,-1355.8C11018.44,-1355.51 11015.46,-1355.22 11012.5,-1354.95 10577.56,-1315.34 10465.44,-1358.55 10030.5,-1318.95 10030.39,-1318.94 10030.29,-1318.93 10030.18,-1318.92"/>
<polygon fill="black" stroke="black" points="10030.52,-1315.44 10020.24,-1318 10029.87,-1322.41 10030.52,-1315.44"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1162" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11056.71,-1354.94C10999.57,-1344.57 10934.2,-1332.7 10868.64,-1320.8"/>
<polygon fill="black" stroke="black" points="10869,-1317.3 10858.54,-1318.96 10867.75,-1324.19 10869,-1317.3"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1163" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11279.84,-1354.68C11290.93,-1345.76 11303.37,-1335.75 11316.02,-1325.57"/>
<polygon fill="black" stroke="black" points="11318.32,-1328.21 11323.92,-1319.22 11313.93,-1322.76 11318.32,-1328.21"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1164" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11455.58,-1356.02C11458.57,-1355.66 11461.55,-1355.3 11464.5,-1354.95 11642.65,-1333.99 11688.35,-1339.92 11866.5,-1318.95 11916.37,-1313.08 11969.18,-1306.1 12020.54,-1298.89"/>
<polygon fill="black" stroke="black" points="12021.04,-1302.36 12030.45,-1297.49 12020.06,-1295.42 12021.04,-1302.36"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1165" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11455.55,-1355.76C11458.55,-1355.48 11461.54,-1355.21 11464.5,-1354.95 12049.21,-1304.47 12199.79,-1369.43 12784.5,-1318.95 12835.38,-1314.56 12889.21,-1308.23 12941.42,-1301.2"/>
<polygon fill="black" stroke="black" points="12942.06,-1304.65 12951.49,-1299.83 12941.11,-1297.71 12942.06,-1304.65"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1166" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11455.55,-1355.71C11458.55,-1355.45 11461.54,-1355.19 11464.5,-1354.95 12456.07,-1274.92 12710.93,-1398.96 13702.5,-1318.95 13753.59,-1314.83 13807.65,-1308.62 13860.04,-1301.61"/>
<polygon fill="black" stroke="black" points="13860.71,-1305.05 13870.15,-1300.24 13859.77,-1298.11 13860.71,-1305.05"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1167" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11455.55,-1355.69C11458.55,-1355.43 11461.54,-1355.19 11464.5,-1354.95 12163.74,-1300.16 13921.26,-1373.73 14620.5,-1318.95 14671.69,-1314.94 14725.86,-1308.77 14778.35,-1301.77"/>
<polygon fill="black" stroke="black" points="14779.03,-1305.21 14788.47,-1300.41 14778.1,-1298.27 14779.03,-1305.21"/>
</g>
<!-- l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1168" class="edge">
<title>l2_expert_12_gpu12&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11455.55,-1355.68C11458.55,-1355.43 11461.53,-1355.18 11464.5,-1354.95 12367.19,-1285.39 14635.81,-1388.5 15538.5,-1318.95 15589.7,-1315.01 15643.87,-1308.87 15696.36,-1301.88"/>
<polygon fill="black" stroke="black" points="15697.04,-1305.32 15706.48,-1300.52 15696.11,-1298.38 15697.04,-1305.32"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_12_gpu12 -->
<g id="edge1151" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_12_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13632.32,-1460.21C13627.02,-1459.77 13621.74,-1459.35 13616.5,-1458.95 12666.08,-1386.29 12419.69,-1499.41 11465.74,-1423.01"/>
<polygon fill="black" stroke="black" points="11465.8,-1419.51 11455.55,-1422.19 11465.24,-1426.48 11465.8,-1419.51"/>
</g>
<!-- l2_expert_agg_gpu12&#45;&gt;l2_res2_gpu12 -->
<g id="edge1169" class="edge">
<title>l2_expert_agg_gpu12&#45;&gt;l2_res2_gpu12</title>
<path fill="none" stroke="black" d="M13516.77,-1188.32C13576.18,-1174.92 13637.05,-1161.19 13690.07,-1149.23"/>
<polygon fill="black" stroke="black" points="13690.9,-1152.64 13699.88,-1147.02 13689.36,-1145.81 13690.9,-1152.64"/>
</g>
<!-- l3_mha_qkv_gpu12 -->
<g id="node482" class="node">
<title>l3_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13953,-1042.95 13472,-1042.95 13472,-974.95 13953,-974.95 13953,-1042.95"/>
<text text-anchor="middle" x="13712.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13712.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13712.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13712.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu12&#45;&gt;l3_mha_qkv_gpu12 -->
<g id="edge1561" class="edge">
<title>l2_res2_gpu12&#45;&gt;l3_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M13802.99,-1078.84C13790.71,-1069.48 13777.21,-1059.21 13764.48,-1049.52"/>
<polygon fill="black" stroke="black" points="13766.32,-1046.52 13756.25,-1043.25 13762.08,-1052.09 13766.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu12 -->
<g id="node485" class="node">
<title>l3_mha_res_add_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14000.5,-730.95 13566.5,-730.95 13566.5,-662.95 14000.5,-662.95 14000.5,-730.95"/>
<text text-anchor="middle" x="13783.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13783.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13783.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13783.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu12&#45;&gt;l3_mha_res_add_gpu12 -->
<g id="edge1565" class="edge">
<title>l2_res2_gpu12&#45;&gt;l3_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M13927.5,-1078.79C13941.51,-1069.33 13954.22,-1057.52 13962.5,-1042.95 14023.14,-936.32 14030.08,-867.29 13959.5,-766.95 13950.91,-754.74 13939.81,-744.69 13927.37,-736.41"/>
<polygon fill="black" stroke="black" points="13928.9,-733.25 13918.56,-730.97 13925.22,-739.2 13928.9,-733.25"/>
</g>
<!-- l2_mha_attn_gpu13 -->
<g id="node363" class="node">
<title>l2_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15629,-1906.95 15148,-1906.95 15148,-1838.95 15629,-1838.95 15629,-1906.95"/>
<text text-anchor="middle" x="15388.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15388.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15388.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15388.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu13&#45;&gt;l2_mha_attn_gpu13 -->
<g id="edge1172" class="edge">
<title>l2_mha_qkv_gpu13&#45;&gt;l2_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M15388.5,-1942.84C15388.5,-1934.73 15388.5,-1925.94 15388.5,-1917.43"/>
<polygon fill="black" stroke="black" points="15392,-1917.25 15388.5,-1907.25 15385,-1917.25 15392,-1917.25"/>
</g>
<!-- l2_mha_out_gpu13 -->
<g id="node364" class="node">
<title>l2_mha_out_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15626,-1802.95 15157,-1802.95 15157,-1734.95 15626,-1734.95 15626,-1802.95"/>
<text text-anchor="middle" x="15391.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15391.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15391.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15391.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu13&#45;&gt;l2_mha_out_gpu13 -->
<g id="edge1173" class="edge">
<title>l2_mha_attn_gpu13&#45;&gt;l2_mha_out_gpu13</title>
<path fill="none" stroke="black" d="M15389.47,-1838.84C15389.71,-1830.73 15389.97,-1821.94 15390.22,-1813.43"/>
<polygon fill="black" stroke="black" points="15393.73,-1813.35 15390.52,-1803.25 15386.73,-1813.15 15393.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu13&#45;&gt;l2_mha_res_add_gpu13 -->
<g id="edge1174" class="edge">
<title>l2_mha_out_gpu13&#45;&gt;l2_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M15452.86,-1734.84C15471.19,-1724.94 15491.43,-1714.02 15510.28,-1703.85"/>
<polygon fill="black" stroke="black" points="15511.98,-1706.91 15519.12,-1699.08 15508.66,-1700.75 15511.98,-1706.91"/>
</g>
<!-- l2_expert_13_gpu13 -->
<g id="node366" class="node">
<title>l2_expert_13_gpu13</title>
<polygon fill="lightpink" stroke="black" points="11907.5,-1422.95 11473.5,-1422.95 11473.5,-1354.95 11907.5,-1354.95 11907.5,-1422.95"/>
<text text-anchor="middle" x="11690.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11690.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11690.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11690.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu13&#45;&gt;l2_expert_13_gpu13 -->
<g id="edge1178" class="edge">
<title>l2_mha_res_add_gpu13&#45;&gt;l2_expert_13_gpu13</title>
<path fill="none" stroke="black" d="M15589.24,-1630.85C15599.16,-1584.78 15608.44,-1502.17 15561.5,-1458.95 15525.15,-1425.48 12135.18,-1426.78 11917.72,-1422.54"/>
<polygon fill="black" stroke="black" points="11917.65,-1419.04 11907.55,-1422.22 11917.43,-1426.03 11917.65,-1419.04"/>
</g>
<!-- l2_gate_gpu13 -->
<g id="node367" class="node">
<title>l2_gate_gpu13</title>
<polygon fill="lightcyan" stroke="black" points="15552.24,-1594.95 14795.44,-1594.95 14600.76,-1458.95 15357.56,-1458.95 15552.24,-1594.95"/>
<text text-anchor="middle" x="15076.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="15076.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15076.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15076.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu13&#45;&gt;l2_gate_gpu13 -->
<g id="edge1176" class="edge">
<title>l2_mha_res_add_gpu13&#45;&gt;l2_gate_gpu13</title>
<path fill="none" stroke="black" d="M15458.17,-1630.94C15420.59,-1620.8 15377.72,-1609.23 15334.61,-1597.6"/>
<polygon fill="black" stroke="black" points="15335.39,-1594.19 15324.83,-1594.96 15333.57,-1600.95 15335.39,-1594.19"/>
</g>
<!-- l2_res2_gpu13 -->
<g id="node369" class="node">
<title>l2_res2_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15399.5,-1146.95 14965.5,-1146.95 14965.5,-1078.95 15399.5,-1078.95 15399.5,-1146.95"/>
<text text-anchor="middle" x="15182.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15182.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15182.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15182.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu13&#45;&gt;l2_res2_gpu13 -->
<g id="edge1196" class="edge">
<title>l2_mha_res_add_gpu13&#45;&gt;l2_res2_gpu13</title>
<path fill="none" stroke="black" d="M15797.95,-1641.19C15843.05,-1637.17 15890.28,-1633.47 15934.5,-1630.95 15982.18,-1628.24 17620.08,-1629.08 17653.5,-1594.95 17695.79,-1551.77 17690.18,-1507 17653.5,-1458.95 17380.82,-1101.76 16104.25,-1170.78 15655.5,-1146.95 15575.45,-1142.7 15487.86,-1136.91 15410.05,-1131.37"/>
<polygon fill="black" stroke="black" points="15409.86,-1127.84 15399.63,-1130.62 15409.36,-1134.83 15409.86,-1127.84"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1179" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11473.45,-1355.66C11470.45,-1355.41 11467.47,-1355.17 11464.5,-1354.95 10491.87,-1282.31 3659.13,-1391.57 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.23,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1180" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11473.45,-1355.66C11470.45,-1355.41 11467.47,-1355.18 11464.5,-1354.95 10593.6,-1289.7 4475.4,-1384.19 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.18 3604.23,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1181" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11473.45,-1355.67C11470.45,-1355.41 11467.47,-1355.18 11464.5,-1354.95 10695.33,-1297.09 5291.67,-1376.8 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.18 4522.22,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1182" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11473.45,-1355.67C11470.45,-1355.42 11467.47,-1355.18 11464.5,-1354.95 10129.62,-1254 6775.38,-1419.88 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.17 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1183" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11473.45,-1355.68C11470.45,-1355.42 11467.47,-1355.18 11464.5,-1354.95 10333.08,-1268.77 7489.92,-1405.11 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.77,-1315.46 6348.53,-1318.17 6358.22,-1322.44 6358.77,-1315.46"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1184" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11473.45,-1355.68C11470.45,-1355.42 11467.47,-1355.18 11464.5,-1354.95 10536.54,-1283.55 8204.46,-1390.33 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.77,-1315.46 7266.53,-1318.16 7276.22,-1322.44 7276.77,-1315.46"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1185" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11473.45,-1355.69C11470.45,-1355.43 11467.46,-1355.19 11464.5,-1354.95 10740,-1298.33 8919,-1375.56 8194.5,-1318.95 8194.4,-1318.95 8194.29,-1318.94 8194.19,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.78,-1315.47 8184.53,-1318.15 8194.21,-1322.44 8194.78,-1315.47"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1186" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11473.45,-1355.71C11470.45,-1355.44 11467.46,-1355.19 11464.5,-1354.95 10422.4,-1271.25 10154.6,-1402.63 9112.5,-1318.95 9112.4,-1318.95 9112.29,-1318.94 9112.19,-1318.93"/>
<polygon fill="black" stroke="black" points="9112.78,-1315.47 9102.53,-1318.13 9112.21,-1322.44 9112.78,-1315.47"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1187" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11473.45,-1355.75C11470.45,-1355.47 11467.46,-1355.21 11464.5,-1354.95 10829.27,-1300.8 10665.73,-1373.09 10030.5,-1318.95 10030.39,-1318.94 10030.29,-1318.94 10030.18,-1318.93"/>
<polygon fill="black" stroke="black" points="10030.5,-1315.44 10020.23,-1318.06 10029.89,-1322.41 10030.5,-1315.44"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1188" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11473.43,-1355.94C11470.43,-1355.6 11467.46,-1355.27 11464.5,-1354.95 11235.93,-1330.33 11177.07,-1343.57 10948.5,-1318.95 10948.39,-1318.94 10948.28,-1318.93 10948.17,-1318.92"/>
<polygon fill="black" stroke="black" points="10948.27,-1315.41 10937.95,-1317.8 10947.51,-1322.37 10948.27,-1315.41"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1189" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11621.63,-1354.86C11601.63,-1345.24 11578.97,-1334.35 11556.06,-1323.34"/>
<polygon fill="black" stroke="black" points="11557.46,-1320.13 11546.93,-1318.96 11554.42,-1326.44 11557.46,-1320.13"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1190" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11844.62,-1354.94C11903.23,-1342.39 11972.04,-1327.66 12038.99,-1313.32"/>
<polygon fill="black" stroke="black" points="12039.81,-1316.72 12048.86,-1311.2 12038.35,-1309.87 12039.81,-1316.72"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1191" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11907.56,-1355.82C11910.56,-1355.52 11913.54,-1355.23 11916.5,-1354.95 12300.93,-1319.01 12400.07,-1354.89 12784.5,-1318.95 12835.16,-1314.22 12888.77,-1307.74 12940.79,-1300.67"/>
<polygon fill="black" stroke="black" points="12941.39,-1304.12 12950.82,-1299.29 12940.44,-1297.18 12941.39,-1304.12"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1192" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11907.55,-1355.73C11910.55,-1355.46 11913.54,-1355.2 11916.5,-1354.95 12707.73,-1289.47 12911.26,-1384.42 13702.5,-1318.95 13753.49,-1314.73 13807.44,-1308.48 13859.74,-1301.47"/>
<polygon fill="black" stroke="black" points="13860.39,-1304.91 13869.83,-1300.1 13859.45,-1297.98 13860.39,-1304.91"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1193" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11907.55,-1355.7C11910.55,-1355.44 11913.54,-1355.19 11916.5,-1354.95 13114.62,-1259.92 13422.38,-1413.96 14620.5,-1318.95 14671.69,-1314.89 14725.86,-1308.7 14778.34,-1301.69"/>
<polygon fill="black" stroke="black" points="14779.03,-1305.13 14788.47,-1300.32 14778.09,-1298.19 14779.03,-1305.13"/>
</g>
<!-- l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1194" class="edge">
<title>l2_expert_13_gpu13&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11907.55,-1355.69C11910.55,-1355.43 11913.54,-1355.18 11916.5,-1354.95 12719.01,-1292.66 14735.98,-1381.23 15538.5,-1318.95 15589.7,-1314.98 15643.87,-1308.83 15696.35,-1301.83"/>
<polygon fill="black" stroke="black" points="15697.04,-1305.27 15706.48,-1300.47 15696.1,-1298.34 15697.04,-1305.27"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_13_gpu13 -->
<g id="edge1177" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_13_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14601.71,-1459.75C14598.29,-1459.47 14594.89,-1459.21 14591.5,-1458.95 13409.21,-1369.68 13103.48,-1516.23 11917.59,-1423"/>
<polygon fill="black" stroke="black" points="11917.79,-1419.5 11907.55,-1422.2 11917.24,-1426.48 11917.79,-1419.5"/>
</g>
<!-- l2_expert_agg_gpu13&#45;&gt;l2_res2_gpu13 -->
<g id="edge1195" class="edge">
<title>l2_expert_agg_gpu13&#45;&gt;l2_res2_gpu13</title>
<path fill="none" stroke="black" d="M14458.27,-1205.62C14512.22,-1197.85 14568.02,-1190 14620.5,-1182.95 14730.46,-1168.18 14852.7,-1153.02 14955.02,-1140.69"/>
<polygon fill="black" stroke="black" points="14955.67,-1144.14 14965.18,-1139.47 14954.83,-1137.19 14955.67,-1144.14"/>
</g>
<!-- l3_mha_qkv_gpu13 -->
<g id="node490" class="node">
<title>l3_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15362,-1042.95 14881,-1042.95 14881,-974.95 15362,-974.95 15362,-1042.95"/>
<text text-anchor="middle" x="15121.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15121.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15121.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15121.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu13&#45;&gt;l3_mha_qkv_gpu13 -->
<g id="edge1587" class="edge">
<title>l2_res2_gpu13&#45;&gt;l3_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M15162.7,-1078.84C15157.58,-1070.29 15152.01,-1060.97 15146.66,-1052.03"/>
<polygon fill="black" stroke="black" points="15149.55,-1050.04 15141.41,-1043.25 15143.54,-1053.63 15149.55,-1050.04"/>
</g>
<!-- l3_mha_res_add_gpu13 -->
<g id="node493" class="node">
<title>l3_mha_res_add_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15474.5,-730.95 15040.5,-730.95 15040.5,-662.95 15474.5,-662.95 15474.5,-730.95"/>
<text text-anchor="middle" x="15257.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15257.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15257.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15257.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu13&#45;&gt;l3_mha_res_add_gpu13 -->
<g id="edge1591" class="edge">
<title>l2_res2_gpu13&#45;&gt;l3_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M15331.44,-1078.69C15347.11,-1069.52 15361.09,-1057.84 15371.5,-1042.95 15441.81,-942.43 15429.64,-873.31 15368.5,-766.95 15361.88,-755.43 15352.47,-745.57 15341.91,-737.21"/>
<polygon fill="black" stroke="black" points="15343.76,-734.23 15333.63,-731.11 15339.61,-739.86 15343.76,-734.23"/>
</g>
<!-- l2_mha_attn_gpu14 -->
<g id="node371" class="node">
<title>l2_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="16244,-1906.95 15763,-1906.95 15763,-1838.95 16244,-1838.95 16244,-1906.95"/>
<text text-anchor="middle" x="16003.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="16003.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16003.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="16003.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu14&#45;&gt;l2_mha_attn_gpu14 -->
<g id="edge1198" class="edge">
<title>l2_mha_qkv_gpu14&#45;&gt;l2_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M16003.5,-1942.84C16003.5,-1934.73 16003.5,-1925.94 16003.5,-1917.43"/>
<polygon fill="black" stroke="black" points="16007,-1917.25 16003.5,-1907.25 16000,-1917.25 16007,-1917.25"/>
</g>
<!-- l2_mha_out_gpu14 -->
<g id="node372" class="node">
<title>l2_mha_out_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="16241,-1802.95 15772,-1802.95 15772,-1734.95 16241,-1734.95 16241,-1802.95"/>
<text text-anchor="middle" x="16006.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16006.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16006.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="16006.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu14&#45;&gt;l2_mha_out_gpu14 -->
<g id="edge1199" class="edge">
<title>l2_mha_attn_gpu14&#45;&gt;l2_mha_out_gpu14</title>
<path fill="none" stroke="black" d="M16004.47,-1838.84C16004.71,-1830.73 16004.97,-1821.94 16005.22,-1813.43"/>
<polygon fill="black" stroke="black" points="16008.73,-1813.35 16005.52,-1803.25 16001.73,-1813.15 16008.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu14&#45;&gt;l2_mha_res_add_gpu14 -->
<g id="edge1200" class="edge">
<title>l2_mha_out_gpu14&#45;&gt;l2_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M16056.5,-1734.84C16070.96,-1725.26 16086.88,-1714.71 16101.82,-1704.82"/>
<polygon fill="black" stroke="black" points="16104.08,-1707.52 16110.49,-1699.08 16100.22,-1701.68 16104.08,-1707.52"/>
</g>
<!-- l2_expert_14_gpu14 -->
<g id="node374" class="node">
<title>l2_expert_14_gpu14</title>
<polygon fill="lightpink" stroke="black" points="12359.5,-1422.95 11925.5,-1422.95 11925.5,-1354.95 12359.5,-1354.95 12359.5,-1422.95"/>
<text text-anchor="middle" x="12142.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12142.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12142.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12142.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu14&#45;&gt;l2_expert_14_gpu14 -->
<g id="edge1204" class="edge">
<title>l2_mha_res_add_gpu14&#45;&gt;l2_expert_14_gpu14</title>
<path fill="none" stroke="black" d="M15943.17,-1641.62C15825.22,-1627.98 15698.77,-1610.27 15675.5,-1594.95 15616.35,-1556.02 15654.06,-1493.95 15592.5,-1458.95 15516.28,-1415.61 12584.84,-1429.32 12369.59,-1422.67"/>
<polygon fill="black" stroke="black" points="12369.7,-1419.17 12359.55,-1422.21 12369.38,-1426.17 12369.7,-1419.17"/>
</g>
<!-- l2_gate_gpu14 -->
<g id="node375" class="node">
<title>l2_gate_gpu14</title>
<polygon fill="lightcyan" stroke="black" points="16636.24,-1594.95 15879.44,-1594.95 15684.76,-1458.95 16441.56,-1458.95 16636.24,-1594.95"/>
<text text-anchor="middle" x="16160.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="16160.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16160.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16160.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu14&#45;&gt;l2_gate_gpu14 -->
<g id="edge1202" class="edge">
<title>l2_mha_res_add_gpu14&#45;&gt;l2_gate_gpu14</title>
<path fill="none" stroke="black" d="M16160.5,-1630.68C16160.5,-1622.86 16160.5,-1614.19 16160.5,-1605.31"/>
<polygon fill="black" stroke="black" points="16164,-1605.22 16160.5,-1595.22 16157,-1605.22 16164,-1605.22"/>
</g>
<!-- l2_res2_gpu14 -->
<g id="node377" class="node">
<title>l2_res2_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16098.5,-1146.95 15664.5,-1146.95 15664.5,-1078.95 16098.5,-1078.95 16098.5,-1146.95"/>
<text text-anchor="middle" x="15881.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15881.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15881.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15881.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu14&#45;&gt;l2_res2_gpu14 -->
<g id="edge1222" class="edge">
<title>l2_mha_res_add_gpu14&#45;&gt;l2_res2_gpu14</title>
<path fill="none" stroke="black" d="M16377.85,-1661.95C16788.63,-1657.1 17642.06,-1641.44 17686.5,-1594.95 17749.76,-1528.77 17749.99,-1248.92 17686.5,-1182.95 17659.51,-1154.91 16588.25,-1128.85 16109.09,-1118.58"/>
<polygon fill="black" stroke="black" points="16109,-1115.07 16098.93,-1118.36 16108.85,-1122.07 16109,-1115.07"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1205" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11925.45,-1355.66C11922.45,-1355.41 11919.47,-1355.17 11916.5,-1354.95 10893.78,-1278.67 3709.22,-1395.21 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.18 2686.23,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1206" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11925.45,-1355.66C11922.45,-1355.41 11919.47,-1355.18 11916.5,-1354.95 10995.51,-1286.06 4525.49,-1387.82 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.18 3604.23,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1207" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11925.45,-1355.67C11922.45,-1355.41 11919.47,-1355.18 11916.5,-1354.95 11097.24,-1293.45 5341.76,-1380.44 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.18 4522.23,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1208" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11925.45,-1355.67C11922.45,-1355.42 11919.47,-1355.18 11916.5,-1354.95 11198.97,-1300.84 6158.03,-1373.05 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.18 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1209" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11925.45,-1355.67C11922.45,-1355.42 11919.47,-1355.18 11916.5,-1354.95 10684.9,-1261.5 7590.1,-1412.38 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.77,-1315.46 6348.53,-1318.17 6358.22,-1322.44 6358.77,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1210" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11925.45,-1355.68C11922.45,-1355.42 11919.47,-1355.18 11916.5,-1354.95 10888.36,-1276.28 8304.64,-1397.61 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.77,-1315.46 7266.53,-1318.17 7276.22,-1322.44 7276.77,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1211" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11925.45,-1355.69C11922.45,-1355.43 11919.47,-1355.18 11916.5,-1354.95 11091.82,-1291.05 9019.18,-1382.84 8194.5,-1318.95 8194.4,-1318.95 8194.29,-1318.94 8194.19,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.78,-1315.46 8184.53,-1318.16 8194.22,-1322.44 8194.78,-1315.46"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1212" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11925.45,-1355.7C11922.45,-1355.44 11919.46,-1355.19 11916.5,-1354.95 10674.05,-1256.7 10354.95,-1417.18 9112.5,-1318.95 9112.4,-1318.95 9112.29,-1318.94 9112.19,-1318.93"/>
<polygon fill="black" stroke="black" points="9112.78,-1315.47 9102.53,-1318.14 9112.21,-1322.44 9112.78,-1315.47"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1213" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11925.45,-1355.73C11922.45,-1355.45 11919.46,-1355.2 11916.5,-1354.95 11080.94,-1286.25 10866.06,-1387.64 10030.5,-1318.95 10030.39,-1318.94 10030.29,-1318.94 10030.18,-1318.93"/>
<polygon fill="black" stroke="black" points="10030.49,-1315.44 10020.23,-1318.09 10029.9,-1322.42 10030.49,-1315.44"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1214" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11925.44,-1355.8C11922.44,-1355.51 11919.46,-1355.22 11916.5,-1354.95 11487.76,-1315.79 11377.24,-1358.1 10948.5,-1318.95 10948.39,-1318.94 10948.29,-1318.93 10948.18,-1318.92"/>
<polygon fill="black" stroke="black" points="10948.52,-1315.44 10938.24,-1318 10947.87,-1322.41 10948.52,-1315.44"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1215" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11964.11,-1354.94C11908.03,-1344.57 11843.88,-1332.7 11779.55,-1320.8"/>
<polygon fill="black" stroke="black" points="11780.11,-1317.34 11769.64,-1318.96 11778.84,-1324.22 11780.11,-1317.34"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1216" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12187.27,-1354.68C12199.39,-1345.68 12213,-1335.56 12226.83,-1325.28"/>
<polygon fill="black" stroke="black" points="12229.05,-1327.99 12234.99,-1319.22 12224.88,-1322.37 12229.05,-1327.99"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1217" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12359.58,-1356.01C12362.57,-1355.65 12365.55,-1355.3 12368.5,-1354.95 12552.84,-1333.54 12600.16,-1340.36 12784.5,-1318.95 12834.48,-1313.15 12887.39,-1306.19 12938.84,-1298.98"/>
<polygon fill="black" stroke="black" points="12939.36,-1302.44 12948.77,-1297.58 12938.38,-1295.51 12939.36,-1302.44"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1218" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12359.55,-1355.76C12362.55,-1355.48 12365.54,-1355.21 12368.5,-1354.95 12959.41,-1304.02 13111.59,-1369.88 13702.5,-1318.95 13753.38,-1314.57 13807.22,-1308.25 13859.42,-1301.21"/>
<polygon fill="black" stroke="black" points="13860.06,-1304.66 13869.5,-1299.84 13859.12,-1297.72 13860.06,-1304.66"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1219" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12359.55,-1355.71C12362.55,-1355.45 12365.54,-1355.19 12368.5,-1354.95 13366.28,-1274.47 13622.72,-1399.41 14620.5,-1318.95 14671.59,-1314.83 14725.65,-1308.62 14778.04,-1301.61"/>
<polygon fill="black" stroke="black" points="14778.71,-1305.05 14788.15,-1300.25 14777.77,-1298.11 14778.71,-1305.05"/>
</g>
<!-- l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1220" class="edge">
<title>l2_expert_14_gpu14&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12359.55,-1355.69C12362.55,-1355.43 12365.54,-1355.19 12368.5,-1354.95 13070.84,-1299.94 14836.16,-1373.95 15538.5,-1318.95 15589.69,-1314.94 15643.86,-1308.78 15696.35,-1301.77"/>
<polygon fill="black" stroke="black" points="15697.03,-1305.21 15706.47,-1300.41 15696.1,-1298.27 15697.03,-1305.21"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_14_gpu14 -->
<g id="edge1203" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_14_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15691.16,-1463.56C15671.36,-1461.83 15651.74,-1460.28 15632.5,-1458.95 14912.1,-1409.44 13108.06,-1478.85 12369.53,-1422.98"/>
<polygon fill="black" stroke="black" points="12369.79,-1419.49 12359.55,-1422.21 12369.25,-1426.47 12369.79,-1419.49"/>
</g>
<!-- l2_expert_agg_gpu14&#45;&gt;l2_res2_gpu14 -->
<g id="edge1221" class="edge">
<title>l2_expert_agg_gpu14&#45;&gt;l2_res2_gpu14</title>
<path fill="none" stroke="black" d="M15369.61,-1200.76C15471.29,-1183.51 15583.31,-1164.52 15676.56,-1148.71"/>
<polygon fill="black" stroke="black" points="15677.4,-1152.11 15686.68,-1146.99 15676.23,-1145.21 15677.4,-1152.11"/>
</g>
<!-- l3_mha_qkv_gpu14 -->
<g id="node498" class="node">
<title>l3_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15988,-1042.95 15507,-1042.95 15507,-974.95 15988,-974.95 15988,-1042.95"/>
<text text-anchor="middle" x="15747.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15747.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15747.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15747.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu14&#45;&gt;l3_mha_qkv_gpu14 -->
<g id="edge1613" class="edge">
<title>l2_res2_gpu14&#45;&gt;l3_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M15837.99,-1078.84C15825.71,-1069.48 15812.21,-1059.21 15799.48,-1049.52"/>
<polygon fill="black" stroke="black" points="15801.32,-1046.52 15791.25,-1043.25 15797.08,-1052.09 15801.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu14 -->
<g id="node501" class="node">
<title>l3_mha_res_add_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16054.5,-730.95 15620.5,-730.95 15620.5,-662.95 16054.5,-662.95 16054.5,-730.95"/>
<text text-anchor="middle" x="15837.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15837.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15837.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15837.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu14&#45;&gt;l3_mha_res_add_gpu14 -->
<g id="edge1617" class="edge">
<title>l2_res2_gpu14&#45;&gt;l3_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M15962.5,-1078.79C15976.51,-1069.33 15989.22,-1057.52 15997.5,-1042.95 16058.14,-936.32 16063.03,-868.7 15994.5,-766.95 15986.32,-754.81 15975.5,-744.79 15963.34,-736.52"/>
<polygon fill="black" stroke="black" points="15965.05,-733.47 15954.73,-731.08 15961.31,-739.38 15965.05,-733.47"/>
</g>
<!-- l2_mha_attn_gpu15 -->
<g id="node379" class="node">
<title>l2_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17815,-1906.95 17334,-1906.95 17334,-1838.95 17815,-1838.95 17815,-1906.95"/>
<text text-anchor="middle" x="17574.5" y="-1891.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="17574.5" y="-1876.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17574.5" y="-1861.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="17574.5" y="-1846.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_mha_qkv_gpu15&#45;&gt;l2_mha_attn_gpu15 -->
<g id="edge1224" class="edge">
<title>l2_mha_qkv_gpu15&#45;&gt;l2_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M17574.5,-1942.84C17574.5,-1934.73 17574.5,-1925.94 17574.5,-1917.43"/>
<polygon fill="black" stroke="black" points="17578,-1917.25 17574.5,-1907.25 17571,-1917.25 17578,-1917.25"/>
</g>
<!-- l2_mha_out_gpu15 -->
<g id="node380" class="node">
<title>l2_mha_out_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17812,-1802.95 17343,-1802.95 17343,-1734.95 17812,-1734.95 17812,-1802.95"/>
<text text-anchor="middle" x="17577.5" y="-1787.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17577.5" y="-1772.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17577.5" y="-1757.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="17577.5" y="-1742.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_attn_gpu15&#45;&gt;l2_mha_out_gpu15 -->
<g id="edge1225" class="edge">
<title>l2_mha_attn_gpu15&#45;&gt;l2_mha_out_gpu15</title>
<path fill="none" stroke="black" d="M17575.47,-1838.84C17575.71,-1830.73 17575.97,-1821.94 17576.22,-1813.43"/>
<polygon fill="black" stroke="black" points="17579.73,-1813.35 17576.52,-1803.25 17572.73,-1813.15 17579.73,-1813.35"/>
</g>
<!-- l2_mha_out_gpu15&#45;&gt;l2_mha_res_add_gpu15 -->
<g id="edge1226" class="edge">
<title>l2_mha_out_gpu15&#45;&gt;l2_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M17620.68,-1734.84C17632.88,-1725.48 17646.27,-1715.21 17658.91,-1705.52"/>
<polygon fill="black" stroke="black" points="17661.28,-1708.12 17667.08,-1699.25 17657.02,-1702.56 17661.28,-1708.12"/>
</g>
<!-- l2_expert_15_gpu15 -->
<g id="node382" class="node">
<title>l2_expert_15_gpu15</title>
<polygon fill="lightpink" stroke="black" points="12811.5,-1422.95 12377.5,-1422.95 12377.5,-1354.95 12811.5,-1354.95 12811.5,-1422.95"/>
<text text-anchor="middle" x="12594.5" y="-1407.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12594.5" y="-1392.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12594.5" y="-1377.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12594.5" y="-1362.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu15&#45;&gt;l2_expert_15_gpu15 -->
<g id="edge1230" class="edge">
<title>l2_mha_res_add_gpu15&#45;&gt;l2_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M17712.34,-1630.82C17712.91,-1583.93 17706.02,-1499.43 17653.5,-1458.95 17605.01,-1421.58 13800.46,-1396.95 12821.93,-1391.23"/>
<polygon fill="black" stroke="black" points="12821.63,-1387.73 12811.61,-1391.17 12821.59,-1394.73 12821.63,-1387.73"/>
</g>
<!-- l2_gate_gpu15 -->
<g id="node383" class="node">
<title>l2_gate_gpu15</title>
<polygon fill="lightcyan" stroke="black" points="17644.24,-1594.95 16887.44,-1594.95 16692.76,-1458.95 17449.56,-1458.95 17644.24,-1594.95"/>
<text text-anchor="middle" x="17168.5" y="-1545.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="17168.5" y="-1530.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17168.5" y="-1515.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17168.5" y="-1500.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l2_mha_res_add_gpu15&#45;&gt;l2_gate_gpu15 -->
<g id="edge1228" class="edge">
<title>l2_mha_res_add_gpu15&#45;&gt;l2_gate_gpu15</title>
<path fill="none" stroke="black" d="M17578.95,-1630.94C17538.36,-1620.76 17492.04,-1609.14 17445.48,-1597.45"/>
<polygon fill="black" stroke="black" points="17446.1,-1594 17435.55,-1594.96 17444.4,-1600.79 17446.1,-1594"/>
</g>
<!-- l2_res2_gpu15 -->
<g id="node385" class="node">
<title>l2_res2_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17602.5,-1146.95 17168.5,-1146.95 17168.5,-1078.95 17602.5,-1078.95 17602.5,-1146.95"/>
<text text-anchor="middle" x="17385.5" y="-1131.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17385.5" y="-1116.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17385.5" y="-1101.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17385.5" y="-1086.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_mha_res_add_gpu15&#45;&gt;l2_res2_gpu15 -->
<g id="edge1248" class="edge">
<title>l2_mha_res_add_gpu15&#45;&gt;l2_res2_gpu15</title>
<path fill="none" stroke="black" d="M17725.02,-1630.68C17760.45,-1543.74 17840.08,-1307.93 17721.5,-1182.95 17704.21,-1164.73 17661.81,-1151.02 17612.75,-1140.83"/>
<polygon fill="black" stroke="black" points="17613.34,-1137.38 17602.85,-1138.84 17611.96,-1144.25 17613.34,-1137.38"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1231" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M12377.45,-1355.66C12374.45,-1355.41 12371.47,-1355.17 12368.5,-1354.95 11295.69,-1275.04 3759.31,-1398.84 2686.5,-1318.95 2686.4,-1318.95 2686.29,-1318.94 2686.19,-1318.93"/>
<polygon fill="black" stroke="black" points="2686.77,-1315.46 2676.53,-1318.19 2686.23,-1322.44 2686.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1232" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M12377.45,-1355.66C12374.45,-1355.41 12371.47,-1355.17 12368.5,-1354.95 11397.42,-1282.42 4575.58,-1391.46 3604.5,-1318.95 3604.4,-1318.95 3604.29,-1318.94 3604.19,-1318.93"/>
<polygon fill="black" stroke="black" points="3604.77,-1315.46 3594.53,-1318.18 3604.23,-1322.44 3604.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1233" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M12377.45,-1355.66C12374.45,-1355.41 12371.47,-1355.18 12368.5,-1354.95 11499.15,-1289.81 5391.85,-1384.07 4522.5,-1318.95 4522.4,-1318.95 4522.29,-1318.94 4522.19,-1318.93"/>
<polygon fill="black" stroke="black" points="4522.77,-1315.46 4512.53,-1318.18 4522.23,-1322.44 4522.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1234" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12377.45,-1355.67C12374.45,-1355.41 12371.47,-1355.18 12368.5,-1354.95 11600.88,-1297.2 6208.12,-1376.69 5440.5,-1318.95 5440.4,-1318.95 5440.29,-1318.94 5440.19,-1318.93"/>
<polygon fill="black" stroke="black" points="5440.77,-1315.46 5430.53,-1318.18 5440.22,-1322.44 5440.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1235" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M12377.45,-1355.67C12374.45,-1355.42 12371.47,-1355.18 12368.5,-1354.95 11036.72,-1254.22 7690.28,-1419.65 6358.5,-1318.95 6358.4,-1318.95 6358.29,-1318.94 6358.19,-1318.93"/>
<polygon fill="black" stroke="black" points="6358.77,-1315.46 6348.53,-1318.17 6358.22,-1322.44 6358.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1236" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M12377.45,-1355.68C12374.45,-1355.42 12371.47,-1355.18 12368.5,-1354.95 11240.19,-1269 8404.82,-1404.88 7276.5,-1318.95 7276.4,-1318.95 7276.29,-1318.94 7276.19,-1318.93"/>
<polygon fill="black" stroke="black" points="7276.77,-1315.46 7266.53,-1318.17 7276.22,-1322.44 7276.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1237" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M12377.45,-1355.68C12374.45,-1355.42 12371.47,-1355.18 12368.5,-1354.95 11443.64,-1283.78 9119.36,-1390.11 8194.5,-1318.95 8194.4,-1318.95 8194.29,-1318.94 8194.19,-1318.93"/>
<polygon fill="black" stroke="black" points="8194.77,-1315.46 8184.53,-1318.16 8194.22,-1322.44 8194.77,-1315.46"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1238" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M12377.45,-1355.69C12374.45,-1355.43 12371.46,-1355.19 12368.5,-1354.95 11647.1,-1298.55 9833.9,-1375.34 9112.5,-1318.95 9112.4,-1318.95 9112.29,-1318.94 9112.19,-1318.93"/>
<polygon fill="black" stroke="black" points="9112.78,-1315.47 9102.53,-1318.15 9112.21,-1322.44 9112.78,-1315.47"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1239" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M12377.45,-1355.71C12374.45,-1355.44 12371.46,-1355.19 12368.5,-1354.95 11332.61,-1271.7 11066.4,-1402.18 10030.5,-1318.95 10030.4,-1318.95 10030.29,-1318.94 10030.19,-1318.93"/>
<polygon fill="black" stroke="black" points="10030.78,-1315.47 10020.53,-1318.13 10030.21,-1322.44 10030.78,-1315.47"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1240" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M12377.45,-1355.75C12374.45,-1355.47 12371.46,-1355.21 12368.5,-1354.95 11739.47,-1301.25 11577.53,-1372.64 10948.5,-1318.95 10948.39,-1318.94 10948.29,-1318.94 10948.18,-1318.93"/>
<polygon fill="black" stroke="black" points="10948.5,-1315.44 10938.23,-1318.05 10947.89,-1322.41 10948.5,-1315.44"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1241" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M12377.43,-1355.95C12374.43,-1355.61 12371.46,-1355.27 12368.5,-1354.95 12146.13,-1330.78 12088.87,-1343.12 11866.5,-1318.95 11866.39,-1318.94 11866.28,-1318.93 11866.17,-1318.92"/>
<polygon fill="black" stroke="black" points="11866.27,-1315.41 11855.95,-1317.79 11865.51,-1322.37 11866.27,-1315.41"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1242" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12529.04,-1354.86C12510.11,-1345.29 12488.67,-1334.45 12467,-1323.49"/>
<polygon fill="black" stroke="black" points="12468.53,-1320.35 12458.03,-1318.96 12465.37,-1326.59 12468.53,-1320.35"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1243" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12752.02,-1354.94C12813.38,-1342.09 12885.69,-1326.93 12955.7,-1312.26"/>
<polygon fill="black" stroke="black" points="12956.49,-1315.67 12965.56,-1310.2 12955.05,-1308.82 12956.49,-1315.67"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1244" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12811.76,-1379.74C13035.47,-1370.04 13393.98,-1351.02 13702.5,-1318.95 13752.82,-1313.72 13806.09,-1307.02 13857.83,-1299.89"/>
<polygon fill="black" stroke="black" points="13858.39,-1303.35 13867.81,-1298.51 13857.43,-1296.42 13858.39,-1303.35"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1245" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12811.68,-1378.92C12981.7,-1371.97 13224.14,-1362.34 13436.5,-1354.95 13962.65,-1336.64 14096.06,-1365.05 14620.5,-1318.95 14671.37,-1314.48 14725.2,-1308.11 14777.41,-1301.07"/>
<polygon fill="black" stroke="black" points="14778.05,-1304.51 14787.48,-1299.69 14777.1,-1297.57 14778.05,-1304.51"/>
</g>
<!-- l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1246" class="edge">
<title>l2_expert_15_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12811.65,-1378.13C12981.66,-1370.75 13224.09,-1360.93 13436.5,-1354.95 13903.49,-1341.8 15072.85,-1356.77 15538.5,-1318.95 15589.59,-1314.8 15643.65,-1308.58 15696.04,-1301.56"/>
<polygon fill="black" stroke="black" points="15696.71,-1305 15706.15,-1300.19 15695.77,-1298.07 15696.71,-1305"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_15_gpu15 -->
<g id="edge1229" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_15_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.67,-1463.26C16680.73,-1461.67 16662.96,-1460.22 16645.5,-1458.95 15893.72,-1404.56 13561.56,-1392.88 12821.96,-1390.52"/>
<polygon fill="black" stroke="black" points="12821.74,-1387.02 12811.73,-1390.49 12821.72,-1394.02 12821.74,-1387.02"/>
</g>
<!-- l2_expert_agg_gpu15&#45;&gt;l2_res2_gpu15 -->
<g id="edge1247" class="edge">
<title>l2_expert_agg_gpu15&#45;&gt;l2_res2_gpu15</title>
<path fill="none" stroke="black" d="M16312.46,-1219.09C16569.98,-1193.86 16927.94,-1158.79 17158.19,-1136.23"/>
<polygon fill="black" stroke="black" points="17158.76,-1139.69 17168.37,-1135.23 17158.08,-1132.72 17158.76,-1139.69"/>
</g>
<!-- l3_mha_qkv_gpu15 -->
<g id="node506" class="node">
<title>l3_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17492,-1042.95 17011,-1042.95 17011,-974.95 17492,-974.95 17492,-1042.95"/>
<text text-anchor="middle" x="17251.5" y="-1027.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17251.5" y="-1012.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17251.5" y="-997.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17251.5" y="-982.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l2_res2_gpu15&#45;&gt;l3_mha_qkv_gpu15 -->
<g id="edge1639" class="edge">
<title>l2_res2_gpu15&#45;&gt;l3_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M17341.99,-1078.84C17329.71,-1069.48 17316.21,-1059.21 17303.48,-1049.52"/>
<polygon fill="black" stroke="black" points="17305.32,-1046.52 17295.25,-1043.25 17301.08,-1052.09 17305.32,-1046.52"/>
</g>
<!-- l3_mha_res_add_gpu15 -->
<g id="node509" class="node">
<title>l3_mha_res_add_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17604.5,-730.95 17170.5,-730.95 17170.5,-662.95 17604.5,-662.95 17604.5,-730.95"/>
<text text-anchor="middle" x="17387.5" y="-715.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17387.5" y="-700.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17387.5" y="-685.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17387.5" y="-670.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l2_res2_gpu15&#45;&gt;l3_mha_res_add_gpu15 -->
<g id="edge1643" class="edge">
<title>l2_res2_gpu15&#45;&gt;l3_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M17466.5,-1078.79C17480.51,-1069.33 17493.22,-1057.52 17501.5,-1042.95 17562.14,-936.32 17559.64,-873.31 17498.5,-766.95 17491.88,-755.43 17482.47,-745.57 17471.91,-737.21"/>
<polygon fill="black" stroke="black" points="17473.76,-734.23 17463.63,-731.11 17469.61,-739.86 17473.76,-734.23"/>
</g>
<!-- l3_mha_attn_gpu0 -->
<g id="node387" class="node">
<title>l3_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="481,-938.95 0,-938.95 0,-870.95 481,-870.95 481,-938.95"/>
<text text-anchor="middle" x="240.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="240.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="240.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="240.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu0&#45;&gt;l3_mha_attn_gpu0 -->
<g id="edge1250" class="edge">
<title>l3_mha_qkv_gpu0&#45;&gt;l3_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M240.5,-974.84C240.5,-966.73 240.5,-957.94 240.5,-949.43"/>
<polygon fill="black" stroke="black" points="244,-949.25 240.5,-939.25 237,-949.25 244,-949.25"/>
</g>
<!-- l3_mha_out_gpu0 -->
<g id="node388" class="node">
<title>l3_mha_out_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="478,-834.95 9,-834.95 9,-766.95 478,-766.95 478,-834.95"/>
<text text-anchor="middle" x="243.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="243.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="243.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="243.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu0&#45;&gt;l3_mha_out_gpu0 -->
<g id="edge1251" class="edge">
<title>l3_mha_attn_gpu0&#45;&gt;l3_mha_out_gpu0</title>
<path fill="none" stroke="black" d="M241.47,-870.84C241.71,-862.73 241.97,-853.94 242.22,-845.43"/>
<polygon fill="black" stroke="black" points="245.73,-845.35 242.52,-835.25 238.73,-845.15 245.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu0&#45;&gt;l3_mha_res_add_gpu0 -->
<g id="edge1252" class="edge">
<title>l3_mha_out_gpu0&#45;&gt;l3_mha_res_add_gpu0</title>
<path fill="none" stroke="black" d="M245.77,-766.84C246.33,-758.73 246.93,-749.94 247.52,-741.43"/>
<polygon fill="black" stroke="black" points="251.02,-741.47 248.21,-731.25 244.04,-740.99 251.02,-741.47"/>
</g>
<!-- l3_expert_0_gpu0 -->
<g id="node390" class="node">
<title>l3_expert_0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="5708.5,-454.95 5274.5,-454.95 5274.5,-386.95 5708.5,-386.95 5708.5,-454.95"/>
<text text-anchor="middle" x="5491.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5491.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5491.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5491.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu0&#45;&gt;l3_expert_0_gpu0 -->
<g id="edge1256" class="edge">
<title>l3_mha_res_add_gpu0&#45;&gt;l3_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M248.66,-662.82C248.08,-615.93 254.97,-531.42 307.5,-490.95 357.3,-452.59 4270.87,-428.62 5264.25,-423.15"/>
<polygon fill="black" stroke="black" points="5264.39,-426.65 5274.37,-423.1 5264.35,-419.65 5264.39,-426.65"/>
</g>
<!-- l3_gate_gpu0 -->
<g id="node391" class="node">
<title>l3_gate_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="1268.24,-626.95 511.44,-626.95 316.76,-490.95 1073.56,-490.95 1268.24,-626.95"/>
<text text-anchor="middle" x="792.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="792.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="792.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="792.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu0&#45;&gt;l3_gate_gpu0 -->
<g id="edge1254" class="edge">
<title>l3_mha_res_add_gpu0&#45;&gt;l3_gate_gpu0</title>
<path fill="none" stroke="black" d="M382.05,-662.94C422.64,-652.76 468.96,-641.14 515.52,-629.45"/>
<polygon fill="black" stroke="black" points="516.6,-632.79 525.45,-626.96 514.9,-626 516.6,-632.79"/>
</g>
<!-- l3_res2_gpu0 -->
<g id="node393" class="node">
<title>l3_res2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="2144.5,-178.95 1710.5,-178.95 1710.5,-110.95 2144.5,-110.95 2144.5,-178.95"/>
<text text-anchor="middle" x="1927.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1927.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1927.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1927.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu0&#45;&gt;l3_res2_gpu0 -->
<g id="edge1274" class="edge">
<title>l3_mha_res_add_gpu0&#45;&gt;l3_res2_gpu0</title>
<path fill="none" stroke="black" d="M241.33,-662.94C218.42,-572.37 170.09,-319.82 310.5,-214.95 365.15,-174.13 1267.6,-155.54 1699.99,-148.94"/>
<polygon fill="black" stroke="black" points="1700.17,-152.43 1710.11,-148.78 1700.06,-145.44 1700.17,-152.43"/>
</g>
<!-- l3_expert_agg_gpu0 -->
<g id="node392" class="node">
<title>l3_expert_agg_gpu0</title>
<polygon fill="yellow" stroke="black" points="2377.4,-350.95 1661.71,-350.95 1477.6,-214.95 2193.29,-214.95 2377.4,-350.95"/>
<text text-anchor="middle" x="1927.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1927.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1927.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1927.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1257" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5274.37,-418.6C4665.29,-414.24 2948.5,-398.04 2386.5,-350.95 2386.39,-350.94 2386.29,-350.94 2386.18,-350.93"/>
<polygon fill="black" stroke="black" points="2386.49,-347.44 2376.23,-350.07 2385.89,-354.41 2386.49,-347.44"/>
</g>
<!-- l3_expert_agg_gpu1 -->
<g id="node400" class="node">
<title>l3_expert_agg_gpu1</title>
<polygon fill="yellow" stroke="black" points="3295.4,-350.95 2579.71,-350.95 2395.6,-214.95 3111.29,-214.95 3295.4,-350.95"/>
<text text-anchor="middle" x="2845.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2845.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2845.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2845.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1258" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5274.09,-416.23C4799.28,-407.6 3681.95,-384.35 3304.5,-350.95 3304.39,-350.94 3304.29,-350.93 3304.18,-350.93"/>
<polygon fill="black" stroke="black" points="3304.51,-347.44 3294.23,-350.02 3303.88,-354.41 3304.51,-347.44"/>
</g>
<!-- l3_expert_agg_gpu2 -->
<g id="node408" class="node">
<title>l3_expert_agg_gpu2</title>
<polygon fill="yellow" stroke="black" points="4213.4,-350.95 3497.71,-350.95 3313.6,-214.95 4029.29,-214.95 4213.4,-350.95"/>
<text text-anchor="middle" x="3763.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3763.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3763.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3763.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1259" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5274.36,-414.13C5021.3,-405.96 4590.78,-387.77 4222.5,-350.95 4222.39,-350.94 4222.29,-350.93 4222.18,-350.92"/>
<polygon fill="black" stroke="black" points="4222.55,-347.44 4212.24,-349.91 4221.84,-354.4 4222.55,-347.44"/>
</g>
<!-- l3_expert_agg_gpu3 -->
<g id="node416" class="node">
<title>l3_expert_agg_gpu3</title>
<polygon fill="yellow" stroke="black" points="5131.4,-350.95 4415.71,-350.95 4231.6,-214.95 4947.29,-214.95 5131.4,-350.95"/>
<text text-anchor="middle" x="4681.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4681.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4681.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4681.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1260" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5294.9,-386.94C5232.85,-376.53 5161.83,-364.6 5090.64,-352.65"/>
<polygon fill="black" stroke="black" points="5091.04,-349.17 5080.59,-350.96 5089.88,-356.07 5091.04,-349.17"/>
</g>
<!-- l3_expert_agg_gpu4 -->
<g id="node424" class="node">
<title>l3_expert_agg_gpu4</title>
<polygon fill="yellow" stroke="black" points="6049.4,-350.95 5333.71,-350.95 5149.6,-214.95 5865.29,-214.95 6049.4,-350.95"/>
<text text-anchor="middle" x="5599.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5599.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5599.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5599.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1261" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5517.92,-386.68C5524.6,-378.27 5532.06,-368.88 5539.67,-359.3"/>
<polygon fill="black" stroke="black" points="5542.61,-361.22 5546.09,-351.22 5537.13,-356.87 5542.61,-361.22"/>
</g>
<!-- l3_expert_agg_gpu5 -->
<g id="node432" class="node">
<title>l3_expert_agg_gpu5</title>
<polygon fill="yellow" stroke="black" points="6967.4,-350.95 6251.71,-350.95 6067.6,-214.95 6783.29,-214.95 6967.4,-350.95"/>
<text text-anchor="middle" x="6517.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6517.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6517.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6517.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1262" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M5708.59,-388.09C5711.58,-387.7 5714.55,-387.32 5717.5,-386.95 5868.71,-367.94 5907.29,-369.96 6058.5,-350.95 6108.03,-344.73 6160.49,-337.59 6211.56,-330.34"/>
<polygon fill="black" stroke="black" points="6212.34,-333.76 6221.75,-328.89 6211.36,-326.83 6212.34,-333.76"/>
</g>
<!-- l3_expert_agg_gpu6 -->
<g id="node440" class="node">
<title>l3_expert_agg_gpu6</title>
<polygon fill="yellow" stroke="black" points="7885.4,-350.95 7169.71,-350.95 6985.6,-214.95 7701.29,-214.95 7885.4,-350.95"/>
<text text-anchor="middle" x="7435.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7435.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7435.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7435.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1263" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M5708.55,-387.77C5711.55,-387.48 5714.54,-387.21 5717.5,-386.95 6275.18,-338.43 6418.82,-399.46 6976.5,-350.95 7027.38,-346.53 7081.21,-340.18 7133.42,-333.14"/>
<polygon fill="black" stroke="black" points="7134.05,-336.59 7143.49,-331.77 7133.11,-329.65 7134.05,-336.59"/>
</g>
<!-- l3_expert_agg_gpu7 -->
<g id="node448" class="node">
<title>l3_expert_agg_gpu7</title>
<polygon fill="yellow" stroke="black" points="8803.4,-350.95 8087.71,-350.95 7903.6,-214.95 8619.29,-214.95 8803.4,-350.95"/>
<text text-anchor="middle" x="8353.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8353.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8353.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8353.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1264" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M5708.55,-387.71C5711.55,-387.45 5714.54,-387.19 5717.5,-386.95 6682.03,-308.88 6929.96,-429 7894.5,-350.95 7945.59,-346.82 7999.65,-340.6 8052.04,-333.59"/>
<polygon fill="black" stroke="black" points="8052.71,-337.03 8062.15,-332.22 8051.77,-330.09 8052.71,-337.03"/>
</g>
<!-- l3_expert_agg_gpu8 -->
<g id="node456" class="node">
<title>l3_expert_agg_gpu8</title>
<polygon fill="yellow" stroke="black" points="9721.4,-350.95 9005.71,-350.95 8821.6,-214.95 9537.29,-214.95 9721.4,-350.95"/>
<text text-anchor="middle" x="9271.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9271.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9271.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9271.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1265" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M5708.55,-387.69C5711.55,-387.43 5714.54,-387.19 5717.5,-386.95 7088.93,-279.33 7441.06,-458.54 8812.5,-350.95 8863.69,-346.94 8917.86,-340.76 8970.35,-333.76"/>
<polygon fill="black" stroke="black" points="8971.03,-337.2 8980.47,-332.4 8970.1,-330.26 8971.03,-337.2"/>
</g>
<!-- l3_expert_agg_gpu9 -->
<g id="node464" class="node">
<title>l3_expert_agg_gpu9</title>
<polygon fill="yellow" stroke="black" points="10639.4,-350.95 9923.71,-350.95 9739.6,-214.95 10455.29,-214.95 10639.4,-350.95"/>
<text text-anchor="middle" x="10189.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10189.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10189.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10189.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1266" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M5708.55,-387.68C5711.55,-387.43 5714.53,-387.18 5717.5,-386.95 6606.67,-318.37 8841.33,-419.52 9730.5,-350.95 9781.7,-347.01 9835.87,-340.87 9888.36,-333.87"/>
<polygon fill="black" stroke="black" points="9889.04,-337.31 9898.48,-332.51 9888.1,-330.38 9889.04,-337.31"/>
</g>
<!-- l3_expert_agg_gpu10 -->
<g id="node472" class="node">
<title>l3_expert_agg_gpu10</title>
<polygon fill="yellow" stroke="black" points="11557.4,-350.95 10841.71,-350.95 10657.6,-214.95 11373.29,-214.95 11557.4,-350.95"/>
<text text-anchor="middle" x="11107.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11107.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11107.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11107.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1267" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M5708.55,-387.68C5711.55,-387.42 5714.53,-387.18 5717.5,-386.95 6810.13,-303.59 9555.87,-434.29 10648.5,-350.95 10699.7,-347.05 10753.88,-340.93 10806.36,-333.95"/>
<polygon fill="black" stroke="black" points="10807.04,-337.39 10816.49,-332.59 10806.11,-330.45 10807.04,-337.39"/>
</g>
<!-- l3_expert_agg_gpu11 -->
<g id="node480" class="node">
<title>l3_expert_agg_gpu11</title>
<polygon fill="yellow" stroke="black" points="12475.4,-350.95 11759.71,-350.95 11575.6,-214.95 12291.29,-214.95 12475.4,-350.95"/>
<text text-anchor="middle" x="12025.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12025.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12025.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12025.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1268" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M5708.55,-387.67C5711.55,-387.42 5714.53,-387.18 5717.5,-386.95 7013.59,-288.82 10270.41,-449.06 11566.5,-350.95 11617.8,-347.07 11672.08,-340.95 11724.66,-333.96"/>
<polygon fill="black" stroke="black" points="11725.35,-337.4 11734.8,-332.6 11724.42,-330.46 11725.35,-337.4"/>
</g>
<!-- l3_expert_agg_gpu12 -->
<g id="node488" class="node">
<title>l3_expert_agg_gpu12</title>
<polygon fill="yellow" stroke="black" points="13393.4,-350.95 12677.71,-350.95 12493.6,-214.95 13209.29,-214.95 13393.4,-350.95"/>
<text text-anchor="middle" x="12943.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12943.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12943.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12943.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1269" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M5708.55,-387.67C5711.55,-387.42 5714.53,-387.18 5717.5,-386.95 6467.28,-330.5 11734.72,-407.39 12484.5,-350.95 12535.8,-347.09 12590.08,-340.99 12642.66,-333.99"/>
<polygon fill="black" stroke="black" points="12643.36,-337.43 12652.8,-332.63 12642.42,-330.49 12643.36,-337.43"/>
</g>
<!-- l3_expert_agg_gpu13 -->
<g id="node496" class="node">
<title>l3_expert_agg_gpu13</title>
<polygon fill="yellow" stroke="black" points="14311.4,-350.95 13595.71,-350.95 13411.6,-214.95 14127.29,-214.95 14311.4,-350.95"/>
<text text-anchor="middle" x="13861.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13861.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13861.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13861.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1270" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M5708.55,-387.67C5711.55,-387.41 5714.53,-387.18 5717.5,-386.95 6569.01,-323.11 12550.99,-414.78 13402.5,-350.95 13453.8,-347.11 13508.08,-341.01 13560.66,-334.02"/>
<polygon fill="black" stroke="black" points="13561.36,-337.46 13570.8,-332.66 13560.43,-330.52 13561.36,-337.46"/>
</g>
<!-- l3_expert_agg_gpu14 -->
<g id="node504" class="node">
<title>l3_expert_agg_gpu14</title>
<polygon fill="yellow" stroke="black" points="15229.4,-350.95 14513.71,-350.95 14329.6,-214.95 15045.29,-214.95 15229.4,-350.95"/>
<text text-anchor="middle" x="14779.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14779.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14779.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14779.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1271" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M5708.55,-387.66C5711.55,-387.41 5714.53,-387.17 5717.5,-386.95 6670.74,-315.72 13367.26,-422.16 14320.5,-350.95 14371.8,-347.12 14426.08,-341.03 14478.66,-334.04"/>
<polygon fill="black" stroke="black" points="14479.36,-337.48 14488.81,-332.68 14478.43,-330.54 14479.36,-337.48"/>
</g>
<!-- l3_expert_agg_gpu15 -->
<g id="node512" class="node">
<title>l3_expert_agg_gpu15</title>
<polygon fill="yellow" stroke="black" points="16147.4,-350.95 15431.71,-350.95 15247.6,-214.95 15963.29,-214.95 16147.4,-350.95"/>
<text text-anchor="middle" x="15697.5" y="-301.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15697.5" y="-286.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="15697.5" y="-271.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15697.5" y="-256.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1272" class="edge">
<title>l3_expert_0_gpu0&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M5708.55,-387.66C5711.55,-387.41 5714.53,-387.17 5717.5,-386.95 6772.47,-308.33 14183.53,-429.55 15238.5,-350.95 15289.8,-347.13 15344.09,-341.04 15396.66,-334.06"/>
<polygon fill="black" stroke="black" points="15397.36,-337.5 15406.81,-332.7 15396.43,-330.56 15397.36,-337.5"/>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert_0_gpu0 -->
<g id="edge1255" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1104.64,-512.59C1175.46,-503.9 1250.45,-495.96 1320.5,-490.95 2096.93,-435.44 4510.36,-424.5 5264.17,-422.42"/>
<polygon fill="black" stroke="black" points="5264.34,-425.92 5274.33,-422.4 5264.32,-418.92 5264.34,-425.92"/>
</g>
<!-- l3_expert_agg_gpu0&#45;&gt;l3_res2_gpu0 -->
<g id="edge1273" class="edge">
<title>l3_expert_agg_gpu0&#45;&gt;l3_res2_gpu0</title>
<path fill="none" stroke="black" d="M1927.5,-214.75C1927.5,-206 1927.5,-197.23 1927.5,-189.02"/>
<polygon fill="black" stroke="black" points="1931,-188.97 1927.5,-178.97 1924,-188.97 1931,-188.97"/>
</g>
<!-- output -->
<g id="node514" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="8812.5" cy="-37.48" rx="306.77" ry="37.45"/>
<text text-anchor="middle" x="8812.5" y="-48.78" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="8812.5" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8812.5" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_res2_gpu0&#45;&gt;output -->
<g id="edge1665" class="edge">
<title>l3_res2_gpu0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2144.82,-131.58C2281.11,-124.32 2460.51,-115.67 2619.5,-110.95 4869.99,-44.15 7582.21,-38.14 8495.2,-38.17"/>
<polygon fill="black" stroke="black" points="8495.53,-41.67 8505.53,-38.17 8495.53,-34.67 8495.53,-41.67"/>
</g>
<!-- l3_mha_attn_gpu1 -->
<g id="node395" class="node">
<title>l3_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1439,-938.95 958,-938.95 958,-870.95 1439,-870.95 1439,-938.95"/>
<text text-anchor="middle" x="1198.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1198.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1198.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1198.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu1&#45;&gt;l3_mha_attn_gpu1 -->
<g id="edge1276" class="edge">
<title>l3_mha_qkv_gpu1&#45;&gt;l3_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M1198.5,-974.84C1198.5,-966.73 1198.5,-957.94 1198.5,-949.43"/>
<polygon fill="black" stroke="black" points="1202,-949.25 1198.5,-939.25 1195,-949.25 1202,-949.25"/>
</g>
<!-- l3_mha_out_gpu1 -->
<g id="node396" class="node">
<title>l3_mha_out_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1436,-834.95 967,-834.95 967,-766.95 1436,-766.95 1436,-834.95"/>
<text text-anchor="middle" x="1201.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1201.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1201.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1201.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu1&#45;&gt;l3_mha_out_gpu1 -->
<g id="edge1277" class="edge">
<title>l3_mha_attn_gpu1&#45;&gt;l3_mha_out_gpu1</title>
<path fill="none" stroke="black" d="M1199.47,-870.84C1199.71,-862.73 1199.97,-853.94 1200.22,-845.43"/>
<polygon fill="black" stroke="black" points="1203.73,-845.35 1200.52,-835.25 1196.73,-845.15 1203.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu1&#45;&gt;l3_mha_res_add_gpu1 -->
<g id="edge1278" class="edge">
<title>l3_mha_out_gpu1&#45;&gt;l3_mha_res_add_gpu1</title>
<path fill="none" stroke="black" d="M1244.68,-766.84C1256.88,-757.48 1270.27,-747.21 1282.91,-737.52"/>
<polygon fill="black" stroke="black" points="1285.28,-740.12 1291.08,-731.25 1281.02,-734.56 1285.28,-740.12"/>
</g>
<!-- l3_expert_1_gpu1 -->
<g id="node398" class="node">
<title>l3_expert_1_gpu1</title>
<polygon fill="lightpink" stroke="black" points="6160.5,-454.95 5726.5,-454.95 5726.5,-386.95 6160.5,-386.95 6160.5,-454.95"/>
<text text-anchor="middle" x="5943.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5943.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5943.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5943.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu1&#45;&gt;l3_expert_1_gpu1 -->
<g id="edge1282" class="edge">
<title>l3_mha_res_add_gpu1&#45;&gt;l3_expert_1_gpu1</title>
<path fill="none" stroke="black" d="M1332.63,-662.78C1332.02,-615.85 1338.87,-531.29 1391.5,-490.95 1438.16,-455.19 5478.26,-459.35 5716.35,-454.56"/>
<polygon fill="black" stroke="black" points="5716.57,-458.05 5726.45,-454.23 5716.34,-451.05 5716.57,-458.05"/>
</g>
<!-- l3_gate_gpu1 -->
<g id="node399" class="node">
<title>l3_gate_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="2352.24,-626.95 1595.44,-626.95 1400.76,-490.95 2157.56,-490.95 2352.24,-626.95"/>
<text text-anchor="middle" x="1876.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1876.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1876.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1876.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu1&#45;&gt;l3_gate_gpu1 -->
<g id="edge1280" class="edge">
<title>l3_mha_res_add_gpu1&#45;&gt;l3_gate_gpu1</title>
<path fill="none" stroke="black" d="M1466.05,-662.94C1506.64,-652.76 1552.96,-641.14 1599.52,-629.45"/>
<polygon fill="black" stroke="black" points="1600.6,-632.79 1609.45,-626.96 1598.9,-626 1600.6,-632.79"/>
</g>
<!-- l3_res2_gpu1 -->
<g id="node401" class="node">
<title>l3_res2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="3062.5,-178.95 2628.5,-178.95 2628.5,-110.95 3062.5,-110.95 3062.5,-178.95"/>
<text text-anchor="middle" x="2845.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2845.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2845.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2845.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu1&#45;&gt;l3_res2_gpu1 -->
<g id="edge1300" class="edge">
<title>l3_mha_res_add_gpu1&#45;&gt;l3_res2_gpu1</title>
<path fill="none" stroke="black" d="M1117.2,-689.33C815.39,-679.04 302.87,-657.23 274.5,-626.95 146.56,-490.41 393.96,-242.91 442.5,-214.95 524.89,-167.5 2058.48,-182.22 2153.5,-178.95 2308.59,-173.62 2483.12,-165.29 2618.11,-158.32"/>
<polygon fill="black" stroke="black" points="2618.36,-161.81 2628.17,-157.8 2618,-154.82 2618.36,-161.81"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1283" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5726.45,-387.69C5723.45,-387.43 5720.46,-387.18 5717.5,-386.95 4979.48,-329.34 3124.52,-408.54 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.78,-347.47 2376.53,-350.15 2386.22,-354.44 2386.78,-347.47"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1284" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5726.45,-387.71C5723.45,-387.44 5720.46,-387.19 5717.5,-386.95 4648.36,-301.29 4373.64,-436.59 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.78,-347.47 3294.53,-350.13 3304.21,-354.44 3304.78,-347.47"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1285" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5726.45,-387.75C5723.45,-387.47 5720.46,-387.2 5717.5,-386.95 5055.24,-330.84 4884.77,-407.06 4222.5,-350.95 4222.39,-350.94 4222.29,-350.94 4222.18,-350.93"/>
<polygon fill="black" stroke="black" points="4222.5,-347.44 4212.23,-350.06 4221.89,-354.41 4222.5,-347.44"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1286" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5726.43,-387.91C5723.44,-387.58 5720.46,-387.26 5717.5,-386.95 5461.94,-360.37 5396.06,-377.53 5140.5,-350.95 5140.39,-350.94 5140.28,-350.93 5140.17,-350.92"/>
<polygon fill="black" stroke="black" points="5140.26,-347.41 5129.95,-349.84 5139.52,-354.37 5140.26,-347.41"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1287" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5859.79,-386.86C5835.04,-377.07 5806.95,-365.97 5778.6,-354.76"/>
<polygon fill="black" stroke="black" points="5779.57,-351.38 5768.98,-350.96 5776.99,-357.89 5779.57,-351.38"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1288" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6082.82,-386.94C6129.67,-375.84 6183.75,-363.03 6237.5,-350.3"/>
<polygon fill="black" stroke="black" points="6238.6,-353.63 6247.53,-347.92 6236.99,-346.82 6238.6,-353.63"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1289" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6160.56,-387.83C6163.56,-387.53 6166.54,-387.23 6169.5,-386.95 6526.91,-352.97 6619.09,-384.92 6976.5,-350.95 7027.15,-346.14 7080.76,-339.62 7132.77,-332.53"/>
<polygon fill="black" stroke="black" points="7133.38,-335.98 7142.81,-331.15 7132.43,-329.05 7133.38,-335.98"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1290" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6160.55,-387.73C6163.55,-387.46 6166.54,-387.2 6169.5,-386.95 6933.7,-323.43 7130.3,-414.46 7894.5,-350.95 7945.49,-346.72 7999.44,-340.46 8051.74,-333.44"/>
<polygon fill="black" stroke="black" points="8052.39,-336.88 8061.83,-332.07 8051.45,-329.95 8052.39,-336.88"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1291" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6160.55,-387.7C6163.55,-387.44 6166.54,-387.19 6169.5,-386.95 7340.58,-293.88 7641.41,-444 8812.5,-350.95 8863.69,-346.89 8917.86,-340.69 8970.34,-333.67"/>
<polygon fill="black" stroke="black" points="8971.02,-337.11 8980.47,-332.31 8970.09,-330.18 8971.02,-337.11"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1292" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6160.55,-387.69C6163.55,-387.43 6166.54,-387.18 6169.5,-386.95 6958.5,-325.64 8941.5,-412.25 9730.5,-350.95 9781.7,-346.98 9835.87,-340.82 9888.35,-333.83"/>
<polygon fill="black" stroke="black" points="9889.03,-337.27 9898.48,-332.46 9888.1,-330.33 9889.03,-337.27"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1293" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6160.55,-387.68C6163.55,-387.42 6166.53,-387.18 6169.5,-386.95 7161.95,-310.87 9656.05,-427.02 10648.5,-350.95 10699.7,-347.03 10753.87,-340.9 10806.36,-333.92"/>
<polygon fill="black" stroke="black" points="10807.04,-337.36 10816.49,-332.55 10806.11,-330.42 10807.04,-337.36"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1294" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6160.55,-387.67C6163.55,-387.42 6166.53,-387.18 6169.5,-386.95 7365.41,-296.09 10370.58,-441.79 11566.5,-350.95 11617.8,-347.06 11672.08,-340.93 11724.65,-333.94"/>
<polygon fill="black" stroke="black" points="11725.35,-337.37 11734.8,-332.57 11724.42,-330.44 11725.35,-337.37"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1295" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6160.55,-387.67C6163.55,-387.42 6166.53,-387.18 6169.5,-386.95 7568.87,-281.31 11085.12,-456.56 12484.5,-350.95 12535.8,-347.08 12590.08,-340.97 12642.66,-333.98"/>
<polygon fill="black" stroke="black" points="12643.36,-337.42 12652.8,-332.62 12642.42,-330.48 12643.36,-337.42"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1296" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6160.55,-387.67C6163.55,-387.41 6166.53,-387.18 6169.5,-386.95 6970.92,-326.75 12601.08,-411.14 13402.5,-350.95 13453.8,-347.1 13508.08,-341 13560.66,-334.01"/>
<polygon fill="black" stroke="black" points="13561.36,-337.45 13570.8,-332.65 13560.43,-330.51 13561.36,-337.45"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1297" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6160.55,-387.66C6163.55,-387.41 6166.53,-387.18 6169.5,-386.95 7072.65,-319.36 13417.35,-418.53 14320.5,-350.95 14371.8,-347.11 14426.08,-341.02 14478.66,-334.03"/>
<polygon fill="black" stroke="black" points="14479.36,-337.47 14488.8,-332.67 14478.43,-330.53 14479.36,-337.47"/>
</g>
<!-- l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1298" class="edge">
<title>l3_expert_1_gpu1&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6160.55,-387.66C6163.55,-387.41 6166.53,-387.17 6169.5,-386.95 7174.38,-311.97 14233.62,-425.91 15238.5,-350.95 15289.8,-347.13 15344.08,-341.04 15396.66,-334.05"/>
<polygon fill="black" stroke="black" points="15397.36,-337.49 15406.81,-332.69 15396.43,-330.55 15397.36,-337.49"/>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert_1_gpu1 -->
<g id="edge1281" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert_1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2188.26,-512.34C2259.2,-503.65 2334.32,-495.77 2404.5,-490.95 3135.72,-440.76 4966.83,-511.63 5716.32,-454.99"/>
<polygon fill="black" stroke="black" points="5716.75,-458.47 5726.45,-454.22 5716.21,-451.49 5716.75,-458.47"/>
</g>
<!-- l3_expert_agg_gpu1&#45;&gt;l3_res2_gpu1 -->
<g id="edge1299" class="edge">
<title>l3_expert_agg_gpu1&#45;&gt;l3_res2_gpu1</title>
<path fill="none" stroke="black" d="M2845.5,-214.75C2845.5,-206 2845.5,-197.23 2845.5,-189.02"/>
<polygon fill="black" stroke="black" points="2849,-188.97 2845.5,-178.97 2842,-188.97 2849,-188.97"/>
</g>
<!-- l3_res2_gpu1&#45;&gt;output -->
<g id="edge1666" class="edge">
<title>l3_res2_gpu1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3062.82,-131.7C3199.11,-124.48 3378.51,-115.84 3537.5,-110.95 5417.5,-53.23 7675.82,-41.48 8495.66,-39.09"/>
<polygon fill="black" stroke="black" points="8495.84,-42.59 8505.83,-39.06 8495.82,-35.59 8495.84,-42.59"/>
</g>
<!-- l3_mha_attn_gpu2 -->
<g id="node403" class="node">
<title>l3_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2523,-938.95 2042,-938.95 2042,-870.95 2523,-870.95 2523,-938.95"/>
<text text-anchor="middle" x="2282.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2282.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2282.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2282.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu2&#45;&gt;l3_mha_attn_gpu2 -->
<g id="edge1302" class="edge">
<title>l3_mha_qkv_gpu2&#45;&gt;l3_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M2282.5,-974.84C2282.5,-966.73 2282.5,-957.94 2282.5,-949.43"/>
<polygon fill="black" stroke="black" points="2286,-949.25 2282.5,-939.25 2279,-949.25 2286,-949.25"/>
</g>
<!-- l3_mha_out_gpu2 -->
<g id="node404" class="node">
<title>l3_mha_out_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="2520,-834.95 2051,-834.95 2051,-766.95 2520,-766.95 2520,-834.95"/>
<text text-anchor="middle" x="2285.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2285.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2285.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2285.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu2&#45;&gt;l3_mha_out_gpu2 -->
<g id="edge1303" class="edge">
<title>l3_mha_attn_gpu2&#45;&gt;l3_mha_out_gpu2</title>
<path fill="none" stroke="black" d="M2283.47,-870.84C2283.71,-862.73 2283.97,-853.94 2284.22,-845.43"/>
<polygon fill="black" stroke="black" points="2287.73,-845.35 2284.52,-835.25 2280.73,-845.15 2287.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu2&#45;&gt;l3_mha_res_add_gpu2 -->
<g id="edge1304" class="edge">
<title>l3_mha_out_gpu2&#45;&gt;l3_mha_res_add_gpu2</title>
<path fill="none" stroke="black" d="M2328.68,-766.84C2340.88,-757.48 2354.27,-747.21 2366.91,-737.52"/>
<polygon fill="black" stroke="black" points="2369.28,-740.12 2375.08,-731.25 2365.02,-734.56 2369.28,-740.12"/>
</g>
<!-- l3_expert_2_gpu2 -->
<g id="node406" class="node">
<title>l3_expert_2_gpu2</title>
<polygon fill="lightpink" stroke="black" points="6612.5,-454.95 6178.5,-454.95 6178.5,-386.95 6612.5,-386.95 6612.5,-454.95"/>
<text text-anchor="middle" x="6395.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6395.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6395.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6395.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu2&#45;&gt;l3_expert_2_gpu2 -->
<g id="edge1308" class="edge">
<title>l3_mha_res_add_gpu2&#45;&gt;l3_expert_2_gpu2</title>
<path fill="none" stroke="black" d="M2416.64,-662.79C2416.04,-615.87 2422.9,-531.33 2475.5,-490.95 2515.23,-460.46 5948.02,-458.97 6168.15,-454.55"/>
<polygon fill="black" stroke="black" points="6168.57,-458.04 6178.45,-454.22 6168.34,-451.04 6168.57,-458.04"/>
</g>
<!-- l3_gate_gpu2 -->
<g id="node407" class="node">
<title>l3_gate_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="3436.24,-626.95 2679.44,-626.95 2484.76,-490.95 3241.56,-490.95 3436.24,-626.95"/>
<text text-anchor="middle" x="2960.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2960.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2960.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2960.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu2&#45;&gt;l3_gate_gpu2 -->
<g id="edge1306" class="edge">
<title>l3_mha_res_add_gpu2&#45;&gt;l3_gate_gpu2</title>
<path fill="none" stroke="black" d="M2550.05,-662.94C2590.64,-652.76 2636.96,-641.14 2683.52,-629.45"/>
<polygon fill="black" stroke="black" points="2684.6,-632.79 2693.45,-626.96 2682.9,-626 2684.6,-632.79"/>
</g>
<!-- l3_res2_gpu2 -->
<g id="node409" class="node">
<title>l3_res2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="3980.5,-178.95 3546.5,-178.95 3546.5,-110.95 3980.5,-110.95 3980.5,-178.95"/>
<text text-anchor="middle" x="3763.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3763.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3763.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3763.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu2&#45;&gt;l3_res2_gpu2 -->
<g id="edge1326" class="edge">
<title>l3_mha_res_add_gpu2&#45;&gt;l3_res2_gpu2</title>
<path fill="none" stroke="black" d="M2201.21,-687.01C2027.78,-680.02 1778.58,-670.28 1560.5,-662.95 1525.7,-661.78 331.77,-651.93 307.5,-626.95 265.38,-583.6 270.9,-539.06 307.5,-490.95 585.88,-125.03 849.56,-281.49 1304.5,-214.95 1693.11,-158.12 2678.98,-192.31 3071.5,-178.95 3226.59,-173.68 3401.13,-165.34 3536.11,-158.36"/>
<polygon fill="black" stroke="black" points="3536.36,-161.85 3546.17,-157.84 3536,-154.86 3536.36,-161.85"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1309" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6178.45,-387.69C6175.45,-387.43 6172.47,-387.18 6169.5,-386.95 5331.3,-322.07 3224.7,-415.82 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.16 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1310" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6178.45,-387.7C6175.45,-387.44 6172.46,-387.19 6169.5,-386.95 4900.02,-286.74 4573.99,-451.14 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.78,-347.47 3294.53,-350.14 3304.21,-354.44 3304.78,-347.47"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1311" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6178.45,-387.72C6175.45,-387.45 6172.46,-387.2 6169.5,-386.95 5306.91,-316.29 5085.09,-421.6 4222.5,-350.95 4222.4,-350.94 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.79,-347.47 4212.53,-350.11 4222.2,-354.44 4222.79,-347.47"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1312" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6178.44,-387.79C6175.44,-387.5 6172.46,-387.22 6169.5,-386.95 5713.74,-345.83 5596.26,-392.06 5140.5,-350.95 5140.39,-350.94 5140.29,-350.93 5140.18,-350.92"/>
<polygon fill="black" stroke="black" points="5140.51,-347.44 5130.24,-350.01 5139.87,-354.41 5140.51,-347.44"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1313" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6202.3,-386.94C6141.32,-376.53 6071.53,-364.6 6001.57,-352.65"/>
<polygon fill="black" stroke="black" points="6002.14,-349.2 5991.7,-350.96 6000.96,-356.1 6002.14,-349.2"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1314" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6425.34,-386.68C6433.05,-378.1 6441.65,-368.5 6450.43,-358.72"/>
<polygon fill="black" stroke="black" points="6453.09,-361 6457.16,-351.22 6447.88,-356.32 6453.09,-361"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1315" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6612.59,-388.07C6615.58,-387.69 6618.55,-387.32 6621.5,-386.95 6778.89,-367.49 6819.11,-370.41 6976.5,-350.95 7026.05,-344.83 7078.51,-337.74 7129.58,-330.52"/>
<polygon fill="black" stroke="black" points="7130.36,-333.94 7139.77,-329.07 7129.38,-327.01 7130.36,-333.94"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1316" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6612.55,-387.76C6615.55,-387.48 6618.54,-387.21 6621.5,-386.95 7185.38,-337.98 7330.62,-399.91 7894.5,-350.95 7945.38,-346.54 7999.21,-340.2 8051.42,-333.16"/>
<polygon fill="black" stroke="black" points="8052.05,-336.6 8061.49,-331.79 8051.11,-329.67 8052.05,-336.6"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1317" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6612.55,-387.71C6615.55,-387.45 6618.54,-387.19 6621.5,-386.95 7592.24,-308.43 7841.76,-429.45 8812.5,-350.95 8863.59,-346.82 8917.65,-340.6 8970.04,-333.59"/>
<polygon fill="black" stroke="black" points="8970.71,-337.03 8980.15,-332.23 8969.77,-330.1 8970.71,-337.03"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1318" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6612.55,-387.69C6615.55,-387.43 6618.54,-387.19 6621.5,-386.95 7310.32,-332.92 9041.68,-404.97 9730.5,-350.95 9781.69,-346.94 9835.86,-340.77 9888.35,-333.76"/>
<polygon fill="black" stroke="black" points="9889.03,-337.2 9898.47,-332.4 9888.1,-330.26 9889.03,-337.2"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1319" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6612.55,-387.68C6615.55,-387.43 6618.53,-387.18 6621.5,-386.95 7513.78,-318.14 9756.22,-419.74 10648.5,-350.95 10699.7,-347.01 10753.87,-340.87 10806.36,-333.88"/>
<polygon fill="black" stroke="black" points="10807.04,-337.32 10816.48,-332.51 10806.11,-330.38 10807.04,-337.32"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1320" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6612.55,-387.68C6615.55,-387.42 6618.53,-387.18 6621.5,-386.95 7717.23,-303.37 10470.76,-434.51 11566.5,-350.95 11617.7,-347.05 11671.88,-340.93 11724.36,-333.95"/>
<polygon fill="black" stroke="black" points="11725.04,-337.39 11734.49,-332.59 11724.11,-330.45 11725.04,-337.39"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1321" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6612.55,-387.67C6615.55,-387.42 6618.53,-387.18 6621.5,-386.95 7920.7,-288.59 11185.3,-449.29 12484.5,-350.95 12535.8,-347.07 12590.08,-340.95 12642.66,-333.96"/>
<polygon fill="black" stroke="black" points="12643.35,-337.4 12652.8,-332.6 12642.42,-330.46 12643.35,-337.4"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1322" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6612.55,-387.67C6615.55,-387.42 6618.53,-387.18 6621.5,-386.95 7372.83,-330.38 12651.17,-407.51 13402.5,-350.95 13453.8,-347.09 13508.08,-340.99 13560.66,-334"/>
<polygon fill="black" stroke="black" points="13561.36,-337.43 13570.8,-332.63 13560.42,-330.5 13561.36,-337.43"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1323" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6612.55,-387.67C6615.55,-387.41 6618.53,-387.18 6621.5,-386.95 7474.56,-323 13467.44,-414.89 14320.5,-350.95 14371.8,-347.11 14426.08,-341.01 14478.66,-334.02"/>
<polygon fill="black" stroke="black" points="14479.36,-337.46 14488.8,-332.66 14478.43,-330.52 14479.36,-337.46"/>
</g>
<!-- l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1324" class="edge">
<title>l3_expert_2_gpu2&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6612.55,-387.66C6615.55,-387.41 6618.53,-387.17 6621.5,-386.95 7576.29,-315.61 14283.71,-422.28 15238.5,-350.95 15289.8,-347.12 15344.08,-341.03 15396.66,-334.04"/>
<polygon fill="black" stroke="black" points="15397.36,-337.48 15406.81,-332.68 15396.43,-330.54 15397.36,-337.48"/>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert_2_gpu2 -->
<g id="edge1307" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert_2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3268.98,-509.91C3329.05,-502.22 3391.63,-495.35 3450.5,-490.95 4652.31,-401.17 4962.99,-549.63 6168.25,-455.01"/>
<polygon fill="black" stroke="black" points="6168.76,-458.48 6178.45,-454.21 6168.21,-451.5 6168.76,-458.48"/>
</g>
<!-- l3_expert_agg_gpu2&#45;&gt;l3_res2_gpu2 -->
<g id="edge1325" class="edge">
<title>l3_expert_agg_gpu2&#45;&gt;l3_res2_gpu2</title>
<path fill="none" stroke="black" d="M3763.5,-214.75C3763.5,-206 3763.5,-197.23 3763.5,-189.02"/>
<polygon fill="black" stroke="black" points="3767,-188.97 3763.5,-178.97 3760,-188.97 3767,-188.97"/>
</g>
<!-- l3_res2_gpu2&#45;&gt;output -->
<g id="edge1667" class="edge">
<title>l3_res2_gpu2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3980.82,-131.86C4117.12,-124.7 4296.52,-116.07 4455.5,-110.95 5968.34,-62.31 7777.76,-45.43 8496.14,-40.38"/>
<polygon fill="black" stroke="black" points="8496.4,-43.88 8506.37,-40.31 8496.35,-36.88 8496.4,-43.88"/>
</g>
<!-- l3_mha_attn_gpu3 -->
<g id="node411" class="node">
<title>l3_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3569,-938.95 3088,-938.95 3088,-870.95 3569,-870.95 3569,-938.95"/>
<text text-anchor="middle" x="3328.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3328.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3328.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3328.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu3&#45;&gt;l3_mha_attn_gpu3 -->
<g id="edge1328" class="edge">
<title>l3_mha_qkv_gpu3&#45;&gt;l3_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M3328.5,-974.84C3328.5,-966.73 3328.5,-957.94 3328.5,-949.43"/>
<polygon fill="black" stroke="black" points="3332,-949.25 3328.5,-939.25 3325,-949.25 3332,-949.25"/>
</g>
<!-- l3_mha_out_gpu3 -->
<g id="node412" class="node">
<title>l3_mha_out_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3566,-834.95 3097,-834.95 3097,-766.95 3566,-766.95 3566,-834.95"/>
<text text-anchor="middle" x="3331.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3331.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3331.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3331.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu3&#45;&gt;l3_mha_out_gpu3 -->
<g id="edge1329" class="edge">
<title>l3_mha_attn_gpu3&#45;&gt;l3_mha_out_gpu3</title>
<path fill="none" stroke="black" d="M3329.47,-870.84C3329.71,-862.73 3329.97,-853.94 3330.22,-845.43"/>
<polygon fill="black" stroke="black" points="3333.73,-845.35 3330.52,-835.25 3326.73,-845.15 3333.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu3&#45;&gt;l3_mha_res_add_gpu3 -->
<g id="edge1330" class="edge">
<title>l3_mha_out_gpu3&#45;&gt;l3_mha_res_add_gpu3</title>
<path fill="none" stroke="black" d="M3374.68,-766.84C3386.88,-757.48 3400.27,-747.21 3412.91,-737.52"/>
<polygon fill="black" stroke="black" points="3415.28,-740.12 3421.08,-731.25 3411.02,-734.56 3415.28,-740.12"/>
</g>
<!-- l3_expert_3_gpu3 -->
<g id="node414" class="node">
<title>l3_expert_3_gpu3</title>
<polygon fill="lightpink" stroke="black" points="7064.5,-454.95 6630.5,-454.95 6630.5,-386.95 7064.5,-386.95 7064.5,-454.95"/>
<text text-anchor="middle" x="6847.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6847.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6847.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6847.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu3&#45;&gt;l3_expert_3_gpu3 -->
<g id="edge1334" class="edge">
<title>l3_mha_res_add_gpu3&#45;&gt;l3_expert_3_gpu3</title>
<path fill="none" stroke="black" d="M3505.03,-662.88C3567.55,-614.17 3693.34,-525.25 3817.5,-490.95 3965.17,-450.16 6383.88,-466.66 6620.36,-454.83"/>
<polygon fill="black" stroke="black" points="6620.69,-458.32 6630.45,-454.21 6620.25,-451.33 6620.69,-458.32"/>
</g>
<!-- l3_gate_gpu3 -->
<g id="node415" class="node">
<title>l3_gate_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="4778.24,-626.95 4021.44,-626.95 3826.76,-490.95 4583.56,-490.95 4778.24,-626.95"/>
<text text-anchor="middle" x="4302.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4302.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4302.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4302.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu3&#45;&gt;l3_gate_gpu3 -->
<g id="edge1332" class="edge">
<title>l3_mha_res_add_gpu3&#45;&gt;l3_gate_gpu3</title>
<path fill="none" stroke="black" d="M3667.89,-662.94C3763.49,-647.43 3879.67,-628.58 3986.36,-611.26"/>
<polygon fill="black" stroke="black" points="3987.02,-614.7 3996.33,-609.64 3985.9,-607.79 3987.02,-614.7"/>
</g>
<!-- l3_res2_gpu3 -->
<g id="node417" class="node">
<title>l3_res2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="4898.5,-178.95 4464.5,-178.95 4464.5,-110.95 4898.5,-110.95 4898.5,-178.95"/>
<text text-anchor="middle" x="4681.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4681.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4681.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4681.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu3&#45;&gt;l3_res2_gpu3 -->
<g id="edge1352" class="edge">
<title>l3_mha_res_add_gpu3&#45;&gt;l3_res2_gpu3</title>
<path fill="none" stroke="black" d="M3247.42,-686.46C3082.15,-679.42 2849.01,-669.88 2644.5,-662.95 2608.12,-661.72 1360.7,-652.22 1334.5,-626.95 1297.72,-591.49 1302.19,-236.55 1323.5,-214.95 1349.51,-188.59 3952.49,-180.09 3989.5,-178.95 4144.61,-174.21 4319.14,-165.86 4454.12,-158.75"/>
<polygon fill="black" stroke="black" points="4454.38,-162.25 4464.18,-158.22 4454.01,-155.26 4454.38,-162.25"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1335" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6630.45,-387.68C6627.45,-387.42 6624.47,-387.18 6621.5,-386.95 5683.13,-314.79 3324.88,-423.09 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.16 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1336" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6630.45,-387.69C6627.45,-387.43 6624.46,-387.18 6621.5,-386.95 5886.58,-329.57 4039.42,-408.32 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.78,-347.47 3294.53,-350.15 3304.22,-354.44 3304.78,-347.47"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1337" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6630.45,-387.71C6627.45,-387.44 6624.46,-387.19 6621.5,-386.95 5558.57,-301.74 5285.43,-436.14 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.78,-347.47 4212.53,-350.13 4222.21,-354.44 4222.78,-347.47"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1338" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6630.45,-387.75C6627.45,-387.47 6624.46,-387.2 6621.5,-386.95 5965.44,-331.29 5796.56,-406.61 5140.5,-350.95 5140.39,-350.94 5140.29,-350.94 5140.18,-350.93"/>
<polygon fill="black" stroke="black" points="5140.5,-347.44 5130.23,-350.06 5139.89,-354.41 5140.5,-347.44"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1339" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6630.43,-387.91C6627.44,-387.58 6624.46,-387.26 6621.5,-386.95 6372.13,-360.82 6307.87,-377.08 6058.5,-350.95 6058.39,-350.94 6058.28,-350.93 6058.17,-350.92"/>
<polygon fill="black" stroke="black" points="6058.26,-347.41 6047.95,-349.83 6057.52,-354.37 6058.26,-347.41"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1340" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6767.19,-386.86C6743.56,-377.12 6716.74,-366.06 6689.66,-354.91"/>
<polygon fill="black" stroke="black" points="6690.66,-351.53 6680.08,-350.96 6687.99,-358 6690.66,-351.53"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1341" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6990.21,-386.94C7039.78,-375.48 7097.23,-362.19 7154.05,-349.05"/>
<polygon fill="black" stroke="black" points="7154.95,-352.44 7163.9,-346.77 7153.37,-345.62 7154.95,-352.44"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1342" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7064.56,-387.83C7067.56,-387.53 7070.54,-387.23 7073.5,-386.95 7437.11,-352.52 7530.89,-385.37 7894.5,-350.95 7945.15,-346.16 7998.76,-339.65 8050.78,-332.56"/>
<polygon fill="black" stroke="black" points="8051.38,-336.01 8060.81,-331.19 8050.43,-329.08 8051.38,-336.01"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1343" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7064.55,-387.73C7067.55,-387.46 7070.54,-387.2 7073.5,-386.95 7843.9,-322.98 8042.1,-414.91 8812.5,-350.95 8863.49,-346.72 8917.44,-340.46 8969.74,-333.45"/>
<polygon fill="black" stroke="black" points="8970.39,-336.89 8979.83,-332.08 8969.45,-329.95 8970.39,-336.89"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1344" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7064.55,-387.7C7067.55,-387.44 7070.54,-387.19 7073.5,-386.95 8250.79,-293.43 8553.21,-444.45 9730.5,-350.95 9781.69,-346.89 9835.86,-340.69 9888.34,-333.68"/>
<polygon fill="black" stroke="black" points="9889.02,-337.12 9898.47,-332.31 9888.09,-330.18 9889.02,-337.12"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1345" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7064.55,-387.69C7067.55,-387.43 7070.54,-387.18 7073.5,-386.95 7865.6,-325.42 9856.4,-412.47 10648.5,-350.95 10699.7,-346.98 10753.87,-340.82 10806.35,-333.83"/>
<polygon fill="black" stroke="black" points="10807.03,-337.27 10816.48,-332.46 10806.1,-330.33 10807.03,-337.27"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1346" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7064.55,-387.68C7067.55,-387.42 7070.53,-387.18 7073.5,-386.95 8069.06,-310.64 10570.94,-427.24 11566.5,-350.95 11617.7,-347.03 11671.87,-340.9 11724.36,-333.92"/>
<polygon fill="black" stroke="black" points="11725.04,-337.36 11734.49,-332.56 11724.11,-330.42 11725.04,-337.36"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1347" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7064.55,-387.67C7067.55,-387.42 7070.53,-387.18 7073.5,-386.95 8272.52,-295.87 11285.48,-442.01 12484.5,-350.95 12535.8,-347.06 12590.08,-340.93 12642.65,-333.94"/>
<polygon fill="black" stroke="black" points="12643.35,-337.37 12652.8,-332.57 12642.42,-330.44 12643.35,-337.37"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1348" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7064.55,-387.67C7067.55,-387.42 7070.53,-387.18 7073.5,-386.95 8475.98,-281.09 12000.02,-456.78 13402.5,-350.95 13453.8,-347.08 13508.08,-340.97 13560.66,-333.98"/>
<polygon fill="black" stroke="black" points="13561.36,-337.42 13570.8,-332.62 13560.42,-330.48 13561.36,-337.42"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1349" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7064.55,-387.67C7067.55,-387.41 7070.53,-387.18 7073.5,-386.95 7876.47,-326.63 13517.53,-411.25 14320.5,-350.95 14371.8,-347.1 14426.08,-341 14478.66,-334.01"/>
<polygon fill="black" stroke="black" points="14479.36,-337.45 14488.8,-332.65 14478.43,-330.51 14479.36,-337.45"/>
</g>
<!-- l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1350" class="edge">
<title>l3_expert_3_gpu3&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7064.55,-387.66C7067.55,-387.41 7070.53,-387.18 7073.5,-386.95 7978.2,-319.25 14333.8,-418.64 15238.5,-350.95 15289.8,-347.12 15344.08,-341.02 15396.66,-334.03"/>
<polygon fill="black" stroke="black" points="15397.36,-337.47 15406.8,-332.67 15396.43,-330.53 15397.36,-337.47"/>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert_3_gpu3 -->
<g id="edge1333" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert_3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4633.05,-525.18C4773.09,-512.49 4938.12,-499.07 5087.5,-490.95 5765.14,-454.12 5940.25,-511.76 6620.4,-455.01"/>
<polygon fill="black" stroke="black" points="6620.78,-458.49 6630.45,-454.16 6620.19,-451.51 6620.78,-458.49"/>
</g>
<!-- l3_expert_agg_gpu3&#45;&gt;l3_res2_gpu3 -->
<g id="edge1351" class="edge">
<title>l3_expert_agg_gpu3&#45;&gt;l3_res2_gpu3</title>
<path fill="none" stroke="black" d="M4681.5,-214.75C4681.5,-206 4681.5,-197.23 4681.5,-189.02"/>
<polygon fill="black" stroke="black" points="4685,-188.97 4681.5,-178.97 4678,-188.97 4685,-188.97"/>
</g>
<!-- l3_res2_gpu3&#45;&gt;output -->
<g id="edge1668" class="edge">
<title>l3_res2_gpu3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4898.83,-132.11C5035.13,-125.04 5214.53,-116.42 5373.5,-110.95 6524.29,-71.39 7892.49,-50.31 8497.75,-42.31"/>
<polygon fill="black" stroke="black" points="8497.98,-45.81 8507.93,-42.18 8497.89,-38.81 8497.98,-45.81"/>
</g>
<!-- l3_mha_attn_gpu4 -->
<g id="node419" class="node">
<title>l3_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5206,-938.95 4725,-938.95 4725,-870.95 5206,-870.95 5206,-938.95"/>
<text text-anchor="middle" x="4965.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4965.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4965.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4965.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu4&#45;&gt;l3_mha_attn_gpu4 -->
<g id="edge1354" class="edge">
<title>l3_mha_qkv_gpu4&#45;&gt;l3_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M4965.5,-974.84C4965.5,-966.73 4965.5,-957.94 4965.5,-949.43"/>
<polygon fill="black" stroke="black" points="4969,-949.25 4965.5,-939.25 4962,-949.25 4969,-949.25"/>
</g>
<!-- l3_mha_out_gpu4 -->
<g id="node420" class="node">
<title>l3_mha_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5203,-834.95 4734,-834.95 4734,-766.95 5203,-766.95 5203,-834.95"/>
<text text-anchor="middle" x="4968.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4968.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4968.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4968.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu4&#45;&gt;l3_mha_out_gpu4 -->
<g id="edge1355" class="edge">
<title>l3_mha_attn_gpu4&#45;&gt;l3_mha_out_gpu4</title>
<path fill="none" stroke="black" d="M4966.47,-870.84C4966.71,-862.73 4966.97,-853.94 4967.22,-845.43"/>
<polygon fill="black" stroke="black" points="4970.73,-845.35 4967.52,-835.25 4963.73,-845.15 4970.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu4&#45;&gt;l3_mha_res_add_gpu4 -->
<g id="edge1356" class="edge">
<title>l3_mha_out_gpu4&#45;&gt;l3_mha_res_add_gpu4</title>
<path fill="none" stroke="black" d="M5011.68,-766.84C5023.88,-757.48 5037.27,-747.21 5049.91,-737.52"/>
<polygon fill="black" stroke="black" points="5052.28,-740.12 5058.08,-731.25 5048.02,-734.56 5052.28,-740.12"/>
</g>
<!-- l3_expert_4_gpu4 -->
<g id="node422" class="node">
<title>l3_expert_4_gpu4</title>
<polygon fill="lightpink" stroke="black" points="7516.5,-454.95 7082.5,-454.95 7082.5,-386.95 7516.5,-386.95 7516.5,-454.95"/>
<text text-anchor="middle" x="7299.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7299.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7299.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7299.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu4&#45;&gt;l3_expert_4_gpu4 -->
<g id="edge1360" class="edge">
<title>l3_mha_res_add_gpu4&#45;&gt;l3_expert_4_gpu4</title>
<path fill="none" stroke="black" d="M5092.82,-662.9C5082.96,-616.91 5073.75,-534.37 5120.5,-490.95 5159.09,-455.11 6912.05,-459.1 7072.38,-454.61"/>
<polygon fill="black" stroke="black" points="7072.61,-458.11 7082.45,-454.18 7072.31,-451.11 7072.61,-458.11"/>
</g>
<!-- l3_gate_gpu4 -->
<g id="node423" class="node">
<title>l3_gate_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="6081.24,-626.95 5324.44,-626.95 5129.76,-490.95 5886.56,-490.95 6081.24,-626.95"/>
<text text-anchor="middle" x="5605.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5605.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5605.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5605.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu4&#45;&gt;l3_gate_gpu4 -->
<g id="edge1358" class="edge">
<title>l3_mha_res_add_gpu4&#45;&gt;l3_gate_gpu4</title>
<path fill="none" stroke="black" d="M5223.83,-662.94C5261.41,-652.8 5304.28,-641.23 5347.39,-629.6"/>
<polygon fill="black" stroke="black" points="5348.43,-632.95 5357.17,-626.96 5346.61,-626.19 5348.43,-632.95"/>
</g>
<!-- l3_res2_gpu4 -->
<g id="node425" class="node">
<title>l3_res2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5816.5,-178.95 5382.5,-178.95 5382.5,-110.95 5816.5,-110.95 5816.5,-178.95"/>
<text text-anchor="middle" x="5599.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5599.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5599.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5599.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu4&#45;&gt;l3_res2_gpu4 -->
<g id="edge1378" class="edge">
<title>l3_mha_res_add_gpu4&#45;&gt;l3_res2_gpu4</title>
<path fill="none" stroke="black" d="M4884.26,-690.35C4607.19,-683.33 4113.25,-671.21 3690.5,-662.95 3626.64,-661.71 1438.47,-670.23 1391.5,-626.95 1324.02,-564.78 1299.95,-280.16 1364.5,-214.95 1399.12,-179.98 4858.31,-180.38 4907.5,-178.95 5062.62,-174.47 5237.15,-166.12 5372.13,-158.95"/>
<polygon fill="black" stroke="black" points="5372.39,-162.44 5382.19,-158.41 5372.01,-155.45 5372.39,-162.44"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1361" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7082.45,-387.68C7079.45,-387.42 7076.47,-387.18 7073.5,-386.95 6034.95,-307.52 3425.05,-430.36 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.17 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1362" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7082.45,-387.69C7079.45,-387.43 7076.47,-387.18 7073.5,-386.95 6238.41,-322.3 4139.6,-415.59 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.16 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1363" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7082.45,-387.7C7079.45,-387.44 7076.46,-387.19 7073.5,-386.95 5810.22,-287.19 5485.78,-450.69 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.78,-347.47 4212.53,-350.14 4222.21,-354.44 4222.78,-347.47"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1364" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7082.45,-387.72C7079.45,-387.45 7076.46,-387.2 7073.5,-386.95 6217.11,-316.74 5996.89,-421.15 5140.5,-350.95 5140.4,-350.94 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.79,-347.47 5130.53,-350.11 5140.2,-354.44 5140.79,-347.47"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1365" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7082.44,-387.79C7079.44,-387.5 7076.46,-387.22 7073.5,-386.95 6623.94,-346.28 6508.06,-391.61 6058.5,-350.95 6058.39,-350.94 6058.29,-350.93 6058.18,-350.92"/>
<polygon fill="black" stroke="black" points="6058.52,-347.44 6048.24,-350 6057.87,-354.41 6058.52,-347.44"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1366" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7109.7,-386.94C7049.92,-376.55 6981.51,-364.65 6912.92,-352.72"/>
<polygon fill="black" stroke="black" points="6913.25,-349.23 6902.8,-350.96 6912.05,-356.12 6913.25,-349.23"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1367" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7332.77,-386.68C7341.44,-378.01 7351.14,-368.32 7361.02,-358.43"/>
<polygon fill="black" stroke="black" points="7363.64,-360.76 7368.24,-351.22 7358.69,-355.81 7363.64,-360.76"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1368" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7516.58,-388.05C7519.57,-387.68 7522.55,-387.31 7525.5,-386.95 7689.07,-367.04 7730.93,-370.86 7894.5,-350.95 7944.15,-344.91 7996.73,-337.86 8047.89,-330.64"/>
<polygon fill="black" stroke="black" points="8048.69,-334.06 8058.1,-329.19 8047.71,-327.13 8048.69,-334.06"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1369" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7516.55,-387.76C7519.55,-387.48 7522.54,-387.21 7525.5,-386.95 8095.59,-337.53 8242.41,-400.36 8812.5,-350.95 8863.38,-346.54 8917.21,-340.21 8969.42,-333.17"/>
<polygon fill="black" stroke="black" points="8970.05,-336.62 8979.49,-331.8 8969.11,-329.68 8970.05,-336.62"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1370" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7516.55,-387.71C7519.55,-387.45 7522.54,-387.19 7525.5,-386.95 8502.44,-307.98 8753.55,-429.9 9730.5,-350.95 9781.59,-346.82 9835.65,-340.61 9888.04,-333.6"/>
<polygon fill="black" stroke="black" points="9888.71,-337.04 9898.15,-332.23 9887.77,-330.1 9888.71,-337.04"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1371" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7516.55,-387.69C7519.55,-387.43 7522.54,-387.19 7525.5,-386.95 8217.42,-332.69 9956.58,-405.2 10648.5,-350.95 10699.69,-346.94 10753.86,-340.77 10806.35,-333.76"/>
<polygon fill="black" stroke="black" points="10807.03,-337.2 10816.47,-332.4 10806.1,-330.27 10807.03,-337.2"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1372" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7516.55,-387.68C7519.55,-387.43 7522.53,-387.18 7525.5,-386.95 8420.88,-317.92 10671.12,-419.97 11566.5,-350.95 11617.7,-347.01 11671.87,-340.87 11724.36,-333.88"/>
<polygon fill="black" stroke="black" points="11725.04,-337.32 11734.48,-332.52 11724.11,-330.38 11725.04,-337.32"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1373" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7516.55,-387.68C7519.55,-387.42 7522.53,-387.18 7525.5,-386.95 8624.34,-303.14 11385.66,-434.74 12484.5,-350.95 12535.7,-347.05 12589.88,-340.93 12642.36,-333.95"/>
<polygon fill="black" stroke="black" points="12643.04,-337.39 12652.49,-332.59 12642.11,-330.45 12643.04,-337.39"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1374" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7516.55,-387.67C7519.55,-387.42 7522.53,-387.18 7525.5,-386.95 8827.8,-288.36 12100.2,-449.51 13402.5,-350.95 13453.8,-347.07 13508.08,-340.95 13560.66,-333.96"/>
<polygon fill="black" stroke="black" points="13561.35,-337.4 13570.8,-332.6 13560.42,-330.46 13561.35,-337.4"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1375" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7516.55,-387.67C7519.55,-387.42 7522.53,-387.18 7525.5,-386.95 8278.38,-330.27 13567.62,-407.62 14320.5,-350.95 14371.8,-347.09 14426.08,-340.99 14478.66,-334"/>
<polygon fill="black" stroke="black" points="14479.36,-337.43 14488.8,-332.63 14478.43,-330.5 14479.36,-337.43"/>
</g>
<!-- l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1376" class="edge">
<title>l3_expert_4_gpu4&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7516.55,-387.67C7519.55,-387.41 7522.53,-387.18 7525.5,-386.95 8380.11,-322.88 14383.89,-415 15238.5,-350.95 15289.8,-347.11 15344.08,-341.01 15396.66,-334.02"/>
<polygon fill="black" stroke="black" points="15397.36,-337.46 15406.8,-332.66 15396.43,-330.52 15397.36,-337.46"/>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert_4_gpu4 -->
<g id="edge1359" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert_4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5915.38,-510.85C5975.04,-503.13 6037.12,-496.01 6095.5,-490.95 6525.56,-453.73 6638.63,-493.82 7072.46,-455.01"/>
<polygon fill="black" stroke="black" points="7072.8,-458.49 7082.44,-454.11 7072.17,-451.52 7072.8,-458.49"/>
</g>
<!-- l3_expert_agg_gpu4&#45;&gt;l3_res2_gpu4 -->
<g id="edge1377" class="edge">
<title>l3_expert_agg_gpu4&#45;&gt;l3_res2_gpu4</title>
<path fill="none" stroke="black" d="M5599.5,-214.75C5599.5,-206 5599.5,-197.23 5599.5,-189.02"/>
<polygon fill="black" stroke="black" points="5603,-188.97 5599.5,-178.97 5596,-188.97 5603,-188.97"/>
</g>
<!-- l3_res2_gpu4&#45;&gt;output -->
<g id="edge1669" class="edge">
<title>l3_res2_gpu4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5816.85,-132.53C5953.15,-125.63 6132.55,-117.03 6291.5,-110.95 7087.88,-80.52 8026.21,-56.72 8502.07,-45.51"/>
<polygon fill="black" stroke="black" points="8502.26,-49.01 8512.17,-45.27 8502.09,-42.01 8502.26,-49.01"/>
</g>
<!-- l3_mha_attn_gpu5 -->
<g id="node427" class="node">
<title>l3_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6214,-938.95 5733,-938.95 5733,-870.95 6214,-870.95 6214,-938.95"/>
<text text-anchor="middle" x="5973.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5973.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5973.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5973.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu5&#45;&gt;l3_mha_attn_gpu5 -->
<g id="edge1380" class="edge">
<title>l3_mha_qkv_gpu5&#45;&gt;l3_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M5973.5,-974.84C5973.5,-966.73 5973.5,-957.94 5973.5,-949.43"/>
<polygon fill="black" stroke="black" points="5977,-949.25 5973.5,-939.25 5970,-949.25 5977,-949.25"/>
</g>
<!-- l3_mha_out_gpu5 -->
<g id="node428" class="node">
<title>l3_mha_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6211,-834.95 5742,-834.95 5742,-766.95 6211,-766.95 6211,-834.95"/>
<text text-anchor="middle" x="5976.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5976.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5976.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5976.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu5&#45;&gt;l3_mha_out_gpu5 -->
<g id="edge1381" class="edge">
<title>l3_mha_attn_gpu5&#45;&gt;l3_mha_out_gpu5</title>
<path fill="none" stroke="black" d="M5974.47,-870.84C5974.71,-862.73 5974.97,-853.94 5975.22,-845.43"/>
<polygon fill="black" stroke="black" points="5978.73,-845.35 5975.52,-835.25 5971.73,-845.15 5978.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu5&#45;&gt;l3_mha_res_add_gpu5 -->
<g id="edge1382" class="edge">
<title>l3_mha_out_gpu5&#45;&gt;l3_mha_res_add_gpu5</title>
<path fill="none" stroke="black" d="M6019.68,-766.84C6031.88,-757.48 6045.27,-747.21 6057.91,-737.52"/>
<polygon fill="black" stroke="black" points="6060.28,-740.12 6066.08,-731.25 6056.02,-734.56 6060.28,-740.12"/>
</g>
<!-- l3_expert_5_gpu5 -->
<g id="node430" class="node">
<title>l3_expert_5_gpu5</title>
<polygon fill="lightpink" stroke="black" points="7968.5,-454.95 7534.5,-454.95 7534.5,-386.95 7968.5,-386.95 7968.5,-454.95"/>
<text text-anchor="middle" x="7751.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="7751.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="7751.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7751.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu5&#45;&gt;l3_expert_5_gpu5 -->
<g id="edge1386" class="edge">
<title>l3_mha_res_add_gpu5&#45;&gt;l3_expert_5_gpu5</title>
<path fill="none" stroke="black" d="M6100.86,-662.95C6091.05,-617.01 6081.91,-534.54 6128.5,-490.95 6183.59,-439.42 7377.58,-460.3 7524.34,-454.71"/>
<polygon fill="black" stroke="black" points="7524.65,-458.2 7534.45,-454.15 7524.27,-451.21 7524.65,-458.2"/>
</g>
<!-- l3_gate_gpu5 -->
<g id="node431" class="node">
<title>l3_gate_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="7089.24,-626.95 6332.44,-626.95 6137.76,-490.95 6894.56,-490.95 7089.24,-626.95"/>
<text text-anchor="middle" x="6613.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6613.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6613.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6613.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu5&#45;&gt;l3_gate_gpu5 -->
<g id="edge1384" class="edge">
<title>l3_mha_res_add_gpu5&#45;&gt;l3_gate_gpu5</title>
<path fill="none" stroke="black" d="M6231.83,-662.94C6269.41,-652.8 6312.28,-641.23 6355.39,-629.6"/>
<polygon fill="black" stroke="black" points="6356.43,-632.95 6365.17,-626.96 6354.61,-626.19 6356.43,-632.95"/>
</g>
<!-- l3_res2_gpu5 -->
<g id="node433" class="node">
<title>l3_res2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="6734.5,-178.95 6300.5,-178.95 6300.5,-110.95 6734.5,-110.95 6734.5,-178.95"/>
<text text-anchor="middle" x="6517.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6517.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="6517.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6517.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu5&#45;&gt;l3_res2_gpu5 -->
<g id="edge1404" class="edge">
<title>l3_mha_res_add_gpu5&#45;&gt;l3_res2_gpu5</title>
<path fill="none" stroke="black" d="M5892.14,-685.04C5735.26,-677.58 5518.35,-668.15 5327.5,-662.95 5286.78,-661.84 2426.37,-652.33 2394.5,-626.95 2345.84,-588.21 2408.86,-531.27 2361.5,-490.95 2322.29,-457.58 1950.48,-462.2 1899.5,-454.95 1674.35,-422.94 1542.04,-527.35 1398.5,-350.95 1360.35,-304.07 1355.93,-257.87 1398.5,-214.95 1441.8,-171.3 5764.04,-180.67 5825.5,-178.95 5980.62,-174.63 6155.15,-166.28 6290.13,-159.06"/>
<polygon fill="black" stroke="black" points="6290.39,-162.55 6300.19,-158.52 6290.02,-155.56 6290.39,-162.55"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1387" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7534.45,-387.67C7531.45,-387.42 7528.47,-387.18 7525.5,-386.95 6386.77,-300.24 3525.23,-437.64 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.17 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1388" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7534.45,-387.68C7531.45,-387.42 7528.47,-387.18 7525.5,-386.95 6590.23,-315.02 4239.77,-422.86 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.16 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1389" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7534.45,-387.69C7531.45,-387.43 7528.46,-387.18 7525.5,-386.95 6793.69,-329.8 4954.32,-408.09 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.78,-347.47 4212.53,-350.15 4222.21,-354.44 4222.78,-347.47"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1390" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7534.45,-387.71C7531.45,-387.44 7528.46,-387.19 7525.5,-386.95 6468.77,-302.19 6197.23,-435.69 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.78,-347.47 5130.53,-350.13 5140.21,-354.44 5140.78,-347.47"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1391" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7534.45,-387.75C7531.45,-387.47 7528.46,-387.21 7525.5,-386.95 6875.65,-331.74 6708.36,-406.15 6058.5,-350.95 6058.39,-350.94 6058.29,-350.94 6058.18,-350.93"/>
<polygon fill="black" stroke="black" points="6058.5,-347.44 6048.23,-350.06 6057.89,-354.41 6058.5,-347.44"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1392" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7534.43,-387.92C7531.44,-387.59 7528.46,-387.27 7525.5,-386.95 7282.33,-361.27 7219.67,-376.63 6976.5,-350.95 6976.39,-350.94 6976.28,-350.93 6976.17,-350.92"/>
<polygon fill="black" stroke="black" points="6976.26,-347.41 6965.95,-349.82 6975.52,-354.37 6976.26,-347.41"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1393" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7674.6,-386.86C7652.07,-377.16 7626.51,-366.16 7600.7,-355.05"/>
<polygon fill="black" stroke="black" points="7601.75,-351.7 7591.18,-350.96 7598.99,-358.12 7601.75,-351.7"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1394" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7897.61,-386.94C7949.78,-375.16 8010.48,-361.45 8070.24,-347.95"/>
<polygon fill="black" stroke="black" points="8071.23,-351.31 8080.21,-345.69 8069.69,-344.48 8071.23,-351.31"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1395" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M7968.56,-387.83C7971.56,-387.52 7974.54,-387.23 7977.5,-386.95 8347.31,-352.07 8442.68,-385.82 8812.5,-350.95 8863.15,-346.18 8916.76,-339.68 8968.78,-332.6"/>
<polygon fill="black" stroke="black" points="8969.38,-336.05 8978.82,-331.22 8968.43,-329.11 8969.38,-336.05"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1396" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7968.55,-387.73C7971.55,-387.46 7974.54,-387.2 7977.5,-386.95 8754.11,-322.53 8953.89,-415.36 9730.5,-350.95 9781.49,-346.72 9835.44,-340.47 9887.74,-333.45"/>
<polygon fill="black" stroke="black" points="9888.39,-336.9 9897.83,-332.09 9887.45,-329.96 9888.39,-336.9"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1397" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7968.55,-387.7C7971.55,-387.44 7974.54,-387.19 7977.5,-386.95 9160.99,-292.98 9465,-444.9 10648.5,-350.95 10699.69,-346.89 10753.86,-340.69 10806.34,-333.68"/>
<polygon fill="black" stroke="black" points="10807.02,-337.12 10816.47,-332.31 10806.09,-330.18 10807.02,-337.12"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1398" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M7968.55,-387.69C7971.55,-387.43 7974.54,-387.18 7977.5,-386.95 8772.7,-325.19 10771.3,-412.7 11566.5,-350.95 11617.7,-346.98 11671.87,-340.83 11724.35,-333.83"/>
<polygon fill="black" stroke="black" points="11725.04,-337.27 11734.48,-332.47 11724.1,-330.33 11725.04,-337.27"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1399" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M7968.55,-387.68C7971.55,-387.42 7974.53,-387.18 7977.5,-386.95 8976.16,-310.42 11485.84,-427.47 12484.5,-350.95 12535.7,-347.03 12589.87,-340.9 12642.36,-333.92"/>
<polygon fill="black" stroke="black" points="12643.04,-337.36 12652.49,-332.56 12642.11,-330.42 12643.04,-337.36"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1400" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7968.55,-387.67C7971.55,-387.42 7974.53,-387.18 7977.5,-386.95 9179.62,-295.64 12200.38,-442.24 13402.5,-350.95 13453.8,-347.06 13508.08,-340.93 13560.65,-333.94"/>
<polygon fill="black" stroke="black" points="13561.35,-337.38 13570.8,-332.57 13560.42,-330.44 13561.35,-337.38"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1401" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7968.55,-387.67C7971.55,-387.42 7974.53,-387.18 7977.5,-386.95 9383.08,-280.86 12914.92,-457.01 14320.5,-350.95 14371.8,-347.08 14426.08,-340.97 14478.66,-333.98"/>
<polygon fill="black" stroke="black" points="14479.36,-337.42 14488.8,-332.62 14478.42,-330.48 14479.36,-337.42"/>
</g>
<!-- l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1402" class="edge">
<title>l3_expert_5_gpu5&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M7968.55,-387.67C7971.55,-387.41 7974.53,-387.18 7977.5,-386.95 8782.02,-326.52 14433.98,-411.37 15238.5,-350.95 15289.8,-347.1 15344.08,-341 15396.66,-334.01"/>
<polygon fill="black" stroke="black" points="15397.36,-337.45 15406.8,-332.65 15396.43,-330.51 15397.36,-337.45"/>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert_5_gpu5 -->
<g id="edge1385" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert_5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6925.9,-512.82C6984.83,-504.99 7046,-497.33 7103.5,-490.95 7287.3,-470.56 7336.78,-476.35 7524.23,-455.07"/>
<polygon fill="black" stroke="black" points="7524.89,-458.52 7534.42,-453.9 7524.09,-451.57 7524.89,-458.52"/>
</g>
<!-- l3_expert_agg_gpu5&#45;&gt;l3_res2_gpu5 -->
<g id="edge1403" class="edge">
<title>l3_expert_agg_gpu5&#45;&gt;l3_res2_gpu5</title>
<path fill="none" stroke="black" d="M6517.5,-214.75C6517.5,-206 6517.5,-197.23 6517.5,-189.02"/>
<polygon fill="black" stroke="black" points="6521,-188.97 6517.5,-178.97 6514,-188.97 6521,-188.97"/>
</g>
<!-- l3_res2_gpu5&#45;&gt;output -->
<g id="edge1670" class="edge">
<title>l3_res2_gpu5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6734.5,-133.47C6870.86,-126.91 7050.46,-118.34 7209.5,-110.95 7665.45,-89.77 8194.4,-66.02 8516.14,-51.66"/>
<polygon fill="black" stroke="black" points="8516.71,-55.13 8526.54,-51.19 8516.4,-48.14 8516.71,-55.13"/>
</g>
<!-- l3_mha_attn_gpu6 -->
<g id="node435" class="node">
<title>l3_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7222,-938.95 6741,-938.95 6741,-870.95 7222,-870.95 7222,-938.95"/>
<text text-anchor="middle" x="6981.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6981.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="6981.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6981.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu6&#45;&gt;l3_mha_attn_gpu6 -->
<g id="edge1406" class="edge">
<title>l3_mha_qkv_gpu6&#45;&gt;l3_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M6981.5,-974.84C6981.5,-966.73 6981.5,-957.94 6981.5,-949.43"/>
<polygon fill="black" stroke="black" points="6985,-949.25 6981.5,-939.25 6978,-949.25 6985,-949.25"/>
</g>
<!-- l3_mha_out_gpu6 -->
<g id="node436" class="node">
<title>l3_mha_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7219,-834.95 6750,-834.95 6750,-766.95 7219,-766.95 7219,-834.95"/>
<text text-anchor="middle" x="6984.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6984.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="6984.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6984.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu6&#45;&gt;l3_mha_out_gpu6 -->
<g id="edge1407" class="edge">
<title>l3_mha_attn_gpu6&#45;&gt;l3_mha_out_gpu6</title>
<path fill="none" stroke="black" d="M6982.47,-870.84C6982.71,-862.73 6982.97,-853.94 6983.22,-845.43"/>
<polygon fill="black" stroke="black" points="6986.73,-845.35 6983.52,-835.25 6979.73,-845.15 6986.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu6&#45;&gt;l3_mha_res_add_gpu6 -->
<g id="edge1408" class="edge">
<title>l3_mha_out_gpu6&#45;&gt;l3_mha_res_add_gpu6</title>
<path fill="none" stroke="black" d="M7027.68,-766.84C7039.88,-757.48 7053.27,-747.21 7065.91,-737.52"/>
<polygon fill="black" stroke="black" points="7068.28,-740.12 7074.08,-731.25 7064.02,-734.56 7068.28,-740.12"/>
</g>
<!-- l3_expert_6_gpu6 -->
<g id="node438" class="node">
<title>l3_expert_6_gpu6</title>
<polygon fill="lightpink" stroke="black" points="8420.5,-454.95 7986.5,-454.95 7986.5,-386.95 8420.5,-386.95 8420.5,-454.95"/>
<text text-anchor="middle" x="8203.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8203.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="8203.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8203.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu6&#45;&gt;l3_expert_6_gpu6 -->
<g id="edge1412" class="edge">
<title>l3_mha_res_add_gpu6&#45;&gt;l3_expert_6_gpu6</title>
<path fill="none" stroke="black" d="M7108.88,-662.67C7099.23,-616.79 7090.41,-534.81 7136.5,-490.95 7168.99,-460.04 7869.77,-459.34 7976.15,-454.7"/>
<polygon fill="black" stroke="black" points="7976.67,-458.18 7986.44,-454.08 7976.25,-451.19 7976.67,-458.18"/>
</g>
<!-- l3_gate_gpu6 -->
<g id="node439" class="node">
<title>l3_gate_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="8097.24,-626.95 7340.44,-626.95 7145.76,-490.95 7902.56,-490.95 8097.24,-626.95"/>
<text text-anchor="middle" x="7621.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7621.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7621.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7621.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu6&#45;&gt;l3_gate_gpu6 -->
<g id="edge1410" class="edge">
<title>l3_mha_res_add_gpu6&#45;&gt;l3_gate_gpu6</title>
<path fill="none" stroke="black" d="M7239.83,-662.94C7277.41,-652.8 7320.28,-641.23 7363.39,-629.6"/>
<polygon fill="black" stroke="black" points="7364.43,-632.95 7373.17,-626.96 7362.61,-626.19 7364.43,-632.95"/>
</g>
<!-- l3_res2_gpu6 -->
<g id="node441" class="node">
<title>l3_res2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="7652.5,-178.95 7218.5,-178.95 7218.5,-110.95 7652.5,-110.95 7652.5,-178.95"/>
<text text-anchor="middle" x="7435.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7435.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7435.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7435.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu6&#45;&gt;l3_res2_gpu6 -->
<g id="edge1430" class="edge">
<title>l3_mha_res_add_gpu6&#45;&gt;l3_res2_gpu6</title>
<path fill="none" stroke="black" d="M6900.14,-684.86C6743.26,-677.33 6526.35,-667.87 6335.5,-662.95 6281.9,-661.57 2521.99,-653.66 2475.5,-626.95 2414.5,-591.91 2452.17,-531.25 2394.5,-490.95 2323.69,-441.47 2288.11,-472.38 2203.5,-454.95 2067.9,-427.02 2036.42,-407.45 1899.5,-386.95 1848.14,-379.27 1468.78,-389.06 1433.5,-350.95 1392.44,-306.6 1390.9,-257.84 1433.5,-214.95 1459.49,-188.79 6706.64,-179.96 6743.5,-178.95 6898.62,-174.73 7073.16,-166.38 7208.13,-159.14"/>
<polygon fill="black" stroke="black" points="7208.4,-162.63 7218.19,-158.6 7208.02,-155.64 7208.4,-162.63"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1413" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M7986.45,-387.67C7983.45,-387.42 7980.47,-387.18 7977.5,-386.95 6738.59,-292.97 3625.41,-444.91 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.17 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1414" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7986.45,-387.68C7983.45,-387.42 7980.47,-387.18 7977.5,-386.95 6942.05,-307.74 4339.95,-430.14 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.17 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1415" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7986.45,-387.69C7983.45,-387.43 7980.47,-387.18 7977.5,-386.95 7145.51,-322.52 5054.49,-415.37 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.16 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1416" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7986.45,-387.7C7983.45,-387.44 7980.46,-387.19 7977.5,-386.95 6720.43,-287.64 6397.58,-450.24 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.78,-347.47 5130.53,-350.14 5140.21,-354.44 5140.78,-347.47"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1417" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M7986.45,-387.72C7983.45,-387.45 7980.46,-387.2 7977.5,-386.95 7127.32,-317.19 6908.68,-420.7 6058.5,-350.95 6058.4,-350.94 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.79,-347.47 6048.53,-350.11 6058.2,-354.44 6058.79,-347.47"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1418" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7986.44,-387.8C7983.44,-387.5 7980.46,-387.22 7977.5,-386.95 7534.14,-346.73 7419.86,-391.16 6976.5,-350.95 6976.39,-350.94 6976.29,-350.93 6976.18,-350.92"/>
<polygon fill="black" stroke="black" points="6976.52,-347.44 6966.24,-350 6975.87,-354.41 6976.52,-347.44"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1419" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8017.1,-386.94C7958.39,-376.55 7891.2,-364.65 7823.84,-352.72"/>
<polygon fill="black" stroke="black" points="7824.36,-349.26 7813.9,-350.96 7823.14,-356.15 7824.36,-349.26"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1420" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8240.19,-386.68C8249.85,-377.93 8260.66,-368.13 8271.67,-358.15"/>
<polygon fill="black" stroke="black" points="8274.26,-360.53 8279.31,-351.22 8269.55,-355.34 8274.26,-360.53"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1421" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8420.58,-388.04C8423.57,-387.67 8426.55,-387.31 8429.5,-386.95 8599.26,-366.6 8642.74,-371.31 8812.5,-350.95 8862.16,-345 8914.74,-337.99 8965.91,-330.79"/>
<polygon fill="black" stroke="black" points="8966.71,-334.21 8976.12,-329.35 8965.73,-327.28 8966.71,-334.21"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1422" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8420.55,-387.76C8423.55,-387.48 8426.54,-387.21 8429.5,-386.95 9005.79,-337.08 9154.21,-400.81 9730.5,-350.95 9781.38,-346.55 9835.21,-340.22 9887.42,-333.18"/>
<polygon fill="black" stroke="black" points="9888.06,-336.63 9897.49,-331.81 9887.11,-329.69 9888.06,-336.63"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1423" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8420.55,-387.71C8423.55,-387.45 8426.54,-387.19 8429.5,-386.95 9412.65,-307.53 9665.35,-430.35 10648.5,-350.95 10699.59,-346.83 10753.65,-340.61 10806.04,-333.6"/>
<polygon fill="black" stroke="black" points="10806.71,-337.04 10816.15,-332.23 10805.77,-330.1 10806.71,-337.04"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1424" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8420.55,-387.69C8423.55,-387.43 8426.54,-387.19 8429.5,-386.95 9124.52,-332.47 10871.47,-405.42 11566.5,-350.95 11617.69,-346.94 11671.86,-340.77 11724.35,-333.77"/>
<polygon fill="black" stroke="black" points="11725.03,-337.21 11734.47,-332.4 11724.1,-330.27 11725.03,-337.21"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1425" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8420.55,-387.68C8423.55,-387.43 8426.53,-387.18 8429.5,-386.95 9327.98,-317.69 11586.02,-420.19 12484.5,-350.95 12535.7,-347.01 12589.87,-340.87 12642.36,-333.88"/>
<polygon fill="black" stroke="black" points="12643.04,-337.32 12652.48,-332.52 12642.11,-330.38 12643.04,-337.32"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1426" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8420.55,-387.68C8423.55,-387.42 8426.53,-387.18 8429.5,-386.95 9531.44,-302.92 12300.56,-434.96 13402.5,-350.95 13453.7,-347.05 13507.88,-340.93 13560.36,-333.95"/>
<polygon fill="black" stroke="black" points="13561.04,-337.39 13570.49,-332.59 13560.11,-330.45 13561.04,-337.39"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1427" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8420.55,-387.67C8423.55,-387.42 8426.53,-387.18 8429.5,-386.95 9734.9,-288.14 13015.1,-449.74 14320.5,-350.95 14371.8,-347.07 14426.08,-340.95 14478.66,-333.96"/>
<polygon fill="black" stroke="black" points="14479.35,-337.4 14488.8,-332.6 14478.42,-330.46 14479.35,-337.4"/>
</g>
<!-- l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1428" class="edge">
<title>l3_expert_6_gpu6&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8420.55,-387.67C8423.55,-387.42 8426.53,-387.18 8429.5,-386.95 9183.93,-330.16 14484.07,-407.73 15238.5,-350.95 15289.8,-347.09 15344.08,-340.99 15396.66,-334"/>
<polygon fill="black" stroke="black" points="15397.36,-337.43 15406.8,-332.63 15396.43,-330.5 15397.36,-337.43"/>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert_6_gpu6 -->
<g id="edge1411" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert_6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7903.98,-491.95C7955.11,-480 8006.59,-467.97 8052.1,-457.33"/>
<polygon fill="black" stroke="black" points="8053.08,-460.7 8062.02,-455.01 8051.49,-453.88 8053.08,-460.7"/>
</g>
<!-- l3_expert_agg_gpu6&#45;&gt;l3_res2_gpu6 -->
<g id="edge1429" class="edge">
<title>l3_expert_agg_gpu6&#45;&gt;l3_res2_gpu6</title>
<path fill="none" stroke="black" d="M7435.5,-214.75C7435.5,-206 7435.5,-197.23 7435.5,-189.02"/>
<polygon fill="black" stroke="black" points="7439,-188.97 7435.5,-178.97 7432,-188.97 7439,-188.97"/>
</g>
<!-- l3_res2_gpu6&#45;&gt;output -->
<g id="edge1671" class="edge">
<title>l3_res2_gpu6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7652.55,-127.33C7894.53,-108.79 8286,-78.81 8546.28,-58.87"/>
<polygon fill="black" stroke="black" points="8546.55,-62.36 8556.26,-58.1 8546.02,-55.38 8546.55,-62.36"/>
</g>
<!-- l3_mha_attn_gpu7 -->
<g id="node443" class="node">
<title>l3_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8230,-938.95 7749,-938.95 7749,-870.95 8230,-870.95 8230,-938.95"/>
<text text-anchor="middle" x="7989.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7989.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="7989.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7989.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu7&#45;&gt;l3_mha_attn_gpu7 -->
<g id="edge1432" class="edge">
<title>l3_mha_qkv_gpu7&#45;&gt;l3_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M7989.5,-974.84C7989.5,-966.73 7989.5,-957.94 7989.5,-949.43"/>
<polygon fill="black" stroke="black" points="7993,-949.25 7989.5,-939.25 7986,-949.25 7993,-949.25"/>
</g>
<!-- l3_mha_out_gpu7 -->
<g id="node444" class="node">
<title>l3_mha_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8227,-834.95 7758,-834.95 7758,-766.95 8227,-766.95 8227,-834.95"/>
<text text-anchor="middle" x="7992.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7992.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="7992.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="7992.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu7&#45;&gt;l3_mha_out_gpu7 -->
<g id="edge1433" class="edge">
<title>l3_mha_attn_gpu7&#45;&gt;l3_mha_out_gpu7</title>
<path fill="none" stroke="black" d="M7990.47,-870.84C7990.71,-862.73 7990.97,-853.94 7991.22,-845.43"/>
<polygon fill="black" stroke="black" points="7994.73,-845.35 7991.52,-835.25 7987.73,-845.15 7994.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu7&#45;&gt;l3_mha_res_add_gpu7 -->
<g id="edge1434" class="edge">
<title>l3_mha_out_gpu7&#45;&gt;l3_mha_res_add_gpu7</title>
<path fill="none" stroke="black" d="M8035.68,-766.84C8047.88,-757.48 8061.27,-747.21 8073.91,-737.52"/>
<polygon fill="black" stroke="black" points="8076.28,-740.12 8082.08,-731.25 8072.02,-734.56 8076.28,-740.12"/>
</g>
<!-- l3_expert_7_gpu7 -->
<g id="node446" class="node">
<title>l3_expert_7_gpu7</title>
<polygon fill="lightpink" stroke="black" points="8872.5,-454.95 8438.5,-454.95 8438.5,-386.95 8872.5,-386.95 8872.5,-454.95"/>
<text text-anchor="middle" x="8655.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8655.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8655.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8655.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu7&#45;&gt;l3_expert_7_gpu7 -->
<g id="edge1438" class="edge">
<title>l3_mha_res_add_gpu7&#45;&gt;l3_expert_7_gpu7</title>
<path fill="none" stroke="black" d="M8117.32,-662.81C8108.31,-617.47 8100.39,-536.55 8144.5,-490.95 8186.89,-447.13 8350.58,-462.03 8428.06,-454.9"/>
<polygon fill="black" stroke="black" points="8428.85,-458.33 8438.4,-453.74 8428.07,-451.37 8428.85,-458.33"/>
</g>
<!-- l3_gate_gpu7 -->
<g id="node447" class="node">
<title>l3_gate_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="9105.24,-626.95 8348.44,-626.95 8153.76,-490.95 8910.56,-490.95 9105.24,-626.95"/>
<text text-anchor="middle" x="8629.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8629.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8629.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8629.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu7&#45;&gt;l3_gate_gpu7 -->
<g id="edge1436" class="edge">
<title>l3_mha_res_add_gpu7&#45;&gt;l3_gate_gpu7</title>
<path fill="none" stroke="black" d="M8247.83,-662.94C8285.41,-652.8 8328.28,-641.23 8371.39,-629.6"/>
<polygon fill="black" stroke="black" points="8372.43,-632.95 8381.17,-626.96 8370.61,-626.19 8372.43,-632.95"/>
</g>
<!-- l3_res2_gpu7 -->
<g id="node449" class="node">
<title>l3_res2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="8570.5,-178.95 8136.5,-178.95 8136.5,-110.95 8570.5,-110.95 8570.5,-178.95"/>
<text text-anchor="middle" x="8353.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8353.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8353.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8353.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu7&#45;&gt;l3_res2_gpu7 -->
<g id="edge1456" class="edge">
<title>l3_mha_res_add_gpu7&#45;&gt;l3_res2_gpu7</title>
<path fill="none" stroke="black" d="M7908.14,-684.92C7751.26,-677.41 7534.35,-667.95 7343.5,-662.95 7147.67,-657.82 4010.22,-662.09 3817.5,-626.95 3644.32,-595.38 3617.41,-528.86 3445.5,-490.95 2904.56,-371.68 2756.22,-423.62 2203.5,-386.95 2162.71,-384.25 1496.69,-380.56 1468.5,-350.95 1426.82,-307.18 1425.88,-257.82 1468.5,-214.95 1498.82,-184.45 7618.51,-180.1 7661.5,-178.95 7816.63,-174.81 7991.16,-166.46 8126.14,-159.19"/>
<polygon fill="black" stroke="black" points="8126.4,-162.69 8136.19,-158.65 8126.02,-155.7 8126.4,-162.69"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1439" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8438.45,-387.67C8435.45,-387.42 8432.47,-387.18 8429.5,-386.95 7090.41,-285.69 3725.59,-452.18 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.17 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1440" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8438.45,-387.67C8435.45,-387.42 8432.47,-387.18 8429.5,-386.95 7293.87,-300.47 4440.13,-437.41 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.17 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1441" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8438.45,-387.68C8435.45,-387.42 8432.47,-387.18 8429.5,-386.95 7497.33,-315.25 5154.67,-422.64 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.16 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1442" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8438.45,-387.69C8435.45,-387.43 8432.46,-387.18 8429.5,-386.95 7700.79,-330.02 5869.21,-407.87 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.78,-347.47 5130.53,-350.15 5140.21,-354.44 5140.78,-347.47"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1443" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8438.45,-387.71C8435.45,-387.44 8432.46,-387.19 8429.5,-386.95 7378.98,-302.64 7109.02,-435.24 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.78,-347.47 6048.53,-350.13 6058.21,-354.44 6058.78,-347.47"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1444" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8438.45,-387.75C8435.45,-387.47 8432.46,-387.21 8429.5,-386.95 7785.85,-332.19 7620.15,-405.7 6976.5,-350.95 6976.39,-350.94 6976.29,-350.94 6976.18,-350.93"/>
<polygon fill="black" stroke="black" points="6976.5,-347.44 6966.23,-350.06 6975.89,-354.41 6976.5,-347.44"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1445" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8438.43,-387.93C8435.44,-387.59 8432.46,-387.27 8429.5,-386.95 8192.52,-361.72 8131.48,-376.18 7894.5,-350.95 7894.39,-350.94 7894.28,-350.93 7894.17,-350.92"/>
<polygon fill="black" stroke="black" points="7894.27,-347.41 7883.95,-349.81 7893.51,-354.37 7894.27,-347.41"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1446" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8582.01,-386.86C8560.57,-377.2 8536.26,-366.26 8511.71,-355.2"/>
<polygon fill="black" stroke="black" points="8512.84,-351.87 8502.29,-350.96 8509.97,-358.25 8512.84,-351.87"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1447" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8805.01,-386.94C8859.85,-374.84 8923.91,-360.69 8986.68,-346.84"/>
<polygon fill="black" stroke="black" points="8987.73,-350.19 8996.74,-344.61 8986.22,-343.35 8987.73,-350.19"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1448" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M8872.56,-387.82C8875.56,-387.52 8878.54,-387.23 8881.5,-386.95 9257.52,-351.62 9354.48,-386.28 9730.5,-350.95 9781.16,-346.19 9834.76,-339.7 9886.78,-332.63"/>
<polygon fill="black" stroke="black" points="9887.39,-336.08 9896.82,-331.25 9886.44,-329.14 9887.39,-336.08"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1449" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M8872.55,-387.73C8875.55,-387.46 8878.54,-387.2 8881.5,-386.95 9664.31,-322.08 9865.69,-415.81 10648.5,-350.95 10699.49,-346.73 10753.44,-340.48 10805.74,-333.46"/>
<polygon fill="black" stroke="black" points="10806.39,-336.9 10815.83,-332.09 10805.45,-329.97 10806.39,-336.9"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1450" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8872.55,-387.7C8875.55,-387.44 8878.54,-387.19 8881.5,-386.95 10071.2,-292.53 10376.8,-445.35 11566.5,-350.95 11617.69,-346.89 11671.86,-340.7 11724.34,-333.68"/>
<polygon fill="black" stroke="black" points="11725.02,-337.12 11734.47,-332.32 11724.09,-330.19 11725.02,-337.12"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1451" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8872.55,-387.69C8875.55,-387.43 8878.54,-387.18 8881.5,-386.95 9679.8,-324.97 11686.19,-412.92 12484.5,-350.95 12535.7,-346.98 12589.87,-340.83 12642.35,-333.83"/>
<polygon fill="black" stroke="black" points="12643.04,-337.27 12652.48,-332.47 12642.1,-330.33 12643.04,-337.27"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1452" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M8872.55,-387.68C8875.55,-387.42 8878.53,-387.18 8881.5,-386.95 9883.26,-310.19 12400.74,-427.69 13402.5,-350.95 13453.7,-347.03 13507.87,-340.91 13560.36,-333.92"/>
<polygon fill="black" stroke="black" points="13561.04,-337.36 13570.49,-332.56 13560.11,-330.42 13561.04,-337.36"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1453" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M8872.55,-387.67C8875.55,-387.42 8878.53,-387.18 8881.5,-386.95 10086.72,-295.41 13115.28,-442.46 14320.5,-350.95 14371.8,-347.06 14426.08,-340.94 14478.65,-333.94"/>
<polygon fill="black" stroke="black" points="14479.35,-337.38 14488.8,-332.57 14478.42,-330.44 14479.35,-337.38"/>
</g>
<!-- l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1454" class="edge">
<title>l3_expert_7_gpu7&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8872.55,-387.67C8875.55,-387.42 8878.53,-387.18 8881.5,-386.95 10290.18,-280.64 13829.81,-457.23 15238.5,-350.95 15289.8,-347.08 15344.08,-340.97 15396.66,-333.98"/>
<polygon fill="black" stroke="black" points="15397.36,-337.42 15406.8,-332.62 15396.42,-330.48 15397.36,-337.42"/>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert_7_gpu7 -->
<g id="edge1437" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert_7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8642.35,-490.75C8644.02,-482 8645.7,-473.23 8647.27,-465.02"/>
<polygon fill="black" stroke="black" points="8650.75,-465.45 8649.19,-454.97 8643.87,-464.13 8650.75,-465.45"/>
</g>
<!-- l3_expert_agg_gpu7&#45;&gt;l3_res2_gpu7 -->
<g id="edge1455" class="edge">
<title>l3_expert_agg_gpu7&#45;&gt;l3_res2_gpu7</title>
<path fill="none" stroke="black" d="M8353.5,-214.75C8353.5,-206 8353.5,-197.23 8353.5,-189.02"/>
<polygon fill="black" stroke="black" points="8357,-188.97 8353.5,-178.97 8350,-188.97 8357,-188.97"/>
</g>
<!-- l3_res2_gpu7&#45;&gt;output -->
<g id="edge1672" class="edge">
<title>l3_res2_gpu7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8497.16,-110.94C8549.52,-98.91 8608.84,-85.28 8661.8,-73.11"/>
<polygon fill="black" stroke="black" points="8662.65,-76.5 8671.61,-70.85 8661.08,-69.68 8662.65,-76.5"/>
</g>
<!-- l3_mha_attn_gpu8 -->
<g id="node451" class="node">
<title>l3_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="9743,-938.95 9262,-938.95 9262,-870.95 9743,-870.95 9743,-938.95"/>
<text text-anchor="middle" x="9502.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9502.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9502.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9502.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu8&#45;&gt;l3_mha_attn_gpu8 -->
<g id="edge1458" class="edge">
<title>l3_mha_qkv_gpu8&#45;&gt;l3_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M9502.5,-974.84C9502.5,-966.73 9502.5,-957.94 9502.5,-949.43"/>
<polygon fill="black" stroke="black" points="9506,-949.25 9502.5,-939.25 9499,-949.25 9506,-949.25"/>
</g>
<!-- l3_mha_out_gpu8 -->
<g id="node452" class="node">
<title>l3_mha_out_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="9740,-834.95 9271,-834.95 9271,-766.95 9740,-766.95 9740,-834.95"/>
<text text-anchor="middle" x="9505.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9505.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9505.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9505.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu8&#45;&gt;l3_mha_out_gpu8 -->
<g id="edge1459" class="edge">
<title>l3_mha_attn_gpu8&#45;&gt;l3_mha_out_gpu8</title>
<path fill="none" stroke="black" d="M9503.47,-870.84C9503.71,-862.73 9503.97,-853.94 9504.22,-845.43"/>
<polygon fill="black" stroke="black" points="9507.73,-845.35 9504.52,-835.25 9500.73,-845.15 9507.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu8&#45;&gt;l3_mha_res_add_gpu8 -->
<g id="edge1460" class="edge">
<title>l3_mha_out_gpu8&#45;&gt;l3_mha_res_add_gpu8</title>
<path fill="none" stroke="black" d="M9548.36,-766.84C9560.46,-757.48 9573.75,-747.21 9586.29,-737.52"/>
<polygon fill="black" stroke="black" points="9588.63,-740.14 9594.41,-731.25 9584.35,-734.6 9588.63,-740.14"/>
</g>
<!-- l3_expert_8_gpu8 -->
<g id="node454" class="node">
<title>l3_expert_8_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9324.5,-454.95 8890.5,-454.95 8890.5,-386.95 9324.5,-386.95 9324.5,-454.95"/>
<text text-anchor="middle" x="9107.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="9107.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9107.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9107.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu8&#45;&gt;l3_expert_8_gpu8 -->
<g id="edge1464" class="edge">
<title>l3_mha_res_add_gpu8&#45;&gt;l3_expert_8_gpu8</title>
<path fill="none" stroke="black" d="M9420.36,-688.89C9310.35,-680.75 9191.85,-663.47 9152.5,-626.95 9140.68,-615.99 9123.7,-522.2 9114.34,-465.35"/>
<polygon fill="black" stroke="black" points="9117.74,-464.5 9112.68,-455.2 9110.84,-465.63 9117.74,-464.5"/>
</g>
<!-- l3_gate_gpu8 -->
<g id="node455" class="node">
<title>l3_gate_gpu8</title>
<polygon fill="lightcyan" stroke="black" points="10113.24,-626.95 9356.44,-626.95 9161.76,-490.95 9918.56,-490.95 10113.24,-626.95"/>
<text text-anchor="middle" x="9637.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9637.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9637.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9637.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu8&#45;&gt;l3_gate_gpu8 -->
<g id="edge1462" class="edge">
<title>l3_mha_res_add_gpu8&#45;&gt;l3_gate_gpu8</title>
<path fill="none" stroke="black" d="M9637.5,-662.68C9637.5,-654.86 9637.5,-646.19 9637.5,-637.31"/>
<polygon fill="black" stroke="black" points="9641,-637.22 9637.5,-627.22 9634,-637.22 9641,-637.22"/>
</g>
<!-- l3_res2_gpu8 -->
<g id="node457" class="node">
<title>l3_res2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="9488.5,-178.95 9054.5,-178.95 9054.5,-110.95 9488.5,-110.95 9488.5,-178.95"/>
<text text-anchor="middle" x="9271.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9271.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9271.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9271.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu8&#45;&gt;l3_res2_gpu8 -->
<g id="edge1482" class="edge">
<title>l3_mha_res_add_gpu8&#45;&gt;l3_res2_gpu8</title>
<path fill="none" stroke="black" d="M9854.76,-689.53C10103.74,-682.33 10524.03,-670.66 10885.5,-662.95 10947.24,-661.64 13058.98,-663.85 13108.5,-626.95 13159.33,-589.08 13101.89,-530.42 13151.5,-490.95 13379.52,-309.57 14167.51,-401.6 14458.5,-386.95 14505.62,-384.58 16123.5,-384.66 16156.5,-350.95 16198.79,-307.76 16199.12,-257.82 16156.5,-214.95 16126.18,-184.45 10006.49,-180.1 9963.5,-178.95 9808.37,-174.81 9633.84,-166.46 9498.86,-159.19"/>
<polygon fill="black" stroke="black" points="9498.98,-155.7 9488.81,-158.65 9498.6,-162.69 9498.98,-155.7"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1465" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8890.45,-387.67C8887.45,-387.42 8884.47,-387.18 8881.5,-386.95 8161.87,-332.69 3106.14,-405.2 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1466" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M8890.45,-387.67C8887.45,-387.42 8884.47,-387.18 8881.5,-386.95 7645.69,-293.19 4540.31,-444.68 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.17 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1467" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8890.45,-387.68C8887.45,-387.42 8884.47,-387.18 8881.5,-386.95 7849.15,-307.97 5254.85,-429.91 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.17 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1468" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M8890.45,-387.69C8887.45,-387.43 8884.47,-387.18 8881.5,-386.95 8052.61,-322.75 5969.39,-415.14 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.78,-347.46 5130.53,-350.16 5140.22,-354.44 5140.78,-347.46"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1469" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8890.45,-387.7C8887.45,-387.44 8884.46,-387.19 8881.5,-386.95 7630.63,-288.09 7309.37,-449.79 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.78,-347.47 6048.53,-350.14 6058.21,-354.44 6058.78,-347.47"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1470" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M8890.45,-387.72C8887.45,-387.45 8884.46,-387.2 8881.5,-386.95 8037.52,-317.64 7820.48,-420.25 6976.5,-350.95 6976.39,-350.94 6976.29,-350.94 6976.18,-350.93"/>
<polygon fill="black" stroke="black" points="6976.49,-347.44 6966.23,-350.09 6975.9,-354.42 6976.49,-347.44"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1471" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M8890.44,-387.8C8887.44,-387.5 8884.46,-387.22 8881.5,-386.95 8444.35,-347.18 8331.65,-390.71 7894.5,-350.95 7894.39,-350.94 7894.29,-350.93 7894.18,-350.92"/>
<polygon fill="black" stroke="black" points="7894.52,-347.44 7884.24,-350 7893.87,-354.41 7894.52,-347.44"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1472" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M8924.5,-386.94C8866.97,-376.57 8801.16,-364.7 8735.17,-352.8"/>
<polygon fill="black" stroke="black" points="8735.46,-349.29 8725,-350.96 8734.22,-356.18 8735.46,-349.29"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1473" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9147.62,-386.68C9158.28,-377.85 9170.22,-367.94 9182.38,-357.86"/>
<polygon fill="black" stroke="black" points="9184.93,-360.29 9190.39,-351.22 9180.46,-354.91 9184.93,-360.29"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1474" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9324.58,-388.02C9327.57,-387.66 9330.55,-387.3 9333.5,-386.95 9509.44,-366.15 9554.56,-371.76 9730.5,-350.95 9780.37,-345.06 9833.18,-338.06 9884.53,-330.84"/>
<polygon fill="black" stroke="black" points="9885.03,-334.31 9894.44,-329.45 9884.05,-327.38 9885.03,-334.31"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1475" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9324.55,-387.76C9327.55,-387.48 9330.54,-387.21 9333.5,-386.95 9915.99,-336.63 10066.01,-401.26 10648.5,-350.95 10699.38,-346.56 10753.21,-340.23 10805.42,-333.2"/>
<polygon fill="black" stroke="black" points="10806.06,-336.64 10815.49,-331.83 10805.11,-329.71 10806.06,-336.64"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1476" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9324.55,-387.71C9327.55,-387.45 9330.54,-387.19 9333.5,-386.95 10322.85,-307.08 10577.14,-430.8 11566.5,-350.95 11617.59,-346.83 11671.65,-340.62 11724.04,-333.6"/>
<polygon fill="black" stroke="black" points="11724.71,-337.05 11734.15,-332.24 11723.77,-330.11 11724.71,-337.05"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1477" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9324.55,-387.69C9327.55,-387.43 9330.54,-387.19 9333.5,-386.95 10031.63,-332.24 11786.37,-405.65 12484.5,-350.95 12535.69,-346.94 12589.86,-340.77 12642.35,-333.77"/>
<polygon fill="black" stroke="black" points="12643.03,-337.21 12652.47,-332.4 12642.1,-330.27 12643.03,-337.21"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1478" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9324.55,-387.68C9327.55,-387.43 9330.53,-387.18 9333.5,-386.95 10235.08,-317.47 12500.91,-420.42 13402.5,-350.95 13453.7,-347.01 13507.87,-340.87 13560.36,-333.88"/>
<polygon fill="black" stroke="black" points="13561.04,-337.32 13570.48,-332.52 13560.11,-330.38 13561.04,-337.32"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1479" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9324.55,-387.68C9327.55,-387.42 9330.53,-387.18 9333.5,-386.95 10438.54,-302.69 13215.45,-435.19 14320.5,-350.95 14371.7,-347.05 14425.88,-340.93 14478.36,-333.95"/>
<polygon fill="black" stroke="black" points="14479.04,-337.39 14488.49,-332.59 14478.11,-330.45 14479.04,-337.39"/>
</g>
<!-- l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1480" class="edge">
<title>l3_expert_8_gpu8&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9324.55,-387.67C9327.55,-387.42 9330.53,-387.18 9333.5,-386.95 10642,-287.91 13929.99,-449.96 15238.5,-350.95 15289.8,-347.07 15344.08,-340.96 15396.66,-333.96"/>
<polygon fill="black" stroke="black" points="15397.35,-337.4 15406.8,-332.6 15396.42,-330.46 15397.35,-337.4"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_8_gpu8 -->
<g id="edge1463" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_8_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9376.38,-490.95C9331.36,-479.4 9286.19,-467.81 9246.08,-457.51"/>
<polygon fill="black" stroke="black" points="9246.81,-454.09 9236.26,-454.99 9245.07,-460.87 9246.81,-454.09"/>
</g>
<!-- l3_expert_agg_gpu8&#45;&gt;l3_res2_gpu8 -->
<g id="edge1481" class="edge">
<title>l3_expert_agg_gpu8&#45;&gt;l3_res2_gpu8</title>
<path fill="none" stroke="black" d="M9271.5,-214.75C9271.5,-206 9271.5,-197.23 9271.5,-189.02"/>
<polygon fill="black" stroke="black" points="9275,-188.97 9271.5,-178.97 9268,-188.97 9275,-188.97"/>
</g>
<!-- l3_res2_gpu8&#45;&gt;output -->
<g id="edge1673" class="edge">
<title>l3_res2_gpu8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9127.84,-110.94C9075.48,-98.91 9016.16,-85.28 8963.2,-73.11"/>
<polygon fill="black" stroke="black" points="8963.92,-69.68 8953.39,-70.85 8962.35,-76.5 8963.92,-69.68"/>
</g>
<!-- l3_mha_attn_gpu9 -->
<g id="node459" class="node">
<title>l3_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11151,-938.95 10670,-938.95 10670,-870.95 11151,-870.95 11151,-938.95"/>
<text text-anchor="middle" x="10910.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10910.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10910.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="10910.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu9&#45;&gt;l3_mha_attn_gpu9 -->
<g id="edge1484" class="edge">
<title>l3_mha_qkv_gpu9&#45;&gt;l3_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M10910.5,-974.84C10910.5,-966.73 10910.5,-957.94 10910.5,-949.43"/>
<polygon fill="black" stroke="black" points="10914,-949.25 10910.5,-939.25 10907,-949.25 10914,-949.25"/>
</g>
<!-- l3_mha_out_gpu9 -->
<g id="node460" class="node">
<title>l3_mha_out_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11148,-834.95 10679,-834.95 10679,-766.95 11148,-766.95 11148,-834.95"/>
<text text-anchor="middle" x="10913.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10913.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10913.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="10913.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu9&#45;&gt;l3_mha_out_gpu9 -->
<g id="edge1485" class="edge">
<title>l3_mha_attn_gpu9&#45;&gt;l3_mha_out_gpu9</title>
<path fill="none" stroke="black" d="M10911.47,-870.84C10911.71,-862.73 10911.97,-853.94 10912.22,-845.43"/>
<polygon fill="black" stroke="black" points="10915.73,-845.35 10912.52,-835.25 10908.73,-845.15 10915.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu9&#45;&gt;l3_mha_res_add_gpu9 -->
<g id="edge1486" class="edge">
<title>l3_mha_out_gpu9&#45;&gt;l3_mha_res_add_gpu9</title>
<path fill="none" stroke="black" d="M10977.78,-766.84C10997.08,-756.9 11018.38,-745.92 11038.21,-735.71"/>
<polygon fill="black" stroke="black" points="11039.91,-738.77 11047.2,-731.08 11036.71,-732.55 11039.91,-738.77"/>
</g>
<!-- l3_expert_9_gpu9 -->
<g id="node462" class="node">
<title>l3_expert_9_gpu9</title>
<polygon fill="lightpink" stroke="black" points="9776.5,-454.95 9342.5,-454.95 9342.5,-386.95 9776.5,-386.95 9776.5,-454.95"/>
<text text-anchor="middle" x="9559.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="9559.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9559.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9559.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu9&#45;&gt;l3_expert_9_gpu9 -->
<g id="edge1490" class="edge">
<title>l3_mha_res_add_gpu9&#45;&gt;l3_expert_9_gpu9</title>
<path fill="none" stroke="black" d="M11120.21,-662.57C11129.97,-616.57 11138.92,-534.46 11092.5,-490.95 11041.1,-442.79 9928.38,-460.07 9786.9,-454.72"/>
<polygon fill="black" stroke="black" points="9786.73,-451.2 9776.55,-454.15 9786.35,-458.19 9786.73,-451.2"/>
</g>
<!-- l3_gate_gpu9 -->
<g id="node463" class="node">
<title>l3_gate_gpu9</title>
<polygon fill="lightcyan" stroke="black" points="11083.24,-626.95 10326.44,-626.95 10131.76,-490.95 10888.56,-490.95 11083.24,-626.95"/>
<text text-anchor="middle" x="10607.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10607.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10607.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10607.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu9&#45;&gt;l3_gate_gpu9 -->
<g id="edge1488" class="edge">
<title>l3_mha_res_add_gpu9&#45;&gt;l3_gate_gpu9</title>
<path fill="none" stroke="black" d="M10989.17,-662.94C10951.59,-652.8 10908.72,-641.23 10865.61,-629.6"/>
<polygon fill="black" stroke="black" points="10866.39,-626.19 10855.83,-626.96 10864.57,-632.95 10866.39,-626.19"/>
</g>
<!-- l3_res2_gpu9 -->
<g id="node465" class="node">
<title>l3_res2_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="10406.5,-178.95 9972.5,-178.95 9972.5,-110.95 10406.5,-110.95 10406.5,-178.95"/>
<text text-anchor="middle" x="10189.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10189.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10189.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10189.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu9&#45;&gt;l3_res2_gpu9 -->
<g id="edge1508" class="edge">
<title>l3_mha_res_add_gpu9&#45;&gt;l3_res2_gpu9</title>
<path fill="none" stroke="black" d="M11328.89,-670.85C11361.89,-667.74 11395.57,-664.95 11427.5,-662.95 11475.08,-659.97 13106.03,-656.43 13143.5,-626.95 13192.64,-588.3 13130.99,-530.41 13179.5,-490.95 13237.34,-443.91 13775.19,-460.91 13849.5,-454.95 14133.31,-432.2 14202.36,-405.1 14486.5,-386.95 14533.61,-383.95 16152.48,-384.68 16185.5,-350.95 16227.79,-307.76 16228.1,-257.84 16185.5,-214.95 16159.54,-188.82 10918.32,-179.96 10881.5,-178.95 10726.38,-174.73 10551.84,-166.38 10416.87,-159.14"/>
<polygon fill="black" stroke="black" points="10416.98,-155.64 10406.81,-158.6 10416.6,-162.63 10416.98,-155.64"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1491" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9342.45,-387.67C9339.45,-387.41 9336.47,-387.18 9333.5,-386.95 8563.78,-329.05 3156.23,-408.84 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.22,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1492" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9342.45,-387.67C9339.45,-387.42 9336.47,-387.18 9333.5,-386.95 7997.51,-285.92 4640.49,-451.96 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.17 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1493" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9342.45,-387.68C9339.45,-387.42 9336.47,-387.18 9333.5,-386.95 8200.97,-300.69 5355.03,-437.19 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.17 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1494" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9342.45,-387.68C9339.45,-387.42 9336.47,-387.18 9333.5,-386.95 8404.43,-315.47 6069.57,-422.41 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.16 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1495" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9342.45,-387.69C9339.45,-387.43 9336.46,-387.19 9333.5,-386.95 8607.89,-330.25 6784.11,-407.64 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.78,-347.47 6048.53,-350.15 6058.21,-354.44 6058.78,-347.47"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1496" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9342.45,-387.71C9339.45,-387.44 9336.46,-387.19 9333.5,-386.95 8289.18,-303.09 8020.82,-434.79 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.78,-347.47 6966.53,-350.13 6976.21,-354.44 6976.78,-347.47"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1497" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9342.45,-387.75C9339.45,-387.47 9336.46,-387.21 9333.5,-386.95 8696.05,-332.64 8531.95,-405.25 7894.5,-350.95 7894.39,-350.94 7894.29,-350.94 7894.18,-350.93"/>
<polygon fill="black" stroke="black" points="7894.5,-347.44 7884.23,-350.06 7893.89,-354.41 7894.5,-347.44"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1498" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9342.43,-387.93C9339.43,-387.6 9336.46,-387.27 9333.5,-386.95 9102.72,-362.17 9043.28,-375.73 8812.5,-350.95 8812.39,-350.94 8812.28,-350.93 8812.17,-350.92"/>
<polygon fill="black" stroke="black" points="8812.27,-347.41 8801.95,-349.81 8811.51,-354.37 8812.27,-347.41"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1499" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9489.42,-386.86C9469.06,-377.24 9446,-366.35 9422.68,-355.34"/>
<polygon fill="black" stroke="black" points="9423.93,-352.06 9413.39,-350.96 9420.94,-358.39 9423.93,-352.06"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1500" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9712.41,-386.94C9770,-374.51 9837.52,-359.94 9903.36,-345.72"/>
<polygon fill="black" stroke="black" points="9904.44,-349.07 9913.48,-343.54 9902.97,-342.23 9904.44,-349.07"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1501" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9776.56,-387.82C9779.56,-387.52 9782.54,-387.23 9785.5,-386.95 10167.72,-351.17 10266.28,-386.73 10648.5,-350.95 10699.16,-346.21 10752.77,-339.73 10804.79,-332.66"/>
<polygon fill="black" stroke="black" points="10805.39,-336.11 10814.82,-331.28 10804.44,-329.17 10805.39,-336.11"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1502" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9776.55,-387.73C9779.55,-387.46 9782.54,-387.2 9785.5,-386.95 10574.52,-321.63 10777.48,-416.26 11566.5,-350.95 11617.49,-346.73 11671.44,-340.48 11723.74,-333.47"/>
<polygon fill="black" stroke="black" points="11724.39,-336.91 11733.83,-332.1 11723.45,-329.97 11724.39,-336.91"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1503" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9776.55,-387.7C9779.55,-387.44 9782.54,-387.19 9785.5,-386.95 10981.4,-292.08 11288.59,-445.8 12484.5,-350.95 12535.69,-346.89 12589.86,-340.7 12642.34,-333.69"/>
<polygon fill="black" stroke="black" points="12643.02,-337.13 12652.47,-332.32 12642.09,-330.19 12643.02,-337.13"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1504" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9776.55,-387.69C9779.55,-387.43 9782.54,-387.18 9785.5,-386.95 10586.91,-324.74 12601.09,-413.15 13402.5,-350.95 13453.7,-346.98 13507.87,-340.83 13560.35,-333.83"/>
<polygon fill="black" stroke="black" points="13561.04,-337.27 13570.48,-332.47 13560.1,-330.33 13561.04,-337.27"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1505" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9776.55,-387.68C9779.55,-387.42 9782.53,-387.18 9785.5,-386.95 10790.36,-309.97 13315.63,-427.92 14320.5,-350.95 14371.7,-347.03 14425.87,-340.91 14478.36,-333.92"/>
<polygon fill="black" stroke="black" points="14479.04,-337.36 14488.49,-332.56 14478.11,-330.42 14479.04,-337.36"/>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1506" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9776.55,-387.67C9779.55,-387.42 9782.53,-387.18 9785.5,-386.95 10993.82,-295.19 14030.17,-442.69 15238.5,-350.95 15289.8,-347.06 15344.08,-340.94 15396.65,-333.94"/>
<polygon fill="black" stroke="black" points="15397.35,-337.38 15406.8,-332.58 15396.42,-330.44 15397.35,-337.38"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_9_gpu9 -->
<g id="edge1489" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10133.62,-492.32C10129.9,-491.86 10126.19,-491.41 10122.5,-490.95 9976.2,-473.04 9936.63,-473.8 9786.63,-455.08"/>
<polygon fill="black" stroke="black" points="9786.95,-451.59 9776.59,-453.82 9786.07,-458.54 9786.95,-451.59"/>
</g>
<!-- l3_expert_agg_gpu9&#45;&gt;l3_res2_gpu9 -->
<g id="edge1507" class="edge">
<title>l3_expert_agg_gpu9&#45;&gt;l3_res2_gpu9</title>
<path fill="none" stroke="black" d="M10189.5,-214.75C10189.5,-206 10189.5,-197.23 10189.5,-189.02"/>
<polygon fill="black" stroke="black" points="10193,-188.97 10189.5,-178.97 10186,-188.97 10193,-188.97"/>
</g>
<!-- l3_res2_gpu9&#45;&gt;output -->
<g id="edge1674" class="edge">
<title>l3_res2_gpu9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9972.45,-127.33C9730.47,-108.79 9339,-78.81 9078.72,-58.87"/>
<polygon fill="black" stroke="black" points="9078.98,-55.38 9068.74,-58.1 9078.45,-62.36 9078.98,-55.38"/>
</g>
<!-- l3_mha_attn_gpu10 -->
<g id="node467" class="node">
<title>l3_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="11713,-938.95 11232,-938.95 11232,-870.95 11713,-870.95 11713,-938.95"/>
<text text-anchor="middle" x="11472.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11472.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11472.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11472.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu10&#45;&gt;l3_mha_attn_gpu10 -->
<g id="edge1510" class="edge">
<title>l3_mha_qkv_gpu10&#45;&gt;l3_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M11472.5,-974.84C11472.5,-966.73 11472.5,-957.94 11472.5,-949.43"/>
<polygon fill="black" stroke="black" points="11476,-949.25 11472.5,-939.25 11469,-949.25 11476,-949.25"/>
</g>
<!-- l3_mha_out_gpu10 -->
<g id="node468" class="node">
<title>l3_mha_out_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="11710,-834.95 11241,-834.95 11241,-766.95 11710,-766.95 11710,-834.95"/>
<text text-anchor="middle" x="11475.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11475.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11475.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="11475.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu10&#45;&gt;l3_mha_out_gpu10 -->
<g id="edge1511" class="edge">
<title>l3_mha_attn_gpu10&#45;&gt;l3_mha_out_gpu10</title>
<path fill="none" stroke="black" d="M11473.47,-870.84C11473.71,-862.73 11473.97,-853.94 11474.22,-845.43"/>
<polygon fill="black" stroke="black" points="11477.73,-845.35 11474.52,-835.25 11470.73,-845.15 11477.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu10&#45;&gt;l3_mha_res_add_gpu10 -->
<g id="edge1512" class="edge">
<title>l3_mha_out_gpu10&#45;&gt;l3_mha_res_add_gpu10</title>
<path fill="none" stroke="black" d="M11533.29,-766.84C11550.32,-757.08 11569.1,-746.32 11586.64,-736.26"/>
<polygon fill="black" stroke="black" points="11588.76,-739.09 11595.69,-731.08 11585.28,-733.01 11588.76,-739.09"/>
</g>
<!-- l3_expert_10_gpu10 -->
<g id="node470" class="node">
<title>l3_expert_10_gpu10</title>
<polygon fill="lightpink" stroke="black" points="10228.5,-454.95 9794.5,-454.95 9794.5,-386.95 10228.5,-386.95 10228.5,-454.95"/>
<text text-anchor="middle" x="10011.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="10011.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10011.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10011.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu10&#45;&gt;l3_expert_10_gpu10 -->
<g id="edge1516" class="edge">
<title>l3_mha_res_add_gpu10&#45;&gt;l3_expert_10_gpu10</title>
<path fill="none" stroke="black" d="M11436.18,-670.19C11312.3,-654.64 11179.45,-636.11 11168.5,-626.95 11119.65,-586.12 11174.34,-529.28 11123.5,-490.95 11085.7,-462.46 10347.71,-459.7 10238.65,-454.71"/>
<polygon fill="black" stroke="black" points="10238.76,-451.21 10228.56,-454.09 10238.33,-458.2 10238.76,-451.21"/>
</g>
<!-- l3_gate_gpu10 -->
<g id="node471" class="node">
<title>l3_gate_gpu10</title>
<polygon fill="lightcyan" stroke="black" points="12129.24,-626.95 11372.44,-626.95 11177.76,-490.95 11934.56,-490.95 12129.24,-626.95"/>
<text text-anchor="middle" x="11653.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11653.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11653.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11653.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu10&#45;&gt;l3_gate_gpu10 -->
<g id="edge1514" class="edge">
<title>l3_mha_res_add_gpu10&#45;&gt;l3_gate_gpu10</title>
<path fill="none" stroke="black" d="M11653.5,-662.68C11653.5,-654.86 11653.5,-646.19 11653.5,-637.31"/>
<polygon fill="black" stroke="black" points="11657,-637.22 11653.5,-627.22 11650,-637.22 11657,-637.22"/>
</g>
<!-- l3_res2_gpu10 -->
<g id="node473" class="node">
<title>l3_res2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="11324.5,-178.95 10890.5,-178.95 10890.5,-110.95 11324.5,-110.95 11324.5,-178.95"/>
<text text-anchor="middle" x="11107.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11107.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11107.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11107.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu10&#45;&gt;l3_res2_gpu10 -->
<g id="edge1534" class="edge">
<title>l3_mha_res_add_gpu10&#45;&gt;l3_res2_gpu10</title>
<path fill="none" stroke="black" d="M11870.82,-695.52C12264.3,-693.36 13064.83,-682.14 13179.5,-626.95 13251.87,-592.12 13225.87,-525.25 13298.5,-490.95 13358.21,-462.76 14420.54,-457.92 14486.5,-454.95 14510.7,-453.86 16210.89,-368.59 16227.5,-350.95 16268.95,-306.96 16270.07,-257.87 16227.5,-214.95 16184.19,-171.29 11860.98,-180.67 11799.5,-178.95 11644.38,-174.63 11469.85,-166.28 11334.87,-159.06"/>
<polygon fill="black" stroke="black" points="11334.98,-155.56 11324.81,-158.52 11334.61,-162.55 11334.98,-155.56"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1517" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9794.45,-387.67C9791.45,-387.41 9788.47,-387.18 9785.5,-386.95 8965.69,-325.41 3206.32,-412.48 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.23,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1518" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9794.45,-387.67C9791.45,-387.42 9788.47,-387.18 9785.5,-386.95 9067.42,-332.8 4022.58,-405.09 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.18 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1519" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9794.45,-387.67C9791.45,-387.42 9788.47,-387.18 9785.5,-386.95 8552.8,-293.42 5455.21,-444.46 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.17 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1520" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9794.45,-387.68C9791.45,-387.42 9788.47,-387.18 9785.5,-386.95 8756.26,-308.2 6169.75,-429.69 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.17 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1521" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9794.45,-387.69C9791.45,-387.43 9788.47,-387.18 9785.5,-386.95 8959.71,-322.97 6884.29,-414.92 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.78,-347.46 6048.53,-350.16 6058.22,-354.44 6058.78,-347.46"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1522" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9794.45,-387.7C9791.45,-387.44 9788.46,-387.19 9785.5,-386.95 8540.84,-288.54 8221.16,-449.34 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.78,-347.47 6966.53,-350.14 6976.21,-354.44 6976.78,-347.47"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1523" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9794.45,-387.73C9791.45,-387.45 9788.46,-387.2 9785.5,-386.95 8947.73,-318.09 8732.27,-419.8 7894.5,-350.95 7894.39,-350.94 7894.29,-350.94 7894.18,-350.93"/>
<polygon fill="black" stroke="black" points="7894.49,-347.44 7884.23,-350.09 7893.9,-354.42 7894.49,-347.44"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1524" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9794.44,-387.8C9791.44,-387.51 9788.46,-387.22 9785.5,-386.95 9354.55,-347.63 9243.45,-390.26 8812.5,-350.95 8812.39,-350.94 8812.29,-350.93 8812.18,-350.92"/>
<polygon fill="black" stroke="black" points="8812.52,-347.44 8802.24,-350 8811.87,-354.41 8812.52,-347.44"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1525" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9831.89,-386.94C9775.44,-376.57 9710.85,-364.7 9646.08,-352.8"/>
<polygon fill="black" stroke="black" points="9646.57,-349.33 9636.1,-350.96 9645.31,-356.21 9646.57,-349.33"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1526" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10055.04,-386.68C10066.72,-377.76 10079.82,-367.75 10093.15,-357.57"/>
<polygon fill="black" stroke="black" points="10095.64,-360.07 10101.46,-351.22 10091.39,-354.51 10095.64,-360.07"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1527" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10228.58,-388.01C10231.57,-387.65 10234.55,-387.3 10237.5,-386.95 10419.63,-365.7 10466.37,-372.2 10648.5,-350.95 10698.38,-345.13 10751.19,-338.17 10802.55,-330.97"/>
<polygon fill="black" stroke="black" points="10803.04,-334.44 10812.46,-329.58 10802.07,-327.51 10803.04,-334.44"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1528" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10228.55,-387.76C10231.55,-387.48 10234.54,-387.21 10237.5,-386.95 10826.2,-336.18 10977.8,-401.71 11566.5,-350.95 11617.38,-346.57 11671.22,-340.24 11723.42,-333.21"/>
<polygon fill="black" stroke="black" points="11724.06,-336.65 11733.5,-331.84 11723.11,-329.72 11724.06,-336.65"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1529" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10228.55,-387.71C10231.55,-387.45 10234.54,-387.19 10237.5,-386.95 11233.06,-306.63 11488.94,-431.25 12484.5,-350.95 12535.59,-346.83 12589.65,-340.62 12642.04,-333.61"/>
<polygon fill="black" stroke="black" points="12642.71,-337.05 12652.15,-332.24 12641.77,-330.11 12642.71,-337.05"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1530" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10228.55,-387.69C10231.55,-387.43 10234.54,-387.19 10237.5,-386.95 10938.73,-332.02 12701.27,-405.87 13402.5,-350.95 13453.69,-346.94 13507.86,-340.77 13560.35,-333.77"/>
<polygon fill="black" stroke="black" points="13561.03,-337.21 13570.47,-332.41 13560.1,-330.27 13561.03,-337.21"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1531" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10228.55,-387.68C10231.55,-387.43 10234.53,-387.18 10237.5,-386.95 11142.19,-317.24 13415.81,-420.64 14320.5,-350.95 14371.7,-347.01 14425.87,-340.87 14478.36,-333.88"/>
<polygon fill="black" stroke="black" points="14479.04,-337.32 14488.48,-332.52 14478.11,-330.38 14479.04,-337.32"/>
</g>
<!-- l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1532" class="edge">
<title>l3_expert_10_gpu10&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10228.55,-387.68C10231.55,-387.42 10234.53,-387.18 10237.5,-386.95 11345.65,-302.47 14130.35,-435.42 15238.5,-350.95 15289.7,-347.05 15343.88,-340.94 15396.36,-333.95"/>
<polygon fill="black" stroke="black" points="15397.04,-337.39 15406.49,-332.59 15396.11,-330.45 15397.04,-337.39"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_10_gpu10 -->
<g id="edge1515" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_10_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11179.63,-492.41C11174.22,-491.91 11168.85,-491.42 11163.5,-490.95 10756.51,-455.3 10649.35,-492.16 10238.63,-455.02"/>
<polygon fill="black" stroke="black" points="10238.84,-451.52 10228.56,-454.1 10238.2,-458.49 10238.84,-451.52"/>
</g>
<!-- l3_expert_agg_gpu10&#45;&gt;l3_res2_gpu10 -->
<g id="edge1533" class="edge">
<title>l3_expert_agg_gpu10&#45;&gt;l3_res2_gpu10</title>
<path fill="none" stroke="black" d="M11107.5,-214.75C11107.5,-206 11107.5,-197.23 11107.5,-189.02"/>
<polygon fill="black" stroke="black" points="11111,-188.97 11107.5,-178.97 11104,-188.97 11111,-188.97"/>
</g>
<!-- l3_res2_gpu10&#45;&gt;output -->
<g id="edge1675" class="edge">
<title>l3_res2_gpu10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10890.5,-133.47C10754.14,-126.91 10574.54,-118.34 10415.5,-110.95 9959.55,-89.77 9430.6,-66.02 9108.86,-51.66"/>
<polygon fill="black" stroke="black" points="9108.6,-48.14 9098.46,-51.19 9108.29,-55.13 9108.6,-48.14"/>
</g>
<!-- l3_mha_attn_gpu11 -->
<g id="node475" class="node">
<title>l3_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13282,-938.95 12801,-938.95 12801,-870.95 13282,-870.95 13282,-938.95"/>
<text text-anchor="middle" x="13041.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13041.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13041.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13041.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu11&#45;&gt;l3_mha_attn_gpu11 -->
<g id="edge1536" class="edge">
<title>l3_mha_qkv_gpu11&#45;&gt;l3_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M13041.5,-974.84C13041.5,-966.73 13041.5,-957.94 13041.5,-949.43"/>
<polygon fill="black" stroke="black" points="13045,-949.25 13041.5,-939.25 13038,-949.25 13045,-949.25"/>
</g>
<!-- l3_mha_out_gpu11 -->
<g id="node476" class="node">
<title>l3_mha_out_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13279,-834.95 12810,-834.95 12810,-766.95 13279,-766.95 13279,-834.95"/>
<text text-anchor="middle" x="13044.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13044.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13044.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13044.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu11&#45;&gt;l3_mha_out_gpu11 -->
<g id="edge1537" class="edge">
<title>l3_mha_attn_gpu11&#45;&gt;l3_mha_out_gpu11</title>
<path fill="none" stroke="black" d="M13042.47,-870.84C13042.71,-862.73 13042.97,-853.94 13043.22,-845.43"/>
<polygon fill="black" stroke="black" points="13046.73,-845.35 13043.52,-835.25 13039.73,-845.15 13046.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu11&#45;&gt;l3_mha_res_add_gpu11 -->
<g id="edge1538" class="edge">
<title>l3_mha_out_gpu11&#45;&gt;l3_mha_res_add_gpu11</title>
<path fill="none" stroke="black" d="M13108.46,-766.84C13127.65,-756.9 13148.85,-745.92 13168.58,-735.71"/>
<polygon fill="black" stroke="black" points="13170.25,-738.78 13177.52,-731.08 13167.03,-732.57 13170.25,-738.78"/>
</g>
<!-- l3_expert_11_gpu11 -->
<g id="node478" class="node">
<title>l3_expert_11_gpu11</title>
<polygon fill="lightpink" stroke="black" points="10680.5,-454.95 10246.5,-454.95 10246.5,-386.95 10680.5,-386.95 10680.5,-454.95"/>
<text text-anchor="middle" x="10463.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="10463.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10463.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10463.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu11&#45;&gt;l3_expert_11_gpu11 -->
<g id="edge1542" class="edge">
<title>l3_mha_res_add_gpu11&#45;&gt;l3_expert_11_gpu11</title>
<path fill="none" stroke="black" d="M13231.11,-662.65C13214.15,-614.72 13175.51,-528.01 13108.5,-490.95 13051.18,-459.26 10871.5,-460.25 10690.55,-454.65"/>
<polygon fill="black" stroke="black" points="10690.7,-451.15 10680.55,-454.2 10690.38,-458.15 10690.7,-451.15"/>
</g>
<!-- l3_gate_gpu11 -->
<g id="node479" class="node">
<title>l3_gate_gpu11</title>
<polygon fill="lightcyan" stroke="black" points="13099.24,-626.95 12342.44,-626.95 12147.76,-490.95 12904.56,-490.95 13099.24,-626.95"/>
<text text-anchor="middle" x="12623.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12623.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12623.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12623.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu11&#45;&gt;l3_gate_gpu11 -->
<g id="edge1540" class="edge">
<title>l3_mha_res_add_gpu11&#45;&gt;l3_gate_gpu11</title>
<path fill="none" stroke="black" d="M13091.51,-662.94C13044.84,-652.68 12991.53,-640.94 12937.99,-629.16"/>
<polygon fill="black" stroke="black" points="12938.51,-625.69 12927.99,-626.96 12937.01,-632.53 12938.51,-625.69"/>
</g>
<!-- l3_res2_gpu11 -->
<g id="node481" class="node">
<title>l3_res2_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="12242.5,-178.95 11808.5,-178.95 11808.5,-110.95 12242.5,-110.95 12242.5,-178.95"/>
<text text-anchor="middle" x="12025.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12025.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12025.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12025.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu11&#45;&gt;l3_res2_gpu11 -->
<g id="edge1560" class="edge">
<title>l3_mha_res_add_gpu11&#45;&gt;l3_res2_gpu11</title>
<path fill="none" stroke="black" d="M13458.89,-670.87C13491.89,-667.75 13525.57,-664.96 13557.5,-662.95 13650.73,-657.1 15154.28,-667.36 15238.5,-626.95 15309.61,-592.84 15283.8,-529.69 15352.5,-490.95 15706.65,-291.27 15991.93,-659.66 16256.5,-350.95 16295.83,-305.06 16299.02,-257.91 16256.5,-214.95 16221.92,-180.02 12766.63,-180.37 12717.5,-178.95 12562.38,-174.47 12387.85,-166.12 12252.87,-158.94"/>
<polygon fill="black" stroke="black" points="12252.99,-155.45 12242.81,-158.41 12252.61,-162.44 12252.99,-155.45"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1543" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10246.45,-387.66C10243.45,-387.41 10240.47,-387.18 10237.5,-386.95 9367.6,-321.77 3256.41,-416.11 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.23,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1544" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10246.45,-387.67C10243.45,-387.41 10240.47,-387.18 10237.5,-386.95 9469.33,-329.16 4072.67,-408.73 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.18 3304.22,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1545" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10246.45,-387.67C10243.45,-387.42 10240.47,-387.18 10237.5,-386.95 8904.62,-286.14 5555.39,-451.73 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.17 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1546" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10246.45,-387.68C10243.45,-387.42 10240.47,-387.18 10237.5,-386.95 9108.08,-300.92 6269.92,-436.96 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.17 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1547" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10246.45,-387.68C10243.45,-387.42 10240.47,-387.18 10237.5,-386.95 9311.54,-315.7 6984.47,-422.19 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.77,-347.46 6048.53,-350.16 6058.22,-354.44 6058.77,-347.46"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1548" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10246.45,-387.69C10243.45,-387.43 10240.46,-387.19 10237.5,-386.95 9514.99,-330.47 7699.01,-407.42 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.78,-347.47 6966.53,-350.15 6976.21,-354.44 6976.78,-347.47"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1549" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10246.45,-387.71C10243.45,-387.44 10240.46,-387.19 10237.5,-386.95 9199.39,-303.54 8932.61,-434.34 7894.5,-350.95 7894.4,-350.95 7894.29,-350.94 7894.19,-350.93"/>
<polygon fill="black" stroke="black" points="7894.78,-347.47 7884.53,-350.13 7894.21,-354.44 7894.78,-347.47"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1550" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10246.45,-387.75C10243.45,-387.47 10240.46,-387.21 10237.5,-386.95 9606.26,-333.09 9443.74,-404.8 8812.5,-350.95 8812.39,-350.94 8812.29,-350.94 8812.18,-350.93"/>
<polygon fill="black" stroke="black" points="8812.5,-347.44 8802.23,-350.05 8811.89,-354.41 8812.5,-347.44"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1551" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10246.43,-387.94C10243.43,-387.6 10240.46,-387.27 10237.5,-386.95 10012.91,-362.62 9955.09,-375.28 9730.5,-350.95 9730.39,-350.94 9730.28,-350.93 9730.17,-350.92"/>
<polygon fill="black" stroke="black" points="9730.27,-347.41 9719.95,-349.8 9729.51,-354.37 9730.27,-347.41"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1552" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10396.82,-386.86C10377.54,-377.29 10355.71,-366.45 10333.63,-355.49"/>
<polygon fill="black" stroke="black" points="10335.01,-352.27 10324.49,-350.96 10331.89,-358.54 10335.01,-352.27"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1553" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10619.81,-386.94C10680.13,-374.21 10751.11,-359.22 10819.97,-344.67"/>
<polygon fill="black" stroke="black" points="10821.05,-348.02 10830.11,-342.53 10819.61,-341.17 10821.05,-348.02"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1554" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10680.56,-387.82C10683.56,-387.52 10686.54,-387.23 10689.5,-386.95 11077.92,-350.72 11178.08,-387.18 11566.5,-350.95 11617.16,-346.23 11670.77,-339.76 11722.79,-332.69"/>
<polygon fill="black" stroke="black" points="11723.39,-336.14 11732.83,-331.31 11722.44,-329.2 11723.39,-336.14"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1555" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10680.55,-387.73C10683.55,-387.46 10686.54,-387.2 10689.5,-386.95 11484.72,-321.18 11689.28,-416.71 12484.5,-350.95 12535.58,-346.73 12589.64,-340.46 12642.03,-333.43"/>
<polygon fill="black" stroke="black" points="12642.7,-336.88 12652.14,-332.07 12641.76,-329.94 12642.7,-336.88"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1556" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10680.55,-387.7C10683.55,-387.44 10686.54,-387.19 10689.5,-386.95 11891.61,-291.63 12200.39,-446.25 13402.5,-350.95 13453.69,-346.9 13507.86,-340.7 13560.34,-333.69"/>
<polygon fill="black" stroke="black" points="13561.03,-337.13 13570.47,-332.32 13560.09,-330.19 13561.03,-337.13"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1557" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10680.55,-387.69C10683.55,-387.43 10686.54,-387.18 10689.5,-386.95 11494.01,-324.52 13515.99,-413.37 14320.5,-350.95 14371.7,-346.98 14425.87,-340.83 14478.35,-333.83"/>
<polygon fill="black" stroke="black" points="14479.04,-337.27 14488.48,-332.47 14478.1,-330.34 14479.04,-337.27"/>
</g>
<!-- l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1558" class="edge">
<title>l3_expert_11_gpu11&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10680.55,-387.68C10683.55,-387.42 10686.53,-387.18 10689.5,-386.95 11697.47,-309.74 14230.53,-428.14 15238.5,-350.95 15289.7,-347.03 15343.87,-340.91 15396.36,-333.92"/>
<polygon fill="black" stroke="black" points="15397.04,-337.36 15406.49,-332.56 15396.11,-330.42 15397.04,-337.36"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_11_gpu11 -->
<g id="edge1541" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_11_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12148.7,-491.8C12145.29,-491.51 12141.89,-491.23 12138.5,-490.95 11499.71,-439.06 11333.08,-508.87 10690.53,-455"/>
<polygon fill="black" stroke="black" points="10690.81,-451.51 10680.55,-454.16 10690.22,-458.49 10690.81,-451.51"/>
</g>
<!-- l3_expert_agg_gpu11&#45;&gt;l3_res2_gpu11 -->
<g id="edge1559" class="edge">
<title>l3_expert_agg_gpu11&#45;&gt;l3_res2_gpu11</title>
<path fill="none" stroke="black" d="M12025.5,-214.75C12025.5,-206 12025.5,-197.23 12025.5,-189.02"/>
<polygon fill="black" stroke="black" points="12029,-188.97 12025.5,-178.97 12022,-188.97 12029,-188.97"/>
</g>
<!-- l3_res2_gpu11&#45;&gt;output -->
<g id="edge1676" class="edge">
<title>l3_res2_gpu11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11808.15,-132.53C11671.85,-125.63 11492.45,-117.03 11333.5,-110.95 10537.12,-80.52 9598.79,-56.72 9122.93,-45.51"/>
<polygon fill="black" stroke="black" points="9122.91,-42.01 9112.83,-45.27 9122.74,-49.01 9122.91,-42.01"/>
</g>
<!-- l3_mha_attn_gpu12 -->
<g id="node483" class="node">
<title>l3_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13953,-938.95 13472,-938.95 13472,-870.95 13953,-870.95 13953,-938.95"/>
<text text-anchor="middle" x="13712.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13712.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13712.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13712.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu12&#45;&gt;l3_mha_attn_gpu12 -->
<g id="edge1562" class="edge">
<title>l3_mha_qkv_gpu12&#45;&gt;l3_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M13712.5,-974.84C13712.5,-966.73 13712.5,-957.94 13712.5,-949.43"/>
<polygon fill="black" stroke="black" points="13716,-949.25 13712.5,-939.25 13709,-949.25 13716,-949.25"/>
</g>
<!-- l3_mha_out_gpu12 -->
<g id="node484" class="node">
<title>l3_mha_out_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13950,-834.95 13481,-834.95 13481,-766.95 13950,-766.95 13950,-834.95"/>
<text text-anchor="middle" x="13715.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13715.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13715.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="13715.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu12&#45;&gt;l3_mha_out_gpu12 -->
<g id="edge1563" class="edge">
<title>l3_mha_attn_gpu12&#45;&gt;l3_mha_out_gpu12</title>
<path fill="none" stroke="black" d="M13713.47,-870.84C13713.71,-862.73 13713.97,-853.94 13714.22,-845.43"/>
<polygon fill="black" stroke="black" points="13717.73,-845.35 13714.52,-835.25 13710.73,-845.15 13717.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu12&#45;&gt;l3_mha_res_add_gpu12 -->
<g id="edge1564" class="edge">
<title>l3_mha_out_gpu12&#45;&gt;l3_mha_res_add_gpu12</title>
<path fill="none" stroke="black" d="M13737.58,-766.84C13743.34,-758.2 13749.62,-748.77 13755.64,-739.75"/>
<polygon fill="black" stroke="black" points="13758.67,-741.51 13761.3,-731.25 13752.84,-737.63 13758.67,-741.51"/>
</g>
<!-- l3_expert_12_gpu12 -->
<g id="node486" class="node">
<title>l3_expert_12_gpu12</title>
<polygon fill="lightpink" stroke="black" points="11132.5,-454.95 10698.5,-454.95 10698.5,-386.95 11132.5,-386.95 11132.5,-454.95"/>
<text text-anchor="middle" x="10915.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10915.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="10915.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10915.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu12&#45;&gt;l3_expert_12_gpu12 -->
<g id="edge1568" class="edge">
<title>l3_mha_res_add_gpu12&#45;&gt;l3_expert_12_gpu12</title>
<path fill="none" stroke="black" d="M13566.44,-671.93C13449.04,-657.72 13323.05,-640 13298.5,-626.95 13226.53,-588.71 13249.69,-524.68 13175.5,-490.95 13074.82,-445.19 11331.49,-463.31 11142.7,-454.79"/>
<polygon fill="black" stroke="black" points="11142.74,-451.28 11132.55,-454.19 11142.33,-458.27 11142.74,-451.28"/>
</g>
<!-- l3_gate_gpu12 -->
<g id="node487" class="node">
<title>l3_gate_gpu12</title>
<polygon fill="lightcyan" stroke="black" points="14259.24,-626.95 13502.44,-626.95 13307.76,-490.95 14064.56,-490.95 14259.24,-626.95"/>
<text text-anchor="middle" x="13783.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="13783.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13783.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13783.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu12&#45;&gt;l3_gate_gpu12 -->
<g id="edge1566" class="edge">
<title>l3_mha_res_add_gpu12&#45;&gt;l3_gate_gpu12</title>
<path fill="none" stroke="black" d="M13783.5,-662.68C13783.5,-654.86 13783.5,-646.19 13783.5,-637.31"/>
<polygon fill="black" stroke="black" points="13787,-637.22 13783.5,-627.22 13780,-637.22 13787,-637.22"/>
</g>
<!-- l3_res2_gpu12 -->
<g id="node489" class="node">
<title>l3_res2_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="13160.5,-178.95 12726.5,-178.95 12726.5,-110.95 13160.5,-110.95 13160.5,-178.95"/>
<text text-anchor="middle" x="12943.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12943.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12943.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12943.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu12&#45;&gt;l3_res2_gpu12 -->
<g id="edge1586" class="edge">
<title>l3_mha_res_add_gpu12&#45;&gt;l3_res2_gpu12</title>
<path fill="none" stroke="black" d="M14000.67,-690.17C14615.05,-673.81 16321.24,-628.25 16322.5,-626.95 16349.72,-598.98 16344.13,-253.4 16303.5,-214.95 16276.58,-189.48 13672.54,-180.09 13635.5,-178.95 13480.39,-174.21 13305.86,-165.87 13170.88,-158.75"/>
<polygon fill="black" stroke="black" points="13170.99,-155.26 13160.82,-158.22 13170.62,-162.25 13170.99,-155.26"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1569" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10698.45,-387.66C10695.45,-387.41 10692.47,-387.18 10689.5,-386.95 9769.51,-318.13 3306.5,-419.75 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.23,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1570" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10698.45,-387.67C10695.45,-387.41 10692.47,-387.18 10689.5,-386.95 9871.24,-325.52 4122.76,-412.36 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.18 3304.23,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1571" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10698.45,-387.67C10695.45,-387.42 10692.47,-387.18 10689.5,-386.95 9972.97,-332.91 4939.03,-404.98 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.18 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1572" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10698.45,-387.67C10695.45,-387.42 10692.47,-387.18 10689.5,-386.95 9459.9,-293.64 6370.1,-444.23 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.17 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1573" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10698.45,-387.68C10695.45,-387.42 10692.47,-387.18 10689.5,-386.95 9663.36,-308.42 7084.64,-429.46 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.77,-347.46 6048.53,-350.17 6058.22,-354.44 6058.77,-347.46"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1574" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10698.45,-387.69C10695.45,-387.43 10692.47,-387.18 10689.5,-386.95 9866.82,-323.2 7799.18,-414.69 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.78,-347.46 6966.53,-350.16 6976.22,-354.44 6976.78,-347.46"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1575" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10698.45,-387.7C10695.45,-387.44 10692.46,-387.19 10689.5,-386.95 9451.04,-288.99 9132.96,-448.89 7894.5,-350.95 7894.4,-350.95 7894.29,-350.94 7894.19,-350.93"/>
<polygon fill="black" stroke="black" points="7894.78,-347.47 7884.53,-350.14 7894.21,-354.44 7894.78,-347.47"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1576" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10698.45,-387.73C10695.45,-387.46 10692.46,-387.2 10689.5,-386.95 9857.93,-318.54 9644.07,-419.35 8812.5,-350.95 8812.39,-350.94 8812.29,-350.94 8812.18,-350.93"/>
<polygon fill="black" stroke="black" points="8812.49,-347.44 8802.23,-350.08 8811.9,-354.42 8812.49,-347.44"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1577" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10698.44,-387.8C10695.44,-387.51 10692.46,-387.22 10689.5,-386.95 10264.75,-348.08 10155.25,-389.81 9730.5,-350.95 9730.39,-350.94 9730.29,-350.93 9730.18,-350.92"/>
<polygon fill="black" stroke="black" points="9730.52,-347.44 9720.24,-349.99 9729.87,-354.41 9730.52,-347.44"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1578" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10739.29,-386.94C10684.02,-376.59 10620.8,-364.75 10557.38,-352.87"/>
<polygon fill="black" stroke="black" points="10557.68,-349.36 10547.21,-350.96 10556.39,-356.24 10557.68,-349.36"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1579" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10962.47,-386.68C10975.18,-377.68 10989.47,-367.56 11003.98,-357.28"/>
<polygon fill="black" stroke="black" points="11006.4,-359.85 11012.54,-351.22 11002.36,-354.14 11006.4,-359.85"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1580" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11132.58,-388C11135.57,-387.64 11138.55,-387.29 11141.5,-386.95 11329.82,-365.25 11378.18,-372.65 11566.5,-350.95 11616.48,-345.19 11669.4,-338.26 11720.85,-331.06"/>
<polygon fill="black" stroke="black" points="11721.37,-334.52 11730.78,-329.66 11720.39,-327.59 11721.37,-334.52"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1581" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11132.55,-387.76C11135.55,-387.48 11138.54,-387.21 11141.5,-386.95 11736.4,-335.73 11889.6,-402.17 12484.5,-350.95 12535.38,-346.57 12589.22,-340.25 12641.42,-333.22"/>
<polygon fill="black" stroke="black" points="12642.06,-336.67 12651.5,-331.85 12641.12,-329.73 12642.06,-336.67"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1582" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11132.55,-387.71C11135.55,-387.45 11138.54,-387.19 11141.5,-386.95 12143.27,-306.18 12400.73,-431.7 13402.5,-350.95 13453.59,-346.83 13507.65,-340.62 13560.04,-333.61"/>
<polygon fill="black" stroke="black" points="13560.71,-337.05 13570.15,-332.25 13559.77,-330.12 13560.71,-337.05"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1583" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11132.55,-387.69C11135.55,-387.43 11138.54,-387.19 11141.5,-386.95 11845.83,-331.79 13616.17,-406.1 14320.5,-350.95 14371.69,-346.95 14425.86,-340.78 14478.35,-333.77"/>
<polygon fill="black" stroke="black" points="14479.03,-337.21 14488.47,-332.41 14478.1,-330.28 14479.03,-337.21"/>
</g>
<!-- l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1584" class="edge">
<title>l3_expert_12_gpu12&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11132.55,-387.68C11135.55,-387.43 11138.53,-387.18 11141.5,-386.95 12049.29,-317.02 14330.71,-420.87 15238.5,-350.95 15289.7,-347.01 15343.87,-340.87 15396.36,-333.88"/>
<polygon fill="black" stroke="black" points="15397.04,-337.32 15406.48,-332.52 15396.11,-330.39 15397.04,-337.32"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_12_gpu12 -->
<g id="edge1567" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_12_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13309.32,-492.21C13304.02,-491.77 13298.74,-491.35 13293.5,-490.95 12343.08,-418.29 12096.69,-531.41 11142.74,-455.01"/>
<polygon fill="black" stroke="black" points="11142.8,-451.51 11132.55,-454.19 11142.24,-458.48 11142.8,-451.51"/>
</g>
<!-- l3_expert_agg_gpu12&#45;&gt;l3_res2_gpu12 -->
<g id="edge1585" class="edge">
<title>l3_expert_agg_gpu12&#45;&gt;l3_res2_gpu12</title>
<path fill="none" stroke="black" d="M12943.5,-214.75C12943.5,-206 12943.5,-197.23 12943.5,-189.02"/>
<polygon fill="black" stroke="black" points="12947,-188.97 12943.5,-178.97 12940,-188.97 12947,-188.97"/>
</g>
<!-- l3_res2_gpu12&#45;&gt;output -->
<g id="edge1677" class="edge">
<title>l3_res2_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12726.17,-132.11C12589.87,-125.04 12410.47,-116.42 12251.5,-110.95 11100.71,-71.39 9732.51,-50.31 9127.25,-42.31"/>
<polygon fill="black" stroke="black" points="9127.11,-38.81 9117.07,-42.18 9127.02,-45.81 9127.11,-38.81"/>
</g>
<!-- l3_mha_attn_gpu13 -->
<g id="node491" class="node">
<title>l3_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15362,-938.95 14881,-938.95 14881,-870.95 15362,-870.95 15362,-938.95"/>
<text text-anchor="middle" x="15121.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15121.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15121.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15121.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu13&#45;&gt;l3_mha_attn_gpu13 -->
<g id="edge1588" class="edge">
<title>l3_mha_qkv_gpu13&#45;&gt;l3_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M15121.5,-974.84C15121.5,-966.73 15121.5,-957.94 15121.5,-949.43"/>
<polygon fill="black" stroke="black" points="15125,-949.25 15121.5,-939.25 15118,-949.25 15125,-949.25"/>
</g>
<!-- l3_mha_out_gpu13 -->
<g id="node492" class="node">
<title>l3_mha_out_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="15359,-834.95 14890,-834.95 14890,-766.95 15359,-766.95 15359,-834.95"/>
<text text-anchor="middle" x="15124.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15124.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15124.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15124.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu13&#45;&gt;l3_mha_out_gpu13 -->
<g id="edge1589" class="edge">
<title>l3_mha_attn_gpu13&#45;&gt;l3_mha_out_gpu13</title>
<path fill="none" stroke="black" d="M15122.47,-870.84C15122.71,-862.73 15122.97,-853.94 15123.22,-845.43"/>
<polygon fill="black" stroke="black" points="15126.73,-845.35 15123.52,-835.25 15119.73,-845.15 15126.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu13&#45;&gt;l3_mha_res_add_gpu13 -->
<g id="edge1590" class="edge">
<title>l3_mha_out_gpu13&#45;&gt;l3_mha_res_add_gpu13</title>
<path fill="none" stroke="black" d="M15167.68,-766.84C15179.88,-757.48 15193.27,-747.21 15205.91,-737.52"/>
<polygon fill="black" stroke="black" points="15208.28,-740.12 15214.08,-731.25 15204.02,-734.56 15208.28,-740.12"/>
</g>
<!-- l3_expert_13_gpu13 -->
<g id="node494" class="node">
<title>l3_expert_13_gpu13</title>
<polygon fill="lightpink" stroke="black" points="11584.5,-454.95 11150.5,-454.95 11150.5,-386.95 11584.5,-386.95 11584.5,-454.95"/>
<text text-anchor="middle" x="11367.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11367.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11367.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11367.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu13&#45;&gt;l3_expert_13_gpu13 -->
<g id="edge1594" class="edge">
<title>l3_mha_res_add_gpu13&#45;&gt;l3_expert_13_gpu13</title>
<path fill="none" stroke="black" d="M15266.24,-662.85C15276.16,-616.78 15285.44,-534.17 15238.5,-490.95 15202.15,-457.48 11812.18,-458.78 11594.72,-454.54"/>
<polygon fill="black" stroke="black" points="11594.65,-451.04 11584.55,-454.22 11594.43,-458.03 11594.65,-451.04"/>
</g>
<!-- l3_gate_gpu13 -->
<g id="node495" class="node">
<title>l3_gate_gpu13</title>
<polygon fill="lightcyan" stroke="black" points="15229.24,-626.95 14472.44,-626.95 14277.76,-490.95 15034.56,-490.95 15229.24,-626.95"/>
<text text-anchor="middle" x="14753.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="14753.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14753.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14753.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu13&#45;&gt;l3_gate_gpu13 -->
<g id="edge1592" class="edge">
<title>l3_mha_res_add_gpu13&#45;&gt;l3_gate_gpu13</title>
<path fill="none" stroke="black" d="M15135.17,-662.94C15097.59,-652.8 15054.72,-641.23 15011.61,-629.6"/>
<polygon fill="black" stroke="black" points="15012.39,-626.19 15001.83,-626.96 15010.57,-632.95 15012.39,-626.19"/>
</g>
<!-- l3_res2_gpu13 -->
<g id="node497" class="node">
<title>l3_res2_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="14078.5,-178.95 13644.5,-178.95 13644.5,-110.95 14078.5,-110.95 14078.5,-178.95"/>
<text text-anchor="middle" x="13861.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13861.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13861.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13861.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu13&#45;&gt;l3_res2_gpu13 -->
<g id="edge1612" class="edge">
<title>l3_mha_res_add_gpu13&#45;&gt;l3_res2_gpu13</title>
<path fill="none" stroke="black" d="M15474.95,-673.19C15520.05,-669.17 15567.28,-665.47 15611.5,-662.95 15659.18,-660.24 17297.08,-661.08 17330.5,-626.95 17372.79,-583.77 17367.1,-539.05 17330.5,-490.95 17051.81,-124.73 16787.87,-281.46 16332.5,-214.95 15941.24,-157.81 14948.69,-192.37 14553.5,-178.95 14398.41,-173.69 14223.87,-165.35 14088.89,-158.37"/>
<polygon fill="black" stroke="black" points="14089,-154.87 14078.83,-157.85 14088.64,-161.86 14089,-154.87"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1595" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11150.45,-387.66C11147.45,-387.41 11144.47,-387.17 11141.5,-386.95 10171.42,-314.5 3356.59,-423.39 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.23,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1596" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11150.45,-387.66C11147.45,-387.41 11144.47,-387.18 11141.5,-386.95 10273.15,-321.89 4172.85,-416 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.18 3304.23,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1597" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11150.45,-387.67C11147.45,-387.41 11144.47,-387.18 11141.5,-386.95 10374.88,-329.27 4989.12,-408.62 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.18 4222.22,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1598" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11150.45,-387.67C11147.45,-387.42 11144.47,-387.18 11141.5,-386.95 9811.72,-286.37 6470.28,-451.51 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.17 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1599" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11150.45,-387.68C11147.45,-387.42 11144.47,-387.18 11141.5,-386.95 10015.18,-301.15 7184.82,-436.73 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.77,-347.46 6048.53,-350.17 6058.22,-354.44 6058.77,-347.46"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1600" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11150.45,-387.68C11147.45,-387.42 11144.47,-387.18 11141.5,-386.95 10218.64,-315.92 7899.36,-421.96 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.77,-347.46 6966.53,-350.16 6976.22,-354.44 6976.77,-347.46"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1601" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11150.45,-387.69C11147.45,-387.43 11144.46,-387.19 11141.5,-386.95 10422.1,-330.7 8613.9,-407.19 7894.5,-350.95 7894.4,-350.95 7894.29,-350.94 7894.19,-350.93"/>
<polygon fill="black" stroke="black" points="7894.78,-347.47 7884.53,-350.15 7894.21,-354.44 7894.78,-347.47"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1602" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11150.45,-387.71C11147.45,-387.44 11144.46,-387.19 11141.5,-386.95 10109.59,-303.99 9844.41,-433.89 8812.5,-350.95 8812.4,-350.95 8812.29,-350.94 8812.19,-350.93"/>
<polygon fill="black" stroke="black" points="8812.78,-347.47 8802.53,-350.13 8812.21,-354.44 8812.78,-347.47"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1603" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11150.45,-387.75C11147.45,-387.47 11144.46,-387.21 11141.5,-386.95 10516.46,-333.54 10355.54,-404.35 9730.5,-350.95 9730.39,-350.94 9730.29,-350.94 9730.18,-350.93"/>
<polygon fill="black" stroke="black" points="9730.5,-347.44 9720.23,-350.05 9729.89,-354.41 9730.5,-347.44"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1604" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11150.43,-387.95C11147.43,-387.61 11144.46,-387.28 11141.5,-386.95 10923.11,-363.07 10866.89,-374.84 10648.5,-350.95 10648.39,-350.94 10648.28,-350.93 10648.17,-350.92"/>
<polygon fill="black" stroke="black" points="10648.28,-347.41 10637.95,-349.79 10647.51,-354.37 10648.28,-347.41"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1605" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11304.23,-386.86C11286.01,-377.33 11265.4,-366.55 11244.54,-355.64"/>
<polygon fill="black" stroke="black" points="11246.08,-352.49 11235.59,-350.96 11242.83,-358.69 11246.08,-352.49"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1606" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11527.2,-386.94C11590.33,-373.9 11664.88,-358.49 11736.81,-343.62"/>
<polygon fill="black" stroke="black" points="11737.86,-346.98 11746.95,-341.53 11736.44,-340.12 11737.86,-346.98"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1607" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11584.56,-387.81C11587.56,-387.52 11590.54,-387.23 11593.5,-386.95 11988.12,-350.27 12089.88,-387.63 12484.5,-350.95 12535.16,-346.25 12588.77,-339.78 12640.79,-332.71"/>
<polygon fill="black" stroke="black" points="12641.39,-336.16 12650.83,-331.34 12640.45,-329.23 12641.39,-336.16"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1608" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11584.55,-387.73C11587.55,-387.46 11590.54,-387.2 11593.5,-386.95 12394.93,-320.73 12601.07,-417.16 13402.5,-350.95 13453.58,-346.73 13507.64,-340.47 13560.03,-333.44"/>
<polygon fill="black" stroke="black" points="13560.7,-336.88 13570.14,-332.07 13559.76,-329.95 13560.7,-336.88"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1609" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11584.55,-387.7C11587.55,-387.44 11590.54,-387.19 11593.5,-386.95 12801.82,-291.18 13112.18,-446.7 14320.5,-350.95 14371.69,-346.9 14425.86,-340.7 14478.34,-333.69"/>
<polygon fill="black" stroke="black" points="14479.03,-337.13 14488.47,-332.33 14478.09,-330.19 14479.03,-337.13"/>
</g>
<!-- l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1610" class="edge">
<title>l3_expert_13_gpu13&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11584.55,-387.69C11587.55,-387.43 11590.53,-387.18 11593.5,-386.95 12401.11,-324.29 14430.89,-413.6 15238.5,-350.95 15289.7,-346.98 15343.87,-340.83 15396.35,-333.84"/>
<polygon fill="black" stroke="black" points="15397.04,-337.28 15406.48,-332.47 15396.1,-330.34 15397.04,-337.28"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_13_gpu13 -->
<g id="edge1593" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_13_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14278.71,-491.75C14275.29,-491.47 14271.89,-491.21 14268.5,-490.95 13086.21,-401.68 12780.48,-548.23 11594.59,-455"/>
<polygon fill="black" stroke="black" points="11594.79,-451.5 11584.55,-454.2 11594.24,-458.48 11594.79,-451.5"/>
</g>
<!-- l3_expert_agg_gpu13&#45;&gt;l3_res2_gpu13 -->
<g id="edge1611" class="edge">
<title>l3_expert_agg_gpu13&#45;&gt;l3_res2_gpu13</title>
<path fill="none" stroke="black" d="M13861.5,-214.75C13861.5,-206 13861.5,-197.23 13861.5,-189.02"/>
<polygon fill="black" stroke="black" points="13865,-188.97 13861.5,-178.97 13858,-188.97 13865,-188.97"/>
</g>
<!-- l3_res2_gpu13&#45;&gt;output -->
<g id="edge1678" class="edge">
<title>l3_res2_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13644.18,-131.86C13507.88,-124.7 13328.48,-116.07 13169.5,-110.95 11656.66,-62.31 9847.24,-45.43 9128.86,-40.38"/>
<polygon fill="black" stroke="black" points="9128.65,-36.88 9118.63,-40.31 9128.6,-43.88 9128.65,-36.88"/>
</g>
<!-- l3_mha_attn_gpu14 -->
<g id="node499" class="node">
<title>l3_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15988,-938.95 15507,-938.95 15507,-870.95 15988,-870.95 15988,-938.95"/>
<text text-anchor="middle" x="15747.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15747.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15747.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15747.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu14&#45;&gt;l3_mha_attn_gpu14 -->
<g id="edge1614" class="edge">
<title>l3_mha_qkv_gpu14&#45;&gt;l3_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M15747.5,-974.84C15747.5,-966.73 15747.5,-957.94 15747.5,-949.43"/>
<polygon fill="black" stroke="black" points="15751,-949.25 15747.5,-939.25 15744,-949.25 15751,-949.25"/>
</g>
<!-- l3_mha_out_gpu14 -->
<g id="node500" class="node">
<title>l3_mha_out_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15985,-834.95 15516,-834.95 15516,-766.95 15985,-766.95 15985,-834.95"/>
<text text-anchor="middle" x="15750.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15750.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15750.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="15750.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu14&#45;&gt;l3_mha_out_gpu14 -->
<g id="edge1615" class="edge">
<title>l3_mha_attn_gpu14&#45;&gt;l3_mha_out_gpu14</title>
<path fill="none" stroke="black" d="M15748.47,-870.84C15748.71,-862.73 15748.97,-853.94 15749.22,-845.43"/>
<polygon fill="black" stroke="black" points="15752.73,-845.35 15749.52,-835.25 15745.73,-845.15 15752.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu14&#45;&gt;l3_mha_res_add_gpu14 -->
<g id="edge1616" class="edge">
<title>l3_mha_out_gpu14&#45;&gt;l3_mha_res_add_gpu14</title>
<path fill="none" stroke="black" d="M15778.75,-766.84C15786.34,-757.93 15794.65,-748.19 15802.57,-738.91"/>
<polygon fill="black" stroke="black" points="15805.27,-741.13 15809.1,-731.25 15799.95,-736.59 15805.27,-741.13"/>
</g>
<!-- l3_expert_14_gpu14 -->
<g id="node502" class="node">
<title>l3_expert_14_gpu14</title>
<polygon fill="lightpink" stroke="black" points="12036.5,-454.95 11602.5,-454.95 11602.5,-386.95 12036.5,-386.95 12036.5,-454.95"/>
<text text-anchor="middle" x="11819.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11819.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11819.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11819.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu14&#45;&gt;l3_expert_14_gpu14 -->
<g id="edge1620" class="edge">
<title>l3_mha_res_add_gpu14&#45;&gt;l3_expert_14_gpu14</title>
<path fill="none" stroke="black" d="M15620.17,-673.62C15502.22,-659.98 15375.77,-642.27 15352.5,-626.95 15293.35,-588.02 15331.06,-525.95 15269.5,-490.95 15193.28,-447.61 12261.84,-461.32 12046.59,-454.67"/>
<polygon fill="black" stroke="black" points="12046.7,-451.17 12036.55,-454.21 12046.38,-458.17 12046.7,-451.17"/>
</g>
<!-- l3_gate_gpu14 -->
<g id="node503" class="node">
<title>l3_gate_gpu14</title>
<polygon fill="lightcyan" stroke="black" points="16313.24,-626.95 15556.44,-626.95 15361.76,-490.95 16118.56,-490.95 16313.24,-626.95"/>
<text text-anchor="middle" x="15837.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="15837.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15837.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15837.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu14&#45;&gt;l3_gate_gpu14 -->
<g id="edge1618" class="edge">
<title>l3_mha_res_add_gpu14&#45;&gt;l3_gate_gpu14</title>
<path fill="none" stroke="black" d="M15837.5,-662.68C15837.5,-654.86 15837.5,-646.19 15837.5,-637.31"/>
<polygon fill="black" stroke="black" points="15841,-637.22 15837.5,-627.22 15834,-637.22 15841,-637.22"/>
</g>
<!-- l3_res2_gpu14 -->
<g id="node505" class="node">
<title>l3_res2_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="14996.5,-178.95 14562.5,-178.95 14562.5,-110.95 14996.5,-110.95 14996.5,-178.95"/>
<text text-anchor="middle" x="14779.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14779.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14779.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14779.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu14&#45;&gt;l3_res2_gpu14 -->
<g id="edge1638" class="edge">
<title>l3_mha_res_add_gpu14&#45;&gt;l3_res2_gpu14</title>
<path fill="none" stroke="black" d="M16054.85,-693.95C16465.63,-689.1 17319.06,-673.44 17363.5,-626.95 17426.76,-560.77 17427.62,-280.31 17363.5,-214.95 17326.69,-177.43 15524.04,-180.71 15471.5,-178.95 15316.41,-173.78 15141.87,-165.44 15006.89,-158.44"/>
<polygon fill="black" stroke="black" points="15007,-154.94 14996.83,-157.92 15006.63,-161.93 15007,-154.94"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1621" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11602.45,-387.66C11599.45,-387.41 11596.47,-387.17 11593.5,-386.95 10573.33,-310.86 3406.68,-427.02 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.18 2386.23,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1622" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11602.45,-387.66C11599.45,-387.41 11596.47,-387.18 11593.5,-386.95 10675.06,-318.25 4222.94,-419.64 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.18 3304.23,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1623" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11602.45,-387.67C11599.45,-387.41 11596.47,-387.18 11593.5,-386.95 10776.79,-325.64 5039.21,-412.25 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.18 4222.23,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1624" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11602.45,-387.67C11599.45,-387.42 11596.47,-387.18 11593.5,-386.95 10163.54,-279.09 6570.46,-458.78 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.18 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1625" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11602.45,-387.67C11599.45,-387.42 11596.47,-387.18 11593.5,-386.95 10367,-293.87 7285,-444.01 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.77,-347.46 6048.53,-350.17 6058.22,-354.44 6058.77,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1626" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11602.45,-387.68C11599.45,-387.42 11596.47,-387.18 11593.5,-386.95 10570.46,-308.65 7999.54,-429.24 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.77,-347.46 6966.53,-350.17 6976.22,-354.44 6976.77,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1627" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11602.45,-387.69C11599.45,-387.43 11596.47,-387.18 11593.5,-386.95 10773.92,-323.42 8714.08,-414.47 7894.5,-350.95 7894.4,-350.95 7894.29,-350.94 7894.19,-350.93"/>
<polygon fill="black" stroke="black" points="7894.78,-347.46 7884.53,-350.16 7894.22,-354.44 7894.78,-347.46"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1628" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11602.45,-387.7C11599.45,-387.44 11596.46,-387.19 11593.5,-386.95 10361.25,-289.44 10044.75,-448.44 8812.5,-350.95 8812.4,-350.95 8812.29,-350.94 8812.19,-350.93"/>
<polygon fill="black" stroke="black" points="8812.78,-347.47 8802.53,-350.14 8812.21,-354.44 8812.78,-347.47"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1629" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11602.45,-387.73C11599.45,-387.46 11596.46,-387.2 11593.5,-386.95 10768.14,-318.99 10555.86,-418.9 9730.5,-350.95 9730.39,-350.94 9730.29,-350.94 9730.18,-350.93"/>
<polygon fill="black" stroke="black" points="9730.49,-347.44 9720.23,-350.08 9729.9,-354.42 9730.49,-347.44"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1630" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11602.44,-387.81C11599.44,-387.51 11596.46,-387.23 11593.5,-386.95 11174.95,-348.53 11067.05,-389.36 10648.5,-350.95 10648.39,-350.94 10648.29,-350.93 10648.18,-350.92"/>
<polygon fill="black" stroke="black" points="10648.52,-347.44 10638.24,-349.99 10647.87,-354.41 10648.52,-347.44"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1631" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11646.69,-386.94C11592.48,-376.59 11530.48,-364.75 11468.29,-352.87"/>
<polygon fill="black" stroke="black" points="11468.79,-349.4 11458.31,-350.96 11467.47,-356.28 11468.79,-349.4"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1632" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11869.63,-386.86C11883.63,-377.62 11899.41,-367.2 11915.42,-356.63"/>
<polygon fill="black" stroke="black" points="11917.39,-359.52 11923.8,-351.09 11913.53,-353.68 11917.39,-359.52"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1633" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12036.58,-387.99C12039.57,-387.64 12042.55,-387.29 12045.5,-386.95 12240.01,-364.8 12289.99,-373.1 12484.5,-350.95 12534.49,-345.26 12587.41,-338.36 12638.87,-331.17"/>
<polygon fill="black" stroke="black" points="12639.38,-334.63 12648.79,-329.78 12638.41,-327.7 12639.38,-334.63"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1634" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12036.55,-387.76C12039.55,-387.48 12042.54,-387.21 12045.5,-386.95 12646.61,-335.28 12801.39,-402.62 13402.5,-350.95 13453.47,-346.57 13507.42,-340.24 13559.71,-333.19"/>
<polygon fill="black" stroke="black" points="13560.37,-336.64 13569.8,-331.82 13559.42,-329.7 13560.37,-336.64"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1635" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12036.55,-387.71C12039.55,-387.45 12042.54,-387.19 12045.5,-386.95 13053.47,-305.73 13312.53,-432.15 14320.5,-350.95 14371.59,-346.84 14425.65,-340.63 14478.04,-333.62"/>
<polygon fill="black" stroke="black" points="14478.71,-337.06 14488.15,-332.25 14477.77,-330.12 14478.71,-337.06"/>
</g>
<!-- l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1636" class="edge">
<title>l3_expert_14_gpu14&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12036.55,-387.69C12039.55,-387.43 12042.54,-387.19 12045.5,-386.95 12752.94,-331.57 14531.06,-406.32 15238.5,-350.95 15289.69,-346.95 15343.86,-340.78 15396.35,-333.78"/>
<polygon fill="black" stroke="black" points="15397.03,-337.21 15406.47,-332.41 15396.1,-330.28 15397.03,-337.21"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_14_gpu14 -->
<g id="edge1619" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_14_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15368.16,-495.56C15348.36,-493.83 15328.74,-492.28 15309.5,-490.95 14589.1,-441.44 12785.06,-510.85 12046.53,-454.98"/>
<polygon fill="black" stroke="black" points="12046.79,-451.49 12036.55,-454.21 12046.25,-458.47 12046.79,-451.49"/>
</g>
<!-- l3_expert_agg_gpu14&#45;&gt;l3_res2_gpu14 -->
<g id="edge1637" class="edge">
<title>l3_expert_agg_gpu14&#45;&gt;l3_res2_gpu14</title>
<path fill="none" stroke="black" d="M14779.5,-214.75C14779.5,-206 14779.5,-197.23 14779.5,-189.02"/>
<polygon fill="black" stroke="black" points="14783,-188.97 14779.5,-178.97 14776,-188.97 14783,-188.97"/>
</g>
<!-- l3_res2_gpu14&#45;&gt;output -->
<g id="edge1679" class="edge">
<title>l3_res2_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14562.18,-131.7C14425.89,-124.48 14246.49,-115.84 14087.5,-110.95 12207.5,-53.23 9949.18,-41.48 9129.34,-39.09"/>
<polygon fill="black" stroke="black" points="9129.18,-35.59 9119.17,-39.06 9129.16,-42.59 9129.18,-35.59"/>
</g>
<!-- l3_mha_attn_gpu15 -->
<g id="node507" class="node">
<title>l3_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17492,-938.95 17011,-938.95 17011,-870.95 17492,-870.95 17492,-938.95"/>
<text text-anchor="middle" x="17251.5" y="-923.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="17251.5" y="-908.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17251.5" y="-893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="17251.5" y="-878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
</g>
<!-- l3_mha_qkv_gpu15&#45;&gt;l3_mha_attn_gpu15 -->
<g id="edge1640" class="edge">
<title>l3_mha_qkv_gpu15&#45;&gt;l3_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M17251.5,-974.84C17251.5,-966.73 17251.5,-957.94 17251.5,-949.43"/>
<polygon fill="black" stroke="black" points="17255,-949.25 17251.5,-939.25 17248,-949.25 17255,-949.25"/>
</g>
<!-- l3_mha_out_gpu15 -->
<g id="node508" class="node">
<title>l3_mha_out_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="17489,-834.95 17020,-834.95 17020,-766.95 17489,-766.95 17489,-834.95"/>
<text text-anchor="middle" x="17254.5" y="-819.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17254.5" y="-804.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17254.5" y="-789.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="17254.5" y="-774.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_attn_gpu15&#45;&gt;l3_mha_out_gpu15 -->
<g id="edge1641" class="edge">
<title>l3_mha_attn_gpu15&#45;&gt;l3_mha_out_gpu15</title>
<path fill="none" stroke="black" d="M17252.47,-870.84C17252.71,-862.73 17252.97,-853.94 17253.22,-845.43"/>
<polygon fill="black" stroke="black" points="17256.73,-845.35 17253.52,-835.25 17249.73,-845.15 17256.73,-845.35"/>
</g>
<!-- l3_mha_out_gpu15&#45;&gt;l3_mha_res_add_gpu15 -->
<g id="edge1642" class="edge">
<title>l3_mha_out_gpu15&#45;&gt;l3_mha_res_add_gpu15</title>
<path fill="none" stroke="black" d="M17297.68,-766.84C17309.88,-757.48 17323.27,-747.21 17335.91,-737.52"/>
<polygon fill="black" stroke="black" points="17338.28,-740.12 17344.08,-731.25 17334.02,-734.56 17338.28,-740.12"/>
</g>
<!-- l3_expert_15_gpu15 -->
<g id="node510" class="node">
<title>l3_expert_15_gpu15</title>
<polygon fill="lightpink" stroke="black" points="12488.5,-454.95 12054.5,-454.95 12054.5,-386.95 12488.5,-386.95 12488.5,-454.95"/>
<text text-anchor="middle" x="12271.5" y="-439.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12271.5" y="-424.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12271.5" y="-409.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12271.5" y="-394.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu15&#45;&gt;l3_expert_15_gpu15 -->
<g id="edge1646" class="edge">
<title>l3_mha_res_add_gpu15&#45;&gt;l3_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M17389.34,-662.82C17389.91,-615.93 17383.02,-531.43 17330.5,-490.95 17282.01,-453.58 13477.46,-428.95 12498.93,-423.23"/>
<polygon fill="black" stroke="black" points="12498.63,-419.73 12488.61,-423.17 12498.59,-426.73 12498.63,-419.73"/>
</g>
<!-- l3_gate_gpu15 -->
<g id="node511" class="node">
<title>l3_gate_gpu15</title>
<polygon fill="lightcyan" stroke="black" points="17321.24,-626.95 16564.44,-626.95 16369.76,-490.95 17126.56,-490.95 17321.24,-626.95"/>
<text text-anchor="middle" x="16845.5" y="-577.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="16845.5" y="-562.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16845.5" y="-547.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16845.5" y="-532.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l3_mha_res_add_gpu15&#45;&gt;l3_gate_gpu15 -->
<g id="edge1644" class="edge">
<title>l3_mha_res_add_gpu15&#45;&gt;l3_gate_gpu15</title>
<path fill="none" stroke="black" d="M17255.95,-662.94C17215.36,-652.76 17169.04,-641.14 17122.48,-629.45"/>
<polygon fill="black" stroke="black" points="17123.1,-626 17112.55,-626.96 17121.4,-632.79 17123.1,-626"/>
</g>
<!-- l3_res2_gpu15 -->
<g id="node513" class="node">
<title>l3_res2_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="15914.5,-178.95 15480.5,-178.95 15480.5,-110.95 15914.5,-110.95 15914.5,-178.95"/>
<text text-anchor="middle" x="15697.5" y="-163.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15697.5" y="-148.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="15697.5" y="-133.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15697.5" y="-118.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_mha_res_add_gpu15&#45;&gt;l3_res2_gpu15 -->
<g id="edge1664" class="edge">
<title>l3_mha_res_add_gpu15&#45;&gt;l3_res2_gpu15</title>
<path fill="none" stroke="black" d="M17402.57,-662.84C17440.39,-574.2 17527.42,-330.48 17398.5,-214.95 17344.57,-166.63 16376.07,-151.85 15925.09,-147.58"/>
<polygon fill="black" stroke="black" points="15924.9,-144.08 15914.87,-147.49 15924.83,-151.08 15924.9,-144.08"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1647" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M12054.45,-387.66C12051.45,-387.41 12048.47,-387.17 12045.5,-386.95 10975.24,-307.22 3456.77,-430.66 2386.5,-350.95 2386.4,-350.95 2386.29,-350.94 2386.19,-350.93"/>
<polygon fill="black" stroke="black" points="2386.77,-347.46 2376.53,-350.19 2386.23,-354.44 2386.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1648" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M12054.45,-387.66C12051.45,-387.41 12048.47,-387.17 12045.5,-386.95 11076.97,-314.61 4273.03,-423.27 3304.5,-350.95 3304.4,-350.95 3304.29,-350.94 3304.19,-350.93"/>
<polygon fill="black" stroke="black" points="3304.77,-347.46 3294.53,-350.18 3304.23,-354.44 3304.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1649" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M12054.45,-387.66C12051.45,-387.41 12048.47,-387.18 12045.5,-386.95 11178.7,-322 5089.3,-415.89 4222.5,-350.95 4222.4,-350.95 4222.29,-350.94 4222.19,-350.93"/>
<polygon fill="black" stroke="black" points="4222.77,-347.46 4212.53,-350.18 4222.23,-354.44 4222.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1650" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12054.45,-387.67C12051.45,-387.41 12048.47,-387.18 12045.5,-386.95 11280.43,-329.39 5905.57,-408.5 5140.5,-350.95 5140.4,-350.95 5140.29,-350.94 5140.19,-350.93"/>
<polygon fill="black" stroke="black" points="5140.77,-347.46 5130.53,-350.18 5140.22,-354.44 5140.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1651" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M12054.45,-387.67C12051.45,-387.42 12048.47,-387.18 12045.5,-386.95 10718.82,-286.59 7385.18,-451.28 6058.5,-350.95 6058.4,-350.95 6058.29,-350.94 6058.19,-350.93"/>
<polygon fill="black" stroke="black" points="6058.77,-347.46 6048.53,-350.17 6058.22,-354.44 6058.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1652" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M12054.45,-387.68C12051.45,-387.42 12048.47,-387.18 12045.5,-386.95 10922.28,-301.37 8099.72,-436.51 6976.5,-350.95 6976.4,-350.95 6976.29,-350.94 6976.19,-350.93"/>
<polygon fill="black" stroke="black" points="6976.77,-347.46 6966.53,-350.17 6976.22,-354.44 6976.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1653" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M12054.45,-387.68C12051.45,-387.42 12048.47,-387.18 12045.5,-386.95 11125.74,-316.15 8814.26,-421.74 7894.5,-350.95 7894.4,-350.95 7894.29,-350.94 7894.19,-350.93"/>
<polygon fill="black" stroke="black" points="7894.77,-347.46 7884.53,-350.16 7894.22,-354.44 7894.77,-347.46"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1654" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M12054.45,-387.69C12051.45,-387.43 12048.46,-387.19 12045.5,-386.95 11329.2,-330.92 9528.8,-406.97 8812.5,-350.95 8812.4,-350.95 8812.29,-350.94 8812.19,-350.93"/>
<polygon fill="black" stroke="black" points="8812.78,-347.47 8802.53,-350.15 8812.21,-354.44 8812.78,-347.47"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1655" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M12054.45,-387.71C12051.45,-387.44 12048.46,-387.19 12045.5,-386.95 11019.8,-304.44 10756.2,-433.44 9730.5,-350.95 9730.4,-350.94 9730.29,-350.94 9730.19,-350.93"/>
<polygon fill="black" stroke="black" points="9730.78,-347.47 9720.53,-350.13 9730.21,-354.44 9730.78,-347.47"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1656" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M12054.45,-387.75C12051.45,-387.47 12048.46,-387.21 12045.5,-386.95 11426.67,-333.99 11267.33,-403.9 10648.5,-350.95 10648.39,-350.94 10648.29,-350.94 10648.18,-350.93"/>
<polygon fill="black" stroke="black" points="10648.5,-347.44 10638.23,-350.05 10647.89,-354.41 10648.5,-347.44"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1657" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M12054.43,-387.96C12051.43,-387.62 12048.46,-387.28 12045.5,-386.95 11833.3,-363.52 11778.7,-374.39 11566.5,-350.95 11566.39,-350.94 11566.28,-350.93 11566.17,-350.92"/>
<polygon fill="black" stroke="black" points="11566.28,-347.41 11555.95,-349.77 11565.5,-354.36 11566.28,-347.41"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1658" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12211.64,-386.86C12194.62,-377.45 12175.38,-366.82 12155.9,-356.05"/>
<polygon fill="black" stroke="black" points="12157.39,-352.87 12146.94,-351.09 12154,-358.99 12157.39,-352.87"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1659" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12434.6,-386.94C12500.5,-373.61 12578.59,-357.8 12653.57,-342.63"/>
<polygon fill="black" stroke="black" points="12654.54,-346 12663.65,-340.59 12653.15,-339.14 12654.54,-346"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1660" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12488.76,-412.12C12716.79,-402.63 13085.5,-383.7 13402.5,-350.95 13452.83,-345.75 13506.1,-339.07 13557.83,-331.95"/>
<polygon fill="black" stroke="black" points="13558.39,-335.4 13567.82,-330.56 13557.43,-328.47 13558.39,-335.4"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1661" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12488.92,-413.28C12997.88,-397.58 14230.65,-359 14320.5,-350.95 14371.27,-346.41 14424.99,-340.01 14477.11,-332.96"/>
<polygon fill="black" stroke="black" points="14477.73,-336.41 14487.16,-331.59 14476.78,-329.48 14477.73,-336.41"/>
</g>
<!-- l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1662" class="edge">
<title>l3_expert_15_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12488.62,-412.78C12711.05,-405.59 13066.87,-394.53 13374.5,-386.95 13788.67,-376.76 14825.6,-384.94 15238.5,-350.95 15289.58,-346.75 15343.64,-340.49 15396.03,-333.47"/>
<polygon fill="black" stroke="black" points="15396.7,-336.91 15406.14,-332.1 15395.76,-329.97 15396.7,-336.91"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_15_gpu15 -->
<g id="edge1645" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_15_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16375.67,-495.26C16357.73,-493.67 16339.96,-492.22 16322.5,-490.95 15570.72,-436.56 13238.56,-424.88 12498.96,-422.52"/>
<polygon fill="black" stroke="black" points="12498.74,-419.02 12488.73,-422.49 12498.72,-426.02 12498.74,-419.02"/>
</g>
<!-- l3_expert_agg_gpu15&#45;&gt;l3_res2_gpu15 -->
<g id="edge1663" class="edge">
<title>l3_expert_agg_gpu15&#45;&gt;l3_res2_gpu15</title>
<path fill="none" stroke="black" d="M15697.5,-214.75C15697.5,-206 15697.5,-197.23 15697.5,-189.02"/>
<polygon fill="black" stroke="black" points="15701,-188.97 15697.5,-178.97 15694,-188.97 15701,-188.97"/>
</g>
<!-- l3_res2_gpu15&#45;&gt;output -->
<g id="edge1680" class="edge">
<title>l3_res2_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15480.18,-131.58C15343.89,-124.32 15164.49,-115.67 15005.5,-110.95 12755.01,-44.15 10042.79,-38.14 9129.8,-38.17"/>
<polygon fill="black" stroke="black" points="9129.47,-34.67 9119.47,-38.17 9129.47,-41.67 9129.47,-34.67"/>
</g>
</g>
</svg>
