<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_dag Pages: 1 -->
<svg width="1440pt" height="123pt"
 viewBox="0.00 0.00 1440.00 123.03" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 2492.91)">
<title>baseline_moe_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2492.91 29221.57,-2492.91 29221.57,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9240.57,-867.95 9240.57,-1265.95 17994.57,-1265.95 17994.57,-867.95 9240.57,-867.95"/>
<text text-anchor="middle" x="13617.57" y="-1250.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9248.57,-875.95 9248.57,-1234.95 17986.57,-1234.95 17986.57,-875.95 9248.57,-875.95"/>
<text text-anchor="middle" x="13617.57" y="-1219.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pipeline_stage_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9322.57,-94.95 9322.57,-859.95 17544.57,-859.95 17544.57,-94.95 9322.57,-94.95"/>
<text text-anchor="middle" x="13433.57" y="-844.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 8&#45;15)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9338.57,-469.95 9338.57,-828.95 17528.57,-828.95 17528.57,-469.95 9338.57,-469.95"/>
<text text-anchor="middle" x="13433.57" y="-813.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9330.57,-102.95 9330.57,-461.95 17536.57,-461.95 17536.57,-102.95 9330.57,-102.95"/>
<text text-anchor="middle" x="13433.57" y="-446.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="14936.57" cy="-2451.43" rx="306.77" ry="37.45"/>
<text text-anchor="middle" x="14936.57" y="-2462.73" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="14936.57" y="-2447.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14936.57" y="-2432.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_qkv_gpu0 -->
<g id="node2" class="node">
<title>l0_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="9396.57,-2377.95 8924.57,-2377.95 8924.57,-2309.95 9396.57,-2309.95 9396.57,-2377.95"/>
<text text-anchor="middle" x="9160.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9160.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9160.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="9160.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M14630.35,-2448.59C13854.59,-2443.34 11748.96,-2425.52 9994.57,-2377.95 9797,-2372.6 9573.21,-2363.58 9407.23,-2356.32"/>
<polygon fill="black" stroke="black" points="9407.02,-2352.81 9396.88,-2355.87 9406.72,-2359.81 9407.02,-2352.81"/>
</g>
<!-- l0_res_add_gpu0 -->
<g id="node6" class="node">
<title>l0_res_add_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="2445.57,-1893.95 2011.57,-1893.95 2011.57,-1825.95 2445.57,-1825.95 2445.57,-1893.95"/>
<text text-anchor="middle" x="2228.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2228.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2228.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2228.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu0 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;l0_res_add_gpu0</title>
<path fill="none" stroke="black" d="M14629.92,-2449.44C12705.33,-2442.71 2373.57,-2399.21 2373.57,-2240.95 2373.57,-2240.95 2373.57,-2240.95 2373.57,-2134.95 2373.57,-2043.51 2309.69,-1952.75 2266.73,-1902.05"/>
<polygon fill="black" stroke="black" points="2269.21,-1899.56 2260.03,-1894.26 2263.9,-1904.12 2269.21,-1899.56"/>
</g>
<!-- l0_mha_qkv_gpu1 -->
<g id="node18" class="node">
<title>l0_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12499.57,-2377.95 12027.57,-2377.95 12027.57,-2309.95 12499.57,-2309.95 12499.57,-2377.95"/>
<text text-anchor="middle" x="12263.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12263.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="12263.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="12263.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu1 -->
<g id="edge67" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M14631.88,-2446.8C14188.77,-2440.18 13340.78,-2422.47 12620.57,-2377.95 12584.79,-2375.74 12547.05,-2372.86 12510.03,-2369.71"/>
<polygon fill="black" stroke="black" points="12509.87,-2366.18 12499.61,-2368.82 12509.28,-2373.16 12509.87,-2366.18"/>
</g>
<!-- l0_res_add_gpu1 -->
<g id="node22" class="node">
<title>l0_res_add_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="6099.57,-1893.95 5665.57,-1893.95 5665.57,-1825.95 6099.57,-1825.95 6099.57,-1893.95"/>
<text text-anchor="middle" x="5882.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5882.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5882.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5882.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu1 -->
<g id="edge72" class="edge">
<title>input&#45;&gt;l0_res_add_gpu1</title>
<path fill="none" stroke="black" d="M14633.41,-2445.5C13560.67,-2427.07 10008.57,-2357.28 10008.57,-2240.95 10008.57,-2240.95 10008.57,-2240.95 10008.57,-2134.95 10008.57,-1937.94 6974,-1877.32 6109.74,-1864.05"/>
<polygon fill="black" stroke="black" points="6109.73,-1860.55 6099.68,-1863.9 6109.62,-1867.55 6109.73,-1860.55"/>
</g>
<!-- l0_mha_qkv_gpu2 -->
<g id="node34" class="node">
<title>l0_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13979.57,-2377.95 13507.57,-2377.95 13507.57,-2309.95 13979.57,-2309.95 13979.57,-2377.95"/>
<text text-anchor="middle" x="13743.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13743.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13743.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="13743.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu2 -->
<g id="edge133" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M14666.42,-2433.59C14477.68,-2420.87 14219.96,-2401.58 13993.57,-2377.95 13992.28,-2377.82 13990.99,-2377.68 13989.7,-2377.55"/>
<polygon fill="black" stroke="black" points="13990.04,-2374.06 13979.73,-2376.48 13989.3,-2381.02 13990.04,-2374.06"/>
</g>
<!-- l0_res_add_gpu2 -->
<g id="node38" class="node">
<title>l0_res_add_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="9753.57,-1893.95 9319.57,-1893.95 9319.57,-1825.95 9753.57,-1825.95 9753.57,-1893.95"/>
<text text-anchor="middle" x="9536.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9536.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9536.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9536.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu2 -->
<g id="edge138" class="edge">
<title>input&#45;&gt;l0_res_add_gpu2</title>
<path fill="none" stroke="black" d="M14634.6,-2444.59C14343.12,-2436.74 13889.69,-2418.7 13498.57,-2377.95 13111.86,-2337.67 12634.57,-2629.75 12634.57,-2240.95 12634.57,-2240.95 12634.57,-2240.95 12634.57,-2134.95 12634.57,-1863.22 12325.68,-1979.84 12058.57,-1929.95 11837.02,-1888.58 10341.54,-1869.13 9763.76,-1863.1"/>
<polygon fill="black" stroke="black" points="9763.68,-1859.6 9753.64,-1862.99 9763.6,-1866.6 9763.68,-1859.6"/>
</g>
<!-- l0_mha_qkv_gpu3 -->
<g id="node50" class="node">
<title>l0_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="15040.57,-2377.95 14568.57,-2377.95 14568.57,-2309.95 15040.57,-2309.95 15040.57,-2377.95"/>
<text text-anchor="middle" x="14804.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14804.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14804.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="14804.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu3 -->
<g id="edge199" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M14891.14,-2414.13C14879.15,-2404.55 14866.15,-2394.16 14853.97,-2384.42"/>
<polygon fill="black" stroke="black" points="14856.09,-2381.64 14846.09,-2378.13 14851.72,-2387.11 14856.09,-2381.64"/>
</g>
<!-- l0_res_add_gpu3 -->
<g id="node54" class="node">
<title>l0_res_add_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="13407.57,-1893.95 12973.57,-1893.95 12973.57,-1825.95 13407.57,-1825.95 13407.57,-1893.95"/>
<text text-anchor="middle" x="13190.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13190.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13190.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13190.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu3 -->
<g id="edge204" class="edge">
<title>input&#45;&gt;l0_res_add_gpu3</title>
<path fill="none" stroke="black" d="M14643.9,-2440.03C14371.59,-2422.13 14007.57,-2373.43 14007.57,-2240.95 14007.57,-2240.95 14007.57,-2240.95 14007.57,-2134.95 14007.57,-2019.92 13950,-1986.03 13849.57,-1929.95 13777.38,-1889.65 13578.5,-1872.85 13417.95,-1865.87"/>
<polygon fill="black" stroke="black" points="13418.06,-1862.37 13407.92,-1865.44 13417.76,-1869.37 13418.06,-1862.37"/>
</g>
<!-- l0_mha_qkv_gpu4 -->
<g id="node66" class="node">
<title>l0_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="15604.57,-2377.95 15132.57,-2377.95 15132.57,-2309.95 15604.57,-2309.95 15604.57,-2377.95"/>
<text text-anchor="middle" x="15368.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15368.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15368.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="15368.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu4 -->
<g id="edge265" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M15070.59,-2417.71C15119.02,-2405.88 15173.9,-2392.48 15223.25,-2380.43"/>
<polygon fill="black" stroke="black" points="15224.16,-2383.82 15233.04,-2378.04 15222.5,-2377.02 15224.16,-2383.82"/>
</g>
<!-- l0_res_add_gpu4 -->
<g id="node70" class="node">
<title>l0_res_add_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="15924.57,-1893.95 15490.57,-1893.95 15490.57,-1825.95 15924.57,-1825.95 15924.57,-1893.95"/>
<text text-anchor="middle" x="15707.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15707.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15707.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15707.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu4 -->
<g id="edge270" class="edge">
<title>input&#45;&gt;l0_res_add_gpu4</title>
<path fill="none" stroke="black" d="M15012.03,-2415.05C15026.55,-2405 15040.15,-2392.68 15049.57,-2377.95 15082.7,-2326.17 15068.57,-2302.42 15068.57,-2240.95 15068.57,-2240.95 15068.57,-2240.95 15068.57,-2134.95 15068.57,-2042.45 15037.23,-1993.38 15104.57,-1929.95 15132.29,-1903.84 15321.02,-1885.22 15480.06,-1873.95"/>
<polygon fill="black" stroke="black" points="15480.76,-1877.41 15490.49,-1873.22 15480.27,-1870.43 15480.76,-1877.41"/>
</g>
<!-- l0_mha_qkv_gpu5 -->
<g id="node82" class="node">
<title>l0_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="17288.57,-2377.95 16816.57,-2377.95 16816.57,-2309.95 17288.57,-2309.95 17288.57,-2377.95"/>
<text text-anchor="middle" x="17052.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17052.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17052.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="17052.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu5 -->
<g id="edge331" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M15241.73,-2447.22C15611.68,-2441.34 16253.82,-2424.73 16802.57,-2377.95 16803.86,-2377.84 16805.15,-2377.73 16806.44,-2377.62"/>
<polygon fill="black" stroke="black" points="16806.79,-2381.1 16816.43,-2376.71 16806.16,-2374.13 16806.79,-2381.1"/>
</g>
<!-- l0_res_add_gpu5 -->
<g id="node86" class="node">
<title>l0_res_add_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="19578.57,-1893.95 19144.57,-1893.95 19144.57,-1825.95 19578.57,-1825.95 19578.57,-1893.95"/>
<text text-anchor="middle" x="19361.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19361.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="19361.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="19361.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu5 -->
<g id="edge336" class="edge">
<title>input&#45;&gt;l0_res_add_gpu5</title>
<path fill="none" stroke="black" d="M15240.83,-2446.52C15766.39,-2435.67 16788.57,-2394.8 16788.57,-2240.95 16788.57,-2240.95 16788.57,-2240.95 16788.57,-2134.95 16788.57,-1900.1 18505.5,-1866.1 19134.32,-1861.53"/>
<polygon fill="black" stroke="black" points="19134.44,-1865.03 19144.41,-1861.45 19134.39,-1858.03 19134.44,-1865.03"/>
</g>
<!-- l0_mha_qkv_gpu6 -->
<g id="node98" class="node">
<title>l0_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20401.57,-2377.95 19929.57,-2377.95 19929.57,-2309.95 20401.57,-2309.95 20401.57,-2377.95"/>
<text text-anchor="middle" x="20165.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20165.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="20165.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="20165.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu6 -->
<g id="edge397" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M15243.18,-2448.97C16166.9,-2444.1 18914.36,-2425.86 19808.57,-2377.95 19844.36,-2376.04 19882.11,-2373.31 19919.14,-2370.24"/>
<polygon fill="black" stroke="black" points="19919.89,-2373.69 19929.56,-2369.36 19919.3,-2366.71 19919.89,-2373.69"/>
</g>
<!-- l0_res_add_gpu6 -->
<g id="node102" class="node">
<title>l0_res_add_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="23232.57,-1893.95 22798.57,-1893.95 22798.57,-1825.95 23232.57,-1825.95 23232.57,-1893.95"/>
<text text-anchor="middle" x="23015.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="23015.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23015.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23015.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu6 -->
<g id="edge402" class="edge">
<title>input&#45;&gt;l0_res_add_gpu6</title>
<path fill="none" stroke="black" d="M15239.54,-2445.31C16301.98,-2426.39 19794.57,-2355.48 19794.57,-2240.95 19794.57,-2240.95 19794.57,-2240.95 19794.57,-2134.95 19794.57,-1946.96 19983.14,-1979.21 20164.57,-1929.95 20414.3,-1862.16 22157.46,-1859.08 22788.34,-1860.22"/>
<polygon fill="black" stroke="black" points="22788.45,-1863.72 22798.46,-1860.24 22788.47,-1856.72 22788.45,-1863.72"/>
</g>
<!-- l0_mha_qkv_gpu7 -->
<g id="node114" class="node">
<title>l0_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23178.57,-2377.95 22706.57,-2377.95 22706.57,-2309.95 23178.57,-2309.95 23178.57,-2377.95"/>
<text text-anchor="middle" x="22942.57" y="-2362.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="22942.57" y="-2347.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="22942.57" y="-2332.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="22942.57" y="-2317.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv_gpu7 -->
<g id="edge463" class="edge">
<title>input&#45;&gt;l0_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M15242.42,-2447.87C16159.14,-2440 18964.49,-2414.45 21290.57,-2377.95 21789.43,-2370.13 22372.96,-2357.7 22695.86,-2350.54"/>
<polygon fill="black" stroke="black" points="22696.36,-2354.03 22706.28,-2350.31 22696.21,-2347.03 22696.36,-2354.03"/>
</g>
<!-- l0_res_add_gpu7 -->
<g id="node118" class="node">
<title>l0_res_add_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="26886.57,-1893.95 26452.57,-1893.95 26452.57,-1825.95 26886.57,-1825.95 26886.57,-1893.95"/>
<text text-anchor="middle" x="26669.57" y="-1878.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="26669.57" y="-1863.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26669.57" y="-1848.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="26669.57" y="-1833.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- input&#45;&gt;l0_res_add_gpu7 -->
<g id="edge468" class="edge">
<title>input&#45;&gt;l0_res_add_gpu7</title>
<path fill="none" stroke="black" d="M15243.22,-2448.95C16320.85,-2443.38 19896.82,-2421.76 20410.57,-2377.95 20798.83,-2344.84 21276.57,-2630.63 21276.57,-2240.95 21276.57,-2240.95 21276.57,-2240.95 21276.57,-2134.95 21276.57,-1872.08 25417.42,-1859.51 26442.25,-1860.43"/>
<polygon fill="black" stroke="black" points="26442.31,-1863.93 26452.32,-1860.44 26442.32,-1856.93 26442.31,-1863.93"/>
</g>
<!-- l0_mha_attn_gpu0 -->
<g id="node3" class="node">
<title>l0_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="8813.57,-2273.95 8341.57,-2273.95 8341.57,-2205.95 8813.57,-2205.95 8813.57,-2273.95"/>
<text text-anchor="middle" x="8577.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8577.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8577.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8577.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu0&#45;&gt;l0_mha_attn_gpu0 -->
<g id="edge2" class="edge">
<title>l0_mha_qkv_gpu0&#45;&gt;l0_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M8971.69,-2309.91C8909.34,-2299 8839.81,-2286.83 8776.72,-2275.8"/>
<polygon fill="black" stroke="black" points="8777.1,-2272.31 8766.65,-2274.03 8775.89,-2279.21 8777.1,-2272.31"/>
</g>
<!-- l0_mha_out_gpu0 -->
<g id="node4" class="node">
<title>l0_mha_out_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="7640.57,-2169.95 7180.57,-2169.95 7180.57,-2101.95 7640.57,-2101.95 7640.57,-2169.95"/>
<text text-anchor="middle" x="7410.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7410.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="7410.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="7410.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu0&#45;&gt;l0_mha_out_gpu0 -->
<g id="edge3" class="edge">
<title>l0_mha_attn_gpu0&#45;&gt;l0_mha_out_gpu0</title>
<path fill="none" stroke="black" d="M8341.41,-2218.31C8140.5,-2200.75 7853.21,-2175.64 7651.07,-2157.97"/>
<polygon fill="black" stroke="black" points="7651.17,-2154.47 7640.91,-2157.09 7650.56,-2161.44 7651.17,-2154.47"/>
</g>
<!-- l0_mha_allreduce_gpu0 -->
<g id="node5" class="node">
<title>l0_mha_allreduce_gpu0</title>
<polygon fill="yellow" stroke="black" points="5527.47,-2065.95 4811.78,-2065.95 4627.67,-1929.95 5343.36,-1929.95 5527.47,-2065.95"/>
<text text-anchor="middle" x="5077.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5077.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5077.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="5077.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu0&#45;&gt;l0_mha_allreduce_gpu0 -->
<g id="edge4" class="edge">
<title>l0_mha_out_gpu0&#45;&gt;l0_mha_allreduce_gpu0</title>
<path fill="none" stroke="black" d="M7180.49,-2121.54C6784.31,-2098.45 5968.71,-2050.9 5477.81,-2022.28"/>
<polygon fill="black" stroke="black" points="5477.9,-2018.78 5467.72,-2021.7 5477.5,-2025.77 5477.9,-2018.78"/>
</g>
<!-- l0_mha_allreduce_gpu0&#45;&gt;l0_res_add_gpu0 -->
<g id="edge5" class="edge">
<title>l0_mha_allreduce_gpu0&#45;&gt;l0_res_add_gpu0</title>
<path fill="none" stroke="black" d="M4693.34,-1978.61C4091.04,-1949.86 2943.19,-1895.07 2456.15,-1871.82"/>
<polygon fill="black" stroke="black" points="2455.99,-1868.31 2445.84,-1871.32 2455.66,-1875.3 2455.99,-1868.31"/>
</g>
<!-- l0_expert_0_gpu0 -->
<g id="node7" class="node">
<title>l0_expert_0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="475.57,-1617.95 41.57,-1617.95 41.57,-1549.95 475.57,-1549.95 475.57,-1617.95"/>
<text text-anchor="middle" x="258.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="258.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="258.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="258.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_0_gpu0 -->
<g id="edge9" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M2011.31,-1855.44C1681.55,-1848.85 1070.37,-1831.37 855.57,-1789.95 666.39,-1753.47 455.49,-1670.42 341.92,-1621.96"/>
<polygon fill="black" stroke="black" points="343.15,-1618.68 332.58,-1617.96 340.39,-1625.11 343.15,-1618.68"/>
</g>
<!-- l0_expert_1_gpu0 -->
<g id="node8" class="node">
<title>l0_expert_1_gpu0</title>
<polygon fill="lightpink" stroke="black" points="927.57,-1617.95 493.57,-1617.95 493.57,-1549.95 927.57,-1549.95 927.57,-1617.95"/>
<text text-anchor="middle" x="710.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="710.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="710.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="710.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_1_gpu0 -->
<g id="edge12" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M2011.4,-1851.43C1765.44,-1841.56 1380.44,-1821.67 1238.57,-1789.95 1070.83,-1752.45 886,-1670.59 785.62,-1622.43"/>
<polygon fill="black" stroke="black" points="786.99,-1619.21 776.46,-1618.02 783.95,-1625.51 786.99,-1619.21"/>
</g>
<!-- l0_expert_2_gpu0 -->
<g id="node9" class="node">
<title>l0_expert_2_gpu0</title>
<polygon fill="lightpink" stroke="black" points="1379.57,-1617.95 945.57,-1617.95 945.57,-1549.95 1379.57,-1549.95 1379.57,-1617.95"/>
<text text-anchor="middle" x="1162.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1162.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1162.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1162.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_2_gpu0 -->
<g id="edge15" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_2_gpu0</title>
<path fill="none" stroke="black" d="M2011.52,-1851.65C1820.94,-1843.01 1559.3,-1825.12 1461.57,-1789.95 1359.97,-1753.4 1260.26,-1673.77 1205.54,-1625.22"/>
<polygon fill="black" stroke="black" points="1207.58,-1622.35 1197.79,-1618.29 1202.91,-1627.56 1207.58,-1622.35"/>
</g>
<!-- l0_expert_3_gpu0 -->
<g id="node10" class="node">
<title>l0_expert_3_gpu0</title>
<polygon fill="lightpink" stroke="black" points="1831.57,-1617.95 1397.57,-1617.95 1397.57,-1549.95 1831.57,-1549.95 1831.57,-1617.95"/>
<text text-anchor="middle" x="1614.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1614.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1614.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1614.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_3_gpu0 -->
<g id="edge18" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_3_gpu0</title>
<path fill="none" stroke="black" d="M2011.42,-1853.21C1806.73,-1845.49 1526.26,-1828.05 1491.57,-1789.95 1450.87,-1745.26 1461.02,-1706.11 1491.57,-1653.95 1498.49,-1642.14 1508.25,-1632.19 1519.29,-1623.86"/>
<polygon fill="black" stroke="black" points="1521.36,-1626.69 1527.53,-1618.08 1517.34,-1620.96 1521.36,-1626.69"/>
</g>
<!-- l0_expert_4_gpu0 -->
<g id="node11" class="node">
<title>l0_expert_4_gpu0</title>
<polygon fill="lightpink" stroke="black" points="2283.57,-1617.95 1849.57,-1617.95 1849.57,-1549.95 2283.57,-1549.95 2283.57,-1617.95"/>
<text text-anchor="middle" x="2066.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2066.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2066.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2066.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_4_gpu0 -->
<g id="edge21" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_4_gpu0</title>
<path fill="none" stroke="black" d="M2390.82,-1825.86C2423.59,-1815.87 2451.22,-1803.81 2461.57,-1789.95 2497.74,-1741.52 2500.46,-1700.23 2461.57,-1653.95 2455.27,-1646.46 2378.16,-1632.22 2293.73,-1618.61"/>
<polygon fill="black" stroke="black" points="2294.1,-1615.12 2283.67,-1617 2292.99,-1622.04 2294.1,-1615.12"/>
</g>
<!-- l0_expert_5_gpu0 -->
<g id="node12" class="node">
<title>l0_expert_5_gpu0</title>
<polygon fill="lightpink" stroke="black" points="2735.57,-1617.95 2301.57,-1617.95 2301.57,-1549.95 2735.57,-1549.95 2735.57,-1617.95"/>
<text text-anchor="middle" x="2518.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2518.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2518.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2518.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_5_gpu0 -->
<g id="edge24" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_5_gpu0</title>
<path fill="none" stroke="black" d="M2412.12,-1825.93C2447.84,-1816.06 2478.1,-1804.04 2490.57,-1789.95 2529.63,-1745.82 2530.12,-1674.04 2525.44,-1628.18"/>
<polygon fill="black" stroke="black" points="2528.92,-1627.79 2524.3,-1618.25 2521.96,-1628.58 2528.92,-1627.79"/>
</g>
<!-- l0_expert_6_gpu0 -->
<g id="node13" class="node">
<title>l0_expert_6_gpu0</title>
<polygon fill="lightpink" stroke="black" points="3187.57,-1617.95 2753.57,-1617.95 2753.57,-1549.95 3187.57,-1549.95 3187.57,-1617.95"/>
<text text-anchor="middle" x="2970.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2970.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2970.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2970.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_6_gpu0 -->
<g id="edge27" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_6_gpu0</title>
<path fill="none" stroke="black" d="M2395.99,-1825.93C2438.11,-1815.95 2482.89,-1803.88 2523.57,-1789.95 2661.06,-1742.88 2813.35,-1667.77 2899.96,-1622.72"/>
<polygon fill="black" stroke="black" points="2901.66,-1625.78 2908.9,-1618.05 2898.42,-1619.57 2901.66,-1625.78"/>
</g>
<!-- l0_expert_7_gpu0 -->
<g id="node14" class="node">
<title>l0_expert_7_gpu0</title>
<polygon fill="lightpink" stroke="black" points="3639.57,-1617.95 3205.57,-1617.95 3205.57,-1549.95 3639.57,-1549.95 3639.57,-1617.95"/>
<text text-anchor="middle" x="3422.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3422.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3422.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3422.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_expert_7_gpu0 -->
<g id="edge30" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_expert_7_gpu0</title>
<path fill="none" stroke="black" d="M2445.77,-1832.54C2524.24,-1821.46 2613.26,-1807.13 2693.57,-1789.95 2915.23,-1742.54 3168.98,-1666.01 3311.06,-1621.08"/>
<polygon fill="black" stroke="black" points="3312.2,-1624.39 3320.67,-1618.04 3310.08,-1617.72 3312.2,-1624.39"/>
</g>
<!-- l0_gate_gpu0 -->
<g id="node15" class="node">
<title>l0_gate_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="2452.31,-1789.95 1695.51,-1789.95 1500.83,-1653.95 2257.62,-1653.95 2452.31,-1789.95"/>
<text text-anchor="middle" x="1976.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1976.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1976.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="1976.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_gate_gpu0 -->
<g id="edge7" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_gate_gpu0</title>
<path fill="none" stroke="black" d="M2167.24,-1825.86C2149.67,-1816.37 2129.79,-1805.64 2109.66,-1794.78"/>
<polygon fill="black" stroke="black" points="2111.18,-1791.63 2100.72,-1789.96 2107.86,-1797.79 2111.18,-1791.63"/>
</g>
<!-- l0_res2_gpu0 -->
<g id="node17" class="node">
<title>l0_res2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="3884.57,-1341.95 3450.57,-1341.95 3450.57,-1273.95 3884.57,-1273.95 3884.57,-1341.95"/>
<text text-anchor="middle" x="3667.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3667.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3667.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3667.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu0&#45;&gt;l0_res2_gpu0 -->
<g id="edge33" class="edge">
<title>l0_res_add_gpu0&#45;&gt;l0_res2_gpu0</title>
<path fill="none" stroke="black" d="M2011.25,-1855.21C1564.96,-1846.86 574.32,-1824.66 423.57,-1789.95 224.86,-1744.2 -103.56,-1701.76 32.57,-1549.95 267.63,-1287.83 1256.38,-1402.98 1607.57,-1377.95 2272.49,-1330.58 3060.51,-1315.61 3440.4,-1310.98"/>
<polygon fill="black" stroke="black" points="3440.45,-1314.48 3450.41,-1310.86 3440.37,-1307.48 3440.45,-1314.48"/>
</g>
<!-- l0_expert_agg_gpu0 -->
<g id="node16" class="node">
<title>l0_expert_agg_gpu0</title>
<polygon fill="yellow" stroke="black" points="2516.47,-1513.95 1800.78,-1513.95 1616.67,-1377.95 2332.36,-1377.95 2516.47,-1513.95"/>
<text text-anchor="middle" x="2066.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2066.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2066.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="2066.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge10" class="edge">
<title>l0_expert_0_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M475.64,-1550.92C478.63,-1550.59 481.61,-1550.27 484.57,-1549.95 908.17,-1505.31 1397.75,-1477 1718.74,-1461.59"/>
<polygon fill="black" stroke="black" points="1719.31,-1465.07 1729.14,-1461.1 1718.98,-1458.08 1719.31,-1465.07"/>
</g>
<!-- l0_expert_1_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge13" class="edge">
<title>l0_expert_1_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M927.65,-1551.03C930.64,-1550.66 933.62,-1550.3 936.57,-1549.95 1204.02,-1518.26 1508.1,-1491.04 1733.4,-1472.56"/>
<polygon fill="black" stroke="black" points="1733.71,-1476.04 1743.39,-1471.74 1733.14,-1469.07 1733.71,-1476.04"/>
</g>
<!-- l0_expert_2_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge16" class="edge">
<title>l0_expert_2_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M1379.67,-1550.29C1493.61,-1533.15 1635.11,-1511.86 1760.02,-1493.07"/>
<polygon fill="black" stroke="black" points="1760.77,-1496.5 1770.13,-1491.55 1759.73,-1489.58 1760.77,-1496.5"/>
</g>
<!-- l0_expert_3_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge19" class="edge">
<title>l0_expert_3_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M1724.27,-1549.94C1757.64,-1539.91 1795.64,-1528.47 1833.91,-1516.96"/>
<polygon fill="black" stroke="black" points="1835.07,-1520.26 1843.64,-1514.03 1833.06,-1513.56 1835.07,-1520.26"/>
</g>
<!-- l0_expert_4_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge22" class="edge">
<title>l0_expert_4_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M2066.57,-1549.68C2066.57,-1541.86 2066.57,-1533.19 2066.57,-1524.31"/>
<polygon fill="black" stroke="black" points="2070.07,-1524.22 2066.57,-1514.22 2063.07,-1524.22 2070.07,-1524.22"/>
</g>
<!-- l0_expert_5_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge25" class="edge">
<title>l0_expert_5_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M2408.86,-1549.94C2375.5,-1539.91 2337.49,-1528.47 2299.23,-1516.96"/>
<polygon fill="black" stroke="black" points="2300.08,-1513.56 2289.5,-1514.03 2298.07,-1520.26 2300.08,-1513.56"/>
</g>
<!-- l0_expert_6_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge28" class="edge">
<title>l0_expert_6_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M2753.46,-1550.29C2683.45,-1539.76 2603.03,-1527.66 2522.44,-1515.54"/>
<polygon fill="black" stroke="black" points="2522.51,-1512.01 2512.1,-1513.98 2521.47,-1518.93 2522.51,-1512.01"/>
</g>
<!-- l0_expert_7_gpu0&#45;&gt;l0_expert_agg_gpu0 -->
<g id="edge31" class="edge">
<title>l0_expert_7_gpu0&#45;&gt;l0_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M3205.49,-1551.03C3202.5,-1550.66 3199.52,-1550.3 3196.57,-1549.95 2959.11,-1521.82 2692.78,-1497.2 2478.35,-1479.1"/>
<polygon fill="black" stroke="black" points="2478.43,-1475.6 2468.17,-1478.24 2477.85,-1482.57 2478.43,-1475.6"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_0_gpu0 -->
<g id="edge8" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1568.18,-1701.15C1270.62,-1684.7 857.73,-1657.7 485.8,-1618.06"/>
<polygon fill="black" stroke="black" points="485.96,-1614.56 475.64,-1616.97 485.21,-1621.52 485.96,-1614.56"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_1_gpu0 -->
<g id="edge11" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1541.54,-1682.39C1358.05,-1664.98 1141.98,-1642.96 937.68,-1618.07"/>
<polygon fill="black" stroke="black" points="938,-1614.59 927.65,-1616.85 937.16,-1621.54 938,-1614.59"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_2_gpu0 -->
<g id="edge14" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1575.53,-1653.95C1504.49,-1642.08 1433.2,-1630.17 1370.34,-1619.67"/>
<polygon fill="black" stroke="black" points="1370.76,-1616.19 1360.32,-1617.99 1369.61,-1623.09 1370.76,-1616.19"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_3_gpu0 -->
<g id="edge17" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1798.22,-1653.95C1768.66,-1642.84 1739,-1631.7 1712.4,-1621.71"/>
<polygon fill="black" stroke="black" points="1713.34,-1618.32 1702.75,-1618.08 1710.88,-1624.87 1713.34,-1618.32"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_4_gpu0 -->
<g id="edge20" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2021.04,-1653.75C2027.22,-1644.41 2033.41,-1635.06 2039.15,-1626.39"/>
<polygon fill="black" stroke="black" points="2042.12,-1628.24 2044.72,-1617.97 2036.28,-1624.38 2042.12,-1628.24"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_5_gpu0 -->
<g id="edge23" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2243.6,-1653.95C2289.73,-1642.37 2336.02,-1630.76 2377.12,-1620.45"/>
<polygon fill="black" stroke="black" points="2378.05,-1623.82 2386.9,-1617.99 2376.34,-1617.03 2378.05,-1623.82"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_6_gpu0 -->
<g id="edge26" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2294.29,-1679.19C2429.69,-1661.18 2589.65,-1639.61 2743.35,-1618.12"/>
<polygon fill="black" stroke="black" points="2744.05,-1621.56 2753.46,-1616.7 2743.08,-1614.62 2744.05,-1621.56"/>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_expert_7_gpu0 -->
<g id="edge29" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_expert_7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2320.25,-1697.54C2562.24,-1679.7 2893.92,-1652.54 3195.24,-1618.09"/>
<polygon fill="black" stroke="black" points="3195.95,-1621.53 3205.49,-1616.91 3195.16,-1614.57 3195.95,-1621.53"/>
</g>
<!-- l0_expert_agg_gpu0&#45;&gt;l0_res2_gpu0 -->
<g id="edge32" class="edge">
<title>l0_expert_agg_gpu0&#45;&gt;l0_res2_gpu0</title>
<path fill="none" stroke="black" d="M2386.71,-1417.76C2698.59,-1391.27 3164.84,-1351.66 3440.39,-1328.25"/>
<polygon fill="black" stroke="black" points="3440.85,-1331.72 3450.52,-1327.39 3440.26,-1324.75 3440.85,-1331.72"/>
</g>
<!-- l1_mha_qkv_gpu0 -->
<g id="node130" class="node">
<title>l1_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10887.57,-1203.95 10717.57,-1203.95 10717.57,-1150.95 10887.57,-1150.95 10887.57,-1203.95"/>
<text text-anchor="middle" x="10802.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="10802.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="10802.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu0&#45;&gt;l1_mha_qkv_gpu0 -->
<g id="edge34" class="edge">
<title>l0_res2_gpu0&#45;&gt;l1_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M3884.97,-1304.11C4403.73,-1297.47 5755,-1280.96 6883.57,-1273.95 6909.41,-1273.79 10579.29,-1271.32 10604.57,-1265.95 10656.47,-1254.94 10711.35,-1229.46 10750.13,-1208.82"/>
<polygon fill="black" stroke="black" points="10752,-1211.79 10759.14,-1203.96 10748.67,-1205.63 10752,-1211.79"/>
</g>
<!-- l1_res_add_gpu0 -->
<g id="node515" class="node">
<title>l1_res_add_gpu0</title>
<ellipse fill="none" stroke="black" cx="8565.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8565.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu0</text>
</g>
<!-- l0_res2_gpu0&#45;&gt;l1_res_add_gpu0 -->
<g id="edge39" class="edge">
<title>l0_res2_gpu0&#45;&gt;l1_res_add_gpu0</title>
<path fill="none" stroke="black" d="M3884.75,-1301.26C4742.56,-1278.75 7876.97,-1196.52 8468.81,-1180.99"/>
<polygon fill="black" stroke="black" points="8469.1,-1184.49 8479.01,-1180.72 8468.92,-1177.49 8469.1,-1184.49"/>
</g>
<!-- l0_mha_attn_gpu1 -->
<g id="node19" class="node">
<title>l0_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12333.57,-2273.95 11861.57,-2273.95 11861.57,-2205.95 12333.57,-2205.95 12333.57,-2273.95"/>
<text text-anchor="middle" x="12097.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="12097.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="12097.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="12097.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu1&#45;&gt;l0_mha_attn_gpu1 -->
<g id="edge68" class="edge">
<title>l0_mha_qkv_gpu1&#45;&gt;l0_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M12209.67,-2309.84C12193.94,-2300.17 12176.6,-2289.52 12160.37,-2279.54"/>
<polygon fill="black" stroke="black" points="12161.83,-2276.33 12151.48,-2274.08 12158.17,-2282.3 12161.83,-2276.33"/>
</g>
<!-- l0_mha_out_gpu1 -->
<g id="node20" class="node">
<title>l0_mha_out_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12161.57,-2169.95 11701.57,-2169.95 11701.57,-2101.95 12161.57,-2101.95 12161.57,-2169.95"/>
<text text-anchor="middle" x="11931.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11931.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11931.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="11931.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu1&#45;&gt;l0_mha_out_gpu1 -->
<g id="edge69" class="edge">
<title>l0_mha_attn_gpu1&#45;&gt;l0_mha_out_gpu1</title>
<path fill="none" stroke="black" d="M12043.67,-2205.84C12027.94,-2196.17 12010.6,-2185.52 11994.37,-2175.54"/>
<polygon fill="black" stroke="black" points="11995.83,-2172.33 11985.48,-2170.08 11992.17,-2178.3 11995.83,-2172.33"/>
</g>
<!-- l0_mha_allreduce_gpu1 -->
<g id="node21" class="node">
<title>l0_mha_allreduce_gpu1</title>
<polygon fill="yellow" stroke="black" points="12049.47,-2065.95 11333.78,-2065.95 11149.67,-1929.95 11865.36,-1929.95 12049.47,-2065.95"/>
<text text-anchor="middle" x="11599.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11599.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11599.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="11599.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu1&#45;&gt;l0_mha_allreduce_gpu1 -->
<g id="edge70" class="edge">
<title>l0_mha_out_gpu1&#45;&gt;l0_mha_allreduce_gpu1</title>
<path fill="none" stroke="black" d="M11850.78,-2101.86C11826.89,-2092.07 11799.78,-2080.97 11772.42,-2069.76"/>
<polygon fill="black" stroke="black" points="11773.72,-2066.51 11763.14,-2065.96 11771.06,-2072.99 11773.72,-2066.51"/>
</g>
<!-- l0_mha_allreduce_gpu1&#45;&gt;l0_res_add_gpu1 -->
<g id="edge71" class="edge">
<title>l0_mha_allreduce_gpu1&#45;&gt;l0_res_add_gpu1</title>
<path fill="none" stroke="black" d="M11214.45,-1977.81C10895.22,-1962.62 10429.5,-1941.99 10022.57,-1929.95 8530.23,-1885.82 6734.41,-1867.88 6109.78,-1862.68"/>
<polygon fill="black" stroke="black" points="6109.79,-1859.18 6099.76,-1862.6 6109.74,-1866.18 6109.79,-1859.18"/>
</g>
<!-- l0_expert_8_gpu1 -->
<g id="node23" class="node">
<title>l0_expert_8_gpu1</title>
<polygon fill="lightpink" stroke="black" points="4129.57,-1617.95 3695.57,-1617.95 3695.57,-1549.95 4129.57,-1549.95 4129.57,-1617.95"/>
<text text-anchor="middle" x="3912.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3912.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3912.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="3912.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_8_gpu1 -->
<g id="edge75" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_8_gpu1</title>
<path fill="none" stroke="black" d="M5665.31,-1855.44C5335.55,-1848.85 4724.37,-1831.37 4509.57,-1789.95 4320.39,-1753.47 4109.49,-1670.42 3995.92,-1621.96"/>
<polygon fill="black" stroke="black" points="3997.15,-1618.68 3986.58,-1617.96 3994.39,-1625.11 3997.15,-1618.68"/>
</g>
<!-- l0_expert_9_gpu1 -->
<g id="node24" class="node">
<title>l0_expert_9_gpu1</title>
<polygon fill="lightpink" stroke="black" points="4581.57,-1617.95 4147.57,-1617.95 4147.57,-1549.95 4581.57,-1549.95 4581.57,-1617.95"/>
<text text-anchor="middle" x="4364.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4364.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4364.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4364.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_9_gpu1 -->
<g id="edge78" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_9_gpu1</title>
<path fill="none" stroke="black" d="M5665.4,-1851.43C5419.44,-1841.56 5034.44,-1821.67 4892.57,-1789.95 4724.83,-1752.45 4540,-1670.59 4439.62,-1622.43"/>
<polygon fill="black" stroke="black" points="4440.99,-1619.21 4430.46,-1618.02 4437.95,-1625.51 4440.99,-1619.21"/>
</g>
<!-- l0_expert_10_gpu1 -->
<g id="node25" class="node">
<title>l0_expert_10_gpu1</title>
<polygon fill="lightpink" stroke="black" points="5033.57,-1617.95 4599.57,-1617.95 4599.57,-1549.95 5033.57,-1549.95 5033.57,-1617.95"/>
<text text-anchor="middle" x="4816.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4816.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4816.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="4816.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_10_gpu1 -->
<g id="edge81" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_10_gpu1</title>
<path fill="none" stroke="black" d="M5665.52,-1851.65C5474.94,-1843.01 5213.3,-1825.12 5115.57,-1789.95 5013.97,-1753.4 4914.26,-1673.77 4859.54,-1625.22"/>
<polygon fill="black" stroke="black" points="4861.58,-1622.35 4851.79,-1618.29 4856.91,-1627.56 4861.58,-1622.35"/>
</g>
<!-- l0_expert_11_gpu1 -->
<g id="node26" class="node">
<title>l0_expert_11_gpu1</title>
<polygon fill="lightpink" stroke="black" points="5485.57,-1617.95 5051.57,-1617.95 5051.57,-1549.95 5485.57,-1549.95 5485.57,-1617.95"/>
<text text-anchor="middle" x="5268.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="5268.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5268.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5268.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_11_gpu1 -->
<g id="edge84" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_11_gpu1</title>
<path fill="none" stroke="black" d="M5665.42,-1853.21C5460.73,-1845.49 5180.26,-1828.05 5145.57,-1789.95 5104.87,-1745.26 5115.02,-1706.11 5145.57,-1653.95 5152.49,-1642.14 5162.25,-1632.19 5173.29,-1623.86"/>
<polygon fill="black" stroke="black" points="5175.36,-1626.69 5181.53,-1618.08 5171.34,-1620.96 5175.36,-1626.69"/>
</g>
<!-- l0_expert_12_gpu1 -->
<g id="node27" class="node">
<title>l0_expert_12_gpu1</title>
<polygon fill="lightpink" stroke="black" points="5937.57,-1617.95 5503.57,-1617.95 5503.57,-1549.95 5937.57,-1549.95 5937.57,-1617.95"/>
<text text-anchor="middle" x="5720.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5720.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5720.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5720.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_12_gpu1 -->
<g id="edge87" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_12_gpu1</title>
<path fill="none" stroke="black" d="M6044.82,-1825.86C6077.59,-1815.87 6105.22,-1803.81 6115.57,-1789.95 6151.74,-1741.52 6154.46,-1700.23 6115.57,-1653.95 6109.27,-1646.46 6032.16,-1632.22 5947.73,-1618.61"/>
<polygon fill="black" stroke="black" points="5948.1,-1615.12 5937.67,-1617 5946.99,-1622.04 5948.1,-1615.12"/>
</g>
<!-- l0_expert_13_gpu1 -->
<g id="node28" class="node">
<title>l0_expert_13_gpu1</title>
<polygon fill="lightpink" stroke="black" points="6389.57,-1617.95 5955.57,-1617.95 5955.57,-1549.95 6389.57,-1549.95 6389.57,-1617.95"/>
<text text-anchor="middle" x="6172.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6172.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6172.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6172.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_13_gpu1 -->
<g id="edge90" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_13_gpu1</title>
<path fill="none" stroke="black" d="M6066.12,-1825.93C6101.84,-1816.06 6132.1,-1804.04 6144.57,-1789.95 6183.63,-1745.82 6184.12,-1674.04 6179.44,-1628.18"/>
<polygon fill="black" stroke="black" points="6182.92,-1627.79 6178.3,-1618.25 6175.96,-1628.58 6182.92,-1627.79"/>
</g>
<!-- l0_expert_14_gpu1 -->
<g id="node29" class="node">
<title>l0_expert_14_gpu1</title>
<polygon fill="lightpink" stroke="black" points="6841.57,-1617.95 6407.57,-1617.95 6407.57,-1549.95 6841.57,-1549.95 6841.57,-1617.95"/>
<text text-anchor="middle" x="6624.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6624.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6624.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="6624.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_14_gpu1 -->
<g id="edge93" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_14_gpu1</title>
<path fill="none" stroke="black" d="M6049.99,-1825.93C6092.11,-1815.95 6136.89,-1803.88 6177.57,-1789.95 6315.06,-1742.88 6467.35,-1667.77 6553.96,-1622.72"/>
<polygon fill="black" stroke="black" points="6555.66,-1625.78 6562.9,-1618.05 6552.42,-1619.57 6555.66,-1625.78"/>
</g>
<!-- l0_expert_15_gpu1 -->
<g id="node30" class="node">
<title>l0_expert_15_gpu1</title>
<polygon fill="lightpink" stroke="black" points="7293.57,-1617.95 6859.57,-1617.95 6859.57,-1549.95 7293.57,-1549.95 7293.57,-1617.95"/>
<text text-anchor="middle" x="7076.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="7076.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7076.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7076.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_expert_15_gpu1 -->
<g id="edge96" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_expert_15_gpu1</title>
<path fill="none" stroke="black" d="M6099.77,-1832.54C6178.24,-1821.46 6267.26,-1807.13 6347.57,-1789.95 6569.23,-1742.54 6822.98,-1666.01 6965.06,-1621.08"/>
<polygon fill="black" stroke="black" points="6966.2,-1624.39 6974.67,-1618.04 6964.08,-1617.72 6966.2,-1624.39"/>
</g>
<!-- l0_gate_gpu1 -->
<g id="node31" class="node">
<title>l0_gate_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="6106.31,-1789.95 5349.51,-1789.95 5154.83,-1653.95 5911.62,-1653.95 6106.31,-1789.95"/>
<text text-anchor="middle" x="5630.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5630.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5630.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5630.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_gate_gpu1 -->
<g id="edge73" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_gate_gpu1</title>
<path fill="none" stroke="black" d="M5821.24,-1825.86C5803.67,-1816.37 5783.79,-1805.64 5763.66,-1794.78"/>
<polygon fill="black" stroke="black" points="5765.18,-1791.63 5754.72,-1789.96 5761.86,-1797.79 5765.18,-1791.63"/>
</g>
<!-- l0_res2_gpu1 -->
<g id="node33" class="node">
<title>l0_res2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="7326.57,-1341.95 6892.57,-1341.95 6892.57,-1273.95 7326.57,-1273.95 7326.57,-1341.95"/>
<text text-anchor="middle" x="7109.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7109.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7109.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7109.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu1&#45;&gt;l0_res2_gpu1 -->
<g id="edge99" class="edge">
<title>l0_res_add_gpu1&#45;&gt;l0_res2_gpu1</title>
<path fill="none" stroke="black" d="M5665.25,-1855.21C5218.96,-1846.86 4228.32,-1824.66 4077.57,-1789.95 3878.86,-1744.2 3550.44,-1701.76 3686.57,-1549.95 3921.63,-1287.83 4910.43,-1403.65 5261.57,-1377.95 5844.59,-1335.29 6533.12,-1318.41 6882.14,-1312.22"/>
<polygon fill="black" stroke="black" points="6882.43,-1315.71 6892.36,-1312.04 6882.3,-1308.71 6882.43,-1315.71"/>
</g>
<!-- l0_expert_agg_gpu1 -->
<g id="node32" class="node">
<title>l0_expert_agg_gpu1</title>
<polygon fill="yellow" stroke="black" points="6170.47,-1513.95 5454.78,-1513.95 5270.67,-1377.95 5986.36,-1377.95 6170.47,-1513.95"/>
<text text-anchor="middle" x="5720.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5720.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5720.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="5720.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_8_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge76" class="edge">
<title>l0_expert_8_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M4129.64,-1550.92C4132.63,-1550.59 4135.61,-1550.27 4138.57,-1549.95 4562.17,-1505.31 5051.75,-1477 5372.74,-1461.59"/>
<polygon fill="black" stroke="black" points="5373.31,-1465.07 5383.14,-1461.1 5372.98,-1458.08 5373.31,-1465.07"/>
</g>
<!-- l0_expert_9_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge79" class="edge">
<title>l0_expert_9_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M4581.65,-1551.03C4584.64,-1550.66 4587.62,-1550.3 4590.57,-1549.95 4858.02,-1518.26 5162.1,-1491.04 5387.4,-1472.56"/>
<polygon fill="black" stroke="black" points="5387.71,-1476.04 5397.39,-1471.74 5387.14,-1469.07 5387.71,-1476.04"/>
</g>
<!-- l0_expert_10_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge82" class="edge">
<title>l0_expert_10_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5033.67,-1550.29C5147.61,-1533.15 5289.11,-1511.86 5414.02,-1493.07"/>
<polygon fill="black" stroke="black" points="5414.77,-1496.5 5424.13,-1491.55 5413.73,-1489.58 5414.77,-1496.5"/>
</g>
<!-- l0_expert_11_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge85" class="edge">
<title>l0_expert_11_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5378.27,-1549.94C5411.64,-1539.91 5449.64,-1528.47 5487.91,-1516.96"/>
<polygon fill="black" stroke="black" points="5489.07,-1520.26 5497.64,-1514.03 5487.06,-1513.56 5489.07,-1520.26"/>
</g>
<!-- l0_expert_12_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge88" class="edge">
<title>l0_expert_12_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5720.57,-1549.68C5720.57,-1541.86 5720.57,-1533.19 5720.57,-1524.31"/>
<polygon fill="black" stroke="black" points="5724.07,-1524.22 5720.57,-1514.22 5717.07,-1524.22 5724.07,-1524.22"/>
</g>
<!-- l0_expert_13_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge91" class="edge">
<title>l0_expert_13_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6062.86,-1549.94C6029.5,-1539.91 5991.49,-1528.47 5953.23,-1516.96"/>
<polygon fill="black" stroke="black" points="5954.08,-1513.56 5943.5,-1514.03 5952.07,-1520.26 5954.08,-1513.56"/>
</g>
<!-- l0_expert_14_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge94" class="edge">
<title>l0_expert_14_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6407.46,-1550.29C6337.45,-1539.76 6257.03,-1527.66 6176.44,-1515.54"/>
<polygon fill="black" stroke="black" points="6176.51,-1512.01 6166.1,-1513.98 6175.47,-1518.93 6176.51,-1512.01"/>
</g>
<!-- l0_expert_15_gpu1&#45;&gt;l0_expert_agg_gpu1 -->
<g id="edge97" class="edge">
<title>l0_expert_15_gpu1&#45;&gt;l0_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6859.49,-1551.03C6856.5,-1550.66 6853.52,-1550.3 6850.57,-1549.95 6613.11,-1521.82 6346.78,-1497.2 6132.35,-1479.1"/>
<polygon fill="black" stroke="black" points="6132.43,-1475.6 6122.17,-1478.24 6131.85,-1482.57 6132.43,-1475.6"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_8_gpu1 -->
<g id="edge74" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_8_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5222.18,-1701.15C4924.62,-1684.7 4511.73,-1657.7 4139.8,-1618.06"/>
<polygon fill="black" stroke="black" points="4139.96,-1614.56 4129.64,-1616.97 4139.21,-1621.52 4139.96,-1614.56"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_9_gpu1 -->
<g id="edge77" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_9_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5195.54,-1682.39C5012.05,-1664.98 4795.98,-1642.96 4591.68,-1618.07"/>
<polygon fill="black" stroke="black" points="4592,-1614.59 4581.65,-1616.85 4591.16,-1621.54 4592,-1614.59"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_10_gpu1 -->
<g id="edge80" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_10_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5229.53,-1653.95C5158.49,-1642.08 5087.2,-1630.17 5024.34,-1619.67"/>
<polygon fill="black" stroke="black" points="5024.76,-1616.19 5014.32,-1617.99 5023.61,-1623.09 5024.76,-1616.19"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_11_gpu1 -->
<g id="edge83" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_11_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5452.22,-1653.95C5422.66,-1642.84 5393,-1631.7 5366.4,-1621.71"/>
<polygon fill="black" stroke="black" points="5367.34,-1618.32 5356.75,-1618.08 5364.88,-1624.87 5367.34,-1618.32"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_12_gpu1 -->
<g id="edge86" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_12_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5675.04,-1653.75C5681.22,-1644.41 5687.41,-1635.06 5693.15,-1626.39"/>
<polygon fill="black" stroke="black" points="5696.12,-1628.24 5698.72,-1617.97 5690.28,-1624.38 5696.12,-1628.24"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_13_gpu1 -->
<g id="edge89" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_13_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5897.6,-1653.95C5943.73,-1642.37 5990.02,-1630.76 6031.12,-1620.45"/>
<polygon fill="black" stroke="black" points="6032.05,-1623.82 6040.9,-1617.99 6030.34,-1617.03 6032.05,-1623.82"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_14_gpu1 -->
<g id="edge92" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_14_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5948.29,-1679.19C6083.69,-1661.18 6243.65,-1639.61 6397.35,-1618.12"/>
<polygon fill="black" stroke="black" points="6398.05,-1621.56 6407.46,-1616.7 6397.08,-1614.62 6398.05,-1621.56"/>
</g>
<!-- l0_gate_gpu1&#45;&gt;l0_expert_15_gpu1 -->
<g id="edge95" class="edge">
<title>l0_gate_gpu1&#45;&gt;l0_expert_15_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5974.25,-1697.54C6216.24,-1679.7 6547.92,-1652.54 6849.24,-1618.09"/>
<polygon fill="black" stroke="black" points="6849.95,-1621.53 6859.49,-1616.91 6849.16,-1614.57 6849.95,-1621.53"/>
</g>
<!-- l0_expert_agg_gpu1&#45;&gt;l0_res2_gpu1 -->
<g id="edge98" class="edge">
<title>l0_expert_agg_gpu1&#45;&gt;l0_res2_gpu1</title>
<path fill="none" stroke="black" d="M6035.75,-1414.09C6293.56,-1388.85 6651.95,-1353.76 6882.36,-1331.2"/>
<polygon fill="black" stroke="black" points="6882.94,-1334.66 6892.55,-1330.2 6882.25,-1327.69 6882.94,-1334.66"/>
</g>
<!-- l1_mha_qkv_gpu1 -->
<g id="node146" class="node">
<title>l1_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11838.57,-1203.95 11668.57,-1203.95 11668.57,-1150.95 11838.57,-1150.95 11838.57,-1203.95"/>
<text text-anchor="middle" x="11753.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="11753.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11753.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu1&#45;&gt;l1_mha_qkv_gpu1 -->
<g id="edge100" class="edge">
<title>l0_res2_gpu1&#45;&gt;l1_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M7326.82,-1301.31C7637.06,-1293.52 8224.88,-1279.78 8725.57,-1273.95 8764.22,-1273.5 11470.49,-1272.61 11508.57,-1265.95 11572.18,-1254.84 11641.15,-1228.85 11689.66,-1208.06"/>
<polygon fill="black" stroke="black" points="11691.3,-1211.17 11699.08,-1203.98 11688.51,-1204.75 11691.3,-1211.17"/>
</g>
<!-- l1_res_add_gpu1 -->
<g id="node516" class="node">
<title>l1_res_add_gpu1</title>
<ellipse fill="none" stroke="black" cx="8758.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8758.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu1</text>
</g>
<!-- l0_res2_gpu1&#45;&gt;l1_res_add_gpu1 -->
<g id="edge105" class="edge">
<title>l0_res2_gpu1&#45;&gt;l1_res_add_gpu1</title>
<path fill="none" stroke="black" d="M7326.85,-1305.21C7739.66,-1301.35 8601.84,-1290.4 8662.57,-1265.95 8694.52,-1253.09 8722.51,-1224.43 8739.9,-1203.4"/>
<polygon fill="black" stroke="black" points="8742.73,-1205.48 8746.25,-1195.49 8737.26,-1201.1 8742.73,-1205.48"/>
</g>
<!-- l0_mha_attn_gpu2 -->
<g id="node35" class="node">
<title>l0_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13872.57,-2273.95 13400.57,-2273.95 13400.57,-2205.95 13872.57,-2205.95 13872.57,-2273.95"/>
<text text-anchor="middle" x="13636.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13636.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13636.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="13636.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu2&#45;&gt;l0_mha_attn_gpu2 -->
<g id="edge134" class="edge">
<title>l0_mha_qkv_gpu2&#45;&gt;l0_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M13708.83,-2309.84C13699.3,-2300.75 13688.86,-2290.8 13678.95,-2281.35"/>
<polygon fill="black" stroke="black" points="13681.15,-2278.62 13671.5,-2274.25 13676.32,-2283.69 13681.15,-2278.62"/>
</g>
<!-- l0_mha_out_gpu2 -->
<g id="node36" class="node">
<title>l0_mha_out_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13813.57,-2169.95 13353.57,-2169.95 13353.57,-2101.95 13813.57,-2101.95 13813.57,-2169.95"/>
<text text-anchor="middle" x="13583.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13583.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13583.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="13583.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu2&#45;&gt;l0_mha_out_gpu2 -->
<g id="edge135" class="edge">
<title>l0_mha_attn_gpu2&#45;&gt;l0_mha_out_gpu2</title>
<path fill="none" stroke="black" d="M13619.36,-2205.84C13614.96,-2197.37 13610.18,-2188.16 13605.57,-2179.31"/>
<polygon fill="black" stroke="black" points="13608.59,-2177.51 13600.87,-2170.25 13602.38,-2180.74 13608.59,-2177.51"/>
</g>
<!-- l0_mha_allreduce_gpu2 -->
<g id="node37" class="node">
<title>l0_mha_allreduce_gpu2</title>
<polygon fill="yellow" stroke="black" points="13840.47,-2065.95 13124.78,-2065.95 12940.67,-1929.95 13656.36,-1929.95 13840.47,-2065.95"/>
<text text-anchor="middle" x="13390.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="13390.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13390.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="13390.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu2&#45;&gt;l0_mha_allreduce_gpu2 -->
<g id="edge136" class="edge">
<title>l0_mha_out_gpu2&#45;&gt;l0_mha_allreduce_gpu2</title>
<path fill="none" stroke="black" d="M13536.36,-2101.68C13523.46,-2092.59 13508.95,-2082.37 13494.22,-2071.99"/>
<polygon fill="black" stroke="black" points="13496.21,-2069.12 13486.02,-2066.22 13492.18,-2074.84 13496.21,-2069.12"/>
</g>
<!-- l0_mha_allreduce_gpu2&#45;&gt;l0_res_add_gpu2 -->
<g id="edge137" class="edge">
<title>l0_mha_allreduce_gpu2&#45;&gt;l0_res_add_gpu2</title>
<path fill="none" stroke="black" d="M12973.49,-1954.29C12867.6,-1944.83 12753.98,-1935.87 12648.57,-1929.95 11569.86,-1869.36 10278.03,-1861.33 9763.84,-1860.71"/>
<polygon fill="black" stroke="black" points="9763.71,-1857.21 9753.71,-1860.7 9763.7,-1864.21 9763.71,-1857.21"/>
</g>
<!-- l0_expert_16_gpu2 -->
<g id="node39" class="node">
<title>l0_expert_16_gpu2</title>
<polygon fill="lightpink" stroke="black" points="7783.57,-1617.95 7349.57,-1617.95 7349.57,-1549.95 7783.57,-1549.95 7783.57,-1617.95"/>
<text text-anchor="middle" x="7566.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="7566.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7566.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="7566.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_16_gpu2 -->
<g id="edge141" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_16_gpu2</title>
<path fill="none" stroke="black" d="M9319.31,-1855.44C8989.55,-1848.85 8378.37,-1831.37 8163.57,-1789.95 7974.39,-1753.47 7763.49,-1670.42 7649.92,-1621.96"/>
<polygon fill="black" stroke="black" points="7651.15,-1618.68 7640.58,-1617.96 7648.39,-1625.11 7651.15,-1618.68"/>
</g>
<!-- l0_expert_17_gpu2 -->
<g id="node40" class="node">
<title>l0_expert_17_gpu2</title>
<polygon fill="lightpink" stroke="black" points="8235.57,-1617.95 7801.57,-1617.95 7801.57,-1549.95 8235.57,-1549.95 8235.57,-1617.95"/>
<text text-anchor="middle" x="8018.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="8018.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8018.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8018.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_17_gpu2 -->
<g id="edge144" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_17_gpu2</title>
<path fill="none" stroke="black" d="M9319.4,-1851.43C9073.44,-1841.56 8688.44,-1821.67 8546.57,-1789.95 8378.83,-1752.45 8194,-1670.59 8093.62,-1622.43"/>
<polygon fill="black" stroke="black" points="8094.99,-1619.21 8084.46,-1618.02 8091.95,-1625.51 8094.99,-1619.21"/>
</g>
<!-- l0_expert_18_gpu2 -->
<g id="node41" class="node">
<title>l0_expert_18_gpu2</title>
<polygon fill="lightpink" stroke="black" points="8687.57,-1617.95 8253.57,-1617.95 8253.57,-1549.95 8687.57,-1549.95 8687.57,-1617.95"/>
<text text-anchor="middle" x="8470.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="8470.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8470.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8470.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_18_gpu2 -->
<g id="edge147" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_18_gpu2</title>
<path fill="none" stroke="black" d="M9319.52,-1851.65C9128.94,-1843.01 8867.3,-1825.12 8769.57,-1789.95 8667.97,-1753.4 8568.26,-1673.77 8513.54,-1625.22"/>
<polygon fill="black" stroke="black" points="8515.58,-1622.35 8505.79,-1618.29 8510.91,-1627.56 8515.58,-1622.35"/>
</g>
<!-- l0_expert_19_gpu2 -->
<g id="node42" class="node">
<title>l0_expert_19_gpu2</title>
<polygon fill="lightpink" stroke="black" points="9139.57,-1617.95 8705.57,-1617.95 8705.57,-1549.95 9139.57,-1549.95 9139.57,-1617.95"/>
<text text-anchor="middle" x="8922.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="8922.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8922.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8922.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_19_gpu2 -->
<g id="edge150" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_19_gpu2</title>
<path fill="none" stroke="black" d="M9319.42,-1853.21C9114.73,-1845.49 8834.26,-1828.05 8799.57,-1789.95 8758.87,-1745.26 8769.02,-1706.11 8799.57,-1653.95 8806.49,-1642.14 8816.25,-1632.19 8827.29,-1623.86"/>
<polygon fill="black" stroke="black" points="8829.36,-1626.69 8835.53,-1618.08 8825.34,-1620.96 8829.36,-1626.69"/>
</g>
<!-- l0_expert_20_gpu2 -->
<g id="node43" class="node">
<title>l0_expert_20_gpu2</title>
<polygon fill="lightpink" stroke="black" points="9591.57,-1617.95 9157.57,-1617.95 9157.57,-1549.95 9591.57,-1549.95 9591.57,-1617.95"/>
<text text-anchor="middle" x="9374.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="9374.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9374.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9374.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_20_gpu2 -->
<g id="edge153" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_20_gpu2</title>
<path fill="none" stroke="black" d="M9698.82,-1825.86C9731.59,-1815.87 9759.22,-1803.81 9769.57,-1789.95 9805.74,-1741.52 9808.46,-1700.23 9769.57,-1653.95 9763.27,-1646.46 9686.16,-1632.22 9601.73,-1618.61"/>
<polygon fill="black" stroke="black" points="9602.1,-1615.12 9591.67,-1617 9600.99,-1622.04 9602.1,-1615.12"/>
</g>
<!-- l0_expert_21_gpu2 -->
<g id="node44" class="node">
<title>l0_expert_21_gpu2</title>
<polygon fill="lightpink" stroke="black" points="10043.57,-1617.95 9609.57,-1617.95 9609.57,-1549.95 10043.57,-1549.95 10043.57,-1617.95"/>
<text text-anchor="middle" x="9826.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="9826.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9826.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9826.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_21_gpu2 -->
<g id="edge156" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_21_gpu2</title>
<path fill="none" stroke="black" d="M9719.04,-1825.92C9754.77,-1816.04 9785.08,-1804.01 9797.57,-1789.95 9836.66,-1745.95 9837.61,-1674.37 9833.22,-1628.49"/>
<polygon fill="black" stroke="black" points="9836.66,-1627.83 9832.11,-1618.26 9829.7,-1628.58 9836.66,-1627.83"/>
</g>
<!-- l0_expert_22_gpu2 -->
<g id="node45" class="node">
<title>l0_expert_22_gpu2</title>
<polygon fill="lightpink" stroke="black" points="10495.57,-1617.95 10061.57,-1617.95 10061.57,-1549.95 10495.57,-1549.95 10495.57,-1617.95"/>
<text text-anchor="middle" x="10278.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="10278.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="10278.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10278.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_22_gpu2 -->
<g id="edge159" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_22_gpu2</title>
<path fill="none" stroke="black" d="M9702.45,-1825.89C9744.39,-1815.9 9789.03,-1803.83 9829.57,-1789.95 9967.58,-1742.71 10120.58,-1667.66 10207.61,-1622.66"/>
<polygon fill="black" stroke="black" points="10209.33,-1625.71 10216.6,-1618 10206.11,-1619.5 10209.33,-1625.71"/>
</g>
<!-- l0_expert_23_gpu2 -->
<g id="node46" class="node">
<title>l0_expert_23_gpu2</title>
<polygon fill="lightpink" stroke="black" points="10947.57,-1617.95 10513.57,-1617.95 10513.57,-1549.95 10947.57,-1549.95 10947.57,-1617.95"/>
<text text-anchor="middle" x="10730.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="10730.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="10730.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="10730.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_expert_23_gpu2 -->
<g id="edge162" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_expert_23_gpu2</title>
<path fill="none" stroke="black" d="M9753.7,-1832.33C9831.62,-1821.27 9919.9,-1806.99 9999.57,-1789.95 10221.79,-1742.43 10476.26,-1665.93 10618.74,-1621.05"/>
<polygon fill="black" stroke="black" points="10619.9,-1624.35 10628.38,-1618 10617.79,-1617.68 10619.9,-1624.35"/>
</g>
<!-- l0_gate_gpu2 -->
<g id="node47" class="node">
<title>l0_gate_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="9760.31,-1789.95 9003.51,-1789.95 8808.83,-1653.95 9565.62,-1653.95 9760.31,-1789.95"/>
<text text-anchor="middle" x="9284.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9284.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9284.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="9284.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_gate_gpu2 -->
<g id="edge139" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_gate_gpu2</title>
<path fill="none" stroke="black" d="M9475.24,-1825.86C9457.67,-1816.37 9437.79,-1805.64 9417.66,-1794.78"/>
<polygon fill="black" stroke="black" points="9419.18,-1791.63 9408.72,-1789.96 9415.86,-1797.79 9419.18,-1791.63"/>
</g>
<!-- l0_res2_gpu2 -->
<g id="node49" class="node">
<title>l0_res2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="9168.57,-1341.95 8734.57,-1341.95 8734.57,-1273.95 9168.57,-1273.95 9168.57,-1341.95"/>
<text text-anchor="middle" x="8951.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8951.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8951.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8951.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu2&#45;&gt;l0_res2_gpu2 -->
<g id="edge165" class="edge">
<title>l0_res_add_gpu2&#45;&gt;l0_res2_gpu2</title>
<path fill="none" stroke="black" d="M9319.25,-1855.21C8872.96,-1846.86 7882.32,-1824.66 7731.57,-1789.95 7546.56,-1747.35 7444.32,-1776.94 7340.57,-1617.95 7185.74,-1380.7 8244.61,-1325.59 8724.19,-1312.8"/>
<polygon fill="black" stroke="black" points="8724.45,-1316.3 8734.36,-1312.54 8724.27,-1309.3 8724.45,-1316.3"/>
</g>
<!-- l0_expert_agg_gpu2 -->
<g id="node48" class="node">
<title>l0_expert_agg_gpu2</title>
<polygon fill="yellow" stroke="black" points="9401.47,-1513.95 8685.78,-1513.95 8501.67,-1377.95 9217.36,-1377.95 9401.47,-1513.95"/>
<text text-anchor="middle" x="8951.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8951.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8951.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="8951.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_16_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge142" class="edge">
<title>l0_expert_16_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7783.65,-1551.02C7786.64,-1550.65 7789.61,-1550.3 7792.57,-1549.95 8069.71,-1517.43 8385.21,-1490.02 8616.99,-1471.67"/>
<polygon fill="black" stroke="black" points="8617.58,-1475.13 8627.27,-1470.86 8617.03,-1468.15 8617.58,-1475.13"/>
</g>
<!-- l0_expert_17_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge145" class="edge">
<title>l0_expert_17_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8235.68,-1551.25C8238.66,-1550.81 8241.63,-1550.38 8244.57,-1549.95 8375.28,-1530.89 8519.58,-1509.86 8643.55,-1491.81"/>
<polygon fill="black" stroke="black" points="8644.18,-1495.25 8653.58,-1490.34 8643.18,-1488.32 8644.18,-1495.25"/>
</g>
<!-- l0_expert_18_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge148" class="edge">
<title>l0_expert_18_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8587.31,-1549.94C8622.96,-1539.86 8663.61,-1528.37 8704.5,-1516.81"/>
<polygon fill="black" stroke="black" points="8705.67,-1520.12 8714.34,-1514.03 8703.76,-1513.38 8705.67,-1520.12"/>
</g>
<!-- l0_expert_19_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge151" class="edge">
<title>l0_expert_19_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M8929.66,-1549.68C8931.35,-1541.77 8933.22,-1533 8935.14,-1524.02"/>
<polygon fill="black" stroke="black" points="8938.56,-1524.73 8937.23,-1514.22 8931.72,-1523.27 8938.56,-1524.73"/>
</g>
<!-- l0_expert_20_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge154" class="edge">
<title>l0_expert_20_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9271.9,-1549.94C9240.81,-1539.95 9205.41,-1528.57 9169.76,-1517.1"/>
<polygon fill="black" stroke="black" points="9170.79,-1513.76 9160.19,-1514.03 9168.64,-1520.42 9170.79,-1513.76"/>
</g>
<!-- l0_expert_21_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge157" class="edge">
<title>l0_expert_21_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9614.2,-1549.94C9546.89,-1539.48 9469.82,-1527.5 9392.6,-1515.5"/>
<polygon fill="black" stroke="black" points="9393.11,-1512.04 9382.69,-1513.96 9392.03,-1518.96 9393.11,-1512.04"/>
</g>
<!-- l0_expert_22_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge160" class="edge">
<title>l0_expert_22_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10061.49,-1551.04C10058.5,-1550.67 10055.52,-1550.31 10052.57,-1549.95 9825.75,-1522.8 9571.93,-1498.64 9365.2,-1480.55"/>
<polygon fill="black" stroke="black" points="9365.35,-1477.05 9355.08,-1479.67 9364.74,-1484.02 9365.35,-1477.05"/>
</g>
<!-- l0_expert_23_gpu2&#45;&gt;l0_expert_agg_gpu2 -->
<g id="edge163" class="edge">
<title>l0_expert_23_gpu2&#45;&gt;l0_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10513.5,-1550.92C10510.5,-1550.59 10507.53,-1550.27 10504.57,-1549.95 10110.66,-1508.2 9658.63,-1480.49 9344.22,-1464.43"/>
<polygon fill="black" stroke="black" points="9344.19,-1460.93 9334.02,-1463.91 9343.83,-1467.92 9344.19,-1460.93"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_16_gpu2 -->
<g id="edge140" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_16_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8876.18,-1701.15C8578.62,-1684.7 8165.73,-1657.7 7793.8,-1618.06"/>
<polygon fill="black" stroke="black" points="7793.96,-1614.56 7783.64,-1616.97 7793.21,-1621.52 7793.96,-1614.56"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_17_gpu2 -->
<g id="edge143" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_17_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8849.54,-1682.39C8666.05,-1664.98 8449.98,-1642.96 8245.68,-1618.07"/>
<polygon fill="black" stroke="black" points="8246,-1614.59 8235.65,-1616.85 8245.16,-1621.54 8246,-1614.59"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_18_gpu2 -->
<g id="edge146" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_18_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8883.53,-1653.95C8812.49,-1642.08 8741.2,-1630.17 8678.34,-1619.67"/>
<polygon fill="black" stroke="black" points="8678.76,-1616.19 8668.32,-1617.99 8677.61,-1623.09 8678.76,-1616.19"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_19_gpu2 -->
<g id="edge149" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_19_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9106.22,-1653.95C9076.66,-1642.84 9047,-1631.7 9020.4,-1621.71"/>
<polygon fill="black" stroke="black" points="9021.34,-1618.32 9010.75,-1618.08 9018.88,-1624.87 9021.34,-1618.32"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_20_gpu2 -->
<g id="edge152" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_20_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9329.04,-1653.75C9335.22,-1644.41 9341.41,-1635.06 9347.15,-1626.39"/>
<polygon fill="black" stroke="black" points="9350.12,-1628.24 9352.72,-1617.97 9344.28,-1624.38 9350.12,-1628.24"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_21_gpu2 -->
<g id="edge155" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_21_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9551.6,-1653.95C9597.73,-1642.37 9644.02,-1630.76 9685.12,-1620.45"/>
<polygon fill="black" stroke="black" points="9686.05,-1623.82 9694.9,-1617.99 9684.34,-1617.03 9686.05,-1623.82"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_22_gpu2 -->
<g id="edge158" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_22_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9602.29,-1679.19C9737.69,-1661.18 9897.65,-1639.61 10051.35,-1618.12"/>
<polygon fill="black" stroke="black" points="10052.05,-1621.56 10061.46,-1616.7 10051.08,-1614.62 10052.05,-1621.56"/>
</g>
<!-- l0_gate_gpu2&#45;&gt;l0_expert_23_gpu2 -->
<g id="edge161" class="edge">
<title>l0_gate_gpu2&#45;&gt;l0_expert_23_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9628.25,-1697.54C9870.24,-1679.7 10201.92,-1652.54 10503.24,-1618.09"/>
<polygon fill="black" stroke="black" points="10503.95,-1621.53 10513.49,-1616.91 10503.16,-1614.57 10503.95,-1621.53"/>
</g>
<!-- l0_expert_agg_gpu2&#45;&gt;l0_res2_gpu2 -->
<g id="edge164" class="edge">
<title>l0_expert_agg_gpu2&#45;&gt;l0_res2_gpu2</title>
<path fill="none" stroke="black" d="M8951.57,-1377.75C8951.57,-1369 8951.57,-1360.23 8951.57,-1352.02"/>
<polygon fill="black" stroke="black" points="8955.07,-1351.97 8951.57,-1341.97 8948.07,-1351.97 8955.07,-1351.97"/>
</g>
<!-- l1_mha_qkv_gpu2 -->
<g id="node162" class="node">
<title>l1_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13006.57,-1203.95 12836.57,-1203.95 12836.57,-1150.95 13006.57,-1150.95 13006.57,-1203.95"/>
<text text-anchor="middle" x="12921.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="12921.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12921.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu2&#45;&gt;l1_mha_qkv_gpu2 -->
<g id="edge166" class="edge">
<title>l0_res2_gpu2&#45;&gt;l1_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M9168.91,-1303.82C9615.2,-1297.47 10667.29,-1282.92 11550.57,-1273.95 11608.96,-1273.36 12543.73,-1273.94 12601.57,-1265.95 12684.19,-1254.54 12775.74,-1228.04 12839.67,-1207.17"/>
<polygon fill="black" stroke="black" points="12840.89,-1210.46 12849.29,-1204.01 12838.7,-1203.81 12840.89,-1210.46"/>
</g>
<!-- l1_res_add_gpu2 -->
<g id="node517" class="node">
<title>l1_res_add_gpu2</title>
<ellipse fill="none" stroke="black" cx="8951.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8951.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu2</text>
</g>
<!-- l0_res2_gpu2&#45;&gt;l1_res_add_gpu2 -->
<g id="edge171" class="edge">
<title>l0_res2_gpu2&#45;&gt;l1_res_add_gpu2</title>
<path fill="none" stroke="black" d="M8951.57,-1273.86C8951.57,-1252.78 8951.57,-1225.79 8951.57,-1205.9"/>
<polygon fill="black" stroke="black" points="8955.07,-1205.67 8951.57,-1195.67 8948.07,-1205.67 8955.07,-1205.67"/>
</g>
<!-- l0_mha_attn_gpu3 -->
<g id="node51" class="node">
<title>l0_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="14933.57,-2273.95 14461.57,-2273.95 14461.57,-2205.95 14933.57,-2205.95 14933.57,-2273.95"/>
<text text-anchor="middle" x="14697.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="14697.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14697.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="14697.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu3&#45;&gt;l0_mha_attn_gpu3 -->
<g id="edge200" class="edge">
<title>l0_mha_qkv_gpu3&#45;&gt;l0_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M14769.83,-2309.84C14760.3,-2300.75 14749.86,-2290.8 14739.95,-2281.35"/>
<polygon fill="black" stroke="black" points="14742.15,-2278.62 14732.5,-2274.25 14737.32,-2283.69 14742.15,-2278.62"/>
</g>
<!-- l0_mha_out_gpu3 -->
<g id="node52" class="node">
<title>l0_mha_out_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="14856.57,-2169.95 14396.57,-2169.95 14396.57,-2101.95 14856.57,-2101.95 14856.57,-2169.95"/>
<text text-anchor="middle" x="14626.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14626.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14626.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="14626.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu3&#45;&gt;l0_mha_out_gpu3 -->
<g id="edge201" class="edge">
<title>l0_mha_attn_gpu3&#45;&gt;l0_mha_out_gpu3</title>
<path fill="none" stroke="black" d="M14674.52,-2205.84C14668.44,-2197.11 14661.81,-2187.58 14655.47,-2178.47"/>
<polygon fill="black" stroke="black" points="14658.33,-2176.46 14649.75,-2170.25 14652.59,-2180.46 14658.33,-2176.46"/>
</g>
<!-- l0_mha_allreduce_gpu3 -->
<g id="node53" class="node">
<title>l0_mha_allreduce_gpu3</title>
<polygon fill="yellow" stroke="black" points="15005.47,-2065.95 14289.78,-2065.95 14105.67,-1929.95 14821.36,-1929.95 15005.47,-2065.95"/>
<text text-anchor="middle" x="14555.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14555.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14555.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="14555.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu3&#45;&gt;l0_mha_allreduce_gpu3 -->
<g id="edge202" class="edge">
<title>l0_mha_out_gpu3&#45;&gt;l0_mha_allreduce_gpu3</title>
<path fill="none" stroke="black" d="M14609.2,-2101.68C14604.94,-2093.52 14600.2,-2084.44 14595.35,-2075.16"/>
<polygon fill="black" stroke="black" points="14598.41,-2073.46 14590.68,-2066.22 14592.21,-2076.7 14598.41,-2073.46"/>
</g>
<!-- l0_mha_allreduce_gpu3&#45;&gt;l0_res_add_gpu3 -->
<g id="edge203" class="edge">
<title>l0_mha_allreduce_gpu3&#45;&gt;l0_res_add_gpu3</title>
<path fill="none" stroke="black" d="M14120.06,-1940.78C14086.75,-1936.95 14053.63,-1933.29 14021.57,-1929.95 13817.67,-1908.71 13585.08,-1889.85 13417.93,-1877.25"/>
<polygon fill="black" stroke="black" points="13418,-1873.74 13407.76,-1876.48 13417.47,-1880.72 13418,-1873.74"/>
</g>
<!-- l0_expert_24_gpu3 -->
<g id="node55" class="node">
<title>l0_expert_24_gpu3</title>
<polygon fill="lightpink" stroke="black" points="11437.57,-1617.95 11003.57,-1617.95 11003.57,-1549.95 11437.57,-1549.95 11437.57,-1617.95"/>
<text text-anchor="middle" x="11220.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="11220.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="11220.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11220.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_24_gpu3 -->
<g id="edge207" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_24_gpu3</title>
<path fill="none" stroke="black" d="M12973.32,-1855.49C12643.16,-1848.96 12030.73,-1831.55 11815.57,-1789.95 11626.98,-1753.49 11416.8,-1670.43 11303.63,-1621.97"/>
<polygon fill="black" stroke="black" points="11304.89,-1618.7 11294.32,-1617.96 11302.12,-1625.13 11304.89,-1618.7"/>
</g>
<!-- l0_expert_25_gpu3 -->
<g id="node56" class="node">
<title>l0_expert_25_gpu3</title>
<polygon fill="lightpink" stroke="black" points="11889.57,-1617.95 11455.57,-1617.95 11455.57,-1549.95 11889.57,-1549.95 11889.57,-1617.95"/>
<text text-anchor="middle" x="11672.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="11672.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="11672.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11672.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_25_gpu3 -->
<g id="edge210" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_25_gpu3</title>
<path fill="none" stroke="black" d="M12973.45,-1851.46C12727.26,-1841.62 12341.62,-1821.76 12199.57,-1789.95 12032.12,-1752.46 11847.65,-1670.6 11747.46,-1622.43"/>
<polygon fill="black" stroke="black" points="11748.86,-1619.22 11738.33,-1618.02 11745.81,-1625.52 11748.86,-1619.22"/>
</g>
<!-- l0_expert_26_gpu3 -->
<g id="node57" class="node">
<title>l0_expert_26_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12341.57,-1617.95 11907.57,-1617.95 11907.57,-1549.95 12341.57,-1549.95 12341.57,-1617.95"/>
<text text-anchor="middle" x="12124.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="12124.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12124.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12124.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_26_gpu3 -->
<g id="edge213" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_26_gpu3</title>
<path fill="none" stroke="black" d="M12973.22,-1851.7C12782.39,-1843.1 12520.4,-1825.23 12422.57,-1789.95 12321.22,-1753.41 12221.88,-1673.78 12167.36,-1625.22"/>
<polygon fill="black" stroke="black" points="12169.43,-1622.37 12159.65,-1618.29 12164.75,-1627.58 12169.43,-1622.37"/>
</g>
<!-- l0_expert_27_gpu3 -->
<g id="node58" class="node">
<title>l0_expert_27_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12793.57,-1617.95 12359.57,-1617.95 12359.57,-1549.95 12793.57,-1549.95 12793.57,-1617.95"/>
<text text-anchor="middle" x="12576.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="12576.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12576.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12576.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_27_gpu3 -->
<g id="edge216" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_27_gpu3</title>
<path fill="none" stroke="black" d="M12973.42,-1853.21C12768.73,-1845.49 12488.26,-1828.05 12453.57,-1789.95 12412.87,-1745.26 12423.02,-1706.11 12453.57,-1653.95 12460.49,-1642.14 12470.25,-1632.19 12481.29,-1623.86"/>
<polygon fill="black" stroke="black" points="12483.36,-1626.69 12489.53,-1618.08 12479.34,-1620.96 12483.36,-1626.69"/>
</g>
<!-- l0_expert_28_gpu3 -->
<g id="node59" class="node">
<title>l0_expert_28_gpu3</title>
<polygon fill="lightpink" stroke="black" points="13245.57,-1617.95 12811.57,-1617.95 12811.57,-1549.95 13245.57,-1549.95 13245.57,-1617.95"/>
<text text-anchor="middle" x="13028.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="13028.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13028.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13028.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_28_gpu3 -->
<g id="edge219" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_28_gpu3</title>
<path fill="none" stroke="black" d="M13352.82,-1825.86C13385.59,-1815.87 13413.22,-1803.81 13423.57,-1789.95 13459.74,-1741.52 13462.46,-1700.23 13423.57,-1653.95 13417.27,-1646.46 13340.16,-1632.22 13255.73,-1618.61"/>
<polygon fill="black" stroke="black" points="13256.1,-1615.12 13245.67,-1617 13254.99,-1622.04 13256.1,-1615.12"/>
</g>
<!-- l0_expert_29_gpu3 -->
<g id="node60" class="node">
<title>l0_expert_29_gpu3</title>
<polygon fill="lightpink" stroke="black" points="13697.57,-1617.95 13263.57,-1617.95 13263.57,-1549.95 13697.57,-1549.95 13697.57,-1617.95"/>
<text text-anchor="middle" x="13480.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="13480.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13480.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13480.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_29_gpu3 -->
<g id="edge222" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_29_gpu3</title>
<path fill="none" stroke="black" d="M13373.04,-1825.92C13408.77,-1816.04 13439.08,-1804.01 13451.57,-1789.95 13490.66,-1745.95 13491.61,-1674.37 13487.22,-1628.49"/>
<polygon fill="black" stroke="black" points="13490.66,-1627.83 13486.11,-1618.26 13483.7,-1628.58 13490.66,-1627.83"/>
</g>
<!-- l0_expert_30_gpu3 -->
<g id="node61" class="node">
<title>l0_expert_30_gpu3</title>
<polygon fill="lightpink" stroke="black" points="14149.57,-1617.95 13715.57,-1617.95 13715.57,-1549.95 14149.57,-1549.95 14149.57,-1617.95"/>
<text text-anchor="middle" x="13932.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="13932.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13932.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13932.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_30_gpu3 -->
<g id="edge225" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_30_gpu3</title>
<path fill="none" stroke="black" d="M13356.45,-1825.89C13398.39,-1815.9 13443.03,-1803.83 13483.57,-1789.95 13621.58,-1742.71 13774.58,-1667.66 13861.61,-1622.66"/>
<polygon fill="black" stroke="black" points="13863.33,-1625.71 13870.6,-1618 13860.11,-1619.5 13863.33,-1625.71"/>
</g>
<!-- l0_expert_31_gpu3 -->
<g id="node62" class="node">
<title>l0_expert_31_gpu3</title>
<polygon fill="lightpink" stroke="black" points="14601.57,-1617.95 14167.57,-1617.95 14167.57,-1549.95 14601.57,-1549.95 14601.57,-1617.95"/>
<text text-anchor="middle" x="14384.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="14384.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14384.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14384.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_expert_31_gpu3 -->
<g id="edge228" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_expert_31_gpu3</title>
<path fill="none" stroke="black" d="M13407.7,-1832.33C13485.62,-1821.27 13573.9,-1806.99 13653.57,-1789.95 13875.79,-1742.43 14130.26,-1665.93 14272.74,-1621.05"/>
<polygon fill="black" stroke="black" points="14273.9,-1624.35 14282.38,-1618 14271.79,-1617.68 14273.9,-1624.35"/>
</g>
<!-- l0_gate_gpu3 -->
<g id="node63" class="node">
<title>l0_gate_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="13414.31,-1789.95 12657.51,-1789.95 12462.83,-1653.95 13219.62,-1653.95 13414.31,-1789.95"/>
<text text-anchor="middle" x="12938.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12938.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12938.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12938.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_gate_gpu3 -->
<g id="edge205" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_gate_gpu3</title>
<path fill="none" stroke="black" d="M13129.24,-1825.86C13111.67,-1816.37 13091.79,-1805.64 13071.66,-1794.78"/>
<polygon fill="black" stroke="black" points="13073.18,-1791.63 13062.72,-1789.96 13069.86,-1797.79 13073.18,-1791.63"/>
</g>
<!-- l0_res2_gpu3 -->
<g id="node65" class="node">
<title>l0_res2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="11993.57,-1341.95 11559.57,-1341.95 11559.57,-1273.95 11993.57,-1273.95 11993.57,-1341.95"/>
<text text-anchor="middle" x="11776.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11776.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="11776.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="11776.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu3&#45;&gt;l0_res2_gpu3 -->
<g id="edge231" class="edge">
<title>l0_res_add_gpu3&#45;&gt;l0_res2_gpu3</title>
<path fill="none" stroke="black" d="M12973.42,-1855.25C12526.84,-1846.95 11534.5,-1824.85 11383.57,-1789.95 11199.39,-1747.37 11097.73,-1776.36 10994.57,-1617.95 10855.19,-1403.93 11271.6,-1338.12 11549.2,-1317.9"/>
<polygon fill="black" stroke="black" points="11549.7,-1321.37 11559.43,-1317.17 11549.2,-1314.39 11549.7,-1321.37"/>
</g>
<!-- l0_expert_agg_gpu3 -->
<g id="node64" class="node">
<title>l0_expert_agg_gpu3</title>
<polygon fill="yellow" stroke="black" points="13026.47,-1513.95 12310.78,-1513.95 12126.67,-1377.95 12842.36,-1377.95 13026.47,-1513.95"/>
<text text-anchor="middle" x="12576.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12576.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12576.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="12576.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_24_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge208" class="edge">
<title>l0_expert_24_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11437.65,-1551.03C11440.64,-1550.66 11443.62,-1550.3 11446.57,-1549.95 11714.02,-1518.26 12018.1,-1491.04 12243.4,-1472.56"/>
<polygon fill="black" stroke="black" points="12243.71,-1476.04 12253.39,-1471.74 12243.14,-1469.07 12243.71,-1476.04"/>
</g>
<!-- l0_expert_25_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge211" class="edge">
<title>l0_expert_25_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11889.67,-1550.29C12003.61,-1533.15 12145.11,-1511.86 12270.02,-1493.07"/>
<polygon fill="black" stroke="black" points="12270.77,-1496.5 12280.13,-1491.55 12269.73,-1489.58 12270.77,-1496.5"/>
</g>
<!-- l0_expert_26_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge214" class="edge">
<title>l0_expert_26_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12234.27,-1549.94C12267.64,-1539.91 12305.64,-1528.47 12343.91,-1516.96"/>
<polygon fill="black" stroke="black" points="12345.07,-1520.26 12353.64,-1514.03 12343.06,-1513.56 12345.07,-1520.26"/>
</g>
<!-- l0_expert_27_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge217" class="edge">
<title>l0_expert_27_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12576.57,-1549.68C12576.57,-1541.86 12576.57,-1533.19 12576.57,-1524.31"/>
<polygon fill="black" stroke="black" points="12580.07,-1524.22 12576.57,-1514.22 12573.07,-1524.22 12580.07,-1524.22"/>
</g>
<!-- l0_expert_28_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge220" class="edge">
<title>l0_expert_28_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12918.86,-1549.94C12885.5,-1539.91 12847.49,-1528.47 12809.23,-1516.96"/>
<polygon fill="black" stroke="black" points="12810.08,-1513.56 12799.5,-1514.03 12808.07,-1520.26 12810.08,-1513.56"/>
</g>
<!-- l0_expert_29_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge223" class="edge">
<title>l0_expert_29_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M13263.46,-1550.29C13193.45,-1539.76 13113.03,-1527.66 13032.44,-1515.54"/>
<polygon fill="black" stroke="black" points="13032.51,-1512.01 13022.1,-1513.98 13031.47,-1518.93 13032.51,-1512.01"/>
</g>
<!-- l0_expert_30_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge226" class="edge">
<title>l0_expert_30_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M13715.49,-1551.03C13712.5,-1550.66 13709.52,-1550.3 13706.57,-1549.95 13469.11,-1521.82 13202.78,-1497.2 12988.35,-1479.1"/>
<polygon fill="black" stroke="black" points="12988.43,-1475.6 12978.17,-1478.24 12987.85,-1482.57 12988.43,-1475.6"/>
</g>
<!-- l0_expert_31_gpu3&#45;&gt;l0_expert_agg_gpu3 -->
<g id="edge229" class="edge">
<title>l0_expert_31_gpu3&#45;&gt;l0_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M14167.5,-1550.92C14164.5,-1550.59 14161.53,-1550.27 14158.57,-1549.95 13753.92,-1507.31 13289.07,-1479.57 12968.48,-1463.74"/>
<polygon fill="black" stroke="black" points="12968.25,-1460.22 12958.09,-1463.23 12967.9,-1467.21 12968.25,-1460.22"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_24_gpu3 -->
<g id="edge206" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_24_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12530.18,-1701.15C12232.62,-1684.7 11819.73,-1657.7 11447.8,-1618.06"/>
<polygon fill="black" stroke="black" points="11447.96,-1614.56 11437.64,-1616.97 11447.21,-1621.52 11447.96,-1614.56"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_25_gpu3 -->
<g id="edge209" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_25_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12503.54,-1682.39C12320.05,-1664.98 12103.98,-1642.96 11899.68,-1618.07"/>
<polygon fill="black" stroke="black" points="11900,-1614.59 11889.65,-1616.85 11899.16,-1621.54 11900,-1614.59"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_26_gpu3 -->
<g id="edge212" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_26_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12537.53,-1653.95C12466.49,-1642.08 12395.2,-1630.17 12332.34,-1619.67"/>
<polygon fill="black" stroke="black" points="12332.76,-1616.19 12322.32,-1617.99 12331.61,-1623.09 12332.76,-1616.19"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_27_gpu3 -->
<g id="edge215" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_27_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12760.22,-1653.95C12730.66,-1642.84 12701,-1631.7 12674.4,-1621.71"/>
<polygon fill="black" stroke="black" points="12675.34,-1618.32 12664.75,-1618.08 12672.88,-1624.87 12675.34,-1618.32"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_28_gpu3 -->
<g id="edge218" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_28_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12983.04,-1653.75C12989.22,-1644.41 12995.41,-1635.06 13001.15,-1626.39"/>
<polygon fill="black" stroke="black" points="13004.12,-1628.24 13006.72,-1617.97 12998.28,-1624.38 13004.12,-1628.24"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_29_gpu3 -->
<g id="edge221" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_29_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13205.6,-1653.95C13251.73,-1642.37 13298.02,-1630.76 13339.12,-1620.45"/>
<polygon fill="black" stroke="black" points="13340.05,-1623.82 13348.9,-1617.99 13338.34,-1617.03 13340.05,-1623.82"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_30_gpu3 -->
<g id="edge224" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_30_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13256.29,-1679.19C13391.69,-1661.18 13551.65,-1639.61 13705.35,-1618.12"/>
<polygon fill="black" stroke="black" points="13706.05,-1621.56 13715.46,-1616.7 13705.08,-1614.62 13706.05,-1621.56"/>
</g>
<!-- l0_gate_gpu3&#45;&gt;l0_expert_31_gpu3 -->
<g id="edge227" class="edge">
<title>l0_gate_gpu3&#45;&gt;l0_expert_31_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13282.25,-1697.54C13524.24,-1679.7 13855.92,-1652.54 14157.24,-1618.09"/>
<polygon fill="black" stroke="black" points="14157.95,-1621.53 14167.49,-1616.91 14157.16,-1614.57 14157.95,-1621.53"/>
</g>
<!-- l0_expert_agg_gpu3&#45;&gt;l0_res2_gpu3 -->
<g id="edge230" class="edge">
<title>l0_expert_agg_gpu3&#45;&gt;l0_res2_gpu3</title>
<path fill="none" stroke="black" d="M12182.43,-1377.95C12112.75,-1366.1 12042.84,-1354.22 11981.14,-1343.73"/>
<polygon fill="black" stroke="black" points="11981.36,-1340.22 11970.92,-1341.99 11980.19,-1347.12 11981.36,-1340.22"/>
</g>
<!-- l1_mha_qkv_gpu3 -->
<g id="node178" class="node">
<title>l1_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="13551.57,-1203.95 13381.57,-1203.95 13381.57,-1150.95 13551.57,-1150.95 13551.57,-1203.95"/>
<text text-anchor="middle" x="13466.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="13466.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13466.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu3&#45;&gt;l1_mha_qkv_gpu3 -->
<g id="edge232" class="edge">
<title>l0_res2_gpu3&#45;&gt;l1_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M11993.84,-1305.39C12376.02,-1301.99 13139.62,-1291.99 13259.57,-1265.95 13313.27,-1254.29 13370.54,-1228.98 13411.2,-1208.56"/>
<polygon fill="black" stroke="black" points="13412.8,-1211.67 13420.13,-1204.02 13409.63,-1205.43 13412.8,-1211.67"/>
</g>
<!-- l1_res_add_gpu3 -->
<g id="node518" class="node">
<title>l1_res_add_gpu3</title>
<ellipse fill="none" stroke="black" cx="9144.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="9144.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu3</text>
</g>
<!-- l0_res2_gpu3&#45;&gt;l1_res_add_gpu3 -->
<g id="edge237" class="edge">
<title>l0_res2_gpu3&#45;&gt;l1_res_add_gpu3</title>
<path fill="none" stroke="black" d="M11559.52,-1307.49C10965.74,-1308.43 9351.56,-1307.15 9244.57,-1265.95 9211.69,-1253.29 9182.45,-1224.6 9164.21,-1203.5"/>
<polygon fill="black" stroke="black" points="9166.65,-1200.97 9157.54,-1195.56 9161.29,-1205.47 9166.65,-1200.97"/>
</g>
<!-- l0_mha_attn_gpu4 -->
<g id="node67" class="node">
<title>l0_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="15657.57,-2273.95 15185.57,-2273.95 15185.57,-2205.95 15657.57,-2205.95 15657.57,-2273.95"/>
<text text-anchor="middle" x="15421.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15421.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15421.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="15421.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu4&#45;&gt;l0_mha_attn_gpu4 -->
<g id="edge266" class="edge">
<title>l0_mha_qkv_gpu4&#45;&gt;l0_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M15385.78,-2309.84C15390.17,-2301.37 15394.96,-2292.16 15399.56,-2283.31"/>
<polygon fill="black" stroke="black" points="15402.76,-2284.74 15404.27,-2274.25 15396.55,-2281.51 15402.76,-2284.74"/>
</g>
<!-- l0_mha_out_gpu4 -->
<g id="node68" class="node">
<title>l0_mha_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="15686.57,-2169.95 15226.57,-2169.95 15226.57,-2101.95 15686.57,-2101.95 15686.57,-2169.95"/>
<text text-anchor="middle" x="15456.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15456.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15456.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="15456.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu4&#45;&gt;l0_mha_out_gpu4 -->
<g id="edge267" class="edge">
<title>l0_mha_attn_gpu4&#45;&gt;l0_mha_out_gpu4</title>
<path fill="none" stroke="black" d="M15432.93,-2205.84C15435.77,-2197.55 15438.86,-2188.55 15441.84,-2179.86"/>
<polygon fill="black" stroke="black" points="15445.21,-2180.85 15445.14,-2170.25 15438.59,-2178.58 15445.21,-2180.85"/>
</g>
<!-- l0_mha_allreduce_gpu4 -->
<g id="node69" class="node">
<title>l0_mha_allreduce_gpu4</title>
<polygon fill="yellow" stroke="black" points="16013.47,-2065.95 15297.78,-2065.95 15113.67,-1929.95 15829.36,-1929.95 16013.47,-2065.95"/>
<text text-anchor="middle" x="15563.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="15563.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15563.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="15563.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu4&#45;&gt;l0_mha_allreduce_gpu4 -->
<g id="edge268" class="edge">
<title>l0_mha_out_gpu4&#45;&gt;l0_mha_allreduce_gpu4</title>
<path fill="none" stroke="black" d="M15482.74,-2101.68C15489.37,-2093.27 15496.75,-2083.88 15504.29,-2074.3"/>
<polygon fill="black" stroke="black" points="15507.22,-2076.24 15510.65,-2066.22 15501.71,-2071.91 15507.22,-2076.24"/>
</g>
<!-- l0_mha_allreduce_gpu4&#45;&gt;l0_res_add_gpu4 -->
<g id="edge269" class="edge">
<title>l0_mha_allreduce_gpu4&#45;&gt;l0_res_add_gpu4</title>
<path fill="none" stroke="black" d="M15634.72,-1929.75C15645.12,-1919.93 15655.55,-1910.08 15665.13,-1901.04"/>
<polygon fill="black" stroke="black" points="15667.74,-1903.38 15672.61,-1893.97 15662.94,-1898.29 15667.74,-1903.38"/>
</g>
<!-- l0_expert_32_gpu4 -->
<g id="node71" class="node">
<title>l0_expert_32_gpu4</title>
<polygon fill="lightpink" stroke="black" points="15091.57,-1617.95 14657.57,-1617.95 14657.57,-1549.95 15091.57,-1549.95 15091.57,-1617.95"/>
<text text-anchor="middle" x="14874.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="14874.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14874.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="14874.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_32_gpu4 -->
<g id="edge273" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_32_gpu4</title>
<path fill="none" stroke="black" d="M15557.6,-1825.87C15514.38,-1815.39 15467.35,-1803.09 15424.57,-1789.95 15259.33,-1739.21 15071.58,-1665.7 14963.71,-1621.88"/>
<polygon fill="black" stroke="black" points="14964.75,-1618.53 14954.17,-1618 14962.11,-1625.01 14964.75,-1618.53"/>
</g>
<!-- l0_expert_33_gpu4 -->
<g id="node72" class="node">
<title>l0_expert_33_gpu4</title>
<polygon fill="lightpink" stroke="black" points="15543.57,-1617.95 15109.57,-1617.95 15109.57,-1549.95 15543.57,-1549.95 15543.57,-1617.95"/>
<text text-anchor="middle" x="15326.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="15326.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15326.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15326.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_33_gpu4 -->
<g id="edge276" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_33_gpu4</title>
<path fill="none" stroke="black" d="M15661.61,-1825.9C15591.1,-1775.19 15456.49,-1678.39 15381.13,-1624.19"/>
<polygon fill="black" stroke="black" points="15382.85,-1621.12 15372.69,-1618.12 15378.76,-1626.8 15382.85,-1621.12"/>
</g>
<!-- l0_expert_34_gpu4 -->
<g id="node73" class="node">
<title>l0_expert_34_gpu4</title>
<polygon fill="lightpink" stroke="black" points="15995.57,-1617.95 15561.57,-1617.95 15561.57,-1549.95 15995.57,-1549.95 15995.57,-1617.95"/>
<text text-anchor="middle" x="15778.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="15778.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15778.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15778.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_34_gpu4 -->
<g id="edge279" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_34_gpu4</title>
<path fill="none" stroke="black" d="M15701.3,-1825.85C15694.93,-1784.03 15689.01,-1710.66 15712.57,-1653.95 15716.81,-1643.76 15723.31,-1634.19 15730.6,-1625.63"/>
<polygon fill="black" stroke="black" points="15733.36,-1627.8 15737.49,-1618.05 15728.17,-1623.1 15733.36,-1627.8"/>
</g>
<!-- l0_expert_35_gpu4 -->
<g id="node74" class="node">
<title>l0_expert_35_gpu4</title>
<polygon fill="lightpink" stroke="black" points="16447.57,-1617.95 16013.57,-1617.95 16013.57,-1549.95 16447.57,-1549.95 16447.57,-1617.95"/>
<text text-anchor="middle" x="16230.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="16230.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="16230.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16230.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_35_gpu4 -->
<g id="edge282" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_35_gpu4</title>
<path fill="none" stroke="black" d="M15711.58,-1825.73C15718.54,-1770.76 15733.27,-1665.71 15745.57,-1653.95 15785.61,-1615.68 15932.35,-1625.11 16003.53,-1617.88"/>
<polygon fill="black" stroke="black" points="16003.95,-1621.35 16013.46,-1616.68 16003.12,-1614.4 16003.95,-1621.35"/>
</g>
<!-- l0_expert_36_gpu4 -->
<g id="node75" class="node">
<title>l0_expert_36_gpu4</title>
<polygon fill="lightpink" stroke="black" points="16899.57,-1617.95 16465.57,-1617.95 16465.57,-1549.95 16899.57,-1549.95 16899.57,-1617.95"/>
<text text-anchor="middle" x="16682.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="16682.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="16682.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16682.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_36_gpu4 -->
<g id="edge285" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_36_gpu4</title>
<path fill="none" stroke="black" d="M15924.73,-1859.48C16204.91,-1857.85 16662.82,-1846.44 16715.57,-1789.95 16756.31,-1746.33 16730.54,-1673.37 16707.25,-1627.27"/>
<polygon fill="black" stroke="black" points="16710.22,-1625.4 16702.5,-1618.15 16704.02,-1628.63 16710.22,-1625.4"/>
</g>
<!-- l0_expert_37_gpu4 -->
<g id="node76" class="node">
<title>l0_expert_37_gpu4</title>
<polygon fill="lightpink" stroke="black" points="17351.57,-1617.95 16917.57,-1617.95 16917.57,-1549.95 17351.57,-1549.95 17351.57,-1617.95"/>
<text text-anchor="middle" x="17134.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="17134.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="17134.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17134.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_37_gpu4 -->
<g id="edge288" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_37_gpu4</title>
<path fill="none" stroke="black" d="M15924.71,-1854.85C16181.22,-1848.19 16591.77,-1831.29 16739.57,-1789.95 16868.63,-1753.85 17004.13,-1672.57 17078.1,-1623.89"/>
<polygon fill="black" stroke="black" points="17080.4,-1626.57 17086.81,-1618.13 17076.54,-1620.73 17080.4,-1626.57"/>
</g>
<!-- l0_expert_38_gpu4 -->
<g id="node77" class="node">
<title>l0_expert_38_gpu4</title>
<polygon fill="lightpink" stroke="black" points="17803.57,-1617.95 17369.57,-1617.95 17369.57,-1549.95 17803.57,-1549.95 17803.57,-1617.95"/>
<text text-anchor="middle" x="17586.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="17586.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="17586.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="17586.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_38_gpu4 -->
<g id="edge291" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_38_gpu4</title>
<path fill="none" stroke="black" d="M15924.64,-1852.36C16215.52,-1842.48 16716.07,-1821.57 16896.57,-1789.95 17113.03,-1752.04 17357.68,-1669.49 17489.67,-1621.51"/>
<polygon fill="black" stroke="black" points="17491.16,-1624.69 17499.36,-1617.97 17488.77,-1618.11 17491.16,-1624.69"/>
</g>
<!-- l0_expert_39_gpu4 -->
<g id="node78" class="node">
<title>l0_expert_39_gpu4</title>
<polygon fill="lightpink" stroke="black" points="18255.57,-1617.95 17821.57,-1617.95 17821.57,-1549.95 18255.57,-1549.95 18255.57,-1617.95"/>
<text text-anchor="middle" x="18038.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="18038.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="18038.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="18038.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_expert_39_gpu4 -->
<g id="edge294" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_expert_39_gpu4</title>
<path fill="none" stroke="black" d="M15924.58,-1853.45C16269.16,-1843.89 16926.12,-1822.12 17157.57,-1789.95 17432.4,-1751.76 17747.55,-1668.63 17916.44,-1620.79"/>
<polygon fill="black" stroke="black" points="17917.44,-1624.14 17926.1,-1618.04 17915.53,-1617.41 17917.44,-1624.14"/>
</g>
<!-- l0_gate_gpu4 -->
<g id="node79" class="node">
<title>l0_gate_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="16706.31,-1789.95 15949.51,-1789.95 15754.83,-1653.95 16511.62,-1653.95 16706.31,-1789.95"/>
<text text-anchor="middle" x="16230.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="16230.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="16230.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16230.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_gate_gpu4 -->
<g id="edge271" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_gate_gpu4</title>
<path fill="none" stroke="black" d="M15834.51,-1825.94C15873.59,-1815.78 15918.18,-1804.19 15963.01,-1792.53"/>
<polygon fill="black" stroke="black" points="15964.08,-1795.87 15972.88,-1789.96 15962.32,-1789.09 15964.08,-1795.87"/>
</g>
<!-- l0_res2_gpu4 -->
<g id="node81" class="node">
<title>l0_res2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="15646.57,-1341.95 15212.57,-1341.95 15212.57,-1273.95 15646.57,-1273.95 15646.57,-1341.95"/>
<text text-anchor="middle" x="15429.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15429.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15429.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="15429.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu4&#45;&gt;l0_res2_gpu4 -->
<g id="edge297" class="edge">
<title>l0_res_add_gpu4&#45;&gt;l0_res2_gpu4</title>
<path fill="none" stroke="black" d="M15490.48,-1852.37C15361.29,-1844.45 15195.11,-1827.23 15051.57,-1789.95 14863.08,-1741 14755.89,-1780.45 14648.57,-1617.95 14507.96,-1405.07 14924.36,-1338.84 15202.07,-1318.24"/>
<polygon fill="black" stroke="black" points="15202.58,-1321.72 15212.3,-1317.5 15202.07,-1314.73 15202.58,-1321.72"/>
</g>
<!-- l0_expert_agg_gpu4 -->
<g id="node80" class="node">
<title>l0_expert_agg_gpu4</title>
<polygon fill="yellow" stroke="black" points="16680.47,-1513.95 15964.78,-1513.95 15780.67,-1377.95 16496.36,-1377.95 16680.47,-1513.95"/>
<text text-anchor="middle" x="16230.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16230.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="16230.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="16230.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_32_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge274" class="edge">
<title>l0_expert_32_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M15091.65,-1551.03C15094.64,-1550.66 15097.62,-1550.3 15100.57,-1549.95 15368.02,-1518.26 15672.1,-1491.04 15897.4,-1472.56"/>
<polygon fill="black" stroke="black" points="15897.71,-1476.04 15907.39,-1471.74 15897.14,-1469.07 15897.71,-1476.04"/>
</g>
<!-- l0_expert_33_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge277" class="edge">
<title>l0_expert_33_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M15543.67,-1550.29C15657.61,-1533.15 15799.11,-1511.86 15924.02,-1493.07"/>
<polygon fill="black" stroke="black" points="15924.77,-1496.5 15934.13,-1491.55 15923.73,-1489.58 15924.77,-1496.5"/>
</g>
<!-- l0_expert_34_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge280" class="edge">
<title>l0_expert_34_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M15888.27,-1549.94C15921.64,-1539.91 15959.64,-1528.47 15997.91,-1516.96"/>
<polygon fill="black" stroke="black" points="15999.07,-1520.26 16007.64,-1514.03 15997.06,-1513.56 15999.07,-1520.26"/>
</g>
<!-- l0_expert_35_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge283" class="edge">
<title>l0_expert_35_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M16230.57,-1549.68C16230.57,-1541.86 16230.57,-1533.19 16230.57,-1524.31"/>
<polygon fill="black" stroke="black" points="16234.07,-1524.22 16230.57,-1514.22 16227.07,-1524.22 16234.07,-1524.22"/>
</g>
<!-- l0_expert_36_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge286" class="edge">
<title>l0_expert_36_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M16572.86,-1549.94C16539.5,-1539.91 16501.49,-1528.47 16463.23,-1516.96"/>
<polygon fill="black" stroke="black" points="16464.08,-1513.56 16453.5,-1514.03 16462.07,-1520.26 16464.08,-1513.56"/>
</g>
<!-- l0_expert_37_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge289" class="edge">
<title>l0_expert_37_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M16917.46,-1550.29C16847.45,-1539.76 16767.03,-1527.66 16686.44,-1515.54"/>
<polygon fill="black" stroke="black" points="16686.51,-1512.01 16676.1,-1513.98 16685.47,-1518.93 16686.51,-1512.01"/>
</g>
<!-- l0_expert_38_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge292" class="edge">
<title>l0_expert_38_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M17369.49,-1551.03C17366.5,-1550.66 17363.52,-1550.3 17360.57,-1549.95 17123.11,-1521.82 16856.78,-1497.2 16642.35,-1479.1"/>
<polygon fill="black" stroke="black" points="16642.43,-1475.6 16632.17,-1478.24 16641.85,-1482.57 16642.43,-1475.6"/>
</g>
<!-- l0_expert_39_gpu4&#45;&gt;l0_expert_agg_gpu4 -->
<g id="edge295" class="edge">
<title>l0_expert_39_gpu4&#45;&gt;l0_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M17821.5,-1550.92C17818.5,-1550.59 17815.53,-1550.27 17812.57,-1549.95 17407.92,-1507.31 16943.07,-1479.57 16622.48,-1463.74"/>
<polygon fill="black" stroke="black" points="16622.25,-1460.22 16612.09,-1463.23 16621.9,-1467.21 16622.25,-1460.22"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_32_gpu4 -->
<g id="edge272" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_32_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15802.74,-1687.45C15594.16,-1669.73 15339.47,-1646.07 15101.88,-1618.09"/>
<polygon fill="black" stroke="black" points="15101.99,-1614.58 15091.65,-1616.88 15101.17,-1621.53 15101.99,-1614.58"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_33_gpu4 -->
<g id="edge275" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_33_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15785.19,-1653.95C15704.95,-1641.88 15624.44,-1629.77 15553.76,-1619.13"/>
<polygon fill="black" stroke="black" points="15554.27,-1615.67 15543.86,-1617.64 15553.23,-1622.59 15554.27,-1615.67"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_34_gpu4 -->
<g id="edge278" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_34_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16007.88,-1653.95C15970.05,-1642.57 15932.1,-1631.15 15898.27,-1620.97"/>
<polygon fill="black" stroke="black" points="15898.96,-1617.52 15888.38,-1617.99 15896.94,-1624.23 15898.96,-1617.52"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_35_gpu4 -->
<g id="edge281" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_35_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16230.57,-1653.75C16230.57,-1645 16230.57,-1636.23 16230.57,-1628.02"/>
<polygon fill="black" stroke="black" points="16234.07,-1627.97 16230.57,-1617.97 16227.07,-1627.97 16234.07,-1627.97"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_36_gpu4 -->
<g id="edge284" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_36_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16453.26,-1653.95C16491.08,-1642.57 16529.03,-1631.15 16562.87,-1620.97"/>
<polygon fill="black" stroke="black" points="16564.19,-1624.23 16572.76,-1617.99 16562.18,-1617.52 16564.19,-1624.23"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_37_gpu4 -->
<g id="edge287" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_37_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16541.04,-1674.24C16661.31,-1656.15 16796.45,-1635.82 16907.36,-1619.14"/>
<polygon fill="black" stroke="black" points="16907.97,-1622.58 16917.34,-1617.63 16906.93,-1615.66 16907.97,-1622.58"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_38_gpu4 -->
<g id="edge290" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_38_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16570.4,-1694.8C16792.27,-1676.55 17088.41,-1649.99 17359.45,-1618.07"/>
<polygon fill="black" stroke="black" points="17359.97,-1621.53 17369.49,-1616.88 17359.15,-1614.58 17359.97,-1621.53"/>
</g>
<!-- l0_gate_gpu4&#45;&gt;l0_expert_39_gpu4 -->
<g id="edge293" class="edge">
<title>l0_gate_gpu4&#45;&gt;l0_expert_39_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16586.25,-1705.94C16904.83,-1690.57 17384.84,-1662.67 17811.43,-1618.05"/>
<polygon fill="black" stroke="black" points="17811.92,-1621.51 17821.5,-1616.99 17811.19,-1614.55 17811.92,-1621.51"/>
</g>
<!-- l0_expert_agg_gpu4&#45;&gt;l0_res2_gpu4 -->
<g id="edge296" class="edge">
<title>l0_expert_agg_gpu4&#45;&gt;l0_res2_gpu4</title>
<path fill="none" stroke="black" d="M15835.94,-1377.95C15766.17,-1366.1 15696.17,-1354.22 15634.4,-1343.73"/>
<polygon fill="black" stroke="black" points="15634.61,-1340.22 15624.16,-1341.99 15633.44,-1347.12 15634.61,-1340.22"/>
</g>
<!-- l1_mha_qkv_gpu4 -->
<g id="node194" class="node">
<title>l1_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13853.57,-1203.95 13683.57,-1203.95 13683.57,-1150.95 13853.57,-1150.95 13853.57,-1203.95"/>
<text text-anchor="middle" x="13768.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="13768.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13768.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu4&#45;&gt;l1_mha_qkv_gpu4 -->
<g id="edge298" class="edge">
<title>l0_res2_gpu4&#45;&gt;l1_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M15212.4,-1306.54C14889.56,-1304.86 14298.55,-1297.42 14088.57,-1265.95 14006.76,-1253.69 13916.02,-1227.65 13852.12,-1207.15"/>
<polygon fill="black" stroke="black" points="13853.09,-1203.78 13842.5,-1204.03 13850.94,-1210.44 13853.09,-1203.78"/>
</g>
<!-- l1_res_add_gpu4 -->
<g id="node519" class="node">
<title>l1_res_add_gpu4</title>
<ellipse fill="none" stroke="black" cx="18090.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="18090.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu4</text>
</g>
<!-- l0_res2_gpu4&#45;&gt;l1_res_add_gpu4 -->
<g id="edge303" class="edge">
<title>l0_res2_gpu4&#45;&gt;l1_res_add_gpu4</title>
<path fill="none" stroke="black" d="M15646.68,-1307.54C16245.27,-1308.6 17882.2,-1307.66 17990.57,-1265.95 18023.45,-1253.3 18052.69,-1224.6 18070.93,-1203.5"/>
<polygon fill="black" stroke="black" points="18073.85,-1205.47 18077.59,-1195.56 18068.49,-1200.97 18073.85,-1205.47"/>
</g>
<!-- l0_mha_attn_gpu5 -->
<g id="node83" class="node">
<title>l0_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="17395.57,-2273.95 16923.57,-2273.95 16923.57,-2205.95 17395.57,-2205.95 17395.57,-2273.95"/>
<text text-anchor="middle" x="17159.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="17159.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17159.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="17159.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu5&#45;&gt;l0_mha_attn_gpu5 -->
<g id="edge332" class="edge">
<title>l0_mha_qkv_gpu5&#45;&gt;l0_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M17087.31,-2309.84C17096.84,-2300.75 17107.28,-2290.8 17117.19,-2281.35"/>
<polygon fill="black" stroke="black" points="17119.81,-2283.69 17124.64,-2274.25 17114.98,-2278.62 17119.81,-2283.69"/>
</g>
<!-- l0_mha_out_gpu5 -->
<g id="node84" class="node">
<title>l0_mha_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="18117.57,-2169.95 17657.57,-2169.95 17657.57,-2101.95 18117.57,-2101.95 18117.57,-2169.95"/>
<text text-anchor="middle" x="17887.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17887.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17887.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="17887.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu5&#45;&gt;l0_mha_out_gpu5 -->
<g id="edge333" class="edge">
<title>l0_mha_attn_gpu5&#45;&gt;l0_mha_out_gpu5</title>
<path fill="none" stroke="black" d="M17395.18,-2205.94C17475.84,-2194.64 17566.14,-2181.99 17647.18,-2170.63"/>
<polygon fill="black" stroke="black" points="17648.11,-2174.04 17657.52,-2169.18 17647.13,-2167.11 17648.11,-2174.04"/>
</g>
<!-- l0_mha_allreduce_gpu5 -->
<g id="node85" class="node">
<title>l0_mha_allreduce_gpu5</title>
<polygon fill="yellow" stroke="black" points="19065.47,-2065.95 18349.78,-2065.95 18165.67,-1929.95 18881.36,-1929.95 19065.47,-2065.95"/>
<text text-anchor="middle" x="18615.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18615.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="18615.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="18615.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu5&#45;&gt;l0_mha_allreduce_gpu5 -->
<g id="edge334" class="edge">
<title>l0_mha_out_gpu5&#45;&gt;l0_mha_allreduce_gpu5</title>
<path fill="none" stroke="black" d="M18064.26,-2101.94C18141.36,-2087.54 18233.86,-2070.26 18320.87,-2054.01"/>
<polygon fill="black" stroke="black" points="18321.72,-2057.41 18330.91,-2052.13 18320.44,-2050.53 18321.72,-2057.41"/>
</g>
<!-- l0_mha_allreduce_gpu5&#45;&gt;l0_res_add_gpu5 -->
<g id="edge335" class="edge">
<title>l0_mha_allreduce_gpu5&#45;&gt;l0_res_add_gpu5</title>
<path fill="none" stroke="black" d="M18901.59,-1944.81C18991.64,-1928.39 19088.85,-1910.67 19170.6,-1895.77"/>
<polygon fill="black" stroke="black" points="19171.28,-1899.2 19180.49,-1893.96 19170.03,-1892.31 19171.28,-1899.2"/>
</g>
<!-- l0_expert_40_gpu5 -->
<g id="node87" class="node">
<title>l0_expert_40_gpu5</title>
<polygon fill="lightpink" stroke="black" points="18745.57,-1617.95 18311.57,-1617.95 18311.57,-1549.95 18745.57,-1549.95 18745.57,-1617.95"/>
<text text-anchor="middle" x="18528.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="18528.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="18528.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="18528.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_40_gpu5 -->
<g id="edge339" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_40_gpu5</title>
<path fill="none" stroke="black" d="M19211.6,-1825.87C19168.38,-1815.39 19121.35,-1803.09 19078.57,-1789.95 18913.33,-1739.21 18725.58,-1665.7 18617.71,-1621.88"/>
<polygon fill="black" stroke="black" points="18618.75,-1618.53 18608.17,-1618 18616.11,-1625.01 18618.75,-1618.53"/>
</g>
<!-- l0_expert_41_gpu5 -->
<g id="node88" class="node">
<title>l0_expert_41_gpu5</title>
<polygon fill="lightpink" stroke="black" points="19197.57,-1617.95 18763.57,-1617.95 18763.57,-1549.95 19197.57,-1549.95 19197.57,-1617.95"/>
<text text-anchor="middle" x="18980.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="18980.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="18980.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="18980.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_41_gpu5 -->
<g id="edge342" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_41_gpu5</title>
<path fill="none" stroke="black" d="M19315.61,-1825.9C19245.1,-1775.19 19110.49,-1678.39 19035.13,-1624.19"/>
<polygon fill="black" stroke="black" points="19036.85,-1621.12 19026.69,-1618.12 19032.76,-1626.8 19036.85,-1621.12"/>
</g>
<!-- l0_expert_42_gpu5 -->
<g id="node89" class="node">
<title>l0_expert_42_gpu5</title>
<polygon fill="lightpink" stroke="black" points="19649.57,-1617.95 19215.57,-1617.95 19215.57,-1549.95 19649.57,-1549.95 19649.57,-1617.95"/>
<text text-anchor="middle" x="19432.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="19432.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="19432.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="19432.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_42_gpu5 -->
<g id="edge345" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_42_gpu5</title>
<path fill="none" stroke="black" d="M19355.3,-1825.85C19348.93,-1784.03 19343.01,-1710.66 19366.57,-1653.95 19370.81,-1643.76 19377.31,-1634.19 19384.6,-1625.63"/>
<polygon fill="black" stroke="black" points="19387.36,-1627.8 19391.49,-1618.05 19382.17,-1623.1 19387.36,-1627.8"/>
</g>
<!-- l0_expert_43_gpu5 -->
<g id="node90" class="node">
<title>l0_expert_43_gpu5</title>
<polygon fill="lightpink" stroke="black" points="20101.57,-1617.95 19667.57,-1617.95 19667.57,-1549.95 20101.57,-1549.95 20101.57,-1617.95"/>
<text text-anchor="middle" x="19884.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="19884.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="19884.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="19884.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_43_gpu5 -->
<g id="edge348" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_43_gpu5</title>
<path fill="none" stroke="black" d="M19365.58,-1825.73C19372.54,-1770.76 19387.27,-1665.71 19399.57,-1653.95 19439.61,-1615.68 19586.35,-1625.11 19657.53,-1617.88"/>
<polygon fill="black" stroke="black" points="19657.95,-1621.35 19667.46,-1616.68 19657.12,-1614.4 19657.95,-1621.35"/>
</g>
<!-- l0_expert_44_gpu5 -->
<g id="node91" class="node">
<title>l0_expert_44_gpu5</title>
<polygon fill="lightpink" stroke="black" points="20553.57,-1617.95 20119.57,-1617.95 20119.57,-1549.95 20553.57,-1549.95 20553.57,-1617.95"/>
<text text-anchor="middle" x="20336.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="20336.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="20336.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="20336.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_44_gpu5 -->
<g id="edge351" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_44_gpu5</title>
<path fill="none" stroke="black" d="M19578.73,-1859.48C19858.91,-1857.85 20316.82,-1846.44 20369.57,-1789.95 20410.31,-1746.33 20384.54,-1673.37 20361.25,-1627.27"/>
<polygon fill="black" stroke="black" points="20364.22,-1625.4 20356.5,-1618.15 20358.02,-1628.63 20364.22,-1625.4"/>
</g>
<!-- l0_expert_45_gpu5 -->
<g id="node92" class="node">
<title>l0_expert_45_gpu5</title>
<polygon fill="lightpink" stroke="black" points="21005.57,-1617.95 20571.57,-1617.95 20571.57,-1549.95 21005.57,-1549.95 21005.57,-1617.95"/>
<text text-anchor="middle" x="20788.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="20788.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="20788.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="20788.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_45_gpu5 -->
<g id="edge354" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_45_gpu5</title>
<path fill="none" stroke="black" d="M19578.71,-1854.85C19835.22,-1848.19 20245.77,-1831.29 20393.57,-1789.95 20522.63,-1753.85 20658.13,-1672.57 20732.1,-1623.89"/>
<polygon fill="black" stroke="black" points="20734.4,-1626.57 20740.81,-1618.13 20730.54,-1620.73 20734.4,-1626.57"/>
</g>
<!-- l0_expert_46_gpu5 -->
<g id="node93" class="node">
<title>l0_expert_46_gpu5</title>
<polygon fill="lightpink" stroke="black" points="21457.57,-1617.95 21023.57,-1617.95 21023.57,-1549.95 21457.57,-1549.95 21457.57,-1617.95"/>
<text text-anchor="middle" x="21240.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="21240.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="21240.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="21240.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_46_gpu5 -->
<g id="edge357" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_46_gpu5</title>
<path fill="none" stroke="black" d="M19578.64,-1852.36C19869.52,-1842.48 20370.07,-1821.57 20550.57,-1789.95 20767.03,-1752.04 21011.68,-1669.49 21143.67,-1621.51"/>
<polygon fill="black" stroke="black" points="21145.16,-1624.69 21153.36,-1617.97 21142.77,-1618.11 21145.16,-1624.69"/>
</g>
<!-- l0_expert_47_gpu5 -->
<g id="node94" class="node">
<title>l0_expert_47_gpu5</title>
<polygon fill="lightpink" stroke="black" points="21909.57,-1617.95 21475.57,-1617.95 21475.57,-1549.95 21909.57,-1549.95 21909.57,-1617.95"/>
<text text-anchor="middle" x="21692.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="21692.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="21692.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="21692.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_expert_47_gpu5 -->
<g id="edge360" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_expert_47_gpu5</title>
<path fill="none" stroke="black" d="M19578.58,-1853.45C19923.16,-1843.89 20580.12,-1822.12 20811.57,-1789.95 21086.4,-1751.76 21401.55,-1668.63 21570.44,-1620.79"/>
<polygon fill="black" stroke="black" points="21571.44,-1624.14 21580.1,-1618.04 21569.53,-1617.41 21571.44,-1624.14"/>
</g>
<!-- l0_gate_gpu5 -->
<g id="node95" class="node">
<title>l0_gate_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="20360.31,-1789.95 19603.51,-1789.95 19408.83,-1653.95 20165.62,-1653.95 20360.31,-1789.95"/>
<text text-anchor="middle" x="19884.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="19884.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="19884.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="19884.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_gate_gpu5 -->
<g id="edge337" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_gate_gpu5</title>
<path fill="none" stroke="black" d="M19488.51,-1825.94C19527.59,-1815.78 19572.18,-1804.19 19617.01,-1792.53"/>
<polygon fill="black" stroke="black" points="19618.08,-1795.87 19626.88,-1789.96 19616.32,-1789.09 19618.08,-1795.87"/>
</g>
<!-- l0_res2_gpu5 -->
<g id="node97" class="node">
<title>l0_res2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="18500.57,-1341.95 18066.57,-1341.95 18066.57,-1273.95 18500.57,-1273.95 18500.57,-1341.95"/>
<text text-anchor="middle" x="18283.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18283.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="18283.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="18283.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu5&#45;&gt;l0_res2_gpu5 -->
<g id="edge363" class="edge">
<title>l0_res_add_gpu5&#45;&gt;l0_res2_gpu5</title>
<path fill="none" stroke="black" d="M19144.48,-1852.37C19015.29,-1844.45 18849.11,-1827.23 18705.57,-1789.95 18517.08,-1741 18414.83,-1777.08 18302.57,-1617.95 18246.39,-1538.33 18260.26,-1416.51 18273.13,-1352.19"/>
<polygon fill="black" stroke="black" points="18276.56,-1352.88 18275.18,-1342.38 18269.71,-1351.45 18276.56,-1352.88"/>
</g>
<!-- l0_expert_agg_gpu5 -->
<g id="node96" class="node">
<title>l0_expert_agg_gpu5</title>
<polygon fill="yellow" stroke="black" points="20334.47,-1513.95 19618.78,-1513.95 19434.67,-1377.95 20150.36,-1377.95 20334.47,-1513.95"/>
<text text-anchor="middle" x="19884.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="19884.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="19884.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="19884.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_40_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge340" class="edge">
<title>l0_expert_40_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M18745.65,-1551.03C18748.64,-1550.66 18751.62,-1550.3 18754.57,-1549.95 19022.02,-1518.26 19326.1,-1491.04 19551.4,-1472.56"/>
<polygon fill="black" stroke="black" points="19551.71,-1476.04 19561.39,-1471.74 19551.14,-1469.07 19551.71,-1476.04"/>
</g>
<!-- l0_expert_41_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge343" class="edge">
<title>l0_expert_41_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M19197.67,-1550.29C19311.61,-1533.15 19453.11,-1511.86 19578.02,-1493.07"/>
<polygon fill="black" stroke="black" points="19578.77,-1496.5 19588.13,-1491.55 19577.73,-1489.58 19578.77,-1496.5"/>
</g>
<!-- l0_expert_42_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge346" class="edge">
<title>l0_expert_42_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M19542.27,-1549.94C19575.64,-1539.91 19613.64,-1528.47 19651.91,-1516.96"/>
<polygon fill="black" stroke="black" points="19653.07,-1520.26 19661.64,-1514.03 19651.06,-1513.56 19653.07,-1520.26"/>
</g>
<!-- l0_expert_43_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge349" class="edge">
<title>l0_expert_43_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M19884.57,-1549.68C19884.57,-1541.86 19884.57,-1533.19 19884.57,-1524.31"/>
<polygon fill="black" stroke="black" points="19888.07,-1524.22 19884.57,-1514.22 19881.07,-1524.22 19888.07,-1524.22"/>
</g>
<!-- l0_expert_44_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge352" class="edge">
<title>l0_expert_44_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M20226.86,-1549.94C20193.5,-1539.91 20155.49,-1528.47 20117.23,-1516.96"/>
<polygon fill="black" stroke="black" points="20118.08,-1513.56 20107.5,-1514.03 20116.07,-1520.26 20118.08,-1513.56"/>
</g>
<!-- l0_expert_45_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge355" class="edge">
<title>l0_expert_45_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M20571.46,-1550.29C20501.45,-1539.76 20421.03,-1527.66 20340.44,-1515.54"/>
<polygon fill="black" stroke="black" points="20340.51,-1512.01 20330.1,-1513.98 20339.47,-1518.93 20340.51,-1512.01"/>
</g>
<!-- l0_expert_46_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge358" class="edge">
<title>l0_expert_46_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M21023.49,-1551.03C21020.5,-1550.66 21017.52,-1550.3 21014.57,-1549.95 20777.11,-1521.82 20510.78,-1497.2 20296.35,-1479.1"/>
<polygon fill="black" stroke="black" points="20296.43,-1475.6 20286.17,-1478.24 20295.85,-1482.57 20296.43,-1475.6"/>
</g>
<!-- l0_expert_47_gpu5&#45;&gt;l0_expert_agg_gpu5 -->
<g id="edge361" class="edge">
<title>l0_expert_47_gpu5&#45;&gt;l0_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M21475.5,-1550.92C21472.5,-1550.59 21469.53,-1550.27 21466.57,-1549.95 21061.92,-1507.31 20597.07,-1479.57 20276.48,-1463.74"/>
<polygon fill="black" stroke="black" points="20276.25,-1460.22 20266.09,-1463.23 20275.9,-1467.21 20276.25,-1460.22"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_40_gpu5 -->
<g id="edge338" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_40_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19456.74,-1687.45C19248.16,-1669.73 18993.47,-1646.07 18755.88,-1618.09"/>
<polygon fill="black" stroke="black" points="18755.99,-1614.58 18745.65,-1616.88 18755.17,-1621.53 18755.99,-1614.58"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_41_gpu5 -->
<g id="edge341" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_41_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19439.19,-1653.95C19358.95,-1641.88 19278.44,-1629.77 19207.76,-1619.13"/>
<polygon fill="black" stroke="black" points="19208.27,-1615.67 19197.86,-1617.64 19207.23,-1622.59 19208.27,-1615.67"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_42_gpu5 -->
<g id="edge344" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_42_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19661.88,-1653.95C19624.05,-1642.57 19586.1,-1631.15 19552.27,-1620.97"/>
<polygon fill="black" stroke="black" points="19552.96,-1617.52 19542.38,-1617.99 19550.94,-1624.23 19552.96,-1617.52"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_43_gpu5 -->
<g id="edge347" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_43_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19884.57,-1653.75C19884.57,-1645 19884.57,-1636.23 19884.57,-1628.02"/>
<polygon fill="black" stroke="black" points="19888.07,-1627.97 19884.57,-1617.97 19881.07,-1627.97 19888.07,-1627.97"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_44_gpu5 -->
<g id="edge350" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_44_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20107.26,-1653.95C20145.08,-1642.57 20183.03,-1631.15 20216.87,-1620.97"/>
<polygon fill="black" stroke="black" points="20218.19,-1624.23 20226.76,-1617.99 20216.18,-1617.52 20218.19,-1624.23"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_45_gpu5 -->
<g id="edge353" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_45_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20195.04,-1674.24C20315.31,-1656.15 20450.45,-1635.82 20561.36,-1619.14"/>
<polygon fill="black" stroke="black" points="20561.97,-1622.58 20571.34,-1617.63 20560.93,-1615.66 20561.97,-1622.58"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_46_gpu5 -->
<g id="edge356" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_46_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20224.4,-1694.8C20446.27,-1676.55 20742.41,-1649.99 21013.45,-1618.07"/>
<polygon fill="black" stroke="black" points="21013.97,-1621.53 21023.49,-1616.88 21013.15,-1614.58 21013.97,-1621.53"/>
</g>
<!-- l0_gate_gpu5&#45;&gt;l0_expert_47_gpu5 -->
<g id="edge359" class="edge">
<title>l0_gate_gpu5&#45;&gt;l0_expert_47_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20240.25,-1705.94C20558.83,-1690.57 21038.84,-1662.67 21465.43,-1618.05"/>
<polygon fill="black" stroke="black" points="21465.92,-1621.51 21475.5,-1616.99 21465.19,-1614.55 21465.92,-1621.51"/>
</g>
<!-- l0_expert_agg_gpu5&#45;&gt;l0_res2_gpu5 -->
<g id="edge362" class="edge">
<title>l0_expert_agg_gpu5&#45;&gt;l0_res2_gpu5</title>
<path fill="none" stroke="black" d="M19478.5,-1410.46C19171.68,-1384.4 18761.79,-1349.58 18510.57,-1328.24"/>
<polygon fill="black" stroke="black" points="18510.85,-1324.75 18500.58,-1327.39 18510.25,-1331.72 18510.85,-1324.75"/>
</g>
<!-- l1_mha_qkv_gpu5 -->
<g id="node210" class="node">
<title>l1_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="14568.57,-1203.95 14398.57,-1203.95 14398.57,-1150.95 14568.57,-1150.95 14568.57,-1203.95"/>
<text text-anchor="middle" x="14483.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="14483.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14483.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu5&#45;&gt;l1_mha_qkv_gpu5 -->
<g id="edge364" class="edge">
<title>l0_res2_gpu5&#45;&gt;l1_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M18066.39,-1303.88C17616.6,-1297.59 16550.41,-1283.07 15655.57,-1273.95 15627.18,-1273.66 14660.95,-1273.47 14633.57,-1265.95 14593.35,-1254.91 14552.79,-1230.25 14524.01,-1209.91"/>
<polygon fill="black" stroke="black" points="14526,-1207.04 14515.84,-1204.04 14521.91,-1212.72 14526,-1207.04"/>
</g>
<!-- l1_res_add_gpu5 -->
<g id="node520" class="node">
<title>l1_res_add_gpu5</title>
<ellipse fill="none" stroke="black" cx="18283.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="18283.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu5</text>
</g>
<!-- l0_res2_gpu5&#45;&gt;l1_res_add_gpu5 -->
<g id="edge369" class="edge">
<title>l0_res2_gpu5&#45;&gt;l1_res_add_gpu5</title>
<path fill="none" stroke="black" d="M18283.57,-1273.86C18283.57,-1252.78 18283.57,-1225.79 18283.57,-1205.9"/>
<polygon fill="black" stroke="black" points="18287.07,-1205.67 18283.57,-1195.67 18280.07,-1205.67 18287.07,-1205.67"/>
</g>
<!-- l0_mha_attn_gpu6 -->
<g id="node99" class="node">
<title>l0_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20401.57,-2273.95 19929.57,-2273.95 19929.57,-2205.95 20401.57,-2205.95 20401.57,-2273.95"/>
<text text-anchor="middle" x="20165.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="20165.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="20165.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="20165.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu6&#45;&gt;l0_mha_attn_gpu6 -->
<g id="edge398" class="edge">
<title>l0_mha_qkv_gpu6&#45;&gt;l0_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M20165.57,-2309.84C20165.57,-2301.73 20165.57,-2292.94 20165.57,-2284.43"/>
<polygon fill="black" stroke="black" points="20169.07,-2284.25 20165.57,-2274.25 20162.07,-2284.25 20169.07,-2284.25"/>
</g>
<!-- l0_mha_out_gpu6 -->
<g id="node100" class="node">
<title>l0_mha_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20624.57,-2169.95 20164.57,-2169.95 20164.57,-2101.95 20624.57,-2101.95 20624.57,-2169.95"/>
<text text-anchor="middle" x="20394.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="20394.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="20394.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="20394.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu6&#45;&gt;l0_mha_out_gpu6 -->
<g id="edge399" class="edge">
<title>l0_mha_attn_gpu6&#45;&gt;l0_mha_out_gpu6</title>
<path fill="none" stroke="black" d="M20239.92,-2205.84C20262.63,-2195.72 20287.76,-2184.53 20311.04,-2174.16"/>
<polygon fill="black" stroke="black" points="20312.49,-2177.34 20320.2,-2170.08 20309.64,-2170.95 20312.49,-2177.34"/>
</g>
<!-- l0_mha_allreduce_gpu6 -->
<g id="node101" class="node">
<title>l0_mha_allreduce_gpu6</title>
<polygon fill="yellow" stroke="black" points="21073.47,-2065.95 20357.78,-2065.95 20173.67,-1929.95 20889.36,-1929.95 21073.47,-2065.95"/>
<text text-anchor="middle" x="20623.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20623.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="20623.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="20623.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu6&#45;&gt;l0_mha_allreduce_gpu6 -->
<g id="edge400" class="edge">
<title>l0_mha_out_gpu6&#45;&gt;l0_mha_allreduce_gpu6</title>
<path fill="none" stroke="black" d="M20450.3,-2101.86C20466,-2092.53 20483.72,-2082.01 20501.69,-2071.34"/>
<polygon fill="black" stroke="black" points="20503.71,-2074.21 20510.52,-2066.09 20500.13,-2068.19 20503.71,-2074.21"/>
</g>
<!-- l0_mha_allreduce_gpu6&#45;&gt;l0_res_add_gpu6 -->
<g id="edge401" class="edge">
<title>l0_mha_allreduce_gpu6&#45;&gt;l0_res_add_gpu6</title>
<path fill="none" stroke="black" d="M20931.17,-1960.6C21036.16,-1949.29 21154.37,-1937.75 21262.57,-1929.95 21809.23,-1890.58 22453.53,-1872.47 22788.1,-1865.18"/>
<polygon fill="black" stroke="black" points="22788.47,-1868.67 22798.39,-1864.96 22788.32,-1861.67 22788.47,-1868.67"/>
</g>
<!-- l0_expert_48_gpu6 -->
<g id="node103" class="node">
<title>l0_expert_48_gpu6</title>
<polygon fill="lightpink" stroke="black" points="22399.57,-1617.95 21965.57,-1617.95 21965.57,-1549.95 22399.57,-1549.95 22399.57,-1617.95"/>
<text text-anchor="middle" x="22182.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="22182.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22182.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="22182.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_48_gpu6 -->
<g id="edge405" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_48_gpu6</title>
<path fill="none" stroke="black" d="M22865.6,-1825.87C22822.38,-1815.39 22775.35,-1803.09 22732.57,-1789.95 22567.33,-1739.21 22379.58,-1665.7 22271.71,-1621.88"/>
<polygon fill="black" stroke="black" points="22272.75,-1618.53 22262.17,-1618 22270.11,-1625.01 22272.75,-1618.53"/>
</g>
<!-- l0_expert_49_gpu6 -->
<g id="node104" class="node">
<title>l0_expert_49_gpu6</title>
<polygon fill="lightpink" stroke="black" points="22851.57,-1617.95 22417.57,-1617.95 22417.57,-1549.95 22851.57,-1549.95 22851.57,-1617.95"/>
<text text-anchor="middle" x="22634.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="22634.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22634.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="22634.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_49_gpu6 -->
<g id="edge408" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_49_gpu6</title>
<path fill="none" stroke="black" d="M22969.61,-1825.9C22899.1,-1775.19 22764.49,-1678.39 22689.13,-1624.19"/>
<polygon fill="black" stroke="black" points="22690.85,-1621.12 22680.69,-1618.12 22686.76,-1626.8 22690.85,-1621.12"/>
</g>
<!-- l0_expert_50_gpu6 -->
<g id="node105" class="node">
<title>l0_expert_50_gpu6</title>
<polygon fill="lightpink" stroke="black" points="23303.57,-1617.95 22869.57,-1617.95 22869.57,-1549.95 23303.57,-1549.95 23303.57,-1617.95"/>
<text text-anchor="middle" x="23086.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="23086.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23086.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23086.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_50_gpu6 -->
<g id="edge411" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_50_gpu6</title>
<path fill="none" stroke="black" d="M23009.3,-1825.85C23002.93,-1784.03 22997.01,-1710.66 23020.57,-1653.95 23024.81,-1643.76 23031.31,-1634.19 23038.6,-1625.63"/>
<polygon fill="black" stroke="black" points="23041.36,-1627.8 23045.49,-1618.05 23036.17,-1623.1 23041.36,-1627.8"/>
</g>
<!-- l0_expert_51_gpu6 -->
<g id="node106" class="node">
<title>l0_expert_51_gpu6</title>
<polygon fill="lightpink" stroke="black" points="23755.57,-1617.95 23321.57,-1617.95 23321.57,-1549.95 23755.57,-1549.95 23755.57,-1617.95"/>
<text text-anchor="middle" x="23538.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="23538.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23538.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23538.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_51_gpu6 -->
<g id="edge414" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_51_gpu6</title>
<path fill="none" stroke="black" d="M23019.58,-1825.73C23026.54,-1770.76 23041.27,-1665.71 23053.57,-1653.95 23093.61,-1615.68 23240.35,-1625.11 23311.53,-1617.88"/>
<polygon fill="black" stroke="black" points="23311.95,-1621.35 23321.46,-1616.68 23311.12,-1614.4 23311.95,-1621.35"/>
</g>
<!-- l0_expert_52_gpu6 -->
<g id="node107" class="node">
<title>l0_expert_52_gpu6</title>
<polygon fill="lightpink" stroke="black" points="24207.57,-1617.95 23773.57,-1617.95 23773.57,-1549.95 24207.57,-1549.95 24207.57,-1617.95"/>
<text text-anchor="middle" x="23990.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="23990.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23990.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23990.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_52_gpu6 -->
<g id="edge417" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_52_gpu6</title>
<path fill="none" stroke="black" d="M23232.73,-1859.48C23512.91,-1857.85 23970.82,-1846.44 24023.57,-1789.95 24064.31,-1746.33 24038.54,-1673.37 24015.25,-1627.27"/>
<polygon fill="black" stroke="black" points="24018.22,-1625.4 24010.5,-1618.15 24012.02,-1628.63 24018.22,-1625.4"/>
</g>
<!-- l0_expert_53_gpu6 -->
<g id="node108" class="node">
<title>l0_expert_53_gpu6</title>
<polygon fill="lightpink" stroke="black" points="24659.57,-1617.95 24225.57,-1617.95 24225.57,-1549.95 24659.57,-1549.95 24659.57,-1617.95"/>
<text text-anchor="middle" x="24442.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="24442.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="24442.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="24442.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_53_gpu6 -->
<g id="edge420" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_53_gpu6</title>
<path fill="none" stroke="black" d="M23232.71,-1854.85C23489.22,-1848.19 23899.77,-1831.29 24047.57,-1789.95 24176.63,-1753.85 24312.13,-1672.57 24386.1,-1623.89"/>
<polygon fill="black" stroke="black" points="24388.4,-1626.57 24394.81,-1618.13 24384.54,-1620.73 24388.4,-1626.57"/>
</g>
<!-- l0_expert_54_gpu6 -->
<g id="node109" class="node">
<title>l0_expert_54_gpu6</title>
<polygon fill="lightpink" stroke="black" points="25111.57,-1617.95 24677.57,-1617.95 24677.57,-1549.95 25111.57,-1549.95 25111.57,-1617.95"/>
<text text-anchor="middle" x="24894.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="24894.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="24894.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="24894.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_54_gpu6 -->
<g id="edge423" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_54_gpu6</title>
<path fill="none" stroke="black" d="M23232.64,-1852.36C23523.52,-1842.48 24024.07,-1821.57 24204.57,-1789.95 24421.03,-1752.04 24665.68,-1669.49 24797.67,-1621.51"/>
<polygon fill="black" stroke="black" points="24799.16,-1624.69 24807.36,-1617.97 24796.77,-1618.11 24799.16,-1624.69"/>
</g>
<!-- l0_expert_55_gpu6 -->
<g id="node110" class="node">
<title>l0_expert_55_gpu6</title>
<polygon fill="lightpink" stroke="black" points="25563.57,-1617.95 25129.57,-1617.95 25129.57,-1549.95 25563.57,-1549.95 25563.57,-1617.95"/>
<text text-anchor="middle" x="25346.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="25346.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="25346.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="25346.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_expert_55_gpu6 -->
<g id="edge426" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_expert_55_gpu6</title>
<path fill="none" stroke="black" d="M23232.58,-1853.45C23577.16,-1843.89 24234.12,-1822.12 24465.57,-1789.95 24740.4,-1751.76 25055.55,-1668.63 25224.44,-1620.79"/>
<polygon fill="black" stroke="black" points="25225.44,-1624.14 25234.1,-1618.04 25223.53,-1617.41 25225.44,-1624.14"/>
</g>
<!-- l0_gate_gpu6 -->
<g id="node111" class="node">
<title>l0_gate_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="24014.31,-1789.95 23257.51,-1789.95 23062.83,-1653.95 23819.62,-1653.95 24014.31,-1789.95"/>
<text text-anchor="middle" x="23538.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="23538.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23538.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23538.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_gate_gpu6 -->
<g id="edge403" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_gate_gpu6</title>
<path fill="none" stroke="black" d="M23142.51,-1825.94C23181.59,-1815.78 23226.18,-1804.19 23271.01,-1792.53"/>
<polygon fill="black" stroke="black" points="23272.08,-1795.87 23280.88,-1789.96 23270.32,-1789.09 23272.08,-1795.87"/>
</g>
<!-- l0_res2_gpu6 -->
<g id="node113" class="node">
<title>l0_res2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="20553.57,-1341.95 20119.57,-1341.95 20119.57,-1273.95 20553.57,-1273.95 20553.57,-1341.95"/>
<text text-anchor="middle" x="20336.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20336.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="20336.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="20336.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu6&#45;&gt;l0_res2_gpu6 -->
<g id="edge429" class="edge">
<title>l0_res_add_gpu6&#45;&gt;l0_res2_gpu6</title>
<path fill="none" stroke="black" d="M22798.48,-1852.37C22669.29,-1844.45 22503.11,-1827.23 22359.57,-1789.95 22171.08,-1741 22101.39,-1748.15 21956.57,-1617.95 21930.82,-1594.81 21947.02,-1569.68 21918.57,-1549.95 21703.43,-1400.81 20947.73,-1340.65 20563.92,-1319.28"/>
<polygon fill="black" stroke="black" points="20563.98,-1315.78 20553.8,-1318.72 20563.59,-1322.77 20563.98,-1315.78"/>
</g>
<!-- l0_expert_agg_gpu6 -->
<g id="node112" class="node">
<title>l0_expert_agg_gpu6</title>
<polygon fill="yellow" stroke="black" points="23988.47,-1513.95 23272.78,-1513.95 23088.67,-1377.95 23804.36,-1377.95 23988.47,-1513.95"/>
<text text-anchor="middle" x="23538.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="23538.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23538.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23538.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_48_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge406" class="edge">
<title>l0_expert_48_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M22399.65,-1551.03C22402.64,-1550.66 22405.62,-1550.3 22408.57,-1549.95 22676.02,-1518.26 22980.1,-1491.04 23205.4,-1472.56"/>
<polygon fill="black" stroke="black" points="23205.71,-1476.04 23215.39,-1471.74 23205.14,-1469.07 23205.71,-1476.04"/>
</g>
<!-- l0_expert_49_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge409" class="edge">
<title>l0_expert_49_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M22851.67,-1550.29C22965.61,-1533.15 23107.11,-1511.86 23232.02,-1493.07"/>
<polygon fill="black" stroke="black" points="23232.77,-1496.5 23242.13,-1491.55 23231.73,-1489.58 23232.77,-1496.5"/>
</g>
<!-- l0_expert_50_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge412" class="edge">
<title>l0_expert_50_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M23196.27,-1549.94C23229.64,-1539.91 23267.64,-1528.47 23305.91,-1516.96"/>
<polygon fill="black" stroke="black" points="23307.07,-1520.26 23315.64,-1514.03 23305.06,-1513.56 23307.07,-1520.26"/>
</g>
<!-- l0_expert_51_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge415" class="edge">
<title>l0_expert_51_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M23538.57,-1549.68C23538.57,-1541.86 23538.57,-1533.19 23538.57,-1524.31"/>
<polygon fill="black" stroke="black" points="23542.07,-1524.22 23538.57,-1514.22 23535.07,-1524.22 23542.07,-1524.22"/>
</g>
<!-- l0_expert_52_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge418" class="edge">
<title>l0_expert_52_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M23880.86,-1549.94C23847.5,-1539.91 23809.49,-1528.47 23771.23,-1516.96"/>
<polygon fill="black" stroke="black" points="23772.08,-1513.56 23761.5,-1514.03 23770.07,-1520.26 23772.08,-1513.56"/>
</g>
<!-- l0_expert_53_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge421" class="edge">
<title>l0_expert_53_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M24225.46,-1550.29C24155.45,-1539.76 24075.03,-1527.66 23994.44,-1515.54"/>
<polygon fill="black" stroke="black" points="23994.51,-1512.01 23984.1,-1513.98 23993.47,-1518.93 23994.51,-1512.01"/>
</g>
<!-- l0_expert_54_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge424" class="edge">
<title>l0_expert_54_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M24677.49,-1551.03C24674.5,-1550.66 24671.52,-1550.3 24668.57,-1549.95 24431.11,-1521.82 24164.78,-1497.2 23950.35,-1479.1"/>
<polygon fill="black" stroke="black" points="23950.43,-1475.6 23940.17,-1478.24 23949.85,-1482.57 23950.43,-1475.6"/>
</g>
<!-- l0_expert_55_gpu6&#45;&gt;l0_expert_agg_gpu6 -->
<g id="edge427" class="edge">
<title>l0_expert_55_gpu6&#45;&gt;l0_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M25129.5,-1550.92C25126.5,-1550.59 25123.53,-1550.27 25120.57,-1549.95 24715.92,-1507.31 24251.07,-1479.57 23930.48,-1463.74"/>
<polygon fill="black" stroke="black" points="23930.25,-1460.22 23920.09,-1463.23 23929.9,-1467.21 23930.25,-1460.22"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_48_gpu6 -->
<g id="edge404" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_48_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23110.74,-1687.45C22902.16,-1669.73 22647.47,-1646.07 22409.88,-1618.09"/>
<polygon fill="black" stroke="black" points="22409.99,-1614.58 22399.65,-1616.88 22409.17,-1621.53 22409.99,-1614.58"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_49_gpu6 -->
<g id="edge407" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_49_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23093.19,-1653.95C23012.95,-1641.88 22932.44,-1629.77 22861.76,-1619.13"/>
<polygon fill="black" stroke="black" points="22862.27,-1615.67 22851.86,-1617.64 22861.23,-1622.59 22862.27,-1615.67"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_50_gpu6 -->
<g id="edge410" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_50_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23315.88,-1653.95C23278.05,-1642.57 23240.1,-1631.15 23206.27,-1620.97"/>
<polygon fill="black" stroke="black" points="23206.96,-1617.52 23196.38,-1617.99 23204.94,-1624.23 23206.96,-1617.52"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_51_gpu6 -->
<g id="edge413" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_51_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23538.57,-1653.75C23538.57,-1645 23538.57,-1636.23 23538.57,-1628.02"/>
<polygon fill="black" stroke="black" points="23542.07,-1627.97 23538.57,-1617.97 23535.07,-1627.97 23542.07,-1627.97"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_52_gpu6 -->
<g id="edge416" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_52_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23761.26,-1653.95C23799.08,-1642.57 23837.03,-1631.15 23870.87,-1620.97"/>
<polygon fill="black" stroke="black" points="23872.19,-1624.23 23880.76,-1617.99 23870.18,-1617.52 23872.19,-1624.23"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_53_gpu6 -->
<g id="edge419" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_53_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23849.04,-1674.24C23969.31,-1656.15 24104.45,-1635.82 24215.36,-1619.14"/>
<polygon fill="black" stroke="black" points="24215.97,-1622.58 24225.34,-1617.63 24214.93,-1615.66 24215.97,-1622.58"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_54_gpu6 -->
<g id="edge422" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_54_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23878.4,-1694.8C24100.27,-1676.55 24396.41,-1649.99 24667.45,-1618.07"/>
<polygon fill="black" stroke="black" points="24667.97,-1621.53 24677.49,-1616.88 24667.15,-1614.58 24667.97,-1621.53"/>
</g>
<!-- l0_gate_gpu6&#45;&gt;l0_expert_55_gpu6 -->
<g id="edge425" class="edge">
<title>l0_gate_gpu6&#45;&gt;l0_expert_55_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23894.25,-1705.94C24212.83,-1690.57 24692.84,-1662.67 25119.43,-1618.05"/>
<polygon fill="black" stroke="black" points="25119.92,-1621.51 25129.5,-1616.99 25119.19,-1614.55 25119.92,-1621.51"/>
</g>
<!-- l0_expert_agg_gpu6&#45;&gt;l0_res2_gpu6 -->
<g id="edge428" class="edge">
<title>l0_expert_agg_gpu6&#45;&gt;l0_res2_gpu6</title>
<path fill="none" stroke="black" d="M23157.1,-1428.75C22484.4,-1400.18 21107.1,-1341.68 20563.99,-1318.61"/>
<polygon fill="black" stroke="black" points="20563.82,-1315.1 20553.68,-1318.17 20563.52,-1322.1 20563.82,-1315.1"/>
</g>
<!-- l1_mha_qkv_gpu6 -->
<g id="node226" class="node">
<title>l1_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="15566.57,-1203.95 15396.57,-1203.95 15396.57,-1150.95 15566.57,-1150.95 15566.57,-1203.95"/>
<text text-anchor="middle" x="15481.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="15481.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15481.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu6&#45;&gt;l1_mha_qkv_gpu6 -->
<g id="edge430" class="edge">
<title>l0_res2_gpu6&#45;&gt;l1_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M20119.33,-1301.96C19777.05,-1294.34 19091.27,-1280.04 18509.57,-1273.95 18470.92,-1273.55 15764.64,-1272.61 15726.57,-1265.95 15662.96,-1254.84 15593.98,-1228.85 15545.48,-1208.06"/>
<polygon fill="black" stroke="black" points="15546.62,-1204.75 15536.06,-1203.98 15543.84,-1211.17 15546.62,-1204.75"/>
</g>
<!-- l1_res_add_gpu6 -->
<g id="node521" class="node">
<title>l1_res_add_gpu6</title>
<ellipse fill="none" stroke="black" cx="18476.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="18476.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu6</text>
</g>
<!-- l0_res2_gpu6&#45;&gt;l1_res_add_gpu6 -->
<g id="edge435" class="edge">
<title>l0_res2_gpu6&#45;&gt;l1_res_add_gpu6</title>
<path fill="none" stroke="black" d="M20119.38,-1305.95C19663.55,-1303.29 18643.08,-1294.21 18572.57,-1265.95 18540.6,-1253.14 18512.61,-1224.47 18495.22,-1203.43"/>
<polygon fill="black" stroke="black" points="18497.86,-1201.12 18488.88,-1195.51 18492.4,-1205.5 18497.86,-1201.12"/>
</g>
<!-- l0_mha_attn_gpu7 -->
<g id="node115" class="node">
<title>l0_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="25983.57,-2273.95 25511.57,-2273.95 25511.57,-2205.95 25983.57,-2205.95 25983.57,-2273.95"/>
<text text-anchor="middle" x="25747.57" y="-2258.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="25747.57" y="-2243.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="25747.57" y="-2228.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="25747.57" y="-2213.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- l0_mha_qkv_gpu7&#45;&gt;l0_mha_attn_gpu7 -->
<g id="edge464" class="edge">
<title>l0_mha_qkv_gpu7&#45;&gt;l0_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M23178.7,-2334.37C23704.24,-2315.26 24966.19,-2269.37 25501.17,-2249.91"/>
<polygon fill="black" stroke="black" points="25501.47,-2253.4 25511.34,-2249.54 25501.22,-2246.41 25501.47,-2253.4"/>
</g>
<!-- l0_mha_out_gpu7 -->
<g id="node116" class="node">
<title>l0_mha_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="26207.57,-2169.95 25747.57,-2169.95 25747.57,-2101.95 26207.57,-2101.95 26207.57,-2169.95"/>
<text text-anchor="middle" x="25977.57" y="-2154.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="25977.57" y="-2139.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="25977.57" y="-2124.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="25977.57" y="-2109.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=1024]</text>
</g>
<!-- l0_mha_attn_gpu7&#45;&gt;l0_mha_out_gpu7 -->
<g id="edge465" class="edge">
<title>l0_mha_attn_gpu7&#45;&gt;l0_mha_out_gpu7</title>
<path fill="none" stroke="black" d="M25822.24,-2205.84C25845.06,-2195.72 25870.29,-2184.53 25893.67,-2174.16"/>
<polygon fill="black" stroke="black" points="25895.15,-2177.33 25902.88,-2170.08 25892.32,-2170.93 25895.15,-2177.33"/>
</g>
<!-- l0_mha_allreduce_gpu7 -->
<g id="node117" class="node">
<title>l0_mha_allreduce_gpu7</title>
<polygon fill="yellow" stroke="black" points="26658.47,-2065.95 25942.78,-2065.95 25758.67,-1929.95 26474.36,-1929.95 26658.47,-2065.95"/>
<text text-anchor="middle" x="26208.57" y="-2016.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="26208.57" y="-2001.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26208.57" y="-1986.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=1024]</text>
<text text-anchor="middle" x="26208.57" y="-1971.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_mha_out_gpu7&#45;&gt;l0_mha_allreduce_gpu7 -->
<g id="edge466" class="edge">
<title>l0_mha_out_gpu7&#45;&gt;l0_mha_allreduce_gpu7</title>
<path fill="none" stroke="black" d="M26033.78,-2101.86C26049.62,-2092.53 26067.5,-2082.01 26085.62,-2071.34"/>
<polygon fill="black" stroke="black" points="26087.69,-2074.18 26094.53,-2066.09 26084.14,-2068.15 26087.69,-2074.18"/>
</g>
<!-- l0_mha_allreduce_gpu7&#45;&gt;l0_res_add_gpu7 -->
<g id="edge467" class="edge">
<title>l0_mha_allreduce_gpu7&#45;&gt;l0_res_add_gpu7</title>
<path fill="none" stroke="black" d="M26435.69,-1929.95C26474.44,-1918.52 26513.31,-1907.05 26547.93,-1896.84"/>
<polygon fill="black" stroke="black" points="26548.97,-1900.18 26557.57,-1893.99 26546.99,-1893.47 26548.97,-1900.18"/>
</g>
<!-- l0_expert_56_gpu7 -->
<g id="node119" class="node">
<title>l0_expert_56_gpu7</title>
<polygon fill="lightpink" stroke="black" points="26053.57,-1617.95 25619.57,-1617.95 25619.57,-1549.95 26053.57,-1549.95 26053.57,-1617.95"/>
<text text-anchor="middle" x="25836.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="25836.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="25836.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="25836.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_56_gpu7 -->
<g id="edge471" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_56_gpu7</title>
<path fill="none" stroke="black" d="M26519.6,-1825.87C26476.38,-1815.39 26429.35,-1803.09 26386.57,-1789.95 26221.33,-1739.21 26033.58,-1665.7 25925.71,-1621.88"/>
<polygon fill="black" stroke="black" points="25926.75,-1618.53 25916.17,-1618 25924.11,-1625.01 25926.75,-1618.53"/>
</g>
<!-- l0_expert_57_gpu7 -->
<g id="node120" class="node">
<title>l0_expert_57_gpu7</title>
<polygon fill="lightpink" stroke="black" points="26505.57,-1617.95 26071.57,-1617.95 26071.57,-1549.95 26505.57,-1549.95 26505.57,-1617.95"/>
<text text-anchor="middle" x="26288.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="26288.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26288.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="26288.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_57_gpu7 -->
<g id="edge474" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_57_gpu7</title>
<path fill="none" stroke="black" d="M26623.61,-1825.9C26553.1,-1775.19 26418.49,-1678.39 26343.13,-1624.19"/>
<polygon fill="black" stroke="black" points="26344.85,-1621.12 26334.69,-1618.12 26340.76,-1626.8 26344.85,-1621.12"/>
</g>
<!-- l0_expert_58_gpu7 -->
<g id="node121" class="node">
<title>l0_expert_58_gpu7</title>
<polygon fill="lightpink" stroke="black" points="26957.57,-1617.95 26523.57,-1617.95 26523.57,-1549.95 26957.57,-1549.95 26957.57,-1617.95"/>
<text text-anchor="middle" x="26740.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="26740.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="26740.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="26740.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_58_gpu7 -->
<g id="edge477" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_58_gpu7</title>
<path fill="none" stroke="black" d="M26663.3,-1825.85C26656.93,-1784.03 26651.01,-1710.66 26674.57,-1653.95 26678.81,-1643.76 26685.31,-1634.19 26692.6,-1625.63"/>
<polygon fill="black" stroke="black" points="26695.36,-1627.8 26699.49,-1618.05 26690.17,-1623.1 26695.36,-1627.8"/>
</g>
<!-- l0_expert_59_gpu7 -->
<g id="node122" class="node">
<title>l0_expert_59_gpu7</title>
<polygon fill="lightpink" stroke="black" points="27409.57,-1617.95 26975.57,-1617.95 26975.57,-1549.95 27409.57,-1549.95 27409.57,-1617.95"/>
<text text-anchor="middle" x="27192.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="27192.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="27192.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="27192.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_59_gpu7 -->
<g id="edge480" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_59_gpu7</title>
<path fill="none" stroke="black" d="M26673.58,-1825.73C26680.54,-1770.76 26695.27,-1665.71 26707.57,-1653.95 26747.61,-1615.68 26894.35,-1625.11 26965.53,-1617.88"/>
<polygon fill="black" stroke="black" points="26965.95,-1621.35 26975.46,-1616.68 26965.12,-1614.4 26965.95,-1621.35"/>
</g>
<!-- l0_expert_60_gpu7 -->
<g id="node123" class="node">
<title>l0_expert_60_gpu7</title>
<polygon fill="lightpink" stroke="black" points="27861.57,-1617.95 27427.57,-1617.95 27427.57,-1549.95 27861.57,-1549.95 27861.57,-1617.95"/>
<text text-anchor="middle" x="27644.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="27644.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="27644.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="27644.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_60_gpu7 -->
<g id="edge483" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_60_gpu7</title>
<path fill="none" stroke="black" d="M26886.73,-1859.48C27166.91,-1857.85 27624.82,-1846.44 27677.57,-1789.95 27718.31,-1746.33 27692.54,-1673.37 27669.25,-1627.27"/>
<polygon fill="black" stroke="black" points="27672.22,-1625.4 27664.5,-1618.15 27666.02,-1628.63 27672.22,-1625.4"/>
</g>
<!-- l0_expert_61_gpu7 -->
<g id="node124" class="node">
<title>l0_expert_61_gpu7</title>
<polygon fill="lightpink" stroke="black" points="28313.57,-1617.95 27879.57,-1617.95 27879.57,-1549.95 28313.57,-1549.95 28313.57,-1617.95"/>
<text text-anchor="middle" x="28096.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="28096.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="28096.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="28096.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_61_gpu7 -->
<g id="edge486" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_61_gpu7</title>
<path fill="none" stroke="black" d="M26886.71,-1854.85C27143.22,-1848.19 27553.77,-1831.29 27701.57,-1789.95 27830.63,-1753.85 27966.13,-1672.57 28040.1,-1623.89"/>
<polygon fill="black" stroke="black" points="28042.4,-1626.57 28048.81,-1618.13 28038.54,-1620.73 28042.4,-1626.57"/>
</g>
<!-- l0_expert_62_gpu7 -->
<g id="node125" class="node">
<title>l0_expert_62_gpu7</title>
<polygon fill="lightpink" stroke="black" points="28765.57,-1617.95 28331.57,-1617.95 28331.57,-1549.95 28765.57,-1549.95 28765.57,-1617.95"/>
<text text-anchor="middle" x="28548.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="28548.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="28548.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="28548.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_62_gpu7 -->
<g id="edge489" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_62_gpu7</title>
<path fill="none" stroke="black" d="M26886.64,-1852.36C27177.52,-1842.48 27678.07,-1821.57 27858.57,-1789.95 28075.03,-1752.04 28319.68,-1669.49 28451.67,-1621.51"/>
<polygon fill="black" stroke="black" points="28453.16,-1624.69 28461.36,-1617.97 28450.77,-1618.11 28453.16,-1624.69"/>
</g>
<!-- l0_expert_63_gpu7 -->
<g id="node126" class="node">
<title>l0_expert_63_gpu7</title>
<polygon fill="lightpink" stroke="black" points="29217.57,-1617.95 28783.57,-1617.95 28783.57,-1549.95 29217.57,-1549.95 29217.57,-1617.95"/>
<text text-anchor="middle" x="29000.57" y="-1602.75" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="29000.57" y="-1587.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="29000.57" y="-1572.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="29000.57" y="-1557.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_expert_63_gpu7 -->
<g id="edge492" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_expert_63_gpu7</title>
<path fill="none" stroke="black" d="M26886.58,-1853.45C27231.16,-1843.89 27888.12,-1822.12 28119.57,-1789.95 28394.4,-1751.76 28709.55,-1668.63 28878.44,-1620.79"/>
<polygon fill="black" stroke="black" points="28879.44,-1624.14 28888.1,-1618.04 28877.53,-1617.41 28879.44,-1624.14"/>
</g>
<!-- l0_gate_gpu7 -->
<g id="node127" class="node">
<title>l0_gate_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="27668.31,-1789.95 26911.51,-1789.95 26716.83,-1653.95 27473.62,-1653.95 27668.31,-1789.95"/>
<text text-anchor="middle" x="27192.57" y="-1740.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="27192.57" y="-1725.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="27192.57" y="-1710.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="27192.57" y="-1695.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_gate_gpu7 -->
<g id="edge469" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_gate_gpu7</title>
<path fill="none" stroke="black" d="M26796.51,-1825.94C26835.59,-1815.78 26880.18,-1804.19 26925.01,-1792.53"/>
<polygon fill="black" stroke="black" points="26926.08,-1795.87 26934.88,-1789.96 26924.32,-1789.09 26926.08,-1795.87"/>
</g>
<!-- l0_res2_gpu7 -->
<g id="node129" class="node">
<title>l0_res2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="23406.57,-1341.95 22972.57,-1341.95 22972.57,-1273.95 23406.57,-1273.95 23406.57,-1341.95"/>
<text text-anchor="middle" x="23189.57" y="-1326.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="23189.57" y="-1311.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="23189.57" y="-1296.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="23189.57" y="-1281.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_res_add_gpu7&#45;&gt;l0_res2_gpu7 -->
<g id="edge495" class="edge">
<title>l0_res_add_gpu7&#45;&gt;l0_res2_gpu7</title>
<path fill="none" stroke="black" d="M26452.48,-1852.37C26323.29,-1844.45 26157.11,-1827.23 26013.57,-1789.95 25825.08,-1741 25755.39,-1748.15 25610.57,-1617.95 25584.82,-1594.81 25601.43,-1569.07 25572.57,-1549.95 24985.5,-1161.12 24698.42,-1446.14 23997.57,-1377.95 23801.64,-1358.89 23578.7,-1340.07 23416.7,-1326.91"/>
<polygon fill="black" stroke="black" points="23416.86,-1323.41 23406.61,-1326.09 23416.29,-1330.39 23416.86,-1323.41"/>
</g>
<!-- l0_expert_agg_gpu7 -->
<g id="node128" class="node">
<title>l0_expert_agg_gpu7</title>
<polygon fill="yellow" stroke="black" points="27642.47,-1513.95 26926.78,-1513.95 26742.67,-1377.95 27458.36,-1377.95 27642.47,-1513.95"/>
<text text-anchor="middle" x="27192.57" y="-1464.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="27192.57" y="-1449.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="27192.57" y="-1434.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="27192.57" y="-1419.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l0_expert_56_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge472" class="edge">
<title>l0_expert_56_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M26053.65,-1551.03C26056.64,-1550.66 26059.62,-1550.3 26062.57,-1549.95 26330.02,-1518.26 26634.1,-1491.04 26859.4,-1472.56"/>
<polygon fill="black" stroke="black" points="26859.71,-1476.04 26869.39,-1471.74 26859.14,-1469.07 26859.71,-1476.04"/>
</g>
<!-- l0_expert_57_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge475" class="edge">
<title>l0_expert_57_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M26505.67,-1550.29C26619.61,-1533.15 26761.11,-1511.86 26886.02,-1493.07"/>
<polygon fill="black" stroke="black" points="26886.77,-1496.5 26896.13,-1491.55 26885.73,-1489.58 26886.77,-1496.5"/>
</g>
<!-- l0_expert_58_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge478" class="edge">
<title>l0_expert_58_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M26850.27,-1549.94C26883.64,-1539.91 26921.64,-1528.47 26959.91,-1516.96"/>
<polygon fill="black" stroke="black" points="26961.07,-1520.26 26969.64,-1514.03 26959.06,-1513.56 26961.07,-1520.26"/>
</g>
<!-- l0_expert_59_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge481" class="edge">
<title>l0_expert_59_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M27192.57,-1549.68C27192.57,-1541.86 27192.57,-1533.19 27192.57,-1524.31"/>
<polygon fill="black" stroke="black" points="27196.07,-1524.22 27192.57,-1514.22 27189.07,-1524.22 27196.07,-1524.22"/>
</g>
<!-- l0_expert_60_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge484" class="edge">
<title>l0_expert_60_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M27534.86,-1549.94C27501.5,-1539.91 27463.49,-1528.47 27425.23,-1516.96"/>
<polygon fill="black" stroke="black" points="27426.08,-1513.56 27415.5,-1514.03 27424.07,-1520.26 27426.08,-1513.56"/>
</g>
<!-- l0_expert_61_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge487" class="edge">
<title>l0_expert_61_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M27879.46,-1550.29C27809.45,-1539.76 27729.03,-1527.66 27648.44,-1515.54"/>
<polygon fill="black" stroke="black" points="27648.51,-1512.01 27638.1,-1513.98 27647.47,-1518.93 27648.51,-1512.01"/>
</g>
<!-- l0_expert_62_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge490" class="edge">
<title>l0_expert_62_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M28331.49,-1551.03C28328.5,-1550.66 28325.52,-1550.3 28322.57,-1549.95 28085.11,-1521.82 27818.78,-1497.2 27604.35,-1479.1"/>
<polygon fill="black" stroke="black" points="27604.43,-1475.6 27594.17,-1478.24 27603.85,-1482.57 27604.43,-1475.6"/>
</g>
<!-- l0_expert_63_gpu7&#45;&gt;l0_expert_agg_gpu7 -->
<g id="edge493" class="edge">
<title>l0_expert_63_gpu7&#45;&gt;l0_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M28783.5,-1550.92C28780.5,-1550.59 28777.53,-1550.27 28774.57,-1549.95 28369.92,-1507.31 27905.07,-1479.57 27584.48,-1463.74"/>
<polygon fill="black" stroke="black" points="27584.25,-1460.22 27574.09,-1463.23 27583.9,-1467.21 27584.25,-1460.22"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_56_gpu7 -->
<g id="edge470" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_56_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26764.74,-1687.45C26556.16,-1669.73 26301.47,-1646.07 26063.88,-1618.09"/>
<polygon fill="black" stroke="black" points="26063.99,-1614.58 26053.65,-1616.88 26063.17,-1621.53 26063.99,-1614.58"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_57_gpu7 -->
<g id="edge473" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_57_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26747.19,-1653.95C26666.95,-1641.88 26586.44,-1629.77 26515.76,-1619.13"/>
<polygon fill="black" stroke="black" points="26516.27,-1615.67 26505.86,-1617.64 26515.23,-1622.59 26516.27,-1615.67"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_58_gpu7 -->
<g id="edge476" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_58_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26969.88,-1653.95C26932.05,-1642.57 26894.1,-1631.15 26860.27,-1620.97"/>
<polygon fill="black" stroke="black" points="26860.96,-1617.52 26850.38,-1617.99 26858.94,-1624.23 26860.96,-1617.52"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_59_gpu7 -->
<g id="edge479" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_59_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27192.57,-1653.75C27192.57,-1645 27192.57,-1636.23 27192.57,-1628.02"/>
<polygon fill="black" stroke="black" points="27196.07,-1627.97 27192.57,-1617.97 27189.07,-1627.97 27196.07,-1627.97"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_60_gpu7 -->
<g id="edge482" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_60_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27415.26,-1653.95C27453.08,-1642.57 27491.03,-1631.15 27524.87,-1620.97"/>
<polygon fill="black" stroke="black" points="27526.19,-1624.23 27534.76,-1617.99 27524.18,-1617.52 27526.19,-1624.23"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_61_gpu7 -->
<g id="edge485" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_61_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27503.04,-1674.24C27623.31,-1656.15 27758.45,-1635.82 27869.36,-1619.14"/>
<polygon fill="black" stroke="black" points="27869.97,-1622.58 27879.34,-1617.63 27868.93,-1615.66 27869.97,-1622.58"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_62_gpu7 -->
<g id="edge488" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_62_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27532.4,-1694.8C27754.27,-1676.55 28050.41,-1649.99 28321.45,-1618.07"/>
<polygon fill="black" stroke="black" points="28321.97,-1621.53 28331.49,-1616.88 28321.15,-1614.58 28321.97,-1621.53"/>
</g>
<!-- l0_gate_gpu7&#45;&gt;l0_expert_63_gpu7 -->
<g id="edge491" class="edge">
<title>l0_gate_gpu7&#45;&gt;l0_expert_63_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27548.25,-1705.94C27866.83,-1690.57 28346.84,-1662.67 28773.43,-1618.05"/>
<polygon fill="black" stroke="black" points="28773.92,-1621.51 28783.5,-1616.99 28773.19,-1614.55 28773.92,-1621.51"/>
</g>
<!-- l0_expert_agg_gpu7&#45;&gt;l0_res2_gpu7 -->
<g id="edge494" class="edge">
<title>l0_expert_agg_gpu7&#45;&gt;l0_res2_gpu7</title>
<path fill="none" stroke="black" d="M26809.42,-1427.31C26488.02,-1412.87 26016.89,-1392.51 25605.57,-1377.95 24800.72,-1349.47 23844.72,-1324.91 23416.59,-1314.4"/>
<polygon fill="black" stroke="black" points="23416.66,-1310.91 23406.58,-1314.16 23416.49,-1317.9 23416.66,-1310.91"/>
</g>
<!-- l1_mha_qkv_gpu7 -->
<g id="node242" class="node">
<title>l1_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="16518.57,-1203.95 16348.57,-1203.95 16348.57,-1150.95 16518.57,-1150.95 16518.57,-1203.95"/>
<text text-anchor="middle" x="16433.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="16433.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="16433.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l0_res2_gpu7&#45;&gt;l1_mha_qkv_gpu7 -->
<g id="edge496" class="edge">
<title>l0_res2_gpu7&#45;&gt;l1_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M22972.48,-1303.45C22522.87,-1296.38 21457.1,-1280.48 20562.57,-1273.95 20535.26,-1273.75 16657.27,-1271.65 16630.57,-1265.95 16578.89,-1254.94 16524.3,-1229.46 16485.72,-1208.82"/>
<polygon fill="black" stroke="black" points="16487.22,-1205.65 16476.76,-1203.96 16483.88,-1211.81 16487.22,-1205.65"/>
</g>
<!-- l1_res_add_gpu7 -->
<g id="node522" class="node">
<title>l1_res_add_gpu7</title>
<ellipse fill="none" stroke="black" cx="18669.57" cy="-1177.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="18669.57" y="-1173.75" font-family="Times,serif" font-size="14.00">l1_res_add_gpu7</text>
</g>
<!-- l0_res2_gpu7&#45;&gt;l1_res_add_gpu7 -->
<g id="edge501" class="edge">
<title>l0_res2_gpu7&#45;&gt;l1_res_add_gpu7</title>
<path fill="none" stroke="black" d="M22972.32,-1300.78C22160.99,-1277.71 19326.37,-1197.13 18766.17,-1181.2"/>
<polygon fill="black" stroke="black" points="18766.2,-1177.7 18756.11,-1180.91 18766,-1184.7 18766.2,-1177.7"/>
</g>
<!-- l1_mha_attn_gpu0 -->
<g id="node131" class="node">
<title>l1_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="12139.57,-1114.95 11969.57,-1114.95 11969.57,-1061.95 12139.57,-1061.95 12139.57,-1114.95"/>
<text text-anchor="middle" x="12054.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="12054.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="12054.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu0&#45;&gt;l1_mha_attn_gpu0 -->
<g id="edge35" class="edge">
<title>l1_mha_qkv_gpu0&#45;&gt;l1_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M10887.8,-1168.26C10948.03,-1162.71 11030.69,-1155.57 11103.57,-1150.95 11480.69,-1127.07 11582.05,-1172.41 11959.34,-1114.99"/>
<polygon fill="black" stroke="black" points="11960.09,-1118.41 11969.44,-1113.43 11959.03,-1111.49 11960.09,-1118.41"/>
</g>
<!-- l1_mha_out_gpu0 -->
<g id="node132" class="node">
<title>l1_mha_out_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="12020.57,-1025.95 11850.57,-1025.95 11850.57,-972.95 12020.57,-972.95 12020.57,-1025.95"/>
<text text-anchor="middle" x="11935.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="11935.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11935.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu0&#45;&gt;l1_mha_out_gpu0 -->
<g id="edge36" class="edge">
<title>l1_mha_attn_gpu0&#45;&gt;l1_mha_out_gpu0</title>
<path fill="none" stroke="black" d="M12019.51,-1061.82C12006.79,-1052.52 11992.27,-1041.91 11978.92,-1032.15"/>
<polygon fill="black" stroke="black" points="11980.93,-1029.28 11970.79,-1026.2 11976.8,-1034.93 11980.93,-1029.28"/>
</g>
<!-- l1_mha_allreduce_gpu0 -->
<g id="node133" class="node">
<title>l1_mha_allreduce_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11140.57,-936.95 10970.57,-936.95 10970.57,-883.95 11140.57,-883.95 11140.57,-936.95"/>
<text text-anchor="middle" x="11055.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="11055.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11055.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu0&#45;&gt;l1_mha_allreduce_gpu0 -->
<g id="edge37" class="edge">
<title>l1_mha_out_gpu0&#45;&gt;l1_mha_allreduce_gpu0</title>
<path fill="none" stroke="black" d="M11850.39,-990.03C11685.45,-973.73 11323.55,-937.95 11150.88,-920.88"/>
<polygon fill="black" stroke="black" points="11151.09,-917.38 11140.79,-919.88 11150.4,-924.35 11151.09,-917.38"/>
</g>
<!-- l1_mha_allreduce_gpu0&#45;&gt;l1_res_add_gpu0 -->
<g id="edge38" class="edge">
<title>l1_mha_allreduce_gpu0&#45;&gt;l1_res_add_gpu0</title>
<path fill="none" stroke="black" d="M10970.48,-918.14C10891.9,-924.06 10771.94,-932.43 10667.57,-936.95 10476.59,-945.22 9132.53,-924.7 8947.57,-972.95 8805.56,-1010 8657.88,-1108.97 8595.85,-1153.81"/>
<polygon fill="black" stroke="black" points="8593.7,-1151.05 8587.67,-1159.77 8597.82,-1156.71 8593.7,-1151.05"/>
</g>
<!-- l1_mha_res_add_gpu0 -->
<g id="node134" class="node">
<title>l1_mha_res_add_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="17224.57,-1203.95 17054.57,-1203.95 17054.57,-1150.95 17224.57,-1150.95 17224.57,-1203.95"/>
<text text-anchor="middle" x="17139.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="17139.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="17139.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_0_gpu0 -->
<g id="node135" class="node">
<title>l1_expert_0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="9691.07,-1114.95 9596.07,-1114.95 9596.07,-1061.95 9691.07,-1061.95 9691.07,-1114.95"/>
<text text-anchor="middle" x="9643.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9643.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9643.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu0 -->
<g id="node144" class="node">
<title>l1_expert_agg_gpu0</title>
<polygon fill="yellow" stroke="black" points="9850.2,-1017.45 9610.58,-1017.45 9548.94,-981.45 9788.56,-981.45 9850.2,-1017.45"/>
<text text-anchor="middle" x="9699.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge43" class="edge">
<title>l1_expert_0_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9660.07,-1061.82C9667.3,-1050.59 9675.77,-1037.43 9683,-1026.19"/>
<polygon fill="black" stroke="black" points="9686.03,-1027.96 9688.5,-1017.65 9680.14,-1024.17 9686.03,-1027.96"/>
</g>
<!-- l1_expert_1_gpu0 -->
<g id="node136" class="node">
<title>l1_expert_1_gpu0</title>
<polygon fill="lightpink" stroke="black" points="9804.07,-1114.95 9709.07,-1114.95 9709.07,-1061.95 9804.07,-1061.95 9804.07,-1114.95"/>
<text text-anchor="middle" x="9756.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9756.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9756.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_1_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge46" class="edge">
<title>l1_expert_1_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9739.77,-1061.82C9732.42,-1050.59 9723.8,-1037.43 9716.43,-1026.19"/>
<polygon fill="black" stroke="black" points="9719.25,-1024.1 9710.84,-1017.65 9713.39,-1027.94 9719.25,-1024.1"/>
</g>
<!-- l1_expert_2_gpu0 -->
<g id="node137" class="node">
<title>l1_expert_2_gpu0</title>
<polygon fill="lightpink" stroke="black" points="9917.07,-1114.95 9822.07,-1114.95 9822.07,-1061.95 9917.07,-1061.95 9917.07,-1114.95"/>
<text text-anchor="middle" x="9869.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9869.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9869.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_2_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge49" class="edge">
<title>l1_expert_2_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9821.76,-1062.99C9796.68,-1050.15 9766.22,-1034.56 9741.99,-1022.16"/>
<polygon fill="black" stroke="black" points="9743.52,-1019.02 9733.03,-1017.58 9740.34,-1025.25 9743.52,-1019.02"/>
</g>
<!-- l1_expert_3_gpu0 -->
<g id="node138" class="node">
<title>l1_expert_3_gpu0</title>
<polygon fill="lightpink" stroke="black" points="10030.07,-1114.95 9935.07,-1114.95 9935.07,-1061.95 10030.07,-1061.95 10030.07,-1114.95"/>
<text text-anchor="middle" x="9982.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9982.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9982.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_3_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge52" class="edge">
<title>l1_expert_3_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9934.82,-1065.09C9932.05,-1063.99 9929.28,-1062.93 9926.57,-1061.95 9880.33,-1045.29 9827.39,-1030.7 9784.27,-1019.92"/>
<polygon fill="black" stroke="black" points="9784.93,-1016.47 9774.38,-1017.47 9783.24,-1023.27 9784.93,-1016.47"/>
</g>
<!-- l1_expert_4_gpu0 -->
<g id="node139" class="node">
<title>l1_expert_4_gpu0</title>
<polygon fill="lightpink" stroke="black" points="10143.07,-1114.95 10048.07,-1114.95 10048.07,-1061.95 10143.07,-1061.95 10143.07,-1114.95"/>
<text text-anchor="middle" x="10095.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10095.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="10095.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_4_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge55" class="edge">
<title>l1_expert_4_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10047.91,-1064.81C10045.12,-1063.78 10042.32,-1062.81 10039.57,-1061.95 9978.02,-1042.7 9908.19,-1028.77 9847.91,-1019.09"/>
<polygon fill="black" stroke="black" points="9848.35,-1015.62 9837.93,-1017.51 9847.26,-1022.53 9848.35,-1015.62"/>
</g>
<!-- l1_expert_5_gpu0 -->
<g id="node140" class="node">
<title>l1_expert_5_gpu0</title>
<polygon fill="lightpink" stroke="black" points="9352.07,-1114.95 9257.07,-1114.95 9257.07,-1061.95 9352.07,-1061.95 9352.07,-1114.95"/>
<text text-anchor="middle" x="9304.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="9304.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9304.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_5_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge58" class="edge">
<title>l1_expert_5_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9352.14,-1065.17C9355.3,-1064 9358.46,-1062.92 9361.57,-1061.95 9436.63,-1038.71 9523.94,-1023.1 9591.02,-1013.43"/>
<polygon fill="black" stroke="black" points="9591.78,-1016.85 9601.19,-1011.98 9590.79,-1009.92 9591.78,-1016.85"/>
</g>
<!-- l1_expert_6_gpu0 -->
<g id="node141" class="node">
<title>l1_expert_6_gpu0</title>
<polygon fill="lightpink" stroke="black" points="9465.07,-1114.95 9370.07,-1114.95 9370.07,-1061.95 9465.07,-1061.95 9465.07,-1114.95"/>
<text text-anchor="middle" x="9417.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9417.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9417.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_6_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge61" class="edge">
<title>l1_expert_6_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9465.24,-1065.48C9468.38,-1064.24 9471.51,-1063.05 9474.57,-1061.95 9520.73,-1045.43 9573.55,-1030.78 9616.41,-1019.93"/>
<polygon fill="black" stroke="black" points="9617.39,-1023.29 9626.24,-1017.46 9615.69,-1016.5 9617.39,-1023.29"/>
</g>
<!-- l1_expert_7_gpu0 -->
<g id="node142" class="node">
<title>l1_expert_7_gpu0</title>
<polygon fill="lightpink" stroke="black" points="9578.07,-1114.95 9483.07,-1114.95 9483.07,-1061.95 9578.07,-1061.95 9578.07,-1114.95"/>
<text text-anchor="middle" x="9530.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9530.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9530.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_7_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge64" class="edge">
<title>l1_expert_7_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9578.09,-1062.99C9603.03,-1050.15 9633.31,-1034.56 9657.4,-1022.16"/>
<polygon fill="black" stroke="black" points="9659.02,-1025.27 9666.31,-1017.58 9655.81,-1019.04 9659.02,-1025.27"/>
</g>
<!-- l1_gate_gpu0 -->
<g id="node143" class="node">
<title>l1_gate_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="9691.36,-1195.45 9615.33,-1195.45 9595.77,-1159.45 9671.8,-1159.45 9691.36,-1195.45"/>
<text text-anchor="middle" x="9643.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_0_gpu0 -->
<g id="edge41" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9643.57,-1159.26C9643.57,-1149.54 9643.57,-1137 9643.57,-1125.23"/>
<polygon fill="black" stroke="black" points="9647.07,-1125.19 9643.57,-1115.19 9640.07,-1125.19 9647.07,-1125.19"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_1_gpu0 -->
<g id="edge44" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9665.89,-1159.26C9679.93,-1148.46 9698.48,-1134.17 9715.15,-1121.35"/>
<polygon fill="black" stroke="black" points="9717.36,-1124.06 9723.14,-1115.19 9713.09,-1118.51 9717.36,-1124.06"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_2_gpu0 -->
<g id="edge47" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9675.5,-1165.76C9707.94,-1154.71 9759.76,-1136.54 9812.51,-1115.28"/>
<polygon fill="black" stroke="black" points="9814.07,-1118.42 9822.02,-1111.42 9811.44,-1111.94 9814.07,-1118.42"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_3_gpu0 -->
<g id="edge50" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9678.62,-1171.31C9730.94,-1163.1 9832.46,-1145.12 9925.34,-1115.11"/>
<polygon fill="black" stroke="black" points="9926.47,-1118.43 9934.88,-1111.98 9924.28,-1111.78 9926.47,-1118.43"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_4_gpu0 -->
<g id="edge53" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9679.79,-1174.15C9748.69,-1169.05 9903.13,-1154.25 10038.25,-1115.04"/>
<polygon fill="black" stroke="black" points="10039.34,-1118.37 10047.94,-1112.18 10037.36,-1111.66 10039.34,-1118.37"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_5_gpu0 -->
<g id="edge56" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9601.28,-1170.03C9547.39,-1161.23 9451.47,-1143.53 9361.69,-1114.71"/>
<polygon fill="black" stroke="black" points="9362.77,-1111.38 9352.18,-1111.61 9360.6,-1118.04 9362.77,-1111.38"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_6_gpu0 -->
<g id="edge59" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9595.87,-1160.12C9563.96,-1148.96 9520.88,-1133.45 9474.64,-1114.88"/>
<polygon fill="black" stroke="black" points="9475.94,-1111.63 9465.36,-1111.13 9473.32,-1118.12 9475.94,-1111.63"/>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert_7_gpu0 -->
<g id="edge62" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert_7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9621.24,-1159.26C9607.2,-1148.46 9588.65,-1134.17 9571.99,-1121.35"/>
<polygon fill="black" stroke="black" points="9574.05,-1118.51 9563.99,-1115.19 9569.78,-1124.06 9574.05,-1118.51"/>
</g>
<!-- l1_res2_gpu0 -->
<g id="node145" class="node">
<title>l1_res2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="9754.57,-928.45 9644.57,-928.45 9644.57,-892.45 9754.57,-892.45 9754.57,-928.45"/>
<text text-anchor="middle" x="9699.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu0&#45;&gt;l1_res2_gpu0 -->
<g id="edge65" class="edge">
<title>l1_expert_agg_gpu0&#45;&gt;l1_res2_gpu0</title>
<path fill="none" stroke="black" d="M9699.57,-981.26C9699.57,-969.11 9699.57,-952.57 9699.57,-938.63"/>
<polygon fill="black" stroke="black" points="9703.07,-938.61 9699.57,-928.61 9696.07,-938.61 9703.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu8 -->
<g id="node258" class="node">
<title>l2_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10741.07,-797.95 10646.07,-797.95 10646.07,-744.95 10741.07,-744.95 10741.07,-797.95"/>
<text text-anchor="middle" x="10693.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="10693.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10693.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu0&#45;&gt;l2_mha_qkv_gpu8 -->
<g id="edge529" class="edge">
<title>l1_res2_gpu0&#45;&gt;l2_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M9754.8,-906.87C9954.52,-897.51 10627.97,-865.54 10637.57,-859.95 10657.57,-848.31 10671.59,-826.36 10680.6,-807.35"/>
<polygon fill="black" stroke="black" points="10683.88,-808.59 10684.74,-798.04 10677.48,-805.75 10683.88,-808.59"/>
</g>
<!-- l1_mha_attn_gpu1 -->
<g id="node147" class="node">
<title>l1_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="13232.57,-1114.95 13062.57,-1114.95 13062.57,-1061.95 13232.57,-1061.95 13232.57,-1114.95"/>
<text text-anchor="middle" x="13147.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13147.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13147.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu1&#45;&gt;l1_mha_attn_gpu1 -->
<g id="edge101" class="edge">
<title>l1_mha_qkv_gpu1&#45;&gt;l1_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M11838.76,-1166.11C11885.82,-1160.78 11945.35,-1154.63 11998.57,-1150.95 12463.3,-1118.88 12587.88,-1183.9 13052.46,-1114.96"/>
<polygon fill="black" stroke="black" points="13053.07,-1118.41 13062.45,-1113.46 13052.04,-1111.48 13053.07,-1118.41"/>
</g>
<!-- l1_mha_out_gpu1 -->
<g id="node148" class="node">
<title>l1_mha_out_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="13086.57,-1025.95 12916.57,-1025.95 12916.57,-972.95 13086.57,-972.95 13086.57,-1025.95"/>
<text text-anchor="middle" x="13001.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13001.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13001.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu1&#45;&gt;l1_mha_out_gpu1 -->
<g id="edge102" class="edge">
<title>l1_mha_attn_gpu1&#45;&gt;l1_mha_out_gpu1</title>
<path fill="none" stroke="black" d="M13104.55,-1061.82C13088.44,-1052.22 13069.96,-1041.21 13053.15,-1031.19"/>
<polygon fill="black" stroke="black" points="13054.91,-1028.16 13044.53,-1026.05 13051.33,-1034.18 13054.91,-1028.16"/>
</g>
<!-- l1_mha_allreduce_gpu1 -->
<g id="node149" class="node">
<title>l1_mha_allreduce_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12044.57,-936.95 11874.57,-936.95 11874.57,-883.95 12044.57,-883.95 12044.57,-936.95"/>
<text text-anchor="middle" x="11959.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="11959.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11959.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu1&#45;&gt;l1_mha_allreduce_gpu1 -->
<g id="edge103" class="edge">
<title>l1_mha_out_gpu1&#45;&gt;l1_mha_allreduce_gpu1</title>
<path fill="none" stroke="black" d="M12916.33,-988.57C12870.25,-983.44 12812.34,-977.35 12760.57,-972.95 12512.06,-951.83 12449.07,-958.08 12200.57,-936.95 12152.54,-932.87 12099.22,-927.33 12054.98,-922.46"/>
<polygon fill="black" stroke="black" points="12055.14,-918.96 12044.81,-921.34 12054.37,-925.92 12055.14,-918.96"/>
</g>
<!-- l1_mha_allreduce_gpu1&#45;&gt;l1_res_add_gpu1 -->
<g id="edge104" class="edge">
<title>l1_mha_allreduce_gpu1&#45;&gt;l1_res_add_gpu1</title>
<path fill="none" stroke="black" d="M11874.48,-918.3C11795.92,-924.33 11675.95,-932.77 11571.57,-936.95 11433.39,-942.49 9215.18,-933.72 9082.57,-972.95 8958.93,-1009.53 8836.5,-1107.64 8784.54,-1152.94"/>
<polygon fill="black" stroke="black" points="8782.01,-1150.5 8776.82,-1159.74 8786.63,-1155.76 8782.01,-1150.5"/>
</g>
<!-- l1_mha_res_add_gpu1 -->
<g id="node150" class="node">
<title>l1_mha_res_add_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="16123.57,-1203.95 15953.57,-1203.95 15953.57,-1150.95 16123.57,-1150.95 16123.57,-1203.95"/>
<text text-anchor="middle" x="16038.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="16038.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="16038.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_8_gpu1 -->
<g id="node151" class="node">
<title>l1_expert_8_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10821.07,-1114.95 10726.07,-1114.95 10726.07,-1061.95 10821.07,-1061.95 10821.07,-1114.95"/>
<text text-anchor="middle" x="10773.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="10773.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10773.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu1 -->
<g id="node160" class="node">
<title>l1_expert_agg_gpu1</title>
<polygon fill="yellow" stroke="black" points="10754.2,-1017.45 10514.58,-1017.45 10452.94,-981.45 10692.56,-981.45 10754.2,-1017.45"/>
<text text-anchor="middle" x="10603.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_8_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge109" class="edge">
<title>l1_expert_8_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10725.76,-1062.99C10700.68,-1050.15 10670.22,-1034.56 10645.99,-1022.16"/>
<polygon fill="black" stroke="black" points="10647.52,-1019.02 10637.03,-1017.58 10644.34,-1025.25 10647.52,-1019.02"/>
</g>
<!-- l1_expert_9_gpu1 -->
<g id="node152" class="node">
<title>l1_expert_9_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10934.07,-1114.95 10839.07,-1114.95 10839.07,-1061.95 10934.07,-1061.95 10934.07,-1114.95"/>
<text text-anchor="middle" x="10886.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="10886.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10886.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_9_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge112" class="edge">
<title>l1_expert_9_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10838.82,-1065.09C10836.05,-1063.99 10833.28,-1062.93 10830.57,-1061.95 10784.33,-1045.29 10731.39,-1030.7 10688.27,-1019.92"/>
<polygon fill="black" stroke="black" points="10688.93,-1016.47 10678.38,-1017.47 10687.24,-1023.27 10688.93,-1016.47"/>
</g>
<!-- l1_expert_10_gpu1 -->
<g id="node153" class="node">
<title>l1_expert_10_gpu1</title>
<polygon fill="lightpink" stroke="black" points="11047.07,-1114.95 10952.07,-1114.95 10952.07,-1061.95 11047.07,-1061.95 11047.07,-1114.95"/>
<text text-anchor="middle" x="10999.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="10999.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10999.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_10_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge115" class="edge">
<title>l1_expert_10_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10951.91,-1064.81C10949.12,-1063.78 10946.32,-1062.81 10943.57,-1061.95 10882.02,-1042.7 10812.19,-1028.77 10751.91,-1019.09"/>
<polygon fill="black" stroke="black" points="10752.35,-1015.62 10741.93,-1017.51 10751.26,-1022.53 10752.35,-1015.62"/>
</g>
<!-- l1_expert_11_gpu1 -->
<g id="node154" class="node">
<title>l1_expert_11_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10256.07,-1114.95 10161.07,-1114.95 10161.07,-1061.95 10256.07,-1061.95 10256.07,-1114.95"/>
<text text-anchor="middle" x="10208.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="10208.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10208.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_11_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge118" class="edge">
<title>l1_expert_11_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10256.14,-1065.17C10259.3,-1064 10262.46,-1062.92 10265.57,-1061.95 10340.63,-1038.71 10427.94,-1023.1 10495.02,-1013.43"/>
<polygon fill="black" stroke="black" points="10495.78,-1016.85 10505.19,-1011.98 10494.79,-1009.92 10495.78,-1016.85"/>
</g>
<!-- l1_expert_12_gpu1 -->
<g id="node155" class="node">
<title>l1_expert_12_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10369.07,-1114.95 10274.07,-1114.95 10274.07,-1061.95 10369.07,-1061.95 10369.07,-1114.95"/>
<text text-anchor="middle" x="10321.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10321.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10321.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_12_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge121" class="edge">
<title>l1_expert_12_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10369.24,-1065.48C10372.38,-1064.24 10375.51,-1063.05 10378.57,-1061.95 10424.73,-1045.43 10477.55,-1030.78 10520.41,-1019.93"/>
<polygon fill="black" stroke="black" points="10521.39,-1023.29 10530.24,-1017.46 10519.69,-1016.5 10521.39,-1023.29"/>
</g>
<!-- l1_expert_13_gpu1 -->
<g id="node156" class="node">
<title>l1_expert_13_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10482.07,-1114.95 10387.07,-1114.95 10387.07,-1061.95 10482.07,-1061.95 10482.07,-1114.95"/>
<text text-anchor="middle" x="10434.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10434.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10434.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_13_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge124" class="edge">
<title>l1_expert_13_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10482.09,-1062.99C10507.03,-1050.15 10537.31,-1034.56 10561.4,-1022.16"/>
<polygon fill="black" stroke="black" points="10563.02,-1025.27 10570.31,-1017.58 10559.81,-1019.04 10563.02,-1025.27"/>
</g>
<!-- l1_expert_14_gpu1 -->
<g id="node157" class="node">
<title>l1_expert_14_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10595.07,-1114.95 10500.07,-1114.95 10500.07,-1061.95 10595.07,-1061.95 10595.07,-1114.95"/>
<text text-anchor="middle" x="10547.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="10547.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10547.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_14_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge127" class="edge">
<title>l1_expert_14_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10564.07,-1061.82C10571.3,-1050.59 10579.77,-1037.43 10587,-1026.19"/>
<polygon fill="black" stroke="black" points="10590.03,-1027.96 10592.5,-1017.65 10584.14,-1024.17 10590.03,-1027.96"/>
</g>
<!-- l1_expert_15_gpu1 -->
<g id="node158" class="node">
<title>l1_expert_15_gpu1</title>
<polygon fill="lightpink" stroke="black" points="10708.07,-1114.95 10613.07,-1114.95 10613.07,-1061.95 10708.07,-1061.95 10708.07,-1114.95"/>
<text text-anchor="middle" x="10660.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="10660.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10660.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_15_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge130" class="edge">
<title>l1_expert_15_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10643.77,-1061.82C10636.42,-1050.59 10627.8,-1037.43 10620.43,-1026.19"/>
<polygon fill="black" stroke="black" points="10623.25,-1024.1 10614.84,-1017.65 10617.39,-1027.94 10623.25,-1024.1"/>
</g>
<!-- l1_gate_gpu1 -->
<g id="node159" class="node">
<title>l1_gate_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="10595.36,-1195.45 10519.33,-1195.45 10499.77,-1159.45 10575.8,-1159.45 10595.36,-1195.45"/>
<text text-anchor="middle" x="10547.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_8_gpu1 -->
<g id="edge107" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_8_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10579.5,-1165.76C10611.94,-1154.71 10663.76,-1136.54 10716.51,-1115.28"/>
<polygon fill="black" stroke="black" points="10718.07,-1118.42 10726.02,-1111.42 10715.44,-1111.94 10718.07,-1118.42"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_9_gpu1 -->
<g id="edge110" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_9_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10582.62,-1171.31C10634.94,-1163.1 10736.46,-1145.12 10829.34,-1115.11"/>
<polygon fill="black" stroke="black" points="10830.47,-1118.43 10838.88,-1111.98 10828.28,-1111.78 10830.47,-1118.43"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_10_gpu1 -->
<g id="edge113" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_10_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10582.11,-1170.93C10614.7,-1165.73 10664.95,-1157.75 10708.57,-1150.95 10809.81,-1135.18 10840.46,-1144.53 10942.2,-1115.06"/>
<polygon fill="black" stroke="black" points="10943.34,-1118.37 10951.94,-1112.18 10941.36,-1111.66 10943.34,-1118.37"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_11_gpu1 -->
<g id="edge116" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_11_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10505.28,-1170.03C10451.39,-1161.23 10355.47,-1143.53 10265.69,-1114.71"/>
<polygon fill="black" stroke="black" points="10266.77,-1111.38 10256.18,-1111.61 10264.6,-1118.04 10266.77,-1111.38"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_12_gpu1 -->
<g id="edge119" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_12_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10499.87,-1160.12C10467.96,-1148.96 10424.88,-1133.45 10378.64,-1114.88"/>
<polygon fill="black" stroke="black" points="10379.94,-1111.63 10369.36,-1111.13 10377.32,-1118.12 10379.94,-1111.63"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_13_gpu1 -->
<g id="edge122" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_13_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10525.24,-1159.26C10511.2,-1148.46 10492.65,-1134.17 10475.99,-1121.35"/>
<polygon fill="black" stroke="black" points="10478.05,-1118.51 10467.99,-1115.19 10473.78,-1124.06 10478.05,-1118.51"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_14_gpu1 -->
<g id="edge125" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_14_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10547.57,-1159.26C10547.57,-1149.54 10547.57,-1137 10547.57,-1125.23"/>
<polygon fill="black" stroke="black" points="10551.07,-1125.19 10547.57,-1115.19 10544.07,-1125.19 10551.07,-1125.19"/>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert_15_gpu1 -->
<g id="edge128" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert_15_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10569.89,-1159.26C10583.93,-1148.46 10602.48,-1134.17 10619.15,-1121.35"/>
<polygon fill="black" stroke="black" points="10621.36,-1124.06 10627.14,-1115.19 10617.09,-1118.51 10621.36,-1124.06"/>
</g>
<!-- l1_res2_gpu1 -->
<g id="node161" class="node">
<title>l1_res2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="10658.57,-928.45 10548.57,-928.45 10548.57,-892.45 10658.57,-892.45 10658.57,-928.45"/>
<text text-anchor="middle" x="10603.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu1&#45;&gt;l1_res2_gpu1 -->
<g id="edge131" class="edge">
<title>l1_expert_agg_gpu1&#45;&gt;l1_res2_gpu1</title>
<path fill="none" stroke="black" d="M10603.57,-981.26C10603.57,-969.11 10603.57,-952.57 10603.57,-938.63"/>
<polygon fill="black" stroke="black" points="10607.07,-938.61 10603.57,-928.61 10600.07,-938.61 10607.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu9 -->
<g id="node274" class="node">
<title>l2_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11645.07,-797.95 11550.07,-797.95 11550.07,-744.95 11645.07,-744.95 11645.07,-797.95"/>
<text text-anchor="middle" x="11597.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="11597.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11597.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu1&#45;&gt;l2_mha_qkv_gpu9 -->
<g id="edge530" class="edge">
<title>l1_res2_gpu1&#45;&gt;l2_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M10658.61,-901.31C10728.76,-891.34 10853.86,-874.92 10961.57,-867.95 10977.65,-866.91 11527.49,-867.79 11541.57,-859.95 11561.79,-848.7 11575.81,-826.75 11584.77,-807.64"/>
<polygon fill="black" stroke="black" points="11588.07,-808.83 11588.88,-798.27 11581.66,-806.02 11588.07,-808.83"/>
</g>
<!-- l1_mha_attn_gpu2 -->
<g id="node163" class="node">
<title>l1_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13420.57,-1114.95 13250.57,-1114.95 13250.57,-1061.95 13420.57,-1061.95 13420.57,-1114.95"/>
<text text-anchor="middle" x="13335.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13335.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13335.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu2&#45;&gt;l1_mha_attn_gpu2 -->
<g id="edge167" class="edge">
<title>l1_mha_qkv_gpu2&#45;&gt;l1_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M13006.83,-1161.86C13069.11,-1150.79 13155.76,-1134.52 13240.54,-1115.13"/>
<polygon fill="black" stroke="black" points="13241.37,-1118.53 13250.33,-1112.88 13239.8,-1111.71 13241.37,-1118.53"/>
</g>
<!-- l1_mha_out_gpu2 -->
<g id="node164" class="node">
<title>l1_mha_out_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13274.57,-1025.95 13104.57,-1025.95 13104.57,-972.95 13274.57,-972.95 13274.57,-1025.95"/>
<text text-anchor="middle" x="13189.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13189.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13189.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu2&#45;&gt;l1_mha_out_gpu2 -->
<g id="edge168" class="edge">
<title>l1_mha_attn_gpu2&#45;&gt;l1_mha_out_gpu2</title>
<path fill="none" stroke="black" d="M13292.55,-1061.82C13276.44,-1052.22 13257.96,-1041.21 13241.15,-1031.19"/>
<polygon fill="black" stroke="black" points="13242.91,-1028.16 13232.53,-1026.05 13239.33,-1034.18 13242.91,-1028.16"/>
</g>
<!-- l1_mha_allreduce_gpu2 -->
<g id="node165" class="node">
<title>l1_mha_allreduce_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12379.57,-936.95 12209.57,-936.95 12209.57,-883.95 12379.57,-883.95 12379.57,-936.95"/>
<text text-anchor="middle" x="12294.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="12294.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12294.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu2&#45;&gt;l1_mha_allreduce_gpu2 -->
<g id="edge169" class="edge">
<title>l1_mha_out_gpu2&#45;&gt;l1_mha_allreduce_gpu2</title>
<path fill="none" stroke="black" d="M13104.43,-974.56C13101.45,-973.98 13098.49,-973.44 13095.57,-972.95 12849.97,-932.16 12784.64,-958 12536.57,-936.95 12488.04,-932.84 12434.14,-927.26 12389.56,-922.36"/>
<polygon fill="black" stroke="black" points="12389.93,-918.88 12379.6,-921.27 12389.16,-925.84 12389.93,-918.88"/>
</g>
<!-- l1_mha_allreduce_gpu2&#45;&gt;l1_res_add_gpu2 -->
<g id="edge170" class="edge">
<title>l1_mha_allreduce_gpu2&#45;&gt;l1_res_add_gpu2</title>
<path fill="none" stroke="black" d="M12209.4,-922.42C12163.35,-927.85 12105.44,-933.9 12053.57,-936.95 11972.81,-941.71 9215.56,-940.26 9141.57,-972.95 9057.4,-1010.14 8993.34,-1104.57 8966.03,-1150.53"/>
<polygon fill="black" stroke="black" points="8962.92,-1148.9 8960.91,-1159.3 8968.97,-1152.43 8962.92,-1148.9"/>
</g>
<!-- l1_mha_res_add_gpu2 -->
<g id="node166" class="node">
<title>l1_mha_res_add_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="15077.57,-1203.95 14907.57,-1203.95 14907.57,-1150.95 15077.57,-1150.95 15077.57,-1203.95"/>
<text text-anchor="middle" x="14992.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="14992.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="14992.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_16_gpu2 -->
<g id="node167" class="node">
<title>l1_expert_16_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11612.07,-1114.95 11517.07,-1114.95 11517.07,-1061.95 11612.07,-1061.95 11612.07,-1114.95"/>
<text text-anchor="middle" x="11564.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="11564.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11564.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu2 -->
<g id="node176" class="node">
<title>l1_expert_agg_gpu2</title>
<polygon fill="yellow" stroke="black" points="11658.2,-1017.45 11418.58,-1017.45 11356.94,-981.45 11596.56,-981.45 11658.2,-1017.45"/>
<text text-anchor="middle" x="11507.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_16_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge175" class="edge">
<title>l1_expert_16_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11547.77,-1061.82C11540.42,-1050.59 11531.8,-1037.43 11524.43,-1026.19"/>
<polygon fill="black" stroke="black" points="11527.25,-1024.1 11518.84,-1017.65 11521.39,-1027.94 11527.25,-1024.1"/>
</g>
<!-- l1_expert_17_gpu2 -->
<g id="node168" class="node">
<title>l1_expert_17_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11725.07,-1114.95 11630.07,-1114.95 11630.07,-1061.95 11725.07,-1061.95 11725.07,-1114.95"/>
<text text-anchor="middle" x="11677.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="11677.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11677.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_17_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge178" class="edge">
<title>l1_expert_17_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11629.76,-1062.99C11604.68,-1050.15 11574.22,-1034.56 11549.99,-1022.16"/>
<polygon fill="black" stroke="black" points="11551.52,-1019.02 11541.03,-1017.58 11548.34,-1025.25 11551.52,-1019.02"/>
</g>
<!-- l1_expert_18_gpu2 -->
<g id="node169" class="node">
<title>l1_expert_18_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11838.07,-1114.95 11743.07,-1114.95 11743.07,-1061.95 11838.07,-1061.95 11838.07,-1114.95"/>
<text text-anchor="middle" x="11790.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="11790.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11790.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_18_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge181" class="edge">
<title>l1_expert_18_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11742.82,-1065.09C11740.05,-1063.99 11737.28,-1062.93 11734.57,-1061.95 11688.33,-1045.29 11635.39,-1030.7 11592.27,-1019.92"/>
<polygon fill="black" stroke="black" points="11592.93,-1016.47 11582.38,-1017.47 11591.24,-1023.27 11592.93,-1016.47"/>
</g>
<!-- l1_expert_19_gpu2 -->
<g id="node170" class="node">
<title>l1_expert_19_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11951.07,-1114.95 11856.07,-1114.95 11856.07,-1061.95 11951.07,-1061.95 11951.07,-1114.95"/>
<text text-anchor="middle" x="11903.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="11903.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11903.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_19_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge184" class="edge">
<title>l1_expert_19_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11855.91,-1064.81C11853.12,-1063.78 11850.32,-1062.81 11847.57,-1061.95 11786.02,-1042.7 11716.19,-1028.77 11655.91,-1019.09"/>
<polygon fill="black" stroke="black" points="11656.35,-1015.62 11645.93,-1017.51 11655.26,-1022.53 11656.35,-1015.62"/>
</g>
<!-- l1_expert_20_gpu2 -->
<g id="node171" class="node">
<title>l1_expert_20_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11160.07,-1114.95 11065.07,-1114.95 11065.07,-1061.95 11160.07,-1061.95 11160.07,-1114.95"/>
<text text-anchor="middle" x="11112.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="11112.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11112.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_20_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge187" class="edge">
<title>l1_expert_20_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11160.14,-1065.17C11163.3,-1064 11166.46,-1062.92 11169.57,-1061.95 11244.63,-1038.71 11331.94,-1023.1 11399.02,-1013.43"/>
<polygon fill="black" stroke="black" points="11399.78,-1016.85 11409.19,-1011.98 11398.79,-1009.92 11399.78,-1016.85"/>
</g>
<!-- l1_expert_21_gpu2 -->
<g id="node172" class="node">
<title>l1_expert_21_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11273.07,-1114.95 11178.07,-1114.95 11178.07,-1061.95 11273.07,-1061.95 11273.07,-1114.95"/>
<text text-anchor="middle" x="11225.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="11225.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11225.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_21_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge190" class="edge">
<title>l1_expert_21_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11273.24,-1065.48C11276.38,-1064.24 11279.51,-1063.05 11282.57,-1061.95 11328.73,-1045.43 11381.55,-1030.78 11424.41,-1019.93"/>
<polygon fill="black" stroke="black" points="11425.39,-1023.29 11434.24,-1017.46 11423.69,-1016.5 11425.39,-1023.29"/>
</g>
<!-- l1_expert_22_gpu2 -->
<g id="node173" class="node">
<title>l1_expert_22_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11386.07,-1114.95 11291.07,-1114.95 11291.07,-1061.95 11386.07,-1061.95 11386.07,-1114.95"/>
<text text-anchor="middle" x="11338.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="11338.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11338.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_22_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge193" class="edge">
<title>l1_expert_22_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11386.09,-1062.99C11411.03,-1050.15 11441.31,-1034.56 11465.4,-1022.16"/>
<polygon fill="black" stroke="black" points="11467.02,-1025.27 11474.31,-1017.58 11463.81,-1019.04 11467.02,-1025.27"/>
</g>
<!-- l1_expert_23_gpu2 -->
<g id="node174" class="node">
<title>l1_expert_23_gpu2</title>
<polygon fill="lightpink" stroke="black" points="11499.07,-1114.95 11404.07,-1114.95 11404.07,-1061.95 11499.07,-1061.95 11499.07,-1114.95"/>
<text text-anchor="middle" x="11451.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="11451.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11451.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_23_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge196" class="edge">
<title>l1_expert_23_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11468.07,-1061.82C11475.3,-1050.59 11483.77,-1037.43 11491,-1026.19"/>
<polygon fill="black" stroke="black" points="11494.03,-1027.96 11496.5,-1017.65 11488.14,-1024.17 11494.03,-1027.96"/>
</g>
<!-- l1_gate_gpu2 -->
<g id="node175" class="node">
<title>l1_gate_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="11499.36,-1195.45 11423.33,-1195.45 11403.77,-1159.45 11479.8,-1159.45 11499.36,-1195.45"/>
<text text-anchor="middle" x="11451.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_16_gpu2 -->
<g id="edge173" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_16_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11473.89,-1159.26C11487.93,-1148.46 11506.48,-1134.17 11523.15,-1121.35"/>
<polygon fill="black" stroke="black" points="11525.36,-1124.06 11531.14,-1115.19 11521.09,-1118.51 11525.36,-1124.06"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_17_gpu2 -->
<g id="edge176" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_17_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11483.5,-1165.76C11515.94,-1154.71 11567.76,-1136.54 11620.51,-1115.28"/>
<polygon fill="black" stroke="black" points="11622.07,-1118.42 11630.02,-1111.42 11619.44,-1111.94 11622.07,-1118.42"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_18_gpu2 -->
<g id="edge179" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_18_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11486.62,-1171.31C11538.94,-1163.1 11640.46,-1145.12 11733.34,-1115.11"/>
<polygon fill="black" stroke="black" points="11734.47,-1118.43 11742.88,-1111.98 11732.28,-1111.78 11734.47,-1118.43"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_19_gpu2 -->
<g id="edge182" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_19_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11486.76,-1172.24C11567.2,-1162.41 11763.35,-1137.31 11846.18,-1114.96"/>
<polygon fill="black" stroke="black" points="11847.28,-1118.29 11855.94,-1112.18 11845.36,-1111.55 11847.28,-1118.29"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_20_gpu2 -->
<g id="edge185" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_20_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11409.28,-1170.03C11355.39,-1161.23 11259.47,-1143.53 11169.69,-1114.71"/>
<polygon fill="black" stroke="black" points="11170.77,-1111.38 11160.18,-1111.61 11168.6,-1118.04 11170.77,-1111.38"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_21_gpu2 -->
<g id="edge188" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_21_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11403.87,-1160.12C11371.96,-1148.96 11328.88,-1133.45 11282.64,-1114.88"/>
<polygon fill="black" stroke="black" points="11283.94,-1111.63 11273.36,-1111.13 11281.32,-1118.12 11283.94,-1111.63"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_22_gpu2 -->
<g id="edge191" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_22_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11429.24,-1159.26C11415.2,-1148.46 11396.65,-1134.17 11379.99,-1121.35"/>
<polygon fill="black" stroke="black" points="11382.05,-1118.51 11371.99,-1115.19 11377.78,-1124.06 11382.05,-1118.51"/>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert_23_gpu2 -->
<g id="edge194" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert_23_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11451.57,-1159.26C11451.57,-1149.54 11451.57,-1137 11451.57,-1125.23"/>
<polygon fill="black" stroke="black" points="11455.07,-1125.19 11451.57,-1115.19 11448.07,-1125.19 11455.07,-1125.19"/>
</g>
<!-- l1_res2_gpu2 -->
<g id="node177" class="node">
<title>l1_res2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="11562.57,-928.45 11452.57,-928.45 11452.57,-892.45 11562.57,-892.45 11562.57,-928.45"/>
<text text-anchor="middle" x="11507.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu2&#45;&gt;l1_res2_gpu2 -->
<g id="edge197" class="edge">
<title>l1_expert_agg_gpu2&#45;&gt;l1_res2_gpu2</title>
<path fill="none" stroke="black" d="M11507.57,-981.26C11507.57,-969.11 11507.57,-952.57 11507.57,-938.63"/>
<polygon fill="black" stroke="black" points="11511.07,-938.61 11507.57,-928.61 11504.07,-938.61 11511.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu10 -->
<g id="node290" class="node">
<title>l2_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12606.07,-797.95 12511.07,-797.95 12511.07,-744.95 12606.07,-744.95 12606.07,-797.95"/>
<text text-anchor="middle" x="12558.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="12558.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12558.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu2&#45;&gt;l2_mha_qkv_gpu10 -->
<g id="edge531" class="edge">
<title>l1_res2_gpu2&#45;&gt;l2_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M11562.61,-901.29C11632.76,-891.3 11757.86,-874.85 11865.57,-867.95 11883.23,-866.82 12487.1,-868.55 12502.57,-859.95 12522.8,-848.72 12536.82,-826.76 12545.77,-807.65"/>
<polygon fill="black" stroke="black" points="12549.07,-808.84 12549.88,-798.28 12542.66,-806.03 12549.07,-808.84"/>
</g>
<!-- l1_mha_attn_gpu3 -->
<g id="node179" class="node">
<title>l1_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="13608.57,-1114.95 13438.57,-1114.95 13438.57,-1061.95 13608.57,-1061.95 13608.57,-1114.95"/>
<text text-anchor="middle" x="13523.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13523.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13523.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu3&#45;&gt;l1_mha_attn_gpu3 -->
<g id="edge233" class="edge">
<title>l1_mha_qkv_gpu3&#45;&gt;l1_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M13483.36,-1150.82C13488.94,-1142.31 13495.23,-1132.7 13501.16,-1123.65"/>
<polygon fill="black" stroke="black" points="13504.15,-1125.49 13506.7,-1115.2 13498.29,-1121.65 13504.15,-1125.49"/>
</g>
<!-- l1_mha_out_gpu3 -->
<g id="node180" class="node">
<title>l1_mha_out_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="13462.57,-1025.95 13292.57,-1025.95 13292.57,-972.95 13462.57,-972.95 13462.57,-1025.95"/>
<text text-anchor="middle" x="13377.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13377.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13377.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu3&#45;&gt;l1_mha_out_gpu3 -->
<g id="edge234" class="edge">
<title>l1_mha_attn_gpu3&#45;&gt;l1_mha_out_gpu3</title>
<path fill="none" stroke="black" d="M13480.55,-1061.82C13464.44,-1052.22 13445.96,-1041.21 13429.15,-1031.19"/>
<polygon fill="black" stroke="black" points="13430.91,-1028.16 13420.53,-1026.05 13427.33,-1034.18 13430.91,-1028.16"/>
</g>
<!-- l1_mha_allreduce_gpu3 -->
<g id="node181" class="node">
<title>l1_mha_allreduce_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="13052.57,-936.95 12882.57,-936.95 12882.57,-883.95 13052.57,-883.95 13052.57,-936.95"/>
<text text-anchor="middle" x="12967.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="12967.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12967.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu3&#45;&gt;l1_mha_allreduce_gpu3 -->
<g id="edge235" class="edge">
<title>l1_mha_out_gpu3&#45;&gt;l1_mha_allreduce_gpu3</title>
<path fill="none" stroke="black" d="M13292.33,-975.04C13289.38,-974.32 13286.45,-973.62 13283.57,-972.95 13209.81,-955.79 13125.6,-939.57 13062.67,-928.1"/>
<polygon fill="black" stroke="black" points="13063.22,-924.64 13052.76,-926.3 13061.97,-931.53 13063.22,-924.64"/>
</g>
<!-- l1_mha_allreduce_gpu3&#45;&gt;l1_res_add_gpu3 -->
<g id="edge236" class="edge">
<title>l1_mha_allreduce_gpu3&#45;&gt;l1_res_add_gpu3</title>
<path fill="none" stroke="black" d="M12882.46,-920.27C12821.79,-926.16 12738.26,-933.43 12664.57,-936.95 12317.72,-953.52 9882.7,-919.63 9539.57,-972.95 9405.93,-993.72 9362.79,-989.53 9248.57,-1061.95 9211.69,-1085.34 9179.7,-1125.22 9161.27,-1151.2"/>
<polygon fill="black" stroke="black" points="9158.38,-1149.22 9155.55,-1159.43 9164.13,-1153.21 9158.38,-1149.22"/>
</g>
<!-- l1_mha_res_add_gpu3 -->
<g id="node182" class="node">
<title>l1_mha_res_add_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="14267.57,-1203.95 14097.57,-1203.95 14097.57,-1150.95 14267.57,-1150.95 14267.57,-1203.95"/>
<text text-anchor="middle" x="14182.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="14182.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14182.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_24_gpu3 -->
<g id="node183" class="node">
<title>l1_expert_24_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12592.07,-1114.95 12497.07,-1114.95 12497.07,-1061.95 12592.07,-1061.95 12592.07,-1114.95"/>
<text text-anchor="middle" x="12544.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="12544.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12544.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu3 -->
<g id="node192" class="node">
<title>l1_expert_agg_gpu3</title>
<polygon fill="yellow" stroke="black" points="12751.2,-1017.45 12511.58,-1017.45 12449.94,-981.45 12689.56,-981.45 12751.2,-1017.45"/>
<text text-anchor="middle" x="12600.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_24_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge241" class="edge">
<title>l1_expert_24_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12561.07,-1061.82C12568.3,-1050.59 12576.77,-1037.43 12584,-1026.19"/>
<polygon fill="black" stroke="black" points="12587.03,-1027.96 12589.5,-1017.65 12581.14,-1024.17 12587.03,-1027.96"/>
</g>
<!-- l1_expert_25_gpu3 -->
<g id="node184" class="node">
<title>l1_expert_25_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12705.07,-1114.95 12610.07,-1114.95 12610.07,-1061.95 12705.07,-1061.95 12705.07,-1114.95"/>
<text text-anchor="middle" x="12657.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="12657.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12657.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_25_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge244" class="edge">
<title>l1_expert_25_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12640.77,-1061.82C12633.42,-1050.59 12624.8,-1037.43 12617.43,-1026.19"/>
<polygon fill="black" stroke="black" points="12620.25,-1024.1 12611.84,-1017.65 12614.39,-1027.94 12620.25,-1024.1"/>
</g>
<!-- l1_expert_26_gpu3 -->
<g id="node185" class="node">
<title>l1_expert_26_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12818.07,-1114.95 12723.07,-1114.95 12723.07,-1061.95 12818.07,-1061.95 12818.07,-1114.95"/>
<text text-anchor="middle" x="12770.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="12770.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12770.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_26_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge247" class="edge">
<title>l1_expert_26_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12722.76,-1062.99C12697.68,-1050.15 12667.22,-1034.56 12642.99,-1022.16"/>
<polygon fill="black" stroke="black" points="12644.52,-1019.02 12634.03,-1017.58 12641.34,-1025.25 12644.52,-1019.02"/>
</g>
<!-- l1_expert_27_gpu3 -->
<g id="node186" class="node">
<title>l1_expert_27_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12931.07,-1114.95 12836.07,-1114.95 12836.07,-1061.95 12931.07,-1061.95 12931.07,-1114.95"/>
<text text-anchor="middle" x="12883.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="12883.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12883.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_27_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge250" class="edge">
<title>l1_expert_27_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12835.82,-1065.09C12833.05,-1063.99 12830.28,-1062.93 12827.57,-1061.95 12781.33,-1045.29 12728.39,-1030.7 12685.27,-1019.92"/>
<polygon fill="black" stroke="black" points="12685.93,-1016.47 12675.38,-1017.47 12684.24,-1023.27 12685.93,-1016.47"/>
</g>
<!-- l1_expert_28_gpu3 -->
<g id="node187" class="node">
<title>l1_expert_28_gpu3</title>
<polygon fill="lightpink" stroke="black" points="13044.07,-1114.95 12949.07,-1114.95 12949.07,-1061.95 13044.07,-1061.95 13044.07,-1114.95"/>
<text text-anchor="middle" x="12996.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="12996.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12996.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_28_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge253" class="edge">
<title>l1_expert_28_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12948.91,-1064.81C12946.12,-1063.78 12943.32,-1062.81 12940.57,-1061.95 12879.02,-1042.7 12809.19,-1028.77 12748.91,-1019.09"/>
<polygon fill="black" stroke="black" points="12749.35,-1015.62 12738.93,-1017.51 12748.26,-1022.53 12749.35,-1015.62"/>
</g>
<!-- l1_expert_29_gpu3 -->
<g id="node188" class="node">
<title>l1_expert_29_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12253.07,-1114.95 12158.07,-1114.95 12158.07,-1061.95 12253.07,-1061.95 12253.07,-1114.95"/>
<text text-anchor="middle" x="12205.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="12205.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12205.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_29_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge256" class="edge">
<title>l1_expert_29_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12253.14,-1065.17C12256.3,-1064 12259.46,-1062.92 12262.57,-1061.95 12337.63,-1038.71 12424.94,-1023.1 12492.02,-1013.43"/>
<polygon fill="black" stroke="black" points="12492.78,-1016.85 12502.19,-1011.98 12491.79,-1009.92 12492.78,-1016.85"/>
</g>
<!-- l1_expert_30_gpu3 -->
<g id="node189" class="node">
<title>l1_expert_30_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12366.07,-1114.95 12271.07,-1114.95 12271.07,-1061.95 12366.07,-1061.95 12366.07,-1114.95"/>
<text text-anchor="middle" x="12318.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="12318.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12318.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_30_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge259" class="edge">
<title>l1_expert_30_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12366.24,-1065.48C12369.38,-1064.24 12372.51,-1063.05 12375.57,-1061.95 12421.73,-1045.43 12474.55,-1030.78 12517.41,-1019.93"/>
<polygon fill="black" stroke="black" points="12518.39,-1023.29 12527.24,-1017.46 12516.69,-1016.5 12518.39,-1023.29"/>
</g>
<!-- l1_expert_31_gpu3 -->
<g id="node190" class="node">
<title>l1_expert_31_gpu3</title>
<polygon fill="lightpink" stroke="black" points="12479.07,-1114.95 12384.07,-1114.95 12384.07,-1061.95 12479.07,-1061.95 12479.07,-1114.95"/>
<text text-anchor="middle" x="12431.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="12431.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12431.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_31_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge262" class="edge">
<title>l1_expert_31_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12479.09,-1062.99C12504.03,-1050.15 12534.31,-1034.56 12558.4,-1022.16"/>
<polygon fill="black" stroke="black" points="12560.02,-1025.27 12567.31,-1017.58 12556.81,-1019.04 12560.02,-1025.27"/>
</g>
<!-- l1_gate_gpu3 -->
<g id="node191" class="node">
<title>l1_gate_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="12592.36,-1195.45 12516.33,-1195.45 12496.77,-1159.45 12572.8,-1159.45 12592.36,-1195.45"/>
<text text-anchor="middle" x="12544.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_24_gpu3 -->
<g id="edge239" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_24_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12544.57,-1159.26C12544.57,-1149.54 12544.57,-1137 12544.57,-1125.23"/>
<polygon fill="black" stroke="black" points="12548.07,-1125.19 12544.57,-1115.19 12541.07,-1125.19 12548.07,-1125.19"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_25_gpu3 -->
<g id="edge242" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_25_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12566.89,-1159.26C12580.93,-1148.46 12599.48,-1134.17 12616.15,-1121.35"/>
<polygon fill="black" stroke="black" points="12618.36,-1124.06 12624.14,-1115.19 12614.09,-1118.51 12618.36,-1124.06"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_26_gpu3 -->
<g id="edge245" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_26_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12576.5,-1165.76C12608.94,-1154.71 12660.76,-1136.54 12713.51,-1115.28"/>
<polygon fill="black" stroke="black" points="12715.07,-1118.42 12723.02,-1111.42 12712.44,-1111.94 12715.07,-1118.42"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_27_gpu3 -->
<g id="edge248" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_27_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12579.62,-1171.31C12631.94,-1163.1 12733.46,-1145.12 12826.34,-1115.11"/>
<polygon fill="black" stroke="black" points="12827.47,-1118.43 12835.88,-1111.98 12825.28,-1111.78 12827.47,-1118.43"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_28_gpu3 -->
<g id="edge251" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_28_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12580.79,-1174.15C12649.69,-1169.05 12804.13,-1154.25 12939.25,-1115.04"/>
<polygon fill="black" stroke="black" points="12940.34,-1118.37 12948.94,-1112.18 12938.36,-1111.66 12940.34,-1118.37"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_29_gpu3 -->
<g id="edge254" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_29_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12502.28,-1170.03C12448.39,-1161.23 12352.47,-1143.53 12262.69,-1114.71"/>
<polygon fill="black" stroke="black" points="12263.77,-1111.38 12253.18,-1111.61 12261.6,-1118.04 12263.77,-1111.38"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_30_gpu3 -->
<g id="edge257" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_30_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12496.87,-1160.12C12464.96,-1148.96 12421.88,-1133.45 12375.64,-1114.88"/>
<polygon fill="black" stroke="black" points="12376.94,-1111.63 12366.36,-1111.13 12374.32,-1118.12 12376.94,-1111.63"/>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert_31_gpu3 -->
<g id="edge260" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert_31_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12522.24,-1159.26C12508.2,-1148.46 12489.65,-1134.17 12472.99,-1121.35"/>
<polygon fill="black" stroke="black" points="12475.05,-1118.51 12464.99,-1115.19 12470.78,-1124.06 12475.05,-1118.51"/>
</g>
<!-- l1_res2_gpu3 -->
<g id="node193" class="node">
<title>l1_res2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="12655.57,-928.45 12545.57,-928.45 12545.57,-892.45 12655.57,-892.45 12655.57,-928.45"/>
<text text-anchor="middle" x="12600.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu3&#45;&gt;l1_res2_gpu3 -->
<g id="edge263" class="edge">
<title>l1_expert_agg_gpu3&#45;&gt;l1_res2_gpu3</title>
<path fill="none" stroke="black" d="M12600.57,-981.26C12600.57,-969.11 12600.57,-952.57 12600.57,-938.63"/>
<polygon fill="black" stroke="black" points="12604.07,-938.61 12600.57,-928.61 12597.07,-938.61 12604.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu11 -->
<g id="node306" class="node">
<title>l2_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="12832.07,-797.95 12737.07,-797.95 12737.07,-744.95 12832.07,-744.95 12832.07,-797.95"/>
<text text-anchor="middle" x="12784.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="12784.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12784.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu3&#45;&gt;l2_mha_qkv_gpu11 -->
<g id="edge532" class="edge">
<title>l1_res2_gpu3&#45;&gt;l2_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M12655.61,-896.53C12679.86,-888.84 12707.54,-877.14 12728.57,-859.95 12745.81,-845.86 12759.45,-825.01 12768.95,-807.19"/>
<polygon fill="black" stroke="black" points="12772.11,-808.7 12773.53,-798.2 12765.87,-805.52 12772.11,-808.7"/>
</g>
<!-- l1_mha_attn_gpu4 -->
<g id="node195" class="node">
<title>l1_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13796.57,-1114.95 13626.57,-1114.95 13626.57,-1061.95 13796.57,-1061.95 13796.57,-1114.95"/>
<text text-anchor="middle" x="13711.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13711.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13711.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu4&#45;&gt;l1_mha_attn_gpu4 -->
<g id="edge299" class="edge">
<title>l1_mha_qkv_gpu4&#45;&gt;l1_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M13751.77,-1150.82C13746.2,-1142.31 13739.9,-1132.7 13733.97,-1123.65"/>
<polygon fill="black" stroke="black" points="13736.85,-1121.65 13728.44,-1115.2 13730.99,-1125.49 13736.85,-1121.65"/>
</g>
<!-- l1_mha_out_gpu4 -->
<g id="node196" class="node">
<title>l1_mha_out_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13825.57,-1025.95 13655.57,-1025.95 13655.57,-972.95 13825.57,-972.95 13825.57,-1025.95"/>
<text text-anchor="middle" x="13740.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13740.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13740.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu4&#45;&gt;l1_mha_out_gpu4 -->
<g id="edge300" class="edge">
<title>l1_mha_attn_gpu4&#45;&gt;l1_mha_out_gpu4</title>
<path fill="none" stroke="black" d="M13720.11,-1061.82C13722.83,-1053.66 13725.89,-1044.49 13728.8,-1035.77"/>
<polygon fill="black" stroke="black" points="13732.14,-1036.8 13731.99,-1026.2 13725.5,-1034.58 13732.14,-1036.8"/>
</g>
<!-- l1_mha_allreduce_gpu4 -->
<g id="node197" class="node">
<title>l1_mha_allreduce_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13854.57,-936.95 13684.57,-936.95 13684.57,-883.95 13854.57,-883.95 13854.57,-936.95"/>
<text text-anchor="middle" x="13769.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="13769.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13769.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu4&#45;&gt;l1_mha_allreduce_gpu4 -->
<g id="edge301" class="edge">
<title>l1_mha_out_gpu4&#45;&gt;l1_mha_allreduce_gpu4</title>
<path fill="none" stroke="black" d="M13749.11,-972.82C13751.83,-964.66 13754.89,-955.49 13757.8,-946.77"/>
<polygon fill="black" stroke="black" points="13761.14,-947.8 13760.99,-937.2 13754.5,-945.58 13761.14,-947.8"/>
</g>
<!-- l1_mha_allreduce_gpu4&#45;&gt;l1_res_add_gpu4 -->
<g id="edge302" class="edge">
<title>l1_mha_allreduce_gpu4&#45;&gt;l1_res_add_gpu4</title>
<path fill="none" stroke="black" d="M13854.61,-918.53C13931.78,-924.62 14048.72,-933.03 14150.57,-936.95 14544.07,-952.11 17305.34,-913.12 17694.57,-972.95 17829.09,-993.63 17872.74,-988.91 17987.57,-1061.95 18024.1,-1085.19 18055.62,-1124.83 18073.86,-1150.84"/>
<polygon fill="black" stroke="black" points="18071.2,-1153.15 18079.74,-1159.42 18076.97,-1149.19 18071.2,-1153.15"/>
</g>
<!-- l1_mha_res_add_gpu4 -->
<g id="node198" class="node">
<title>l1_mha_res_add_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13250.57,-1203.95 13080.57,-1203.95 13080.57,-1150.95 13250.57,-1150.95 13250.57,-1203.95"/>
<text text-anchor="middle" x="13165.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="13165.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="13165.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_32_gpu4 -->
<g id="node199" class="node">
<title>l1_expert_32_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14851.07,-1114.95 14756.07,-1114.95 14756.07,-1061.95 14851.07,-1061.95 14851.07,-1114.95"/>
<text text-anchor="middle" x="14803.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="14803.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14803.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu4 -->
<g id="node208" class="node">
<title>l1_expert_agg_gpu4</title>
<polygon fill="yellow" stroke="black" points="14784.2,-1017.45 14544.58,-1017.45 14482.94,-981.45 14722.56,-981.45 14784.2,-1017.45"/>
<text text-anchor="middle" x="14633.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_32_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge307" class="edge">
<title>l1_expert_32_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14755.76,-1062.99C14730.68,-1050.15 14700.22,-1034.56 14675.99,-1022.16"/>
<polygon fill="black" stroke="black" points="14677.52,-1019.02 14667.03,-1017.58 14674.34,-1025.25 14677.52,-1019.02"/>
</g>
<!-- l1_expert_33_gpu4 -->
<g id="node200" class="node">
<title>l1_expert_33_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14964.07,-1114.95 14869.07,-1114.95 14869.07,-1061.95 14964.07,-1061.95 14964.07,-1114.95"/>
<text text-anchor="middle" x="14916.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="14916.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14916.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_33_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge310" class="edge">
<title>l1_expert_33_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14868.82,-1065.09C14866.05,-1063.99 14863.28,-1062.93 14860.57,-1061.95 14814.33,-1045.29 14761.39,-1030.7 14718.27,-1019.92"/>
<polygon fill="black" stroke="black" points="14718.93,-1016.47 14708.38,-1017.47 14717.24,-1023.27 14718.93,-1016.47"/>
</g>
<!-- l1_expert_34_gpu4 -->
<g id="node201" class="node">
<title>l1_expert_34_gpu4</title>
<polygon fill="lightpink" stroke="black" points="15077.07,-1114.95 14982.07,-1114.95 14982.07,-1061.95 15077.07,-1061.95 15077.07,-1114.95"/>
<text text-anchor="middle" x="15029.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="15029.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15029.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_34_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge313" class="edge">
<title>l1_expert_34_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14981.91,-1064.81C14979.12,-1063.78 14976.32,-1062.81 14973.57,-1061.95 14912.02,-1042.7 14842.19,-1028.77 14781.91,-1019.09"/>
<polygon fill="black" stroke="black" points="14782.35,-1015.62 14771.93,-1017.51 14781.26,-1022.53 14782.35,-1015.62"/>
</g>
<!-- l1_expert_35_gpu4 -->
<g id="node202" class="node">
<title>l1_expert_35_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14286.07,-1114.95 14191.07,-1114.95 14191.07,-1061.95 14286.07,-1061.95 14286.07,-1114.95"/>
<text text-anchor="middle" x="14238.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="14238.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14238.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_35_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge316" class="edge">
<title>l1_expert_35_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14286.14,-1065.17C14289.3,-1064 14292.46,-1062.92 14295.57,-1061.95 14370.63,-1038.71 14457.94,-1023.1 14525.02,-1013.43"/>
<polygon fill="black" stroke="black" points="14525.78,-1016.85 14535.19,-1011.98 14524.79,-1009.92 14525.78,-1016.85"/>
</g>
<!-- l1_expert_36_gpu4 -->
<g id="node203" class="node">
<title>l1_expert_36_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14399.07,-1114.95 14304.07,-1114.95 14304.07,-1061.95 14399.07,-1061.95 14399.07,-1114.95"/>
<text text-anchor="middle" x="14351.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="14351.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14351.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_36_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge319" class="edge">
<title>l1_expert_36_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14399.24,-1065.48C14402.38,-1064.24 14405.51,-1063.05 14408.57,-1061.95 14454.73,-1045.43 14507.55,-1030.78 14550.41,-1019.93"/>
<polygon fill="black" stroke="black" points="14551.39,-1023.29 14560.24,-1017.46 14549.69,-1016.5 14551.39,-1023.29"/>
</g>
<!-- l1_expert_37_gpu4 -->
<g id="node204" class="node">
<title>l1_expert_37_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14512.07,-1114.95 14417.07,-1114.95 14417.07,-1061.95 14512.07,-1061.95 14512.07,-1114.95"/>
<text text-anchor="middle" x="14464.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="14464.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14464.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_37_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge322" class="edge">
<title>l1_expert_37_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14512.09,-1062.99C14537.03,-1050.15 14567.31,-1034.56 14591.4,-1022.16"/>
<polygon fill="black" stroke="black" points="14593.02,-1025.27 14600.31,-1017.58 14589.81,-1019.04 14593.02,-1025.27"/>
</g>
<!-- l1_expert_38_gpu4 -->
<g id="node205" class="node">
<title>l1_expert_38_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14625.07,-1114.95 14530.07,-1114.95 14530.07,-1061.95 14625.07,-1061.95 14625.07,-1114.95"/>
<text text-anchor="middle" x="14577.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="14577.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14577.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_38_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge325" class="edge">
<title>l1_expert_38_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14594.07,-1061.82C14601.3,-1050.59 14609.77,-1037.43 14617,-1026.19"/>
<polygon fill="black" stroke="black" points="14620.03,-1027.96 14622.5,-1017.65 14614.14,-1024.17 14620.03,-1027.96"/>
</g>
<!-- l1_expert_39_gpu4 -->
<g id="node206" class="node">
<title>l1_expert_39_gpu4</title>
<polygon fill="lightpink" stroke="black" points="14738.07,-1114.95 14643.07,-1114.95 14643.07,-1061.95 14738.07,-1061.95 14738.07,-1114.95"/>
<text text-anchor="middle" x="14690.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="14690.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14690.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_39_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge328" class="edge">
<title>l1_expert_39_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14673.77,-1061.82C14666.42,-1050.59 14657.8,-1037.43 14650.43,-1026.19"/>
<polygon fill="black" stroke="black" points="14653.25,-1024.1 14644.84,-1017.65 14647.39,-1027.94 14653.25,-1024.1"/>
</g>
<!-- l1_gate_gpu4 -->
<g id="node207" class="node">
<title>l1_gate_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="14738.36,-1195.45 14662.33,-1195.45 14642.77,-1159.45 14718.8,-1159.45 14738.36,-1195.45"/>
<text text-anchor="middle" x="14690.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_32_gpu4 -->
<g id="edge305" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_32_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14712.89,-1159.26C14726.93,-1148.46 14745.48,-1134.17 14762.15,-1121.35"/>
<polygon fill="black" stroke="black" points="14764.36,-1124.06 14770.14,-1115.19 14760.09,-1118.51 14764.36,-1124.06"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_33_gpu4 -->
<g id="edge308" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_33_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14722.5,-1165.76C14754.94,-1154.71 14806.76,-1136.54 14859.51,-1115.28"/>
<polygon fill="black" stroke="black" points="14861.07,-1118.42 14869.02,-1111.42 14858.44,-1111.94 14861.07,-1118.42"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_34_gpu4 -->
<g id="edge311" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_34_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14725.62,-1171.31C14777.94,-1163.1 14879.46,-1145.12 14972.34,-1115.11"/>
<polygon fill="black" stroke="black" points="14973.47,-1118.43 14981.88,-1111.98 14971.28,-1111.78 14973.47,-1118.43"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_35_gpu4 -->
<g id="edge314" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_35_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14645.95,-1165.36C14625.24,-1160.47 14600.25,-1154.95 14577.57,-1150.95 14456.3,-1129.58 14419.09,-1148.13 14295.89,-1114.65"/>
<polygon fill="black" stroke="black" points="14296.65,-1111.23 14286.08,-1111.93 14294.78,-1117.98 14296.65,-1111.23"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_36_gpu4 -->
<g id="edge317" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_36_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14646.32,-1166.34C14625.48,-1161.61 14600.26,-1155.93 14577.57,-1150.95 14505.63,-1135.18 14483.39,-1138.45 14409.01,-1114.81"/>
<polygon fill="black" stroke="black" points="14409.77,-1111.38 14399.17,-1111.63 14407.61,-1118.04 14409.77,-1111.38"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_37_gpu4 -->
<g id="edge320" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_37_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14642.87,-1160.12C14610.96,-1148.96 14567.88,-1133.45 14521.64,-1114.88"/>
<polygon fill="black" stroke="black" points="14522.94,-1111.63 14512.36,-1111.13 14520.32,-1118.12 14522.94,-1111.63"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_38_gpu4 -->
<g id="edge323" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_38_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14668.24,-1159.26C14654.2,-1148.46 14635.65,-1134.17 14618.99,-1121.35"/>
<polygon fill="black" stroke="black" points="14621.05,-1118.51 14610.99,-1115.19 14616.78,-1124.06 14621.05,-1118.51"/>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert_39_gpu4 -->
<g id="edge326" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert_39_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14690.57,-1159.26C14690.57,-1149.54 14690.57,-1137 14690.57,-1125.23"/>
<polygon fill="black" stroke="black" points="14694.07,-1125.19 14690.57,-1115.19 14687.07,-1125.19 14694.07,-1125.19"/>
</g>
<!-- l1_res2_gpu4 -->
<g id="node209" class="node">
<title>l1_res2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="14688.57,-928.45 14578.57,-928.45 14578.57,-892.45 14688.57,-892.45 14688.57,-928.45"/>
<text text-anchor="middle" x="14633.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu4&#45;&gt;l1_res2_gpu4 -->
<g id="edge329" class="edge">
<title>l1_expert_agg_gpu4&#45;&gt;l1_res2_gpu4</title>
<path fill="none" stroke="black" d="M14633.57,-981.26C14633.57,-969.11 14633.57,-952.57 14633.57,-938.63"/>
<polygon fill="black" stroke="black" points="14637.07,-938.61 14633.57,-928.61 14630.07,-938.61 14637.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu12 -->
<g id="node322" class="node">
<title>l2_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14083.07,-797.95 13988.07,-797.95 13988.07,-744.95 14083.07,-744.95 14083.07,-797.95"/>
<text text-anchor="middle" x="14035.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="14035.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14035.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu4&#45;&gt;l2_mha_qkv_gpu12 -->
<g id="edge533" class="edge">
<title>l1_res2_gpu4&#45;&gt;l2_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M14578.31,-899.87C14519.19,-890.05 14422.56,-875.21 14338.57,-867.95 14324.95,-866.78 14104.48,-866.66 14092.57,-859.95 14072.3,-848.54 14058.03,-826.58 14048.83,-807.52"/>
<polygon fill="black" stroke="black" points="14051.92,-805.84 14044.61,-798.17 14045.54,-808.72 14051.92,-805.84"/>
</g>
<!-- l1_mha_attn_gpu5 -->
<g id="node211" class="node">
<title>l1_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="13984.57,-1114.95 13814.57,-1114.95 13814.57,-1061.95 13984.57,-1061.95 13984.57,-1114.95"/>
<text text-anchor="middle" x="13899.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13899.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="13899.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu5&#45;&gt;l1_mha_attn_gpu5 -->
<g id="edge365" class="edge">
<title>l1_mha_qkv_gpu5&#45;&gt;l1_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M14398.39,-1165.92C14272.77,-1150.36 14047.7,-1122.4 13994.96,-1114.74"/>
<polygon fill="black" stroke="black" points="13995.18,-1111.23 13984.75,-1113.12 13994.08,-1118.14 13995.18,-1111.23"/>
</g>
<!-- l1_mha_out_gpu5 -->
<g id="node212" class="node">
<title>l1_mha_out_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="14099.57,-1025.95 13929.57,-1025.95 13929.57,-972.95 14099.57,-972.95 14099.57,-1025.95"/>
<text text-anchor="middle" x="14014.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="14014.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14014.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu5&#45;&gt;l1_mha_out_gpu5 -->
<g id="edge366" class="edge">
<title>l1_mha_attn_gpu5&#45;&gt;l1_mha_out_gpu5</title>
<path fill="none" stroke="black" d="M13933.45,-1061.82C13945.62,-1052.61 13959.51,-1042.11 13972.31,-1032.43"/>
<polygon fill="black" stroke="black" points="13974.67,-1035.03 13980.53,-1026.2 13970.44,-1029.45 13974.67,-1035.03"/>
</g>
<!-- l1_mha_allreduce_gpu5 -->
<g id="node213" class="node">
<title>l1_mha_allreduce_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="14329.57,-936.95 14159.57,-936.95 14159.57,-883.95 14329.57,-883.95 14329.57,-936.95"/>
<text text-anchor="middle" x="14244.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="14244.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14244.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu5&#45;&gt;l1_mha_allreduce_gpu5 -->
<g id="edge367" class="edge">
<title>l1_mha_out_gpu5&#45;&gt;l1_mha_allreduce_gpu5</title>
<path fill="none" stroke="black" d="M14082.02,-972.94C14108.82,-962.8 14139.8,-951.08 14167.48,-940.61"/>
<polygon fill="black" stroke="black" points="14169,-943.78 14177.12,-936.97 14166.52,-937.23 14169,-943.78"/>
</g>
<!-- l1_mha_allreduce_gpu5&#45;&gt;l1_res_add_gpu5 -->
<g id="edge368" class="edge">
<title>l1_mha_allreduce_gpu5&#45;&gt;l1_res_add_gpu5</title>
<path fill="none" stroke="black" d="M14329.67,-919.72C14395.17,-925.7 14488.01,-933.33 14569.57,-936.95 14665.45,-941.21 17934.03,-941.11 18024.57,-972.95 18038.15,-977.73 18190.75,-1101.01 18255.16,-1153.33"/>
<polygon fill="black" stroke="black" points="18253.31,-1156.34 18263.28,-1159.93 18257.72,-1150.9 18253.31,-1156.34"/>
</g>
<!-- l1_mha_res_add_gpu5 -->
<g id="node214" class="node">
<title>l1_mha_res_add_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12177.57,-1203.95 12007.57,-1203.95 12007.57,-1150.95 12177.57,-1150.95 12177.57,-1203.95"/>
<text text-anchor="middle" x="12092.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="12092.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="12092.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_40_gpu5 -->
<g id="node215" class="node">
<title>l1_expert_40_gpu5</title>
<polygon fill="lightpink" stroke="black" points="15605.07,-1114.95 15510.07,-1114.95 15510.07,-1061.95 15605.07,-1061.95 15605.07,-1114.95"/>
<text text-anchor="middle" x="15557.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="15557.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="15557.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu5 -->
<g id="node224" class="node">
<title>l1_expert_agg_gpu5</title>
<polygon fill="yellow" stroke="black" points="15878.2,-1017.45 15638.58,-1017.45 15576.94,-981.45 15816.56,-981.45 15878.2,-1017.45"/>
<text text-anchor="middle" x="15727.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_40_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge373" class="edge">
<title>l1_expert_40_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15605.38,-1062.99C15630.45,-1050.15 15660.92,-1034.56 15685.15,-1022.16"/>
<polygon fill="black" stroke="black" points="15686.8,-1025.25 15694.11,-1017.58 15683.61,-1019.02 15686.8,-1025.25"/>
</g>
<!-- l1_expert_41_gpu5 -->
<g id="node216" class="node">
<title>l1_expert_41_gpu5</title>
<polygon fill="lightpink" stroke="black" points="15718.07,-1114.95 15623.07,-1114.95 15623.07,-1061.95 15718.07,-1061.95 15718.07,-1114.95"/>
<text text-anchor="middle" x="15670.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="15670.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="15670.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_41_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge376" class="edge">
<title>l1_expert_41_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15687.36,-1061.82C15694.72,-1050.59 15703.34,-1037.43 15710.71,-1026.19"/>
<polygon fill="black" stroke="black" points="15713.75,-1027.94 15716.3,-1017.65 15707.89,-1024.1 15713.75,-1027.94"/>
</g>
<!-- l1_expert_42_gpu5 -->
<g id="node217" class="node">
<title>l1_expert_42_gpu5</title>
<polygon fill="lightpink" stroke="black" points="15831.07,-1114.95 15736.07,-1114.95 15736.07,-1061.95 15831.07,-1061.95 15831.07,-1114.95"/>
<text text-anchor="middle" x="15783.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="15783.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="15783.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_42_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge379" class="edge">
<title>l1_expert_42_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15767.07,-1061.82C15759.84,-1050.59 15751.37,-1037.43 15744.13,-1026.19"/>
<polygon fill="black" stroke="black" points="15747,-1024.17 15738.64,-1017.65 15741.11,-1027.96 15747,-1024.17"/>
</g>
<!-- l1_expert_43_gpu5 -->
<g id="node218" class="node">
<title>l1_expert_43_gpu5</title>
<polygon fill="lightpink" stroke="black" points="15944.07,-1114.95 15849.07,-1114.95 15849.07,-1061.95 15944.07,-1061.95 15944.07,-1114.95"/>
<text text-anchor="middle" x="15896.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="15896.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="15896.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_43_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge382" class="edge">
<title>l1_expert_43_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15849.04,-1062.99C15824.11,-1050.15 15793.83,-1034.56 15769.74,-1022.16"/>
<polygon fill="black" stroke="black" points="15771.32,-1019.04 15760.83,-1017.58 15768.12,-1025.27 15771.32,-1019.04"/>
</g>
<!-- l1_expert_44_gpu5 -->
<g id="node219" class="node">
<title>l1_expert_44_gpu5</title>
<polygon fill="lightpink" stroke="black" points="16057.07,-1114.95 15962.07,-1114.95 15962.07,-1061.95 16057.07,-1061.95 16057.07,-1114.95"/>
<text text-anchor="middle" x="16009.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="16009.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="16009.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_44_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge385" class="edge">
<title>l1_expert_44_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15961.82,-1065.1C15959.05,-1063.99 15956.28,-1062.93 15953.57,-1061.95 15907.53,-1045.33 15854.82,-1030.74 15811.89,-1019.95"/>
<polygon fill="black" stroke="black" points="15812.59,-1016.52 15802.04,-1017.5 15810.9,-1023.31 15812.59,-1016.52"/>
</g>
<!-- l1_expert_45_gpu5 -->
<g id="node220" class="node">
<title>l1_expert_45_gpu5</title>
<polygon fill="lightpink" stroke="black" points="16170.07,-1114.95 16075.07,-1114.95 16075.07,-1061.95 16170.07,-1061.95 16170.07,-1114.95"/>
<text text-anchor="middle" x="16122.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="16122.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="16122.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_45_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge388" class="edge">
<title>l1_expert_45_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M16074.91,-1064.81C16072.12,-1063.78 16069.32,-1062.82 16066.57,-1061.95 16005.06,-1042.7 15935.27,-1028.76 15875.07,-1019.07"/>
<polygon fill="black" stroke="black" points="15875.54,-1015.6 15865.11,-1017.49 15874.44,-1022.51 15875.54,-1015.6"/>
</g>
<!-- l1_expert_46_gpu5 -->
<g id="node221" class="node">
<title>l1_expert_46_gpu5</title>
<polygon fill="lightpink" stroke="black" points="15379.07,-1114.95 15284.07,-1114.95 15284.07,-1061.95 15379.07,-1061.95 15379.07,-1114.95"/>
<text text-anchor="middle" x="15331.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="15331.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="15331.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_46_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge391" class="edge">
<title>l1_expert_46_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15379.14,-1065.17C15382.3,-1064 15385.46,-1062.91 15388.57,-1061.95 15463.85,-1038.66 15551.42,-1023.06 15618.7,-1013.39"/>
<polygon fill="black" stroke="black" points="15619.48,-1016.82 15628.9,-1011.95 15618.5,-1009.89 15619.48,-1016.82"/>
</g>
<!-- l1_expert_47_gpu5 -->
<g id="node222" class="node">
<title>l1_expert_47_gpu5</title>
<polygon fill="lightpink" stroke="black" points="15492.07,-1114.95 15397.07,-1114.95 15397.07,-1061.95 15492.07,-1061.95 15492.07,-1114.95"/>
<text text-anchor="middle" x="15444.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="15444.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="15444.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_47_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge394" class="edge">
<title>l1_expert_47_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15492.24,-1065.48C15495.38,-1064.24 15498.51,-1063.05 15501.57,-1061.95 15547.84,-1045.42 15600.78,-1030.79 15643.79,-1019.96"/>
<polygon fill="black" stroke="black" points="15644.8,-1023.31 15653.65,-1017.49 15643.1,-1016.52 15644.8,-1023.31"/>
</g>
<!-- l1_gate_gpu5 -->
<g id="node223" class="node">
<title>l1_gate_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="15831.36,-1195.45 15755.33,-1195.45 15735.77,-1159.45 15811.8,-1159.45 15831.36,-1195.45"/>
<text text-anchor="middle" x="15783.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_40_gpu5 -->
<g id="edge371" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_40_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15735.87,-1160.12C15703.96,-1148.96 15660.88,-1133.45 15614.64,-1114.88"/>
<polygon fill="black" stroke="black" points="15615.94,-1111.63 15605.36,-1111.13 15613.32,-1118.12 15615.94,-1111.63"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_41_gpu5 -->
<g id="edge374" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_41_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15761.24,-1159.26C15747.2,-1148.46 15728.65,-1134.17 15711.99,-1121.35"/>
<polygon fill="black" stroke="black" points="15714.05,-1118.51 15703.99,-1115.19 15709.78,-1124.06 15714.05,-1118.51"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_42_gpu5 -->
<g id="edge377" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_42_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15783.57,-1159.26C15783.57,-1149.54 15783.57,-1137 15783.57,-1125.23"/>
<polygon fill="black" stroke="black" points="15787.07,-1125.19 15783.57,-1115.19 15780.07,-1125.19 15787.07,-1125.19"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_43_gpu5 -->
<g id="edge380" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_43_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15805.89,-1159.26C15819.93,-1148.46 15838.48,-1134.17 15855.15,-1121.35"/>
<polygon fill="black" stroke="black" points="15857.36,-1124.06 15863.14,-1115.19 15853.09,-1118.51 15857.36,-1124.06"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_44_gpu5 -->
<g id="edge383" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_44_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15815.5,-1165.76C15847.94,-1154.71 15899.76,-1136.54 15952.51,-1115.28"/>
<polygon fill="black" stroke="black" points="15954.07,-1118.42 15962.02,-1111.42 15951.44,-1111.94 15954.07,-1118.42"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_45_gpu5 -->
<g id="edge386" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_45_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15818.62,-1171.31C15870.94,-1163.1 15972.46,-1145.12 16065.34,-1115.11"/>
<polygon fill="black" stroke="black" points="16066.47,-1118.43 16074.88,-1111.98 16064.28,-1111.78 16066.47,-1118.43"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_46_gpu5 -->
<g id="edge389" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_46_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15742.08,-1171.41C15658.21,-1161.01 15470.31,-1136.51 15388.75,-1114.56"/>
<polygon fill="black" stroke="black" points="15389.69,-1111.19 15379.11,-1111.83 15387.78,-1117.92 15389.69,-1111.19"/>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert_47_gpu5 -->
<g id="edge392" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert_47_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15741.28,-1170.03C15687.39,-1161.23 15591.47,-1143.53 15501.69,-1114.71"/>
<polygon fill="black" stroke="black" points="15502.77,-1111.38 15492.18,-1111.61 15500.6,-1118.04 15502.77,-1111.38"/>
</g>
<!-- l1_res2_gpu5 -->
<g id="node225" class="node">
<title>l1_res2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="15782.57,-928.45 15672.57,-928.45 15672.57,-892.45 15782.57,-892.45 15782.57,-928.45"/>
<text text-anchor="middle" x="15727.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu5&#45;&gt;l1_res2_gpu5 -->
<g id="edge395" class="edge">
<title>l1_expert_agg_gpu5&#45;&gt;l1_res2_gpu5</title>
<path fill="none" stroke="black" d="M15727.57,-981.26C15727.57,-969.11 15727.57,-952.57 15727.57,-938.63"/>
<polygon fill="black" stroke="black" points="15731.07,-938.61 15727.57,-928.61 15724.07,-938.61 15731.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu13 -->
<g id="node338" class="node">
<title>l2_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="14309.07,-797.95 14214.07,-797.95 14214.07,-744.95 14309.07,-744.95 14309.07,-797.95"/>
<text text-anchor="middle" x="14261.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="14261.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14261.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu5&#45;&gt;l2_mha_qkv_gpu13 -->
<g id="edge534" class="edge">
<title>l1_res2_gpu5&#45;&gt;l2_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M15672.47,-902C15595.94,-892.03 15453.04,-874.82 15330.57,-867.95 15316.52,-867.17 14329.88,-866.76 14317.57,-859.95 14297.31,-848.76 14283.29,-826.81 14274.35,-807.69"/>
<polygon fill="black" stroke="black" points="14277.46,-806.07 14270.24,-798.31 14271.04,-808.87 14277.46,-806.07"/>
</g>
<!-- l1_mha_attn_gpu6 -->
<g id="node227" class="node">
<title>l1_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="14172.57,-1114.95 14002.57,-1114.95 14002.57,-1061.95 14172.57,-1061.95 14172.57,-1114.95"/>
<text text-anchor="middle" x="14087.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="14087.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14087.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu6&#45;&gt;l1_mha_attn_gpu6 -->
<g id="edge431" class="edge">
<title>l1_mha_qkv_gpu6&#45;&gt;l1_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M15396.46,-1170.35C15316.49,-1164.76 15193.45,-1156.53 15086.57,-1150.95 14685.02,-1130 14580.09,-1175.45 14182.57,-1114.95 14182.47,-1114.94 14182.36,-1114.92 14182.26,-1114.91"/>
<polygon fill="black" stroke="black" points="14183.02,-1111.48 14172.57,-1113.25 14181.84,-1118.38 14183.02,-1111.48"/>
</g>
<!-- l1_mha_out_gpu6 -->
<g id="node228" class="node">
<title>l1_mha_out_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="14405.57,-1025.95 14235.57,-1025.95 14235.57,-972.95 14405.57,-972.95 14405.57,-1025.95"/>
<text text-anchor="middle" x="14320.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="14320.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14320.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu6&#45;&gt;l1_mha_out_gpu6 -->
<g id="edge432" class="edge">
<title>l1_mha_attn_gpu6&#45;&gt;l1_mha_out_gpu6</title>
<path fill="none" stroke="black" d="M14155.9,-1061.94C14183.17,-1051.76 14214.7,-1039.98 14242.84,-1029.48"/>
<polygon fill="black" stroke="black" points="14244.09,-1032.74 14252.24,-1025.97 14241.64,-1026.19 14244.09,-1032.74"/>
</g>
<!-- l1_mha_allreduce_gpu6 -->
<g id="node229" class="node">
<title>l1_mha_allreduce_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="15321.57,-936.95 15151.57,-936.95 15151.57,-883.95 15321.57,-883.95 15321.57,-936.95"/>
<text text-anchor="middle" x="15236.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="15236.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15236.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu6&#45;&gt;l1_mha_allreduce_gpu6 -->
<g id="edge433" class="edge">
<title>l1_mha_out_gpu6&#45;&gt;l1_mha_allreduce_gpu6</title>
<path fill="none" stroke="black" d="M14405.76,-982.94C14427.79,-979.29 14451.52,-975.67 14473.57,-972.95 14712.98,-943.41 14996.49,-924.84 15141.19,-916.54"/>
<polygon fill="black" stroke="black" points="15141.58,-920.02 15151.36,-915.96 15141.18,-913.03 15141.58,-920.02"/>
</g>
<!-- l1_mha_allreduce_gpu6&#45;&gt;l1_res_add_gpu6 -->
<g id="edge434" class="edge">
<title>l1_mha_allreduce_gpu6&#45;&gt;l1_res_add_gpu6</title>
<path fill="none" stroke="black" d="M15321.58,-917.66C15407.72,-923.68 15544.83,-932.53 15663.57,-936.95 15799.05,-942 17972.45,-938.48 18103.57,-972.95 18175.27,-991.8 18364.33,-1106.51 18442.25,-1154.92"/>
<polygon fill="black" stroke="black" points="18440.41,-1157.9 18450.75,-1160.22 18444.11,-1151.96 18440.41,-1157.9"/>
</g>
<!-- l1_mha_res_add_gpu6 -->
<g id="node230" class="node">
<title>l1_mha_res_add_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="11282.57,-1203.95 11112.57,-1203.95 11112.57,-1150.95 11282.57,-1150.95 11282.57,-1203.95"/>
<text text-anchor="middle" x="11197.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="11197.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11197.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_48_gpu6 -->
<g id="node231" class="node">
<title>l1_expert_48_gpu6</title>
<polygon fill="lightpink" stroke="black" points="17074.07,-1114.95 16979.07,-1114.95 16979.07,-1061.95 17074.07,-1061.95 17074.07,-1114.95"/>
<text text-anchor="middle" x="17026.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="17026.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="17026.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu6 -->
<g id="node240" class="node">
<title>l1_expert_agg_gpu6</title>
<polygon fill="yellow" stroke="black" points="16782.2,-1017.45 16542.58,-1017.45 16480.94,-981.45 16720.56,-981.45 16782.2,-1017.45"/>
<text text-anchor="middle" x="16631.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_48_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge439" class="edge">
<title>l1_expert_48_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16978.91,-1064.81C16976.12,-1063.78 16973.32,-1062.82 16970.57,-1061.95 16909.06,-1042.7 16839.27,-1028.76 16779.07,-1019.07"/>
<polygon fill="black" stroke="black" points="16779.54,-1015.6 16769.11,-1017.49 16778.44,-1022.51 16779.54,-1015.6"/>
</g>
<!-- l1_expert_49_gpu6 -->
<g id="node232" class="node">
<title>l1_expert_49_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16283.07,-1114.95 16188.07,-1114.95 16188.07,-1061.95 16283.07,-1061.95 16283.07,-1114.95"/>
<text text-anchor="middle" x="16235.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="16235.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16235.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_49_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge442" class="edge">
<title>l1_expert_49_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16283.14,-1065.17C16286.3,-1064 16289.46,-1062.91 16292.57,-1061.95 16367.85,-1038.66 16455.42,-1023.06 16522.7,-1013.39"/>
<polygon fill="black" stroke="black" points="16523.48,-1016.82 16532.9,-1011.95 16522.5,-1009.89 16523.48,-1016.82"/>
</g>
<!-- l1_expert_50_gpu6 -->
<g id="node233" class="node">
<title>l1_expert_50_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16396.07,-1114.95 16301.07,-1114.95 16301.07,-1061.95 16396.07,-1061.95 16396.07,-1114.95"/>
<text text-anchor="middle" x="16348.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="16348.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16348.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_50_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge445" class="edge">
<title>l1_expert_50_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16396.24,-1065.48C16399.38,-1064.24 16402.51,-1063.05 16405.57,-1061.95 16451.84,-1045.42 16504.78,-1030.79 16547.79,-1019.96"/>
<polygon fill="black" stroke="black" points="16548.8,-1023.31 16557.65,-1017.49 16547.1,-1016.52 16548.8,-1023.31"/>
</g>
<!-- l1_expert_51_gpu6 -->
<g id="node234" class="node">
<title>l1_expert_51_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16509.07,-1114.95 16414.07,-1114.95 16414.07,-1061.95 16509.07,-1061.95 16509.07,-1114.95"/>
<text text-anchor="middle" x="16461.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="16461.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16461.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_51_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge448" class="edge">
<title>l1_expert_51_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16509.38,-1062.99C16534.45,-1050.15 16564.92,-1034.56 16589.15,-1022.16"/>
<polygon fill="black" stroke="black" points="16590.8,-1025.25 16598.11,-1017.58 16587.61,-1019.02 16590.8,-1025.25"/>
</g>
<!-- l1_expert_52_gpu6 -->
<g id="node235" class="node">
<title>l1_expert_52_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16622.07,-1114.95 16527.07,-1114.95 16527.07,-1061.95 16622.07,-1061.95 16622.07,-1114.95"/>
<text text-anchor="middle" x="16574.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="16574.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16574.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_52_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge451" class="edge">
<title>l1_expert_52_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16591.36,-1061.82C16598.72,-1050.59 16607.34,-1037.43 16614.71,-1026.19"/>
<polygon fill="black" stroke="black" points="16617.75,-1027.94 16620.3,-1017.65 16611.89,-1024.1 16617.75,-1027.94"/>
</g>
<!-- l1_expert_53_gpu6 -->
<g id="node236" class="node">
<title>l1_expert_53_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16735.07,-1114.95 16640.07,-1114.95 16640.07,-1061.95 16735.07,-1061.95 16735.07,-1114.95"/>
<text text-anchor="middle" x="16687.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="16687.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16687.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_53_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge454" class="edge">
<title>l1_expert_53_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16671.07,-1061.82C16663.84,-1050.59 16655.37,-1037.43 16648.13,-1026.19"/>
<polygon fill="black" stroke="black" points="16651,-1024.17 16642.64,-1017.65 16645.11,-1027.96 16651,-1024.17"/>
</g>
<!-- l1_expert_54_gpu6 -->
<g id="node237" class="node">
<title>l1_expert_54_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16848.07,-1114.95 16753.07,-1114.95 16753.07,-1061.95 16848.07,-1061.95 16848.07,-1114.95"/>
<text text-anchor="middle" x="16800.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="16800.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16800.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_54_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge457" class="edge">
<title>l1_expert_54_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16753.04,-1062.99C16728.11,-1050.15 16697.83,-1034.56 16673.74,-1022.16"/>
<polygon fill="black" stroke="black" points="16675.32,-1019.04 16664.83,-1017.58 16672.12,-1025.27 16675.32,-1019.04"/>
</g>
<!-- l1_expert_55_gpu6 -->
<g id="node238" class="node">
<title>l1_expert_55_gpu6</title>
<polygon fill="lightpink" stroke="black" points="16961.07,-1114.95 16866.07,-1114.95 16866.07,-1061.95 16961.07,-1061.95 16961.07,-1114.95"/>
<text text-anchor="middle" x="16913.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="16913.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16913.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_55_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge460" class="edge">
<title>l1_expert_55_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16865.82,-1065.1C16863.05,-1063.99 16860.28,-1062.93 16857.57,-1061.95 16811.53,-1045.33 16758.82,-1030.74 16715.89,-1019.95"/>
<polygon fill="black" stroke="black" points="16716.59,-1016.52 16706.04,-1017.5 16714.9,-1023.31 16716.59,-1016.52"/>
</g>
<!-- l1_gate_gpu6 -->
<g id="node239" class="node">
<title>l1_gate_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="16735.36,-1195.45 16659.33,-1195.45 16639.77,-1159.45 16715.8,-1159.45 16735.36,-1195.45"/>
<text text-anchor="middle" x="16687.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_48_gpu6 -->
<g id="edge437" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_48_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16722.62,-1171.31C16774.94,-1163.1 16876.46,-1145.12 16969.34,-1115.11"/>
<polygon fill="black" stroke="black" points="16970.47,-1118.43 16978.88,-1111.98 16968.28,-1111.78 16970.47,-1118.43"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_49_gpu6 -->
<g id="edge440" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_49_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16645.13,-1169.62C16612.89,-1164.44 16567.45,-1157.19 16527.57,-1150.95 16426.33,-1135.13 16395.77,-1144.21 16292.95,-1114.71"/>
<polygon fill="black" stroke="black" points="16293.69,-1111.28 16283.11,-1111.84 16291.73,-1118 16293.69,-1111.28"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_50_gpu6 -->
<g id="edge443" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_50_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16645.28,-1170.03C16591.39,-1161.23 16495.47,-1143.53 16405.69,-1114.71"/>
<polygon fill="black" stroke="black" points="16406.77,-1111.38 16396.18,-1111.61 16404.6,-1118.04 16406.77,-1111.38"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_51_gpu6 -->
<g id="edge446" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_51_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16639.87,-1160.12C16607.96,-1148.96 16564.88,-1133.45 16518.64,-1114.88"/>
<polygon fill="black" stroke="black" points="16519.94,-1111.63 16509.36,-1111.13 16517.32,-1118.12 16519.94,-1111.63"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_52_gpu6 -->
<g id="edge449" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_52_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16665.24,-1159.26C16651.2,-1148.46 16632.65,-1134.17 16615.99,-1121.35"/>
<polygon fill="black" stroke="black" points="16618.05,-1118.51 16607.99,-1115.19 16613.78,-1124.06 16618.05,-1118.51"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_53_gpu6 -->
<g id="edge452" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_53_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16687.57,-1159.26C16687.57,-1149.54 16687.57,-1137 16687.57,-1125.23"/>
<polygon fill="black" stroke="black" points="16691.07,-1125.19 16687.57,-1115.19 16684.07,-1125.19 16691.07,-1125.19"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_54_gpu6 -->
<g id="edge455" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_54_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16709.89,-1159.26C16723.93,-1148.46 16742.48,-1134.17 16759.15,-1121.35"/>
<polygon fill="black" stroke="black" points="16761.36,-1124.06 16767.14,-1115.19 16757.09,-1118.51 16761.36,-1124.06"/>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert_55_gpu6 -->
<g id="edge458" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert_55_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16719.5,-1165.76C16751.94,-1154.71 16803.76,-1136.54 16856.51,-1115.28"/>
<polygon fill="black" stroke="black" points="16858.07,-1118.42 16866.02,-1111.42 16855.44,-1111.94 16858.07,-1118.42"/>
</g>
<!-- l1_res2_gpu6 -->
<g id="node241" class="node">
<title>l1_res2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="16686.57,-928.45 16576.57,-928.45 16576.57,-892.45 16686.57,-892.45 16686.57,-928.45"/>
<text text-anchor="middle" x="16631.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu6&#45;&gt;l1_res2_gpu6 -->
<g id="edge461" class="edge">
<title>l1_expert_agg_gpu6&#45;&gt;l1_res2_gpu6</title>
<path fill="none" stroke="black" d="M16631.57,-981.26C16631.57,-969.11 16631.57,-952.57 16631.57,-938.63"/>
<polygon fill="black" stroke="black" points="16635.07,-938.61 16631.57,-928.61 16628.07,-938.61 16635.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu14 -->
<g id="node354" class="node">
<title>l2_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15279.07,-797.95 15184.07,-797.95 15184.07,-744.95 15279.07,-744.95 15279.07,-797.95"/>
<text text-anchor="middle" x="15231.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="15231.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15231.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu6&#45;&gt;l2_mha_qkv_gpu14 -->
<g id="edge535" class="edge">
<title>l1_res2_gpu6&#45;&gt;l2_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M16576.56,-906.1C16442.42,-898.05 16087.81,-877.62 15791.57,-867.95 15777.57,-867.5 15299.8,-866.77 15287.57,-859.95 15267.36,-848.68 15253.34,-826.73 15244.38,-807.63"/>
<polygon fill="black" stroke="black" points="15247.49,-806.01 15240.27,-798.26 15241.08,-808.82 15247.49,-806.01"/>
</g>
<!-- l1_mha_attn_gpu7 -->
<g id="node243" class="node">
<title>l1_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="15265.57,-1114.95 15095.57,-1114.95 15095.57,-1061.95 15265.57,-1061.95 15265.57,-1114.95"/>
<text text-anchor="middle" x="15180.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="15180.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15180.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_qkv_gpu7&#45;&gt;l1_mha_attn_gpu7 -->
<g id="edge497" class="edge">
<title>l1_mha_qkv_gpu7&#45;&gt;l1_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M16348.33,-1168.26C16288.1,-1162.71 16205.45,-1155.57 16132.57,-1150.95 15752.11,-1126.86 15652.39,-1172.72 15275.57,-1114.95 15275.47,-1114.94 15275.36,-1114.92 15275.26,-1114.91"/>
<polygon fill="black" stroke="black" points="15276.02,-1111.49 15265.57,-1113.24 15274.83,-1118.38 15276.02,-1111.49"/>
</g>
<!-- l1_mha_out_gpu7 -->
<g id="node244" class="node">
<title>l1_mha_out_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="15412.57,-1025.95 15242.57,-1025.95 15242.57,-972.95 15412.57,-972.95 15412.57,-1025.95"/>
<text text-anchor="middle" x="15327.57" y="-1010.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="15327.57" y="-995.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15327.57" y="-980.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_attn_gpu7&#45;&gt;l1_mha_out_gpu7 -->
<g id="edge498" class="edge">
<title>l1_mha_attn_gpu7&#45;&gt;l1_mha_out_gpu7</title>
<path fill="none" stroke="black" d="M15223.88,-1061.82C15240.11,-1052.22 15258.71,-1041.21 15275.64,-1031.19"/>
<polygon fill="black" stroke="black" points="15277.49,-1034.16 15284.31,-1026.05 15273.93,-1028.13 15277.49,-1034.16"/>
</g>
<!-- l1_mha_allreduce_gpu7 -->
<g id="node245" class="node">
<title>l1_mha_allreduce_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="17224.57,-936.95 17054.57,-936.95 17054.57,-883.95 17224.57,-883.95 17224.57,-936.95"/>
<text text-anchor="middle" x="17139.57" y="-921.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="17139.57" y="-906.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17139.57" y="-891.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_mha_out_gpu7&#45;&gt;l1_mha_allreduce_gpu7 -->
<g id="edge499" class="edge">
<title>l1_mha_out_gpu7&#45;&gt;l1_mha_allreduce_gpu7</title>
<path fill="none" stroke="black" d="M15412.68,-987.86C15458.51,-982.55 15516.05,-976.51 15567.57,-972.95 16067.97,-938.43 16194.48,-959.34 16695.57,-936.95 16815.89,-931.58 16954.43,-923.29 17044.31,-917.63"/>
<polygon fill="black" stroke="black" points="17044.72,-921.11 17054.48,-916.99 17044.28,-914.12 17044.72,-921.11"/>
</g>
<!-- l1_mha_allreduce_gpu7&#45;&gt;l1_res_add_gpu7 -->
<g id="edge500" class="edge">
<title>l1_mha_allreduce_gpu7&#45;&gt;l1_res_add_gpu7</title>
<path fill="none" stroke="black" d="M17224.89,-918.94C17291.7,-924.58 17386.99,-932.14 17470.57,-936.95 17575.25,-942.98 18315.25,-936.52 18413.57,-972.95 18516.02,-1010.92 18609.11,-1106.81 18649.01,-1152.07"/>
<polygon fill="black" stroke="black" points="18646.41,-1154.41 18655.62,-1159.66 18651.69,-1149.82 18646.41,-1154.41"/>
</g>
<!-- l1_mha_res_add_gpu7 -->
<g id="node246" class="node">
<title>l1_mha_res_add_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="10180.57,-1203.95 10010.57,-1203.95 10010.57,-1150.95 10180.57,-1150.95 10180.57,-1203.95"/>
<text text-anchor="middle" x="10095.57" y="-1188.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="10095.57" y="-1173.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10095.57" y="-1158.75" font-family="Times,serif" font-size="14.00">Same dims as layer 0</text>
</g>
<!-- l1_expert_56_gpu7 -->
<g id="node247" class="node">
<title>l1_expert_56_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17752.07,-1114.95 17657.07,-1114.95 17657.07,-1061.95 17752.07,-1061.95 17752.07,-1114.95"/>
<text text-anchor="middle" x="17704.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="17704.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17704.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_agg_gpu7 -->
<g id="node256" class="node">
<title>l1_expert_agg_gpu7</title>
<polygon fill="yellow" stroke="black" points="17685.2,-1017.45 17445.58,-1017.45 17383.94,-981.45 17623.56,-981.45 17685.2,-1017.45"/>
<text text-anchor="middle" x="17534.57" y="-995.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l1_expert_56_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge505" class="edge">
<title>l1_expert_56_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17656.76,-1062.99C17631.68,-1050.15 17601.22,-1034.56 17576.99,-1022.16"/>
<polygon fill="black" stroke="black" points="17578.52,-1019.02 17568.03,-1017.58 17575.34,-1025.25 17578.52,-1019.02"/>
</g>
<!-- l1_expert_57_gpu7 -->
<g id="node248" class="node">
<title>l1_expert_57_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17865.07,-1114.95 17770.07,-1114.95 17770.07,-1061.95 17865.07,-1061.95 17865.07,-1114.95"/>
<text text-anchor="middle" x="17817.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="17817.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17817.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_57_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge508" class="edge">
<title>l1_expert_57_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17769.82,-1065.09C17767.05,-1063.99 17764.28,-1062.93 17761.57,-1061.95 17715.33,-1045.29 17662.39,-1030.7 17619.27,-1019.92"/>
<polygon fill="black" stroke="black" points="17619.93,-1016.47 17609.38,-1017.47 17618.24,-1023.27 17619.93,-1016.47"/>
</g>
<!-- l1_expert_58_gpu7 -->
<g id="node249" class="node">
<title>l1_expert_58_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17978.07,-1114.95 17883.07,-1114.95 17883.07,-1061.95 17978.07,-1061.95 17978.07,-1114.95"/>
<text text-anchor="middle" x="17930.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="17930.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17930.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_58_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge511" class="edge">
<title>l1_expert_58_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17882.91,-1064.81C17880.12,-1063.78 17877.32,-1062.81 17874.57,-1061.95 17813.02,-1042.7 17743.19,-1028.77 17682.91,-1019.09"/>
<polygon fill="black" stroke="black" points="17683.35,-1015.62 17672.93,-1017.51 17682.26,-1022.53 17683.35,-1015.62"/>
</g>
<!-- l1_expert_59_gpu7 -->
<g id="node250" class="node">
<title>l1_expert_59_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17187.07,-1114.95 17092.07,-1114.95 17092.07,-1061.95 17187.07,-1061.95 17187.07,-1114.95"/>
<text text-anchor="middle" x="17139.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="17139.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17139.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_59_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge514" class="edge">
<title>l1_expert_59_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17187.14,-1065.17C17190.3,-1064 17193.46,-1062.92 17196.57,-1061.95 17271.63,-1038.71 17358.94,-1023.1 17426.02,-1013.43"/>
<polygon fill="black" stroke="black" points="17426.78,-1016.85 17436.19,-1011.98 17425.79,-1009.92 17426.78,-1016.85"/>
</g>
<!-- l1_expert_60_gpu7 -->
<g id="node251" class="node">
<title>l1_expert_60_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17300.07,-1114.95 17205.07,-1114.95 17205.07,-1061.95 17300.07,-1061.95 17300.07,-1114.95"/>
<text text-anchor="middle" x="17252.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="17252.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17252.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_60_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge517" class="edge">
<title>l1_expert_60_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17300.24,-1065.48C17303.38,-1064.24 17306.51,-1063.05 17309.57,-1061.95 17355.73,-1045.43 17408.55,-1030.78 17451.41,-1019.93"/>
<polygon fill="black" stroke="black" points="17452.39,-1023.29 17461.24,-1017.46 17450.69,-1016.5 17452.39,-1023.29"/>
</g>
<!-- l1_expert_61_gpu7 -->
<g id="node252" class="node">
<title>l1_expert_61_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17413.07,-1114.95 17318.07,-1114.95 17318.07,-1061.95 17413.07,-1061.95 17413.07,-1114.95"/>
<text text-anchor="middle" x="17365.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="17365.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17365.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_61_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge520" class="edge">
<title>l1_expert_61_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17413.09,-1062.99C17438.03,-1050.15 17468.31,-1034.56 17492.4,-1022.16"/>
<polygon fill="black" stroke="black" points="17494.02,-1025.27 17501.31,-1017.58 17490.81,-1019.04 17494.02,-1025.27"/>
</g>
<!-- l1_expert_62_gpu7 -->
<g id="node253" class="node">
<title>l1_expert_62_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17526.07,-1114.95 17431.07,-1114.95 17431.07,-1061.95 17526.07,-1061.95 17526.07,-1114.95"/>
<text text-anchor="middle" x="17478.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="17478.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17478.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_62_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge523" class="edge">
<title>l1_expert_62_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17495.07,-1061.82C17502.3,-1050.59 17510.77,-1037.43 17518,-1026.19"/>
<polygon fill="black" stroke="black" points="17521.03,-1027.96 17523.5,-1017.65 17515.14,-1024.17 17521.03,-1027.96"/>
</g>
<!-- l1_expert_63_gpu7 -->
<g id="node254" class="node">
<title>l1_expert_63_gpu7</title>
<polygon fill="lightpink" stroke="black" points="17639.07,-1114.95 17544.07,-1114.95 17544.07,-1061.95 17639.07,-1061.95 17639.07,-1114.95"/>
<text text-anchor="middle" x="17591.57" y="-1099.75" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="17591.57" y="-1084.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17591.57" y="-1069.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_expert_63_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge526" class="edge">
<title>l1_expert_63_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17574.77,-1061.82C17567.42,-1050.59 17558.8,-1037.43 17551.43,-1026.19"/>
<polygon fill="black" stroke="black" points="17554.25,-1024.1 17545.84,-1017.65 17548.39,-1027.94 17554.25,-1024.1"/>
</g>
<!-- l1_gate_gpu7 -->
<g id="node255" class="node">
<title>l1_gate_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="17639.36,-1195.45 17563.33,-1195.45 17543.77,-1159.45 17619.8,-1159.45 17639.36,-1195.45"/>
<text text-anchor="middle" x="17591.57" y="-1173.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_56_gpu7 -->
<g id="edge503" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_56_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17613.89,-1159.26C17627.93,-1148.46 17646.48,-1134.17 17663.15,-1121.35"/>
<polygon fill="black" stroke="black" points="17665.36,-1124.06 17671.14,-1115.19 17661.09,-1118.51 17665.36,-1124.06"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_57_gpu7 -->
<g id="edge506" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_57_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17623.5,-1165.76C17655.94,-1154.71 17707.76,-1136.54 17760.51,-1115.28"/>
<polygon fill="black" stroke="black" points="17762.07,-1118.42 17770.02,-1111.42 17759.44,-1111.94 17762.07,-1118.42"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_58_gpu7 -->
<g id="edge509" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_58_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17626.62,-1171.31C17678.94,-1163.1 17780.46,-1145.12 17873.34,-1115.11"/>
<polygon fill="black" stroke="black" points="17874.47,-1118.43 17882.88,-1111.98 17872.28,-1111.78 17874.47,-1118.43"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_59_gpu7 -->
<g id="edge512" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_59_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17551.27,-1173.73C17480.71,-1168.21 17330.42,-1153.07 17197.09,-1114.75"/>
<polygon fill="black" stroke="black" points="17197.69,-1111.28 17187.11,-1111.83 17195.73,-1118 17197.69,-1111.28"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_60_gpu7 -->
<g id="edge515" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_60_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17549.28,-1170.03C17495.39,-1161.23 17399.47,-1143.53 17309.69,-1114.71"/>
<polygon fill="black" stroke="black" points="17310.77,-1111.38 17300.18,-1111.61 17308.6,-1118.04 17310.77,-1111.38"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_61_gpu7 -->
<g id="edge518" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_61_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17543.87,-1160.12C17511.96,-1148.96 17468.88,-1133.45 17422.64,-1114.88"/>
<polygon fill="black" stroke="black" points="17423.94,-1111.63 17413.36,-1111.13 17421.32,-1118.12 17423.94,-1111.63"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_62_gpu7 -->
<g id="edge521" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_62_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17569.24,-1159.26C17555.2,-1148.46 17536.65,-1134.17 17519.99,-1121.35"/>
<polygon fill="black" stroke="black" points="17522.05,-1118.51 17511.99,-1115.19 17517.78,-1124.06 17522.05,-1118.51"/>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert_63_gpu7 -->
<g id="edge524" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert_63_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17591.57,-1159.26C17591.57,-1149.54 17591.57,-1137 17591.57,-1125.23"/>
<polygon fill="black" stroke="black" points="17595.07,-1125.19 17591.57,-1115.19 17588.07,-1125.19 17595.07,-1125.19"/>
</g>
<!-- l1_res2_gpu7 -->
<g id="node257" class="node">
<title>l1_res2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="17589.57,-928.45 17479.57,-928.45 17479.57,-892.45 17589.57,-892.45 17589.57,-928.45"/>
<text text-anchor="middle" x="17534.57" y="-906.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l1_expert_agg_gpu7&#45;&gt;l1_res2_gpu7 -->
<g id="edge527" class="edge">
<title>l1_expert_agg_gpu7&#45;&gt;l1_res2_gpu7</title>
<path fill="none" stroke="black" d="M17534.57,-981.26C17534.57,-969.11 17534.57,-952.57 17534.57,-938.63"/>
<polygon fill="black" stroke="black" points="17538.07,-938.61 17534.57,-928.61 17531.07,-938.61 17538.07,-938.61"/>
</g>
<!-- l2_mha_qkv_gpu15 -->
<g id="node370" class="node">
<title>l2_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16199.07,-797.95 16104.07,-797.95 16104.07,-744.95 16199.07,-744.95 16199.07,-797.95"/>
<text text-anchor="middle" x="16151.57" y="-782.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="16151.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16151.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l1_res2_gpu7&#45;&gt;l2_mha_qkv_gpu15 -->
<g id="edge536" class="edge">
<title>l1_res2_gpu7&#45;&gt;l2_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M17479.32,-899.65C17419.12,-889.48 17319.85,-874.21 17233.57,-867.95 17219.36,-866.92 16220.04,-866.84 16207.57,-859.95 16187.31,-848.76 16173.29,-826.81 16164.35,-807.69"/>
<polygon fill="black" stroke="black" points="16167.46,-806.07 16160.24,-798.31 16161.04,-808.87 16167.46,-806.07"/>
</g>
<!-- l2_mha_attn_gpu8 -->
<g id="node259" class="node">
<title>l2_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="12154.07,-708.95 12059.07,-708.95 12059.07,-655.95 12154.07,-655.95 12154.07,-708.95"/>
<text text-anchor="middle" x="12106.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="12106.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="12106.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu8&#45;&gt;l2_mha_attn_gpu8 -->
<g id="edge537" class="edge">
<title>l2_mha_qkv_gpu8&#45;&gt;l2_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M10741.11,-766.29C10806.81,-760.68 10929.1,-750.72 11033.57,-744.95 11256.17,-732.67 11814.35,-760.01 12049.13,-708.83"/>
<polygon fill="black" stroke="black" points="12050.07,-712.2 12059.05,-706.57 12048.52,-705.38 12050.07,-712.2"/>
</g>
<!-- l2_res_add_gpu8 -->
<g id="node523" class="node">
<title>l2_res_add_gpu8</title>
<ellipse fill="none" stroke="black" cx="8623.57" cy="-771.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8623.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu8</text>
</g>
<!-- l2_mha_qkv_gpu8&#45;&gt;l2_res_add_gpu8 -->
<g id="edge541" class="edge">
<title>l2_mha_qkv_gpu8&#45;&gt;l2_res_add_gpu8</title>
<path fill="none" stroke="black" d="M10685.96,-797.97C10677,-822.93 10659.29,-857.43 10628.57,-863.95 10615.66,-866.69 8741.48,-866.69 8728.57,-863.95 8690.73,-855.92 8659.34,-822.1 8641.02,-797.67"/>
<polygon fill="black" stroke="black" points="8643.79,-795.53 8635.09,-789.48 8638.12,-799.64 8643.79,-795.53"/>
</g>
<!-- l2_mha_out_gpu8 -->
<g id="node260" class="node">
<title>l2_mha_out_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="12008.07,-619.95 11913.07,-619.95 11913.07,-566.95 12008.07,-566.95 12008.07,-619.95"/>
<text text-anchor="middle" x="11960.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="11960.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="11960.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu8&#45;&gt;l2_mha_out_gpu8 -->
<g id="edge538" class="edge">
<title>l2_mha_attn_gpu8&#45;&gt;l2_mha_out_gpu8</title>
<path fill="none" stroke="black" d="M12063.55,-655.82C12047.44,-646.22 12028.96,-635.21 12012.15,-625.19"/>
<polygon fill="black" stroke="black" points="12013.91,-622.16 12003.53,-620.05 12010.33,-628.18 12013.91,-622.16"/>
</g>
<!-- l2_mha_allreduce_gpu8 -->
<g id="node261" class="node">
<title>l2_mha_allreduce_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="11193.07,-530.95 11098.07,-530.95 11098.07,-477.95 11193.07,-477.95 11193.07,-530.95"/>
<text text-anchor="middle" x="11145.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="11145.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="11145.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu8&#45;&gt;l2_mha_allreduce_gpu8 -->
<g id="edge539" class="edge">
<title>l2_mha_out_gpu8&#45;&gt;l2_mha_allreduce_gpu8</title>
<path fill="none" stroke="black" d="M11913.03,-586.14C11871.91,-580.77 11810.86,-572.98 11757.57,-566.95 11554.04,-543.95 11311.93,-520.89 11203.31,-510.77"/>
<polygon fill="black" stroke="black" points="11203.5,-507.28 11193.22,-509.84 11202.86,-514.25 11203.5,-507.28"/>
</g>
<!-- l2_mha_allreduce_gpu8&#45;&gt;l2_res_add_gpu8 -->
<g id="edge540" class="edge">
<title>l2_mha_allreduce_gpu8&#45;&gt;l2_res_add_gpu8</title>
<path fill="none" stroke="black" d="M11097.82,-509.29C11024.64,-515 10880.32,-525.66 10757.57,-530.95 10563.82,-539.31 9200.41,-518.73 9012.57,-566.95 8868.38,-603.97 8717.78,-702.96 8654.48,-747.81"/>
<polygon fill="black" stroke="black" points="8652.24,-745.11 8646.13,-753.77 8656.31,-750.8 8652.24,-745.11"/>
</g>
<!-- l2_mha_res_add_gpu8 -->
<g id="node262" class="node">
<title>l2_mha_res_add_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="16715.07,-797.95 16620.07,-797.95 16620.07,-744.95 16715.07,-744.95 16715.07,-797.95"/>
<text text-anchor="middle" x="16667.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="16667.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16667.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_0_gpu8 -->
<g id="node263" class="node">
<title>l2_expert_0_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9781.07,-708.95 9686.07,-708.95 9686.07,-655.95 9781.07,-655.95 9781.07,-708.95"/>
<text text-anchor="middle" x="9733.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 64</text>
<text text-anchor="middle" x="9733.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9733.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu8 -->
<g id="node272" class="node">
<title>l2_expert_agg_gpu8</title>
<polygon fill="yellow" stroke="black" points="9940.2,-611.45 9700.58,-611.45 9638.94,-575.45 9878.56,-575.45 9940.2,-611.45"/>
<text text-anchor="middle" x="9789.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_0_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge545" class="edge">
<title>l2_expert_0_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9750.07,-655.82C9757.3,-644.59 9765.77,-631.43 9773,-620.19"/>
<polygon fill="black" stroke="black" points="9776.03,-621.96 9778.5,-611.65 9770.14,-618.17 9776.03,-621.96"/>
</g>
<!-- l2_expert_1_gpu8 -->
<g id="node264" class="node">
<title>l2_expert_1_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9894.07,-708.95 9799.07,-708.95 9799.07,-655.95 9894.07,-655.95 9894.07,-708.95"/>
<text text-anchor="middle" x="9846.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 65</text>
<text text-anchor="middle" x="9846.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9846.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_1_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge548" class="edge">
<title>l2_expert_1_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9829.77,-655.82C9822.42,-644.59 9813.8,-631.43 9806.43,-620.19"/>
<polygon fill="black" stroke="black" points="9809.25,-618.1 9800.84,-611.65 9803.39,-621.94 9809.25,-618.1"/>
</g>
<!-- l2_expert_2_gpu8 -->
<g id="node265" class="node">
<title>l2_expert_2_gpu8</title>
<polygon fill="lightpink" stroke="black" points="10007.07,-708.95 9912.07,-708.95 9912.07,-655.95 10007.07,-655.95 10007.07,-708.95"/>
<text text-anchor="middle" x="9959.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 66</text>
<text text-anchor="middle" x="9959.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9959.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_2_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge551" class="edge">
<title>l2_expert_2_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9911.76,-656.99C9886.68,-644.15 9856.22,-628.56 9831.99,-616.16"/>
<polygon fill="black" stroke="black" points="9833.52,-613.02 9823.03,-611.58 9830.34,-619.25 9833.52,-613.02"/>
</g>
<!-- l2_expert_3_gpu8 -->
<g id="node266" class="node">
<title>l2_expert_3_gpu8</title>
<polygon fill="lightpink" stroke="black" points="10120.07,-708.95 10025.07,-708.95 10025.07,-655.95 10120.07,-655.95 10120.07,-708.95"/>
<text text-anchor="middle" x="10072.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 67</text>
<text text-anchor="middle" x="10072.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10072.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_3_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge554" class="edge">
<title>l2_expert_3_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10024.82,-659.09C10022.05,-657.99 10019.28,-656.93 10016.57,-655.95 9970.33,-639.29 9917.39,-624.7 9874.27,-613.92"/>
<polygon fill="black" stroke="black" points="9874.93,-610.47 9864.38,-611.47 9873.24,-617.27 9874.93,-610.47"/>
</g>
<!-- l2_expert_4_gpu8 -->
<g id="node267" class="node">
<title>l2_expert_4_gpu8</title>
<polygon fill="lightpink" stroke="black" points="10233.07,-708.95 10138.07,-708.95 10138.07,-655.95 10233.07,-655.95 10233.07,-708.95"/>
<text text-anchor="middle" x="10185.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 68</text>
<text text-anchor="middle" x="10185.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10185.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_4_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge557" class="edge">
<title>l2_expert_4_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10137.91,-658.81C10135.12,-657.78 10132.32,-656.81 10129.57,-655.95 10068.02,-636.7 9998.19,-622.77 9937.91,-613.09"/>
<polygon fill="black" stroke="black" points="9938.35,-609.62 9927.93,-611.51 9937.26,-616.53 9938.35,-609.62"/>
</g>
<!-- l2_expert_5_gpu8 -->
<g id="node268" class="node">
<title>l2_expert_5_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9442.07,-708.95 9347.07,-708.95 9347.07,-655.95 9442.07,-655.95 9442.07,-708.95"/>
<text text-anchor="middle" x="9394.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 69</text>
<text text-anchor="middle" x="9394.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9394.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_5_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge560" class="edge">
<title>l2_expert_5_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9442.14,-659.17C9445.3,-658 9448.46,-656.92 9451.57,-655.95 9526.63,-632.71 9613.94,-617.1 9681.02,-607.43"/>
<polygon fill="black" stroke="black" points="9681.78,-610.85 9691.19,-605.98 9680.79,-603.92 9681.78,-610.85"/>
</g>
<!-- l2_expert_6_gpu8 -->
<g id="node269" class="node">
<title>l2_expert_6_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9555.07,-708.95 9460.07,-708.95 9460.07,-655.95 9555.07,-655.95 9555.07,-708.95"/>
<text text-anchor="middle" x="9507.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 70</text>
<text text-anchor="middle" x="9507.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9507.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_6_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge563" class="edge">
<title>l2_expert_6_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9555.24,-659.48C9558.38,-658.24 9561.51,-657.05 9564.57,-655.95 9610.73,-639.43 9663.55,-624.78 9706.41,-613.93"/>
<polygon fill="black" stroke="black" points="9707.39,-617.29 9716.24,-611.46 9705.69,-610.5 9707.39,-617.29"/>
</g>
<!-- l2_expert_7_gpu8 -->
<g id="node270" class="node">
<title>l2_expert_7_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9668.07,-708.95 9573.07,-708.95 9573.07,-655.95 9668.07,-655.95 9668.07,-708.95"/>
<text text-anchor="middle" x="9620.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 71</text>
<text text-anchor="middle" x="9620.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9620.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_7_gpu8&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge566" class="edge">
<title>l2_expert_7_gpu8&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9668.09,-656.99C9693.03,-644.15 9723.31,-628.56 9747.4,-616.16"/>
<polygon fill="black" stroke="black" points="9749.02,-619.27 9756.31,-611.58 9745.81,-613.04 9749.02,-619.27"/>
</g>
<!-- l2_gate_gpu8 -->
<g id="node271" class="node">
<title>l2_gate_gpu8</title>
<polygon fill="lightcyan" stroke="black" points="9781.36,-789.45 9705.33,-789.45 9685.77,-753.45 9761.8,-753.45 9781.36,-789.45"/>
<text text-anchor="middle" x="9733.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_0_gpu8 -->
<g id="edge543" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9733.57,-753.26C9733.57,-743.54 9733.57,-731 9733.57,-719.23"/>
<polygon fill="black" stroke="black" points="9737.07,-719.19 9733.57,-709.19 9730.07,-719.19 9737.07,-719.19"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_1_gpu8 -->
<g id="edge546" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9755.89,-753.26C9769.93,-742.46 9788.48,-728.17 9805.15,-715.35"/>
<polygon fill="black" stroke="black" points="9807.36,-718.06 9813.14,-709.19 9803.09,-712.51 9807.36,-718.06"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_2_gpu8 -->
<g id="edge549" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9765.5,-759.76C9797.94,-748.71 9849.76,-730.54 9902.51,-709.28"/>
<polygon fill="black" stroke="black" points="9904.07,-712.42 9912.02,-705.42 9901.44,-705.94 9904.07,-712.42"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_3_gpu8 -->
<g id="edge552" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9768.62,-765.31C9820.94,-757.1 9922.46,-739.12 10015.34,-709.11"/>
<polygon fill="black" stroke="black" points="10016.47,-712.43 10024.88,-705.98 10014.28,-705.78 10016.47,-712.43"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_4_gpu8 -->
<g id="edge555" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9769.79,-768.15C9838.69,-763.05 9993.13,-748.25 10128.25,-709.04"/>
<polygon fill="black" stroke="black" points="10129.34,-712.37 10137.94,-706.18 10127.36,-705.66 10129.34,-712.37"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_5_gpu8 -->
<g id="edge558" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9691.28,-764.03C9637.39,-755.23 9541.47,-737.53 9451.69,-708.71"/>
<polygon fill="black" stroke="black" points="9452.77,-705.38 9442.18,-705.61 9450.6,-712.04 9452.77,-705.38"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_6_gpu8 -->
<g id="edge561" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9685.87,-754.12C9653.96,-742.96 9610.88,-727.45 9564.64,-708.88"/>
<polygon fill="black" stroke="black" points="9565.94,-705.63 9555.36,-705.13 9563.32,-712.12 9565.94,-705.63"/>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert_7_gpu8 -->
<g id="edge564" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert_7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9711.24,-753.26C9697.2,-742.46 9678.65,-728.17 9661.99,-715.35"/>
<polygon fill="black" stroke="black" points="9664.05,-712.51 9653.99,-709.19 9659.78,-718.06 9664.05,-712.51"/>
</g>
<!-- l2_res2_gpu8 -->
<g id="node273" class="node">
<title>l2_res2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="9844.57,-522.45 9734.57,-522.45 9734.57,-486.45 9844.57,-486.45 9844.57,-522.45"/>
<text text-anchor="middle" x="9789.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu8&#45;&gt;l2_res2_gpu8 -->
<g id="edge567" class="edge">
<title>l2_expert_agg_gpu8&#45;&gt;l2_res2_gpu8</title>
<path fill="none" stroke="black" d="M9789.57,-575.26C9789.57,-563.11 9789.57,-546.57 9789.57,-532.63"/>
<polygon fill="black" stroke="black" points="9793.07,-532.61 9789.57,-522.61 9786.07,-532.61 9793.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu8 -->
<g id="node386" class="node">
<title>l3_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="10733.07,-430.95 10638.07,-430.95 10638.07,-377.95 10733.07,-377.95 10733.07,-430.95"/>
<text text-anchor="middle" x="10685.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="10685.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10685.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu8&#45;&gt;l3_mha_qkv_gpu8 -->
<g id="edge569" class="edge">
<title>l2_res2_gpu8&#45;&gt;l3_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M9844.83,-503.03C10020.43,-501.38 10558.31,-493.74 10629.57,-461.95 10641.2,-456.77 10651.71,-447.99 10660.41,-438.88"/>
<polygon fill="black" stroke="black" points="10663.2,-441 10667.27,-431.22 10657.99,-436.33 10663.2,-441"/>
</g>
<!-- l2_mha_attn_gpu9 -->
<g id="node275" class="node">
<title>l2_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="13171.07,-708.95 13076.07,-708.95 13076.07,-655.95 13171.07,-655.95 13171.07,-708.95"/>
<text text-anchor="middle" x="13123.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13123.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13123.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu9&#45;&gt;l2_mha_attn_gpu9 -->
<g id="edge603" class="edge">
<title>l2_mha_qkv_gpu9&#45;&gt;l2_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M11645.11,-766.24C11710.81,-760.56 11833.09,-750.53 11937.57,-744.95 12185.26,-731.73 12806.87,-765.26 13066.22,-708.81"/>
<polygon fill="black" stroke="black" points="13067.07,-712.21 13076.05,-706.59 13065.52,-705.38 13067.07,-712.21"/>
</g>
<!-- l2_res_add_gpu9 -->
<g id="node525" class="node">
<title>l2_res_add_gpu9</title>
<ellipse fill="none" stroke="black" cx="8816.57" cy="-771.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8816.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu9</text>
</g>
<!-- l2_mha_qkv_gpu9&#45;&gt;l2_res_add_gpu9 -->
<g id="edge607" class="edge">
<title>l2_mha_qkv_gpu9&#45;&gt;l2_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11589.96,-797.97C11581,-822.93 11563.29,-857.43 11532.57,-863.95 11514.83,-867.72 8939.31,-867.72 8921.57,-863.95 8883.73,-855.92 8852.34,-822.1 8834.02,-797.67"/>
<polygon fill="black" stroke="black" points="8836.79,-795.53 8828.09,-789.48 8831.12,-799.64 8836.79,-795.53"/>
</g>
<!-- l2_mha_out_gpu9 -->
<g id="node276" class="node">
<title>l2_mha_out_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="12866.07,-619.95 12771.07,-619.95 12771.07,-566.95 12866.07,-566.95 12866.07,-619.95"/>
<text text-anchor="middle" x="12818.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="12818.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="12818.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu9&#45;&gt;l2_mha_out_gpu9 -->
<g id="edge604" class="edge">
<title>l2_mha_attn_gpu9&#45;&gt;l2_mha_out_gpu9</title>
<path fill="none" stroke="black" d="M13075.85,-659.02C13073.07,-657.93 13070.29,-656.9 13067.57,-655.95 13003.3,-633.6 12927.04,-616.02 12876,-605.48"/>
<polygon fill="black" stroke="black" points="12876.63,-602.04 12866.14,-603.47 12875.23,-608.9 12876.63,-602.04"/>
</g>
<!-- l2_mha_allreduce_gpu9 -->
<g id="node277" class="node">
<title>l2_mha_allreduce_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11898.07,-530.95 11803.07,-530.95 11803.07,-477.95 11898.07,-477.95 11898.07,-530.95"/>
<text text-anchor="middle" x="11850.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="11850.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11850.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu9&#45;&gt;l2_mha_allreduce_gpu9 -->
<g id="edge605" class="edge">
<title>l2_mha_out_gpu9&#45;&gt;l2_mha_allreduce_gpu9</title>
<path fill="none" stroke="black" d="M12770.79,-574.78C12760.92,-571.71 12750.5,-568.89 12740.57,-566.95 12720.07,-562.96 12101.9,-522.01 11908.09,-509.24"/>
<polygon fill="black" stroke="black" points="11908.31,-505.74 11898.1,-508.58 11907.85,-512.73 11908.31,-505.74"/>
</g>
<!-- l2_mha_allreduce_gpu9&#45;&gt;l2_res_add_gpu9 -->
<g id="edge606" class="edge">
<title>l2_mha_allreduce_gpu9&#45;&gt;l2_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11802.96,-513.48C11764.84,-519.52 11709.94,-527.36 11661.57,-530.95 11522.77,-541.28 9290.45,-528.91 9156.57,-566.95 9027.85,-603.53 8898.45,-702.01 8843.71,-747.2"/>
<polygon fill="black" stroke="black" points="8841.32,-744.64 8835.88,-753.73 8845.81,-750.02 8841.32,-744.64"/>
</g>
<!-- l2_mha_res_add_gpu9 -->
<g id="node278" class="node">
<title>l2_mha_res_add_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="15796.07,-797.95 15701.07,-797.95 15701.07,-744.95 15796.07,-744.95 15796.07,-797.95"/>
<text text-anchor="middle" x="15748.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="15748.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="15748.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_8_gpu9 -->
<g id="node279" class="node">
<title>l2_expert_8_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10911.07,-708.95 10816.07,-708.95 10816.07,-655.95 10911.07,-655.95 10911.07,-708.95"/>
<text text-anchor="middle" x="10863.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 72</text>
<text text-anchor="middle" x="10863.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10863.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu9 -->
<g id="node288" class="node">
<title>l2_expert_agg_gpu9</title>
<polygon fill="yellow" stroke="black" points="10844.2,-611.45 10604.58,-611.45 10542.94,-575.45 10782.56,-575.45 10844.2,-611.45"/>
<text text-anchor="middle" x="10693.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_8_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge611" class="edge">
<title>l2_expert_8_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10815.76,-656.99C10790.68,-644.15 10760.22,-628.56 10735.99,-616.16"/>
<polygon fill="black" stroke="black" points="10737.52,-613.02 10727.03,-611.58 10734.34,-619.25 10737.52,-613.02"/>
</g>
<!-- l2_expert_9_gpu9 -->
<g id="node280" class="node">
<title>l2_expert_9_gpu9</title>
<polygon fill="lightpink" stroke="black" points="11024.07,-708.95 10929.07,-708.95 10929.07,-655.95 11024.07,-655.95 11024.07,-708.95"/>
<text text-anchor="middle" x="10976.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 73</text>
<text text-anchor="middle" x="10976.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10976.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge614" class="edge">
<title>l2_expert_9_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10928.82,-659.09C10926.05,-657.99 10923.28,-656.93 10920.57,-655.95 10874.33,-639.29 10821.39,-624.7 10778.27,-613.92"/>
<polygon fill="black" stroke="black" points="10778.93,-610.47 10768.38,-611.47 10777.24,-617.27 10778.93,-610.47"/>
</g>
<!-- l2_expert_10_gpu9 -->
<g id="node281" class="node">
<title>l2_expert_10_gpu9</title>
<polygon fill="lightpink" stroke="black" points="11137.07,-708.95 11042.07,-708.95 11042.07,-655.95 11137.07,-655.95 11137.07,-708.95"/>
<text text-anchor="middle" x="11089.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 74</text>
<text text-anchor="middle" x="11089.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11089.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_10_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge617" class="edge">
<title>l2_expert_10_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11041.91,-658.81C11039.12,-657.78 11036.32,-656.81 11033.57,-655.95 10972.02,-636.7 10902.19,-622.77 10841.91,-613.09"/>
<polygon fill="black" stroke="black" points="10842.35,-609.62 10831.93,-611.51 10841.26,-616.53 10842.35,-609.62"/>
</g>
<!-- l2_expert_11_gpu9 -->
<g id="node282" class="node">
<title>l2_expert_11_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10346.07,-708.95 10251.07,-708.95 10251.07,-655.95 10346.07,-655.95 10346.07,-708.95"/>
<text text-anchor="middle" x="10298.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 75</text>
<text text-anchor="middle" x="10298.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10298.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_11_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge620" class="edge">
<title>l2_expert_11_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10346.14,-659.17C10349.3,-658 10352.46,-656.92 10355.57,-655.95 10430.63,-632.71 10517.94,-617.1 10585.02,-607.43"/>
<polygon fill="black" stroke="black" points="10585.78,-610.85 10595.19,-605.98 10584.79,-603.92 10585.78,-610.85"/>
</g>
<!-- l2_expert_12_gpu9 -->
<g id="node283" class="node">
<title>l2_expert_12_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10459.07,-708.95 10364.07,-708.95 10364.07,-655.95 10459.07,-655.95 10459.07,-708.95"/>
<text text-anchor="middle" x="10411.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 76</text>
<text text-anchor="middle" x="10411.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10411.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_12_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge623" class="edge">
<title>l2_expert_12_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10459.24,-659.48C10462.38,-658.24 10465.51,-657.05 10468.57,-655.95 10514.73,-639.43 10567.55,-624.78 10610.41,-613.93"/>
<polygon fill="black" stroke="black" points="10611.39,-617.29 10620.24,-611.46 10609.69,-610.5 10611.39,-617.29"/>
</g>
<!-- l2_expert_13_gpu9 -->
<g id="node284" class="node">
<title>l2_expert_13_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10572.07,-708.95 10477.07,-708.95 10477.07,-655.95 10572.07,-655.95 10572.07,-708.95"/>
<text text-anchor="middle" x="10524.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 77</text>
<text text-anchor="middle" x="10524.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10524.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_13_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge626" class="edge">
<title>l2_expert_13_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10572.09,-656.99C10597.03,-644.15 10627.31,-628.56 10651.4,-616.16"/>
<polygon fill="black" stroke="black" points="10653.02,-619.27 10660.31,-611.58 10649.81,-613.04 10653.02,-619.27"/>
</g>
<!-- l2_expert_14_gpu9 -->
<g id="node285" class="node">
<title>l2_expert_14_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10685.07,-708.95 10590.07,-708.95 10590.07,-655.95 10685.07,-655.95 10685.07,-708.95"/>
<text text-anchor="middle" x="10637.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 78</text>
<text text-anchor="middle" x="10637.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10637.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_14_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge629" class="edge">
<title>l2_expert_14_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10654.07,-655.82C10661.3,-644.59 10669.77,-631.43 10677,-620.19"/>
<polygon fill="black" stroke="black" points="10680.03,-621.96 10682.5,-611.65 10674.14,-618.17 10680.03,-621.96"/>
</g>
<!-- l2_expert_15_gpu9 -->
<g id="node286" class="node">
<title>l2_expert_15_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10798.07,-708.95 10703.07,-708.95 10703.07,-655.95 10798.07,-655.95 10798.07,-708.95"/>
<text text-anchor="middle" x="10750.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 79</text>
<text text-anchor="middle" x="10750.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10750.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_15_gpu9&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge632" class="edge">
<title>l2_expert_15_gpu9&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10733.77,-655.82C10726.42,-644.59 10717.8,-631.43 10710.43,-620.19"/>
<polygon fill="black" stroke="black" points="10713.25,-618.1 10704.84,-611.65 10707.39,-621.94 10713.25,-618.1"/>
</g>
<!-- l2_gate_gpu9 -->
<g id="node287" class="node">
<title>l2_gate_gpu9</title>
<polygon fill="lightcyan" stroke="black" points="10628.36,-789.45 10552.33,-789.45 10532.77,-753.45 10608.8,-753.45 10628.36,-789.45"/>
<text text-anchor="middle" x="10580.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_8_gpu9 -->
<g id="edge609" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_8_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10610.27,-755.74C10618.93,-751.84 10628.5,-747.91 10637.57,-744.95 10708,-722.03 10732.22,-732.17 10806.12,-709.14"/>
<polygon fill="black" stroke="black" points="10807.44,-712.39 10815.88,-706 10805.29,-705.73 10807.44,-712.39"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_9_gpu9 -->
<g id="edge612" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10610.13,-755.25C10618.78,-751.35 10628.38,-747.53 10637.57,-744.95 10756.54,-711.56 10796.58,-741.99 10919.21,-708.98"/>
<polygon fill="black" stroke="black" points="10920.27,-712.32 10928.97,-706.27 10918.39,-705.57 10920.27,-712.32"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_10_gpu9 -->
<g id="edge615" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_10_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10609.77,-755.17C10618.5,-751.22 10628.23,-747.39 10637.57,-744.95 10805.38,-701.09 10860.69,-752.24 11032.15,-708.95"/>
<polygon fill="black" stroke="black" points="11033.2,-712.29 11042,-706.39 11031.44,-705.51 11033.2,-712.29"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_11_gpu9 -->
<g id="edge618" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_11_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10536.4,-760.51C10492.63,-750.19 10423.68,-732.66 10355.81,-708.83"/>
<polygon fill="black" stroke="black" points="10356.84,-705.48 10346.24,-705.42 10354.49,-712.07 10356.84,-705.48"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_12_gpu9 -->
<g id="edge621" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_12_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10547.18,-753.26C10524.72,-741.7 10494.55,-726.17 10468.36,-712.69"/>
<polygon fill="black" stroke="black" points="10469.78,-709.48 10459.29,-708.02 10466.58,-715.71 10469.78,-709.48"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_13_gpu9 -->
<g id="edge624" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_13_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10569.5,-753.26C10562.99,-743.14 10554.52,-729.98 10546.68,-717.81"/>
<polygon fill="black" stroke="black" points="10549.49,-715.7 10541.13,-709.19 10543.6,-719.49 10549.49,-715.7"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_14_gpu9 -->
<g id="edge627" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_14_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10591.83,-753.26C10598.46,-743.14 10607.09,-729.98 10615.06,-717.81"/>
<polygon fill="black" stroke="black" points="10618.16,-719.47 10620.71,-709.19 10612.3,-715.63 10618.16,-719.47"/>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert_15_gpu9 -->
<g id="edge630" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert_15_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10610.18,-755.3C10633.27,-743.48 10666.02,-726.72 10694.08,-712.36"/>
<polygon fill="black" stroke="black" points="10695.7,-715.46 10703.01,-707.79 10692.51,-709.23 10695.7,-715.46"/>
</g>
<!-- l2_res2_gpu9 -->
<g id="node289" class="node">
<title>l2_res2_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="10748.57,-522.45 10638.57,-522.45 10638.57,-486.45 10748.57,-486.45 10748.57,-522.45"/>
<text text-anchor="middle" x="10693.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu9&#45;&gt;l2_res2_gpu9 -->
<g id="edge633" class="edge">
<title>l2_expert_agg_gpu9&#45;&gt;l2_res2_gpu9</title>
<path fill="none" stroke="black" d="M10693.57,-575.26C10693.57,-563.11 10693.57,-546.57 10693.57,-532.63"/>
<polygon fill="black" stroke="black" points="10697.07,-532.61 10693.57,-522.61 10690.07,-532.61 10697.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu9 -->
<g id="node402" class="node">
<title>l3_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11637.07,-430.95 11542.07,-430.95 11542.07,-377.95 11637.07,-377.95 11637.07,-430.95"/>
<text text-anchor="middle" x="11589.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="11589.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11589.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu9&#45;&gt;l3_mha_qkv_gpu9 -->
<g id="edge635" class="edge">
<title>l2_res2_gpu9&#45;&gt;l3_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M10748.58,-497.64C10824.99,-489.83 10967.61,-476.2 11089.57,-469.95 11114.21,-468.69 11510.88,-471.65 11533.57,-461.95 11545.37,-456.91 11555.99,-448.07 11564.73,-438.87"/>
<polygon fill="black" stroke="black" points="11567.58,-440.93 11571.6,-431.13 11562.35,-436.28 11567.58,-440.93"/>
</g>
<!-- l2_mha_attn_gpu10 -->
<g id="node291" class="node">
<title>l2_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="13284.07,-708.95 13189.07,-708.95 13189.07,-655.95 13284.07,-655.95 13284.07,-708.95"/>
<text text-anchor="middle" x="13236.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13236.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="13236.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu10&#45;&gt;l2_mha_attn_gpu10 -->
<g id="edge669" class="edge">
<title>l2_mha_qkv_gpu10&#45;&gt;l2_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M12606.34,-747.64C12609.42,-746.62 12612.52,-745.71 12615.57,-744.95 12856.63,-685.41 12934.44,-767.87 13179.13,-708.92"/>
<polygon fill="black" stroke="black" points="13180.15,-712.27 13189.02,-706.48 13178.48,-705.47 13180.15,-712.27"/>
</g>
<!-- l2_res_add_gpu10 -->
<g id="node527" class="node">
<title>l2_res_add_gpu10</title>
<ellipse fill="none" stroke="black" cx="9015.57" cy="-771.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="9015.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu10</text>
</g>
<!-- l2_mha_qkv_gpu10&#45;&gt;l2_res_add_gpu10 -->
<g id="edge673" class="edge">
<title>l2_mha_qkv_gpu10&#45;&gt;l2_res_add_gpu10</title>
<path fill="none" stroke="black" d="M12550.96,-797.97C12542,-822.93 12524.29,-857.43 12493.57,-863.95 12470.7,-868.81 9149.44,-868.81 9126.57,-863.95 9087.5,-855.66 9054.09,-821.9 9034.41,-797.56"/>
<polygon fill="black" stroke="black" points="9036.95,-795.13 9028.04,-789.4 9031.44,-799.44 9036.95,-795.13"/>
</g>
<!-- l2_mha_out_gpu10 -->
<g id="node292" class="node">
<title>l2_mha_out_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="13066.07,-619.95 12971.07,-619.95 12971.07,-566.95 13066.07,-566.95 13066.07,-619.95"/>
<text text-anchor="middle" x="13018.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13018.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="13018.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu10&#45;&gt;l2_mha_out_gpu10 -->
<g id="edge670" class="edge">
<title>l2_mha_attn_gpu10&#45;&gt;l2_mha_out_gpu10</title>
<path fill="none" stroke="black" d="M13189,-659.54C13186.16,-658.31 13183.33,-657.1 13180.57,-655.95 13146.1,-641.58 13106.96,-626.68 13075.78,-615.15"/>
<polygon fill="black" stroke="black" points="13076.97,-611.86 13066.38,-611.68 13074.55,-618.43 13076.97,-611.86"/>
</g>
<!-- l2_mha_allreduce_gpu10 -->
<g id="node293" class="node">
<title>l2_mha_allreduce_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12342.07,-530.95 12247.07,-530.95 12247.07,-477.95 12342.07,-477.95 12342.07,-530.95"/>
<text text-anchor="middle" x="12294.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="12294.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12294.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu10&#45;&gt;l2_mha_allreduce_gpu10 -->
<g id="edge671" class="edge">
<title>l2_mha_out_gpu10&#45;&gt;l2_mha_allreduce_gpu10</title>
<path fill="none" stroke="black" d="M12971.05,-583.04C12943.29,-577.78 12907.54,-571.4 12875.57,-566.95 12716.74,-544.86 12676,-548.1 12516.57,-530.95 12460.74,-524.95 12397.09,-517.58 12352.29,-512.31"/>
<polygon fill="black" stroke="black" points="12352.52,-508.82 12342.18,-511.12 12351.7,-515.77 12352.52,-508.82"/>
</g>
<!-- l2_mha_allreduce_gpu10&#45;&gt;l2_res_add_gpu10 -->
<g id="edge672" class="edge">
<title>l2_mha_allreduce_gpu10&#45;&gt;l2_res_add_gpu10</title>
<path fill="none" stroke="black" d="M12246.95,-509.4C12173.96,-515.26 12030.02,-526.1 11907.57,-530.95 11832.95,-533.91 9288.38,-537.96 9219.57,-566.95 9131.62,-604.01 9061.46,-698.86 9031.42,-744.78"/>
<polygon fill="black" stroke="black" points="9028.42,-742.97 9025.95,-753.28 9034.3,-746.76 9028.42,-742.97"/>
</g>
<!-- l2_mha_res_add_gpu10 -->
<g id="node294" class="node">
<title>l2_mha_res_add_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="14879.07,-797.95 14784.07,-797.95 14784.07,-744.95 14879.07,-744.95 14879.07,-797.95"/>
<text text-anchor="middle" x="14831.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="14831.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="14831.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_16_gpu10 -->
<g id="node295" class="node">
<title>l2_expert_16_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11702.07,-708.95 11607.07,-708.95 11607.07,-655.95 11702.07,-655.95 11702.07,-708.95"/>
<text text-anchor="middle" x="11654.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 80</text>
<text text-anchor="middle" x="11654.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11654.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu10 -->
<g id="node304" class="node">
<title>l2_expert_agg_gpu10</title>
<polygon fill="yellow" stroke="black" points="11748.2,-611.45 11508.58,-611.45 11446.94,-575.45 11686.56,-575.45 11748.2,-611.45"/>
<text text-anchor="middle" x="11597.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_16_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge677" class="edge">
<title>l2_expert_16_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11637.77,-655.82C11630.42,-644.59 11621.8,-631.43 11614.43,-620.19"/>
<polygon fill="black" stroke="black" points="11617.25,-618.1 11608.84,-611.65 11611.39,-621.94 11617.25,-618.1"/>
</g>
<!-- l2_expert_17_gpu10 -->
<g id="node296" class="node">
<title>l2_expert_17_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11815.07,-708.95 11720.07,-708.95 11720.07,-655.95 11815.07,-655.95 11815.07,-708.95"/>
<text text-anchor="middle" x="11767.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 81</text>
<text text-anchor="middle" x="11767.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11767.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_17_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge680" class="edge">
<title>l2_expert_17_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11719.76,-656.99C11694.68,-644.15 11664.22,-628.56 11639.99,-616.16"/>
<polygon fill="black" stroke="black" points="11641.52,-613.02 11631.03,-611.58 11638.34,-619.25 11641.52,-613.02"/>
</g>
<!-- l2_expert_18_gpu10 -->
<g id="node297" class="node">
<title>l2_expert_18_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11928.07,-708.95 11833.07,-708.95 11833.07,-655.95 11928.07,-655.95 11928.07,-708.95"/>
<text text-anchor="middle" x="11880.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 82</text>
<text text-anchor="middle" x="11880.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11880.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_18_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge683" class="edge">
<title>l2_expert_18_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11832.82,-659.09C11830.05,-657.99 11827.28,-656.93 11824.57,-655.95 11778.33,-639.29 11725.39,-624.7 11682.27,-613.92"/>
<polygon fill="black" stroke="black" points="11682.93,-610.47 11672.38,-611.47 11681.24,-617.27 11682.93,-610.47"/>
</g>
<!-- l2_expert_19_gpu10 -->
<g id="node298" class="node">
<title>l2_expert_19_gpu10</title>
<polygon fill="lightpink" stroke="black" points="12041.07,-708.95 11946.07,-708.95 11946.07,-655.95 12041.07,-655.95 12041.07,-708.95"/>
<text text-anchor="middle" x="11993.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 83</text>
<text text-anchor="middle" x="11993.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11993.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_19_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge686" class="edge">
<title>l2_expert_19_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11945.91,-658.81C11943.12,-657.78 11940.32,-656.81 11937.57,-655.95 11876.02,-636.7 11806.19,-622.77 11745.91,-613.09"/>
<polygon fill="black" stroke="black" points="11746.35,-609.62 11735.93,-611.51 11745.26,-616.53 11746.35,-609.62"/>
</g>
<!-- l2_expert_20_gpu10 -->
<g id="node299" class="node">
<title>l2_expert_20_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11250.07,-708.95 11155.07,-708.95 11155.07,-655.95 11250.07,-655.95 11250.07,-708.95"/>
<text text-anchor="middle" x="11202.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 84</text>
<text text-anchor="middle" x="11202.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11202.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_20_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge689" class="edge">
<title>l2_expert_20_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11250.14,-659.17C11253.3,-658 11256.46,-656.92 11259.57,-655.95 11334.63,-632.71 11421.94,-617.1 11489.02,-607.43"/>
<polygon fill="black" stroke="black" points="11489.78,-610.85 11499.19,-605.98 11488.79,-603.92 11489.78,-610.85"/>
</g>
<!-- l2_expert_21_gpu10 -->
<g id="node300" class="node">
<title>l2_expert_21_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11363.07,-708.95 11268.07,-708.95 11268.07,-655.95 11363.07,-655.95 11363.07,-708.95"/>
<text text-anchor="middle" x="11315.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 85</text>
<text text-anchor="middle" x="11315.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11315.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_21_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge692" class="edge">
<title>l2_expert_21_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11363.24,-659.48C11366.38,-658.24 11369.51,-657.05 11372.57,-655.95 11418.73,-639.43 11471.55,-624.78 11514.41,-613.93"/>
<polygon fill="black" stroke="black" points="11515.39,-617.29 11524.24,-611.46 11513.69,-610.5 11515.39,-617.29"/>
</g>
<!-- l2_expert_22_gpu10 -->
<g id="node301" class="node">
<title>l2_expert_22_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11476.07,-708.95 11381.07,-708.95 11381.07,-655.95 11476.07,-655.95 11476.07,-708.95"/>
<text text-anchor="middle" x="11428.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 86</text>
<text text-anchor="middle" x="11428.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11428.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_22_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge695" class="edge">
<title>l2_expert_22_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11476.09,-656.99C11501.03,-644.15 11531.31,-628.56 11555.4,-616.16"/>
<polygon fill="black" stroke="black" points="11557.02,-619.27 11564.31,-611.58 11553.81,-613.04 11557.02,-619.27"/>
</g>
<!-- l2_expert_23_gpu10 -->
<g id="node302" class="node">
<title>l2_expert_23_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11589.07,-708.95 11494.07,-708.95 11494.07,-655.95 11589.07,-655.95 11589.07,-708.95"/>
<text text-anchor="middle" x="11541.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 87</text>
<text text-anchor="middle" x="11541.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11541.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_23_gpu10&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge698" class="edge">
<title>l2_expert_23_gpu10&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11558.07,-655.82C11565.3,-644.59 11573.77,-631.43 11581,-620.19"/>
<polygon fill="black" stroke="black" points="11584.03,-621.96 11586.5,-611.65 11578.14,-618.17 11584.03,-621.96"/>
</g>
<!-- l2_gate_gpu10 -->
<g id="node303" class="node">
<title>l2_gate_gpu10</title>
<polygon fill="lightcyan" stroke="black" points="11532.36,-789.45 11456.33,-789.45 11436.77,-753.45 11512.8,-753.45 11532.36,-789.45"/>
<text text-anchor="middle" x="11484.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_16_gpu10 -->
<g id="edge675" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_16_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11514.18,-755.3C11537.27,-743.48 11570.02,-726.72 11598.08,-712.36"/>
<polygon fill="black" stroke="black" points="11599.7,-715.46 11607.01,-707.79 11596.51,-709.23 11599.7,-715.46"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_17_gpu10 -->
<g id="edge678" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_17_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11514.27,-755.74C11522.93,-751.84 11532.5,-747.91 11541.57,-744.95 11612,-722.03 11636.22,-732.17 11710.12,-709.14"/>
<polygon fill="black" stroke="black" points="11711.44,-712.39 11719.88,-706 11709.29,-705.73 11711.44,-712.39"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_18_gpu10 -->
<g id="edge681" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_18_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11514.13,-755.25C11522.78,-751.35 11532.38,-747.53 11541.57,-744.95 11660.54,-711.56 11700.58,-741.99 11823.21,-708.98"/>
<polygon fill="black" stroke="black" points="11824.27,-712.32 11832.97,-706.27 11822.39,-705.57 11824.27,-712.32"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_19_gpu10 -->
<g id="edge684" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_19_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11513.77,-755.17C11522.5,-751.22 11532.23,-747.39 11541.57,-744.95 11709.38,-701.09 11764.69,-752.24 11936.15,-708.95"/>
<polygon fill="black" stroke="black" points="11937.2,-712.29 11946,-706.39 11935.44,-705.51 11937.2,-712.29"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_20_gpu10 -->
<g id="edge687" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_20_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11440.4,-760.51C11396.63,-750.19 11327.68,-732.66 11259.81,-708.83"/>
<polygon fill="black" stroke="black" points="11260.84,-705.48 11250.24,-705.42 11258.49,-712.07 11260.84,-705.48"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_21_gpu10 -->
<g id="edge690" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_21_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11451.18,-753.26C11428.72,-741.7 11398.55,-726.17 11372.36,-712.69"/>
<polygon fill="black" stroke="black" points="11373.78,-709.48 11363.29,-708.02 11370.58,-715.71 11373.78,-709.48"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_22_gpu10 -->
<g id="edge693" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_22_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11473.5,-753.26C11466.99,-743.14 11458.52,-729.98 11450.68,-717.81"/>
<polygon fill="black" stroke="black" points="11453.49,-715.7 11445.13,-709.19 11447.6,-719.49 11453.49,-715.7"/>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert_23_gpu10 -->
<g id="edge696" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert_23_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11495.83,-753.26C11502.46,-743.14 11511.09,-729.98 11519.06,-717.81"/>
<polygon fill="black" stroke="black" points="11522.16,-719.47 11524.71,-709.19 11516.3,-715.63 11522.16,-719.47"/>
</g>
<!-- l2_res2_gpu10 -->
<g id="node305" class="node">
<title>l2_res2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="11652.57,-522.45 11542.57,-522.45 11542.57,-486.45 11652.57,-486.45 11652.57,-522.45"/>
<text text-anchor="middle" x="11597.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu10&#45;&gt;l2_res2_gpu10 -->
<g id="edge699" class="edge">
<title>l2_expert_agg_gpu10&#45;&gt;l2_res2_gpu10</title>
<path fill="none" stroke="black" d="M11597.57,-575.26C11597.57,-563.11 11597.57,-546.57 11597.57,-532.63"/>
<polygon fill="black" stroke="black" points="11601.07,-532.61 11597.57,-522.61 11594.07,-532.61 11601.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu10 -->
<g id="node418" class="node">
<title>l3_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12603.07,-430.95 12508.07,-430.95 12508.07,-377.95 12603.07,-377.95 12603.07,-430.95"/>
<text text-anchor="middle" x="12555.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="12555.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12555.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu10&#45;&gt;l3_mha_qkv_gpu10 -->
<g id="edge701" class="edge">
<title>l2_res2_gpu10&#45;&gt;l3_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M11652.88,-491.65C11692.2,-483.86 11746.37,-474.3 11794.57,-469.95 11814.07,-468.2 12481.53,-469.59 12499.57,-461.95 12511.39,-456.95 12522.01,-448.12 12530.75,-438.92"/>
<polygon fill="black" stroke="black" points="12533.6,-440.97 12537.62,-431.17 12528.37,-436.33 12533.6,-440.97"/>
</g>
<!-- l2_mha_attn_gpu11 -->
<g id="node307" class="node">
<title>l2_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13397.07,-708.95 13302.07,-708.95 13302.07,-655.95 13397.07,-655.95 13397.07,-708.95"/>
<text text-anchor="middle" x="13349.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13349.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13349.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu11&#45;&gt;l2_mha_attn_gpu11 -->
<g id="edge735" class="edge">
<title>l2_mha_qkv_gpu11&#45;&gt;l2_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M12832.18,-769.54C12921.7,-766.79 13120.82,-755.76 13292.28,-708.98"/>
<polygon fill="black" stroke="black" points="13293.27,-712.34 13301.97,-706.29 13291.4,-705.59 13293.27,-712.34"/>
</g>
<!-- l2_res_add_gpu11 -->
<g id="node529" class="node">
<title>l2_res_add_gpu11</title>
<ellipse fill="none" stroke="black" cx="9220.57" cy="-771.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="9220.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu11</text>
</g>
<!-- l2_mha_qkv_gpu11&#45;&gt;l2_res_add_gpu11 -->
<g id="edge739" class="edge">
<title>l2_mha_qkv_gpu11&#45;&gt;l2_res_add_gpu11</title>
<path fill="none" stroke="black" d="M12776.96,-797.97C12768,-822.93 12750.29,-857.43 12719.57,-863.95 12696.63,-868.82 9366.5,-868.82 9343.57,-863.95 9301.82,-855.09 9264.29,-821.29 9241.96,-797.11"/>
<polygon fill="black" stroke="black" points="9244.55,-794.74 9235.26,-789.64 9239.34,-799.42 9244.55,-794.74"/>
</g>
<!-- l2_mha_out_gpu11 -->
<g id="node308" class="node">
<title>l2_mha_out_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13223.07,-619.95 13128.07,-619.95 13128.07,-566.95 13223.07,-566.95 13223.07,-619.95"/>
<text text-anchor="middle" x="13175.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13175.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13175.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu11&#45;&gt;l2_mha_out_gpu11 -->
<g id="edge736" class="edge">
<title>l2_mha_attn_gpu11&#45;&gt;l2_mha_out_gpu11</title>
<path fill="none" stroke="black" d="M13302.02,-657.68C13280.53,-646.94 13254.97,-634.15 13232.47,-622.9"/>
<polygon fill="black" stroke="black" points="13233.87,-619.69 13223.36,-618.35 13230.74,-625.95 13233.87,-619.69"/>
</g>
<!-- l2_mha_allreduce_gpu11 -->
<g id="node309" class="node">
<title>l2_mha_allreduce_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="12975.07,-530.95 12880.07,-530.95 12880.07,-477.95 12975.07,-477.95 12975.07,-530.95"/>
<text text-anchor="middle" x="12927.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="12927.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12927.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu11&#45;&gt;l2_mha_allreduce_gpu11 -->
<g id="edge737" class="edge">
<title>l2_mha_out_gpu11&#45;&gt;l2_mha_allreduce_gpu11</title>
<path fill="none" stroke="black" d="M13128.05,-575.78C13087.25,-561.47 13028.33,-540.8 12984.92,-525.57"/>
<polygon fill="black" stroke="black" points="12985.95,-522.22 12975.35,-522.22 12983.63,-528.83 12985.95,-522.22"/>
</g>
<!-- l2_mha_allreduce_gpu11&#45;&gt;l2_res_add_gpu11 -->
<g id="edge738" class="edge">
<title>l2_mha_allreduce_gpu11&#45;&gt;l2_res_add_gpu11</title>
<path fill="none" stroke="black" d="M12879.58,-510.93C12823.35,-517.07 12727.34,-526.74 12644.57,-530.95 12309.98,-548 9960.61,-515.44 9629.57,-566.95 9495.93,-587.75 9455.02,-587.16 9338.57,-655.95 9298.43,-679.67 9261.48,-719.73 9239.98,-745.62"/>
<polygon fill="black" stroke="black" points="9237.17,-743.53 9233.56,-753.5 9242.6,-747.96 9237.17,-743.53"/>
</g>
<!-- l2_mha_res_add_gpu11 -->
<g id="node310" class="node">
<title>l2_mha_res_add_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="14196.07,-797.95 14101.07,-797.95 14101.07,-744.95 14196.07,-744.95 14196.07,-797.95"/>
<text text-anchor="middle" x="14148.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="14148.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="14148.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_24_gpu11 -->
<g id="node311" class="node">
<title>l2_expert_24_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12606.07,-708.95 12511.07,-708.95 12511.07,-655.95 12606.07,-655.95 12606.07,-708.95"/>
<text text-anchor="middle" x="12558.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 88</text>
<text text-anchor="middle" x="12558.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12558.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu11 -->
<g id="node320" class="node">
<title>l2_expert_agg_gpu11</title>
<polygon fill="yellow" stroke="black" points="12731.2,-611.45 12491.58,-611.45 12429.94,-575.45 12669.56,-575.45 12731.2,-611.45"/>
<text text-anchor="middle" x="12580.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_24_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge743" class="edge">
<title>l2_expert_24_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12565.05,-655.82C12567.78,-645.03 12570.95,-632.47 12573.72,-621.53"/>
<polygon fill="black" stroke="black" points="12577.16,-622.21 12576.22,-611.65 12570.37,-620.49 12577.16,-622.21"/>
</g>
<!-- l2_expert_25_gpu11 -->
<g id="node312" class="node">
<title>l2_expert_25_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12719.07,-708.95 12624.07,-708.95 12624.07,-655.95 12719.07,-655.95 12719.07,-708.95"/>
<text text-anchor="middle" x="12671.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 89</text>
<text text-anchor="middle" x="12671.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12671.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_25_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge746" class="edge">
<title>l2_expert_25_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12644.76,-655.82C12632.54,-644.14 12618.16,-630.39 12606.1,-618.86"/>
<polygon fill="black" stroke="black" points="12608.21,-616.04 12598.56,-611.65 12603.37,-621.1 12608.21,-616.04"/>
</g>
<!-- l2_expert_26_gpu11 -->
<g id="node313" class="node">
<title>l2_expert_26_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12832.07,-708.95 12737.07,-708.95 12737.07,-655.95 12832.07,-655.95 12832.07,-708.95"/>
<text text-anchor="middle" x="12784.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 90</text>
<text text-anchor="middle" x="12784.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12784.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_26_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge749" class="edge">
<title>l2_expert_26_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12736.96,-659.64C12734.12,-658.38 12731.31,-657.15 12728.57,-655.95 12696.71,-642.08 12660.71,-627.11 12632.2,-615.41"/>
<polygon fill="black" stroke="black" points="12633.41,-612.13 12622.83,-611.58 12630.76,-618.6 12633.41,-612.13"/>
</g>
<!-- l2_expert_27_gpu11 -->
<g id="node314" class="node">
<title>l2_expert_27_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12945.07,-708.95 12850.07,-708.95 12850.07,-655.95 12945.07,-655.95 12945.07,-708.95"/>
<text text-anchor="middle" x="12897.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 91</text>
<text text-anchor="middle" x="12897.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12897.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_27_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge752" class="edge">
<title>l2_expert_27_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12849.86,-658.98C12847.07,-657.91 12844.3,-656.89 12841.57,-655.95 12790.05,-638.35 12731.14,-623.99 12682.34,-613.59"/>
<polygon fill="black" stroke="black" points="12682.91,-610.13 12672.4,-611.5 12681.46,-616.98 12682.91,-610.13"/>
</g>
<!-- l2_expert_28_gpu11 -->
<g id="node315" class="node">
<title>l2_expert_28_gpu11</title>
<polygon fill="lightpink" stroke="black" points="13058.07,-708.95 12963.07,-708.95 12963.07,-655.95 13058.07,-655.95 13058.07,-708.95"/>
<text text-anchor="middle" x="13010.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 92</text>
<text text-anchor="middle" x="13010.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13010.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_28_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge755" class="edge">
<title>l2_expert_28_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12962.93,-658.76C12960.13,-657.74 12957.33,-656.79 12954.57,-655.95 12930.64,-648.68 12803.23,-628.35 12703.69,-613.05"/>
<polygon fill="black" stroke="black" points="12703.95,-609.55 12693.54,-611.49 12702.89,-616.46 12703.95,-609.55"/>
</g>
<!-- l2_expert_29_gpu11 -->
<g id="node316" class="node">
<title>l2_expert_29_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12267.07,-708.95 12172.07,-708.95 12172.07,-655.95 12267.07,-655.95 12267.07,-708.95"/>
<text text-anchor="middle" x="12219.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 93</text>
<text text-anchor="middle" x="12219.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12219.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_29_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge758" class="edge">
<title>l2_expert_29_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12267.16,-659.24C12270.32,-658.06 12273.47,-656.95 12276.57,-655.95 12341.4,-635.18 12416.35,-619.92 12475.6,-609.8"/>
<polygon fill="black" stroke="black" points="12476.44,-613.21 12485.72,-608.1 12475.28,-606.31 12476.44,-613.21"/>
</g>
<!-- l2_expert_30_gpu11 -->
<g id="node317" class="node">
<title>l2_expert_30_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12380.07,-708.95 12285.07,-708.95 12285.07,-655.95 12380.07,-655.95 12380.07,-708.95"/>
<text text-anchor="middle" x="12332.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 94</text>
<text text-anchor="middle" x="12332.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12332.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_30_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge761" class="edge">
<title>l2_expert_30_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12380.3,-659.64C12383.42,-658.36 12386.53,-657.12 12389.57,-655.95 12429.73,-640.56 12475.58,-625.71 12512.29,-614.46"/>
<polygon fill="black" stroke="black" points="12513.35,-617.79 12521.9,-611.53 12511.32,-611.09 12513.35,-617.79"/>
</g>
<!-- l2_expert_31_gpu11 -->
<g id="node318" class="node">
<title>l2_expert_31_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12493.07,-708.95 12398.07,-708.95 12398.07,-655.95 12493.07,-655.95 12493.07,-708.95"/>
<text text-anchor="middle" x="12445.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 95</text>
<text text-anchor="middle" x="12445.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12445.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_31_gpu11&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge764" class="edge">
<title>l2_expert_31_gpu11&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12485.34,-655.82C12504.33,-643.59 12526.85,-629.07 12545.22,-617.23"/>
<polygon fill="black" stroke="black" points="12547.37,-620.01 12553.88,-611.65 12543.58,-614.13 12547.37,-620.01"/>
</g>
<!-- l2_gate_gpu11 -->
<g id="node319" class="node">
<title>l2_gate_gpu11</title>
<polygon fill="lightcyan" stroke="black" points="12493.36,-789.45 12417.33,-789.45 12397.77,-753.45 12473.8,-753.45 12493.36,-789.45"/>
<text text-anchor="middle" x="12445.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_24_gpu11 -->
<g id="edge741" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_24_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12467.89,-753.26C12481.93,-742.46 12500.48,-728.17 12517.15,-715.35"/>
<polygon fill="black" stroke="black" points="12519.36,-718.06 12525.14,-709.19 12515.09,-712.51 12519.36,-718.06"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_25_gpu11 -->
<g id="edge744" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_25_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12475.48,-756.32C12484.13,-752.43 12493.66,-748.35 12502.57,-744.95 12549.02,-727.23 12564.62,-727.78 12614.41,-709.23"/>
<polygon fill="black" stroke="black" points="12615.66,-712.5 12623.77,-705.67 12613.18,-705.95 12615.66,-712.5"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_26_gpu11 -->
<g id="edge747" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_26_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12475.18,-755.44C12483.83,-751.54 12493.42,-747.68 12502.57,-744.95 12597.01,-716.84 12629.17,-736.95 12727.24,-709.02"/>
<polygon fill="black" stroke="black" points="12728.33,-712.35 12736.94,-706.16 12726.35,-705.63 12728.33,-712.35"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_27_gpu11 -->
<g id="edge750" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_27_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12474.8,-755.26C12483.52,-751.31 12493.25,-747.46 12502.57,-744.95 12645.72,-706.38 12693.36,-747.04 12840.17,-708.96"/>
<polygon fill="black" stroke="black" points="12841.23,-712.3 12849.99,-706.34 12839.42,-705.54 12841.23,-712.3"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_28_gpu11 -->
<g id="edge753" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_28_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12474.76,-755.1C12483.48,-751.15 12493.22,-747.34 12502.57,-744.95 12694.68,-695.89 12757.46,-757.43 12953.28,-708.9"/>
<polygon fill="black" stroke="black" points="12954.18,-712.28 12963.01,-706.43 12952.45,-705.5 12954.18,-712.28"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_29_gpu11 -->
<g id="edge756" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_29_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12397.87,-754.12C12365.96,-742.96 12322.88,-727.45 12276.64,-708.88"/>
<polygon fill="black" stroke="black" points="12277.94,-705.63 12267.36,-705.13 12275.32,-712.12 12277.94,-705.63"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_30_gpu11 -->
<g id="edge759" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_30_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12423.24,-753.26C12409.2,-742.46 12390.65,-728.17 12373.99,-715.35"/>
<polygon fill="black" stroke="black" points="12376.05,-712.51 12365.99,-709.19 12371.78,-718.06 12376.05,-712.51"/>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert_31_gpu11 -->
<g id="edge762" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert_31_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12445.57,-753.26C12445.57,-743.54 12445.57,-731 12445.57,-719.23"/>
<polygon fill="black" stroke="black" points="12449.07,-719.19 12445.57,-709.19 12442.07,-719.19 12449.07,-719.19"/>
</g>
<!-- l2_res2_gpu11 -->
<g id="node321" class="node">
<title>l2_res2_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="12635.57,-522.45 12525.57,-522.45 12525.57,-486.45 12635.57,-486.45 12635.57,-522.45"/>
<text text-anchor="middle" x="12580.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu11&#45;&gt;l2_res2_gpu11 -->
<g id="edge765" class="edge">
<title>l2_expert_agg_gpu11&#45;&gt;l2_res2_gpu11</title>
<path fill="none" stroke="black" d="M12580.57,-575.26C12580.57,-563.11 12580.57,-546.57 12580.57,-532.63"/>
<polygon fill="black" stroke="black" points="12584.07,-532.61 12580.57,-522.61 12577.07,-532.61 12584.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu11 -->
<g id="node434" class="node">
<title>l3_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="12829.07,-430.95 12734.07,-430.95 12734.07,-377.95 12829.07,-377.95 12829.07,-430.95"/>
<text text-anchor="middle" x="12781.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="12781.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12781.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu11&#45;&gt;l3_mha_qkv_gpu11 -->
<g id="edge767" class="edge">
<title>l2_res2_gpu11&#45;&gt;l3_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M12635.91,-494.54C12664.14,-488.32 12698.19,-478.15 12725.57,-461.95 12735.96,-455.81 12745.78,-447.27 12754.21,-438.7"/>
<polygon fill="black" stroke="black" points="12756.95,-440.89 12761.24,-431.21 12751.85,-436.1 12756.95,-440.89"/>
</g>
<!-- l2_mha_attn_gpu12 -->
<g id="node323" class="node">
<title>l2_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13510.07,-708.95 13415.07,-708.95 13415.07,-655.95 13510.07,-655.95 13510.07,-708.95"/>
<text text-anchor="middle" x="13462.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13462.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13462.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu12&#45;&gt;l2_mha_attn_gpu12 -->
<g id="edge801" class="edge">
<title>l2_mha_qkv_gpu12&#45;&gt;l2_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M13988.05,-769.55C13897.65,-766.82 13695.11,-755.8 13519.73,-708.6"/>
<polygon fill="black" stroke="black" points="13520.64,-705.22 13510.07,-705.96 13518.8,-711.98 13520.64,-705.22"/>
</g>
<!-- l2_res_add_gpu12 -->
<g id="node531" class="node">
<title>l2_res_add_gpu12</title>
<ellipse fill="none" stroke="black" cx="17646.57" cy="-771.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="17646.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu12</text>
</g>
<!-- l2_mha_qkv_gpu12&#45;&gt;l2_res_add_gpu12 -->
<g id="edge805" class="edge">
<title>l2_mha_qkv_gpu12&#45;&gt;l2_res_add_gpu12</title>
<path fill="none" stroke="black" d="M14043.43,-797.96C14052.63,-822.91 14070.69,-857.4 14101.57,-863.95 14124.81,-868.89 17500.32,-868.89 17523.57,-863.95 17565.31,-855.09 17602.85,-821.29 17625.17,-797.11"/>
<polygon fill="black" stroke="black" points="17627.8,-799.42 17631.87,-789.64 17622.59,-794.74 17627.8,-799.42"/>
</g>
<!-- l2_mha_out_gpu12 -->
<g id="node324" class="node">
<title>l2_mha_out_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13510.07,-619.95 13415.07,-619.95 13415.07,-566.95 13510.07,-566.95 13510.07,-619.95"/>
<text text-anchor="middle" x="13462.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13462.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13462.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu12&#45;&gt;l2_mha_out_gpu12 -->
<g id="edge802" class="edge">
<title>l2_mha_attn_gpu12&#45;&gt;l2_mha_out_gpu12</title>
<path fill="none" stroke="black" d="M13462.57,-655.82C13462.57,-647.84 13462.57,-638.89 13462.57,-630.34"/>
<polygon fill="black" stroke="black" points="13466.07,-630.2 13462.57,-620.2 13459.07,-630.2 13466.07,-630.2"/>
</g>
<!-- l2_mha_allreduce_gpu12 -->
<g id="node325" class="node">
<title>l2_mha_allreduce_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13622.07,-530.95 13527.07,-530.95 13527.07,-477.95 13622.07,-477.95 13622.07,-530.95"/>
<text text-anchor="middle" x="13574.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="13574.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13574.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu12&#45;&gt;l2_mha_allreduce_gpu12 -->
<g id="edge803" class="edge">
<title>l2_mha_out_gpu12&#45;&gt;l2_mha_allreduce_gpu12</title>
<path fill="none" stroke="black" d="M13495.57,-566.82C13507.42,-557.61 13520.94,-547.11 13533.41,-537.43"/>
<polygon fill="black" stroke="black" points="13535.67,-540.1 13541.42,-531.2 13531.38,-534.57 13535.67,-540.1"/>
</g>
<!-- l2_mha_allreduce_gpu12&#45;&gt;l2_res_add_gpu12 -->
<g id="edge804" class="edge">
<title>l2_mha_allreduce_gpu12&#45;&gt;l2_res_add_gpu12</title>
<path fill="none" stroke="black" d="M13622.22,-510.95C13678.05,-517.11 13773.38,-526.79 13855.57,-530.95 14230,-549.91 16858.82,-511.27 17229.57,-566.95 17367.52,-587.67 17410.43,-585.05 17530.57,-655.95 17570.37,-679.44 17606.6,-719.57 17627.62,-745.54"/>
<polygon fill="black" stroke="black" points="17624.93,-747.78 17633.89,-753.43 17630.41,-743.43 17624.93,-747.78"/>
</g>
<!-- l2_mha_res_add_gpu12 -->
<g id="node326" class="node">
<title>l2_mha_res_add_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="12719.07,-797.95 12624.07,-797.95 12624.07,-744.95 12719.07,-744.95 12719.07,-797.95"/>
<text text-anchor="middle" x="12671.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="12671.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12671.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_32_gpu12 -->
<g id="node327" class="node">
<title>l2_expert_32_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14422.07,-708.95 14327.07,-708.95 14327.07,-655.95 14422.07,-655.95 14422.07,-708.95"/>
<text text-anchor="middle" x="14374.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 96</text>
<text text-anchor="middle" x="14374.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14374.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu12 -->
<g id="node336" class="node">
<title>l2_expert_agg_gpu12</title>
<polygon fill="yellow" stroke="black" points="14353.2,-611.45 14113.58,-611.45 14051.94,-575.45 14291.56,-575.45 14353.2,-611.45"/>
<text text-anchor="middle" x="14202.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_32_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge809" class="edge">
<title>l2_expert_32_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14326.66,-657.22C14301.18,-644.33 14270.12,-628.62 14245.45,-616.14"/>
<polygon fill="black" stroke="black" points="14246.84,-612.92 14236.33,-611.53 14243.68,-619.17 14246.84,-612.92"/>
</g>
<!-- l2_expert_33_gpu12 -->
<g id="node328" class="node">
<title>l2_expert_33_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14535.07,-708.95 14440.07,-708.95 14440.07,-655.95 14535.07,-655.95 14535.07,-708.95"/>
<text text-anchor="middle" x="14487.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 97</text>
<text text-anchor="middle" x="14487.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14487.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_33_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge812" class="edge">
<title>l2_expert_33_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14439.82,-659.09C14437.05,-657.98 14434.28,-656.93 14431.57,-655.95 14385.02,-639.23 14331.73,-624.66 14288.27,-613.91"/>
<polygon fill="black" stroke="black" points="14288.85,-610.44 14278.3,-611.46 14287.18,-617.24 14288.85,-610.44"/>
</g>
<!-- l2_expert_34_gpu12 -->
<g id="node329" class="node">
<title>l2_expert_34_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14648.07,-708.95 14553.07,-708.95 14553.07,-655.95 14648.07,-655.95 14648.07,-708.95"/>
<text text-anchor="middle" x="14600.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 98</text>
<text text-anchor="middle" x="14600.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14600.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_34_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge815" class="edge">
<title>l2_expert_34_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14552.92,-658.81C14550.12,-657.77 14547.32,-656.81 14544.57,-655.95 14482.79,-636.67 14412.73,-622.74 14352.18,-613.08"/>
<polygon fill="black" stroke="black" points="14352.58,-609.6 14342.16,-611.5 14351.5,-616.51 14352.58,-609.6"/>
</g>
<!-- l2_expert_35_gpu12 -->
<g id="node330" class="node">
<title>l2_expert_35_gpu12</title>
<polygon fill="lightpink" stroke="black" points="13849.07,-708.95 13754.07,-708.95 13754.07,-655.95 13849.07,-655.95 13849.07,-708.95"/>
<text text-anchor="middle" x="13801.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 99</text>
<text text-anchor="middle" x="13801.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13801.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_35_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge818" class="edge">
<title>l2_expert_35_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M13849.14,-659.16C13852.3,-657.99 13855.46,-656.91 13858.57,-655.95 13935.52,-632.25 14025.15,-616.59 14093.62,-607.01"/>
<polygon fill="black" stroke="black" points="14094.13,-610.48 14103.56,-605.64 14093.18,-603.54 14094.13,-610.48"/>
</g>
<!-- l2_expert_36_gpu12 -->
<g id="node331" class="node">
<title>l2_expert_36_gpu12</title>
<polygon fill="lightpink" stroke="black" points="13964.07,-708.95 13867.07,-708.95 13867.07,-655.95 13964.07,-655.95 13964.07,-708.95"/>
<text text-anchor="middle" x="13915.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 100</text>
<text text-anchor="middle" x="13915.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13915.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_36_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge821" class="edge">
<title>l2_expert_36_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M13964.09,-659.48C13967.28,-658.24 13970.46,-657.05 13973.57,-655.95 14020.59,-639.41 14074.37,-624.76 14117.98,-613.91"/>
<polygon fill="black" stroke="black" points="14118.83,-617.3 14127.7,-611.51 14117.15,-610.51 14118.83,-617.3"/>
</g>
<!-- l2_expert_37_gpu12 -->
<g id="node332" class="node">
<title>l2_expert_37_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14079.07,-708.95 13982.07,-708.95 13982.07,-655.95 14079.07,-655.95 14079.07,-708.95"/>
<text text-anchor="middle" x="14030.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 101</text>
<text text-anchor="middle" x="14030.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14030.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_37_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge824" class="edge">
<title>l2_expert_37_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14079.4,-656.76C14104.76,-643.93 14135.46,-628.4 14159.87,-616.05"/>
<polygon fill="black" stroke="black" points="14161.55,-619.12 14168.89,-611.49 14158.39,-612.88 14161.55,-619.12"/>
</g>
<!-- l2_expert_38_gpu12 -->
<g id="node333" class="node">
<title>l2_expert_38_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14194.07,-708.95 14097.07,-708.95 14097.07,-655.95 14194.07,-655.95 14194.07,-708.95"/>
<text text-anchor="middle" x="14145.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 102</text>
<text text-anchor="middle" x="14145.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14145.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_38_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge827" class="edge">
<title>l2_expert_38_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14162.36,-655.82C14169.72,-644.59 14178.34,-631.43 14185.71,-620.19"/>
<polygon fill="black" stroke="black" points="14188.75,-621.94 14191.3,-611.65 14182.89,-618.1 14188.75,-621.94"/>
</g>
<!-- l2_expert_39_gpu12 -->
<g id="node334" class="node">
<title>l2_expert_39_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14309.07,-708.95 14212.07,-708.95 14212.07,-655.95 14309.07,-655.95 14309.07,-708.95"/>
<text text-anchor="middle" x="14260.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 103</text>
<text text-anchor="middle" x="14260.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14260.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_39_gpu12&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge830" class="edge">
<title>l2_expert_39_gpu12&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14243.48,-655.82C14235.99,-644.59 14227.22,-631.43 14219.73,-620.19"/>
<polygon fill="black" stroke="black" points="14222.5,-618.03 14214.04,-611.65 14216.67,-621.92 14222.5,-618.03"/>
</g>
<!-- l2_gate_gpu12 -->
<g id="node335" class="node">
<title>l2_gate_gpu12</title>
<polygon fill="lightcyan" stroke="black" points="14422.36,-789.45 14346.33,-789.45 14326.77,-753.45 14402.8,-753.45 14422.36,-789.45"/>
<text text-anchor="middle" x="14374.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_32_gpu12 -->
<g id="edge807" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_32_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14374.57,-753.26C14374.57,-743.54 14374.57,-731 14374.57,-719.23"/>
<polygon fill="black" stroke="black" points="14378.07,-719.19 14374.57,-709.19 14371.07,-719.19 14378.07,-719.19"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_33_gpu12 -->
<g id="edge810" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_33_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14396.89,-753.26C14410.93,-742.46 14429.48,-728.17 14446.15,-715.35"/>
<polygon fill="black" stroke="black" points="14448.36,-718.06 14454.14,-709.19 14444.09,-712.51 14448.36,-718.06"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_34_gpu12 -->
<g id="edge813" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_34_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14406.5,-759.76C14438.94,-748.71 14490.76,-730.54 14543.51,-709.28"/>
<polygon fill="black" stroke="black" points="14545.07,-712.42 14553.02,-705.42 14542.44,-705.94 14545.07,-712.42"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_35_gpu12 -->
<g id="edge816" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_35_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14342.1,-753.37C14334.56,-750.06 14326.43,-746.98 14318.57,-744.95 14123.21,-694.51 14059.35,-757.47 13859.29,-708.7"/>
<polygon fill="black" stroke="black" points="13859.9,-705.25 13849.35,-706.22 13858.2,-712.04 13859.9,-705.25"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_36_gpu12 -->
<g id="edge819" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_36_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14341.77,-753.39C14334.31,-750.12 14326.3,-747.06 14318.57,-744.95 14173.01,-705.35 14124.66,-746.6 13974.29,-708.73"/>
<polygon fill="black" stroke="black" points="13974.79,-705.24 13964.23,-706.12 13973.03,-712.02 13974.79,-705.24"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_37_gpu12 -->
<g id="edge822" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_37_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14341.08,-753.42C14333.8,-750.23 14326.04,-747.19 14318.57,-744.95 14222.46,-716.14 14189.84,-736.69 14088.94,-708.7"/>
<polygon fill="black" stroke="black" points="14089.86,-705.32 14079.28,-705.93 14087.93,-712.05 14089.86,-705.32"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_38_gpu12 -->
<g id="edge825" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_38_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14338.7,-753.33C14332.07,-750.39 14325.15,-747.47 14318.57,-744.95 14268.55,-725.82 14253.71,-727.76 14203.57,-708.95 14203.47,-708.92 14203.38,-708.88 14203.28,-708.84"/>
<polygon fill="black" stroke="black" points="14204.73,-705.65 14194.14,-705.28 14202.18,-712.17 14204.73,-705.65"/>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert_39_gpu12 -->
<g id="edge828" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert_39_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14352.05,-753.26C14337.88,-742.46 14319.17,-728.17 14302.36,-715.35"/>
<polygon fill="black" stroke="black" points="14304.36,-712.47 14294.29,-709.19 14300.11,-718.04 14304.36,-712.47"/>
</g>
<!-- l2_res2_gpu12 -->
<g id="node337" class="node">
<title>l2_res2_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14257.57,-522.45 14147.57,-522.45 14147.57,-486.45 14257.57,-486.45 14257.57,-522.45"/>
<text text-anchor="middle" x="14202.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu12&#45;&gt;l2_res2_gpu12 -->
<g id="edge831" class="edge">
<title>l2_expert_agg_gpu12&#45;&gt;l2_res2_gpu12</title>
<path fill="none" stroke="black" d="M14202.57,-575.26C14202.57,-563.11 14202.57,-546.57 14202.57,-532.63"/>
<polygon fill="black" stroke="black" points="14206.07,-532.61 14202.57,-522.61 14199.07,-532.61 14206.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu12 -->
<g id="node450" class="node">
<title>l3_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="14086.07,-430.95 13991.07,-430.95 13991.07,-377.95 14086.07,-377.95 14086.07,-430.95"/>
<text text-anchor="middle" x="14038.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="14038.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14038.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu12&#45;&gt;l3_mha_qkv_gpu12 -->
<g id="edge833" class="edge">
<title>l2_res2_gpu12&#45;&gt;l3_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M14147.4,-486.98C14130.08,-480.54 14111.36,-472.2 14095.57,-461.95 14085.53,-455.44 14075.82,-446.94 14067.34,-438.52"/>
<polygon fill="black" stroke="black" points="14069.7,-435.93 14060.23,-431.2 14064.68,-440.81 14069.7,-435.93"/>
</g>
<!-- l2_mha_attn_gpu13 -->
<g id="node339" class="node">
<title>l2_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13623.07,-708.95 13528.07,-708.95 13528.07,-655.95 13623.07,-655.95 13623.07,-708.95"/>
<text text-anchor="middle" x="13575.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13575.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13575.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu13&#45;&gt;l2_mha_attn_gpu13 -->
<g id="edge867" class="edge">
<title>l2_mha_qkv_gpu13&#45;&gt;l2_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M14214.02,-747.42C14211.2,-746.49 14208.37,-745.65 14205.57,-744.95 13961.28,-683.87 13882.4,-767.76 13633.41,-708.71"/>
<polygon fill="black" stroke="black" points="13633.88,-705.23 13623.34,-706.27 13632.23,-712.03 13633.88,-705.23"/>
</g>
<!-- l2_res_add_gpu13 -->
<g id="node533" class="node">
<title>l2_res_add_gpu13</title>
<ellipse fill="none" stroke="black" cx="17851.57" cy="-771.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="17851.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu13</text>
</g>
<!-- l2_mha_qkv_gpu13&#45;&gt;l2_res_add_gpu13 -->
<g id="edge871" class="edge">
<title>l2_mha_qkv_gpu13&#45;&gt;l2_res_add_gpu13</title>
<path fill="none" stroke="black" d="M14269.18,-797.97C14278.14,-822.93 14295.85,-857.43 14326.57,-863.95 14349.76,-868.87 17717.38,-868.87 17740.57,-863.95 17779.64,-855.66 17813.05,-821.9 17832.73,-797.56"/>
<polygon fill="black" stroke="black" points="17835.7,-799.44 17839.1,-789.4 17830.18,-795.13 17835.7,-799.44"/>
</g>
<!-- l2_mha_out_gpu13 -->
<g id="node340" class="node">
<title>l2_mha_out_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13712.07,-619.95 13617.07,-619.95 13617.07,-566.95 13712.07,-566.95 13712.07,-619.95"/>
<text text-anchor="middle" x="13664.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13664.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13664.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu13&#45;&gt;l2_mha_out_gpu13 -->
<g id="edge868" class="edge">
<title>l2_mha_attn_gpu13&#45;&gt;l2_mha_out_gpu13</title>
<path fill="none" stroke="black" d="M13601.79,-655.82C13610.94,-646.87 13621.34,-636.71 13631.01,-627.26"/>
<polygon fill="black" stroke="black" points="13633.52,-629.7 13638.23,-620.2 13628.63,-624.69 13633.52,-629.7"/>
</g>
<!-- l2_mha_allreduce_gpu13 -->
<g id="node341" class="node">
<title>l2_mha_allreduce_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13959.07,-530.95 13864.07,-530.95 13864.07,-477.95 13959.07,-477.95 13959.07,-530.95"/>
<text text-anchor="middle" x="13911.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="13911.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13911.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu13&#45;&gt;l2_mha_allreduce_gpu13 -->
<g id="edge869" class="edge">
<title>l2_mha_out_gpu13&#45;&gt;l2_mha_allreduce_gpu13</title>
<path fill="none" stroke="black" d="M13712.19,-575.68C13752.73,-561.4 13811.06,-540.86 13854.17,-525.67"/>
<polygon fill="black" stroke="black" points="13855.4,-528.95 13863.67,-522.32 13853.08,-522.35 13855.4,-528.95"/>
</g>
<!-- l2_mha_allreduce_gpu13&#45;&gt;l2_res_add_gpu13 -->
<g id="edge870" class="edge">
<title>l2_mha_allreduce_gpu13&#45;&gt;l2_res_add_gpu13</title>
<path fill="none" stroke="black" d="M13959.27,-512.24C14005.12,-518.42 14076.42,-527.15 14138.57,-530.95 14328.83,-542.61 17388.49,-507.39 17569.57,-566.95 17576.82,-569.34 17748.67,-695.01 17820.48,-747.64"/>
<polygon fill="black" stroke="black" points="17818.59,-750.6 17828.73,-753.69 17822.73,-744.95 17818.59,-750.6"/>
</g>
<!-- l2_mha_res_add_gpu13 -->
<g id="node342" class="node">
<title>l2_mha_res_add_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="12041.07,-797.95 11946.07,-797.95 11946.07,-744.95 12041.07,-744.95 12041.07,-797.95"/>
<text text-anchor="middle" x="11993.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="11993.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11993.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_40_gpu13 -->
<g id="node343" class="node">
<title>l2_expert_40_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15106.07,-708.95 15009.07,-708.95 15009.07,-655.95 15106.07,-655.95 15106.07,-708.95"/>
<text text-anchor="middle" x="15057.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 104</text>
<text text-anchor="middle" x="15057.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15057.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu13 -->
<g id="node352" class="node">
<title>l2_expert_agg_gpu13</title>
<polygon fill="yellow" stroke="black" points="15380.2,-611.45 15140.58,-611.45 15078.94,-575.45 15318.56,-575.45 15380.2,-611.45"/>
<text text-anchor="middle" x="15229.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_40_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge875" class="edge">
<title>l2_expert_40_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15106.4,-656.76C15131.76,-643.93 15162.46,-628.4 15186.87,-616.05"/>
<polygon fill="black" stroke="black" points="15188.55,-619.12 15195.89,-611.49 15185.39,-612.88 15188.55,-619.12"/>
</g>
<!-- l2_expert_41_gpu13 -->
<g id="node344" class="node">
<title>l2_expert_41_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15221.07,-708.95 15124.07,-708.95 15124.07,-655.95 15221.07,-655.95 15221.07,-708.95"/>
<text text-anchor="middle" x="15172.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 105</text>
<text text-anchor="middle" x="15172.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15172.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_41_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge878" class="edge">
<title>l2_expert_41_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15189.36,-655.82C15196.72,-644.59 15205.34,-631.43 15212.71,-620.19"/>
<polygon fill="black" stroke="black" points="15215.75,-621.94 15218.3,-611.65 15209.89,-618.1 15215.75,-621.94"/>
</g>
<!-- l2_expert_42_gpu13 -->
<g id="node345" class="node">
<title>l2_expert_42_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15336.07,-708.95 15239.07,-708.95 15239.07,-655.95 15336.07,-655.95 15336.07,-708.95"/>
<text text-anchor="middle" x="15287.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 106</text>
<text text-anchor="middle" x="15287.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15287.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_42_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge881" class="edge">
<title>l2_expert_42_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15270.48,-655.82C15262.99,-644.59 15254.22,-631.43 15246.73,-620.19"/>
<polygon fill="black" stroke="black" points="15249.5,-618.03 15241.04,-611.65 15243.67,-621.92 15249.5,-618.03"/>
</g>
<!-- l2_expert_43_gpu13 -->
<g id="node346" class="node">
<title>l2_expert_43_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15451.07,-708.95 15354.07,-708.95 15354.07,-655.95 15451.07,-655.95 15451.07,-708.95"/>
<text text-anchor="middle" x="15402.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 107</text>
<text text-anchor="middle" x="15402.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15402.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_43_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge884" class="edge">
<title>l2_expert_43_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15353.92,-656.99C15328.4,-644.15 15297.4,-628.56 15272.74,-616.16"/>
<polygon fill="black" stroke="black" points="15274.13,-612.94 15263.62,-611.58 15270.98,-619.2 15274.13,-612.94"/>
</g>
<!-- l2_expert_44_gpu13 -->
<g id="node347" class="node">
<title>l2_expert_44_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15566.07,-708.95 15469.07,-708.95 15469.07,-655.95 15566.07,-655.95 15566.07,-708.95"/>
<text text-anchor="middle" x="15517.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 108</text>
<text text-anchor="middle" x="15517.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15517.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_44_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge887" class="edge">
<title>l2_expert_44_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15468.96,-659.09C15466.14,-657.99 15463.33,-656.93 15460.57,-655.95 15413.38,-639.24 15359.37,-624.62 15315.45,-613.84"/>
<polygon fill="black" stroke="black" points="15316.21,-610.42 15305.67,-611.45 15314.55,-617.22 15316.21,-610.42"/>
</g>
<!-- l2_expert_45_gpu13 -->
<g id="node348" class="node">
<title>l2_expert_45_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15681.07,-708.95 15584.07,-708.95 15584.07,-655.95 15681.07,-655.95 15681.07,-708.95"/>
<text text-anchor="middle" x="15632.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 109</text>
<text text-anchor="middle" x="15632.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15632.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_45_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge890" class="edge">
<title>l2_expert_45_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15584.05,-658.81C15581.21,-657.78 15578.37,-656.81 15575.57,-655.95 15512.87,-636.68 15441.81,-622.74 15380.46,-613.07"/>
<polygon fill="black" stroke="black" points="15380.73,-609.57 15370.31,-611.49 15379.66,-616.48 15380.73,-609.57"/>
</g>
<!-- l2_expert_46_gpu13 -->
<g id="node349" class="node">
<title>l2_expert_46_gpu13</title>
<polygon fill="lightpink" stroke="black" points="14876.07,-708.95 14779.07,-708.95 14779.07,-655.95 14876.07,-655.95 14876.07,-708.95"/>
<text text-anchor="middle" x="14827.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 110</text>
<text text-anchor="middle" x="14827.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14827.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_46_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge893" class="edge">
<title>l2_expert_46_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M14876.31,-659.05C14879.41,-657.93 14882.52,-656.88 14885.57,-655.95 14962.6,-632.5 15052.22,-616.83 15120.67,-607.19"/>
<polygon fill="black" stroke="black" points="15121.19,-610.65 15130.61,-605.81 15120.23,-603.71 15121.19,-610.65"/>
</g>
<!-- l2_expert_47_gpu13 -->
<g id="node350" class="node">
<title>l2_expert_47_gpu13</title>
<polygon fill="lightpink" stroke="black" points="14991.07,-708.95 14894.07,-708.95 14894.07,-655.95 14991.07,-655.95 14991.07,-708.95"/>
<text text-anchor="middle" x="14942.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 111</text>
<text text-anchor="middle" x="14942.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14942.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_47_gpu13&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge896" class="edge">
<title>l2_expert_47_gpu13&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M14991.09,-659.48C14994.28,-658.24 14997.46,-657.05 15000.57,-655.95 15047.59,-639.41 15101.37,-624.76 15144.98,-613.91"/>
<polygon fill="black" stroke="black" points="15145.83,-617.3 15154.7,-611.51 15144.15,-610.51 15145.83,-617.3"/>
</g>
<!-- l2_gate_gpu13 -->
<g id="node351" class="node">
<title>l2_gate_gpu13</title>
<polygon fill="lightcyan" stroke="black" points="15392.36,-789.45 15316.33,-789.45 15296.77,-753.45 15372.8,-753.45 15392.36,-789.45"/>
<text text-anchor="middle" x="15344.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_40_gpu13 -->
<g id="edge873" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_40_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15310.4,-753.45C15303.29,-750.32 15295.78,-747.31 15288.57,-744.95 15216.84,-721.48 15192.29,-731.98 15115.92,-708.76"/>
<polygon fill="black" stroke="black" points="15116.93,-705.41 15106.34,-705.75 15114.83,-712.08 15116.93,-705.41"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_41_gpu13 -->
<g id="edge876" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_41_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15310.59,-753.26C15287.73,-741.7 15257.02,-726.17 15230.37,-712.69"/>
<polygon fill="black" stroke="black" points="15231.64,-709.41 15221.13,-708.02 15228.48,-715.65 15231.64,-709.41"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_42_gpu13 -->
<g id="edge879" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_42_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15333.31,-753.26C15326.68,-743.14 15318.05,-729.98 15310.08,-717.81"/>
<polygon fill="black" stroke="black" points="15312.84,-715.63 15304.43,-709.19 15306.98,-719.47 15312.84,-715.63"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_43_gpu13 -->
<g id="edge882" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_43_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15356.03,-753.26C15362.78,-743.14 15371.55,-729.98 15379.66,-717.81"/>
<polygon fill="black" stroke="black" points="15382.78,-719.45 15385.41,-709.19 15376.95,-715.57 15382.78,-719.45"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_44_gpu13 -->
<g id="edge885" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_44_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15374.31,-755.5C15397.76,-743.7 15431.17,-726.9 15459.83,-712.49"/>
<polygon fill="black" stroke="black" points="15461.59,-715.52 15468.95,-707.9 15458.44,-709.27 15461.59,-715.52"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_45_gpu13 -->
<g id="edge888" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_45_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15378.36,-763.25C15421.96,-753.57 15500.16,-734.89 15574.45,-709.16"/>
<polygon fill="black" stroke="black" points="15575.69,-712.43 15583.96,-705.82 15573.37,-705.83 15575.69,-712.43"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_46_gpu13 -->
<g id="edge891" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_46_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15312.09,-753.44C15304.54,-750.12 15296.42,-747.03 15288.57,-744.95 15117.85,-699.87 15061.75,-751.79 14886.04,-708.65"/>
<polygon fill="black" stroke="black" points="14886.77,-705.23 14876.22,-706.17 14885.06,-712.01 14886.77,-705.23"/>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert_47_gpu13 -->
<g id="edge894" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert_47_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15311.43,-753.38C15304.06,-750.15 15296.17,-747.11 15288.57,-744.95 15167.6,-710.71 15126.98,-741.62 15001.25,-708.75"/>
<polygon fill="black" stroke="black" points="15001.82,-705.27 14991.25,-706.04 14999.99,-712.03 15001.82,-705.27"/>
</g>
<!-- l2_res2_gpu13 -->
<g id="node353" class="node">
<title>l2_res2_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15284.57,-522.45 15174.57,-522.45 15174.57,-486.45 15284.57,-486.45 15284.57,-522.45"/>
<text text-anchor="middle" x="15229.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu13&#45;&gt;l2_res2_gpu13 -->
<g id="edge897" class="edge">
<title>l2_expert_agg_gpu13&#45;&gt;l2_res2_gpu13</title>
<path fill="none" stroke="black" d="M15229.57,-575.26C15229.57,-563.11 15229.57,-546.57 15229.57,-532.63"/>
<polygon fill="black" stroke="black" points="15233.07,-532.61 15229.57,-522.61 15226.07,-532.61 15233.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu13 -->
<g id="node466" class="node">
<title>l3_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="14312.07,-430.95 14217.07,-430.95 14217.07,-377.95 14312.07,-377.95 14312.07,-430.95"/>
<text text-anchor="middle" x="14264.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="14264.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14264.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu13&#45;&gt;l3_mha_qkv_gpu13 -->
<g id="edge899" class="edge">
<title>l2_res2_gpu13&#45;&gt;l3_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M15174.41,-498.42C15088.57,-490.8 14917.8,-476.56 14772.57,-469.95 14747.48,-468.81 14343.66,-471.82 14320.57,-461.95 14308.76,-456.91 14298.14,-448.08 14289.41,-438.87"/>
<polygon fill="black" stroke="black" points="14291.79,-436.28 14282.53,-431.13 14286.56,-440.93 14291.79,-436.28"/>
</g>
<!-- l2_mha_attn_gpu14 -->
<g id="node355" class="node">
<title>l2_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="13736.07,-708.95 13641.07,-708.95 13641.07,-655.95 13736.07,-655.95 13736.07,-708.95"/>
<text text-anchor="middle" x="13688.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13688.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13688.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu14&#45;&gt;l2_mha_attn_gpu14 -->
<g id="edge933" class="edge">
<title>l2_mha_qkv_gpu14&#45;&gt;l2_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M15183.89,-766.26C15117.68,-760.59 14994.11,-750.54 14888.57,-744.95 14638.02,-731.7 14009.46,-765.05 13746.28,-708.61"/>
<polygon fill="black" stroke="black" points="13746.83,-705.14 13736.31,-706.38 13745.31,-711.98 13746.83,-705.14"/>
</g>
<!-- l2_res_add_gpu14 -->
<g id="node535" class="node">
<title>l2_res_add_gpu14</title>
<ellipse fill="none" stroke="black" cx="18056.57" cy="-771.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="18056.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu14</text>
</g>
<!-- l2_mha_qkv_gpu14&#45;&gt;l2_res_add_gpu14 -->
<g id="edge937" class="edge">
<title>l2_mha_qkv_gpu14&#45;&gt;l2_res_add_gpu14</title>
<path fill="none" stroke="black" d="M15239.18,-797.97C15248.14,-822.93 15265.85,-857.43 15296.57,-863.95 15314.56,-867.77 17927.57,-867.77 17945.57,-863.95 17984.64,-855.66 18018.05,-821.9 18037.73,-797.56"/>
<polygon fill="black" stroke="black" points="18040.7,-799.44 18044.1,-789.4 18035.18,-795.13 18040.7,-799.44"/>
</g>
<!-- l2_mha_out_gpu14 -->
<g id="node356" class="node">
<title>l2_mha_out_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="13914.07,-619.95 13819.07,-619.95 13819.07,-566.95 13914.07,-566.95 13914.07,-619.95"/>
<text text-anchor="middle" x="13866.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13866.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13866.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu14&#45;&gt;l2_mha_out_gpu14 -->
<g id="edge934" class="edge">
<title>l2_mha_attn_gpu14&#45;&gt;l2_mha_out_gpu14</title>
<path fill="none" stroke="black" d="M13736.27,-658.14C13758.91,-647.07 13786.12,-633.77 13809.82,-622.19"/>
<polygon fill="black" stroke="black" points="13811.6,-625.22 13819.05,-617.68 13808.52,-618.93 13811.6,-625.22"/>
</g>
<!-- l2_mha_allreduce_gpu14 -->
<g id="node357" class="node">
<title>l2_mha_allreduce_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="14763.07,-530.95 14668.07,-530.95 14668.07,-477.95 14763.07,-477.95 14763.07,-530.95"/>
<text text-anchor="middle" x="14715.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="14715.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14715.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu14&#45;&gt;l2_mha_allreduce_gpu14 -->
<g id="edge935" class="edge">
<title>l2_mha_out_gpu14&#45;&gt;l2_mha_allreduce_gpu14</title>
<path fill="none" stroke="black" d="M13914.29,-584.84C13949.64,-579.38 13999.03,-572.09 14042.57,-566.95 14269.63,-540.15 14540.97,-518.52 14657.61,-509.71"/>
<polygon fill="black" stroke="black" points="14658.03,-513.19 14667.74,-508.95 14657.51,-506.21 14658.03,-513.19"/>
</g>
<!-- l2_mha_allreduce_gpu14&#45;&gt;l2_res_add_gpu14 -->
<g id="edge936" class="edge">
<title>l2_mha_allreduce_gpu14&#45;&gt;l2_res_add_gpu14</title>
<path fill="none" stroke="black" d="M14763.16,-508.81C14845.24,-514.45 15018.75,-525.73 15165.57,-530.95 15303.55,-535.86 17516.44,-534.19 17650.57,-566.95 17727.7,-585.79 17934.78,-700.95 18019.58,-749.21"/>
<polygon fill="black" stroke="black" points="18017.93,-752.3 18028.35,-754.21 18021.4,-746.22 18017.93,-752.3"/>
</g>
<!-- l2_mha_res_add_gpu14 -->
<g id="node358" class="node">
<title>l2_mha_res_add_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="11137.07,-797.95 11042.07,-797.95 11042.07,-744.95 11137.07,-744.95 11137.07,-797.95"/>
<text text-anchor="middle" x="11089.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="11089.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11089.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_48_gpu14 -->
<g id="node359" class="node">
<title>l2_expert_48_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16601.07,-708.95 16504.07,-708.95 16504.07,-655.95 16601.07,-655.95 16601.07,-708.95"/>
<text text-anchor="middle" x="16552.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 112</text>
<text text-anchor="middle" x="16552.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16552.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu14 -->
<g id="node368" class="node">
<title>l2_expert_agg_gpu14</title>
<polygon fill="yellow" stroke="black" points="16301.2,-611.45 16061.58,-611.45 15999.94,-575.45 16239.56,-575.45 16301.2,-611.45"/>
<text text-anchor="middle" x="16150.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_48_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge941" class="edge">
<title>l2_expert_48_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16504.05,-658.81C16501.21,-657.78 16498.37,-656.81 16495.57,-655.95 16432.91,-636.67 16361.88,-622.73 16300.62,-613.04"/>
<polygon fill="black" stroke="black" points="16300.91,-609.54 16290.49,-611.46 16299.83,-616.46 16300.91,-609.54"/>
</g>
<!-- l2_expert_49_gpu14 -->
<g id="node360" class="node">
<title>l2_expert_49_gpu14</title>
<polygon fill="lightpink" stroke="black" points="15796.07,-708.95 15699.07,-708.95 15699.07,-655.95 15796.07,-655.95 15796.07,-708.95"/>
<text text-anchor="middle" x="15747.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 113</text>
<text text-anchor="middle" x="15747.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15747.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_49_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge944" class="edge">
<title>l2_expert_49_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M15796.31,-659.05C15799.41,-657.93 15802.52,-656.88 15805.57,-655.95 15882.96,-632.41 15973.03,-616.73 16041.72,-607.1"/>
<polygon fill="black" stroke="black" points="16042.27,-610.56 16051.7,-605.72 16041.32,-603.62 16042.27,-610.56"/>
</g>
<!-- l2_expert_50_gpu14 -->
<g id="node361" class="node">
<title>l2_expert_50_gpu14</title>
<polygon fill="lightpink" stroke="black" points="15911.07,-708.95 15814.07,-708.95 15814.07,-655.95 15911.07,-655.95 15911.07,-708.95"/>
<text text-anchor="middle" x="15862.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 114</text>
<text text-anchor="middle" x="15862.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15862.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_50_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge947" class="edge">
<title>l2_expert_50_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M15911.09,-659.48C15914.27,-658.23 15917.46,-657.05 15920.57,-655.95 15967.79,-639.37 16021.8,-624.71 16065.61,-613.87"/>
<polygon fill="black" stroke="black" points="16066.49,-617.26 16075.37,-611.48 16064.82,-610.46 16066.49,-617.26"/>
</g>
<!-- l2_expert_51_gpu14 -->
<g id="node362" class="node">
<title>l2_expert_51_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16026.07,-708.95 15929.07,-708.95 15929.07,-655.95 16026.07,-655.95 16026.07,-708.95"/>
<text text-anchor="middle" x="15977.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 115</text>
<text text-anchor="middle" x="15977.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15977.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_51_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge950" class="edge">
<title>l2_expert_51_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16026.22,-656.99C16051.74,-644.15 16082.74,-628.56 16107.4,-616.16"/>
<polygon fill="black" stroke="black" points="16109.16,-619.2 16116.52,-611.58 16106.01,-612.94 16109.16,-619.2"/>
</g>
<!-- l2_expert_52_gpu14 -->
<g id="node363" class="node">
<title>l2_expert_52_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16141.07,-708.95 16044.07,-708.95 16044.07,-655.95 16141.07,-655.95 16141.07,-708.95"/>
<text text-anchor="middle" x="16092.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 116</text>
<text text-anchor="middle" x="16092.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16092.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_52_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge953" class="edge">
<title>l2_expert_52_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16109.66,-655.82C16117.14,-644.59 16125.92,-631.43 16133.41,-620.19"/>
<polygon fill="black" stroke="black" points="16136.47,-621.92 16139.1,-611.65 16130.64,-618.03 16136.47,-621.92"/>
</g>
<!-- l2_expert_53_gpu14 -->
<g id="node364" class="node">
<title>l2_expert_53_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16256.07,-708.95 16159.07,-708.95 16159.07,-655.95 16256.07,-655.95 16256.07,-708.95"/>
<text text-anchor="middle" x="16207.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 117</text>
<text text-anchor="middle" x="16207.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16207.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_53_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge956" class="edge">
<title>l2_expert_53_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16190.77,-655.82C16183.42,-644.59 16174.8,-631.43 16167.43,-620.19"/>
<polygon fill="black" stroke="black" points="16170.25,-618.1 16161.84,-611.65 16164.39,-621.94 16170.25,-618.1"/>
</g>
<!-- l2_expert_54_gpu14 -->
<g id="node365" class="node">
<title>l2_expert_54_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16371.07,-708.95 16274.07,-708.95 16274.07,-655.95 16371.07,-655.95 16371.07,-708.95"/>
<text text-anchor="middle" x="16322.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 118</text>
<text text-anchor="middle" x="16322.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16322.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_54_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge959" class="edge">
<title>l2_expert_54_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16273.74,-656.76C16248.38,-643.93 16217.67,-628.4 16193.26,-616.05"/>
<polygon fill="black" stroke="black" points="16194.75,-612.88 16184.24,-611.49 16191.59,-619.12 16194.75,-612.88"/>
</g>
<!-- l2_expert_55_gpu14 -->
<g id="node366" class="node">
<title>l2_expert_55_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16486.07,-708.95 16389.07,-708.95 16389.07,-655.95 16486.07,-655.95 16486.07,-708.95"/>
<text text-anchor="middle" x="16437.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 119</text>
<text text-anchor="middle" x="16437.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16437.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_55_gpu14&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge962" class="edge">
<title>l2_expert_55_gpu14&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16388.96,-659.09C16386.14,-657.99 16383.33,-656.93 16380.57,-655.95 16333.58,-639.28 16279.81,-624.67 16236.08,-613.87"/>
<polygon fill="black" stroke="black" points="16236.88,-610.46 16226.33,-611.49 16235.21,-617.26 16236.88,-610.46"/>
</g>
<!-- l2_gate_gpu14 -->
<g id="node367" class="node">
<title>l2_gate_gpu14</title>
<polygon fill="lightcyan" stroke="black" points="16312.36,-789.45 16236.33,-789.45 16216.77,-753.45 16292.8,-753.45 16312.36,-789.45"/>
<text text-anchor="middle" x="16264.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_48_gpu14 -->
<g id="edge939" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_48_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16298.36,-763.25C16341.96,-753.57 16420.16,-734.89 16494.45,-709.16"/>
<polygon fill="black" stroke="black" points="16495.69,-712.43 16503.96,-705.82 16493.37,-705.83 16495.69,-712.43"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_49_gpu14 -->
<g id="edge942" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_49_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16232.09,-753.44C16224.54,-750.12 16216.42,-747.03 16208.57,-744.95 16037.85,-699.87 15981.75,-751.79 15806.04,-708.65"/>
<polygon fill="black" stroke="black" points="15806.77,-705.23 15796.22,-706.17 15805.06,-712.01 15806.77,-705.23"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_50_gpu14 -->
<g id="edge945" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_50_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16231.43,-753.38C16224.06,-750.15 16216.17,-747.11 16208.57,-744.95 16087.6,-710.71 16046.98,-741.62 15921.25,-708.75"/>
<polygon fill="black" stroke="black" points="15921.82,-705.27 15911.25,-706.04 15919.99,-712.03 15921.82,-705.27"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_51_gpu14 -->
<g id="edge948" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_51_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16230.4,-753.45C16223.29,-750.32 16215.78,-747.31 16208.57,-744.95 16136.84,-721.48 16112.29,-731.98 16035.92,-708.76"/>
<polygon fill="black" stroke="black" points="16036.93,-705.41 16026.34,-705.75 16034.83,-712.08 16036.93,-705.41"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_52_gpu14 -->
<g id="edge951" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_52_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16230.59,-753.26C16207.73,-741.7 16177.02,-726.17 16150.37,-712.69"/>
<polygon fill="black" stroke="black" points="16151.64,-709.41 16141.13,-708.02 16148.48,-715.65 16151.64,-709.41"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_53_gpu14 -->
<g id="edge954" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_53_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16253.31,-753.26C16246.68,-743.14 16238.05,-729.98 16230.08,-717.81"/>
<polygon fill="black" stroke="black" points="16232.84,-715.63 16224.43,-709.19 16226.98,-719.47 16232.84,-715.63"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_54_gpu14 -->
<g id="edge957" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_54_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16276.03,-753.26C16282.78,-743.14 16291.55,-729.98 16299.66,-717.81"/>
<polygon fill="black" stroke="black" points="16302.78,-719.45 16305.41,-709.19 16296.95,-715.57 16302.78,-719.45"/>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert_55_gpu14 -->
<g id="edge960" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert_55_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16294.31,-755.5C16317.76,-743.7 16351.17,-726.9 16379.83,-712.49"/>
<polygon fill="black" stroke="black" points="16381.59,-715.52 16388.95,-707.9 16378.44,-709.27 16381.59,-715.52"/>
</g>
<!-- l2_res2_gpu14 -->
<g id="node369" class="node">
<title>l2_res2_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16205.57,-522.45 16095.57,-522.45 16095.57,-486.45 16205.57,-486.45 16205.57,-522.45"/>
<text text-anchor="middle" x="16150.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu14&#45;&gt;l2_res2_gpu14 -->
<g id="edge963" class="edge">
<title>l2_expert_agg_gpu14&#45;&gt;l2_res2_gpu14</title>
<path fill="none" stroke="black" d="M16150.57,-575.26C16150.57,-563.11 16150.57,-546.57 16150.57,-532.63"/>
<polygon fill="black" stroke="black" points="16154.07,-532.61 16150.57,-522.61 16147.07,-532.61 16154.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu14 -->
<g id="node482" class="node">
<title>l3_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="15287.07,-430.95 15192.07,-430.95 15192.07,-377.95 15287.07,-377.95 15287.07,-430.95"/>
<text text-anchor="middle" x="15239.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="15239.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15239.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu14&#45;&gt;l3_mha_qkv_gpu14 -->
<g id="edge965" class="edge">
<title>l2_res2_gpu14&#45;&gt;l3_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M16095.57,-503.09C15918.15,-501.59 15368.28,-494.35 15295.57,-461.95 15283.94,-456.77 15273.42,-447.99 15264.73,-438.88"/>
<polygon fill="black" stroke="black" points="15267.15,-436.34 15257.87,-431.22 15261.93,-441.01 15267.15,-436.34"/>
</g>
<!-- l2_mha_attn_gpu15 -->
<g id="node371" class="node">
<title>l2_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="14761.07,-708.95 14666.07,-708.95 14666.07,-655.95 14761.07,-655.95 14761.07,-708.95"/>
<text text-anchor="middle" x="14713.57" y="-693.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="14713.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14713.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_qkv_gpu15&#45;&gt;l2_mha_attn_gpu15 -->
<g id="edge999" class="edge">
<title>l2_mha_qkv_gpu15&#45;&gt;l2_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M16104.03,-766.36C16037.38,-760.76 15912.32,-750.74 15805.57,-744.95 15578.91,-732.66 15010.59,-760.14 14771.08,-708.56"/>
<polygon fill="black" stroke="black" points="14771.84,-705.14 14761.32,-706.37 14770.31,-711.98 14771.84,-705.14"/>
</g>
<!-- l2_res_add_gpu15 -->
<g id="node537" class="node">
<title>l2_res_add_gpu15</title>
<ellipse fill="none" stroke="black" cx="18261.57" cy="-771.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="18261.57" y="-767.75" font-family="Times,serif" font-size="14.00">l2_res_add_gpu15</text>
</g>
<!-- l2_mha_qkv_gpu15&#45;&gt;l2_res_add_gpu15 -->
<g id="edge1003" class="edge">
<title>l2_mha_qkv_gpu15&#45;&gt;l2_res_add_gpu15</title>
<path fill="none" stroke="black" d="M16159.18,-797.97C16168.14,-822.93 16185.85,-857.43 16216.57,-863.95 16229.71,-866.74 18137.43,-866.74 18150.57,-863.95 18189.64,-855.66 18223.05,-821.9 18242.73,-797.56"/>
<polygon fill="black" stroke="black" points="18245.7,-799.44 18249.1,-789.4 18240.18,-795.13 18245.7,-799.44"/>
</g>
<!-- l2_mha_out_gpu15 -->
<g id="node372" class="node">
<title>l2_mha_out_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="14940.07,-619.95 14845.07,-619.95 14845.07,-566.95 14940.07,-566.95 14940.07,-619.95"/>
<text text-anchor="middle" x="14892.57" y="-604.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="14892.57" y="-589.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14892.57" y="-574.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_attn_gpu15&#45;&gt;l2_mha_out_gpu15 -->
<g id="edge1000" class="edge">
<title>l2_mha_attn_gpu15&#45;&gt;l2_mha_out_gpu15</title>
<path fill="none" stroke="black" d="M14761.54,-658.14C14784.3,-647.07 14811.67,-633.77 14835.5,-622.19"/>
<polygon fill="black" stroke="black" points="14837.31,-625.2 14844.78,-617.68 14834.25,-618.9 14837.31,-625.2"/>
</g>
<!-- l2_mha_allreduce_gpu15 -->
<g id="node373" class="node">
<title>l2_mha_allreduce_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16715.07,-530.95 16620.07,-530.95 16620.07,-477.95 16715.07,-477.95 16715.07,-530.95"/>
<text text-anchor="middle" x="16667.57" y="-515.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="16667.57" y="-500.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16667.57" y="-485.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_mha_out_gpu15&#45;&gt;l2_mha_allreduce_gpu15 -->
<g id="edge1001" class="edge">
<title>l2_mha_out_gpu15&#45;&gt;l2_mha_allreduce_gpu15</title>
<path fill="none" stroke="black" d="M14940.1,-584.13C14975.65,-578.27 15025.5,-570.81 15069.57,-566.95 15576.77,-522.58 15705.92,-553.26 16214.57,-530.95 16356.74,-524.72 16523.84,-514.58 16609.89,-509.16"/>
<polygon fill="black" stroke="black" points="16610.22,-512.65 16619.98,-508.52 16609.78,-505.66 16610.22,-512.65"/>
</g>
<!-- l2_mha_allreduce_gpu15&#45;&gt;l2_res_add_gpu15 -->
<g id="edge1002" class="edge">
<title>l2_mha_allreduce_gpu15&#45;&gt;l2_res_add_gpu15</title>
<path fill="none" stroke="black" d="M16715.11,-509.61C16780.49,-515.19 16901.87,-525.09 17005.57,-530.95 17111.81,-536.96 17861.48,-533.72 17962.57,-566.95 18077.84,-604.85 18189.46,-701.49 18237.25,-746.59"/>
<polygon fill="black" stroke="black" points="18234.98,-749.26 18244.63,-753.63 18239.81,-744.19 18234.98,-749.26"/>
</g>
<!-- l2_mha_res_add_gpu15 -->
<g id="node374" class="node">
<title>l2_mha_res_add_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="10233.07,-797.95 10138.07,-797.95 10138.07,-744.95 10233.07,-744.95 10233.07,-797.95"/>
<text text-anchor="middle" x="10185.57" y="-782.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="10185.57" y="-767.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="10185.57" y="-752.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_56_gpu15 -->
<g id="node375" class="node">
<title>l2_expert_56_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17291.07,-708.95 17194.07,-708.95 17194.07,-655.95 17291.07,-655.95 17291.07,-708.95"/>
<text text-anchor="middle" x="17242.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 120</text>
<text text-anchor="middle" x="17242.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17242.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_agg_gpu15 -->
<g id="node384" class="node">
<title>l2_expert_agg_gpu15</title>
<polygon fill="yellow" stroke="black" points="17220.2,-611.45 16980.58,-611.45 16918.94,-575.45 17158.56,-575.45 17220.2,-611.45"/>
<text text-anchor="middle" x="17069.57" y="-589.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l2_expert_56_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1007" class="edge">
<title>l2_expert_56_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17193.92,-656.99C17168.4,-644.15 17137.4,-628.56 17112.74,-616.16"/>
<polygon fill="black" stroke="black" points="17114.13,-612.94 17103.62,-611.58 17110.98,-619.2 17114.13,-612.94"/>
</g>
<!-- l2_expert_57_gpu15 -->
<g id="node376" class="node">
<title>l2_expert_57_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17406.07,-708.95 17309.07,-708.95 17309.07,-655.95 17406.07,-655.95 17406.07,-708.95"/>
<text text-anchor="middle" x="17357.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 121</text>
<text text-anchor="middle" x="17357.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17357.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_57_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1010" class="edge">
<title>l2_expert_57_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17308.96,-659.09C17306.14,-657.99 17303.33,-656.93 17300.57,-655.95 17253.38,-639.24 17199.37,-624.62 17155.45,-613.84"/>
<polygon fill="black" stroke="black" points="17156.21,-610.42 17145.67,-611.45 17154.55,-617.22 17156.21,-610.42"/>
</g>
<!-- l2_expert_58_gpu15 -->
<g id="node377" class="node">
<title>l2_expert_58_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17521.07,-708.95 17424.07,-708.95 17424.07,-655.95 17521.07,-655.95 17521.07,-708.95"/>
<text text-anchor="middle" x="17472.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 122</text>
<text text-anchor="middle" x="17472.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17472.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_58_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1013" class="edge">
<title>l2_expert_58_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17424.05,-658.81C17421.21,-657.78 17418.37,-656.81 17415.57,-655.95 17352.87,-636.68 17281.81,-622.74 17220.46,-613.07"/>
<polygon fill="black" stroke="black" points="17220.73,-609.57 17210.31,-611.49 17219.66,-616.48 17220.73,-609.57"/>
</g>
<!-- l2_expert_59_gpu15 -->
<g id="node378" class="node">
<title>l2_expert_59_gpu15</title>
<polygon fill="lightpink" stroke="black" points="16716.07,-708.95 16619.07,-708.95 16619.07,-655.95 16716.07,-655.95 16716.07,-708.95"/>
<text text-anchor="middle" x="16667.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 123</text>
<text text-anchor="middle" x="16667.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16667.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_59_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1016" class="edge">
<title>l2_expert_59_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16716.31,-659.05C16719.41,-657.93 16722.52,-656.88 16725.57,-655.95 16802.6,-632.5 16892.22,-616.83 16960.67,-607.19"/>
<polygon fill="black" stroke="black" points="16961.19,-610.65 16970.61,-605.81 16960.23,-603.71 16961.19,-610.65"/>
</g>
<!-- l2_expert_60_gpu15 -->
<g id="node379" class="node">
<title>l2_expert_60_gpu15</title>
<polygon fill="lightpink" stroke="black" points="16831.07,-708.95 16734.07,-708.95 16734.07,-655.95 16831.07,-655.95 16831.07,-708.95"/>
<text text-anchor="middle" x="16782.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 124</text>
<text text-anchor="middle" x="16782.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16782.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_60_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1019" class="edge">
<title>l2_expert_60_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16831.09,-659.48C16834.28,-658.24 16837.46,-657.05 16840.57,-655.95 16887.59,-639.41 16941.37,-624.76 16984.98,-613.91"/>
<polygon fill="black" stroke="black" points="16985.83,-617.3 16994.7,-611.51 16984.15,-610.51 16985.83,-617.3"/>
</g>
<!-- l2_expert_61_gpu15 -->
<g id="node380" class="node">
<title>l2_expert_61_gpu15</title>
<polygon fill="lightpink" stroke="black" points="16946.07,-708.95 16849.07,-708.95 16849.07,-655.95 16946.07,-655.95 16946.07,-708.95"/>
<text text-anchor="middle" x="16897.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 125</text>
<text text-anchor="middle" x="16897.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16897.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_61_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1022" class="edge">
<title>l2_expert_61_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16946.4,-656.76C16971.76,-643.93 17002.46,-628.4 17026.87,-616.05"/>
<polygon fill="black" stroke="black" points="17028.55,-619.12 17035.89,-611.49 17025.39,-612.88 17028.55,-619.12"/>
</g>
<!-- l2_expert_62_gpu15 -->
<g id="node381" class="node">
<title>l2_expert_62_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17061.07,-708.95 16964.07,-708.95 16964.07,-655.95 17061.07,-655.95 17061.07,-708.95"/>
<text text-anchor="middle" x="17012.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 126</text>
<text text-anchor="middle" x="17012.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17012.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_62_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1025" class="edge">
<title>l2_expert_62_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17029.36,-655.82C17036.72,-644.59 17045.34,-631.43 17052.71,-620.19"/>
<polygon fill="black" stroke="black" points="17055.75,-621.94 17058.3,-611.65 17049.89,-618.1 17055.75,-621.94"/>
</g>
<!-- l2_expert_63_gpu15 -->
<g id="node382" class="node">
<title>l2_expert_63_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17176.07,-708.95 17079.07,-708.95 17079.07,-655.95 17176.07,-655.95 17176.07,-708.95"/>
<text text-anchor="middle" x="17127.57" y="-693.75" font-family="Times,serif" font-size="14.00">Expert 127</text>
<text text-anchor="middle" x="17127.57" y="-678.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17127.57" y="-663.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_expert_63_gpu15&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1028" class="edge">
<title>l2_expert_63_gpu15&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17110.48,-655.82C17102.99,-644.59 17094.22,-631.43 17086.73,-620.19"/>
<polygon fill="black" stroke="black" points="17089.5,-618.03 17081.04,-611.65 17083.67,-621.92 17089.5,-618.03"/>
</g>
<!-- l2_gate_gpu15 -->
<g id="node383" class="node">
<title>l2_gate_gpu15</title>
<polygon fill="lightcyan" stroke="black" points="17175.36,-789.45 17099.33,-789.45 17079.77,-753.45 17155.8,-753.45 17175.36,-789.45"/>
<text text-anchor="middle" x="17127.57" y="-767.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_56_gpu15 -->
<g id="edge1005" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_56_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17150.29,-753.26C17164.58,-742.46 17183.45,-728.17 17200.41,-715.35"/>
<polygon fill="black" stroke="black" points="17202.69,-718.01 17208.55,-709.19 17198.47,-712.43 17202.69,-718.01"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_57_gpu15 -->
<g id="edge1008" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_57_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17159.42,-759.97C17192.43,-748.93 17245.67,-730.6 17299.51,-709.28"/>
<polygon fill="black" stroke="black" points="17300.87,-712.51 17308.86,-705.55 17298.27,-706 17300.87,-712.51"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_58_gpu15 -->
<g id="edge1011" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_58_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17162.77,-765.39C17215.85,-757.22 17319.45,-739.23 17414.28,-709.13"/>
<polygon fill="black" stroke="black" points="17415.58,-712.39 17424.02,-705.98 17413.42,-705.72 17415.58,-712.39"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_59_gpu15 -->
<g id="edge1014" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_59_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17087.45,-767.81C17015.98,-762.36 16862.15,-747.24 16726.05,-708.76"/>
<polygon fill="black" stroke="black" points="16726.86,-705.35 16716.28,-705.94 16724.92,-712.07 16726.86,-705.35"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_60_gpu15 -->
<g id="edge1017" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_60_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17085.52,-764.19C17030.9,-755.47 16932.67,-737.73 16841.05,-708.84"/>
<polygon fill="black" stroke="black" points="16841.94,-705.45 16831.34,-705.73 16839.8,-712.12 16841.94,-705.45"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_61_gpu15 -->
<g id="edge1020" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_61_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17080.14,-754.51C17045.41,-742.59 16997.26,-725.55 16955.57,-708.95 16955.47,-708.92 16955.38,-708.88 16955.28,-708.84"/>
<polygon fill="black" stroke="black" points="16956.78,-705.67 16946.2,-705.13 16954.13,-712.15 16956.78,-705.67"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_62_gpu15 -->
<g id="edge1023" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_62_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17104.85,-753.26C17090.56,-742.46 17071.68,-728.17 17054.73,-715.35"/>
<polygon fill="black" stroke="black" points="17056.67,-712.43 17046.58,-709.19 17052.45,-718.01 17056.67,-712.43"/>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert_63_gpu15 -->
<g id="edge1026" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert_63_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17127.57,-753.26C17127.57,-743.54 17127.57,-731 17127.57,-719.23"/>
<polygon fill="black" stroke="black" points="17131.07,-719.19 17127.57,-709.19 17124.07,-719.19 17131.07,-719.19"/>
</g>
<!-- l2_res2_gpu15 -->
<g id="node385" class="node">
<title>l2_res2_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17124.57,-522.45 17014.57,-522.45 17014.57,-486.45 17124.57,-486.45 17124.57,-522.45"/>
<text text-anchor="middle" x="17069.57" y="-500.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l2_expert_agg_gpu15&#45;&gt;l2_res2_gpu15 -->
<g id="edge1029" class="edge">
<title>l2_expert_agg_gpu15&#45;&gt;l2_res2_gpu15</title>
<path fill="none" stroke="black" d="M17069.57,-575.26C17069.57,-563.11 17069.57,-546.57 17069.57,-532.63"/>
<polygon fill="black" stroke="black" points="17073.07,-532.61 17069.57,-522.61 17066.07,-532.61 17073.07,-532.61"/>
</g>
<!-- l3_mha_qkv_gpu15 -->
<g id="node498" class="node">
<title>l3_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16208.07,-430.95 16113.07,-430.95 16113.07,-377.95 16208.07,-377.95 16208.07,-430.95"/>
<text text-anchor="middle" x="16160.57" y="-415.75" font-family="Times,serif" font-size="14.00">Qkv</text>
<text text-anchor="middle" x="16160.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16160.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l2_res2_gpu15&#45;&gt;l3_mha_qkv_gpu15 -->
<g id="edge1031" class="edge">
<title>l2_res2_gpu15&#45;&gt;l3_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M17014.4,-496.71C16946.38,-488.71 16827.16,-475.73 16724.57,-469.95 16696.39,-468.37 16242.54,-473.02 16216.57,-461.95 16204.76,-456.92 16194.14,-448.09 16185.4,-438.89"/>
<polygon fill="black" stroke="black" points="16187.78,-436.3 16178.53,-431.14 16182.55,-440.94 16187.78,-436.3"/>
</g>
<!-- l3_mha_attn_gpu8 -->
<g id="node387" class="node">
<title>l3_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="12146.07,-341.95 12051.07,-341.95 12051.07,-288.95 12146.07,-288.95 12146.07,-341.95"/>
<text text-anchor="middle" x="12098.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="12098.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="12098.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu8&#45;&gt;l3_mha_attn_gpu8 -->
<g id="edge570" class="edge">
<title>l3_mha_qkv_gpu8&#45;&gt;l3_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M10733.11,-399.29C10798.81,-393.68 10921.1,-383.72 11025.57,-377.95 11248.17,-365.67 11806.35,-393.01 12041.13,-341.83"/>
<polygon fill="black" stroke="black" points="12042.07,-345.2 12051.05,-339.57 12040.52,-338.38 12042.07,-345.2"/>
</g>
<!-- l3_res_add_gpu8 -->
<g id="node524" class="node">
<title>l3_res_add_gpu8</title>
<ellipse fill="none" stroke="black" cx="8623.57" cy="-404.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8623.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu8</text>
</g>
<!-- l3_mha_qkv_gpu8&#45;&gt;l3_res_add_gpu8 -->
<g id="edge574" class="edge">
<title>l3_mha_qkv_gpu8&#45;&gt;l3_res_add_gpu8</title>
<path fill="none" stroke="black" d="M10668.45,-431.1C10657.03,-445.72 10640.48,-461.73 10620.57,-465.95 10607.72,-468.68 8741.42,-468.68 8728.57,-465.95 8700.36,-459.97 8672.38,-442.88 8652.41,-428.23"/>
<polygon fill="black" stroke="black" points="8654.45,-425.39 8644.36,-422.14 8650.22,-430.97 8654.45,-425.39"/>
</g>
<!-- l3_mha_out_gpu8 -->
<g id="node388" class="node">
<title>l3_mha_out_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="12000.07,-252.95 11905.07,-252.95 11905.07,-199.95 12000.07,-199.95 12000.07,-252.95"/>
<text text-anchor="middle" x="11952.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="11952.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="11952.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu8&#45;&gt;l3_mha_out_gpu8 -->
<g id="edge571" class="edge">
<title>l3_mha_attn_gpu8&#45;&gt;l3_mha_out_gpu8</title>
<path fill="none" stroke="black" d="M12055.55,-288.82C12039.44,-279.22 12020.96,-268.21 12004.15,-258.19"/>
<polygon fill="black" stroke="black" points="12005.91,-255.16 11995.53,-253.05 12002.33,-261.18 12005.91,-255.16"/>
</g>
<!-- l3_mha_allreduce_gpu8 -->
<g id="node389" class="node">
<title>l3_mha_allreduce_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="11242.07,-163.95 11147.07,-163.95 11147.07,-110.95 11242.07,-110.95 11242.07,-163.95"/>
<text text-anchor="middle" x="11194.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="11194.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="11194.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu8&#45;&gt;l3_mha_allreduce_gpu8 -->
<g id="edge572" class="edge">
<title>l3_mha_out_gpu8&#45;&gt;l3_mha_allreduce_gpu8</title>
<path fill="none" stroke="black" d="M11905.01,-219.28C11863.89,-213.99 11802.83,-206.25 11749.57,-199.95 11568.07,-178.5 11352.9,-155.29 11252.09,-144.55"/>
<polygon fill="black" stroke="black" points="11252.42,-141.06 11242.11,-143.48 11251.68,-148.02 11252.42,-141.06"/>
</g>
<!-- l3_mha_allreduce_gpu8&#45;&gt;l3_res_add_gpu8 -->
<g id="edge573" class="edge">
<title>l3_mha_allreduce_gpu8&#45;&gt;l3_res_add_gpu8</title>
<path fill="none" stroke="black" d="M11146.96,-141.76C11065.71,-147.28 10895.03,-158.31 10750.57,-163.95 10557.56,-171.49 9199.65,-151.91 9012.57,-199.95 8868.38,-236.98 8717.78,-335.96 8654.48,-380.81"/>
<polygon fill="black" stroke="black" points="8652.24,-378.11 8646.13,-386.77 8656.31,-383.8 8652.24,-378.11"/>
</g>
<!-- l3_mha_res_add_gpu8 -->
<g id="node390" class="node">
<title>l3_mha_res_add_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="16781.07,-430.95 16686.07,-430.95 16686.07,-377.95 16781.07,-377.95 16781.07,-430.95"/>
<text text-anchor="middle" x="16733.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="16733.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16733.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_0_gpu8 -->
<g id="node391" class="node">
<title>l3_expert_0_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9773.07,-341.95 9678.07,-341.95 9678.07,-288.95 9773.07,-288.95 9773.07,-341.95"/>
<text text-anchor="middle" x="9725.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 72</text>
<text text-anchor="middle" x="9725.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9725.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu8 -->
<g id="node400" class="node">
<title>l3_expert_agg_gpu8</title>
<polygon fill="yellow" stroke="black" points="9933.2,-244.45 9693.58,-244.45 9631.94,-208.45 9871.56,-208.45 9933.2,-244.45"/>
<text text-anchor="middle" x="9782.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_0_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge578" class="edge">
<title>l3_expert_0_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9742.36,-288.82C9749.72,-277.59 9758.34,-264.43 9765.71,-253.19"/>
<polygon fill="black" stroke="black" points="9768.75,-254.94 9771.3,-244.65 9762.89,-251.1 9768.75,-254.94"/>
</g>
<!-- l3_expert_1_gpu8 -->
<g id="node392" class="node">
<title>l3_expert_1_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9886.07,-341.95 9791.07,-341.95 9791.07,-288.95 9886.07,-288.95 9886.07,-341.95"/>
<text text-anchor="middle" x="9838.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 73</text>
<text text-anchor="middle" x="9838.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9838.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_1_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge581" class="edge">
<title>l3_expert_1_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9822.07,-288.82C9814.84,-277.59 9806.37,-264.43 9799.13,-253.19"/>
<polygon fill="black" stroke="black" points="9802,-251.17 9793.64,-244.65 9796.11,-254.96 9802,-251.17"/>
</g>
<!-- l3_expert_2_gpu8 -->
<g id="node393" class="node">
<title>l3_expert_2_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9999.07,-341.95 9904.07,-341.95 9904.07,-288.95 9999.07,-288.95 9999.07,-341.95"/>
<text text-anchor="middle" x="9951.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 74</text>
<text text-anchor="middle" x="9951.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9951.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_2_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge584" class="edge">
<title>l3_expert_2_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9904.04,-289.99C9879.11,-277.15 9848.83,-261.56 9824.74,-249.16"/>
<polygon fill="black" stroke="black" points="9826.32,-246.04 9815.83,-244.58 9823.12,-252.27 9826.32,-246.04"/>
</g>
<!-- l3_expert_3_gpu8 -->
<g id="node394" class="node">
<title>l3_expert_3_gpu8</title>
<polygon fill="lightpink" stroke="black" points="10112.07,-341.95 10017.07,-341.95 10017.07,-288.95 10112.07,-288.95 10112.07,-341.95"/>
<text text-anchor="middle" x="10064.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 75</text>
<text text-anchor="middle" x="10064.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10064.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_3_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge587" class="edge">
<title>l3_expert_3_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10016.82,-292.1C10014.05,-290.99 10011.28,-289.93 10008.57,-288.95 9962.53,-272.33 9909.82,-257.74 9866.89,-246.95"/>
<polygon fill="black" stroke="black" points="9867.59,-243.52 9857.04,-244.5 9865.9,-250.31 9867.59,-243.52"/>
</g>
<!-- l3_expert_4_gpu8 -->
<g id="node395" class="node">
<title>l3_expert_4_gpu8</title>
<polygon fill="lightpink" stroke="black" points="10225.07,-341.95 10130.07,-341.95 10130.07,-288.95 10225.07,-288.95 10225.07,-341.95"/>
<text text-anchor="middle" x="10177.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 76</text>
<text text-anchor="middle" x="10177.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10177.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_4_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge590" class="edge">
<title>l3_expert_4_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10129.91,-291.81C10127.12,-290.78 10124.32,-289.82 10121.57,-288.95 10060.06,-269.7 9990.27,-255.76 9930.07,-246.07"/>
<polygon fill="black" stroke="black" points="9930.54,-242.6 9920.11,-244.49 9929.44,-249.51 9930.54,-242.6"/>
</g>
<!-- l3_expert_5_gpu8 -->
<g id="node396" class="node">
<title>l3_expert_5_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9434.07,-341.95 9339.07,-341.95 9339.07,-288.95 9434.07,-288.95 9434.07,-341.95"/>
<text text-anchor="middle" x="9386.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 77</text>
<text text-anchor="middle" x="9386.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9386.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_5_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge593" class="edge">
<title>l3_expert_5_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9434.14,-292.17C9437.3,-291 9440.46,-289.91 9443.57,-288.95 9518.85,-265.66 9606.42,-250.06 9673.7,-240.39"/>
<polygon fill="black" stroke="black" points="9674.48,-243.82 9683.9,-238.95 9673.5,-236.89 9674.48,-243.82"/>
</g>
<!-- l3_expert_6_gpu8 -->
<g id="node397" class="node">
<title>l3_expert_6_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9547.07,-341.95 9452.07,-341.95 9452.07,-288.95 9547.07,-288.95 9547.07,-341.95"/>
<text text-anchor="middle" x="9499.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 78</text>
<text text-anchor="middle" x="9499.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9499.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_6_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge596" class="edge">
<title>l3_expert_6_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9547.24,-292.48C9550.38,-291.24 9553.51,-290.05 9556.57,-288.95 9602.84,-272.42 9655.78,-257.79 9698.79,-246.96"/>
<polygon fill="black" stroke="black" points="9699.8,-250.31 9708.65,-244.49 9698.1,-243.52 9699.8,-250.31"/>
</g>
<!-- l3_expert_7_gpu8 -->
<g id="node398" class="node">
<title>l3_expert_7_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9660.07,-341.95 9565.07,-341.95 9565.07,-288.95 9660.07,-288.95 9660.07,-341.95"/>
<text text-anchor="middle" x="9612.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 79</text>
<text text-anchor="middle" x="9612.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9612.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_7_gpu8&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge599" class="edge">
<title>l3_expert_7_gpu8&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9660.38,-289.99C9685.45,-277.15 9715.92,-261.56 9740.15,-249.16"/>
<polygon fill="black" stroke="black" points="9741.8,-252.25 9749.11,-244.58 9738.61,-246.02 9741.8,-252.25"/>
</g>
<!-- l3_gate_gpu8 -->
<g id="node399" class="node">
<title>l3_gate_gpu8</title>
<polygon fill="lightcyan" stroke="black" points="9773.36,-422.45 9697.33,-422.45 9677.77,-386.45 9753.8,-386.45 9773.36,-422.45"/>
<text text-anchor="middle" x="9725.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_0_gpu8 -->
<g id="edge576" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9725.57,-386.26C9725.57,-376.54 9725.57,-364 9725.57,-352.23"/>
<polygon fill="black" stroke="black" points="9729.07,-352.19 9725.57,-342.19 9722.07,-352.19 9729.07,-352.19"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_1_gpu8 -->
<g id="edge579" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9747.89,-386.26C9761.93,-375.46 9780.48,-361.17 9797.15,-348.35"/>
<polygon fill="black" stroke="black" points="9799.36,-351.06 9805.14,-342.19 9795.09,-345.51 9799.36,-351.06"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_2_gpu8 -->
<g id="edge582" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9757.5,-392.76C9789.94,-381.71 9841.76,-363.54 9894.51,-342.28"/>
<polygon fill="black" stroke="black" points="9896.07,-345.42 9904.02,-338.42 9893.44,-338.94 9896.07,-345.42"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_3_gpu8 -->
<g id="edge585" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9760.62,-398.31C9812.94,-390.1 9914.46,-372.12 10007.34,-342.11"/>
<polygon fill="black" stroke="black" points="10008.47,-345.43 10016.88,-338.98 10006.28,-338.78 10008.47,-345.43"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_4_gpu8 -->
<g id="edge588" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9761.79,-401.15C9830.69,-396.05 9985.13,-381.25 10120.25,-342.04"/>
<polygon fill="black" stroke="black" points="10121.34,-345.37 10129.94,-339.18 10119.36,-338.66 10121.34,-345.37"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_5_gpu8 -->
<g id="edge591" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9683.28,-397.03C9629.39,-388.23 9533.47,-370.53 9443.69,-341.71"/>
<polygon fill="black" stroke="black" points="9444.77,-338.38 9434.18,-338.61 9442.6,-345.04 9444.77,-338.38"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_6_gpu8 -->
<g id="edge594" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9677.87,-387.12C9645.96,-375.96 9602.88,-360.45 9556.64,-341.88"/>
<polygon fill="black" stroke="black" points="9557.94,-338.63 9547.36,-338.13 9555.32,-345.12 9557.94,-338.63"/>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert_7_gpu8 -->
<g id="edge597" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert_7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9703.24,-386.26C9689.2,-375.46 9670.65,-361.17 9653.99,-348.35"/>
<polygon fill="black" stroke="black" points="9656.05,-345.51 9645.99,-342.19 9651.78,-351.06 9656.05,-345.51"/>
</g>
<!-- l3_res2_gpu8 -->
<g id="node401" class="node">
<title>l3_res2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="9837.57,-155.45 9727.57,-155.45 9727.57,-119.45 9837.57,-119.45 9837.57,-155.45"/>
<text text-anchor="middle" x="9782.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu8&#45;&gt;l3_res2_gpu8 -->
<g id="edge600" class="edge">
<title>l3_expert_agg_gpu8&#45;&gt;l3_res2_gpu8</title>
<path fill="none" stroke="black" d="M9782.57,-208.26C9782.57,-196.11 9782.57,-179.57 9782.57,-165.63"/>
<polygon fill="black" stroke="black" points="9786.07,-165.61 9782.57,-155.61 9779.07,-165.61 9786.07,-165.61"/>
</g>
<!-- output -->
<g id="node514" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="13465.57" cy="-37.48" rx="306.77" ry="37.45"/>
<text text-anchor="middle" x="13465.57" y="-48.78" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="13465.57" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden=8192]</text>
<text text-anchor="middle" x="13465.57" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden=8192]</text>
</g>
<!-- l3_res2_gpu8&#45;&gt;output -->
<g id="edge602" class="edge">
<title>l3_res2_gpu8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9837.58,-133.17C9971.72,-125.3 10326.34,-105.21 10622.57,-94.95 11540.33,-63.17 12625.41,-47.76 13150.09,-41.71"/>
<polygon fill="black" stroke="black" points="13150.5,-45.2 13160.46,-41.59 13150.42,-38.2 13150.5,-45.2"/>
</g>
<!-- l3_mha_attn_gpu9 -->
<g id="node403" class="node">
<title>l3_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="13171.07,-341.95 13076.07,-341.95 13076.07,-288.95 13171.07,-288.95 13171.07,-341.95"/>
<text text-anchor="middle" x="13123.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13123.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13123.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu9&#45;&gt;l3_mha_attn_gpu9 -->
<g id="edge636" class="edge">
<title>l3_mha_qkv_gpu9&#45;&gt;l3_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M11637.25,-399.27C11703.46,-393.6 11827.02,-383.55 11932.57,-377.95 12181.36,-364.77 12805.72,-398.49 13066.18,-341.82"/>
<polygon fill="black" stroke="black" points="13067.07,-345.21 13076.05,-339.59 13065.52,-338.38 13067.07,-345.21"/>
</g>
<!-- l3_res_add_gpu9 -->
<g id="node526" class="node">
<title>l3_res_add_gpu9</title>
<ellipse fill="none" stroke="black" cx="8816.57" cy="-404.45" rx="87.99" ry="18"/>
<text text-anchor="middle" x="8816.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu9</text>
</g>
<!-- l3_mha_qkv_gpu9&#45;&gt;l3_res_add_gpu9 -->
<g id="edge640" class="edge">
<title>l3_mha_qkv_gpu9&#45;&gt;l3_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11572.45,-431.1C11561.03,-445.72 11544.48,-461.73 11524.57,-465.95 11506.89,-469.71 8939.25,-469.71 8921.57,-465.95 8893.36,-459.97 8865.38,-442.88 8845.41,-428.23"/>
<polygon fill="black" stroke="black" points="8847.45,-425.39 8837.36,-422.14 8843.22,-430.97 8847.45,-425.39"/>
</g>
<!-- l3_mha_out_gpu9 -->
<g id="node404" class="node">
<title>l3_mha_out_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="13024.07,-252.95 12929.07,-252.95 12929.07,-199.95 13024.07,-199.95 13024.07,-252.95"/>
<text text-anchor="middle" x="12976.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="12976.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="12976.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu9&#45;&gt;l3_mha_out_gpu9 -->
<g id="edge637" class="edge">
<title>l3_mha_attn_gpu9&#45;&gt;l3_mha_out_gpu9</title>
<path fill="none" stroke="black" d="M13080.26,-288.82C13064.03,-279.22 13045.43,-268.21 13028.5,-258.19"/>
<polygon fill="black" stroke="black" points="13030.21,-255.13 13019.82,-253.05 13026.65,-261.16 13030.21,-255.13"/>
</g>
<!-- l3_mha_allreduce_gpu9 -->
<g id="node405" class="node">
<title>l3_mha_allreduce_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="11925.07,-163.95 11830.07,-163.95 11830.07,-110.95 11925.07,-110.95 11925.07,-163.95"/>
<text text-anchor="middle" x="11877.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="11877.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11877.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu9&#45;&gt;l3_mha_allreduce_gpu9 -->
<g id="edge638" class="edge">
<title>l3_mha_out_gpu9&#45;&gt;l3_mha_allreduce_gpu9</title>
<path fill="none" stroke="black" d="M12928.84,-218.72C12887.55,-213.08 12826.21,-205.15 12772.57,-199.95 12689.65,-191.93 12120.18,-154.36 11935.35,-142.24"/>
<polygon fill="black" stroke="black" points="11935.5,-138.74 11925.29,-141.58 11935.04,-145.72 11935.5,-138.74"/>
</g>
<!-- l3_mha_allreduce_gpu9&#45;&gt;l3_res_add_gpu9 -->
<g id="edge639" class="edge">
<title>l3_mha_allreduce_gpu9&#45;&gt;l3_res_add_gpu9</title>
<path fill="none" stroke="black" d="M11830.06,-145.24C11784.8,-151.38 11714.7,-160.04 11653.57,-163.95 11515.11,-172.81 9290.02,-162.03 9156.57,-199.95 9027.85,-236.53 8898.45,-335.01 8843.71,-380.21"/>
<polygon fill="black" stroke="black" points="8841.32,-377.64 8835.88,-386.73 8845.81,-383.02 8841.32,-377.64"/>
</g>
<!-- l3_mha_res_add_gpu9 -->
<g id="node406" class="node">
<title>l3_mha_res_add_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="15747.07,-430.95 15652.07,-430.95 15652.07,-377.95 15747.07,-377.95 15747.07,-430.95"/>
<text text-anchor="middle" x="15699.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="15699.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="15699.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_8_gpu9 -->
<g id="node407" class="node">
<title>l3_expert_8_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10903.07,-341.95 10808.07,-341.95 10808.07,-288.95 10903.07,-288.95 10903.07,-341.95"/>
<text text-anchor="middle" x="10855.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 80</text>
<text text-anchor="middle" x="10855.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10855.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu9 -->
<g id="node416" class="node">
<title>l3_expert_agg_gpu9</title>
<polygon fill="yellow" stroke="black" points="10837.2,-244.45 10597.58,-244.45 10535.94,-208.45 10775.56,-208.45 10837.2,-244.45"/>
<text text-anchor="middle" x="10686.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_8_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge644" class="edge">
<title>l3_expert_8_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10808.04,-289.99C10783.11,-277.15 10752.83,-261.56 10728.74,-249.16"/>
<polygon fill="black" stroke="black" points="10730.32,-246.04 10719.83,-244.58 10727.12,-252.27 10730.32,-246.04"/>
</g>
<!-- l3_expert_9_gpu9 -->
<g id="node408" class="node">
<title>l3_expert_9_gpu9</title>
<polygon fill="lightpink" stroke="black" points="11016.07,-341.95 10921.07,-341.95 10921.07,-288.95 11016.07,-288.95 11016.07,-341.95"/>
<text text-anchor="middle" x="10968.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 81</text>
<text text-anchor="middle" x="10968.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10968.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge647" class="edge">
<title>l3_expert_9_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10920.82,-292.1C10918.05,-290.99 10915.28,-289.93 10912.57,-288.95 10866.53,-272.33 10813.82,-257.74 10770.89,-246.95"/>
<polygon fill="black" stroke="black" points="10771.59,-243.52 10761.04,-244.5 10769.9,-250.31 10771.59,-243.52"/>
</g>
<!-- l3_expert_10_gpu9 -->
<g id="node409" class="node">
<title>l3_expert_10_gpu9</title>
<polygon fill="lightpink" stroke="black" points="11129.07,-341.95 11034.07,-341.95 11034.07,-288.95 11129.07,-288.95 11129.07,-341.95"/>
<text text-anchor="middle" x="11081.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 82</text>
<text text-anchor="middle" x="11081.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11081.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_10_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge650" class="edge">
<title>l3_expert_10_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11033.91,-291.81C11031.12,-290.78 11028.32,-289.82 11025.57,-288.95 10964.06,-269.7 10894.27,-255.76 10834.07,-246.07"/>
<polygon fill="black" stroke="black" points="10834.54,-242.6 10824.11,-244.49 10833.44,-249.51 10834.54,-242.6"/>
</g>
<!-- l3_expert_11_gpu9 -->
<g id="node410" class="node">
<title>l3_expert_11_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10338.07,-341.95 10243.07,-341.95 10243.07,-288.95 10338.07,-288.95 10338.07,-341.95"/>
<text text-anchor="middle" x="10290.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 83</text>
<text text-anchor="middle" x="10290.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10290.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_11_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge653" class="edge">
<title>l3_expert_11_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10338.14,-292.17C10341.3,-291 10344.46,-289.91 10347.57,-288.95 10422.85,-265.66 10510.42,-250.06 10577.7,-240.39"/>
<polygon fill="black" stroke="black" points="10578.48,-243.82 10587.9,-238.95 10577.5,-236.89 10578.48,-243.82"/>
</g>
<!-- l3_expert_12_gpu9 -->
<g id="node411" class="node">
<title>l3_expert_12_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10451.07,-341.95 10356.07,-341.95 10356.07,-288.95 10451.07,-288.95 10451.07,-341.95"/>
<text text-anchor="middle" x="10403.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 84</text>
<text text-anchor="middle" x="10403.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10403.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_12_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge656" class="edge">
<title>l3_expert_12_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10451.24,-292.48C10454.38,-291.24 10457.51,-290.05 10460.57,-288.95 10506.84,-272.42 10559.78,-257.79 10602.79,-246.96"/>
<polygon fill="black" stroke="black" points="10603.8,-250.31 10612.65,-244.49 10602.1,-243.52 10603.8,-250.31"/>
</g>
<!-- l3_expert_13_gpu9 -->
<g id="node412" class="node">
<title>l3_expert_13_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10564.07,-341.95 10469.07,-341.95 10469.07,-288.95 10564.07,-288.95 10564.07,-341.95"/>
<text text-anchor="middle" x="10516.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 85</text>
<text text-anchor="middle" x="10516.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10516.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_13_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge659" class="edge">
<title>l3_expert_13_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10564.38,-289.99C10589.45,-277.15 10619.92,-261.56 10644.15,-249.16"/>
<polygon fill="black" stroke="black" points="10645.8,-252.25 10653.11,-244.58 10642.61,-246.02 10645.8,-252.25"/>
</g>
<!-- l3_expert_14_gpu9 -->
<g id="node413" class="node">
<title>l3_expert_14_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10677.07,-341.95 10582.07,-341.95 10582.07,-288.95 10677.07,-288.95 10677.07,-341.95"/>
<text text-anchor="middle" x="10629.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 86</text>
<text text-anchor="middle" x="10629.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10629.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_14_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge662" class="edge">
<title>l3_expert_14_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10646.36,-288.82C10653.72,-277.59 10662.34,-264.43 10669.71,-253.19"/>
<polygon fill="black" stroke="black" points="10672.75,-254.94 10675.3,-244.65 10666.89,-251.1 10672.75,-254.94"/>
</g>
<!-- l3_expert_15_gpu9 -->
<g id="node414" class="node">
<title>l3_expert_15_gpu9</title>
<polygon fill="lightpink" stroke="black" points="10790.07,-341.95 10695.07,-341.95 10695.07,-288.95 10790.07,-288.95 10790.07,-341.95"/>
<text text-anchor="middle" x="10742.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 87</text>
<text text-anchor="middle" x="10742.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10742.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_15_gpu9&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge665" class="edge">
<title>l3_expert_15_gpu9&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10726.07,-288.82C10718.84,-277.59 10710.37,-264.43 10703.13,-253.19"/>
<polygon fill="black" stroke="black" points="10706,-251.17 10697.64,-244.65 10700.11,-254.96 10706,-251.17"/>
</g>
<!-- l3_gate_gpu9 -->
<g id="node415" class="node">
<title>l3_gate_gpu9</title>
<polygon fill="lightcyan" stroke="black" points="10620.36,-422.45 10544.33,-422.45 10524.77,-386.45 10600.8,-386.45 10620.36,-422.45"/>
<text text-anchor="middle" x="10572.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_8_gpu9 -->
<g id="edge642" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_8_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10602.27,-388.74C10610.93,-384.84 10620.5,-380.91 10629.57,-377.95 10700,-355.03 10724.22,-365.17 10798.12,-342.14"/>
<polygon fill="black" stroke="black" points="10799.44,-345.39 10807.88,-339 10797.29,-338.73 10799.44,-345.39"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_9_gpu9 -->
<g id="edge645" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10602.13,-388.25C10610.78,-384.35 10620.38,-380.53 10629.57,-377.95 10748.54,-344.56 10788.58,-374.99 10911.21,-341.98"/>
<polygon fill="black" stroke="black" points="10912.27,-345.32 10920.97,-339.27 10910.39,-338.57 10912.27,-345.32"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_10_gpu9 -->
<g id="edge648" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_10_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10601.77,-388.17C10610.5,-384.22 10620.23,-380.39 10629.57,-377.95 10797.38,-334.09 10852.69,-385.24 11024.15,-341.95"/>
<polygon fill="black" stroke="black" points="11025.2,-345.29 11034,-339.39 11023.44,-338.51 11025.2,-345.29"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_11_gpu9 -->
<g id="edge651" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_11_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10528.4,-393.51C10484.63,-383.19 10415.68,-365.66 10347.81,-341.83"/>
<polygon fill="black" stroke="black" points="10348.84,-338.48 10338.24,-338.42 10346.49,-345.07 10348.84,-338.48"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_12_gpu9 -->
<g id="edge654" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_12_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10539.18,-386.26C10516.72,-374.7 10486.55,-359.17 10460.36,-345.69"/>
<polygon fill="black" stroke="black" points="10461.78,-342.48 10451.29,-341.02 10458.58,-348.71 10461.78,-342.48"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_13_gpu9 -->
<g id="edge657" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_13_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10561.5,-386.26C10554.99,-376.14 10546.52,-362.98 10538.68,-350.81"/>
<polygon fill="black" stroke="black" points="10541.49,-348.7 10533.13,-342.19 10535.6,-352.49 10541.49,-348.7"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_14_gpu9 -->
<g id="edge660" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_14_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10583.83,-386.26C10590.46,-376.14 10599.09,-362.98 10607.06,-350.81"/>
<polygon fill="black" stroke="black" points="10610.16,-352.47 10612.71,-342.19 10604.3,-348.63 10610.16,-352.47"/>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert_15_gpu9 -->
<g id="edge663" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert_15_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10602.18,-388.3C10625.27,-376.48 10658.02,-359.72 10686.08,-345.36"/>
<polygon fill="black" stroke="black" points="10687.7,-348.46 10695.01,-340.79 10684.51,-342.23 10687.7,-348.46"/>
</g>
<!-- l3_res2_gpu9 -->
<g id="node417" class="node">
<title>l3_res2_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="10741.57,-155.45 10631.57,-155.45 10631.57,-119.45 10741.57,-119.45 10741.57,-155.45"/>
<text text-anchor="middle" x="10686.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu9&#45;&gt;l3_res2_gpu9 -->
<g id="edge666" class="edge">
<title>l3_expert_agg_gpu9&#45;&gt;l3_res2_gpu9</title>
<path fill="none" stroke="black" d="M10686.57,-208.26C10686.57,-196.11 10686.57,-179.57 10686.57,-165.63"/>
<polygon fill="black" stroke="black" points="10690.07,-165.61 10686.57,-155.61 10683.07,-165.61 10690.07,-165.61"/>
</g>
<!-- l3_res2_gpu9&#45;&gt;output -->
<g id="edge668" class="edge">
<title>l3_res2_gpu9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10741.8,-130.17C10826.88,-120.78 10995.19,-103.27 11138.57,-94.95 11856.5,-53.33 12700.76,-42.28 13148.79,-39.42"/>
<polygon fill="black" stroke="black" points="13149,-42.92 13158.97,-39.35 13148.95,-35.92 13149,-42.92"/>
</g>
<!-- l3_mha_attn_gpu10 -->
<g id="node419" class="node">
<title>l3_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="13284.07,-341.95 13189.07,-341.95 13189.07,-288.95 13284.07,-288.95 13284.07,-341.95"/>
<text text-anchor="middle" x="13236.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13236.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="13236.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu10&#45;&gt;l3_mha_attn_gpu10 -->
<g id="edge702" class="edge">
<title>l3_mha_qkv_gpu10&#45;&gt;l3_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M12603.34,-380.64C12606.42,-379.62 12609.52,-378.71 12612.57,-377.95 12854.91,-318.14 12933.13,-401.14 13179.07,-341.93"/>
<polygon fill="black" stroke="black" points="13180.15,-345.27 13189.02,-339.48 13178.48,-338.47 13180.15,-345.27"/>
</g>
<!-- l3_res_add_gpu10 -->
<g id="node528" class="node">
<title>l3_res_add_gpu10</title>
<ellipse fill="none" stroke="black" cx="9015.57" cy="-404.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="9015.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu10</text>
</g>
<!-- l3_mha_qkv_gpu10&#45;&gt;l3_res_add_gpu10 -->
<g id="edge706" class="edge">
<title>l3_mha_qkv_gpu10&#45;&gt;l3_res_add_gpu10</title>
<path fill="none" stroke="black" d="M12538.45,-431.1C12527.03,-445.72 12510.48,-461.73 12490.57,-465.95 12467.72,-470.8 9149.42,-470.8 9126.57,-465.95 9097.02,-459.68 9067.28,-442.49 9046.03,-427.87"/>
<polygon fill="black" stroke="black" points="9047.94,-424.93 9037.76,-422.01 9043.9,-430.64 9047.94,-424.93"/>
</g>
<!-- l3_mha_out_gpu10 -->
<g id="node420" class="node">
<title>l3_mha_out_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="13211.07,-252.95 13116.07,-252.95 13116.07,-199.95 13211.07,-199.95 13211.07,-252.95"/>
<text text-anchor="middle" x="13163.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13163.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="13163.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu10&#45;&gt;l3_mha_out_gpu10 -->
<g id="edge703" class="edge">
<title>l3_mha_attn_gpu10&#45;&gt;l3_mha_out_gpu10</title>
<path fill="none" stroke="black" d="M13215.06,-288.82C13207.77,-280.14 13199.52,-270.3 13191.79,-261.09"/>
<polygon fill="black" stroke="black" points="13194.28,-258.61 13185.17,-253.2 13188.92,-263.11 13194.28,-258.61"/>
</g>
<!-- l3_mha_allreduce_gpu10 -->
<g id="node421" class="node">
<title>l3_mha_allreduce_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="12372.07,-163.95 12277.07,-163.95 12277.07,-110.95 12372.07,-110.95 12372.07,-163.95"/>
<text text-anchor="middle" x="12324.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="12324.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12324.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu10&#45;&gt;l3_mha_allreduce_gpu10 -->
<g id="edge704" class="edge">
<title>l3_mha_out_gpu10&#45;&gt;l3_mha_allreduce_gpu10</title>
<path fill="none" stroke="black" d="M13115.95,-214.69C13091.45,-209.52 13061.03,-203.65 13033.57,-199.95 12819.35,-171.1 12763.77,-184.18 12548.57,-163.95 12491.99,-158.64 12427.54,-151.15 12382.34,-145.66"/>
<polygon fill="black" stroke="black" points="12382.49,-142.15 12372.14,-144.42 12381.64,-149.1 12382.49,-142.15"/>
</g>
<!-- l3_mha_allreduce_gpu10&#45;&gt;l3_res_add_gpu10 -->
<g id="edge705" class="edge">
<title>l3_mha_allreduce_gpu10&#45;&gt;l3_res_add_gpu10</title>
<path fill="none" stroke="black" d="M12276.88,-142.37C12203.42,-148.23 12058.14,-159.1 11934.57,-163.95 11859.2,-166.91 9289.08,-170.67 9219.57,-199.95 9131.62,-237.01 9061.46,-331.85 9031.42,-377.77"/>
<polygon fill="black" stroke="black" points="9028.42,-375.97 9025.95,-386.27 9034.3,-379.76 9028.42,-375.97"/>
</g>
<!-- l3_mha_res_add_gpu10 -->
<g id="node422" class="node">
<title>l3_mha_res_add_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="14885.07,-430.95 14790.07,-430.95 14790.07,-377.95 14885.07,-377.95 14885.07,-430.95"/>
<text text-anchor="middle" x="14837.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="14837.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="14837.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_16_gpu10 -->
<g id="node423" class="node">
<title>l3_expert_16_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11694.07,-341.95 11599.07,-341.95 11599.07,-288.95 11694.07,-288.95 11694.07,-341.95"/>
<text text-anchor="middle" x="11646.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 88</text>
<text text-anchor="middle" x="11646.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11646.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu10 -->
<g id="node432" class="node">
<title>l3_expert_agg_gpu10</title>
<polygon fill="yellow" stroke="black" points="11740.2,-244.45 11500.58,-244.45 11438.94,-208.45 11678.56,-208.45 11740.2,-244.45"/>
<text text-anchor="middle" x="11589.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_16_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge710" class="edge">
<title>l3_expert_16_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11629.77,-288.82C11622.42,-277.59 11613.8,-264.43 11606.43,-253.19"/>
<polygon fill="black" stroke="black" points="11609.25,-251.1 11600.84,-244.65 11603.39,-254.94 11609.25,-251.1"/>
</g>
<!-- l3_expert_17_gpu10 -->
<g id="node424" class="node">
<title>l3_expert_17_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11807.07,-341.95 11712.07,-341.95 11712.07,-288.95 11807.07,-288.95 11807.07,-341.95"/>
<text text-anchor="middle" x="11759.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 89</text>
<text text-anchor="middle" x="11759.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11759.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_17_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge713" class="edge">
<title>l3_expert_17_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11711.76,-289.99C11686.68,-277.15 11656.22,-261.56 11631.99,-249.16"/>
<polygon fill="black" stroke="black" points="11633.52,-246.02 11623.03,-244.58 11630.34,-252.25 11633.52,-246.02"/>
</g>
<!-- l3_expert_18_gpu10 -->
<g id="node425" class="node">
<title>l3_expert_18_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11920.07,-341.95 11825.07,-341.95 11825.07,-288.95 11920.07,-288.95 11920.07,-341.95"/>
<text text-anchor="middle" x="11872.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 90</text>
<text text-anchor="middle" x="11872.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11872.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_18_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge716" class="edge">
<title>l3_expert_18_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11824.82,-292.09C11822.05,-290.99 11819.28,-289.93 11816.57,-288.95 11770.33,-272.29 11717.39,-257.7 11674.27,-246.92"/>
<polygon fill="black" stroke="black" points="11674.93,-243.47 11664.38,-244.47 11673.24,-250.27 11674.93,-243.47"/>
</g>
<!-- l3_expert_19_gpu10 -->
<g id="node426" class="node">
<title>l3_expert_19_gpu10</title>
<polygon fill="lightpink" stroke="black" points="12033.07,-341.95 11938.07,-341.95 11938.07,-288.95 12033.07,-288.95 12033.07,-341.95"/>
<text text-anchor="middle" x="11985.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 91</text>
<text text-anchor="middle" x="11985.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11985.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_19_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge719" class="edge">
<title>l3_expert_19_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11937.91,-291.81C11935.12,-290.78 11932.32,-289.81 11929.57,-288.95 11868.02,-269.7 11798.19,-255.77 11737.91,-246.09"/>
<polygon fill="black" stroke="black" points="11738.35,-242.62 11727.93,-244.51 11737.26,-249.53 11738.35,-242.62"/>
</g>
<!-- l3_expert_20_gpu10 -->
<g id="node427" class="node">
<title>l3_expert_20_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11242.07,-341.95 11147.07,-341.95 11147.07,-288.95 11242.07,-288.95 11242.07,-341.95"/>
<text text-anchor="middle" x="11194.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 92</text>
<text text-anchor="middle" x="11194.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11194.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_20_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge722" class="edge">
<title>l3_expert_20_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11242.14,-292.17C11245.3,-291 11248.46,-289.92 11251.57,-288.95 11326.63,-265.71 11413.94,-250.1 11481.02,-240.43"/>
<polygon fill="black" stroke="black" points="11481.78,-243.85 11491.19,-238.98 11480.79,-236.92 11481.78,-243.85"/>
</g>
<!-- l3_expert_21_gpu10 -->
<g id="node428" class="node">
<title>l3_expert_21_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11355.07,-341.95 11260.07,-341.95 11260.07,-288.95 11355.07,-288.95 11355.07,-341.95"/>
<text text-anchor="middle" x="11307.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 93</text>
<text text-anchor="middle" x="11307.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11307.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_21_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge725" class="edge">
<title>l3_expert_21_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11355.24,-292.48C11358.38,-291.24 11361.51,-290.05 11364.57,-288.95 11410.73,-272.43 11463.55,-257.78 11506.41,-246.93"/>
<polygon fill="black" stroke="black" points="11507.39,-250.29 11516.24,-244.46 11505.69,-243.5 11507.39,-250.29"/>
</g>
<!-- l3_expert_22_gpu10 -->
<g id="node429" class="node">
<title>l3_expert_22_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11468.07,-341.95 11373.07,-341.95 11373.07,-288.95 11468.07,-288.95 11468.07,-341.95"/>
<text text-anchor="middle" x="11420.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 94</text>
<text text-anchor="middle" x="11420.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11420.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_22_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge728" class="edge">
<title>l3_expert_22_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11468.09,-289.99C11493.03,-277.15 11523.31,-261.56 11547.4,-249.16"/>
<polygon fill="black" stroke="black" points="11549.02,-252.27 11556.31,-244.58 11545.81,-246.04 11549.02,-252.27"/>
</g>
<!-- l3_expert_23_gpu10 -->
<g id="node430" class="node">
<title>l3_expert_23_gpu10</title>
<polygon fill="lightpink" stroke="black" points="11581.07,-341.95 11486.07,-341.95 11486.07,-288.95 11581.07,-288.95 11581.07,-341.95"/>
<text text-anchor="middle" x="11533.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 95</text>
<text text-anchor="middle" x="11533.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11533.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_23_gpu10&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge731" class="edge">
<title>l3_expert_23_gpu10&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11550.07,-288.82C11557.3,-277.59 11565.77,-264.43 11573,-253.19"/>
<polygon fill="black" stroke="black" points="11576.03,-254.96 11578.5,-244.65 11570.14,-251.17 11576.03,-254.96"/>
</g>
<!-- l3_gate_gpu10 -->
<g id="node431" class="node">
<title>l3_gate_gpu10</title>
<polygon fill="lightcyan" stroke="black" points="11524.36,-422.45 11448.33,-422.45 11428.77,-386.45 11504.8,-386.45 11524.36,-422.45"/>
<text text-anchor="middle" x="11476.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_16_gpu10 -->
<g id="edge708" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_16_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11506.18,-388.3C11529.27,-376.48 11562.02,-359.72 11590.08,-345.36"/>
<polygon fill="black" stroke="black" points="11591.7,-348.46 11599.01,-340.79 11588.51,-342.23 11591.7,-348.46"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_17_gpu10 -->
<g id="edge711" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_17_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11506.27,-388.74C11514.93,-384.84 11524.5,-380.91 11533.57,-377.95 11604,-355.03 11628.22,-365.17 11702.12,-342.14"/>
<polygon fill="black" stroke="black" points="11703.44,-345.39 11711.88,-339 11701.29,-338.73 11703.44,-345.39"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_18_gpu10 -->
<g id="edge714" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_18_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11506.13,-388.25C11514.78,-384.35 11524.38,-380.53 11533.57,-377.95 11652.54,-344.56 11692.58,-374.99 11815.21,-341.98"/>
<polygon fill="black" stroke="black" points="11816.27,-345.32 11824.97,-339.27 11814.39,-338.57 11816.27,-345.32"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_19_gpu10 -->
<g id="edge717" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_19_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11505.77,-388.17C11514.5,-384.22 11524.23,-380.39 11533.57,-377.95 11701.38,-334.09 11756.69,-385.24 11928.15,-341.95"/>
<polygon fill="black" stroke="black" points="11929.2,-345.29 11938,-339.39 11927.44,-338.51 11929.2,-345.29"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_20_gpu10 -->
<g id="edge720" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_20_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11432.4,-393.51C11388.63,-383.19 11319.68,-365.66 11251.81,-341.83"/>
<polygon fill="black" stroke="black" points="11252.84,-338.48 11242.24,-338.42 11250.49,-345.07 11252.84,-338.48"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_21_gpu10 -->
<g id="edge723" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_21_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11443.18,-386.26C11420.72,-374.7 11390.55,-359.17 11364.36,-345.69"/>
<polygon fill="black" stroke="black" points="11365.78,-342.48 11355.29,-341.02 11362.58,-348.71 11365.78,-342.48"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_22_gpu10 -->
<g id="edge726" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_22_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11465.5,-386.26C11458.99,-376.14 11450.52,-362.98 11442.68,-350.81"/>
<polygon fill="black" stroke="black" points="11445.49,-348.7 11437.13,-342.19 11439.6,-352.49 11445.49,-348.7"/>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert_23_gpu10 -->
<g id="edge729" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert_23_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11487.83,-386.26C11494.46,-376.14 11503.09,-362.98 11511.06,-350.81"/>
<polygon fill="black" stroke="black" points="11514.16,-352.47 11516.71,-342.19 11508.3,-348.63 11514.16,-352.47"/>
</g>
<!-- l3_res2_gpu10 -->
<g id="node433" class="node">
<title>l3_res2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="11644.57,-155.45 11534.57,-155.45 11534.57,-119.45 11644.57,-119.45 11644.57,-155.45"/>
<text text-anchor="middle" x="11589.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu10&#45;&gt;l3_res2_gpu10 -->
<g id="edge732" class="edge">
<title>l3_expert_agg_gpu10&#45;&gt;l3_res2_gpu10</title>
<path fill="none" stroke="black" d="M11589.57,-208.26C11589.57,-196.11 11589.57,-179.57 11589.57,-165.63"/>
<polygon fill="black" stroke="black" points="11593.07,-165.61 11589.57,-155.61 11586.07,-165.61 11593.07,-165.61"/>
</g>
<!-- l3_res2_gpu10&#45;&gt;output -->
<g id="edge734" class="edge">
<title>l3_res2_gpu10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11645.03,-124.23C11691.84,-114.47 11760.74,-101.41 11821.57,-94.95 12070.46,-68.55 12749.25,-51.83 13152.55,-43.91"/>
<polygon fill="black" stroke="black" points="13152.69,-47.4 13162.62,-43.71 13152.55,-40.41 13152.69,-47.4"/>
</g>
<!-- l3_mha_attn_gpu11 -->
<g id="node435" class="node">
<title>l3_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13397.07,-341.95 13302.07,-341.95 13302.07,-288.95 13397.07,-288.95 13397.07,-341.95"/>
<text text-anchor="middle" x="13349.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13349.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13349.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu11&#45;&gt;l3_mha_attn_gpu11 -->
<g id="edge768" class="edge">
<title>l3_mha_qkv_gpu11&#45;&gt;l3_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M12829.1,-402.59C12918.98,-399.92 13119.57,-389.03 13292.21,-342"/>
<polygon fill="black" stroke="black" points="13293.27,-345.34 13301.97,-339.29 13291.4,-338.59 13293.27,-345.34"/>
</g>
<!-- l3_res_add_gpu11 -->
<g id="node530" class="node">
<title>l3_res_add_gpu11</title>
<ellipse fill="none" stroke="black" cx="9220.57" cy="-404.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="9220.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu11</text>
</g>
<!-- l3_mha_qkv_gpu11&#45;&gt;l3_res_add_gpu11 -->
<g id="edge772" class="edge">
<title>l3_mha_qkv_gpu11&#45;&gt;l3_res_add_gpu11</title>
<path fill="none" stroke="black" d="M12764.45,-431.1C12753.03,-445.72 12736.48,-461.73 12716.57,-465.95 12693.6,-470.83 9358.54,-470.83 9335.57,-465.95 9305.07,-459.48 9274.1,-442.17 9252,-427.56"/>
<polygon fill="black" stroke="black" points="9253.93,-424.64 9243.69,-421.92 9249.99,-430.43 9253.93,-424.64"/>
</g>
<!-- l3_mha_out_gpu11 -->
<g id="node436" class="node">
<title>l3_mha_out_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13397.07,-252.95 13302.07,-252.95 13302.07,-199.95 13397.07,-199.95 13397.07,-252.95"/>
<text text-anchor="middle" x="13349.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13349.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13349.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu11&#45;&gt;l3_mha_out_gpu11 -->
<g id="edge769" class="edge">
<title>l3_mha_attn_gpu11&#45;&gt;l3_mha_out_gpu11</title>
<path fill="none" stroke="black" d="M13349.57,-288.82C13349.57,-280.84 13349.57,-271.89 13349.57,-263.34"/>
<polygon fill="black" stroke="black" points="13353.07,-263.2 13349.57,-253.2 13346.07,-263.2 13353.07,-263.2"/>
</g>
<!-- l3_mha_allreduce_gpu11 -->
<g id="node437" class="node">
<title>l3_mha_allreduce_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="13089.07,-163.95 12994.07,-163.95 12994.07,-110.95 13089.07,-110.95 13089.07,-163.95"/>
<text text-anchor="middle" x="13041.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="13041.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13041.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu11&#45;&gt;l3_mha_allreduce_gpu11 -->
<g id="edge770" class="edge">
<title>l3_mha_out_gpu11&#45;&gt;l3_mha_allreduce_gpu11</title>
<path fill="none" stroke="black" d="M13301.78,-211.96C13247.07,-196.5 13157.5,-171.2 13099.04,-154.69"/>
<polygon fill="black" stroke="black" points="13099.79,-151.26 13089.21,-151.91 13097.89,-158 13099.79,-151.26"/>
</g>
<!-- l3_mha_allreduce_gpu11&#45;&gt;l3_res_add_gpu11 -->
<g id="edge771" class="edge">
<title>l3_mha_allreduce_gpu11&#45;&gt;l3_res_add_gpu11</title>
<path fill="none" stroke="black" d="M12993.79,-142.68C12924.11,-148.64 12790.5,-159.31 12676.57,-163.95 12337.49,-177.78 9957.92,-147.96 9622.57,-199.95 9488.5,-220.74 9446.19,-217.96 9330.57,-288.95 9292.37,-312.41 9258.31,-352.27 9238.55,-378.22"/>
<polygon fill="black" stroke="black" points="9235.59,-376.34 9232.41,-386.45 9241.2,-380.53 9235.59,-376.34"/>
</g>
<!-- l3_mha_res_add_gpu11 -->
<g id="node438" class="node">
<title>l3_mha_res_add_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="14199.07,-430.95 14104.07,-430.95 14104.07,-377.95 14199.07,-377.95 14199.07,-430.95"/>
<text text-anchor="middle" x="14151.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="14151.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="14151.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_24_gpu11 -->
<g id="node439" class="node">
<title>l3_expert_24_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12604.07,-341.95 12509.07,-341.95 12509.07,-288.95 12604.07,-288.95 12604.07,-341.95"/>
<text text-anchor="middle" x="12556.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 96</text>
<text text-anchor="middle" x="12556.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12556.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu11 -->
<g id="node448" class="node">
<title>l3_expert_agg_gpu11</title>
<polygon fill="yellow" stroke="black" points="12763.2,-244.45 12523.58,-244.45 12461.94,-208.45 12701.56,-208.45 12763.2,-244.45"/>
<text text-anchor="middle" x="12612.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_24_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge776" class="edge">
<title>l3_expert_24_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12573.07,-288.82C12580.3,-277.59 12588.77,-264.43 12596,-253.19"/>
<polygon fill="black" stroke="black" points="12599.03,-254.96 12601.5,-244.65 12593.14,-251.17 12599.03,-254.96"/>
</g>
<!-- l3_expert_25_gpu11 -->
<g id="node440" class="node">
<title>l3_expert_25_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12717.07,-341.95 12622.07,-341.95 12622.07,-288.95 12717.07,-288.95 12717.07,-341.95"/>
<text text-anchor="middle" x="12669.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 97</text>
<text text-anchor="middle" x="12669.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12669.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_25_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge779" class="edge">
<title>l3_expert_25_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12652.77,-288.82C12645.42,-277.59 12636.8,-264.43 12629.43,-253.19"/>
<polygon fill="black" stroke="black" points="12632.25,-251.1 12623.84,-244.65 12626.39,-254.94 12632.25,-251.1"/>
</g>
<!-- l3_expert_26_gpu11 -->
<g id="node441" class="node">
<title>l3_expert_26_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12830.07,-341.95 12735.07,-341.95 12735.07,-288.95 12830.07,-288.95 12830.07,-341.95"/>
<text text-anchor="middle" x="12782.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 98</text>
<text text-anchor="middle" x="12782.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12782.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_26_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge782" class="edge">
<title>l3_expert_26_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12734.76,-289.99C12709.68,-277.15 12679.22,-261.56 12654.99,-249.16"/>
<polygon fill="black" stroke="black" points="12656.52,-246.02 12646.03,-244.58 12653.34,-252.25 12656.52,-246.02"/>
</g>
<!-- l3_expert_27_gpu11 -->
<g id="node442" class="node">
<title>l3_expert_27_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12943.07,-341.95 12848.07,-341.95 12848.07,-288.95 12943.07,-288.95 12943.07,-341.95"/>
<text text-anchor="middle" x="12895.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 99</text>
<text text-anchor="middle" x="12895.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12895.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_27_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge785" class="edge">
<title>l3_expert_27_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12847.82,-292.09C12845.05,-290.99 12842.28,-289.93 12839.57,-288.95 12793.33,-272.29 12740.39,-257.7 12697.27,-246.92"/>
<polygon fill="black" stroke="black" points="12697.93,-243.47 12687.38,-244.47 12696.24,-250.27 12697.93,-243.47"/>
</g>
<!-- l3_expert_28_gpu11 -->
<g id="node443" class="node">
<title>l3_expert_28_gpu11</title>
<polygon fill="lightpink" stroke="black" points="13058.07,-341.95 12961.07,-341.95 12961.07,-288.95 13058.07,-288.95 13058.07,-341.95"/>
<text text-anchor="middle" x="13009.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 100</text>
<text text-anchor="middle" x="13009.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="13009.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_28_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge788" class="edge">
<title>l3_expert_28_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12961.05,-291.82C12958.21,-290.78 12955.37,-289.82 12952.57,-288.95 12890.41,-269.74 12819.89,-255.77 12759.25,-246.04"/>
<polygon fill="black" stroke="black" points="12759.64,-242.56 12749.22,-244.46 12758.55,-249.48 12759.64,-242.56"/>
</g>
<!-- l3_expert_29_gpu11 -->
<g id="node444" class="node">
<title>l3_expert_29_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12261.07,-341.95 12164.07,-341.95 12164.07,-288.95 12261.07,-288.95 12261.07,-341.95"/>
<text text-anchor="middle" x="12212.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 101</text>
<text text-anchor="middle" x="12212.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12212.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_29_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge791" class="edge">
<title>l3_expert_29_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12261.31,-292.06C12264.41,-290.93 12267.52,-289.88 12270.57,-288.95 12346.86,-265.68 12435.57,-250.04 12503.52,-240.36"/>
<polygon fill="black" stroke="black" points="12504.4,-243.77 12513.82,-238.92 12503.43,-236.84 12504.4,-243.77"/>
</g>
<!-- l3_expert_30_gpu11 -->
<g id="node445" class="node">
<title>l3_expert_30_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12376.07,-341.95 12279.07,-341.95 12279.07,-288.95 12376.07,-288.95 12376.07,-341.95"/>
<text text-anchor="middle" x="12327.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 102</text>
<text text-anchor="middle" x="12327.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12327.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_30_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge794" class="edge">
<title>l3_expert_30_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12376.09,-292.49C12379.28,-291.24 12382.46,-290.05 12385.57,-288.95 12432.18,-272.5 12485.48,-257.85 12528.71,-246.98"/>
<polygon fill="black" stroke="black" points="12529.76,-250.33 12538.62,-244.51 12528.07,-243.53 12529.76,-250.33"/>
</g>
<!-- l3_expert_31_gpu11 -->
<g id="node446" class="node">
<title>l3_expert_31_gpu11</title>
<polygon fill="lightpink" stroke="black" points="12491.07,-341.95 12394.07,-341.95 12394.07,-288.95 12491.07,-288.95 12491.07,-341.95"/>
<text text-anchor="middle" x="12442.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 103</text>
<text text-anchor="middle" x="12442.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12442.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_31_gpu11&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge797" class="edge">
<title>l3_expert_31_gpu11&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12491.28,-289.52C12516.14,-276.8 12546.1,-261.47 12570.02,-249.23"/>
<polygon fill="black" stroke="black" points="12571.89,-252.2 12579.2,-244.53 12568.7,-245.97 12571.89,-252.2"/>
</g>
<!-- l3_gate_gpu11 -->
<g id="node447" class="node">
<title>l3_gate_gpu11</title>
<polygon fill="lightcyan" stroke="black" points="12490.36,-422.45 12414.33,-422.45 12394.77,-386.45 12470.8,-386.45 12490.36,-422.45"/>
<text text-anchor="middle" x="12442.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_24_gpu11 -->
<g id="edge774" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_24_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12465.09,-386.26C12479.26,-375.46 12497.97,-361.17 12514.78,-348.35"/>
<polygon fill="black" stroke="black" points="12517.02,-351.04 12522.85,-342.19 12512.78,-345.47 12517.02,-351.04"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_25_gpu11 -->
<g id="edge777" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_25_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12472.47,-389.3C12481.13,-385.42 12490.65,-381.34 12499.57,-377.95 12546.42,-360.14 12562.19,-360.85 12612.35,-342.25"/>
<polygon fill="black" stroke="black" points="12613.66,-345.49 12621.77,-338.68 12611.18,-338.95 12613.66,-345.49"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_26_gpu11 -->
<g id="edge780" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_26_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12472.18,-388.43C12480.83,-384.53 12490.42,-380.67 12499.57,-377.95 12594.42,-349.75 12626.73,-370.03 12725.2,-342.03"/>
<polygon fill="black" stroke="black" points="12726.33,-345.35 12734.94,-339.17 12724.36,-338.63 12726.33,-345.35"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_27_gpu11 -->
<g id="edge783" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_27_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12471.8,-388.26C12480.52,-384.31 12490.25,-380.46 12499.57,-377.95 12643.14,-339.29 12690.92,-380.12 12838.14,-341.97"/>
<polygon fill="black" stroke="black" points="12839.23,-345.3 12847.99,-339.34 12837.42,-338.54 12839.23,-345.3"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_28_gpu11 -->
<g id="edge786" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_28_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12471.76,-388.1C12480.48,-384.15 12490.22,-380.34 12499.57,-377.95 12692.11,-328.79 12754.86,-389.89 12951.08,-341.97"/>
<polygon fill="black" stroke="black" points="12951.98,-345.35 12960.83,-339.53 12950.28,-338.56 12951.98,-345.35"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_29_gpu11 -->
<g id="edge789" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_29_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12395.14,-387.51C12360.41,-375.59 12312.26,-358.55 12270.57,-341.95 12270.47,-341.92 12270.38,-341.88 12270.28,-341.84"/>
<polygon fill="black" stroke="black" points="12271.78,-338.67 12261.2,-338.13 12269.13,-345.15 12271.78,-338.67"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_30_gpu11 -->
<g id="edge792" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_30_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12419.85,-386.26C12405.56,-375.46 12386.68,-361.17 12369.73,-348.35"/>
<polygon fill="black" stroke="black" points="12371.67,-345.43 12361.58,-342.19 12367.45,-351.01 12371.67,-345.43"/>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert_31_gpu11 -->
<g id="edge795" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert_31_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12442.57,-386.26C12442.57,-376.54 12442.57,-364 12442.57,-352.23"/>
<polygon fill="black" stroke="black" points="12446.07,-352.19 12442.57,-342.19 12439.07,-352.19 12446.07,-352.19"/>
</g>
<!-- l3_res2_gpu11 -->
<g id="node449" class="node">
<title>l3_res2_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="12667.57,-155.45 12557.57,-155.45 12557.57,-119.45 12667.57,-119.45 12667.57,-155.45"/>
<text text-anchor="middle" x="12612.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu11&#45;&gt;l3_res2_gpu11 -->
<g id="edge798" class="edge">
<title>l3_expert_agg_gpu11&#45;&gt;l3_res2_gpu11</title>
<path fill="none" stroke="black" d="M12612.57,-208.26C12612.57,-196.11 12612.57,-179.57 12612.57,-165.63"/>
<polygon fill="black" stroke="black" points="12616.07,-165.61 12612.57,-155.61 12609.07,-165.61 12616.07,-165.61"/>
</g>
<!-- l3_res2_gpu11&#45;&gt;output -->
<g id="edge800" class="edge">
<title>l3_res2_gpu11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12667.88,-130.1C12780.64,-117.15 13042.75,-87.04 13235.89,-64.86"/>
<polygon fill="black" stroke="black" points="13236.36,-68.33 13245.9,-63.71 13235.56,-61.37 13236.36,-68.33"/>
</g>
<!-- l3_mha_attn_gpu12 -->
<g id="node451" class="node">
<title>l3_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13510.07,-341.95 13415.07,-341.95 13415.07,-288.95 13510.07,-288.95 13510.07,-341.95"/>
<text text-anchor="middle" x="13462.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13462.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13462.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu12&#45;&gt;l3_mha_attn_gpu12 -->
<g id="edge834" class="edge">
<title>l3_mha_qkv_gpu12&#45;&gt;l3_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M13990.77,-402.59C13899.85,-399.92 13696.13,-389.01 13519.78,-341.61"/>
<polygon fill="black" stroke="black" points="13520.64,-338.22 13510.07,-338.96 13518.8,-344.97 13520.64,-338.22"/>
</g>
<!-- l3_res_add_gpu12 -->
<g id="node532" class="node">
<title>l3_res_add_gpu12</title>
<ellipse fill="none" stroke="black" cx="17646.57" cy="-404.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="17646.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu12</text>
</g>
<!-- l3_mha_qkv_gpu12&#45;&gt;l3_res_add_gpu12 -->
<g id="edge838" class="edge">
<title>l3_mha_qkv_gpu12&#45;&gt;l3_res_add_gpu12</title>
<path fill="none" stroke="black" d="M14056.05,-431.08C14067.69,-445.69 14084.5,-461.69 14104.57,-465.95 14127.85,-470.89 17508.29,-470.89 17531.57,-465.95 17562.07,-459.48 17593.04,-442.17 17615.14,-427.56"/>
<polygon fill="black" stroke="black" points="17617.14,-430.43 17623.45,-421.92 17613.21,-424.64 17617.14,-430.43"/>
</g>
<!-- l3_mha_out_gpu12 -->
<g id="node452" class="node">
<title>l3_mha_out_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13555.07,-252.95 13460.07,-252.95 13460.07,-199.95 13555.07,-199.95 13555.07,-252.95"/>
<text text-anchor="middle" x="13507.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13507.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13507.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu12&#45;&gt;l3_mha_out_gpu12 -->
<g id="edge835" class="edge">
<title>l3_mha_attn_gpu12&#45;&gt;l3_mha_out_gpu12</title>
<path fill="none" stroke="black" d="M13475.83,-288.82C13480.14,-280.49 13484.99,-271.1 13489.59,-262.21"/>
<polygon fill="black" stroke="black" points="13492.76,-263.69 13494.25,-253.2 13486.55,-260.48 13492.76,-263.69"/>
</g>
<!-- l3_mha_allreduce_gpu12 -->
<g id="node453" class="node">
<title>l3_mha_allreduce_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="13741.07,-163.95 13646.07,-163.95 13646.07,-110.95 13741.07,-110.95 13741.07,-163.95"/>
<text text-anchor="middle" x="13693.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="13693.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13693.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu12&#45;&gt;l3_mha_allreduce_gpu12 -->
<g id="edge836" class="edge">
<title>l3_mha_out_gpu12&#45;&gt;l3_mha_allreduce_gpu12</title>
<path fill="none" stroke="black" d="M13555.47,-203.05C13580.2,-191.48 13610.55,-177.28 13636.49,-165.15"/>
<polygon fill="black" stroke="black" points="13638.26,-168.19 13645.83,-160.78 13635.29,-161.85 13638.26,-168.19"/>
</g>
<!-- l3_mha_allreduce_gpu12&#45;&gt;l3_res_add_gpu12 -->
<g id="edge837" class="edge">
<title>l3_mha_allreduce_gpu12&#45;&gt;l3_res_add_gpu12</title>
<path fill="none" stroke="black" d="M13741.08,-147.04C13776.61,-153.04 13826.46,-160.56 13870.57,-163.95 14243.6,-192.69 16867.59,-144.38 17237.57,-199.95 17375.52,-220.67 17419.72,-215.91 17538.57,-288.95 17576.43,-312.22 17609.77,-352.13 17629.05,-378.15"/>
<polygon fill="black" stroke="black" points="17626.33,-380.36 17635.04,-386.4 17632,-376.25 17626.33,-380.36"/>
</g>
<!-- l3_mha_res_add_gpu12 -->
<g id="node454" class="node">
<title>l3_mha_res_add_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="12716.07,-430.95 12621.07,-430.95 12621.07,-377.95 12716.07,-377.95 12716.07,-430.95"/>
<text text-anchor="middle" x="12668.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="12668.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12668.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_32_gpu12 -->
<g id="node455" class="node">
<title>l3_expert_32_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14426.07,-341.95 14329.07,-341.95 14329.07,-288.95 14426.07,-288.95 14426.07,-341.95"/>
<text text-anchor="middle" x="14377.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 104</text>
<text text-anchor="middle" x="14377.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14377.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu12 -->
<g id="node464" class="node">
<title>l3_expert_agg_gpu12</title>
<polygon fill="yellow" stroke="black" points="14391.2,-244.45 14151.58,-244.45 14089.94,-208.45 14329.56,-208.45 14391.2,-244.45"/>
<text text-anchor="middle" x="14240.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_32_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge842" class="edge">
<title>l3_expert_32_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14337.21,-288.82C14317.85,-276.53 14294.88,-261.94 14276.18,-250.07"/>
<polygon fill="black" stroke="black" points="14277.97,-247.06 14267.66,-244.65 14274.22,-252.97 14277.97,-247.06"/>
</g>
<!-- l3_expert_33_gpu12 -->
<g id="node456" class="node">
<title>l3_expert_33_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14541.07,-341.95 14444.07,-341.95 14444.07,-288.95 14541.07,-288.95 14541.07,-341.95"/>
<text text-anchor="middle" x="14492.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 105</text>
<text text-anchor="middle" x="14492.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14492.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_33_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge845" class="edge">
<title>l3_expert_33_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14443.91,-292.24C14441.1,-291.1 14438.3,-289.99 14435.57,-288.95 14394.75,-273.45 14348.14,-258.64 14310.72,-247.45"/>
<polygon fill="black" stroke="black" points="14311.5,-244.03 14300.92,-244.53 14309.51,-250.74 14311.5,-244.03"/>
</g>
<!-- l3_expert_34_gpu12 -->
<g id="node457" class="node">
<title>l3_expert_34_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14656.07,-341.95 14559.07,-341.95 14559.07,-288.95 14656.07,-288.95 14656.07,-341.95"/>
<text text-anchor="middle" x="14607.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 106</text>
<text text-anchor="middle" x="14607.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14607.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_34_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge848" class="edge">
<title>l3_expert_34_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14559.03,-291.88C14556.19,-290.83 14553.36,-289.84 14550.57,-288.95 14492,-270.3 14425.33,-256.2 14368.86,-246.23"/>
<polygon fill="black" stroke="black" points="14369.26,-242.75 14358.8,-244.48 14368.06,-249.65 14369.26,-242.75"/>
</g>
<!-- l3_expert_35_gpu12 -->
<g id="node458" class="node">
<title>l3_expert_35_gpu12</title>
<polygon fill="lightpink" stroke="black" points="13851.07,-341.95 13754.07,-341.95 13754.07,-288.95 13851.07,-288.95 13851.07,-341.95"/>
<text text-anchor="middle" x="13802.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 107</text>
<text text-anchor="middle" x="13802.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13802.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_35_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge851" class="edge">
<title>l3_expert_35_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M13851.29,-291.99C13854.4,-290.88 13857.51,-289.86 13860.57,-288.95 13948.59,-262.94 14051.53,-247.14 14128.05,-238.08"/>
<polygon fill="black" stroke="black" points="14128.67,-241.53 14138.2,-236.9 14127.86,-234.58 14128.67,-241.53"/>
</g>
<!-- l3_expert_36_gpu12 -->
<g id="node459" class="node">
<title>l3_expert_36_gpu12</title>
<polygon fill="lightpink" stroke="black" points="13966.07,-341.95 13869.07,-341.95 13869.07,-288.95 13966.07,-288.95 13966.07,-341.95"/>
<text text-anchor="middle" x="13917.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 108</text>
<text text-anchor="middle" x="13917.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="13917.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_36_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge854" class="edge">
<title>l3_expert_36_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M13966.36,-292.24C13969.46,-291.07 13972.54,-289.96 13975.57,-288.95 14029.14,-271.13 14090.45,-256.55 14140.61,-246.06"/>
<polygon fill="black" stroke="black" points="14141.4,-249.47 14150.48,-244.02 14139.98,-242.61 14141.4,-249.47"/>
</g>
<!-- l3_expert_37_gpu12 -->
<g id="node460" class="node">
<title>l3_expert_37_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14081.07,-341.95 13984.07,-341.95 13984.07,-288.95 14081.07,-288.95 14081.07,-341.95"/>
<text text-anchor="middle" x="14032.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 109</text>
<text text-anchor="middle" x="14032.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14032.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_37_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge857" class="edge">
<title>l3_expert_37_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14081.26,-292.94C14084.41,-291.58 14087.53,-290.24 14090.57,-288.95 14123.04,-275.16 14159.67,-260.13 14188.6,-248.39"/>
<polygon fill="black" stroke="black" points="14190.15,-251.53 14198.1,-244.53 14187.52,-245.05 14190.15,-251.53"/>
</g>
<!-- l3_expert_38_gpu12 -->
<g id="node461" class="node">
<title>l3_expert_38_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14196.07,-341.95 14099.07,-341.95 14099.07,-288.95 14196.07,-288.95 14196.07,-341.95"/>
<text text-anchor="middle" x="14147.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 110</text>
<text text-anchor="middle" x="14147.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14147.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_38_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge860" class="edge">
<title>l3_expert_38_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14174.97,-288.82C14187.57,-277.03 14202.44,-263.13 14214.83,-251.53"/>
<polygon fill="black" stroke="black" points="14217.27,-254.04 14222.18,-244.65 14212.49,-248.93 14217.27,-254.04"/>
</g>
<!-- l3_expert_39_gpu12 -->
<g id="node462" class="node">
<title>l3_expert_39_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14311.07,-341.95 14214.07,-341.95 14214.07,-288.95 14311.07,-288.95 14311.07,-341.95"/>
<text text-anchor="middle" x="14262.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 111</text>
<text text-anchor="middle" x="14262.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14262.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_39_gpu12&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge863" class="edge">
<title>l3_expert_39_gpu12&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14256.09,-288.82C14253.36,-278.03 14250.18,-265.47 14247.42,-254.53"/>
<polygon fill="black" stroke="black" points="14250.76,-253.49 14244.92,-244.65 14243.98,-255.21 14250.76,-253.49"/>
</g>
<!-- l3_gate_gpu12 -->
<g id="node463" class="node">
<title>l3_gate_gpu12</title>
<polygon fill="lightcyan" stroke="black" points="14425.36,-422.45 14349.33,-422.45 14329.77,-386.45 14405.8,-386.45 14425.36,-422.45"/>
<text text-anchor="middle" x="14377.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_32_gpu12 -->
<g id="edge840" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_32_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14377.57,-386.26C14377.57,-376.54 14377.57,-364 14377.57,-352.23"/>
<polygon fill="black" stroke="black" points="14381.07,-352.19 14377.57,-342.19 14374.07,-352.19 14381.07,-352.19"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_33_gpu12 -->
<g id="edge843" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_33_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14400.29,-386.26C14414.58,-375.46 14433.45,-361.17 14450.41,-348.35"/>
<polygon fill="black" stroke="black" points="14452.69,-351.01 14458.55,-342.19 14448.47,-345.43 14452.69,-351.01"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_34_gpu12 -->
<g id="edge846" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_34_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14409.42,-392.97C14442.43,-381.93 14495.67,-363.6 14549.51,-342.28"/>
<polygon fill="black" stroke="black" points="14550.87,-345.51 14558.86,-338.55 14548.27,-339 14550.87,-345.51"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_35_gpu12 -->
<g id="edge849" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_35_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14345.1,-386.37C14337.56,-383.05 14329.43,-379.98 14321.57,-377.95 14125.78,-327.42 14061.95,-389.94 13861.18,-341.67"/>
<polygon fill="black" stroke="black" points="13861.75,-338.21 13851.21,-339.21 13860.08,-345.01 13861.75,-338.21"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_36_gpu12 -->
<g id="edge852" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_36_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14344.77,-386.39C14337.31,-383.11 14329.3,-380.06 14321.57,-377.95 14175.58,-338.26 14127.1,-379.68 13976.31,-341.74"/>
<polygon fill="black" stroke="black" points="13976.79,-338.24 13966.23,-339.12 13975.03,-345.02 13976.79,-338.24"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_37_gpu12 -->
<g id="edge855" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_37_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14344.08,-386.42C14336.8,-383.23 14329.04,-380.19 14321.57,-377.95 14225.04,-349.05 14192.28,-369.77 14090.97,-341.71"/>
<polygon fill="black" stroke="black" points="14091.86,-338.32 14081.28,-338.93 14089.93,-345.05 14091.86,-338.32"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_38_gpu12 -->
<g id="edge858" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_38_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14342,-386.45C14335.28,-383.46 14328.26,-380.5 14321.57,-377.95 14271.13,-358.73 14256.14,-360.85 14205.57,-341.95 14205.47,-341.92 14205.38,-341.88 14205.28,-341.84"/>
<polygon fill="black" stroke="black" points="14206.73,-338.65 14196.14,-338.28 14204.19,-345.18 14206.73,-338.65"/>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert_39_gpu12 -->
<g id="edge861" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert_39_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14354.85,-386.26C14340.56,-375.46 14321.68,-361.17 14304.73,-348.35"/>
<polygon fill="black" stroke="black" points="14306.67,-345.43 14296.58,-342.19 14302.45,-351.01 14306.67,-345.43"/>
</g>
<!-- l3_res2_gpu12 -->
<g id="node465" class="node">
<title>l3_res2_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="14295.57,-155.45 14185.57,-155.45 14185.57,-119.45 14295.57,-119.45 14295.57,-155.45"/>
<text text-anchor="middle" x="14240.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu12&#45;&gt;l3_res2_gpu12 -->
<g id="edge864" class="edge">
<title>l3_expert_agg_gpu12&#45;&gt;l3_res2_gpu12</title>
<path fill="none" stroke="black" d="M14240.57,-208.26C14240.57,-196.11 14240.57,-179.57 14240.57,-165.63"/>
<polygon fill="black" stroke="black" points="14244.07,-165.61 14240.57,-155.61 14237.07,-165.61 14244.07,-165.61"/>
</g>
<!-- l3_res2_gpu12&#45;&gt;output -->
<g id="edge866" class="edge">
<title>l3_res2_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14185.54,-126.73C14133.59,-117.74 14053.44,-104.4 13983.57,-94.95 13894.86,-82.96 13797.33,-71.8 13711.05,-62.62"/>
<polygon fill="black" stroke="black" points="13711.17,-59.12 13700.86,-61.54 13710.43,-66.08 13711.17,-59.12"/>
</g>
<!-- l3_mha_attn_gpu13 -->
<g id="node467" class="node">
<title>l3_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13623.07,-341.95 13528.07,-341.95 13528.07,-288.95 13623.07,-288.95 13623.07,-341.95"/>
<text text-anchor="middle" x="13575.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13575.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13575.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu13&#45;&gt;l3_mha_attn_gpu13 -->
<g id="edge900" class="edge">
<title>l3_mha_qkv_gpu13&#45;&gt;l3_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M14217.02,-380.42C14214.2,-379.49 14211.37,-378.65 14208.57,-377.95 13962.88,-316.56 13883.63,-401.11 13633.09,-341.64"/>
<polygon fill="black" stroke="black" points="13633.88,-338.23 13623.34,-339.27 13632.23,-345.03 13633.88,-338.23"/>
</g>
<!-- l3_res_add_gpu13 -->
<g id="node534" class="node">
<title>l3_res_add_gpu13</title>
<ellipse fill="none" stroke="black" cx="17851.57" cy="-404.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="17851.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu13</text>
</g>
<!-- l3_mha_qkv_gpu13&#45;&gt;l3_res_add_gpu13 -->
<g id="edge904" class="edge">
<title>l3_mha_qkv_gpu13&#45;&gt;l3_res_add_gpu13</title>
<path fill="none" stroke="black" d="M14281.69,-431.1C14293.11,-445.72 14309.66,-461.73 14329.57,-465.95 14352.74,-470.87 17717.4,-470.87 17740.57,-465.95 17770.12,-459.68 17799.85,-442.49 17821.1,-427.87"/>
<polygon fill="black" stroke="black" points="17823.24,-430.64 17829.38,-422.01 17819.2,-424.93 17823.24,-430.64"/>
</g>
<!-- l3_mha_out_gpu13 -->
<g id="node468" class="node">
<title>l3_mha_out_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13847.07,-252.95 13752.07,-252.95 13752.07,-199.95 13847.07,-199.95 13847.07,-252.95"/>
<text text-anchor="middle" x="13799.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13799.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13799.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu13&#45;&gt;l3_mha_out_gpu13 -->
<g id="edge901" class="edge">
<title>l3_mha_attn_gpu13&#45;&gt;l3_mha_out_gpu13</title>
<path fill="none" stroke="black" d="M13623.36,-292.79C13626.47,-291.47 13629.56,-290.18 13632.57,-288.95 13668.61,-274.27 13709.62,-259.15 13741.98,-247.57"/>
<polygon fill="black" stroke="black" points="13743.48,-250.75 13751.73,-244.1 13741.13,-244.16 13743.48,-250.75"/>
</g>
<!-- l3_mha_allreduce_gpu13 -->
<g id="node469" class="node">
<title>l3_mha_allreduce_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="13974.07,-163.95 13879.07,-163.95 13879.07,-110.95 13974.07,-110.95 13974.07,-163.95"/>
<text text-anchor="middle" x="13926.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="13926.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13926.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu13&#45;&gt;l3_mha_allreduce_gpu13 -->
<g id="edge902" class="edge">
<title>l3_mha_out_gpu13&#45;&gt;l3_mha_allreduce_gpu13</title>
<path fill="none" stroke="black" d="M13836.99,-199.82C13850.69,-190.44 13866.35,-179.71 13880.7,-169.87"/>
<polygon fill="black" stroke="black" points="13882.71,-172.74 13888.98,-164.2 13878.75,-166.97 13882.71,-172.74"/>
</g>
<!-- l3_mha_allreduce_gpu13&#45;&gt;l3_res_add_gpu13 -->
<g id="edge903" class="edge">
<title>l3_mha_allreduce_gpu13&#45;&gt;l3_res_add_gpu13</title>
<path fill="none" stroke="black" d="M13974.39,-144.64C14024.63,-150.83 14106,-159.99 14176.57,-163.95 14270.9,-169.25 17488.03,-169.81 17577.57,-199.95 17591.74,-204.72 17753.93,-328.51 17821.9,-380.64"/>
<polygon fill="black" stroke="black" points="17820.02,-383.61 17830.08,-386.92 17824.28,-378.06 17820.02,-383.61"/>
</g>
<!-- l3_mha_res_add_gpu13 -->
<g id="node470" class="node">
<title>l3_mha_res_add_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="12036.07,-430.95 11941.07,-430.95 11941.07,-377.95 12036.07,-377.95 12036.07,-430.95"/>
<text text-anchor="middle" x="11988.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="11988.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11988.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_40_gpu13 -->
<g id="node471" class="node">
<title>l3_expert_40_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15114.07,-341.95 15017.07,-341.95 15017.07,-288.95 15114.07,-288.95 15114.07,-341.95"/>
<text text-anchor="middle" x="15065.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 112</text>
<text text-anchor="middle" x="15065.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15065.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu13 -->
<g id="node480" class="node">
<title>l3_expert_agg_gpu13</title>
<polygon fill="yellow" stroke="black" points="15388.2,-244.45 15148.58,-244.45 15086.94,-208.45 15326.56,-208.45 15388.2,-244.45"/>
<text text-anchor="middle" x="15237.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_40_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge908" class="edge">
<title>l3_expert_40_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15114.4,-289.76C15139.76,-276.93 15170.46,-261.4 15194.87,-249.05"/>
<polygon fill="black" stroke="black" points="15196.55,-252.12 15203.89,-244.49 15193.39,-245.88 15196.55,-252.12"/>
</g>
<!-- l3_expert_41_gpu13 -->
<g id="node472" class="node">
<title>l3_expert_41_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15229.07,-341.95 15132.07,-341.95 15132.07,-288.95 15229.07,-288.95 15229.07,-341.95"/>
<text text-anchor="middle" x="15180.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 113</text>
<text text-anchor="middle" x="15180.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15180.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_41_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge911" class="edge">
<title>l3_expert_41_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15197.36,-288.82C15204.72,-277.59 15213.34,-264.43 15220.71,-253.19"/>
<polygon fill="black" stroke="black" points="15223.75,-254.94 15226.3,-244.65 15217.89,-251.1 15223.75,-254.94"/>
</g>
<!-- l3_expert_42_gpu13 -->
<g id="node473" class="node">
<title>l3_expert_42_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15344.07,-341.95 15247.07,-341.95 15247.07,-288.95 15344.07,-288.95 15344.07,-341.95"/>
<text text-anchor="middle" x="15295.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 114</text>
<text text-anchor="middle" x="15295.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15295.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_42_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge914" class="edge">
<title>l3_expert_42_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15278.48,-288.82C15270.99,-277.59 15262.22,-264.43 15254.73,-253.19"/>
<polygon fill="black" stroke="black" points="15257.5,-251.03 15249.04,-244.65 15251.67,-254.92 15257.5,-251.03"/>
</g>
<!-- l3_expert_43_gpu13 -->
<g id="node474" class="node">
<title>l3_expert_43_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15459.07,-341.95 15362.07,-341.95 15362.07,-288.95 15459.07,-288.95 15459.07,-341.95"/>
<text text-anchor="middle" x="15410.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 115</text>
<text text-anchor="middle" x="15410.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15410.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_43_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge917" class="edge">
<title>l3_expert_43_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15361.92,-289.99C15336.4,-277.15 15305.4,-261.56 15280.74,-249.16"/>
<polygon fill="black" stroke="black" points="15282.13,-245.94 15271.62,-244.58 15278.98,-252.2 15282.13,-245.94"/>
</g>
<!-- l3_expert_44_gpu13 -->
<g id="node475" class="node">
<title>l3_expert_44_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15574.07,-341.95 15477.07,-341.95 15477.07,-288.95 15574.07,-288.95 15574.07,-341.95"/>
<text text-anchor="middle" x="15525.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 116</text>
<text text-anchor="middle" x="15525.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15525.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_44_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge920" class="edge">
<title>l3_expert_44_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15476.96,-292.09C15474.14,-290.99 15471.33,-289.93 15468.57,-288.95 15421.38,-272.24 15367.37,-257.62 15323.45,-246.84"/>
<polygon fill="black" stroke="black" points="15324.21,-243.42 15313.67,-244.45 15322.55,-250.22 15324.21,-243.42"/>
</g>
<!-- l3_expert_45_gpu13 -->
<g id="node476" class="node">
<title>l3_expert_45_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15689.07,-341.95 15592.07,-341.95 15592.07,-288.95 15689.07,-288.95 15689.07,-341.95"/>
<text text-anchor="middle" x="15640.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 117</text>
<text text-anchor="middle" x="15640.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15640.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_45_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge923" class="edge">
<title>l3_expert_45_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15592.05,-291.81C15589.21,-290.78 15586.37,-289.81 15583.57,-288.95 15520.87,-269.68 15449.81,-255.74 15388.46,-246.07"/>
<polygon fill="black" stroke="black" points="15388.73,-242.57 15378.31,-244.49 15387.66,-249.48 15388.73,-242.57"/>
</g>
<!-- l3_expert_46_gpu13 -->
<g id="node477" class="node">
<title>l3_expert_46_gpu13</title>
<polygon fill="lightpink" stroke="black" points="14884.07,-341.95 14787.07,-341.95 14787.07,-288.95 14884.07,-288.95 14884.07,-341.95"/>
<text text-anchor="middle" x="14835.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 118</text>
<text text-anchor="middle" x="14835.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14835.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_46_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge926" class="edge">
<title>l3_expert_46_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M14884.31,-292.05C14887.41,-290.93 14890.52,-289.88 14893.57,-288.95 14970.6,-265.5 15060.22,-249.83 15128.67,-240.19"/>
<polygon fill="black" stroke="black" points="15129.19,-243.65 15138.61,-238.81 15128.23,-236.71 15129.19,-243.65"/>
</g>
<!-- l3_expert_47_gpu13 -->
<g id="node478" class="node">
<title>l3_expert_47_gpu13</title>
<polygon fill="lightpink" stroke="black" points="14999.07,-341.95 14902.07,-341.95 14902.07,-288.95 14999.07,-288.95 14999.07,-341.95"/>
<text text-anchor="middle" x="14950.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 119</text>
<text text-anchor="middle" x="14950.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14950.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_47_gpu13&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge929" class="edge">
<title>l3_expert_47_gpu13&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M14999.09,-292.48C15002.28,-291.24 15005.46,-290.05 15008.57,-288.95 15055.59,-272.41 15109.37,-257.76 15152.98,-246.91"/>
<polygon fill="black" stroke="black" points="15153.83,-250.3 15162.7,-244.51 15152.15,-243.51 15153.83,-250.3"/>
</g>
<!-- l3_gate_gpu13 -->
<g id="node479" class="node">
<title>l3_gate_gpu13</title>
<polygon fill="lightcyan" stroke="black" points="15400.36,-422.45 15324.33,-422.45 15304.77,-386.45 15380.8,-386.45 15400.36,-422.45"/>
<text text-anchor="middle" x="15352.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_40_gpu13 -->
<g id="edge906" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_40_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15318.4,-386.45C15311.29,-383.32 15303.78,-380.31 15296.57,-377.95 15224.84,-354.48 15200.29,-364.98 15123.92,-341.76"/>
<polygon fill="black" stroke="black" points="15124.93,-338.41 15114.34,-338.75 15122.83,-345.08 15124.93,-338.41"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_41_gpu13 -->
<g id="edge909" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_41_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15318.59,-386.26C15295.73,-374.7 15265.02,-359.17 15238.37,-345.69"/>
<polygon fill="black" stroke="black" points="15239.64,-342.41 15229.13,-341.02 15236.48,-348.65 15239.64,-342.41"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_42_gpu13 -->
<g id="edge912" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_42_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15341.31,-386.26C15334.68,-376.14 15326.05,-362.98 15318.08,-350.81"/>
<polygon fill="black" stroke="black" points="15320.84,-348.63 15312.43,-342.19 15314.98,-352.47 15320.84,-348.63"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_43_gpu13 -->
<g id="edge915" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_43_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15364.03,-386.26C15370.78,-376.14 15379.55,-362.98 15387.66,-350.81"/>
<polygon fill="black" stroke="black" points="15390.78,-352.45 15393.41,-342.19 15384.95,-348.57 15390.78,-352.45"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_44_gpu13 -->
<g id="edge918" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_44_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15382.31,-388.5C15405.76,-376.7 15439.17,-359.9 15467.83,-345.49"/>
<polygon fill="black" stroke="black" points="15469.59,-348.52 15476.95,-340.9 15466.44,-342.27 15469.59,-348.52"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_45_gpu13 -->
<g id="edge921" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_45_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15386.36,-396.25C15429.96,-386.57 15508.16,-367.89 15582.45,-342.16"/>
<polygon fill="black" stroke="black" points="15583.69,-345.43 15591.96,-338.82 15581.37,-338.83 15583.69,-345.43"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_46_gpu13 -->
<g id="edge924" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_46_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15320.09,-386.44C15312.54,-383.12 15304.42,-380.03 15296.57,-377.95 15125.85,-332.87 15069.75,-384.79 14894.04,-341.65"/>
<polygon fill="black" stroke="black" points="14894.77,-338.23 14884.22,-339.17 14893.06,-345.01 14894.77,-338.23"/>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert_47_gpu13 -->
<g id="edge927" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert_47_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15319.43,-386.38C15312.06,-383.15 15304.17,-380.11 15296.57,-377.95 15175.6,-343.71 15134.98,-374.62 15009.25,-341.75"/>
<polygon fill="black" stroke="black" points="15009.82,-338.27 14999.25,-339.04 15007.99,-345.03 15009.82,-338.27"/>
</g>
<!-- l3_res2_gpu13 -->
<g id="node481" class="node">
<title>l3_res2_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="15292.57,-155.45 15182.57,-155.45 15182.57,-119.45 15292.57,-119.45 15292.57,-155.45"/>
<text text-anchor="middle" x="15237.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu13&#45;&gt;l3_res2_gpu13 -->
<g id="edge930" class="edge">
<title>l3_expert_agg_gpu13&#45;&gt;l3_res2_gpu13</title>
<path fill="none" stroke="black" d="M15237.57,-208.26C15237.57,-196.11 15237.57,-179.57 15237.57,-165.63"/>
<polygon fill="black" stroke="black" points="15241.07,-165.61 15237.57,-155.61 15234.07,-165.61 15241.07,-165.61"/>
</g>
<!-- l3_res2_gpu13&#45;&gt;output -->
<g id="edge932" class="edge">
<title>l3_res2_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15182.39,-129.67C15105.01,-120.4 14959.78,-103.92 14835.57,-94.95 14472.19,-68.73 14053.64,-53.68 13775.77,-45.81"/>
<polygon fill="black" stroke="black" points="13775.62,-42.3 13765.53,-45.52 13775.43,-49.3 13775.62,-42.3"/>
</g>
<!-- l3_mha_attn_gpu14 -->
<g id="node483" class="node">
<title>l3_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="13736.07,-341.95 13641.07,-341.95 13641.07,-288.95 13736.07,-288.95 13736.07,-341.95"/>
<text text-anchor="middle" x="13688.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="13688.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13688.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu14&#45;&gt;l3_mha_attn_gpu14 -->
<g id="edge966" class="edge">
<title>l3_mha_qkv_gpu14&#45;&gt;l3_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M15191.89,-399.29C15125.36,-393.62 15000.88,-383.54 14894.57,-377.95 14642.7,-364.71 14010.84,-398.32 13746.33,-341.62"/>
<polygon fill="black" stroke="black" points="13746.83,-338.14 13736.31,-339.38 13745.31,-344.98 13746.83,-338.14"/>
</g>
<!-- l3_res_add_gpu14 -->
<g id="node536" class="node">
<title>l3_res_add_gpu14</title>
<ellipse fill="none" stroke="black" cx="18056.57" cy="-404.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="18056.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu14</text>
</g>
<!-- l3_mha_qkv_gpu14&#45;&gt;l3_res_add_gpu14 -->
<g id="edge970" class="edge">
<title>l3_mha_qkv_gpu14&#45;&gt;l3_res_add_gpu14</title>
<path fill="none" stroke="black" d="M15256.69,-431.1C15268.11,-445.72 15284.66,-461.73 15304.57,-465.95 15322.51,-469.76 17927.63,-469.76 17945.57,-465.95 17975.12,-459.68 18004.85,-442.49 18026.1,-427.87"/>
<polygon fill="black" stroke="black" points="18028.24,-430.64 18034.38,-422.01 18024.2,-424.93 18028.24,-430.64"/>
</g>
<!-- l3_mha_out_gpu14 -->
<g id="node484" class="node">
<title>l3_mha_out_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="13983.07,-252.95 13888.07,-252.95 13888.07,-199.95 13983.07,-199.95 13983.07,-252.95"/>
<text text-anchor="middle" x="13935.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="13935.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13935.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu14&#45;&gt;l3_mha_out_gpu14 -->
<g id="edge967" class="edge">
<title>l3_mha_attn_gpu14&#45;&gt;l3_mha_out_gpu14</title>
<path fill="none" stroke="black" d="M13736.31,-292.65C13739.43,-291.36 13742.53,-290.12 13745.57,-288.95 13747.2,-288.32 13822.66,-263.93 13877.97,-246.06"/>
<polygon fill="black" stroke="black" points="13879.26,-249.32 13887.7,-242.91 13877.11,-242.66 13879.26,-249.32"/>
</g>
<!-- l3_mha_allreduce_gpu14 -->
<g id="node485" class="node">
<title>l3_mha_allreduce_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="14826.07,-163.95 14731.07,-163.95 14731.07,-110.95 14826.07,-110.95 14826.07,-163.95"/>
<text text-anchor="middle" x="14778.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="14778.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14778.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu14&#45;&gt;l3_mha_allreduce_gpu14 -->
<g id="edge968" class="edge">
<title>l3_mha_out_gpu14&#45;&gt;l3_mha_allreduce_gpu14</title>
<path fill="none" stroke="black" d="M13983.08,-216.03C14011.32,-210.7 14047.88,-204.26 14080.57,-199.95 14317.3,-168.77 14601.34,-149.25 14720.98,-141.84"/>
<polygon fill="black" stroke="black" points="14721.25,-145.33 14731.02,-141.22 14720.82,-138.34 14721.25,-145.33"/>
</g>
<!-- l3_mha_allreduce_gpu14&#45;&gt;l3_res_add_gpu14 -->
<g id="edge969" class="edge">
<title>l3_mha_allreduce_gpu14&#45;&gt;l3_res_add_gpu14</title>
<path fill="none" stroke="black" d="M14826.26,-142.3C14900.46,-148.12 15048.08,-159 15173.57,-163.95 15311.53,-169.4 17524.57,-166.66 17658.57,-199.95 17734.34,-218.78 17936.86,-333.72 18020.09,-382.06"/>
<polygon fill="black" stroke="black" points="18018.53,-385.21 18028.93,-387.21 18022.05,-379.16 18018.53,-385.21"/>
</g>
<!-- l3_mha_res_add_gpu14 -->
<g id="node486" class="node">
<title>l3_mha_res_add_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="11129.07,-430.95 11034.07,-430.95 11034.07,-377.95 11129.07,-377.95 11129.07,-430.95"/>
<text text-anchor="middle" x="11081.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="11081.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11081.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_48_gpu14 -->
<g id="node487" class="node">
<title>l3_expert_48_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16609.07,-341.95 16512.07,-341.95 16512.07,-288.95 16609.07,-288.95 16609.07,-341.95"/>
<text text-anchor="middle" x="16560.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 120</text>
<text text-anchor="middle" x="16560.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16560.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu14 -->
<g id="node496" class="node">
<title>l3_expert_agg_gpu14</title>
<polygon fill="yellow" stroke="black" points="16309.2,-244.45 16069.58,-244.45 16007.94,-208.45 16247.56,-208.45 16309.2,-244.45"/>
<text text-anchor="middle" x="16158.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_48_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge974" class="edge">
<title>l3_expert_48_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16512.05,-291.81C16509.21,-290.78 16506.37,-289.81 16503.57,-288.95 16440.91,-269.67 16369.88,-255.73 16308.62,-246.04"/>
<polygon fill="black" stroke="black" points="16308.91,-242.54 16298.49,-244.46 16307.83,-249.46 16308.91,-242.54"/>
</g>
<!-- l3_expert_49_gpu14 -->
<g id="node488" class="node">
<title>l3_expert_49_gpu14</title>
<polygon fill="lightpink" stroke="black" points="15804.07,-341.95 15707.07,-341.95 15707.07,-288.95 15804.07,-288.95 15804.07,-341.95"/>
<text text-anchor="middle" x="15755.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 121</text>
<text text-anchor="middle" x="15755.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15755.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_49_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge977" class="edge">
<title>l3_expert_49_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M15804.31,-292.05C15807.41,-290.93 15810.52,-289.88 15813.57,-288.95 15890.96,-265.41 15981.03,-249.73 16049.72,-240.1"/>
<polygon fill="black" stroke="black" points="16050.27,-243.56 16059.7,-238.72 16049.32,-236.62 16050.27,-243.56"/>
</g>
<!-- l3_expert_50_gpu14 -->
<g id="node489" class="node">
<title>l3_expert_50_gpu14</title>
<polygon fill="lightpink" stroke="black" points="15919.07,-341.95 15822.07,-341.95 15822.07,-288.95 15919.07,-288.95 15919.07,-341.95"/>
<text text-anchor="middle" x="15870.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 122</text>
<text text-anchor="middle" x="15870.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15870.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_50_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge980" class="edge">
<title>l3_expert_50_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M15919.09,-292.48C15922.27,-291.23 15925.46,-290.05 15928.57,-288.95 15975.79,-272.37 16029.8,-257.71 16073.61,-246.87"/>
<polygon fill="black" stroke="black" points="16074.49,-250.26 16083.37,-244.48 16072.82,-243.46 16074.49,-250.26"/>
</g>
<!-- l3_expert_51_gpu14 -->
<g id="node490" class="node">
<title>l3_expert_51_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16034.07,-341.95 15937.07,-341.95 15937.07,-288.95 16034.07,-288.95 16034.07,-341.95"/>
<text text-anchor="middle" x="15985.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 123</text>
<text text-anchor="middle" x="15985.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15985.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_51_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge983" class="edge">
<title>l3_expert_51_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16034.22,-289.99C16059.74,-277.15 16090.74,-261.56 16115.4,-249.16"/>
<polygon fill="black" stroke="black" points="16117.16,-252.2 16124.52,-244.58 16114.01,-245.94 16117.16,-252.2"/>
</g>
<!-- l3_expert_52_gpu14 -->
<g id="node491" class="node">
<title>l3_expert_52_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16149.07,-341.95 16052.07,-341.95 16052.07,-288.95 16149.07,-288.95 16149.07,-341.95"/>
<text text-anchor="middle" x="16100.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 124</text>
<text text-anchor="middle" x="16100.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16100.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_52_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge986" class="edge">
<title>l3_expert_52_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16117.66,-288.82C16125.14,-277.59 16133.92,-264.43 16141.41,-253.19"/>
<polygon fill="black" stroke="black" points="16144.47,-254.92 16147.1,-244.65 16138.64,-251.03 16144.47,-254.92"/>
</g>
<!-- l3_expert_53_gpu14 -->
<g id="node492" class="node">
<title>l3_expert_53_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16264.07,-341.95 16167.07,-341.95 16167.07,-288.95 16264.07,-288.95 16264.07,-341.95"/>
<text text-anchor="middle" x="16215.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 125</text>
<text text-anchor="middle" x="16215.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16215.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_53_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge989" class="edge">
<title>l3_expert_53_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16198.77,-288.82C16191.42,-277.59 16182.8,-264.43 16175.43,-253.19"/>
<polygon fill="black" stroke="black" points="16178.25,-251.1 16169.84,-244.65 16172.39,-254.94 16178.25,-251.1"/>
</g>
<!-- l3_expert_54_gpu14 -->
<g id="node493" class="node">
<title>l3_expert_54_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16379.07,-341.95 16282.07,-341.95 16282.07,-288.95 16379.07,-288.95 16379.07,-341.95"/>
<text text-anchor="middle" x="16330.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 126</text>
<text text-anchor="middle" x="16330.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16330.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_54_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge992" class="edge">
<title>l3_expert_54_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16281.74,-289.76C16256.38,-276.93 16225.67,-261.4 16201.26,-249.05"/>
<polygon fill="black" stroke="black" points="16202.75,-245.88 16192.24,-244.49 16199.59,-252.12 16202.75,-245.88"/>
</g>
<!-- l3_expert_55_gpu14 -->
<g id="node494" class="node">
<title>l3_expert_55_gpu14</title>
<polygon fill="lightpink" stroke="black" points="16494.07,-341.95 16397.07,-341.95 16397.07,-288.95 16494.07,-288.95 16494.07,-341.95"/>
<text text-anchor="middle" x="16445.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 127</text>
<text text-anchor="middle" x="16445.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16445.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_55_gpu14&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge995" class="edge">
<title>l3_expert_55_gpu14&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16396.96,-292.09C16394.14,-290.99 16391.33,-289.93 16388.57,-288.95 16341.58,-272.28 16287.81,-257.67 16244.08,-246.87"/>
<polygon fill="black" stroke="black" points="16244.88,-243.46 16234.33,-244.49 16243.21,-250.26 16244.88,-243.46"/>
</g>
<!-- l3_gate_gpu14 -->
<g id="node495" class="node">
<title>l3_gate_gpu14</title>
<polygon fill="lightcyan" stroke="black" points="16321.36,-422.45 16245.33,-422.45 16225.77,-386.45 16301.8,-386.45 16321.36,-422.45"/>
<text text-anchor="middle" x="16273.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_48_gpu14 -->
<g id="edge972" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_48_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16307.21,-396.23C16350.62,-386.53 16428.48,-367.83 16502.49,-342.15"/>
<polygon fill="black" stroke="black" points="16503.69,-345.43 16511.96,-338.81 16501.36,-338.83 16503.69,-345.43"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_49_gpu14 -->
<g id="edge975" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_49_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16241.09,-386.43C16233.54,-383.11 16225.42,-380.03 16217.57,-377.95 16046.42,-332.77 15990.19,-384.87 15814.06,-341.66"/>
<polygon fill="black" stroke="black" points="15814.77,-338.23 15804.22,-339.17 15813.06,-345.01 15814.77,-338.23"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_50_gpu14 -->
<g id="edge978" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_50_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16240.44,-386.38C16233.06,-383.14 16225.18,-380.1 16217.57,-377.95 16096.06,-343.59 16055.34,-374.76 15928.91,-341.65"/>
<polygon fill="black" stroke="black" points="15929.82,-338.27 15919.25,-339.05 15927.99,-345.03 15929.82,-338.27"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_51_gpu14 -->
<g id="edge981" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_51_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16239.4,-386.44C16232.3,-383.32 16224.78,-380.31 16217.57,-377.95 16145.43,-354.39 16120.73,-365.05 16043.96,-341.77"/>
<polygon fill="black" stroke="black" points="16044.93,-338.4 16034.34,-338.76 16042.83,-345.08 16044.93,-338.4"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_52_gpu14 -->
<g id="edge984" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_52_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16239.39,-386.26C16216.21,-374.61 16185,-358.91 16158.05,-345.36"/>
<polygon fill="black" stroke="black" points="16159.59,-342.22 16149.09,-340.85 16156.45,-348.47 16159.59,-342.22"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_53_gpu14 -->
<g id="edge987" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_53_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16262.11,-386.26C16255.36,-376.14 16246.58,-362.98 16238.47,-350.81"/>
<polygon fill="black" stroke="black" points="16241.18,-348.57 16232.72,-342.19 16235.36,-352.45 16241.18,-348.57"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_54_gpu14 -->
<g id="edge990" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_54_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16284.83,-386.26C16291.46,-376.14 16300.09,-362.98 16308.06,-350.81"/>
<polygon fill="black" stroke="black" points="16311.16,-352.47 16313.71,-342.19 16305.3,-348.63 16311.16,-352.47"/>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert_55_gpu14 -->
<g id="edge993" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert_55_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16303.14,-388.5C16326.36,-376.75 16359.42,-360.03 16387.85,-345.65"/>
<polygon fill="black" stroke="black" points="16389.55,-348.71 16396.89,-341.07 16386.39,-342.46 16389.55,-348.71"/>
</g>
<!-- l3_res2_gpu14 -->
<g id="node497" class="node">
<title>l3_res2_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16213.57,-155.45 16103.57,-155.45 16103.57,-119.45 16213.57,-119.45 16213.57,-155.45"/>
<text text-anchor="middle" x="16158.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu14&#45;&gt;l3_res2_gpu14 -->
<g id="edge996" class="edge">
<title>l3_expert_agg_gpu14&#45;&gt;l3_res2_gpu14</title>
<path fill="none" stroke="black" d="M16158.57,-208.26C16158.57,-196.11 16158.57,-179.57 16158.57,-165.63"/>
<polygon fill="black" stroke="black" points="16162.07,-165.61 16158.57,-155.61 16155.07,-165.61 16162.07,-165.61"/>
</g>
<!-- l3_res2_gpu14&#45;&gt;output -->
<g id="edge998" class="edge">
<title>l3_res2_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M16103.44,-133.45C15967.34,-126.1 15604.46,-106.94 15301.57,-94.95 14764.89,-73.71 14139.69,-55.97 13774.74,-46.32"/>
<polygon fill="black" stroke="black" points="13774.64,-42.82 13764.55,-46.05 13774.46,-49.82 13774.64,-42.82"/>
</g>
<!-- l3_mha_attn_gpu15 -->
<g id="node499" class="node">
<title>l3_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="14769.07,-341.95 14674.07,-341.95 14674.07,-288.95 14769.07,-288.95 14769.07,-341.95"/>
<text text-anchor="middle" x="14721.57" y="-326.75" font-family="Times,serif" font-size="14.00">Attn</text>
<text text-anchor="middle" x="14721.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14721.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_qkv_gpu15&#45;&gt;l3_mha_attn_gpu15 -->
<g id="edge1032" class="edge">
<title>l3_mha_qkv_gpu15&#45;&gt;l3_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M16113.01,-400.05C16037.51,-394.73 15885.54,-384.4 15756.57,-377.95 15542.54,-367.26 15006.4,-390.56 14779.24,-341.6"/>
<polygon fill="black" stroke="black" points="14779.84,-338.14 14769.32,-339.36 14778.31,-344.97 14779.84,-338.14"/>
</g>
<!-- l3_res_add_gpu15 -->
<g id="node538" class="node">
<title>l3_res_add_gpu15</title>
<ellipse fill="none" stroke="black" cx="18261.57" cy="-404.45" rx="93.68" ry="18"/>
<text text-anchor="middle" x="18261.57" y="-400.75" font-family="Times,serif" font-size="14.00">l3_res_add_gpu15</text>
</g>
<!-- l3_mha_qkv_gpu15&#45;&gt;l3_res_add_gpu15 -->
<g id="edge1036" class="edge">
<title>l3_mha_qkv_gpu15&#45;&gt;l3_res_add_gpu15</title>
<path fill="none" stroke="black" d="M16177.69,-431.1C16189.11,-445.72 16205.66,-461.73 16225.57,-465.95 16238.65,-468.73 18137.49,-468.73 18150.57,-465.95 18180.12,-459.68 18209.85,-442.49 18231.1,-427.87"/>
<polygon fill="black" stroke="black" points="18233.24,-430.64 18239.38,-422.01 18229.2,-424.93 18233.24,-430.64"/>
</g>
<!-- l3_mha_out_gpu15 -->
<g id="node500" class="node">
<title>l3_mha_out_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="14948.07,-252.95 14853.07,-252.95 14853.07,-199.95 14948.07,-199.95 14948.07,-252.95"/>
<text text-anchor="middle" x="14900.57" y="-237.75" font-family="Times,serif" font-size="14.00">Out</text>
<text text-anchor="middle" x="14900.57" y="-222.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14900.57" y="-207.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_attn_gpu15&#45;&gt;l3_mha_out_gpu15 -->
<g id="edge1033" class="edge">
<title>l3_mha_attn_gpu15&#45;&gt;l3_mha_out_gpu15</title>
<path fill="none" stroke="black" d="M14769.54,-291.14C14792.3,-280.07 14819.67,-266.77 14843.5,-255.19"/>
<polygon fill="black" stroke="black" points="14845.31,-258.2 14852.78,-250.68 14842.25,-251.9 14845.31,-258.2"/>
</g>
<!-- l3_mha_allreduce_gpu15 -->
<g id="node501" class="node">
<title>l3_mha_allreduce_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="16723.07,-163.95 16628.07,-163.95 16628.07,-110.95 16723.07,-110.95 16723.07,-163.95"/>
<text text-anchor="middle" x="16675.57" y="-148.75" font-family="Times,serif" font-size="14.00">Allreduce</text>
<text text-anchor="middle" x="16675.57" y="-133.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16675.57" y="-118.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_mha_out_gpu15&#45;&gt;l3_mha_allreduce_gpu15 -->
<g id="edge1034" class="edge">
<title>l3_mha_out_gpu15&#45;&gt;l3_mha_allreduce_gpu15</title>
<path fill="none" stroke="black" d="M14948.1,-217.13C14983.65,-211.27 15033.5,-203.81 15077.57,-199.95 15584.77,-155.58 15713.92,-186.26 16222.57,-163.95 16364.74,-157.72 16531.84,-147.58 16617.89,-142.16"/>
<polygon fill="black" stroke="black" points="16618.22,-145.65 16627.98,-141.52 16617.78,-138.66 16618.22,-145.65"/>
</g>
<!-- l3_mha_allreduce_gpu15&#45;&gt;l3_res_add_gpu15 -->
<g id="edge1035" class="edge">
<title>l3_mha_allreduce_gpu15&#45;&gt;l3_res_add_gpu15</title>
<path fill="none" stroke="black" d="M16723.11,-142.62C16788.49,-148.21 16909.87,-158.13 17013.57,-163.95 17121.69,-170.03 17885.4,-164.05 17987.57,-199.95 18095.38,-237.83 18196.24,-334.12 18239.45,-379.32"/>
<polygon fill="black" stroke="black" points="18236.95,-381.77 18246.36,-386.64 18242.04,-376.96 18236.95,-381.77"/>
</g>
<!-- l3_mha_res_add_gpu15 -->
<g id="node502" class="node">
<title>l3_mha_res_add_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="10225.07,-430.95 10130.07,-430.95 10130.07,-377.95 10225.07,-377.95 10225.07,-430.95"/>
<text text-anchor="middle" x="10177.57" y="-415.75" font-family="Times,serif" font-size="14.00">Res Add</text>
<text text-anchor="middle" x="10177.57" y="-400.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="10177.57" y="-385.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_56_gpu15 -->
<g id="node503" class="node">
<title>l3_expert_56_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17299.07,-341.95 17202.07,-341.95 17202.07,-288.95 17299.07,-288.95 17299.07,-341.95"/>
<text text-anchor="middle" x="17250.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 128</text>
<text text-anchor="middle" x="17250.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17250.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_agg_gpu15 -->
<g id="node512" class="node">
<title>l3_expert_agg_gpu15</title>
<polygon fill="yellow" stroke="black" points="17228.2,-244.45 16988.58,-244.45 16926.94,-208.45 17166.56,-208.45 17228.2,-244.45"/>
<text text-anchor="middle" x="17077.57" y="-222.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
</g>
<!-- l3_expert_56_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1040" class="edge">
<title>l3_expert_56_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17201.92,-289.99C17176.4,-277.15 17145.4,-261.56 17120.74,-249.16"/>
<polygon fill="black" stroke="black" points="17122.13,-245.94 17111.62,-244.58 17118.98,-252.2 17122.13,-245.94"/>
</g>
<!-- l3_expert_57_gpu15 -->
<g id="node504" class="node">
<title>l3_expert_57_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17414.07,-341.95 17317.07,-341.95 17317.07,-288.95 17414.07,-288.95 17414.07,-341.95"/>
<text text-anchor="middle" x="17365.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 129</text>
<text text-anchor="middle" x="17365.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17365.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_57_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1043" class="edge">
<title>l3_expert_57_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17316.96,-292.09C17314.14,-290.99 17311.33,-289.93 17308.57,-288.95 17261.38,-272.24 17207.37,-257.62 17163.45,-246.84"/>
<polygon fill="black" stroke="black" points="17164.21,-243.42 17153.67,-244.45 17162.55,-250.22 17164.21,-243.42"/>
</g>
<!-- l3_expert_58_gpu15 -->
<g id="node505" class="node">
<title>l3_expert_58_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17529.07,-341.95 17432.07,-341.95 17432.07,-288.95 17529.07,-288.95 17529.07,-341.95"/>
<text text-anchor="middle" x="17480.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 130</text>
<text text-anchor="middle" x="17480.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17480.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_58_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1046" class="edge">
<title>l3_expert_58_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17432.05,-291.81C17429.21,-290.78 17426.37,-289.81 17423.57,-288.95 17360.87,-269.68 17289.81,-255.74 17228.46,-246.07"/>
<polygon fill="black" stroke="black" points="17228.73,-242.57 17218.31,-244.49 17227.66,-249.48 17228.73,-242.57"/>
</g>
<!-- l3_expert_59_gpu15 -->
<g id="node506" class="node">
<title>l3_expert_59_gpu15</title>
<polygon fill="lightpink" stroke="black" points="16724.07,-341.95 16627.07,-341.95 16627.07,-288.95 16724.07,-288.95 16724.07,-341.95"/>
<text text-anchor="middle" x="16675.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 131</text>
<text text-anchor="middle" x="16675.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16675.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_59_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1049" class="edge">
<title>l3_expert_59_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16724.31,-292.05C16727.41,-290.93 16730.52,-289.88 16733.57,-288.95 16810.6,-265.5 16900.22,-249.83 16968.67,-240.19"/>
<polygon fill="black" stroke="black" points="16969.19,-243.65 16978.61,-238.81 16968.23,-236.71 16969.19,-243.65"/>
</g>
<!-- l3_expert_60_gpu15 -->
<g id="node507" class="node">
<title>l3_expert_60_gpu15</title>
<polygon fill="lightpink" stroke="black" points="16839.07,-341.95 16742.07,-341.95 16742.07,-288.95 16839.07,-288.95 16839.07,-341.95"/>
<text text-anchor="middle" x="16790.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 132</text>
<text text-anchor="middle" x="16790.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16790.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_60_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1052" class="edge">
<title>l3_expert_60_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16839.09,-292.48C16842.28,-291.24 16845.46,-290.05 16848.57,-288.95 16895.59,-272.41 16949.37,-257.76 16992.98,-246.91"/>
<polygon fill="black" stroke="black" points="16993.83,-250.3 17002.7,-244.51 16992.15,-243.51 16993.83,-250.3"/>
</g>
<!-- l3_expert_61_gpu15 -->
<g id="node508" class="node">
<title>l3_expert_61_gpu15</title>
<polygon fill="lightpink" stroke="black" points="16954.07,-341.95 16857.07,-341.95 16857.07,-288.95 16954.07,-288.95 16954.07,-341.95"/>
<text text-anchor="middle" x="16905.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 133</text>
<text text-anchor="middle" x="16905.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16905.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_61_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1055" class="edge">
<title>l3_expert_61_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16954.4,-289.76C16979.76,-276.93 17010.46,-261.4 17034.87,-249.05"/>
<polygon fill="black" stroke="black" points="17036.55,-252.12 17043.89,-244.49 17033.39,-245.88 17036.55,-252.12"/>
</g>
<!-- l3_expert_62_gpu15 -->
<g id="node509" class="node">
<title>l3_expert_62_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17069.07,-341.95 16972.07,-341.95 16972.07,-288.95 17069.07,-288.95 17069.07,-341.95"/>
<text text-anchor="middle" x="17020.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 134</text>
<text text-anchor="middle" x="17020.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17020.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_62_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1058" class="edge">
<title>l3_expert_62_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17037.36,-288.82C17044.72,-277.59 17053.34,-264.43 17060.71,-253.19"/>
<polygon fill="black" stroke="black" points="17063.75,-254.94 17066.3,-244.65 17057.89,-251.1 17063.75,-254.94"/>
</g>
<!-- l3_expert_63_gpu15 -->
<g id="node510" class="node">
<title>l3_expert_63_gpu15</title>
<polygon fill="lightpink" stroke="black" points="17184.07,-341.95 17087.07,-341.95 17087.07,-288.95 17184.07,-288.95 17184.07,-341.95"/>
<text text-anchor="middle" x="17135.57" y="-326.75" font-family="Times,serif" font-size="14.00">Expert 135</text>
<text text-anchor="middle" x="17135.57" y="-311.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17135.57" y="-296.75" font-family="Times,serif" font-size="14.00">Same dims</text>
</g>
<!-- l3_expert_63_gpu15&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1061" class="edge">
<title>l3_expert_63_gpu15&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17118.48,-288.82C17110.99,-277.59 17102.22,-264.43 17094.73,-253.19"/>
<polygon fill="black" stroke="black" points="17097.5,-251.03 17089.04,-244.65 17091.67,-254.92 17097.5,-251.03"/>
</g>
<!-- l3_gate_gpu15 -->
<g id="node511" class="node">
<title>l3_gate_gpu15</title>
<polygon fill="lightcyan" stroke="black" points="17183.36,-422.45 17107.33,-422.45 17087.77,-386.45 17163.8,-386.45 17183.36,-422.45"/>
<text text-anchor="middle" x="17135.57" y="-400.75" font-family="Times,serif" font-size="14.00">Gate</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_56_gpu15 -->
<g id="edge1038" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_56_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17158.29,-386.26C17172.58,-375.46 17191.45,-361.17 17208.41,-348.35"/>
<polygon fill="black" stroke="black" points="17210.69,-351.01 17216.55,-342.19 17206.47,-345.43 17210.69,-351.01"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_57_gpu15 -->
<g id="edge1041" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_57_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17167.42,-392.97C17200.43,-381.93 17253.67,-363.6 17307.51,-342.28"/>
<polygon fill="black" stroke="black" points="17308.87,-345.51 17316.86,-338.55 17306.27,-339 17308.87,-345.51"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_58_gpu15 -->
<g id="edge1044" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_58_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17170.77,-398.39C17223.85,-390.22 17327.45,-372.23 17422.28,-342.13"/>
<polygon fill="black" stroke="black" points="17423.58,-345.39 17432.02,-338.98 17421.42,-338.72 17423.58,-345.39"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_59_gpu15 -->
<g id="edge1047" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_59_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17095.45,-400.81C17023.98,-395.36 16870.15,-380.24 16734.05,-341.76"/>
<polygon fill="black" stroke="black" points="16734.86,-338.35 16724.28,-338.94 16732.92,-345.07 16734.86,-338.35"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_60_gpu15 -->
<g id="edge1050" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_60_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17093.52,-397.19C17038.9,-388.47 16940.67,-370.73 16849.05,-341.84"/>
<polygon fill="black" stroke="black" points="16849.94,-338.45 16839.34,-338.73 16847.8,-345.12 16849.94,-338.45"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_61_gpu15 -->
<g id="edge1053" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_61_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17088.14,-387.51C17053.41,-375.59 17005.26,-358.55 16963.57,-341.95 16963.47,-341.92 16963.38,-341.88 16963.28,-341.84"/>
<polygon fill="black" stroke="black" points="16964.78,-338.67 16954.2,-338.13 16962.13,-345.15 16964.78,-338.67"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_62_gpu15 -->
<g id="edge1056" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_62_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17112.85,-386.26C17098.56,-375.46 17079.68,-361.17 17062.73,-348.35"/>
<polygon fill="black" stroke="black" points="17064.67,-345.43 17054.58,-342.19 17060.45,-351.01 17064.67,-345.43"/>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert_63_gpu15 -->
<g id="edge1059" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert_63_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17135.57,-386.26C17135.57,-376.54 17135.57,-364 17135.57,-352.23"/>
<polygon fill="black" stroke="black" points="17139.07,-352.19 17135.57,-342.19 17132.07,-352.19 17139.07,-352.19"/>
</g>
<!-- l3_res2_gpu15 -->
<g id="node513" class="node">
<title>l3_res2_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17132.57,-155.45 17022.57,-155.45 17022.57,-119.45 17132.57,-119.45 17132.57,-155.45"/>
<text text-anchor="middle" x="17077.57" y="-133.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
</g>
<!-- l3_expert_agg_gpu15&#45;&gt;l3_res2_gpu15 -->
<g id="edge1062" class="edge">
<title>l3_expert_agg_gpu15&#45;&gt;l3_res2_gpu15</title>
<path fill="none" stroke="black" d="M17077.57,-208.26C17077.57,-196.11 17077.57,-179.57 17077.57,-165.63"/>
<polygon fill="black" stroke="black" points="17081.07,-165.61 17077.57,-155.61 17074.07,-165.61 17081.07,-165.61"/>
</g>
<!-- l3_res2_gpu15&#45;&gt;output -->
<g id="edge1064" class="edge">
<title>l3_res2_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M17022.46,-128.06C16954.5,-118.11 16835.34,-102 16732.57,-94.95 16165.89,-56.07 14486.58,-43.46 13782.17,-39.81"/>
<polygon fill="black" stroke="black" points="13782.14,-36.31 13772.12,-39.76 13782.11,-43.31 13782.14,-36.31"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_0_gpu0 -->
<g id="edge42" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M8611.52,-1162.04C8627.24,-1157.7 8645.03,-1153.44 8661.57,-1150.95 8862.03,-1120.81 9370.97,-1161.22 9586.03,-1114.84"/>
<polygon fill="black" stroke="black" points="9587.07,-1118.19 9596.04,-1112.56 9585.52,-1111.36 9587.07,-1118.19"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_1_gpu0 -->
<g id="edge45" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M8611.52,-1162C8627.23,-1157.66 8645.02,-1153.41 8661.57,-1150.95 8886.98,-1117.55 9459.73,-1166.47 9699.28,-1114.78"/>
<polygon fill="black" stroke="black" points="9700.06,-1118.2 9709.05,-1112.58 9698.52,-1111.37 9700.06,-1118.2"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_2_gpu0 -->
<g id="edge48" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_2_gpu0</title>
<path fill="none" stroke="black" d="M8611.51,-1161.97C8627.23,-1157.63 8645.02,-1153.38 8661.57,-1150.95 8911.77,-1114.31 9547.73,-1171.67 9812.04,-1114.84"/>
<polygon fill="black" stroke="black" points="9813.06,-1118.2 9822.05,-1112.59 9811.52,-1111.37 9813.06,-1118.2"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_3_gpu0 -->
<g id="edge51" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_3_gpu0</title>
<path fill="none" stroke="black" d="M8611.51,-1161.94C8627.22,-1157.6 8645.01,-1153.35 8661.57,-1150.95 8936.62,-1111.06 9635.97,-1176.91 9924.95,-1114.86"/>
<polygon fill="black" stroke="black" points="9926.06,-1118.2 9935.05,-1112.6 9924.53,-1111.37 9926.06,-1118.2"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_4_gpu0 -->
<g id="edge54" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_4_gpu0</title>
<path fill="none" stroke="black" d="M8611.02,-1162.05C8626.85,-1157.66 8644.84,-1153.36 8661.57,-1150.95 8961.52,-1107.8 9724.46,-1182.18 10038,-1114.85"/>
<polygon fill="black" stroke="black" points="10039.06,-1118.2 10048.05,-1112.61 10037.53,-1111.37 10039.06,-1118.2"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_5_gpu0 -->
<g id="edge57" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_5_gpu0</title>
<path fill="none" stroke="black" d="M8613.08,-1162.18C8628.43,-1158.01 8645.61,-1153.82 8661.57,-1150.95 8875.38,-1112.6 9133.76,-1097.08 9246.85,-1091.79"/>
<polygon fill="black" stroke="black" points="9247.18,-1095.28 9257.01,-1091.33 9246.86,-1088.29 9247.18,-1095.28"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_6_gpu0 -->
<g id="edge60" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_6_gpu0</title>
<path fill="none" stroke="black" d="M8612.03,-1162.03C8627.62,-1157.74 8645.21,-1153.52 8661.57,-1150.95 8966.03,-1103.22 9056.98,-1186.97 9360.08,-1114.92"/>
<polygon fill="black" stroke="black" points="9361.13,-1118.27 9370.03,-1112.52 9359.49,-1111.47 9361.13,-1118.27"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_expert_7_gpu0 -->
<g id="edge63" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_expert_7_gpu0</title>
<path fill="none" stroke="black" d="M8611.53,-1162.09C8627.25,-1157.76 8645.03,-1153.49 8661.57,-1150.95 9015.77,-1096.72 9120.94,-1197.54 9473.08,-1114.91"/>
<polygon fill="black" stroke="black" points="9474.12,-1118.26 9483.04,-1112.54 9472.5,-1111.46 9474.12,-1118.26"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_gate_gpu0 -->
<g id="edge40" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_gate_gpu0</title>
<path fill="none" stroke="black" d="M8577.09,-1195.48C8594.03,-1219.76 8628.27,-1260.98 8670.57,-1269.95 8701.11,-1276.43 9201.54,-1273.4 9232.57,-1269.95 9369.16,-1254.77 9526.68,-1212.04 9600.8,-1190.38"/>
<polygon fill="black" stroke="black" points="9602.09,-1193.65 9610.69,-1187.47 9600.11,-1186.93 9602.09,-1193.65"/>
</g>
<!-- l1_res_add_gpu0&#45;&gt;l1_res2_gpu0 -->
<g id="edge66" class="edge">
<title>l1_res_add_gpu0&#45;&gt;l1_res2_gpu0</title>
<path fill="none" stroke="black" d="M8576.38,-1159.58C8603.64,-1118.75 8679.71,-1014.91 8773.57,-972.95 8851.56,-938.09 9435.85,-918.78 9634.04,-913.18"/>
<polygon fill="black" stroke="black" points="9634.41,-916.68 9644.3,-912.9 9634.21,-909.68 9634.41,-916.68"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_8_gpu1 -->
<g id="edge108" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_8_gpu1</title>
<path fill="none" stroke="black" d="M8804.01,-1161.99C8819.84,-1157.59 8837.83,-1153.3 8854.57,-1150.95 9056.59,-1122.59 10473.28,-1159.69 10716.02,-1114.69"/>
<polygon fill="black" stroke="black" points="10716.97,-1118.07 10726.06,-1112.63 10715.56,-1111.21 10716.97,-1118.07"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_9_gpu1 -->
<g id="edge111" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_9_gpu1</title>
<path fill="none" stroke="black" d="M8804.01,-1161.98C8819.84,-1157.58 8837.83,-1153.29 8854.57,-1150.95 9069.07,-1120.96 10574.42,-1162.31 10829.19,-1114.67"/>
<polygon fill="black" stroke="black" points="10829.97,-1118.08 10839.06,-1112.63 10828.56,-1111.22 10829.97,-1118.08"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_10_gpu1 -->
<g id="edge114" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_10_gpu1</title>
<path fill="none" stroke="black" d="M8804.01,-1161.97C8819.84,-1157.57 8837.83,-1153.29 8854.57,-1150.95 9081.46,-1119.34 10674.33,-1164.9 10942.05,-1114.7"/>
<polygon fill="black" stroke="black" points="10942.97,-1118.08 10952.06,-1112.64 10941.56,-1111.23 10942.97,-1118.08"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_11_gpu1 -->
<g id="edge117" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_11_gpu1</title>
<path fill="none" stroke="black" d="M8804.51,-1161.93C8820.22,-1157.59 8838.01,-1153.35 8854.57,-1150.95 9136.94,-1110.1 9855.08,-1178.47 10151.13,-1114.82"/>
<polygon fill="black" stroke="black" points="10152.06,-1118.2 10161.05,-1112.6 10150.53,-1111.37 10152.06,-1118.2"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_12_gpu1 -->
<g id="edge120" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_12_gpu1</title>
<path fill="none" stroke="black" d="M8804.02,-1162.05C8819.85,-1157.65 8837.84,-1153.35 8854.57,-1150.95 9161.86,-1106.84 9943.67,-1183.75 10264.24,-1114.8"/>
<polygon fill="black" stroke="black" points="10265.06,-1118.2 10274.05,-1112.61 10263.53,-1111.37 10265.06,-1118.2"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_13_gpu1 -->
<g id="edge123" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_13_gpu1</title>
<path fill="none" stroke="black" d="M8804.02,-1162.03C8819.85,-1157.63 8837.84,-1153.34 8854.57,-1150.95 9186.74,-1103.59 10032.08,-1189.03 10377.24,-1114.8"/>
<polygon fill="black" stroke="black" points="10378.05,-1118.2 10387.05,-1112.61 10376.53,-1111.37 10378.05,-1118.2"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_14_gpu1 -->
<g id="edge126" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_14_gpu1</title>
<path fill="none" stroke="black" d="M8804.01,-1162.01C8819.85,-1157.62 8837.84,-1153.33 8854.57,-1150.95 9211.58,-1100.35 10120.23,-1194.28 10490.08,-1114.84"/>
<polygon fill="black" stroke="black" points="10491.05,-1118.2 10500.06,-1112.62 10489.53,-1111.37 10491.05,-1118.2"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_expert_15_gpu1 -->
<g id="edge129" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_expert_15_gpu1</title>
<path fill="none" stroke="black" d="M8804.01,-1162C8819.84,-1157.6 8837.83,-1153.31 8854.57,-1150.95 9236.53,-1097.09 10208.99,-1199.6 10603.28,-1114.79"/>
<polygon fill="black" stroke="black" points="10604.05,-1118.21 10613.06,-1112.62 10602.54,-1111.37 10604.05,-1118.21"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_gate_gpu1 -->
<g id="edge106" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_gate_gpu1</title>
<path fill="none" stroke="black" d="M8770.09,-1195.48C8787.03,-1219.76 8821.27,-1260.98 8863.57,-1269.95 8881.46,-1273.75 10162.42,-1272.21 10180.57,-1269.95 10300.58,-1255.06 10437.73,-1213.77 10505.34,-1191.74"/>
<polygon fill="black" stroke="black" points="10506.78,-1194.95 10515.19,-1188.5 10504.59,-1188.3 10506.78,-1194.95"/>
</g>
<!-- l1_res_add_gpu1&#45;&gt;l1_res2_gpu1 -->
<g id="edge132" class="edge">
<title>l1_res_add_gpu1&#45;&gt;l1_res2_gpu1</title>
<path fill="none" stroke="black" d="M8767.9,-1159.45C8791.55,-1118.31 8858.37,-1013.83 8947.57,-972.95 8965.97,-964.52 10233.41,-923.33 10538.19,-913.54"/>
<polygon fill="black" stroke="black" points="10538.32,-917.04 10548.2,-913.22 10538.09,-910.05 10538.32,-917.04"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_16_gpu2 -->
<g id="edge174" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_16_gpu2</title>
<path fill="none" stroke="black" d="M8997,-1161.94C9012.84,-1157.54 9030.83,-1153.26 9047.57,-1150.95 9315.43,-1113.99 11198.75,-1173.53 11507.17,-1114.7"/>
<polygon fill="black" stroke="black" points="11507.98,-1118.1 11517.06,-1112.64 11506.56,-1111.25 11507.98,-1118.1"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_17_gpu2 -->
<g id="edge177" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_17_gpu2</title>
<path fill="none" stroke="black" d="M8997,-1161.94C9012.83,-1157.54 9030.83,-1153.26 9047.57,-1150.95 9327.88,-1112.36 11299.46,-1176.15 11620.2,-1114.69"/>
<polygon fill="black" stroke="black" points="11620.98,-1118.11 11630.06,-1112.65 11619.56,-1111.25 11620.98,-1118.11"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_18_gpu2 -->
<g id="edge180" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_18_gpu2</title>
<path fill="none" stroke="black" d="M8997,-1161.93C9012.83,-1157.53 9030.83,-1153.25 9047.57,-1150.95 9340.2,-1110.76 11398.3,-1178.73 11732.78,-1114.78"/>
<polygon fill="black" stroke="black" points="11733.98,-1118.1 11743.06,-1112.65 11732.56,-1111.25 11733.98,-1118.1"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_19_gpu2 -->
<g id="edge183" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_19_gpu2</title>
<path fill="none" stroke="black" d="M8997,-1161.93C9012.83,-1157.52 9030.83,-1153.25 9047.57,-1150.95 9352.74,-1109.12 11500.32,-1181.4 11846.13,-1114.72"/>
<polygon fill="black" stroke="black" points="11846.99,-1118.11 11856.06,-1112.65 11845.56,-1111.26 11846.99,-1118.11"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_20_gpu2 -->
<g id="edge186" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_20_gpu2</title>
<path fill="none" stroke="black" d="M8997.01,-1161.97C9012.84,-1157.58 9030.83,-1153.29 9047.57,-1150.95 9265.66,-1120.49 10796.14,-1163.05 11055.03,-1114.7"/>
<polygon fill="black" stroke="black" points="11055.97,-1118.08 11065.06,-1112.63 11054.56,-1111.22 11055.97,-1118.08"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_21_gpu2 -->
<g id="edge189" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_21_gpu2</title>
<path fill="none" stroke="black" d="M8997.01,-1161.97C9012.84,-1157.57 9030.83,-1153.28 9047.57,-1150.95 9278.05,-1118.87 10896.07,-1165.64 11167.89,-1114.73"/>
<polygon fill="black" stroke="black" points="11168.97,-1118.08 11178.06,-1112.64 11167.56,-1111.23 11168.97,-1118.08"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_22_gpu2 -->
<g id="edge192" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_22_gpu2</title>
<path fill="none" stroke="black" d="M8997.01,-1161.96C9012.84,-1157.56 9030.83,-1153.28 9047.57,-1150.95 9290.57,-1117.24 10997.86,-1168.29 11281.21,-1114.68"/>
<polygon fill="black" stroke="black" points="11281.98,-1118.09 11291.06,-1112.64 11280.56,-1111.24 11281.98,-1118.09"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_expert_23_gpu2 -->
<g id="edge195" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_expert_23_gpu2</title>
<path fill="none" stroke="black" d="M8997,-1161.95C9012.84,-1157.55 9030.83,-1153.27 9047.57,-1150.95 9303,-1115.61 11098.22,-1170.9 11394.17,-1114.69"/>
<polygon fill="black" stroke="black" points="11394.98,-1118.1 11404.06,-1112.64 11393.56,-1111.24 11394.98,-1118.1"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_gate_gpu2 -->
<g id="edge172" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_gate_gpu2</title>
<path fill="none" stroke="black" d="M8963.09,-1195.48C8980.03,-1219.76 9014.27,-1260.98 9056.57,-1269.95 9071.69,-1273.16 11267.45,-1273.16 11282.57,-1269.95 11335.28,-1258.77 11388.58,-1225.03 11420.85,-1201.55"/>
<polygon fill="black" stroke="black" points="11423.03,-1204.29 11428.98,-1195.53 11418.86,-1198.67 11423.03,-1204.29"/>
</g>
<!-- l1_res_add_gpu2&#45;&gt;l1_res2_gpu2 -->
<g id="edge198" class="edge">
<title>l1_res_add_gpu2&#45;&gt;l1_res2_gpu2</title>
<path fill="none" stroke="black" d="M8956.51,-1159.23C8969.34,-1118.1 9008.05,-1014.45 9082.57,-972.95 9132.74,-945.01 11092.2,-939.49 11149.57,-936.95 11251.92,-932.42 11370.47,-923.19 11442.19,-917.17"/>
<polygon fill="black" stroke="black" points="11442.76,-920.63 11452.43,-916.3 11442.17,-913.66 11442.76,-920.63"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_24_gpu3 -->
<g id="edge240" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_24_gpu3</title>
<path fill="none" stroke="black" d="M9191.17,-1162.11C9207.85,-1157.64 9226.89,-1153.27 9244.57,-1150.95 9598.83,-1104.5 12092.34,-1191.78 12487.06,-1114.74"/>
<polygon fill="black" stroke="black" points="12487.99,-1118.13 12497.06,-1112.66 12486.56,-1111.27 12487.99,-1118.13"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_25_gpu3 -->
<g id="edge243" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_25_gpu3</title>
<path fill="none" stroke="black" d="M9191.17,-1162.11C9207.85,-1157.64 9226.89,-1153.27 9244.57,-1150.95 9611.27,-1102.94 12192.8,-1194.41 12600.02,-1114.76"/>
<polygon fill="black" stroke="black" points="12600.99,-1118.13 12610.06,-1112.66 12599.56,-1111.28 12600.99,-1118.13"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_26_gpu3 -->
<g id="edge246" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_26_gpu3</title>
<path fill="none" stroke="black" d="M9191.17,-1162.11C9207.85,-1157.63 9226.89,-1153.26 9244.57,-1150.95 9623.72,-1101.37 12293.34,-1197.05 12713,-1114.76"/>
<polygon fill="black" stroke="black" points="12713.99,-1118.13 12723.06,-1112.66 12712.56,-1111.28 12713.99,-1118.13"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_27_gpu3 -->
<g id="edge249" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_27_gpu3</title>
<path fill="none" stroke="black" d="M9191.17,-1162.1C9207.85,-1157.63 9226.89,-1153.26 9244.57,-1150.95 9439.26,-1125.53 12546.54,-1157.25 12826.09,-1114.48"/>
<polygon fill="black" stroke="black" points="12826.86,-1117.9 12836.07,-1112.66 12825.6,-1111.01 12826.86,-1117.9"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_28_gpu3 -->
<g id="edge252" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_28_gpu3</title>
<path fill="none" stroke="black" d="M9190.92,-1162.17C9207.66,-1157.67 9226.8,-1153.27 9244.57,-1150.95 9445.5,-1124.74 12653.85,-1158.55 12939.21,-1114.47"/>
<polygon fill="black" stroke="black" points="12939.86,-1117.91 12949.07,-1112.66 12938.6,-1111.02 12939.86,-1117.91"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_29_gpu3 -->
<g id="edge255" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_29_gpu3</title>
<path fill="none" stroke="black" d="M9191.18,-1162.13C9207.85,-1157.65 9226.89,-1153.28 9244.57,-1150.95 9561.37,-1109.2 11789.28,-1182.82 12147.78,-1114.51"/>
<polygon fill="black" stroke="black" points="12148.75,-1117.89 12157.84,-1112.45 12147.34,-1111.03 12148.75,-1117.89"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_30_gpu3 -->
<g id="edge258" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_30_gpu3</title>
<path fill="none" stroke="black" d="M9191.18,-1162.12C9207.85,-1157.65 9226.89,-1153.28 9244.57,-1150.95 9573.98,-1107.62 11891.68,-1186.52 12261.2,-1114.71"/>
<polygon fill="black" stroke="black" points="12261.99,-1118.12 12271.06,-1112.65 12260.56,-1111.27 12261.99,-1118.12"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_expert_31_gpu3 -->
<g id="edge261" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_expert_31_gpu3</title>
<path fill="none" stroke="black" d="M9191.17,-1162.12C9207.85,-1157.64 9226.89,-1153.27 9244.57,-1150.95 9586.4,-1106.06 11991.97,-1189.15 12374.12,-1114.73"/>
<polygon fill="black" stroke="black" points="12374.99,-1118.12 12384.06,-1112.66 12373.56,-1111.27 12374.99,-1118.12"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_gate_gpu3 -->
<g id="edge238" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_gate_gpu3</title>
<path fill="none" stroke="black" d="M9156.72,-1195.43C9174.54,-1219.64 9210.35,-1260.78 9253.57,-1269.95 9273.43,-1274.17 12157.42,-1272.45 12177.57,-1269.95 12297.58,-1255.06 12434.73,-1213.77 12502.34,-1191.74"/>
<polygon fill="black" stroke="black" points="12503.78,-1194.95 12512.19,-1188.5 12501.59,-1188.3 12503.78,-1194.95"/>
</g>
<!-- l1_res_add_gpu3&#45;&gt;l1_res2_gpu3 -->
<g id="edge264" class="edge">
<title>l1_res_add_gpu3&#45;&gt;l1_res2_gpu3</title>
<path fill="none" stroke="black" d="M9143.36,-1159.42C9141.57,-1119.16 9143.45,-1018.11 9202.57,-972.95 9237.74,-946.09 12344.41,-939.85 12388.57,-936.95 12437.95,-933.71 12493.48,-926.92 12535.31,-921.16"/>
<polygon fill="black" stroke="black" points="12535.95,-924.6 12545.37,-919.76 12534.98,-917.67 12535.95,-924.6"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_32_gpu4 -->
<g id="edge306" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_32_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.12C18027.29,-1157.64 18008.24,-1153.27 17990.57,-1150.95 17648.84,-1106.07 15244.29,-1188.02 14861.26,-1114.51"/>
<polygon fill="black" stroke="black" points="14861.8,-1111.04 14851.3,-1112.46 14860.39,-1117.9 14861.8,-1111.04"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_33_gpu4 -->
<g id="edge309" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_33_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.12C18027.29,-1157.65 18008.24,-1153.28 17990.57,-1150.95 17661.27,-1107.63 15344.57,-1185.43 14974.19,-1114.49"/>
<polygon fill="black" stroke="black" points="14974.8,-1111.04 14964.3,-1112.45 14973.39,-1117.9 14974.8,-1111.04"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_34_gpu4 -->
<g id="edge312" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_34_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.13C18027.28,-1157.65 18008.24,-1153.28 17990.57,-1150.95 17673.77,-1109.2 15445.85,-1182.82 15087.35,-1114.51"/>
<polygon fill="black" stroke="black" points="15087.8,-1111.03 15077.3,-1112.45 15086.39,-1117.89 15087.8,-1111.03"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_35_gpu4 -->
<g id="edge315" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_35_gpu4</title>
<path fill="none" stroke="black" d="M18044.22,-1162.17C18027.48,-1157.67 18008.33,-1153.27 17990.57,-1150.95 17789.69,-1124.75 14582.36,-1157.9 14296.19,-1114.25"/>
<polygon fill="black" stroke="black" points="14296.76,-1110.8 14286.3,-1112.46 14295.51,-1117.69 14296.76,-1110.8"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_36_gpu4 -->
<g id="edge318" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_36_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.1C18027.29,-1157.63 18008.25,-1153.26 17990.57,-1150.95 17599.08,-1099.83 14842.33,-1198.4 14409.38,-1114.54"/>
<polygon fill="black" stroke="black" points="14409.8,-1111.05 14399.3,-1112.46 14408.38,-1117.91 14409.8,-1111.05"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_37_gpu4 -->
<g id="edge321" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_37_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.11C18027.29,-1157.63 18008.25,-1153.26 17990.57,-1150.95 17611.53,-1101.39 14942.95,-1195.8 14522.38,-1114.54"/>
<polygon fill="black" stroke="black" points="14522.8,-1111.05 14512.3,-1112.46 14521.38,-1117.91 14522.8,-1111.05"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_38_gpu4 -->
<g id="edge324" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_38_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.11C18027.29,-1157.64 18008.24,-1153.27 17990.57,-1150.95 17623.97,-1102.95 15043.48,-1193.2 14635.36,-1114.53"/>
<polygon fill="black" stroke="black" points="14635.8,-1111.05 14625.3,-1112.46 14634.38,-1117.9 14635.8,-1111.05"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_expert_39_gpu4 -->
<g id="edge327" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_expert_39_gpu4</title>
<path fill="none" stroke="black" d="M18043.96,-1162.11C18027.29,-1157.64 18008.24,-1153.27 17990.57,-1150.95 17636.41,-1104.51 15143.93,-1190.61 14748.32,-1114.52"/>
<polygon fill="black" stroke="black" points="14748.8,-1111.04 14738.3,-1112.46 14747.39,-1117.9 14748.8,-1111.04"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_gate_gpu4 -->
<g id="edge304" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_gate_gpu4</title>
<path fill="none" stroke="black" d="M18078.41,-1195.43C18060.6,-1219.64 18024.78,-1260.78 17981.57,-1269.95 17960.69,-1274.38 14928.48,-1274.23 14907.57,-1269.95 14842.52,-1256.67 14772.84,-1223.12 14730.48,-1200.29"/>
<polygon fill="black" stroke="black" points="14732.06,-1197.17 14721.61,-1195.46 14728.71,-1203.32 14732.06,-1197.17"/>
</g>
<!-- l1_res_add_gpu4&#45;&gt;l1_res2_gpu4 -->
<g id="edge330" class="edge">
<title>l1_res_add_gpu4&#45;&gt;l1_res2_gpu4</title>
<path fill="none" stroke="black" d="M18091.06,-1159.35C18091.18,-1118.93 18085.13,-1017.56 18024.57,-972.95 17992.34,-949.21 15182.58,-938.21 15142.57,-936.95 14983.22,-931.97 14796.03,-921.37 14699.13,-915.53"/>
<polygon fill="black" stroke="black" points="14699.09,-912.02 14688.9,-914.91 14698.67,-919.01 14699.09,-912.02"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_40_gpu5 -->
<g id="edge372" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_40_gpu5</title>
<path fill="none" stroke="black" d="M18238.13,-1161.94C18222.3,-1157.54 18204.31,-1153.26 18187.57,-1150.95 17907.37,-1112.38 15936.76,-1175.23 15615.19,-1114.47"/>
<polygon fill="black" stroke="black" points="15615.8,-1111.02 15605.3,-1112.45 15614.39,-1117.88 15615.8,-1111.02"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_41_gpu5 -->
<g id="edge375" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_41_gpu5</title>
<path fill="none" stroke="black" d="M18238.13,-1161.94C18222.3,-1157.54 18204.31,-1153.26 18187.57,-1150.95 17919.81,-1114 16037.45,-1172.64 15728.22,-1114.47"/>
<polygon fill="black" stroke="black" points="15728.8,-1111.02 15718.3,-1112.44 15727.4,-1117.88 15728.8,-1111.02"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_42_gpu5 -->
<g id="edge378" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_42_gpu5</title>
<path fill="none" stroke="black" d="M18238.13,-1161.95C18222.3,-1157.55 18204.31,-1153.27 18187.57,-1150.95 17932.25,-1115.63 16137.97,-1170.06 15841.22,-1114.47"/>
<polygon fill="black" stroke="black" points="15841.8,-1111.01 15831.3,-1112.44 15840.4,-1117.87 15841.8,-1111.01"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_43_gpu5 -->
<g id="edge381" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_43_gpu5</title>
<path fill="none" stroke="black" d="M18238.13,-1161.96C18222.3,-1157.56 18204.31,-1153.28 18187.57,-1150.95 17944.67,-1117.25 16238.32,-1167.48 15954.18,-1114.45"/>
<polygon fill="black" stroke="black" points="15954.8,-1111.01 15944.3,-1112.44 15953.4,-1117.87 15954.8,-1111.01"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_44_gpu5 -->
<g id="edge384" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_44_gpu5</title>
<path fill="none" stroke="black" d="M18238.13,-1161.97C18222.3,-1157.57 18204.31,-1153.28 18187.57,-1150.95 17957.2,-1118.89 16340.1,-1164.88 16067.5,-1114.51"/>
<polygon fill="black" stroke="black" points="16067.8,-1111 16057.3,-1112.44 16066.4,-1117.86 16067.8,-1111"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_45_gpu5 -->
<g id="edge387" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_45_gpu5</title>
<path fill="none" stroke="black" d="M18238.13,-1161.97C18222.3,-1157.58 18204.31,-1153.29 18187.57,-1150.95 17969.59,-1120.51 16440.03,-1162.32 16180.36,-1114.47"/>
<polygon fill="black" stroke="black" points="16180.8,-1110.99 16170.3,-1112.43 16179.41,-1117.85 16180.8,-1110.99"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_46_gpu5 -->
<g id="edge390" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_46_gpu5</title>
<path fill="none" stroke="black" d="M18238.14,-1161.93C18222.3,-1157.52 18204.31,-1153.25 18187.57,-1150.95 17882.51,-1109.13 15735.91,-1180.39 15389.26,-1114.49"/>
<polygon fill="black" stroke="black" points="15389.8,-1111.03 15379.3,-1112.45 15388.39,-1117.89 15389.8,-1111.03"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_expert_47_gpu5 -->
<g id="edge393" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_expert_47_gpu5</title>
<path fill="none" stroke="black" d="M18238.14,-1161.93C18222.3,-1157.53 18204.31,-1153.25 18187.57,-1150.95 17894.91,-1110.75 15835.89,-1177.82 15502.11,-1114.46"/>
<polygon fill="black" stroke="black" points="15502.8,-1111.03 15492.3,-1112.45 15501.39,-1117.89 15502.8,-1111.03"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_gate_gpu5 -->
<g id="edge370" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_gate_gpu5</title>
<path fill="none" stroke="black" d="M18272.05,-1195.48C18255.11,-1219.76 18220.87,-1260.98 18178.57,-1269.95 18163.45,-1273.16 15968.68,-1273.16 15953.57,-1269.95 15900.62,-1258.72 15846.99,-1224.99 15814.5,-1201.53"/>
<polygon fill="black" stroke="black" points="15816.44,-1198.61 15806.31,-1195.51 15812.3,-1204.25 15816.44,-1198.61"/>
</g>
<!-- l1_res_add_gpu5&#45;&gt;l1_res2_gpu5 -->
<g id="edge396" class="edge">
<title>l1_res_add_gpu5&#45;&gt;l1_res2_gpu5</title>
<path fill="none" stroke="black" d="M18274.95,-1159.39C18253.01,-1118.14 18190.61,-1013.4 18103.57,-972.95 18026.16,-936.98 16652.89,-939.25 16567.57,-936.95 16278.73,-929.18 15934.07,-918.17 15792.82,-913.59"/>
<polygon fill="black" stroke="black" points="15792.71,-910.08 15782.6,-913.26 15792.48,-917.08 15792.71,-910.08"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_48_gpu6 -->
<g id="edge438" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_48_gpu6</title>
<path fill="none" stroke="black" d="M18430.63,-1161.93C18414.92,-1157.59 18397.12,-1153.35 18380.57,-1150.95 18098.41,-1110.13 17381.04,-1177.51 17084.26,-1114.59"/>
<polygon fill="black" stroke="black" points="17084.83,-1111.13 17074.31,-1112.4 17083.32,-1117.97 17084.83,-1111.13"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_49_gpu6 -->
<g id="edge441" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_49_gpu6</title>
<path fill="none" stroke="black" d="M18431.13,-1161.97C18415.3,-1157.57 18397.31,-1153.29 18380.57,-1150.95 18153.78,-1119.36 16561.84,-1164.14 16293.35,-1114.48"/>
<polygon fill="black" stroke="black" points="16293.8,-1111 16283.3,-1112.43 16292.4,-1117.86 16293.8,-1111"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_50_gpu6 -->
<g id="edge444" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_50_gpu6</title>
<path fill="none" stroke="black" d="M18431.13,-1161.98C18415.3,-1157.58 18397.31,-1153.29 18380.57,-1150.95 18166.17,-1120.97 16661.74,-1161.59 16406.2,-1114.44"/>
<polygon fill="black" stroke="black" points="16406.8,-1110.99 16396.3,-1112.43 16405.4,-1117.85 16406.8,-1110.99"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_51_gpu6 -->
<g id="edge447" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_51_gpu6</title>
<path fill="none" stroke="black" d="M18431.13,-1161.99C18415.29,-1157.59 18397.3,-1153.3 18380.57,-1150.95 18178.65,-1122.61 16762.87,-1159.01 16519.38,-1114.47"/>
<polygon fill="black" stroke="black" points="16519.8,-1110.98 16509.3,-1112.43 16518.41,-1117.84 16519.8,-1110.98"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_52_gpu6 -->
<g id="edge450" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_52_gpu6</title>
<path fill="none" stroke="black" d="M18431.13,-1162C18415.29,-1157.6 18397.3,-1153.31 18380.57,-1150.95 17998.82,-1097.12 17027.2,-1198.32 16632.1,-1114.57"/>
<polygon fill="black" stroke="black" points="16632.82,-1111.14 16622.3,-1112.42 16631.33,-1117.98 16632.82,-1111.14"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_53_gpu6 -->
<g id="edge453" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_53_gpu6</title>
<path fill="none" stroke="black" d="M18431.12,-1162.01C18415.29,-1157.62 18397.3,-1153.33 18380.57,-1150.95 18023.78,-1100.38 17115.94,-1193.08 16745.31,-1114.61"/>
<polygon fill="black" stroke="black" points="16745.82,-1111.14 16735.3,-1112.42 16744.33,-1117.98 16745.82,-1111.14"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_54_gpu6 -->
<g id="edge456" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_54_gpu6</title>
<path fill="none" stroke="black" d="M18431.12,-1162.03C18415.29,-1157.63 18397.3,-1153.34 18380.57,-1150.95 18048.61,-1103.62 17204.07,-1187.91 16858.14,-1114.57"/>
<polygon fill="black" stroke="black" points="16858.82,-1111.14 16848.31,-1112.41 16857.32,-1117.97 16858.82,-1111.14"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_expert_55_gpu6 -->
<g id="edge459" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_expert_55_gpu6</title>
<path fill="none" stroke="black" d="M18431.12,-1162.05C18415.29,-1157.65 18397.3,-1153.35 18380.57,-1150.95 18073.49,-1106.87 17292.47,-1182.72 16971.15,-1114.57"/>
<polygon fill="black" stroke="black" points="16971.83,-1111.14 16961.31,-1112.41 16970.32,-1117.97 16971.83,-1111.14"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_gate_gpu6 -->
<g id="edge436" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_gate_gpu6</title>
<path fill="none" stroke="black" d="M18465.05,-1195.48C18448.11,-1219.76 18413.87,-1260.98 18371.57,-1269.95 18353.68,-1273.75 17072.72,-1272.21 17054.57,-1269.95 16942.47,-1256.04 16815.42,-1219.1 16744.06,-1196.33"/>
<polygon fill="black" stroke="black" points="16744.96,-1192.95 16734.37,-1193.22 16742.82,-1199.61 16744.96,-1192.95"/>
</g>
<!-- l1_res_add_gpu6&#45;&gt;l1_res2_gpu6 -->
<g id="edge462" class="edge">
<title>l1_res_add_gpu6&#45;&gt;l1_res2_gpu6</title>
<path fill="none" stroke="black" d="M18465.7,-1159.36C18438.3,-1118.03 18361.74,-1013.15 18266.57,-972.95 18141.53,-920.15 17181.15,-943.13 17045.57,-936.95 16922.26,-931.34 16778.46,-921.81 16696.9,-916.13"/>
<polygon fill="black" stroke="black" points="16697,-912.63 16686.78,-915.42 16696.52,-919.61 16697,-912.63"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_56_gpu7 -->
<g id="edge504" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_56_gpu7</title>
<path fill="none" stroke="black" d="M18623.61,-1162.09C18607.89,-1157.76 18590.1,-1153.49 18573.57,-1150.95 18219.8,-1096.77 18115.03,-1196.3 17762.3,-1114.68"/>
<polygon fill="black" stroke="black" points="17762.86,-1111.21 17752.32,-1112.34 17761.26,-1118.03 17762.86,-1111.21"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_57_gpu7 -->
<g id="edge507" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_57_gpu7</title>
<path fill="none" stroke="black" d="M18623.11,-1162.03C18607.51,-1157.75 18589.92,-1153.52 18573.57,-1150.95 18269.55,-1103.28 18178.96,-1185.9 17875.3,-1114.69"/>
<polygon fill="black" stroke="black" points="17875.87,-1111.22 17865.33,-1112.31 17874.25,-1118.03 17875.87,-1111.22"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_58_gpu7 -->
<g id="edge510" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_58_gpu7</title>
<path fill="none" stroke="black" d="M18622.06,-1162.18C18606.71,-1158.01 18589.52,-1153.82 18573.57,-1150.95 18359.76,-1112.6 18101.38,-1097.08 17988.28,-1091.79"/>
<polygon fill="black" stroke="black" points="17988.27,-1088.29 17978.12,-1091.33 17987.95,-1095.28 17988.27,-1088.29"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_59_gpu7 -->
<g id="edge513" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_59_gpu7</title>
<path fill="none" stroke="black" d="M18624.12,-1162.05C18608.28,-1157.66 18590.3,-1153.36 18573.57,-1150.95 18273.84,-1107.83 17511.67,-1181.16 17197.39,-1114.62"/>
<polygon fill="black" stroke="black" points="17197.83,-1111.13 17187.31,-1112.4 17196.32,-1117.97 17197.83,-1111.13"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_60_gpu7 -->
<g id="edge516" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_60_gpu7</title>
<path fill="none" stroke="black" d="M18623.63,-1161.94C18607.91,-1157.6 18590.12,-1153.35 18573.57,-1150.95 18298.74,-1111.09 17600.14,-1175.98 17310.44,-1114.63"/>
<polygon fill="black" stroke="black" points="17310.83,-1111.13 17300.31,-1112.39 17309.32,-1117.97 17310.83,-1111.13"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_61_gpu7 -->
<g id="edge519" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_61_gpu7</title>
<path fill="none" stroke="black" d="M18623.63,-1161.97C18607.91,-1157.63 18590.12,-1153.38 18573.57,-1150.95 18323.58,-1114.33 17688.37,-1170.82 17423.35,-1114.61"/>
<polygon fill="black" stroke="black" points="17423.83,-1111.13 17413.31,-1112.38 17422.32,-1117.97 17423.83,-1111.13"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_62_gpu7 -->
<g id="edge522" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_62_gpu7</title>
<path fill="none" stroke="black" d="M18623.62,-1162C18607.91,-1157.66 18590.12,-1153.41 18573.57,-1150.95 18348.38,-1117.58 17776.34,-1165.7 17536.11,-1114.56"/>
<polygon fill="black" stroke="black" points="17536.84,-1111.13 17526.32,-1112.37 17535.31,-1117.96 17536.84,-1111.13"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_expert_63_gpu7 -->
<g id="edge525" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_expert_63_gpu7</title>
<path fill="none" stroke="black" d="M18623.61,-1162.04C18607.9,-1157.7 18590.11,-1153.44 18573.57,-1150.95 18373.32,-1120.84 17865.08,-1160.53 17649.37,-1114.61"/>
<polygon fill="black" stroke="black" points="17649.84,-1111.13 17639.32,-1112.36 17648.31,-1117.96 17649.84,-1111.13"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_gate_gpu7 -->
<g id="edge502" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_gate_gpu7</title>
<path fill="none" stroke="black" d="M18658.05,-1195.48C18641.11,-1219.76 18606.87,-1260.98 18564.57,-1269.95 18534.03,-1276.43 18033.6,-1273.4 18002.57,-1269.95 17873.26,-1255.58 17725.2,-1216.52 17646.89,-1194.02"/>
<polygon fill="black" stroke="black" points="17647.81,-1190.64 17637.23,-1191.23 17645.87,-1197.37 17647.81,-1190.64"/>
</g>
<!-- l1_res_add_gpu7&#45;&gt;l1_res2_gpu7 -->
<g id="edge528" class="edge">
<title>l1_res_add_gpu7&#45;&gt;l1_res2_gpu7</title>
<path fill="none" stroke="black" d="M18666.57,-1159.26C18658.47,-1118.64 18632.04,-1016.87 18564.57,-972.95 18483.97,-920.49 17813.89,-912.77 17599.95,-911.64"/>
<polygon fill="black" stroke="black" points="17599.83,-908.14 17589.81,-911.59 17599.79,-915.14 17599.83,-908.14"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_0_gpu8 -->
<g id="edge544" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M8669.52,-756.03C8685.24,-751.69 8703.03,-747.43 8719.57,-744.95 8927.07,-713.89 9453.99,-756.69 9676.02,-708.84"/>
<polygon fill="black" stroke="black" points="9677.06,-712.19 9686.04,-706.57 9675.52,-705.36 9677.06,-712.19"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_1_gpu8 -->
<g id="edge547" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M8669.51,-755.99C8685.23,-751.65 8703.02,-747.4 8719.57,-744.95 8951.93,-710.64 9542.29,-761.91 9788.99,-708.85"/>
<polygon fill="black" stroke="black" points="9790.06,-712.19 9799.05,-706.58 9788.52,-705.37 9790.06,-712.19"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_2_gpu8 -->
<g id="edge550" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_2_gpu8</title>
<path fill="none" stroke="black" d="M8669.51,-755.96C8685.23,-751.62 8703.02,-747.37 8719.57,-744.95 8976.86,-707.38 9630.97,-767.18 9902.17,-708.81"/>
<polygon fill="black" stroke="black" points="9903.06,-712.2 9912.05,-706.59 9901.53,-705.37 9903.06,-712.2"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_3_gpu8 -->
<g id="edge553" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_3_gpu8</title>
<path fill="none" stroke="black" d="M8669.51,-755.93C8685.22,-751.59 8703.01,-747.35 8719.57,-744.95 9001.73,-704.13 9719.31,-772.43 10015.14,-708.82"/>
<polygon fill="black" stroke="black" points="10016.06,-712.2 10025.05,-706.6 10014.53,-705.37 10016.06,-712.2"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_4_gpu8 -->
<g id="edge556" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_4_gpu8</title>
<path fill="none" stroke="black" d="M8669.02,-756.05C8684.85,-751.65 8702.84,-747.35 8719.57,-744.95 9026.64,-700.87 9807.89,-777.71 10128.25,-708.8"/>
<polygon fill="black" stroke="black" points="10129.06,-712.2 10138.05,-706.61 10127.53,-705.37 10129.06,-712.2"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_5_gpu8 -->
<g id="edge559" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_5_gpu8</title>
<path fill="none" stroke="black" d="M8671.07,-756.14C8686.42,-751.97 8703.61,-747.78 8719.57,-744.95 8945.65,-704.92 9219.2,-690.19 9336.55,-685.44"/>
<polygon fill="black" stroke="black" points="9336.88,-688.93 9346.74,-685.04 9336.61,-681.94 9336.88,-688.93"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_6_gpu8 -->
<g id="edge562" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_6_gpu8</title>
<path fill="none" stroke="black" d="M8670.02,-756C8685.62,-751.72 8703.21,-747.5 8719.57,-744.95 9038.12,-695.38 9133.1,-783.97 9450.11,-708.91"/>
<polygon fill="black" stroke="black" points="9451.13,-712.27 9460.03,-706.53 9449.49,-705.46 9451.13,-712.27"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_expert_7_gpu8 -->
<g id="edge565" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_expert_7_gpu8</title>
<path fill="none" stroke="black" d="M8669.53,-756.08C8685.24,-751.74 8703.03,-747.47 8719.57,-744.95 9087.92,-688.87 9197.08,-794.57 9563.24,-708.88"/>
<polygon fill="black" stroke="black" points="9564.12,-712.26 9573.04,-706.55 9562.5,-705.45 9564.12,-712.26"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_gate_gpu8 -->
<g id="edge542" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_gate_gpu8</title>
<path fill="none" stroke="black" d="M8635.09,-789.48C8652.03,-813.76 8686.27,-854.98 8728.57,-863.95 8760.41,-870.71 9282.2,-867.48 9314.57,-863.95 9454.26,-848.72 9615.57,-805.71 9690.81,-784.14"/>
<polygon fill="black" stroke="black" points="9692.21,-787.37 9700.84,-781.24 9690.26,-780.65 9692.21,-787.37"/>
</g>
<!-- l2_res_add_gpu8&#45;&gt;l2_res2_gpu8 -->
<g id="edge568" class="edge">
<title>l2_res_add_gpu8&#45;&gt;l2_res2_gpu8</title>
<path fill="none" stroke="black" d="M8634.52,-753.57C8662.13,-712.71 8739.11,-608.79 8833.57,-566.95 8914.51,-531.1 9522.15,-512.34 9724.35,-507.05"/>
<polygon fill="black" stroke="black" points="9724.62,-510.54 9734.52,-506.78 9724.43,-503.54 9724.62,-510.54"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_0_gpu8 -->
<g id="edge577" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M8669.52,-389.03C8685.24,-384.69 8703.03,-380.43 8719.57,-377.95 8925.34,-347.12 9447.86,-389.33 9668.1,-341.82"/>
<polygon fill="black" stroke="black" points="9669.07,-345.19 9678.04,-339.57 9667.52,-338.37 9669.07,-345.19"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_1_gpu8 -->
<g id="edge580" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M8669.52,-388.99C8685.23,-384.65 8703.02,-380.4 8719.57,-377.95 8950.19,-343.87 9536.15,-394.55 9781.06,-341.83"/>
<polygon fill="black" stroke="black" points="9782.06,-345.19 9791.05,-339.58 9780.52,-338.37 9782.06,-345.19"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_2_gpu8 -->
<g id="edge583" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_2_gpu8</title>
<path fill="none" stroke="black" d="M8669.51,-388.96C8685.23,-384.62 8703.02,-380.37 8719.57,-377.95 8975.12,-340.61 9624.82,-399.81 9894.24,-341.8"/>
<polygon fill="black" stroke="black" points="9895.06,-345.2 9904.05,-339.59 9893.53,-338.37 9895.06,-345.2"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_3_gpu8 -->
<g id="edge586" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_3_gpu8</title>
<path fill="none" stroke="black" d="M8669.51,-388.94C8685.22,-384.59 8703.01,-380.35 8719.57,-377.95 8999.98,-337.36 9713.15,-405.06 10007.2,-341.81"/>
<polygon fill="black" stroke="black" points="10008.06,-345.2 10017.05,-339.6 10006.53,-338.37 10008.06,-345.2"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_4_gpu8 -->
<g id="edge589" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_4_gpu8</title>
<path fill="none" stroke="black" d="M8669.02,-389.05C8684.85,-384.66 8702.84,-380.36 8719.57,-377.95 9024.75,-334.12 9800.96,-410.27 10119.83,-341.89"/>
<polygon fill="black" stroke="black" points="10121.05,-345.2 10130.05,-339.61 10119.53,-338.37 10121.05,-345.2"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_5_gpu8 -->
<g id="edge592" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_5_gpu8</title>
<path fill="none" stroke="black" d="M8671.07,-389.15C8686.43,-384.98 8703.61,-380.79 8719.57,-377.95 8942.69,-338.32 9212.61,-323.39 9328.8,-318.52"/>
<polygon fill="black" stroke="black" points="9329.05,-322.01 9338.89,-318.11 9328.76,-315.02 9329.05,-322.01"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_6_gpu8 -->
<g id="edge595" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_6_gpu8</title>
<path fill="none" stroke="black" d="M8670.02,-389.01C8685.62,-384.73 8703.21,-380.5 8719.57,-377.95 9034.63,-328.83 9128.59,-416.24 9442.22,-341.89"/>
<polygon fill="black" stroke="black" points="9443.13,-345.27 9452.03,-339.53 9441.49,-338.46 9443.13,-345.27"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_expert_7_gpu8 -->
<g id="edge598" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_expert_7_gpu8</title>
<path fill="none" stroke="black" d="M8669.53,-389.08C8685.24,-384.75 8703.03,-380.47 8719.57,-377.95 9084.33,-322.34 9192.52,-426.78 9555.06,-341.92"/>
<polygon fill="black" stroke="black" points="9556.12,-345.26 9565.04,-339.55 9554.5,-338.45 9556.12,-345.26"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_gate_gpu8 -->
<g id="edge575" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_gate_gpu8</title>
<path fill="none" stroke="black" d="M8644.36,-422.14C8664.39,-437.77 8696.33,-459.11 8728.57,-465.95 8760.41,-472.71 9282.1,-468.37 9314.57,-465.95 9448.91,-455.96 9605.93,-427.83 9681.07,-413.33"/>
<polygon fill="black" stroke="black" points="9681.97,-416.72 9691.12,-411.38 9680.64,-409.85 9681.97,-416.72"/>
</g>
<!-- l3_res_add_gpu8&#45;&gt;l3_res2_gpu8 -->
<g id="edge601" class="edge">
<title>l3_res_add_gpu8&#45;&gt;l3_res2_gpu8</title>
<path fill="none" stroke="black" d="M8634.52,-386.57C8662.13,-345.72 8739.12,-241.82 8833.57,-199.95 8913.82,-164.38 9515.71,-145.47 9717.13,-140.09"/>
<polygon fill="black" stroke="black" points="9717.36,-143.58 9727.27,-139.82 9717.18,-136.58 9717.36,-143.58"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_8_gpu9 -->
<g id="edge610" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_8_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-755.98C8877.84,-751.59 8895.83,-747.3 8912.57,-744.95 9118.17,-716.12 10560.51,-754.44 10806.22,-708.66"/>
<polygon fill="black" stroke="black" points="10806.97,-712.07 10816.06,-706.63 10805.56,-705.22 10806.97,-712.07"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_9_gpu9 -->
<g id="edge613" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_9_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-755.97C8877.84,-751.58 8895.83,-747.29 8912.57,-744.95 9130.55,-714.51 10660.27,-757.03 10919.04,-708.7"/>
<polygon fill="black" stroke="black" points="10919.97,-712.08 10929.06,-706.63 10918.56,-705.22 10919.97,-712.08"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_10_gpu9 -->
<g id="edge616" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_10_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-755.97C8877.84,-751.57 8895.83,-747.28 8912.57,-744.95 9142.94,-712.89 10760.2,-759.62 11031.9,-708.73"/>
<polygon fill="black" stroke="black" points="11032.97,-712.08 11042.06,-706.64 11031.56,-705.23 11032.97,-712.08"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_11_gpu9 -->
<g id="edge619" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_11_gpu9</title>
<path fill="none" stroke="black" d="M8862.51,-755.93C8878.22,-751.58 8896.01,-747.34 8912.57,-744.95 9201.91,-703.19 9937.73,-773.92 10240.89,-708.87"/>
<polygon fill="black" stroke="black" points="10242.06,-712.2 10251.05,-706.6 10240.53,-705.37 10242.06,-712.2"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_12_gpu9 -->
<g id="edge622" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_12_gpu9</title>
<path fill="none" stroke="black" d="M8862.02,-756.04C8877.85,-751.65 8895.84,-747.35 8912.57,-744.95 9226.84,-699.93 10026.35,-779.21 10354.02,-708.85"/>
<polygon fill="black" stroke="black" points="10355.05,-712.2 10364.05,-706.61 10353.53,-705.37 10355.05,-712.2"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_13_gpu9 -->
<g id="edge625" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_13_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-756.02C8877.85,-751.63 8895.84,-747.33 8912.57,-744.95 9251.73,-696.68 10114.79,-784.49 10467.04,-708.84"/>
<polygon fill="black" stroke="black" points="10468.05,-712.2 10477.06,-706.62 10466.53,-705.37 10468.05,-712.2"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_14_gpu9 -->
<g id="edge628" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_14_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-756.01C8877.85,-751.61 8895.84,-747.32 8912.57,-744.95 9276.65,-693.42 10203.42,-789.79 10580.16,-708.82"/>
<polygon fill="black" stroke="black" points="10581.05,-712.21 10590.06,-706.62 10579.54,-705.37 10581.05,-712.21"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_expert_15_gpu9 -->
<g id="edge631" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_expert_15_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-756C8877.84,-751.6 8895.83,-747.31 8912.57,-744.95 9105.71,-717.75 10459.57,-751.83 10693.09,-708.67"/>
<polygon fill="black" stroke="black" points="10693.97,-712.07 10703.06,-706.63 10692.56,-705.21 10693.97,-712.07"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_gate_gpu9 -->
<g id="edge608" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_gate_gpu9</title>
<path fill="none" stroke="black" d="M8828.09,-789.48C8845.03,-813.76 8879.27,-854.98 8921.57,-863.95 8939.39,-867.74 10215.5,-866.32 10233.57,-863.95 10346.23,-849.19 10474.35,-808.57 10538.82,-786.39"/>
<polygon fill="black" stroke="black" points="10540.3,-789.57 10548.6,-782.99 10538.01,-782.96 10540.3,-789.57"/>
</g>
<!-- l2_res_add_gpu9&#45;&gt;l2_res2_gpu9 -->
<g id="edge634" class="edge">
<title>l2_res_add_gpu9&#45;&gt;l2_res2_gpu9</title>
<path fill="none" stroke="black" d="M8826.42,-753.43C8851.34,-712.25 8921.44,-607.69 9012.57,-566.95 9031.35,-558.56 10320.66,-517.26 10628.22,-507.51"/>
<polygon fill="black" stroke="black" points="10628.44,-511.01 10638.32,-507.19 10628.21,-504.01 10628.44,-511.01"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_8_gpu9 -->
<g id="edge643" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_8_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-388.99C8877.84,-384.59 8895.83,-380.3 8912.57,-377.95 9117.3,-349.24 10553.55,-387.26 10798.26,-341.65"/>
<polygon fill="black" stroke="black" points="10798.97,-345.07 10808.06,-339.63 10797.56,-338.22 10798.97,-345.07"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_9_gpu9 -->
<g id="edge646" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_9_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-388.98C8877.84,-384.58 8895.83,-380.29 8912.57,-377.95 9129.68,-347.62 10653.31,-389.85 10911.08,-341.69"/>
<polygon fill="black" stroke="black" points="10911.97,-345.08 10921.06,-339.63 10910.56,-338.22 10911.97,-345.08"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_10_gpu9 -->
<g id="edge649" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_10_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-388.97C8877.84,-384.57 8895.83,-380.28 8912.57,-377.95 9142.07,-346 10753.23,-392.44 11023.93,-341.72"/>
<polygon fill="black" stroke="black" points="11024.97,-345.08 11034.06,-339.64 11023.56,-338.23 11024.97,-345.08"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_11_gpu9 -->
<g id="edge652" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_11_gpu9</title>
<path fill="none" stroke="black" d="M8862.51,-388.93C8878.22,-384.58 8896.01,-380.34 8912.57,-377.95 9200.17,-336.42 9931.57,-406.56 10232.95,-341.86"/>
<polygon fill="black" stroke="black" points="10234.06,-345.2 10243.05,-339.6 10232.53,-338.37 10234.06,-345.2"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_12_gpu9 -->
<g id="edge655" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_12_gpu9</title>
<path fill="none" stroke="black" d="M8862.02,-389.04C8877.85,-384.65 8895.84,-380.35 8912.57,-377.95 9225.09,-333.16 10020.18,-411.85 10346.08,-341.83"/>
<polygon fill="black" stroke="black" points="10347.05,-345.2 10356.05,-339.61 10345.53,-338.37 10347.05,-345.2"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_13_gpu9 -->
<g id="edge658" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_13_gpu9</title>
<path fill="none" stroke="black" d="M8862.02,-389.03C8877.85,-384.63 8895.84,-380.34 8912.57,-377.95 9249.98,-329.91 10108.61,-417.13 10459.09,-341.83"/>
<polygon fill="black" stroke="black" points="10460.05,-345.2 10469.05,-339.62 10458.53,-338.37 10460.05,-345.2"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_14_gpu9 -->
<g id="edge661" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_14_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-389.01C8877.85,-384.61 8895.84,-380.32 8912.57,-377.95 9274.91,-326.65 10197.23,-422.43 10572.21,-341.81"/>
<polygon fill="black" stroke="black" points="10573.05,-345.21 10582.06,-339.62 10571.54,-338.37 10573.05,-345.21"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_expert_15_gpu9 -->
<g id="edge664" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_expert_15_gpu9</title>
<path fill="none" stroke="black" d="M8862.01,-389C8877.84,-384.6 8895.83,-380.31 8912.57,-377.95 9104.84,-350.87 10452.63,-384.65 10685.14,-341.66"/>
<polygon fill="black" stroke="black" points="10685.97,-345.07 10695.06,-339.63 10684.56,-338.21 10685.97,-345.07"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_gate_gpu9 -->
<g id="edge641" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_gate_gpu9</title>
<path fill="none" stroke="black" d="M8837.36,-422.14C8857.39,-437.77 8889.33,-459.11 8921.57,-465.95 8939.29,-469.71 10207.53,-467.54 10225.57,-465.95 10335.78,-456.26 10463.42,-429.58 10528.89,-414.74"/>
<polygon fill="black" stroke="black" points="10529.88,-418.11 10538.85,-412.47 10528.32,-411.28 10529.88,-418.11"/>
</g>
<!-- l3_res_add_gpu9&#45;&gt;l3_res2_gpu9 -->
<g id="edge667" class="edge">
<title>l3_res_add_gpu9&#45;&gt;l3_res2_gpu9</title>
<path fill="none" stroke="black" d="M8826.42,-386.43C8851.34,-345.26 8921.44,-240.7 9012.57,-199.95 9031.27,-191.59 10315.22,-150.26 10621.5,-140.52"/>
<polygon fill="black" stroke="black" points="10621.67,-144.01 10631.55,-140.2 10621.44,-137.02 10621.67,-144.01"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_16_gpu10 -->
<g id="edge676" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_16_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-755.95C9080.73,-751.55 9099.83,-747.27 9117.57,-744.95 9387.88,-709.68 11286.24,-768.02 11597.09,-708.71"/>
<polygon fill="black" stroke="black" points="11597.98,-712.1 11607.06,-706.65 11596.56,-705.25 11597.98,-712.1"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_17_gpu10 -->
<g id="edge679" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_17_gpu10</title>
<path fill="none" stroke="black" d="M9063.64,-756.01C9080.53,-751.58 9099.74,-747.27 9117.57,-744.95 9400.34,-708.15 11386.96,-770.65 11710.13,-708.71"/>
<polygon fill="black" stroke="black" points="11710.98,-712.11 11720.06,-706.65 11709.56,-705.25 11710.98,-712.11"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_18_gpu10 -->
<g id="edge682" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_18_gpu10</title>
<path fill="none" stroke="black" d="M9063.64,-756C9080.53,-751.58 9099.74,-747.27 9117.57,-744.95 9412.81,-706.61 11487.85,-773.29 11823.2,-708.7"/>
<polygon fill="black" stroke="black" points="11823.98,-712.11 11833.06,-706.65 11822.56,-705.26 11823.98,-712.11"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_19_gpu10 -->
<g id="edge685" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_19_gpu10</title>
<path fill="none" stroke="black" d="M9063.64,-756C9080.53,-751.57 9099.74,-747.26 9117.57,-744.95 9425.22,-705.08 11587.84,-775.9 11936.06,-708.73"/>
<polygon fill="black" stroke="black" points="11936.99,-712.11 11946.06,-706.65 11935.56,-705.26 11936.99,-712.11"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_20_gpu10 -->
<g id="edge688" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_20_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-755.98C9080.73,-751.58 9099.83,-747.3 9117.57,-744.95 9338.05,-715.82 10883.55,-757.54 11144.94,-708.72"/>
<polygon fill="black" stroke="black" points="11145.97,-712.08 11155.06,-706.63 11144.56,-705.22 11145.97,-712.08"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_21_gpu10 -->
<g id="edge691" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_21_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-755.97C9080.73,-751.57 9099.83,-747.29 9117.57,-744.95 9350.57,-714.28 10985.11,-760.18 11258.21,-708.67"/>
<polygon fill="black" stroke="black" points="11258.97,-712.09 11268.06,-706.64 11257.56,-705.23 11258.97,-712.09"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_22_gpu10 -->
<g id="edge694" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_22_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-755.96C9080.73,-751.56 9099.83,-747.28 9117.57,-744.95 9362.99,-712.75 11085.32,-762.79 11371.13,-708.69"/>
<polygon fill="black" stroke="black" points="11371.98,-712.09 11381.06,-706.64 11370.56,-705.24 11371.98,-712.09"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_expert_23_gpu10 -->
<g id="edge697" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_expert_23_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-755.95C9080.73,-751.55 9099.83,-747.27 9117.57,-744.95 9375.43,-711.22 11185.69,-765.4 11484.09,-708.71"/>
<polygon fill="black" stroke="black" points="11484.98,-712.1 11494.06,-706.64 11483.56,-705.24 11484.98,-712.1"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_gate_gpu10 -->
<g id="edge674" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_gate_gpu10</title>
<path fill="none" stroke="black" d="M9028.04,-789.4C9046.29,-813.58 9082.89,-854.68 9126.57,-863.95 9153.89,-869.75 11109.87,-867.58 11137.57,-863.95 11250.23,-849.19 11378.35,-808.57 11442.82,-786.39"/>
<polygon fill="black" stroke="black" points="11444.3,-789.57 11452.6,-782.99 11442.01,-782.96 11444.3,-789.57"/>
</g>
<!-- l2_res_add_gpu10&#45;&gt;l2_res2_gpu10 -->
<g id="edge700" class="edge">
<title>l2_res_add_gpu10&#45;&gt;l2_res2_gpu10</title>
<path fill="none" stroke="black" d="M9021.3,-753.19C9036.05,-711.96 9079.63,-608.11 9156.57,-566.95 9206.69,-540.14 11145.77,-533.28 11202.57,-530.95 11318.71,-526.19 11453.83,-516.58 11532.14,-510.62"/>
<polygon fill="black" stroke="black" points="11532.63,-514.09 11542.33,-509.84 11532.1,-507.11 11532.63,-514.09"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_16_gpu10 -->
<g id="edge709" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_16_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-388.95C9080.73,-384.55 9099.83,-380.27 9117.57,-377.95 9387,-342.79 11279.25,-400.84 11589.12,-341.71"/>
<polygon fill="black" stroke="black" points="11589.98,-345.1 11599.06,-339.64 11588.56,-338.25 11589.98,-345.1"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_17_gpu10 -->
<g id="edge712" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_17_gpu10</title>
<path fill="none" stroke="black" d="M9063.64,-389.01C9080.53,-384.58 9099.74,-380.27 9117.57,-377.95 9399.46,-341.26 11379.96,-403.47 11702.16,-341.7"/>
<polygon fill="black" stroke="black" points="11702.98,-345.11 11712.06,-339.65 11701.56,-338.25 11702.98,-345.11"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_18_gpu10 -->
<g id="edge715" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_18_gpu10</title>
<path fill="none" stroke="black" d="M9063.64,-389C9080.53,-384.58 9099.74,-380.27 9117.57,-377.95 9411.94,-339.72 11480.84,-406.11 11815.23,-341.69"/>
<polygon fill="black" stroke="black" points="11815.98,-345.11 11825.06,-339.65 11814.56,-338.26 11815.98,-345.11"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_19_gpu10 -->
<g id="edge718" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_19_gpu10</title>
<path fill="none" stroke="black" d="M9063.64,-389C9080.53,-384.57 9099.74,-380.26 9117.57,-377.95 9424.34,-338.19 11580.84,-408.72 11928.09,-341.73"/>
<polygon fill="black" stroke="black" points="11928.99,-345.11 11938.06,-339.65 11927.56,-338.26 11928.99,-345.11"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_20_gpu10 -->
<g id="edge721" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_20_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-388.98C9080.73,-384.58 9099.83,-380.3 9117.57,-377.95 9337.18,-348.93 10876.59,-390.36 11136.98,-341.71"/>
<polygon fill="black" stroke="black" points="11137.97,-345.08 11147.06,-339.63 11136.56,-338.22 11137.97,-345.08"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_21_gpu10 -->
<g id="edge724" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_21_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-388.97C9080.73,-384.57 9099.83,-380.29 9117.57,-377.95 9349.7,-347.39 10978.14,-393 11250.24,-341.67"/>
<polygon fill="black" stroke="black" points="11250.98,-345.09 11260.06,-339.64 11249.56,-338.23 11250.98,-345.09"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_22_gpu10 -->
<g id="edge727" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_22_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-388.96C9080.73,-384.56 9099.83,-380.28 9117.57,-377.95 9362.12,-345.86 11078.34,-395.61 11363.16,-341.69"/>
<polygon fill="black" stroke="black" points="11363.98,-345.09 11373.06,-339.64 11362.56,-338.24 11363.98,-345.09"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_expert_23_gpu10 -->
<g id="edge730" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_expert_23_gpu10</title>
<path fill="none" stroke="black" d="M9063.9,-388.96C9080.73,-384.56 9099.83,-380.27 9117.57,-377.95 9374.56,-344.33 11178.71,-398.22 11476.12,-341.7"/>
<polygon fill="black" stroke="black" points="11476.98,-345.1 11486.06,-339.64 11475.56,-338.24 11476.98,-345.1"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_gate_gpu10 -->
<g id="edge707" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_gate_gpu10</title>
<path fill="none" stroke="black" d="M9037.76,-422.01C9059.08,-437.54 9092.95,-458.82 9126.57,-465.95 9153.78,-471.73 11101.86,-468.39 11129.57,-465.95 11239.78,-456.26 11367.42,-429.58 11432.89,-414.74"/>
<polygon fill="black" stroke="black" points="11433.88,-418.11 11442.85,-412.47 11432.32,-411.28 11433.88,-418.11"/>
</g>
<!-- l3_res_add_gpu10&#45;&gt;l3_res2_gpu10 -->
<g id="edge733" class="edge">
<title>l3_res_add_gpu10&#45;&gt;l3_res2_gpu10</title>
<path fill="none" stroke="black" d="M9021.3,-386.19C9036.05,-344.95 9079.62,-241.1 9156.57,-199.95 9207.89,-172.51 11193.43,-166.64 11251.57,-163.95 11346.48,-159.56 11456.12,-150.57 11524.16,-144.52"/>
<polygon fill="black" stroke="black" points="11524.65,-147.99 11534.3,-143.61 11524.03,-141.02 11524.65,-147.99"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_24_gpu11 -->
<g id="edge742" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_24_gpu11</title>
<path fill="none" stroke="black" d="M9272.67,-756.4C9291.97,-751.83 9314.12,-747.33 9334.57,-744.95 9681.08,-704.68 12114.44,-784.09 12501.01,-708.75"/>
<polygon fill="black" stroke="black" points="12501.99,-712.12 12511.06,-706.66 12500.56,-705.27 12501.99,-712.12"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_25_gpu11 -->
<g id="edge745" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_25_gpu11</title>
<path fill="none" stroke="black" d="M9272.39,-756.46C9291.75,-751.87 9314.02,-747.34 9334.57,-744.95 9693.62,-703.29 12216.07,-786.76 12614.25,-708.71"/>
<polygon fill="black" stroke="black" points="12614.99,-712.13 12624.06,-706.66 12613.56,-705.28 12614.99,-712.13"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_26_gpu11 -->
<g id="edge748" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_26_gpu11</title>
<path fill="none" stroke="black" d="M9272.39,-756.46C9291.75,-751.87 9314.02,-747.33 9334.57,-744.95 9519.23,-723.56 12459.47,-749.17 12727.2,-708.45"/>
<polygon fill="black" stroke="black" points="12727.85,-711.89 12737.06,-706.66 12726.6,-705.01 12727.85,-711.89"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_27_gpu11 -->
<g id="edge751" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_27_gpu11</title>
<path fill="none" stroke="black" d="M9272.39,-756.45C9291.75,-751.86 9314.02,-747.33 9334.57,-744.95 9525.38,-722.88 12563.51,-750.44 12839.88,-708.51"/>
<polygon fill="black" stroke="black" points="12840.85,-711.89 12850.06,-706.66 12839.6,-705 12840.85,-711.89"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_28_gpu11 -->
<g id="edge754" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_28_gpu11</title>
<path fill="none" stroke="black" d="M9272.39,-756.45C9291.75,-751.86 9314.02,-747.33 9334.57,-744.95 9531.63,-722.19 12670.65,-751.74 12952.99,-708.5"/>
<polygon fill="black" stroke="black" points="12953.86,-711.9 12963.07,-706.66 12952.6,-705.01 12953.86,-711.9"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_29_gpu11 -->
<g id="edge757" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_29_gpu11</title>
<path fill="none" stroke="black" d="M9272.68,-756.41C9291.97,-751.85 9314.12,-747.34 9334.57,-744.95 9643.67,-708.81 11812.73,-776.19 12162.03,-708.74"/>
<polygon fill="black" stroke="black" points="12162.99,-712.11 12172.06,-706.65 12161.56,-705.26 12162.99,-712.11"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_30_gpu11 -->
<g id="edge760" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_30_gpu11</title>
<path fill="none" stroke="black" d="M9272.68,-756.41C9291.97,-751.84 9314.12,-747.34 9334.57,-744.95 9656.19,-707.43 11913.93,-778.84 12275.17,-708.71"/>
<polygon fill="black" stroke="black" points="12275.99,-712.12 12285.06,-706.65 12274.56,-705.27 12275.99,-712.12"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_expert_31_gpu11 -->
<g id="edge763" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_expert_31_gpu11</title>
<path fill="none" stroke="black" d="M9272.67,-756.4C9291.97,-751.84 9314.12,-747.33 9334.57,-744.95 9668.63,-706.05 12014.14,-781.46 12388.08,-708.74"/>
<polygon fill="black" stroke="black" points="12388.99,-712.12 12398.06,-706.65 12387.56,-705.27 12388.99,-712.12"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_gate_gpu11 -->
<g id="edge740" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_gate_gpu11</title>
<path fill="none" stroke="black" d="M9235.26,-789.64C9256.22,-813.68 9297.31,-854.14 9343.57,-863.95 9361.9,-867.84 12022.95,-866.06 12041.57,-863.95 12175.75,-848.79 12330.32,-806.15 12403.27,-784.46"/>
<polygon fill="black" stroke="black" points="12404.43,-787.77 12413.01,-781.55 12402.43,-781.06 12404.43,-787.77"/>
</g>
<!-- l2_res_add_gpu11&#45;&gt;l2_res2_gpu11 -->
<g id="edge766" class="edge">
<title>l2_res_add_gpu11&#45;&gt;l2_res2_gpu11</title>
<path fill="none" stroke="black" d="M9220.51,-753.3C9221.43,-712.77 9230.05,-611.19 9291.57,-566.95 9360.58,-517.32 12266.72,-536.16 12351.57,-530.95 12406.88,-527.56 12469.38,-520.37 12515.1,-514.49"/>
<polygon fill="black" stroke="black" points="12515.71,-517.94 12525.17,-513.18 12514.8,-511 12515.71,-517.94"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_24_gpu11 -->
<g id="edge775" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_24_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.12C9287.71,-384.65 9307.88,-380.28 9326.57,-377.95 9673.49,-334.82 12112.9,-417.22 12499.27,-341.7"/>
<polygon fill="black" stroke="black" points="12499.99,-345.13 12509.06,-339.66 12498.56,-338.28 12499.99,-345.13"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_25_gpu11 -->
<g id="edge778" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_25_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.12C9287.7,-384.64 9307.88,-380.27 9326.57,-377.95 9685.93,-333.34 12213.33,-419.85 12612.23,-341.71"/>
<polygon fill="black" stroke="black" points="12612.99,-345.13 12622.06,-339.66 12611.56,-338.28 12612.99,-345.13"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_26_gpu11 -->
<g id="edge781" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_26_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.11C9287.7,-384.64 9307.88,-380.27 9326.57,-377.95 9698.39,-331.86 12313.85,-422.48 12725.2,-341.72"/>
<polygon fill="black" stroke="black" points="12725.99,-345.13 12735.06,-339.66 12724.56,-338.28 12725.99,-345.13"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_27_gpu11 -->
<g id="edge784" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_27_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.11C9287.7,-384.63 9307.88,-380.27 9326.57,-377.95 9517.52,-354.31 12561.02,-383.46 12837.86,-341.51"/>
<polygon fill="black" stroke="black" points="12838.85,-344.89 12848.06,-339.66 12837.6,-338 12838.85,-344.89"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_28_gpu11 -->
<g id="edge787" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_28_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.11C9287.7,-384.63 9307.88,-380.26 9326.57,-377.95 9523.77,-353.57 12668.03,-384.13 12950.79,-341.57"/>
<polygon fill="black" stroke="black" points="12951.66,-344.97 12960.88,-339.76 12950.42,-338.08 12951.66,-344.97"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_29_gpu11 -->
<g id="edge790" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_29_gpu11</title>
<path fill="none" stroke="black" d="M9270.03,-389.14C9287.71,-384.66 9307.88,-380.29 9326.57,-377.95 9635.38,-339.34 11804.51,-408.14 12153.84,-341.8"/>
<polygon fill="black" stroke="black" points="12154.78,-345.18 12163.88,-339.75 12153.38,-338.33 12154.78,-345.18"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_30_gpu11 -->
<g id="edge793" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_30_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.13C9287.71,-384.66 9307.88,-380.29 9326.57,-377.95 9648.1,-337.83 11907.45,-410.8 12268.98,-341.78"/>
<polygon fill="black" stroke="black" points="12269.79,-345.19 12278.88,-339.75 12268.38,-338.33 12269.79,-345.19"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_expert_31_gpu11 -->
<g id="edge796" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_expert_31_gpu11</title>
<path fill="none" stroke="black" d="M9270.02,-389.13C9287.71,-384.65 9307.88,-380.28 9326.57,-377.95 9660.74,-336.33 12009.41,-413.42 12383.88,-341.8"/>
<polygon fill="black" stroke="black" points="12384.79,-345.19 12393.88,-339.75 12383.38,-338.33 12384.79,-345.19"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_gate_gpu11 -->
<g id="edge773" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_gate_gpu11</title>
<path fill="none" stroke="black" d="M9243.69,-421.92C9265.87,-437.39 9301.02,-458.62 9335.57,-465.95 9353.92,-469.85 12017.86,-467.36 12036.57,-465.95 12169.13,-455.97 12324,-427.9 12398.34,-413.39"/>
<polygon fill="black" stroke="black" points="12399.14,-416.8 12408.28,-411.43 12397.79,-409.93 12399.14,-416.8"/>
</g>
<!-- l3_res_add_gpu11&#45;&gt;l3_res2_gpu11 -->
<g id="edge799" class="edge">
<title>l3_res_add_gpu11&#45;&gt;l3_res2_gpu11</title>
<path fill="none" stroke="black" d="M9219.81,-386.37C9219.06,-346.01 9223.55,-244.74 9283.57,-199.95 9352.54,-148.48 12295.67,-169.18 12381.57,-163.95 12437.54,-160.55 12500.83,-153.32 12546.99,-147.43"/>
<polygon fill="black" stroke="black" points="12547.69,-150.87 12557.16,-146.12 12546.79,-143.93 12547.69,-150.87"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_32_gpu12 -->
<g id="edge808" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_32_gpu12</title>
<path fill="none" stroke="black" d="M17594.46,-756.4C17575.17,-751.83 17553.02,-747.33 17532.57,-744.95 17193.39,-705.49 14811.72,-781.46 14432.17,-708.49"/>
<polygon fill="black" stroke="black" points="14432.8,-705.04 14422.3,-706.46 14431.39,-711.9 14432.8,-705.04"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_33_gpu12 -->
<g id="edge811" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_33_gpu12</title>
<path fill="none" stroke="black" d="M17594.46,-756.4C17575.17,-751.84 17553.02,-747.34 17532.57,-744.95 17205.84,-706.86 14911.98,-778.87 14545.09,-708.47"/>
<polygon fill="black" stroke="black" points="14545.8,-705.04 14535.3,-706.45 14544.39,-711.9 14545.8,-705.04"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_34_gpu12 -->
<g id="edge814" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_34_gpu12</title>
<path fill="none" stroke="black" d="M17594.46,-756.41C17575.17,-751.84 17553.01,-747.34 17532.57,-744.95 17218.36,-708.25 15013.25,-776.26 14658.26,-708.5"/>
<polygon fill="black" stroke="black" points="14658.8,-705.03 14648.3,-706.45 14657.39,-711.89 14658.8,-705.03"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_35_gpu12 -->
<g id="edge817" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_35_gpu12</title>
<path fill="none" stroke="black" d="M17594.75,-756.45C17575.39,-751.86 17553.12,-747.33 17532.57,-744.95 17332.57,-721.87 14146.87,-751.71 13859.56,-708.31"/>
<polygon fill="black" stroke="black" points="13859.76,-704.79 13849.3,-706.46 13858.52,-711.68 13859.76,-704.79"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_36_gpu12 -->
<g id="edge820" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_36_gpu12</title>
<path fill="none" stroke="black" d="M17594.75,-756.45C17575.39,-751.86 17553.12,-747.33 17532.57,-744.95 17338.83,-722.56 14252.97,-749.83 13974.11,-708.23"/>
<polygon fill="black" stroke="black" points="13974.61,-704.76 13964.15,-706.46 13973.38,-711.66 13974.61,-704.76"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_37_gpu12 -->
<g id="edge823" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_37_gpu12</title>
<path fill="none" stroke="black" d="M17594.75,-756.45C17575.39,-751.86 17553.12,-747.33 17532.57,-744.95 17155.58,-701.31 14507.16,-788.14 14089.17,-708.5"/>
<polygon fill="black" stroke="black" points="14089.65,-705.02 14079.15,-706.46 14088.25,-711.88 14089.65,-705.02"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_38_gpu12 -->
<g id="edge826" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_38_gpu12</title>
<path fill="none" stroke="black" d="M17594.75,-756.46C17575.39,-751.87 17553.12,-747.34 17532.57,-744.95 17168.26,-702.71 14609.43,-785.54 14204.15,-708.49"/>
<polygon fill="black" stroke="black" points="14204.65,-705.02 14194.15,-706.46 14203.25,-711.88 14204.65,-705.02"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_expert_39_gpu12 -->
<g id="edge829" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_expert_39_gpu12</title>
<path fill="none" stroke="black" d="M17594.75,-756.46C17575.39,-751.87 17553.12,-747.34 17532.57,-744.95 17180.94,-704.11 14711.61,-782.94 14319.1,-708.47"/>
<polygon fill="black" stroke="black" points="14319.65,-705.01 14309.15,-706.46 14318.25,-711.87 14319.65,-705.01"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_gate_gpu12 -->
<g id="edge806" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_gate_gpu12</title>
<path fill="none" stroke="black" d="M17631.87,-789.64C17610.92,-813.68 17569.83,-854.14 17523.57,-863.95 17504.96,-867.9 14803.47,-866.06 14784.57,-863.95 14655.56,-849.58 14507.87,-810.52 14429.75,-788.02"/>
<polygon fill="black" stroke="black" points="14430.7,-784.65 14420.12,-785.23 14428.75,-791.37 14430.7,-784.65"/>
</g>
<!-- l2_res_add_gpu12&#45;&gt;l2_res2_gpu12 -->
<g id="edge832" class="edge">
<title>l2_res_add_gpu12&#45;&gt;l2_res2_gpu12</title>
<path fill="none" stroke="black" d="M17646.1,-753.25C17643.94,-712.62 17632.23,-610.82 17569.57,-566.95 17503.34,-520.6 14740.36,-533.71 14659.57,-530.95 14519.96,-526.2 14356.6,-515.95 14267.93,-509.99"/>
<polygon fill="black" stroke="black" points="14267.97,-506.49 14257.76,-509.31 14267.5,-513.47 14267.97,-506.49"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_32_gpu12 -->
<g id="edge841" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_32_gpu12</title>
<path fill="none" stroke="black" d="M17597.11,-389.12C17579.43,-384.65 17559.26,-380.28 17540.57,-377.95 17201.28,-335.72 14816.45,-413.43 14436.05,-341.46"/>
<polygon fill="black" stroke="black" points="14436.65,-338.01 14426.15,-339.46 14435.26,-344.87 14436.65,-338.01"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_33_gpu12 -->
<g id="edge844" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_33_gpu12</title>
<path fill="none" stroke="black" d="M17597.11,-389.13C17579.43,-384.65 17559.26,-380.28 17540.57,-377.95 17213.93,-337.22 14918.46,-410.84 14550.96,-341.44"/>
<polygon fill="black" stroke="black" points="14551.65,-338.01 14541.15,-339.45 14550.26,-344.87 14551.65,-338.01"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_34_gpu12 -->
<g id="edge847" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_34_gpu12</title>
<path fill="none" stroke="black" d="M17597.11,-389.13C17579.43,-384.66 17559.26,-380.29 17540.57,-377.95 17226.66,-338.73 15021.47,-408.22 14666.12,-341.47"/>
<polygon fill="black" stroke="black" points="14666.65,-338 14656.15,-339.45 14665.26,-344.86 14666.65,-338"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_35_gpu12 -->
<g id="edge850" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_35_gpu12</title>
<path fill="none" stroke="black" d="M17597.12,-389.1C17579.43,-384.63 17559.26,-380.26 17540.57,-377.95 17340.33,-353.21 14146.32,-384.14 13861.01,-341.22"/>
<polygon fill="black" stroke="black" points="13861.61,-337.77 13851.15,-339.46 13860.38,-344.66 13861.61,-337.77"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_36_gpu12 -->
<g id="edge853" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_36_gpu12</title>
<path fill="none" stroke="black" d="M17597.12,-389.11C17579.43,-384.63 17559.26,-380.27 17540.57,-377.95 17150.6,-329.71 14407.53,-423.83 13976.2,-341.5"/>
<polygon fill="black" stroke="black" points="13976.65,-338.02 13966.15,-339.46 13975.25,-344.88 13976.65,-338.02"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_37_gpu12 -->
<g id="edge856" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_37_gpu12</title>
<path fill="none" stroke="black" d="M17597.11,-389.11C17579.43,-384.64 17559.26,-380.27 17540.57,-377.95 17163.28,-331.21 14509.89,-421.22 14091.19,-341.5"/>
<polygon fill="black" stroke="black" points="14091.65,-338.02 14081.15,-339.46 14090.25,-344.88 14091.65,-338.02"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_38_gpu12 -->
<g id="edge859" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_38_gpu12</title>
<path fill="none" stroke="black" d="M17597.11,-389.12C17579.43,-384.64 17559.26,-380.27 17540.57,-377.95 17175.95,-332.72 14612.17,-418.62 14206.16,-341.49"/>
<polygon fill="black" stroke="black" points="14206.65,-338.02 14196.15,-339.46 14205.25,-344.88 14206.65,-338.02"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_expert_39_gpu12 -->
<g id="edge862" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_expert_39_gpu12</title>
<path fill="none" stroke="black" d="M17597.11,-389.12C17579.43,-384.65 17559.26,-380.28 17540.57,-377.95 17188.62,-334.22 14714.35,-416.02 14321.12,-341.48"/>
<polygon fill="black" stroke="black" points="14321.65,-338.01 14311.15,-339.46 14320.25,-344.87 14321.65,-338.01"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_gate_gpu12 -->
<g id="edge839" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_gate_gpu12</title>
<path fill="none" stroke="black" d="M17623.45,-421.92C17601.26,-437.39 17566.12,-458.62 17531.57,-465.95 17512.95,-469.9 14809.55,-467.36 14790.57,-465.95 14660.32,-456.31 14508.85,-429.78 14430.54,-414.91"/>
<polygon fill="black" stroke="black" points="14430.92,-411.42 14420.44,-412.98 14429.61,-418.29 14430.92,-411.42"/>
</g>
<!-- l3_res_add_gpu12&#45;&gt;l3_res2_gpu12 -->
<g id="edge865" class="edge">
<title>l3_res_add_gpu12&#45;&gt;l3_res2_gpu12</title>
<path fill="none" stroke="black" d="M17646.8,-386.32C17646.29,-345.84 17638.69,-244.35 17577.57,-199.95 17513.4,-153.34 14801.84,-166.55 14722.57,-163.95 14573.43,-159.07 14398.55,-148.64 14305.9,-142.75"/>
<polygon fill="black" stroke="black" points="14306.04,-139.25 14295.84,-142.1 14305.59,-146.23 14306.04,-139.25"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_40_gpu13 -->
<g id="edge874" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_40_gpu13</title>
<path fill="none" stroke="black" d="M17803.5,-756.01C17786.61,-751.58 17767.4,-747.27 17749.57,-744.95 17462.44,-707.61 15445.59,-769.74 15116.28,-708.49"/>
<polygon fill="black" stroke="black" points="15116.65,-704.99 15106.15,-706.45 15115.26,-711.85 15116.65,-704.99"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_41_gpu13 -->
<g id="edge877" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_41_gpu13</title>
<path fill="none" stroke="black" d="M17803.24,-755.95C17786.41,-751.54 17767.31,-747.27 17749.57,-744.95 17475.12,-709.17 15548.07,-767.14 15231.32,-708.49"/>
<polygon fill="black" stroke="black" points="15231.65,-704.99 15221.15,-706.45 15230.27,-711.85 15231.65,-704.99"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_42_gpu13 -->
<g id="edge880" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_42_gpu13</title>
<path fill="none" stroke="black" d="M17803.24,-755.95C17786.41,-751.55 17767.31,-747.27 17749.57,-744.95 17487.78,-710.73 15650.38,-764.55 15346.32,-708.48"/>
<polygon fill="black" stroke="black" points="15346.65,-704.98 15336.15,-706.44 15345.27,-711.84 15346.65,-704.98"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_43_gpu13 -->
<g id="edge883" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_43_gpu13</title>
<path fill="none" stroke="black" d="M17803.24,-755.96C17786.41,-751.56 17767.31,-747.28 17749.57,-744.95 17500.44,-712.29 15752.51,-761.97 15461.28,-708.47"/>
<polygon fill="black" stroke="black" points="15461.65,-704.98 15451.15,-706.44 15460.27,-711.84 15461.65,-704.98"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_44_gpu13 -->
<g id="edge886" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_44_gpu13</title>
<path fill="none" stroke="black" d="M17803.23,-755.97C17786.41,-751.57 17767.3,-747.29 17749.57,-744.95 17513.08,-713.85 15854.46,-759.4 15576.2,-708.45"/>
<polygon fill="black" stroke="black" points="15576.65,-704.97 15566.15,-706.44 15575.27,-711.84 15576.65,-704.97"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_45_gpu13 -->
<g id="edge889" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_45_gpu13</title>
<path fill="none" stroke="black" d="M17803.23,-755.98C17786.41,-751.58 17767.3,-747.29 17749.57,-744.95 17525.71,-715.41 15956.25,-756.84 15691.08,-708.42"/>
<polygon fill="black" stroke="black" points="15691.65,-704.97 15681.15,-706.43 15690.27,-711.83 15691.65,-704.97"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_46_gpu13 -->
<g id="edge892" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_46_gpu13</title>
<path fill="none" stroke="black" d="M17803.5,-756C17786.61,-751.57 17767.4,-747.26 17749.57,-744.95 17437.04,-704.48 15240.11,-774.95 14886.08,-708.46"/>
<polygon fill="black" stroke="black" points="14886.65,-705 14876.15,-706.45 14885.26,-711.86 14886.65,-705"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_expert_47_gpu13 -->
<g id="edge895" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_expert_47_gpu13</title>
<path fill="none" stroke="black" d="M17803.5,-756C17786.61,-751.58 17767.4,-747.27 17749.57,-744.95 17449.74,-706.05 15342.94,-772.34 15001.2,-708.48"/>
<polygon fill="black" stroke="black" points="15001.65,-705 14991.15,-706.45 15000.26,-711.86 15001.65,-705"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_gate_gpu13 -->
<g id="edge872" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_gate_gpu13</title>
<path fill="none" stroke="black" d="M17839.1,-789.4C17820.85,-813.58 17784.25,-854.68 17740.57,-863.95 17712.87,-869.83 15729.66,-867.53 15701.57,-863.95 15593.36,-850.16 15471.06,-813.76 15401.36,-790.95"/>
<polygon fill="black" stroke="black" points="15402.05,-787.49 15391.46,-787.69 15399.86,-794.14 15402.05,-787.49"/>
</g>
<!-- l2_res_add_gpu13&#45;&gt;l2_res2_gpu13 -->
<g id="edge898" class="edge">
<title>l2_res_add_gpu13&#45;&gt;l2_res2_gpu13</title>
<path fill="none" stroke="black" d="M17841.38,-753.34C17815.64,-711.96 17743.36,-606.98 17650.57,-566.95 17570.77,-532.53 16173.45,-533.25 16086.57,-530.95 15791.16,-523.16 15438.52,-512.12 15295.08,-507.55"/>
<polygon fill="black" stroke="black" points="15294.82,-504.04 15284.71,-507.22 15294.59,-511.04 15294.82,-504.04"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_40_gpu13 -->
<g id="edge907" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_40_gpu13</title>
<path fill="none" stroke="black" d="M17803.5,-389.01C17786.61,-384.58 17767.4,-380.27 17749.57,-377.95 17463.31,-340.72 15452.59,-402.56 15124.25,-341.48"/>
<polygon fill="black" stroke="black" points="15124.65,-337.99 15114.15,-339.45 15123.26,-344.85 15124.65,-337.99"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_41_gpu13 -->
<g id="edge910" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_41_gpu13</title>
<path fill="none" stroke="black" d="M17803.24,-388.95C17786.41,-384.55 17767.31,-380.27 17749.57,-377.95 17475.99,-342.28 15555.06,-399.96 15239.29,-341.48"/>
<polygon fill="black" stroke="black" points="15239.65,-337.99 15229.15,-339.45 15238.27,-344.85 15239.65,-337.99"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_42_gpu13 -->
<g id="edge913" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_42_gpu13</title>
<path fill="none" stroke="black" d="M17803.24,-388.95C17786.41,-384.55 17767.31,-380.27 17749.57,-377.95 17488.66,-343.84 15657.36,-397.38 15354.28,-341.48"/>
<polygon fill="black" stroke="black" points="15354.65,-337.98 15344.15,-339.44 15353.27,-344.84 15354.65,-337.98"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_43_gpu13 -->
<g id="edge916" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_43_gpu13</title>
<path fill="none" stroke="black" d="M17803.24,-388.96C17786.41,-384.56 17767.3,-380.28 17749.57,-377.95 17501.31,-345.4 15759.49,-394.8 15469.24,-341.47"/>
<polygon fill="black" stroke="black" points="15469.65,-337.98 15459.15,-339.44 15468.27,-344.84 15469.65,-337.98"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_44_gpu13 -->
<g id="edge919" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_44_gpu13</title>
<path fill="none" stroke="black" d="M17803.23,-388.97C17786.41,-384.57 17767.3,-380.29 17749.57,-377.95 17513.95,-346.96 15861.44,-392.23 15584.16,-341.44"/>
<polygon fill="black" stroke="black" points="15584.65,-337.97 15574.15,-339.44 15583.27,-344.84 15584.65,-337.97"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_45_gpu13 -->
<g id="edge922" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_45_gpu13</title>
<path fill="none" stroke="black" d="M17803.23,-388.98C17786.41,-384.58 17767.3,-380.29 17749.57,-377.95 17526.58,-348.51 15963.21,-389.67 15699.04,-341.42"/>
<polygon fill="black" stroke="black" points="15699.65,-337.97 15689.15,-339.43 15698.27,-344.83 15699.65,-337.97"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_46_gpu13 -->
<g id="edge925" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_46_gpu13</title>
<path fill="none" stroke="black" d="M17803.5,-389C17786.61,-384.57 17767.4,-380.26 17749.57,-377.95 17437.91,-337.59 15247.12,-407.77 14894.06,-341.45"/>
<polygon fill="black" stroke="black" points="14894.65,-338 14884.15,-339.45 14893.26,-344.86 14894.65,-338"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_expert_47_gpu13 -->
<g id="edge928" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_expert_47_gpu13</title>
<path fill="none" stroke="black" d="M17803.5,-389C17786.61,-384.58 17767.4,-380.27 17749.57,-377.95 17450.62,-339.16 15349.94,-405.16 15009.17,-341.47"/>
<polygon fill="black" stroke="black" points="15009.65,-338 14999.15,-339.45 15008.26,-344.86 15009.65,-338"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_gate_gpu13 -->
<g id="edge905" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_gate_gpu13</title>
<path fill="none" stroke="black" d="M17829.38,-422.01C17808.05,-437.54 17774.19,-458.82 17740.57,-465.95 17712.2,-471.97 15681.42,-468.88 15652.57,-465.95 15565.81,-457.15 15467.08,-434.39 15407.33,-419.16"/>
<polygon fill="black" stroke="black" points="15407.92,-415.7 15397.36,-416.6 15406.18,-422.48 15407.92,-415.7"/>
</g>
<!-- l3_res_add_gpu13&#45;&gt;l3_res2_gpu13 -->
<g id="edge931" class="edge">
<title>l3_res_add_gpu13&#45;&gt;l3_res2_gpu13</title>
<path fill="none" stroke="black" d="M17841.98,-386.36C17817.68,-345.02 17749.15,-240.13 17658.57,-199.95 17579.12,-164.72 16181.45,-166.25 16094.57,-163.95 15799.16,-156.16 15446.52,-145.12 15303.08,-140.55"/>
<polygon fill="black" stroke="black" points="15302.82,-137.04 15292.71,-140.22 15302.59,-144.04 15302.82,-137.04"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_48_gpu14 -->
<g id="edge940" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_48_gpu14</title>
<path fill="none" stroke="black" d="M18007.96,-756C17991.2,-751.64 17972.2,-747.36 17954.57,-744.95 17661.73,-704.92 16918.31,-772.81 16611.02,-708.54"/>
<polygon fill="black" stroke="black" points="16611.68,-705.1 16601.16,-706.4 16610.19,-711.94 16611.68,-705.1"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_49_gpu14 -->
<g id="edge943" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_49_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-755.97C17991.41,-751.57 17972.3,-747.29 17954.57,-744.95 17720.81,-714.19 16081.25,-758.85 15806.09,-708.43"/>
<polygon fill="black" stroke="black" points="15806.65,-704.97 15796.15,-706.44 15805.27,-711.84 15806.65,-704.97"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_50_gpu14 -->
<g id="edge946" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_50_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-755.98C17991.41,-751.58 17972.3,-747.3 17954.57,-744.95 17733.43,-715.74 16183.02,-756.29 15920.96,-708.4"/>
<polygon fill="black" stroke="black" points="15921.65,-704.97 15911.15,-706.43 15920.27,-711.83 15921.65,-704.97"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_51_gpu14 -->
<g id="edge949" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_51_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-755.99C17991.41,-751.59 17972.3,-747.31 17954.57,-744.95 17746.15,-717.31 16286.05,-753.7 16036.17,-708.43"/>
<polygon fill="black" stroke="black" points="16036.65,-704.96 16026.16,-706.43 16035.28,-711.82 16036.65,-704.96"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_52_gpu14 -->
<g id="edge952" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_52_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-756C17991.4,-751.61 17972.3,-747.32 17954.57,-744.95 17560.31,-692.42 16558.44,-793.66 16150.97,-708.54"/>
<polygon fill="black" stroke="black" points="16151.67,-705.11 16141.16,-706.43 16150.2,-711.95 16151.67,-705.11"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_53_gpu14 -->
<g id="edge955" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_53_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-756.02C17991.4,-751.62 17972.3,-747.33 17954.57,-744.95 17585.74,-695.55 16648.78,-788.4 16266.2,-708.58"/>
<polygon fill="black" stroke="black" points="16266.67,-705.1 16256.16,-706.42 16265.2,-711.95 16266.67,-705.1"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_54_gpu14 -->
<g id="edge958" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_54_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-756.03C17991.4,-751.64 17972.3,-747.34 17954.57,-744.95 17611.05,-698.67 16738.5,-783.21 16381.06,-708.55"/>
<polygon fill="black" stroke="black" points="16381.67,-705.1 16371.16,-706.41 16380.19,-711.95 16381.67,-705.1"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_expert_55_gpu14 -->
<g id="edge961" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_expert_55_gpu14</title>
<path fill="none" stroke="black" d="M18007.97,-755.98C17991.2,-751.61 17972.2,-747.35 17954.57,-744.95 17636.49,-701.81 16828.9,-777.96 16496.34,-708.61"/>
<polygon fill="black" stroke="black" points="16496.67,-705.1 16486.16,-706.41 16495.19,-711.94 16496.67,-705.1"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_gate_gpu14 -->
<g id="edge938" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_gate_gpu14</title>
<path fill="none" stroke="black" d="M18044.1,-789.4C18025.85,-813.58 17989.25,-854.68 17945.57,-863.95 17927.57,-867.77 16638.82,-866.29 16620.57,-863.95 16512.8,-850.18 16391.04,-813.86 16321.48,-791.04"/>
<polygon fill="black" stroke="black" points="16322.2,-787.6 16311.61,-787.78 16320,-794.24 16322.2,-787.6"/>
</g>
<!-- l2_res_add_gpu14&#45;&gt;l2_res2_gpu14 -->
<g id="edge964" class="edge">
<title>l2_res_add_gpu14&#45;&gt;l2_res2_gpu14</title>
<path fill="none" stroke="black" d="M18044.1,-753.32C18012.78,-711.92 17926.03,-606.87 17824.57,-566.95 17699.09,-517.58 16746.28,-536.68 16611.57,-530.95 16470.45,-524.96 16305.19,-515.13 16215.88,-509.59"/>
<polygon fill="black" stroke="black" points="16216.09,-506.1 16205.9,-508.97 16215.66,-513.09 16216.09,-506.1"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_48_gpu14 -->
<g id="edge973" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_48_gpu14</title>
<path fill="none" stroke="black" d="M18007.96,-389.01C17991.2,-384.64 17972.2,-380.37 17954.57,-377.95 17663.47,-338.13 16924.47,-405.46 16618.96,-341.53"/>
<polygon fill="black" stroke="black" points="16619.68,-338.1 16609.16,-339.4 16618.19,-344.94 16619.68,-338.1"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_49_gpu14 -->
<g id="edge976" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_49_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-388.97C17991.41,-384.57 17972.3,-380.29 17954.57,-377.95 17721.68,-347.29 16088.23,-391.68 15814.05,-341.42"/>
<polygon fill="black" stroke="black" points="15814.65,-337.97 15804.15,-339.44 15813.27,-344.84 15814.65,-337.97"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_50_gpu14 -->
<g id="edge979" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_50_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-388.98C17991.41,-384.58 17972.3,-380.3 17954.57,-377.95 17734.41,-348.86 16191.51,-389.08 15929.31,-341.46"/>
<polygon fill="black" stroke="black" points="15929.65,-337.96 15919.15,-339.43 15928.27,-344.83 15929.65,-337.96"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_51_gpu14 -->
<g id="edge982" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_51_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-388.99C17991.41,-384.59 17972.3,-380.31 17954.57,-377.95 17747.02,-350.42 16293.01,-386.53 16044.13,-341.42"/>
<polygon fill="black" stroke="black" points="16044.65,-337.96 16034.16,-339.43 16043.27,-344.82 16044.65,-337.96"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_52_gpu14 -->
<g id="edge985" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_52_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-389C17991.4,-384.61 17972.3,-380.32 17954.57,-377.95 17562.16,-325.65 16565.12,-426.26 16159.22,-341.59"/>
<polygon fill="black" stroke="black" points="16159.67,-338.11 16149.16,-339.42 16158.2,-344.95 16159.67,-338.11"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_53_gpu14 -->
<g id="edge988" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_53_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-389.02C17991.4,-384.62 17972.3,-380.33 17954.57,-377.95 17587.49,-328.77 16654.96,-421.05 16274.16,-341.57"/>
<polygon fill="black" stroke="black" points="16274.67,-338.11 16264.16,-339.42 16273.2,-344.95 16274.67,-338.11"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_54_gpu14 -->
<g id="edge991" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_54_gpu14</title>
<path fill="none" stroke="black" d="M18008.23,-389.03C17991.4,-384.64 17972.3,-380.34 17954.57,-377.95 17612.8,-331.89 16744.68,-415.86 16389.01,-341.54"/>
<polygon fill="black" stroke="black" points="16389.67,-338.1 16379.16,-339.41 16388.19,-344.95 16389.67,-338.1"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_expert_55_gpu14 -->
<g id="edge994" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_expert_55_gpu14</title>
<path fill="none" stroke="black" d="M18007.97,-388.98C17991.2,-384.62 17972.2,-380.35 17954.57,-377.95 17638.23,-335.02 16835.07,-410.61 16504.29,-341.6"/>
<polygon fill="black" stroke="black" points="16504.67,-338.1 16494.16,-339.41 16503.19,-344.94 16504.67,-338.1"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_gate_gpu14 -->
<g id="edge971" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_gate_gpu14</title>
<path fill="none" stroke="black" d="M18034.38,-422.01C18013.05,-437.54 17979.19,-458.82 17945.57,-465.95 17911.36,-473.21 16721.45,-468.54 16686.57,-465.95 16556.32,-456.31 16404.85,-429.78 16326.54,-414.91"/>
<polygon fill="black" stroke="black" points="16326.92,-411.42 16316.44,-412.98 16325.61,-418.29 16326.92,-411.42"/>
</g>
<!-- l3_res_add_gpu14&#45;&gt;l3_res2_gpu14 -->
<g id="edge997" class="edge">
<title>l3_res_add_gpu14&#45;&gt;l3_res2_gpu14</title>
<path fill="none" stroke="black" d="M18044.53,-386.33C18014.28,-344.95 17930.29,-239.95 17830.57,-199.95 17705.63,-149.85 16754.06,-169.67 16619.57,-163.95 16478.45,-157.95 16313.19,-148.13 16223.88,-142.59"/>
<polygon fill="black" stroke="black" points="16224.09,-139.1 16213.9,-141.97 16223.66,-146.09 16224.09,-139.1"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_56_gpu15 -->
<g id="edge1006" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_56_gpu15</title>
<path fill="none" stroke="black" d="M18212.68,-756.09C18195.98,-751.76 18177.09,-747.48 18159.57,-744.95 17784.7,-690.81 17674.72,-793.51 17301.17,-708.65"/>
<polygon fill="black" stroke="black" points="17301.71,-705.18 17291.17,-706.34 17300.13,-712 17301.71,-705.18"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_57_gpu15 -->
<g id="edge1009" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_57_gpu15</title>
<path fill="none" stroke="black" d="M18212.42,-756.09C18195.78,-751.78 18176.99,-747.53 18159.57,-744.95 17835.43,-697.07 17739.76,-783.04 17416.31,-708.68"/>
<polygon fill="black" stroke="black" points="17416.71,-705.19 17406.18,-706.32 17415.12,-712 17416.71,-705.19"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_58_gpu15 -->
<g id="edge1012" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_58_gpu15</title>
<path fill="none" stroke="black" d="M18211.31,-756.24C18194.93,-752.05 18176.58,-747.82 18159.57,-744.95 17928.95,-706.05 17650.35,-690.71 17531.21,-685.62"/>
<polygon fill="black" stroke="black" points="17531.35,-682.13 17521.21,-685.21 17531.05,-689.12 17531.35,-682.13"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_59_gpu15 -->
<g id="edge1015" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_59_gpu15</title>
<path fill="none" stroke="black" d="M18212.97,-755.99C18196.2,-751.62 18177.2,-747.35 18159.57,-744.95 17846.94,-702.48 17053.17,-776.86 16726.17,-708.57"/>
<polygon fill="black" stroke="black" points="16726.68,-705.1 16716.16,-706.41 16725.19,-711.94 16726.68,-705.1"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_60_gpu15 -->
<g id="edge1018" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_60_gpu15</title>
<path fill="none" stroke="black" d="M18212.96,-756.01C18196.2,-751.64 18177.2,-747.37 18159.57,-744.95 17872.32,-705.61 17143.29,-771.64 16841.29,-708.6"/>
<polygon fill="black" stroke="black" points="16841.68,-705.1 16831.16,-706.4 16840.19,-711.94 16841.68,-705.1"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_61_gpu15 -->
<g id="edge1021" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_61_gpu15</title>
<path fill="none" stroke="black" d="M18212.96,-756.04C18196.19,-751.67 18177.2,-747.39 18159.57,-744.95 17897.65,-708.73 17233.16,-766.46 16956.25,-708.59"/>
<polygon fill="black" stroke="black" points="16956.68,-705.1 16946.16,-706.39 16955.19,-711.94 16956.68,-705.1"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_62_gpu15 -->
<g id="edge1024" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_62_gpu15</title>
<path fill="none" stroke="black" d="M18212.95,-756.07C18196.19,-751.71 18177.19,-747.42 18159.57,-744.95 17922.93,-711.84 17322.77,-761.32 17071.07,-708.55"/>
<polygon fill="black" stroke="black" points="17071.68,-705.1 17061.17,-706.38 17070.19,-711.94 17071.68,-705.1"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_expert_63_gpu15 -->
<g id="edge1027" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_expert_63_gpu15</title>
<path fill="none" stroke="black" d="M18212.69,-756.04C18195.99,-751.7 18177.1,-747.44 18159.57,-744.95 17948.27,-714.97 17412.67,-756.16 17186.07,-708.55"/>
<polygon fill="black" stroke="black" points="17186.69,-705.1 17176.17,-706.36 17185.18,-711.93 17186.69,-705.1"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_gate_gpu15 -->
<g id="edge1004" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_gate_gpu15</title>
<path fill="none" stroke="black" d="M18249.1,-789.4C18230.85,-813.58 18194.25,-854.68 18150.57,-863.95 18134.32,-867.4 17569.08,-865.73 17552.57,-863.95 17417.93,-849.47 17263.37,-809.89 17182.87,-787.48"/>
<polygon fill="black" stroke="black" points="17183.53,-784.03 17172.95,-784.7 17181.64,-790.77 17183.53,-784.03"/>
</g>
<!-- l2_res_add_gpu15&#45;&gt;l2_res2_gpu15 -->
<g id="edge1030" class="edge">
<title>l2_res_add_gpu15&#45;&gt;l2_res2_gpu15</title>
<path fill="none" stroke="black" d="M18255.25,-753.37C18239.12,-712.54 18192.13,-609.53 18114.57,-566.95 18028.95,-519.95 17350.19,-508.52 17134.87,-506.06"/>
<polygon fill="black" stroke="black" points="17134.71,-502.56 17124.67,-505.95 17134.63,-509.56 17134.71,-502.56"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_56_gpu15 -->
<g id="edge1039" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_56_gpu15</title>
<path fill="none" stroke="black" d="M18212.68,-389.09C18195.98,-384.76 18177.09,-380.49 18159.57,-377.95 17788.2,-324.24 17679.22,-425.8 17309.08,-341.63"/>
<polygon fill="black" stroke="black" points="17309.71,-338.18 17299.18,-339.34 17308.13,-345 17309.71,-338.18"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_57_gpu15 -->
<g id="edge1042" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_57_gpu15</title>
<path fill="none" stroke="black" d="M18212.41,-389.09C18195.77,-384.79 18176.99,-380.53 18159.57,-377.95 17838.92,-330.5 17744.27,-415.34 17424.2,-341.66"/>
<polygon fill="black" stroke="black" points="17424.71,-338.19 17414.18,-339.32 17423.12,-345 17424.71,-338.19"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_58_gpu15 -->
<g id="edge1045" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_58_gpu15</title>
<path fill="none" stroke="black" d="M18211.31,-389.25C18194.93,-385.06 18176.58,-380.83 18159.57,-377.95 17932.43,-339.51 17658.2,-323.97 17539.77,-318.73"/>
<polygon fill="black" stroke="black" points="17539.62,-315.22 17529.48,-318.29 17539.32,-322.22 17539.62,-315.22"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_59_gpu15 -->
<g id="edge1048" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_59_gpu15</title>
<path fill="none" stroke="black" d="M18212.97,-388.99C18196.2,-384.62 18177.2,-380.35 18159.57,-377.95 17848.69,-335.69 17059.34,-409.5 16734.12,-341.56"/>
<polygon fill="black" stroke="black" points="16734.68,-338.1 16724.16,-339.41 16733.19,-344.94 16734.68,-338.1"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_60_gpu15 -->
<g id="edge1051" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_60_gpu15</title>
<path fill="none" stroke="black" d="M18212.96,-389.01C18196.2,-384.64 18177.2,-380.37 18159.57,-377.95 17874.07,-338.82 17149.45,-404.29 16849.23,-341.58"/>
<polygon fill="black" stroke="black" points="16849.68,-338.1 16839.16,-339.4 16848.19,-344.94 16849.68,-338.1"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_61_gpu15 -->
<g id="edge1054" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_61_gpu15</title>
<path fill="none" stroke="black" d="M18212.96,-389.04C18196.19,-384.67 18177.2,-380.39 18159.57,-377.95 17899.4,-341.94 17239.31,-399.11 16964.19,-341.57"/>
<polygon fill="black" stroke="black" points="16964.68,-338.1 16954.16,-339.39 16963.19,-344.94 16964.68,-338.1"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_62_gpu15 -->
<g id="edge1057" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_62_gpu15</title>
<path fill="none" stroke="black" d="M18212.95,-389.07C18196.19,-384.71 18177.19,-380.42 18159.57,-377.95 17924.67,-345.06 17328.91,-393.96 17079,-341.53"/>
<polygon fill="black" stroke="black" points="17079.69,-338.1 17069.17,-339.38 17078.19,-344.94 17079.69,-338.1"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_expert_63_gpu15 -->
<g id="edge1060" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_expert_63_gpu15</title>
<path fill="none" stroke="black" d="M18212.69,-389.04C18195.99,-384.71 18177.1,-380.44 18159.57,-377.95 17950,-348.18 17418.8,-388.81 17193.99,-341.53"/>
<polygon fill="black" stroke="black" points="17194.69,-338.1 17184.17,-339.36 17193.18,-344.93 17194.69,-338.1"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_gate_gpu15 -->
<g id="edge1037" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_gate_gpu15</title>
<path fill="none" stroke="black" d="M18239.38,-422.01C18218.05,-437.54 18184.19,-458.82 18150.57,-465.95 18118.07,-472.85 17585.7,-468.38 17552.57,-465.95 17420.73,-456.28 17267.32,-429.64 17188.43,-414.79"/>
<polygon fill="black" stroke="black" points="17188.74,-411.29 17178.26,-412.86 17187.43,-418.16 17188.74,-411.29"/>
</g>
<!-- l3_res_add_gpu15&#45;&gt;l3_res2_gpu15 -->
<g id="edge1063" class="edge">
<title>l3_res_add_gpu15&#45;&gt;l3_res2_gpu15</title>
<path fill="none" stroke="black" d="M18257.99,-386.21C18248.52,-345.49 18218.65,-243.5 18149.57,-199.95 18064.58,-146.37 17362.54,-139.42 17142.95,-138.56"/>
<polygon fill="black" stroke="black" points="17142.88,-135.06 17132.86,-138.53 17142.85,-142.06 17142.88,-135.06"/>
</g>
</g>
</svg>
