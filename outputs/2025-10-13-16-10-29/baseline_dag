// Baseline MoE with TP8 PP2
digraph baseline_moe_dag {
	rankdir=TB size="20,20"
	input [label="Total Input\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightblue shape=ellipse style=filled]
	l0_mha_qkv_gpu0 [label="QKV Projection\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu0 [label="Attention\nGPU 0\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu0 [label="Output Projection\nGPU 0\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu0 [label="All-Reduce\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu0 [label="Residual Add\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_0_gpu0 [label="Expert 0\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_1_gpu0 [label="Expert 1\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_2_gpu0 [label="Expert 2\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_3_gpu0 [label="Expert 3\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_4_gpu0 [label="Expert 4\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_5_gpu0 [label="Expert 5\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_6_gpu0 [label="Expert 6\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_7_gpu0 [label="Expert 7\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu0 [label="Gate\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu0 [label="Expert Aggregation\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu0 [label="Residual Add\nGPU 0\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu1 [label="QKV Projection\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu1 [label="Attention\nGPU 1\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu1 [label="Output Projection\nGPU 1\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu1 [label="All-Reduce\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu1 [label="Residual Add\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_8_gpu1 [label="Expert 8\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_9_gpu1 [label="Expert 9\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_10_gpu1 [label="Expert 10\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_11_gpu1 [label="Expert 11\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_12_gpu1 [label="Expert 12\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_13_gpu1 [label="Expert 13\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_14_gpu1 [label="Expert 14\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_15_gpu1 [label="Expert 15\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu1 [label="Gate\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu1 [label="Expert Aggregation\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu1 [label="Residual Add\nGPU 1\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu2 [label="QKV Projection\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu2 [label="Attention\nGPU 2\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu2 [label="Output Projection\nGPU 2\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu2 [label="All-Reduce\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu2 [label="Residual Add\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_16_gpu2 [label="Expert 16\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_17_gpu2 [label="Expert 17\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_18_gpu2 [label="Expert 18\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_19_gpu2 [label="Expert 19\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_20_gpu2 [label="Expert 20\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_21_gpu2 [label="Expert 21\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_22_gpu2 [label="Expert 22\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_23_gpu2 [label="Expert 23\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu2 [label="Gate\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu2 [label="Expert Aggregation\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu2 [label="Residual Add\nGPU 2\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu3 [label="QKV Projection\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu3 [label="Attention\nGPU 3\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu3 [label="Output Projection\nGPU 3\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu3 [label="All-Reduce\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu3 [label="Residual Add\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_24_gpu3 [label="Expert 24\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_25_gpu3 [label="Expert 25\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_26_gpu3 [label="Expert 26\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_27_gpu3 [label="Expert 27\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_28_gpu3 [label="Expert 28\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_29_gpu3 [label="Expert 29\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_30_gpu3 [label="Expert 30\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_31_gpu3 [label="Expert 31\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu3 [label="Gate\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu3 [label="Expert Aggregation\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu3 [label="Residual Add\nGPU 3\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu4 [label="QKV Projection\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu4 [label="Attention\nGPU 4\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu4 [label="Output Projection\nGPU 4\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu4 [label="All-Reduce\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu4 [label="Residual Add\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_32_gpu4 [label="Expert 32\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_33_gpu4 [label="Expert 33\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_34_gpu4 [label="Expert 34\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_35_gpu4 [label="Expert 35\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_36_gpu4 [label="Expert 36\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_37_gpu4 [label="Expert 37\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_38_gpu4 [label="Expert 38\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_39_gpu4 [label="Expert 39\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu4 [label="Gate\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu4 [label="Expert Aggregation\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu4 [label="Residual Add\nGPU 4\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu5 [label="QKV Projection\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu5 [label="Attention\nGPU 5\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu5 [label="Output Projection\nGPU 5\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu5 [label="All-Reduce\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu5 [label="Residual Add\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_40_gpu5 [label="Expert 40\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_41_gpu5 [label="Expert 41\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_42_gpu5 [label="Expert 42\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_43_gpu5 [label="Expert 43\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_44_gpu5 [label="Expert 44\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_45_gpu5 [label="Expert 45\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_46_gpu5 [label="Expert 46\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_47_gpu5 [label="Expert 47\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu5 [label="Gate\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu5 [label="Expert Aggregation\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu5 [label="Residual Add\nGPU 5\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu6 [label="QKV Projection\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu6 [label="Attention\nGPU 6\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu6 [label="Output Projection\nGPU 6\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu6 [label="All-Reduce\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu6 [label="Residual Add\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_48_gpu6 [label="Expert 48\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_49_gpu6 [label="Expert 49\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_50_gpu6 [label="Expert 50\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_51_gpu6 [label="Expert 51\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_52_gpu6 [label="Expert 52\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_53_gpu6 [label="Expert 53\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_54_gpu6 [label="Expert 54\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_55_gpu6 [label="Expert 55\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu6 [label="Gate\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu6 [label="Expert Aggregation\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu6 [label="Residual Add\nGPU 6\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_mha_qkv_gpu7 [label="QKV Projection\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_attn_gpu7 [label="Attention\nGPU 7\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_out_gpu7 [label="Output Projection\nGPU 7\nInput: [batch_size=1024, seq_len=10000, heads=2, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden=1024]" fillcolor=lightgreen shape=rectangle style=filled]
	l0_mha_allreduce_gpu7 [label="All-Reduce\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=1024]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res_add_gpu7 [label="Residual Add\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	l0_expert_56_gpu7 [label="Expert 56\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_57_gpu7 [label="Expert 57\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_58_gpu7 [label="Expert 58\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_59_gpu7 [label="Expert 59\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_60_gpu7 [label="Expert 60\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_61_gpu7 [label="Expert 61\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_62_gpu7 [label="Expert 62\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_expert_63_gpu7 [label="Expert 63\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightpink shape=rectangle style=filled]
	l0_gate_gpu7 [label="Gate\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, num_experts=16]" fillcolor=lightcyan shape=parallelogram style=filled]
	l0_expert_agg_gpu7 [label="Expert Aggregation\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=yellow shape=parallelogram style=filled]
	l0_res2_gpu7 [label="Residual Add\nGPU 7\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightcoral shape=rectangle style=filled]
	subgraph cluster_pipeline_stage_0 {
		label="Pipeline Stage 0 (GPUs 0-7)" style=dashed
		subgraph cluster_layer_0 {
			label="Layer 0"
		}
		subgraph cluster_layer_1 {
			label="Layer 1"
			l1_mha_qkv_gpu0 [label="Qkv\nGPU 0\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu0 [label="Attn\nGPU 0\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu0 [label="Out\nGPU 0\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu0 [label="Allreduce\nGPU 0\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu0 [label="Res Add\nGPU 0\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_0_gpu0 [label="Expert 0\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_1_gpu0 [label="Expert 1\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_2_gpu0 [label="Expert 2\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_3_gpu0 [label="Expert 3\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_4_gpu0 [label="Expert 4\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_5_gpu0 [label="Expert 5\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_6_gpu0 [label="Expert 6\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_7_gpu0 [label="Expert 7\nGPU 0\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu0 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu0 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu0 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu1 [label="Qkv\nGPU 1\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu1 [label="Attn\nGPU 1\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu1 [label="Out\nGPU 1\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu1 [label="Allreduce\nGPU 1\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu1 [label="Res Add\nGPU 1\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_8_gpu1 [label="Expert 8\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_9_gpu1 [label="Expert 9\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_10_gpu1 [label="Expert 10\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_11_gpu1 [label="Expert 11\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_12_gpu1 [label="Expert 12\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_13_gpu1 [label="Expert 13\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_14_gpu1 [label="Expert 14\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_15_gpu1 [label="Expert 15\nGPU 1\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu1 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu1 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu1 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu2 [label="Qkv\nGPU 2\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu2 [label="Attn\nGPU 2\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu2 [label="Out\nGPU 2\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu2 [label="Allreduce\nGPU 2\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu2 [label="Res Add\nGPU 2\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_16_gpu2 [label="Expert 16\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_17_gpu2 [label="Expert 17\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_18_gpu2 [label="Expert 18\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_19_gpu2 [label="Expert 19\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_20_gpu2 [label="Expert 20\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_21_gpu2 [label="Expert 21\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_22_gpu2 [label="Expert 22\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_23_gpu2 [label="Expert 23\nGPU 2\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu2 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu2 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu2 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu3 [label="Qkv\nGPU 3\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu3 [label="Attn\nGPU 3\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu3 [label="Out\nGPU 3\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu3 [label="Allreduce\nGPU 3\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu3 [label="Res Add\nGPU 3\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_24_gpu3 [label="Expert 24\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_25_gpu3 [label="Expert 25\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_26_gpu3 [label="Expert 26\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_27_gpu3 [label="Expert 27\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_28_gpu3 [label="Expert 28\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_29_gpu3 [label="Expert 29\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_30_gpu3 [label="Expert 30\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_31_gpu3 [label="Expert 31\nGPU 3\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu3 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu3 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu3 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu4 [label="Qkv\nGPU 4\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu4 [label="Attn\nGPU 4\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu4 [label="Out\nGPU 4\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu4 [label="Allreduce\nGPU 4\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu4 [label="Res Add\nGPU 4\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_32_gpu4 [label="Expert 32\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_33_gpu4 [label="Expert 33\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_34_gpu4 [label="Expert 34\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_35_gpu4 [label="Expert 35\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_36_gpu4 [label="Expert 36\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_37_gpu4 [label="Expert 37\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_38_gpu4 [label="Expert 38\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_39_gpu4 [label="Expert 39\nGPU 4\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu4 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu4 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu4 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu5 [label="Qkv\nGPU 5\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu5 [label="Attn\nGPU 5\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu5 [label="Out\nGPU 5\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu5 [label="Allreduce\nGPU 5\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu5 [label="Res Add\nGPU 5\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_40_gpu5 [label="Expert 40\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_41_gpu5 [label="Expert 41\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_42_gpu5 [label="Expert 42\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_43_gpu5 [label="Expert 43\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_44_gpu5 [label="Expert 44\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_45_gpu5 [label="Expert 45\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_46_gpu5 [label="Expert 46\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_47_gpu5 [label="Expert 47\nGPU 5\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu5 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu5 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu5 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu6 [label="Qkv\nGPU 6\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu6 [label="Attn\nGPU 6\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu6 [label="Out\nGPU 6\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu6 [label="Allreduce\nGPU 6\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu6 [label="Res Add\nGPU 6\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_48_gpu6 [label="Expert 48\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_49_gpu6 [label="Expert 49\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_50_gpu6 [label="Expert 50\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_51_gpu6 [label="Expert 51\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_52_gpu6 [label="Expert 52\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_53_gpu6 [label="Expert 53\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_54_gpu6 [label="Expert 54\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_55_gpu6 [label="Expert 55\nGPU 6\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu6 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu6 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu6 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_qkv_gpu7 [label="Qkv\nGPU 7\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_attn_gpu7 [label="Attn\nGPU 7\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_out_gpu7 [label="Out\nGPU 7\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_allreduce_gpu7 [label="Allreduce\nGPU 7\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mha_res_add_gpu7 [label="Res Add\nGPU 7\nSame dims as layer 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_expert_56_gpu7 [label="Expert 56\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_57_gpu7 [label="Expert 57\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_58_gpu7 [label="Expert 58\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_59_gpu7 [label="Expert 59\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_60_gpu7 [label="Expert 60\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_61_gpu7 [label="Expert 61\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_62_gpu7 [label="Expert 62\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_expert_63_gpu7 [label="Expert 63\nGPU 7\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l1_gate_gpu7 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l1_expert_agg_gpu7 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l1_res2_gpu7 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
		}
	}
	subgraph cluster_pipeline_stage_1 {
		label="Pipeline Stage 1 (GPUs 8-15)" style=dashed
		subgraph cluster_layer_2 {
			label="Layer 2"
			l2_mha_qkv_gpu8 [label="Qkv\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu8 [label="Attn\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu8 [label="Out\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu8 [label="Allreduce\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu8 [label="Res Add\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_0_gpu8 [label="Expert 64\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_1_gpu8 [label="Expert 65\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_2_gpu8 [label="Expert 66\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_3_gpu8 [label="Expert 67\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_4_gpu8 [label="Expert 68\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_5_gpu8 [label="Expert 69\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_6_gpu8 [label="Expert 70\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_7_gpu8 [label="Expert 71\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu8 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu8 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu8 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu9 [label="Qkv\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu9 [label="Attn\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu9 [label="Out\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu9 [label="Allreduce\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu9 [label="Res Add\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_8_gpu9 [label="Expert 72\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_9_gpu9 [label="Expert 73\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_10_gpu9 [label="Expert 74\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_11_gpu9 [label="Expert 75\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_12_gpu9 [label="Expert 76\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_13_gpu9 [label="Expert 77\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_14_gpu9 [label="Expert 78\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_15_gpu9 [label="Expert 79\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu9 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu9 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu9 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu10 [label="Qkv\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu10 [label="Attn\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu10 [label="Out\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu10 [label="Allreduce\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu10 [label="Res Add\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_16_gpu10 [label="Expert 80\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_17_gpu10 [label="Expert 81\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_18_gpu10 [label="Expert 82\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_19_gpu10 [label="Expert 83\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_20_gpu10 [label="Expert 84\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_21_gpu10 [label="Expert 85\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_22_gpu10 [label="Expert 86\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_23_gpu10 [label="Expert 87\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu10 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu10 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu10 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu11 [label="Qkv\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu11 [label="Attn\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu11 [label="Out\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu11 [label="Allreduce\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu11 [label="Res Add\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_24_gpu11 [label="Expert 88\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_25_gpu11 [label="Expert 89\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_26_gpu11 [label="Expert 90\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_27_gpu11 [label="Expert 91\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_28_gpu11 [label="Expert 92\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_29_gpu11 [label="Expert 93\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_30_gpu11 [label="Expert 94\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_31_gpu11 [label="Expert 95\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu11 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu11 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu11 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu12 [label="Qkv\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu12 [label="Attn\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu12 [label="Out\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu12 [label="Allreduce\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu12 [label="Res Add\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_32_gpu12 [label="Expert 96\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_33_gpu12 [label="Expert 97\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_34_gpu12 [label="Expert 98\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_35_gpu12 [label="Expert 99\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_36_gpu12 [label="Expert 100\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_37_gpu12 [label="Expert 101\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_38_gpu12 [label="Expert 102\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_39_gpu12 [label="Expert 103\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu12 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu12 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu12 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu13 [label="Qkv\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu13 [label="Attn\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu13 [label="Out\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu13 [label="Allreduce\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu13 [label="Res Add\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_40_gpu13 [label="Expert 104\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_41_gpu13 [label="Expert 105\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_42_gpu13 [label="Expert 106\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_43_gpu13 [label="Expert 107\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_44_gpu13 [label="Expert 108\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_45_gpu13 [label="Expert 109\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_46_gpu13 [label="Expert 110\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_47_gpu13 [label="Expert 111\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu13 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu13 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu13 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu14 [label="Qkv\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu14 [label="Attn\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu14 [label="Out\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu14 [label="Allreduce\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu14 [label="Res Add\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_48_gpu14 [label="Expert 112\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_49_gpu14 [label="Expert 113\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_50_gpu14 [label="Expert 114\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_51_gpu14 [label="Expert 115\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_52_gpu14 [label="Expert 116\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_53_gpu14 [label="Expert 117\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_54_gpu14 [label="Expert 118\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_55_gpu14 [label="Expert 119\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu14 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu14 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu14 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_qkv_gpu15 [label="Qkv\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_attn_gpu15 [label="Attn\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_out_gpu15 [label="Out\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_allreduce_gpu15 [label="Allreduce\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mha_res_add_gpu15 [label="Res Add\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l2_expert_56_gpu15 [label="Expert 120\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_57_gpu15 [label="Expert 121\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_58_gpu15 [label="Expert 122\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_59_gpu15 [label="Expert 123\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_60_gpu15 [label="Expert 124\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_61_gpu15 [label="Expert 125\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_62_gpu15 [label="Expert 126\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_expert_63_gpu15 [label="Expert 127\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l2_gate_gpu15 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l2_expert_agg_gpu15 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l2_res2_gpu15 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
		}
		subgraph cluster_layer_3 {
			label="Layer 3"
			l3_mha_qkv_gpu8 [label="Qkv\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu8 [label="Attn\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu8 [label="Out\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu8 [label="Allreduce\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu8 [label="Res Add\nGPU 8\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_0_gpu8 [label="Expert 72\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_1_gpu8 [label="Expert 73\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_2_gpu8 [label="Expert 74\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_3_gpu8 [label="Expert 75\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_4_gpu8 [label="Expert 76\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_5_gpu8 [label="Expert 77\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_6_gpu8 [label="Expert 78\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_7_gpu8 [label="Expert 79\nGPU 8\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu8 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu8 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu8 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu9 [label="Qkv\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu9 [label="Attn\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu9 [label="Out\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu9 [label="Allreduce\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu9 [label="Res Add\nGPU 9\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_8_gpu9 [label="Expert 80\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_9_gpu9 [label="Expert 81\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_10_gpu9 [label="Expert 82\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_11_gpu9 [label="Expert 83\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_12_gpu9 [label="Expert 84\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_13_gpu9 [label="Expert 85\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_14_gpu9 [label="Expert 86\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_15_gpu9 [label="Expert 87\nGPU 9\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu9 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu9 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu9 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu10 [label="Qkv\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu10 [label="Attn\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu10 [label="Out\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu10 [label="Allreduce\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu10 [label="Res Add\nGPU 10\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_16_gpu10 [label="Expert 88\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_17_gpu10 [label="Expert 89\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_18_gpu10 [label="Expert 90\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_19_gpu10 [label="Expert 91\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_20_gpu10 [label="Expert 92\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_21_gpu10 [label="Expert 93\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_22_gpu10 [label="Expert 94\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_23_gpu10 [label="Expert 95\nGPU 10\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu10 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu10 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu10 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu11 [label="Qkv\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu11 [label="Attn\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu11 [label="Out\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu11 [label="Allreduce\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu11 [label="Res Add\nGPU 11\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_24_gpu11 [label="Expert 96\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_25_gpu11 [label="Expert 97\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_26_gpu11 [label="Expert 98\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_27_gpu11 [label="Expert 99\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_28_gpu11 [label="Expert 100\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_29_gpu11 [label="Expert 101\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_30_gpu11 [label="Expert 102\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_31_gpu11 [label="Expert 103\nGPU 11\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu11 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu11 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu11 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu12 [label="Qkv\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu12 [label="Attn\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu12 [label="Out\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu12 [label="Allreduce\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu12 [label="Res Add\nGPU 12\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_32_gpu12 [label="Expert 104\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_33_gpu12 [label="Expert 105\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_34_gpu12 [label="Expert 106\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_35_gpu12 [label="Expert 107\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_36_gpu12 [label="Expert 108\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_37_gpu12 [label="Expert 109\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_38_gpu12 [label="Expert 110\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_39_gpu12 [label="Expert 111\nGPU 12\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu12 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu12 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu12 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu13 [label="Qkv\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu13 [label="Attn\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu13 [label="Out\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu13 [label="Allreduce\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu13 [label="Res Add\nGPU 13\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_40_gpu13 [label="Expert 112\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_41_gpu13 [label="Expert 113\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_42_gpu13 [label="Expert 114\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_43_gpu13 [label="Expert 115\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_44_gpu13 [label="Expert 116\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_45_gpu13 [label="Expert 117\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_46_gpu13 [label="Expert 118\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_47_gpu13 [label="Expert 119\nGPU 13\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu13 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu13 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu13 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu14 [label="Qkv\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu14 [label="Attn\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu14 [label="Out\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu14 [label="Allreduce\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu14 [label="Res Add\nGPU 14\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_48_gpu14 [label="Expert 120\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_49_gpu14 [label="Expert 121\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_50_gpu14 [label="Expert 122\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_51_gpu14 [label="Expert 123\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_52_gpu14 [label="Expert 124\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_53_gpu14 [label="Expert 125\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_54_gpu14 [label="Expert 126\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_55_gpu14 [label="Expert 127\nGPU 14\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu14 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu14 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu14 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_qkv_gpu15 [label="Qkv\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_attn_gpu15 [label="Attn\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_out_gpu15 [label="Out\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_allreduce_gpu15 [label="Allreduce\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mha_res_add_gpu15 [label="Res Add\nGPU 15\nSame dims" fillcolor=lightgreen shape=rectangle style=filled]
			l3_expert_56_gpu15 [label="Expert 128\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_57_gpu15 [label="Expert 129\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_58_gpu15 [label="Expert 130\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_59_gpu15 [label="Expert 131\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_60_gpu15 [label="Expert 132\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_61_gpu15 [label="Expert 133\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_62_gpu15 [label="Expert 134\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_expert_63_gpu15 [label="Expert 135\nGPU 15\nSame dims" fillcolor=lightpink shape=rectangle style=filled]
			l3_gate_gpu15 [label=Gate fillcolor=lightcyan shape=parallelogram style=filled]
			l3_expert_agg_gpu15 [label="Expert Aggregation" fillcolor=yellow shape=parallelogram style=filled]
			l3_res2_gpu15 [label="Residual Add" fillcolor=lightcoral shape=rectangle style=filled]
		}
	}
	output [label="Total Output\nInput: [batch_size=1024, seq_len=10000, hidden=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden=8192]" fillcolor=lightblue shape=ellipse style=filled]
	input -> l0_mha_qkv_gpu0
	l0_mha_qkv_gpu0 -> l0_mha_attn_gpu0
	l0_mha_attn_gpu0 -> l0_mha_out_gpu0
	l0_mha_out_gpu0 -> l0_mha_allreduce_gpu0
	l0_mha_allreduce_gpu0 -> l0_res_add_gpu0
	input -> l0_res_add_gpu0
	l0_res_add_gpu0 -> l0_gate_gpu0
	l0_gate_gpu0 -> l0_expert_0_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_0_gpu0
	l0_expert_0_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_1_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_1_gpu0
	l0_expert_1_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_2_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_2_gpu0
	l0_expert_2_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_3_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_3_gpu0
	l0_expert_3_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_4_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_4_gpu0
	l0_expert_4_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_5_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_5_gpu0
	l0_expert_5_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_6_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_6_gpu0
	l0_expert_6_gpu0 -> l0_expert_agg_gpu0
	l0_gate_gpu0 -> l0_expert_7_gpu0 [style=dashed]
	l0_res_add_gpu0 -> l0_expert_7_gpu0
	l0_expert_7_gpu0 -> l0_expert_agg_gpu0
	l0_expert_agg_gpu0 -> l0_res2_gpu0
	l0_res_add_gpu0 -> l0_res2_gpu0
	l0_res2_gpu0 -> l1_mha_qkv_gpu0
	l1_mha_qkv_gpu0 -> l1_mha_attn_gpu0
	l1_mha_attn_gpu0 -> l1_mha_out_gpu0
	l1_mha_out_gpu0 -> l1_mha_allreduce_gpu0
	l1_mha_allreduce_gpu0 -> l1_res_add_gpu0
	l0_res2_gpu0 -> l1_res_add_gpu0
	l1_res_add_gpu0 -> l1_gate_gpu0
	l1_gate_gpu0 -> l1_expert_0_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_0_gpu0
	l1_expert_0_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_1_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_1_gpu0
	l1_expert_1_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_2_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_2_gpu0
	l1_expert_2_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_3_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_3_gpu0
	l1_expert_3_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_4_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_4_gpu0
	l1_expert_4_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_5_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_5_gpu0
	l1_expert_5_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_6_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_6_gpu0
	l1_expert_6_gpu0 -> l1_expert_agg_gpu0
	l1_gate_gpu0 -> l1_expert_7_gpu0 [style=dashed]
	l1_res_add_gpu0 -> l1_expert_7_gpu0
	l1_expert_7_gpu0 -> l1_expert_agg_gpu0
	l1_expert_agg_gpu0 -> l1_res2_gpu0
	l1_res_add_gpu0 -> l1_res2_gpu0
	input -> l0_mha_qkv_gpu1
	l0_mha_qkv_gpu1 -> l0_mha_attn_gpu1
	l0_mha_attn_gpu1 -> l0_mha_out_gpu1
	l0_mha_out_gpu1 -> l0_mha_allreduce_gpu1
	l0_mha_allreduce_gpu1 -> l0_res_add_gpu1
	input -> l0_res_add_gpu1
	l0_res_add_gpu1 -> l0_gate_gpu1
	l0_gate_gpu1 -> l0_expert_8_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_8_gpu1
	l0_expert_8_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_9_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_9_gpu1
	l0_expert_9_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_10_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_10_gpu1
	l0_expert_10_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_11_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_11_gpu1
	l0_expert_11_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_12_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_12_gpu1
	l0_expert_12_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_13_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_13_gpu1
	l0_expert_13_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_14_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_14_gpu1
	l0_expert_14_gpu1 -> l0_expert_agg_gpu1
	l0_gate_gpu1 -> l0_expert_15_gpu1 [style=dashed]
	l0_res_add_gpu1 -> l0_expert_15_gpu1
	l0_expert_15_gpu1 -> l0_expert_agg_gpu1
	l0_expert_agg_gpu1 -> l0_res2_gpu1
	l0_res_add_gpu1 -> l0_res2_gpu1
	l0_res2_gpu1 -> l1_mha_qkv_gpu1
	l1_mha_qkv_gpu1 -> l1_mha_attn_gpu1
	l1_mha_attn_gpu1 -> l1_mha_out_gpu1
	l1_mha_out_gpu1 -> l1_mha_allreduce_gpu1
	l1_mha_allreduce_gpu1 -> l1_res_add_gpu1
	l0_res2_gpu1 -> l1_res_add_gpu1
	l1_res_add_gpu1 -> l1_gate_gpu1
	l1_gate_gpu1 -> l1_expert_8_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_8_gpu1
	l1_expert_8_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_9_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_9_gpu1
	l1_expert_9_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_10_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_10_gpu1
	l1_expert_10_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_11_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_11_gpu1
	l1_expert_11_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_12_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_12_gpu1
	l1_expert_12_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_13_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_13_gpu1
	l1_expert_13_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_14_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_14_gpu1
	l1_expert_14_gpu1 -> l1_expert_agg_gpu1
	l1_gate_gpu1 -> l1_expert_15_gpu1 [style=dashed]
	l1_res_add_gpu1 -> l1_expert_15_gpu1
	l1_expert_15_gpu1 -> l1_expert_agg_gpu1
	l1_expert_agg_gpu1 -> l1_res2_gpu1
	l1_res_add_gpu1 -> l1_res2_gpu1
	input -> l0_mha_qkv_gpu2
	l0_mha_qkv_gpu2 -> l0_mha_attn_gpu2
	l0_mha_attn_gpu2 -> l0_mha_out_gpu2
	l0_mha_out_gpu2 -> l0_mha_allreduce_gpu2
	l0_mha_allreduce_gpu2 -> l0_res_add_gpu2
	input -> l0_res_add_gpu2
	l0_res_add_gpu2 -> l0_gate_gpu2
	l0_gate_gpu2 -> l0_expert_16_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_16_gpu2
	l0_expert_16_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_17_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_17_gpu2
	l0_expert_17_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_18_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_18_gpu2
	l0_expert_18_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_19_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_19_gpu2
	l0_expert_19_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_20_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_20_gpu2
	l0_expert_20_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_21_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_21_gpu2
	l0_expert_21_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_22_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_22_gpu2
	l0_expert_22_gpu2 -> l0_expert_agg_gpu2
	l0_gate_gpu2 -> l0_expert_23_gpu2 [style=dashed]
	l0_res_add_gpu2 -> l0_expert_23_gpu2
	l0_expert_23_gpu2 -> l0_expert_agg_gpu2
	l0_expert_agg_gpu2 -> l0_res2_gpu2
	l0_res_add_gpu2 -> l0_res2_gpu2
	l0_res2_gpu2 -> l1_mha_qkv_gpu2
	l1_mha_qkv_gpu2 -> l1_mha_attn_gpu2
	l1_mha_attn_gpu2 -> l1_mha_out_gpu2
	l1_mha_out_gpu2 -> l1_mha_allreduce_gpu2
	l1_mha_allreduce_gpu2 -> l1_res_add_gpu2
	l0_res2_gpu2 -> l1_res_add_gpu2
	l1_res_add_gpu2 -> l1_gate_gpu2
	l1_gate_gpu2 -> l1_expert_16_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_16_gpu2
	l1_expert_16_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_17_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_17_gpu2
	l1_expert_17_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_18_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_18_gpu2
	l1_expert_18_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_19_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_19_gpu2
	l1_expert_19_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_20_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_20_gpu2
	l1_expert_20_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_21_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_21_gpu2
	l1_expert_21_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_22_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_22_gpu2
	l1_expert_22_gpu2 -> l1_expert_agg_gpu2
	l1_gate_gpu2 -> l1_expert_23_gpu2 [style=dashed]
	l1_res_add_gpu2 -> l1_expert_23_gpu2
	l1_expert_23_gpu2 -> l1_expert_agg_gpu2
	l1_expert_agg_gpu2 -> l1_res2_gpu2
	l1_res_add_gpu2 -> l1_res2_gpu2
	input -> l0_mha_qkv_gpu3
	l0_mha_qkv_gpu3 -> l0_mha_attn_gpu3
	l0_mha_attn_gpu3 -> l0_mha_out_gpu3
	l0_mha_out_gpu3 -> l0_mha_allreduce_gpu3
	l0_mha_allreduce_gpu3 -> l0_res_add_gpu3
	input -> l0_res_add_gpu3
	l0_res_add_gpu3 -> l0_gate_gpu3
	l0_gate_gpu3 -> l0_expert_24_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_24_gpu3
	l0_expert_24_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_25_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_25_gpu3
	l0_expert_25_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_26_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_26_gpu3
	l0_expert_26_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_27_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_27_gpu3
	l0_expert_27_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_28_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_28_gpu3
	l0_expert_28_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_29_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_29_gpu3
	l0_expert_29_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_30_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_30_gpu3
	l0_expert_30_gpu3 -> l0_expert_agg_gpu3
	l0_gate_gpu3 -> l0_expert_31_gpu3 [style=dashed]
	l0_res_add_gpu3 -> l0_expert_31_gpu3
	l0_expert_31_gpu3 -> l0_expert_agg_gpu3
	l0_expert_agg_gpu3 -> l0_res2_gpu3
	l0_res_add_gpu3 -> l0_res2_gpu3
	l0_res2_gpu3 -> l1_mha_qkv_gpu3
	l1_mha_qkv_gpu3 -> l1_mha_attn_gpu3
	l1_mha_attn_gpu3 -> l1_mha_out_gpu3
	l1_mha_out_gpu3 -> l1_mha_allreduce_gpu3
	l1_mha_allreduce_gpu3 -> l1_res_add_gpu3
	l0_res2_gpu3 -> l1_res_add_gpu3
	l1_res_add_gpu3 -> l1_gate_gpu3
	l1_gate_gpu3 -> l1_expert_24_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_24_gpu3
	l1_expert_24_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_25_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_25_gpu3
	l1_expert_25_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_26_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_26_gpu3
	l1_expert_26_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_27_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_27_gpu3
	l1_expert_27_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_28_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_28_gpu3
	l1_expert_28_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_29_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_29_gpu3
	l1_expert_29_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_30_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_30_gpu3
	l1_expert_30_gpu3 -> l1_expert_agg_gpu3
	l1_gate_gpu3 -> l1_expert_31_gpu3 [style=dashed]
	l1_res_add_gpu3 -> l1_expert_31_gpu3
	l1_expert_31_gpu3 -> l1_expert_agg_gpu3
	l1_expert_agg_gpu3 -> l1_res2_gpu3
	l1_res_add_gpu3 -> l1_res2_gpu3
	input -> l0_mha_qkv_gpu4
	l0_mha_qkv_gpu4 -> l0_mha_attn_gpu4
	l0_mha_attn_gpu4 -> l0_mha_out_gpu4
	l0_mha_out_gpu4 -> l0_mha_allreduce_gpu4
	l0_mha_allreduce_gpu4 -> l0_res_add_gpu4
	input -> l0_res_add_gpu4
	l0_res_add_gpu4 -> l0_gate_gpu4
	l0_gate_gpu4 -> l0_expert_32_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_32_gpu4
	l0_expert_32_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_33_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_33_gpu4
	l0_expert_33_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_34_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_34_gpu4
	l0_expert_34_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_35_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_35_gpu4
	l0_expert_35_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_36_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_36_gpu4
	l0_expert_36_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_37_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_37_gpu4
	l0_expert_37_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_38_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_38_gpu4
	l0_expert_38_gpu4 -> l0_expert_agg_gpu4
	l0_gate_gpu4 -> l0_expert_39_gpu4 [style=dashed]
	l0_res_add_gpu4 -> l0_expert_39_gpu4
	l0_expert_39_gpu4 -> l0_expert_agg_gpu4
	l0_expert_agg_gpu4 -> l0_res2_gpu4
	l0_res_add_gpu4 -> l0_res2_gpu4
	l0_res2_gpu4 -> l1_mha_qkv_gpu4
	l1_mha_qkv_gpu4 -> l1_mha_attn_gpu4
	l1_mha_attn_gpu4 -> l1_mha_out_gpu4
	l1_mha_out_gpu4 -> l1_mha_allreduce_gpu4
	l1_mha_allreduce_gpu4 -> l1_res_add_gpu4
	l0_res2_gpu4 -> l1_res_add_gpu4
	l1_res_add_gpu4 -> l1_gate_gpu4
	l1_gate_gpu4 -> l1_expert_32_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_32_gpu4
	l1_expert_32_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_33_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_33_gpu4
	l1_expert_33_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_34_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_34_gpu4
	l1_expert_34_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_35_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_35_gpu4
	l1_expert_35_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_36_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_36_gpu4
	l1_expert_36_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_37_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_37_gpu4
	l1_expert_37_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_38_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_38_gpu4
	l1_expert_38_gpu4 -> l1_expert_agg_gpu4
	l1_gate_gpu4 -> l1_expert_39_gpu4 [style=dashed]
	l1_res_add_gpu4 -> l1_expert_39_gpu4
	l1_expert_39_gpu4 -> l1_expert_agg_gpu4
	l1_expert_agg_gpu4 -> l1_res2_gpu4
	l1_res_add_gpu4 -> l1_res2_gpu4
	input -> l0_mha_qkv_gpu5
	l0_mha_qkv_gpu5 -> l0_mha_attn_gpu5
	l0_mha_attn_gpu5 -> l0_mha_out_gpu5
	l0_mha_out_gpu5 -> l0_mha_allreduce_gpu5
	l0_mha_allreduce_gpu5 -> l0_res_add_gpu5
	input -> l0_res_add_gpu5
	l0_res_add_gpu5 -> l0_gate_gpu5
	l0_gate_gpu5 -> l0_expert_40_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_40_gpu5
	l0_expert_40_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_41_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_41_gpu5
	l0_expert_41_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_42_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_42_gpu5
	l0_expert_42_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_43_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_43_gpu5
	l0_expert_43_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_44_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_44_gpu5
	l0_expert_44_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_45_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_45_gpu5
	l0_expert_45_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_46_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_46_gpu5
	l0_expert_46_gpu5 -> l0_expert_agg_gpu5
	l0_gate_gpu5 -> l0_expert_47_gpu5 [style=dashed]
	l0_res_add_gpu5 -> l0_expert_47_gpu5
	l0_expert_47_gpu5 -> l0_expert_agg_gpu5
	l0_expert_agg_gpu5 -> l0_res2_gpu5
	l0_res_add_gpu5 -> l0_res2_gpu5
	l0_res2_gpu5 -> l1_mha_qkv_gpu5
	l1_mha_qkv_gpu5 -> l1_mha_attn_gpu5
	l1_mha_attn_gpu5 -> l1_mha_out_gpu5
	l1_mha_out_gpu5 -> l1_mha_allreduce_gpu5
	l1_mha_allreduce_gpu5 -> l1_res_add_gpu5
	l0_res2_gpu5 -> l1_res_add_gpu5
	l1_res_add_gpu5 -> l1_gate_gpu5
	l1_gate_gpu5 -> l1_expert_40_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_40_gpu5
	l1_expert_40_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_41_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_41_gpu5
	l1_expert_41_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_42_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_42_gpu5
	l1_expert_42_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_43_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_43_gpu5
	l1_expert_43_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_44_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_44_gpu5
	l1_expert_44_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_45_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_45_gpu5
	l1_expert_45_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_46_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_46_gpu5
	l1_expert_46_gpu5 -> l1_expert_agg_gpu5
	l1_gate_gpu5 -> l1_expert_47_gpu5 [style=dashed]
	l1_res_add_gpu5 -> l1_expert_47_gpu5
	l1_expert_47_gpu5 -> l1_expert_agg_gpu5
	l1_expert_agg_gpu5 -> l1_res2_gpu5
	l1_res_add_gpu5 -> l1_res2_gpu5
	input -> l0_mha_qkv_gpu6
	l0_mha_qkv_gpu6 -> l0_mha_attn_gpu6
	l0_mha_attn_gpu6 -> l0_mha_out_gpu6
	l0_mha_out_gpu6 -> l0_mha_allreduce_gpu6
	l0_mha_allreduce_gpu6 -> l0_res_add_gpu6
	input -> l0_res_add_gpu6
	l0_res_add_gpu6 -> l0_gate_gpu6
	l0_gate_gpu6 -> l0_expert_48_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_48_gpu6
	l0_expert_48_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_49_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_49_gpu6
	l0_expert_49_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_50_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_50_gpu6
	l0_expert_50_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_51_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_51_gpu6
	l0_expert_51_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_52_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_52_gpu6
	l0_expert_52_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_53_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_53_gpu6
	l0_expert_53_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_54_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_54_gpu6
	l0_expert_54_gpu6 -> l0_expert_agg_gpu6
	l0_gate_gpu6 -> l0_expert_55_gpu6 [style=dashed]
	l0_res_add_gpu6 -> l0_expert_55_gpu6
	l0_expert_55_gpu6 -> l0_expert_agg_gpu6
	l0_expert_agg_gpu6 -> l0_res2_gpu6
	l0_res_add_gpu6 -> l0_res2_gpu6
	l0_res2_gpu6 -> l1_mha_qkv_gpu6
	l1_mha_qkv_gpu6 -> l1_mha_attn_gpu6
	l1_mha_attn_gpu6 -> l1_mha_out_gpu6
	l1_mha_out_gpu6 -> l1_mha_allreduce_gpu6
	l1_mha_allreduce_gpu6 -> l1_res_add_gpu6
	l0_res2_gpu6 -> l1_res_add_gpu6
	l1_res_add_gpu6 -> l1_gate_gpu6
	l1_gate_gpu6 -> l1_expert_48_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_48_gpu6
	l1_expert_48_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_49_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_49_gpu6
	l1_expert_49_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_50_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_50_gpu6
	l1_expert_50_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_51_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_51_gpu6
	l1_expert_51_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_52_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_52_gpu6
	l1_expert_52_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_53_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_53_gpu6
	l1_expert_53_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_54_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_54_gpu6
	l1_expert_54_gpu6 -> l1_expert_agg_gpu6
	l1_gate_gpu6 -> l1_expert_55_gpu6 [style=dashed]
	l1_res_add_gpu6 -> l1_expert_55_gpu6
	l1_expert_55_gpu6 -> l1_expert_agg_gpu6
	l1_expert_agg_gpu6 -> l1_res2_gpu6
	l1_res_add_gpu6 -> l1_res2_gpu6
	input -> l0_mha_qkv_gpu7
	l0_mha_qkv_gpu7 -> l0_mha_attn_gpu7
	l0_mha_attn_gpu7 -> l0_mha_out_gpu7
	l0_mha_out_gpu7 -> l0_mha_allreduce_gpu7
	l0_mha_allreduce_gpu7 -> l0_res_add_gpu7
	input -> l0_res_add_gpu7
	l0_res_add_gpu7 -> l0_gate_gpu7
	l0_gate_gpu7 -> l0_expert_56_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_56_gpu7
	l0_expert_56_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_57_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_57_gpu7
	l0_expert_57_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_58_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_58_gpu7
	l0_expert_58_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_59_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_59_gpu7
	l0_expert_59_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_60_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_60_gpu7
	l0_expert_60_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_61_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_61_gpu7
	l0_expert_61_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_62_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_62_gpu7
	l0_expert_62_gpu7 -> l0_expert_agg_gpu7
	l0_gate_gpu7 -> l0_expert_63_gpu7 [style=dashed]
	l0_res_add_gpu7 -> l0_expert_63_gpu7
	l0_expert_63_gpu7 -> l0_expert_agg_gpu7
	l0_expert_agg_gpu7 -> l0_res2_gpu7
	l0_res_add_gpu7 -> l0_res2_gpu7
	l0_res2_gpu7 -> l1_mha_qkv_gpu7
	l1_mha_qkv_gpu7 -> l1_mha_attn_gpu7
	l1_mha_attn_gpu7 -> l1_mha_out_gpu7
	l1_mha_out_gpu7 -> l1_mha_allreduce_gpu7
	l1_mha_allreduce_gpu7 -> l1_res_add_gpu7
	l0_res2_gpu7 -> l1_res_add_gpu7
	l1_res_add_gpu7 -> l1_gate_gpu7
	l1_gate_gpu7 -> l1_expert_56_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_56_gpu7
	l1_expert_56_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_57_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_57_gpu7
	l1_expert_57_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_58_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_58_gpu7
	l1_expert_58_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_59_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_59_gpu7
	l1_expert_59_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_60_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_60_gpu7
	l1_expert_60_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_61_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_61_gpu7
	l1_expert_61_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_62_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_62_gpu7
	l1_expert_62_gpu7 -> l1_expert_agg_gpu7
	l1_gate_gpu7 -> l1_expert_63_gpu7 [style=dashed]
	l1_res_add_gpu7 -> l1_expert_63_gpu7
	l1_expert_63_gpu7 -> l1_expert_agg_gpu7
	l1_expert_agg_gpu7 -> l1_res2_gpu7
	l1_res_add_gpu7 -> l1_res2_gpu7
	l1_res2_gpu0 -> l2_mha_qkv_gpu8
	l1_res2_gpu1 -> l2_mha_qkv_gpu9
	l1_res2_gpu2 -> l2_mha_qkv_gpu10
	l1_res2_gpu3 -> l2_mha_qkv_gpu11
	l1_res2_gpu4 -> l2_mha_qkv_gpu12
	l1_res2_gpu5 -> l2_mha_qkv_gpu13
	l1_res2_gpu6 -> l2_mha_qkv_gpu14
	l1_res2_gpu7 -> l2_mha_qkv_gpu15
	l2_mha_qkv_gpu8 -> l2_mha_attn_gpu8
	l2_mha_attn_gpu8 -> l2_mha_out_gpu8
	l2_mha_out_gpu8 -> l2_mha_allreduce_gpu8
	l2_mha_allreduce_gpu8 -> l2_res_add_gpu8
	l2_mha_qkv_gpu8 -> l2_res_add_gpu8
	l2_res_add_gpu8 -> l2_gate_gpu8
	l2_gate_gpu8 -> l2_expert_0_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_0_gpu8
	l2_expert_0_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_1_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_1_gpu8
	l2_expert_1_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_2_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_2_gpu8
	l2_expert_2_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_3_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_3_gpu8
	l2_expert_3_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_4_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_4_gpu8
	l2_expert_4_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_5_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_5_gpu8
	l2_expert_5_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_6_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_6_gpu8
	l2_expert_6_gpu8 -> l2_expert_agg_gpu8
	l2_gate_gpu8 -> l2_expert_7_gpu8 [style=dashed]
	l2_res_add_gpu8 -> l2_expert_7_gpu8
	l2_expert_7_gpu8 -> l2_expert_agg_gpu8
	l2_expert_agg_gpu8 -> l2_res2_gpu8
	l2_res_add_gpu8 -> l2_res2_gpu8
	l2_res2_gpu8 -> l3_mha_qkv_gpu8
	l3_mha_qkv_gpu8 -> l3_mha_attn_gpu8
	l3_mha_attn_gpu8 -> l3_mha_out_gpu8
	l3_mha_out_gpu8 -> l3_mha_allreduce_gpu8
	l3_mha_allreduce_gpu8 -> l3_res_add_gpu8
	l3_mha_qkv_gpu8 -> l3_res_add_gpu8
	l3_res_add_gpu8 -> l3_gate_gpu8
	l3_gate_gpu8 -> l3_expert_0_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_0_gpu8
	l3_expert_0_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_1_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_1_gpu8
	l3_expert_1_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_2_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_2_gpu8
	l3_expert_2_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_3_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_3_gpu8
	l3_expert_3_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_4_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_4_gpu8
	l3_expert_4_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_5_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_5_gpu8
	l3_expert_5_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_6_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_6_gpu8
	l3_expert_6_gpu8 -> l3_expert_agg_gpu8
	l3_gate_gpu8 -> l3_expert_7_gpu8 [style=dashed]
	l3_res_add_gpu8 -> l3_expert_7_gpu8
	l3_expert_7_gpu8 -> l3_expert_agg_gpu8
	l3_expert_agg_gpu8 -> l3_res2_gpu8
	l3_res_add_gpu8 -> l3_res2_gpu8
	l3_res2_gpu8 -> output
	l2_mha_qkv_gpu9 -> l2_mha_attn_gpu9
	l2_mha_attn_gpu9 -> l2_mha_out_gpu9
	l2_mha_out_gpu9 -> l2_mha_allreduce_gpu9
	l2_mha_allreduce_gpu9 -> l2_res_add_gpu9
	l2_mha_qkv_gpu9 -> l2_res_add_gpu9
	l2_res_add_gpu9 -> l2_gate_gpu9
	l2_gate_gpu9 -> l2_expert_8_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_8_gpu9
	l2_expert_8_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_9_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_9_gpu9
	l2_expert_9_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_10_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_10_gpu9
	l2_expert_10_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_11_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_11_gpu9
	l2_expert_11_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_12_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_12_gpu9
	l2_expert_12_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_13_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_13_gpu9
	l2_expert_13_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_14_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_14_gpu9
	l2_expert_14_gpu9 -> l2_expert_agg_gpu9
	l2_gate_gpu9 -> l2_expert_15_gpu9 [style=dashed]
	l2_res_add_gpu9 -> l2_expert_15_gpu9
	l2_expert_15_gpu9 -> l2_expert_agg_gpu9
	l2_expert_agg_gpu9 -> l2_res2_gpu9
	l2_res_add_gpu9 -> l2_res2_gpu9
	l2_res2_gpu9 -> l3_mha_qkv_gpu9
	l3_mha_qkv_gpu9 -> l3_mha_attn_gpu9
	l3_mha_attn_gpu9 -> l3_mha_out_gpu9
	l3_mha_out_gpu9 -> l3_mha_allreduce_gpu9
	l3_mha_allreduce_gpu9 -> l3_res_add_gpu9
	l3_mha_qkv_gpu9 -> l3_res_add_gpu9
	l3_res_add_gpu9 -> l3_gate_gpu9
	l3_gate_gpu9 -> l3_expert_8_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_8_gpu9
	l3_expert_8_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_9_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_9_gpu9
	l3_expert_9_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_10_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_10_gpu9
	l3_expert_10_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_11_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_11_gpu9
	l3_expert_11_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_12_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_12_gpu9
	l3_expert_12_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_13_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_13_gpu9
	l3_expert_13_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_14_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_14_gpu9
	l3_expert_14_gpu9 -> l3_expert_agg_gpu9
	l3_gate_gpu9 -> l3_expert_15_gpu9 [style=dashed]
	l3_res_add_gpu9 -> l3_expert_15_gpu9
	l3_expert_15_gpu9 -> l3_expert_agg_gpu9
	l3_expert_agg_gpu9 -> l3_res2_gpu9
	l3_res_add_gpu9 -> l3_res2_gpu9
	l3_res2_gpu9 -> output
	l2_mha_qkv_gpu10 -> l2_mha_attn_gpu10
	l2_mha_attn_gpu10 -> l2_mha_out_gpu10
	l2_mha_out_gpu10 -> l2_mha_allreduce_gpu10
	l2_mha_allreduce_gpu10 -> l2_res_add_gpu10
	l2_mha_qkv_gpu10 -> l2_res_add_gpu10
	l2_res_add_gpu10 -> l2_gate_gpu10
	l2_gate_gpu10 -> l2_expert_16_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_16_gpu10
	l2_expert_16_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_17_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_17_gpu10
	l2_expert_17_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_18_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_18_gpu10
	l2_expert_18_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_19_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_19_gpu10
	l2_expert_19_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_20_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_20_gpu10
	l2_expert_20_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_21_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_21_gpu10
	l2_expert_21_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_22_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_22_gpu10
	l2_expert_22_gpu10 -> l2_expert_agg_gpu10
	l2_gate_gpu10 -> l2_expert_23_gpu10 [style=dashed]
	l2_res_add_gpu10 -> l2_expert_23_gpu10
	l2_expert_23_gpu10 -> l2_expert_agg_gpu10
	l2_expert_agg_gpu10 -> l2_res2_gpu10
	l2_res_add_gpu10 -> l2_res2_gpu10
	l2_res2_gpu10 -> l3_mha_qkv_gpu10
	l3_mha_qkv_gpu10 -> l3_mha_attn_gpu10
	l3_mha_attn_gpu10 -> l3_mha_out_gpu10
	l3_mha_out_gpu10 -> l3_mha_allreduce_gpu10
	l3_mha_allreduce_gpu10 -> l3_res_add_gpu10
	l3_mha_qkv_gpu10 -> l3_res_add_gpu10
	l3_res_add_gpu10 -> l3_gate_gpu10
	l3_gate_gpu10 -> l3_expert_16_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_16_gpu10
	l3_expert_16_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_17_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_17_gpu10
	l3_expert_17_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_18_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_18_gpu10
	l3_expert_18_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_19_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_19_gpu10
	l3_expert_19_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_20_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_20_gpu10
	l3_expert_20_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_21_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_21_gpu10
	l3_expert_21_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_22_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_22_gpu10
	l3_expert_22_gpu10 -> l3_expert_agg_gpu10
	l3_gate_gpu10 -> l3_expert_23_gpu10 [style=dashed]
	l3_res_add_gpu10 -> l3_expert_23_gpu10
	l3_expert_23_gpu10 -> l3_expert_agg_gpu10
	l3_expert_agg_gpu10 -> l3_res2_gpu10
	l3_res_add_gpu10 -> l3_res2_gpu10
	l3_res2_gpu10 -> output
	l2_mha_qkv_gpu11 -> l2_mha_attn_gpu11
	l2_mha_attn_gpu11 -> l2_mha_out_gpu11
	l2_mha_out_gpu11 -> l2_mha_allreduce_gpu11
	l2_mha_allreduce_gpu11 -> l2_res_add_gpu11
	l2_mha_qkv_gpu11 -> l2_res_add_gpu11
	l2_res_add_gpu11 -> l2_gate_gpu11
	l2_gate_gpu11 -> l2_expert_24_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_24_gpu11
	l2_expert_24_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_25_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_25_gpu11
	l2_expert_25_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_26_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_26_gpu11
	l2_expert_26_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_27_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_27_gpu11
	l2_expert_27_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_28_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_28_gpu11
	l2_expert_28_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_29_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_29_gpu11
	l2_expert_29_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_30_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_30_gpu11
	l2_expert_30_gpu11 -> l2_expert_agg_gpu11
	l2_gate_gpu11 -> l2_expert_31_gpu11 [style=dashed]
	l2_res_add_gpu11 -> l2_expert_31_gpu11
	l2_expert_31_gpu11 -> l2_expert_agg_gpu11
	l2_expert_agg_gpu11 -> l2_res2_gpu11
	l2_res_add_gpu11 -> l2_res2_gpu11
	l2_res2_gpu11 -> l3_mha_qkv_gpu11
	l3_mha_qkv_gpu11 -> l3_mha_attn_gpu11
	l3_mha_attn_gpu11 -> l3_mha_out_gpu11
	l3_mha_out_gpu11 -> l3_mha_allreduce_gpu11
	l3_mha_allreduce_gpu11 -> l3_res_add_gpu11
	l3_mha_qkv_gpu11 -> l3_res_add_gpu11
	l3_res_add_gpu11 -> l3_gate_gpu11
	l3_gate_gpu11 -> l3_expert_24_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_24_gpu11
	l3_expert_24_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_25_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_25_gpu11
	l3_expert_25_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_26_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_26_gpu11
	l3_expert_26_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_27_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_27_gpu11
	l3_expert_27_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_28_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_28_gpu11
	l3_expert_28_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_29_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_29_gpu11
	l3_expert_29_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_30_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_30_gpu11
	l3_expert_30_gpu11 -> l3_expert_agg_gpu11
	l3_gate_gpu11 -> l3_expert_31_gpu11 [style=dashed]
	l3_res_add_gpu11 -> l3_expert_31_gpu11
	l3_expert_31_gpu11 -> l3_expert_agg_gpu11
	l3_expert_agg_gpu11 -> l3_res2_gpu11
	l3_res_add_gpu11 -> l3_res2_gpu11
	l3_res2_gpu11 -> output
	l2_mha_qkv_gpu12 -> l2_mha_attn_gpu12
	l2_mha_attn_gpu12 -> l2_mha_out_gpu12
	l2_mha_out_gpu12 -> l2_mha_allreduce_gpu12
	l2_mha_allreduce_gpu12 -> l2_res_add_gpu12
	l2_mha_qkv_gpu12 -> l2_res_add_gpu12
	l2_res_add_gpu12 -> l2_gate_gpu12
	l2_gate_gpu12 -> l2_expert_32_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_32_gpu12
	l2_expert_32_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_33_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_33_gpu12
	l2_expert_33_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_34_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_34_gpu12
	l2_expert_34_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_35_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_35_gpu12
	l2_expert_35_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_36_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_36_gpu12
	l2_expert_36_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_37_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_37_gpu12
	l2_expert_37_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_38_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_38_gpu12
	l2_expert_38_gpu12 -> l2_expert_agg_gpu12
	l2_gate_gpu12 -> l2_expert_39_gpu12 [style=dashed]
	l2_res_add_gpu12 -> l2_expert_39_gpu12
	l2_expert_39_gpu12 -> l2_expert_agg_gpu12
	l2_expert_agg_gpu12 -> l2_res2_gpu12
	l2_res_add_gpu12 -> l2_res2_gpu12
	l2_res2_gpu12 -> l3_mha_qkv_gpu12
	l3_mha_qkv_gpu12 -> l3_mha_attn_gpu12
	l3_mha_attn_gpu12 -> l3_mha_out_gpu12
	l3_mha_out_gpu12 -> l3_mha_allreduce_gpu12
	l3_mha_allreduce_gpu12 -> l3_res_add_gpu12
	l3_mha_qkv_gpu12 -> l3_res_add_gpu12
	l3_res_add_gpu12 -> l3_gate_gpu12
	l3_gate_gpu12 -> l3_expert_32_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_32_gpu12
	l3_expert_32_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_33_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_33_gpu12
	l3_expert_33_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_34_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_34_gpu12
	l3_expert_34_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_35_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_35_gpu12
	l3_expert_35_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_36_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_36_gpu12
	l3_expert_36_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_37_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_37_gpu12
	l3_expert_37_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_38_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_38_gpu12
	l3_expert_38_gpu12 -> l3_expert_agg_gpu12
	l3_gate_gpu12 -> l3_expert_39_gpu12 [style=dashed]
	l3_res_add_gpu12 -> l3_expert_39_gpu12
	l3_expert_39_gpu12 -> l3_expert_agg_gpu12
	l3_expert_agg_gpu12 -> l3_res2_gpu12
	l3_res_add_gpu12 -> l3_res2_gpu12
	l3_res2_gpu12 -> output
	l2_mha_qkv_gpu13 -> l2_mha_attn_gpu13
	l2_mha_attn_gpu13 -> l2_mha_out_gpu13
	l2_mha_out_gpu13 -> l2_mha_allreduce_gpu13
	l2_mha_allreduce_gpu13 -> l2_res_add_gpu13
	l2_mha_qkv_gpu13 -> l2_res_add_gpu13
	l2_res_add_gpu13 -> l2_gate_gpu13
	l2_gate_gpu13 -> l2_expert_40_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_40_gpu13
	l2_expert_40_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_41_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_41_gpu13
	l2_expert_41_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_42_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_42_gpu13
	l2_expert_42_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_43_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_43_gpu13
	l2_expert_43_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_44_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_44_gpu13
	l2_expert_44_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_45_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_45_gpu13
	l2_expert_45_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_46_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_46_gpu13
	l2_expert_46_gpu13 -> l2_expert_agg_gpu13
	l2_gate_gpu13 -> l2_expert_47_gpu13 [style=dashed]
	l2_res_add_gpu13 -> l2_expert_47_gpu13
	l2_expert_47_gpu13 -> l2_expert_agg_gpu13
	l2_expert_agg_gpu13 -> l2_res2_gpu13
	l2_res_add_gpu13 -> l2_res2_gpu13
	l2_res2_gpu13 -> l3_mha_qkv_gpu13
	l3_mha_qkv_gpu13 -> l3_mha_attn_gpu13
	l3_mha_attn_gpu13 -> l3_mha_out_gpu13
	l3_mha_out_gpu13 -> l3_mha_allreduce_gpu13
	l3_mha_allreduce_gpu13 -> l3_res_add_gpu13
	l3_mha_qkv_gpu13 -> l3_res_add_gpu13
	l3_res_add_gpu13 -> l3_gate_gpu13
	l3_gate_gpu13 -> l3_expert_40_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_40_gpu13
	l3_expert_40_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_41_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_41_gpu13
	l3_expert_41_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_42_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_42_gpu13
	l3_expert_42_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_43_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_43_gpu13
	l3_expert_43_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_44_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_44_gpu13
	l3_expert_44_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_45_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_45_gpu13
	l3_expert_45_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_46_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_46_gpu13
	l3_expert_46_gpu13 -> l3_expert_agg_gpu13
	l3_gate_gpu13 -> l3_expert_47_gpu13 [style=dashed]
	l3_res_add_gpu13 -> l3_expert_47_gpu13
	l3_expert_47_gpu13 -> l3_expert_agg_gpu13
	l3_expert_agg_gpu13 -> l3_res2_gpu13
	l3_res_add_gpu13 -> l3_res2_gpu13
	l3_res2_gpu13 -> output
	l2_mha_qkv_gpu14 -> l2_mha_attn_gpu14
	l2_mha_attn_gpu14 -> l2_mha_out_gpu14
	l2_mha_out_gpu14 -> l2_mha_allreduce_gpu14
	l2_mha_allreduce_gpu14 -> l2_res_add_gpu14
	l2_mha_qkv_gpu14 -> l2_res_add_gpu14
	l2_res_add_gpu14 -> l2_gate_gpu14
	l2_gate_gpu14 -> l2_expert_48_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_48_gpu14
	l2_expert_48_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_49_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_49_gpu14
	l2_expert_49_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_50_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_50_gpu14
	l2_expert_50_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_51_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_51_gpu14
	l2_expert_51_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_52_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_52_gpu14
	l2_expert_52_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_53_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_53_gpu14
	l2_expert_53_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_54_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_54_gpu14
	l2_expert_54_gpu14 -> l2_expert_agg_gpu14
	l2_gate_gpu14 -> l2_expert_55_gpu14 [style=dashed]
	l2_res_add_gpu14 -> l2_expert_55_gpu14
	l2_expert_55_gpu14 -> l2_expert_agg_gpu14
	l2_expert_agg_gpu14 -> l2_res2_gpu14
	l2_res_add_gpu14 -> l2_res2_gpu14
	l2_res2_gpu14 -> l3_mha_qkv_gpu14
	l3_mha_qkv_gpu14 -> l3_mha_attn_gpu14
	l3_mha_attn_gpu14 -> l3_mha_out_gpu14
	l3_mha_out_gpu14 -> l3_mha_allreduce_gpu14
	l3_mha_allreduce_gpu14 -> l3_res_add_gpu14
	l3_mha_qkv_gpu14 -> l3_res_add_gpu14
	l3_res_add_gpu14 -> l3_gate_gpu14
	l3_gate_gpu14 -> l3_expert_48_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_48_gpu14
	l3_expert_48_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_49_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_49_gpu14
	l3_expert_49_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_50_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_50_gpu14
	l3_expert_50_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_51_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_51_gpu14
	l3_expert_51_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_52_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_52_gpu14
	l3_expert_52_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_53_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_53_gpu14
	l3_expert_53_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_54_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_54_gpu14
	l3_expert_54_gpu14 -> l3_expert_agg_gpu14
	l3_gate_gpu14 -> l3_expert_55_gpu14 [style=dashed]
	l3_res_add_gpu14 -> l3_expert_55_gpu14
	l3_expert_55_gpu14 -> l3_expert_agg_gpu14
	l3_expert_agg_gpu14 -> l3_res2_gpu14
	l3_res_add_gpu14 -> l3_res2_gpu14
	l3_res2_gpu14 -> output
	l2_mha_qkv_gpu15 -> l2_mha_attn_gpu15
	l2_mha_attn_gpu15 -> l2_mha_out_gpu15
	l2_mha_out_gpu15 -> l2_mha_allreduce_gpu15
	l2_mha_allreduce_gpu15 -> l2_res_add_gpu15
	l2_mha_qkv_gpu15 -> l2_res_add_gpu15
	l2_res_add_gpu15 -> l2_gate_gpu15
	l2_gate_gpu15 -> l2_expert_56_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_56_gpu15
	l2_expert_56_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_57_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_57_gpu15
	l2_expert_57_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_58_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_58_gpu15
	l2_expert_58_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_59_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_59_gpu15
	l2_expert_59_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_60_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_60_gpu15
	l2_expert_60_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_61_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_61_gpu15
	l2_expert_61_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_62_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_62_gpu15
	l2_expert_62_gpu15 -> l2_expert_agg_gpu15
	l2_gate_gpu15 -> l2_expert_63_gpu15 [style=dashed]
	l2_res_add_gpu15 -> l2_expert_63_gpu15
	l2_expert_63_gpu15 -> l2_expert_agg_gpu15
	l2_expert_agg_gpu15 -> l2_res2_gpu15
	l2_res_add_gpu15 -> l2_res2_gpu15
	l2_res2_gpu15 -> l3_mha_qkv_gpu15
	l3_mha_qkv_gpu15 -> l3_mha_attn_gpu15
	l3_mha_attn_gpu15 -> l3_mha_out_gpu15
	l3_mha_out_gpu15 -> l3_mha_allreduce_gpu15
	l3_mha_allreduce_gpu15 -> l3_res_add_gpu15
	l3_mha_qkv_gpu15 -> l3_res_add_gpu15
	l3_res_add_gpu15 -> l3_gate_gpu15
	l3_gate_gpu15 -> l3_expert_56_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_56_gpu15
	l3_expert_56_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_57_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_57_gpu15
	l3_expert_57_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_58_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_58_gpu15
	l3_expert_58_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_59_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_59_gpu15
	l3_expert_59_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_60_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_60_gpu15
	l3_expert_60_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_61_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_61_gpu15
	l3_expert_61_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_62_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_62_gpu15
	l3_expert_62_gpu15 -> l3_expert_agg_gpu15
	l3_gate_gpu15 -> l3_expert_63_gpu15 [style=dashed]
	l3_res_add_gpu15 -> l3_expert_63_gpu15
	l3_expert_63_gpu15 -> l3_expert_agg_gpu15
	l3_expert_agg_gpu15 -> l3_res2_gpu15
	l3_res_add_gpu15 -> l3_res2_gpu15
	l3_res2_gpu15 -> output
}
