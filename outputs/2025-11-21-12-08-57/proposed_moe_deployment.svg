<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_moe_deployment Pages: 1 -->
<svg width="1087pt" height="2160pt"
 viewBox="0.00 0.00 1087.11 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.08 0.08) rotate(0) translate(4 27077.74)">
<title>proposed_moe_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-27077.74 13626,-27077.74 13626,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="7022.5" cy="-27046.87" rx="292.07" ry="26.74"/>
<text text-anchor="middle" x="7022.5" y="-27050.67" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="7022.5" y="-27035.67" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- routing -->
<g id="node2" class="node">
<title>routing</title>
<polygon fill="none" stroke="black" points="7022.5,-26984 6567.5,-26916 7022.5,-26848 7477.5,-26916 7022.5,-26984"/>
<text text-anchor="middle" x="7022.5" y="-26934.8" font-family="Times,serif" font-size="14.00">Gating</text>
<text text-anchor="middle" x="7022.5" y="-26919.8" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="7022.5" y="-26904.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26889.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_routing=2]</text>
</g>
<!-- input&#45;&gt;routing -->
<g id="edge1665" class="edge">
<title>input&#45;&gt;routing</title>
<path fill="none" stroke="black" d="M7022.5,-27019.79C7022.5,-27012.12 7022.5,-27003.31 7022.5,-26994.15"/>
<polygon fill="black" stroke="black" points="7026,-26994.09 7022.5,-26984.09 7019,-26994.09 7026,-26994.09"/>
</g>
<!-- layer0_mha_qkv -->
<g id="node3" class="node">
<title>layer0_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7258.5,-26812 6786.5,-26812 6786.5,-26744 7258.5,-26744 7258.5,-26812"/>
<text text-anchor="middle" x="7022.5" y="-26796.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7022.5" y="-26781.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26766.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7022.5" y="-26751.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- routing&#45;&gt;layer0_mha_qkv -->
<g id="edge1" class="edge">
<title>routing&#45;&gt;layer0_mha_qkv</title>
<path fill="none" stroke="black" d="M7015.75,-26848.99C7015.73,-26839.95 7015.87,-26830.85 7016.16,-26822.36"/>
<polygon fill="black" stroke="black" points="7019.66,-26822.47 7016.6,-26812.33 7012.67,-26822.16 7019.66,-26822.47"/>
</g>
<!-- routing&#45;&gt;layer0_mha_qkv -->
<g id="edge1666" class="edge">
<title>routing&#45;&gt;layer0_mha_qkv</title>
<path fill="none" stroke="black" d="M7029.25,-26848.99C7029.27,-26839.95 7029.13,-26830.85 7028.84,-26822.36"/>
<polygon fill="black" stroke="black" points="7032.33,-26822.16 7028.4,-26812.33 7025.34,-26822.47 7032.33,-26822.16"/>
</g>
<!-- layer0_mha_attn -->
<g id="node4" class="node">
<title>layer0_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7252.5,-26708 6792.5,-26708 6792.5,-26640 7252.5,-26640 7252.5,-26708"/>
<text text-anchor="middle" x="7022.5" y="-26692.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7022.5" y="-26677.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7022.5" y="-26662.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26647.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_mha_qkv&#45;&gt;layer0_mha_attn -->
<g id="edge2" class="edge">
<title>layer0_mha_qkv&#45;&gt;layer0_mha_attn</title>
<path fill="none" stroke="black" d="M7022.5,-26743.88C7022.5,-26735.78 7022.5,-26726.98 7022.5,-26718.47"/>
<polygon fill="black" stroke="black" points="7026,-26718.3 7022.5,-26708.3 7019,-26718.3 7026,-26718.3"/>
</g>
<!-- layer0_mha_out -->
<g id="node5" class="node">
<title>layer0_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7235,-26604 6810,-26604 6810,-26536 7235,-26536 7235,-26604"/>
<text text-anchor="middle" x="7022.5" y="-26588.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7022.5" y="-26573.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26558.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26543.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_mha_attn&#45;&gt;layer0_mha_out -->
<g id="edge3" class="edge">
<title>layer0_mha_attn&#45;&gt;layer0_mha_out</title>
<path fill="none" stroke="black" d="M7022.5,-26639.88C7022.5,-26631.78 7022.5,-26622.98 7022.5,-26614.47"/>
<polygon fill="black" stroke="black" points="7026,-26614.3 7022.5,-26604.3 7019,-26614.3 7026,-26614.3"/>
</g>
<!-- layer0_res1 -->
<g id="node6" class="node">
<title>layer0_res1</title>
<polygon fill="none" stroke="black" points="7463.24,-26500 6762.12,-26500 6581.76,-26334 7282.88,-26334 7463.24,-26500"/>
<text text-anchor="middle" x="7022.5" y="-26443.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7022.5" y="-26428.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26413.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26398.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26383.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_mha_out&#45;&gt;layer0_res1 -->
<g id="edge4" class="edge">
<title>layer0_mha_out&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" d="M7022.5,-26535.86C7022.5,-26528.1 7022.5,-26519.46 7022.5,-26510.48"/>
<polygon fill="black" stroke="black" points="7026,-26510.23 7022.5,-26500.23 7019,-26510.23 7026,-26510.23"/>
</g>
<!-- layer0_ln1 -->
<g id="node7" class="node">
<title>layer0_ln1</title>
<polygon fill="yellow" stroke="black" points="7235,-26298 6810,-26298 6810,-26230 7235,-26230 7235,-26298"/>
<text text-anchor="middle" x="7022.5" y="-26282.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7022.5" y="-26267.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26252.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26237.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_ln1 -->
<g id="edge5" class="edge">
<title>layer0_res1&#45;&gt;layer0_ln1</title>
<path fill="none" stroke="black" d="M7022.5,-26333.87C7022.5,-26325.12 7022.5,-26316.48 7022.5,-26308.45"/>
<polygon fill="black" stroke="black" points="7026,-26308.26 7022.5,-26298.26 7019,-26308.26 7026,-26308.26"/>
</g>
<!-- layer0_expert_routing -->
<g id="node8" class="node">
<title>layer0_expert_routing</title>
<polygon fill="orange" stroke="black" points="7022.5,-26194 6606.5,-26111 7022.5,-26028 7438.5,-26111 7022.5,-26194"/>
<text text-anchor="middle" x="7022.5" y="-26137.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7022.5" y="-26122.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7022.5" y="-26107.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-26092.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7022.5" y="-26077.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_expert_routing -->
<g id="edge6" class="edge">
<title>layer0_ln1&#45;&gt;layer0_expert_routing</title>
<path fill="none" stroke="black" d="M7022.5,-26229.86C7022.5,-26222.1 7022.5,-26213.46 7022.5,-26204.48"/>
<polygon fill="black" stroke="black" points="7026,-26204.23 7022.5,-26194.23 7019,-26204.23 7026,-26204.23"/>
</g>
<!-- layer0_token_distribution -->
<g id="node9" class="node">
<title>layer0_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7450.86,-25992 6769.44,-25992 6594.14,-25856 7275.56,-25856 7450.86,-25992"/>
<text text-anchor="middle" x="7022.5" y="-25942.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7022.5" y="-25927.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7022.5" y="-25912.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7022.5" y="-25897.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer0_expert_routing&#45;&gt;layer0_token_distribution -->
<g id="edge7" class="edge">
<title>layer0_expert_routing&#45;&gt;layer0_token_distribution</title>
<path fill="none" stroke="black" d="M7022.5,-26027.78C7022.5,-26019.34 7022.5,-26010.79 7022.5,-26002.4"/>
<polygon fill="black" stroke="black" points="7026,-26002.28 7022.5,-25992.28 7019,-26002.28 7026,-26002.28"/>
</g>
<!-- layer0_expert0_gate -->
<g id="node10" class="node">
<title>layer0_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="819,-25820 424,-25820 424,-25752 819,-25752 819,-25820"/>
<text text-anchor="middle" x="621.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="621.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="621.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="621.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert0_gate -->
<g id="edge8" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6681.42,-25923.72C5560.99,-25925.09 1999.01,-25921.23 829.31,-25820.11"/>
<polygon fill="black" stroke="black" points="829.32,-25816.6 819.06,-25819.22 828.71,-25823.57 829.32,-25816.6"/>
</g>
<!-- layer0_expert0_up -->
<g id="node11" class="node">
<title>layer0_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1232,-25820 837,-25820 837,-25752 1232,-25752 1232,-25820"/>
<text text-anchor="middle" x="1034.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1034.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1034.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1034.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert0_up -->
<g id="edge9" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6680.42,-25923.24C5609.28,-25923 2327.27,-25914.44 1242.35,-25820.12"/>
<polygon fill="black" stroke="black" points="1242.32,-25816.6 1232.06,-25819.21 1241.71,-25823.57 1242.32,-25816.6"/>
</g>
<!-- layer0_expert1_gate -->
<g id="node14" class="node">
<title>layer0_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1645,-25820 1250,-25820 1250,-25752 1645,-25752 1645,-25820"/>
<text text-anchor="middle" x="1447.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1447.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1447.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1447.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert1_gate -->
<g id="edge14" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6679.86,-25922.69C5660.38,-25920.77 2655.69,-25907.69 1655.28,-25820.11"/>
<polygon fill="black" stroke="black" points="1655.33,-25816.6 1645.06,-25819.21 1654.71,-25823.57 1655.33,-25816.6"/>
</g>
<!-- layer0_expert1_up -->
<g id="node15" class="node">
<title>layer0_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2058,-25820 1663,-25820 1663,-25752 2058,-25752 2058,-25820"/>
<text text-anchor="middle" x="1860.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1860.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1860.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1860.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert1_up -->
<g id="edge15" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6678.92,-25922.04C5712.86,-25918.35 2984.03,-25900.95 2068.08,-25820.09"/>
<polygon fill="black" stroke="black" points="2068.33,-25816.6 2058.06,-25819.2 2067.71,-25823.58 2068.33,-25816.6"/>
</g>
<!-- layer0_expert2_gate -->
<g id="node18" class="node">
<title>layer0_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2471,-25820 2076,-25820 2076,-25752 2471,-25752 2471,-25820"/>
<text text-anchor="middle" x="2273.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2273.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2273.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2273.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert2_gate -->
<g id="edge20" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6677.93,-25921.27C5767.78,-25915.72 3313.04,-25894.22 2481.07,-25820.1"/>
<polygon fill="black" stroke="black" points="2481.33,-25816.6 2471.06,-25819.19 2480.7,-25823.58 2481.33,-25816.6"/>
</g>
<!-- layer0_expert2_up -->
<g id="node19" class="node">
<title>layer0_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2884,-25820 2489,-25820 2489,-25752 2884,-25752 2884,-25820"/>
<text text-anchor="middle" x="2686.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2686.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2686.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2686.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert2_up -->
<g id="edge21" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6676.99,-25920.34C5825.65,-25912.84 3642.62,-25887.52 2894.16,-25820.1"/>
<polygon fill="black" stroke="black" points="2894.34,-25816.61 2884.06,-25819.18 2893.7,-25823.58 2894.34,-25816.61"/>
</g>
<!-- layer0_expert3_gate -->
<g id="node22" class="node">
<title>layer0_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3297,-25820 2902,-25820 2902,-25752 3297,-25752 3297,-25820"/>
<text text-anchor="middle" x="3099.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3099.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3099.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3099.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert3_gate -->
<g id="edge26" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6675.41,-25919.2C5885.73,-25909.62 3972.42,-25880.84 3307.24,-25820.11"/>
<polygon fill="black" stroke="black" points="3307.34,-25816.61 3297.06,-25819.17 3306.7,-25823.58 3307.34,-25816.61"/>
</g>
<!-- layer0_expert3_up -->
<g id="node23" class="node">
<title>layer0_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3710,-25820 3315,-25820 3315,-25752 3710,-25752 3710,-25820"/>
<text text-anchor="middle" x="3512.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3512.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3512.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3512.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert3_up -->
<g id="edge27" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6673.52,-25917.77C5949.21,-25905.98 4302.46,-25874.17 3720.25,-25820.12"/>
<polygon fill="black" stroke="black" points="3720.35,-25816.61 3710.06,-25819.16 3719.69,-25823.58 3720.35,-25816.61"/>
</g>
<!-- layer0_expert4_gate -->
<g id="node26" class="node">
<title>layer0_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4123,-25820 3728,-25820 3728,-25752 4123,-25752 4123,-25820"/>
<text text-anchor="middle" x="3925.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3925.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3925.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3925.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert4_gate -->
<g id="edge32" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6671.06,-25915.9C6016.59,-25901.8 4632.94,-25867.52 4133.26,-25820.12"/>
<polygon fill="black" stroke="black" points="4133.35,-25816.62 4123.06,-25819.14 4132.68,-25823.58 4133.35,-25816.62"/>
</g>
<!-- layer0_expert4_up -->
<g id="node27" class="node">
<title>layer0_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4536,-25820 4141,-25820 4141,-25752 4536,-25752 4536,-25820"/>
<text text-anchor="middle" x="4338.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4338.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4338.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4338.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert4_up -->
<g id="edge33" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6678.37,-25921.42C6201.11,-25916.35 5311.47,-25896.49 4546.19,-25820.13"/>
<polygon fill="black" stroke="black" points="4546.36,-25816.63 4536.07,-25819.12 4545.67,-25823.6 4546.36,-25816.63"/>
</g>
<!-- layer0_expert5_gate -->
<g id="node30" class="node">
<title>layer0_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4949,-25820 4554,-25820 4554,-25752 4949,-25752 4949,-25820"/>
<text text-anchor="middle" x="4751.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4751.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4751.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4751.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert5_gate -->
<g id="edge38" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6672.68,-25917.16C6263.56,-25907.67 5566.04,-25883.18 4959.34,-25820.16"/>
<polygon fill="black" stroke="black" points="4959.38,-25816.64 4949.07,-25819.09 4958.65,-25823.61 4959.38,-25816.64"/>
</g>
<!-- layer0_expert5_up -->
<g id="node31" class="node">
<title>layer0_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5362,-25820 4967,-25820 4967,-25752 5362,-25752 5362,-25820"/>
<text text-anchor="middle" x="5164.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5164.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5164.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5164.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert5_up -->
<g id="edge39" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6664.34,-25910.65C6331.6,-25896.84 5822.32,-25869.72 5372.03,-25820.14"/>
<polygon fill="black" stroke="black" points="5372.4,-25816.66 5362.07,-25819.04 5371.63,-25823.62 5372.4,-25816.66"/>
</g>
<!-- layer0_expert6_gate -->
<g id="node34" class="node">
<title>layer0_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5775,-25820 5380,-25820 5380,-25752 5775,-25752 5775,-25820"/>
<text text-anchor="middle" x="5577.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5577.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5577.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5577.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert6_gate -->
<g id="edge44" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6650.03,-25899.44C6406.4,-25882.23 6081.1,-25855.86 5785.16,-25820.18"/>
<polygon fill="black" stroke="black" points="5785.43,-25816.68 5775.08,-25818.96 5784.59,-25823.63 5785.43,-25816.68"/>
</g>
<!-- layer0_expert6_up -->
<g id="node35" class="node">
<title>layer0_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6188,-25820 5793,-25820 5793,-25752 6188,-25752 6188,-25820"/>
<text text-anchor="middle" x="5990.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5990.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5990.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5990.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert6_up -->
<g id="edge45" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6619.33,-25875.57C6487.89,-25859.37 6341.08,-25840.49 6198.37,-25820.25"/>
<polygon fill="black" stroke="black" points="6198.5,-25816.74 6188.11,-25818.79 6197.51,-25823.67 6198.5,-25816.74"/>
</g>
<!-- layer0_expert7_gate -->
<g id="node38" class="node">
<title>layer0_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6601,-25820 6206,-25820 6206,-25752 6601,-25752 6601,-25820"/>
<text text-anchor="middle" x="6403.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6403.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6403.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6403.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert7_gate -->
<g id="edge50" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6717.53,-25856C6664.4,-25844.32 6611.09,-25832.61 6563.86,-25822.23"/>
<polygon fill="black" stroke="black" points="6564.4,-25818.77 6553.88,-25820.04 6562.89,-25825.6 6564.4,-25818.77"/>
</g>
<!-- layer0_expert7_up -->
<g id="node39" class="node">
<title>layer0_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="7014,-25820 6619,-25820 6619,-25752 7014,-25752 7014,-25820"/>
<text text-anchor="middle" x="6816.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6816.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6816.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6816.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert7_up -->
<g id="edge51" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6921.01,-25856C6905.37,-25845.67 6889.68,-25835.31 6875.38,-25825.87"/>
<polygon fill="black" stroke="black" points="6876.95,-25822.72 6866.68,-25820.13 6873.1,-25828.56 6876.95,-25822.72"/>
</g>
<!-- layer0_expert8_gate -->
<g id="node42" class="node">
<title>layer0_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7427,-25820 7032,-25820 7032,-25752 7427,-25752 7427,-25820"/>
<text text-anchor="middle" x="7229.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7229.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7229.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7229.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert8_gate -->
<g id="edge56" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7124.48,-25856C7140.2,-25845.67 7155.97,-25835.31 7170.33,-25825.87"/>
<polygon fill="black" stroke="black" points="7172.64,-25828.54 7179.08,-25820.13 7168.8,-25822.69 7172.64,-25828.54"/>
</g>
<!-- layer0_expert8_up -->
<g id="node43" class="node">
<title>layer0_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7840,-25820 7445,-25820 7445,-25752 7840,-25752 7840,-25820"/>
<text text-anchor="middle" x="7642.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7642.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7642.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7642.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert8_up -->
<g id="edge57" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7287.23,-25864.93C7353.49,-25850.4 7422.56,-25835.25 7481.99,-25822.21"/>
<polygon fill="black" stroke="black" points="7482.81,-25825.61 7491.82,-25820.05 7481.31,-25818.78 7482.81,-25825.61"/>
</g>
<!-- layer0_expert9_gate -->
<g id="node46" class="node">
<title>layer0_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8253,-25820 7858,-25820 7858,-25752 8253,-25752 8253,-25820"/>
<text text-anchor="middle" x="8055.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8055.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8055.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8055.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert9_gate -->
<g id="edge62" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.03,-25888.73C7473.07,-25870.13 7666.37,-25845.94 7847.89,-25820.22"/>
<polygon fill="black" stroke="black" points="7848.49,-25823.67 7857.89,-25818.8 7847.5,-25816.74 7848.49,-25823.67"/>
</g>
<!-- layer0_expert9_up -->
<g id="node47" class="node">
<title>layer0_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8666,-25820 8271,-25820 8271,-25752 8666,-25752 8666,-25820"/>
<text text-anchor="middle" x="8468.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8468.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8468.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8468.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert9_up -->
<g id="edge63" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7336.91,-25903.51C7585.39,-25886.52 7941.09,-25858.72 8260.99,-25820.16"/>
<polygon fill="black" stroke="black" points="8261.41,-25823.63 8270.92,-25818.96 8260.57,-25816.68 8261.41,-25823.63"/>
</g>
<!-- layer0_expert10_gate -->
<g id="node50" class="node">
<title>layer0_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9079,-25820 8684,-25820 8684,-25752 9079,-25752 9079,-25820"/>
<text text-anchor="middle" x="8881.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8881.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8881.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8881.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert10_gate -->
<g id="edge68" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7347.93,-25912.01C7679.51,-25898.65 8208.55,-25871.38 8673.98,-25820.14"/>
<polygon fill="black" stroke="black" points="8674.37,-25823.62 8683.93,-25819.04 8673.6,-25816.66 8674.37,-25823.62"/>
</g>
<!-- layer0_expert10_up -->
<g id="node51" class="node">
<title>layer0_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9492,-25820 9097,-25820 9097,-25752 9492,-25752 9492,-25820"/>
<text text-anchor="middle" x="9294.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9294.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9294.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9294.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert10_up -->
<g id="edge69" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7355.24,-25917.57C7762.05,-25908.37 8471.4,-25884.08 9086.97,-25820.13"/>
<polygon fill="black" stroke="black" points="9087.35,-25823.61 9096.93,-25819.09 9086.62,-25816.64 9087.35,-25823.61"/>
</g>
<!-- layer0_expert11_gate -->
<g id="node54" class="node">
<title>layer0_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9905,-25820 9510,-25820 9510,-25752 9905,-25752 9905,-25820"/>
<text text-anchor="middle" x="9707.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9707.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9707.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9707.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert11_gate -->
<g id="edge74" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7360.2,-25921.5C7836.01,-25916.55 8730.7,-25896.86 9499.76,-25820.14"/>
<polygon fill="black" stroke="black" points="9500.33,-25823.6 9509.93,-25819.12 9499.64,-25816.63 9500.33,-25823.6"/>
</g>
<!-- layer0_expert11_up -->
<g id="node55" class="node">
<title>layer0_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10318,-25820 9923,-25820 9923,-25752 10318,-25752 10318,-25820"/>
<text text-anchor="middle" x="10120.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10120.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10120.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10120.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert11_up -->
<g id="edge75" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7353.5,-25916.35C7999.28,-25902.53 9407.47,-25868.03 9912.63,-25820.13"/>
<polygon fill="black" stroke="black" points="9913.32,-25823.58 9922.94,-25819.14 9912.65,-25816.62 9913.32,-25823.58"/>
</g>
<!-- layer0_expert12_gate -->
<g id="node58" class="node">
<title>layer0_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10731,-25820 10336,-25820 10336,-25752 10731,-25752 10731,-25820"/>
<text text-anchor="middle" x="10533.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10533.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10533.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10533.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert12_gate -->
<g id="edge80" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7355.83,-25918.02C8071.92,-25906.46 9739.02,-25874.58 10325.68,-25820.13"/>
<polygon fill="black" stroke="black" points="10326.31,-25823.58 10335.94,-25819.16 10325.65,-25816.61 10326.31,-25823.58"/>
</g>
<!-- layer0_expert12_up -->
<g id="node59" class="node">
<title>layer0_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11144,-25820 10749,-25820 10749,-25752 11144,-25752 11144,-25820"/>
<text text-anchor="middle" x="10946.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10946.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10946.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10946.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert12_up -->
<g id="edge81" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7357.57,-25919.35C8139.82,-25909.92 10069.91,-25881.16 10738.7,-25820.12"/>
<polygon fill="black" stroke="black" points="10739.3,-25823.58 10748.94,-25819.17 10738.66,-25816.61 10739.3,-25823.58"/>
</g>
<!-- layer0_expert13_gate -->
<g id="node62" class="node">
<title>layer0_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11557,-25820 11162,-25820 11162,-25752 11557,-25752 11557,-25820"/>
<text text-anchor="middle" x="11359.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11359.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11359.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11359.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert13_gate -->
<g id="edge86" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7358.74,-25920.43C8203.52,-25913.03 10400.4,-25887.78 11151.8,-25820.11"/>
<polygon fill="black" stroke="black" points="11152.3,-25823.58 11161.94,-25819.18 11151.66,-25816.61 11152.3,-25823.58"/>
</g>
<!-- layer0_expert13_up -->
<g id="node63" class="node">
<title>layer0_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11970,-25820 11575,-25820 11575,-25752 11970,-25752 11970,-25820"/>
<text text-anchor="middle" x="11772.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11772.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11772.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11772.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert13_up -->
<g id="edge87" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7360.14,-25921.31C8264.83,-25915.84 10730.6,-25894.43 11564.9,-25820.1"/>
<polygon fill="black" stroke="black" points="11565.3,-25823.58 11574.94,-25819.19 11564.67,-25816.6 11565.3,-25823.58"/>
</g>
<!-- layer0_expert14_gate -->
<g id="node66" class="node">
<title>layer0_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12383,-25820 11988,-25820 11988,-25752 12383,-25752 12383,-25820"/>
<text text-anchor="middle" x="12185.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12185.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12185.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12185.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert14_gate -->
<g id="edge92" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7360.95,-25922.06C8322.58,-25918.42 11060.12,-25901.11 11977.9,-25820.1"/>
<polygon fill="black" stroke="black" points="11978.29,-25823.58 11987.94,-25819.2 11977.67,-25816.6 11978.29,-25823.58"/>
</g>
<!-- layer0_expert14_up -->
<g id="node67" class="node">
<title>layer0_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12796,-25820 12401,-25820 12401,-25752 12796,-25752 12796,-25820"/>
<text text-anchor="middle" x="12598.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12598.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12598.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12598.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert14_up -->
<g id="edge93" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7361.58,-25922.7C8377.74,-25920.8 11388.92,-25907.81 12390.71,-25820.11"/>
<polygon fill="black" stroke="black" points="12391.29,-25823.57 12400.94,-25819.21 12390.67,-25816.6 12391.29,-25823.57"/>
</g>
<!-- layer0_expert15_gate -->
<g id="node70" class="node">
<title>layer0_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13209,-25820 12814,-25820 12814,-25752 13209,-25752 13209,-25820"/>
<text text-anchor="middle" x="13011.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="13011.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13011.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13011.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert15_gate -->
<g id="edge98" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7362.27,-25923.24C8431.13,-25923.02 11717.73,-25914.53 12803.64,-25820.12"/>
<polygon fill="black" stroke="black" points="12804.29,-25823.57 12813.94,-25819.21 12803.68,-25816.6 12804.29,-25823.57"/>
</g>
<!-- layer0_expert15_up -->
<g id="node71" class="node">
<title>layer0_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13622,-25820 13227,-25820 13227,-25752 13622,-25752 13622,-25820"/>
<text text-anchor="middle" x="13424.5" y="-25804.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13424.5" y="-25789.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13424.5" y="-25774.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13424.5" y="-25759.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_token_distribution&#45;&gt;layer0_expert15_up -->
<g id="edge99" class="edge">
<title>layer0_token_distribution&#45;&gt;layer0_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7363.15,-25923.72C8483.21,-25925.1 12046.63,-25921.26 13216.69,-25820.11"/>
<polygon fill="black" stroke="black" points="13217.29,-25823.57 13226.94,-25819.22 13216.68,-25816.6 13217.29,-25823.57"/>
</g>
<!-- layer0_expert0_act -->
<g id="node12" class="node">
<title>layer0_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1232,-25716 837,-25716 837,-25648 1232,-25648 1232,-25716"/>
<text text-anchor="middle" x="1034.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1034.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1034.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1034.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_expert0_gate&#45;&gt;layer0_expert0_act -->
<g id="edge10" class="edge">
<title>layer0_expert0_gate&#45;&gt;layer0_expert0_act</title>
<path fill="none" stroke="black" d="M755.3,-25751.95C798.56,-25741.27 846.7,-25729.38 890.66,-25718.53"/>
<polygon fill="black" stroke="black" points="891.69,-25721.88 900.56,-25716.08 890.01,-25715.08 891.69,-25721.88"/>
</g>
<!-- layer0_expert0_up&#45;&gt;layer0_expert0_act -->
<g id="edge11" class="edge">
<title>layer0_expert0_up&#45;&gt;layer0_expert0_act</title>
<path fill="none" stroke="black" d="M1034.5,-25751.88C1034.5,-25743.78 1034.5,-25734.98 1034.5,-25726.47"/>
<polygon fill="black" stroke="black" points="1038,-25726.3 1034.5,-25716.3 1031,-25726.3 1038,-25726.3"/>
</g>
<!-- layer0_expert0_down -->
<g id="node13" class="node">
<title>layer0_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1651,-25612 1268,-25612 1268,-25544 1651,-25544 1651,-25612"/>
<text text-anchor="middle" x="1459.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1459.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1459.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1459.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_expert0_act&#45;&gt;layer0_expert0_down -->
<g id="edge12" class="edge">
<title>layer0_expert0_act&#45;&gt;layer0_expert0_down</title>
<path fill="none" stroke="black" d="M1172.19,-25647.95C1216.8,-25637.25 1266.45,-25625.33 1311.76,-25614.46"/>
<polygon fill="black" stroke="black" points="1312.76,-25617.82 1321.66,-25612.08 1311.12,-25611.01 1312.76,-25617.82"/>
</g>
<!-- layer0_token_aggregation -->
<g id="node74" class="node">
<title>layer0_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7495.24,-25508 6738.44,-25508 6543.76,-25372 7300.56,-25372 7495.24,-25508"/>
<text text-anchor="middle" x="7019.5" y="-25458.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7019.5" y="-25443.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7019.5" y="-25428.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-25413.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_expert0_down&#45;&gt;layer0_token_aggregation -->
<g id="edge13" class="edge">
<title>layer0_expert0_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M1651.14,-25559.25C1720.5,-25553.46 1799.47,-25547.6 1871.5,-25544 3648.48,-25455.14 5774.12,-25442.19 6632.16,-25440.83"/>
<polygon fill="black" stroke="black" points="6632.2,-25444.33 6642.2,-25440.81 6632.19,-25437.33 6632.2,-25444.33"/>
</g>
<!-- layer0_expert1_act -->
<g id="node16" class="node">
<title>layer0_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2058,-25716 1663,-25716 1663,-25648 2058,-25648 2058,-25716"/>
<text text-anchor="middle" x="1860.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1860.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1860.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1860.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_expert1_gate&#45;&gt;layer0_expert1_act -->
<g id="edge16" class="edge">
<title>layer0_expert1_gate&#45;&gt;layer0_expert1_act</title>
<path fill="none" stroke="black" d="M1581.3,-25751.95C1624.56,-25741.27 1672.7,-25729.38 1716.66,-25718.53"/>
<polygon fill="black" stroke="black" points="1717.69,-25721.88 1726.56,-25716.08 1716.01,-25715.08 1717.69,-25721.88"/>
</g>
<!-- layer0_expert1_up&#45;&gt;layer0_expert1_act -->
<g id="edge17" class="edge">
<title>layer0_expert1_up&#45;&gt;layer0_expert1_act</title>
<path fill="none" stroke="black" d="M1860.5,-25751.88C1860.5,-25743.78 1860.5,-25734.98 1860.5,-25726.47"/>
<polygon fill="black" stroke="black" points="1864,-25726.3 1860.5,-25716.3 1857,-25726.3 1864,-25726.3"/>
</g>
<!-- layer0_expert1_down -->
<g id="node17" class="node">
<title>layer0_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2264,-25612 1881,-25612 1881,-25544 2264,-25544 2264,-25612"/>
<text text-anchor="middle" x="2072.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2072.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2072.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2072.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_expert1_act&#45;&gt;layer0_expert1_down -->
<g id="edge18" class="edge">
<title>layer0_expert1_act&#45;&gt;layer0_expert1_down</title>
<path fill="none" stroke="black" d="M1929.33,-25647.88C1950.17,-25637.86 1973.21,-25626.77 1994.6,-25616.48"/>
<polygon fill="black" stroke="black" points="1996.16,-25619.61 2003.65,-25612.12 1993.12,-25613.31 1996.16,-25619.61"/>
</g>
<!-- layer0_expert1_down&#45;&gt;layer0_token_aggregation -->
<g id="edge19" class="edge">
<title>layer0_expert1_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M2264.26,-25565.44C2387.89,-25558.34 2552.14,-25549.57 2697.5,-25544 4153.65,-25488.22 5887,-25457.8 6639.56,-25446.36"/>
<polygon fill="black" stroke="black" points="6639.79,-25449.86 6649.74,-25446.21 6639.69,-25442.86 6639.79,-25449.86"/>
</g>
<!-- layer0_expert2_act -->
<g id="node20" class="node">
<title>layer0_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2884,-25716 2489,-25716 2489,-25648 2884,-25648 2884,-25716"/>
<text text-anchor="middle" x="2686.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2686.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2686.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2686.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_expert2_gate&#45;&gt;layer0_expert2_act -->
<g id="edge22" class="edge">
<title>layer0_expert2_gate&#45;&gt;layer0_expert2_act</title>
<path fill="none" stroke="black" d="M2407.3,-25751.95C2450.56,-25741.27 2498.7,-25729.38 2542.66,-25718.53"/>
<polygon fill="black" stroke="black" points="2543.69,-25721.88 2552.56,-25716.08 2542.01,-25715.08 2543.69,-25721.88"/>
</g>
<!-- layer0_expert2_up&#45;&gt;layer0_expert2_act -->
<g id="edge23" class="edge">
<title>layer0_expert2_up&#45;&gt;layer0_expert2_act</title>
<path fill="none" stroke="black" d="M2686.5,-25751.88C2686.5,-25743.78 2686.5,-25734.98 2686.5,-25726.47"/>
<polygon fill="black" stroke="black" points="2690,-25726.3 2686.5,-25716.3 2683,-25726.3 2690,-25726.3"/>
</g>
<!-- layer0_expert2_down -->
<g id="node21" class="node">
<title>layer0_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3090,-25612 2707,-25612 2707,-25544 3090,-25544 3090,-25612"/>
<text text-anchor="middle" x="2898.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2898.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2898.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2898.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_expert2_act&#45;&gt;layer0_expert2_down -->
<g id="edge24" class="edge">
<title>layer0_expert2_act&#45;&gt;layer0_expert2_down</title>
<path fill="none" stroke="black" d="M2755.33,-25647.88C2776.17,-25637.86 2799.21,-25626.77 2820.6,-25616.48"/>
<polygon fill="black" stroke="black" points="2822.16,-25619.61 2829.65,-25612.12 2819.12,-25613.31 2822.16,-25619.61"/>
</g>
<!-- layer0_expert2_down&#45;&gt;layer0_token_aggregation -->
<g id="edge25" class="edge">
<title>layer0_expert2_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M3090.27,-25565.72C3213.91,-25558.73 3378.16,-25549.98 3523.5,-25544 4659.09,-25497.3 6003.03,-25463.83 6643.56,-25449.2"/>
<polygon fill="black" stroke="black" points="6643.96,-25452.7 6653.88,-25448.97 6643.8,-25445.7 6643.96,-25452.7"/>
</g>
<!-- layer0_expert3_act -->
<g id="node24" class="node">
<title>layer0_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3710,-25716 3315,-25716 3315,-25648 3710,-25648 3710,-25716"/>
<text text-anchor="middle" x="3512.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3512.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3512.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3512.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_expert3_gate&#45;&gt;layer0_expert3_act -->
<g id="edge28" class="edge">
<title>layer0_expert3_gate&#45;&gt;layer0_expert3_act</title>
<path fill="none" stroke="black" d="M3233.3,-25751.95C3276.56,-25741.27 3324.7,-25729.38 3368.66,-25718.53"/>
<polygon fill="black" stroke="black" points="3369.69,-25721.88 3378.56,-25716.08 3368.01,-25715.08 3369.69,-25721.88"/>
</g>
<!-- layer0_expert3_up&#45;&gt;layer0_expert3_act -->
<g id="edge29" class="edge">
<title>layer0_expert3_up&#45;&gt;layer0_expert3_act</title>
<path fill="none" stroke="black" d="M3512.5,-25751.88C3512.5,-25743.78 3512.5,-25734.98 3512.5,-25726.47"/>
<polygon fill="black" stroke="black" points="3516,-25726.3 3512.5,-25716.3 3509,-25726.3 3516,-25726.3"/>
</g>
<!-- layer0_expert3_down -->
<g id="node25" class="node">
<title>layer0_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3916,-25612 3533,-25612 3533,-25544 3916,-25544 3916,-25612"/>
<text text-anchor="middle" x="3724.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3724.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3724.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3724.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_expert3_act&#45;&gt;layer0_expert3_down -->
<g id="edge30" class="edge">
<title>layer0_expert3_act&#45;&gt;layer0_expert3_down</title>
<path fill="none" stroke="black" d="M3581.33,-25647.88C3602.17,-25637.86 3625.21,-25626.77 3646.6,-25616.48"/>
<polygon fill="black" stroke="black" points="3648.16,-25619.61 3655.65,-25612.12 3645.12,-25613.31 3648.16,-25619.61"/>
</g>
<!-- layer0_expert3_down&#45;&gt;layer0_token_aggregation -->
<g id="edge31" class="edge">
<title>layer0_expert3_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M3916.37,-25568.09C4064.02,-25561.3 4273.16,-25551.82 4456.5,-25544 5238.21,-25510.67 6154.17,-25474.58 6651.89,-25455.21"/>
<polygon fill="black" stroke="black" points="6652.26,-25458.7 6662.11,-25454.81 6651.98,-25451.7 6652.26,-25458.7"/>
</g>
<!-- layer0_expert4_act -->
<g id="node28" class="node">
<title>layer0_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4536,-25716 4141,-25716 4141,-25648 4536,-25648 4536,-25716"/>
<text text-anchor="middle" x="4338.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4338.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4338.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4338.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_expert4_gate&#45;&gt;layer0_expert4_act -->
<g id="edge34" class="edge">
<title>layer0_expert4_gate&#45;&gt;layer0_expert4_act</title>
<path fill="none" stroke="black" d="M4059.3,-25751.95C4102.56,-25741.27 4150.7,-25729.38 4194.66,-25718.53"/>
<polygon fill="black" stroke="black" points="4195.69,-25721.88 4204.56,-25716.08 4194.01,-25715.08 4195.69,-25721.88"/>
</g>
<!-- layer0_expert4_up&#45;&gt;layer0_expert4_act -->
<g id="edge35" class="edge">
<title>layer0_expert4_up&#45;&gt;layer0_expert4_act</title>
<path fill="none" stroke="black" d="M4338.5,-25751.88C4338.5,-25743.78 4338.5,-25734.98 4338.5,-25726.47"/>
<polygon fill="black" stroke="black" points="4342,-25726.3 4338.5,-25716.3 4335,-25726.3 4342,-25726.3"/>
</g>
<!-- layer0_expert4_down -->
<g id="node29" class="node">
<title>layer0_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4849,-25612 4466,-25612 4466,-25544 4849,-25544 4849,-25612"/>
<text text-anchor="middle" x="4657.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4657.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4657.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4657.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_expert4_act&#45;&gt;layer0_expert4_down -->
<g id="edge36" class="edge">
<title>layer0_expert4_act&#45;&gt;layer0_expert4_down</title>
<path fill="none" stroke="black" d="M4442.07,-25647.88C4474.77,-25637.43 4511.07,-25625.82 4544.4,-25615.16"/>
<polygon fill="black" stroke="black" points="4545.72,-25618.42 4554.18,-25612.04 4543.59,-25611.75 4545.72,-25618.42"/>
</g>
<!-- layer0_expert4_down&#45;&gt;layer0_token_aggregation -->
<g id="edge37" class="edge">
<title>layer0_expert4_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M4849.3,-25564.54C4947.96,-25558.22 5070.16,-25550.52 5179.5,-25544 5693.41,-25513.37 6288.22,-25480.55 6659.2,-25460.4"/>
<polygon fill="black" stroke="black" points="6659.49,-25463.89 6669.28,-25459.85 6659.11,-25456.9 6659.49,-25463.89"/>
</g>
<!-- layer0_expert5_act -->
<g id="node32" class="node">
<title>layer0_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5362,-25716 4967,-25716 4967,-25648 5362,-25648 5362,-25716"/>
<text text-anchor="middle" x="5164.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5164.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5164.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5164.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_expert5_gate&#45;&gt;layer0_expert5_act -->
<g id="edge40" class="edge">
<title>layer0_expert5_gate&#45;&gt;layer0_expert5_act</title>
<path fill="none" stroke="black" d="M4885.3,-25751.95C4928.56,-25741.27 4976.7,-25729.38 5020.66,-25718.53"/>
<polygon fill="black" stroke="black" points="5021.69,-25721.88 5030.56,-25716.08 5020.01,-25715.08 5021.69,-25721.88"/>
</g>
<!-- layer0_expert5_up&#45;&gt;layer0_expert5_act -->
<g id="edge41" class="edge">
<title>layer0_expert5_up&#45;&gt;layer0_expert5_act</title>
<path fill="none" stroke="black" d="M5164.5,-25751.88C5164.5,-25743.78 5164.5,-25734.98 5164.5,-25726.47"/>
<polygon fill="black" stroke="black" points="5168,-25726.3 5164.5,-25716.3 5161,-25726.3 5168,-25726.3"/>
</g>
<!-- layer0_expert5_down -->
<g id="node33" class="node">
<title>layer0_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5572,-25612 5189,-25612 5189,-25544 5572,-25544 5572,-25612"/>
<text text-anchor="middle" x="5380.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5380.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5380.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5380.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_expert5_act&#45;&gt;layer0_expert5_down -->
<g id="edge42" class="edge">
<title>layer0_expert5_act&#45;&gt;layer0_expert5_down</title>
<path fill="none" stroke="black" d="M5234.63,-25647.88C5255.86,-25637.86 5279.33,-25626.77 5301.13,-25616.48"/>
<polygon fill="black" stroke="black" points="5302.81,-25619.56 5310.35,-25612.12 5299.82,-25613.23 5302.81,-25619.56"/>
</g>
<!-- layer0_expert5_down&#45;&gt;layer0_token_aggregation -->
<g id="edge43" class="edge">
<title>layer0_expert5_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M5572.12,-25561.1C5841.49,-25538.75 6336.61,-25497.66 6671.89,-25469.84"/>
<polygon fill="black" stroke="black" points="6672.58,-25473.3 6682.26,-25468.98 6672,-25466.32 6672.58,-25473.3"/>
</g>
<!-- layer0_expert6_act -->
<g id="node36" class="node">
<title>layer0_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6188,-25716 5793,-25716 5793,-25648 6188,-25648 6188,-25716"/>
<text text-anchor="middle" x="5990.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5990.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5990.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5990.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_expert6_gate&#45;&gt;layer0_expert6_act -->
<g id="edge46" class="edge">
<title>layer0_expert6_gate&#45;&gt;layer0_expert6_act</title>
<path fill="none" stroke="black" d="M5711.3,-25751.95C5754.56,-25741.27 5802.7,-25729.38 5846.66,-25718.53"/>
<polygon fill="black" stroke="black" points="5847.69,-25721.88 5856.56,-25716.08 5846.01,-25715.08 5847.69,-25721.88"/>
</g>
<!-- layer0_expert6_up&#45;&gt;layer0_expert6_act -->
<g id="edge47" class="edge">
<title>layer0_expert6_up&#45;&gt;layer0_expert6_act</title>
<path fill="none" stroke="black" d="M5990.5,-25751.88C5990.5,-25743.78 5990.5,-25734.98 5990.5,-25726.47"/>
<polygon fill="black" stroke="black" points="5994,-25726.3 5990.5,-25716.3 5987,-25726.3 5994,-25726.3"/>
</g>
<!-- layer0_expert6_down -->
<g id="node37" class="node">
<title>layer0_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6398,-25612 6015,-25612 6015,-25544 6398,-25544 6398,-25612"/>
<text text-anchor="middle" x="6206.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6206.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6206.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6206.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_expert6_act&#45;&gt;layer0_expert6_down -->
<g id="edge48" class="edge">
<title>layer0_expert6_act&#45;&gt;layer0_expert6_down</title>
<path fill="none" stroke="black" d="M6060.63,-25647.88C6081.86,-25637.86 6105.33,-25626.77 6127.13,-25616.48"/>
<polygon fill="black" stroke="black" points="6128.81,-25619.56 6136.35,-25612.12 6125.82,-25613.23 6128.81,-25619.56"/>
</g>
<!-- layer0_expert6_down&#45;&gt;layer0_token_aggregation -->
<g id="edge49" class="edge">
<title>layer0_expert6_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M6398.14,-25544.94C6489.66,-25529.63 6601.58,-25510.91 6705.09,-25493.59"/>
<polygon fill="black" stroke="black" points="6705.79,-25497.03 6715.08,-25491.92 6704.64,-25490.12 6705.79,-25497.03"/>
</g>
<!-- layer0_expert7_act -->
<g id="node40" class="node">
<title>layer0_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="7014,-25716 6619,-25716 6619,-25648 7014,-25648 7014,-25716"/>
<text text-anchor="middle" x="6816.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6816.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6816.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6816.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_expert7_gate&#45;&gt;layer0_expert7_act -->
<g id="edge52" class="edge">
<title>layer0_expert7_gate&#45;&gt;layer0_expert7_act</title>
<path fill="none" stroke="black" d="M6537.3,-25751.95C6580.56,-25741.27 6628.7,-25729.38 6672.66,-25718.53"/>
<polygon fill="black" stroke="black" points="6673.69,-25721.88 6682.56,-25716.08 6672.01,-25715.08 6673.69,-25721.88"/>
</g>
<!-- layer0_expert7_up&#45;&gt;layer0_expert7_act -->
<g id="edge53" class="edge">
<title>layer0_expert7_up&#45;&gt;layer0_expert7_act</title>
<path fill="none" stroke="black" d="M6816.5,-25751.88C6816.5,-25743.78 6816.5,-25734.98 6816.5,-25726.47"/>
<polygon fill="black" stroke="black" points="6820,-25726.3 6816.5,-25716.3 6813,-25726.3 6820,-25726.3"/>
</g>
<!-- layer0_expert7_down -->
<g id="node41" class="node">
<title>layer0_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="7011,-25612 6628,-25612 6628,-25544 7011,-25544 7011,-25612"/>
<text text-anchor="middle" x="6819.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6819.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6819.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6819.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_expert7_act&#45;&gt;layer0_expert7_down -->
<g id="edge54" class="edge">
<title>layer0_expert7_act&#45;&gt;layer0_expert7_down</title>
<path fill="none" stroke="black" d="M6817.47,-25647.88C6817.71,-25639.78 6817.97,-25630.98 6818.22,-25622.47"/>
<polygon fill="black" stroke="black" points="6821.73,-25622.4 6818.52,-25612.3 6814.73,-25622.19 6821.73,-25622.4"/>
</g>
<!-- layer0_expert7_down&#45;&gt;layer0_token_aggregation -->
<g id="edge55" class="edge">
<title>layer0_expert7_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M6868.17,-25543.9C6881.63,-25534.75 6896.8,-25524.44 6912.2,-25513.97"/>
<polygon fill="black" stroke="black" points="6914.47,-25516.66 6920.77,-25508.14 6910.53,-25510.87 6914.47,-25516.66"/>
</g>
<!-- layer0_expert8_act -->
<g id="node44" class="node">
<title>layer0_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7427,-25716 7032,-25716 7032,-25648 7427,-25648 7427,-25716"/>
<text text-anchor="middle" x="7229.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7229.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7229.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7229.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_expert8_gate&#45;&gt;layer0_expert8_act -->
<g id="edge58" class="edge">
<title>layer0_expert8_gate&#45;&gt;layer0_expert8_act</title>
<path fill="none" stroke="black" d="M7229.5,-25751.88C7229.5,-25743.78 7229.5,-25734.98 7229.5,-25726.47"/>
<polygon fill="black" stroke="black" points="7233,-25726.3 7229.5,-25716.3 7226,-25726.3 7233,-25726.3"/>
</g>
<!-- layer0_expert8_up&#45;&gt;layer0_expert8_act -->
<g id="edge59" class="edge">
<title>layer0_expert8_up&#45;&gt;layer0_expert8_act</title>
<path fill="none" stroke="black" d="M7508.7,-25751.95C7465.44,-25741.27 7417.3,-25729.38 7373.34,-25718.53"/>
<polygon fill="black" stroke="black" points="7373.99,-25715.08 7363.44,-25716.08 7372.31,-25721.88 7373.99,-25715.08"/>
</g>
<!-- layer0_expert8_down -->
<g id="node45" class="node">
<title>layer0_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7418,-25612 7035,-25612 7035,-25544 7418,-25544 7418,-25612"/>
<text text-anchor="middle" x="7226.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7226.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7226.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7226.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_expert8_act&#45;&gt;layer0_expert8_down -->
<g id="edge60" class="edge">
<title>layer0_expert8_act&#45;&gt;layer0_expert8_down</title>
<path fill="none" stroke="black" d="M7228.53,-25647.88C7228.29,-25639.78 7228.03,-25630.98 7227.78,-25622.47"/>
<polygon fill="black" stroke="black" points="7231.27,-25622.19 7227.48,-25612.3 7224.27,-25622.4 7231.27,-25622.19"/>
</g>
<!-- layer0_expert8_down&#45;&gt;layer0_token_aggregation -->
<g id="edge61" class="edge">
<title>layer0_expert8_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M7176.13,-25543.9C7162.06,-25534.66 7146.2,-25524.25 7130.12,-25513.67"/>
<polygon fill="black" stroke="black" points="7131.97,-25510.7 7121.69,-25508.14 7128.12,-25516.55 7131.97,-25510.7"/>
</g>
<!-- layer0_expert9_act -->
<g id="node48" class="node">
<title>layer0_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8253,-25716 7858,-25716 7858,-25648 8253,-25648 8253,-25716"/>
<text text-anchor="middle" x="8055.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8055.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8055.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8055.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_expert9_gate&#45;&gt;layer0_expert9_act -->
<g id="edge64" class="edge">
<title>layer0_expert9_gate&#45;&gt;layer0_expert9_act</title>
<path fill="none" stroke="black" d="M8055.5,-25751.88C8055.5,-25743.78 8055.5,-25734.98 8055.5,-25726.47"/>
<polygon fill="black" stroke="black" points="8059,-25726.3 8055.5,-25716.3 8052,-25726.3 8059,-25726.3"/>
</g>
<!-- layer0_expert9_up&#45;&gt;layer0_expert9_act -->
<g id="edge65" class="edge">
<title>layer0_expert9_up&#45;&gt;layer0_expert9_act</title>
<path fill="none" stroke="black" d="M8334.7,-25751.95C8291.44,-25741.27 8243.3,-25729.38 8199.34,-25718.53"/>
<polygon fill="black" stroke="black" points="8199.99,-25715.08 8189.44,-25716.08 8198.31,-25721.88 8199.99,-25715.08"/>
</g>
<!-- layer0_expert9_down -->
<g id="node49" class="node">
<title>layer0_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8034,-25612 7651,-25612 7651,-25544 8034,-25544 8034,-25612"/>
<text text-anchor="middle" x="7842.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7842.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7842.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7842.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_expert9_act&#45;&gt;layer0_expert9_down -->
<g id="edge66" class="edge">
<title>layer0_expert9_act&#45;&gt;layer0_expert9_down</title>
<path fill="none" stroke="black" d="M7986.35,-25647.88C7965.41,-25637.86 7942.26,-25626.77 7920.77,-25616.48"/>
<polygon fill="black" stroke="black" points="7922.2,-25613.29 7911.67,-25612.12 7919.18,-25619.6 7922.2,-25613.29"/>
</g>
<!-- layer0_expert9_down&#45;&gt;layer0_token_aggregation -->
<g id="edge67" class="edge">
<title>layer0_expert9_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M7650.84,-25545.33C7585.96,-25534.61 7510.75,-25522.18 7435.34,-25509.72"/>
<polygon fill="black" stroke="black" points="7435.62,-25506.22 7425.19,-25508.04 7434.48,-25513.12 7435.62,-25506.22"/>
</g>
<!-- layer0_expert10_act -->
<g id="node52" class="node">
<title>layer0_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9079,-25716 8684,-25716 8684,-25648 9079,-25648 9079,-25716"/>
<text text-anchor="middle" x="8881.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8881.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8881.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8881.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_expert10_gate&#45;&gt;layer0_expert10_act -->
<g id="edge70" class="edge">
<title>layer0_expert10_gate&#45;&gt;layer0_expert10_act</title>
<path fill="none" stroke="black" d="M8881.5,-25751.88C8881.5,-25743.78 8881.5,-25734.98 8881.5,-25726.47"/>
<polygon fill="black" stroke="black" points="8885,-25726.3 8881.5,-25716.3 8878,-25726.3 8885,-25726.3"/>
</g>
<!-- layer0_expert10_up&#45;&gt;layer0_expert10_act -->
<g id="edge71" class="edge">
<title>layer0_expert10_up&#45;&gt;layer0_expert10_act</title>
<path fill="none" stroke="black" d="M9160.7,-25751.95C9117.44,-25741.27 9069.3,-25729.38 9025.34,-25718.53"/>
<polygon fill="black" stroke="black" points="9025.99,-25715.08 9015.44,-25716.08 9024.31,-25721.88 9025.99,-25715.08"/>
</g>
<!-- layer0_expert10_down -->
<g id="node53" class="node">
<title>layer0_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8755,-25612 8372,-25612 8372,-25544 8755,-25544 8755,-25612"/>
<text text-anchor="middle" x="8563.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8563.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8563.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8563.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_expert10_act&#45;&gt;layer0_expert10_down -->
<g id="edge72" class="edge">
<title>layer0_expert10_act&#45;&gt;layer0_expert10_down</title>
<path fill="none" stroke="black" d="M8778.25,-25647.88C8745.65,-25637.43 8709.47,-25625.82 8676.25,-25615.16"/>
<polygon fill="black" stroke="black" points="8677.09,-25611.76 8666.5,-25612.04 8674.95,-25618.42 8677.09,-25611.76"/>
</g>
<!-- layer0_expert10_down&#45;&gt;layer0_token_aggregation -->
<g id="edge73" class="edge">
<title>layer0_expert10_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M8371.85,-25560.12C8146.46,-25540.27 7764.98,-25506.66 7464.54,-25480.2"/>
<polygon fill="black" stroke="black" points="7464.61,-25476.69 7454.34,-25479.3 7463.99,-25483.67 7464.61,-25476.69"/>
</g>
<!-- layer0_expert11_act -->
<g id="node56" class="node">
<title>layer0_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9905,-25716 9510,-25716 9510,-25648 9905,-25648 9905,-25716"/>
<text text-anchor="middle" x="9707.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9707.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9707.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9707.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_expert11_gate&#45;&gt;layer0_expert11_act -->
<g id="edge76" class="edge">
<title>layer0_expert11_gate&#45;&gt;layer0_expert11_act</title>
<path fill="none" stroke="black" d="M9707.5,-25751.88C9707.5,-25743.78 9707.5,-25734.98 9707.5,-25726.47"/>
<polygon fill="black" stroke="black" points="9711,-25726.3 9707.5,-25716.3 9704,-25726.3 9711,-25726.3"/>
</g>
<!-- layer0_expert11_up&#45;&gt;layer0_expert11_act -->
<g id="edge77" class="edge">
<title>layer0_expert11_up&#45;&gt;layer0_expert11_act</title>
<path fill="none" stroke="black" d="M9986.7,-25751.95C9943.44,-25741.27 9895.3,-25729.38 9851.34,-25718.53"/>
<polygon fill="black" stroke="black" points="9851.99,-25715.08 9841.44,-25716.08 9850.31,-25721.88 9851.99,-25715.08"/>
</g>
<!-- layer0_expert11_down -->
<g id="node57" class="node">
<title>layer0_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9529,-25612 9146,-25612 9146,-25544 9529,-25544 9529,-25612"/>
<text text-anchor="middle" x="9337.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9337.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9337.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9337.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_expert11_act&#45;&gt;layer0_expert11_down -->
<g id="edge78" class="edge">
<title>layer0_expert11_act&#45;&gt;layer0_expert11_down</title>
<path fill="none" stroke="black" d="M9587.63,-25647.95C9549.2,-25637.36 9506.47,-25625.58 9467.36,-25614.8"/>
<polygon fill="black" stroke="black" points="9468.07,-25611.36 9457.5,-25612.08 9466.21,-25618.11 9468.07,-25611.36"/>
</g>
<!-- layer0_expert11_down&#45;&gt;layer0_token_aggregation -->
<g id="edge79" class="edge">
<title>layer0_expert11_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M9145.84,-25565.75C8774.82,-25543.99 7950.55,-25495.63 7444.2,-25465.92"/>
<polygon fill="black" stroke="black" points="7444.35,-25462.42 7434.17,-25465.33 7443.94,-25469.41 7444.35,-25462.42"/>
</g>
<!-- layer0_expert12_act -->
<g id="node60" class="node">
<title>layer0_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10731,-25716 10336,-25716 10336,-25648 10731,-25648 10731,-25716"/>
<text text-anchor="middle" x="10533.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10533.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10533.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10533.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_expert12_gate&#45;&gt;layer0_expert12_act -->
<g id="edge82" class="edge">
<title>layer0_expert12_gate&#45;&gt;layer0_expert12_act</title>
<path fill="none" stroke="black" d="M10533.5,-25751.88C10533.5,-25743.78 10533.5,-25734.98 10533.5,-25726.47"/>
<polygon fill="black" stroke="black" points="10537,-25726.3 10533.5,-25716.3 10530,-25726.3 10537,-25726.3"/>
</g>
<!-- layer0_expert12_up&#45;&gt;layer0_expert12_act -->
<g id="edge83" class="edge">
<title>layer0_expert12_up&#45;&gt;layer0_expert12_act</title>
<path fill="none" stroke="black" d="M10812.7,-25751.95C10769.44,-25741.27 10721.3,-25729.38 10677.34,-25718.53"/>
<polygon fill="black" stroke="black" points="10677.99,-25715.08 10667.44,-25716.08 10676.31,-25721.88 10677.99,-25715.08"/>
</g>
<!-- layer0_expert12_down -->
<g id="node61" class="node">
<title>layer0_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10329,-25612 9946,-25612 9946,-25544 10329,-25544 10329,-25612"/>
<text text-anchor="middle" x="10137.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10137.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10137.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10137.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_expert12_act&#45;&gt;layer0_expert12_down -->
<g id="edge84" class="edge">
<title>layer0_expert12_act&#45;&gt;layer0_expert12_down</title>
<path fill="none" stroke="black" d="M10405.2,-25647.95C10363.81,-25637.29 10317.76,-25625.43 10275.69,-25614.59"/>
<polygon fill="black" stroke="black" points="10276.49,-25611.19 10265.93,-25612.08 10274.74,-25617.96 10276.49,-25611.19"/>
</g>
<!-- layer0_expert12_down&#45;&gt;layer0_token_aggregation -->
<g id="edge85" class="edge">
<title>layer0_expert12_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M9945.67,-25565.74C9828.15,-25559.01 9674.65,-25550.53 9538.5,-25544 8795.75,-25508.36 7929.41,-25474.66 7430.65,-25456.02"/>
<polygon fill="black" stroke="black" points="7430.53,-25452.52 7420.41,-25455.64 7430.27,-25459.51 7430.53,-25452.52"/>
</g>
<!-- layer0_expert13_act -->
<g id="node64" class="node">
<title>layer0_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11557,-25716 11162,-25716 11162,-25648 11557,-25648 11557,-25716"/>
<text text-anchor="middle" x="11359.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11359.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11359.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11359.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_expert13_gate&#45;&gt;layer0_expert13_act -->
<g id="edge88" class="edge">
<title>layer0_expert13_gate&#45;&gt;layer0_expert13_act</title>
<path fill="none" stroke="black" d="M11359.5,-25751.88C11359.5,-25743.78 11359.5,-25734.98 11359.5,-25726.47"/>
<polygon fill="black" stroke="black" points="11363,-25726.3 11359.5,-25716.3 11356,-25726.3 11363,-25726.3"/>
</g>
<!-- layer0_expert13_up&#45;&gt;layer0_expert13_act -->
<g id="edge89" class="edge">
<title>layer0_expert13_up&#45;&gt;layer0_expert13_act</title>
<path fill="none" stroke="black" d="M11638.7,-25751.95C11595.44,-25741.27 11547.3,-25729.38 11503.34,-25718.53"/>
<polygon fill="black" stroke="black" points="11503.99,-25715.08 11493.44,-25716.08 11502.31,-25721.88 11503.99,-25715.08"/>
</g>
<!-- layer0_expert13_down -->
<g id="node65" class="node">
<title>layer0_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11142,-25612 10759,-25612 10759,-25544 11142,-25544 11142,-25612"/>
<text text-anchor="middle" x="10950.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10950.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10950.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10950.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_expert13_act&#45;&gt;layer0_expert13_down -->
<g id="edge90" class="edge">
<title>layer0_expert13_act&#45;&gt;layer0_expert13_down</title>
<path fill="none" stroke="black" d="M11226.99,-25647.95C11184.15,-25637.27 11136.48,-25625.38 11092.95,-25614.53"/>
<polygon fill="black" stroke="black" points="11093.7,-25611.1 11083.15,-25612.08 11092,-25617.9 11093.7,-25611.1"/>
</g>
<!-- layer0_expert13_down&#45;&gt;layer0_token_aggregation -->
<g id="edge91" class="edge">
<title>layer0_expert13_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M10758.98,-25565.55C10638.35,-25558.61 10479.36,-25549.98 10338.5,-25544 9287.09,-25499.34 8047.53,-25466 7422.76,-25450.54"/>
<polygon fill="black" stroke="black" points="7422.78,-25447.04 7412.69,-25450.3 7422.6,-25454.04 7422.78,-25447.04"/>
</g>
<!-- layer0_expert14_act -->
<g id="node68" class="node">
<title>layer0_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12383,-25716 11988,-25716 11988,-25648 12383,-25648 12383,-25716"/>
<text text-anchor="middle" x="12185.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12185.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12185.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12185.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_expert14_gate&#45;&gt;layer0_expert14_act -->
<g id="edge94" class="edge">
<title>layer0_expert14_gate&#45;&gt;layer0_expert14_act</title>
<path fill="none" stroke="black" d="M12185.5,-25751.88C12185.5,-25743.78 12185.5,-25734.98 12185.5,-25726.47"/>
<polygon fill="black" stroke="black" points="12189,-25726.3 12185.5,-25716.3 12182,-25726.3 12189,-25726.3"/>
</g>
<!-- layer0_expert14_up&#45;&gt;layer0_expert14_act -->
<g id="edge95" class="edge">
<title>layer0_expert14_up&#45;&gt;layer0_expert14_act</title>
<path fill="none" stroke="black" d="M12464.7,-25751.95C12421.44,-25741.27 12373.3,-25729.38 12329.34,-25718.53"/>
<polygon fill="black" stroke="black" points="12329.99,-25715.08 12319.44,-25716.08 12328.31,-25721.88 12329.99,-25715.08"/>
</g>
<!-- layer0_expert14_down -->
<g id="node69" class="node">
<title>layer0_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11961,-25612 11578,-25612 11578,-25544 11961,-25544 11961,-25612"/>
<text text-anchor="middle" x="11769.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11769.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11769.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11769.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_expert14_act&#45;&gt;layer0_expert14_down -->
<g id="edge96" class="edge">
<title>layer0_expert14_act&#45;&gt;layer0_expert14_down</title>
<path fill="none" stroke="black" d="M12050.72,-25647.95C12007.15,-25637.27 11958.66,-25625.38 11914.39,-25614.53"/>
<polygon fill="black" stroke="black" points="11914.96,-25611.06 11904.42,-25612.08 11913.3,-25617.86 11914.96,-25611.06"/>
</g>
<!-- layer0_expert14_down&#45;&gt;layer0_token_aggregation -->
<g id="edge97" class="edge">
<title>layer0_expert14_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M11577.83,-25565.36C11455.82,-25558.3 11294.43,-25549.6 11151.5,-25544 9781.85,-25490.37 8155.66,-25459.43 7418.32,-25447.17"/>
<polygon fill="black" stroke="black" points="7418.12,-25443.67 7408.07,-25447 7418.01,-25450.67 7418.12,-25443.67"/>
</g>
<!-- layer0_expert15_act -->
<g id="node72" class="node">
<title>layer0_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13209,-25716 12814,-25716 12814,-25648 13209,-25648 13209,-25716"/>
<text text-anchor="middle" x="13011.5" y="-25700.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="13011.5" y="-25685.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13011.5" y="-25670.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13011.5" y="-25655.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_expert15_gate&#45;&gt;layer0_expert15_act -->
<g id="edge100" class="edge">
<title>layer0_expert15_gate&#45;&gt;layer0_expert15_act</title>
<path fill="none" stroke="black" d="M13011.5,-25751.88C13011.5,-25743.78 13011.5,-25734.98 13011.5,-25726.47"/>
<polygon fill="black" stroke="black" points="13015,-25726.3 13011.5,-25716.3 13008,-25726.3 13015,-25726.3"/>
</g>
<!-- layer0_expert15_up&#45;&gt;layer0_expert15_act -->
<g id="edge101" class="edge">
<title>layer0_expert15_up&#45;&gt;layer0_expert15_act</title>
<path fill="none" stroke="black" d="M13290.7,-25751.95C13247.44,-25741.27 13199.3,-25729.38 13155.34,-25718.53"/>
<polygon fill="black" stroke="black" points="13155.99,-25715.08 13145.44,-25716.08 13154.31,-25721.88 13155.99,-25715.08"/>
</g>
<!-- layer0_expert15_down -->
<g id="node73" class="node">
<title>layer0_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12784,-25612 12401,-25612 12401,-25544 12784,-25544 12784,-25612"/>
<text text-anchor="middle" x="12592.5" y="-25596.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12592.5" y="-25581.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12592.5" y="-25566.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12592.5" y="-25551.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_expert15_act&#45;&gt;layer0_expert15_down -->
<g id="edge102" class="edge">
<title>layer0_expert15_act&#45;&gt;layer0_expert15_down</title>
<path fill="none" stroke="black" d="M12875.75,-25647.95C12831.77,-25637.25 12782.82,-25625.33 12738.15,-25614.46"/>
<polygon fill="black" stroke="black" points="12738.93,-25611.05 12728.39,-25612.08 12737.28,-25617.85 12738.93,-25611.05"/>
</g>
<!-- layer0_expert15_down&#45;&gt;layer0_token_aggregation -->
<g id="edge103" class="edge">
<title>layer0_expert15_down&#45;&gt;layer0_token_aggregation</title>
<path fill="none" stroke="black" d="M12400.98,-25565.24C12278.02,-25558.09 12114.9,-25549.33 11970.5,-25544 10276.24,-25481.45 8254.33,-25454.15 7414.93,-25444.91"/>
<polygon fill="black" stroke="black" points="7414.84,-25441.4 7404.8,-25444.79 7414.76,-25448.4 7414.84,-25441.4"/>
</g>
<!-- layer0_res2 -->
<g id="node75" class="node">
<title>layer0_res2</title>
<polygon fill="none" stroke="black" points="7460.24,-25336 6759.12,-25336 6578.76,-25170 7279.88,-25170 7460.24,-25336"/>
<text text-anchor="middle" x="7019.5" y="-25279.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7019.5" y="-25264.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-25249.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-25234.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-25219.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_token_aggregation&#45;&gt;layer0_res2 -->
<g id="edge104" class="edge">
<title>layer0_token_aggregation&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" d="M7019.5,-25371.95C7019.5,-25363.63 7019.5,-25355 7019.5,-25346.38"/>
<polygon fill="black" stroke="black" points="7023,-25346.28 7019.5,-25336.28 7016,-25346.28 7023,-25346.28"/>
</g>
<!-- layer1_mha_qkv -->
<g id="node76" class="node">
<title>layer1_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7255.5,-25134 6783.5,-25134 6783.5,-25066 7255.5,-25066 7255.5,-25134"/>
<text text-anchor="middle" x="7019.5" y="-25118.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7019.5" y="-25103.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-25088.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7019.5" y="-25073.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_res2&#45;&gt;layer1_mha_qkv -->
<g id="edge105" class="edge">
<title>layer0_res2&#45;&gt;layer1_mha_qkv</title>
<path fill="none" stroke="black" d="M7019.5,-25169.87C7019.5,-25161.12 7019.5,-25152.48 7019.5,-25144.45"/>
<polygon fill="black" stroke="black" points="7023,-25144.26 7019.5,-25134.26 7016,-25144.26 7023,-25144.26"/>
</g>
<!-- layer1_mha_attn -->
<g id="node77" class="node">
<title>layer1_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7249.5,-25030 6789.5,-25030 6789.5,-24962 7249.5,-24962 7249.5,-25030"/>
<text text-anchor="middle" x="7019.5" y="-25014.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7019.5" y="-24999.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7019.5" y="-24984.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24969.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_mha_qkv&#45;&gt;layer1_mha_attn -->
<g id="edge106" class="edge">
<title>layer1_mha_qkv&#45;&gt;layer1_mha_attn</title>
<path fill="none" stroke="black" d="M7019.5,-25065.88C7019.5,-25057.78 7019.5,-25048.98 7019.5,-25040.47"/>
<polygon fill="black" stroke="black" points="7023,-25040.3 7019.5,-25030.3 7016,-25040.3 7023,-25040.3"/>
</g>
<!-- layer1_mha_out -->
<g id="node78" class="node">
<title>layer1_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7232,-24926 6807,-24926 6807,-24858 7232,-24858 7232,-24926"/>
<text text-anchor="middle" x="7019.5" y="-24910.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7019.5" y="-24895.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24880.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24865.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_mha_attn&#45;&gt;layer1_mha_out -->
<g id="edge107" class="edge">
<title>layer1_mha_attn&#45;&gt;layer1_mha_out</title>
<path fill="none" stroke="black" d="M7019.5,-24961.88C7019.5,-24953.78 7019.5,-24944.98 7019.5,-24936.47"/>
<polygon fill="black" stroke="black" points="7023,-24936.3 7019.5,-24926.3 7016,-24936.3 7023,-24936.3"/>
</g>
<!-- layer1_res1 -->
<g id="node79" class="node">
<title>layer1_res1</title>
<polygon fill="none" stroke="black" points="7460.24,-24822 6759.12,-24822 6578.76,-24656 7279.88,-24656 7460.24,-24822"/>
<text text-anchor="middle" x="7019.5" y="-24765.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7019.5" y="-24750.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24735.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24720.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24705.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_mha_out&#45;&gt;layer1_res1 -->
<g id="edge108" class="edge">
<title>layer1_mha_out&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M7019.5,-24857.86C7019.5,-24850.1 7019.5,-24841.46 7019.5,-24832.48"/>
<polygon fill="black" stroke="black" points="7023,-24832.23 7019.5,-24822.23 7016,-24832.23 7023,-24832.23"/>
</g>
<!-- layer1_ln1 -->
<g id="node80" class="node">
<title>layer1_ln1</title>
<polygon fill="yellow" stroke="black" points="7232,-24620 6807,-24620 6807,-24552 7232,-24552 7232,-24620"/>
<text text-anchor="middle" x="7019.5" y="-24604.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7019.5" y="-24589.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24574.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24559.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln1 -->
<g id="edge109" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln1</title>
<path fill="none" stroke="black" d="M7019.5,-24655.87C7019.5,-24647.12 7019.5,-24638.48 7019.5,-24630.45"/>
<polygon fill="black" stroke="black" points="7023,-24630.26 7019.5,-24620.26 7016,-24630.26 7023,-24630.26"/>
</g>
<!-- layer1_expert_routing -->
<g id="node81" class="node">
<title>layer1_expert_routing</title>
<polygon fill="orange" stroke="black" points="7019.5,-24516 6603.5,-24433 7019.5,-24350 7435.5,-24433 7019.5,-24516"/>
<text text-anchor="middle" x="7019.5" y="-24459.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7019.5" y="-24444.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7019.5" y="-24429.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24414.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7019.5" y="-24399.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_expert_routing -->
<g id="edge110" class="edge">
<title>layer1_ln1&#45;&gt;layer1_expert_routing</title>
<path fill="none" stroke="black" d="M7019.5,-24551.86C7019.5,-24544.1 7019.5,-24535.46 7019.5,-24526.48"/>
<polygon fill="black" stroke="black" points="7023,-24526.23 7019.5,-24516.23 7016,-24526.23 7023,-24526.23"/>
</g>
<!-- layer1_token_distribution -->
<g id="node82" class="node">
<title>layer1_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7447.86,-24314 6766.44,-24314 6591.14,-24178 7272.56,-24178 7447.86,-24314"/>
<text text-anchor="middle" x="7019.5" y="-24264.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7019.5" y="-24249.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7019.5" y="-24234.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7019.5" y="-24219.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer1_expert_routing&#45;&gt;layer1_token_distribution -->
<g id="edge111" class="edge">
<title>layer1_expert_routing&#45;&gt;layer1_token_distribution</title>
<path fill="none" stroke="black" d="M7019.5,-24349.78C7019.5,-24341.34 7019.5,-24332.79 7019.5,-24324.4"/>
<polygon fill="black" stroke="black" points="7023,-24324.28 7019.5,-24314.28 7016,-24324.28 7023,-24324.28"/>
</g>
<!-- layer1_expert0_gate -->
<g id="node83" class="node">
<title>layer1_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="816,-24142 421,-24142 421,-24074 816,-24074 816,-24142"/>
<text text-anchor="middle" x="618.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="618.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="618.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="618.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert0_gate -->
<g id="edge112" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6678.42,-24245.72C5557.99,-24247.09 1996.01,-24243.23 826.31,-24142.11"/>
<polygon fill="black" stroke="black" points="826.32,-24138.6 816.06,-24141.22 825.71,-24145.57 826.32,-24138.6"/>
</g>
<!-- layer1_expert0_up -->
<g id="node84" class="node">
<title>layer1_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1229,-24142 834,-24142 834,-24074 1229,-24074 1229,-24142"/>
<text text-anchor="middle" x="1031.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1031.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1031.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1031.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert0_up -->
<g id="edge113" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6677.42,-24245.24C5606.28,-24245 2324.27,-24236.44 1239.35,-24142.12"/>
<polygon fill="black" stroke="black" points="1239.32,-24138.6 1229.06,-24141.21 1238.71,-24145.57 1239.32,-24138.6"/>
</g>
<!-- layer1_expert1_gate -->
<g id="node87" class="node">
<title>layer1_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1642,-24142 1247,-24142 1247,-24074 1642,-24074 1642,-24142"/>
<text text-anchor="middle" x="1444.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1444.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1444.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1444.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert1_gate -->
<g id="edge118" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6676.86,-24244.69C5657.38,-24242.77 2652.69,-24229.69 1652.28,-24142.11"/>
<polygon fill="black" stroke="black" points="1652.33,-24138.6 1642.06,-24141.21 1651.71,-24145.57 1652.33,-24138.6"/>
</g>
<!-- layer1_expert1_up -->
<g id="node88" class="node">
<title>layer1_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2055,-24142 1660,-24142 1660,-24074 2055,-24074 2055,-24142"/>
<text text-anchor="middle" x="1857.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1857.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1857.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1857.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert1_up -->
<g id="edge119" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6675.92,-24244.04C5709.86,-24240.35 2981.03,-24222.95 2065.08,-24142.09"/>
<polygon fill="black" stroke="black" points="2065.33,-24138.6 2055.06,-24141.2 2064.71,-24145.58 2065.33,-24138.6"/>
</g>
<!-- layer1_expert2_gate -->
<g id="node91" class="node">
<title>layer1_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2468,-24142 2073,-24142 2073,-24074 2468,-24074 2468,-24142"/>
<text text-anchor="middle" x="2270.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2270.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2270.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2270.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert2_gate -->
<g id="edge124" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6674.93,-24243.27C5764.78,-24237.72 3310.04,-24216.22 2478.07,-24142.1"/>
<polygon fill="black" stroke="black" points="2478.33,-24138.6 2468.06,-24141.19 2477.7,-24145.58 2478.33,-24138.6"/>
</g>
<!-- layer1_expert2_up -->
<g id="node92" class="node">
<title>layer1_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2881,-24142 2486,-24142 2486,-24074 2881,-24074 2881,-24142"/>
<text text-anchor="middle" x="2683.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2683.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2683.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2683.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert2_up -->
<g id="edge125" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6673.99,-24242.34C5822.65,-24234.84 3639.62,-24209.52 2891.16,-24142.1"/>
<polygon fill="black" stroke="black" points="2891.34,-24138.61 2881.06,-24141.18 2890.7,-24145.58 2891.34,-24138.61"/>
</g>
<!-- layer1_expert3_gate -->
<g id="node95" class="node">
<title>layer1_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3294,-24142 2899,-24142 2899,-24074 3294,-24074 3294,-24142"/>
<text text-anchor="middle" x="3096.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3096.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3096.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3096.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert3_gate -->
<g id="edge130" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6672.41,-24241.2C5882.73,-24231.62 3969.42,-24202.84 3304.24,-24142.11"/>
<polygon fill="black" stroke="black" points="3304.34,-24138.61 3294.06,-24141.17 3303.7,-24145.58 3304.34,-24138.61"/>
</g>
<!-- layer1_expert3_up -->
<g id="node96" class="node">
<title>layer1_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3707,-24142 3312,-24142 3312,-24074 3707,-24074 3707,-24142"/>
<text text-anchor="middle" x="3509.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3509.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3509.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3509.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert3_up -->
<g id="edge131" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6670.52,-24239.77C5946.21,-24227.98 4299.46,-24196.17 3717.25,-24142.12"/>
<polygon fill="black" stroke="black" points="3717.35,-24138.61 3707.06,-24141.16 3716.69,-24145.58 3717.35,-24138.61"/>
</g>
<!-- layer1_expert4_gate -->
<g id="node99" class="node">
<title>layer1_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4120,-24142 3725,-24142 3725,-24074 4120,-24074 4120,-24142"/>
<text text-anchor="middle" x="3922.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3922.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3922.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3922.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert4_gate -->
<g id="edge136" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6668.06,-24237.9C6013.59,-24223.8 4629.94,-24189.52 4130.26,-24142.12"/>
<polygon fill="black" stroke="black" points="4130.35,-24138.62 4120.06,-24141.14 4129.68,-24145.58 4130.35,-24138.62"/>
</g>
<!-- layer1_expert4_up -->
<g id="node100" class="node">
<title>layer1_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4533,-24142 4138,-24142 4138,-24074 4533,-24074 4533,-24142"/>
<text text-anchor="middle" x="4335.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4335.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4335.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4335.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert4_up -->
<g id="edge137" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6675.37,-24243.42C6198.11,-24238.35 5308.47,-24218.49 4543.19,-24142.13"/>
<polygon fill="black" stroke="black" points="4543.36,-24138.63 4533.07,-24141.12 4542.67,-24145.6 4543.36,-24138.63"/>
</g>
<!-- layer1_expert5_gate -->
<g id="node103" class="node">
<title>layer1_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4946,-24142 4551,-24142 4551,-24074 4946,-24074 4946,-24142"/>
<text text-anchor="middle" x="4748.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4748.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4748.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4748.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert5_gate -->
<g id="edge142" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6669.68,-24239.16C6260.56,-24229.67 5563.04,-24205.18 4956.34,-24142.16"/>
<polygon fill="black" stroke="black" points="4956.38,-24138.64 4946.07,-24141.09 4955.65,-24145.61 4956.38,-24138.64"/>
</g>
<!-- layer1_expert5_up -->
<g id="node104" class="node">
<title>layer1_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5359,-24142 4964,-24142 4964,-24074 5359,-24074 5359,-24142"/>
<text text-anchor="middle" x="5161.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5161.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5161.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5161.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert5_up -->
<g id="edge143" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6661.34,-24232.65C6328.6,-24218.84 5819.32,-24191.72 5369.03,-24142.14"/>
<polygon fill="black" stroke="black" points="5369.4,-24138.66 5359.07,-24141.04 5368.63,-24145.62 5369.4,-24138.66"/>
</g>
<!-- layer1_expert6_gate -->
<g id="node107" class="node">
<title>layer1_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5772,-24142 5377,-24142 5377,-24074 5772,-24074 5772,-24142"/>
<text text-anchor="middle" x="5574.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5574.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5574.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5574.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert6_gate -->
<g id="edge148" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6647.03,-24221.44C6403.4,-24204.23 6078.1,-24177.86 5782.16,-24142.18"/>
<polygon fill="black" stroke="black" points="5782.43,-24138.68 5772.08,-24140.96 5781.59,-24145.63 5782.43,-24138.68"/>
</g>
<!-- layer1_expert6_up -->
<g id="node108" class="node">
<title>layer1_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6185,-24142 5790,-24142 5790,-24074 6185,-24074 6185,-24142"/>
<text text-anchor="middle" x="5987.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5987.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5987.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5987.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert6_up -->
<g id="edge149" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6616.33,-24197.57C6484.89,-24181.37 6338.08,-24162.49 6195.37,-24142.25"/>
<polygon fill="black" stroke="black" points="6195.5,-24138.74 6185.11,-24140.79 6194.51,-24145.67 6195.5,-24138.74"/>
</g>
<!-- layer1_expert7_gate -->
<g id="node111" class="node">
<title>layer1_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6598,-24142 6203,-24142 6203,-24074 6598,-24074 6598,-24142"/>
<text text-anchor="middle" x="6400.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6400.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6400.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6400.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert7_gate -->
<g id="edge154" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6714.53,-24178C6661.4,-24166.32 6608.09,-24154.61 6560.86,-24144.23"/>
<polygon fill="black" stroke="black" points="6561.4,-24140.77 6550.88,-24142.04 6559.89,-24147.6 6561.4,-24140.77"/>
</g>
<!-- layer1_expert7_up -->
<g id="node112" class="node">
<title>layer1_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="7011,-24142 6616,-24142 6616,-24074 7011,-24074 7011,-24142"/>
<text text-anchor="middle" x="6813.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6813.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6813.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6813.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert7_up -->
<g id="edge155" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6918.01,-24178C6902.37,-24167.67 6886.68,-24157.31 6872.38,-24147.87"/>
<polygon fill="black" stroke="black" points="6873.95,-24144.72 6863.68,-24142.13 6870.1,-24150.56 6873.95,-24144.72"/>
</g>
<!-- layer1_expert8_gate -->
<g id="node115" class="node">
<title>layer1_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7424,-24142 7029,-24142 7029,-24074 7424,-24074 7424,-24142"/>
<text text-anchor="middle" x="7226.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7226.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7226.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7226.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert8_gate -->
<g id="edge160" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7121.48,-24178C7137.2,-24167.67 7152.97,-24157.31 7167.33,-24147.87"/>
<polygon fill="black" stroke="black" points="7169.64,-24150.54 7176.08,-24142.13 7165.8,-24144.69 7169.64,-24150.54"/>
</g>
<!-- layer1_expert8_up -->
<g id="node116" class="node">
<title>layer1_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7837,-24142 7442,-24142 7442,-24074 7837,-24074 7837,-24142"/>
<text text-anchor="middle" x="7639.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7639.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7639.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7639.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert8_up -->
<g id="edge161" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7284.23,-24186.93C7350.49,-24172.4 7419.56,-24157.25 7478.99,-24144.21"/>
<polygon fill="black" stroke="black" points="7479.81,-24147.61 7488.82,-24142.05 7478.31,-24140.78 7479.81,-24147.61"/>
</g>
<!-- layer1_expert9_gate -->
<g id="node119" class="node">
<title>layer1_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8250,-24142 7855,-24142 7855,-24074 8250,-24074 8250,-24142"/>
<text text-anchor="middle" x="8052.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8052.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8052.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8052.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert9_gate -->
<g id="edge166" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7315.03,-24210.73C7470.07,-24192.13 7663.37,-24167.94 7844.89,-24142.22"/>
<polygon fill="black" stroke="black" points="7845.49,-24145.67 7854.89,-24140.8 7844.5,-24138.74 7845.49,-24145.67"/>
</g>
<!-- layer1_expert9_up -->
<g id="node120" class="node">
<title>layer1_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8663,-24142 8268,-24142 8268,-24074 8663,-24074 8663,-24142"/>
<text text-anchor="middle" x="8465.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8465.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8465.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8465.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert9_up -->
<g id="edge167" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7333.91,-24225.51C7582.39,-24208.52 7938.09,-24180.72 8257.99,-24142.16"/>
<polygon fill="black" stroke="black" points="8258.41,-24145.63 8267.92,-24140.96 8257.57,-24138.68 8258.41,-24145.63"/>
</g>
<!-- layer1_expert10_gate -->
<g id="node123" class="node">
<title>layer1_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9076,-24142 8681,-24142 8681,-24074 9076,-24074 9076,-24142"/>
<text text-anchor="middle" x="8878.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8878.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8878.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8878.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert10_gate -->
<g id="edge172" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7344.93,-24234.01C7676.51,-24220.65 8205.55,-24193.38 8670.98,-24142.14"/>
<polygon fill="black" stroke="black" points="8671.37,-24145.62 8680.93,-24141.04 8670.6,-24138.66 8671.37,-24145.62"/>
</g>
<!-- layer1_expert10_up -->
<g id="node124" class="node">
<title>layer1_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9489,-24142 9094,-24142 9094,-24074 9489,-24074 9489,-24142"/>
<text text-anchor="middle" x="9291.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9291.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9291.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9291.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert10_up -->
<g id="edge173" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7352.24,-24239.57C7759.05,-24230.37 8468.4,-24206.08 9083.97,-24142.13"/>
<polygon fill="black" stroke="black" points="9084.35,-24145.61 9093.93,-24141.09 9083.62,-24138.64 9084.35,-24145.61"/>
</g>
<!-- layer1_expert11_gate -->
<g id="node127" class="node">
<title>layer1_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9902,-24142 9507,-24142 9507,-24074 9902,-24074 9902,-24142"/>
<text text-anchor="middle" x="9704.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9704.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9704.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9704.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert11_gate -->
<g id="edge178" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7357.2,-24243.5C7833.01,-24238.55 8727.7,-24218.86 9496.76,-24142.14"/>
<polygon fill="black" stroke="black" points="9497.33,-24145.6 9506.93,-24141.12 9496.64,-24138.63 9497.33,-24145.6"/>
</g>
<!-- layer1_expert11_up -->
<g id="node128" class="node">
<title>layer1_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10315,-24142 9920,-24142 9920,-24074 10315,-24074 10315,-24142"/>
<text text-anchor="middle" x="10117.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10117.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10117.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10117.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert11_up -->
<g id="edge179" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7350.5,-24238.35C7996.28,-24224.53 9404.47,-24190.03 9909.63,-24142.13"/>
<polygon fill="black" stroke="black" points="9910.32,-24145.58 9919.94,-24141.14 9909.65,-24138.62 9910.32,-24145.58"/>
</g>
<!-- layer1_expert12_gate -->
<g id="node131" class="node">
<title>layer1_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10728,-24142 10333,-24142 10333,-24074 10728,-24074 10728,-24142"/>
<text text-anchor="middle" x="10530.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10530.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10530.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10530.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert12_gate -->
<g id="edge184" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7352.83,-24240.02C8068.92,-24228.46 9736.02,-24196.58 10322.68,-24142.13"/>
<polygon fill="black" stroke="black" points="10323.31,-24145.58 10332.94,-24141.16 10322.65,-24138.61 10323.31,-24145.58"/>
</g>
<!-- layer1_expert12_up -->
<g id="node132" class="node">
<title>layer1_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11141,-24142 10746,-24142 10746,-24074 11141,-24074 11141,-24142"/>
<text text-anchor="middle" x="10943.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10943.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10943.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10943.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert12_up -->
<g id="edge185" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7354.57,-24241.35C8136.82,-24231.92 10066.91,-24203.16 10735.7,-24142.12"/>
<polygon fill="black" stroke="black" points="10736.3,-24145.58 10745.94,-24141.17 10735.66,-24138.61 10736.3,-24145.58"/>
</g>
<!-- layer1_expert13_gate -->
<g id="node135" class="node">
<title>layer1_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11554,-24142 11159,-24142 11159,-24074 11554,-24074 11554,-24142"/>
<text text-anchor="middle" x="11356.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11356.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11356.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11356.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert13_gate -->
<g id="edge190" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7355.74,-24242.43C8200.52,-24235.03 10397.4,-24209.78 11148.8,-24142.11"/>
<polygon fill="black" stroke="black" points="11149.3,-24145.58 11158.94,-24141.18 11148.66,-24138.61 11149.3,-24145.58"/>
</g>
<!-- layer1_expert13_up -->
<g id="node136" class="node">
<title>layer1_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11967,-24142 11572,-24142 11572,-24074 11967,-24074 11967,-24142"/>
<text text-anchor="middle" x="11769.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11769.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11769.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11769.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert13_up -->
<g id="edge191" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7357.14,-24243.31C8261.83,-24237.84 10727.6,-24216.43 11561.9,-24142.1"/>
<polygon fill="black" stroke="black" points="11562.3,-24145.58 11571.94,-24141.19 11561.67,-24138.6 11562.3,-24145.58"/>
</g>
<!-- layer1_expert14_gate -->
<g id="node139" class="node">
<title>layer1_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12380,-24142 11985,-24142 11985,-24074 12380,-24074 12380,-24142"/>
<text text-anchor="middle" x="12182.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12182.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12182.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12182.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert14_gate -->
<g id="edge196" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7357.95,-24244.06C8319.58,-24240.42 11057.12,-24223.11 11974.9,-24142.1"/>
<polygon fill="black" stroke="black" points="11975.29,-24145.58 11984.94,-24141.2 11974.67,-24138.6 11975.29,-24145.58"/>
</g>
<!-- layer1_expert14_up -->
<g id="node140" class="node">
<title>layer1_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12793,-24142 12398,-24142 12398,-24074 12793,-24074 12793,-24142"/>
<text text-anchor="middle" x="12595.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12595.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12595.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12595.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert14_up -->
<g id="edge197" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7358.58,-24244.7C8374.74,-24242.8 11385.92,-24229.81 12387.71,-24142.11"/>
<polygon fill="black" stroke="black" points="12388.29,-24145.57 12397.94,-24141.21 12387.67,-24138.6 12388.29,-24145.57"/>
</g>
<!-- layer1_expert15_gate -->
<g id="node143" class="node">
<title>layer1_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13206,-24142 12811,-24142 12811,-24074 13206,-24074 13206,-24142"/>
<text text-anchor="middle" x="13008.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="13008.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13008.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13008.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert15_gate -->
<g id="edge202" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7359.27,-24245.24C8428.13,-24245.02 11714.73,-24236.53 12800.64,-24142.12"/>
<polygon fill="black" stroke="black" points="12801.29,-24145.57 12810.94,-24141.21 12800.68,-24138.6 12801.29,-24145.57"/>
</g>
<!-- layer1_expert15_up -->
<g id="node144" class="node">
<title>layer1_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13619,-24142 13224,-24142 13224,-24074 13619,-24074 13619,-24142"/>
<text text-anchor="middle" x="13421.5" y="-24126.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13421.5" y="-24111.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13421.5" y="-24096.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13421.5" y="-24081.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_token_distribution&#45;&gt;layer1_expert15_up -->
<g id="edge203" class="edge">
<title>layer1_token_distribution&#45;&gt;layer1_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7360.15,-24245.72C8480.21,-24247.1 12043.63,-24243.26 13213.69,-24142.11"/>
<polygon fill="black" stroke="black" points="13214.29,-24145.57 13223.94,-24141.22 13213.68,-24138.6 13214.29,-24145.57"/>
</g>
<!-- layer1_expert0_act -->
<g id="node85" class="node">
<title>layer1_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1229,-24038 834,-24038 834,-23970 1229,-23970 1229,-24038"/>
<text text-anchor="middle" x="1031.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1031.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1031.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1031.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_expert0_gate&#45;&gt;layer1_expert0_act -->
<g id="edge114" class="edge">
<title>layer1_expert0_gate&#45;&gt;layer1_expert0_act</title>
<path fill="none" stroke="black" d="M752.3,-24073.95C795.56,-24063.27 843.7,-24051.38 887.66,-24040.53"/>
<polygon fill="black" stroke="black" points="888.69,-24043.88 897.56,-24038.08 887.01,-24037.08 888.69,-24043.88"/>
</g>
<!-- layer1_expert0_up&#45;&gt;layer1_expert0_act -->
<g id="edge115" class="edge">
<title>layer1_expert0_up&#45;&gt;layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1031.5,-24073.88C1031.5,-24065.78 1031.5,-24056.98 1031.5,-24048.47"/>
<polygon fill="black" stroke="black" points="1035,-24048.3 1031.5,-24038.3 1028,-24048.3 1035,-24048.3"/>
</g>
<!-- layer1_expert0_down -->
<g id="node86" class="node">
<title>layer1_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1648,-23934 1265,-23934 1265,-23866 1648,-23866 1648,-23934"/>
<text text-anchor="middle" x="1456.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1456.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1456.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1456.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_expert0_act&#45;&gt;layer1_expert0_down -->
<g id="edge116" class="edge">
<title>layer1_expert0_act&#45;&gt;layer1_expert0_down</title>
<path fill="none" stroke="black" d="M1169.19,-23969.95C1213.8,-23959.25 1263.45,-23947.33 1308.76,-23936.46"/>
<polygon fill="black" stroke="black" points="1309.76,-23939.82 1318.66,-23934.08 1308.12,-23933.01 1309.76,-23939.82"/>
</g>
<!-- layer1_token_aggregation -->
<g id="node147" class="node">
<title>layer1_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7492.24,-23830 6735.44,-23830 6540.76,-23694 7297.56,-23694 7492.24,-23830"/>
<text text-anchor="middle" x="7016.5" y="-23780.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7016.5" y="-23765.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7016.5" y="-23750.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23735.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_expert0_down&#45;&gt;layer1_token_aggregation -->
<g id="edge117" class="edge">
<title>layer1_expert0_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M1648.14,-23881.25C1717.5,-23875.46 1796.47,-23869.6 1868.5,-23866 3645.48,-23777.14 5771.12,-23764.19 6629.16,-23762.83"/>
<polygon fill="black" stroke="black" points="6629.2,-23766.33 6639.2,-23762.81 6629.19,-23759.33 6629.2,-23766.33"/>
</g>
<!-- layer1_expert1_act -->
<g id="node89" class="node">
<title>layer1_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2055,-24038 1660,-24038 1660,-23970 2055,-23970 2055,-24038"/>
<text text-anchor="middle" x="1857.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1857.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1857.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1857.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_expert1_gate&#45;&gt;layer1_expert1_act -->
<g id="edge120" class="edge">
<title>layer1_expert1_gate&#45;&gt;layer1_expert1_act</title>
<path fill="none" stroke="black" d="M1578.3,-24073.95C1621.56,-24063.27 1669.7,-24051.38 1713.66,-24040.53"/>
<polygon fill="black" stroke="black" points="1714.69,-24043.88 1723.56,-24038.08 1713.01,-24037.08 1714.69,-24043.88"/>
</g>
<!-- layer1_expert1_up&#45;&gt;layer1_expert1_act -->
<g id="edge121" class="edge">
<title>layer1_expert1_up&#45;&gt;layer1_expert1_act</title>
<path fill="none" stroke="black" d="M1857.5,-24073.88C1857.5,-24065.78 1857.5,-24056.98 1857.5,-24048.47"/>
<polygon fill="black" stroke="black" points="1861,-24048.3 1857.5,-24038.3 1854,-24048.3 1861,-24048.3"/>
</g>
<!-- layer1_expert1_down -->
<g id="node90" class="node">
<title>layer1_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2261,-23934 1878,-23934 1878,-23866 2261,-23866 2261,-23934"/>
<text text-anchor="middle" x="2069.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2069.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2069.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2069.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_expert1_act&#45;&gt;layer1_expert1_down -->
<g id="edge122" class="edge">
<title>layer1_expert1_act&#45;&gt;layer1_expert1_down</title>
<path fill="none" stroke="black" d="M1926.33,-23969.88C1947.17,-23959.86 1970.21,-23948.77 1991.6,-23938.48"/>
<polygon fill="black" stroke="black" points="1993.16,-23941.61 2000.65,-23934.12 1990.12,-23935.31 1993.16,-23941.61"/>
</g>
<!-- layer1_expert1_down&#45;&gt;layer1_token_aggregation -->
<g id="edge123" class="edge">
<title>layer1_expert1_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M2261.34,-23889.27C2408.97,-23882.04 2618.11,-23872.37 2801.5,-23866 4216.85,-23816.81 5900.35,-23783.14 6638.29,-23769.63"/>
<polygon fill="black" stroke="black" points="6638.61,-23773.12 6648.54,-23769.44 6638.48,-23766.12 6638.61,-23773.12"/>
</g>
<!-- layer1_expert2_act -->
<g id="node93" class="node">
<title>layer1_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2881,-24038 2486,-24038 2486,-23970 2881,-23970 2881,-24038"/>
<text text-anchor="middle" x="2683.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2683.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2683.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2683.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_expert2_gate&#45;&gt;layer1_expert2_act -->
<g id="edge126" class="edge">
<title>layer1_expert2_gate&#45;&gt;layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2404.3,-24073.95C2447.56,-24063.27 2495.7,-24051.38 2539.66,-24040.53"/>
<polygon fill="black" stroke="black" points="2540.69,-24043.88 2549.56,-24038.08 2539.01,-24037.08 2540.69,-24043.88"/>
</g>
<!-- layer1_expert2_up&#45;&gt;layer1_expert2_act -->
<g id="edge127" class="edge">
<title>layer1_expert2_up&#45;&gt;layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2683.5,-24073.88C2683.5,-24065.78 2683.5,-24056.98 2683.5,-24048.47"/>
<polygon fill="black" stroke="black" points="2687,-24048.3 2683.5,-24038.3 2680,-24048.3 2687,-24048.3"/>
</g>
<!-- layer1_expert2_down -->
<g id="node94" class="node">
<title>layer1_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3194,-23934 2811,-23934 2811,-23866 3194,-23866 3194,-23934"/>
<text text-anchor="middle" x="3002.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="3002.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3002.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3002.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_expert2_act&#45;&gt;layer1_expert2_down -->
<g id="edge128" class="edge">
<title>layer1_expert2_act&#45;&gt;layer1_expert2_down</title>
<path fill="none" stroke="black" d="M2787.07,-23969.88C2819.77,-23959.43 2856.07,-23947.82 2889.4,-23937.16"/>
<polygon fill="black" stroke="black" points="2890.72,-23940.42 2899.18,-23934.04 2888.59,-23933.75 2890.72,-23940.42"/>
</g>
<!-- layer1_expert2_down&#45;&gt;layer1_token_aggregation -->
<g id="edge129" class="edge">
<title>layer1_expert2_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M3194.28,-23891.07C3364.12,-23884.14 3618.79,-23873.96 3840.5,-23866 4854.81,-23829.58 6051.56,-23792.31 6644.65,-23774.22"/>
<polygon fill="black" stroke="black" points="6645.19,-23777.71 6655.08,-23773.9 6644.98,-23770.71 6645.19,-23777.71"/>
</g>
<!-- layer1_expert3_act -->
<g id="node97" class="node">
<title>layer1_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3707,-24038 3312,-24038 3312,-23970 3707,-23970 3707,-24038"/>
<text text-anchor="middle" x="3509.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3509.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3509.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3509.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_expert3_gate&#45;&gt;layer1_expert3_act -->
<g id="edge132" class="edge">
<title>layer1_expert3_gate&#45;&gt;layer1_expert3_act</title>
<path fill="none" stroke="black" d="M3230.3,-24073.95C3273.56,-24063.27 3321.7,-24051.38 3365.66,-24040.53"/>
<polygon fill="black" stroke="black" points="3366.69,-24043.88 3375.56,-24038.08 3365.01,-24037.08 3366.69,-24043.88"/>
</g>
<!-- layer1_expert3_up&#45;&gt;layer1_expert3_act -->
<g id="edge133" class="edge">
<title>layer1_expert3_up&#45;&gt;layer1_expert3_act</title>
<path fill="none" stroke="black" d="M3509.5,-24073.88C3509.5,-24065.78 3509.5,-24056.98 3509.5,-24048.47"/>
<polygon fill="black" stroke="black" points="3513,-24048.3 3509.5,-24038.3 3506,-24048.3 3513,-24048.3"/>
</g>
<!-- layer1_expert3_down -->
<g id="node98" class="node">
<title>layer1_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="4233,-23934 3850,-23934 3850,-23866 4233,-23866 4233,-23934"/>
<text text-anchor="middle" x="4041.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="4041.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4041.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4041.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_expert3_act&#45;&gt;layer1_expert3_down -->
<g id="edge134" class="edge">
<title>layer1_expert3_act&#45;&gt;layer1_expert3_down</title>
<path fill="none" stroke="black" d="M3681.86,-23969.95C3738.52,-23959.09 3801.68,-23946.98 3859.06,-23935.98"/>
<polygon fill="black" stroke="black" points="3859.8,-23939.4 3868.96,-23934.08 3858.48,-23932.53 3859.8,-23939.4"/>
</g>
<!-- layer1_expert3_down&#45;&gt;layer1_token_aggregation -->
<g id="edge135" class="edge">
<title>layer1_expert3_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M4233.3,-23888.43C4356.95,-23881.72 4521.2,-23873.02 4666.5,-23866 5368.01,-23832.11 6187.57,-23797.27 6649.96,-23778.05"/>
<polygon fill="black" stroke="black" points="6650.29,-23781.54 6660.13,-23777.63 6650,-23774.54 6650.29,-23781.54"/>
</g>
<!-- layer1_expert4_act -->
<g id="node101" class="node">
<title>layer1_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4533,-24038 4138,-24038 4138,-23970 4533,-23970 4533,-24038"/>
<text text-anchor="middle" x="4335.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4335.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4335.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4335.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_expert4_gate&#45;&gt;layer1_expert4_act -->
<g id="edge138" class="edge">
<title>layer1_expert4_gate&#45;&gt;layer1_expert4_act</title>
<path fill="none" stroke="black" d="M4056.3,-24073.95C4099.56,-24063.27 4147.7,-24051.38 4191.66,-24040.53"/>
<polygon fill="black" stroke="black" points="4192.69,-24043.88 4201.56,-24038.08 4191.01,-24037.08 4192.69,-24043.88"/>
</g>
<!-- layer1_expert4_up&#45;&gt;layer1_expert4_act -->
<g id="edge139" class="edge">
<title>layer1_expert4_up&#45;&gt;layer1_expert4_act</title>
<path fill="none" stroke="black" d="M4335.5,-24073.88C4335.5,-24065.78 4335.5,-24056.98 4335.5,-24048.47"/>
<polygon fill="black" stroke="black" points="4339,-24048.3 4335.5,-24038.3 4332,-24048.3 4339,-24048.3"/>
</g>
<!-- layer1_expert4_down -->
<g id="node102" class="node">
<title>layer1_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="5059,-23934 4676,-23934 4676,-23866 5059,-23866 5059,-23934"/>
<text text-anchor="middle" x="4867.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4867.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4867.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4867.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_expert4_act&#45;&gt;layer1_expert4_down -->
<g id="edge140" class="edge">
<title>layer1_expert4_act&#45;&gt;layer1_expert4_down</title>
<path fill="none" stroke="black" d="M4507.86,-23969.95C4564.52,-23959.09 4627.68,-23946.98 4685.06,-23935.98"/>
<polygon fill="black" stroke="black" points="4685.8,-23939.4 4694.96,-23934.08 4684.48,-23932.53 4685.8,-23939.4"/>
</g>
<!-- layer1_expert4_down&#45;&gt;layer1_token_aggregation -->
<g id="edge141" class="edge">
<title>layer1_expert4_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M5059.23,-23882.81C5128.61,-23877.18 5207.56,-23871.01 5279.5,-23866 5755.22,-23832.85 6304.72,-23801.42 6656.12,-23782.19"/>
<polygon fill="black" stroke="black" points="6656.41,-23785.68 6666.2,-23781.64 6656.03,-23778.69 6656.41,-23785.68"/>
</g>
<!-- layer1_expert5_act -->
<g id="node105" class="node">
<title>layer1_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5359,-24038 4964,-24038 4964,-23970 5359,-23970 5359,-24038"/>
<text text-anchor="middle" x="5161.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5161.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5161.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5161.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_expert5_gate&#45;&gt;layer1_expert5_act -->
<g id="edge144" class="edge">
<title>layer1_expert5_gate&#45;&gt;layer1_expert5_act</title>
<path fill="none" stroke="black" d="M4882.3,-24073.95C4925.56,-24063.27 4973.7,-24051.38 5017.66,-24040.53"/>
<polygon fill="black" stroke="black" points="5018.69,-24043.88 5027.56,-24038.08 5017.01,-24037.08 5018.69,-24043.88"/>
</g>
<!-- layer1_expert5_up&#45;&gt;layer1_expert5_act -->
<g id="edge145" class="edge">
<title>layer1_expert5_up&#45;&gt;layer1_expert5_act</title>
<path fill="none" stroke="black" d="M5161.5,-24073.88C5161.5,-24065.78 5161.5,-24056.98 5161.5,-24048.47"/>
<polygon fill="black" stroke="black" points="5165,-24048.3 5161.5,-24038.3 5158,-24048.3 5165,-24048.3"/>
</g>
<!-- layer1_expert5_down -->
<g id="node106" class="node">
<title>layer1_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5672,-23934 5289,-23934 5289,-23866 5672,-23866 5672,-23934"/>
<text text-anchor="middle" x="5480.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5480.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5480.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5480.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_expert5_act&#45;&gt;layer1_expert5_down -->
<g id="edge146" class="edge">
<title>layer1_expert5_act&#45;&gt;layer1_expert5_down</title>
<path fill="none" stroke="black" d="M5265.07,-23969.88C5297.77,-23959.43 5334.07,-23947.82 5367.4,-23937.16"/>
<polygon fill="black" stroke="black" points="5368.72,-23940.42 5377.18,-23934.04 5366.59,-23933.75 5368.72,-23940.42"/>
</g>
<!-- layer1_expert5_down&#45;&gt;layer1_token_aggregation -->
<g id="edge147" class="edge">
<title>layer1_expert5_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M5672.32,-23882.02C5922.14,-23859.9 6363.32,-23820.83 6671.88,-23793.51"/>
<polygon fill="black" stroke="black" points="6672.23,-23797 6681.89,-23792.63 6671.62,-23790.02 6672.23,-23797"/>
</g>
<!-- layer1_expert6_act -->
<g id="node109" class="node">
<title>layer1_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6185,-24038 5790,-24038 5790,-23970 6185,-23970 6185,-24038"/>
<text text-anchor="middle" x="5987.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5987.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5987.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5987.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_expert6_gate&#45;&gt;layer1_expert6_act -->
<g id="edge150" class="edge">
<title>layer1_expert6_gate&#45;&gt;layer1_expert6_act</title>
<path fill="none" stroke="black" d="M5708.3,-24073.95C5751.56,-24063.27 5799.7,-24051.38 5843.66,-24040.53"/>
<polygon fill="black" stroke="black" points="5844.69,-24043.88 5853.56,-24038.08 5843.01,-24037.08 5844.69,-24043.88"/>
</g>
<!-- layer1_expert6_up&#45;&gt;layer1_expert6_act -->
<g id="edge151" class="edge">
<title>layer1_expert6_up&#45;&gt;layer1_expert6_act</title>
<path fill="none" stroke="black" d="M5987.5,-24073.88C5987.5,-24065.78 5987.5,-24056.98 5987.5,-24048.47"/>
<polygon fill="black" stroke="black" points="5991,-24048.3 5987.5,-24038.3 5984,-24048.3 5991,-24048.3"/>
</g>
<!-- layer1_expert6_down -->
<g id="node110" class="node">
<title>layer1_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6395,-23934 6012,-23934 6012,-23866 6395,-23866 6395,-23934"/>
<text text-anchor="middle" x="6203.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6203.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6203.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6203.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_expert6_act&#45;&gt;layer1_expert6_down -->
<g id="edge152" class="edge">
<title>layer1_expert6_act&#45;&gt;layer1_expert6_down</title>
<path fill="none" stroke="black" d="M6057.63,-23969.88C6078.86,-23959.86 6102.33,-23948.77 6124.13,-23938.48"/>
<polygon fill="black" stroke="black" points="6125.81,-23941.56 6133.35,-23934.12 6122.82,-23935.23 6125.81,-23941.56"/>
</g>
<!-- layer1_expert6_down&#45;&gt;layer1_token_aggregation -->
<g id="edge153" class="edge">
<title>layer1_expert6_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M6395.14,-23866.94C6486.66,-23851.63 6598.58,-23832.91 6702.09,-23815.59"/>
<polygon fill="black" stroke="black" points="6702.79,-23819.03 6712.08,-23813.92 6701.64,-23812.12 6702.79,-23819.03"/>
</g>
<!-- layer1_expert7_act -->
<g id="node113" class="node">
<title>layer1_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="7011,-24038 6616,-24038 6616,-23970 7011,-23970 7011,-24038"/>
<text text-anchor="middle" x="6813.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6813.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6813.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6813.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_expert7_gate&#45;&gt;layer1_expert7_act -->
<g id="edge156" class="edge">
<title>layer1_expert7_gate&#45;&gt;layer1_expert7_act</title>
<path fill="none" stroke="black" d="M6534.3,-24073.95C6577.56,-24063.27 6625.7,-24051.38 6669.66,-24040.53"/>
<polygon fill="black" stroke="black" points="6670.69,-24043.88 6679.56,-24038.08 6669.01,-24037.08 6670.69,-24043.88"/>
</g>
<!-- layer1_expert7_up&#45;&gt;layer1_expert7_act -->
<g id="edge157" class="edge">
<title>layer1_expert7_up&#45;&gt;layer1_expert7_act</title>
<path fill="none" stroke="black" d="M6813.5,-24073.88C6813.5,-24065.78 6813.5,-24056.98 6813.5,-24048.47"/>
<polygon fill="black" stroke="black" points="6817,-24048.3 6813.5,-24038.3 6810,-24048.3 6817,-24048.3"/>
</g>
<!-- layer1_expert7_down -->
<g id="node114" class="node">
<title>layer1_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="7008,-23934 6625,-23934 6625,-23866 7008,-23866 7008,-23934"/>
<text text-anchor="middle" x="6816.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6816.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6816.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6816.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_expert7_act&#45;&gt;layer1_expert7_down -->
<g id="edge158" class="edge">
<title>layer1_expert7_act&#45;&gt;layer1_expert7_down</title>
<path fill="none" stroke="black" d="M6814.47,-23969.88C6814.71,-23961.78 6814.97,-23952.98 6815.22,-23944.47"/>
<polygon fill="black" stroke="black" points="6818.73,-23944.4 6815.52,-23934.3 6811.73,-23944.19 6818.73,-23944.4"/>
</g>
<!-- layer1_expert7_down&#45;&gt;layer1_token_aggregation -->
<g id="edge159" class="edge">
<title>layer1_expert7_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M6865.17,-23865.9C6878.63,-23856.75 6893.8,-23846.44 6909.2,-23835.97"/>
<polygon fill="black" stroke="black" points="6911.47,-23838.66 6917.77,-23830.14 6907.53,-23832.87 6911.47,-23838.66"/>
</g>
<!-- layer1_expert8_act -->
<g id="node117" class="node">
<title>layer1_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7424,-24038 7029,-24038 7029,-23970 7424,-23970 7424,-24038"/>
<text text-anchor="middle" x="7226.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7226.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7226.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7226.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_expert8_gate&#45;&gt;layer1_expert8_act -->
<g id="edge162" class="edge">
<title>layer1_expert8_gate&#45;&gt;layer1_expert8_act</title>
<path fill="none" stroke="black" d="M7226.5,-24073.88C7226.5,-24065.78 7226.5,-24056.98 7226.5,-24048.47"/>
<polygon fill="black" stroke="black" points="7230,-24048.3 7226.5,-24038.3 7223,-24048.3 7230,-24048.3"/>
</g>
<!-- layer1_expert8_up&#45;&gt;layer1_expert8_act -->
<g id="edge163" class="edge">
<title>layer1_expert8_up&#45;&gt;layer1_expert8_act</title>
<path fill="none" stroke="black" d="M7505.7,-24073.95C7462.44,-24063.27 7414.3,-24051.38 7370.34,-24040.53"/>
<polygon fill="black" stroke="black" points="7370.99,-24037.08 7360.44,-24038.08 7369.31,-24043.88 7370.99,-24037.08"/>
</g>
<!-- layer1_expert8_down -->
<g id="node118" class="node">
<title>layer1_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7415,-23934 7032,-23934 7032,-23866 7415,-23866 7415,-23934"/>
<text text-anchor="middle" x="7223.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7223.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7223.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7223.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_expert8_act&#45;&gt;layer1_expert8_down -->
<g id="edge164" class="edge">
<title>layer1_expert8_act&#45;&gt;layer1_expert8_down</title>
<path fill="none" stroke="black" d="M7225.53,-23969.88C7225.29,-23961.78 7225.03,-23952.98 7224.78,-23944.47"/>
<polygon fill="black" stroke="black" points="7228.27,-23944.19 7224.48,-23934.3 7221.27,-23944.4 7228.27,-23944.19"/>
</g>
<!-- layer1_expert8_down&#45;&gt;layer1_token_aggregation -->
<g id="edge165" class="edge">
<title>layer1_expert8_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M7173.13,-23865.9C7159.06,-23856.66 7143.2,-23846.25 7127.12,-23835.67"/>
<polygon fill="black" stroke="black" points="7128.97,-23832.7 7118.69,-23830.14 7125.12,-23838.55 7128.97,-23832.7"/>
</g>
<!-- layer1_expert9_act -->
<g id="node121" class="node">
<title>layer1_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8250,-24038 7855,-24038 7855,-23970 8250,-23970 8250,-24038"/>
<text text-anchor="middle" x="8052.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8052.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8052.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8052.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_expert9_gate&#45;&gt;layer1_expert9_act -->
<g id="edge168" class="edge">
<title>layer1_expert9_gate&#45;&gt;layer1_expert9_act</title>
<path fill="none" stroke="black" d="M8052.5,-24073.88C8052.5,-24065.78 8052.5,-24056.98 8052.5,-24048.47"/>
<polygon fill="black" stroke="black" points="8056,-24048.3 8052.5,-24038.3 8049,-24048.3 8056,-24048.3"/>
</g>
<!-- layer1_expert9_up&#45;&gt;layer1_expert9_act -->
<g id="edge169" class="edge">
<title>layer1_expert9_up&#45;&gt;layer1_expert9_act</title>
<path fill="none" stroke="black" d="M8331.7,-24073.95C8288.44,-24063.27 8240.3,-24051.38 8196.34,-24040.53"/>
<polygon fill="black" stroke="black" points="8196.99,-24037.08 8186.44,-24038.08 8195.31,-24043.88 8196.99,-24037.08"/>
</g>
<!-- layer1_expert9_down -->
<g id="node122" class="node">
<title>layer1_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8031,-23934 7648,-23934 7648,-23866 8031,-23866 8031,-23934"/>
<text text-anchor="middle" x="7839.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7839.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7839.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7839.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_expert9_act&#45;&gt;layer1_expert9_down -->
<g id="edge170" class="edge">
<title>layer1_expert9_act&#45;&gt;layer1_expert9_down</title>
<path fill="none" stroke="black" d="M7983.35,-23969.88C7962.41,-23959.86 7939.26,-23948.77 7917.77,-23938.48"/>
<polygon fill="black" stroke="black" points="7919.2,-23935.29 7908.67,-23934.12 7916.18,-23941.6 7919.2,-23935.29"/>
</g>
<!-- layer1_expert9_down&#45;&gt;layer1_token_aggregation -->
<g id="edge171" class="edge">
<title>layer1_expert9_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M7647.84,-23867.33C7582.96,-23856.61 7507.75,-23844.18 7432.34,-23831.72"/>
<polygon fill="black" stroke="black" points="7432.62,-23828.22 7422.19,-23830.04 7431.48,-23835.12 7432.62,-23828.22"/>
</g>
<!-- layer1_expert10_act -->
<g id="node125" class="node">
<title>layer1_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9076,-24038 8681,-24038 8681,-23970 9076,-23970 9076,-24038"/>
<text text-anchor="middle" x="8878.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8878.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8878.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8878.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_expert10_gate&#45;&gt;layer1_expert10_act -->
<g id="edge174" class="edge">
<title>layer1_expert10_gate&#45;&gt;layer1_expert10_act</title>
<path fill="none" stroke="black" d="M8878.5,-24073.88C8878.5,-24065.78 8878.5,-24056.98 8878.5,-24048.47"/>
<polygon fill="black" stroke="black" points="8882,-24048.3 8878.5,-24038.3 8875,-24048.3 8882,-24048.3"/>
</g>
<!-- layer1_expert10_up&#45;&gt;layer1_expert10_act -->
<g id="edge175" class="edge">
<title>layer1_expert10_up&#45;&gt;layer1_expert10_act</title>
<path fill="none" stroke="black" d="M9157.7,-24073.95C9114.44,-24063.27 9066.3,-24051.38 9022.34,-24040.53"/>
<polygon fill="black" stroke="black" points="9022.99,-24037.08 9012.44,-24038.08 9021.31,-24043.88 9022.99,-24037.08"/>
</g>
<!-- layer1_expert10_down -->
<g id="node126" class="node">
<title>layer1_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8752,-23934 8369,-23934 8369,-23866 8752,-23866 8752,-23934"/>
<text text-anchor="middle" x="8560.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8560.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8560.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8560.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_expert10_act&#45;&gt;layer1_expert10_down -->
<g id="edge176" class="edge">
<title>layer1_expert10_act&#45;&gt;layer1_expert10_down</title>
<path fill="none" stroke="black" d="M8775.25,-23969.88C8742.65,-23959.43 8706.47,-23947.82 8673.25,-23937.16"/>
<polygon fill="black" stroke="black" points="8674.09,-23933.76 8663.5,-23934.04 8671.95,-23940.42 8674.09,-23933.76"/>
</g>
<!-- layer1_expert10_down&#45;&gt;layer1_token_aggregation -->
<g id="edge177" class="edge">
<title>layer1_expert10_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M8368.85,-23882.12C8143.46,-23862.27 7761.98,-23828.66 7461.54,-23802.2"/>
<polygon fill="black" stroke="black" points="7461.61,-23798.69 7451.34,-23801.3 7460.99,-23805.67 7461.61,-23798.69"/>
</g>
<!-- layer1_expert11_act -->
<g id="node129" class="node">
<title>layer1_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9902,-24038 9507,-24038 9507,-23970 9902,-23970 9902,-24038"/>
<text text-anchor="middle" x="9704.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9704.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9704.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9704.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_expert11_gate&#45;&gt;layer1_expert11_act -->
<g id="edge180" class="edge">
<title>layer1_expert11_gate&#45;&gt;layer1_expert11_act</title>
<path fill="none" stroke="black" d="M9704.5,-24073.88C9704.5,-24065.78 9704.5,-24056.98 9704.5,-24048.47"/>
<polygon fill="black" stroke="black" points="9708,-24048.3 9704.5,-24038.3 9701,-24048.3 9708,-24048.3"/>
</g>
<!-- layer1_expert11_up&#45;&gt;layer1_expert11_act -->
<g id="edge181" class="edge">
<title>layer1_expert11_up&#45;&gt;layer1_expert11_act</title>
<path fill="none" stroke="black" d="M9983.7,-24073.95C9940.44,-24063.27 9892.3,-24051.38 9848.34,-24040.53"/>
<polygon fill="black" stroke="black" points="9848.99,-24037.08 9838.44,-24038.08 9847.31,-24043.88 9848.99,-24037.08"/>
</g>
<!-- layer1_expert11_down -->
<g id="node130" class="node">
<title>layer1_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9526,-23934 9143,-23934 9143,-23866 9526,-23866 9526,-23934"/>
<text text-anchor="middle" x="9334.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9334.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9334.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9334.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_expert11_act&#45;&gt;layer1_expert11_down -->
<g id="edge182" class="edge">
<title>layer1_expert11_act&#45;&gt;layer1_expert11_down</title>
<path fill="none" stroke="black" d="M9584.63,-23969.95C9546.2,-23959.36 9503.47,-23947.58 9464.36,-23936.8"/>
<polygon fill="black" stroke="black" points="9465.07,-23933.36 9454.5,-23934.08 9463.21,-23940.11 9465.07,-23933.36"/>
</g>
<!-- layer1_expert11_down&#45;&gt;layer1_token_aggregation -->
<g id="edge183" class="edge">
<title>layer1_expert11_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M9142.84,-23887.75C8771.82,-23865.99 7947.55,-23817.63 7441.2,-23787.92"/>
<polygon fill="black" stroke="black" points="7441.35,-23784.42 7431.17,-23787.33 7440.94,-23791.41 7441.35,-23784.42"/>
</g>
<!-- layer1_expert12_act -->
<g id="node133" class="node">
<title>layer1_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10728,-24038 10333,-24038 10333,-23970 10728,-23970 10728,-24038"/>
<text text-anchor="middle" x="10530.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10530.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10530.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10530.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_expert12_gate&#45;&gt;layer1_expert12_act -->
<g id="edge186" class="edge">
<title>layer1_expert12_gate&#45;&gt;layer1_expert12_act</title>
<path fill="none" stroke="black" d="M10530.5,-24073.88C10530.5,-24065.78 10530.5,-24056.98 10530.5,-24048.47"/>
<polygon fill="black" stroke="black" points="10534,-24048.3 10530.5,-24038.3 10527,-24048.3 10534,-24048.3"/>
</g>
<!-- layer1_expert12_up&#45;&gt;layer1_expert12_act -->
<g id="edge187" class="edge">
<title>layer1_expert12_up&#45;&gt;layer1_expert12_act</title>
<path fill="none" stroke="black" d="M10809.7,-24073.95C10766.44,-24063.27 10718.3,-24051.38 10674.34,-24040.53"/>
<polygon fill="black" stroke="black" points="10674.99,-24037.08 10664.44,-24038.08 10673.31,-24043.88 10674.99,-24037.08"/>
</g>
<!-- layer1_expert12_down -->
<g id="node134" class="node">
<title>layer1_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10326,-23934 9943,-23934 9943,-23866 10326,-23866 10326,-23934"/>
<text text-anchor="middle" x="10134.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10134.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10134.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10134.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_expert12_act&#45;&gt;layer1_expert12_down -->
<g id="edge188" class="edge">
<title>layer1_expert12_act&#45;&gt;layer1_expert12_down</title>
<path fill="none" stroke="black" d="M10402.2,-23969.95C10360.81,-23959.29 10314.76,-23947.43 10272.69,-23936.59"/>
<polygon fill="black" stroke="black" points="10273.49,-23933.19 10262.93,-23934.08 10271.74,-23939.96 10273.49,-23933.19"/>
</g>
<!-- layer1_expert12_down&#45;&gt;layer1_token_aggregation -->
<g id="edge189" class="edge">
<title>layer1_expert12_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M9942.67,-23887.74C9825.15,-23881.01 9671.65,-23872.53 9535.5,-23866 8792.75,-23830.36 7926.41,-23796.66 7427.65,-23778.02"/>
<polygon fill="black" stroke="black" points="7427.53,-23774.52 7417.41,-23777.64 7427.27,-23781.51 7427.53,-23774.52"/>
</g>
<!-- layer1_expert13_act -->
<g id="node137" class="node">
<title>layer1_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11554,-24038 11159,-24038 11159,-23970 11554,-23970 11554,-24038"/>
<text text-anchor="middle" x="11356.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11356.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11356.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11356.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_expert13_gate&#45;&gt;layer1_expert13_act -->
<g id="edge192" class="edge">
<title>layer1_expert13_gate&#45;&gt;layer1_expert13_act</title>
<path fill="none" stroke="black" d="M11356.5,-24073.88C11356.5,-24065.78 11356.5,-24056.98 11356.5,-24048.47"/>
<polygon fill="black" stroke="black" points="11360,-24048.3 11356.5,-24038.3 11353,-24048.3 11360,-24048.3"/>
</g>
<!-- layer1_expert13_up&#45;&gt;layer1_expert13_act -->
<g id="edge193" class="edge">
<title>layer1_expert13_up&#45;&gt;layer1_expert13_act</title>
<path fill="none" stroke="black" d="M11635.7,-24073.95C11592.44,-24063.27 11544.3,-24051.38 11500.34,-24040.53"/>
<polygon fill="black" stroke="black" points="11500.99,-24037.08 11490.44,-24038.08 11499.31,-24043.88 11500.99,-24037.08"/>
</g>
<!-- layer1_expert13_down -->
<g id="node138" class="node">
<title>layer1_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11139,-23934 10756,-23934 10756,-23866 11139,-23866 11139,-23934"/>
<text text-anchor="middle" x="10947.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10947.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10947.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10947.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_expert13_act&#45;&gt;layer1_expert13_down -->
<g id="edge194" class="edge">
<title>layer1_expert13_act&#45;&gt;layer1_expert13_down</title>
<path fill="none" stroke="black" d="M11223.99,-23969.95C11181.15,-23959.27 11133.48,-23947.38 11089.95,-23936.53"/>
<polygon fill="black" stroke="black" points="11090.7,-23933.1 11080.15,-23934.08 11089,-23939.9 11090.7,-23933.1"/>
</g>
<!-- layer1_expert13_down&#45;&gt;layer1_token_aggregation -->
<g id="edge195" class="edge">
<title>layer1_expert13_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M10755.98,-23887.55C10635.35,-23880.61 10476.36,-23871.98 10335.5,-23866 9284.09,-23821.34 8044.53,-23788 7419.76,-23772.54"/>
<polygon fill="black" stroke="black" points="7419.78,-23769.04 7409.69,-23772.3 7419.6,-23776.04 7419.78,-23769.04"/>
</g>
<!-- layer1_expert14_act -->
<g id="node141" class="node">
<title>layer1_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12380,-24038 11985,-24038 11985,-23970 12380,-23970 12380,-24038"/>
<text text-anchor="middle" x="12182.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12182.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12182.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12182.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_expert14_gate&#45;&gt;layer1_expert14_act -->
<g id="edge198" class="edge">
<title>layer1_expert14_gate&#45;&gt;layer1_expert14_act</title>
<path fill="none" stroke="black" d="M12182.5,-24073.88C12182.5,-24065.78 12182.5,-24056.98 12182.5,-24048.47"/>
<polygon fill="black" stroke="black" points="12186,-24048.3 12182.5,-24038.3 12179,-24048.3 12186,-24048.3"/>
</g>
<!-- layer1_expert14_up&#45;&gt;layer1_expert14_act -->
<g id="edge199" class="edge">
<title>layer1_expert14_up&#45;&gt;layer1_expert14_act</title>
<path fill="none" stroke="black" d="M12461.7,-24073.95C12418.44,-24063.27 12370.3,-24051.38 12326.34,-24040.53"/>
<polygon fill="black" stroke="black" points="12326.99,-24037.08 12316.44,-24038.08 12325.31,-24043.88 12326.99,-24037.08"/>
</g>
<!-- layer1_expert14_down -->
<g id="node142" class="node">
<title>layer1_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11958,-23934 11575,-23934 11575,-23866 11958,-23866 11958,-23934"/>
<text text-anchor="middle" x="11766.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11766.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11766.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11766.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_expert14_act&#45;&gt;layer1_expert14_down -->
<g id="edge200" class="edge">
<title>layer1_expert14_act&#45;&gt;layer1_expert14_down</title>
<path fill="none" stroke="black" d="M12047.72,-23969.95C12004.15,-23959.27 11955.66,-23947.38 11911.39,-23936.53"/>
<polygon fill="black" stroke="black" points="11911.96,-23933.06 11901.42,-23934.08 11910.3,-23939.86 11911.96,-23933.06"/>
</g>
<!-- layer1_expert14_down&#45;&gt;layer1_token_aggregation -->
<g id="edge201" class="edge">
<title>layer1_expert14_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M11574.83,-23887.36C11452.82,-23880.3 11291.43,-23871.6 11148.5,-23866 9778.85,-23812.37 8152.66,-23781.43 7415.32,-23769.17"/>
<polygon fill="black" stroke="black" points="7415.12,-23765.67 7405.07,-23769 7415.01,-23772.67 7415.12,-23765.67"/>
</g>
<!-- layer1_expert15_act -->
<g id="node145" class="node">
<title>layer1_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13206,-24038 12811,-24038 12811,-23970 13206,-23970 13206,-24038"/>
<text text-anchor="middle" x="13008.5" y="-24022.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="13008.5" y="-24007.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13008.5" y="-23992.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13008.5" y="-23977.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_expert15_gate&#45;&gt;layer1_expert15_act -->
<g id="edge204" class="edge">
<title>layer1_expert15_gate&#45;&gt;layer1_expert15_act</title>
<path fill="none" stroke="black" d="M13008.5,-24073.88C13008.5,-24065.78 13008.5,-24056.98 13008.5,-24048.47"/>
<polygon fill="black" stroke="black" points="13012,-24048.3 13008.5,-24038.3 13005,-24048.3 13012,-24048.3"/>
</g>
<!-- layer1_expert15_up&#45;&gt;layer1_expert15_act -->
<g id="edge205" class="edge">
<title>layer1_expert15_up&#45;&gt;layer1_expert15_act</title>
<path fill="none" stroke="black" d="M13287.7,-24073.95C13244.44,-24063.27 13196.3,-24051.38 13152.34,-24040.53"/>
<polygon fill="black" stroke="black" points="13152.99,-24037.08 13142.44,-24038.08 13151.31,-24043.88 13152.99,-24037.08"/>
</g>
<!-- layer1_expert15_down -->
<g id="node146" class="node">
<title>layer1_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12781,-23934 12398,-23934 12398,-23866 12781,-23866 12781,-23934"/>
<text text-anchor="middle" x="12589.5" y="-23918.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12589.5" y="-23903.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12589.5" y="-23888.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12589.5" y="-23873.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_expert15_act&#45;&gt;layer1_expert15_down -->
<g id="edge206" class="edge">
<title>layer1_expert15_act&#45;&gt;layer1_expert15_down</title>
<path fill="none" stroke="black" d="M12872.75,-23969.95C12828.77,-23959.25 12779.82,-23947.33 12735.15,-23936.46"/>
<polygon fill="black" stroke="black" points="12735.93,-23933.05 12725.39,-23934.08 12734.28,-23939.85 12735.93,-23933.05"/>
</g>
<!-- layer1_expert15_down&#45;&gt;layer1_token_aggregation -->
<g id="edge207" class="edge">
<title>layer1_expert15_down&#45;&gt;layer1_token_aggregation</title>
<path fill="none" stroke="black" d="M12397.98,-23887.24C12275.02,-23880.09 12111.9,-23871.33 11967.5,-23866 10273.24,-23803.45 8251.33,-23776.15 7411.93,-23766.91"/>
<polygon fill="black" stroke="black" points="7411.84,-23763.4 7401.8,-23766.79 7411.76,-23770.4 7411.84,-23763.4"/>
</g>
<!-- layer1_res2 -->
<g id="node148" class="node">
<title>layer1_res2</title>
<polygon fill="none" stroke="black" points="7457.24,-23658 6756.12,-23658 6575.76,-23492 7276.88,-23492 7457.24,-23658"/>
<text text-anchor="middle" x="7016.5" y="-23601.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7016.5" y="-23586.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23571.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23556.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23541.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_token_aggregation&#45;&gt;layer1_res2 -->
<g id="edge208" class="edge">
<title>layer1_token_aggregation&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M7016.5,-23693.95C7016.5,-23685.63 7016.5,-23677 7016.5,-23668.38"/>
<polygon fill="black" stroke="black" points="7020,-23668.28 7016.5,-23658.28 7013,-23668.28 7020,-23668.28"/>
</g>
<!-- layer2_mha_qkv -->
<g id="node149" class="node">
<title>layer2_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7252.5,-23456 6780.5,-23456 6780.5,-23388 7252.5,-23388 7252.5,-23456"/>
<text text-anchor="middle" x="7016.5" y="-23440.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7016.5" y="-23425.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23410.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7016.5" y="-23395.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_mha_qkv -->
<g id="edge209" class="edge">
<title>layer1_res2&#45;&gt;layer2_mha_qkv</title>
<path fill="none" stroke="black" d="M7016.5,-23491.87C7016.5,-23483.12 7016.5,-23474.48 7016.5,-23466.45"/>
<polygon fill="black" stroke="black" points="7020,-23466.26 7016.5,-23456.26 7013,-23466.26 7020,-23466.26"/>
</g>
<!-- layer2_mha_attn -->
<g id="node150" class="node">
<title>layer2_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7246.5,-23352 6786.5,-23352 6786.5,-23284 7246.5,-23284 7246.5,-23352"/>
<text text-anchor="middle" x="7016.5" y="-23336.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7016.5" y="-23321.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7016.5" y="-23306.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23291.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_mha_qkv&#45;&gt;layer2_mha_attn -->
<g id="edge210" class="edge">
<title>layer2_mha_qkv&#45;&gt;layer2_mha_attn</title>
<path fill="none" stroke="black" d="M7016.5,-23387.88C7016.5,-23379.78 7016.5,-23370.98 7016.5,-23362.47"/>
<polygon fill="black" stroke="black" points="7020,-23362.3 7016.5,-23352.3 7013,-23362.3 7020,-23362.3"/>
</g>
<!-- layer2_mha_out -->
<g id="node151" class="node">
<title>layer2_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7229,-23248 6804,-23248 6804,-23180 7229,-23180 7229,-23248"/>
<text text-anchor="middle" x="7016.5" y="-23232.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7016.5" y="-23217.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23202.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23187.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_mha_attn&#45;&gt;layer2_mha_out -->
<g id="edge211" class="edge">
<title>layer2_mha_attn&#45;&gt;layer2_mha_out</title>
<path fill="none" stroke="black" d="M7016.5,-23283.88C7016.5,-23275.78 7016.5,-23266.98 7016.5,-23258.47"/>
<polygon fill="black" stroke="black" points="7020,-23258.3 7016.5,-23248.3 7013,-23258.3 7020,-23258.3"/>
</g>
<!-- layer2_res1 -->
<g id="node152" class="node">
<title>layer2_res1</title>
<polygon fill="none" stroke="black" points="7457.24,-23144 6756.12,-23144 6575.76,-22978 7276.88,-22978 7457.24,-23144"/>
<text text-anchor="middle" x="7016.5" y="-23087.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7016.5" y="-23072.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23057.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23042.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-23027.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_mha_out&#45;&gt;layer2_res1 -->
<g id="edge212" class="edge">
<title>layer2_mha_out&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M7016.5,-23179.86C7016.5,-23172.1 7016.5,-23163.46 7016.5,-23154.48"/>
<polygon fill="black" stroke="black" points="7020,-23154.23 7016.5,-23144.23 7013,-23154.23 7020,-23154.23"/>
</g>
<!-- layer2_ln1 -->
<g id="node153" class="node">
<title>layer2_ln1</title>
<polygon fill="yellow" stroke="black" points="7229,-22942 6804,-22942 6804,-22874 7229,-22874 7229,-22942"/>
<text text-anchor="middle" x="7016.5" y="-22926.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7016.5" y="-22911.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-22896.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-22881.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln1 -->
<g id="edge213" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln1</title>
<path fill="none" stroke="black" d="M7016.5,-22977.87C7016.5,-22969.12 7016.5,-22960.48 7016.5,-22952.45"/>
<polygon fill="black" stroke="black" points="7020,-22952.26 7016.5,-22942.26 7013,-22952.26 7020,-22952.26"/>
</g>
<!-- layer2_expert_routing -->
<g id="node154" class="node">
<title>layer2_expert_routing</title>
<polygon fill="orange" stroke="black" points="7016.5,-22838 6600.5,-22755 7016.5,-22672 7432.5,-22755 7016.5,-22838"/>
<text text-anchor="middle" x="7016.5" y="-22781.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7016.5" y="-22766.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7016.5" y="-22751.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-22736.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7016.5" y="-22721.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_expert_routing -->
<g id="edge214" class="edge">
<title>layer2_ln1&#45;&gt;layer2_expert_routing</title>
<path fill="none" stroke="black" d="M7016.5,-22873.86C7016.5,-22866.1 7016.5,-22857.46 7016.5,-22848.48"/>
<polygon fill="black" stroke="black" points="7020,-22848.23 7016.5,-22838.23 7013,-22848.23 7020,-22848.23"/>
</g>
<!-- layer2_token_distribution -->
<g id="node155" class="node">
<title>layer2_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7444.86,-22636 6763.44,-22636 6588.14,-22500 7269.56,-22500 7444.86,-22636"/>
<text text-anchor="middle" x="7016.5" y="-22586.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7016.5" y="-22571.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7016.5" y="-22556.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7016.5" y="-22541.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer2_expert_routing&#45;&gt;layer2_token_distribution -->
<g id="edge215" class="edge">
<title>layer2_expert_routing&#45;&gt;layer2_token_distribution</title>
<path fill="none" stroke="black" d="M7016.5,-22671.78C7016.5,-22663.34 7016.5,-22654.79 7016.5,-22646.4"/>
<polygon fill="black" stroke="black" points="7020,-22646.28 7016.5,-22636.28 7013,-22646.28 7020,-22646.28"/>
</g>
<!-- layer2_expert0_gate -->
<g id="node156" class="node">
<title>layer2_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="813,-22464 418,-22464 418,-22396 813,-22396 813,-22464"/>
<text text-anchor="middle" x="615.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="615.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="615.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="615.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert0_gate -->
<g id="edge216" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6675.42,-22567.72C5554.99,-22569.09 1993.01,-22565.23 823.31,-22464.11"/>
<polygon fill="black" stroke="black" points="823.32,-22460.6 813.06,-22463.22 822.71,-22467.57 823.32,-22460.6"/>
</g>
<!-- layer2_expert0_up -->
<g id="node157" class="node">
<title>layer2_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1226,-22464 831,-22464 831,-22396 1226,-22396 1226,-22464"/>
<text text-anchor="middle" x="1028.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1028.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1028.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1028.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert0_up -->
<g id="edge217" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6674.42,-22567.24C5603.28,-22567 2321.27,-22558.44 1236.35,-22464.12"/>
<polygon fill="black" stroke="black" points="1236.32,-22460.6 1226.06,-22463.21 1235.71,-22467.57 1236.32,-22460.6"/>
</g>
<!-- layer2_expert1_gate -->
<g id="node160" class="node">
<title>layer2_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1639,-22464 1244,-22464 1244,-22396 1639,-22396 1639,-22464"/>
<text text-anchor="middle" x="1441.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1441.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1441.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1441.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert1_gate -->
<g id="edge222" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6673.86,-22566.69C5654.38,-22564.77 2649.69,-22551.69 1649.28,-22464.11"/>
<polygon fill="black" stroke="black" points="1649.33,-22460.6 1639.06,-22463.21 1648.71,-22467.57 1649.33,-22460.6"/>
</g>
<!-- layer2_expert1_up -->
<g id="node161" class="node">
<title>layer2_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2052,-22464 1657,-22464 1657,-22396 2052,-22396 2052,-22464"/>
<text text-anchor="middle" x="1854.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1854.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1854.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1854.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert1_up -->
<g id="edge223" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6672.92,-22566.04C5706.86,-22562.35 2978.03,-22544.95 2062.08,-22464.09"/>
<polygon fill="black" stroke="black" points="2062.33,-22460.6 2052.06,-22463.2 2061.71,-22467.58 2062.33,-22460.6"/>
</g>
<!-- layer2_expert2_gate -->
<g id="node164" class="node">
<title>layer2_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2465,-22464 2070,-22464 2070,-22396 2465,-22396 2465,-22464"/>
<text text-anchor="middle" x="2267.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2267.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2267.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2267.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert2_gate -->
<g id="edge228" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6671.93,-22565.27C5761.78,-22559.72 3307.04,-22538.22 2475.07,-22464.1"/>
<polygon fill="black" stroke="black" points="2475.33,-22460.6 2465.06,-22463.19 2474.7,-22467.58 2475.33,-22460.6"/>
</g>
<!-- layer2_expert2_up -->
<g id="node165" class="node">
<title>layer2_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2878,-22464 2483,-22464 2483,-22396 2878,-22396 2878,-22464"/>
<text text-anchor="middle" x="2680.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2680.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2680.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2680.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert2_up -->
<g id="edge229" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6670.99,-22564.34C5819.65,-22556.84 3636.62,-22531.52 2888.16,-22464.1"/>
<polygon fill="black" stroke="black" points="2888.34,-22460.61 2878.06,-22463.18 2887.7,-22467.58 2888.34,-22460.61"/>
</g>
<!-- layer2_expert3_gate -->
<g id="node168" class="node">
<title>layer2_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3291,-22464 2896,-22464 2896,-22396 3291,-22396 3291,-22464"/>
<text text-anchor="middle" x="3093.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3093.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3093.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3093.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert3_gate -->
<g id="edge234" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6669.41,-22563.2C5879.73,-22553.62 3966.42,-22524.84 3301.24,-22464.11"/>
<polygon fill="black" stroke="black" points="3301.34,-22460.61 3291.06,-22463.17 3300.7,-22467.58 3301.34,-22460.61"/>
</g>
<!-- layer2_expert3_up -->
<g id="node169" class="node">
<title>layer2_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3704,-22464 3309,-22464 3309,-22396 3704,-22396 3704,-22464"/>
<text text-anchor="middle" x="3506.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3506.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3506.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3506.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert3_up -->
<g id="edge235" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6667.52,-22561.77C5943.21,-22549.98 4296.46,-22518.17 3714.25,-22464.12"/>
<polygon fill="black" stroke="black" points="3714.35,-22460.61 3704.06,-22463.16 3713.69,-22467.58 3714.35,-22460.61"/>
</g>
<!-- layer2_expert4_gate -->
<g id="node172" class="node">
<title>layer2_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4117,-22464 3722,-22464 3722,-22396 4117,-22396 4117,-22464"/>
<text text-anchor="middle" x="3919.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3919.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3919.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3919.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert4_gate -->
<g id="edge240" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6665.06,-22559.9C6010.59,-22545.8 4626.94,-22511.52 4127.26,-22464.12"/>
<polygon fill="black" stroke="black" points="4127.35,-22460.62 4117.06,-22463.14 4126.68,-22467.58 4127.35,-22460.62"/>
</g>
<!-- layer2_expert4_up -->
<g id="node173" class="node">
<title>layer2_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4530,-22464 4135,-22464 4135,-22396 4530,-22396 4530,-22464"/>
<text text-anchor="middle" x="4332.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4332.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4332.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4332.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert4_up -->
<g id="edge241" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6672.37,-22565.42C6195.11,-22560.35 5305.47,-22540.49 4540.19,-22464.13"/>
<polygon fill="black" stroke="black" points="4540.36,-22460.63 4530.07,-22463.12 4539.67,-22467.6 4540.36,-22460.63"/>
</g>
<!-- layer2_expert5_gate -->
<g id="node176" class="node">
<title>layer2_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4943,-22464 4548,-22464 4548,-22396 4943,-22396 4943,-22464"/>
<text text-anchor="middle" x="4745.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4745.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4745.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4745.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert5_gate -->
<g id="edge246" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6666.68,-22561.16C6257.56,-22551.67 5560.04,-22527.18 4953.34,-22464.16"/>
<polygon fill="black" stroke="black" points="4953.38,-22460.64 4943.07,-22463.09 4952.65,-22467.61 4953.38,-22460.64"/>
</g>
<!-- layer2_expert5_up -->
<g id="node177" class="node">
<title>layer2_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5356,-22464 4961,-22464 4961,-22396 5356,-22396 5356,-22464"/>
<text text-anchor="middle" x="5158.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5158.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5158.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5158.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert5_up -->
<g id="edge247" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6658.34,-22554.65C6325.6,-22540.84 5816.32,-22513.72 5366.03,-22464.14"/>
<polygon fill="black" stroke="black" points="5366.4,-22460.66 5356.07,-22463.04 5365.63,-22467.62 5366.4,-22460.66"/>
</g>
<!-- layer2_expert6_gate -->
<g id="node180" class="node">
<title>layer2_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5769,-22464 5374,-22464 5374,-22396 5769,-22396 5769,-22464"/>
<text text-anchor="middle" x="5571.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5571.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5571.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5571.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert6_gate -->
<g id="edge252" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.03,-22543.44C6400.4,-22526.23 6075.1,-22499.86 5779.16,-22464.18"/>
<polygon fill="black" stroke="black" points="5779.43,-22460.68 5769.08,-22462.96 5778.59,-22467.63 5779.43,-22460.68"/>
</g>
<!-- layer2_expert6_up -->
<g id="node181" class="node">
<title>layer2_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6182,-22464 5787,-22464 5787,-22396 6182,-22396 6182,-22464"/>
<text text-anchor="middle" x="5984.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5984.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5984.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5984.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert6_up -->
<g id="edge253" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6613.33,-22519.57C6481.89,-22503.37 6335.08,-22484.49 6192.37,-22464.25"/>
<polygon fill="black" stroke="black" points="6192.5,-22460.74 6182.11,-22462.79 6191.51,-22467.67 6192.5,-22460.74"/>
</g>
<!-- layer2_expert7_gate -->
<g id="node184" class="node">
<title>layer2_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6595,-22464 6200,-22464 6200,-22396 6595,-22396 6595,-22464"/>
<text text-anchor="middle" x="6397.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6397.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6397.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6397.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert7_gate -->
<g id="edge258" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6711.53,-22500C6658.4,-22488.32 6605.09,-22476.61 6557.86,-22466.23"/>
<polygon fill="black" stroke="black" points="6558.4,-22462.77 6547.88,-22464.04 6556.89,-22469.6 6558.4,-22462.77"/>
</g>
<!-- layer2_expert7_up -->
<g id="node185" class="node">
<title>layer2_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="7008,-22464 6613,-22464 6613,-22396 7008,-22396 7008,-22464"/>
<text text-anchor="middle" x="6810.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6810.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6810.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6810.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert7_up -->
<g id="edge259" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6915.01,-22500C6899.37,-22489.67 6883.68,-22479.31 6869.38,-22469.87"/>
<polygon fill="black" stroke="black" points="6870.95,-22466.72 6860.68,-22464.13 6867.1,-22472.56 6870.95,-22466.72"/>
</g>
<!-- layer2_expert8_gate -->
<g id="node188" class="node">
<title>layer2_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7421,-22464 7026,-22464 7026,-22396 7421,-22396 7421,-22464"/>
<text text-anchor="middle" x="7223.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7223.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7223.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7223.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert8_gate -->
<g id="edge264" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7118.48,-22500C7134.2,-22489.67 7149.97,-22479.31 7164.33,-22469.87"/>
<polygon fill="black" stroke="black" points="7166.64,-22472.54 7173.08,-22464.13 7162.8,-22466.69 7166.64,-22472.54"/>
</g>
<!-- layer2_expert8_up -->
<g id="node189" class="node">
<title>layer2_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7834,-22464 7439,-22464 7439,-22396 7834,-22396 7834,-22464"/>
<text text-anchor="middle" x="7636.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7636.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7636.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7636.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert8_up -->
<g id="edge265" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7281.23,-22508.93C7347.49,-22494.4 7416.56,-22479.25 7475.99,-22466.21"/>
<polygon fill="black" stroke="black" points="7476.81,-22469.61 7485.82,-22464.05 7475.31,-22462.78 7476.81,-22469.61"/>
</g>
<!-- layer2_expert9_gate -->
<g id="node192" class="node">
<title>layer2_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8247,-22464 7852,-22464 7852,-22396 8247,-22396 8247,-22464"/>
<text text-anchor="middle" x="8049.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8049.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8049.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8049.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert9_gate -->
<g id="edge270" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7312.03,-22532.73C7467.07,-22514.13 7660.37,-22489.94 7841.89,-22464.22"/>
<polygon fill="black" stroke="black" points="7842.49,-22467.67 7851.89,-22462.8 7841.5,-22460.74 7842.49,-22467.67"/>
</g>
<!-- layer2_expert9_up -->
<g id="node193" class="node">
<title>layer2_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8660,-22464 8265,-22464 8265,-22396 8660,-22396 8660,-22464"/>
<text text-anchor="middle" x="8462.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8462.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8462.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8462.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert9_up -->
<g id="edge271" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7330.91,-22547.51C7579.39,-22530.52 7935.09,-22502.72 8254.99,-22464.16"/>
<polygon fill="black" stroke="black" points="8255.41,-22467.63 8264.92,-22462.96 8254.57,-22460.68 8255.41,-22467.63"/>
</g>
<!-- layer2_expert10_gate -->
<g id="node196" class="node">
<title>layer2_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9073,-22464 8678,-22464 8678,-22396 9073,-22396 9073,-22464"/>
<text text-anchor="middle" x="8875.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8875.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8875.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8875.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert10_gate -->
<g id="edge276" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7341.93,-22556.01C7673.51,-22542.65 8202.55,-22515.38 8667.98,-22464.14"/>
<polygon fill="black" stroke="black" points="8668.37,-22467.62 8677.93,-22463.04 8667.6,-22460.66 8668.37,-22467.62"/>
</g>
<!-- layer2_expert10_up -->
<g id="node197" class="node">
<title>layer2_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9486,-22464 9091,-22464 9091,-22396 9486,-22396 9486,-22464"/>
<text text-anchor="middle" x="9288.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9288.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9288.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9288.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert10_up -->
<g id="edge277" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7349.24,-22561.57C7756.05,-22552.37 8465.4,-22528.08 9080.97,-22464.13"/>
<polygon fill="black" stroke="black" points="9081.35,-22467.61 9090.93,-22463.09 9080.62,-22460.64 9081.35,-22467.61"/>
</g>
<!-- layer2_expert11_gate -->
<g id="node200" class="node">
<title>layer2_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9899,-22464 9504,-22464 9504,-22396 9899,-22396 9899,-22464"/>
<text text-anchor="middle" x="9701.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9701.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9701.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9701.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert11_gate -->
<g id="edge282" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7354.2,-22565.5C7830.01,-22560.55 8724.7,-22540.86 9493.76,-22464.14"/>
<polygon fill="black" stroke="black" points="9494.33,-22467.6 9503.93,-22463.12 9493.64,-22460.63 9494.33,-22467.6"/>
</g>
<!-- layer2_expert11_up -->
<g id="node201" class="node">
<title>layer2_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10312,-22464 9917,-22464 9917,-22396 10312,-22396 10312,-22464"/>
<text text-anchor="middle" x="10114.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10114.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10114.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10114.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert11_up -->
<g id="edge283" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7347.5,-22560.35C7993.28,-22546.53 9401.47,-22512.03 9906.63,-22464.13"/>
<polygon fill="black" stroke="black" points="9907.32,-22467.58 9916.94,-22463.14 9906.65,-22460.62 9907.32,-22467.58"/>
</g>
<!-- layer2_expert12_gate -->
<g id="node204" class="node">
<title>layer2_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10725,-22464 10330,-22464 10330,-22396 10725,-22396 10725,-22464"/>
<text text-anchor="middle" x="10527.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10527.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10527.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10527.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert12_gate -->
<g id="edge288" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7349.83,-22562.02C8065.92,-22550.46 9733.02,-22518.58 10319.68,-22464.13"/>
<polygon fill="black" stroke="black" points="10320.31,-22467.58 10329.94,-22463.16 10319.65,-22460.61 10320.31,-22467.58"/>
</g>
<!-- layer2_expert12_up -->
<g id="node205" class="node">
<title>layer2_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11138,-22464 10743,-22464 10743,-22396 11138,-22396 11138,-22464"/>
<text text-anchor="middle" x="10940.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10940.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10940.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10940.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert12_up -->
<g id="edge289" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7351.57,-22563.35C8133.82,-22553.92 10063.91,-22525.16 10732.7,-22464.12"/>
<polygon fill="black" stroke="black" points="10733.3,-22467.58 10742.94,-22463.17 10732.66,-22460.61 10733.3,-22467.58"/>
</g>
<!-- layer2_expert13_gate -->
<g id="node208" class="node">
<title>layer2_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11551,-22464 11156,-22464 11156,-22396 11551,-22396 11551,-22464"/>
<text text-anchor="middle" x="11353.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11353.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11353.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11353.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert13_gate -->
<g id="edge294" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7352.74,-22564.43C8197.52,-22557.03 10394.4,-22531.78 11145.8,-22464.11"/>
<polygon fill="black" stroke="black" points="11146.3,-22467.58 11155.94,-22463.18 11145.66,-22460.61 11146.3,-22467.58"/>
</g>
<!-- layer2_expert13_up -->
<g id="node209" class="node">
<title>layer2_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11964,-22464 11569,-22464 11569,-22396 11964,-22396 11964,-22464"/>
<text text-anchor="middle" x="11766.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11766.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11766.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11766.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert13_up -->
<g id="edge295" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7354.14,-22565.31C8258.83,-22559.84 10724.6,-22538.43 11558.9,-22464.1"/>
<polygon fill="black" stroke="black" points="11559.3,-22467.58 11568.94,-22463.19 11558.67,-22460.6 11559.3,-22467.58"/>
</g>
<!-- layer2_expert14_gate -->
<g id="node212" class="node">
<title>layer2_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12377,-22464 11982,-22464 11982,-22396 12377,-22396 12377,-22464"/>
<text text-anchor="middle" x="12179.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12179.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12179.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12179.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert14_gate -->
<g id="edge300" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7354.95,-22566.06C8316.58,-22562.42 11054.12,-22545.11 11971.9,-22464.1"/>
<polygon fill="black" stroke="black" points="11972.29,-22467.58 11981.94,-22463.2 11971.67,-22460.6 11972.29,-22467.58"/>
</g>
<!-- layer2_expert14_up -->
<g id="node213" class="node">
<title>layer2_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12790,-22464 12395,-22464 12395,-22396 12790,-22396 12790,-22464"/>
<text text-anchor="middle" x="12592.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12592.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12592.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12592.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert14_up -->
<g id="edge301" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7355.58,-22566.7C8371.74,-22564.8 11382.92,-22551.81 12384.71,-22464.11"/>
<polygon fill="black" stroke="black" points="12385.29,-22467.57 12394.94,-22463.21 12384.67,-22460.6 12385.29,-22467.57"/>
</g>
<!-- layer2_expert15_gate -->
<g id="node216" class="node">
<title>layer2_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13203,-22464 12808,-22464 12808,-22396 13203,-22396 13203,-22464"/>
<text text-anchor="middle" x="13005.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="13005.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13005.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13005.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert15_gate -->
<g id="edge306" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7356.27,-22567.24C8425.13,-22567.02 11711.73,-22558.53 12797.64,-22464.12"/>
<polygon fill="black" stroke="black" points="12798.29,-22467.57 12807.94,-22463.21 12797.68,-22460.6 12798.29,-22467.57"/>
</g>
<!-- layer2_expert15_up -->
<g id="node217" class="node">
<title>layer2_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13616,-22464 13221,-22464 13221,-22396 13616,-22396 13616,-22464"/>
<text text-anchor="middle" x="13418.5" y="-22448.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13418.5" y="-22433.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13418.5" y="-22418.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13418.5" y="-22403.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_token_distribution&#45;&gt;layer2_expert15_up -->
<g id="edge307" class="edge">
<title>layer2_token_distribution&#45;&gt;layer2_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7357.15,-22567.72C8477.21,-22569.1 12040.63,-22565.26 13210.69,-22464.11"/>
<polygon fill="black" stroke="black" points="13211.29,-22467.57 13220.94,-22463.22 13210.68,-22460.6 13211.29,-22467.57"/>
</g>
<!-- layer2_expert0_act -->
<g id="node158" class="node">
<title>layer2_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1226,-22360 831,-22360 831,-22292 1226,-22292 1226,-22360"/>
<text text-anchor="middle" x="1028.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1028.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1028.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1028.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_expert0_gate&#45;&gt;layer2_expert0_act -->
<g id="edge218" class="edge">
<title>layer2_expert0_gate&#45;&gt;layer2_expert0_act</title>
<path fill="none" stroke="black" d="M749.3,-22395.95C792.56,-22385.27 840.7,-22373.38 884.66,-22362.53"/>
<polygon fill="black" stroke="black" points="885.69,-22365.88 894.56,-22360.08 884.01,-22359.08 885.69,-22365.88"/>
</g>
<!-- layer2_expert0_up&#45;&gt;layer2_expert0_act -->
<g id="edge219" class="edge">
<title>layer2_expert0_up&#45;&gt;layer2_expert0_act</title>
<path fill="none" stroke="black" d="M1028.5,-22395.88C1028.5,-22387.78 1028.5,-22378.98 1028.5,-22370.47"/>
<polygon fill="black" stroke="black" points="1032,-22370.3 1028.5,-22360.3 1025,-22370.3 1032,-22370.3"/>
</g>
<!-- layer2_expert0_down -->
<g id="node159" class="node">
<title>layer2_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1432,-22256 1049,-22256 1049,-22188 1432,-22188 1432,-22256"/>
<text text-anchor="middle" x="1240.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1240.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1240.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1240.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_expert0_act&#45;&gt;layer2_expert0_down -->
<g id="edge220" class="edge">
<title>layer2_expert0_act&#45;&gt;layer2_expert0_down</title>
<path fill="none" stroke="black" d="M1097.33,-22291.88C1118.17,-22281.86 1141.21,-22270.77 1162.6,-22260.48"/>
<polygon fill="black" stroke="black" points="1164.16,-22263.61 1171.65,-22256.12 1161.12,-22257.31 1164.16,-22263.61"/>
</g>
<!-- layer2_token_aggregation -->
<g id="node220" class="node">
<title>layer2_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7489.24,-22152 6732.44,-22152 6537.76,-22016 7294.56,-22016 7489.24,-22152"/>
<text text-anchor="middle" x="7013.5" y="-22102.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7013.5" y="-22087.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7013.5" y="-22072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-22057.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_expert0_down&#45;&gt;layer2_token_aggregation -->
<g id="edge221" class="edge">
<title>layer2_expert0_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M1432.25,-22209.25C1555.88,-22202.07 1720.13,-22193.29 1865.5,-22188 3646.65,-22123.18 5776.04,-22096.85 6630.82,-22088.37"/>
<polygon fill="black" stroke="black" points="6631.16,-22091.87 6641.13,-22088.27 6631.09,-22084.87 6631.16,-22091.87"/>
</g>
<!-- layer2_expert1_act -->
<g id="node162" class="node">
<title>layer2_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2052,-22360 1657,-22360 1657,-22292 2052,-22292 2052,-22360"/>
<text text-anchor="middle" x="1854.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1854.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1854.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1854.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_expert1_gate&#45;&gt;layer2_expert1_act -->
<g id="edge224" class="edge">
<title>layer2_expert1_gate&#45;&gt;layer2_expert1_act</title>
<path fill="none" stroke="black" d="M1575.3,-22395.95C1618.56,-22385.27 1666.7,-22373.38 1710.66,-22362.53"/>
<polygon fill="black" stroke="black" points="1711.69,-22365.88 1720.56,-22360.08 1710.01,-22359.08 1711.69,-22365.88"/>
</g>
<!-- layer2_expert1_up&#45;&gt;layer2_expert1_act -->
<g id="edge225" class="edge">
<title>layer2_expert1_up&#45;&gt;layer2_expert1_act</title>
<path fill="none" stroke="black" d="M1854.5,-22395.88C1854.5,-22387.78 1854.5,-22378.98 1854.5,-22370.47"/>
<polygon fill="black" stroke="black" points="1858,-22370.3 1854.5,-22360.3 1851,-22370.3 1858,-22370.3"/>
</g>
<!-- layer2_expert1_down -->
<g id="node163" class="node">
<title>layer2_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2258,-22256 1875,-22256 1875,-22188 2258,-22188 2258,-22256"/>
<text text-anchor="middle" x="2066.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2066.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2066.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2066.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_expert1_act&#45;&gt;layer2_expert1_down -->
<g id="edge226" class="edge">
<title>layer2_expert1_act&#45;&gt;layer2_expert1_down</title>
<path fill="none" stroke="black" d="M1923.33,-22291.88C1944.17,-22281.86 1967.21,-22270.77 1988.6,-22260.48"/>
<polygon fill="black" stroke="black" points="1990.16,-22263.61 1997.65,-22256.12 1987.12,-22257.31 1990.16,-22263.61"/>
</g>
<!-- layer2_expert1_down&#45;&gt;layer2_token_aggregation -->
<g id="edge227" class="edge">
<title>layer2_expert1_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M2258.26,-22209.44C2381.89,-22202.34 2546.14,-22193.57 2691.5,-22188 4147.65,-22132.22 5881,-22101.8 6633.56,-22090.36"/>
<polygon fill="black" stroke="black" points="6633.79,-22093.86 6643.74,-22090.21 6633.69,-22086.86 6633.79,-22093.86"/>
</g>
<!-- layer2_expert2_act -->
<g id="node166" class="node">
<title>layer2_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2878,-22360 2483,-22360 2483,-22292 2878,-22292 2878,-22360"/>
<text text-anchor="middle" x="2680.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2680.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2680.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2680.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_expert2_gate&#45;&gt;layer2_expert2_act -->
<g id="edge230" class="edge">
<title>layer2_expert2_gate&#45;&gt;layer2_expert2_act</title>
<path fill="none" stroke="black" d="M2401.3,-22395.95C2444.56,-22385.27 2492.7,-22373.38 2536.66,-22362.53"/>
<polygon fill="black" stroke="black" points="2537.69,-22365.88 2546.56,-22360.08 2536.01,-22359.08 2537.69,-22365.88"/>
</g>
<!-- layer2_expert2_up&#45;&gt;layer2_expert2_act -->
<g id="edge231" class="edge">
<title>layer2_expert2_up&#45;&gt;layer2_expert2_act</title>
<path fill="none" stroke="black" d="M2680.5,-22395.88C2680.5,-22387.78 2680.5,-22378.98 2680.5,-22370.47"/>
<polygon fill="black" stroke="black" points="2684,-22370.3 2680.5,-22360.3 2677,-22370.3 2684,-22370.3"/>
</g>
<!-- layer2_expert2_down -->
<g id="node167" class="node">
<title>layer2_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3084,-22256 2701,-22256 2701,-22188 3084,-22188 3084,-22256"/>
<text text-anchor="middle" x="2892.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2892.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2892.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2892.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_expert2_act&#45;&gt;layer2_expert2_down -->
<g id="edge232" class="edge">
<title>layer2_expert2_act&#45;&gt;layer2_expert2_down</title>
<path fill="none" stroke="black" d="M2749.33,-22291.88C2770.17,-22281.86 2793.21,-22270.77 2814.6,-22260.48"/>
<polygon fill="black" stroke="black" points="2816.16,-22263.61 2823.65,-22256.12 2813.12,-22257.31 2816.16,-22263.61"/>
</g>
<!-- layer2_expert2_down&#45;&gt;layer2_token_aggregation -->
<g id="edge233" class="edge">
<title>layer2_expert2_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M3084.34,-22211.16C3226.09,-22204.09 3423.79,-22194.68 3597.5,-22188 4703.01,-22145.46 6010.33,-22110.25 6638.99,-22094.25"/>
<polygon fill="black" stroke="black" points="6639.21,-22097.75 6649.12,-22094 6639.03,-22090.75 6639.21,-22097.75"/>
</g>
<!-- layer2_expert3_act -->
<g id="node170" class="node">
<title>layer2_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3704,-22360 3309,-22360 3309,-22292 3704,-22292 3704,-22360"/>
<text text-anchor="middle" x="3506.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3506.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3506.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3506.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_expert3_gate&#45;&gt;layer2_expert3_act -->
<g id="edge236" class="edge">
<title>layer2_expert3_gate&#45;&gt;layer2_expert3_act</title>
<path fill="none" stroke="black" d="M3227.3,-22395.95C3270.56,-22385.27 3318.7,-22373.38 3362.66,-22362.53"/>
<polygon fill="black" stroke="black" points="3363.69,-22365.88 3372.56,-22360.08 3362.01,-22359.08 3363.69,-22365.88"/>
</g>
<!-- layer2_expert3_up&#45;&gt;layer2_expert3_act -->
<g id="edge237" class="edge">
<title>layer2_expert3_up&#45;&gt;layer2_expert3_act</title>
<path fill="none" stroke="black" d="M3506.5,-22395.88C3506.5,-22387.78 3506.5,-22378.98 3506.5,-22370.47"/>
<polygon fill="black" stroke="black" points="3510,-22370.3 3506.5,-22360.3 3503,-22370.3 3510,-22370.3"/>
</g>
<!-- layer2_expert3_down -->
<g id="node171" class="node">
<title>layer2_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3990,-22256 3607,-22256 3607,-22188 3990,-22188 3990,-22256"/>
<text text-anchor="middle" x="3798.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3798.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3798.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3798.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_expert3_act&#45;&gt;layer2_expert3_down -->
<g id="edge238" class="edge">
<title>layer2_expert3_act&#45;&gt;layer2_expert3_down</title>
<path fill="none" stroke="black" d="M3601.3,-22291.88C3630.91,-22281.54 3663.72,-22270.08 3693.96,-22259.52"/>
<polygon fill="black" stroke="black" points="3695.39,-22262.73 3703.67,-22256.12 3693.08,-22256.12 3695.39,-22262.73"/>
</g>
<!-- layer2_expert3_down&#45;&gt;layer2_token_aggregation -->
<g id="edge239" class="edge">
<title>layer2_expert3_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M3990.09,-22206.97C4082.12,-22200.56 4193.99,-22193.25 4294.5,-22188 5132.63,-22144.25 6117.01,-22111.62 6640.97,-22095.74"/>
<polygon fill="black" stroke="black" points="6641.45,-22099.23 6651.34,-22095.43 6641.23,-22092.23 6641.45,-22099.23"/>
</g>
<!-- layer2_expert4_act -->
<g id="node174" class="node">
<title>layer2_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4530,-22360 4135,-22360 4135,-22292 4530,-22292 4530,-22360"/>
<text text-anchor="middle" x="4332.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4332.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4332.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4332.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_expert4_gate&#45;&gt;layer2_expert4_act -->
<g id="edge242" class="edge">
<title>layer2_expert4_gate&#45;&gt;layer2_expert4_act</title>
<path fill="none" stroke="black" d="M4053.3,-22395.95C4096.56,-22385.27 4144.7,-22373.38 4188.66,-22362.53"/>
<polygon fill="black" stroke="black" points="4189.69,-22365.88 4198.56,-22360.08 4188.01,-22359.08 4189.69,-22365.88"/>
</g>
<!-- layer2_expert4_up&#45;&gt;layer2_expert4_act -->
<g id="edge243" class="edge">
<title>layer2_expert4_up&#45;&gt;layer2_expert4_act</title>
<path fill="none" stroke="black" d="M4332.5,-22395.88C4332.5,-22387.78 4332.5,-22378.98 4332.5,-22370.47"/>
<polygon fill="black" stroke="black" points="4336,-22370.3 4332.5,-22360.3 4329,-22370.3 4336,-22370.3"/>
</g>
<!-- layer2_expert4_down -->
<g id="node175" class="node">
<title>layer2_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4687,-22256 4304,-22256 4304,-22188 4687,-22188 4687,-22256"/>
<text text-anchor="middle" x="4495.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4495.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4495.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4495.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_expert4_act&#45;&gt;layer2_expert4_down -->
<g id="edge244" class="edge">
<title>layer2_expert4_act&#45;&gt;layer2_expert4_down</title>
<path fill="none" stroke="black" d="M4385.42,-22291.88C4400.87,-22282.21 4417.89,-22271.56 4433.84,-22261.59"/>
<polygon fill="black" stroke="black" points="4435.94,-22264.4 4442.57,-22256.12 4432.23,-22258.46 4435.94,-22264.4"/>
</g>
<!-- layer2_expert4_down&#45;&gt;layer2_token_aggregation -->
<g id="edge245" class="edge">
<title>layer2_expert4_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M4687.08,-22210.65C5106.5,-22188 6111.65,-22133.71 6653.24,-22104.46"/>
<polygon fill="black" stroke="black" points="6653.77,-22107.93 6663.56,-22103.9 6653.39,-22100.94 6653.77,-22107.93"/>
</g>
<!-- layer2_expert5_act -->
<g id="node178" class="node">
<title>layer2_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5356,-22360 4961,-22360 4961,-22292 5356,-22292 5356,-22360"/>
<text text-anchor="middle" x="5158.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5158.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5158.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5158.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_expert5_gate&#45;&gt;layer2_expert5_act -->
<g id="edge248" class="edge">
<title>layer2_expert5_gate&#45;&gt;layer2_expert5_act</title>
<path fill="none" stroke="black" d="M4879.3,-22395.95C4922.56,-22385.27 4970.7,-22373.38 5014.66,-22362.53"/>
<polygon fill="black" stroke="black" points="5015.69,-22365.88 5024.56,-22360.08 5014.01,-22359.08 5015.69,-22365.88"/>
</g>
<!-- layer2_expert5_up&#45;&gt;layer2_expert5_act -->
<g id="edge249" class="edge">
<title>layer2_expert5_up&#45;&gt;layer2_expert5_act</title>
<path fill="none" stroke="black" d="M5158.5,-22395.88C5158.5,-22387.78 5158.5,-22378.98 5158.5,-22370.47"/>
<polygon fill="black" stroke="black" points="5162,-22370.3 5158.5,-22360.3 5155,-22370.3 5162,-22370.3"/>
</g>
<!-- layer2_expert5_down -->
<g id="node179" class="node">
<title>layer2_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5725,-22256 5342,-22256 5342,-22188 5725,-22188 5725,-22256"/>
<text text-anchor="middle" x="5533.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5533.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5533.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5533.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_expert5_act&#45;&gt;layer2_expert5_down -->
<g id="edge250" class="edge">
<title>layer2_expert5_act&#45;&gt;layer2_expert5_down</title>
<path fill="none" stroke="black" d="M5279.99,-22291.95C5319.02,-22281.34 5362.43,-22269.53 5402.14,-22258.73"/>
<polygon fill="black" stroke="black" points="5403.15,-22262.08 5411.88,-22256.08 5401.31,-22255.33 5403.15,-22262.08"/>
</g>
<!-- layer2_expert5_down&#45;&gt;layer2_token_aggregation -->
<g id="edge251" class="edge">
<title>layer2_expert5_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M5725.09,-22203.39C5963.85,-22181.45 6376.2,-22143.56 6670.09,-22116.56"/>
<polygon fill="black" stroke="black" points="6670.42,-22120.04 6680.06,-22115.64 6669.78,-22113.07 6670.42,-22120.04"/>
</g>
<!-- layer2_expert6_act -->
<g id="node182" class="node">
<title>layer2_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6182,-22360 5787,-22360 5787,-22292 6182,-22292 6182,-22360"/>
<text text-anchor="middle" x="5984.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5984.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5984.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5984.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_expert6_gate&#45;&gt;layer2_expert6_act -->
<g id="edge254" class="edge">
<title>layer2_expert6_gate&#45;&gt;layer2_expert6_act</title>
<path fill="none" stroke="black" d="M5705.3,-22395.95C5748.56,-22385.27 5796.7,-22373.38 5840.66,-22362.53"/>
<polygon fill="black" stroke="black" points="5841.69,-22365.88 5850.56,-22360.08 5840.01,-22359.08 5841.69,-22365.88"/>
</g>
<!-- layer2_expert6_up&#45;&gt;layer2_expert6_act -->
<g id="edge255" class="edge">
<title>layer2_expert6_up&#45;&gt;layer2_expert6_act</title>
<path fill="none" stroke="black" d="M5984.5,-22395.88C5984.5,-22387.78 5984.5,-22378.98 5984.5,-22370.47"/>
<polygon fill="black" stroke="black" points="5988,-22370.3 5984.5,-22360.3 5981,-22370.3 5988,-22370.3"/>
</g>
<!-- layer2_expert6_down -->
<g id="node183" class="node">
<title>layer2_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6445,-22256 6062,-22256 6062,-22188 6445,-22188 6445,-22256"/>
<text text-anchor="middle" x="6253.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6253.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6253.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6253.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_expert6_act&#45;&gt;layer2_expert6_down -->
<g id="edge256" class="edge">
<title>layer2_expert6_act&#45;&gt;layer2_expert6_down</title>
<path fill="none" stroke="black" d="M6071.84,-22291.88C6098.87,-22281.63 6128.82,-22270.28 6156.47,-22259.79"/>
<polygon fill="black" stroke="black" points="6158.03,-22262.94 6166.14,-22256.12 6155.55,-22256.4 6158.03,-22262.94"/>
</g>
<!-- layer2_expert6_down&#45;&gt;layer2_token_aggregation -->
<g id="edge257" class="edge">
<title>layer2_expert6_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M6437.96,-22187.99C6517.68,-22173.73 6613.18,-22156.64 6703.26,-22140.52"/>
<polygon fill="black" stroke="black" points="6704.14,-22143.91 6713.37,-22138.71 6702.91,-22137.02 6704.14,-22143.91"/>
</g>
<!-- layer2_expert7_act -->
<g id="node186" class="node">
<title>layer2_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="7008,-22360 6613,-22360 6613,-22292 7008,-22292 7008,-22360"/>
<text text-anchor="middle" x="6810.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6810.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6810.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6810.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_expert7_gate&#45;&gt;layer2_expert7_act -->
<g id="edge260" class="edge">
<title>layer2_expert7_gate&#45;&gt;layer2_expert7_act</title>
<path fill="none" stroke="black" d="M6531.3,-22395.95C6574.56,-22385.27 6622.7,-22373.38 6666.66,-22362.53"/>
<polygon fill="black" stroke="black" points="6667.69,-22365.88 6676.56,-22360.08 6666.01,-22359.08 6667.69,-22365.88"/>
</g>
<!-- layer2_expert7_up&#45;&gt;layer2_expert7_act -->
<g id="edge261" class="edge">
<title>layer2_expert7_up&#45;&gt;layer2_expert7_act</title>
<path fill="none" stroke="black" d="M6810.5,-22395.88C6810.5,-22387.78 6810.5,-22378.98 6810.5,-22370.47"/>
<polygon fill="black" stroke="black" points="6814,-22370.3 6810.5,-22360.3 6807,-22370.3 6814,-22370.3"/>
</g>
<!-- layer2_expert7_down -->
<g id="node187" class="node">
<title>layer2_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="7005,-22256 6622,-22256 6622,-22188 7005,-22188 7005,-22256"/>
<text text-anchor="middle" x="6813.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6813.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6813.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6813.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_expert7_act&#45;&gt;layer2_expert7_down -->
<g id="edge262" class="edge">
<title>layer2_expert7_act&#45;&gt;layer2_expert7_down</title>
<path fill="none" stroke="black" d="M6811.47,-22291.88C6811.71,-22283.78 6811.97,-22274.98 6812.22,-22266.47"/>
<polygon fill="black" stroke="black" points="6815.73,-22266.4 6812.52,-22256.3 6808.73,-22266.19 6815.73,-22266.4"/>
</g>
<!-- layer2_expert7_down&#45;&gt;layer2_token_aggregation -->
<g id="edge263" class="edge">
<title>layer2_expert7_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M6862.17,-22187.9C6875.63,-22178.75 6890.8,-22168.44 6906.2,-22157.97"/>
<polygon fill="black" stroke="black" points="6908.47,-22160.66 6914.77,-22152.14 6904.53,-22154.87 6908.47,-22160.66"/>
</g>
<!-- layer2_expert8_act -->
<g id="node190" class="node">
<title>layer2_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7421,-22360 7026,-22360 7026,-22292 7421,-22292 7421,-22360"/>
<text text-anchor="middle" x="7223.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7223.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7223.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7223.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_expert8_gate&#45;&gt;layer2_expert8_act -->
<g id="edge266" class="edge">
<title>layer2_expert8_gate&#45;&gt;layer2_expert8_act</title>
<path fill="none" stroke="black" d="M7223.5,-22395.88C7223.5,-22387.78 7223.5,-22378.98 7223.5,-22370.47"/>
<polygon fill="black" stroke="black" points="7227,-22370.3 7223.5,-22360.3 7220,-22370.3 7227,-22370.3"/>
</g>
<!-- layer2_expert8_up&#45;&gt;layer2_expert8_act -->
<g id="edge267" class="edge">
<title>layer2_expert8_up&#45;&gt;layer2_expert8_act</title>
<path fill="none" stroke="black" d="M7502.7,-22395.95C7459.44,-22385.27 7411.3,-22373.38 7367.34,-22362.53"/>
<polygon fill="black" stroke="black" points="7367.99,-22359.08 7357.44,-22360.08 7366.31,-22365.88 7367.99,-22359.08"/>
</g>
<!-- layer2_expert8_down -->
<g id="node191" class="node">
<title>layer2_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7412,-22256 7029,-22256 7029,-22188 7412,-22188 7412,-22256"/>
<text text-anchor="middle" x="7220.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7220.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7220.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7220.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_expert8_act&#45;&gt;layer2_expert8_down -->
<g id="edge268" class="edge">
<title>layer2_expert8_act&#45;&gt;layer2_expert8_down</title>
<path fill="none" stroke="black" d="M7222.53,-22291.88C7222.29,-22283.78 7222.03,-22274.98 7221.78,-22266.47"/>
<polygon fill="black" stroke="black" points="7225.27,-22266.19 7221.48,-22256.3 7218.27,-22266.4 7225.27,-22266.19"/>
</g>
<!-- layer2_expert8_down&#45;&gt;layer2_token_aggregation -->
<g id="edge269" class="edge">
<title>layer2_expert8_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M7170.13,-22187.9C7156.06,-22178.66 7140.2,-22168.25 7124.12,-22157.67"/>
<polygon fill="black" stroke="black" points="7125.97,-22154.7 7115.69,-22152.14 7122.12,-22160.55 7125.97,-22154.7"/>
</g>
<!-- layer2_expert9_act -->
<g id="node194" class="node">
<title>layer2_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8247,-22360 7852,-22360 7852,-22292 8247,-22292 8247,-22360"/>
<text text-anchor="middle" x="8049.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8049.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8049.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8049.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_expert9_gate&#45;&gt;layer2_expert9_act -->
<g id="edge272" class="edge">
<title>layer2_expert9_gate&#45;&gt;layer2_expert9_act</title>
<path fill="none" stroke="black" d="M8049.5,-22395.88C8049.5,-22387.78 8049.5,-22378.98 8049.5,-22370.47"/>
<polygon fill="black" stroke="black" points="8053,-22370.3 8049.5,-22360.3 8046,-22370.3 8053,-22370.3"/>
</g>
<!-- layer2_expert9_up&#45;&gt;layer2_expert9_act -->
<g id="edge273" class="edge">
<title>layer2_expert9_up&#45;&gt;layer2_expert9_act</title>
<path fill="none" stroke="black" d="M8328.7,-22395.95C8285.44,-22385.27 8237.3,-22373.38 8193.34,-22362.53"/>
<polygon fill="black" stroke="black" points="8193.99,-22359.08 8183.44,-22360.08 8192.31,-22365.88 8193.99,-22359.08"/>
</g>
<!-- layer2_expert9_down -->
<g id="node195" class="node">
<title>layer2_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8028,-22256 7645,-22256 7645,-22188 8028,-22188 8028,-22256"/>
<text text-anchor="middle" x="7836.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7836.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7836.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7836.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_expert9_act&#45;&gt;layer2_expert9_down -->
<g id="edge274" class="edge">
<title>layer2_expert9_act&#45;&gt;layer2_expert9_down</title>
<path fill="none" stroke="black" d="M7980.35,-22291.88C7959.41,-22281.86 7936.26,-22270.77 7914.77,-22260.48"/>
<polygon fill="black" stroke="black" points="7916.2,-22257.29 7905.67,-22256.12 7913.18,-22263.6 7916.2,-22257.29"/>
</g>
<!-- layer2_expert9_down&#45;&gt;layer2_token_aggregation -->
<g id="edge275" class="edge">
<title>layer2_expert9_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M7644.84,-22189.33C7579.96,-22178.61 7504.75,-22166.18 7429.34,-22153.72"/>
<polygon fill="black" stroke="black" points="7429.62,-22150.22 7419.19,-22152.04 7428.48,-22157.12 7429.62,-22150.22"/>
</g>
<!-- layer2_expert10_act -->
<g id="node198" class="node">
<title>layer2_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9073,-22360 8678,-22360 8678,-22292 9073,-22292 9073,-22360"/>
<text text-anchor="middle" x="8875.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8875.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8875.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8875.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_expert10_gate&#45;&gt;layer2_expert10_act -->
<g id="edge278" class="edge">
<title>layer2_expert10_gate&#45;&gt;layer2_expert10_act</title>
<path fill="none" stroke="black" d="M8875.5,-22395.88C8875.5,-22387.78 8875.5,-22378.98 8875.5,-22370.47"/>
<polygon fill="black" stroke="black" points="8879,-22370.3 8875.5,-22360.3 8872,-22370.3 8879,-22370.3"/>
</g>
<!-- layer2_expert10_up&#45;&gt;layer2_expert10_act -->
<g id="edge279" class="edge">
<title>layer2_expert10_up&#45;&gt;layer2_expert10_act</title>
<path fill="none" stroke="black" d="M9154.7,-22395.95C9111.44,-22385.27 9063.3,-22373.38 9019.34,-22362.53"/>
<polygon fill="black" stroke="black" points="9019.99,-22359.08 9009.44,-22360.08 9018.31,-22365.88 9019.99,-22359.08"/>
</g>
<!-- layer2_expert10_down -->
<g id="node199" class="node">
<title>layer2_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8749,-22256 8366,-22256 8366,-22188 8749,-22188 8749,-22256"/>
<text text-anchor="middle" x="8557.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8557.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8557.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8557.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_expert10_act&#45;&gt;layer2_expert10_down -->
<g id="edge280" class="edge">
<title>layer2_expert10_act&#45;&gt;layer2_expert10_down</title>
<path fill="none" stroke="black" d="M8772.25,-22291.88C8739.65,-22281.43 8703.47,-22269.82 8670.25,-22259.16"/>
<polygon fill="black" stroke="black" points="8671.09,-22255.76 8660.5,-22256.04 8668.95,-22262.42 8671.09,-22255.76"/>
</g>
<!-- layer2_expert10_down&#45;&gt;layer2_token_aggregation -->
<g id="edge281" class="edge">
<title>layer2_expert10_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M8365.85,-22204.12C8140.46,-22184.27 7758.98,-22150.66 7458.54,-22124.2"/>
<polygon fill="black" stroke="black" points="7458.61,-22120.69 7448.34,-22123.3 7457.99,-22127.67 7458.61,-22120.69"/>
</g>
<!-- layer2_expert11_act -->
<g id="node202" class="node">
<title>layer2_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9899,-22360 9504,-22360 9504,-22292 9899,-22292 9899,-22360"/>
<text text-anchor="middle" x="9701.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9701.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9701.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9701.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_expert11_gate&#45;&gt;layer2_expert11_act -->
<g id="edge284" class="edge">
<title>layer2_expert11_gate&#45;&gt;layer2_expert11_act</title>
<path fill="none" stroke="black" d="M9701.5,-22395.88C9701.5,-22387.78 9701.5,-22378.98 9701.5,-22370.47"/>
<polygon fill="black" stroke="black" points="9705,-22370.3 9701.5,-22360.3 9698,-22370.3 9705,-22370.3"/>
</g>
<!-- layer2_expert11_up&#45;&gt;layer2_expert11_act -->
<g id="edge285" class="edge">
<title>layer2_expert11_up&#45;&gt;layer2_expert11_act</title>
<path fill="none" stroke="black" d="M9980.7,-22395.95C9937.44,-22385.27 9889.3,-22373.38 9845.34,-22362.53"/>
<polygon fill="black" stroke="black" points="9845.99,-22359.08 9835.44,-22360.08 9844.31,-22365.88 9845.99,-22359.08"/>
</g>
<!-- layer2_expert11_down -->
<g id="node203" class="node">
<title>layer2_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9523,-22256 9140,-22256 9140,-22188 9523,-22188 9523,-22256"/>
<text text-anchor="middle" x="9331.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9331.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9331.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9331.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_expert11_act&#45;&gt;layer2_expert11_down -->
<g id="edge286" class="edge">
<title>layer2_expert11_act&#45;&gt;layer2_expert11_down</title>
<path fill="none" stroke="black" d="M9581.63,-22291.95C9543.2,-22281.36 9500.47,-22269.58 9461.36,-22258.8"/>
<polygon fill="black" stroke="black" points="9462.07,-22255.36 9451.5,-22256.08 9460.21,-22262.11 9462.07,-22255.36"/>
</g>
<!-- layer2_expert11_down&#45;&gt;layer2_token_aggregation -->
<g id="edge287" class="edge">
<title>layer2_expert11_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M9139.84,-22209.75C8768.82,-22187.99 7944.55,-22139.63 7438.2,-22109.92"/>
<polygon fill="black" stroke="black" points="7438.35,-22106.42 7428.17,-22109.33 7437.94,-22113.41 7438.35,-22106.42"/>
</g>
<!-- layer2_expert12_act -->
<g id="node206" class="node">
<title>layer2_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10725,-22360 10330,-22360 10330,-22292 10725,-22292 10725,-22360"/>
<text text-anchor="middle" x="10527.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10527.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10527.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10527.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_expert12_gate&#45;&gt;layer2_expert12_act -->
<g id="edge290" class="edge">
<title>layer2_expert12_gate&#45;&gt;layer2_expert12_act</title>
<path fill="none" stroke="black" d="M10527.5,-22395.88C10527.5,-22387.78 10527.5,-22378.98 10527.5,-22370.47"/>
<polygon fill="black" stroke="black" points="10531,-22370.3 10527.5,-22360.3 10524,-22370.3 10531,-22370.3"/>
</g>
<!-- layer2_expert12_up&#45;&gt;layer2_expert12_act -->
<g id="edge291" class="edge">
<title>layer2_expert12_up&#45;&gt;layer2_expert12_act</title>
<path fill="none" stroke="black" d="M10806.7,-22395.95C10763.44,-22385.27 10715.3,-22373.38 10671.34,-22362.53"/>
<polygon fill="black" stroke="black" points="10671.99,-22359.08 10661.44,-22360.08 10670.31,-22365.88 10671.99,-22359.08"/>
</g>
<!-- layer2_expert12_down -->
<g id="node207" class="node">
<title>layer2_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10323,-22256 9940,-22256 9940,-22188 10323,-22188 10323,-22256"/>
<text text-anchor="middle" x="10131.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10131.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10131.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10131.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_expert12_act&#45;&gt;layer2_expert12_down -->
<g id="edge292" class="edge">
<title>layer2_expert12_act&#45;&gt;layer2_expert12_down</title>
<path fill="none" stroke="black" d="M10399.2,-22291.95C10357.81,-22281.29 10311.76,-22269.43 10269.69,-22258.59"/>
<polygon fill="black" stroke="black" points="10270.49,-22255.19 10259.93,-22256.08 10268.74,-22261.96 10270.49,-22255.19"/>
</g>
<!-- layer2_expert12_down&#45;&gt;layer2_token_aggregation -->
<g id="edge293" class="edge">
<title>layer2_expert12_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M9939.67,-22209.74C9822.15,-22203.01 9668.65,-22194.53 9532.5,-22188 8789.75,-22152.36 7923.41,-22118.66 7424.65,-22100.02"/>
<polygon fill="black" stroke="black" points="7424.53,-22096.52 7414.41,-22099.64 7424.27,-22103.51 7424.53,-22096.52"/>
</g>
<!-- layer2_expert13_act -->
<g id="node210" class="node">
<title>layer2_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11551,-22360 11156,-22360 11156,-22292 11551,-22292 11551,-22360"/>
<text text-anchor="middle" x="11353.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11353.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11353.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11353.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_expert13_gate&#45;&gt;layer2_expert13_act -->
<g id="edge296" class="edge">
<title>layer2_expert13_gate&#45;&gt;layer2_expert13_act</title>
<path fill="none" stroke="black" d="M11353.5,-22395.88C11353.5,-22387.78 11353.5,-22378.98 11353.5,-22370.47"/>
<polygon fill="black" stroke="black" points="11357,-22370.3 11353.5,-22360.3 11350,-22370.3 11357,-22370.3"/>
</g>
<!-- layer2_expert13_up&#45;&gt;layer2_expert13_act -->
<g id="edge297" class="edge">
<title>layer2_expert13_up&#45;&gt;layer2_expert13_act</title>
<path fill="none" stroke="black" d="M11632.7,-22395.95C11589.44,-22385.27 11541.3,-22373.38 11497.34,-22362.53"/>
<polygon fill="black" stroke="black" points="11497.99,-22359.08 11487.44,-22360.08 11496.31,-22365.88 11497.99,-22359.08"/>
</g>
<!-- layer2_expert13_down -->
<g id="node211" class="node">
<title>layer2_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11136,-22256 10753,-22256 10753,-22188 11136,-22188 11136,-22256"/>
<text text-anchor="middle" x="10944.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10944.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10944.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10944.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_expert13_act&#45;&gt;layer2_expert13_down -->
<g id="edge298" class="edge">
<title>layer2_expert13_act&#45;&gt;layer2_expert13_down</title>
<path fill="none" stroke="black" d="M11220.99,-22291.95C11178.15,-22281.27 11130.48,-22269.38 11086.95,-22258.53"/>
<polygon fill="black" stroke="black" points="11087.7,-22255.1 11077.15,-22256.08 11086,-22261.9 11087.7,-22255.1"/>
</g>
<!-- layer2_expert13_down&#45;&gt;layer2_token_aggregation -->
<g id="edge299" class="edge">
<title>layer2_expert13_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M10752.98,-22209.55C10632.35,-22202.61 10473.36,-22193.98 10332.5,-22188 9281.09,-22143.34 8041.53,-22110 7416.76,-22094.54"/>
<polygon fill="black" stroke="black" points="7416.78,-22091.04 7406.69,-22094.3 7416.6,-22098.04 7416.78,-22091.04"/>
</g>
<!-- layer2_expert14_act -->
<g id="node214" class="node">
<title>layer2_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12377,-22360 11982,-22360 11982,-22292 12377,-22292 12377,-22360"/>
<text text-anchor="middle" x="12179.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12179.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12179.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12179.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_expert14_gate&#45;&gt;layer2_expert14_act -->
<g id="edge302" class="edge">
<title>layer2_expert14_gate&#45;&gt;layer2_expert14_act</title>
<path fill="none" stroke="black" d="M12179.5,-22395.88C12179.5,-22387.78 12179.5,-22378.98 12179.5,-22370.47"/>
<polygon fill="black" stroke="black" points="12183,-22370.3 12179.5,-22360.3 12176,-22370.3 12183,-22370.3"/>
</g>
<!-- layer2_expert14_up&#45;&gt;layer2_expert14_act -->
<g id="edge303" class="edge">
<title>layer2_expert14_up&#45;&gt;layer2_expert14_act</title>
<path fill="none" stroke="black" d="M12458.7,-22395.95C12415.44,-22385.27 12367.3,-22373.38 12323.34,-22362.53"/>
<polygon fill="black" stroke="black" points="12323.99,-22359.08 12313.44,-22360.08 12322.31,-22365.88 12323.99,-22359.08"/>
</g>
<!-- layer2_expert14_down -->
<g id="node215" class="node">
<title>layer2_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11955,-22256 11572,-22256 11572,-22188 11955,-22188 11955,-22256"/>
<text text-anchor="middle" x="11763.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11763.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11763.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11763.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_expert14_act&#45;&gt;layer2_expert14_down -->
<g id="edge304" class="edge">
<title>layer2_expert14_act&#45;&gt;layer2_expert14_down</title>
<path fill="none" stroke="black" d="M12044.72,-22291.95C12001.15,-22281.27 11952.66,-22269.38 11908.39,-22258.53"/>
<polygon fill="black" stroke="black" points="11908.96,-22255.06 11898.42,-22256.08 11907.3,-22261.86 11908.96,-22255.06"/>
</g>
<!-- layer2_expert14_down&#45;&gt;layer2_token_aggregation -->
<g id="edge305" class="edge">
<title>layer2_expert14_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M11571.83,-22209.36C11449.82,-22202.3 11288.43,-22193.6 11145.5,-22188 9775.85,-22134.37 8149.66,-22103.43 7412.32,-22091.17"/>
<polygon fill="black" stroke="black" points="7412.12,-22087.67 7402.07,-22091 7412.01,-22094.67 7412.12,-22087.67"/>
</g>
<!-- layer2_expert15_act -->
<g id="node218" class="node">
<title>layer2_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13203,-22360 12808,-22360 12808,-22292 13203,-22292 13203,-22360"/>
<text text-anchor="middle" x="13005.5" y="-22344.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="13005.5" y="-22329.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13005.5" y="-22314.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13005.5" y="-22299.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_expert15_gate&#45;&gt;layer2_expert15_act -->
<g id="edge308" class="edge">
<title>layer2_expert15_gate&#45;&gt;layer2_expert15_act</title>
<path fill="none" stroke="black" d="M13005.5,-22395.88C13005.5,-22387.78 13005.5,-22378.98 13005.5,-22370.47"/>
<polygon fill="black" stroke="black" points="13009,-22370.3 13005.5,-22360.3 13002,-22370.3 13009,-22370.3"/>
</g>
<!-- layer2_expert15_up&#45;&gt;layer2_expert15_act -->
<g id="edge309" class="edge">
<title>layer2_expert15_up&#45;&gt;layer2_expert15_act</title>
<path fill="none" stroke="black" d="M13284.7,-22395.95C13241.44,-22385.27 13193.3,-22373.38 13149.34,-22362.53"/>
<polygon fill="black" stroke="black" points="13149.99,-22359.08 13139.44,-22360.08 13148.31,-22365.88 13149.99,-22359.08"/>
</g>
<!-- layer2_expert15_down -->
<g id="node219" class="node">
<title>layer2_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12778,-22256 12395,-22256 12395,-22188 12778,-22188 12778,-22256"/>
<text text-anchor="middle" x="12586.5" y="-22240.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12586.5" y="-22225.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12586.5" y="-22210.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12586.5" y="-22195.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_expert15_act&#45;&gt;layer2_expert15_down -->
<g id="edge310" class="edge">
<title>layer2_expert15_act&#45;&gt;layer2_expert15_down</title>
<path fill="none" stroke="black" d="M12869.75,-22291.95C12825.77,-22281.25 12776.82,-22269.33 12732.15,-22258.46"/>
<polygon fill="black" stroke="black" points="12732.93,-22255.05 12722.39,-22256.08 12731.28,-22261.85 12732.93,-22255.05"/>
</g>
<!-- layer2_expert15_down&#45;&gt;layer2_token_aggregation -->
<g id="edge311" class="edge">
<title>layer2_expert15_down&#45;&gt;layer2_token_aggregation</title>
<path fill="none" stroke="black" d="M12394.98,-22209.24C12272.02,-22202.09 12108.9,-22193.33 11964.5,-22188 10270.24,-22125.45 8248.33,-22098.15 7408.93,-22088.91"/>
<polygon fill="black" stroke="black" points="7408.84,-22085.4 7398.8,-22088.79 7408.76,-22092.4 7408.84,-22085.4"/>
</g>
<!-- layer2_res2 -->
<g id="node221" class="node">
<title>layer2_res2</title>
<polygon fill="none" stroke="black" points="7454.24,-21980 6753.12,-21980 6572.76,-21814 7273.88,-21814 7454.24,-21980"/>
<text text-anchor="middle" x="7013.5" y="-21923.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7013.5" y="-21908.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21893.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21878.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21863.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_token_aggregation&#45;&gt;layer2_res2 -->
<g id="edge312" class="edge">
<title>layer2_token_aggregation&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M7013.5,-22015.95C7013.5,-22007.63 7013.5,-21999 7013.5,-21990.38"/>
<polygon fill="black" stroke="black" points="7017,-21990.28 7013.5,-21980.28 7010,-21990.28 7017,-21990.28"/>
</g>
<!-- layer3_mha_qkv -->
<g id="node222" class="node">
<title>layer3_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7249.5,-21778 6777.5,-21778 6777.5,-21710 7249.5,-21710 7249.5,-21778"/>
<text text-anchor="middle" x="7013.5" y="-21762.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7013.5" y="-21747.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21732.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7013.5" y="-21717.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_mha_qkv -->
<g id="edge313" class="edge">
<title>layer2_res2&#45;&gt;layer3_mha_qkv</title>
<path fill="none" stroke="black" d="M7013.5,-21813.87C7013.5,-21805.12 7013.5,-21796.48 7013.5,-21788.45"/>
<polygon fill="black" stroke="black" points="7017,-21788.26 7013.5,-21778.26 7010,-21788.26 7017,-21788.26"/>
</g>
<!-- layer3_mha_attn -->
<g id="node223" class="node">
<title>layer3_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7243.5,-21674 6783.5,-21674 6783.5,-21606 7243.5,-21606 7243.5,-21674"/>
<text text-anchor="middle" x="7013.5" y="-21658.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7013.5" y="-21643.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7013.5" y="-21628.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21613.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_mha_qkv&#45;&gt;layer3_mha_attn -->
<g id="edge314" class="edge">
<title>layer3_mha_qkv&#45;&gt;layer3_mha_attn</title>
<path fill="none" stroke="black" d="M7013.5,-21709.88C7013.5,-21701.78 7013.5,-21692.98 7013.5,-21684.47"/>
<polygon fill="black" stroke="black" points="7017,-21684.3 7013.5,-21674.3 7010,-21684.3 7017,-21684.3"/>
</g>
<!-- layer3_mha_out -->
<g id="node224" class="node">
<title>layer3_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7226,-21570 6801,-21570 6801,-21502 7226,-21502 7226,-21570"/>
<text text-anchor="middle" x="7013.5" y="-21554.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7013.5" y="-21539.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21524.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21509.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_mha_attn&#45;&gt;layer3_mha_out -->
<g id="edge315" class="edge">
<title>layer3_mha_attn&#45;&gt;layer3_mha_out</title>
<path fill="none" stroke="black" d="M7013.5,-21605.88C7013.5,-21597.78 7013.5,-21588.98 7013.5,-21580.47"/>
<polygon fill="black" stroke="black" points="7017,-21580.3 7013.5,-21570.3 7010,-21580.3 7017,-21580.3"/>
</g>
<!-- layer3_res1 -->
<g id="node225" class="node">
<title>layer3_res1</title>
<polygon fill="none" stroke="black" points="7454.24,-21466 6753.12,-21466 6572.76,-21300 7273.88,-21300 7454.24,-21466"/>
<text text-anchor="middle" x="7013.5" y="-21409.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7013.5" y="-21394.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21379.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21364.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21349.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_mha_out&#45;&gt;layer3_res1 -->
<g id="edge316" class="edge">
<title>layer3_mha_out&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M7013.5,-21501.86C7013.5,-21494.1 7013.5,-21485.46 7013.5,-21476.48"/>
<polygon fill="black" stroke="black" points="7017,-21476.23 7013.5,-21466.23 7010,-21476.23 7017,-21476.23"/>
</g>
<!-- layer3_ln1 -->
<g id="node226" class="node">
<title>layer3_ln1</title>
<polygon fill="yellow" stroke="black" points="7226,-21264 6801,-21264 6801,-21196 7226,-21196 7226,-21264"/>
<text text-anchor="middle" x="7013.5" y="-21248.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7013.5" y="-21233.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21218.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21203.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln1 -->
<g id="edge317" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln1</title>
<path fill="none" stroke="black" d="M7013.5,-21299.87C7013.5,-21291.12 7013.5,-21282.48 7013.5,-21274.45"/>
<polygon fill="black" stroke="black" points="7017,-21274.26 7013.5,-21264.26 7010,-21274.26 7017,-21274.26"/>
</g>
<!-- layer3_expert_routing -->
<g id="node227" class="node">
<title>layer3_expert_routing</title>
<polygon fill="orange" stroke="black" points="7013.5,-21160 6597.5,-21077 7013.5,-20994 7429.5,-21077 7013.5,-21160"/>
<text text-anchor="middle" x="7013.5" y="-21103.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7013.5" y="-21088.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7013.5" y="-21073.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-21058.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7013.5" y="-21043.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_expert_routing -->
<g id="edge318" class="edge">
<title>layer3_ln1&#45;&gt;layer3_expert_routing</title>
<path fill="none" stroke="black" d="M7013.5,-21195.86C7013.5,-21188.1 7013.5,-21179.46 7013.5,-21170.48"/>
<polygon fill="black" stroke="black" points="7017,-21170.23 7013.5,-21160.23 7010,-21170.23 7017,-21170.23"/>
</g>
<!-- layer3_token_distribution -->
<g id="node228" class="node">
<title>layer3_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7441.86,-20958 6760.44,-20958 6585.14,-20822 7266.56,-20822 7441.86,-20958"/>
<text text-anchor="middle" x="7013.5" y="-20908.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7013.5" y="-20893.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7013.5" y="-20878.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7013.5" y="-20863.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer3_expert_routing&#45;&gt;layer3_token_distribution -->
<g id="edge319" class="edge">
<title>layer3_expert_routing&#45;&gt;layer3_token_distribution</title>
<path fill="none" stroke="black" d="M7013.5,-20993.78C7013.5,-20985.34 7013.5,-20976.79 7013.5,-20968.4"/>
<polygon fill="black" stroke="black" points="7017,-20968.28 7013.5,-20958.28 7010,-20968.28 7017,-20968.28"/>
</g>
<!-- layer3_expert0_gate -->
<g id="node229" class="node">
<title>layer3_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="810,-20786 415,-20786 415,-20718 810,-20718 810,-20786"/>
<text text-anchor="middle" x="612.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="612.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="612.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="612.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert0_gate -->
<g id="edge320" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6672.42,-20889.72C5551.99,-20891.09 1990.01,-20887.23 820.31,-20786.11"/>
<polygon fill="black" stroke="black" points="820.32,-20782.6 810.06,-20785.22 819.71,-20789.57 820.32,-20782.6"/>
</g>
<!-- layer3_expert0_up -->
<g id="node230" class="node">
<title>layer3_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1223,-20786 828,-20786 828,-20718 1223,-20718 1223,-20786"/>
<text text-anchor="middle" x="1025.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1025.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1025.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1025.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert0_up -->
<g id="edge321" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6671.42,-20889.24C5600.28,-20889 2318.27,-20880.44 1233.35,-20786.12"/>
<polygon fill="black" stroke="black" points="1233.32,-20782.6 1223.06,-20785.21 1232.71,-20789.57 1233.32,-20782.6"/>
</g>
<!-- layer3_expert1_gate -->
<g id="node233" class="node">
<title>layer3_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1636,-20786 1241,-20786 1241,-20718 1636,-20718 1636,-20786"/>
<text text-anchor="middle" x="1438.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1438.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1438.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1438.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert1_gate -->
<g id="edge326" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6670.86,-20888.69C5651.38,-20886.77 2646.69,-20873.69 1646.28,-20786.11"/>
<polygon fill="black" stroke="black" points="1646.33,-20782.6 1636.06,-20785.21 1645.71,-20789.57 1646.33,-20782.6"/>
</g>
<!-- layer3_expert1_up -->
<g id="node234" class="node">
<title>layer3_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2049,-20786 1654,-20786 1654,-20718 2049,-20718 2049,-20786"/>
<text text-anchor="middle" x="1851.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1851.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1851.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1851.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert1_up -->
<g id="edge327" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6669.92,-20888.04C5703.86,-20884.35 2975.03,-20866.95 2059.08,-20786.09"/>
<polygon fill="black" stroke="black" points="2059.33,-20782.6 2049.06,-20785.2 2058.71,-20789.58 2059.33,-20782.6"/>
</g>
<!-- layer3_expert2_gate -->
<g id="node237" class="node">
<title>layer3_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2462,-20786 2067,-20786 2067,-20718 2462,-20718 2462,-20786"/>
<text text-anchor="middle" x="2264.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2264.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2264.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2264.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert2_gate -->
<g id="edge332" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6668.93,-20887.27C5758.78,-20881.72 3304.04,-20860.22 2472.07,-20786.1"/>
<polygon fill="black" stroke="black" points="2472.33,-20782.6 2462.06,-20785.19 2471.7,-20789.58 2472.33,-20782.6"/>
</g>
<!-- layer3_expert2_up -->
<g id="node238" class="node">
<title>layer3_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2875,-20786 2480,-20786 2480,-20718 2875,-20718 2875,-20786"/>
<text text-anchor="middle" x="2677.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2677.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2677.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2677.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert2_up -->
<g id="edge333" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6667.99,-20886.34C5816.65,-20878.84 3633.62,-20853.52 2885.16,-20786.1"/>
<polygon fill="black" stroke="black" points="2885.34,-20782.61 2875.06,-20785.18 2884.7,-20789.58 2885.34,-20782.61"/>
</g>
<!-- layer3_expert3_gate -->
<g id="node241" class="node">
<title>layer3_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3288,-20786 2893,-20786 2893,-20718 3288,-20718 3288,-20786"/>
<text text-anchor="middle" x="3090.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3090.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3090.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3090.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert3_gate -->
<g id="edge338" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6666.41,-20885.2C5876.73,-20875.62 3963.42,-20846.84 3298.24,-20786.11"/>
<polygon fill="black" stroke="black" points="3298.34,-20782.61 3288.06,-20785.17 3297.7,-20789.58 3298.34,-20782.61"/>
</g>
<!-- layer3_expert3_up -->
<g id="node242" class="node">
<title>layer3_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3701,-20786 3306,-20786 3306,-20718 3701,-20718 3701,-20786"/>
<text text-anchor="middle" x="3503.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3503.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3503.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3503.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert3_up -->
<g id="edge339" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6664.52,-20883.77C5940.21,-20871.98 4293.46,-20840.17 3711.25,-20786.12"/>
<polygon fill="black" stroke="black" points="3711.35,-20782.61 3701.06,-20785.16 3710.69,-20789.58 3711.35,-20782.61"/>
</g>
<!-- layer3_expert4_gate -->
<g id="node245" class="node">
<title>layer3_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4114,-20786 3719,-20786 3719,-20718 4114,-20718 4114,-20786"/>
<text text-anchor="middle" x="3916.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3916.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3916.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3916.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert4_gate -->
<g id="edge344" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6662.06,-20881.9C6007.59,-20867.8 4623.94,-20833.52 4124.26,-20786.12"/>
<polygon fill="black" stroke="black" points="4124.35,-20782.62 4114.06,-20785.14 4123.68,-20789.58 4124.35,-20782.62"/>
</g>
<!-- layer3_expert4_up -->
<g id="node246" class="node">
<title>layer3_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4527,-20786 4132,-20786 4132,-20718 4527,-20718 4527,-20786"/>
<text text-anchor="middle" x="4329.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4329.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4329.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4329.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert4_up -->
<g id="edge345" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6669.37,-20887.42C6192.11,-20882.35 5302.47,-20862.49 4537.19,-20786.13"/>
<polygon fill="black" stroke="black" points="4537.36,-20782.63 4527.07,-20785.12 4536.67,-20789.6 4537.36,-20782.63"/>
</g>
<!-- layer3_expert5_gate -->
<g id="node249" class="node">
<title>layer3_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4940,-20786 4545,-20786 4545,-20718 4940,-20718 4940,-20786"/>
<text text-anchor="middle" x="4742.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4742.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4742.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4742.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert5_gate -->
<g id="edge350" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6663.68,-20883.16C6254.56,-20873.67 5557.04,-20849.18 4950.34,-20786.16"/>
<polygon fill="black" stroke="black" points="4950.38,-20782.64 4940.07,-20785.09 4949.65,-20789.61 4950.38,-20782.64"/>
</g>
<!-- layer3_expert5_up -->
<g id="node250" class="node">
<title>layer3_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5353,-20786 4958,-20786 4958,-20718 5353,-20718 5353,-20786"/>
<text text-anchor="middle" x="5155.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5155.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5155.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5155.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert5_up -->
<g id="edge351" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6655.34,-20876.65C6322.6,-20862.84 5813.32,-20835.72 5363.03,-20786.14"/>
<polygon fill="black" stroke="black" points="5363.4,-20782.66 5353.07,-20785.04 5362.63,-20789.62 5363.4,-20782.66"/>
</g>
<!-- layer3_expert6_gate -->
<g id="node253" class="node">
<title>layer3_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5766,-20786 5371,-20786 5371,-20718 5766,-20718 5766,-20786"/>
<text text-anchor="middle" x="5568.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5568.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5568.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5568.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert6_gate -->
<g id="edge356" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6641.03,-20865.44C6397.4,-20848.23 6072.1,-20821.86 5776.16,-20786.18"/>
<polygon fill="black" stroke="black" points="5776.43,-20782.68 5766.08,-20784.96 5775.59,-20789.63 5776.43,-20782.68"/>
</g>
<!-- layer3_expert6_up -->
<g id="node254" class="node">
<title>layer3_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6179,-20786 5784,-20786 5784,-20718 6179,-20718 6179,-20786"/>
<text text-anchor="middle" x="5981.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5981.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5981.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5981.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert6_up -->
<g id="edge357" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6610.33,-20841.57C6478.89,-20825.37 6332.08,-20806.49 6189.37,-20786.25"/>
<polygon fill="black" stroke="black" points="6189.5,-20782.74 6179.11,-20784.79 6188.51,-20789.67 6189.5,-20782.74"/>
</g>
<!-- layer3_expert7_gate -->
<g id="node257" class="node">
<title>layer3_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6592,-20786 6197,-20786 6197,-20718 6592,-20718 6592,-20786"/>
<text text-anchor="middle" x="6394.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6394.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6394.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6394.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert7_gate -->
<g id="edge362" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6708.53,-20822C6655.4,-20810.32 6602.09,-20798.61 6554.86,-20788.23"/>
<polygon fill="black" stroke="black" points="6555.4,-20784.77 6544.88,-20786.04 6553.89,-20791.6 6555.4,-20784.77"/>
</g>
<!-- layer3_expert7_up -->
<g id="node258" class="node">
<title>layer3_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="7005,-20786 6610,-20786 6610,-20718 7005,-20718 7005,-20786"/>
<text text-anchor="middle" x="6807.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6807.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6807.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6807.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert7_up -->
<g id="edge363" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6912.01,-20822C6896.37,-20811.67 6880.68,-20801.31 6866.38,-20791.87"/>
<polygon fill="black" stroke="black" points="6867.95,-20788.72 6857.68,-20786.13 6864.1,-20794.56 6867.95,-20788.72"/>
</g>
<!-- layer3_expert8_gate -->
<g id="node261" class="node">
<title>layer3_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7418,-20786 7023,-20786 7023,-20718 7418,-20718 7418,-20786"/>
<text text-anchor="middle" x="7220.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7220.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7220.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7220.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert8_gate -->
<g id="edge368" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7115.48,-20822C7131.2,-20811.67 7146.97,-20801.31 7161.33,-20791.87"/>
<polygon fill="black" stroke="black" points="7163.64,-20794.54 7170.08,-20786.13 7159.8,-20788.69 7163.64,-20794.54"/>
</g>
<!-- layer3_expert8_up -->
<g id="node262" class="node">
<title>layer3_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7831,-20786 7436,-20786 7436,-20718 7831,-20718 7831,-20786"/>
<text text-anchor="middle" x="7633.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7633.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7633.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7633.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert8_up -->
<g id="edge369" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7278.23,-20830.93C7344.49,-20816.4 7413.56,-20801.25 7472.99,-20788.21"/>
<polygon fill="black" stroke="black" points="7473.81,-20791.61 7482.82,-20786.05 7472.31,-20784.78 7473.81,-20791.61"/>
</g>
<!-- layer3_expert9_gate -->
<g id="node265" class="node">
<title>layer3_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8244,-20786 7849,-20786 7849,-20718 8244,-20718 8244,-20786"/>
<text text-anchor="middle" x="8046.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8046.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8046.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8046.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert9_gate -->
<g id="edge374" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7309.03,-20854.73C7464.07,-20836.13 7657.37,-20811.94 7838.89,-20786.22"/>
<polygon fill="black" stroke="black" points="7839.49,-20789.67 7848.89,-20784.8 7838.5,-20782.74 7839.49,-20789.67"/>
</g>
<!-- layer3_expert9_up -->
<g id="node266" class="node">
<title>layer3_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8657,-20786 8262,-20786 8262,-20718 8657,-20718 8657,-20786"/>
<text text-anchor="middle" x="8459.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8459.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8459.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8459.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert9_up -->
<g id="edge375" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7327.91,-20869.51C7576.39,-20852.52 7932.09,-20824.72 8251.99,-20786.16"/>
<polygon fill="black" stroke="black" points="8252.41,-20789.63 8261.92,-20784.96 8251.57,-20782.68 8252.41,-20789.63"/>
</g>
<!-- layer3_expert10_gate -->
<g id="node269" class="node">
<title>layer3_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9070,-20786 8675,-20786 8675,-20718 9070,-20718 9070,-20786"/>
<text text-anchor="middle" x="8872.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8872.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8872.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8872.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert10_gate -->
<g id="edge380" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.93,-20878.01C7670.51,-20864.65 8199.55,-20837.38 8664.98,-20786.14"/>
<polygon fill="black" stroke="black" points="8665.37,-20789.62 8674.93,-20785.04 8664.6,-20782.66 8665.37,-20789.62"/>
</g>
<!-- layer3_expert10_up -->
<g id="node270" class="node">
<title>layer3_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9483,-20786 9088,-20786 9088,-20718 9483,-20718 9483,-20786"/>
<text text-anchor="middle" x="9285.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9285.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9285.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9285.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert10_up -->
<g id="edge381" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7346.24,-20883.57C7753.05,-20874.37 8462.4,-20850.08 9077.97,-20786.13"/>
<polygon fill="black" stroke="black" points="9078.35,-20789.61 9087.93,-20785.09 9077.62,-20782.64 9078.35,-20789.61"/>
</g>
<!-- layer3_expert11_gate -->
<g id="node273" class="node">
<title>layer3_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9896,-20786 9501,-20786 9501,-20718 9896,-20718 9896,-20786"/>
<text text-anchor="middle" x="9698.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9698.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9698.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9698.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert11_gate -->
<g id="edge386" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7351.2,-20887.5C7827.01,-20882.55 8721.7,-20862.86 9490.76,-20786.14"/>
<polygon fill="black" stroke="black" points="9491.33,-20789.6 9500.93,-20785.12 9490.64,-20782.63 9491.33,-20789.6"/>
</g>
<!-- layer3_expert11_up -->
<g id="node274" class="node">
<title>layer3_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10309,-20786 9914,-20786 9914,-20718 10309,-20718 10309,-20786"/>
<text text-anchor="middle" x="10111.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10111.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10111.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10111.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert11_up -->
<g id="edge387" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7344.5,-20882.35C7990.28,-20868.53 9398.47,-20834.03 9903.63,-20786.13"/>
<polygon fill="black" stroke="black" points="9904.32,-20789.58 9913.94,-20785.14 9903.65,-20782.62 9904.32,-20789.58"/>
</g>
<!-- layer3_expert12_gate -->
<g id="node277" class="node">
<title>layer3_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10722,-20786 10327,-20786 10327,-20718 10722,-20718 10722,-20786"/>
<text text-anchor="middle" x="10524.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10524.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10524.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10524.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert12_gate -->
<g id="edge392" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7346.83,-20884.02C8062.92,-20872.46 9730.02,-20840.58 10316.68,-20786.13"/>
<polygon fill="black" stroke="black" points="10317.31,-20789.58 10326.94,-20785.16 10316.65,-20782.61 10317.31,-20789.58"/>
</g>
<!-- layer3_expert12_up -->
<g id="node278" class="node">
<title>layer3_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11135,-20786 10740,-20786 10740,-20718 11135,-20718 11135,-20786"/>
<text text-anchor="middle" x="10937.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10937.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10937.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10937.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert12_up -->
<g id="edge393" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7348.57,-20885.35C8130.82,-20875.92 10060.91,-20847.16 10729.7,-20786.12"/>
<polygon fill="black" stroke="black" points="10730.3,-20789.58 10739.94,-20785.17 10729.66,-20782.61 10730.3,-20789.58"/>
</g>
<!-- layer3_expert13_gate -->
<g id="node281" class="node">
<title>layer3_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11548,-20786 11153,-20786 11153,-20718 11548,-20718 11548,-20786"/>
<text text-anchor="middle" x="11350.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11350.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11350.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11350.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert13_gate -->
<g id="edge398" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7349.74,-20886.43C8194.52,-20879.03 10391.4,-20853.78 11142.8,-20786.11"/>
<polygon fill="black" stroke="black" points="11143.3,-20789.58 11152.94,-20785.18 11142.66,-20782.61 11143.3,-20789.58"/>
</g>
<!-- layer3_expert13_up -->
<g id="node282" class="node">
<title>layer3_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11961,-20786 11566,-20786 11566,-20718 11961,-20718 11961,-20786"/>
<text text-anchor="middle" x="11763.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11763.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11763.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11763.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert13_up -->
<g id="edge399" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7351.14,-20887.31C8255.83,-20881.84 10721.6,-20860.43 11555.9,-20786.1"/>
<polygon fill="black" stroke="black" points="11556.3,-20789.58 11565.94,-20785.19 11555.67,-20782.6 11556.3,-20789.58"/>
</g>
<!-- layer3_expert14_gate -->
<g id="node285" class="node">
<title>layer3_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12374,-20786 11979,-20786 11979,-20718 12374,-20718 12374,-20786"/>
<text text-anchor="middle" x="12176.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12176.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12176.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12176.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert14_gate -->
<g id="edge404" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7351.95,-20888.06C8313.58,-20884.42 11051.12,-20867.11 11968.9,-20786.1"/>
<polygon fill="black" stroke="black" points="11969.29,-20789.58 11978.94,-20785.2 11968.67,-20782.6 11969.29,-20789.58"/>
</g>
<!-- layer3_expert14_up -->
<g id="node286" class="node">
<title>layer3_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12787,-20786 12392,-20786 12392,-20718 12787,-20718 12787,-20786"/>
<text text-anchor="middle" x="12589.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12589.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12589.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12589.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert14_up -->
<g id="edge405" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7352.58,-20888.7C8368.74,-20886.8 11379.92,-20873.81 12381.71,-20786.11"/>
<polygon fill="black" stroke="black" points="12382.29,-20789.57 12391.94,-20785.21 12381.67,-20782.6 12382.29,-20789.57"/>
</g>
<!-- layer3_expert15_gate -->
<g id="node289" class="node">
<title>layer3_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13200,-20786 12805,-20786 12805,-20718 13200,-20718 13200,-20786"/>
<text text-anchor="middle" x="13002.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="13002.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13002.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13002.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert15_gate -->
<g id="edge410" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7353.27,-20889.24C8422.13,-20889.02 11708.73,-20880.53 12794.64,-20786.12"/>
<polygon fill="black" stroke="black" points="12795.29,-20789.57 12804.94,-20785.21 12794.68,-20782.6 12795.29,-20789.57"/>
</g>
<!-- layer3_expert15_up -->
<g id="node290" class="node">
<title>layer3_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13613,-20786 13218,-20786 13218,-20718 13613,-20718 13613,-20786"/>
<text text-anchor="middle" x="13415.5" y="-20770.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13415.5" y="-20755.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13415.5" y="-20740.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13415.5" y="-20725.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_token_distribution&#45;&gt;layer3_expert15_up -->
<g id="edge411" class="edge">
<title>layer3_token_distribution&#45;&gt;layer3_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7354.15,-20889.72C8474.21,-20891.1 12037.63,-20887.26 13207.69,-20786.11"/>
<polygon fill="black" stroke="black" points="13208.29,-20789.57 13217.94,-20785.22 13207.68,-20782.6 13208.29,-20789.57"/>
</g>
<!-- layer3_expert0_act -->
<g id="node231" class="node">
<title>layer3_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1223,-20682 828,-20682 828,-20614 1223,-20614 1223,-20682"/>
<text text-anchor="middle" x="1025.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1025.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1025.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1025.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_expert0_gate&#45;&gt;layer3_expert0_act -->
<g id="edge322" class="edge">
<title>layer3_expert0_gate&#45;&gt;layer3_expert0_act</title>
<path fill="none" stroke="black" d="M746.3,-20717.95C789.56,-20707.27 837.7,-20695.38 881.66,-20684.53"/>
<polygon fill="black" stroke="black" points="882.69,-20687.88 891.56,-20682.08 881.01,-20681.08 882.69,-20687.88"/>
</g>
<!-- layer3_expert0_up&#45;&gt;layer3_expert0_act -->
<g id="edge323" class="edge">
<title>layer3_expert0_up&#45;&gt;layer3_expert0_act</title>
<path fill="none" stroke="black" d="M1025.5,-20717.88C1025.5,-20709.78 1025.5,-20700.98 1025.5,-20692.47"/>
<polygon fill="black" stroke="black" points="1029,-20692.3 1025.5,-20682.3 1022,-20692.3 1029,-20692.3"/>
</g>
<!-- layer3_expert0_down -->
<g id="node232" class="node">
<title>layer3_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1429,-20578 1046,-20578 1046,-20510 1429,-20510 1429,-20578"/>
<text text-anchor="middle" x="1237.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1237.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1237.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1237.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_expert0_act&#45;&gt;layer3_expert0_down -->
<g id="edge324" class="edge">
<title>layer3_expert0_act&#45;&gt;layer3_expert0_down</title>
<path fill="none" stroke="black" d="M1094.33,-20613.88C1115.17,-20603.86 1138.21,-20592.77 1159.6,-20582.48"/>
<polygon fill="black" stroke="black" points="1161.16,-20585.61 1168.65,-20578.12 1158.12,-20579.31 1161.16,-20585.61"/>
</g>
<!-- layer3_token_aggregation -->
<g id="node293" class="node">
<title>layer3_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7486.24,-20474 6729.44,-20474 6534.76,-20338 7291.56,-20338 7486.24,-20474"/>
<text text-anchor="middle" x="7010.5" y="-20424.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7010.5" y="-20409.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7010.5" y="-20394.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-20379.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_expert0_down&#45;&gt;layer3_token_aggregation -->
<g id="edge325" class="edge">
<title>layer3_expert0_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M1429.25,-20531.25C1552.88,-20524.07 1717.13,-20515.29 1862.5,-20510 3643.65,-20445.18 5773.04,-20418.85 6627.82,-20410.37"/>
<polygon fill="black" stroke="black" points="6628.16,-20413.87 6638.13,-20410.27 6628.09,-20406.87 6628.16,-20413.87"/>
</g>
<!-- layer3_expert1_act -->
<g id="node235" class="node">
<title>layer3_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2049,-20682 1654,-20682 1654,-20614 2049,-20614 2049,-20682"/>
<text text-anchor="middle" x="1851.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1851.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1851.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1851.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_expert1_gate&#45;&gt;layer3_expert1_act -->
<g id="edge328" class="edge">
<title>layer3_expert1_gate&#45;&gt;layer3_expert1_act</title>
<path fill="none" stroke="black" d="M1572.3,-20717.95C1615.56,-20707.27 1663.7,-20695.38 1707.66,-20684.53"/>
<polygon fill="black" stroke="black" points="1708.69,-20687.88 1717.56,-20682.08 1707.01,-20681.08 1708.69,-20687.88"/>
</g>
<!-- layer3_expert1_up&#45;&gt;layer3_expert1_act -->
<g id="edge329" class="edge">
<title>layer3_expert1_up&#45;&gt;layer3_expert1_act</title>
<path fill="none" stroke="black" d="M1851.5,-20717.88C1851.5,-20709.78 1851.5,-20700.98 1851.5,-20692.47"/>
<polygon fill="black" stroke="black" points="1855,-20692.3 1851.5,-20682.3 1848,-20692.3 1855,-20692.3"/>
</g>
<!-- layer3_expert1_down -->
<g id="node236" class="node">
<title>layer3_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2255,-20578 1872,-20578 1872,-20510 2255,-20510 2255,-20578"/>
<text text-anchor="middle" x="2063.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2063.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2063.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2063.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_expert1_act&#45;&gt;layer3_expert1_down -->
<g id="edge330" class="edge">
<title>layer3_expert1_act&#45;&gt;layer3_expert1_down</title>
<path fill="none" stroke="black" d="M1920.33,-20613.88C1941.17,-20603.86 1964.21,-20592.77 1985.6,-20582.48"/>
<polygon fill="black" stroke="black" points="1987.16,-20585.61 1994.65,-20578.12 1984.12,-20579.31 1987.16,-20585.61"/>
</g>
<!-- layer3_expert1_down&#45;&gt;layer3_token_aggregation -->
<g id="edge331" class="edge">
<title>layer3_expert1_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M2255.26,-20531.44C2378.89,-20524.34 2543.14,-20515.57 2688.5,-20510 4144.65,-20454.22 5878,-20423.8 6630.56,-20412.36"/>
<polygon fill="black" stroke="black" points="6630.79,-20415.86 6640.74,-20412.21 6630.69,-20408.86 6630.79,-20415.86"/>
</g>
<!-- layer3_expert2_act -->
<g id="node239" class="node">
<title>layer3_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2875,-20682 2480,-20682 2480,-20614 2875,-20614 2875,-20682"/>
<text text-anchor="middle" x="2677.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2677.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2677.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2677.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_expert2_gate&#45;&gt;layer3_expert2_act -->
<g id="edge334" class="edge">
<title>layer3_expert2_gate&#45;&gt;layer3_expert2_act</title>
<path fill="none" stroke="black" d="M2398.3,-20717.95C2441.56,-20707.27 2489.7,-20695.38 2533.66,-20684.53"/>
<polygon fill="black" stroke="black" points="2534.69,-20687.88 2543.56,-20682.08 2533.01,-20681.08 2534.69,-20687.88"/>
</g>
<!-- layer3_expert2_up&#45;&gt;layer3_expert2_act -->
<g id="edge335" class="edge">
<title>layer3_expert2_up&#45;&gt;layer3_expert2_act</title>
<path fill="none" stroke="black" d="M2677.5,-20717.88C2677.5,-20709.78 2677.5,-20700.98 2677.5,-20692.47"/>
<polygon fill="black" stroke="black" points="2681,-20692.3 2677.5,-20682.3 2674,-20692.3 2681,-20692.3"/>
</g>
<!-- layer3_expert2_down -->
<g id="node240" class="node">
<title>layer3_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3081,-20578 2698,-20578 2698,-20510 3081,-20510 3081,-20578"/>
<text text-anchor="middle" x="2889.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2889.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2889.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2889.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_expert2_act&#45;&gt;layer3_expert2_down -->
<g id="edge336" class="edge">
<title>layer3_expert2_act&#45;&gt;layer3_expert2_down</title>
<path fill="none" stroke="black" d="M2746.33,-20613.88C2767.17,-20603.86 2790.21,-20592.77 2811.6,-20582.48"/>
<polygon fill="black" stroke="black" points="2813.16,-20585.61 2820.65,-20578.12 2810.12,-20579.31 2813.16,-20585.61"/>
</g>
<!-- layer3_expert2_down&#45;&gt;layer3_token_aggregation -->
<g id="edge337" class="edge">
<title>layer3_expert2_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M3081.34,-20533.16C3223.09,-20526.09 3420.79,-20516.68 3594.5,-20510 4700.01,-20467.46 6007.33,-20432.25 6635.99,-20416.25"/>
<polygon fill="black" stroke="black" points="6636.21,-20419.75 6646.12,-20416 6636.03,-20412.75 6636.21,-20419.75"/>
</g>
<!-- layer3_expert3_act -->
<g id="node243" class="node">
<title>layer3_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3701,-20682 3306,-20682 3306,-20614 3701,-20614 3701,-20682"/>
<text text-anchor="middle" x="3503.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3503.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3503.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3503.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_expert3_gate&#45;&gt;layer3_expert3_act -->
<g id="edge340" class="edge">
<title>layer3_expert3_gate&#45;&gt;layer3_expert3_act</title>
<path fill="none" stroke="black" d="M3224.3,-20717.95C3267.56,-20707.27 3315.7,-20695.38 3359.66,-20684.53"/>
<polygon fill="black" stroke="black" points="3360.69,-20687.88 3369.56,-20682.08 3359.01,-20681.08 3360.69,-20687.88"/>
</g>
<!-- layer3_expert3_up&#45;&gt;layer3_expert3_act -->
<g id="edge341" class="edge">
<title>layer3_expert3_up&#45;&gt;layer3_expert3_act</title>
<path fill="none" stroke="black" d="M3503.5,-20717.88C3503.5,-20709.78 3503.5,-20700.98 3503.5,-20692.47"/>
<polygon fill="black" stroke="black" points="3507,-20692.3 3503.5,-20682.3 3500,-20692.3 3507,-20692.3"/>
</g>
<!-- layer3_expert3_down -->
<g id="node244" class="node">
<title>layer3_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3987,-20578 3604,-20578 3604,-20510 3987,-20510 3987,-20578"/>
<text text-anchor="middle" x="3795.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3795.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3795.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3795.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_expert3_act&#45;&gt;layer3_expert3_down -->
<g id="edge342" class="edge">
<title>layer3_expert3_act&#45;&gt;layer3_expert3_down</title>
<path fill="none" stroke="black" d="M3598.3,-20613.88C3627.91,-20603.54 3660.72,-20592.08 3690.96,-20581.52"/>
<polygon fill="black" stroke="black" points="3692.39,-20584.73 3700.67,-20578.12 3690.08,-20578.12 3692.39,-20584.73"/>
</g>
<!-- layer3_expert3_down&#45;&gt;layer3_token_aggregation -->
<g id="edge343" class="edge">
<title>layer3_expert3_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M3987.09,-20528.97C4079.12,-20522.56 4190.99,-20515.25 4291.5,-20510 5129.63,-20466.25 6114.01,-20433.62 6637.97,-20417.74"/>
<polygon fill="black" stroke="black" points="6638.45,-20421.23 6648.34,-20417.43 6638.23,-20414.23 6638.45,-20421.23"/>
</g>
<!-- layer3_expert4_act -->
<g id="node247" class="node">
<title>layer3_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4527,-20682 4132,-20682 4132,-20614 4527,-20614 4527,-20682"/>
<text text-anchor="middle" x="4329.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4329.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4329.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4329.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_expert4_gate&#45;&gt;layer3_expert4_act -->
<g id="edge346" class="edge">
<title>layer3_expert4_gate&#45;&gt;layer3_expert4_act</title>
<path fill="none" stroke="black" d="M4050.3,-20717.95C4093.56,-20707.27 4141.7,-20695.38 4185.66,-20684.53"/>
<polygon fill="black" stroke="black" points="4186.69,-20687.88 4195.56,-20682.08 4185.01,-20681.08 4186.69,-20687.88"/>
</g>
<!-- layer3_expert4_up&#45;&gt;layer3_expert4_act -->
<g id="edge347" class="edge">
<title>layer3_expert4_up&#45;&gt;layer3_expert4_act</title>
<path fill="none" stroke="black" d="M4329.5,-20717.88C4329.5,-20709.78 4329.5,-20700.98 4329.5,-20692.47"/>
<polygon fill="black" stroke="black" points="4333,-20692.3 4329.5,-20682.3 4326,-20692.3 4333,-20692.3"/>
</g>
<!-- layer3_expert4_down -->
<g id="node248" class="node">
<title>layer3_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4684,-20578 4301,-20578 4301,-20510 4684,-20510 4684,-20578"/>
<text text-anchor="middle" x="4492.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4492.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4492.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4492.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_expert4_act&#45;&gt;layer3_expert4_down -->
<g id="edge348" class="edge">
<title>layer3_expert4_act&#45;&gt;layer3_expert4_down</title>
<path fill="none" stroke="black" d="M4382.42,-20613.88C4397.87,-20604.21 4414.89,-20593.56 4430.84,-20583.59"/>
<polygon fill="black" stroke="black" points="4432.94,-20586.4 4439.57,-20578.12 4429.23,-20580.46 4432.94,-20586.4"/>
</g>
<!-- layer3_expert4_down&#45;&gt;layer3_token_aggregation -->
<g id="edge349" class="edge">
<title>layer3_expert4_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M4684.08,-20532.65C5103.5,-20510 6108.65,-20455.71 6650.24,-20426.46"/>
<polygon fill="black" stroke="black" points="6650.77,-20429.93 6660.56,-20425.9 6650.39,-20422.94 6650.77,-20429.93"/>
</g>
<!-- layer3_expert5_act -->
<g id="node251" class="node">
<title>layer3_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5353,-20682 4958,-20682 4958,-20614 5353,-20614 5353,-20682"/>
<text text-anchor="middle" x="5155.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5155.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5155.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5155.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_expert5_gate&#45;&gt;layer3_expert5_act -->
<g id="edge352" class="edge">
<title>layer3_expert5_gate&#45;&gt;layer3_expert5_act</title>
<path fill="none" stroke="black" d="M4876.3,-20717.95C4919.56,-20707.27 4967.7,-20695.38 5011.66,-20684.53"/>
<polygon fill="black" stroke="black" points="5012.69,-20687.88 5021.56,-20682.08 5011.01,-20681.08 5012.69,-20687.88"/>
</g>
<!-- layer3_expert5_up&#45;&gt;layer3_expert5_act -->
<g id="edge353" class="edge">
<title>layer3_expert5_up&#45;&gt;layer3_expert5_act</title>
<path fill="none" stroke="black" d="M5155.5,-20717.88C5155.5,-20709.78 5155.5,-20700.98 5155.5,-20692.47"/>
<polygon fill="black" stroke="black" points="5159,-20692.3 5155.5,-20682.3 5152,-20692.3 5159,-20692.3"/>
</g>
<!-- layer3_expert5_down -->
<g id="node252" class="node">
<title>layer3_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5722,-20578 5339,-20578 5339,-20510 5722,-20510 5722,-20578"/>
<text text-anchor="middle" x="5530.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5530.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5530.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5530.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_expert5_act&#45;&gt;layer3_expert5_down -->
<g id="edge354" class="edge">
<title>layer3_expert5_act&#45;&gt;layer3_expert5_down</title>
<path fill="none" stroke="black" d="M5276.99,-20613.95C5316.02,-20603.34 5359.43,-20591.53 5399.14,-20580.73"/>
<polygon fill="black" stroke="black" points="5400.15,-20584.08 5408.88,-20578.08 5398.31,-20577.33 5400.15,-20584.08"/>
</g>
<!-- layer3_expert5_down&#45;&gt;layer3_token_aggregation -->
<g id="edge355" class="edge">
<title>layer3_expert5_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M5722.09,-20525.39C5960.85,-20503.45 6373.2,-20465.56 6667.09,-20438.56"/>
<polygon fill="black" stroke="black" points="6667.42,-20442.04 6677.06,-20437.64 6666.78,-20435.07 6667.42,-20442.04"/>
</g>
<!-- layer3_expert6_act -->
<g id="node255" class="node">
<title>layer3_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6179,-20682 5784,-20682 5784,-20614 6179,-20614 6179,-20682"/>
<text text-anchor="middle" x="5981.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5981.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5981.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5981.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_expert6_gate&#45;&gt;layer3_expert6_act -->
<g id="edge358" class="edge">
<title>layer3_expert6_gate&#45;&gt;layer3_expert6_act</title>
<path fill="none" stroke="black" d="M5702.3,-20717.95C5745.56,-20707.27 5793.7,-20695.38 5837.66,-20684.53"/>
<polygon fill="black" stroke="black" points="5838.69,-20687.88 5847.56,-20682.08 5837.01,-20681.08 5838.69,-20687.88"/>
</g>
<!-- layer3_expert6_up&#45;&gt;layer3_expert6_act -->
<g id="edge359" class="edge">
<title>layer3_expert6_up&#45;&gt;layer3_expert6_act</title>
<path fill="none" stroke="black" d="M5981.5,-20717.88C5981.5,-20709.78 5981.5,-20700.98 5981.5,-20692.47"/>
<polygon fill="black" stroke="black" points="5985,-20692.3 5981.5,-20682.3 5978,-20692.3 5985,-20692.3"/>
</g>
<!-- layer3_expert6_down -->
<g id="node256" class="node">
<title>layer3_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6442,-20578 6059,-20578 6059,-20510 6442,-20510 6442,-20578"/>
<text text-anchor="middle" x="6250.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6250.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6250.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6250.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_expert6_act&#45;&gt;layer3_expert6_down -->
<g id="edge360" class="edge">
<title>layer3_expert6_act&#45;&gt;layer3_expert6_down</title>
<path fill="none" stroke="black" d="M6068.84,-20613.88C6095.87,-20603.63 6125.82,-20592.28 6153.47,-20581.79"/>
<polygon fill="black" stroke="black" points="6155.03,-20584.94 6163.14,-20578.12 6152.55,-20578.4 6155.03,-20584.94"/>
</g>
<!-- layer3_expert6_down&#45;&gt;layer3_token_aggregation -->
<g id="edge361" class="edge">
<title>layer3_expert6_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M6434.96,-20509.99C6514.68,-20495.73 6610.18,-20478.64 6700.26,-20462.52"/>
<polygon fill="black" stroke="black" points="6701.14,-20465.91 6710.37,-20460.71 6699.91,-20459.02 6701.14,-20465.91"/>
</g>
<!-- layer3_expert7_act -->
<g id="node259" class="node">
<title>layer3_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="7005,-20682 6610,-20682 6610,-20614 7005,-20614 7005,-20682"/>
<text text-anchor="middle" x="6807.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6807.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6807.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6807.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_expert7_gate&#45;&gt;layer3_expert7_act -->
<g id="edge364" class="edge">
<title>layer3_expert7_gate&#45;&gt;layer3_expert7_act</title>
<path fill="none" stroke="black" d="M6528.3,-20717.95C6571.56,-20707.27 6619.7,-20695.38 6663.66,-20684.53"/>
<polygon fill="black" stroke="black" points="6664.69,-20687.88 6673.56,-20682.08 6663.01,-20681.08 6664.69,-20687.88"/>
</g>
<!-- layer3_expert7_up&#45;&gt;layer3_expert7_act -->
<g id="edge365" class="edge">
<title>layer3_expert7_up&#45;&gt;layer3_expert7_act</title>
<path fill="none" stroke="black" d="M6807.5,-20717.88C6807.5,-20709.78 6807.5,-20700.98 6807.5,-20692.47"/>
<polygon fill="black" stroke="black" points="6811,-20692.3 6807.5,-20682.3 6804,-20692.3 6811,-20692.3"/>
</g>
<!-- layer3_expert7_down -->
<g id="node260" class="node">
<title>layer3_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="7002,-20578 6619,-20578 6619,-20510 7002,-20510 7002,-20578"/>
<text text-anchor="middle" x="6810.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6810.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6810.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6810.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_expert7_act&#45;&gt;layer3_expert7_down -->
<g id="edge366" class="edge">
<title>layer3_expert7_act&#45;&gt;layer3_expert7_down</title>
<path fill="none" stroke="black" d="M6808.47,-20613.88C6808.71,-20605.78 6808.97,-20596.98 6809.22,-20588.47"/>
<polygon fill="black" stroke="black" points="6812.73,-20588.4 6809.52,-20578.3 6805.73,-20588.19 6812.73,-20588.4"/>
</g>
<!-- layer3_expert7_down&#45;&gt;layer3_token_aggregation -->
<g id="edge367" class="edge">
<title>layer3_expert7_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M6859.17,-20509.9C6872.63,-20500.75 6887.8,-20490.44 6903.2,-20479.97"/>
<polygon fill="black" stroke="black" points="6905.47,-20482.66 6911.77,-20474.14 6901.53,-20476.87 6905.47,-20482.66"/>
</g>
<!-- layer3_expert8_act -->
<g id="node263" class="node">
<title>layer3_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7418,-20682 7023,-20682 7023,-20614 7418,-20614 7418,-20682"/>
<text text-anchor="middle" x="7220.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7220.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7220.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7220.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_expert8_gate&#45;&gt;layer3_expert8_act -->
<g id="edge370" class="edge">
<title>layer3_expert8_gate&#45;&gt;layer3_expert8_act</title>
<path fill="none" stroke="black" d="M7220.5,-20717.88C7220.5,-20709.78 7220.5,-20700.98 7220.5,-20692.47"/>
<polygon fill="black" stroke="black" points="7224,-20692.3 7220.5,-20682.3 7217,-20692.3 7224,-20692.3"/>
</g>
<!-- layer3_expert8_up&#45;&gt;layer3_expert8_act -->
<g id="edge371" class="edge">
<title>layer3_expert8_up&#45;&gt;layer3_expert8_act</title>
<path fill="none" stroke="black" d="M7499.7,-20717.95C7456.44,-20707.27 7408.3,-20695.38 7364.34,-20684.53"/>
<polygon fill="black" stroke="black" points="7364.99,-20681.08 7354.44,-20682.08 7363.31,-20687.88 7364.99,-20681.08"/>
</g>
<!-- layer3_expert8_down -->
<g id="node264" class="node">
<title>layer3_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7409,-20578 7026,-20578 7026,-20510 7409,-20510 7409,-20578"/>
<text text-anchor="middle" x="7217.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7217.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7217.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7217.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_expert8_act&#45;&gt;layer3_expert8_down -->
<g id="edge372" class="edge">
<title>layer3_expert8_act&#45;&gt;layer3_expert8_down</title>
<path fill="none" stroke="black" d="M7219.53,-20613.88C7219.29,-20605.78 7219.03,-20596.98 7218.78,-20588.47"/>
<polygon fill="black" stroke="black" points="7222.27,-20588.19 7218.48,-20578.3 7215.27,-20588.4 7222.27,-20588.19"/>
</g>
<!-- layer3_expert8_down&#45;&gt;layer3_token_aggregation -->
<g id="edge373" class="edge">
<title>layer3_expert8_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M7167.13,-20509.9C7153.06,-20500.66 7137.2,-20490.25 7121.12,-20479.67"/>
<polygon fill="black" stroke="black" points="7122.97,-20476.7 7112.69,-20474.14 7119.12,-20482.55 7122.97,-20476.7"/>
</g>
<!-- layer3_expert9_act -->
<g id="node267" class="node">
<title>layer3_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8244,-20682 7849,-20682 7849,-20614 8244,-20614 8244,-20682"/>
<text text-anchor="middle" x="8046.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8046.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8046.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8046.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_expert9_gate&#45;&gt;layer3_expert9_act -->
<g id="edge376" class="edge">
<title>layer3_expert9_gate&#45;&gt;layer3_expert9_act</title>
<path fill="none" stroke="black" d="M8046.5,-20717.88C8046.5,-20709.78 8046.5,-20700.98 8046.5,-20692.47"/>
<polygon fill="black" stroke="black" points="8050,-20692.3 8046.5,-20682.3 8043,-20692.3 8050,-20692.3"/>
</g>
<!-- layer3_expert9_up&#45;&gt;layer3_expert9_act -->
<g id="edge377" class="edge">
<title>layer3_expert9_up&#45;&gt;layer3_expert9_act</title>
<path fill="none" stroke="black" d="M8325.7,-20717.95C8282.44,-20707.27 8234.3,-20695.38 8190.34,-20684.53"/>
<polygon fill="black" stroke="black" points="8190.99,-20681.08 8180.44,-20682.08 8189.31,-20687.88 8190.99,-20681.08"/>
</g>
<!-- layer3_expert9_down -->
<g id="node268" class="node">
<title>layer3_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8025,-20578 7642,-20578 7642,-20510 8025,-20510 8025,-20578"/>
<text text-anchor="middle" x="7833.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7833.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7833.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7833.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_expert9_act&#45;&gt;layer3_expert9_down -->
<g id="edge378" class="edge">
<title>layer3_expert9_act&#45;&gt;layer3_expert9_down</title>
<path fill="none" stroke="black" d="M7977.35,-20613.88C7956.41,-20603.86 7933.26,-20592.77 7911.77,-20582.48"/>
<polygon fill="black" stroke="black" points="7913.2,-20579.29 7902.67,-20578.12 7910.18,-20585.6 7913.2,-20579.29"/>
</g>
<!-- layer3_expert9_down&#45;&gt;layer3_token_aggregation -->
<g id="edge379" class="edge">
<title>layer3_expert9_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M7641.84,-20511.33C7576.96,-20500.61 7501.75,-20488.18 7426.34,-20475.72"/>
<polygon fill="black" stroke="black" points="7426.62,-20472.22 7416.19,-20474.04 7425.48,-20479.12 7426.62,-20472.22"/>
</g>
<!-- layer3_expert10_act -->
<g id="node271" class="node">
<title>layer3_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9070,-20682 8675,-20682 8675,-20614 9070,-20614 9070,-20682"/>
<text text-anchor="middle" x="8872.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8872.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8872.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8872.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_expert10_gate&#45;&gt;layer3_expert10_act -->
<g id="edge382" class="edge">
<title>layer3_expert10_gate&#45;&gt;layer3_expert10_act</title>
<path fill="none" stroke="black" d="M8872.5,-20717.88C8872.5,-20709.78 8872.5,-20700.98 8872.5,-20692.47"/>
<polygon fill="black" stroke="black" points="8876,-20692.3 8872.5,-20682.3 8869,-20692.3 8876,-20692.3"/>
</g>
<!-- layer3_expert10_up&#45;&gt;layer3_expert10_act -->
<g id="edge383" class="edge">
<title>layer3_expert10_up&#45;&gt;layer3_expert10_act</title>
<path fill="none" stroke="black" d="M9151.7,-20717.95C9108.44,-20707.27 9060.3,-20695.38 9016.34,-20684.53"/>
<polygon fill="black" stroke="black" points="9016.99,-20681.08 9006.44,-20682.08 9015.31,-20687.88 9016.99,-20681.08"/>
</g>
<!-- layer3_expert10_down -->
<g id="node272" class="node">
<title>layer3_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8746,-20578 8363,-20578 8363,-20510 8746,-20510 8746,-20578"/>
<text text-anchor="middle" x="8554.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8554.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8554.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8554.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_expert10_act&#45;&gt;layer3_expert10_down -->
<g id="edge384" class="edge">
<title>layer3_expert10_act&#45;&gt;layer3_expert10_down</title>
<path fill="none" stroke="black" d="M8769.25,-20613.88C8736.65,-20603.43 8700.47,-20591.82 8667.25,-20581.16"/>
<polygon fill="black" stroke="black" points="8668.09,-20577.76 8657.5,-20578.04 8665.95,-20584.42 8668.09,-20577.76"/>
</g>
<!-- layer3_expert10_down&#45;&gt;layer3_token_aggregation -->
<g id="edge385" class="edge">
<title>layer3_expert10_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M8362.85,-20526.12C8137.46,-20506.27 7755.98,-20472.66 7455.54,-20446.2"/>
<polygon fill="black" stroke="black" points="7455.61,-20442.69 7445.34,-20445.3 7454.99,-20449.67 7455.61,-20442.69"/>
</g>
<!-- layer3_expert11_act -->
<g id="node275" class="node">
<title>layer3_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9896,-20682 9501,-20682 9501,-20614 9896,-20614 9896,-20682"/>
<text text-anchor="middle" x="9698.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9698.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9698.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9698.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_expert11_gate&#45;&gt;layer3_expert11_act -->
<g id="edge388" class="edge">
<title>layer3_expert11_gate&#45;&gt;layer3_expert11_act</title>
<path fill="none" stroke="black" d="M9698.5,-20717.88C9698.5,-20709.78 9698.5,-20700.98 9698.5,-20692.47"/>
<polygon fill="black" stroke="black" points="9702,-20692.3 9698.5,-20682.3 9695,-20692.3 9702,-20692.3"/>
</g>
<!-- layer3_expert11_up&#45;&gt;layer3_expert11_act -->
<g id="edge389" class="edge">
<title>layer3_expert11_up&#45;&gt;layer3_expert11_act</title>
<path fill="none" stroke="black" d="M9977.7,-20717.95C9934.44,-20707.27 9886.3,-20695.38 9842.34,-20684.53"/>
<polygon fill="black" stroke="black" points="9842.99,-20681.08 9832.44,-20682.08 9841.31,-20687.88 9842.99,-20681.08"/>
</g>
<!-- layer3_expert11_down -->
<g id="node276" class="node">
<title>layer3_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9520,-20578 9137,-20578 9137,-20510 9520,-20510 9520,-20578"/>
<text text-anchor="middle" x="9328.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9328.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9328.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9328.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_expert11_act&#45;&gt;layer3_expert11_down -->
<g id="edge390" class="edge">
<title>layer3_expert11_act&#45;&gt;layer3_expert11_down</title>
<path fill="none" stroke="black" d="M9578.63,-20613.95C9540.2,-20603.36 9497.47,-20591.58 9458.36,-20580.8"/>
<polygon fill="black" stroke="black" points="9459.07,-20577.36 9448.5,-20578.08 9457.21,-20584.11 9459.07,-20577.36"/>
</g>
<!-- layer3_expert11_down&#45;&gt;layer3_token_aggregation -->
<g id="edge391" class="edge">
<title>layer3_expert11_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M9136.84,-20531.75C8765.82,-20509.99 7941.55,-20461.63 7435.2,-20431.92"/>
<polygon fill="black" stroke="black" points="7435.35,-20428.42 7425.17,-20431.33 7434.94,-20435.41 7435.35,-20428.42"/>
</g>
<!-- layer3_expert12_act -->
<g id="node279" class="node">
<title>layer3_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10722,-20682 10327,-20682 10327,-20614 10722,-20614 10722,-20682"/>
<text text-anchor="middle" x="10524.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10524.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10524.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10524.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_expert12_gate&#45;&gt;layer3_expert12_act -->
<g id="edge394" class="edge">
<title>layer3_expert12_gate&#45;&gt;layer3_expert12_act</title>
<path fill="none" stroke="black" d="M10524.5,-20717.88C10524.5,-20709.78 10524.5,-20700.98 10524.5,-20692.47"/>
<polygon fill="black" stroke="black" points="10528,-20692.3 10524.5,-20682.3 10521,-20692.3 10528,-20692.3"/>
</g>
<!-- layer3_expert12_up&#45;&gt;layer3_expert12_act -->
<g id="edge395" class="edge">
<title>layer3_expert12_up&#45;&gt;layer3_expert12_act</title>
<path fill="none" stroke="black" d="M10803.7,-20717.95C10760.44,-20707.27 10712.3,-20695.38 10668.34,-20684.53"/>
<polygon fill="black" stroke="black" points="10668.99,-20681.08 10658.44,-20682.08 10667.31,-20687.88 10668.99,-20681.08"/>
</g>
<!-- layer3_expert12_down -->
<g id="node280" class="node">
<title>layer3_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10320,-20578 9937,-20578 9937,-20510 10320,-20510 10320,-20578"/>
<text text-anchor="middle" x="10128.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10128.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10128.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10128.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_expert12_act&#45;&gt;layer3_expert12_down -->
<g id="edge396" class="edge">
<title>layer3_expert12_act&#45;&gt;layer3_expert12_down</title>
<path fill="none" stroke="black" d="M10396.2,-20613.95C10354.81,-20603.29 10308.76,-20591.43 10266.69,-20580.59"/>
<polygon fill="black" stroke="black" points="10267.49,-20577.19 10256.93,-20578.08 10265.74,-20583.96 10267.49,-20577.19"/>
</g>
<!-- layer3_expert12_down&#45;&gt;layer3_token_aggregation -->
<g id="edge397" class="edge">
<title>layer3_expert12_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M9936.67,-20531.74C9819.15,-20525.01 9665.65,-20516.53 9529.5,-20510 8786.75,-20474.36 7920.41,-20440.66 7421.65,-20422.02"/>
<polygon fill="black" stroke="black" points="7421.53,-20418.52 7411.41,-20421.64 7421.27,-20425.51 7421.53,-20418.52"/>
</g>
<!-- layer3_expert13_act -->
<g id="node283" class="node">
<title>layer3_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11548,-20682 11153,-20682 11153,-20614 11548,-20614 11548,-20682"/>
<text text-anchor="middle" x="11350.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11350.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11350.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11350.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_expert13_gate&#45;&gt;layer3_expert13_act -->
<g id="edge400" class="edge">
<title>layer3_expert13_gate&#45;&gt;layer3_expert13_act</title>
<path fill="none" stroke="black" d="M11350.5,-20717.88C11350.5,-20709.78 11350.5,-20700.98 11350.5,-20692.47"/>
<polygon fill="black" stroke="black" points="11354,-20692.3 11350.5,-20682.3 11347,-20692.3 11354,-20692.3"/>
</g>
<!-- layer3_expert13_up&#45;&gt;layer3_expert13_act -->
<g id="edge401" class="edge">
<title>layer3_expert13_up&#45;&gt;layer3_expert13_act</title>
<path fill="none" stroke="black" d="M11629.7,-20717.95C11586.44,-20707.27 11538.3,-20695.38 11494.34,-20684.53"/>
<polygon fill="black" stroke="black" points="11494.99,-20681.08 11484.44,-20682.08 11493.31,-20687.88 11494.99,-20681.08"/>
</g>
<!-- layer3_expert13_down -->
<g id="node284" class="node">
<title>layer3_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11133,-20578 10750,-20578 10750,-20510 11133,-20510 11133,-20578"/>
<text text-anchor="middle" x="10941.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10941.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10941.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10941.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_expert13_act&#45;&gt;layer3_expert13_down -->
<g id="edge402" class="edge">
<title>layer3_expert13_act&#45;&gt;layer3_expert13_down</title>
<path fill="none" stroke="black" d="M11217.99,-20613.95C11175.15,-20603.27 11127.48,-20591.38 11083.95,-20580.53"/>
<polygon fill="black" stroke="black" points="11084.7,-20577.1 11074.15,-20578.08 11083,-20583.9 11084.7,-20577.1"/>
</g>
<!-- layer3_expert13_down&#45;&gt;layer3_token_aggregation -->
<g id="edge403" class="edge">
<title>layer3_expert13_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M10749.98,-20531.55C10629.35,-20524.61 10470.36,-20515.98 10329.5,-20510 9278.09,-20465.34 8038.53,-20432 7413.76,-20416.54"/>
<polygon fill="black" stroke="black" points="7413.78,-20413.04 7403.69,-20416.3 7413.6,-20420.04 7413.78,-20413.04"/>
</g>
<!-- layer3_expert14_act -->
<g id="node287" class="node">
<title>layer3_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12374,-20682 11979,-20682 11979,-20614 12374,-20614 12374,-20682"/>
<text text-anchor="middle" x="12176.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12176.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12176.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12176.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_expert14_gate&#45;&gt;layer3_expert14_act -->
<g id="edge406" class="edge">
<title>layer3_expert14_gate&#45;&gt;layer3_expert14_act</title>
<path fill="none" stroke="black" d="M12176.5,-20717.88C12176.5,-20709.78 12176.5,-20700.98 12176.5,-20692.47"/>
<polygon fill="black" stroke="black" points="12180,-20692.3 12176.5,-20682.3 12173,-20692.3 12180,-20692.3"/>
</g>
<!-- layer3_expert14_up&#45;&gt;layer3_expert14_act -->
<g id="edge407" class="edge">
<title>layer3_expert14_up&#45;&gt;layer3_expert14_act</title>
<path fill="none" stroke="black" d="M12455.7,-20717.95C12412.44,-20707.27 12364.3,-20695.38 12320.34,-20684.53"/>
<polygon fill="black" stroke="black" points="12320.99,-20681.08 12310.44,-20682.08 12319.31,-20687.88 12320.99,-20681.08"/>
</g>
<!-- layer3_expert14_down -->
<g id="node288" class="node">
<title>layer3_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11952,-20578 11569,-20578 11569,-20510 11952,-20510 11952,-20578"/>
<text text-anchor="middle" x="11760.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11760.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11760.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11760.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_expert14_act&#45;&gt;layer3_expert14_down -->
<g id="edge408" class="edge">
<title>layer3_expert14_act&#45;&gt;layer3_expert14_down</title>
<path fill="none" stroke="black" d="M12041.72,-20613.95C11998.15,-20603.27 11949.66,-20591.38 11905.39,-20580.53"/>
<polygon fill="black" stroke="black" points="11905.96,-20577.06 11895.42,-20578.08 11904.3,-20583.86 11905.96,-20577.06"/>
</g>
<!-- layer3_expert14_down&#45;&gt;layer3_token_aggregation -->
<g id="edge409" class="edge">
<title>layer3_expert14_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M11568.83,-20531.36C11446.82,-20524.3 11285.43,-20515.6 11142.5,-20510 9772.85,-20456.37 8146.66,-20425.43 7409.32,-20413.17"/>
<polygon fill="black" stroke="black" points="7409.12,-20409.67 7399.07,-20413 7409.01,-20416.67 7409.12,-20409.67"/>
</g>
<!-- layer3_expert15_act -->
<g id="node291" class="node">
<title>layer3_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13200,-20682 12805,-20682 12805,-20614 13200,-20614 13200,-20682"/>
<text text-anchor="middle" x="13002.5" y="-20666.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="13002.5" y="-20651.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13002.5" y="-20636.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13002.5" y="-20621.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_expert15_gate&#45;&gt;layer3_expert15_act -->
<g id="edge412" class="edge">
<title>layer3_expert15_gate&#45;&gt;layer3_expert15_act</title>
<path fill="none" stroke="black" d="M13002.5,-20717.88C13002.5,-20709.78 13002.5,-20700.98 13002.5,-20692.47"/>
<polygon fill="black" stroke="black" points="13006,-20692.3 13002.5,-20682.3 12999,-20692.3 13006,-20692.3"/>
</g>
<!-- layer3_expert15_up&#45;&gt;layer3_expert15_act -->
<g id="edge413" class="edge">
<title>layer3_expert15_up&#45;&gt;layer3_expert15_act</title>
<path fill="none" stroke="black" d="M13281.7,-20717.95C13238.44,-20707.27 13190.3,-20695.38 13146.34,-20684.53"/>
<polygon fill="black" stroke="black" points="13146.99,-20681.08 13136.44,-20682.08 13145.31,-20687.88 13146.99,-20681.08"/>
</g>
<!-- layer3_expert15_down -->
<g id="node292" class="node">
<title>layer3_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12775,-20578 12392,-20578 12392,-20510 12775,-20510 12775,-20578"/>
<text text-anchor="middle" x="12583.5" y="-20562.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12583.5" y="-20547.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12583.5" y="-20532.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12583.5" y="-20517.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_expert15_act&#45;&gt;layer3_expert15_down -->
<g id="edge414" class="edge">
<title>layer3_expert15_act&#45;&gt;layer3_expert15_down</title>
<path fill="none" stroke="black" d="M12866.75,-20613.95C12822.77,-20603.25 12773.82,-20591.33 12729.15,-20580.46"/>
<polygon fill="black" stroke="black" points="12729.93,-20577.05 12719.39,-20578.08 12728.28,-20583.85 12729.93,-20577.05"/>
</g>
<!-- layer3_expert15_down&#45;&gt;layer3_token_aggregation -->
<g id="edge415" class="edge">
<title>layer3_expert15_down&#45;&gt;layer3_token_aggregation</title>
<path fill="none" stroke="black" d="M12391.98,-20531.24C12269.02,-20524.09 12105.9,-20515.33 11961.5,-20510 10267.24,-20447.45 8245.33,-20420.15 7405.93,-20410.91"/>
<polygon fill="black" stroke="black" points="7405.84,-20407.4 7395.8,-20410.79 7405.76,-20414.4 7405.84,-20407.4"/>
</g>
<!-- layer3_res2 -->
<g id="node294" class="node">
<title>layer3_res2</title>
<polygon fill="none" stroke="black" points="7451.24,-20302 6750.12,-20302 6569.76,-20136 7270.88,-20136 7451.24,-20302"/>
<text text-anchor="middle" x="7010.5" y="-20245.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7010.5" y="-20230.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-20215.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-20200.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-20185.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_token_aggregation&#45;&gt;layer3_res2 -->
<g id="edge416" class="edge">
<title>layer3_token_aggregation&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M7010.5,-20337.95C7010.5,-20329.63 7010.5,-20321 7010.5,-20312.38"/>
<polygon fill="black" stroke="black" points="7014,-20312.28 7010.5,-20302.28 7007,-20312.28 7014,-20312.28"/>
</g>
<!-- layer4_mha_qkv -->
<g id="node295" class="node">
<title>layer4_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7246.5,-20100 6774.5,-20100 6774.5,-20032 7246.5,-20032 7246.5,-20100"/>
<text text-anchor="middle" x="7010.5" y="-20084.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7010.5" y="-20069.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-20054.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7010.5" y="-20039.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_mha_qkv -->
<g id="edge417" class="edge">
<title>layer3_res2&#45;&gt;layer4_mha_qkv</title>
<path fill="none" stroke="black" d="M7010.5,-20135.87C7010.5,-20127.12 7010.5,-20118.48 7010.5,-20110.45"/>
<polygon fill="black" stroke="black" points="7014,-20110.26 7010.5,-20100.26 7007,-20110.26 7014,-20110.26"/>
</g>
<!-- layer4_mha_attn -->
<g id="node296" class="node">
<title>layer4_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7240.5,-19996 6780.5,-19996 6780.5,-19928 7240.5,-19928 7240.5,-19996"/>
<text text-anchor="middle" x="7010.5" y="-19980.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7010.5" y="-19965.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7010.5" y="-19950.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19935.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_mha_qkv&#45;&gt;layer4_mha_attn -->
<g id="edge418" class="edge">
<title>layer4_mha_qkv&#45;&gt;layer4_mha_attn</title>
<path fill="none" stroke="black" d="M7010.5,-20031.88C7010.5,-20023.78 7010.5,-20014.98 7010.5,-20006.47"/>
<polygon fill="black" stroke="black" points="7014,-20006.3 7010.5,-19996.3 7007,-20006.3 7014,-20006.3"/>
</g>
<!-- layer4_mha_out -->
<g id="node297" class="node">
<title>layer4_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7223,-19892 6798,-19892 6798,-19824 7223,-19824 7223,-19892"/>
<text text-anchor="middle" x="7010.5" y="-19876.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7010.5" y="-19861.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19846.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19831.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_mha_attn&#45;&gt;layer4_mha_out -->
<g id="edge419" class="edge">
<title>layer4_mha_attn&#45;&gt;layer4_mha_out</title>
<path fill="none" stroke="black" d="M7010.5,-19927.88C7010.5,-19919.78 7010.5,-19910.98 7010.5,-19902.47"/>
<polygon fill="black" stroke="black" points="7014,-19902.3 7010.5,-19892.3 7007,-19902.3 7014,-19902.3"/>
</g>
<!-- layer4_res1 -->
<g id="node298" class="node">
<title>layer4_res1</title>
<polygon fill="none" stroke="black" points="7451.24,-19788 6750.12,-19788 6569.76,-19622 7270.88,-19622 7451.24,-19788"/>
<text text-anchor="middle" x="7010.5" y="-19731.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7010.5" y="-19716.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19701.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19686.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19671.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_mha_out&#45;&gt;layer4_res1 -->
<g id="edge420" class="edge">
<title>layer4_mha_out&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M7010.5,-19823.86C7010.5,-19816.1 7010.5,-19807.46 7010.5,-19798.48"/>
<polygon fill="black" stroke="black" points="7014,-19798.23 7010.5,-19788.23 7007,-19798.23 7014,-19798.23"/>
</g>
<!-- layer4_ln1 -->
<g id="node299" class="node">
<title>layer4_ln1</title>
<polygon fill="yellow" stroke="black" points="7223,-19586 6798,-19586 6798,-19518 7223,-19518 7223,-19586"/>
<text text-anchor="middle" x="7010.5" y="-19570.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7010.5" y="-19555.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19540.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19525.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln1 -->
<g id="edge421" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln1</title>
<path fill="none" stroke="black" d="M7010.5,-19621.87C7010.5,-19613.12 7010.5,-19604.48 7010.5,-19596.45"/>
<polygon fill="black" stroke="black" points="7014,-19596.26 7010.5,-19586.26 7007,-19596.26 7014,-19596.26"/>
</g>
<!-- layer4_expert_routing -->
<g id="node300" class="node">
<title>layer4_expert_routing</title>
<polygon fill="orange" stroke="black" points="7010.5,-19482 6594.5,-19399 7010.5,-19316 7426.5,-19399 7010.5,-19482"/>
<text text-anchor="middle" x="7010.5" y="-19425.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7010.5" y="-19410.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7010.5" y="-19395.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19380.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7010.5" y="-19365.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_expert_routing -->
<g id="edge422" class="edge">
<title>layer4_ln1&#45;&gt;layer4_expert_routing</title>
<path fill="none" stroke="black" d="M7010.5,-19517.86C7010.5,-19510.1 7010.5,-19501.46 7010.5,-19492.48"/>
<polygon fill="black" stroke="black" points="7014,-19492.23 7010.5,-19482.23 7007,-19492.23 7014,-19492.23"/>
</g>
<!-- layer4_token_distribution -->
<g id="node301" class="node">
<title>layer4_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7438.86,-19280 6757.44,-19280 6582.14,-19144 7263.56,-19144 7438.86,-19280"/>
<text text-anchor="middle" x="7010.5" y="-19230.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7010.5" y="-19215.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7010.5" y="-19200.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7010.5" y="-19185.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer4_expert_routing&#45;&gt;layer4_token_distribution -->
<g id="edge423" class="edge">
<title>layer4_expert_routing&#45;&gt;layer4_token_distribution</title>
<path fill="none" stroke="black" d="M7010.5,-19315.78C7010.5,-19307.34 7010.5,-19298.79 7010.5,-19290.4"/>
<polygon fill="black" stroke="black" points="7014,-19290.28 7010.5,-19280.28 7007,-19290.28 7014,-19290.28"/>
</g>
<!-- layer4_expert0_gate -->
<g id="node302" class="node">
<title>layer4_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="807,-19108 412,-19108 412,-19040 807,-19040 807,-19108"/>
<text text-anchor="middle" x="609.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="609.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="609.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="609.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert0_gate -->
<g id="edge424" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6669.42,-19211.72C5548.99,-19213.09 1987.01,-19209.23 817.31,-19108.11"/>
<polygon fill="black" stroke="black" points="817.32,-19104.6 807.06,-19107.22 816.71,-19111.57 817.32,-19104.6"/>
</g>
<!-- layer4_expert0_up -->
<g id="node303" class="node">
<title>layer4_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1220,-19108 825,-19108 825,-19040 1220,-19040 1220,-19108"/>
<text text-anchor="middle" x="1022.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1022.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1022.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1022.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert0_up -->
<g id="edge425" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6668.42,-19211.24C5597.28,-19211 2315.27,-19202.44 1230.35,-19108.12"/>
<polygon fill="black" stroke="black" points="1230.32,-19104.6 1220.06,-19107.21 1229.71,-19111.57 1230.32,-19104.6"/>
</g>
<!-- layer4_expert1_gate -->
<g id="node306" class="node">
<title>layer4_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1633,-19108 1238,-19108 1238,-19040 1633,-19040 1633,-19108"/>
<text text-anchor="middle" x="1435.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1435.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1435.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1435.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert1_gate -->
<g id="edge430" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6667.86,-19210.69C5648.38,-19208.77 2643.69,-19195.69 1643.28,-19108.11"/>
<polygon fill="black" stroke="black" points="1643.33,-19104.6 1633.06,-19107.21 1642.71,-19111.57 1643.33,-19104.6"/>
</g>
<!-- layer4_expert1_up -->
<g id="node307" class="node">
<title>layer4_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2046,-19108 1651,-19108 1651,-19040 2046,-19040 2046,-19108"/>
<text text-anchor="middle" x="1848.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1848.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1848.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1848.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert1_up -->
<g id="edge431" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6666.92,-19210.04C5700.86,-19206.35 2972.03,-19188.95 2056.08,-19108.09"/>
<polygon fill="black" stroke="black" points="2056.33,-19104.6 2046.06,-19107.2 2055.71,-19111.58 2056.33,-19104.6"/>
</g>
<!-- layer4_expert2_gate -->
<g id="node310" class="node">
<title>layer4_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2459,-19108 2064,-19108 2064,-19040 2459,-19040 2459,-19108"/>
<text text-anchor="middle" x="2261.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2261.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2261.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2261.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert2_gate -->
<g id="edge436" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6665.93,-19209.27C5755.78,-19203.72 3301.04,-19182.22 2469.07,-19108.1"/>
<polygon fill="black" stroke="black" points="2469.33,-19104.6 2459.06,-19107.19 2468.7,-19111.58 2469.33,-19104.6"/>
</g>
<!-- layer4_expert2_up -->
<g id="node311" class="node">
<title>layer4_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2872,-19108 2477,-19108 2477,-19040 2872,-19040 2872,-19108"/>
<text text-anchor="middle" x="2674.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2674.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2674.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2674.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert2_up -->
<g id="edge437" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6664.99,-19208.34C5813.65,-19200.84 3630.62,-19175.52 2882.16,-19108.1"/>
<polygon fill="black" stroke="black" points="2882.34,-19104.61 2872.06,-19107.18 2881.7,-19111.58 2882.34,-19104.61"/>
</g>
<!-- layer4_expert3_gate -->
<g id="node314" class="node">
<title>layer4_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3285,-19108 2890,-19108 2890,-19040 3285,-19040 3285,-19108"/>
<text text-anchor="middle" x="3087.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3087.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3087.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3087.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert3_gate -->
<g id="edge442" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6663.41,-19207.2C5873.73,-19197.62 3960.42,-19168.84 3295.24,-19108.11"/>
<polygon fill="black" stroke="black" points="3295.34,-19104.61 3285.06,-19107.17 3294.7,-19111.58 3295.34,-19104.61"/>
</g>
<!-- layer4_expert3_up -->
<g id="node315" class="node">
<title>layer4_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3698,-19108 3303,-19108 3303,-19040 3698,-19040 3698,-19108"/>
<text text-anchor="middle" x="3500.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3500.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3500.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3500.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert3_up -->
<g id="edge443" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6661.52,-19205.77C5937.21,-19193.98 4290.46,-19162.17 3708.25,-19108.12"/>
<polygon fill="black" stroke="black" points="3708.35,-19104.61 3698.06,-19107.16 3707.69,-19111.58 3708.35,-19104.61"/>
</g>
<!-- layer4_expert4_gate -->
<g id="node318" class="node">
<title>layer4_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4111,-19108 3716,-19108 3716,-19040 4111,-19040 4111,-19108"/>
<text text-anchor="middle" x="3913.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3913.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3913.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3913.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert4_gate -->
<g id="edge448" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6659.06,-19203.9C6004.59,-19189.8 4620.94,-19155.52 4121.26,-19108.12"/>
<polygon fill="black" stroke="black" points="4121.35,-19104.62 4111.06,-19107.14 4120.68,-19111.58 4121.35,-19104.62"/>
</g>
<!-- layer4_expert4_up -->
<g id="node319" class="node">
<title>layer4_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4524,-19108 4129,-19108 4129,-19040 4524,-19040 4524,-19108"/>
<text text-anchor="middle" x="4326.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4326.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4326.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4326.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert4_up -->
<g id="edge449" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6666.37,-19209.42C6189.11,-19204.35 5299.47,-19184.49 4534.19,-19108.13"/>
<polygon fill="black" stroke="black" points="4534.36,-19104.63 4524.07,-19107.12 4533.67,-19111.6 4534.36,-19104.63"/>
</g>
<!-- layer4_expert5_gate -->
<g id="node322" class="node">
<title>layer4_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4937,-19108 4542,-19108 4542,-19040 4937,-19040 4937,-19108"/>
<text text-anchor="middle" x="4739.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4739.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4739.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4739.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert5_gate -->
<g id="edge454" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6660.68,-19205.16C6251.56,-19195.67 5554.04,-19171.18 4947.34,-19108.16"/>
<polygon fill="black" stroke="black" points="4947.38,-19104.64 4937.07,-19107.09 4946.65,-19111.61 4947.38,-19104.64"/>
</g>
<!-- layer4_expert5_up -->
<g id="node323" class="node">
<title>layer4_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5350,-19108 4955,-19108 4955,-19040 5350,-19040 5350,-19108"/>
<text text-anchor="middle" x="5152.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5152.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5152.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5152.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert5_up -->
<g id="edge455" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6652.34,-19198.65C6319.6,-19184.84 5810.32,-19157.72 5360.03,-19108.14"/>
<polygon fill="black" stroke="black" points="5360.4,-19104.66 5350.07,-19107.04 5359.63,-19111.62 5360.4,-19104.66"/>
</g>
<!-- layer4_expert6_gate -->
<g id="node326" class="node">
<title>layer4_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5763,-19108 5368,-19108 5368,-19040 5763,-19040 5763,-19108"/>
<text text-anchor="middle" x="5565.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5565.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5565.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5565.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert6_gate -->
<g id="edge460" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6638.03,-19187.44C6394.4,-19170.23 6069.1,-19143.86 5773.16,-19108.18"/>
<polygon fill="black" stroke="black" points="5773.43,-19104.68 5763.08,-19106.96 5772.59,-19111.63 5773.43,-19104.68"/>
</g>
<!-- layer4_expert6_up -->
<g id="node327" class="node">
<title>layer4_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6176,-19108 5781,-19108 5781,-19040 6176,-19040 6176,-19108"/>
<text text-anchor="middle" x="5978.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5978.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5978.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5978.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert6_up -->
<g id="edge461" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6607.33,-19163.57C6475.89,-19147.37 6329.08,-19128.49 6186.37,-19108.25"/>
<polygon fill="black" stroke="black" points="6186.5,-19104.74 6176.11,-19106.79 6185.51,-19111.67 6186.5,-19104.74"/>
</g>
<!-- layer4_expert7_gate -->
<g id="node330" class="node">
<title>layer4_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6589,-19108 6194,-19108 6194,-19040 6589,-19040 6589,-19108"/>
<text text-anchor="middle" x="6391.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6391.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6391.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6391.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert7_gate -->
<g id="edge466" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.53,-19144C6652.4,-19132.32 6599.09,-19120.61 6551.86,-19110.23"/>
<polygon fill="black" stroke="black" points="6552.4,-19106.77 6541.88,-19108.04 6550.89,-19113.6 6552.4,-19106.77"/>
</g>
<!-- layer4_expert7_up -->
<g id="node331" class="node">
<title>layer4_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="7002,-19108 6607,-19108 6607,-19040 7002,-19040 7002,-19108"/>
<text text-anchor="middle" x="6804.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6804.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6804.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6804.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert7_up -->
<g id="edge467" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6909.01,-19144C6893.37,-19133.67 6877.68,-19123.31 6863.38,-19113.87"/>
<polygon fill="black" stroke="black" points="6864.95,-19110.72 6854.68,-19108.13 6861.1,-19116.56 6864.95,-19110.72"/>
</g>
<!-- layer4_expert8_gate -->
<g id="node334" class="node">
<title>layer4_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7415,-19108 7020,-19108 7020,-19040 7415,-19040 7415,-19108"/>
<text text-anchor="middle" x="7217.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7217.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7217.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7217.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert8_gate -->
<g id="edge472" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7112.48,-19144C7128.2,-19133.67 7143.97,-19123.31 7158.33,-19113.87"/>
<polygon fill="black" stroke="black" points="7160.64,-19116.54 7167.08,-19108.13 7156.8,-19110.69 7160.64,-19116.54"/>
</g>
<!-- layer4_expert8_up -->
<g id="node335" class="node">
<title>layer4_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7828,-19108 7433,-19108 7433,-19040 7828,-19040 7828,-19108"/>
<text text-anchor="middle" x="7630.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7630.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7630.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7630.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert8_up -->
<g id="edge473" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7275.23,-19152.93C7341.49,-19138.4 7410.56,-19123.25 7469.99,-19110.21"/>
<polygon fill="black" stroke="black" points="7470.81,-19113.61 7479.82,-19108.05 7469.31,-19106.78 7470.81,-19113.61"/>
</g>
<!-- layer4_expert9_gate -->
<g id="node338" class="node">
<title>layer4_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8241,-19108 7846,-19108 7846,-19040 8241,-19040 8241,-19108"/>
<text text-anchor="middle" x="8043.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8043.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8043.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8043.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert9_gate -->
<g id="edge478" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7306.03,-19176.73C7461.07,-19158.13 7654.37,-19133.94 7835.89,-19108.22"/>
<polygon fill="black" stroke="black" points="7836.49,-19111.67 7845.89,-19106.8 7835.5,-19104.74 7836.49,-19111.67"/>
</g>
<!-- layer4_expert9_up -->
<g id="node339" class="node">
<title>layer4_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8654,-19108 8259,-19108 8259,-19040 8654,-19040 8654,-19108"/>
<text text-anchor="middle" x="8456.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8456.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8456.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8456.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert9_up -->
<g id="edge479" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7324.91,-19191.51C7573.39,-19174.52 7929.09,-19146.72 8248.99,-19108.16"/>
<polygon fill="black" stroke="black" points="8249.41,-19111.63 8258.92,-19106.96 8248.57,-19104.68 8249.41,-19111.63"/>
</g>
<!-- layer4_expert10_gate -->
<g id="node342" class="node">
<title>layer4_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9067,-19108 8672,-19108 8672,-19040 9067,-19040 9067,-19108"/>
<text text-anchor="middle" x="8869.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8869.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8869.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8869.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert10_gate -->
<g id="edge484" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7335.93,-19200.01C7667.51,-19186.65 8196.55,-19159.38 8661.98,-19108.14"/>
<polygon fill="black" stroke="black" points="8662.37,-19111.62 8671.93,-19107.04 8661.6,-19104.66 8662.37,-19111.62"/>
</g>
<!-- layer4_expert10_up -->
<g id="node343" class="node">
<title>layer4_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9480,-19108 9085,-19108 9085,-19040 9480,-19040 9480,-19108"/>
<text text-anchor="middle" x="9282.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9282.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9282.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9282.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert10_up -->
<g id="edge485" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7343.24,-19205.57C7750.05,-19196.37 8459.4,-19172.08 9074.97,-19108.13"/>
<polygon fill="black" stroke="black" points="9075.35,-19111.61 9084.93,-19107.09 9074.62,-19104.64 9075.35,-19111.61"/>
</g>
<!-- layer4_expert11_gate -->
<g id="node346" class="node">
<title>layer4_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9893,-19108 9498,-19108 9498,-19040 9893,-19040 9893,-19108"/>
<text text-anchor="middle" x="9695.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9695.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9695.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9695.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert11_gate -->
<g id="edge490" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7348.2,-19209.5C7824.01,-19204.55 8718.7,-19184.86 9487.76,-19108.14"/>
<polygon fill="black" stroke="black" points="9488.33,-19111.6 9497.93,-19107.12 9487.64,-19104.63 9488.33,-19111.6"/>
</g>
<!-- layer4_expert11_up -->
<g id="node347" class="node">
<title>layer4_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10306,-19108 9911,-19108 9911,-19040 10306,-19040 10306,-19108"/>
<text text-anchor="middle" x="10108.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10108.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10108.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10108.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert11_up -->
<g id="edge491" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7341.5,-19204.35C7987.28,-19190.53 9395.47,-19156.03 9900.63,-19108.13"/>
<polygon fill="black" stroke="black" points="9901.32,-19111.58 9910.94,-19107.14 9900.65,-19104.62 9901.32,-19111.58"/>
</g>
<!-- layer4_expert12_gate -->
<g id="node350" class="node">
<title>layer4_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10719,-19108 10324,-19108 10324,-19040 10719,-19040 10719,-19108"/>
<text text-anchor="middle" x="10521.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10521.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10521.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10521.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert12_gate -->
<g id="edge496" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7343.83,-19206.02C8059.92,-19194.46 9727.02,-19162.58 10313.68,-19108.13"/>
<polygon fill="black" stroke="black" points="10314.31,-19111.58 10323.94,-19107.16 10313.65,-19104.61 10314.31,-19111.58"/>
</g>
<!-- layer4_expert12_up -->
<g id="node351" class="node">
<title>layer4_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11132,-19108 10737,-19108 10737,-19040 11132,-19040 11132,-19108"/>
<text text-anchor="middle" x="10934.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10934.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10934.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10934.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert12_up -->
<g id="edge497" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345.57,-19207.35C8127.82,-19197.92 10057.91,-19169.16 10726.7,-19108.12"/>
<polygon fill="black" stroke="black" points="10727.3,-19111.58 10736.94,-19107.17 10726.66,-19104.61 10727.3,-19111.58"/>
</g>
<!-- layer4_expert13_gate -->
<g id="node354" class="node">
<title>layer4_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11545,-19108 11150,-19108 11150,-19040 11545,-19040 11545,-19108"/>
<text text-anchor="middle" x="11347.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11347.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11347.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11347.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert13_gate -->
<g id="edge502" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7346.74,-19208.43C8191.52,-19201.03 10388.4,-19175.78 11139.8,-19108.11"/>
<polygon fill="black" stroke="black" points="11140.3,-19111.58 11149.94,-19107.18 11139.66,-19104.61 11140.3,-19111.58"/>
</g>
<!-- layer4_expert13_up -->
<g id="node355" class="node">
<title>layer4_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11958,-19108 11563,-19108 11563,-19040 11958,-19040 11958,-19108"/>
<text text-anchor="middle" x="11760.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11760.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11760.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11760.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert13_up -->
<g id="edge503" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7348.14,-19209.31C8252.83,-19203.84 10718.6,-19182.43 11552.9,-19108.1"/>
<polygon fill="black" stroke="black" points="11553.3,-19111.58 11562.94,-19107.19 11552.67,-19104.6 11553.3,-19111.58"/>
</g>
<!-- layer4_expert14_gate -->
<g id="node358" class="node">
<title>layer4_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12371,-19108 11976,-19108 11976,-19040 12371,-19040 12371,-19108"/>
<text text-anchor="middle" x="12173.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12173.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12173.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12173.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert14_gate -->
<g id="edge508" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7348.95,-19210.06C8310.58,-19206.42 11048.12,-19189.11 11965.9,-19108.1"/>
<polygon fill="black" stroke="black" points="11966.29,-19111.58 11975.94,-19107.2 11965.67,-19104.6 11966.29,-19111.58"/>
</g>
<!-- layer4_expert14_up -->
<g id="node359" class="node">
<title>layer4_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12784,-19108 12389,-19108 12389,-19040 12784,-19040 12784,-19108"/>
<text text-anchor="middle" x="12586.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12586.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12586.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12586.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert14_up -->
<g id="edge509" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7349.58,-19210.7C8365.74,-19208.8 11376.92,-19195.81 12378.71,-19108.11"/>
<polygon fill="black" stroke="black" points="12379.29,-19111.57 12388.94,-19107.21 12378.67,-19104.6 12379.29,-19111.57"/>
</g>
<!-- layer4_expert15_gate -->
<g id="node362" class="node">
<title>layer4_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13197,-19108 12802,-19108 12802,-19040 13197,-19040 13197,-19108"/>
<text text-anchor="middle" x="12999.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12999.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12999.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12999.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert15_gate -->
<g id="edge514" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7350.27,-19211.24C8419.13,-19211.02 11705.73,-19202.53 12791.64,-19108.12"/>
<polygon fill="black" stroke="black" points="12792.29,-19111.57 12801.94,-19107.21 12791.68,-19104.6 12792.29,-19111.57"/>
</g>
<!-- layer4_expert15_up -->
<g id="node363" class="node">
<title>layer4_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13610,-19108 13215,-19108 13215,-19040 13610,-19040 13610,-19108"/>
<text text-anchor="middle" x="13412.5" y="-19092.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13412.5" y="-19077.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13412.5" y="-19062.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13412.5" y="-19047.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer4_token_distribution&#45;&gt;layer4_expert15_up -->
<g id="edge515" class="edge">
<title>layer4_token_distribution&#45;&gt;layer4_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7351.15,-19211.72C8471.21,-19213.1 12034.63,-19209.26 13204.69,-19108.11"/>
<polygon fill="black" stroke="black" points="13205.29,-19111.57 13214.94,-19107.22 13204.68,-19104.6 13205.29,-19111.57"/>
</g>
<!-- layer4_expert0_act -->
<g id="node304" class="node">
<title>layer4_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1220,-19004 825,-19004 825,-18936 1220,-18936 1220,-19004"/>
<text text-anchor="middle" x="1022.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1022.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1022.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1022.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_expert0_gate&#45;&gt;layer4_expert0_act -->
<g id="edge426" class="edge">
<title>layer4_expert0_gate&#45;&gt;layer4_expert0_act</title>
<path fill="none" stroke="black" d="M743.3,-19039.95C786.56,-19029.27 834.7,-19017.38 878.66,-19006.53"/>
<polygon fill="black" stroke="black" points="879.69,-19009.88 888.56,-19004.08 878.01,-19003.08 879.69,-19009.88"/>
</g>
<!-- layer4_expert0_up&#45;&gt;layer4_expert0_act -->
<g id="edge427" class="edge">
<title>layer4_expert0_up&#45;&gt;layer4_expert0_act</title>
<path fill="none" stroke="black" d="M1022.5,-19039.88C1022.5,-19031.78 1022.5,-19022.98 1022.5,-19014.47"/>
<polygon fill="black" stroke="black" points="1026,-19014.3 1022.5,-19004.3 1019,-19014.3 1026,-19014.3"/>
</g>
<!-- layer4_expert0_down -->
<g id="node305" class="node">
<title>layer4_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1639,-18900 1256,-18900 1256,-18832 1639,-18832 1639,-18900"/>
<text text-anchor="middle" x="1447.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1447.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1447.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1447.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_expert0_act&#45;&gt;layer4_expert0_down -->
<g id="edge428" class="edge">
<title>layer4_expert0_act&#45;&gt;layer4_expert0_down</title>
<path fill="none" stroke="black" d="M1160.19,-18935.95C1204.8,-18925.25 1254.45,-18913.33 1299.76,-18902.46"/>
<polygon fill="black" stroke="black" points="1300.76,-18905.82 1309.66,-18900.08 1299.12,-18899.01 1300.76,-18905.82"/>
</g>
<!-- layer4_token_aggregation -->
<g id="node366" class="node">
<title>layer4_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7483.24,-18796 6726.44,-18796 6531.76,-18660 7288.56,-18660 7483.24,-18796"/>
<text text-anchor="middle" x="7007.5" y="-18746.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7007.5" y="-18731.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7007.5" y="-18716.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18701.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_expert0_down&#45;&gt;layer4_token_aggregation -->
<g id="edge429" class="edge">
<title>layer4_expert0_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M1639.14,-18847.25C1708.5,-18841.46 1787.47,-18835.6 1859.5,-18832 3636.48,-18743.14 5762.12,-18730.19 6620.16,-18728.83"/>
<polygon fill="black" stroke="black" points="6620.2,-18732.33 6630.2,-18728.81 6620.19,-18725.33 6620.2,-18732.33"/>
</g>
<!-- layer4_expert1_act -->
<g id="node308" class="node">
<title>layer4_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2046,-19004 1651,-19004 1651,-18936 2046,-18936 2046,-19004"/>
<text text-anchor="middle" x="1848.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1848.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1848.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1848.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_expert1_gate&#45;&gt;layer4_expert1_act -->
<g id="edge432" class="edge">
<title>layer4_expert1_gate&#45;&gt;layer4_expert1_act</title>
<path fill="none" stroke="black" d="M1569.3,-19039.95C1612.56,-19029.27 1660.7,-19017.38 1704.66,-19006.53"/>
<polygon fill="black" stroke="black" points="1705.69,-19009.88 1714.56,-19004.08 1704.01,-19003.08 1705.69,-19009.88"/>
</g>
<!-- layer4_expert1_up&#45;&gt;layer4_expert1_act -->
<g id="edge433" class="edge">
<title>layer4_expert1_up&#45;&gt;layer4_expert1_act</title>
<path fill="none" stroke="black" d="M1848.5,-19039.88C1848.5,-19031.78 1848.5,-19022.98 1848.5,-19014.47"/>
<polygon fill="black" stroke="black" points="1852,-19014.3 1848.5,-19004.3 1845,-19014.3 1852,-19014.3"/>
</g>
<!-- layer4_expert1_down -->
<g id="node309" class="node">
<title>layer4_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2252,-18900 1869,-18900 1869,-18832 2252,-18832 2252,-18900"/>
<text text-anchor="middle" x="2060.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2060.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2060.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2060.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_expert1_act&#45;&gt;layer4_expert1_down -->
<g id="edge434" class="edge">
<title>layer4_expert1_act&#45;&gt;layer4_expert1_down</title>
<path fill="none" stroke="black" d="M1917.33,-18935.88C1938.17,-18925.86 1961.21,-18914.77 1982.6,-18904.48"/>
<polygon fill="black" stroke="black" points="1984.16,-18907.61 1991.65,-18900.12 1981.12,-18901.31 1984.16,-18907.61"/>
</g>
<!-- layer4_expert1_down&#45;&gt;layer4_token_aggregation -->
<g id="edge435" class="edge">
<title>layer4_expert1_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M2252.34,-18855.27C2399.97,-18848.04 2609.11,-18838.37 2792.5,-18832 4207.85,-18782.81 5891.35,-18749.14 6629.29,-18735.63"/>
<polygon fill="black" stroke="black" points="6629.61,-18739.12 6639.54,-18735.44 6629.48,-18732.12 6629.61,-18739.12"/>
</g>
<!-- layer4_expert2_act -->
<g id="node312" class="node">
<title>layer4_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2872,-19004 2477,-19004 2477,-18936 2872,-18936 2872,-19004"/>
<text text-anchor="middle" x="2674.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2674.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2674.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2674.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_expert2_gate&#45;&gt;layer4_expert2_act -->
<g id="edge438" class="edge">
<title>layer4_expert2_gate&#45;&gt;layer4_expert2_act</title>
<path fill="none" stroke="black" d="M2395.3,-19039.95C2438.56,-19029.27 2486.7,-19017.38 2530.66,-19006.53"/>
<polygon fill="black" stroke="black" points="2531.69,-19009.88 2540.56,-19004.08 2530.01,-19003.08 2531.69,-19009.88"/>
</g>
<!-- layer4_expert2_up&#45;&gt;layer4_expert2_act -->
<g id="edge439" class="edge">
<title>layer4_expert2_up&#45;&gt;layer4_expert2_act</title>
<path fill="none" stroke="black" d="M2674.5,-19039.88C2674.5,-19031.78 2674.5,-19022.98 2674.5,-19014.47"/>
<polygon fill="black" stroke="black" points="2678,-19014.3 2674.5,-19004.3 2671,-19014.3 2678,-19014.3"/>
</g>
<!-- layer4_expert2_down -->
<g id="node313" class="node">
<title>layer4_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3185,-18900 2802,-18900 2802,-18832 3185,-18832 3185,-18900"/>
<text text-anchor="middle" x="2993.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2993.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2993.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2993.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_expert2_act&#45;&gt;layer4_expert2_down -->
<g id="edge440" class="edge">
<title>layer4_expert2_act&#45;&gt;layer4_expert2_down</title>
<path fill="none" stroke="black" d="M2778.07,-18935.88C2810.77,-18925.43 2847.07,-18913.82 2880.4,-18903.16"/>
<polygon fill="black" stroke="black" points="2881.72,-18906.42 2890.18,-18900.04 2879.59,-18899.75 2881.72,-18906.42"/>
</g>
<!-- layer4_expert2_down&#45;&gt;layer4_token_aggregation -->
<g id="edge441" class="edge">
<title>layer4_expert2_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M3185.28,-18857.07C3355.12,-18850.14 3609.79,-18839.96 3831.5,-18832 4845.81,-18795.58 6042.56,-18758.31 6635.65,-18740.22"/>
<polygon fill="black" stroke="black" points="6636.19,-18743.71 6646.08,-18739.9 6635.98,-18736.71 6636.19,-18743.71"/>
</g>
<!-- layer4_expert3_act -->
<g id="node316" class="node">
<title>layer4_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3698,-19004 3303,-19004 3303,-18936 3698,-18936 3698,-19004"/>
<text text-anchor="middle" x="3500.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3500.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3500.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3500.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_expert3_gate&#45;&gt;layer4_expert3_act -->
<g id="edge444" class="edge">
<title>layer4_expert3_gate&#45;&gt;layer4_expert3_act</title>
<path fill="none" stroke="black" d="M3221.3,-19039.95C3264.56,-19029.27 3312.7,-19017.38 3356.66,-19006.53"/>
<polygon fill="black" stroke="black" points="3357.69,-19009.88 3366.56,-19004.08 3356.01,-19003.08 3357.69,-19009.88"/>
</g>
<!-- layer4_expert3_up&#45;&gt;layer4_expert3_act -->
<g id="edge445" class="edge">
<title>layer4_expert3_up&#45;&gt;layer4_expert3_act</title>
<path fill="none" stroke="black" d="M3500.5,-19039.88C3500.5,-19031.78 3500.5,-19022.98 3500.5,-19014.47"/>
<polygon fill="black" stroke="black" points="3504,-19014.3 3500.5,-19004.3 3497,-19014.3 3504,-19014.3"/>
</g>
<!-- layer4_expert3_down -->
<g id="node317" class="node">
<title>layer4_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="4224,-18900 3841,-18900 3841,-18832 4224,-18832 4224,-18900"/>
<text text-anchor="middle" x="4032.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="4032.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4032.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4032.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_expert3_act&#45;&gt;layer4_expert3_down -->
<g id="edge446" class="edge">
<title>layer4_expert3_act&#45;&gt;layer4_expert3_down</title>
<path fill="none" stroke="black" d="M3672.86,-18935.95C3729.52,-18925.09 3792.68,-18912.98 3850.06,-18901.98"/>
<polygon fill="black" stroke="black" points="3850.8,-18905.4 3859.96,-18900.08 3849.48,-18898.53 3850.8,-18905.4"/>
</g>
<!-- layer4_expert3_down&#45;&gt;layer4_token_aggregation -->
<g id="edge447" class="edge">
<title>layer4_expert3_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M4224.19,-18848.05C4293.55,-18842.34 4372.51,-18836.33 4444.5,-18832 5222.75,-18785.21 6135.26,-18754.25 6634.39,-18739.34"/>
<polygon fill="black" stroke="black" points="6634.75,-18742.84 6644.64,-18739.04 6634.54,-18735.84 6634.75,-18742.84"/>
</g>
<!-- layer4_expert4_act -->
<g id="node320" class="node">
<title>layer4_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4524,-19004 4129,-19004 4129,-18936 4524,-18936 4524,-19004"/>
<text text-anchor="middle" x="4326.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4326.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4326.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4326.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_expert4_gate&#45;&gt;layer4_expert4_act -->
<g id="edge450" class="edge">
<title>layer4_expert4_gate&#45;&gt;layer4_expert4_act</title>
<path fill="none" stroke="black" d="M4047.3,-19039.95C4090.56,-19029.27 4138.7,-19017.38 4182.66,-19006.53"/>
<polygon fill="black" stroke="black" points="4183.69,-19009.88 4192.56,-19004.08 4182.01,-19003.08 4183.69,-19009.88"/>
</g>
<!-- layer4_expert4_up&#45;&gt;layer4_expert4_act -->
<g id="edge451" class="edge">
<title>layer4_expert4_up&#45;&gt;layer4_expert4_act</title>
<path fill="none" stroke="black" d="M4326.5,-19039.88C4326.5,-19031.78 4326.5,-19022.98 4326.5,-19014.47"/>
<polygon fill="black" stroke="black" points="4330,-19014.3 4326.5,-19004.3 4323,-19014.3 4330,-19014.3"/>
</g>
<!-- layer4_expert4_down -->
<g id="node321" class="node">
<title>layer4_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4837,-18900 4454,-18900 4454,-18832 4837,-18832 4837,-18900"/>
<text text-anchor="middle" x="4645.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4645.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4645.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4645.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_expert4_act&#45;&gt;layer4_expert4_down -->
<g id="edge452" class="edge">
<title>layer4_expert4_act&#45;&gt;layer4_expert4_down</title>
<path fill="none" stroke="black" d="M4430.07,-18935.88C4462.77,-18925.43 4499.07,-18913.82 4532.4,-18903.16"/>
<polygon fill="black" stroke="black" points="4533.72,-18906.42 4542.18,-18900.04 4531.59,-18899.75 4533.72,-18906.42"/>
</g>
<!-- layer4_expert4_down&#45;&gt;layer4_token_aggregation -->
<g id="edge453" class="edge">
<title>layer4_expert4_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M4837.3,-18852.54C4935.96,-18846.22 5058.16,-18838.52 5167.5,-18832 5681.41,-18801.37 6276.22,-18768.55 6647.2,-18748.4"/>
<polygon fill="black" stroke="black" points="6647.49,-18751.89 6657.28,-18747.85 6647.11,-18744.9 6647.49,-18751.89"/>
</g>
<!-- layer4_expert5_act -->
<g id="node324" class="node">
<title>layer4_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5350,-19004 4955,-19004 4955,-18936 5350,-18936 5350,-19004"/>
<text text-anchor="middle" x="5152.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5152.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5152.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5152.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_expert5_gate&#45;&gt;layer4_expert5_act -->
<g id="edge456" class="edge">
<title>layer4_expert5_gate&#45;&gt;layer4_expert5_act</title>
<path fill="none" stroke="black" d="M4873.3,-19039.95C4916.56,-19029.27 4964.7,-19017.38 5008.66,-19006.53"/>
<polygon fill="black" stroke="black" points="5009.69,-19009.88 5018.56,-19004.08 5008.01,-19003.08 5009.69,-19009.88"/>
</g>
<!-- layer4_expert5_up&#45;&gt;layer4_expert5_act -->
<g id="edge457" class="edge">
<title>layer4_expert5_up&#45;&gt;layer4_expert5_act</title>
<path fill="none" stroke="black" d="M5152.5,-19039.88C5152.5,-19031.78 5152.5,-19022.98 5152.5,-19014.47"/>
<polygon fill="black" stroke="black" points="5156,-19014.3 5152.5,-19004.3 5149,-19014.3 5156,-19014.3"/>
</g>
<!-- layer4_expert5_down -->
<g id="node325" class="node">
<title>layer4_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5560,-18900 5177,-18900 5177,-18832 5560,-18832 5560,-18900"/>
<text text-anchor="middle" x="5368.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5368.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5368.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5368.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_expert5_act&#45;&gt;layer4_expert5_down -->
<g id="edge458" class="edge">
<title>layer4_expert5_act&#45;&gt;layer4_expert5_down</title>
<path fill="none" stroke="black" d="M5222.63,-18935.88C5243.86,-18925.86 5267.33,-18914.77 5289.13,-18904.48"/>
<polygon fill="black" stroke="black" points="5290.81,-18907.56 5298.35,-18900.12 5287.82,-18901.23 5290.81,-18907.56"/>
</g>
<!-- layer4_expert5_down&#45;&gt;layer4_token_aggregation -->
<g id="edge459" class="edge">
<title>layer4_expert5_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M5560.12,-18849.1C5829.49,-18826.75 6324.61,-18785.66 6659.89,-18757.84"/>
<polygon fill="black" stroke="black" points="6660.58,-18761.3 6670.26,-18756.98 6660,-18754.32 6660.58,-18761.3"/>
</g>
<!-- layer4_expert6_act -->
<g id="node328" class="node">
<title>layer4_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6176,-19004 5781,-19004 5781,-18936 6176,-18936 6176,-19004"/>
<text text-anchor="middle" x="5978.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5978.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5978.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5978.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_expert6_gate&#45;&gt;layer4_expert6_act -->
<g id="edge462" class="edge">
<title>layer4_expert6_gate&#45;&gt;layer4_expert6_act</title>
<path fill="none" stroke="black" d="M5699.3,-19039.95C5742.56,-19029.27 5790.7,-19017.38 5834.66,-19006.53"/>
<polygon fill="black" stroke="black" points="5835.69,-19009.88 5844.56,-19004.08 5834.01,-19003.08 5835.69,-19009.88"/>
</g>
<!-- layer4_expert6_up&#45;&gt;layer4_expert6_act -->
<g id="edge463" class="edge">
<title>layer4_expert6_up&#45;&gt;layer4_expert6_act</title>
<path fill="none" stroke="black" d="M5978.5,-19039.88C5978.5,-19031.78 5978.5,-19022.98 5978.5,-19014.47"/>
<polygon fill="black" stroke="black" points="5982,-19014.3 5978.5,-19004.3 5975,-19014.3 5982,-19014.3"/>
</g>
<!-- layer4_expert6_down -->
<g id="node329" class="node">
<title>layer4_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6386,-18900 6003,-18900 6003,-18832 6386,-18832 6386,-18900"/>
<text text-anchor="middle" x="6194.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6194.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6194.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6194.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_expert6_act&#45;&gt;layer4_expert6_down -->
<g id="edge464" class="edge">
<title>layer4_expert6_act&#45;&gt;layer4_expert6_down</title>
<path fill="none" stroke="black" d="M6048.63,-18935.88C6069.86,-18925.86 6093.33,-18914.77 6115.13,-18904.48"/>
<polygon fill="black" stroke="black" points="6116.81,-18907.56 6124.35,-18900.12 6113.82,-18901.23 6116.81,-18907.56"/>
</g>
<!-- layer4_expert6_down&#45;&gt;layer4_token_aggregation -->
<g id="edge465" class="edge">
<title>layer4_expert6_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M6386.14,-18832.94C6477.66,-18817.63 6589.58,-18798.91 6693.09,-18781.59"/>
<polygon fill="black" stroke="black" points="6693.79,-18785.03 6703.08,-18779.92 6692.64,-18778.12 6693.79,-18785.03"/>
</g>
<!-- layer4_expert7_act -->
<g id="node332" class="node">
<title>layer4_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="7002,-19004 6607,-19004 6607,-18936 7002,-18936 7002,-19004"/>
<text text-anchor="middle" x="6804.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6804.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6804.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6804.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_expert7_gate&#45;&gt;layer4_expert7_act -->
<g id="edge468" class="edge">
<title>layer4_expert7_gate&#45;&gt;layer4_expert7_act</title>
<path fill="none" stroke="black" d="M6525.3,-19039.95C6568.56,-19029.27 6616.7,-19017.38 6660.66,-19006.53"/>
<polygon fill="black" stroke="black" points="6661.69,-19009.88 6670.56,-19004.08 6660.01,-19003.08 6661.69,-19009.88"/>
</g>
<!-- layer4_expert7_up&#45;&gt;layer4_expert7_act -->
<g id="edge469" class="edge">
<title>layer4_expert7_up&#45;&gt;layer4_expert7_act</title>
<path fill="none" stroke="black" d="M6804.5,-19039.88C6804.5,-19031.78 6804.5,-19022.98 6804.5,-19014.47"/>
<polygon fill="black" stroke="black" points="6808,-19014.3 6804.5,-19004.3 6801,-19014.3 6808,-19014.3"/>
</g>
<!-- layer4_expert7_down -->
<g id="node333" class="node">
<title>layer4_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6999,-18900 6616,-18900 6616,-18832 6999,-18832 6999,-18900"/>
<text text-anchor="middle" x="6807.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6807.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6807.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6807.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_expert7_act&#45;&gt;layer4_expert7_down -->
<g id="edge470" class="edge">
<title>layer4_expert7_act&#45;&gt;layer4_expert7_down</title>
<path fill="none" stroke="black" d="M6805.47,-18935.88C6805.71,-18927.78 6805.97,-18918.98 6806.22,-18910.47"/>
<polygon fill="black" stroke="black" points="6809.73,-18910.4 6806.52,-18900.3 6802.73,-18910.19 6809.73,-18910.4"/>
</g>
<!-- layer4_expert7_down&#45;&gt;layer4_token_aggregation -->
<g id="edge471" class="edge">
<title>layer4_expert7_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M6856.17,-18831.9C6869.63,-18822.75 6884.8,-18812.44 6900.2,-18801.97"/>
<polygon fill="black" stroke="black" points="6902.47,-18804.66 6908.77,-18796.14 6898.53,-18798.87 6902.47,-18804.66"/>
</g>
<!-- layer4_expert8_act -->
<g id="node336" class="node">
<title>layer4_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7415,-19004 7020,-19004 7020,-18936 7415,-18936 7415,-19004"/>
<text text-anchor="middle" x="7217.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7217.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7217.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7217.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_expert8_gate&#45;&gt;layer4_expert8_act -->
<g id="edge474" class="edge">
<title>layer4_expert8_gate&#45;&gt;layer4_expert8_act</title>
<path fill="none" stroke="black" d="M7217.5,-19039.88C7217.5,-19031.78 7217.5,-19022.98 7217.5,-19014.47"/>
<polygon fill="black" stroke="black" points="7221,-19014.3 7217.5,-19004.3 7214,-19014.3 7221,-19014.3"/>
</g>
<!-- layer4_expert8_up&#45;&gt;layer4_expert8_act -->
<g id="edge475" class="edge">
<title>layer4_expert8_up&#45;&gt;layer4_expert8_act</title>
<path fill="none" stroke="black" d="M7496.7,-19039.95C7453.44,-19029.27 7405.3,-19017.38 7361.34,-19006.53"/>
<polygon fill="black" stroke="black" points="7361.99,-19003.08 7351.44,-19004.08 7360.31,-19009.88 7361.99,-19003.08"/>
</g>
<!-- layer4_expert8_down -->
<g id="node337" class="node">
<title>layer4_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7406,-18900 7023,-18900 7023,-18832 7406,-18832 7406,-18900"/>
<text text-anchor="middle" x="7214.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7214.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7214.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7214.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_expert8_act&#45;&gt;layer4_expert8_down -->
<g id="edge476" class="edge">
<title>layer4_expert8_act&#45;&gt;layer4_expert8_down</title>
<path fill="none" stroke="black" d="M7216.53,-18935.88C7216.29,-18927.78 7216.03,-18918.98 7215.78,-18910.47"/>
<polygon fill="black" stroke="black" points="7219.27,-18910.19 7215.48,-18900.3 7212.27,-18910.4 7219.27,-18910.19"/>
</g>
<!-- layer4_expert8_down&#45;&gt;layer4_token_aggregation -->
<g id="edge477" class="edge">
<title>layer4_expert8_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M7164.13,-18831.9C7150.06,-18822.66 7134.2,-18812.25 7118.12,-18801.67"/>
<polygon fill="black" stroke="black" points="7119.97,-18798.7 7109.69,-18796.14 7116.12,-18804.55 7119.97,-18798.7"/>
</g>
<!-- layer4_expert9_act -->
<g id="node340" class="node">
<title>layer4_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8241,-19004 7846,-19004 7846,-18936 8241,-18936 8241,-19004"/>
<text text-anchor="middle" x="8043.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8043.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8043.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8043.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer4_expert9_gate&#45;&gt;layer4_expert9_act -->
<g id="edge480" class="edge">
<title>layer4_expert9_gate&#45;&gt;layer4_expert9_act</title>
<path fill="none" stroke="black" d="M8043.5,-19039.88C8043.5,-19031.78 8043.5,-19022.98 8043.5,-19014.47"/>
<polygon fill="black" stroke="black" points="8047,-19014.3 8043.5,-19004.3 8040,-19014.3 8047,-19014.3"/>
</g>
<!-- layer4_expert9_up&#45;&gt;layer4_expert9_act -->
<g id="edge481" class="edge">
<title>layer4_expert9_up&#45;&gt;layer4_expert9_act</title>
<path fill="none" stroke="black" d="M8322.7,-19039.95C8279.44,-19029.27 8231.3,-19017.38 8187.34,-19006.53"/>
<polygon fill="black" stroke="black" points="8187.99,-19003.08 8177.44,-19004.08 8186.31,-19009.88 8187.99,-19003.08"/>
</g>
<!-- layer4_expert9_down -->
<g id="node341" class="node">
<title>layer4_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8022,-18900 7639,-18900 7639,-18832 8022,-18832 8022,-18900"/>
<text text-anchor="middle" x="7830.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7830.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7830.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7830.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer4_expert9_act&#45;&gt;layer4_expert9_down -->
<g id="edge482" class="edge">
<title>layer4_expert9_act&#45;&gt;layer4_expert9_down</title>
<path fill="none" stroke="black" d="M7974.35,-18935.88C7953.41,-18925.86 7930.26,-18914.77 7908.77,-18904.48"/>
<polygon fill="black" stroke="black" points="7910.2,-18901.29 7899.67,-18900.12 7907.18,-18907.6 7910.2,-18901.29"/>
</g>
<!-- layer4_expert9_down&#45;&gt;layer4_token_aggregation -->
<g id="edge483" class="edge">
<title>layer4_expert9_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M7638.84,-18833.33C7573.96,-18822.61 7498.75,-18810.18 7423.34,-18797.72"/>
<polygon fill="black" stroke="black" points="7423.62,-18794.22 7413.19,-18796.04 7422.48,-18801.12 7423.62,-18794.22"/>
</g>
<!-- layer4_expert10_act -->
<g id="node344" class="node">
<title>layer4_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9067,-19004 8672,-19004 8672,-18936 9067,-18936 9067,-19004"/>
<text text-anchor="middle" x="8869.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8869.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8869.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8869.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_expert10_gate&#45;&gt;layer4_expert10_act -->
<g id="edge486" class="edge">
<title>layer4_expert10_gate&#45;&gt;layer4_expert10_act</title>
<path fill="none" stroke="black" d="M8869.5,-19039.88C8869.5,-19031.78 8869.5,-19022.98 8869.5,-19014.47"/>
<polygon fill="black" stroke="black" points="8873,-19014.3 8869.5,-19004.3 8866,-19014.3 8873,-19014.3"/>
</g>
<!-- layer4_expert10_up&#45;&gt;layer4_expert10_act -->
<g id="edge487" class="edge">
<title>layer4_expert10_up&#45;&gt;layer4_expert10_act</title>
<path fill="none" stroke="black" d="M9148.7,-19039.95C9105.44,-19029.27 9057.3,-19017.38 9013.34,-19006.53"/>
<polygon fill="black" stroke="black" points="9013.99,-19003.08 9003.44,-19004.08 9012.31,-19009.88 9013.99,-19003.08"/>
</g>
<!-- layer4_expert10_down -->
<g id="node345" class="node">
<title>layer4_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8743,-18900 8360,-18900 8360,-18832 8743,-18832 8743,-18900"/>
<text text-anchor="middle" x="8551.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8551.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8551.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8551.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_expert10_act&#45;&gt;layer4_expert10_down -->
<g id="edge488" class="edge">
<title>layer4_expert10_act&#45;&gt;layer4_expert10_down</title>
<path fill="none" stroke="black" d="M8766.25,-18935.88C8733.65,-18925.43 8697.47,-18913.82 8664.25,-18903.16"/>
<polygon fill="black" stroke="black" points="8665.09,-18899.76 8654.5,-18900.04 8662.95,-18906.42 8665.09,-18899.76"/>
</g>
<!-- layer4_expert10_down&#45;&gt;layer4_token_aggregation -->
<g id="edge489" class="edge">
<title>layer4_expert10_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M8359.85,-18848.12C8134.46,-18828.27 7752.98,-18794.66 7452.54,-18768.2"/>
<polygon fill="black" stroke="black" points="7452.61,-18764.69 7442.34,-18767.3 7451.99,-18771.67 7452.61,-18764.69"/>
</g>
<!-- layer4_expert11_act -->
<g id="node348" class="node">
<title>layer4_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9893,-19004 9498,-19004 9498,-18936 9893,-18936 9893,-19004"/>
<text text-anchor="middle" x="9695.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9695.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9695.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9695.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer4_expert11_gate&#45;&gt;layer4_expert11_act -->
<g id="edge492" class="edge">
<title>layer4_expert11_gate&#45;&gt;layer4_expert11_act</title>
<path fill="none" stroke="black" d="M9695.5,-19039.88C9695.5,-19031.78 9695.5,-19022.98 9695.5,-19014.47"/>
<polygon fill="black" stroke="black" points="9699,-19014.3 9695.5,-19004.3 9692,-19014.3 9699,-19014.3"/>
</g>
<!-- layer4_expert11_up&#45;&gt;layer4_expert11_act -->
<g id="edge493" class="edge">
<title>layer4_expert11_up&#45;&gt;layer4_expert11_act</title>
<path fill="none" stroke="black" d="M9974.7,-19039.95C9931.44,-19029.27 9883.3,-19017.38 9839.34,-19006.53"/>
<polygon fill="black" stroke="black" points="9839.99,-19003.08 9829.44,-19004.08 9838.31,-19009.88 9839.99,-19003.08"/>
</g>
<!-- layer4_expert11_down -->
<g id="node349" class="node">
<title>layer4_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9517,-18900 9134,-18900 9134,-18832 9517,-18832 9517,-18900"/>
<text text-anchor="middle" x="9325.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9325.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9325.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9325.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer4_expert11_act&#45;&gt;layer4_expert11_down -->
<g id="edge494" class="edge">
<title>layer4_expert11_act&#45;&gt;layer4_expert11_down</title>
<path fill="none" stroke="black" d="M9575.63,-18935.95C9537.2,-18925.36 9494.47,-18913.58 9455.36,-18902.8"/>
<polygon fill="black" stroke="black" points="9456.07,-18899.36 9445.5,-18900.08 9454.21,-18906.11 9456.07,-18899.36"/>
</g>
<!-- layer4_expert11_down&#45;&gt;layer4_token_aggregation -->
<g id="edge495" class="edge">
<title>layer4_expert11_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M9133.84,-18853.75C8762.82,-18831.99 7938.55,-18783.63 7432.2,-18753.92"/>
<polygon fill="black" stroke="black" points="7432.35,-18750.42 7422.17,-18753.33 7431.94,-18757.41 7432.35,-18750.42"/>
</g>
<!-- layer4_expert12_act -->
<g id="node352" class="node">
<title>layer4_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10719,-19004 10324,-19004 10324,-18936 10719,-18936 10719,-19004"/>
<text text-anchor="middle" x="10521.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10521.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10521.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10521.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_expert12_gate&#45;&gt;layer4_expert12_act -->
<g id="edge498" class="edge">
<title>layer4_expert12_gate&#45;&gt;layer4_expert12_act</title>
<path fill="none" stroke="black" d="M10521.5,-19039.88C10521.5,-19031.78 10521.5,-19022.98 10521.5,-19014.47"/>
<polygon fill="black" stroke="black" points="10525,-19014.3 10521.5,-19004.3 10518,-19014.3 10525,-19014.3"/>
</g>
<!-- layer4_expert12_up&#45;&gt;layer4_expert12_act -->
<g id="edge499" class="edge">
<title>layer4_expert12_up&#45;&gt;layer4_expert12_act</title>
<path fill="none" stroke="black" d="M10800.7,-19039.95C10757.44,-19029.27 10709.3,-19017.38 10665.34,-19006.53"/>
<polygon fill="black" stroke="black" points="10665.99,-19003.08 10655.44,-19004.08 10664.31,-19009.88 10665.99,-19003.08"/>
</g>
<!-- layer4_expert12_down -->
<g id="node353" class="node">
<title>layer4_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10317,-18900 9934,-18900 9934,-18832 10317,-18832 10317,-18900"/>
<text text-anchor="middle" x="10125.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10125.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10125.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10125.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_expert12_act&#45;&gt;layer4_expert12_down -->
<g id="edge500" class="edge">
<title>layer4_expert12_act&#45;&gt;layer4_expert12_down</title>
<path fill="none" stroke="black" d="M10393.2,-18935.95C10351.81,-18925.29 10305.76,-18913.43 10263.69,-18902.59"/>
<polygon fill="black" stroke="black" points="10264.49,-18899.19 10253.93,-18900.08 10262.74,-18905.96 10264.49,-18899.19"/>
</g>
<!-- layer4_expert12_down&#45;&gt;layer4_token_aggregation -->
<g id="edge501" class="edge">
<title>layer4_expert12_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M9933.67,-18853.74C9816.15,-18847.01 9662.65,-18838.53 9526.5,-18832 8783.75,-18796.36 7917.41,-18762.66 7418.65,-18744.02"/>
<polygon fill="black" stroke="black" points="7418.53,-18740.52 7408.41,-18743.64 7418.27,-18747.51 7418.53,-18740.52"/>
</g>
<!-- layer4_expert13_act -->
<g id="node356" class="node">
<title>layer4_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11545,-19004 11150,-19004 11150,-18936 11545,-18936 11545,-19004"/>
<text text-anchor="middle" x="11347.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11347.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11347.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11347.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer4_expert13_gate&#45;&gt;layer4_expert13_act -->
<g id="edge504" class="edge">
<title>layer4_expert13_gate&#45;&gt;layer4_expert13_act</title>
<path fill="none" stroke="black" d="M11347.5,-19039.88C11347.5,-19031.78 11347.5,-19022.98 11347.5,-19014.47"/>
<polygon fill="black" stroke="black" points="11351,-19014.3 11347.5,-19004.3 11344,-19014.3 11351,-19014.3"/>
</g>
<!-- layer4_expert13_up&#45;&gt;layer4_expert13_act -->
<g id="edge505" class="edge">
<title>layer4_expert13_up&#45;&gt;layer4_expert13_act</title>
<path fill="none" stroke="black" d="M11626.7,-19039.95C11583.44,-19029.27 11535.3,-19017.38 11491.34,-19006.53"/>
<polygon fill="black" stroke="black" points="11491.99,-19003.08 11481.44,-19004.08 11490.31,-19009.88 11491.99,-19003.08"/>
</g>
<!-- layer4_expert13_down -->
<g id="node357" class="node">
<title>layer4_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11130,-18900 10747,-18900 10747,-18832 11130,-18832 11130,-18900"/>
<text text-anchor="middle" x="10938.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10938.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10938.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10938.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer4_expert13_act&#45;&gt;layer4_expert13_down -->
<g id="edge506" class="edge">
<title>layer4_expert13_act&#45;&gt;layer4_expert13_down</title>
<path fill="none" stroke="black" d="M11214.99,-18935.95C11172.15,-18925.27 11124.48,-18913.38 11080.95,-18902.53"/>
<polygon fill="black" stroke="black" points="11081.7,-18899.1 11071.15,-18900.08 11080,-18905.9 11081.7,-18899.1"/>
</g>
<!-- layer4_expert13_down&#45;&gt;layer4_token_aggregation -->
<g id="edge507" class="edge">
<title>layer4_expert13_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M10746.98,-18853.55C10626.35,-18846.61 10467.36,-18837.98 10326.5,-18832 9275.09,-18787.34 8035.53,-18754 7410.76,-18738.54"/>
<polygon fill="black" stroke="black" points="7410.78,-18735.04 7400.69,-18738.3 7410.6,-18742.04 7410.78,-18735.04"/>
</g>
<!-- layer4_expert14_act -->
<g id="node360" class="node">
<title>layer4_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12371,-19004 11976,-19004 11976,-18936 12371,-18936 12371,-19004"/>
<text text-anchor="middle" x="12173.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12173.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12173.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12173.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_expert14_gate&#45;&gt;layer4_expert14_act -->
<g id="edge510" class="edge">
<title>layer4_expert14_gate&#45;&gt;layer4_expert14_act</title>
<path fill="none" stroke="black" d="M12173.5,-19039.88C12173.5,-19031.78 12173.5,-19022.98 12173.5,-19014.47"/>
<polygon fill="black" stroke="black" points="12177,-19014.3 12173.5,-19004.3 12170,-19014.3 12177,-19014.3"/>
</g>
<!-- layer4_expert14_up&#45;&gt;layer4_expert14_act -->
<g id="edge511" class="edge">
<title>layer4_expert14_up&#45;&gt;layer4_expert14_act</title>
<path fill="none" stroke="black" d="M12452.7,-19039.95C12409.44,-19029.27 12361.3,-19017.38 12317.34,-19006.53"/>
<polygon fill="black" stroke="black" points="12317.99,-19003.08 12307.44,-19004.08 12316.31,-19009.88 12317.99,-19003.08"/>
</g>
<!-- layer4_expert14_down -->
<g id="node361" class="node">
<title>layer4_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11949,-18900 11566,-18900 11566,-18832 11949,-18832 11949,-18900"/>
<text text-anchor="middle" x="11757.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11757.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11757.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11757.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_expert14_act&#45;&gt;layer4_expert14_down -->
<g id="edge512" class="edge">
<title>layer4_expert14_act&#45;&gt;layer4_expert14_down</title>
<path fill="none" stroke="black" d="M12038.72,-18935.95C11995.15,-18925.27 11946.66,-18913.38 11902.39,-18902.53"/>
<polygon fill="black" stroke="black" points="11902.96,-18899.06 11892.42,-18900.08 11901.3,-18905.86 11902.96,-18899.06"/>
</g>
<!-- layer4_expert14_down&#45;&gt;layer4_token_aggregation -->
<g id="edge513" class="edge">
<title>layer4_expert14_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M11565.83,-18853.36C11443.82,-18846.3 11282.43,-18837.6 11139.5,-18832 9769.85,-18778.37 8143.66,-18747.43 7406.32,-18735.17"/>
<polygon fill="black" stroke="black" points="7406.12,-18731.67 7396.07,-18735 7406.01,-18738.67 7406.12,-18731.67"/>
</g>
<!-- layer4_expert15_act -->
<g id="node364" class="node">
<title>layer4_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13197,-19004 12802,-19004 12802,-18936 13197,-18936 13197,-19004"/>
<text text-anchor="middle" x="12999.5" y="-18988.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12999.5" y="-18973.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12999.5" y="-18958.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12999.5" y="-18943.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer4_expert15_gate&#45;&gt;layer4_expert15_act -->
<g id="edge516" class="edge">
<title>layer4_expert15_gate&#45;&gt;layer4_expert15_act</title>
<path fill="none" stroke="black" d="M12999.5,-19039.88C12999.5,-19031.78 12999.5,-19022.98 12999.5,-19014.47"/>
<polygon fill="black" stroke="black" points="13003,-19014.3 12999.5,-19004.3 12996,-19014.3 13003,-19014.3"/>
</g>
<!-- layer4_expert15_up&#45;&gt;layer4_expert15_act -->
<g id="edge517" class="edge">
<title>layer4_expert15_up&#45;&gt;layer4_expert15_act</title>
<path fill="none" stroke="black" d="M13278.7,-19039.95C13235.44,-19029.27 13187.3,-19017.38 13143.34,-19006.53"/>
<polygon fill="black" stroke="black" points="13143.99,-19003.08 13133.44,-19004.08 13142.31,-19009.88 13143.99,-19003.08"/>
</g>
<!-- layer4_expert15_down -->
<g id="node365" class="node">
<title>layer4_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12772,-18900 12389,-18900 12389,-18832 12772,-18832 12772,-18900"/>
<text text-anchor="middle" x="12580.5" y="-18884.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12580.5" y="-18869.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12580.5" y="-18854.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12580.5" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer4_expert15_act&#45;&gt;layer4_expert15_down -->
<g id="edge518" class="edge">
<title>layer4_expert15_act&#45;&gt;layer4_expert15_down</title>
<path fill="none" stroke="black" d="M12863.75,-18935.95C12819.77,-18925.25 12770.82,-18913.33 12726.15,-18902.46"/>
<polygon fill="black" stroke="black" points="12726.93,-18899.05 12716.39,-18900.08 12725.28,-18905.85 12726.93,-18899.05"/>
</g>
<!-- layer4_expert15_down&#45;&gt;layer4_token_aggregation -->
<g id="edge519" class="edge">
<title>layer4_expert15_down&#45;&gt;layer4_token_aggregation</title>
<path fill="none" stroke="black" d="M12388.98,-18853.24C12266.02,-18846.09 12102.9,-18837.33 11958.5,-18832 10264.24,-18769.45 8242.33,-18742.15 7402.93,-18732.91"/>
<polygon fill="black" stroke="black" points="7402.84,-18729.4 7392.8,-18732.79 7402.76,-18736.4 7402.84,-18729.4"/>
</g>
<!-- layer4_res2 -->
<g id="node367" class="node">
<title>layer4_res2</title>
<polygon fill="none" stroke="black" points="7448.24,-18624 6747.12,-18624 6566.76,-18458 7267.88,-18458 7448.24,-18624"/>
<text text-anchor="middle" x="7007.5" y="-18567.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7007.5" y="-18552.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18537.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18522.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18507.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_token_aggregation&#45;&gt;layer4_res2 -->
<g id="edge520" class="edge">
<title>layer4_token_aggregation&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M7007.5,-18659.95C7007.5,-18651.63 7007.5,-18643 7007.5,-18634.38"/>
<polygon fill="black" stroke="black" points="7011,-18634.28 7007.5,-18624.28 7004,-18634.28 7011,-18634.28"/>
</g>
<!-- layer5_mha_qkv -->
<g id="node368" class="node">
<title>layer5_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7243.5,-18422 6771.5,-18422 6771.5,-18354 7243.5,-18354 7243.5,-18422"/>
<text text-anchor="middle" x="7007.5" y="-18406.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7007.5" y="-18391.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18376.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7007.5" y="-18361.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_res2&#45;&gt;layer5_mha_qkv -->
<g id="edge521" class="edge">
<title>layer4_res2&#45;&gt;layer5_mha_qkv</title>
<path fill="none" stroke="black" d="M7007.5,-18457.87C7007.5,-18449.12 7007.5,-18440.48 7007.5,-18432.45"/>
<polygon fill="black" stroke="black" points="7011,-18432.26 7007.5,-18422.26 7004,-18432.26 7011,-18432.26"/>
</g>
<!-- layer5_mha_attn -->
<g id="node369" class="node">
<title>layer5_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7237.5,-18318 6777.5,-18318 6777.5,-18250 7237.5,-18250 7237.5,-18318"/>
<text text-anchor="middle" x="7007.5" y="-18302.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7007.5" y="-18287.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7007.5" y="-18272.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18257.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_mha_qkv&#45;&gt;layer5_mha_attn -->
<g id="edge522" class="edge">
<title>layer5_mha_qkv&#45;&gt;layer5_mha_attn</title>
<path fill="none" stroke="black" d="M7007.5,-18353.88C7007.5,-18345.78 7007.5,-18336.98 7007.5,-18328.47"/>
<polygon fill="black" stroke="black" points="7011,-18328.3 7007.5,-18318.3 7004,-18328.3 7011,-18328.3"/>
</g>
<!-- layer5_mha_out -->
<g id="node370" class="node">
<title>layer5_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7220,-18214 6795,-18214 6795,-18146 7220,-18146 7220,-18214"/>
<text text-anchor="middle" x="7007.5" y="-18198.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7007.5" y="-18183.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18168.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18153.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_mha_attn&#45;&gt;layer5_mha_out -->
<g id="edge523" class="edge">
<title>layer5_mha_attn&#45;&gt;layer5_mha_out</title>
<path fill="none" stroke="black" d="M7007.5,-18249.88C7007.5,-18241.78 7007.5,-18232.98 7007.5,-18224.47"/>
<polygon fill="black" stroke="black" points="7011,-18224.3 7007.5,-18214.3 7004,-18224.3 7011,-18224.3"/>
</g>
<!-- layer5_res1 -->
<g id="node371" class="node">
<title>layer5_res1</title>
<polygon fill="none" stroke="black" points="7448.24,-18110 6747.12,-18110 6566.76,-17944 7267.88,-17944 7448.24,-18110"/>
<text text-anchor="middle" x="7007.5" y="-18053.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7007.5" y="-18038.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18023.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-18008.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-17993.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_mha_out&#45;&gt;layer5_res1 -->
<g id="edge524" class="edge">
<title>layer5_mha_out&#45;&gt;layer5_res1</title>
<path fill="none" stroke="black" d="M7007.5,-18145.86C7007.5,-18138.1 7007.5,-18129.46 7007.5,-18120.48"/>
<polygon fill="black" stroke="black" points="7011,-18120.23 7007.5,-18110.23 7004,-18120.23 7011,-18120.23"/>
</g>
<!-- layer5_ln1 -->
<g id="node372" class="node">
<title>layer5_ln1</title>
<polygon fill="yellow" stroke="black" points="7220,-17908 6795,-17908 6795,-17840 7220,-17840 7220,-17908"/>
<text text-anchor="middle" x="7007.5" y="-17892.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7007.5" y="-17877.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-17862.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-17847.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_res1&#45;&gt;layer5_ln1 -->
<g id="edge525" class="edge">
<title>layer5_res1&#45;&gt;layer5_ln1</title>
<path fill="none" stroke="black" d="M7007.5,-17943.87C7007.5,-17935.12 7007.5,-17926.48 7007.5,-17918.45"/>
<polygon fill="black" stroke="black" points="7011,-17918.26 7007.5,-17908.26 7004,-17918.26 7011,-17918.26"/>
</g>
<!-- layer5_expert_routing -->
<g id="node373" class="node">
<title>layer5_expert_routing</title>
<polygon fill="orange" stroke="black" points="7007.5,-17804 6591.5,-17721 7007.5,-17638 7423.5,-17721 7007.5,-17804"/>
<text text-anchor="middle" x="7007.5" y="-17747.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7007.5" y="-17732.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7007.5" y="-17717.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-17702.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7007.5" y="-17687.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_ln1&#45;&gt;layer5_expert_routing -->
<g id="edge526" class="edge">
<title>layer5_ln1&#45;&gt;layer5_expert_routing</title>
<path fill="none" stroke="black" d="M7007.5,-17839.86C7007.5,-17832.1 7007.5,-17823.46 7007.5,-17814.48"/>
<polygon fill="black" stroke="black" points="7011,-17814.23 7007.5,-17804.23 7004,-17814.23 7011,-17814.23"/>
</g>
<!-- layer5_token_distribution -->
<g id="node374" class="node">
<title>layer5_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7435.86,-17602 6754.44,-17602 6579.14,-17466 7260.56,-17466 7435.86,-17602"/>
<text text-anchor="middle" x="7007.5" y="-17552.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7007.5" y="-17537.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7007.5" y="-17522.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7007.5" y="-17507.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer5_expert_routing&#45;&gt;layer5_token_distribution -->
<g id="edge527" class="edge">
<title>layer5_expert_routing&#45;&gt;layer5_token_distribution</title>
<path fill="none" stroke="black" d="M7007.5,-17637.78C7007.5,-17629.34 7007.5,-17620.79 7007.5,-17612.4"/>
<polygon fill="black" stroke="black" points="7011,-17612.28 7007.5,-17602.28 7004,-17612.28 7011,-17612.28"/>
</g>
<!-- layer5_expert0_gate -->
<g id="node375" class="node">
<title>layer5_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="804,-17430 409,-17430 409,-17362 804,-17362 804,-17430"/>
<text text-anchor="middle" x="606.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="606.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="606.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="606.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert0_gate -->
<g id="edge528" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6666.42,-17533.72C5545.99,-17535.09 1984.01,-17531.23 814.31,-17430.11"/>
<polygon fill="black" stroke="black" points="814.32,-17426.6 804.06,-17429.22 813.71,-17433.57 814.32,-17426.6"/>
</g>
<!-- layer5_expert0_up -->
<g id="node376" class="node">
<title>layer5_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1217,-17430 822,-17430 822,-17362 1217,-17362 1217,-17430"/>
<text text-anchor="middle" x="1019.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1019.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1019.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1019.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert0_up -->
<g id="edge529" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6665.42,-17533.24C5594.28,-17533 2312.27,-17524.44 1227.35,-17430.12"/>
<polygon fill="black" stroke="black" points="1227.32,-17426.6 1217.06,-17429.21 1226.71,-17433.57 1227.32,-17426.6"/>
</g>
<!-- layer5_expert1_gate -->
<g id="node379" class="node">
<title>layer5_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1630,-17430 1235,-17430 1235,-17362 1630,-17362 1630,-17430"/>
<text text-anchor="middle" x="1432.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1432.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1432.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1432.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert1_gate -->
<g id="edge534" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6664.86,-17532.69C5645.38,-17530.77 2640.69,-17517.69 1640.28,-17430.11"/>
<polygon fill="black" stroke="black" points="1640.33,-17426.6 1630.06,-17429.21 1639.71,-17433.57 1640.33,-17426.6"/>
</g>
<!-- layer5_expert1_up -->
<g id="node380" class="node">
<title>layer5_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2043,-17430 1648,-17430 1648,-17362 2043,-17362 2043,-17430"/>
<text text-anchor="middle" x="1845.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1845.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1845.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1845.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert1_up -->
<g id="edge535" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6663.92,-17532.04C5697.86,-17528.35 2969.03,-17510.95 2053.08,-17430.09"/>
<polygon fill="black" stroke="black" points="2053.33,-17426.6 2043.06,-17429.2 2052.71,-17433.58 2053.33,-17426.6"/>
</g>
<!-- layer5_expert2_gate -->
<g id="node383" class="node">
<title>layer5_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2456,-17430 2061,-17430 2061,-17362 2456,-17362 2456,-17430"/>
<text text-anchor="middle" x="2258.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2258.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2258.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2258.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert2_gate -->
<g id="edge540" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6662.93,-17531.27C5752.78,-17525.72 3298.04,-17504.22 2466.07,-17430.1"/>
<polygon fill="black" stroke="black" points="2466.33,-17426.6 2456.06,-17429.19 2465.7,-17433.58 2466.33,-17426.6"/>
</g>
<!-- layer5_expert2_up -->
<g id="node384" class="node">
<title>layer5_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2869,-17430 2474,-17430 2474,-17362 2869,-17362 2869,-17430"/>
<text text-anchor="middle" x="2671.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2671.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2671.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2671.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert2_up -->
<g id="edge541" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6661.99,-17530.34C5810.65,-17522.84 3627.62,-17497.52 2879.16,-17430.1"/>
<polygon fill="black" stroke="black" points="2879.34,-17426.61 2869.06,-17429.18 2878.7,-17433.58 2879.34,-17426.61"/>
</g>
<!-- layer5_expert3_gate -->
<g id="node387" class="node">
<title>layer5_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3282,-17430 2887,-17430 2887,-17362 3282,-17362 3282,-17430"/>
<text text-anchor="middle" x="3084.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3084.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3084.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3084.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert3_gate -->
<g id="edge546" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6660.41,-17529.2C5870.73,-17519.62 3957.42,-17490.84 3292.24,-17430.11"/>
<polygon fill="black" stroke="black" points="3292.34,-17426.61 3282.06,-17429.17 3291.7,-17433.58 3292.34,-17426.61"/>
</g>
<!-- layer5_expert3_up -->
<g id="node388" class="node">
<title>layer5_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3695,-17430 3300,-17430 3300,-17362 3695,-17362 3695,-17430"/>
<text text-anchor="middle" x="3497.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3497.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3497.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3497.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert3_up -->
<g id="edge547" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6658.52,-17527.77C5934.21,-17515.98 4287.46,-17484.17 3705.25,-17430.12"/>
<polygon fill="black" stroke="black" points="3705.35,-17426.61 3695.06,-17429.16 3704.69,-17433.58 3705.35,-17426.61"/>
</g>
<!-- layer5_expert4_gate -->
<g id="node391" class="node">
<title>layer5_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4108,-17430 3713,-17430 3713,-17362 4108,-17362 4108,-17430"/>
<text text-anchor="middle" x="3910.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3910.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3910.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3910.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert4_gate -->
<g id="edge552" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6656.06,-17525.9C6001.59,-17511.8 4617.94,-17477.52 4118.26,-17430.12"/>
<polygon fill="black" stroke="black" points="4118.35,-17426.62 4108.06,-17429.14 4117.68,-17433.58 4118.35,-17426.62"/>
</g>
<!-- layer5_expert4_up -->
<g id="node392" class="node">
<title>layer5_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4521,-17430 4126,-17430 4126,-17362 4521,-17362 4521,-17430"/>
<text text-anchor="middle" x="4323.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4323.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4323.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4323.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert4_up -->
<g id="edge553" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6663.37,-17531.42C6186.11,-17526.35 5296.47,-17506.49 4531.19,-17430.13"/>
<polygon fill="black" stroke="black" points="4531.36,-17426.63 4521.07,-17429.12 4530.67,-17433.6 4531.36,-17426.63"/>
</g>
<!-- layer5_expert5_gate -->
<g id="node395" class="node">
<title>layer5_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4934,-17430 4539,-17430 4539,-17362 4934,-17362 4934,-17430"/>
<text text-anchor="middle" x="4736.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4736.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4736.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4736.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert5_gate -->
<g id="edge558" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.68,-17527.16C6248.56,-17517.67 5551.04,-17493.18 4944.34,-17430.16"/>
<polygon fill="black" stroke="black" points="4944.38,-17426.64 4934.07,-17429.09 4943.65,-17433.61 4944.38,-17426.64"/>
</g>
<!-- layer5_expert5_up -->
<g id="node396" class="node">
<title>layer5_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5347,-17430 4952,-17430 4952,-17362 5347,-17362 5347,-17430"/>
<text text-anchor="middle" x="5149.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5149.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5149.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5149.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert5_up -->
<g id="edge559" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6649.34,-17520.65C6316.6,-17506.84 5807.32,-17479.72 5357.03,-17430.14"/>
<polygon fill="black" stroke="black" points="5357.4,-17426.66 5347.07,-17429.04 5356.63,-17433.62 5357.4,-17426.66"/>
</g>
<!-- layer5_expert6_gate -->
<g id="node399" class="node">
<title>layer5_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5760,-17430 5365,-17430 5365,-17362 5760,-17362 5760,-17430"/>
<text text-anchor="middle" x="5562.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5562.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5562.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5562.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert6_gate -->
<g id="edge564" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6635.03,-17509.44C6391.4,-17492.23 6066.1,-17465.86 5770.16,-17430.18"/>
<polygon fill="black" stroke="black" points="5770.43,-17426.68 5760.08,-17428.96 5769.59,-17433.63 5770.43,-17426.68"/>
</g>
<!-- layer5_expert6_up -->
<g id="node400" class="node">
<title>layer5_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6173,-17430 5778,-17430 5778,-17362 6173,-17362 6173,-17430"/>
<text text-anchor="middle" x="5975.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5975.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5975.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5975.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert6_up -->
<g id="edge565" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6604.33,-17485.57C6472.89,-17469.37 6326.08,-17450.49 6183.37,-17430.25"/>
<polygon fill="black" stroke="black" points="6183.5,-17426.74 6173.11,-17428.79 6182.51,-17433.67 6183.5,-17426.74"/>
</g>
<!-- layer5_expert7_gate -->
<g id="node403" class="node">
<title>layer5_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6586,-17430 6191,-17430 6191,-17362 6586,-17362 6586,-17430"/>
<text text-anchor="middle" x="6388.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6388.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6388.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6388.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert7_gate -->
<g id="edge570" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6702.53,-17466C6649.4,-17454.32 6596.09,-17442.61 6548.86,-17432.23"/>
<polygon fill="black" stroke="black" points="6549.4,-17428.77 6538.88,-17430.04 6547.89,-17435.6 6549.4,-17428.77"/>
</g>
<!-- layer5_expert7_up -->
<g id="node404" class="node">
<title>layer5_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6999,-17430 6604,-17430 6604,-17362 6999,-17362 6999,-17430"/>
<text text-anchor="middle" x="6801.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6801.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6801.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6801.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert7_up -->
<g id="edge571" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6906.01,-17466C6890.37,-17455.67 6874.68,-17445.31 6860.38,-17435.87"/>
<polygon fill="black" stroke="black" points="6861.95,-17432.72 6851.68,-17430.13 6858.1,-17438.56 6861.95,-17432.72"/>
</g>
<!-- layer5_expert8_gate -->
<g id="node407" class="node">
<title>layer5_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7412,-17430 7017,-17430 7017,-17362 7412,-17362 7412,-17430"/>
<text text-anchor="middle" x="7214.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7214.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7214.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7214.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert8_gate -->
<g id="edge576" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7109.48,-17466C7125.2,-17455.67 7140.97,-17445.31 7155.33,-17435.87"/>
<polygon fill="black" stroke="black" points="7157.64,-17438.54 7164.08,-17430.13 7153.8,-17432.69 7157.64,-17438.54"/>
</g>
<!-- layer5_expert8_up -->
<g id="node408" class="node">
<title>layer5_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7825,-17430 7430,-17430 7430,-17362 7825,-17362 7825,-17430"/>
<text text-anchor="middle" x="7627.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7627.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7627.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7627.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert8_up -->
<g id="edge577" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7272.23,-17474.93C7338.49,-17460.4 7407.56,-17445.25 7466.99,-17432.21"/>
<polygon fill="black" stroke="black" points="7467.81,-17435.61 7476.82,-17430.05 7466.31,-17428.78 7467.81,-17435.61"/>
</g>
<!-- layer5_expert9_gate -->
<g id="node411" class="node">
<title>layer5_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8238,-17430 7843,-17430 7843,-17362 8238,-17362 8238,-17430"/>
<text text-anchor="middle" x="8040.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8040.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8040.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8040.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert9_gate -->
<g id="edge582" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7303.03,-17498.73C7458.07,-17480.13 7651.37,-17455.94 7832.89,-17430.22"/>
<polygon fill="black" stroke="black" points="7833.49,-17433.67 7842.89,-17428.8 7832.5,-17426.74 7833.49,-17433.67"/>
</g>
<!-- layer5_expert9_up -->
<g id="node412" class="node">
<title>layer5_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8651,-17430 8256,-17430 8256,-17362 8651,-17362 8651,-17430"/>
<text text-anchor="middle" x="8453.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8453.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8453.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8453.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert9_up -->
<g id="edge583" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.91,-17513.51C7570.39,-17496.52 7926.09,-17468.72 8245.99,-17430.16"/>
<polygon fill="black" stroke="black" points="8246.41,-17433.63 8255.92,-17428.96 8245.57,-17426.68 8246.41,-17433.63"/>
</g>
<!-- layer5_expert10_gate -->
<g id="node415" class="node">
<title>layer5_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9064,-17430 8669,-17430 8669,-17362 9064,-17362 9064,-17430"/>
<text text-anchor="middle" x="8866.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8866.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8866.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8866.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert10_gate -->
<g id="edge588" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7332.93,-17522.01C7664.51,-17508.65 8193.55,-17481.38 8658.98,-17430.14"/>
<polygon fill="black" stroke="black" points="8659.37,-17433.62 8668.93,-17429.04 8658.6,-17426.66 8659.37,-17433.62"/>
</g>
<!-- layer5_expert10_up -->
<g id="node416" class="node">
<title>layer5_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9477,-17430 9082,-17430 9082,-17362 9477,-17362 9477,-17430"/>
<text text-anchor="middle" x="9279.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9279.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9279.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9279.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert10_up -->
<g id="edge589" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7340.24,-17527.57C7747.05,-17518.37 8456.4,-17494.08 9071.97,-17430.13"/>
<polygon fill="black" stroke="black" points="9072.35,-17433.61 9081.93,-17429.09 9071.62,-17426.64 9072.35,-17433.61"/>
</g>
<!-- layer5_expert11_gate -->
<g id="node419" class="node">
<title>layer5_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9890,-17430 9495,-17430 9495,-17362 9890,-17362 9890,-17430"/>
<text text-anchor="middle" x="9692.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9692.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9692.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9692.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert11_gate -->
<g id="edge594" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345.2,-17531.5C7821.01,-17526.55 8715.7,-17506.86 9484.76,-17430.14"/>
<polygon fill="black" stroke="black" points="9485.33,-17433.6 9494.93,-17429.12 9484.64,-17426.63 9485.33,-17433.6"/>
</g>
<!-- layer5_expert11_up -->
<g id="node420" class="node">
<title>layer5_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10303,-17430 9908,-17430 9908,-17362 10303,-17362 10303,-17430"/>
<text text-anchor="middle" x="10105.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10105.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10105.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10105.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert11_up -->
<g id="edge595" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.5,-17526.35C7984.28,-17512.53 9392.47,-17478.03 9897.63,-17430.13"/>
<polygon fill="black" stroke="black" points="9898.32,-17433.58 9907.94,-17429.14 9897.65,-17426.62 9898.32,-17433.58"/>
</g>
<!-- layer5_expert12_gate -->
<g id="node423" class="node">
<title>layer5_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10716,-17430 10321,-17430 10321,-17362 10716,-17362 10716,-17430"/>
<text text-anchor="middle" x="10518.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10518.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10518.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10518.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert12_gate -->
<g id="edge600" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7340.83,-17528.02C8056.92,-17516.46 9724.02,-17484.58 10310.68,-17430.13"/>
<polygon fill="black" stroke="black" points="10311.31,-17433.58 10320.94,-17429.16 10310.65,-17426.61 10311.31,-17433.58"/>
</g>
<!-- layer5_expert12_up -->
<g id="node424" class="node">
<title>layer5_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11129,-17430 10734,-17430 10734,-17362 11129,-17362 11129,-17430"/>
<text text-anchor="middle" x="10931.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10931.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10931.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10931.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert12_up -->
<g id="edge601" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7342.57,-17529.35C8124.82,-17519.92 10054.91,-17491.16 10723.7,-17430.12"/>
<polygon fill="black" stroke="black" points="10724.3,-17433.58 10733.94,-17429.17 10723.66,-17426.61 10724.3,-17433.58"/>
</g>
<!-- layer5_expert13_gate -->
<g id="node427" class="node">
<title>layer5_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11542,-17430 11147,-17430 11147,-17362 11542,-17362 11542,-17430"/>
<text text-anchor="middle" x="11344.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11344.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11344.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11344.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert13_gate -->
<g id="edge606" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7343.74,-17530.43C8188.52,-17523.03 10385.4,-17497.78 11136.8,-17430.11"/>
<polygon fill="black" stroke="black" points="11137.3,-17433.58 11146.94,-17429.18 11136.66,-17426.61 11137.3,-17433.58"/>
</g>
<!-- layer5_expert13_up -->
<g id="node428" class="node">
<title>layer5_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11955,-17430 11560,-17430 11560,-17362 11955,-17362 11955,-17430"/>
<text text-anchor="middle" x="11757.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11757.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11757.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11757.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert13_up -->
<g id="edge607" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345.14,-17531.31C8249.83,-17525.84 10715.6,-17504.43 11549.9,-17430.1"/>
<polygon fill="black" stroke="black" points="11550.3,-17433.58 11559.94,-17429.19 11549.67,-17426.6 11550.3,-17433.58"/>
</g>
<!-- layer5_expert14_gate -->
<g id="node431" class="node">
<title>layer5_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12368,-17430 11973,-17430 11973,-17362 12368,-17362 12368,-17430"/>
<text text-anchor="middle" x="12170.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12170.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12170.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12170.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert14_gate -->
<g id="edge612" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345.95,-17532.06C8307.58,-17528.42 11045.12,-17511.11 11962.9,-17430.1"/>
<polygon fill="black" stroke="black" points="11963.29,-17433.58 11972.94,-17429.2 11962.67,-17426.6 11963.29,-17433.58"/>
</g>
<!-- layer5_expert14_up -->
<g id="node432" class="node">
<title>layer5_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12781,-17430 12386,-17430 12386,-17362 12781,-17362 12781,-17430"/>
<text text-anchor="middle" x="12583.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12583.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12583.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12583.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert14_up -->
<g id="edge613" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7346.58,-17532.7C8362.74,-17530.8 11373.92,-17517.81 12375.71,-17430.11"/>
<polygon fill="black" stroke="black" points="12376.29,-17433.57 12385.94,-17429.21 12375.67,-17426.6 12376.29,-17433.57"/>
</g>
<!-- layer5_expert15_gate -->
<g id="node435" class="node">
<title>layer5_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13194,-17430 12799,-17430 12799,-17362 13194,-17362 13194,-17430"/>
<text text-anchor="middle" x="12996.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12996.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12996.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12996.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert15_gate -->
<g id="edge618" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7347.27,-17533.24C8416.13,-17533.02 11702.73,-17524.53 12788.64,-17430.12"/>
<polygon fill="black" stroke="black" points="12789.29,-17433.57 12798.94,-17429.21 12788.68,-17426.6 12789.29,-17433.57"/>
</g>
<!-- layer5_expert15_up -->
<g id="node436" class="node">
<title>layer5_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13607,-17430 13212,-17430 13212,-17362 13607,-17362 13607,-17430"/>
<text text-anchor="middle" x="13409.5" y="-17414.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13409.5" y="-17399.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13409.5" y="-17384.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13409.5" y="-17369.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer5_token_distribution&#45;&gt;layer5_expert15_up -->
<g id="edge619" class="edge">
<title>layer5_token_distribution&#45;&gt;layer5_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7348.15,-17533.72C8468.21,-17535.1 12031.63,-17531.26 13201.69,-17430.11"/>
<polygon fill="black" stroke="black" points="13202.29,-17433.57 13211.94,-17429.22 13201.68,-17426.6 13202.29,-17433.57"/>
</g>
<!-- layer5_expert0_act -->
<g id="node377" class="node">
<title>layer5_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1217,-17326 822,-17326 822,-17258 1217,-17258 1217,-17326"/>
<text text-anchor="middle" x="1019.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1019.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1019.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1019.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_expert0_gate&#45;&gt;layer5_expert0_act -->
<g id="edge530" class="edge">
<title>layer5_expert0_gate&#45;&gt;layer5_expert0_act</title>
<path fill="none" stroke="black" d="M740.3,-17361.95C783.56,-17351.27 831.7,-17339.38 875.66,-17328.53"/>
<polygon fill="black" stroke="black" points="876.69,-17331.88 885.56,-17326.08 875.01,-17325.08 876.69,-17331.88"/>
</g>
<!-- layer5_expert0_up&#45;&gt;layer5_expert0_act -->
<g id="edge531" class="edge">
<title>layer5_expert0_up&#45;&gt;layer5_expert0_act</title>
<path fill="none" stroke="black" d="M1019.5,-17361.88C1019.5,-17353.78 1019.5,-17344.98 1019.5,-17336.47"/>
<polygon fill="black" stroke="black" points="1023,-17336.3 1019.5,-17326.3 1016,-17336.3 1023,-17336.3"/>
</g>
<!-- layer5_expert0_down -->
<g id="node378" class="node">
<title>layer5_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1423,-17222 1040,-17222 1040,-17154 1423,-17154 1423,-17222"/>
<text text-anchor="middle" x="1231.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1231.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1231.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1231.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_expert0_act&#45;&gt;layer5_expert0_down -->
<g id="edge532" class="edge">
<title>layer5_expert0_act&#45;&gt;layer5_expert0_down</title>
<path fill="none" stroke="black" d="M1088.33,-17257.88C1109.17,-17247.86 1132.21,-17236.77 1153.6,-17226.48"/>
<polygon fill="black" stroke="black" points="1155.16,-17229.61 1162.65,-17222.12 1152.12,-17223.31 1155.16,-17229.61"/>
</g>
<!-- layer5_token_aggregation -->
<g id="node439" class="node">
<title>layer5_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7480.24,-17118 6723.44,-17118 6528.76,-16982 7285.56,-16982 7480.24,-17118"/>
<text text-anchor="middle" x="7004.5" y="-17068.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7004.5" y="-17053.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7004.5" y="-17038.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-17023.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_expert0_down&#45;&gt;layer5_token_aggregation -->
<g id="edge533" class="edge">
<title>layer5_expert0_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M1423.25,-17175.25C1546.88,-17168.07 1711.13,-17159.29 1856.5,-17154 3637.65,-17089.18 5767.04,-17062.85 6621.82,-17054.37"/>
<polygon fill="black" stroke="black" points="6622.16,-17057.87 6632.13,-17054.27 6622.09,-17050.87 6622.16,-17057.87"/>
</g>
<!-- layer5_expert1_act -->
<g id="node381" class="node">
<title>layer5_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2043,-17326 1648,-17326 1648,-17258 2043,-17258 2043,-17326"/>
<text text-anchor="middle" x="1845.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1845.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1845.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1845.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_expert1_gate&#45;&gt;layer5_expert1_act -->
<g id="edge536" class="edge">
<title>layer5_expert1_gate&#45;&gt;layer5_expert1_act</title>
<path fill="none" stroke="black" d="M1566.3,-17361.95C1609.56,-17351.27 1657.7,-17339.38 1701.66,-17328.53"/>
<polygon fill="black" stroke="black" points="1702.69,-17331.88 1711.56,-17326.08 1701.01,-17325.08 1702.69,-17331.88"/>
</g>
<!-- layer5_expert1_up&#45;&gt;layer5_expert1_act -->
<g id="edge537" class="edge">
<title>layer5_expert1_up&#45;&gt;layer5_expert1_act</title>
<path fill="none" stroke="black" d="M1845.5,-17361.88C1845.5,-17353.78 1845.5,-17344.98 1845.5,-17336.47"/>
<polygon fill="black" stroke="black" points="1849,-17336.3 1845.5,-17326.3 1842,-17336.3 1849,-17336.3"/>
</g>
<!-- layer5_expert1_down -->
<g id="node382" class="node">
<title>layer5_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2249,-17222 1866,-17222 1866,-17154 2249,-17154 2249,-17222"/>
<text text-anchor="middle" x="2057.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2057.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2057.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2057.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_expert1_act&#45;&gt;layer5_expert1_down -->
<g id="edge538" class="edge">
<title>layer5_expert1_act&#45;&gt;layer5_expert1_down</title>
<path fill="none" stroke="black" d="M1914.33,-17257.88C1935.17,-17247.86 1958.21,-17236.77 1979.6,-17226.48"/>
<polygon fill="black" stroke="black" points="1981.16,-17229.61 1988.65,-17222.12 1978.12,-17223.31 1981.16,-17229.61"/>
</g>
<!-- layer5_expert1_down&#45;&gt;layer5_token_aggregation -->
<g id="edge539" class="edge">
<title>layer5_expert1_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M2249.26,-17175.44C2372.89,-17168.34 2537.14,-17159.57 2682.5,-17154 4138.65,-17098.22 5872,-17067.8 6624.56,-17056.36"/>
<polygon fill="black" stroke="black" points="6624.79,-17059.86 6634.74,-17056.21 6624.69,-17052.86 6624.79,-17059.86"/>
</g>
<!-- layer5_expert2_act -->
<g id="node385" class="node">
<title>layer5_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2869,-17326 2474,-17326 2474,-17258 2869,-17258 2869,-17326"/>
<text text-anchor="middle" x="2671.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2671.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2671.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2671.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_expert2_gate&#45;&gt;layer5_expert2_act -->
<g id="edge542" class="edge">
<title>layer5_expert2_gate&#45;&gt;layer5_expert2_act</title>
<path fill="none" stroke="black" d="M2392.3,-17361.95C2435.56,-17351.27 2483.7,-17339.38 2527.66,-17328.53"/>
<polygon fill="black" stroke="black" points="2528.69,-17331.88 2537.56,-17326.08 2527.01,-17325.08 2528.69,-17331.88"/>
</g>
<!-- layer5_expert2_up&#45;&gt;layer5_expert2_act -->
<g id="edge543" class="edge">
<title>layer5_expert2_up&#45;&gt;layer5_expert2_act</title>
<path fill="none" stroke="black" d="M2671.5,-17361.88C2671.5,-17353.78 2671.5,-17344.98 2671.5,-17336.47"/>
<polygon fill="black" stroke="black" points="2675,-17336.3 2671.5,-17326.3 2668,-17336.3 2675,-17336.3"/>
</g>
<!-- layer5_expert2_down -->
<g id="node386" class="node">
<title>layer5_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3075,-17222 2692,-17222 2692,-17154 3075,-17154 3075,-17222"/>
<text text-anchor="middle" x="2883.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2883.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2883.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2883.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_expert2_act&#45;&gt;layer5_expert2_down -->
<g id="edge544" class="edge">
<title>layer5_expert2_act&#45;&gt;layer5_expert2_down</title>
<path fill="none" stroke="black" d="M2740.33,-17257.88C2761.17,-17247.86 2784.21,-17236.77 2805.6,-17226.48"/>
<polygon fill="black" stroke="black" points="2807.16,-17229.61 2814.65,-17222.12 2804.12,-17223.31 2807.16,-17229.61"/>
</g>
<!-- layer5_expert2_down&#45;&gt;layer5_token_aggregation -->
<g id="edge545" class="edge">
<title>layer5_expert2_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M3075.34,-17177.16C3217.09,-17170.09 3414.79,-17160.68 3588.5,-17154 4694.01,-17111.46 6001.33,-17076.25 6629.99,-17060.25"/>
<polygon fill="black" stroke="black" points="6630.21,-17063.75 6640.12,-17060 6630.03,-17056.75 6630.21,-17063.75"/>
</g>
<!-- layer5_expert3_act -->
<g id="node389" class="node">
<title>layer5_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3695,-17326 3300,-17326 3300,-17258 3695,-17258 3695,-17326"/>
<text text-anchor="middle" x="3497.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3497.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3497.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3497.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_expert3_gate&#45;&gt;layer5_expert3_act -->
<g id="edge548" class="edge">
<title>layer5_expert3_gate&#45;&gt;layer5_expert3_act</title>
<path fill="none" stroke="black" d="M3218.3,-17361.95C3261.56,-17351.27 3309.7,-17339.38 3353.66,-17328.53"/>
<polygon fill="black" stroke="black" points="3354.69,-17331.88 3363.56,-17326.08 3353.01,-17325.08 3354.69,-17331.88"/>
</g>
<!-- layer5_expert3_up&#45;&gt;layer5_expert3_act -->
<g id="edge549" class="edge">
<title>layer5_expert3_up&#45;&gt;layer5_expert3_act</title>
<path fill="none" stroke="black" d="M3497.5,-17361.88C3497.5,-17353.78 3497.5,-17344.98 3497.5,-17336.47"/>
<polygon fill="black" stroke="black" points="3501,-17336.3 3497.5,-17326.3 3494,-17336.3 3501,-17336.3"/>
</g>
<!-- layer5_expert3_down -->
<g id="node390" class="node">
<title>layer5_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3981,-17222 3598,-17222 3598,-17154 3981,-17154 3981,-17222"/>
<text text-anchor="middle" x="3789.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3789.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3789.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3789.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_expert3_act&#45;&gt;layer5_expert3_down -->
<g id="edge550" class="edge">
<title>layer5_expert3_act&#45;&gt;layer5_expert3_down</title>
<path fill="none" stroke="black" d="M3592.3,-17257.88C3621.91,-17247.54 3654.72,-17236.08 3684.96,-17225.52"/>
<polygon fill="black" stroke="black" points="3686.39,-17228.73 3694.67,-17222.12 3684.08,-17222.12 3686.39,-17228.73"/>
</g>
<!-- layer5_expert3_down&#45;&gt;layer5_token_aggregation -->
<g id="edge551" class="edge">
<title>layer5_expert3_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M3981.09,-17172.97C4073.12,-17166.56 4184.99,-17159.25 4285.5,-17154 5123.63,-17110.25 6108.01,-17077.62 6631.97,-17061.74"/>
<polygon fill="black" stroke="black" points="6632.45,-17065.23 6642.34,-17061.43 6632.23,-17058.23 6632.45,-17065.23"/>
</g>
<!-- layer5_expert4_act -->
<g id="node393" class="node">
<title>layer5_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4521,-17326 4126,-17326 4126,-17258 4521,-17258 4521,-17326"/>
<text text-anchor="middle" x="4323.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4323.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4323.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4323.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_expert4_gate&#45;&gt;layer5_expert4_act -->
<g id="edge554" class="edge">
<title>layer5_expert4_gate&#45;&gt;layer5_expert4_act</title>
<path fill="none" stroke="black" d="M4044.3,-17361.95C4087.56,-17351.27 4135.7,-17339.38 4179.66,-17328.53"/>
<polygon fill="black" stroke="black" points="4180.69,-17331.88 4189.56,-17326.08 4179.01,-17325.08 4180.69,-17331.88"/>
</g>
<!-- layer5_expert4_up&#45;&gt;layer5_expert4_act -->
<g id="edge555" class="edge">
<title>layer5_expert4_up&#45;&gt;layer5_expert4_act</title>
<path fill="none" stroke="black" d="M4323.5,-17361.88C4323.5,-17353.78 4323.5,-17344.98 4323.5,-17336.47"/>
<polygon fill="black" stroke="black" points="4327,-17336.3 4323.5,-17326.3 4320,-17336.3 4327,-17336.3"/>
</g>
<!-- layer5_expert4_down -->
<g id="node394" class="node">
<title>layer5_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4678,-17222 4295,-17222 4295,-17154 4678,-17154 4678,-17222"/>
<text text-anchor="middle" x="4486.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4486.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4486.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4486.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_expert4_act&#45;&gt;layer5_expert4_down -->
<g id="edge556" class="edge">
<title>layer5_expert4_act&#45;&gt;layer5_expert4_down</title>
<path fill="none" stroke="black" d="M4376.42,-17257.88C4391.87,-17248.21 4408.89,-17237.56 4424.84,-17227.59"/>
<polygon fill="black" stroke="black" points="4426.94,-17230.4 4433.57,-17222.12 4423.23,-17224.46 4426.94,-17230.4"/>
</g>
<!-- layer5_expert4_down&#45;&gt;layer5_token_aggregation -->
<g id="edge557" class="edge">
<title>layer5_expert4_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M4678.08,-17176.65C5097.5,-17154 6102.65,-17099.71 6644.24,-17070.46"/>
<polygon fill="black" stroke="black" points="6644.77,-17073.93 6654.56,-17069.9 6644.39,-17066.94 6644.77,-17073.93"/>
</g>
<!-- layer5_expert5_act -->
<g id="node397" class="node">
<title>layer5_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5347,-17326 4952,-17326 4952,-17258 5347,-17258 5347,-17326"/>
<text text-anchor="middle" x="5149.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5149.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5149.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5149.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_expert5_gate&#45;&gt;layer5_expert5_act -->
<g id="edge560" class="edge">
<title>layer5_expert5_gate&#45;&gt;layer5_expert5_act</title>
<path fill="none" stroke="black" d="M4870.3,-17361.95C4913.56,-17351.27 4961.7,-17339.38 5005.66,-17328.53"/>
<polygon fill="black" stroke="black" points="5006.69,-17331.88 5015.56,-17326.08 5005.01,-17325.08 5006.69,-17331.88"/>
</g>
<!-- layer5_expert5_up&#45;&gt;layer5_expert5_act -->
<g id="edge561" class="edge">
<title>layer5_expert5_up&#45;&gt;layer5_expert5_act</title>
<path fill="none" stroke="black" d="M5149.5,-17361.88C5149.5,-17353.78 5149.5,-17344.98 5149.5,-17336.47"/>
<polygon fill="black" stroke="black" points="5153,-17336.3 5149.5,-17326.3 5146,-17336.3 5153,-17336.3"/>
</g>
<!-- layer5_expert5_down -->
<g id="node398" class="node">
<title>layer5_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5716,-17222 5333,-17222 5333,-17154 5716,-17154 5716,-17222"/>
<text text-anchor="middle" x="5524.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5524.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5524.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5524.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_expert5_act&#45;&gt;layer5_expert5_down -->
<g id="edge562" class="edge">
<title>layer5_expert5_act&#45;&gt;layer5_expert5_down</title>
<path fill="none" stroke="black" d="M5270.99,-17257.95C5310.02,-17247.34 5353.43,-17235.53 5393.14,-17224.73"/>
<polygon fill="black" stroke="black" points="5394.15,-17228.08 5402.88,-17222.08 5392.31,-17221.33 5394.15,-17228.08"/>
</g>
<!-- layer5_expert5_down&#45;&gt;layer5_token_aggregation -->
<g id="edge563" class="edge">
<title>layer5_expert5_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M5716.09,-17169.39C5954.85,-17147.45 6367.2,-17109.56 6661.09,-17082.56"/>
<polygon fill="black" stroke="black" points="6661.42,-17086.04 6671.06,-17081.64 6660.78,-17079.07 6661.42,-17086.04"/>
</g>
<!-- layer5_expert6_act -->
<g id="node401" class="node">
<title>layer5_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6173,-17326 5778,-17326 5778,-17258 6173,-17258 6173,-17326"/>
<text text-anchor="middle" x="5975.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5975.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5975.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5975.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_expert6_gate&#45;&gt;layer5_expert6_act -->
<g id="edge566" class="edge">
<title>layer5_expert6_gate&#45;&gt;layer5_expert6_act</title>
<path fill="none" stroke="black" d="M5696.3,-17361.95C5739.56,-17351.27 5787.7,-17339.38 5831.66,-17328.53"/>
<polygon fill="black" stroke="black" points="5832.69,-17331.88 5841.56,-17326.08 5831.01,-17325.08 5832.69,-17331.88"/>
</g>
<!-- layer5_expert6_up&#45;&gt;layer5_expert6_act -->
<g id="edge567" class="edge">
<title>layer5_expert6_up&#45;&gt;layer5_expert6_act</title>
<path fill="none" stroke="black" d="M5975.5,-17361.88C5975.5,-17353.78 5975.5,-17344.98 5975.5,-17336.47"/>
<polygon fill="black" stroke="black" points="5979,-17336.3 5975.5,-17326.3 5972,-17336.3 5979,-17336.3"/>
</g>
<!-- layer5_expert6_down -->
<g id="node402" class="node">
<title>layer5_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6436,-17222 6053,-17222 6053,-17154 6436,-17154 6436,-17222"/>
<text text-anchor="middle" x="6244.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6244.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6244.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6244.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_expert6_act&#45;&gt;layer5_expert6_down -->
<g id="edge568" class="edge">
<title>layer5_expert6_act&#45;&gt;layer5_expert6_down</title>
<path fill="none" stroke="black" d="M6062.84,-17257.88C6089.87,-17247.63 6119.82,-17236.28 6147.47,-17225.79"/>
<polygon fill="black" stroke="black" points="6149.03,-17228.94 6157.14,-17222.12 6146.55,-17222.4 6149.03,-17228.94"/>
</g>
<!-- layer5_expert6_down&#45;&gt;layer5_token_aggregation -->
<g id="edge569" class="edge">
<title>layer5_expert6_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M6428.96,-17153.99C6508.68,-17139.73 6604.18,-17122.64 6694.26,-17106.52"/>
<polygon fill="black" stroke="black" points="6695.14,-17109.91 6704.37,-17104.71 6693.91,-17103.02 6695.14,-17109.91"/>
</g>
<!-- layer5_expert7_act -->
<g id="node405" class="node">
<title>layer5_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6999,-17326 6604,-17326 6604,-17258 6999,-17258 6999,-17326"/>
<text text-anchor="middle" x="6801.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6801.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6801.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6801.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_expert7_gate&#45;&gt;layer5_expert7_act -->
<g id="edge572" class="edge">
<title>layer5_expert7_gate&#45;&gt;layer5_expert7_act</title>
<path fill="none" stroke="black" d="M6522.3,-17361.95C6565.56,-17351.27 6613.7,-17339.38 6657.66,-17328.53"/>
<polygon fill="black" stroke="black" points="6658.69,-17331.88 6667.56,-17326.08 6657.01,-17325.08 6658.69,-17331.88"/>
</g>
<!-- layer5_expert7_up&#45;&gt;layer5_expert7_act -->
<g id="edge573" class="edge">
<title>layer5_expert7_up&#45;&gt;layer5_expert7_act</title>
<path fill="none" stroke="black" d="M6801.5,-17361.88C6801.5,-17353.78 6801.5,-17344.98 6801.5,-17336.47"/>
<polygon fill="black" stroke="black" points="6805,-17336.3 6801.5,-17326.3 6798,-17336.3 6805,-17336.3"/>
</g>
<!-- layer5_expert7_down -->
<g id="node406" class="node">
<title>layer5_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6996,-17222 6613,-17222 6613,-17154 6996,-17154 6996,-17222"/>
<text text-anchor="middle" x="6804.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6804.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6804.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6804.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_expert7_act&#45;&gt;layer5_expert7_down -->
<g id="edge574" class="edge">
<title>layer5_expert7_act&#45;&gt;layer5_expert7_down</title>
<path fill="none" stroke="black" d="M6802.47,-17257.88C6802.71,-17249.78 6802.97,-17240.98 6803.22,-17232.47"/>
<polygon fill="black" stroke="black" points="6806.73,-17232.4 6803.52,-17222.3 6799.73,-17232.19 6806.73,-17232.4"/>
</g>
<!-- layer5_expert7_down&#45;&gt;layer5_token_aggregation -->
<g id="edge575" class="edge">
<title>layer5_expert7_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M6853.17,-17153.9C6866.63,-17144.75 6881.8,-17134.44 6897.2,-17123.97"/>
<polygon fill="black" stroke="black" points="6899.47,-17126.66 6905.77,-17118.14 6895.53,-17120.87 6899.47,-17126.66"/>
</g>
<!-- layer5_expert8_act -->
<g id="node409" class="node">
<title>layer5_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7412,-17326 7017,-17326 7017,-17258 7412,-17258 7412,-17326"/>
<text text-anchor="middle" x="7214.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7214.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7214.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7214.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer5_expert8_gate&#45;&gt;layer5_expert8_act -->
<g id="edge578" class="edge">
<title>layer5_expert8_gate&#45;&gt;layer5_expert8_act</title>
<path fill="none" stroke="black" d="M7214.5,-17361.88C7214.5,-17353.78 7214.5,-17344.98 7214.5,-17336.47"/>
<polygon fill="black" stroke="black" points="7218,-17336.3 7214.5,-17326.3 7211,-17336.3 7218,-17336.3"/>
</g>
<!-- layer5_expert8_up&#45;&gt;layer5_expert8_act -->
<g id="edge579" class="edge">
<title>layer5_expert8_up&#45;&gt;layer5_expert8_act</title>
<path fill="none" stroke="black" d="M7493.7,-17361.95C7450.44,-17351.27 7402.3,-17339.38 7358.34,-17328.53"/>
<polygon fill="black" stroke="black" points="7358.99,-17325.08 7348.44,-17326.08 7357.31,-17331.88 7358.99,-17325.08"/>
</g>
<!-- layer5_expert8_down -->
<g id="node410" class="node">
<title>layer5_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7403,-17222 7020,-17222 7020,-17154 7403,-17154 7403,-17222"/>
<text text-anchor="middle" x="7211.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7211.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7211.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7211.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer5_expert8_act&#45;&gt;layer5_expert8_down -->
<g id="edge580" class="edge">
<title>layer5_expert8_act&#45;&gt;layer5_expert8_down</title>
<path fill="none" stroke="black" d="M7213.53,-17257.88C7213.29,-17249.78 7213.03,-17240.98 7212.78,-17232.47"/>
<polygon fill="black" stroke="black" points="7216.27,-17232.19 7212.48,-17222.3 7209.27,-17232.4 7216.27,-17232.19"/>
</g>
<!-- layer5_expert8_down&#45;&gt;layer5_token_aggregation -->
<g id="edge581" class="edge">
<title>layer5_expert8_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M7161.13,-17153.9C7147.06,-17144.66 7131.2,-17134.25 7115.12,-17123.67"/>
<polygon fill="black" stroke="black" points="7116.97,-17120.7 7106.69,-17118.14 7113.12,-17126.55 7116.97,-17120.7"/>
</g>
<!-- layer5_expert9_act -->
<g id="node413" class="node">
<title>layer5_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8238,-17326 7843,-17326 7843,-17258 8238,-17258 8238,-17326"/>
<text text-anchor="middle" x="8040.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8040.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8040.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8040.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer5_expert9_gate&#45;&gt;layer5_expert9_act -->
<g id="edge584" class="edge">
<title>layer5_expert9_gate&#45;&gt;layer5_expert9_act</title>
<path fill="none" stroke="black" d="M8040.5,-17361.88C8040.5,-17353.78 8040.5,-17344.98 8040.5,-17336.47"/>
<polygon fill="black" stroke="black" points="8044,-17336.3 8040.5,-17326.3 8037,-17336.3 8044,-17336.3"/>
</g>
<!-- layer5_expert9_up&#45;&gt;layer5_expert9_act -->
<g id="edge585" class="edge">
<title>layer5_expert9_up&#45;&gt;layer5_expert9_act</title>
<path fill="none" stroke="black" d="M8319.7,-17361.95C8276.44,-17351.27 8228.3,-17339.38 8184.34,-17328.53"/>
<polygon fill="black" stroke="black" points="8184.99,-17325.08 8174.44,-17326.08 8183.31,-17331.88 8184.99,-17325.08"/>
</g>
<!-- layer5_expert9_down -->
<g id="node414" class="node">
<title>layer5_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8019,-17222 7636,-17222 7636,-17154 8019,-17154 8019,-17222"/>
<text text-anchor="middle" x="7827.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7827.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7827.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7827.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer5_expert9_act&#45;&gt;layer5_expert9_down -->
<g id="edge586" class="edge">
<title>layer5_expert9_act&#45;&gt;layer5_expert9_down</title>
<path fill="none" stroke="black" d="M7971.35,-17257.88C7950.41,-17247.86 7927.26,-17236.77 7905.77,-17226.48"/>
<polygon fill="black" stroke="black" points="7907.2,-17223.29 7896.67,-17222.12 7904.18,-17229.6 7907.2,-17223.29"/>
</g>
<!-- layer5_expert9_down&#45;&gt;layer5_token_aggregation -->
<g id="edge587" class="edge">
<title>layer5_expert9_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M7635.84,-17155.33C7570.96,-17144.61 7495.75,-17132.18 7420.34,-17119.72"/>
<polygon fill="black" stroke="black" points="7420.62,-17116.22 7410.19,-17118.04 7419.48,-17123.12 7420.62,-17116.22"/>
</g>
<!-- layer5_expert10_act -->
<g id="node417" class="node">
<title>layer5_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9064,-17326 8669,-17326 8669,-17258 9064,-17258 9064,-17326"/>
<text text-anchor="middle" x="8866.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8866.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8866.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8866.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer5_expert10_gate&#45;&gt;layer5_expert10_act -->
<g id="edge590" class="edge">
<title>layer5_expert10_gate&#45;&gt;layer5_expert10_act</title>
<path fill="none" stroke="black" d="M8866.5,-17361.88C8866.5,-17353.78 8866.5,-17344.98 8866.5,-17336.47"/>
<polygon fill="black" stroke="black" points="8870,-17336.3 8866.5,-17326.3 8863,-17336.3 8870,-17336.3"/>
</g>
<!-- layer5_expert10_up&#45;&gt;layer5_expert10_act -->
<g id="edge591" class="edge">
<title>layer5_expert10_up&#45;&gt;layer5_expert10_act</title>
<path fill="none" stroke="black" d="M9145.7,-17361.95C9102.44,-17351.27 9054.3,-17339.38 9010.34,-17328.53"/>
<polygon fill="black" stroke="black" points="9010.99,-17325.08 9000.44,-17326.08 9009.31,-17331.88 9010.99,-17325.08"/>
</g>
<!-- layer5_expert10_down -->
<g id="node418" class="node">
<title>layer5_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8740,-17222 8357,-17222 8357,-17154 8740,-17154 8740,-17222"/>
<text text-anchor="middle" x="8548.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8548.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8548.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8548.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer5_expert10_act&#45;&gt;layer5_expert10_down -->
<g id="edge592" class="edge">
<title>layer5_expert10_act&#45;&gt;layer5_expert10_down</title>
<path fill="none" stroke="black" d="M8763.25,-17257.88C8730.65,-17247.43 8694.47,-17235.82 8661.25,-17225.16"/>
<polygon fill="black" stroke="black" points="8662.09,-17221.76 8651.5,-17222.04 8659.95,-17228.42 8662.09,-17221.76"/>
</g>
<!-- layer5_expert10_down&#45;&gt;layer5_token_aggregation -->
<g id="edge593" class="edge">
<title>layer5_expert10_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M8356.85,-17170.12C8131.46,-17150.27 7749.98,-17116.66 7449.54,-17090.2"/>
<polygon fill="black" stroke="black" points="7449.61,-17086.69 7439.34,-17089.3 7448.99,-17093.67 7449.61,-17086.69"/>
</g>
<!-- layer5_expert11_act -->
<g id="node421" class="node">
<title>layer5_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9890,-17326 9495,-17326 9495,-17258 9890,-17258 9890,-17326"/>
<text text-anchor="middle" x="9692.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9692.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9692.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9692.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer5_expert11_gate&#45;&gt;layer5_expert11_act -->
<g id="edge596" class="edge">
<title>layer5_expert11_gate&#45;&gt;layer5_expert11_act</title>
<path fill="none" stroke="black" d="M9692.5,-17361.88C9692.5,-17353.78 9692.5,-17344.98 9692.5,-17336.47"/>
<polygon fill="black" stroke="black" points="9696,-17336.3 9692.5,-17326.3 9689,-17336.3 9696,-17336.3"/>
</g>
<!-- layer5_expert11_up&#45;&gt;layer5_expert11_act -->
<g id="edge597" class="edge">
<title>layer5_expert11_up&#45;&gt;layer5_expert11_act</title>
<path fill="none" stroke="black" d="M9971.7,-17361.95C9928.44,-17351.27 9880.3,-17339.38 9836.34,-17328.53"/>
<polygon fill="black" stroke="black" points="9836.99,-17325.08 9826.44,-17326.08 9835.31,-17331.88 9836.99,-17325.08"/>
</g>
<!-- layer5_expert11_down -->
<g id="node422" class="node">
<title>layer5_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9514,-17222 9131,-17222 9131,-17154 9514,-17154 9514,-17222"/>
<text text-anchor="middle" x="9322.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9322.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9322.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9322.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer5_expert11_act&#45;&gt;layer5_expert11_down -->
<g id="edge598" class="edge">
<title>layer5_expert11_act&#45;&gt;layer5_expert11_down</title>
<path fill="none" stroke="black" d="M9572.63,-17257.95C9534.2,-17247.36 9491.47,-17235.58 9452.36,-17224.8"/>
<polygon fill="black" stroke="black" points="9453.07,-17221.36 9442.5,-17222.08 9451.21,-17228.11 9453.07,-17221.36"/>
</g>
<!-- layer5_expert11_down&#45;&gt;layer5_token_aggregation -->
<g id="edge599" class="edge">
<title>layer5_expert11_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M9130.84,-17175.75C8759.82,-17153.99 7935.55,-17105.63 7429.2,-17075.92"/>
<polygon fill="black" stroke="black" points="7429.35,-17072.42 7419.17,-17075.33 7428.94,-17079.41 7429.35,-17072.42"/>
</g>
<!-- layer5_expert12_act -->
<g id="node425" class="node">
<title>layer5_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10716,-17326 10321,-17326 10321,-17258 10716,-17258 10716,-17326"/>
<text text-anchor="middle" x="10518.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10518.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10518.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10518.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer5_expert12_gate&#45;&gt;layer5_expert12_act -->
<g id="edge602" class="edge">
<title>layer5_expert12_gate&#45;&gt;layer5_expert12_act</title>
<path fill="none" stroke="black" d="M10518.5,-17361.88C10518.5,-17353.78 10518.5,-17344.98 10518.5,-17336.47"/>
<polygon fill="black" stroke="black" points="10522,-17336.3 10518.5,-17326.3 10515,-17336.3 10522,-17336.3"/>
</g>
<!-- layer5_expert12_up&#45;&gt;layer5_expert12_act -->
<g id="edge603" class="edge">
<title>layer5_expert12_up&#45;&gt;layer5_expert12_act</title>
<path fill="none" stroke="black" d="M10797.7,-17361.95C10754.44,-17351.27 10706.3,-17339.38 10662.34,-17328.53"/>
<polygon fill="black" stroke="black" points="10662.99,-17325.08 10652.44,-17326.08 10661.31,-17331.88 10662.99,-17325.08"/>
</g>
<!-- layer5_expert12_down -->
<g id="node426" class="node">
<title>layer5_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10314,-17222 9931,-17222 9931,-17154 10314,-17154 10314,-17222"/>
<text text-anchor="middle" x="10122.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10122.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10122.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10122.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer5_expert12_act&#45;&gt;layer5_expert12_down -->
<g id="edge604" class="edge">
<title>layer5_expert12_act&#45;&gt;layer5_expert12_down</title>
<path fill="none" stroke="black" d="M10390.2,-17257.95C10348.81,-17247.29 10302.76,-17235.43 10260.69,-17224.59"/>
<polygon fill="black" stroke="black" points="10261.49,-17221.19 10250.93,-17222.08 10259.74,-17227.96 10261.49,-17221.19"/>
</g>
<!-- layer5_expert12_down&#45;&gt;layer5_token_aggregation -->
<g id="edge605" class="edge">
<title>layer5_expert12_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M9930.67,-17175.74C9813.15,-17169.01 9659.65,-17160.53 9523.5,-17154 8780.75,-17118.36 7914.41,-17084.66 7415.65,-17066.02"/>
<polygon fill="black" stroke="black" points="7415.53,-17062.52 7405.41,-17065.64 7415.27,-17069.51 7415.53,-17062.52"/>
</g>
<!-- layer5_expert13_act -->
<g id="node429" class="node">
<title>layer5_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11542,-17326 11147,-17326 11147,-17258 11542,-17258 11542,-17326"/>
<text text-anchor="middle" x="11344.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11344.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11344.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11344.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer5_expert13_gate&#45;&gt;layer5_expert13_act -->
<g id="edge608" class="edge">
<title>layer5_expert13_gate&#45;&gt;layer5_expert13_act</title>
<path fill="none" stroke="black" d="M11344.5,-17361.88C11344.5,-17353.78 11344.5,-17344.98 11344.5,-17336.47"/>
<polygon fill="black" stroke="black" points="11348,-17336.3 11344.5,-17326.3 11341,-17336.3 11348,-17336.3"/>
</g>
<!-- layer5_expert13_up&#45;&gt;layer5_expert13_act -->
<g id="edge609" class="edge">
<title>layer5_expert13_up&#45;&gt;layer5_expert13_act</title>
<path fill="none" stroke="black" d="M11623.7,-17361.95C11580.44,-17351.27 11532.3,-17339.38 11488.34,-17328.53"/>
<polygon fill="black" stroke="black" points="11488.99,-17325.08 11478.44,-17326.08 11487.31,-17331.88 11488.99,-17325.08"/>
</g>
<!-- layer5_expert13_down -->
<g id="node430" class="node">
<title>layer5_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11127,-17222 10744,-17222 10744,-17154 11127,-17154 11127,-17222"/>
<text text-anchor="middle" x="10935.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10935.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10935.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10935.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer5_expert13_act&#45;&gt;layer5_expert13_down -->
<g id="edge610" class="edge">
<title>layer5_expert13_act&#45;&gt;layer5_expert13_down</title>
<path fill="none" stroke="black" d="M11211.99,-17257.95C11169.15,-17247.27 11121.48,-17235.38 11077.95,-17224.53"/>
<polygon fill="black" stroke="black" points="11078.7,-17221.1 11068.15,-17222.08 11077,-17227.9 11078.7,-17221.1"/>
</g>
<!-- layer5_expert13_down&#45;&gt;layer5_token_aggregation -->
<g id="edge611" class="edge">
<title>layer5_expert13_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M10743.98,-17175.55C10623.35,-17168.61 10464.36,-17159.98 10323.5,-17154 9272.09,-17109.34 8032.53,-17076 7407.76,-17060.54"/>
<polygon fill="black" stroke="black" points="7407.78,-17057.04 7397.69,-17060.3 7407.6,-17064.04 7407.78,-17057.04"/>
</g>
<!-- layer5_expert14_act -->
<g id="node433" class="node">
<title>layer5_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12368,-17326 11973,-17326 11973,-17258 12368,-17258 12368,-17326"/>
<text text-anchor="middle" x="12170.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12170.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12170.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12170.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer5_expert14_gate&#45;&gt;layer5_expert14_act -->
<g id="edge614" class="edge">
<title>layer5_expert14_gate&#45;&gt;layer5_expert14_act</title>
<path fill="none" stroke="black" d="M12170.5,-17361.88C12170.5,-17353.78 12170.5,-17344.98 12170.5,-17336.47"/>
<polygon fill="black" stroke="black" points="12174,-17336.3 12170.5,-17326.3 12167,-17336.3 12174,-17336.3"/>
</g>
<!-- layer5_expert14_up&#45;&gt;layer5_expert14_act -->
<g id="edge615" class="edge">
<title>layer5_expert14_up&#45;&gt;layer5_expert14_act</title>
<path fill="none" stroke="black" d="M12449.7,-17361.95C12406.44,-17351.27 12358.3,-17339.38 12314.34,-17328.53"/>
<polygon fill="black" stroke="black" points="12314.99,-17325.08 12304.44,-17326.08 12313.31,-17331.88 12314.99,-17325.08"/>
</g>
<!-- layer5_expert14_down -->
<g id="node434" class="node">
<title>layer5_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11946,-17222 11563,-17222 11563,-17154 11946,-17154 11946,-17222"/>
<text text-anchor="middle" x="11754.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11754.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11754.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11754.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer5_expert14_act&#45;&gt;layer5_expert14_down -->
<g id="edge616" class="edge">
<title>layer5_expert14_act&#45;&gt;layer5_expert14_down</title>
<path fill="none" stroke="black" d="M12035.72,-17257.95C11992.15,-17247.27 11943.66,-17235.38 11899.39,-17224.53"/>
<polygon fill="black" stroke="black" points="11899.96,-17221.06 11889.42,-17222.08 11898.3,-17227.86 11899.96,-17221.06"/>
</g>
<!-- layer5_expert14_down&#45;&gt;layer5_token_aggregation -->
<g id="edge617" class="edge">
<title>layer5_expert14_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M11562.83,-17175.36C11440.82,-17168.3 11279.43,-17159.6 11136.5,-17154 9766.85,-17100.37 8140.66,-17069.43 7403.32,-17057.17"/>
<polygon fill="black" stroke="black" points="7403.12,-17053.67 7393.07,-17057 7403.01,-17060.67 7403.12,-17053.67"/>
</g>
<!-- layer5_expert15_act -->
<g id="node437" class="node">
<title>layer5_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13194,-17326 12799,-17326 12799,-17258 13194,-17258 13194,-17326"/>
<text text-anchor="middle" x="12996.5" y="-17310.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12996.5" y="-17295.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12996.5" y="-17280.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12996.5" y="-17265.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer5_expert15_gate&#45;&gt;layer5_expert15_act -->
<g id="edge620" class="edge">
<title>layer5_expert15_gate&#45;&gt;layer5_expert15_act</title>
<path fill="none" stroke="black" d="M12996.5,-17361.88C12996.5,-17353.78 12996.5,-17344.98 12996.5,-17336.47"/>
<polygon fill="black" stroke="black" points="13000,-17336.3 12996.5,-17326.3 12993,-17336.3 13000,-17336.3"/>
</g>
<!-- layer5_expert15_up&#45;&gt;layer5_expert15_act -->
<g id="edge621" class="edge">
<title>layer5_expert15_up&#45;&gt;layer5_expert15_act</title>
<path fill="none" stroke="black" d="M13275.7,-17361.95C13232.44,-17351.27 13184.3,-17339.38 13140.34,-17328.53"/>
<polygon fill="black" stroke="black" points="13140.99,-17325.08 13130.44,-17326.08 13139.31,-17331.88 13140.99,-17325.08"/>
</g>
<!-- layer5_expert15_down -->
<g id="node438" class="node">
<title>layer5_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12769,-17222 12386,-17222 12386,-17154 12769,-17154 12769,-17222"/>
<text text-anchor="middle" x="12577.5" y="-17206.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12577.5" y="-17191.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12577.5" y="-17176.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12577.5" y="-17161.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer5_expert15_act&#45;&gt;layer5_expert15_down -->
<g id="edge622" class="edge">
<title>layer5_expert15_act&#45;&gt;layer5_expert15_down</title>
<path fill="none" stroke="black" d="M12860.75,-17257.95C12816.77,-17247.25 12767.82,-17235.33 12723.15,-17224.46"/>
<polygon fill="black" stroke="black" points="12723.93,-17221.05 12713.39,-17222.08 12722.28,-17227.85 12723.93,-17221.05"/>
</g>
<!-- layer5_expert15_down&#45;&gt;layer5_token_aggregation -->
<g id="edge623" class="edge">
<title>layer5_expert15_down&#45;&gt;layer5_token_aggregation</title>
<path fill="none" stroke="black" d="M12385.98,-17175.24C12263.02,-17168.09 12099.9,-17159.33 11955.5,-17154 10261.24,-17091.45 8239.33,-17064.15 7399.93,-17054.91"/>
<polygon fill="black" stroke="black" points="7399.84,-17051.4 7389.8,-17054.79 7399.76,-17058.4 7399.84,-17051.4"/>
</g>
<!-- layer5_res2 -->
<g id="node440" class="node">
<title>layer5_res2</title>
<polygon fill="none" stroke="black" points="7445.24,-16946 6744.12,-16946 6563.76,-16780 7264.88,-16780 7445.24,-16946"/>
<text text-anchor="middle" x="7004.5" y="-16889.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7004.5" y="-16874.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16859.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16844.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16829.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_token_aggregation&#45;&gt;layer5_res2 -->
<g id="edge624" class="edge">
<title>layer5_token_aggregation&#45;&gt;layer5_res2</title>
<path fill="none" stroke="black" d="M7004.5,-16981.95C7004.5,-16973.63 7004.5,-16965 7004.5,-16956.38"/>
<polygon fill="black" stroke="black" points="7008,-16956.28 7004.5,-16946.28 7001,-16956.28 7008,-16956.28"/>
</g>
<!-- layer6_mha_qkv -->
<g id="node441" class="node">
<title>layer6_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7240.5,-16744 6768.5,-16744 6768.5,-16676 7240.5,-16676 7240.5,-16744"/>
<text text-anchor="middle" x="7004.5" y="-16728.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7004.5" y="-16713.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16698.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7004.5" y="-16683.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_res2&#45;&gt;layer6_mha_qkv -->
<g id="edge625" class="edge">
<title>layer5_res2&#45;&gt;layer6_mha_qkv</title>
<path fill="none" stroke="black" d="M7004.5,-16779.87C7004.5,-16771.12 7004.5,-16762.48 7004.5,-16754.45"/>
<polygon fill="black" stroke="black" points="7008,-16754.26 7004.5,-16744.26 7001,-16754.26 7008,-16754.26"/>
</g>
<!-- layer6_mha_attn -->
<g id="node442" class="node">
<title>layer6_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7234.5,-16640 6774.5,-16640 6774.5,-16572 7234.5,-16572 7234.5,-16640"/>
<text text-anchor="middle" x="7004.5" y="-16624.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7004.5" y="-16609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7004.5" y="-16594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16579.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_mha_qkv&#45;&gt;layer6_mha_attn -->
<g id="edge626" class="edge">
<title>layer6_mha_qkv&#45;&gt;layer6_mha_attn</title>
<path fill="none" stroke="black" d="M7004.5,-16675.88C7004.5,-16667.78 7004.5,-16658.98 7004.5,-16650.47"/>
<polygon fill="black" stroke="black" points="7008,-16650.3 7004.5,-16640.3 7001,-16650.3 7008,-16650.3"/>
</g>
<!-- layer6_mha_out -->
<g id="node443" class="node">
<title>layer6_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7217,-16536 6792,-16536 6792,-16468 7217,-16468 7217,-16536"/>
<text text-anchor="middle" x="7004.5" y="-16520.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7004.5" y="-16505.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16490.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16475.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_mha_attn&#45;&gt;layer6_mha_out -->
<g id="edge627" class="edge">
<title>layer6_mha_attn&#45;&gt;layer6_mha_out</title>
<path fill="none" stroke="black" d="M7004.5,-16571.88C7004.5,-16563.78 7004.5,-16554.98 7004.5,-16546.47"/>
<polygon fill="black" stroke="black" points="7008,-16546.3 7004.5,-16536.3 7001,-16546.3 7008,-16546.3"/>
</g>
<!-- layer6_res1 -->
<g id="node444" class="node">
<title>layer6_res1</title>
<polygon fill="none" stroke="black" points="7445.24,-16432 6744.12,-16432 6563.76,-16266 7264.88,-16266 7445.24,-16432"/>
<text text-anchor="middle" x="7004.5" y="-16375.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7004.5" y="-16360.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16345.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16330.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16315.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_mha_out&#45;&gt;layer6_res1 -->
<g id="edge628" class="edge">
<title>layer6_mha_out&#45;&gt;layer6_res1</title>
<path fill="none" stroke="black" d="M7004.5,-16467.86C7004.5,-16460.1 7004.5,-16451.46 7004.5,-16442.48"/>
<polygon fill="black" stroke="black" points="7008,-16442.23 7004.5,-16432.23 7001,-16442.23 7008,-16442.23"/>
</g>
<!-- layer6_ln1 -->
<g id="node445" class="node">
<title>layer6_ln1</title>
<polygon fill="yellow" stroke="black" points="7217,-16230 6792,-16230 6792,-16162 7217,-16162 7217,-16230"/>
<text text-anchor="middle" x="7004.5" y="-16214.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7004.5" y="-16199.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16184.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16169.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_res1&#45;&gt;layer6_ln1 -->
<g id="edge629" class="edge">
<title>layer6_res1&#45;&gt;layer6_ln1</title>
<path fill="none" stroke="black" d="M7004.5,-16265.87C7004.5,-16257.12 7004.5,-16248.48 7004.5,-16240.45"/>
<polygon fill="black" stroke="black" points="7008,-16240.26 7004.5,-16230.26 7001,-16240.26 7008,-16240.26"/>
</g>
<!-- layer6_expert_routing -->
<g id="node446" class="node">
<title>layer6_expert_routing</title>
<polygon fill="orange" stroke="black" points="7004.5,-16126 6588.5,-16043 7004.5,-15960 7420.5,-16043 7004.5,-16126"/>
<text text-anchor="middle" x="7004.5" y="-16069.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7004.5" y="-16054.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7004.5" y="-16039.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-16024.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7004.5" y="-16009.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_ln1&#45;&gt;layer6_expert_routing -->
<g id="edge630" class="edge">
<title>layer6_ln1&#45;&gt;layer6_expert_routing</title>
<path fill="none" stroke="black" d="M7004.5,-16161.86C7004.5,-16154.1 7004.5,-16145.46 7004.5,-16136.48"/>
<polygon fill="black" stroke="black" points="7008,-16136.23 7004.5,-16126.23 7001,-16136.23 7008,-16136.23"/>
</g>
<!-- layer6_token_distribution -->
<g id="node447" class="node">
<title>layer6_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7432.86,-15924 6751.44,-15924 6576.14,-15788 7257.56,-15788 7432.86,-15924"/>
<text text-anchor="middle" x="7004.5" y="-15874.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7004.5" y="-15859.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7004.5" y="-15844.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7004.5" y="-15829.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer6_expert_routing&#45;&gt;layer6_token_distribution -->
<g id="edge631" class="edge">
<title>layer6_expert_routing&#45;&gt;layer6_token_distribution</title>
<path fill="none" stroke="black" d="M7004.5,-15959.78C7004.5,-15951.34 7004.5,-15942.79 7004.5,-15934.4"/>
<polygon fill="black" stroke="black" points="7008,-15934.28 7004.5,-15924.28 7001,-15934.28 7008,-15934.28"/>
</g>
<!-- layer6_expert0_gate -->
<g id="node448" class="node">
<title>layer6_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="801,-15752 406,-15752 406,-15684 801,-15684 801,-15752"/>
<text text-anchor="middle" x="603.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="603.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="603.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="603.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert0_gate -->
<g id="edge632" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6663.42,-15855.72C5542.99,-15857.09 1981.01,-15853.23 811.31,-15752.11"/>
<polygon fill="black" stroke="black" points="811.32,-15748.6 801.06,-15751.22 810.71,-15755.57 811.32,-15748.6"/>
</g>
<!-- layer6_expert0_up -->
<g id="node449" class="node">
<title>layer6_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1214,-15752 819,-15752 819,-15684 1214,-15684 1214,-15752"/>
<text text-anchor="middle" x="1016.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1016.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1016.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1016.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert0_up -->
<g id="edge633" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6662.42,-15855.24C5591.28,-15855 2309.27,-15846.44 1224.35,-15752.12"/>
<polygon fill="black" stroke="black" points="1224.32,-15748.6 1214.06,-15751.21 1223.71,-15755.57 1224.32,-15748.6"/>
</g>
<!-- layer6_expert1_gate -->
<g id="node452" class="node">
<title>layer6_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1627,-15752 1232,-15752 1232,-15684 1627,-15684 1627,-15752"/>
<text text-anchor="middle" x="1429.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1429.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1429.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1429.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert1_gate -->
<g id="edge638" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6661.86,-15854.69C5642.38,-15852.77 2637.69,-15839.69 1637.28,-15752.11"/>
<polygon fill="black" stroke="black" points="1637.33,-15748.6 1627.06,-15751.21 1636.71,-15755.57 1637.33,-15748.6"/>
</g>
<!-- layer6_expert1_up -->
<g id="node453" class="node">
<title>layer6_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2040,-15752 1645,-15752 1645,-15684 2040,-15684 2040,-15752"/>
<text text-anchor="middle" x="1842.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1842.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1842.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1842.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert1_up -->
<g id="edge639" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6660.92,-15854.04C5694.86,-15850.35 2966.03,-15832.95 2050.08,-15752.09"/>
<polygon fill="black" stroke="black" points="2050.33,-15748.6 2040.06,-15751.2 2049.71,-15755.58 2050.33,-15748.6"/>
</g>
<!-- layer6_expert2_gate -->
<g id="node456" class="node">
<title>layer6_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2453,-15752 2058,-15752 2058,-15684 2453,-15684 2453,-15752"/>
<text text-anchor="middle" x="2255.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2255.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2255.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2255.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert2_gate -->
<g id="edge644" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6659.93,-15853.27C5749.78,-15847.72 3295.04,-15826.22 2463.07,-15752.1"/>
<polygon fill="black" stroke="black" points="2463.33,-15748.6 2453.06,-15751.19 2462.7,-15755.58 2463.33,-15748.6"/>
</g>
<!-- layer6_expert2_up -->
<g id="node457" class="node">
<title>layer6_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2866,-15752 2471,-15752 2471,-15684 2866,-15684 2866,-15752"/>
<text text-anchor="middle" x="2668.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2668.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2668.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2668.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert2_up -->
<g id="edge645" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6658.99,-15852.34C5807.65,-15844.84 3624.62,-15819.52 2876.16,-15752.1"/>
<polygon fill="black" stroke="black" points="2876.34,-15748.61 2866.06,-15751.18 2875.7,-15755.58 2876.34,-15748.61"/>
</g>
<!-- layer6_expert3_gate -->
<g id="node460" class="node">
<title>layer6_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3279,-15752 2884,-15752 2884,-15684 3279,-15684 3279,-15752"/>
<text text-anchor="middle" x="3081.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3081.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3081.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3081.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert3_gate -->
<g id="edge650" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.41,-15851.2C5867.73,-15841.62 3954.42,-15812.84 3289.24,-15752.11"/>
<polygon fill="black" stroke="black" points="3289.34,-15748.61 3279.06,-15751.17 3288.7,-15755.58 3289.34,-15748.61"/>
</g>
<!-- layer6_expert3_up -->
<g id="node461" class="node">
<title>layer6_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3692,-15752 3297,-15752 3297,-15684 3692,-15684 3692,-15752"/>
<text text-anchor="middle" x="3494.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3494.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3494.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3494.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert3_up -->
<g id="edge651" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6655.52,-15849.77C5931.21,-15837.98 4284.46,-15806.17 3702.25,-15752.12"/>
<polygon fill="black" stroke="black" points="3702.35,-15748.61 3692.06,-15751.16 3701.69,-15755.58 3702.35,-15748.61"/>
</g>
<!-- layer6_expert4_gate -->
<g id="node464" class="node">
<title>layer6_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4105,-15752 3710,-15752 3710,-15684 4105,-15684 4105,-15752"/>
<text text-anchor="middle" x="3907.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3907.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3907.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3907.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert4_gate -->
<g id="edge656" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6653.06,-15847.9C5998.59,-15833.8 4614.94,-15799.52 4115.26,-15752.12"/>
<polygon fill="black" stroke="black" points="4115.35,-15748.62 4105.06,-15751.14 4114.68,-15755.58 4115.35,-15748.62"/>
</g>
<!-- layer6_expert4_up -->
<g id="node465" class="node">
<title>layer6_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4518,-15752 4123,-15752 4123,-15684 4518,-15684 4518,-15752"/>
<text text-anchor="middle" x="4320.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4320.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4320.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4320.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert4_up -->
<g id="edge657" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6660.37,-15853.42C6183.11,-15848.35 5293.47,-15828.49 4528.19,-15752.13"/>
<polygon fill="black" stroke="black" points="4528.36,-15748.63 4518.07,-15751.12 4527.67,-15755.6 4528.36,-15748.63"/>
</g>
<!-- layer6_expert5_gate -->
<g id="node468" class="node">
<title>layer6_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4931,-15752 4536,-15752 4536,-15684 4931,-15684 4931,-15752"/>
<text text-anchor="middle" x="4733.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4733.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4733.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4733.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert5_gate -->
<g id="edge662" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6654.68,-15849.16C6245.56,-15839.67 5548.04,-15815.18 4941.34,-15752.16"/>
<polygon fill="black" stroke="black" points="4941.38,-15748.64 4931.07,-15751.09 4940.65,-15755.61 4941.38,-15748.64"/>
</g>
<!-- layer6_expert5_up -->
<g id="node469" class="node">
<title>layer6_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5344,-15752 4949,-15752 4949,-15684 5344,-15684 5344,-15752"/>
<text text-anchor="middle" x="5146.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5146.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5146.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5146.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert5_up -->
<g id="edge663" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6646.34,-15842.65C6313.6,-15828.84 5804.32,-15801.72 5354.03,-15752.14"/>
<polygon fill="black" stroke="black" points="5354.4,-15748.66 5344.07,-15751.04 5353.63,-15755.62 5354.4,-15748.66"/>
</g>
<!-- layer6_expert6_gate -->
<g id="node472" class="node">
<title>layer6_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5757,-15752 5362,-15752 5362,-15684 5757,-15684 5757,-15752"/>
<text text-anchor="middle" x="5559.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5559.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5559.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5559.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert6_gate -->
<g id="edge668" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6632.03,-15831.44C6388.4,-15814.23 6063.1,-15787.86 5767.16,-15752.18"/>
<polygon fill="black" stroke="black" points="5767.43,-15748.68 5757.08,-15750.96 5766.59,-15755.63 5767.43,-15748.68"/>
</g>
<!-- layer6_expert6_up -->
<g id="node473" class="node">
<title>layer6_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6170,-15752 5775,-15752 5775,-15684 6170,-15684 6170,-15752"/>
<text text-anchor="middle" x="5972.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5972.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5972.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5972.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert6_up -->
<g id="edge669" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6601.33,-15807.57C6469.89,-15791.37 6323.08,-15772.49 6180.37,-15752.25"/>
<polygon fill="black" stroke="black" points="6180.5,-15748.74 6170.11,-15750.79 6179.51,-15755.67 6180.5,-15748.74"/>
</g>
<!-- layer6_expert7_gate -->
<g id="node476" class="node">
<title>layer6_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6583,-15752 6188,-15752 6188,-15684 6583,-15684 6583,-15752"/>
<text text-anchor="middle" x="6385.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6385.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6385.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6385.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert7_gate -->
<g id="edge674" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6699.53,-15788C6646.4,-15776.32 6593.09,-15764.61 6545.86,-15754.23"/>
<polygon fill="black" stroke="black" points="6546.4,-15750.77 6535.88,-15752.04 6544.89,-15757.6 6546.4,-15750.77"/>
</g>
<!-- layer6_expert7_up -->
<g id="node477" class="node">
<title>layer6_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6996,-15752 6601,-15752 6601,-15684 6996,-15684 6996,-15752"/>
<text text-anchor="middle" x="6798.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6798.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6798.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6798.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert7_up -->
<g id="edge675" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6903.01,-15788C6887.37,-15777.67 6871.68,-15767.31 6857.38,-15757.87"/>
<polygon fill="black" stroke="black" points="6858.95,-15754.72 6848.68,-15752.13 6855.1,-15760.56 6858.95,-15754.72"/>
</g>
<!-- layer6_expert8_gate -->
<g id="node480" class="node">
<title>layer6_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7409,-15752 7014,-15752 7014,-15684 7409,-15684 7409,-15752"/>
<text text-anchor="middle" x="7211.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7211.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7211.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7211.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert8_gate -->
<g id="edge680" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7106.48,-15788C7122.2,-15777.67 7137.97,-15767.31 7152.33,-15757.87"/>
<polygon fill="black" stroke="black" points="7154.64,-15760.54 7161.08,-15752.13 7150.8,-15754.69 7154.64,-15760.54"/>
</g>
<!-- layer6_expert8_up -->
<g id="node481" class="node">
<title>layer6_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7822,-15752 7427,-15752 7427,-15684 7822,-15684 7822,-15752"/>
<text text-anchor="middle" x="7624.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7624.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7624.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7624.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert8_up -->
<g id="edge681" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7269.23,-15796.93C7335.49,-15782.4 7404.56,-15767.25 7463.99,-15754.21"/>
<polygon fill="black" stroke="black" points="7464.81,-15757.61 7473.82,-15752.05 7463.31,-15750.78 7464.81,-15757.61"/>
</g>
<!-- layer6_expert9_gate -->
<g id="node484" class="node">
<title>layer6_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8235,-15752 7840,-15752 7840,-15684 8235,-15684 8235,-15752"/>
<text text-anchor="middle" x="8037.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8037.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8037.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8037.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert9_gate -->
<g id="edge686" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7300.03,-15820.73C7455.07,-15802.13 7648.37,-15777.94 7829.89,-15752.22"/>
<polygon fill="black" stroke="black" points="7830.49,-15755.67 7839.89,-15750.8 7829.5,-15748.74 7830.49,-15755.67"/>
</g>
<!-- layer6_expert9_up -->
<g id="node485" class="node">
<title>layer6_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8648,-15752 8253,-15752 8253,-15684 8648,-15684 8648,-15752"/>
<text text-anchor="middle" x="8450.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8450.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8450.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8450.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert9_up -->
<g id="edge687" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.91,-15835.51C7567.39,-15818.52 7923.09,-15790.72 8242.99,-15752.16"/>
<polygon fill="black" stroke="black" points="8243.41,-15755.63 8252.92,-15750.96 8242.57,-15748.68 8243.41,-15755.63"/>
</g>
<!-- layer6_expert10_gate -->
<g id="node488" class="node">
<title>layer6_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9061,-15752 8666,-15752 8666,-15684 9061,-15684 9061,-15752"/>
<text text-anchor="middle" x="8863.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8863.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8863.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8863.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert10_gate -->
<g id="edge692" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7329.93,-15844.01C7661.51,-15830.65 8190.55,-15803.38 8655.98,-15752.14"/>
<polygon fill="black" stroke="black" points="8656.37,-15755.62 8665.93,-15751.04 8655.6,-15748.66 8656.37,-15755.62"/>
</g>
<!-- layer6_expert10_up -->
<g id="node489" class="node">
<title>layer6_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9474,-15752 9079,-15752 9079,-15684 9474,-15684 9474,-15752"/>
<text text-anchor="middle" x="9276.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9276.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9276.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9276.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert10_up -->
<g id="edge693" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7337.24,-15849.57C7744.05,-15840.37 8453.4,-15816.08 9068.97,-15752.13"/>
<polygon fill="black" stroke="black" points="9069.35,-15755.61 9078.93,-15751.09 9068.62,-15748.64 9069.35,-15755.61"/>
</g>
<!-- layer6_expert11_gate -->
<g id="node492" class="node">
<title>layer6_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9887,-15752 9492,-15752 9492,-15684 9887,-15684 9887,-15752"/>
<text text-anchor="middle" x="9689.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9689.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9689.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9689.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert11_gate -->
<g id="edge698" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7342.2,-15853.5C7818.01,-15848.55 8712.7,-15828.86 9481.76,-15752.14"/>
<polygon fill="black" stroke="black" points="9482.33,-15755.6 9491.93,-15751.12 9481.64,-15748.63 9482.33,-15755.6"/>
</g>
<!-- layer6_expert11_up -->
<g id="node493" class="node">
<title>layer6_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10300,-15752 9905,-15752 9905,-15684 10300,-15684 10300,-15752"/>
<text text-anchor="middle" x="10102.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10102.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10102.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10102.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert11_up -->
<g id="edge699" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7335.5,-15848.35C7981.28,-15834.53 9389.47,-15800.03 9894.63,-15752.13"/>
<polygon fill="black" stroke="black" points="9895.32,-15755.58 9904.94,-15751.14 9894.65,-15748.62 9895.32,-15755.58"/>
</g>
<!-- layer6_expert12_gate -->
<g id="node496" class="node">
<title>layer6_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10713,-15752 10318,-15752 10318,-15684 10713,-15684 10713,-15752"/>
<text text-anchor="middle" x="10515.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10515.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10515.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10515.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert12_gate -->
<g id="edge704" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7337.83,-15850.02C8053.92,-15838.46 9721.02,-15806.58 10307.68,-15752.13"/>
<polygon fill="black" stroke="black" points="10308.31,-15755.58 10317.94,-15751.16 10307.65,-15748.61 10308.31,-15755.58"/>
</g>
<!-- layer6_expert12_up -->
<g id="node497" class="node">
<title>layer6_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11126,-15752 10731,-15752 10731,-15684 11126,-15684 11126,-15752"/>
<text text-anchor="middle" x="10928.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10928.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10928.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10928.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert12_up -->
<g id="edge705" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7339.57,-15851.35C8121.82,-15841.92 10051.91,-15813.16 10720.7,-15752.12"/>
<polygon fill="black" stroke="black" points="10721.3,-15755.58 10730.94,-15751.17 10720.66,-15748.61 10721.3,-15755.58"/>
</g>
<!-- layer6_expert13_gate -->
<g id="node500" class="node">
<title>layer6_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11539,-15752 11144,-15752 11144,-15684 11539,-15684 11539,-15752"/>
<text text-anchor="middle" x="11341.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11341.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11341.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11341.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert13_gate -->
<g id="edge710" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7340.74,-15852.43C8185.52,-15845.03 10382.4,-15819.78 11133.8,-15752.11"/>
<polygon fill="black" stroke="black" points="11134.3,-15755.58 11143.94,-15751.18 11133.66,-15748.61 11134.3,-15755.58"/>
</g>
<!-- layer6_expert13_up -->
<g id="node501" class="node">
<title>layer6_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11952,-15752 11557,-15752 11557,-15684 11952,-15684 11952,-15752"/>
<text text-anchor="middle" x="11754.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11754.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11754.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11754.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert13_up -->
<g id="edge711" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7342.14,-15853.31C8246.83,-15847.84 10712.6,-15826.43 11546.9,-15752.1"/>
<polygon fill="black" stroke="black" points="11547.3,-15755.58 11556.94,-15751.19 11546.67,-15748.6 11547.3,-15755.58"/>
</g>
<!-- layer6_expert14_gate -->
<g id="node504" class="node">
<title>layer6_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12365,-15752 11970,-15752 11970,-15684 12365,-15684 12365,-15752"/>
<text text-anchor="middle" x="12167.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12167.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12167.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12167.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert14_gate -->
<g id="edge716" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7342.95,-15854.06C8304.58,-15850.42 11042.12,-15833.11 11959.9,-15752.1"/>
<polygon fill="black" stroke="black" points="11960.29,-15755.58 11969.94,-15751.2 11959.67,-15748.6 11960.29,-15755.58"/>
</g>
<!-- layer6_expert14_up -->
<g id="node505" class="node">
<title>layer6_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12778,-15752 12383,-15752 12383,-15684 12778,-15684 12778,-15752"/>
<text text-anchor="middle" x="12580.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12580.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12580.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12580.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert14_up -->
<g id="edge717" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7343.58,-15854.7C8359.74,-15852.8 11370.92,-15839.81 12372.71,-15752.11"/>
<polygon fill="black" stroke="black" points="12373.29,-15755.57 12382.94,-15751.21 12372.67,-15748.6 12373.29,-15755.57"/>
</g>
<!-- layer6_expert15_gate -->
<g id="node508" class="node">
<title>layer6_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13191,-15752 12796,-15752 12796,-15684 13191,-15684 13191,-15752"/>
<text text-anchor="middle" x="12993.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12993.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12993.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12993.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert15_gate -->
<g id="edge722" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7344.27,-15855.24C8413.13,-15855.02 11699.73,-15846.53 12785.64,-15752.12"/>
<polygon fill="black" stroke="black" points="12786.29,-15755.57 12795.94,-15751.21 12785.68,-15748.6 12786.29,-15755.57"/>
</g>
<!-- layer6_expert15_up -->
<g id="node509" class="node">
<title>layer6_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13604,-15752 13209,-15752 13209,-15684 13604,-15684 13604,-15752"/>
<text text-anchor="middle" x="13406.5" y="-15736.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13406.5" y="-15721.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13406.5" y="-15706.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13406.5" y="-15691.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer6_token_distribution&#45;&gt;layer6_expert15_up -->
<g id="edge723" class="edge">
<title>layer6_token_distribution&#45;&gt;layer6_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345.15,-15855.72C8465.21,-15857.1 12028.63,-15853.26 13198.69,-15752.11"/>
<polygon fill="black" stroke="black" points="13199.29,-15755.57 13208.94,-15751.22 13198.68,-15748.6 13199.29,-15755.57"/>
</g>
<!-- layer6_expert0_act -->
<g id="node450" class="node">
<title>layer6_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1214,-15648 819,-15648 819,-15580 1214,-15580 1214,-15648"/>
<text text-anchor="middle" x="1016.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1016.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1016.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1016.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_expert0_gate&#45;&gt;layer6_expert0_act -->
<g id="edge634" class="edge">
<title>layer6_expert0_gate&#45;&gt;layer6_expert0_act</title>
<path fill="none" stroke="black" d="M737.3,-15683.95C780.56,-15673.27 828.7,-15661.38 872.66,-15650.53"/>
<polygon fill="black" stroke="black" points="873.69,-15653.88 882.56,-15648.08 872.01,-15647.08 873.69,-15653.88"/>
</g>
<!-- layer6_expert0_up&#45;&gt;layer6_expert0_act -->
<g id="edge635" class="edge">
<title>layer6_expert0_up&#45;&gt;layer6_expert0_act</title>
<path fill="none" stroke="black" d="M1016.5,-15683.88C1016.5,-15675.78 1016.5,-15666.98 1016.5,-15658.47"/>
<polygon fill="black" stroke="black" points="1020,-15658.3 1016.5,-15648.3 1013,-15658.3 1020,-15658.3"/>
</g>
<!-- layer6_expert0_down -->
<g id="node451" class="node">
<title>layer6_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1420,-15544 1037,-15544 1037,-15476 1420,-15476 1420,-15544"/>
<text text-anchor="middle" x="1228.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1228.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1228.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1228.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_expert0_act&#45;&gt;layer6_expert0_down -->
<g id="edge636" class="edge">
<title>layer6_expert0_act&#45;&gt;layer6_expert0_down</title>
<path fill="none" stroke="black" d="M1085.33,-15579.88C1106.17,-15569.86 1129.21,-15558.77 1150.6,-15548.48"/>
<polygon fill="black" stroke="black" points="1152.16,-15551.61 1159.65,-15544.12 1149.12,-15545.31 1152.16,-15551.61"/>
</g>
<!-- layer6_token_aggregation -->
<g id="node512" class="node">
<title>layer6_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7477.24,-15440 6720.44,-15440 6525.76,-15304 7282.56,-15304 7477.24,-15440"/>
<text text-anchor="middle" x="7001.5" y="-15390.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="7001.5" y="-15375.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="7001.5" y="-15360.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-15345.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_expert0_down&#45;&gt;layer6_token_aggregation -->
<g id="edge637" class="edge">
<title>layer6_expert0_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M1420.25,-15497.25C1543.88,-15490.07 1708.13,-15481.29 1853.5,-15476 3634.65,-15411.18 5764.04,-15384.85 6618.82,-15376.37"/>
<polygon fill="black" stroke="black" points="6619.16,-15379.87 6629.13,-15376.27 6619.09,-15372.87 6619.16,-15379.87"/>
</g>
<!-- layer6_expert1_act -->
<g id="node454" class="node">
<title>layer6_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2040,-15648 1645,-15648 1645,-15580 2040,-15580 2040,-15648"/>
<text text-anchor="middle" x="1842.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1842.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1842.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1842.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_expert1_gate&#45;&gt;layer6_expert1_act -->
<g id="edge640" class="edge">
<title>layer6_expert1_gate&#45;&gt;layer6_expert1_act</title>
<path fill="none" stroke="black" d="M1563.3,-15683.95C1606.56,-15673.27 1654.7,-15661.38 1698.66,-15650.53"/>
<polygon fill="black" stroke="black" points="1699.69,-15653.88 1708.56,-15648.08 1698.01,-15647.08 1699.69,-15653.88"/>
</g>
<!-- layer6_expert1_up&#45;&gt;layer6_expert1_act -->
<g id="edge641" class="edge">
<title>layer6_expert1_up&#45;&gt;layer6_expert1_act</title>
<path fill="none" stroke="black" d="M1842.5,-15683.88C1842.5,-15675.78 1842.5,-15666.98 1842.5,-15658.47"/>
<polygon fill="black" stroke="black" points="1846,-15658.3 1842.5,-15648.3 1839,-15658.3 1846,-15658.3"/>
</g>
<!-- layer6_expert1_down -->
<g id="node455" class="node">
<title>layer6_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2246,-15544 1863,-15544 1863,-15476 2246,-15476 2246,-15544"/>
<text text-anchor="middle" x="2054.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2054.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2054.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2054.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_expert1_act&#45;&gt;layer6_expert1_down -->
<g id="edge642" class="edge">
<title>layer6_expert1_act&#45;&gt;layer6_expert1_down</title>
<path fill="none" stroke="black" d="M1911.33,-15579.88C1932.17,-15569.86 1955.21,-15558.77 1976.6,-15548.48"/>
<polygon fill="black" stroke="black" points="1978.16,-15551.61 1985.65,-15544.12 1975.12,-15545.31 1978.16,-15551.61"/>
</g>
<!-- layer6_expert1_down&#45;&gt;layer6_token_aggregation -->
<g id="edge643" class="edge">
<title>layer6_expert1_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M2246.33,-15498.85C2388.07,-15491.64 2585.77,-15482.17 2759.5,-15476 4185.42,-15425.32 5881.86,-15392.37 6623.27,-15379.33"/>
<polygon fill="black" stroke="black" points="6623.37,-15382.83 6633.31,-15379.15 6623.25,-15375.83 6623.37,-15382.83"/>
</g>
<!-- layer6_expert2_act -->
<g id="node458" class="node">
<title>layer6_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2866,-15648 2471,-15648 2471,-15580 2866,-15580 2866,-15648"/>
<text text-anchor="middle" x="2668.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2668.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2668.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2668.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_expert2_gate&#45;&gt;layer6_expert2_act -->
<g id="edge646" class="edge">
<title>layer6_expert2_gate&#45;&gt;layer6_expert2_act</title>
<path fill="none" stroke="black" d="M2389.3,-15683.95C2432.56,-15673.27 2480.7,-15661.38 2524.66,-15650.53"/>
<polygon fill="black" stroke="black" points="2525.69,-15653.88 2534.56,-15648.08 2524.01,-15647.08 2525.69,-15653.88"/>
</g>
<!-- layer6_expert2_up&#45;&gt;layer6_expert2_act -->
<g id="edge647" class="edge">
<title>layer6_expert2_up&#45;&gt;layer6_expert2_act</title>
<path fill="none" stroke="black" d="M2668.5,-15683.88C2668.5,-15675.78 2668.5,-15666.98 2668.5,-15658.47"/>
<polygon fill="black" stroke="black" points="2672,-15658.3 2668.5,-15648.3 2665,-15658.3 2672,-15658.3"/>
</g>
<!-- layer6_expert2_down -->
<g id="node459" class="node">
<title>layer6_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3152,-15544 2769,-15544 2769,-15476 3152,-15476 3152,-15544"/>
<text text-anchor="middle" x="2960.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2960.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2960.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2960.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_expert2_act&#45;&gt;layer6_expert2_down -->
<g id="edge648" class="edge">
<title>layer6_expert2_act&#45;&gt;layer6_expert2_down</title>
<path fill="none" stroke="black" d="M2763.3,-15579.88C2792.91,-15569.54 2825.72,-15558.08 2855.96,-15547.52"/>
<polygon fill="black" stroke="black" points="2857.39,-15550.73 2865.67,-15544.12 2855.08,-15544.12 2857.39,-15550.73"/>
</g>
<!-- layer6_expert2_down&#45;&gt;layer6_token_aggregation -->
<g id="edge649" class="edge">
<title>layer6_expert2_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M3152.34,-15499.19C3294.09,-15492.15 3491.79,-15482.75 3665.5,-15476 4740.18,-15434.26 6010.15,-15398.9 6627.29,-15382.61"/>
<polygon fill="black" stroke="black" points="6627.78,-15386.1 6637.68,-15382.34 6627.59,-15379.1 6627.78,-15386.1"/>
</g>
<!-- layer6_expert3_act -->
<g id="node462" class="node">
<title>layer6_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3692,-15648 3297,-15648 3297,-15580 3692,-15580 3692,-15648"/>
<text text-anchor="middle" x="3494.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3494.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3494.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3494.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_expert3_gate&#45;&gt;layer6_expert3_act -->
<g id="edge652" class="edge">
<title>layer6_expert3_gate&#45;&gt;layer6_expert3_act</title>
<path fill="none" stroke="black" d="M3215.3,-15683.95C3258.56,-15673.27 3306.7,-15661.38 3350.66,-15650.53"/>
<polygon fill="black" stroke="black" points="3351.69,-15653.88 3360.56,-15648.08 3350.01,-15647.08 3351.69,-15653.88"/>
</g>
<!-- layer6_expert3_up&#45;&gt;layer6_expert3_act -->
<g id="edge653" class="edge">
<title>layer6_expert3_up&#45;&gt;layer6_expert3_act</title>
<path fill="none" stroke="black" d="M3494.5,-15683.88C3494.5,-15675.78 3494.5,-15666.98 3494.5,-15658.47"/>
<polygon fill="black" stroke="black" points="3498,-15658.3 3494.5,-15648.3 3491,-15658.3 3498,-15658.3"/>
</g>
<!-- layer6_expert3_down -->
<g id="node463" class="node">
<title>layer6_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="4058,-15544 3675,-15544 3675,-15476 4058,-15476 4058,-15544"/>
<text text-anchor="middle" x="3866.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3866.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3866.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3866.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_expert3_act&#45;&gt;layer6_expert3_down -->
<g id="edge654" class="edge">
<title>layer6_expert3_act&#45;&gt;layer6_expert3_down</title>
<path fill="none" stroke="black" d="M3615.02,-15579.95C3653.66,-15569.36 3696.62,-15557.58 3735.94,-15546.8"/>
<polygon fill="black" stroke="black" points="3737.13,-15550.1 3745.85,-15544.08 3735.28,-15543.35 3737.13,-15550.1"/>
</g>
<!-- layer6_expert3_down&#45;&gt;layer6_token_aggregation -->
<g id="edge655" class="edge">
<title>layer6_expert3_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M4058.18,-15500.68C4568.64,-15478.54 5967.52,-15417.86 6636.18,-15388.85"/>
<polygon fill="black" stroke="black" points="6636.62,-15392.33 6646.46,-15388.4 6636.32,-15385.34 6636.62,-15392.33"/>
</g>
<!-- layer6_expert4_act -->
<g id="node466" class="node">
<title>layer6_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4518,-15648 4123,-15648 4123,-15580 4518,-15580 4518,-15648"/>
<text text-anchor="middle" x="4320.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4320.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4320.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4320.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_expert4_gate&#45;&gt;layer6_expert4_act -->
<g id="edge658" class="edge">
<title>layer6_expert4_gate&#45;&gt;layer6_expert4_act</title>
<path fill="none" stroke="black" d="M4041.3,-15683.95C4084.56,-15673.27 4132.7,-15661.38 4176.66,-15650.53"/>
<polygon fill="black" stroke="black" points="4177.69,-15653.88 4186.56,-15648.08 4176.01,-15647.08 4177.69,-15653.88"/>
</g>
<!-- layer6_expert4_up&#45;&gt;layer6_expert4_act -->
<g id="edge659" class="edge">
<title>layer6_expert4_up&#45;&gt;layer6_expert4_act</title>
<path fill="none" stroke="black" d="M4320.5,-15683.88C4320.5,-15675.78 4320.5,-15666.98 4320.5,-15658.47"/>
<polygon fill="black" stroke="black" points="4324,-15658.3 4320.5,-15648.3 4317,-15658.3 4324,-15658.3"/>
</g>
<!-- layer6_expert4_down -->
<g id="node467" class="node">
<title>layer6_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="5096,-15544 4713,-15544 4713,-15476 5096,-15476 5096,-15544"/>
<text text-anchor="middle" x="4904.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4904.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4904.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4904.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_expert4_act&#45;&gt;layer6_expert4_down -->
<g id="edge660" class="edge">
<title>layer6_expert4_act&#45;&gt;layer6_expert4_down</title>
<path fill="none" stroke="black" d="M4509.7,-15579.95C4572.24,-15569.03 4641.99,-15556.85 4705.25,-15545.8"/>
<polygon fill="black" stroke="black" points="4706.1,-15549.21 4715.35,-15544.04 4704.89,-15542.31 4706.1,-15549.21"/>
</g>
<!-- layer6_expert4_down&#45;&gt;layer6_token_aggregation -->
<g id="edge661" class="edge">
<title>layer6_expert4_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M5096.15,-15496.57C5447.35,-15473.79 6198.97,-15425.05 6646.07,-15396.05"/>
<polygon fill="black" stroke="black" points="6646.49,-15399.53 6656.24,-15395.39 6646.04,-15392.55 6646.49,-15399.53"/>
</g>
<!-- layer6_expert5_act -->
<g id="node470" class="node">
<title>layer6_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5344,-15648 4949,-15648 4949,-15580 5344,-15580 5344,-15648"/>
<text text-anchor="middle" x="5146.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5146.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5146.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5146.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_expert5_gate&#45;&gt;layer6_expert5_act -->
<g id="edge664" class="edge">
<title>layer6_expert5_gate&#45;&gt;layer6_expert5_act</title>
<path fill="none" stroke="black" d="M4867.3,-15683.95C4910.56,-15673.27 4958.7,-15661.38 5002.66,-15650.53"/>
<polygon fill="black" stroke="black" points="5003.69,-15653.88 5012.56,-15648.08 5002.01,-15647.08 5003.69,-15653.88"/>
</g>
<!-- layer6_expert5_up&#45;&gt;layer6_expert5_act -->
<g id="edge665" class="edge">
<title>layer6_expert5_up&#45;&gt;layer6_expert5_act</title>
<path fill="none" stroke="black" d="M5146.5,-15683.88C5146.5,-15675.78 5146.5,-15666.98 5146.5,-15658.47"/>
<polygon fill="black" stroke="black" points="5150,-15658.3 5146.5,-15648.3 5143,-15658.3 5150,-15658.3"/>
</g>
<!-- layer6_expert5_down -->
<g id="node471" class="node">
<title>layer6_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5816,-15544 5433,-15544 5433,-15476 5816,-15476 5816,-15544"/>
<text text-anchor="middle" x="5624.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5624.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5624.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5624.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_expert5_act&#45;&gt;layer6_expert5_down -->
<g id="edge666" class="edge">
<title>layer6_expert5_act&#45;&gt;layer6_expert5_down</title>
<path fill="none" stroke="black" d="M5301.36,-15579.95C5351.96,-15569.16 5408.32,-15557.13 5459.62,-15546.18"/>
<polygon fill="black" stroke="black" points="5460.43,-15549.59 5469.47,-15544.08 5458.96,-15542.74 5460.43,-15549.59"/>
</g>
<!-- layer6_expert5_down&#45;&gt;layer6_token_aggregation -->
<g id="edge667" class="edge">
<title>layer6_expert5_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M5816.33,-15490.05C6034.39,-15468.52 6394.53,-15432.95 6660.69,-15406.66"/>
<polygon fill="black" stroke="black" points="6661.3,-15410.12 6670.91,-15405.65 6660.62,-15403.15 6661.3,-15410.12"/>
</g>
<!-- layer6_expert6_act -->
<g id="node474" class="node">
<title>layer6_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6170,-15648 5775,-15648 5775,-15580 6170,-15580 6170,-15648"/>
<text text-anchor="middle" x="5972.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5972.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5972.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5972.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_expert6_gate&#45;&gt;layer6_expert6_act -->
<g id="edge670" class="edge">
<title>layer6_expert6_gate&#45;&gt;layer6_expert6_act</title>
<path fill="none" stroke="black" d="M5693.3,-15683.95C5736.56,-15673.27 5784.7,-15661.38 5828.66,-15650.53"/>
<polygon fill="black" stroke="black" points="5829.69,-15653.88 5838.56,-15648.08 5828.01,-15647.08 5829.69,-15653.88"/>
</g>
<!-- layer6_expert6_up&#45;&gt;layer6_expert6_act -->
<g id="edge671" class="edge">
<title>layer6_expert6_up&#45;&gt;layer6_expert6_act</title>
<path fill="none" stroke="black" d="M5972.5,-15683.88C5972.5,-15675.78 5972.5,-15666.98 5972.5,-15658.47"/>
<polygon fill="black" stroke="black" points="5976,-15658.3 5972.5,-15648.3 5969,-15658.3 5976,-15658.3"/>
</g>
<!-- layer6_expert6_down -->
<g id="node475" class="node">
<title>layer6_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6376,-15544 5993,-15544 5993,-15476 6376,-15476 6376,-15544"/>
<text text-anchor="middle" x="6184.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6184.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6184.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6184.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_expert6_act&#45;&gt;layer6_expert6_down -->
<g id="edge672" class="edge">
<title>layer6_expert6_act&#45;&gt;layer6_expert6_down</title>
<path fill="none" stroke="black" d="M6041.33,-15579.88C6062.17,-15569.86 6085.21,-15558.77 6106.6,-15548.48"/>
<polygon fill="black" stroke="black" points="6108.16,-15551.61 6115.65,-15544.12 6105.12,-15545.31 6108.16,-15551.61"/>
</g>
<!-- layer6_expert6_down&#45;&gt;layer6_token_aggregation -->
<g id="edge673" class="edge">
<title>layer6_expert6_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M6376.05,-15477.11C6468.57,-15461.71 6582.01,-15442.83 6686.76,-15425.39"/>
<polygon fill="black" stroke="black" points="6687.58,-15428.8 6696.87,-15423.71 6686.43,-15421.9 6687.58,-15428.8"/>
</g>
<!-- layer6_expert7_act -->
<g id="node478" class="node">
<title>layer6_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6996,-15648 6601,-15648 6601,-15580 6996,-15580 6996,-15648"/>
<text text-anchor="middle" x="6798.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6798.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6798.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6798.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_expert7_gate&#45;&gt;layer6_expert7_act -->
<g id="edge676" class="edge">
<title>layer6_expert7_gate&#45;&gt;layer6_expert7_act</title>
<path fill="none" stroke="black" d="M6519.3,-15683.95C6562.56,-15673.27 6610.7,-15661.38 6654.66,-15650.53"/>
<polygon fill="black" stroke="black" points="6655.69,-15653.88 6664.56,-15648.08 6654.01,-15647.08 6655.69,-15653.88"/>
</g>
<!-- layer6_expert7_up&#45;&gt;layer6_expert7_act -->
<g id="edge677" class="edge">
<title>layer6_expert7_up&#45;&gt;layer6_expert7_act</title>
<path fill="none" stroke="black" d="M6798.5,-15683.88C6798.5,-15675.78 6798.5,-15666.98 6798.5,-15658.47"/>
<polygon fill="black" stroke="black" points="6802,-15658.3 6798.5,-15648.3 6795,-15658.3 6802,-15658.3"/>
</g>
<!-- layer6_expert7_down -->
<g id="node479" class="node">
<title>layer6_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6993,-15544 6610,-15544 6610,-15476 6993,-15476 6993,-15544"/>
<text text-anchor="middle" x="6801.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6801.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6801.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6801.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_expert7_act&#45;&gt;layer6_expert7_down -->
<g id="edge678" class="edge">
<title>layer6_expert7_act&#45;&gt;layer6_expert7_down</title>
<path fill="none" stroke="black" d="M6799.47,-15579.88C6799.71,-15571.78 6799.97,-15562.98 6800.22,-15554.47"/>
<polygon fill="black" stroke="black" points="6803.73,-15554.4 6800.52,-15544.3 6796.73,-15554.19 6803.73,-15554.4"/>
</g>
<!-- layer6_expert7_down&#45;&gt;layer6_token_aggregation -->
<g id="edge679" class="edge">
<title>layer6_expert7_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M6850.17,-15475.9C6863.63,-15466.75 6878.8,-15456.44 6894.2,-15445.97"/>
<polygon fill="black" stroke="black" points="6896.47,-15448.66 6902.77,-15440.14 6892.53,-15442.87 6896.47,-15448.66"/>
</g>
<!-- layer6_expert8_act -->
<g id="node482" class="node">
<title>layer6_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7409,-15648 7014,-15648 7014,-15580 7409,-15580 7409,-15648"/>
<text text-anchor="middle" x="7211.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7211.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7211.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7211.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer6_expert8_gate&#45;&gt;layer6_expert8_act -->
<g id="edge682" class="edge">
<title>layer6_expert8_gate&#45;&gt;layer6_expert8_act</title>
<path fill="none" stroke="black" d="M7211.5,-15683.88C7211.5,-15675.78 7211.5,-15666.98 7211.5,-15658.47"/>
<polygon fill="black" stroke="black" points="7215,-15658.3 7211.5,-15648.3 7208,-15658.3 7215,-15658.3"/>
</g>
<!-- layer6_expert8_up&#45;&gt;layer6_expert8_act -->
<g id="edge683" class="edge">
<title>layer6_expert8_up&#45;&gt;layer6_expert8_act</title>
<path fill="none" stroke="black" d="M7490.7,-15683.95C7447.44,-15673.27 7399.3,-15661.38 7355.34,-15650.53"/>
<polygon fill="black" stroke="black" points="7355.99,-15647.08 7345.44,-15648.08 7354.31,-15653.88 7355.99,-15647.08"/>
</g>
<!-- layer6_expert8_down -->
<g id="node483" class="node">
<title>layer6_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7400,-15544 7017,-15544 7017,-15476 7400,-15476 7400,-15544"/>
<text text-anchor="middle" x="7208.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7208.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7208.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7208.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer6_expert8_act&#45;&gt;layer6_expert8_down -->
<g id="edge684" class="edge">
<title>layer6_expert8_act&#45;&gt;layer6_expert8_down</title>
<path fill="none" stroke="black" d="M7210.53,-15579.88C7210.29,-15571.78 7210.03,-15562.98 7209.78,-15554.47"/>
<polygon fill="black" stroke="black" points="7213.27,-15554.19 7209.48,-15544.3 7206.27,-15554.4 7213.27,-15554.19"/>
</g>
<!-- layer6_expert8_down&#45;&gt;layer6_token_aggregation -->
<g id="edge685" class="edge">
<title>layer6_expert8_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M7158.13,-15475.9C7144.06,-15466.66 7128.2,-15456.25 7112.12,-15445.67"/>
<polygon fill="black" stroke="black" points="7113.97,-15442.7 7103.69,-15440.14 7110.12,-15448.55 7113.97,-15442.7"/>
</g>
<!-- layer6_expert9_act -->
<g id="node486" class="node">
<title>layer6_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8235,-15648 7840,-15648 7840,-15580 8235,-15580 8235,-15648"/>
<text text-anchor="middle" x="8037.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8037.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8037.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8037.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer6_expert9_gate&#45;&gt;layer6_expert9_act -->
<g id="edge688" class="edge">
<title>layer6_expert9_gate&#45;&gt;layer6_expert9_act</title>
<path fill="none" stroke="black" d="M8037.5,-15683.88C8037.5,-15675.78 8037.5,-15666.98 8037.5,-15658.47"/>
<polygon fill="black" stroke="black" points="8041,-15658.3 8037.5,-15648.3 8034,-15658.3 8041,-15658.3"/>
</g>
<!-- layer6_expert9_up&#45;&gt;layer6_expert9_act -->
<g id="edge689" class="edge">
<title>layer6_expert9_up&#45;&gt;layer6_expert9_act</title>
<path fill="none" stroke="black" d="M8316.7,-15683.95C8273.44,-15673.27 8225.3,-15661.38 8181.34,-15650.53"/>
<polygon fill="black" stroke="black" points="8181.99,-15647.08 8171.44,-15648.08 8180.31,-15653.88 8181.99,-15647.08"/>
</g>
<!-- layer6_expert9_down -->
<g id="node487" class="node">
<title>layer6_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8016,-15544 7633,-15544 7633,-15476 8016,-15476 8016,-15544"/>
<text text-anchor="middle" x="7824.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7824.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7824.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7824.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer6_expert9_act&#45;&gt;layer6_expert9_down -->
<g id="edge690" class="edge">
<title>layer6_expert9_act&#45;&gt;layer6_expert9_down</title>
<path fill="none" stroke="black" d="M7968.35,-15579.88C7947.41,-15569.86 7924.26,-15558.77 7902.77,-15548.48"/>
<polygon fill="black" stroke="black" points="7904.2,-15545.29 7893.67,-15544.12 7901.18,-15551.6 7904.2,-15545.29"/>
</g>
<!-- layer6_expert9_down&#45;&gt;layer6_token_aggregation -->
<g id="edge691" class="edge">
<title>layer6_expert9_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M7632.84,-15477.33C7567.96,-15466.61 7492.75,-15454.18 7417.34,-15441.72"/>
<polygon fill="black" stroke="black" points="7417.62,-15438.22 7407.19,-15440.04 7416.48,-15445.12 7417.62,-15438.22"/>
</g>
<!-- layer6_expert10_act -->
<g id="node490" class="node">
<title>layer6_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9061,-15648 8666,-15648 8666,-15580 9061,-15580 9061,-15648"/>
<text text-anchor="middle" x="8863.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8863.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8863.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8863.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer6_expert10_gate&#45;&gt;layer6_expert10_act -->
<g id="edge694" class="edge">
<title>layer6_expert10_gate&#45;&gt;layer6_expert10_act</title>
<path fill="none" stroke="black" d="M8863.5,-15683.88C8863.5,-15675.78 8863.5,-15666.98 8863.5,-15658.47"/>
<polygon fill="black" stroke="black" points="8867,-15658.3 8863.5,-15648.3 8860,-15658.3 8867,-15658.3"/>
</g>
<!-- layer6_expert10_up&#45;&gt;layer6_expert10_act -->
<g id="edge695" class="edge">
<title>layer6_expert10_up&#45;&gt;layer6_expert10_act</title>
<path fill="none" stroke="black" d="M9142.7,-15683.95C9099.44,-15673.27 9051.3,-15661.38 9007.34,-15650.53"/>
<polygon fill="black" stroke="black" points="9007.99,-15647.08 8997.44,-15648.08 9006.31,-15653.88 9007.99,-15647.08"/>
</g>
<!-- layer6_expert10_down -->
<g id="node491" class="node">
<title>layer6_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8737,-15544 8354,-15544 8354,-15476 8737,-15476 8737,-15544"/>
<text text-anchor="middle" x="8545.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8545.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8545.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8545.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer6_expert10_act&#45;&gt;layer6_expert10_down -->
<g id="edge696" class="edge">
<title>layer6_expert10_act&#45;&gt;layer6_expert10_down</title>
<path fill="none" stroke="black" d="M8760.25,-15579.88C8727.65,-15569.43 8691.47,-15557.82 8658.25,-15547.16"/>
<polygon fill="black" stroke="black" points="8659.09,-15543.76 8648.5,-15544.04 8656.95,-15550.42 8659.09,-15543.76"/>
</g>
<!-- layer6_expert10_down&#45;&gt;layer6_token_aggregation -->
<g id="edge697" class="edge">
<title>layer6_expert10_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M8353.85,-15492.12C8128.46,-15472.27 7746.98,-15438.66 7446.54,-15412.2"/>
<polygon fill="black" stroke="black" points="7446.61,-15408.69 7436.34,-15411.3 7445.99,-15415.67 7446.61,-15408.69"/>
</g>
<!-- layer6_expert11_act -->
<g id="node494" class="node">
<title>layer6_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9887,-15648 9492,-15648 9492,-15580 9887,-15580 9887,-15648"/>
<text text-anchor="middle" x="9689.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9689.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9689.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9689.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer6_expert11_gate&#45;&gt;layer6_expert11_act -->
<g id="edge700" class="edge">
<title>layer6_expert11_gate&#45;&gt;layer6_expert11_act</title>
<path fill="none" stroke="black" d="M9689.5,-15683.88C9689.5,-15675.78 9689.5,-15666.98 9689.5,-15658.47"/>
<polygon fill="black" stroke="black" points="9693,-15658.3 9689.5,-15648.3 9686,-15658.3 9693,-15658.3"/>
</g>
<!-- layer6_expert11_up&#45;&gt;layer6_expert11_act -->
<g id="edge701" class="edge">
<title>layer6_expert11_up&#45;&gt;layer6_expert11_act</title>
<path fill="none" stroke="black" d="M9968.7,-15683.95C9925.44,-15673.27 9877.3,-15661.38 9833.34,-15650.53"/>
<polygon fill="black" stroke="black" points="9833.99,-15647.08 9823.44,-15648.08 9832.31,-15653.88 9833.99,-15647.08"/>
</g>
<!-- layer6_expert11_down -->
<g id="node495" class="node">
<title>layer6_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9511,-15544 9128,-15544 9128,-15476 9511,-15476 9511,-15544"/>
<text text-anchor="middle" x="9319.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9319.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9319.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9319.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer6_expert11_act&#45;&gt;layer6_expert11_down -->
<g id="edge702" class="edge">
<title>layer6_expert11_act&#45;&gt;layer6_expert11_down</title>
<path fill="none" stroke="black" d="M9569.63,-15579.95C9531.2,-15569.36 9488.47,-15557.58 9449.36,-15546.8"/>
<polygon fill="black" stroke="black" points="9450.07,-15543.36 9439.5,-15544.08 9448.21,-15550.11 9450.07,-15543.36"/>
</g>
<!-- layer6_expert11_down&#45;&gt;layer6_token_aggregation -->
<g id="edge703" class="edge">
<title>layer6_expert11_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M9127.84,-15497.75C8756.82,-15475.99 7932.55,-15427.63 7426.2,-15397.92"/>
<polygon fill="black" stroke="black" points="7426.35,-15394.42 7416.17,-15397.33 7425.94,-15401.41 7426.35,-15394.42"/>
</g>
<!-- layer6_expert12_act -->
<g id="node498" class="node">
<title>layer6_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10713,-15648 10318,-15648 10318,-15580 10713,-15580 10713,-15648"/>
<text text-anchor="middle" x="10515.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10515.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10515.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10515.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer6_expert12_gate&#45;&gt;layer6_expert12_act -->
<g id="edge706" class="edge">
<title>layer6_expert12_gate&#45;&gt;layer6_expert12_act</title>
<path fill="none" stroke="black" d="M10515.5,-15683.88C10515.5,-15675.78 10515.5,-15666.98 10515.5,-15658.47"/>
<polygon fill="black" stroke="black" points="10519,-15658.3 10515.5,-15648.3 10512,-15658.3 10519,-15658.3"/>
</g>
<!-- layer6_expert12_up&#45;&gt;layer6_expert12_act -->
<g id="edge707" class="edge">
<title>layer6_expert12_up&#45;&gt;layer6_expert12_act</title>
<path fill="none" stroke="black" d="M10794.7,-15683.95C10751.44,-15673.27 10703.3,-15661.38 10659.34,-15650.53"/>
<polygon fill="black" stroke="black" points="10659.99,-15647.08 10649.44,-15648.08 10658.31,-15653.88 10659.99,-15647.08"/>
</g>
<!-- layer6_expert12_down -->
<g id="node499" class="node">
<title>layer6_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10311,-15544 9928,-15544 9928,-15476 10311,-15476 10311,-15544"/>
<text text-anchor="middle" x="10119.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10119.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10119.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10119.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer6_expert12_act&#45;&gt;layer6_expert12_down -->
<g id="edge708" class="edge">
<title>layer6_expert12_act&#45;&gt;layer6_expert12_down</title>
<path fill="none" stroke="black" d="M10387.2,-15579.95C10345.81,-15569.29 10299.76,-15557.43 10257.69,-15546.59"/>
<polygon fill="black" stroke="black" points="10258.49,-15543.19 10247.93,-15544.08 10256.74,-15549.96 10258.49,-15543.19"/>
</g>
<!-- layer6_expert12_down&#45;&gt;layer6_token_aggregation -->
<g id="edge709" class="edge">
<title>layer6_expert12_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M9927.67,-15497.74C9810.15,-15491.01 9656.65,-15482.53 9520.5,-15476 8777.75,-15440.36 7911.41,-15406.66 7412.65,-15388.02"/>
<polygon fill="black" stroke="black" points="7412.53,-15384.52 7402.41,-15387.64 7412.27,-15391.51 7412.53,-15384.52"/>
</g>
<!-- layer6_expert13_act -->
<g id="node502" class="node">
<title>layer6_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11539,-15648 11144,-15648 11144,-15580 11539,-15580 11539,-15648"/>
<text text-anchor="middle" x="11341.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11341.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11341.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11341.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer6_expert13_gate&#45;&gt;layer6_expert13_act -->
<g id="edge712" class="edge">
<title>layer6_expert13_gate&#45;&gt;layer6_expert13_act</title>
<path fill="none" stroke="black" d="M11341.5,-15683.88C11341.5,-15675.78 11341.5,-15666.98 11341.5,-15658.47"/>
<polygon fill="black" stroke="black" points="11345,-15658.3 11341.5,-15648.3 11338,-15658.3 11345,-15658.3"/>
</g>
<!-- layer6_expert13_up&#45;&gt;layer6_expert13_act -->
<g id="edge713" class="edge">
<title>layer6_expert13_up&#45;&gt;layer6_expert13_act</title>
<path fill="none" stroke="black" d="M11620.7,-15683.95C11577.44,-15673.27 11529.3,-15661.38 11485.34,-15650.53"/>
<polygon fill="black" stroke="black" points="11485.99,-15647.08 11475.44,-15648.08 11484.31,-15653.88 11485.99,-15647.08"/>
</g>
<!-- layer6_expert13_down -->
<g id="node503" class="node">
<title>layer6_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11124,-15544 10741,-15544 10741,-15476 11124,-15476 11124,-15544"/>
<text text-anchor="middle" x="10932.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10932.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10932.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10932.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer6_expert13_act&#45;&gt;layer6_expert13_down -->
<g id="edge714" class="edge">
<title>layer6_expert13_act&#45;&gt;layer6_expert13_down</title>
<path fill="none" stroke="black" d="M11208.99,-15579.95C11166.15,-15569.27 11118.48,-15557.38 11074.95,-15546.53"/>
<polygon fill="black" stroke="black" points="11075.7,-15543.1 11065.15,-15544.08 11074,-15549.9 11075.7,-15543.1"/>
</g>
<!-- layer6_expert13_down&#45;&gt;layer6_token_aggregation -->
<g id="edge715" class="edge">
<title>layer6_expert13_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M10740.98,-15497.55C10620.35,-15490.61 10461.36,-15481.98 10320.5,-15476 9269.09,-15431.34 8029.53,-15398 7404.76,-15382.54"/>
<polygon fill="black" stroke="black" points="7404.78,-15379.04 7394.69,-15382.3 7404.6,-15386.04 7404.78,-15379.04"/>
</g>
<!-- layer6_expert14_act -->
<g id="node506" class="node">
<title>layer6_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12365,-15648 11970,-15648 11970,-15580 12365,-15580 12365,-15648"/>
<text text-anchor="middle" x="12167.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12167.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12167.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12167.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer6_expert14_gate&#45;&gt;layer6_expert14_act -->
<g id="edge718" class="edge">
<title>layer6_expert14_gate&#45;&gt;layer6_expert14_act</title>
<path fill="none" stroke="black" d="M12167.5,-15683.88C12167.5,-15675.78 12167.5,-15666.98 12167.5,-15658.47"/>
<polygon fill="black" stroke="black" points="12171,-15658.3 12167.5,-15648.3 12164,-15658.3 12171,-15658.3"/>
</g>
<!-- layer6_expert14_up&#45;&gt;layer6_expert14_act -->
<g id="edge719" class="edge">
<title>layer6_expert14_up&#45;&gt;layer6_expert14_act</title>
<path fill="none" stroke="black" d="M12446.7,-15683.95C12403.44,-15673.27 12355.3,-15661.38 12311.34,-15650.53"/>
<polygon fill="black" stroke="black" points="12311.99,-15647.08 12301.44,-15648.08 12310.31,-15653.88 12311.99,-15647.08"/>
</g>
<!-- layer6_expert14_down -->
<g id="node507" class="node">
<title>layer6_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11943,-15544 11560,-15544 11560,-15476 11943,-15476 11943,-15544"/>
<text text-anchor="middle" x="11751.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11751.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11751.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11751.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer6_expert14_act&#45;&gt;layer6_expert14_down -->
<g id="edge720" class="edge">
<title>layer6_expert14_act&#45;&gt;layer6_expert14_down</title>
<path fill="none" stroke="black" d="M12032.72,-15579.95C11989.15,-15569.27 11940.66,-15557.38 11896.39,-15546.53"/>
<polygon fill="black" stroke="black" points="11896.96,-15543.06 11886.42,-15544.08 11895.3,-15549.86 11896.96,-15543.06"/>
</g>
<!-- layer6_expert14_down&#45;&gt;layer6_token_aggregation -->
<g id="edge721" class="edge">
<title>layer6_expert14_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M11559.83,-15497.36C11437.82,-15490.3 11276.43,-15481.6 11133.5,-15476 9763.85,-15422.37 8137.66,-15391.43 7400.32,-15379.17"/>
<polygon fill="black" stroke="black" points="7400.12,-15375.67 7390.07,-15379 7400.01,-15382.67 7400.12,-15375.67"/>
</g>
<!-- layer6_expert15_act -->
<g id="node510" class="node">
<title>layer6_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13191,-15648 12796,-15648 12796,-15580 13191,-15580 13191,-15648"/>
<text text-anchor="middle" x="12993.5" y="-15632.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12993.5" y="-15617.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12993.5" y="-15602.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12993.5" y="-15587.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer6_expert15_gate&#45;&gt;layer6_expert15_act -->
<g id="edge724" class="edge">
<title>layer6_expert15_gate&#45;&gt;layer6_expert15_act</title>
<path fill="none" stroke="black" d="M12993.5,-15683.88C12993.5,-15675.78 12993.5,-15666.98 12993.5,-15658.47"/>
<polygon fill="black" stroke="black" points="12997,-15658.3 12993.5,-15648.3 12990,-15658.3 12997,-15658.3"/>
</g>
<!-- layer6_expert15_up&#45;&gt;layer6_expert15_act -->
<g id="edge725" class="edge">
<title>layer6_expert15_up&#45;&gt;layer6_expert15_act</title>
<path fill="none" stroke="black" d="M13272.7,-15683.95C13229.44,-15673.27 13181.3,-15661.38 13137.34,-15650.53"/>
<polygon fill="black" stroke="black" points="13137.99,-15647.08 13127.44,-15648.08 13136.31,-15653.88 13137.99,-15647.08"/>
</g>
<!-- layer6_expert15_down -->
<g id="node511" class="node">
<title>layer6_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12766,-15544 12383,-15544 12383,-15476 12766,-15476 12766,-15544"/>
<text text-anchor="middle" x="12574.5" y="-15528.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12574.5" y="-15513.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12574.5" y="-15498.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12574.5" y="-15483.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer6_expert15_act&#45;&gt;layer6_expert15_down -->
<g id="edge726" class="edge">
<title>layer6_expert15_act&#45;&gt;layer6_expert15_down</title>
<path fill="none" stroke="black" d="M12857.75,-15579.95C12813.77,-15569.25 12764.82,-15557.33 12720.15,-15546.46"/>
<polygon fill="black" stroke="black" points="12720.93,-15543.05 12710.39,-15544.08 12719.28,-15549.85 12720.93,-15543.05"/>
</g>
<!-- layer6_expert15_down&#45;&gt;layer6_token_aggregation -->
<g id="edge727" class="edge">
<title>layer6_expert15_down&#45;&gt;layer6_token_aggregation</title>
<path fill="none" stroke="black" d="M12382.98,-15497.24C12260.02,-15490.09 12096.9,-15481.33 11952.5,-15476 10258.24,-15413.45 8236.33,-15386.15 7396.93,-15376.91"/>
<polygon fill="black" stroke="black" points="7396.84,-15373.4 7386.8,-15376.79 7396.76,-15380.4 7396.84,-15373.4"/>
</g>
<!-- layer6_res2 -->
<g id="node513" class="node">
<title>layer6_res2</title>
<polygon fill="none" stroke="black" points="7442.24,-15268 6741.12,-15268 6560.76,-15102 7261.88,-15102 7442.24,-15268"/>
<text text-anchor="middle" x="7001.5" y="-15211.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7001.5" y="-15196.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-15181.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-15166.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-15151.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_token_aggregation&#45;&gt;layer6_res2 -->
<g id="edge728" class="edge">
<title>layer6_token_aggregation&#45;&gt;layer6_res2</title>
<path fill="none" stroke="black" d="M7001.5,-15303.95C7001.5,-15295.63 7001.5,-15287 7001.5,-15278.38"/>
<polygon fill="black" stroke="black" points="7005,-15278.28 7001.5,-15268.28 6998,-15278.28 7005,-15278.28"/>
</g>
<!-- layer7_mha_qkv -->
<g id="node514" class="node">
<title>layer7_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7237.5,-15066 6765.5,-15066 6765.5,-14998 7237.5,-14998 7237.5,-15066"/>
<text text-anchor="middle" x="7001.5" y="-15050.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="7001.5" y="-15035.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-15020.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7001.5" y="-15005.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_res2&#45;&gt;layer7_mha_qkv -->
<g id="edge729" class="edge">
<title>layer6_res2&#45;&gt;layer7_mha_qkv</title>
<path fill="none" stroke="black" d="M7001.5,-15101.87C7001.5,-15093.12 7001.5,-15084.48 7001.5,-15076.45"/>
<polygon fill="black" stroke="black" points="7005,-15076.26 7001.5,-15066.26 6998,-15076.26 7005,-15076.26"/>
</g>
<!-- layer7_mha_attn -->
<g id="node515" class="node">
<title>layer7_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7231.5,-14962 6771.5,-14962 6771.5,-14894 7231.5,-14894 7231.5,-14962"/>
<text text-anchor="middle" x="7001.5" y="-14946.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7001.5" y="-14931.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7001.5" y="-14916.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14901.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_mha_qkv&#45;&gt;layer7_mha_attn -->
<g id="edge730" class="edge">
<title>layer7_mha_qkv&#45;&gt;layer7_mha_attn</title>
<path fill="none" stroke="black" d="M7001.5,-14997.88C7001.5,-14989.78 7001.5,-14980.98 7001.5,-14972.47"/>
<polygon fill="black" stroke="black" points="7005,-14972.3 7001.5,-14962.3 6998,-14972.3 7005,-14972.3"/>
</g>
<!-- layer7_mha_out -->
<g id="node516" class="node">
<title>layer7_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7214,-14858 6789,-14858 6789,-14790 7214,-14790 7214,-14858"/>
<text text-anchor="middle" x="7001.5" y="-14842.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="7001.5" y="-14827.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14812.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14797.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_mha_attn&#45;&gt;layer7_mha_out -->
<g id="edge731" class="edge">
<title>layer7_mha_attn&#45;&gt;layer7_mha_out</title>
<path fill="none" stroke="black" d="M7001.5,-14893.88C7001.5,-14885.78 7001.5,-14876.98 7001.5,-14868.47"/>
<polygon fill="black" stroke="black" points="7005,-14868.3 7001.5,-14858.3 6998,-14868.3 7005,-14868.3"/>
</g>
<!-- layer7_res1 -->
<g id="node517" class="node">
<title>layer7_res1</title>
<polygon fill="none" stroke="black" points="7442.24,-14754 6741.12,-14754 6560.76,-14588 7261.88,-14588 7442.24,-14754"/>
<text text-anchor="middle" x="7001.5" y="-14697.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7001.5" y="-14682.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14667.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14652.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14637.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_mha_out&#45;&gt;layer7_res1 -->
<g id="edge732" class="edge">
<title>layer7_mha_out&#45;&gt;layer7_res1</title>
<path fill="none" stroke="black" d="M7001.5,-14789.86C7001.5,-14782.1 7001.5,-14773.46 7001.5,-14764.48"/>
<polygon fill="black" stroke="black" points="7005,-14764.23 7001.5,-14754.23 6998,-14764.23 7005,-14764.23"/>
</g>
<!-- layer7_ln1 -->
<g id="node518" class="node">
<title>layer7_ln1</title>
<polygon fill="yellow" stroke="black" points="7214,-14552 6789,-14552 6789,-14484 7214,-14484 7214,-14552"/>
<text text-anchor="middle" x="7001.5" y="-14536.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7001.5" y="-14521.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14506.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14491.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_res1&#45;&gt;layer7_ln1 -->
<g id="edge733" class="edge">
<title>layer7_res1&#45;&gt;layer7_ln1</title>
<path fill="none" stroke="black" d="M7001.5,-14587.87C7001.5,-14579.12 7001.5,-14570.48 7001.5,-14562.45"/>
<polygon fill="black" stroke="black" points="7005,-14562.26 7001.5,-14552.26 6998,-14562.26 7005,-14562.26"/>
</g>
<!-- layer7_expert_routing -->
<g id="node519" class="node">
<title>layer7_expert_routing</title>
<polygon fill="orange" stroke="black" points="7001.5,-14448 6585.5,-14365 7001.5,-14282 7417.5,-14365 7001.5,-14448"/>
<text text-anchor="middle" x="7001.5" y="-14391.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="7001.5" y="-14376.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="7001.5" y="-14361.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14346.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="7001.5" y="-14331.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_ln1&#45;&gt;layer7_expert_routing -->
<g id="edge734" class="edge">
<title>layer7_ln1&#45;&gt;layer7_expert_routing</title>
<path fill="none" stroke="black" d="M7001.5,-14483.86C7001.5,-14476.1 7001.5,-14467.46 7001.5,-14458.48"/>
<polygon fill="black" stroke="black" points="7005,-14458.23 7001.5,-14448.23 6998,-14458.23 7005,-14458.23"/>
</g>
<!-- layer7_token_distribution -->
<g id="node520" class="node">
<title>layer7_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7429.86,-14246 6748.44,-14246 6573.14,-14110 7254.56,-14110 7429.86,-14246"/>
<text text-anchor="middle" x="7001.5" y="-14196.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="7001.5" y="-14181.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7001.5" y="-14166.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="7001.5" y="-14151.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer7_expert_routing&#45;&gt;layer7_token_distribution -->
<g id="edge735" class="edge">
<title>layer7_expert_routing&#45;&gt;layer7_token_distribution</title>
<path fill="none" stroke="black" d="M7001.5,-14281.78C7001.5,-14273.34 7001.5,-14264.79 7001.5,-14256.4"/>
<polygon fill="black" stroke="black" points="7005,-14256.28 7001.5,-14246.28 6998,-14256.28 7005,-14256.28"/>
</g>
<!-- layer7_expert0_gate -->
<g id="node521" class="node">
<title>layer7_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="798,-14074 403,-14074 403,-14006 798,-14006 798,-14074"/>
<text text-anchor="middle" x="600.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="600.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="600.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="600.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert0_gate -->
<g id="edge736" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6660.42,-14177.72C5539.99,-14179.09 1978.01,-14175.23 808.31,-14074.11"/>
<polygon fill="black" stroke="black" points="808.32,-14070.6 798.06,-14073.22 807.71,-14077.57 808.32,-14070.6"/>
</g>
<!-- layer7_expert0_up -->
<g id="node522" class="node">
<title>layer7_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1211,-14074 816,-14074 816,-14006 1211,-14006 1211,-14074"/>
<text text-anchor="middle" x="1013.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1013.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1013.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1013.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert0_up -->
<g id="edge737" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6659.42,-14177.24C5588.28,-14177 2306.27,-14168.44 1221.35,-14074.12"/>
<polygon fill="black" stroke="black" points="1221.32,-14070.6 1211.06,-14073.21 1220.71,-14077.57 1221.32,-14070.6"/>
</g>
<!-- layer7_expert1_gate -->
<g id="node525" class="node">
<title>layer7_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1624,-14074 1229,-14074 1229,-14006 1624,-14006 1624,-14074"/>
<text text-anchor="middle" x="1426.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1426.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1426.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1426.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert1_gate -->
<g id="edge742" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6658.86,-14176.69C5639.38,-14174.77 2634.69,-14161.69 1634.28,-14074.11"/>
<polygon fill="black" stroke="black" points="1634.33,-14070.6 1624.06,-14073.21 1633.71,-14077.57 1634.33,-14070.6"/>
</g>
<!-- layer7_expert1_up -->
<g id="node526" class="node">
<title>layer7_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2037,-14074 1642,-14074 1642,-14006 2037,-14006 2037,-14074"/>
<text text-anchor="middle" x="1839.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1839.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1839.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1839.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert1_up -->
<g id="edge743" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.92,-14176.04C5691.86,-14172.35 2963.03,-14154.95 2047.08,-14074.09"/>
<polygon fill="black" stroke="black" points="2047.33,-14070.6 2037.06,-14073.2 2046.71,-14077.58 2047.33,-14070.6"/>
</g>
<!-- layer7_expert2_gate -->
<g id="node529" class="node">
<title>layer7_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2450,-14074 2055,-14074 2055,-14006 2450,-14006 2450,-14074"/>
<text text-anchor="middle" x="2252.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2252.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2252.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2252.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert2_gate -->
<g id="edge748" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6656.93,-14175.27C5746.78,-14169.72 3292.04,-14148.22 2460.07,-14074.1"/>
<polygon fill="black" stroke="black" points="2460.33,-14070.6 2450.06,-14073.19 2459.7,-14077.58 2460.33,-14070.6"/>
</g>
<!-- layer7_expert2_up -->
<g id="node530" class="node">
<title>layer7_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2863,-14074 2468,-14074 2468,-14006 2863,-14006 2863,-14074"/>
<text text-anchor="middle" x="2665.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2665.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2665.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2665.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert2_up -->
<g id="edge749" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6655.99,-14174.34C5804.65,-14166.84 3621.62,-14141.52 2873.16,-14074.1"/>
<polygon fill="black" stroke="black" points="2873.34,-14070.61 2863.06,-14073.18 2872.7,-14077.58 2873.34,-14070.61"/>
</g>
<!-- layer7_expert3_gate -->
<g id="node533" class="node">
<title>layer7_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3276,-14074 2881,-14074 2881,-14006 3276,-14006 3276,-14074"/>
<text text-anchor="middle" x="3078.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3078.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3078.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3078.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert3_gate -->
<g id="edge754" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6654.41,-14173.2C5864.73,-14163.62 3951.42,-14134.84 3286.24,-14074.11"/>
<polygon fill="black" stroke="black" points="3286.34,-14070.61 3276.06,-14073.17 3285.7,-14077.58 3286.34,-14070.61"/>
</g>
<!-- layer7_expert3_up -->
<g id="node534" class="node">
<title>layer7_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3689,-14074 3294,-14074 3294,-14006 3689,-14006 3689,-14074"/>
<text text-anchor="middle" x="3491.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3491.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3491.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3491.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert3_up -->
<g id="edge755" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6652.52,-14171.77C5928.21,-14159.98 4281.46,-14128.17 3699.25,-14074.12"/>
<polygon fill="black" stroke="black" points="3699.35,-14070.61 3689.06,-14073.16 3698.69,-14077.58 3699.35,-14070.61"/>
</g>
<!-- layer7_expert4_gate -->
<g id="node537" class="node">
<title>layer7_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4102,-14074 3707,-14074 3707,-14006 4102,-14006 4102,-14074"/>
<text text-anchor="middle" x="3904.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3904.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3904.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3904.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert4_gate -->
<g id="edge760" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6650.06,-14169.9C5995.59,-14155.8 4611.94,-14121.52 4112.26,-14074.12"/>
<polygon fill="black" stroke="black" points="4112.35,-14070.62 4102.06,-14073.14 4111.68,-14077.58 4112.35,-14070.62"/>
</g>
<!-- layer7_expert4_up -->
<g id="node538" class="node">
<title>layer7_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4515,-14074 4120,-14074 4120,-14006 4515,-14006 4515,-14074"/>
<text text-anchor="middle" x="4317.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4317.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4317.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4317.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert4_up -->
<g id="edge761" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.37,-14175.42C6180.11,-14170.35 5290.47,-14150.49 4525.19,-14074.13"/>
<polygon fill="black" stroke="black" points="4525.36,-14070.63 4515.07,-14073.12 4524.67,-14077.6 4525.36,-14070.63"/>
</g>
<!-- layer7_expert5_gate -->
<g id="node541" class="node">
<title>layer7_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4928,-14074 4533,-14074 4533,-14006 4928,-14006 4928,-14074"/>
<text text-anchor="middle" x="4730.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4730.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4730.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4730.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert5_gate -->
<g id="edge766" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6651.68,-14171.16C6242.56,-14161.67 5545.04,-14137.18 4938.34,-14074.16"/>
<polygon fill="black" stroke="black" points="4938.38,-14070.64 4928.07,-14073.09 4937.65,-14077.61 4938.38,-14070.64"/>
</g>
<!-- layer7_expert5_up -->
<g id="node542" class="node">
<title>layer7_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5341,-14074 4946,-14074 4946,-14006 5341,-14006 5341,-14074"/>
<text text-anchor="middle" x="5143.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5143.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5143.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5143.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert5_up -->
<g id="edge767" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6643.34,-14164.65C6310.6,-14150.84 5801.32,-14123.72 5351.03,-14074.14"/>
<polygon fill="black" stroke="black" points="5351.4,-14070.66 5341.07,-14073.04 5350.63,-14077.62 5351.4,-14070.66"/>
</g>
<!-- layer7_expert6_gate -->
<g id="node545" class="node">
<title>layer7_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5754,-14074 5359,-14074 5359,-14006 5754,-14006 5754,-14074"/>
<text text-anchor="middle" x="5556.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5556.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5556.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5556.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert6_gate -->
<g id="edge772" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6629.03,-14153.44C6385.4,-14136.23 6060.1,-14109.86 5764.16,-14074.18"/>
<polygon fill="black" stroke="black" points="5764.43,-14070.68 5754.08,-14072.96 5763.59,-14077.63 5764.43,-14070.68"/>
</g>
<!-- layer7_expert6_up -->
<g id="node546" class="node">
<title>layer7_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6167,-14074 5772,-14074 5772,-14006 6167,-14006 6167,-14074"/>
<text text-anchor="middle" x="5969.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5969.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5969.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5969.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert6_up -->
<g id="edge773" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6598.33,-14129.57C6466.89,-14113.37 6320.08,-14094.49 6177.37,-14074.25"/>
<polygon fill="black" stroke="black" points="6177.5,-14070.74 6167.11,-14072.79 6176.51,-14077.67 6177.5,-14070.74"/>
</g>
<!-- layer7_expert7_gate -->
<g id="node549" class="node">
<title>layer7_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6580,-14074 6185,-14074 6185,-14006 6580,-14006 6580,-14074"/>
<text text-anchor="middle" x="6382.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6382.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6382.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6382.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert7_gate -->
<g id="edge778" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6696.53,-14110C6643.4,-14098.32 6590.09,-14086.61 6542.86,-14076.23"/>
<polygon fill="black" stroke="black" points="6543.4,-14072.77 6532.88,-14074.04 6541.89,-14079.6 6543.4,-14072.77"/>
</g>
<!-- layer7_expert7_up -->
<g id="node550" class="node">
<title>layer7_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6993,-14074 6598,-14074 6598,-14006 6993,-14006 6993,-14074"/>
<text text-anchor="middle" x="6795.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6795.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6795.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6795.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert7_up -->
<g id="edge779" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6900.01,-14110C6884.37,-14099.67 6868.68,-14089.31 6854.38,-14079.87"/>
<polygon fill="black" stroke="black" points="6855.95,-14076.72 6845.68,-14074.13 6852.1,-14082.56 6855.95,-14076.72"/>
</g>
<!-- layer7_expert8_gate -->
<g id="node553" class="node">
<title>layer7_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7406,-14074 7011,-14074 7011,-14006 7406,-14006 7406,-14074"/>
<text text-anchor="middle" x="7208.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7208.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7208.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7208.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert8_gate -->
<g id="edge784" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7103.48,-14110C7119.2,-14099.67 7134.97,-14089.31 7149.33,-14079.87"/>
<polygon fill="black" stroke="black" points="7151.64,-14082.54 7158.08,-14074.13 7147.8,-14076.69 7151.64,-14082.54"/>
</g>
<!-- layer7_expert8_up -->
<g id="node554" class="node">
<title>layer7_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7819,-14074 7424,-14074 7424,-14006 7819,-14006 7819,-14074"/>
<text text-anchor="middle" x="7621.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7621.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7621.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7621.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert8_up -->
<g id="edge785" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7266.23,-14118.93C7332.49,-14104.4 7401.56,-14089.25 7460.99,-14076.21"/>
<polygon fill="black" stroke="black" points="7461.81,-14079.61 7470.82,-14074.05 7460.31,-14072.78 7461.81,-14079.61"/>
</g>
<!-- layer7_expert9_gate -->
<g id="node557" class="node">
<title>layer7_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8232,-14074 7837,-14074 7837,-14006 8232,-14006 8232,-14074"/>
<text text-anchor="middle" x="8034.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8034.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8034.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8034.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert9_gate -->
<g id="edge790" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7297.03,-14142.73C7452.07,-14124.13 7645.37,-14099.94 7826.89,-14074.22"/>
<polygon fill="black" stroke="black" points="7827.49,-14077.67 7836.89,-14072.8 7826.5,-14070.74 7827.49,-14077.67"/>
</g>
<!-- layer7_expert9_up -->
<g id="node558" class="node">
<title>layer7_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8645,-14074 8250,-14074 8250,-14006 8645,-14006 8645,-14074"/>
<text text-anchor="middle" x="8447.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8447.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8447.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8447.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert9_up -->
<g id="edge791" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7315.91,-14157.51C7564.39,-14140.52 7920.09,-14112.72 8239.99,-14074.16"/>
<polygon fill="black" stroke="black" points="8240.41,-14077.63 8249.92,-14072.96 8239.57,-14070.68 8240.41,-14077.63"/>
</g>
<!-- layer7_expert10_gate -->
<g id="node561" class="node">
<title>layer7_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9058,-14074 8663,-14074 8663,-14006 9058,-14006 9058,-14074"/>
<text text-anchor="middle" x="8860.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8860.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8860.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8860.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert10_gate -->
<g id="edge796" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7326.93,-14166.01C7658.51,-14152.65 8187.55,-14125.38 8652.98,-14074.14"/>
<polygon fill="black" stroke="black" points="8653.37,-14077.62 8662.93,-14073.04 8652.6,-14070.66 8653.37,-14077.62"/>
</g>
<!-- layer7_expert10_up -->
<g id="node562" class="node">
<title>layer7_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9471,-14074 9076,-14074 9076,-14006 9471,-14006 9471,-14074"/>
<text text-anchor="middle" x="9273.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9273.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9273.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9273.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert10_up -->
<g id="edge797" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7334.24,-14171.57C7741.05,-14162.37 8450.4,-14138.08 9065.97,-14074.13"/>
<polygon fill="black" stroke="black" points="9066.35,-14077.61 9075.93,-14073.09 9065.62,-14070.64 9066.35,-14077.61"/>
</g>
<!-- layer7_expert11_gate -->
<g id="node565" class="node">
<title>layer7_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9884,-14074 9489,-14074 9489,-14006 9884,-14006 9884,-14074"/>
<text text-anchor="middle" x="9686.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9686.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9686.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9686.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert11_gate -->
<g id="edge802" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7339.2,-14175.5C7815.01,-14170.55 8709.7,-14150.86 9478.76,-14074.14"/>
<polygon fill="black" stroke="black" points="9479.33,-14077.6 9488.93,-14073.12 9478.64,-14070.63 9479.33,-14077.6"/>
</g>
<!-- layer7_expert11_up -->
<g id="node566" class="node">
<title>layer7_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10297,-14074 9902,-14074 9902,-14006 10297,-14006 10297,-14074"/>
<text text-anchor="middle" x="10099.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10099.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10099.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10099.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert11_up -->
<g id="edge803" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7332.5,-14170.35C7978.28,-14156.53 9386.47,-14122.03 9891.63,-14074.13"/>
<polygon fill="black" stroke="black" points="9892.32,-14077.58 9901.94,-14073.14 9891.65,-14070.62 9892.32,-14077.58"/>
</g>
<!-- layer7_expert12_gate -->
<g id="node569" class="node">
<title>layer7_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10710,-14074 10315,-14074 10315,-14006 10710,-14006 10710,-14074"/>
<text text-anchor="middle" x="10512.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10512.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10512.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10512.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert12_gate -->
<g id="edge808" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7334.83,-14172.02C8050.92,-14160.46 9718.02,-14128.58 10304.68,-14074.13"/>
<polygon fill="black" stroke="black" points="10305.31,-14077.58 10314.94,-14073.16 10304.65,-14070.61 10305.31,-14077.58"/>
</g>
<!-- layer7_expert12_up -->
<g id="node570" class="node">
<title>layer7_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11123,-14074 10728,-14074 10728,-14006 11123,-14006 11123,-14074"/>
<text text-anchor="middle" x="10925.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10925.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10925.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10925.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert12_up -->
<g id="edge809" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7336.57,-14173.35C8118.82,-14163.92 10048.91,-14135.16 10717.7,-14074.12"/>
<polygon fill="black" stroke="black" points="10718.3,-14077.58 10727.94,-14073.17 10717.66,-14070.61 10718.3,-14077.58"/>
</g>
<!-- layer7_expert13_gate -->
<g id="node573" class="node">
<title>layer7_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11536,-14074 11141,-14074 11141,-14006 11536,-14006 11536,-14074"/>
<text text-anchor="middle" x="11338.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11338.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11338.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11338.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert13_gate -->
<g id="edge814" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7337.74,-14174.43C8182.52,-14167.03 10379.4,-14141.78 11130.8,-14074.11"/>
<polygon fill="black" stroke="black" points="11131.3,-14077.58 11140.94,-14073.18 11130.66,-14070.61 11131.3,-14077.58"/>
</g>
<!-- layer7_expert13_up -->
<g id="node574" class="node">
<title>layer7_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11949,-14074 11554,-14074 11554,-14006 11949,-14006 11949,-14074"/>
<text text-anchor="middle" x="11751.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11751.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11751.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11751.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert13_up -->
<g id="edge815" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7339.14,-14175.31C8243.83,-14169.84 10709.6,-14148.43 11543.9,-14074.1"/>
<polygon fill="black" stroke="black" points="11544.3,-14077.58 11553.94,-14073.19 11543.67,-14070.6 11544.3,-14077.58"/>
</g>
<!-- layer7_expert14_gate -->
<g id="node577" class="node">
<title>layer7_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12362,-14074 11967,-14074 11967,-14006 12362,-14006 12362,-14074"/>
<text text-anchor="middle" x="12164.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12164.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12164.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12164.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert14_gate -->
<g id="edge820" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7339.95,-14176.06C8301.58,-14172.42 11039.12,-14155.11 11956.9,-14074.1"/>
<polygon fill="black" stroke="black" points="11957.29,-14077.58 11966.94,-14073.2 11956.67,-14070.6 11957.29,-14077.58"/>
</g>
<!-- layer7_expert14_up -->
<g id="node578" class="node">
<title>layer7_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12775,-14074 12380,-14074 12380,-14006 12775,-14006 12775,-14074"/>
<text text-anchor="middle" x="12577.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12577.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12577.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12577.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert14_up -->
<g id="edge821" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7340.58,-14176.7C8356.74,-14174.8 11367.92,-14161.81 12369.71,-14074.11"/>
<polygon fill="black" stroke="black" points="12370.29,-14077.57 12379.94,-14073.21 12369.67,-14070.6 12370.29,-14077.57"/>
</g>
<!-- layer7_expert15_gate -->
<g id="node581" class="node">
<title>layer7_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13188,-14074 12793,-14074 12793,-14006 13188,-14006 13188,-14074"/>
<text text-anchor="middle" x="12990.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12990.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12990.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12990.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert15_gate -->
<g id="edge826" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7341.27,-14177.24C8410.13,-14177.02 11696.73,-14168.53 12782.64,-14074.12"/>
<polygon fill="black" stroke="black" points="12783.29,-14077.57 12792.94,-14073.21 12782.68,-14070.6 12783.29,-14077.57"/>
</g>
<!-- layer7_expert15_up -->
<g id="node582" class="node">
<title>layer7_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13601,-14074 13206,-14074 13206,-14006 13601,-14006 13601,-14074"/>
<text text-anchor="middle" x="13403.5" y="-14058.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13403.5" y="-14043.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13403.5" y="-14028.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13403.5" y="-14013.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer7_token_distribution&#45;&gt;layer7_expert15_up -->
<g id="edge827" class="edge">
<title>layer7_token_distribution&#45;&gt;layer7_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7342.15,-14177.72C8462.21,-14179.1 12025.63,-14175.26 13195.69,-14074.11"/>
<polygon fill="black" stroke="black" points="13196.29,-14077.57 13205.94,-14073.22 13195.68,-14070.6 13196.29,-14077.57"/>
</g>
<!-- layer7_expert0_act -->
<g id="node523" class="node">
<title>layer7_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1211,-13970 816,-13970 816,-13902 1211,-13902 1211,-13970"/>
<text text-anchor="middle" x="1013.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1013.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1013.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1013.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_expert0_gate&#45;&gt;layer7_expert0_act -->
<g id="edge738" class="edge">
<title>layer7_expert0_gate&#45;&gt;layer7_expert0_act</title>
<path fill="none" stroke="black" d="M734.3,-14005.95C777.56,-13995.27 825.7,-13983.38 869.66,-13972.53"/>
<polygon fill="black" stroke="black" points="870.69,-13975.88 879.56,-13970.08 869.01,-13969.08 870.69,-13975.88"/>
</g>
<!-- layer7_expert0_up&#45;&gt;layer7_expert0_act -->
<g id="edge739" class="edge">
<title>layer7_expert0_up&#45;&gt;layer7_expert0_act</title>
<path fill="none" stroke="black" d="M1013.5,-14005.88C1013.5,-13997.78 1013.5,-13988.98 1013.5,-13980.47"/>
<polygon fill="black" stroke="black" points="1017,-13980.3 1013.5,-13970.3 1010,-13980.3 1017,-13980.3"/>
</g>
<!-- layer7_expert0_down -->
<g id="node524" class="node">
<title>layer7_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1630,-13866 1247,-13866 1247,-13798 1630,-13798 1630,-13866"/>
<text text-anchor="middle" x="1438.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1438.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1438.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1438.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_expert0_act&#45;&gt;layer7_expert0_down -->
<g id="edge740" class="edge">
<title>layer7_expert0_act&#45;&gt;layer7_expert0_down</title>
<path fill="none" stroke="black" d="M1151.19,-13901.95C1195.8,-13891.25 1245.45,-13879.33 1290.76,-13868.46"/>
<polygon fill="black" stroke="black" points="1291.76,-13871.82 1300.66,-13866.08 1290.12,-13865.01 1291.76,-13871.82"/>
</g>
<!-- layer7_token_aggregation -->
<g id="node585" class="node">
<title>layer7_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7474.24,-13762 6717.44,-13762 6522.76,-13626 7279.56,-13626 7474.24,-13762"/>
<text text-anchor="middle" x="6998.5" y="-13712.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6998.5" y="-13697.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6998.5" y="-13682.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13667.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_expert0_down&#45;&gt;layer7_token_aggregation -->
<g id="edge741" class="edge">
<title>layer7_expert0_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M1630.25,-13819.29C1753.88,-13812.13 1918.13,-13803.35 2063.5,-13798 3760.56,-13735.5 5787.4,-13708.04 6616.55,-13698.83"/>
<polygon fill="black" stroke="black" points="6616.59,-13702.33 6626.55,-13698.72 6616.51,-13695.33 6616.59,-13702.33"/>
</g>
<!-- layer7_expert1_act -->
<g id="node527" class="node">
<title>layer7_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2037,-13970 1642,-13970 1642,-13902 2037,-13902 2037,-13970"/>
<text text-anchor="middle" x="1839.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1839.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1839.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1839.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_expert1_gate&#45;&gt;layer7_expert1_act -->
<g id="edge744" class="edge">
<title>layer7_expert1_gate&#45;&gt;layer7_expert1_act</title>
<path fill="none" stroke="black" d="M1560.3,-14005.95C1603.56,-13995.27 1651.7,-13983.38 1695.66,-13972.53"/>
<polygon fill="black" stroke="black" points="1696.69,-13975.88 1705.56,-13970.08 1695.01,-13969.08 1696.69,-13975.88"/>
</g>
<!-- layer7_expert1_up&#45;&gt;layer7_expert1_act -->
<g id="edge745" class="edge">
<title>layer7_expert1_up&#45;&gt;layer7_expert1_act</title>
<path fill="none" stroke="black" d="M1839.5,-14005.88C1839.5,-13997.78 1839.5,-13988.98 1839.5,-13980.47"/>
<polygon fill="black" stroke="black" points="1843,-13980.3 1839.5,-13970.3 1836,-13980.3 1843,-13980.3"/>
</g>
<!-- layer7_expert1_down -->
<g id="node528" class="node">
<title>layer7_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2456,-13866 2073,-13866 2073,-13798 2456,-13798 2456,-13866"/>
<text text-anchor="middle" x="2264.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2264.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2264.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2264.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_expert1_act&#45;&gt;layer7_expert1_down -->
<g id="edge746" class="edge">
<title>layer7_expert1_act&#45;&gt;layer7_expert1_down</title>
<path fill="none" stroke="black" d="M1977.19,-13901.95C2021.8,-13891.25 2071.45,-13879.33 2116.76,-13868.46"/>
<polygon fill="black" stroke="black" points="2117.76,-13871.82 2126.66,-13866.08 2116.12,-13865.01 2117.76,-13871.82"/>
</g>
<!-- layer7_expert1_down&#45;&gt;layer7_token_aggregation -->
<g id="edge747" class="edge">
<title>layer7_expert1_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M2456.15,-13813.4C2525.51,-13807.63 2604.48,-13801.74 2676.5,-13798 4128.72,-13722.6 5858.34,-13702.33 6613.68,-13696.93"/>
<polygon fill="black" stroke="black" points="6613.93,-13700.43 6623.9,-13696.86 6613.88,-13693.43 6613.93,-13700.43"/>
</g>
<!-- layer7_expert2_act -->
<g id="node531" class="node">
<title>layer7_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2863,-13970 2468,-13970 2468,-13902 2863,-13902 2863,-13970"/>
<text text-anchor="middle" x="2665.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2665.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2665.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2665.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_expert2_gate&#45;&gt;layer7_expert2_act -->
<g id="edge750" class="edge">
<title>layer7_expert2_gate&#45;&gt;layer7_expert2_act</title>
<path fill="none" stroke="black" d="M2386.3,-14005.95C2429.56,-13995.27 2477.7,-13983.38 2521.66,-13972.53"/>
<polygon fill="black" stroke="black" points="2522.69,-13975.88 2531.56,-13970.08 2521.01,-13969.08 2522.69,-13975.88"/>
</g>
<!-- layer7_expert2_up&#45;&gt;layer7_expert2_act -->
<g id="edge751" class="edge">
<title>layer7_expert2_up&#45;&gt;layer7_expert2_act</title>
<path fill="none" stroke="black" d="M2665.5,-14005.88C2665.5,-13997.78 2665.5,-13988.98 2665.5,-13980.47"/>
<polygon fill="black" stroke="black" points="2669,-13980.3 2665.5,-13970.3 2662,-13980.3 2669,-13980.3"/>
</g>
<!-- layer7_expert2_down -->
<g id="node532" class="node">
<title>layer7_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3069,-13866 2686,-13866 2686,-13798 3069,-13798 3069,-13866"/>
<text text-anchor="middle" x="2877.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2877.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2877.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2877.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_expert2_act&#45;&gt;layer7_expert2_down -->
<g id="edge752" class="edge">
<title>layer7_expert2_act&#45;&gt;layer7_expert2_down</title>
<path fill="none" stroke="black" d="M2734.33,-13901.88C2755.17,-13891.86 2778.21,-13880.77 2799.6,-13870.48"/>
<polygon fill="black" stroke="black" points="2801.16,-13873.61 2808.65,-13866.12 2798.12,-13867.31 2801.16,-13873.61"/>
</g>
<!-- layer7_expert2_down&#45;&gt;layer7_token_aggregation -->
<g id="edge753" class="edge">
<title>layer7_expert2_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M3069.35,-13821.58C3216.99,-13814.52 3426.13,-13804.92 3609.5,-13798 4705.03,-13756.66 6000.26,-13720.96 6624.78,-13704.57"/>
<polygon fill="black" stroke="black" points="6624.93,-13708.06 6634.83,-13704.3 6624.75,-13701.07 6624.93,-13708.06"/>
</g>
<!-- layer7_expert3_act -->
<g id="node535" class="node">
<title>layer7_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3689,-13970 3294,-13970 3294,-13902 3689,-13902 3689,-13970"/>
<text text-anchor="middle" x="3491.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3491.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3491.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3491.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_expert3_gate&#45;&gt;layer7_expert3_act -->
<g id="edge756" class="edge">
<title>layer7_expert3_gate&#45;&gt;layer7_expert3_act</title>
<path fill="none" stroke="black" d="M3212.3,-14005.95C3255.56,-13995.27 3303.7,-13983.38 3347.66,-13972.53"/>
<polygon fill="black" stroke="black" points="3348.69,-13975.88 3357.56,-13970.08 3347.01,-13969.08 3348.69,-13975.88"/>
</g>
<!-- layer7_expert3_up&#45;&gt;layer7_expert3_act -->
<g id="edge757" class="edge">
<title>layer7_expert3_up&#45;&gt;layer7_expert3_act</title>
<path fill="none" stroke="black" d="M3491.5,-14005.88C3491.5,-13997.78 3491.5,-13988.98 3491.5,-13980.47"/>
<polygon fill="black" stroke="black" points="3495,-13980.3 3491.5,-13970.3 3488,-13980.3 3495,-13980.3"/>
</g>
<!-- layer7_expert3_down -->
<g id="node536" class="node">
<title>layer7_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="4002,-13866 3619,-13866 3619,-13798 4002,-13798 4002,-13866"/>
<text text-anchor="middle" x="3810.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3810.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3810.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3810.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_expert3_act&#45;&gt;layer7_expert3_down -->
<g id="edge758" class="edge">
<title>layer7_expert3_act&#45;&gt;layer7_expert3_down</title>
<path fill="none" stroke="black" d="M3595.07,-13901.88C3627.77,-13891.43 3664.07,-13879.82 3697.4,-13869.16"/>
<polygon fill="black" stroke="black" points="3698.72,-13872.42 3707.18,-13866.04 3696.59,-13865.75 3698.72,-13872.42"/>
</g>
<!-- layer7_expert3_down&#45;&gt;layer7_token_aggregation -->
<g id="edge759" class="edge">
<title>layer7_expert3_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M4002.11,-13822.18C4149.57,-13815.44 4358.42,-13805.97 4541.5,-13798 5283.57,-13765.7 6151.81,-13729.73 6631.99,-13710"/>
<polygon fill="black" stroke="black" points="6632.35,-13713.48 6642.2,-13709.58 6632.06,-13706.49 6632.35,-13713.48"/>
</g>
<!-- layer7_expert4_act -->
<g id="node539" class="node">
<title>layer7_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4515,-13970 4120,-13970 4120,-13902 4515,-13902 4515,-13970"/>
<text text-anchor="middle" x="4317.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4317.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4317.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4317.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_expert4_gate&#45;&gt;layer7_expert4_act -->
<g id="edge762" class="edge">
<title>layer7_expert4_gate&#45;&gt;layer7_expert4_act</title>
<path fill="none" stroke="black" d="M4038.3,-14005.95C4081.56,-13995.27 4129.7,-13983.38 4173.66,-13972.53"/>
<polygon fill="black" stroke="black" points="4174.69,-13975.88 4183.56,-13970.08 4173.01,-13969.08 4174.69,-13975.88"/>
</g>
<!-- layer7_expert4_up&#45;&gt;layer7_expert4_act -->
<g id="edge763" class="edge">
<title>layer7_expert4_up&#45;&gt;layer7_expert4_act</title>
<path fill="none" stroke="black" d="M4317.5,-14005.88C4317.5,-13997.78 4317.5,-13988.98 4317.5,-13980.47"/>
<polygon fill="black" stroke="black" points="4321,-13980.3 4317.5,-13970.3 4314,-13980.3 4321,-13980.3"/>
</g>
<!-- layer7_expert4_down -->
<g id="node540" class="node">
<title>layer7_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4934,-13866 4551,-13866 4551,-13798 4934,-13798 4934,-13866"/>
<text text-anchor="middle" x="4742.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4742.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4742.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4742.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_expert4_act&#45;&gt;layer7_expert4_down -->
<g id="edge764" class="edge">
<title>layer7_expert4_act&#45;&gt;layer7_expert4_down</title>
<path fill="none" stroke="black" d="M4455.19,-13901.95C4499.8,-13891.25 4549.45,-13879.33 4594.76,-13868.46"/>
<polygon fill="black" stroke="black" points="4595.76,-13871.82 4604.66,-13866.08 4594.12,-13865.01 4595.76,-13871.82"/>
</g>
<!-- layer7_expert4_down&#45;&gt;layer7_token_aggregation -->
<g id="edge765" class="edge">
<title>layer7_expert4_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M4934.36,-13819.43C5312.11,-13796.66 6157.46,-13745.7 6641,-13716.55"/>
<polygon fill="black" stroke="black" points="6641.52,-13720.03 6651.29,-13715.93 6641.1,-13713.04 6641.52,-13720.03"/>
</g>
<!-- layer7_expert5_act -->
<g id="node543" class="node">
<title>layer7_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5341,-13970 4946,-13970 4946,-13902 5341,-13902 5341,-13970"/>
<text text-anchor="middle" x="5143.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5143.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5143.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5143.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_expert5_gate&#45;&gt;layer7_expert5_act -->
<g id="edge768" class="edge">
<title>layer7_expert5_gate&#45;&gt;layer7_expert5_act</title>
<path fill="none" stroke="black" d="M4864.3,-14005.95C4907.56,-13995.27 4955.7,-13983.38 4999.66,-13972.53"/>
<polygon fill="black" stroke="black" points="5000.69,-13975.88 5009.56,-13970.08 4999.01,-13969.08 5000.69,-13975.88"/>
</g>
<!-- layer7_expert5_up&#45;&gt;layer7_expert5_act -->
<g id="edge769" class="edge">
<title>layer7_expert5_up&#45;&gt;layer7_expert5_act</title>
<path fill="none" stroke="black" d="M5143.5,-14005.88C5143.5,-13997.78 5143.5,-13988.98 5143.5,-13980.47"/>
<polygon fill="black" stroke="black" points="5147,-13980.3 5143.5,-13970.3 5140,-13980.3 5147,-13980.3"/>
</g>
<!-- layer7_expert5_down -->
<g id="node544" class="node">
<title>layer7_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5760,-13866 5377,-13866 5377,-13798 5760,-13798 5760,-13866"/>
<text text-anchor="middle" x="5568.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5568.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5568.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5568.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_expert5_act&#45;&gt;layer7_expert5_down -->
<g id="edge770" class="edge">
<title>layer7_expert5_act&#45;&gt;layer7_expert5_down</title>
<path fill="none" stroke="black" d="M5281.19,-13901.95C5325.8,-13891.25 5375.45,-13879.33 5420.76,-13868.46"/>
<polygon fill="black" stroke="black" points="5421.76,-13871.82 5430.66,-13866.08 5420.12,-13865.01 5421.76,-13871.82"/>
</g>
<!-- layer7_expert5_down&#45;&gt;layer7_token_aggregation -->
<g id="edge771" class="edge">
<title>layer7_expert5_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M5760.24,-13812.76C5988.97,-13791.01 6375.58,-13754.24 6656.06,-13727.57"/>
<polygon fill="black" stroke="black" points="6656.78,-13731.01 6666.41,-13726.58 6656.12,-13724.05 6656.78,-13731.01"/>
</g>
<!-- layer7_expert6_act -->
<g id="node547" class="node">
<title>layer7_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6167,-13970 5772,-13970 5772,-13902 6167,-13902 6167,-13970"/>
<text text-anchor="middle" x="5969.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5969.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5969.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5969.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_expert6_gate&#45;&gt;layer7_expert6_act -->
<g id="edge774" class="edge">
<title>layer7_expert6_gate&#45;&gt;layer7_expert6_act</title>
<path fill="none" stroke="black" d="M5690.3,-14005.95C5733.56,-13995.27 5781.7,-13983.38 5825.66,-13972.53"/>
<polygon fill="black" stroke="black" points="5826.69,-13975.88 5835.56,-13970.08 5825.01,-13969.08 5826.69,-13975.88"/>
</g>
<!-- layer7_expert6_up&#45;&gt;layer7_expert6_act -->
<g id="edge775" class="edge">
<title>layer7_expert6_up&#45;&gt;layer7_expert6_act</title>
<path fill="none" stroke="black" d="M5969.5,-14005.88C5969.5,-13997.78 5969.5,-13988.98 5969.5,-13980.47"/>
<polygon fill="black" stroke="black" points="5973,-13980.3 5969.5,-13970.3 5966,-13980.3 5973,-13980.3"/>
</g>
<!-- layer7_expert6_down -->
<g id="node548" class="node">
<title>layer7_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6373,-13866 5990,-13866 5990,-13798 6373,-13798 6373,-13866"/>
<text text-anchor="middle" x="6181.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6181.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6181.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6181.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_expert6_act&#45;&gt;layer7_expert6_down -->
<g id="edge776" class="edge">
<title>layer7_expert6_act&#45;&gt;layer7_expert6_down</title>
<path fill="none" stroke="black" d="M6038.33,-13901.88C6059.17,-13891.86 6082.21,-13880.77 6103.6,-13870.48"/>
<polygon fill="black" stroke="black" points="6105.16,-13873.61 6112.65,-13866.12 6102.12,-13867.31 6105.16,-13873.61"/>
</g>
<!-- layer7_expert6_down&#45;&gt;layer7_token_aggregation -->
<g id="edge777" class="edge">
<title>layer7_expert6_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M6373.05,-13799.11C6465.57,-13783.71 6579.01,-13764.83 6683.76,-13747.39"/>
<polygon fill="black" stroke="black" points="6684.58,-13750.8 6693.87,-13745.71 6683.43,-13743.9 6684.58,-13750.8"/>
</g>
<!-- layer7_expert7_act -->
<g id="node551" class="node">
<title>layer7_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6993,-13970 6598,-13970 6598,-13902 6993,-13902 6993,-13970"/>
<text text-anchor="middle" x="6795.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6795.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6795.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6795.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_expert7_gate&#45;&gt;layer7_expert7_act -->
<g id="edge780" class="edge">
<title>layer7_expert7_gate&#45;&gt;layer7_expert7_act</title>
<path fill="none" stroke="black" d="M6516.3,-14005.95C6559.56,-13995.27 6607.7,-13983.38 6651.66,-13972.53"/>
<polygon fill="black" stroke="black" points="6652.69,-13975.88 6661.56,-13970.08 6651.01,-13969.08 6652.69,-13975.88"/>
</g>
<!-- layer7_expert7_up&#45;&gt;layer7_expert7_act -->
<g id="edge781" class="edge">
<title>layer7_expert7_up&#45;&gt;layer7_expert7_act</title>
<path fill="none" stroke="black" d="M6795.5,-14005.88C6795.5,-13997.78 6795.5,-13988.98 6795.5,-13980.47"/>
<polygon fill="black" stroke="black" points="6799,-13980.3 6795.5,-13970.3 6792,-13980.3 6799,-13980.3"/>
</g>
<!-- layer7_expert7_down -->
<g id="node552" class="node">
<title>layer7_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6990,-13866 6607,-13866 6607,-13798 6990,-13798 6990,-13866"/>
<text text-anchor="middle" x="6798.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6798.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6798.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6798.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_expert7_act&#45;&gt;layer7_expert7_down -->
<g id="edge782" class="edge">
<title>layer7_expert7_act&#45;&gt;layer7_expert7_down</title>
<path fill="none" stroke="black" d="M6796.47,-13901.88C6796.71,-13893.78 6796.97,-13884.98 6797.22,-13876.47"/>
<polygon fill="black" stroke="black" points="6800.73,-13876.4 6797.52,-13866.3 6793.73,-13876.19 6800.73,-13876.4"/>
</g>
<!-- layer7_expert7_down&#45;&gt;layer7_token_aggregation -->
<g id="edge783" class="edge">
<title>layer7_expert7_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M6847.17,-13797.9C6860.63,-13788.75 6875.8,-13778.44 6891.2,-13767.97"/>
<polygon fill="black" stroke="black" points="6893.47,-13770.66 6899.77,-13762.14 6889.53,-13764.87 6893.47,-13770.66"/>
</g>
<!-- layer7_expert8_act -->
<g id="node555" class="node">
<title>layer7_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7406,-13970 7011,-13970 7011,-13902 7406,-13902 7406,-13970"/>
<text text-anchor="middle" x="7208.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7208.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7208.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7208.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer7_expert8_gate&#45;&gt;layer7_expert8_act -->
<g id="edge786" class="edge">
<title>layer7_expert8_gate&#45;&gt;layer7_expert8_act</title>
<path fill="none" stroke="black" d="M7208.5,-14005.88C7208.5,-13997.78 7208.5,-13988.98 7208.5,-13980.47"/>
<polygon fill="black" stroke="black" points="7212,-13980.3 7208.5,-13970.3 7205,-13980.3 7212,-13980.3"/>
</g>
<!-- layer7_expert8_up&#45;&gt;layer7_expert8_act -->
<g id="edge787" class="edge">
<title>layer7_expert8_up&#45;&gt;layer7_expert8_act</title>
<path fill="none" stroke="black" d="M7487.7,-14005.95C7444.44,-13995.27 7396.3,-13983.38 7352.34,-13972.53"/>
<polygon fill="black" stroke="black" points="7352.99,-13969.08 7342.44,-13970.08 7351.31,-13975.88 7352.99,-13969.08"/>
</g>
<!-- layer7_expert8_down -->
<g id="node556" class="node">
<title>layer7_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7397,-13866 7014,-13866 7014,-13798 7397,-13798 7397,-13866"/>
<text text-anchor="middle" x="7205.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7205.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7205.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7205.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer7_expert8_act&#45;&gt;layer7_expert8_down -->
<g id="edge788" class="edge">
<title>layer7_expert8_act&#45;&gt;layer7_expert8_down</title>
<path fill="none" stroke="black" d="M7207.53,-13901.88C7207.29,-13893.78 7207.03,-13884.98 7206.78,-13876.47"/>
<polygon fill="black" stroke="black" points="7210.27,-13876.19 7206.48,-13866.3 7203.27,-13876.4 7210.27,-13876.19"/>
</g>
<!-- layer7_expert8_down&#45;&gt;layer7_token_aggregation -->
<g id="edge789" class="edge">
<title>layer7_expert8_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M7155.13,-13797.9C7141.06,-13788.66 7125.2,-13778.25 7109.12,-13767.67"/>
<polygon fill="black" stroke="black" points="7110.97,-13764.7 7100.69,-13762.14 7107.12,-13770.55 7110.97,-13764.7"/>
</g>
<!-- layer7_expert9_act -->
<g id="node559" class="node">
<title>layer7_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8232,-13970 7837,-13970 7837,-13902 8232,-13902 8232,-13970"/>
<text text-anchor="middle" x="8034.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8034.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8034.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8034.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer7_expert9_gate&#45;&gt;layer7_expert9_act -->
<g id="edge792" class="edge">
<title>layer7_expert9_gate&#45;&gt;layer7_expert9_act</title>
<path fill="none" stroke="black" d="M8034.5,-14005.88C8034.5,-13997.78 8034.5,-13988.98 8034.5,-13980.47"/>
<polygon fill="black" stroke="black" points="8038,-13980.3 8034.5,-13970.3 8031,-13980.3 8038,-13980.3"/>
</g>
<!-- layer7_expert9_up&#45;&gt;layer7_expert9_act -->
<g id="edge793" class="edge">
<title>layer7_expert9_up&#45;&gt;layer7_expert9_act</title>
<path fill="none" stroke="black" d="M8313.7,-14005.95C8270.44,-13995.27 8222.3,-13983.38 8178.34,-13972.53"/>
<polygon fill="black" stroke="black" points="8178.99,-13969.08 8168.44,-13970.08 8177.31,-13975.88 8178.99,-13969.08"/>
</g>
<!-- layer7_expert9_down -->
<g id="node560" class="node">
<title>layer7_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8013,-13866 7630,-13866 7630,-13798 8013,-13798 8013,-13866"/>
<text text-anchor="middle" x="7821.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7821.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7821.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7821.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer7_expert9_act&#45;&gt;layer7_expert9_down -->
<g id="edge794" class="edge">
<title>layer7_expert9_act&#45;&gt;layer7_expert9_down</title>
<path fill="none" stroke="black" d="M7965.35,-13901.88C7944.41,-13891.86 7921.26,-13880.77 7899.77,-13870.48"/>
<polygon fill="black" stroke="black" points="7901.2,-13867.29 7890.67,-13866.12 7898.18,-13873.6 7901.2,-13867.29"/>
</g>
<!-- layer7_expert9_down&#45;&gt;layer7_token_aggregation -->
<g id="edge795" class="edge">
<title>layer7_expert9_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M7629.84,-13799.33C7564.96,-13788.61 7489.75,-13776.18 7414.34,-13763.72"/>
<polygon fill="black" stroke="black" points="7414.62,-13760.22 7404.19,-13762.04 7413.48,-13767.12 7414.62,-13760.22"/>
</g>
<!-- layer7_expert10_act -->
<g id="node563" class="node">
<title>layer7_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9058,-13970 8663,-13970 8663,-13902 9058,-13902 9058,-13970"/>
<text text-anchor="middle" x="8860.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8860.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8860.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8860.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer7_expert10_gate&#45;&gt;layer7_expert10_act -->
<g id="edge798" class="edge">
<title>layer7_expert10_gate&#45;&gt;layer7_expert10_act</title>
<path fill="none" stroke="black" d="M8860.5,-14005.88C8860.5,-13997.78 8860.5,-13988.98 8860.5,-13980.47"/>
<polygon fill="black" stroke="black" points="8864,-13980.3 8860.5,-13970.3 8857,-13980.3 8864,-13980.3"/>
</g>
<!-- layer7_expert10_up&#45;&gt;layer7_expert10_act -->
<g id="edge799" class="edge">
<title>layer7_expert10_up&#45;&gt;layer7_expert10_act</title>
<path fill="none" stroke="black" d="M9139.7,-14005.95C9096.44,-13995.27 9048.3,-13983.38 9004.34,-13972.53"/>
<polygon fill="black" stroke="black" points="9004.99,-13969.08 8994.44,-13970.08 9003.31,-13975.88 9004.99,-13969.08"/>
</g>
<!-- layer7_expert10_down -->
<g id="node564" class="node">
<title>layer7_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8734,-13866 8351,-13866 8351,-13798 8734,-13798 8734,-13866"/>
<text text-anchor="middle" x="8542.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8542.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8542.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8542.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer7_expert10_act&#45;&gt;layer7_expert10_down -->
<g id="edge800" class="edge">
<title>layer7_expert10_act&#45;&gt;layer7_expert10_down</title>
<path fill="none" stroke="black" d="M8757.25,-13901.88C8724.65,-13891.43 8688.47,-13879.82 8655.25,-13869.16"/>
<polygon fill="black" stroke="black" points="8656.09,-13865.76 8645.5,-13866.04 8653.95,-13872.42 8656.09,-13865.76"/>
</g>
<!-- layer7_expert10_down&#45;&gt;layer7_token_aggregation -->
<g id="edge801" class="edge">
<title>layer7_expert10_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M8350.85,-13814.12C8125.46,-13794.27 7743.98,-13760.66 7443.54,-13734.2"/>
<polygon fill="black" stroke="black" points="7443.61,-13730.69 7433.34,-13733.3 7442.99,-13737.67 7443.61,-13730.69"/>
</g>
<!-- layer7_expert11_act -->
<g id="node567" class="node">
<title>layer7_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9884,-13970 9489,-13970 9489,-13902 9884,-13902 9884,-13970"/>
<text text-anchor="middle" x="9686.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9686.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9686.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9686.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer7_expert11_gate&#45;&gt;layer7_expert11_act -->
<g id="edge804" class="edge">
<title>layer7_expert11_gate&#45;&gt;layer7_expert11_act</title>
<path fill="none" stroke="black" d="M9686.5,-14005.88C9686.5,-13997.78 9686.5,-13988.98 9686.5,-13980.47"/>
<polygon fill="black" stroke="black" points="9690,-13980.3 9686.5,-13970.3 9683,-13980.3 9690,-13980.3"/>
</g>
<!-- layer7_expert11_up&#45;&gt;layer7_expert11_act -->
<g id="edge805" class="edge">
<title>layer7_expert11_up&#45;&gt;layer7_expert11_act</title>
<path fill="none" stroke="black" d="M9965.7,-14005.95C9922.44,-13995.27 9874.3,-13983.38 9830.34,-13972.53"/>
<polygon fill="black" stroke="black" points="9830.99,-13969.08 9820.44,-13970.08 9829.31,-13975.88 9830.99,-13969.08"/>
</g>
<!-- layer7_expert11_down -->
<g id="node568" class="node">
<title>layer7_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9508,-13866 9125,-13866 9125,-13798 9508,-13798 9508,-13866"/>
<text text-anchor="middle" x="9316.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9316.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9316.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9316.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer7_expert11_act&#45;&gt;layer7_expert11_down -->
<g id="edge806" class="edge">
<title>layer7_expert11_act&#45;&gt;layer7_expert11_down</title>
<path fill="none" stroke="black" d="M9566.63,-13901.95C9528.2,-13891.36 9485.47,-13879.58 9446.36,-13868.8"/>
<polygon fill="black" stroke="black" points="9447.07,-13865.36 9436.5,-13866.08 9445.21,-13872.11 9447.07,-13865.36"/>
</g>
<!-- layer7_expert11_down&#45;&gt;layer7_token_aggregation -->
<g id="edge807" class="edge">
<title>layer7_expert11_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M9124.84,-13819.75C8753.82,-13797.99 7929.55,-13749.63 7423.2,-13719.92"/>
<polygon fill="black" stroke="black" points="7423.35,-13716.42 7413.17,-13719.33 7422.94,-13723.41 7423.35,-13716.42"/>
</g>
<!-- layer7_expert12_act -->
<g id="node571" class="node">
<title>layer7_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10710,-13970 10315,-13970 10315,-13902 10710,-13902 10710,-13970"/>
<text text-anchor="middle" x="10512.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10512.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10512.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10512.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer7_expert12_gate&#45;&gt;layer7_expert12_act -->
<g id="edge810" class="edge">
<title>layer7_expert12_gate&#45;&gt;layer7_expert12_act</title>
<path fill="none" stroke="black" d="M10512.5,-14005.88C10512.5,-13997.78 10512.5,-13988.98 10512.5,-13980.47"/>
<polygon fill="black" stroke="black" points="10516,-13980.3 10512.5,-13970.3 10509,-13980.3 10516,-13980.3"/>
</g>
<!-- layer7_expert12_up&#45;&gt;layer7_expert12_act -->
<g id="edge811" class="edge">
<title>layer7_expert12_up&#45;&gt;layer7_expert12_act</title>
<path fill="none" stroke="black" d="M10791.7,-14005.95C10748.44,-13995.27 10700.3,-13983.38 10656.34,-13972.53"/>
<polygon fill="black" stroke="black" points="10656.99,-13969.08 10646.44,-13970.08 10655.31,-13975.88 10656.99,-13969.08"/>
</g>
<!-- layer7_expert12_down -->
<g id="node572" class="node">
<title>layer7_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10308,-13866 9925,-13866 9925,-13798 10308,-13798 10308,-13866"/>
<text text-anchor="middle" x="10116.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10116.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10116.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10116.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer7_expert12_act&#45;&gt;layer7_expert12_down -->
<g id="edge812" class="edge">
<title>layer7_expert12_act&#45;&gt;layer7_expert12_down</title>
<path fill="none" stroke="black" d="M10384.2,-13901.95C10342.81,-13891.29 10296.76,-13879.43 10254.69,-13868.59"/>
<polygon fill="black" stroke="black" points="10255.49,-13865.19 10244.93,-13866.08 10253.74,-13871.96 10255.49,-13865.19"/>
</g>
<!-- layer7_expert12_down&#45;&gt;layer7_token_aggregation -->
<g id="edge813" class="edge">
<title>layer7_expert12_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M9924.67,-13819.74C9807.15,-13813.01 9653.65,-13804.53 9517.5,-13798 8774.75,-13762.36 7908.41,-13728.66 7409.65,-13710.02"/>
<polygon fill="black" stroke="black" points="7409.53,-13706.52 7399.41,-13709.64 7409.27,-13713.51 7409.53,-13706.52"/>
</g>
<!-- layer7_expert13_act -->
<g id="node575" class="node">
<title>layer7_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11536,-13970 11141,-13970 11141,-13902 11536,-13902 11536,-13970"/>
<text text-anchor="middle" x="11338.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11338.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11338.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11338.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer7_expert13_gate&#45;&gt;layer7_expert13_act -->
<g id="edge816" class="edge">
<title>layer7_expert13_gate&#45;&gt;layer7_expert13_act</title>
<path fill="none" stroke="black" d="M11338.5,-14005.88C11338.5,-13997.78 11338.5,-13988.98 11338.5,-13980.47"/>
<polygon fill="black" stroke="black" points="11342,-13980.3 11338.5,-13970.3 11335,-13980.3 11342,-13980.3"/>
</g>
<!-- layer7_expert13_up&#45;&gt;layer7_expert13_act -->
<g id="edge817" class="edge">
<title>layer7_expert13_up&#45;&gt;layer7_expert13_act</title>
<path fill="none" stroke="black" d="M11617.7,-14005.95C11574.44,-13995.27 11526.3,-13983.38 11482.34,-13972.53"/>
<polygon fill="black" stroke="black" points="11482.99,-13969.08 11472.44,-13970.08 11481.31,-13975.88 11482.99,-13969.08"/>
</g>
<!-- layer7_expert13_down -->
<g id="node576" class="node">
<title>layer7_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11121,-13866 10738,-13866 10738,-13798 11121,-13798 11121,-13866"/>
<text text-anchor="middle" x="10929.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10929.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10929.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10929.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer7_expert13_act&#45;&gt;layer7_expert13_down -->
<g id="edge818" class="edge">
<title>layer7_expert13_act&#45;&gt;layer7_expert13_down</title>
<path fill="none" stroke="black" d="M11205.99,-13901.95C11163.15,-13891.27 11115.48,-13879.38 11071.95,-13868.53"/>
<polygon fill="black" stroke="black" points="11072.7,-13865.1 11062.15,-13866.08 11071,-13871.9 11072.7,-13865.1"/>
</g>
<!-- layer7_expert13_down&#45;&gt;layer7_token_aggregation -->
<g id="edge819" class="edge">
<title>layer7_expert13_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M10737.98,-13819.55C10617.35,-13812.61 10458.36,-13803.98 10317.5,-13798 9266.09,-13753.34 8026.53,-13720 7401.76,-13704.54"/>
<polygon fill="black" stroke="black" points="7401.78,-13701.04 7391.69,-13704.3 7401.6,-13708.04 7401.78,-13701.04"/>
</g>
<!-- layer7_expert14_act -->
<g id="node579" class="node">
<title>layer7_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12362,-13970 11967,-13970 11967,-13902 12362,-13902 12362,-13970"/>
<text text-anchor="middle" x="12164.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12164.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12164.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12164.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer7_expert14_gate&#45;&gt;layer7_expert14_act -->
<g id="edge822" class="edge">
<title>layer7_expert14_gate&#45;&gt;layer7_expert14_act</title>
<path fill="none" stroke="black" d="M12164.5,-14005.88C12164.5,-13997.78 12164.5,-13988.98 12164.5,-13980.47"/>
<polygon fill="black" stroke="black" points="12168,-13980.3 12164.5,-13970.3 12161,-13980.3 12168,-13980.3"/>
</g>
<!-- layer7_expert14_up&#45;&gt;layer7_expert14_act -->
<g id="edge823" class="edge">
<title>layer7_expert14_up&#45;&gt;layer7_expert14_act</title>
<path fill="none" stroke="black" d="M12443.7,-14005.95C12400.44,-13995.27 12352.3,-13983.38 12308.34,-13972.53"/>
<polygon fill="black" stroke="black" points="12308.99,-13969.08 12298.44,-13970.08 12307.31,-13975.88 12308.99,-13969.08"/>
</g>
<!-- layer7_expert14_down -->
<g id="node580" class="node">
<title>layer7_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11940,-13866 11557,-13866 11557,-13798 11940,-13798 11940,-13866"/>
<text text-anchor="middle" x="11748.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11748.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11748.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11748.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer7_expert14_act&#45;&gt;layer7_expert14_down -->
<g id="edge824" class="edge">
<title>layer7_expert14_act&#45;&gt;layer7_expert14_down</title>
<path fill="none" stroke="black" d="M12029.72,-13901.95C11986.15,-13891.27 11937.66,-13879.38 11893.39,-13868.53"/>
<polygon fill="black" stroke="black" points="11893.96,-13865.06 11883.42,-13866.08 11892.3,-13871.86 11893.96,-13865.06"/>
</g>
<!-- layer7_expert14_down&#45;&gt;layer7_token_aggregation -->
<g id="edge825" class="edge">
<title>layer7_expert14_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M11556.83,-13819.36C11434.82,-13812.3 11273.43,-13803.6 11130.5,-13798 9760.85,-13744.37 8134.66,-13713.43 7397.32,-13701.17"/>
<polygon fill="black" stroke="black" points="7397.12,-13697.67 7387.07,-13701 7397.01,-13704.67 7397.12,-13697.67"/>
</g>
<!-- layer7_expert15_act -->
<g id="node583" class="node">
<title>layer7_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13188,-13970 12793,-13970 12793,-13902 13188,-13902 13188,-13970"/>
<text text-anchor="middle" x="12990.5" y="-13954.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12990.5" y="-13939.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12990.5" y="-13924.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12990.5" y="-13909.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer7_expert15_gate&#45;&gt;layer7_expert15_act -->
<g id="edge828" class="edge">
<title>layer7_expert15_gate&#45;&gt;layer7_expert15_act</title>
<path fill="none" stroke="black" d="M12990.5,-14005.88C12990.5,-13997.78 12990.5,-13988.98 12990.5,-13980.47"/>
<polygon fill="black" stroke="black" points="12994,-13980.3 12990.5,-13970.3 12987,-13980.3 12994,-13980.3"/>
</g>
<!-- layer7_expert15_up&#45;&gt;layer7_expert15_act -->
<g id="edge829" class="edge">
<title>layer7_expert15_up&#45;&gt;layer7_expert15_act</title>
<path fill="none" stroke="black" d="M13269.7,-14005.95C13226.44,-13995.27 13178.3,-13983.38 13134.34,-13972.53"/>
<polygon fill="black" stroke="black" points="13134.99,-13969.08 13124.44,-13970.08 13133.31,-13975.88 13134.99,-13969.08"/>
</g>
<!-- layer7_expert15_down -->
<g id="node584" class="node">
<title>layer7_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12763,-13866 12380,-13866 12380,-13798 12763,-13798 12763,-13866"/>
<text text-anchor="middle" x="12571.5" y="-13850.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12571.5" y="-13835.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12571.5" y="-13820.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12571.5" y="-13805.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer7_expert15_act&#45;&gt;layer7_expert15_down -->
<g id="edge830" class="edge">
<title>layer7_expert15_act&#45;&gt;layer7_expert15_down</title>
<path fill="none" stroke="black" d="M12854.75,-13901.95C12810.77,-13891.25 12761.82,-13879.33 12717.15,-13868.46"/>
<polygon fill="black" stroke="black" points="12717.93,-13865.05 12707.39,-13866.08 12716.28,-13871.85 12717.93,-13865.05"/>
</g>
<!-- layer7_expert15_down&#45;&gt;layer7_token_aggregation -->
<g id="edge831" class="edge">
<title>layer7_expert15_down&#45;&gt;layer7_token_aggregation</title>
<path fill="none" stroke="black" d="M12379.98,-13819.24C12257.02,-13812.09 12093.9,-13803.33 11949.5,-13798 10255.24,-13735.45 8233.33,-13708.15 7393.93,-13698.91"/>
<polygon fill="black" stroke="black" points="7393.84,-13695.4 7383.8,-13698.79 7393.76,-13702.4 7393.84,-13695.4"/>
</g>
<!-- layer7_res2 -->
<g id="node586" class="node">
<title>layer7_res2</title>
<polygon fill="none" stroke="black" points="7439.24,-13590 6738.12,-13590 6557.76,-13424 7258.88,-13424 7439.24,-13590"/>
<text text-anchor="middle" x="6998.5" y="-13533.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6998.5" y="-13518.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13503.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13488.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13473.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_token_aggregation&#45;&gt;layer7_res2 -->
<g id="edge832" class="edge">
<title>layer7_token_aggregation&#45;&gt;layer7_res2</title>
<path fill="none" stroke="black" d="M6998.5,-13625.95C6998.5,-13617.63 6998.5,-13609 6998.5,-13600.38"/>
<polygon fill="black" stroke="black" points="7002,-13600.28 6998.5,-13590.28 6995,-13600.28 7002,-13600.28"/>
</g>
<!-- layer8_mha_qkv -->
<g id="node587" class="node">
<title>layer8_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7234.5,-13388 6762.5,-13388 6762.5,-13320 7234.5,-13320 7234.5,-13388"/>
<text text-anchor="middle" x="6998.5" y="-13372.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6998.5" y="-13357.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13342.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6998.5" y="-13327.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_res2&#45;&gt;layer8_mha_qkv -->
<g id="edge833" class="edge">
<title>layer7_res2&#45;&gt;layer8_mha_qkv</title>
<path fill="none" stroke="black" d="M6998.5,-13423.87C6998.5,-13415.12 6998.5,-13406.48 6998.5,-13398.45"/>
<polygon fill="black" stroke="black" points="7002,-13398.26 6998.5,-13388.26 6995,-13398.26 7002,-13398.26"/>
</g>
<!-- layer8_mha_attn -->
<g id="node588" class="node">
<title>layer8_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7228.5,-13284 6768.5,-13284 6768.5,-13216 7228.5,-13216 7228.5,-13284"/>
<text text-anchor="middle" x="6998.5" y="-13268.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6998.5" y="-13253.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6998.5" y="-13238.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13223.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_mha_qkv&#45;&gt;layer8_mha_attn -->
<g id="edge834" class="edge">
<title>layer8_mha_qkv&#45;&gt;layer8_mha_attn</title>
<path fill="none" stroke="black" d="M6998.5,-13319.88C6998.5,-13311.78 6998.5,-13302.98 6998.5,-13294.47"/>
<polygon fill="black" stroke="black" points="7002,-13294.3 6998.5,-13284.3 6995,-13294.3 7002,-13294.3"/>
</g>
<!-- layer8_mha_out -->
<g id="node589" class="node">
<title>layer8_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7211,-13180 6786,-13180 6786,-13112 7211,-13112 7211,-13180"/>
<text text-anchor="middle" x="6998.5" y="-13164.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6998.5" y="-13149.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13134.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-13119.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_mha_attn&#45;&gt;layer8_mha_out -->
<g id="edge835" class="edge">
<title>layer8_mha_attn&#45;&gt;layer8_mha_out</title>
<path fill="none" stroke="black" d="M6998.5,-13215.88C6998.5,-13207.78 6998.5,-13198.98 6998.5,-13190.47"/>
<polygon fill="black" stroke="black" points="7002,-13190.3 6998.5,-13180.3 6995,-13190.3 7002,-13190.3"/>
</g>
<!-- layer8_res1 -->
<g id="node590" class="node">
<title>layer8_res1</title>
<polygon fill="none" stroke="black" points="7439.24,-13076 6738.12,-13076 6557.76,-12910 7258.88,-12910 7439.24,-13076"/>
<text text-anchor="middle" x="6998.5" y="-13019.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6998.5" y="-13004.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12989.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12974.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12959.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_mha_out&#45;&gt;layer8_res1 -->
<g id="edge836" class="edge">
<title>layer8_mha_out&#45;&gt;layer8_res1</title>
<path fill="none" stroke="black" d="M6998.5,-13111.86C6998.5,-13104.1 6998.5,-13095.46 6998.5,-13086.48"/>
<polygon fill="black" stroke="black" points="7002,-13086.23 6998.5,-13076.23 6995,-13086.23 7002,-13086.23"/>
</g>
<!-- layer8_ln1 -->
<g id="node591" class="node">
<title>layer8_ln1</title>
<polygon fill="yellow" stroke="black" points="7211,-12874 6786,-12874 6786,-12806 7211,-12806 7211,-12874"/>
<text text-anchor="middle" x="6998.5" y="-12858.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6998.5" y="-12843.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12828.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12813.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_res1&#45;&gt;layer8_ln1 -->
<g id="edge837" class="edge">
<title>layer8_res1&#45;&gt;layer8_ln1</title>
<path fill="none" stroke="black" d="M6998.5,-12909.87C6998.5,-12901.12 6998.5,-12892.48 6998.5,-12884.45"/>
<polygon fill="black" stroke="black" points="7002,-12884.26 6998.5,-12874.26 6995,-12884.26 7002,-12884.26"/>
</g>
<!-- layer8_expert_routing -->
<g id="node592" class="node">
<title>layer8_expert_routing</title>
<polygon fill="orange" stroke="black" points="6998.5,-12770 6582.5,-12687 6998.5,-12604 7414.5,-12687 6998.5,-12770"/>
<text text-anchor="middle" x="6998.5" y="-12713.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6998.5" y="-12698.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6998.5" y="-12683.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12668.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6998.5" y="-12653.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_ln1&#45;&gt;layer8_expert_routing -->
<g id="edge838" class="edge">
<title>layer8_ln1&#45;&gt;layer8_expert_routing</title>
<path fill="none" stroke="black" d="M6998.5,-12805.86C6998.5,-12798.1 6998.5,-12789.46 6998.5,-12780.48"/>
<polygon fill="black" stroke="black" points="7002,-12780.23 6998.5,-12770.23 6995,-12780.23 7002,-12780.23"/>
</g>
<!-- layer8_token_distribution -->
<g id="node593" class="node">
<title>layer8_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7426.86,-12568 6745.44,-12568 6570.14,-12432 7251.56,-12432 7426.86,-12568"/>
<text text-anchor="middle" x="6998.5" y="-12518.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6998.5" y="-12503.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6998.5" y="-12488.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6998.5" y="-12473.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer8_expert_routing&#45;&gt;layer8_token_distribution -->
<g id="edge839" class="edge">
<title>layer8_expert_routing&#45;&gt;layer8_token_distribution</title>
<path fill="none" stroke="black" d="M6998.5,-12603.78C6998.5,-12595.34 6998.5,-12586.79 6998.5,-12578.4"/>
<polygon fill="black" stroke="black" points="7002,-12578.28 6998.5,-12568.28 6995,-12578.28 7002,-12578.28"/>
</g>
<!-- layer8_expert0_gate -->
<g id="node594" class="node">
<title>layer8_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="795,-12396 400,-12396 400,-12328 795,-12328 795,-12396"/>
<text text-anchor="middle" x="597.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="597.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="597.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="597.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert0_gate -->
<g id="edge840" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.42,-12499.72C5536.99,-12501.09 1975.01,-12497.23 805.31,-12396.11"/>
<polygon fill="black" stroke="black" points="805.32,-12392.6 795.06,-12395.22 804.71,-12399.57 805.32,-12392.6"/>
</g>
<!-- layer8_expert0_up -->
<g id="node595" class="node">
<title>layer8_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1208,-12396 813,-12396 813,-12328 1208,-12328 1208,-12396"/>
<text text-anchor="middle" x="1010.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1010.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1010.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1010.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert0_up -->
<g id="edge841" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6656.42,-12499.24C5585.28,-12499 2303.27,-12490.44 1218.35,-12396.12"/>
<polygon fill="black" stroke="black" points="1218.32,-12392.6 1208.06,-12395.21 1217.71,-12399.57 1218.32,-12392.6"/>
</g>
<!-- layer8_expert1_gate -->
<g id="node598" class="node">
<title>layer8_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1621,-12396 1226,-12396 1226,-12328 1621,-12328 1621,-12396"/>
<text text-anchor="middle" x="1423.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1423.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1423.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1423.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert1_gate -->
<g id="edge846" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6655.86,-12498.69C5636.38,-12496.77 2631.69,-12483.69 1631.28,-12396.11"/>
<polygon fill="black" stroke="black" points="1631.33,-12392.6 1621.06,-12395.21 1630.71,-12399.57 1631.33,-12392.6"/>
</g>
<!-- layer8_expert1_up -->
<g id="node599" class="node">
<title>layer8_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2034,-12396 1639,-12396 1639,-12328 2034,-12328 2034,-12396"/>
<text text-anchor="middle" x="1836.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1836.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1836.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1836.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert1_up -->
<g id="edge847" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6654.92,-12498.04C5688.86,-12494.35 2960.03,-12476.95 2044.08,-12396.09"/>
<polygon fill="black" stroke="black" points="2044.33,-12392.6 2034.06,-12395.2 2043.71,-12399.58 2044.33,-12392.6"/>
</g>
<!-- layer8_expert2_gate -->
<g id="node602" class="node">
<title>layer8_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2447,-12396 2052,-12396 2052,-12328 2447,-12328 2447,-12396"/>
<text text-anchor="middle" x="2249.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2249.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2249.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2249.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert2_gate -->
<g id="edge852" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6653.93,-12497.27C5743.78,-12491.72 3289.04,-12470.22 2457.07,-12396.1"/>
<polygon fill="black" stroke="black" points="2457.33,-12392.6 2447.06,-12395.19 2456.7,-12399.58 2457.33,-12392.6"/>
</g>
<!-- layer8_expert2_up -->
<g id="node603" class="node">
<title>layer8_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2860,-12396 2465,-12396 2465,-12328 2860,-12328 2860,-12396"/>
<text text-anchor="middle" x="2662.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2662.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2662.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2662.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert2_up -->
<g id="edge853" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6652.99,-12496.34C5801.65,-12488.84 3618.62,-12463.52 2870.16,-12396.1"/>
<polygon fill="black" stroke="black" points="2870.34,-12392.61 2860.06,-12395.18 2869.7,-12399.58 2870.34,-12392.61"/>
</g>
<!-- layer8_expert3_gate -->
<g id="node606" class="node">
<title>layer8_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3273,-12396 2878,-12396 2878,-12328 3273,-12328 3273,-12396"/>
<text text-anchor="middle" x="3075.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3075.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3075.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3075.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert3_gate -->
<g id="edge858" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6651.41,-12495.2C5861.73,-12485.62 3948.42,-12456.84 3283.24,-12396.11"/>
<polygon fill="black" stroke="black" points="3283.34,-12392.61 3273.06,-12395.17 3282.7,-12399.58 3283.34,-12392.61"/>
</g>
<!-- layer8_expert3_up -->
<g id="node607" class="node">
<title>layer8_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3686,-12396 3291,-12396 3291,-12328 3686,-12328 3686,-12396"/>
<text text-anchor="middle" x="3488.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3488.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3488.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3488.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert3_up -->
<g id="edge859" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6649.52,-12493.77C5925.21,-12481.98 4278.46,-12450.17 3696.25,-12396.12"/>
<polygon fill="black" stroke="black" points="3696.35,-12392.61 3686.06,-12395.16 3695.69,-12399.58 3696.35,-12392.61"/>
</g>
<!-- layer8_expert4_gate -->
<g id="node610" class="node">
<title>layer8_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4099,-12396 3704,-12396 3704,-12328 4099,-12328 4099,-12396"/>
<text text-anchor="middle" x="3901.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3901.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3901.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3901.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert4_gate -->
<g id="edge864" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6647.06,-12491.9C5992.59,-12477.8 4608.94,-12443.52 4109.26,-12396.12"/>
<polygon fill="black" stroke="black" points="4109.35,-12392.62 4099.06,-12395.14 4108.68,-12399.58 4109.35,-12392.62"/>
</g>
<!-- layer8_expert4_up -->
<g id="node611" class="node">
<title>layer8_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4512,-12396 4117,-12396 4117,-12328 4512,-12328 4512,-12396"/>
<text text-anchor="middle" x="4314.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4314.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4314.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4314.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert4_up -->
<g id="edge865" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6654.37,-12497.42C6177.11,-12492.35 5287.47,-12472.49 4522.19,-12396.13"/>
<polygon fill="black" stroke="black" points="4522.36,-12392.63 4512.07,-12395.12 4521.67,-12399.6 4522.36,-12392.63"/>
</g>
<!-- layer8_expert5_gate -->
<g id="node614" class="node">
<title>layer8_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4925,-12396 4530,-12396 4530,-12328 4925,-12328 4925,-12396"/>
<text text-anchor="middle" x="4727.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4727.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4727.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4727.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert5_gate -->
<g id="edge870" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6648.68,-12493.16C6239.56,-12483.67 5542.04,-12459.18 4935.34,-12396.16"/>
<polygon fill="black" stroke="black" points="4935.38,-12392.64 4925.07,-12395.09 4934.65,-12399.61 4935.38,-12392.64"/>
</g>
<!-- layer8_expert5_up -->
<g id="node615" class="node">
<title>layer8_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5338,-12396 4943,-12396 4943,-12328 5338,-12328 5338,-12396"/>
<text text-anchor="middle" x="5140.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5140.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5140.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5140.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert5_up -->
<g id="edge871" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6640.34,-12486.65C6307.6,-12472.84 5798.32,-12445.72 5348.03,-12396.14"/>
<polygon fill="black" stroke="black" points="5348.4,-12392.66 5338.07,-12395.04 5347.63,-12399.62 5348.4,-12392.66"/>
</g>
<!-- layer8_expert6_gate -->
<g id="node618" class="node">
<title>layer8_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5751,-12396 5356,-12396 5356,-12328 5751,-12328 5751,-12396"/>
<text text-anchor="middle" x="5553.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5553.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5553.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5553.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert6_gate -->
<g id="edge876" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6626.03,-12475.44C6382.4,-12458.23 6057.1,-12431.86 5761.16,-12396.18"/>
<polygon fill="black" stroke="black" points="5761.43,-12392.68 5751.08,-12394.96 5760.59,-12399.63 5761.43,-12392.68"/>
</g>
<!-- layer8_expert6_up -->
<g id="node619" class="node">
<title>layer8_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6164,-12396 5769,-12396 5769,-12328 6164,-12328 6164,-12396"/>
<text text-anchor="middle" x="5966.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5966.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5966.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5966.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert6_up -->
<g id="edge877" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6595.33,-12451.57C6463.89,-12435.37 6317.08,-12416.49 6174.37,-12396.25"/>
<polygon fill="black" stroke="black" points="6174.5,-12392.74 6164.11,-12394.79 6173.51,-12399.67 6174.5,-12392.74"/>
</g>
<!-- layer8_expert7_gate -->
<g id="node622" class="node">
<title>layer8_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6577,-12396 6182,-12396 6182,-12328 6577,-12328 6577,-12396"/>
<text text-anchor="middle" x="6379.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6379.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6379.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6379.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert7_gate -->
<g id="edge882" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6693.53,-12432C6640.4,-12420.32 6587.09,-12408.61 6539.86,-12398.23"/>
<polygon fill="black" stroke="black" points="6540.4,-12394.77 6529.88,-12396.04 6538.89,-12401.6 6540.4,-12394.77"/>
</g>
<!-- layer8_expert7_up -->
<g id="node623" class="node">
<title>layer8_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6990,-12396 6595,-12396 6595,-12328 6990,-12328 6990,-12396"/>
<text text-anchor="middle" x="6792.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6792.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6792.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6792.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert7_up -->
<g id="edge883" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6897.01,-12432C6881.37,-12421.67 6865.68,-12411.31 6851.38,-12401.87"/>
<polygon fill="black" stroke="black" points="6852.95,-12398.72 6842.68,-12396.13 6849.1,-12404.56 6852.95,-12398.72"/>
</g>
<!-- layer8_expert8_gate -->
<g id="node626" class="node">
<title>layer8_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7403,-12396 7008,-12396 7008,-12328 7403,-12328 7403,-12396"/>
<text text-anchor="middle" x="7205.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7205.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7205.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7205.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert8_gate -->
<g id="edge888" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7100.48,-12432C7116.2,-12421.67 7131.97,-12411.31 7146.33,-12401.87"/>
<polygon fill="black" stroke="black" points="7148.64,-12404.54 7155.08,-12396.13 7144.8,-12398.69 7148.64,-12404.54"/>
</g>
<!-- layer8_expert8_up -->
<g id="node627" class="node">
<title>layer8_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7816,-12396 7421,-12396 7421,-12328 7816,-12328 7816,-12396"/>
<text text-anchor="middle" x="7618.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7618.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7618.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7618.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert8_up -->
<g id="edge889" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7263.23,-12440.93C7329.49,-12426.4 7398.56,-12411.25 7457.99,-12398.21"/>
<polygon fill="black" stroke="black" points="7458.81,-12401.61 7467.82,-12396.05 7457.31,-12394.78 7458.81,-12401.61"/>
</g>
<!-- layer8_expert9_gate -->
<g id="node630" class="node">
<title>layer8_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8229,-12396 7834,-12396 7834,-12328 8229,-12328 8229,-12396"/>
<text text-anchor="middle" x="8031.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8031.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8031.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8031.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert9_gate -->
<g id="edge894" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7294.03,-12464.73C7449.07,-12446.13 7642.37,-12421.94 7823.89,-12396.22"/>
<polygon fill="black" stroke="black" points="7824.49,-12399.67 7833.89,-12394.8 7823.5,-12392.74 7824.49,-12399.67"/>
</g>
<!-- layer8_expert9_up -->
<g id="node631" class="node">
<title>layer8_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8642,-12396 8247,-12396 8247,-12328 8642,-12328 8642,-12396"/>
<text text-anchor="middle" x="8444.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8444.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8444.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8444.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert9_up -->
<g id="edge895" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7312.91,-12479.51C7561.39,-12462.52 7917.09,-12434.72 8236.99,-12396.16"/>
<polygon fill="black" stroke="black" points="8237.41,-12399.63 8246.92,-12394.96 8236.57,-12392.68 8237.41,-12399.63"/>
</g>
<!-- layer8_expert10_gate -->
<g id="node634" class="node">
<title>layer8_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9055,-12396 8660,-12396 8660,-12328 9055,-12328 9055,-12396"/>
<text text-anchor="middle" x="8857.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8857.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8857.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8857.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert10_gate -->
<g id="edge900" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7323.93,-12488.01C7655.51,-12474.65 8184.55,-12447.38 8649.98,-12396.14"/>
<polygon fill="black" stroke="black" points="8650.37,-12399.62 8659.93,-12395.04 8649.6,-12392.66 8650.37,-12399.62"/>
</g>
<!-- layer8_expert10_up -->
<g id="node635" class="node">
<title>layer8_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9468,-12396 9073,-12396 9073,-12328 9468,-12328 9468,-12396"/>
<text text-anchor="middle" x="9270.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9270.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9270.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9270.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert10_up -->
<g id="edge901" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7331.24,-12493.57C7738.05,-12484.37 8447.4,-12460.08 9062.97,-12396.13"/>
<polygon fill="black" stroke="black" points="9063.35,-12399.61 9072.93,-12395.09 9062.62,-12392.64 9063.35,-12399.61"/>
</g>
<!-- layer8_expert11_gate -->
<g id="node638" class="node">
<title>layer8_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9881,-12396 9486,-12396 9486,-12328 9881,-12328 9881,-12396"/>
<text text-anchor="middle" x="9683.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9683.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9683.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9683.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert11_gate -->
<g id="edge906" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7336.2,-12497.5C7812.01,-12492.55 8706.7,-12472.86 9475.76,-12396.14"/>
<polygon fill="black" stroke="black" points="9476.33,-12399.6 9485.93,-12395.12 9475.64,-12392.63 9476.33,-12399.6"/>
</g>
<!-- layer8_expert11_up -->
<g id="node639" class="node">
<title>layer8_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10294,-12396 9899,-12396 9899,-12328 10294,-12328 10294,-12396"/>
<text text-anchor="middle" x="10096.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10096.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10096.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10096.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert11_up -->
<g id="edge907" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7329.5,-12492.35C7975.28,-12478.53 9383.47,-12444.03 9888.63,-12396.13"/>
<polygon fill="black" stroke="black" points="9889.32,-12399.58 9898.94,-12395.14 9888.65,-12392.62 9889.32,-12399.58"/>
</g>
<!-- layer8_expert12_gate -->
<g id="node642" class="node">
<title>layer8_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10707,-12396 10312,-12396 10312,-12328 10707,-12328 10707,-12396"/>
<text text-anchor="middle" x="10509.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10509.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10509.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10509.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert12_gate -->
<g id="edge912" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7331.83,-12494.02C8047.92,-12482.46 9715.02,-12450.58 10301.68,-12396.13"/>
<polygon fill="black" stroke="black" points="10302.31,-12399.58 10311.94,-12395.16 10301.65,-12392.61 10302.31,-12399.58"/>
</g>
<!-- layer8_expert12_up -->
<g id="node643" class="node">
<title>layer8_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11120,-12396 10725,-12396 10725,-12328 11120,-12328 11120,-12396"/>
<text text-anchor="middle" x="10922.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10922.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10922.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10922.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert12_up -->
<g id="edge913" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7333.57,-12495.35C8115.82,-12485.92 10045.91,-12457.16 10714.7,-12396.12"/>
<polygon fill="black" stroke="black" points="10715.3,-12399.58 10724.94,-12395.17 10714.66,-12392.61 10715.3,-12399.58"/>
</g>
<!-- layer8_expert13_gate -->
<g id="node646" class="node">
<title>layer8_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11533,-12396 11138,-12396 11138,-12328 11533,-12328 11533,-12396"/>
<text text-anchor="middle" x="11335.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11335.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11335.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11335.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert13_gate -->
<g id="edge918" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7334.74,-12496.43C8179.52,-12489.03 10376.4,-12463.78 11127.8,-12396.11"/>
<polygon fill="black" stroke="black" points="11128.3,-12399.58 11137.94,-12395.18 11127.66,-12392.61 11128.3,-12399.58"/>
</g>
<!-- layer8_expert13_up -->
<g id="node647" class="node">
<title>layer8_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11946,-12396 11551,-12396 11551,-12328 11946,-12328 11946,-12396"/>
<text text-anchor="middle" x="11748.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11748.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11748.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11748.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert13_up -->
<g id="edge919" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7336.14,-12497.31C8240.83,-12491.84 10706.6,-12470.43 11540.9,-12396.1"/>
<polygon fill="black" stroke="black" points="11541.3,-12399.58 11550.94,-12395.19 11540.67,-12392.6 11541.3,-12399.58"/>
</g>
<!-- layer8_expert14_gate -->
<g id="node650" class="node">
<title>layer8_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12359,-12396 11964,-12396 11964,-12328 12359,-12328 12359,-12396"/>
<text text-anchor="middle" x="12161.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12161.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12161.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12161.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert14_gate -->
<g id="edge924" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7336.95,-12498.06C8298.58,-12494.42 11036.12,-12477.11 11953.9,-12396.1"/>
<polygon fill="black" stroke="black" points="11954.29,-12399.58 11963.94,-12395.2 11953.67,-12392.6 11954.29,-12399.58"/>
</g>
<!-- layer8_expert14_up -->
<g id="node651" class="node">
<title>layer8_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12772,-12396 12377,-12396 12377,-12328 12772,-12328 12772,-12396"/>
<text text-anchor="middle" x="12574.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12574.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12574.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12574.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert14_up -->
<g id="edge925" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7337.58,-12498.7C8353.74,-12496.8 11364.92,-12483.81 12366.71,-12396.11"/>
<polygon fill="black" stroke="black" points="12367.29,-12399.57 12376.94,-12395.21 12366.67,-12392.6 12367.29,-12399.57"/>
</g>
<!-- layer8_expert15_gate -->
<g id="node654" class="node">
<title>layer8_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13185,-12396 12790,-12396 12790,-12328 13185,-12328 13185,-12396"/>
<text text-anchor="middle" x="12987.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12987.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12987.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12987.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert15_gate -->
<g id="edge930" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.27,-12499.24C8407.13,-12499.02 11693.73,-12490.53 12779.64,-12396.12"/>
<polygon fill="black" stroke="black" points="12780.29,-12399.57 12789.94,-12395.21 12779.68,-12392.6 12780.29,-12399.57"/>
</g>
<!-- layer8_expert15_up -->
<g id="node655" class="node">
<title>layer8_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13598,-12396 13203,-12396 13203,-12328 13598,-12328 13598,-12396"/>
<text text-anchor="middle" x="13400.5" y="-12380.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13400.5" y="-12365.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13400.5" y="-12350.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13400.5" y="-12335.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_token_distribution&#45;&gt;layer8_expert15_up -->
<g id="edge931" class="edge">
<title>layer8_token_distribution&#45;&gt;layer8_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7339.15,-12499.72C8459.21,-12501.1 12022.63,-12497.26 13192.69,-12396.11"/>
<polygon fill="black" stroke="black" points="13193.29,-12399.57 13202.94,-12395.22 13192.68,-12392.6 13193.29,-12399.57"/>
</g>
<!-- layer8_expert0_act -->
<g id="node596" class="node">
<title>layer8_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1208,-12292 813,-12292 813,-12224 1208,-12224 1208,-12292"/>
<text text-anchor="middle" x="1010.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1010.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1010.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1010.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer8_expert0_gate&#45;&gt;layer8_expert0_act -->
<g id="edge842" class="edge">
<title>layer8_expert0_gate&#45;&gt;layer8_expert0_act</title>
<path fill="none" stroke="black" d="M731.3,-12327.95C774.56,-12317.27 822.7,-12305.38 866.66,-12294.53"/>
<polygon fill="black" stroke="black" points="867.69,-12297.88 876.56,-12292.08 866.01,-12291.08 867.69,-12297.88"/>
</g>
<!-- layer8_expert0_up&#45;&gt;layer8_expert0_act -->
<g id="edge843" class="edge">
<title>layer8_expert0_up&#45;&gt;layer8_expert0_act</title>
<path fill="none" stroke="black" d="M1010.5,-12327.88C1010.5,-12319.78 1010.5,-12310.98 1010.5,-12302.47"/>
<polygon fill="black" stroke="black" points="1014,-12302.3 1010.5,-12292.3 1007,-12302.3 1014,-12302.3"/>
</g>
<!-- layer8_expert0_down -->
<g id="node597" class="node">
<title>layer8_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1414,-12188 1031,-12188 1031,-12120 1414,-12120 1414,-12188"/>
<text text-anchor="middle" x="1222.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1222.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1222.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1222.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer8_expert0_act&#45;&gt;layer8_expert0_down -->
<g id="edge844" class="edge">
<title>layer8_expert0_act&#45;&gt;layer8_expert0_down</title>
<path fill="none" stroke="black" d="M1079.33,-12223.88C1100.17,-12213.86 1123.21,-12202.77 1144.6,-12192.48"/>
<polygon fill="black" stroke="black" points="1146.16,-12195.61 1153.65,-12188.12 1143.12,-12189.31 1146.16,-12195.61"/>
</g>
<!-- layer8_token_aggregation -->
<g id="node658" class="node">
<title>layer8_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7471.24,-12084 6714.44,-12084 6519.76,-11948 7276.56,-11948 7471.24,-12084"/>
<text text-anchor="middle" x="6995.5" y="-12034.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6995.5" y="-12019.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6995.5" y="-12004.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11989.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_expert0_down&#45;&gt;layer8_token_aggregation -->
<g id="edge845" class="edge">
<title>layer8_expert0_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M1414.25,-12141.25C1537.88,-12134.07 1702.13,-12125.29 1847.5,-12120 3628.65,-12055.18 5758.04,-12028.85 6612.82,-12020.37"/>
<polygon fill="black" stroke="black" points="6613.16,-12023.87 6623.13,-12020.27 6613.09,-12016.87 6613.16,-12023.87"/>
</g>
<!-- layer8_expert1_act -->
<g id="node600" class="node">
<title>layer8_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2034,-12292 1639,-12292 1639,-12224 2034,-12224 2034,-12292"/>
<text text-anchor="middle" x="1836.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1836.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1836.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1836.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer8_expert1_gate&#45;&gt;layer8_expert1_act -->
<g id="edge848" class="edge">
<title>layer8_expert1_gate&#45;&gt;layer8_expert1_act</title>
<path fill="none" stroke="black" d="M1557.3,-12327.95C1600.56,-12317.27 1648.7,-12305.38 1692.66,-12294.53"/>
<polygon fill="black" stroke="black" points="1693.69,-12297.88 1702.56,-12292.08 1692.01,-12291.08 1693.69,-12297.88"/>
</g>
<!-- layer8_expert1_up&#45;&gt;layer8_expert1_act -->
<g id="edge849" class="edge">
<title>layer8_expert1_up&#45;&gt;layer8_expert1_act</title>
<path fill="none" stroke="black" d="M1836.5,-12327.88C1836.5,-12319.78 1836.5,-12310.98 1836.5,-12302.47"/>
<polygon fill="black" stroke="black" points="1840,-12302.3 1836.5,-12292.3 1833,-12302.3 1840,-12302.3"/>
</g>
<!-- layer8_expert1_down -->
<g id="node601" class="node">
<title>layer8_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2240,-12188 1857,-12188 1857,-12120 2240,-12120 2240,-12188"/>
<text text-anchor="middle" x="2048.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2048.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2048.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2048.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer8_expert1_act&#45;&gt;layer8_expert1_down -->
<g id="edge850" class="edge">
<title>layer8_expert1_act&#45;&gt;layer8_expert1_down</title>
<path fill="none" stroke="black" d="M1905.33,-12223.88C1926.17,-12213.86 1949.21,-12202.77 1970.6,-12192.48"/>
<polygon fill="black" stroke="black" points="1972.16,-12195.61 1979.65,-12188.12 1969.12,-12189.31 1972.16,-12195.61"/>
</g>
<!-- layer8_expert1_down&#45;&gt;layer8_token_aggregation -->
<g id="edge851" class="edge">
<title>layer8_expert1_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M2240.15,-12142.43C2376.13,-12135.24 2562.97,-12125.98 2727.5,-12120 4163.26,-12067.79 5871.72,-12035.59 6616.74,-12023.04"/>
<polygon fill="black" stroke="black" points="6616.89,-12026.53 6626.82,-12022.87 6616.77,-12019.53 6616.89,-12026.53"/>
</g>
<!-- layer8_expert2_act -->
<g id="node604" class="node">
<title>layer8_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2860,-12292 2465,-12292 2465,-12224 2860,-12224 2860,-12292"/>
<text text-anchor="middle" x="2662.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2662.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2662.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2662.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer8_expert2_gate&#45;&gt;layer8_expert2_act -->
<g id="edge854" class="edge">
<title>layer8_expert2_gate&#45;&gt;layer8_expert2_act</title>
<path fill="none" stroke="black" d="M2383.3,-12327.95C2426.56,-12317.27 2474.7,-12305.38 2518.66,-12294.53"/>
<polygon fill="black" stroke="black" points="2519.69,-12297.88 2528.56,-12292.08 2518.01,-12291.08 2519.69,-12297.88"/>
</g>
<!-- layer8_expert2_up&#45;&gt;layer8_expert2_act -->
<g id="edge855" class="edge">
<title>layer8_expert2_up&#45;&gt;layer8_expert2_act</title>
<path fill="none" stroke="black" d="M2662.5,-12327.88C2662.5,-12319.78 2662.5,-12310.98 2662.5,-12302.47"/>
<polygon fill="black" stroke="black" points="2666,-12302.3 2662.5,-12292.3 2659,-12302.3 2666,-12302.3"/>
</g>
<!-- layer8_expert2_down -->
<g id="node605" class="node">
<title>layer8_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3120,-12188 2737,-12188 2737,-12120 3120,-12120 3120,-12188"/>
<text text-anchor="middle" x="2928.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2928.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2928.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2928.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer8_expert2_act&#45;&gt;layer8_expert2_down -->
<g id="edge856" class="edge">
<title>layer8_expert2_act&#45;&gt;layer8_expert2_down</title>
<path fill="none" stroke="black" d="M2748.86,-12223.88C2775.6,-12213.63 2805.21,-12202.28 2832.55,-12191.79"/>
<polygon fill="black" stroke="black" points="2834.03,-12194.97 2842.12,-12188.12 2831.53,-12188.44 2834.03,-12194.97"/>
</g>
<!-- layer8_expert2_down&#45;&gt;layer8_token_aggregation -->
<g id="edge857" class="edge">
<title>layer8_expert2_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M3120.07,-12137.71C3205.01,-12131.4 3306.19,-12124.52 3397.5,-12120 4570.31,-12061.98 5959.91,-12033.64 6616.17,-12022.67"/>
<polygon fill="black" stroke="black" points="6616.32,-12026.17 6626.26,-12022.5 6616.2,-12019.17 6616.32,-12026.17"/>
</g>
<!-- layer8_expert3_act -->
<g id="node608" class="node">
<title>layer8_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3686,-12292 3291,-12292 3291,-12224 3686,-12224 3686,-12292"/>
<text text-anchor="middle" x="3488.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3488.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3488.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3488.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer8_expert3_gate&#45;&gt;layer8_expert3_act -->
<g id="edge860" class="edge">
<title>layer8_expert3_gate&#45;&gt;layer8_expert3_act</title>
<path fill="none" stroke="black" d="M3209.3,-12327.95C3252.56,-12317.27 3300.7,-12305.38 3344.66,-12294.53"/>
<polygon fill="black" stroke="black" points="3345.69,-12297.88 3354.56,-12292.08 3344.01,-12291.08 3345.69,-12297.88"/>
</g>
<!-- layer8_expert3_up&#45;&gt;layer8_expert3_act -->
<g id="edge861" class="edge">
<title>layer8_expert3_up&#45;&gt;layer8_expert3_act</title>
<path fill="none" stroke="black" d="M3488.5,-12327.88C3488.5,-12319.78 3488.5,-12310.98 3488.5,-12302.47"/>
<polygon fill="black" stroke="black" points="3492,-12302.3 3488.5,-12292.3 3485,-12302.3 3492,-12302.3"/>
</g>
<!-- layer8_expert3_down -->
<g id="node609" class="node">
<title>layer8_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3790,-12188 3407,-12188 3407,-12120 3790,-12120 3790,-12188"/>
<text text-anchor="middle" x="3598.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3598.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3598.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3598.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer8_expert3_act&#45;&gt;layer8_expert3_down -->
<g id="edge862" class="edge">
<title>layer8_expert3_act&#45;&gt;layer8_expert3_down</title>
<path fill="none" stroke="black" d="M3524.21,-12223.88C3534.11,-12214.71 3544.96,-12204.65 3555.23,-12195.12"/>
<polygon fill="black" stroke="black" points="3557.64,-12197.67 3562.59,-12188.3 3552.88,-12192.53 3557.64,-12197.67"/>
</g>
<!-- layer8_expert3_down&#45;&gt;layer8_token_aggregation -->
<g id="edge863" class="edge">
<title>layer8_expert3_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M3790.26,-12145.32C4336.84,-12123.44 5909.51,-12060.48 6628.68,-12031.69"/>
<polygon fill="black" stroke="black" points="6628.83,-12035.18 6638.68,-12031.29 6628.55,-12028.19 6628.83,-12035.18"/>
</g>
<!-- layer8_expert4_act -->
<g id="node612" class="node">
<title>layer8_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4512,-12292 4117,-12292 4117,-12224 4512,-12224 4512,-12292"/>
<text text-anchor="middle" x="4314.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4314.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4314.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4314.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer8_expert4_gate&#45;&gt;layer8_expert4_act -->
<g id="edge866" class="edge">
<title>layer8_expert4_gate&#45;&gt;layer8_expert4_act</title>
<path fill="none" stroke="black" d="M4035.3,-12327.95C4078.56,-12317.27 4126.7,-12305.38 4170.66,-12294.53"/>
<polygon fill="black" stroke="black" points="4171.69,-12297.88 4180.56,-12292.08 4170.01,-12291.08 4171.69,-12297.88"/>
</g>
<!-- layer8_expert4_up&#45;&gt;layer8_expert4_act -->
<g id="edge867" class="edge">
<title>layer8_expert4_up&#45;&gt;layer8_expert4_act</title>
<path fill="none" stroke="black" d="M4314.5,-12327.88C4314.5,-12319.78 4314.5,-12310.98 4314.5,-12302.47"/>
<polygon fill="black" stroke="black" points="4318,-12302.3 4314.5,-12292.3 4311,-12302.3 4318,-12302.3"/>
</g>
<!-- layer8_expert4_down -->
<g id="node613" class="node">
<title>layer8_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="5041,-12188 4658,-12188 4658,-12120 5041,-12120 5041,-12188"/>
<text text-anchor="middle" x="4849.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4849.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4849.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4849.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer8_expert4_act&#45;&gt;layer8_expert4_down -->
<g id="edge868" class="edge">
<title>layer8_expert4_act&#45;&gt;layer8_expert4_down</title>
<path fill="none" stroke="black" d="M4487.83,-12223.95C4544.81,-12213.09 4608.33,-12200.98 4666.03,-12189.98"/>
<polygon fill="black" stroke="black" points="4666.82,-12193.39 4675.99,-12188.08 4665.51,-12186.52 4666.82,-12193.39"/>
</g>
<!-- layer8_expert4_down&#45;&gt;layer8_token_aggregation -->
<g id="edge869" class="edge">
<title>layer8_expert4_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M5041.36,-12140.84C5400.96,-12118.05 6181.31,-12068.6 6639.65,-12039.55"/>
<polygon fill="black" stroke="black" points="6639.99,-12043.04 6649.75,-12038.91 6639.54,-12036.05 6639.99,-12043.04"/>
</g>
<!-- layer8_expert5_act -->
<g id="node616" class="node">
<title>layer8_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5338,-12292 4943,-12292 4943,-12224 5338,-12224 5338,-12292"/>
<text text-anchor="middle" x="5140.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5140.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5140.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5140.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer8_expert5_gate&#45;&gt;layer8_expert5_act -->
<g id="edge872" class="edge">
<title>layer8_expert5_gate&#45;&gt;layer8_expert5_act</title>
<path fill="none" stroke="black" d="M4861.3,-12327.95C4904.56,-12317.27 4952.7,-12305.38 4996.66,-12294.53"/>
<polygon fill="black" stroke="black" points="4997.69,-12297.88 5006.56,-12292.08 4996.01,-12291.08 4997.69,-12297.88"/>
</g>
<!-- layer8_expert5_up&#45;&gt;layer8_expert5_act -->
<g id="edge873" class="edge">
<title>layer8_expert5_up&#45;&gt;layer8_expert5_act</title>
<path fill="none" stroke="black" d="M5140.5,-12327.88C5140.5,-12319.78 5140.5,-12310.98 5140.5,-12302.47"/>
<polygon fill="black" stroke="black" points="5144,-12302.3 5140.5,-12292.3 5137,-12302.3 5144,-12302.3"/>
</g>
<!-- layer8_expert5_down -->
<g id="node617" class="node">
<title>layer8_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5867,-12188 5484,-12188 5484,-12120 5867,-12120 5867,-12188"/>
<text text-anchor="middle" x="5675.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5675.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5675.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5675.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer8_expert5_act&#45;&gt;layer8_expert5_down -->
<g id="edge874" class="edge">
<title>layer8_expert5_act&#45;&gt;layer8_expert5_down</title>
<path fill="none" stroke="black" d="M5313.83,-12223.95C5370.81,-12213.09 5434.33,-12200.98 5492.03,-12189.98"/>
<polygon fill="black" stroke="black" points="5492.82,-12193.39 5501.99,-12188.08 5491.51,-12186.52 5492.82,-12193.39"/>
</g>
<!-- layer8_expert5_down&#45;&gt;layer8_token_aggregation -->
<g id="edge875" class="edge">
<title>layer8_expert5_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M5867.09,-12133.26C6073.49,-12112 6406.01,-12077.74 6656.74,-12051.9"/>
<polygon fill="black" stroke="black" points="6657.15,-12055.38 6666.74,-12050.87 6656.43,-12048.42 6657.15,-12055.38"/>
</g>
<!-- layer8_expert6_act -->
<g id="node620" class="node">
<title>layer8_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6164,-12292 5769,-12292 5769,-12224 6164,-12224 6164,-12292"/>
<text text-anchor="middle" x="5966.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5966.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5966.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5966.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer8_expert6_gate&#45;&gt;layer8_expert6_act -->
<g id="edge878" class="edge">
<title>layer8_expert6_gate&#45;&gt;layer8_expert6_act</title>
<path fill="none" stroke="black" d="M5687.3,-12327.95C5730.56,-12317.27 5778.7,-12305.38 5822.66,-12294.53"/>
<polygon fill="black" stroke="black" points="5823.69,-12297.88 5832.56,-12292.08 5822.01,-12291.08 5823.69,-12297.88"/>
</g>
<!-- layer8_expert6_up&#45;&gt;layer8_expert6_act -->
<g id="edge879" class="edge">
<title>layer8_expert6_up&#45;&gt;layer8_expert6_act</title>
<path fill="none" stroke="black" d="M5966.5,-12327.88C5966.5,-12319.78 5966.5,-12310.98 5966.5,-12302.47"/>
<polygon fill="black" stroke="black" points="5970,-12302.3 5966.5,-12292.3 5963,-12302.3 5970,-12302.3"/>
</g>
<!-- layer8_expert6_down -->
<g id="node621" class="node">
<title>layer8_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6480,-12188 6097,-12188 6097,-12120 6480,-12120 6480,-12188"/>
<text text-anchor="middle" x="6288.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6288.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6288.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6288.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer8_expert6_act&#45;&gt;layer8_expert6_down -->
<g id="edge880" class="edge">
<title>layer8_expert6_act&#45;&gt;layer8_expert6_down</title>
<path fill="none" stroke="black" d="M6071.04,-12223.88C6104.05,-12213.43 6140.69,-12201.82 6174.34,-12191.16"/>
<polygon fill="black" stroke="black" points="6175.73,-12194.39 6184.21,-12188.04 6173.62,-12187.72 6175.73,-12194.39"/>
</g>
<!-- layer8_expert6_down&#45;&gt;layer8_token_aggregation -->
<g id="edge881" class="edge">
<title>layer8_expert6_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M6460.1,-12119.99C6529.18,-12106.7 6610.99,-12090.96 6689.61,-12075.84"/>
<polygon fill="black" stroke="black" points="6690.52,-12079.23 6699.68,-12073.9 6689.2,-12072.36 6690.52,-12079.23"/>
</g>
<!-- layer8_expert7_act -->
<g id="node624" class="node">
<title>layer8_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6990,-12292 6595,-12292 6595,-12224 6990,-12224 6990,-12292"/>
<text text-anchor="middle" x="6792.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6792.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6792.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6792.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer8_expert7_gate&#45;&gt;layer8_expert7_act -->
<g id="edge884" class="edge">
<title>layer8_expert7_gate&#45;&gt;layer8_expert7_act</title>
<path fill="none" stroke="black" d="M6513.3,-12327.95C6556.56,-12317.27 6604.7,-12305.38 6648.66,-12294.53"/>
<polygon fill="black" stroke="black" points="6649.69,-12297.88 6658.56,-12292.08 6648.01,-12291.08 6649.69,-12297.88"/>
</g>
<!-- layer8_expert7_up&#45;&gt;layer8_expert7_act -->
<g id="edge885" class="edge">
<title>layer8_expert7_up&#45;&gt;layer8_expert7_act</title>
<path fill="none" stroke="black" d="M6792.5,-12327.88C6792.5,-12319.78 6792.5,-12310.98 6792.5,-12302.47"/>
<polygon fill="black" stroke="black" points="6796,-12302.3 6792.5,-12292.3 6789,-12302.3 6796,-12302.3"/>
</g>
<!-- layer8_expert7_down -->
<g id="node625" class="node">
<title>layer8_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6987,-12188 6604,-12188 6604,-12120 6987,-12120 6987,-12188"/>
<text text-anchor="middle" x="6795.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6795.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6795.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6795.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer8_expert7_act&#45;&gt;layer8_expert7_down -->
<g id="edge886" class="edge">
<title>layer8_expert7_act&#45;&gt;layer8_expert7_down</title>
<path fill="none" stroke="black" d="M6793.47,-12223.88C6793.71,-12215.78 6793.97,-12206.98 6794.22,-12198.47"/>
<polygon fill="black" stroke="black" points="6797.73,-12198.4 6794.52,-12188.3 6790.73,-12198.19 6797.73,-12198.4"/>
</g>
<!-- layer8_expert7_down&#45;&gt;layer8_token_aggregation -->
<g id="edge887" class="edge">
<title>layer8_expert7_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M6844.17,-12119.9C6857.63,-12110.75 6872.8,-12100.44 6888.2,-12089.97"/>
<polygon fill="black" stroke="black" points="6890.47,-12092.66 6896.77,-12084.14 6886.53,-12086.87 6890.47,-12092.66"/>
</g>
<!-- layer8_expert8_act -->
<g id="node628" class="node">
<title>layer8_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7403,-12292 7008,-12292 7008,-12224 7403,-12224 7403,-12292"/>
<text text-anchor="middle" x="7205.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7205.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7205.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7205.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_expert8_gate&#45;&gt;layer8_expert8_act -->
<g id="edge890" class="edge">
<title>layer8_expert8_gate&#45;&gt;layer8_expert8_act</title>
<path fill="none" stroke="black" d="M7205.5,-12327.88C7205.5,-12319.78 7205.5,-12310.98 7205.5,-12302.47"/>
<polygon fill="black" stroke="black" points="7209,-12302.3 7205.5,-12292.3 7202,-12302.3 7209,-12302.3"/>
</g>
<!-- layer8_expert8_up&#45;&gt;layer8_expert8_act -->
<g id="edge891" class="edge">
<title>layer8_expert8_up&#45;&gt;layer8_expert8_act</title>
<path fill="none" stroke="black" d="M7484.7,-12327.95C7441.44,-12317.27 7393.3,-12305.38 7349.34,-12294.53"/>
<polygon fill="black" stroke="black" points="7349.99,-12291.08 7339.44,-12292.08 7348.31,-12297.88 7349.99,-12291.08"/>
</g>
<!-- layer8_expert8_down -->
<g id="node629" class="node">
<title>layer8_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7394,-12188 7011,-12188 7011,-12120 7394,-12120 7394,-12188"/>
<text text-anchor="middle" x="7202.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7202.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7202.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7202.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_expert8_act&#45;&gt;layer8_expert8_down -->
<g id="edge892" class="edge">
<title>layer8_expert8_act&#45;&gt;layer8_expert8_down</title>
<path fill="none" stroke="black" d="M7204.53,-12223.88C7204.29,-12215.78 7204.03,-12206.98 7203.78,-12198.47"/>
<polygon fill="black" stroke="black" points="7207.27,-12198.19 7203.48,-12188.3 7200.27,-12198.4 7207.27,-12198.19"/>
</g>
<!-- layer8_expert8_down&#45;&gt;layer8_token_aggregation -->
<g id="edge893" class="edge">
<title>layer8_expert8_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M7152.13,-12119.9C7138.06,-12110.66 7122.2,-12100.25 7106.12,-12089.67"/>
<polygon fill="black" stroke="black" points="7107.97,-12086.7 7097.69,-12084.14 7104.12,-12092.55 7107.97,-12086.7"/>
</g>
<!-- layer8_expert9_act -->
<g id="node632" class="node">
<title>layer8_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8229,-12292 7834,-12292 7834,-12224 8229,-12224 8229,-12292"/>
<text text-anchor="middle" x="8031.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8031.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8031.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8031.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_expert9_gate&#45;&gt;layer8_expert9_act -->
<g id="edge896" class="edge">
<title>layer8_expert9_gate&#45;&gt;layer8_expert9_act</title>
<path fill="none" stroke="black" d="M8031.5,-12327.88C8031.5,-12319.78 8031.5,-12310.98 8031.5,-12302.47"/>
<polygon fill="black" stroke="black" points="8035,-12302.3 8031.5,-12292.3 8028,-12302.3 8035,-12302.3"/>
</g>
<!-- layer8_expert9_up&#45;&gt;layer8_expert9_act -->
<g id="edge897" class="edge">
<title>layer8_expert9_up&#45;&gt;layer8_expert9_act</title>
<path fill="none" stroke="black" d="M8310.7,-12327.95C8267.44,-12317.27 8219.3,-12305.38 8175.34,-12294.53"/>
<polygon fill="black" stroke="black" points="8175.99,-12291.08 8165.44,-12292.08 8174.31,-12297.88 8175.99,-12291.08"/>
</g>
<!-- layer8_expert9_down -->
<g id="node633" class="node">
<title>layer8_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8010,-12188 7627,-12188 7627,-12120 8010,-12120 8010,-12188"/>
<text text-anchor="middle" x="7818.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7818.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7818.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7818.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_expert9_act&#45;&gt;layer8_expert9_down -->
<g id="edge898" class="edge">
<title>layer8_expert9_act&#45;&gt;layer8_expert9_down</title>
<path fill="none" stroke="black" d="M7962.35,-12223.88C7941.41,-12213.86 7918.26,-12202.77 7896.77,-12192.48"/>
<polygon fill="black" stroke="black" points="7898.2,-12189.29 7887.67,-12188.12 7895.18,-12195.6 7898.2,-12189.29"/>
</g>
<!-- layer8_expert9_down&#45;&gt;layer8_token_aggregation -->
<g id="edge899" class="edge">
<title>layer8_expert9_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M7626.84,-12121.33C7561.96,-12110.61 7486.75,-12098.18 7411.34,-12085.72"/>
<polygon fill="black" stroke="black" points="7411.62,-12082.22 7401.19,-12084.04 7410.48,-12089.12 7411.62,-12082.22"/>
</g>
<!-- layer8_expert10_act -->
<g id="node636" class="node">
<title>layer8_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9055,-12292 8660,-12292 8660,-12224 9055,-12224 9055,-12292"/>
<text text-anchor="middle" x="8857.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8857.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8857.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8857.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_expert10_gate&#45;&gt;layer8_expert10_act -->
<g id="edge902" class="edge">
<title>layer8_expert10_gate&#45;&gt;layer8_expert10_act</title>
<path fill="none" stroke="black" d="M8857.5,-12327.88C8857.5,-12319.78 8857.5,-12310.98 8857.5,-12302.47"/>
<polygon fill="black" stroke="black" points="8861,-12302.3 8857.5,-12292.3 8854,-12302.3 8861,-12302.3"/>
</g>
<!-- layer8_expert10_up&#45;&gt;layer8_expert10_act -->
<g id="edge903" class="edge">
<title>layer8_expert10_up&#45;&gt;layer8_expert10_act</title>
<path fill="none" stroke="black" d="M9136.7,-12327.95C9093.44,-12317.27 9045.3,-12305.38 9001.34,-12294.53"/>
<polygon fill="black" stroke="black" points="9001.99,-12291.08 8991.44,-12292.08 9000.31,-12297.88 9001.99,-12291.08"/>
</g>
<!-- layer8_expert10_down -->
<g id="node637" class="node">
<title>layer8_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8731,-12188 8348,-12188 8348,-12120 8731,-12120 8731,-12188"/>
<text text-anchor="middle" x="8539.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8539.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8539.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8539.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_expert10_act&#45;&gt;layer8_expert10_down -->
<g id="edge904" class="edge">
<title>layer8_expert10_act&#45;&gt;layer8_expert10_down</title>
<path fill="none" stroke="black" d="M8754.25,-12223.88C8721.65,-12213.43 8685.47,-12201.82 8652.25,-12191.16"/>
<polygon fill="black" stroke="black" points="8653.09,-12187.76 8642.5,-12188.04 8650.95,-12194.42 8653.09,-12187.76"/>
</g>
<!-- layer8_expert10_down&#45;&gt;layer8_token_aggregation -->
<g id="edge905" class="edge">
<title>layer8_expert10_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M8347.85,-12136.12C8122.46,-12116.27 7740.98,-12082.66 7440.54,-12056.2"/>
<polygon fill="black" stroke="black" points="7440.61,-12052.69 7430.34,-12055.3 7439.99,-12059.67 7440.61,-12052.69"/>
</g>
<!-- layer8_expert11_act -->
<g id="node640" class="node">
<title>layer8_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9881,-12292 9486,-12292 9486,-12224 9881,-12224 9881,-12292"/>
<text text-anchor="middle" x="9683.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9683.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9683.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9683.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_expert11_gate&#45;&gt;layer8_expert11_act -->
<g id="edge908" class="edge">
<title>layer8_expert11_gate&#45;&gt;layer8_expert11_act</title>
<path fill="none" stroke="black" d="M9683.5,-12327.88C9683.5,-12319.78 9683.5,-12310.98 9683.5,-12302.47"/>
<polygon fill="black" stroke="black" points="9687,-12302.3 9683.5,-12292.3 9680,-12302.3 9687,-12302.3"/>
</g>
<!-- layer8_expert11_up&#45;&gt;layer8_expert11_act -->
<g id="edge909" class="edge">
<title>layer8_expert11_up&#45;&gt;layer8_expert11_act</title>
<path fill="none" stroke="black" d="M9962.7,-12327.95C9919.44,-12317.27 9871.3,-12305.38 9827.34,-12294.53"/>
<polygon fill="black" stroke="black" points="9827.99,-12291.08 9817.44,-12292.08 9826.31,-12297.88 9827.99,-12291.08"/>
</g>
<!-- layer8_expert11_down -->
<g id="node641" class="node">
<title>layer8_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9505,-12188 9122,-12188 9122,-12120 9505,-12120 9505,-12188"/>
<text text-anchor="middle" x="9313.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9313.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9313.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9313.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_expert11_act&#45;&gt;layer8_expert11_down -->
<g id="edge910" class="edge">
<title>layer8_expert11_act&#45;&gt;layer8_expert11_down</title>
<path fill="none" stroke="black" d="M9563.63,-12223.95C9525.2,-12213.36 9482.47,-12201.58 9443.36,-12190.8"/>
<polygon fill="black" stroke="black" points="9444.07,-12187.36 9433.5,-12188.08 9442.21,-12194.11 9444.07,-12187.36"/>
</g>
<!-- layer8_expert11_down&#45;&gt;layer8_token_aggregation -->
<g id="edge911" class="edge">
<title>layer8_expert11_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M9121.84,-12141.75C8750.82,-12119.99 7926.55,-12071.63 7420.2,-12041.92"/>
<polygon fill="black" stroke="black" points="7420.35,-12038.42 7410.17,-12041.33 7419.94,-12045.41 7420.35,-12038.42"/>
</g>
<!-- layer8_expert12_act -->
<g id="node644" class="node">
<title>layer8_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10707,-12292 10312,-12292 10312,-12224 10707,-12224 10707,-12292"/>
<text text-anchor="middle" x="10509.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10509.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10509.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10509.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_expert12_gate&#45;&gt;layer8_expert12_act -->
<g id="edge914" class="edge">
<title>layer8_expert12_gate&#45;&gt;layer8_expert12_act</title>
<path fill="none" stroke="black" d="M10509.5,-12327.88C10509.5,-12319.78 10509.5,-12310.98 10509.5,-12302.47"/>
<polygon fill="black" stroke="black" points="10513,-12302.3 10509.5,-12292.3 10506,-12302.3 10513,-12302.3"/>
</g>
<!-- layer8_expert12_up&#45;&gt;layer8_expert12_act -->
<g id="edge915" class="edge">
<title>layer8_expert12_up&#45;&gt;layer8_expert12_act</title>
<path fill="none" stroke="black" d="M10788.7,-12327.95C10745.44,-12317.27 10697.3,-12305.38 10653.34,-12294.53"/>
<polygon fill="black" stroke="black" points="10653.99,-12291.08 10643.44,-12292.08 10652.31,-12297.88 10653.99,-12291.08"/>
</g>
<!-- layer8_expert12_down -->
<g id="node645" class="node">
<title>layer8_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10305,-12188 9922,-12188 9922,-12120 10305,-12120 10305,-12188"/>
<text text-anchor="middle" x="10113.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10113.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10113.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10113.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_expert12_act&#45;&gt;layer8_expert12_down -->
<g id="edge916" class="edge">
<title>layer8_expert12_act&#45;&gt;layer8_expert12_down</title>
<path fill="none" stroke="black" d="M10381.2,-12223.95C10339.81,-12213.29 10293.76,-12201.43 10251.69,-12190.59"/>
<polygon fill="black" stroke="black" points="10252.49,-12187.19 10241.93,-12188.08 10250.74,-12193.96 10252.49,-12187.19"/>
</g>
<!-- layer8_expert12_down&#45;&gt;layer8_token_aggregation -->
<g id="edge917" class="edge">
<title>layer8_expert12_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M9921.67,-12141.74C9804.15,-12135.01 9650.65,-12126.53 9514.5,-12120 8771.75,-12084.36 7905.41,-12050.66 7406.65,-12032.02"/>
<polygon fill="black" stroke="black" points="7406.53,-12028.52 7396.41,-12031.64 7406.27,-12035.51 7406.53,-12028.52"/>
</g>
<!-- layer8_expert13_act -->
<g id="node648" class="node">
<title>layer8_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11533,-12292 11138,-12292 11138,-12224 11533,-12224 11533,-12292"/>
<text text-anchor="middle" x="11335.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11335.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11335.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11335.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_expert13_gate&#45;&gt;layer8_expert13_act -->
<g id="edge920" class="edge">
<title>layer8_expert13_gate&#45;&gt;layer8_expert13_act</title>
<path fill="none" stroke="black" d="M11335.5,-12327.88C11335.5,-12319.78 11335.5,-12310.98 11335.5,-12302.47"/>
<polygon fill="black" stroke="black" points="11339,-12302.3 11335.5,-12292.3 11332,-12302.3 11339,-12302.3"/>
</g>
<!-- layer8_expert13_up&#45;&gt;layer8_expert13_act -->
<g id="edge921" class="edge">
<title>layer8_expert13_up&#45;&gt;layer8_expert13_act</title>
<path fill="none" stroke="black" d="M11614.7,-12327.95C11571.44,-12317.27 11523.3,-12305.38 11479.34,-12294.53"/>
<polygon fill="black" stroke="black" points="11479.99,-12291.08 11469.44,-12292.08 11478.31,-12297.88 11479.99,-12291.08"/>
</g>
<!-- layer8_expert13_down -->
<g id="node649" class="node">
<title>layer8_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11118,-12188 10735,-12188 10735,-12120 11118,-12120 11118,-12188"/>
<text text-anchor="middle" x="10926.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10926.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10926.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10926.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_expert13_act&#45;&gt;layer8_expert13_down -->
<g id="edge922" class="edge">
<title>layer8_expert13_act&#45;&gt;layer8_expert13_down</title>
<path fill="none" stroke="black" d="M11202.99,-12223.95C11160.15,-12213.27 11112.48,-12201.38 11068.95,-12190.53"/>
<polygon fill="black" stroke="black" points="11069.7,-12187.1 11059.15,-12188.08 11068,-12193.9 11069.7,-12187.1"/>
</g>
<!-- layer8_expert13_down&#45;&gt;layer8_token_aggregation -->
<g id="edge923" class="edge">
<title>layer8_expert13_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M10734.98,-12141.55C10614.35,-12134.61 10455.36,-12125.98 10314.5,-12120 9263.09,-12075.34 8023.53,-12042 7398.76,-12026.54"/>
<polygon fill="black" stroke="black" points="7398.78,-12023.04 7388.69,-12026.3 7398.6,-12030.04 7398.78,-12023.04"/>
</g>
<!-- layer8_expert14_act -->
<g id="node652" class="node">
<title>layer8_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12359,-12292 11964,-12292 11964,-12224 12359,-12224 12359,-12292"/>
<text text-anchor="middle" x="12161.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12161.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12161.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12161.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_expert14_gate&#45;&gt;layer8_expert14_act -->
<g id="edge926" class="edge">
<title>layer8_expert14_gate&#45;&gt;layer8_expert14_act</title>
<path fill="none" stroke="black" d="M12161.5,-12327.88C12161.5,-12319.78 12161.5,-12310.98 12161.5,-12302.47"/>
<polygon fill="black" stroke="black" points="12165,-12302.3 12161.5,-12292.3 12158,-12302.3 12165,-12302.3"/>
</g>
<!-- layer8_expert14_up&#45;&gt;layer8_expert14_act -->
<g id="edge927" class="edge">
<title>layer8_expert14_up&#45;&gt;layer8_expert14_act</title>
<path fill="none" stroke="black" d="M12440.7,-12327.95C12397.44,-12317.27 12349.3,-12305.38 12305.34,-12294.53"/>
<polygon fill="black" stroke="black" points="12305.99,-12291.08 12295.44,-12292.08 12304.31,-12297.88 12305.99,-12291.08"/>
</g>
<!-- layer8_expert14_down -->
<g id="node653" class="node">
<title>layer8_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11937,-12188 11554,-12188 11554,-12120 11937,-12120 11937,-12188"/>
<text text-anchor="middle" x="11745.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11745.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11745.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11745.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_expert14_act&#45;&gt;layer8_expert14_down -->
<g id="edge928" class="edge">
<title>layer8_expert14_act&#45;&gt;layer8_expert14_down</title>
<path fill="none" stroke="black" d="M12026.72,-12223.95C11983.15,-12213.27 11934.66,-12201.38 11890.39,-12190.53"/>
<polygon fill="black" stroke="black" points="11890.96,-12187.06 11880.42,-12188.08 11889.3,-12193.86 11890.96,-12187.06"/>
</g>
<!-- layer8_expert14_down&#45;&gt;layer8_token_aggregation -->
<g id="edge929" class="edge">
<title>layer8_expert14_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M11553.83,-12141.36C11431.82,-12134.3 11270.43,-12125.6 11127.5,-12120 9757.85,-12066.37 8131.66,-12035.43 7394.32,-12023.17"/>
<polygon fill="black" stroke="black" points="7394.12,-12019.67 7384.07,-12023 7394.01,-12026.67 7394.12,-12019.67"/>
</g>
<!-- layer8_expert15_act -->
<g id="node656" class="node">
<title>layer8_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13185,-12292 12790,-12292 12790,-12224 13185,-12224 13185,-12292"/>
<text text-anchor="middle" x="12987.5" y="-12276.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12987.5" y="-12261.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12987.5" y="-12246.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12987.5" y="-12231.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_expert15_gate&#45;&gt;layer8_expert15_act -->
<g id="edge932" class="edge">
<title>layer8_expert15_gate&#45;&gt;layer8_expert15_act</title>
<path fill="none" stroke="black" d="M12987.5,-12327.88C12987.5,-12319.78 12987.5,-12310.98 12987.5,-12302.47"/>
<polygon fill="black" stroke="black" points="12991,-12302.3 12987.5,-12292.3 12984,-12302.3 12991,-12302.3"/>
</g>
<!-- layer8_expert15_up&#45;&gt;layer8_expert15_act -->
<g id="edge933" class="edge">
<title>layer8_expert15_up&#45;&gt;layer8_expert15_act</title>
<path fill="none" stroke="black" d="M13266.7,-12327.95C13223.44,-12317.27 13175.3,-12305.38 13131.34,-12294.53"/>
<polygon fill="black" stroke="black" points="13131.99,-12291.08 13121.44,-12292.08 13130.31,-12297.88 13131.99,-12291.08"/>
</g>
<!-- layer8_expert15_down -->
<g id="node657" class="node">
<title>layer8_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12760,-12188 12377,-12188 12377,-12120 12760,-12120 12760,-12188"/>
<text text-anchor="middle" x="12568.5" y="-12172.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12568.5" y="-12157.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12568.5" y="-12142.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12568.5" y="-12127.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_expert15_act&#45;&gt;layer8_expert15_down -->
<g id="edge934" class="edge">
<title>layer8_expert15_act&#45;&gt;layer8_expert15_down</title>
<path fill="none" stroke="black" d="M12851.75,-12223.95C12807.77,-12213.25 12758.82,-12201.33 12714.15,-12190.46"/>
<polygon fill="black" stroke="black" points="12714.93,-12187.05 12704.39,-12188.08 12713.28,-12193.85 12714.93,-12187.05"/>
</g>
<!-- layer8_expert15_down&#45;&gt;layer8_token_aggregation -->
<g id="edge935" class="edge">
<title>layer8_expert15_down&#45;&gt;layer8_token_aggregation</title>
<path fill="none" stroke="black" d="M12376.98,-12141.24C12254.02,-12134.09 12090.9,-12125.33 11946.5,-12120 10252.24,-12057.45 8230.33,-12030.15 7390.93,-12020.91"/>
<polygon fill="black" stroke="black" points="7390.84,-12017.4 7380.8,-12020.79 7390.76,-12024.4 7390.84,-12017.4"/>
</g>
<!-- layer8_res2 -->
<g id="node659" class="node">
<title>layer8_res2</title>
<polygon fill="none" stroke="black" points="7436.24,-11912 6735.12,-11912 6554.76,-11746 7255.88,-11746 7436.24,-11912"/>
<text text-anchor="middle" x="6995.5" y="-11855.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6995.5" y="-11840.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11825.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11810.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11795.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_token_aggregation&#45;&gt;layer8_res2 -->
<g id="edge936" class="edge">
<title>layer8_token_aggregation&#45;&gt;layer8_res2</title>
<path fill="none" stroke="black" d="M6995.5,-11947.95C6995.5,-11939.63 6995.5,-11931 6995.5,-11922.38"/>
<polygon fill="black" stroke="black" points="6999,-11922.28 6995.5,-11912.28 6992,-11922.28 6999,-11922.28"/>
</g>
<!-- layer9_mha_qkv -->
<g id="node660" class="node">
<title>layer9_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7231.5,-11710 6759.5,-11710 6759.5,-11642 7231.5,-11642 7231.5,-11710"/>
<text text-anchor="middle" x="6995.5" y="-11694.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6995.5" y="-11679.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11664.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6995.5" y="-11649.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_res2&#45;&gt;layer9_mha_qkv -->
<g id="edge937" class="edge">
<title>layer8_res2&#45;&gt;layer9_mha_qkv</title>
<path fill="none" stroke="black" d="M6995.5,-11745.87C6995.5,-11737.12 6995.5,-11728.48 6995.5,-11720.45"/>
<polygon fill="black" stroke="black" points="6999,-11720.26 6995.5,-11710.26 6992,-11720.26 6999,-11720.26"/>
</g>
<!-- layer9_mha_attn -->
<g id="node661" class="node">
<title>layer9_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7225.5,-11606 6765.5,-11606 6765.5,-11538 7225.5,-11538 7225.5,-11606"/>
<text text-anchor="middle" x="6995.5" y="-11590.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6995.5" y="-11575.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6995.5" y="-11560.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11545.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_mha_qkv&#45;&gt;layer9_mha_attn -->
<g id="edge938" class="edge">
<title>layer9_mha_qkv&#45;&gt;layer9_mha_attn</title>
<path fill="none" stroke="black" d="M6995.5,-11641.88C6995.5,-11633.78 6995.5,-11624.98 6995.5,-11616.47"/>
<polygon fill="black" stroke="black" points="6999,-11616.3 6995.5,-11606.3 6992,-11616.3 6999,-11616.3"/>
</g>
<!-- layer9_mha_out -->
<g id="node662" class="node">
<title>layer9_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7208,-11502 6783,-11502 6783,-11434 7208,-11434 7208,-11502"/>
<text text-anchor="middle" x="6995.5" y="-11486.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6995.5" y="-11471.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11456.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11441.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_mha_attn&#45;&gt;layer9_mha_out -->
<g id="edge939" class="edge">
<title>layer9_mha_attn&#45;&gt;layer9_mha_out</title>
<path fill="none" stroke="black" d="M6995.5,-11537.88C6995.5,-11529.78 6995.5,-11520.98 6995.5,-11512.47"/>
<polygon fill="black" stroke="black" points="6999,-11512.3 6995.5,-11502.3 6992,-11512.3 6999,-11512.3"/>
</g>
<!-- layer9_res1 -->
<g id="node663" class="node">
<title>layer9_res1</title>
<polygon fill="none" stroke="black" points="7436.24,-11398 6735.12,-11398 6554.76,-11232 7255.88,-11232 7436.24,-11398"/>
<text text-anchor="middle" x="6995.5" y="-11341.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6995.5" y="-11326.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11311.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11296.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11281.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_mha_out&#45;&gt;layer9_res1 -->
<g id="edge940" class="edge">
<title>layer9_mha_out&#45;&gt;layer9_res1</title>
<path fill="none" stroke="black" d="M6995.5,-11433.86C6995.5,-11426.1 6995.5,-11417.46 6995.5,-11408.48"/>
<polygon fill="black" stroke="black" points="6999,-11408.23 6995.5,-11398.23 6992,-11408.23 6999,-11408.23"/>
</g>
<!-- layer9_ln1 -->
<g id="node664" class="node">
<title>layer9_ln1</title>
<polygon fill="yellow" stroke="black" points="7208,-11196 6783,-11196 6783,-11128 7208,-11128 7208,-11196"/>
<text text-anchor="middle" x="6995.5" y="-11180.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6995.5" y="-11165.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11150.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-11135.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_res1&#45;&gt;layer9_ln1 -->
<g id="edge941" class="edge">
<title>layer9_res1&#45;&gt;layer9_ln1</title>
<path fill="none" stroke="black" d="M6995.5,-11231.87C6995.5,-11223.12 6995.5,-11214.48 6995.5,-11206.45"/>
<polygon fill="black" stroke="black" points="6999,-11206.26 6995.5,-11196.26 6992,-11206.26 6999,-11206.26"/>
</g>
<!-- layer9_expert_routing -->
<g id="node665" class="node">
<title>layer9_expert_routing</title>
<polygon fill="orange" stroke="black" points="6995.5,-11092 6579.5,-11009 6995.5,-10926 7411.5,-11009 6995.5,-11092"/>
<text text-anchor="middle" x="6995.5" y="-11035.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6995.5" y="-11020.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6995.5" y="-11005.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-10990.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6995.5" y="-10975.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_ln1&#45;&gt;layer9_expert_routing -->
<g id="edge942" class="edge">
<title>layer9_ln1&#45;&gt;layer9_expert_routing</title>
<path fill="none" stroke="black" d="M6995.5,-11127.86C6995.5,-11120.1 6995.5,-11111.46 6995.5,-11102.48"/>
<polygon fill="black" stroke="black" points="6999,-11102.23 6995.5,-11092.23 6992,-11102.23 6999,-11102.23"/>
</g>
<!-- layer9_token_distribution -->
<g id="node666" class="node">
<title>layer9_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7423.86,-10890 6742.44,-10890 6567.14,-10754 7248.56,-10754 7423.86,-10890"/>
<text text-anchor="middle" x="6995.5" y="-10840.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6995.5" y="-10825.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6995.5" y="-10810.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6995.5" y="-10795.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer9_expert_routing&#45;&gt;layer9_token_distribution -->
<g id="edge943" class="edge">
<title>layer9_expert_routing&#45;&gt;layer9_token_distribution</title>
<path fill="none" stroke="black" d="M6995.5,-10925.78C6995.5,-10917.34 6995.5,-10908.79 6995.5,-10900.4"/>
<polygon fill="black" stroke="black" points="6999,-10900.28 6995.5,-10890.28 6992,-10900.28 6999,-10900.28"/>
</g>
<!-- layer9_expert0_gate -->
<g id="node667" class="node">
<title>layer9_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="792,-10718 397,-10718 397,-10650 792,-10650 792,-10718"/>
<text text-anchor="middle" x="594.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="594.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="594.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="594.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert0_gate -->
<g id="edge944" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6654.42,-10821.72C5533.99,-10823.09 1972.01,-10819.23 802.31,-10718.11"/>
<polygon fill="black" stroke="black" points="802.32,-10714.6 792.06,-10717.22 801.71,-10721.57 802.32,-10714.6"/>
</g>
<!-- layer9_expert0_up -->
<g id="node668" class="node">
<title>layer9_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1205,-10718 810,-10718 810,-10650 1205,-10650 1205,-10718"/>
<text text-anchor="middle" x="1007.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1007.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1007.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1007.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert0_up -->
<g id="edge945" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6653.42,-10821.24C5582.28,-10821 2300.27,-10812.44 1215.35,-10718.12"/>
<polygon fill="black" stroke="black" points="1215.32,-10714.6 1205.06,-10717.21 1214.71,-10721.57 1215.32,-10714.6"/>
</g>
<!-- layer9_expert1_gate -->
<g id="node671" class="node">
<title>layer9_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1618,-10718 1223,-10718 1223,-10650 1618,-10650 1618,-10718"/>
<text text-anchor="middle" x="1420.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1420.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1420.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1420.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert1_gate -->
<g id="edge950" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6652.86,-10820.69C5633.38,-10818.77 2628.69,-10805.69 1628.28,-10718.11"/>
<polygon fill="black" stroke="black" points="1628.33,-10714.6 1618.06,-10717.21 1627.71,-10721.57 1628.33,-10714.6"/>
</g>
<!-- layer9_expert1_up -->
<g id="node672" class="node">
<title>layer9_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2031,-10718 1636,-10718 1636,-10650 2031,-10650 2031,-10718"/>
<text text-anchor="middle" x="1833.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1833.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1833.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1833.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert1_up -->
<g id="edge951" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6651.92,-10820.04C5685.86,-10816.35 2957.03,-10798.95 2041.08,-10718.09"/>
<polygon fill="black" stroke="black" points="2041.33,-10714.6 2031.06,-10717.2 2040.71,-10721.58 2041.33,-10714.6"/>
</g>
<!-- layer9_expert2_gate -->
<g id="node675" class="node">
<title>layer9_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2444,-10718 2049,-10718 2049,-10650 2444,-10650 2444,-10718"/>
<text text-anchor="middle" x="2246.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2246.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2246.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2246.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert2_gate -->
<g id="edge956" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6650.93,-10819.27C5740.78,-10813.72 3286.04,-10792.22 2454.07,-10718.1"/>
<polygon fill="black" stroke="black" points="2454.33,-10714.6 2444.06,-10717.19 2453.7,-10721.58 2454.33,-10714.6"/>
</g>
<!-- layer9_expert2_up -->
<g id="node676" class="node">
<title>layer9_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2857,-10718 2462,-10718 2462,-10650 2857,-10650 2857,-10718"/>
<text text-anchor="middle" x="2659.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2659.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2659.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2659.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert2_up -->
<g id="edge957" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6649.99,-10818.34C5798.65,-10810.84 3615.62,-10785.52 2867.16,-10718.1"/>
<polygon fill="black" stroke="black" points="2867.34,-10714.61 2857.06,-10717.18 2866.7,-10721.58 2867.34,-10714.61"/>
</g>
<!-- layer9_expert3_gate -->
<g id="node679" class="node">
<title>layer9_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3270,-10718 2875,-10718 2875,-10650 3270,-10650 3270,-10718"/>
<text text-anchor="middle" x="3072.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3072.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3072.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3072.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert3_gate -->
<g id="edge962" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6648.41,-10817.2C5858.73,-10807.62 3945.42,-10778.84 3280.24,-10718.11"/>
<polygon fill="black" stroke="black" points="3280.34,-10714.61 3270.06,-10717.17 3279.7,-10721.58 3280.34,-10714.61"/>
</g>
<!-- layer9_expert3_up -->
<g id="node680" class="node">
<title>layer9_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3683,-10718 3288,-10718 3288,-10650 3683,-10650 3683,-10718"/>
<text text-anchor="middle" x="3485.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3485.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3485.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3485.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert3_up -->
<g id="edge963" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6646.52,-10815.77C5922.21,-10803.98 4275.46,-10772.17 3693.25,-10718.12"/>
<polygon fill="black" stroke="black" points="3693.35,-10714.61 3683.06,-10717.16 3692.69,-10721.58 3693.35,-10714.61"/>
</g>
<!-- layer9_expert4_gate -->
<g id="node683" class="node">
<title>layer9_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4096,-10718 3701,-10718 3701,-10650 4096,-10650 4096,-10718"/>
<text text-anchor="middle" x="3898.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3898.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3898.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3898.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert4_gate -->
<g id="edge968" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.06,-10813.9C5989.59,-10799.8 4605.94,-10765.52 4106.26,-10718.12"/>
<polygon fill="black" stroke="black" points="4106.35,-10714.62 4096.06,-10717.14 4105.68,-10721.58 4106.35,-10714.62"/>
</g>
<!-- layer9_expert4_up -->
<g id="node684" class="node">
<title>layer9_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4509,-10718 4114,-10718 4114,-10650 4509,-10650 4509,-10718"/>
<text text-anchor="middle" x="4311.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4311.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4311.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4311.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert4_up -->
<g id="edge969" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6651.37,-10819.42C6174.11,-10814.35 5284.47,-10794.49 4519.19,-10718.13"/>
<polygon fill="black" stroke="black" points="4519.36,-10714.63 4509.07,-10717.12 4518.67,-10721.6 4519.36,-10714.63"/>
</g>
<!-- layer9_expert5_gate -->
<g id="node687" class="node">
<title>layer9_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4922,-10718 4527,-10718 4527,-10650 4922,-10650 4922,-10718"/>
<text text-anchor="middle" x="4724.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4724.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4724.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4724.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert5_gate -->
<g id="edge974" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6645.68,-10815.16C6236.56,-10805.67 5539.04,-10781.18 4932.34,-10718.16"/>
<polygon fill="black" stroke="black" points="4932.38,-10714.64 4922.07,-10717.09 4931.65,-10721.61 4932.38,-10714.64"/>
</g>
<!-- layer9_expert5_up -->
<g id="node688" class="node">
<title>layer9_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5335,-10718 4940,-10718 4940,-10650 5335,-10650 5335,-10718"/>
<text text-anchor="middle" x="5137.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5137.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5137.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5137.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert5_up -->
<g id="edge975" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6637.34,-10808.65C6304.6,-10794.84 5795.32,-10767.72 5345.03,-10718.14"/>
<polygon fill="black" stroke="black" points="5345.4,-10714.66 5335.07,-10717.04 5344.63,-10721.62 5345.4,-10714.66"/>
</g>
<!-- layer9_expert6_gate -->
<g id="node691" class="node">
<title>layer9_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5748,-10718 5353,-10718 5353,-10650 5748,-10650 5748,-10718"/>
<text text-anchor="middle" x="5550.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5550.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5550.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5550.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert6_gate -->
<g id="edge980" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6623.03,-10797.44C6379.4,-10780.23 6054.1,-10753.86 5758.16,-10718.18"/>
<polygon fill="black" stroke="black" points="5758.43,-10714.68 5748.08,-10716.96 5757.59,-10721.63 5758.43,-10714.68"/>
</g>
<!-- layer9_expert6_up -->
<g id="node692" class="node">
<title>layer9_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6161,-10718 5766,-10718 5766,-10650 6161,-10650 6161,-10718"/>
<text text-anchor="middle" x="5963.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5963.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5963.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5963.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert6_up -->
<g id="edge981" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6592.33,-10773.57C6460.89,-10757.37 6314.08,-10738.49 6171.37,-10718.25"/>
<polygon fill="black" stroke="black" points="6171.5,-10714.74 6161.11,-10716.79 6170.51,-10721.67 6171.5,-10714.74"/>
</g>
<!-- layer9_expert7_gate -->
<g id="node695" class="node">
<title>layer9_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6574,-10718 6179,-10718 6179,-10650 6574,-10650 6574,-10718"/>
<text text-anchor="middle" x="6376.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6376.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6376.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6376.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert7_gate -->
<g id="edge986" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6690.53,-10754C6637.4,-10742.32 6584.09,-10730.61 6536.86,-10720.23"/>
<polygon fill="black" stroke="black" points="6537.4,-10716.77 6526.88,-10718.04 6535.89,-10723.6 6537.4,-10716.77"/>
</g>
<!-- layer9_expert7_up -->
<g id="node696" class="node">
<title>layer9_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6987,-10718 6592,-10718 6592,-10650 6987,-10650 6987,-10718"/>
<text text-anchor="middle" x="6789.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6789.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6789.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6789.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert7_up -->
<g id="edge987" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6894.01,-10754C6878.37,-10743.67 6862.68,-10733.31 6848.38,-10723.87"/>
<polygon fill="black" stroke="black" points="6849.95,-10720.72 6839.68,-10718.13 6846.1,-10726.56 6849.95,-10720.72"/>
</g>
<!-- layer9_expert8_gate -->
<g id="node699" class="node">
<title>layer9_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7400,-10718 7005,-10718 7005,-10650 7400,-10650 7400,-10718"/>
<text text-anchor="middle" x="7202.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7202.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7202.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7202.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert8_gate -->
<g id="edge992" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7097.48,-10754C7113.2,-10743.67 7128.97,-10733.31 7143.33,-10723.87"/>
<polygon fill="black" stroke="black" points="7145.64,-10726.54 7152.08,-10718.13 7141.8,-10720.69 7145.64,-10726.54"/>
</g>
<!-- layer9_expert8_up -->
<g id="node700" class="node">
<title>layer9_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7813,-10718 7418,-10718 7418,-10650 7813,-10650 7813,-10718"/>
<text text-anchor="middle" x="7615.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7615.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7615.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7615.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert8_up -->
<g id="edge993" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7260.23,-10762.93C7326.49,-10748.4 7395.56,-10733.25 7454.99,-10720.21"/>
<polygon fill="black" stroke="black" points="7455.81,-10723.61 7464.82,-10718.05 7454.31,-10716.78 7455.81,-10723.61"/>
</g>
<!-- layer9_expert9_gate -->
<g id="node703" class="node">
<title>layer9_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8226,-10718 7831,-10718 7831,-10650 8226,-10650 8226,-10718"/>
<text text-anchor="middle" x="8028.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8028.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8028.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8028.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert9_gate -->
<g id="edge998" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7291.03,-10786.73C7446.07,-10768.13 7639.37,-10743.94 7820.89,-10718.22"/>
<polygon fill="black" stroke="black" points="7821.49,-10721.67 7830.89,-10716.8 7820.5,-10714.74 7821.49,-10721.67"/>
</g>
<!-- layer9_expert9_up -->
<g id="node704" class="node">
<title>layer9_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8639,-10718 8244,-10718 8244,-10650 8639,-10650 8639,-10718"/>
<text text-anchor="middle" x="8441.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8441.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8441.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8441.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert9_up -->
<g id="edge999" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7309.91,-10801.51C7558.39,-10784.52 7914.09,-10756.72 8233.99,-10718.16"/>
<polygon fill="black" stroke="black" points="8234.41,-10721.63 8243.92,-10716.96 8233.57,-10714.68 8234.41,-10721.63"/>
</g>
<!-- layer9_expert10_gate -->
<g id="node707" class="node">
<title>layer9_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9052,-10718 8657,-10718 8657,-10650 9052,-10650 9052,-10718"/>
<text text-anchor="middle" x="8854.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8854.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8854.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8854.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert10_gate -->
<g id="edge1004" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.93,-10810.01C7652.51,-10796.65 8181.55,-10769.38 8646.98,-10718.14"/>
<polygon fill="black" stroke="black" points="8647.37,-10721.62 8656.93,-10717.04 8646.6,-10714.66 8647.37,-10721.62"/>
</g>
<!-- layer9_expert10_up -->
<g id="node708" class="node">
<title>layer9_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9465,-10718 9070,-10718 9070,-10650 9465,-10650 9465,-10718"/>
<text text-anchor="middle" x="9267.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9267.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9267.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9267.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert10_up -->
<g id="edge1005" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7328.24,-10815.57C7735.05,-10806.37 8444.4,-10782.08 9059.97,-10718.13"/>
<polygon fill="black" stroke="black" points="9060.35,-10721.61 9069.93,-10717.09 9059.62,-10714.64 9060.35,-10721.61"/>
</g>
<!-- layer9_expert11_gate -->
<g id="node711" class="node">
<title>layer9_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9878,-10718 9483,-10718 9483,-10650 9878,-10650 9878,-10718"/>
<text text-anchor="middle" x="9680.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9680.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9680.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9680.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert11_gate -->
<g id="edge1010" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7333.2,-10819.5C7809.01,-10814.55 8703.7,-10794.86 9472.76,-10718.14"/>
<polygon fill="black" stroke="black" points="9473.33,-10721.6 9482.93,-10717.12 9472.64,-10714.63 9473.33,-10721.6"/>
</g>
<!-- layer9_expert11_up -->
<g id="node712" class="node">
<title>layer9_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10291,-10718 9896,-10718 9896,-10650 10291,-10650 10291,-10718"/>
<text text-anchor="middle" x="10093.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10093.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10093.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10093.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert11_up -->
<g id="edge1011" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7326.5,-10814.35C7972.28,-10800.53 9380.47,-10766.03 9885.63,-10718.13"/>
<polygon fill="black" stroke="black" points="9886.32,-10721.58 9895.94,-10717.14 9885.65,-10714.62 9886.32,-10721.58"/>
</g>
<!-- layer9_expert12_gate -->
<g id="node715" class="node">
<title>layer9_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10704,-10718 10309,-10718 10309,-10650 10704,-10650 10704,-10718"/>
<text text-anchor="middle" x="10506.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10506.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10506.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10506.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert12_gate -->
<g id="edge1016" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7328.83,-10816.02C8044.92,-10804.46 9712.02,-10772.58 10298.68,-10718.13"/>
<polygon fill="black" stroke="black" points="10299.31,-10721.58 10308.94,-10717.16 10298.65,-10714.61 10299.31,-10721.58"/>
</g>
<!-- layer9_expert12_up -->
<g id="node716" class="node">
<title>layer9_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11117,-10718 10722,-10718 10722,-10650 11117,-10650 11117,-10718"/>
<text text-anchor="middle" x="10919.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10919.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10919.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10919.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert12_up -->
<g id="edge1017" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7330.57,-10817.35C8112.82,-10807.92 10042.91,-10779.16 10711.7,-10718.12"/>
<polygon fill="black" stroke="black" points="10712.3,-10721.58 10721.94,-10717.17 10711.66,-10714.61 10712.3,-10721.58"/>
</g>
<!-- layer9_expert13_gate -->
<g id="node719" class="node">
<title>layer9_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11530,-10718 11135,-10718 11135,-10650 11530,-10650 11530,-10718"/>
<text text-anchor="middle" x="11332.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11332.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11332.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11332.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert13_gate -->
<g id="edge1022" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7331.74,-10818.43C8176.52,-10811.03 10373.4,-10785.78 11124.8,-10718.11"/>
<polygon fill="black" stroke="black" points="11125.3,-10721.58 11134.94,-10717.18 11124.66,-10714.61 11125.3,-10721.58"/>
</g>
<!-- layer9_expert13_up -->
<g id="node720" class="node">
<title>layer9_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11943,-10718 11548,-10718 11548,-10650 11943,-10650 11943,-10718"/>
<text text-anchor="middle" x="11745.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11745.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11745.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11745.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert13_up -->
<g id="edge1023" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7333.14,-10819.31C8237.83,-10813.84 10703.6,-10792.43 11537.9,-10718.1"/>
<polygon fill="black" stroke="black" points="11538.3,-10721.58 11547.94,-10717.19 11537.67,-10714.6 11538.3,-10721.58"/>
</g>
<!-- layer9_expert14_gate -->
<g id="node723" class="node">
<title>layer9_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12356,-10718 11961,-10718 11961,-10650 12356,-10650 12356,-10718"/>
<text text-anchor="middle" x="12158.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12158.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12158.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12158.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert14_gate -->
<g id="edge1028" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7333.95,-10820.06C8295.58,-10816.42 11033.12,-10799.11 11950.9,-10718.1"/>
<polygon fill="black" stroke="black" points="11951.29,-10721.58 11960.94,-10717.2 11950.67,-10714.6 11951.29,-10721.58"/>
</g>
<!-- layer9_expert14_up -->
<g id="node724" class="node">
<title>layer9_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12769,-10718 12374,-10718 12374,-10650 12769,-10650 12769,-10718"/>
<text text-anchor="middle" x="12571.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12571.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12571.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12571.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert14_up -->
<g id="edge1029" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7334.58,-10820.7C8350.74,-10818.8 11361.92,-10805.81 12363.71,-10718.11"/>
<polygon fill="black" stroke="black" points="12364.29,-10721.57 12373.94,-10717.21 12363.67,-10714.6 12364.29,-10721.57"/>
</g>
<!-- layer9_expert15_gate -->
<g id="node727" class="node">
<title>layer9_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13182,-10718 12787,-10718 12787,-10650 13182,-10650 13182,-10718"/>
<text text-anchor="middle" x="12984.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12984.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12984.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12984.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert15_gate -->
<g id="edge1034" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7335.27,-10821.24C8404.13,-10821.02 11690.73,-10812.53 12776.64,-10718.12"/>
<polygon fill="black" stroke="black" points="12777.29,-10721.57 12786.94,-10717.21 12776.68,-10714.6 12777.29,-10721.57"/>
</g>
<!-- layer9_expert15_up -->
<g id="node728" class="node">
<title>layer9_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13595,-10718 13200,-10718 13200,-10650 13595,-10650 13595,-10718"/>
<text text-anchor="middle" x="13397.5" y="-10702.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13397.5" y="-10687.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13397.5" y="-10672.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13397.5" y="-10657.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_token_distribution&#45;&gt;layer9_expert15_up -->
<g id="edge1035" class="edge">
<title>layer9_token_distribution&#45;&gt;layer9_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7336.15,-10821.72C8456.21,-10823.1 12019.63,-10819.26 13189.69,-10718.11"/>
<polygon fill="black" stroke="black" points="13190.29,-10721.57 13199.94,-10717.22 13189.68,-10714.6 13190.29,-10721.57"/>
</g>
<!-- layer9_expert0_act -->
<g id="node669" class="node">
<title>layer9_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1205,-10614 810,-10614 810,-10546 1205,-10546 1205,-10614"/>
<text text-anchor="middle" x="1007.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1007.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1007.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1007.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer9_expert0_gate&#45;&gt;layer9_expert0_act -->
<g id="edge946" class="edge">
<title>layer9_expert0_gate&#45;&gt;layer9_expert0_act</title>
<path fill="none" stroke="black" d="M728.3,-10649.95C771.56,-10639.27 819.7,-10627.38 863.66,-10616.53"/>
<polygon fill="black" stroke="black" points="864.69,-10619.88 873.56,-10614.08 863.01,-10613.08 864.69,-10619.88"/>
</g>
<!-- layer9_expert0_up&#45;&gt;layer9_expert0_act -->
<g id="edge947" class="edge">
<title>layer9_expert0_up&#45;&gt;layer9_expert0_act</title>
<path fill="none" stroke="black" d="M1007.5,-10649.88C1007.5,-10641.78 1007.5,-10632.98 1007.5,-10624.47"/>
<polygon fill="black" stroke="black" points="1011,-10624.3 1007.5,-10614.3 1004,-10624.3 1011,-10624.3"/>
</g>
<!-- layer9_expert0_down -->
<g id="node670" class="node">
<title>layer9_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1624,-10510 1241,-10510 1241,-10442 1624,-10442 1624,-10510"/>
<text text-anchor="middle" x="1432.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1432.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1432.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1432.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer9_expert0_act&#45;&gt;layer9_expert0_down -->
<g id="edge948" class="edge">
<title>layer9_expert0_act&#45;&gt;layer9_expert0_down</title>
<path fill="none" stroke="black" d="M1145.19,-10545.95C1189.8,-10535.25 1239.45,-10523.33 1284.76,-10512.46"/>
<polygon fill="black" stroke="black" points="1285.76,-10515.82 1294.66,-10510.08 1284.12,-10509.01 1285.76,-10515.82"/>
</g>
<!-- layer9_token_aggregation -->
<g id="node731" class="node">
<title>layer9_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7468.24,-10406 6711.44,-10406 6516.76,-10270 7273.56,-10270 7468.24,-10406"/>
<text text-anchor="middle" x="6992.5" y="-10356.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6992.5" y="-10341.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6992.5" y="-10326.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-10311.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_expert0_down&#45;&gt;layer9_token_aggregation -->
<g id="edge949" class="edge">
<title>layer9_expert0_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M1624.14,-10464.28C1760.12,-10457.02 1946.96,-10447.73 2111.5,-10442 3787.8,-10383.59 5789.18,-10353.94 6611.35,-10343.48"/>
<polygon fill="black" stroke="black" points="6611.61,-10346.98 6621.57,-10343.35 6611.52,-10339.98 6611.61,-10346.98"/>
</g>
<!-- layer9_expert1_act -->
<g id="node673" class="node">
<title>layer9_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2031,-10614 1636,-10614 1636,-10546 2031,-10546 2031,-10614"/>
<text text-anchor="middle" x="1833.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1833.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1833.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1833.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer9_expert1_gate&#45;&gt;layer9_expert1_act -->
<g id="edge952" class="edge">
<title>layer9_expert1_gate&#45;&gt;layer9_expert1_act</title>
<path fill="none" stroke="black" d="M1554.3,-10649.95C1597.56,-10639.27 1645.7,-10627.38 1689.66,-10616.53"/>
<polygon fill="black" stroke="black" points="1690.69,-10619.88 1699.56,-10614.08 1689.01,-10613.08 1690.69,-10619.88"/>
</g>
<!-- layer9_expert1_up&#45;&gt;layer9_expert1_act -->
<g id="edge953" class="edge">
<title>layer9_expert1_up&#45;&gt;layer9_expert1_act</title>
<path fill="none" stroke="black" d="M1833.5,-10649.88C1833.5,-10641.78 1833.5,-10632.98 1833.5,-10624.47"/>
<polygon fill="black" stroke="black" points="1837,-10624.3 1833.5,-10614.3 1830,-10624.3 1837,-10624.3"/>
</g>
<!-- layer9_expert1_down -->
<g id="node674" class="node">
<title>layer9_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2504,-10510 2121,-10510 2121,-10442 2504,-10442 2504,-10510"/>
<text text-anchor="middle" x="2312.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2312.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2312.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2312.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer9_expert1_act&#45;&gt;layer9_expert1_down -->
<g id="edge954" class="edge">
<title>layer9_expert1_act&#45;&gt;layer9_expert1_down</title>
<path fill="none" stroke="black" d="M1988.69,-10545.95C2039.39,-10535.16 2095.87,-10523.13 2147.28,-10512.18"/>
<polygon fill="black" stroke="black" points="2148.1,-10515.59 2157.15,-10510.08 2146.64,-10508.74 2148.1,-10515.59"/>
</g>
<!-- layer9_expert1_down&#45;&gt;layer9_token_aggregation -->
<g id="edge955" class="edge">
<title>layer9_expert1_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M2504.15,-10457.42C2573.51,-10451.64 2652.48,-10445.75 2724.5,-10442 4155.82,-10367.47 5860.01,-10346.76 6608.17,-10341.09"/>
<polygon fill="black" stroke="black" points="6608.32,-10344.59 6618.29,-10341.02 6608.27,-10337.59 6608.32,-10344.59"/>
</g>
<!-- layer9_expert2_act -->
<g id="node677" class="node">
<title>layer9_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2857,-10614 2462,-10614 2462,-10546 2857,-10546 2857,-10614"/>
<text text-anchor="middle" x="2659.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2659.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2659.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2659.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer9_expert2_gate&#45;&gt;layer9_expert2_act -->
<g id="edge958" class="edge">
<title>layer9_expert2_gate&#45;&gt;layer9_expert2_act</title>
<path fill="none" stroke="black" d="M2380.3,-10649.95C2423.56,-10639.27 2471.7,-10627.38 2515.66,-10616.53"/>
<polygon fill="black" stroke="black" points="2516.69,-10619.88 2525.56,-10614.08 2515.01,-10613.08 2516.69,-10619.88"/>
</g>
<!-- layer9_expert2_up&#45;&gt;layer9_expert2_act -->
<g id="edge959" class="edge">
<title>layer9_expert2_up&#45;&gt;layer9_expert2_act</title>
<path fill="none" stroke="black" d="M2659.5,-10649.88C2659.5,-10641.78 2659.5,-10632.98 2659.5,-10624.47"/>
<polygon fill="black" stroke="black" points="2663,-10624.3 2659.5,-10614.3 2656,-10624.3 2663,-10624.3"/>
</g>
<!-- layer9_expert2_down -->
<g id="node678" class="node">
<title>layer9_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3117,-10510 2734,-10510 2734,-10442 3117,-10442 3117,-10510"/>
<text text-anchor="middle" x="2925.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2925.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2925.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2925.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer9_expert2_act&#45;&gt;layer9_expert2_down -->
<g id="edge960" class="edge">
<title>layer9_expert2_act&#45;&gt;layer9_expert2_down</title>
<path fill="none" stroke="black" d="M2745.86,-10545.88C2772.6,-10535.63 2802.21,-10524.28 2829.55,-10513.79"/>
<polygon fill="black" stroke="black" points="2831.03,-10516.97 2839.12,-10510.12 2828.53,-10510.44 2831.03,-10516.97"/>
</g>
<!-- layer9_expert2_down&#45;&gt;layer9_token_aggregation -->
<g id="edge961" class="edge">
<title>layer9_expert2_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M3117.07,-10459.71C3202.01,-10453.4 3303.19,-10446.52 3394.5,-10442 4567.31,-10383.98 5956.91,-10355.64 6613.17,-10344.67"/>
<polygon fill="black" stroke="black" points="6613.32,-10348.17 6623.26,-10344.5 6613.2,-10341.17 6613.32,-10348.17"/>
</g>
<!-- layer9_expert3_act -->
<g id="node681" class="node">
<title>layer9_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3683,-10614 3288,-10614 3288,-10546 3683,-10546 3683,-10614"/>
<text text-anchor="middle" x="3485.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3485.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3485.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3485.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer9_expert3_gate&#45;&gt;layer9_expert3_act -->
<g id="edge964" class="edge">
<title>layer9_expert3_gate&#45;&gt;layer9_expert3_act</title>
<path fill="none" stroke="black" d="M3206.3,-10649.95C3249.56,-10639.27 3297.7,-10627.38 3341.66,-10616.53"/>
<polygon fill="black" stroke="black" points="3342.69,-10619.88 3351.56,-10614.08 3341.01,-10613.08 3342.69,-10619.88"/>
</g>
<!-- layer9_expert3_up&#45;&gt;layer9_expert3_act -->
<g id="edge965" class="edge">
<title>layer9_expert3_up&#45;&gt;layer9_expert3_act</title>
<path fill="none" stroke="black" d="M3485.5,-10649.88C3485.5,-10641.78 3485.5,-10632.98 3485.5,-10624.47"/>
<polygon fill="black" stroke="black" points="3489,-10624.3 3485.5,-10614.3 3482,-10624.3 3489,-10624.3"/>
</g>
<!-- layer9_expert3_down -->
<g id="node682" class="node">
<title>layer9_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3787,-10510 3404,-10510 3404,-10442 3787,-10442 3787,-10510"/>
<text text-anchor="middle" x="3595.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3595.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3595.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3595.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer9_expert3_act&#45;&gt;layer9_expert3_down -->
<g id="edge966" class="edge">
<title>layer9_expert3_act&#45;&gt;layer9_expert3_down</title>
<path fill="none" stroke="black" d="M3521.21,-10545.88C3531.11,-10536.71 3541.96,-10526.65 3552.23,-10517.12"/>
<polygon fill="black" stroke="black" points="3554.64,-10519.67 3559.59,-10510.3 3549.88,-10514.53 3554.64,-10519.67"/>
</g>
<!-- layer9_expert3_down&#45;&gt;layer9_token_aggregation -->
<g id="edge967" class="edge">
<title>layer9_expert3_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M3787.26,-10467.32C4333.84,-10445.44 5906.51,-10382.48 6625.68,-10353.69"/>
<polygon fill="black" stroke="black" points="6625.83,-10357.18 6635.68,-10353.29 6625.55,-10350.19 6625.83,-10357.18"/>
</g>
<!-- layer9_expert4_act -->
<g id="node685" class="node">
<title>layer9_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4509,-10614 4114,-10614 4114,-10546 4509,-10546 4509,-10614"/>
<text text-anchor="middle" x="4311.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4311.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4311.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4311.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer9_expert4_gate&#45;&gt;layer9_expert4_act -->
<g id="edge970" class="edge">
<title>layer9_expert4_gate&#45;&gt;layer9_expert4_act</title>
<path fill="none" stroke="black" d="M4032.3,-10649.95C4075.56,-10639.27 4123.7,-10627.38 4167.66,-10616.53"/>
<polygon fill="black" stroke="black" points="4168.69,-10619.88 4177.56,-10614.08 4167.01,-10613.08 4168.69,-10619.88"/>
</g>
<!-- layer9_expert4_up&#45;&gt;layer9_expert4_act -->
<g id="edge971" class="edge">
<title>layer9_expert4_up&#45;&gt;layer9_expert4_act</title>
<path fill="none" stroke="black" d="M4311.5,-10649.88C4311.5,-10641.78 4311.5,-10632.98 4311.5,-10624.47"/>
<polygon fill="black" stroke="black" points="4315,-10624.3 4311.5,-10614.3 4308,-10624.3 4315,-10624.3"/>
</g>
<!-- layer9_expert4_down -->
<g id="node686" class="node">
<title>layer9_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="5038,-10510 4655,-10510 4655,-10442 5038,-10442 5038,-10510"/>
<text text-anchor="middle" x="4846.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4846.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4846.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4846.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer9_expert4_act&#45;&gt;layer9_expert4_down -->
<g id="edge972" class="edge">
<title>layer9_expert4_act&#45;&gt;layer9_expert4_down</title>
<path fill="none" stroke="black" d="M4484.83,-10545.95C4541.81,-10535.09 4605.33,-10522.98 4663.03,-10511.98"/>
<polygon fill="black" stroke="black" points="4663.82,-10515.39 4672.99,-10510.08 4662.51,-10508.52 4663.82,-10515.39"/>
</g>
<!-- layer9_expert4_down&#45;&gt;layer9_token_aggregation -->
<g id="edge973" class="edge">
<title>layer9_expert4_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M5038.36,-10462.84C5397.96,-10440.05 6178.31,-10390.6 6636.65,-10361.55"/>
<polygon fill="black" stroke="black" points="6636.99,-10365.04 6646.75,-10360.91 6636.54,-10358.05 6636.99,-10365.04"/>
</g>
<!-- layer9_expert5_act -->
<g id="node689" class="node">
<title>layer9_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5335,-10614 4940,-10614 4940,-10546 5335,-10546 5335,-10614"/>
<text text-anchor="middle" x="5137.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5137.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5137.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5137.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer9_expert5_gate&#45;&gt;layer9_expert5_act -->
<g id="edge976" class="edge">
<title>layer9_expert5_gate&#45;&gt;layer9_expert5_act</title>
<path fill="none" stroke="black" d="M4858.3,-10649.95C4901.56,-10639.27 4949.7,-10627.38 4993.66,-10616.53"/>
<polygon fill="black" stroke="black" points="4994.69,-10619.88 5003.56,-10614.08 4993.01,-10613.08 4994.69,-10619.88"/>
</g>
<!-- layer9_expert5_up&#45;&gt;layer9_expert5_act -->
<g id="edge977" class="edge">
<title>layer9_expert5_up&#45;&gt;layer9_expert5_act</title>
<path fill="none" stroke="black" d="M5137.5,-10649.88C5137.5,-10641.78 5137.5,-10632.98 5137.5,-10624.47"/>
<polygon fill="black" stroke="black" points="5141,-10624.3 5137.5,-10614.3 5134,-10624.3 5141,-10624.3"/>
</g>
<!-- layer9_expert5_down -->
<g id="node690" class="node">
<title>layer9_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5864,-10510 5481,-10510 5481,-10442 5864,-10442 5864,-10510"/>
<text text-anchor="middle" x="5672.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5672.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5672.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5672.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer9_expert5_act&#45;&gt;layer9_expert5_down -->
<g id="edge978" class="edge">
<title>layer9_expert5_act&#45;&gt;layer9_expert5_down</title>
<path fill="none" stroke="black" d="M5310.83,-10545.95C5367.81,-10535.09 5431.33,-10522.98 5489.03,-10511.98"/>
<polygon fill="black" stroke="black" points="5489.82,-10515.39 5498.99,-10510.08 5488.51,-10508.52 5489.82,-10515.39"/>
</g>
<!-- layer9_expert5_down&#45;&gt;layer9_token_aggregation -->
<g id="edge979" class="edge">
<title>layer9_expert5_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M5864.09,-10455.26C6070.49,-10434 6403.01,-10399.74 6653.74,-10373.9"/>
<polygon fill="black" stroke="black" points="6654.15,-10377.38 6663.74,-10372.87 6653.43,-10370.42 6654.15,-10377.38"/>
</g>
<!-- layer9_expert6_act -->
<g id="node693" class="node">
<title>layer9_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6161,-10614 5766,-10614 5766,-10546 6161,-10546 6161,-10614"/>
<text text-anchor="middle" x="5963.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5963.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5963.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5963.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer9_expert6_gate&#45;&gt;layer9_expert6_act -->
<g id="edge982" class="edge">
<title>layer9_expert6_gate&#45;&gt;layer9_expert6_act</title>
<path fill="none" stroke="black" d="M5684.3,-10649.95C5727.56,-10639.27 5775.7,-10627.38 5819.66,-10616.53"/>
<polygon fill="black" stroke="black" points="5820.69,-10619.88 5829.56,-10614.08 5819.01,-10613.08 5820.69,-10619.88"/>
</g>
<!-- layer9_expert6_up&#45;&gt;layer9_expert6_act -->
<g id="edge983" class="edge">
<title>layer9_expert6_up&#45;&gt;layer9_expert6_act</title>
<path fill="none" stroke="black" d="M5963.5,-10649.88C5963.5,-10641.78 5963.5,-10632.98 5963.5,-10624.47"/>
<polygon fill="black" stroke="black" points="5967,-10624.3 5963.5,-10614.3 5960,-10624.3 5967,-10624.3"/>
</g>
<!-- layer9_expert6_down -->
<g id="node694" class="node">
<title>layer9_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6477,-10510 6094,-10510 6094,-10442 6477,-10442 6477,-10510"/>
<text text-anchor="middle" x="6285.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6285.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6285.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6285.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer9_expert6_act&#45;&gt;layer9_expert6_down -->
<g id="edge984" class="edge">
<title>layer9_expert6_act&#45;&gt;layer9_expert6_down</title>
<path fill="none" stroke="black" d="M6068.04,-10545.88C6101.05,-10535.43 6137.69,-10523.82 6171.34,-10513.16"/>
<polygon fill="black" stroke="black" points="6172.73,-10516.39 6181.21,-10510.04 6170.62,-10509.72 6172.73,-10516.39"/>
</g>
<!-- layer9_expert6_down&#45;&gt;layer9_token_aggregation -->
<g id="edge985" class="edge">
<title>layer9_expert6_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M6457.1,-10441.99C6526.18,-10428.7 6607.99,-10412.96 6686.61,-10397.84"/>
<polygon fill="black" stroke="black" points="6687.52,-10401.23 6696.68,-10395.9 6686.2,-10394.36 6687.52,-10401.23"/>
</g>
<!-- layer9_expert7_act -->
<g id="node697" class="node">
<title>layer9_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6987,-10614 6592,-10614 6592,-10546 6987,-10546 6987,-10614"/>
<text text-anchor="middle" x="6789.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6789.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6789.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6789.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer9_expert7_gate&#45;&gt;layer9_expert7_act -->
<g id="edge988" class="edge">
<title>layer9_expert7_gate&#45;&gt;layer9_expert7_act</title>
<path fill="none" stroke="black" d="M6510.3,-10649.95C6553.56,-10639.27 6601.7,-10627.38 6645.66,-10616.53"/>
<polygon fill="black" stroke="black" points="6646.69,-10619.88 6655.56,-10614.08 6645.01,-10613.08 6646.69,-10619.88"/>
</g>
<!-- layer9_expert7_up&#45;&gt;layer9_expert7_act -->
<g id="edge989" class="edge">
<title>layer9_expert7_up&#45;&gt;layer9_expert7_act</title>
<path fill="none" stroke="black" d="M6789.5,-10649.88C6789.5,-10641.78 6789.5,-10632.98 6789.5,-10624.47"/>
<polygon fill="black" stroke="black" points="6793,-10624.3 6789.5,-10614.3 6786,-10624.3 6793,-10624.3"/>
</g>
<!-- layer9_expert7_down -->
<g id="node698" class="node">
<title>layer9_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6984,-10510 6601,-10510 6601,-10442 6984,-10442 6984,-10510"/>
<text text-anchor="middle" x="6792.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6792.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6792.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6792.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer9_expert7_act&#45;&gt;layer9_expert7_down -->
<g id="edge990" class="edge">
<title>layer9_expert7_act&#45;&gt;layer9_expert7_down</title>
<path fill="none" stroke="black" d="M6790.47,-10545.88C6790.71,-10537.78 6790.97,-10528.98 6791.22,-10520.47"/>
<polygon fill="black" stroke="black" points="6794.73,-10520.4 6791.52,-10510.3 6787.73,-10520.19 6794.73,-10520.4"/>
</g>
<!-- layer9_expert7_down&#45;&gt;layer9_token_aggregation -->
<g id="edge991" class="edge">
<title>layer9_expert7_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M6841.17,-10441.9C6854.63,-10432.75 6869.8,-10422.44 6885.2,-10411.97"/>
<polygon fill="black" stroke="black" points="6887.47,-10414.66 6893.77,-10406.14 6883.53,-10408.87 6887.47,-10414.66"/>
</g>
<!-- layer9_expert8_act -->
<g id="node701" class="node">
<title>layer9_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7400,-10614 7005,-10614 7005,-10546 7400,-10546 7400,-10614"/>
<text text-anchor="middle" x="7202.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7202.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7202.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7202.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_expert8_gate&#45;&gt;layer9_expert8_act -->
<g id="edge994" class="edge">
<title>layer9_expert8_gate&#45;&gt;layer9_expert8_act</title>
<path fill="none" stroke="black" d="M7202.5,-10649.88C7202.5,-10641.78 7202.5,-10632.98 7202.5,-10624.47"/>
<polygon fill="black" stroke="black" points="7206,-10624.3 7202.5,-10614.3 7199,-10624.3 7206,-10624.3"/>
</g>
<!-- layer9_expert8_up&#45;&gt;layer9_expert8_act -->
<g id="edge995" class="edge">
<title>layer9_expert8_up&#45;&gt;layer9_expert8_act</title>
<path fill="none" stroke="black" d="M7481.7,-10649.95C7438.44,-10639.27 7390.3,-10627.38 7346.34,-10616.53"/>
<polygon fill="black" stroke="black" points="7346.99,-10613.08 7336.44,-10614.08 7345.31,-10619.88 7346.99,-10613.08"/>
</g>
<!-- layer9_expert8_down -->
<g id="node702" class="node">
<title>layer9_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7391,-10510 7008,-10510 7008,-10442 7391,-10442 7391,-10510"/>
<text text-anchor="middle" x="7199.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7199.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7199.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7199.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_expert8_act&#45;&gt;layer9_expert8_down -->
<g id="edge996" class="edge">
<title>layer9_expert8_act&#45;&gt;layer9_expert8_down</title>
<path fill="none" stroke="black" d="M7201.53,-10545.88C7201.29,-10537.78 7201.03,-10528.98 7200.78,-10520.47"/>
<polygon fill="black" stroke="black" points="7204.27,-10520.19 7200.48,-10510.3 7197.27,-10520.4 7204.27,-10520.19"/>
</g>
<!-- layer9_expert8_down&#45;&gt;layer9_token_aggregation -->
<g id="edge997" class="edge">
<title>layer9_expert8_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M7149.13,-10441.9C7135.06,-10432.66 7119.2,-10422.25 7103.12,-10411.67"/>
<polygon fill="black" stroke="black" points="7104.97,-10408.7 7094.69,-10406.14 7101.12,-10414.55 7104.97,-10408.7"/>
</g>
<!-- layer9_expert9_act -->
<g id="node705" class="node">
<title>layer9_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8226,-10614 7831,-10614 7831,-10546 8226,-10546 8226,-10614"/>
<text text-anchor="middle" x="8028.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8028.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8028.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8028.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_expert9_gate&#45;&gt;layer9_expert9_act -->
<g id="edge1000" class="edge">
<title>layer9_expert9_gate&#45;&gt;layer9_expert9_act</title>
<path fill="none" stroke="black" d="M8028.5,-10649.88C8028.5,-10641.78 8028.5,-10632.98 8028.5,-10624.47"/>
<polygon fill="black" stroke="black" points="8032,-10624.3 8028.5,-10614.3 8025,-10624.3 8032,-10624.3"/>
</g>
<!-- layer9_expert9_up&#45;&gt;layer9_expert9_act -->
<g id="edge1001" class="edge">
<title>layer9_expert9_up&#45;&gt;layer9_expert9_act</title>
<path fill="none" stroke="black" d="M8307.7,-10649.95C8264.44,-10639.27 8216.3,-10627.38 8172.34,-10616.53"/>
<polygon fill="black" stroke="black" points="8172.99,-10613.08 8162.44,-10614.08 8171.31,-10619.88 8172.99,-10613.08"/>
</g>
<!-- layer9_expert9_down -->
<g id="node706" class="node">
<title>layer9_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8007,-10510 7624,-10510 7624,-10442 8007,-10442 8007,-10510"/>
<text text-anchor="middle" x="7815.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7815.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7815.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7815.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_expert9_act&#45;&gt;layer9_expert9_down -->
<g id="edge1002" class="edge">
<title>layer9_expert9_act&#45;&gt;layer9_expert9_down</title>
<path fill="none" stroke="black" d="M7959.35,-10545.88C7938.41,-10535.86 7915.26,-10524.77 7893.77,-10514.48"/>
<polygon fill="black" stroke="black" points="7895.2,-10511.29 7884.67,-10510.12 7892.18,-10517.6 7895.2,-10511.29"/>
</g>
<!-- layer9_expert9_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1003" class="edge">
<title>layer9_expert9_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M7623.84,-10443.33C7558.96,-10432.61 7483.75,-10420.18 7408.34,-10407.72"/>
<polygon fill="black" stroke="black" points="7408.62,-10404.22 7398.19,-10406.04 7407.48,-10411.12 7408.62,-10404.22"/>
</g>
<!-- layer9_expert10_act -->
<g id="node709" class="node">
<title>layer9_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9052,-10614 8657,-10614 8657,-10546 9052,-10546 9052,-10614"/>
<text text-anchor="middle" x="8854.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8854.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8854.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8854.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_expert10_gate&#45;&gt;layer9_expert10_act -->
<g id="edge1006" class="edge">
<title>layer9_expert10_gate&#45;&gt;layer9_expert10_act</title>
<path fill="none" stroke="black" d="M8854.5,-10649.88C8854.5,-10641.78 8854.5,-10632.98 8854.5,-10624.47"/>
<polygon fill="black" stroke="black" points="8858,-10624.3 8854.5,-10614.3 8851,-10624.3 8858,-10624.3"/>
</g>
<!-- layer9_expert10_up&#45;&gt;layer9_expert10_act -->
<g id="edge1007" class="edge">
<title>layer9_expert10_up&#45;&gt;layer9_expert10_act</title>
<path fill="none" stroke="black" d="M9133.7,-10649.95C9090.44,-10639.27 9042.3,-10627.38 8998.34,-10616.53"/>
<polygon fill="black" stroke="black" points="8998.99,-10613.08 8988.44,-10614.08 8997.31,-10619.88 8998.99,-10613.08"/>
</g>
<!-- layer9_expert10_down -->
<g id="node710" class="node">
<title>layer9_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8728,-10510 8345,-10510 8345,-10442 8728,-10442 8728,-10510"/>
<text text-anchor="middle" x="8536.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8536.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8536.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8536.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_expert10_act&#45;&gt;layer9_expert10_down -->
<g id="edge1008" class="edge">
<title>layer9_expert10_act&#45;&gt;layer9_expert10_down</title>
<path fill="none" stroke="black" d="M8751.25,-10545.88C8718.65,-10535.43 8682.47,-10523.82 8649.25,-10513.16"/>
<polygon fill="black" stroke="black" points="8650.09,-10509.76 8639.5,-10510.04 8647.95,-10516.42 8650.09,-10509.76"/>
</g>
<!-- layer9_expert10_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1009" class="edge">
<title>layer9_expert10_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M8344.85,-10458.12C8119.46,-10438.27 7737.98,-10404.66 7437.54,-10378.2"/>
<polygon fill="black" stroke="black" points="7437.61,-10374.69 7427.34,-10377.3 7436.99,-10381.67 7437.61,-10374.69"/>
</g>
<!-- layer9_expert11_act -->
<g id="node713" class="node">
<title>layer9_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9878,-10614 9483,-10614 9483,-10546 9878,-10546 9878,-10614"/>
<text text-anchor="middle" x="9680.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9680.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9680.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9680.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_expert11_gate&#45;&gt;layer9_expert11_act -->
<g id="edge1012" class="edge">
<title>layer9_expert11_gate&#45;&gt;layer9_expert11_act</title>
<path fill="none" stroke="black" d="M9680.5,-10649.88C9680.5,-10641.78 9680.5,-10632.98 9680.5,-10624.47"/>
<polygon fill="black" stroke="black" points="9684,-10624.3 9680.5,-10614.3 9677,-10624.3 9684,-10624.3"/>
</g>
<!-- layer9_expert11_up&#45;&gt;layer9_expert11_act -->
<g id="edge1013" class="edge">
<title>layer9_expert11_up&#45;&gt;layer9_expert11_act</title>
<path fill="none" stroke="black" d="M9959.7,-10649.95C9916.44,-10639.27 9868.3,-10627.38 9824.34,-10616.53"/>
<polygon fill="black" stroke="black" points="9824.99,-10613.08 9814.44,-10614.08 9823.31,-10619.88 9824.99,-10613.08"/>
</g>
<!-- layer9_expert11_down -->
<g id="node714" class="node">
<title>layer9_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9502,-10510 9119,-10510 9119,-10442 9502,-10442 9502,-10510"/>
<text text-anchor="middle" x="9310.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9310.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9310.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9310.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_expert11_act&#45;&gt;layer9_expert11_down -->
<g id="edge1014" class="edge">
<title>layer9_expert11_act&#45;&gt;layer9_expert11_down</title>
<path fill="none" stroke="black" d="M9560.63,-10545.95C9522.2,-10535.36 9479.47,-10523.58 9440.36,-10512.8"/>
<polygon fill="black" stroke="black" points="9441.07,-10509.36 9430.5,-10510.08 9439.21,-10516.11 9441.07,-10509.36"/>
</g>
<!-- layer9_expert11_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1015" class="edge">
<title>layer9_expert11_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M9118.84,-10463.75C8747.82,-10441.99 7923.55,-10393.63 7417.2,-10363.92"/>
<polygon fill="black" stroke="black" points="7417.35,-10360.42 7407.17,-10363.33 7416.94,-10367.41 7417.35,-10360.42"/>
</g>
<!-- layer9_expert12_act -->
<g id="node717" class="node">
<title>layer9_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10704,-10614 10309,-10614 10309,-10546 10704,-10546 10704,-10614"/>
<text text-anchor="middle" x="10506.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10506.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10506.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10506.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_expert12_gate&#45;&gt;layer9_expert12_act -->
<g id="edge1018" class="edge">
<title>layer9_expert12_gate&#45;&gt;layer9_expert12_act</title>
<path fill="none" stroke="black" d="M10506.5,-10649.88C10506.5,-10641.78 10506.5,-10632.98 10506.5,-10624.47"/>
<polygon fill="black" stroke="black" points="10510,-10624.3 10506.5,-10614.3 10503,-10624.3 10510,-10624.3"/>
</g>
<!-- layer9_expert12_up&#45;&gt;layer9_expert12_act -->
<g id="edge1019" class="edge">
<title>layer9_expert12_up&#45;&gt;layer9_expert12_act</title>
<path fill="none" stroke="black" d="M10785.7,-10649.95C10742.44,-10639.27 10694.3,-10627.38 10650.34,-10616.53"/>
<polygon fill="black" stroke="black" points="10650.99,-10613.08 10640.44,-10614.08 10649.31,-10619.88 10650.99,-10613.08"/>
</g>
<!-- layer9_expert12_down -->
<g id="node718" class="node">
<title>layer9_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10302,-10510 9919,-10510 9919,-10442 10302,-10442 10302,-10510"/>
<text text-anchor="middle" x="10110.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10110.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10110.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10110.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_expert12_act&#45;&gt;layer9_expert12_down -->
<g id="edge1020" class="edge">
<title>layer9_expert12_act&#45;&gt;layer9_expert12_down</title>
<path fill="none" stroke="black" d="M10378.2,-10545.95C10336.81,-10535.29 10290.76,-10523.43 10248.69,-10512.59"/>
<polygon fill="black" stroke="black" points="10249.49,-10509.19 10238.93,-10510.08 10247.74,-10515.96 10249.49,-10509.19"/>
</g>
<!-- layer9_expert12_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1021" class="edge">
<title>layer9_expert12_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M9918.67,-10463.74C9801.15,-10457.01 9647.65,-10448.53 9511.5,-10442 8768.75,-10406.36 7902.41,-10372.66 7403.65,-10354.02"/>
<polygon fill="black" stroke="black" points="7403.53,-10350.52 7393.41,-10353.64 7403.27,-10357.51 7403.53,-10350.52"/>
</g>
<!-- layer9_expert13_act -->
<g id="node721" class="node">
<title>layer9_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11530,-10614 11135,-10614 11135,-10546 11530,-10546 11530,-10614"/>
<text text-anchor="middle" x="11332.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11332.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11332.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11332.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_expert13_gate&#45;&gt;layer9_expert13_act -->
<g id="edge1024" class="edge">
<title>layer9_expert13_gate&#45;&gt;layer9_expert13_act</title>
<path fill="none" stroke="black" d="M11332.5,-10649.88C11332.5,-10641.78 11332.5,-10632.98 11332.5,-10624.47"/>
<polygon fill="black" stroke="black" points="11336,-10624.3 11332.5,-10614.3 11329,-10624.3 11336,-10624.3"/>
</g>
<!-- layer9_expert13_up&#45;&gt;layer9_expert13_act -->
<g id="edge1025" class="edge">
<title>layer9_expert13_up&#45;&gt;layer9_expert13_act</title>
<path fill="none" stroke="black" d="M11611.7,-10649.95C11568.44,-10639.27 11520.3,-10627.38 11476.34,-10616.53"/>
<polygon fill="black" stroke="black" points="11476.99,-10613.08 11466.44,-10614.08 11475.31,-10619.88 11476.99,-10613.08"/>
</g>
<!-- layer9_expert13_down -->
<g id="node722" class="node">
<title>layer9_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11115,-10510 10732,-10510 10732,-10442 11115,-10442 11115,-10510"/>
<text text-anchor="middle" x="10923.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10923.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10923.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10923.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_expert13_act&#45;&gt;layer9_expert13_down -->
<g id="edge1026" class="edge">
<title>layer9_expert13_act&#45;&gt;layer9_expert13_down</title>
<path fill="none" stroke="black" d="M11199.99,-10545.95C11157.15,-10535.27 11109.48,-10523.38 11065.95,-10512.53"/>
<polygon fill="black" stroke="black" points="11066.7,-10509.1 11056.15,-10510.08 11065,-10515.9 11066.7,-10509.1"/>
</g>
<!-- layer9_expert13_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1027" class="edge">
<title>layer9_expert13_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M10731.98,-10463.55C10611.35,-10456.61 10452.36,-10447.98 10311.5,-10442 9260.09,-10397.34 8020.53,-10364 7395.76,-10348.54"/>
<polygon fill="black" stroke="black" points="7395.78,-10345.04 7385.69,-10348.3 7395.6,-10352.04 7395.78,-10345.04"/>
</g>
<!-- layer9_expert14_act -->
<g id="node725" class="node">
<title>layer9_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12356,-10614 11961,-10614 11961,-10546 12356,-10546 12356,-10614"/>
<text text-anchor="middle" x="12158.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12158.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12158.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12158.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_expert14_gate&#45;&gt;layer9_expert14_act -->
<g id="edge1030" class="edge">
<title>layer9_expert14_gate&#45;&gt;layer9_expert14_act</title>
<path fill="none" stroke="black" d="M12158.5,-10649.88C12158.5,-10641.78 12158.5,-10632.98 12158.5,-10624.47"/>
<polygon fill="black" stroke="black" points="12162,-10624.3 12158.5,-10614.3 12155,-10624.3 12162,-10624.3"/>
</g>
<!-- layer9_expert14_up&#45;&gt;layer9_expert14_act -->
<g id="edge1031" class="edge">
<title>layer9_expert14_up&#45;&gt;layer9_expert14_act</title>
<path fill="none" stroke="black" d="M12437.7,-10649.95C12394.44,-10639.27 12346.3,-10627.38 12302.34,-10616.53"/>
<polygon fill="black" stroke="black" points="12302.99,-10613.08 12292.44,-10614.08 12301.31,-10619.88 12302.99,-10613.08"/>
</g>
<!-- layer9_expert14_down -->
<g id="node726" class="node">
<title>layer9_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11934,-10510 11551,-10510 11551,-10442 11934,-10442 11934,-10510"/>
<text text-anchor="middle" x="11742.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11742.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11742.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11742.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_expert14_act&#45;&gt;layer9_expert14_down -->
<g id="edge1032" class="edge">
<title>layer9_expert14_act&#45;&gt;layer9_expert14_down</title>
<path fill="none" stroke="black" d="M12023.72,-10545.95C11980.15,-10535.27 11931.66,-10523.38 11887.39,-10512.53"/>
<polygon fill="black" stroke="black" points="11887.96,-10509.06 11877.42,-10510.08 11886.3,-10515.86 11887.96,-10509.06"/>
</g>
<!-- layer9_expert14_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1033" class="edge">
<title>layer9_expert14_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M11550.83,-10463.36C11428.82,-10456.3 11267.43,-10447.6 11124.5,-10442 9754.85,-10388.37 8128.66,-10357.43 7391.32,-10345.17"/>
<polygon fill="black" stroke="black" points="7391.12,-10341.67 7381.07,-10345 7391.01,-10348.67 7391.12,-10341.67"/>
</g>
<!-- layer9_expert15_act -->
<g id="node729" class="node">
<title>layer9_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13182,-10614 12787,-10614 12787,-10546 13182,-10546 13182,-10614"/>
<text text-anchor="middle" x="12984.5" y="-10598.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12984.5" y="-10583.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12984.5" y="-10568.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12984.5" y="-10553.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_expert15_gate&#45;&gt;layer9_expert15_act -->
<g id="edge1036" class="edge">
<title>layer9_expert15_gate&#45;&gt;layer9_expert15_act</title>
<path fill="none" stroke="black" d="M12984.5,-10649.88C12984.5,-10641.78 12984.5,-10632.98 12984.5,-10624.47"/>
<polygon fill="black" stroke="black" points="12988,-10624.3 12984.5,-10614.3 12981,-10624.3 12988,-10624.3"/>
</g>
<!-- layer9_expert15_up&#45;&gt;layer9_expert15_act -->
<g id="edge1037" class="edge">
<title>layer9_expert15_up&#45;&gt;layer9_expert15_act</title>
<path fill="none" stroke="black" d="M13263.7,-10649.95C13220.44,-10639.27 13172.3,-10627.38 13128.34,-10616.53"/>
<polygon fill="black" stroke="black" points="13128.99,-10613.08 13118.44,-10614.08 13127.31,-10619.88 13128.99,-10613.08"/>
</g>
<!-- layer9_expert15_down -->
<g id="node730" class="node">
<title>layer9_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12757,-10510 12374,-10510 12374,-10442 12757,-10442 12757,-10510"/>
<text text-anchor="middle" x="12565.5" y="-10494.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12565.5" y="-10479.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12565.5" y="-10464.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12565.5" y="-10449.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_expert15_act&#45;&gt;layer9_expert15_down -->
<g id="edge1038" class="edge">
<title>layer9_expert15_act&#45;&gt;layer9_expert15_down</title>
<path fill="none" stroke="black" d="M12848.75,-10545.95C12804.77,-10535.25 12755.82,-10523.33 12711.15,-10512.46"/>
<polygon fill="black" stroke="black" points="12711.93,-10509.05 12701.39,-10510.08 12710.28,-10515.85 12711.93,-10509.05"/>
</g>
<!-- layer9_expert15_down&#45;&gt;layer9_token_aggregation -->
<g id="edge1039" class="edge">
<title>layer9_expert15_down&#45;&gt;layer9_token_aggregation</title>
<path fill="none" stroke="black" d="M12373.98,-10463.24C12251.02,-10456.09 12087.9,-10447.33 11943.5,-10442 10249.24,-10379.45 8227.33,-10352.15 7387.93,-10342.91"/>
<polygon fill="black" stroke="black" points="7387.84,-10339.4 7377.8,-10342.79 7387.76,-10346.4 7387.84,-10339.4"/>
</g>
<!-- layer9_res2 -->
<g id="node732" class="node">
<title>layer9_res2</title>
<polygon fill="none" stroke="black" points="7433.24,-10234 6732.12,-10234 6551.76,-10068 7252.88,-10068 7433.24,-10234"/>
<text text-anchor="middle" x="6992.5" y="-10177.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6992.5" y="-10162.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-10147.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-10132.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-10117.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_token_aggregation&#45;&gt;layer9_res2 -->
<g id="edge1040" class="edge">
<title>layer9_token_aggregation&#45;&gt;layer9_res2</title>
<path fill="none" stroke="black" d="M6992.5,-10269.95C6992.5,-10261.63 6992.5,-10253 6992.5,-10244.38"/>
<polygon fill="black" stroke="black" points="6996,-10244.28 6992.5,-10234.28 6989,-10244.28 6996,-10244.28"/>
</g>
<!-- layer10_mha_qkv -->
<g id="node733" class="node">
<title>layer10_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7228.5,-10032 6756.5,-10032 6756.5,-9964 7228.5,-9964 7228.5,-10032"/>
<text text-anchor="middle" x="6992.5" y="-10016.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6992.5" y="-10001.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9986.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6992.5" y="-9971.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_res2&#45;&gt;layer10_mha_qkv -->
<g id="edge1041" class="edge">
<title>layer9_res2&#45;&gt;layer10_mha_qkv</title>
<path fill="none" stroke="black" d="M6992.5,-10067.87C6992.5,-10059.12 6992.5,-10050.48 6992.5,-10042.45"/>
<polygon fill="black" stroke="black" points="6996,-10042.26 6992.5,-10032.26 6989,-10042.26 6996,-10042.26"/>
</g>
<!-- layer10_mha_attn -->
<g id="node734" class="node">
<title>layer10_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7222.5,-9928 6762.5,-9928 6762.5,-9860 7222.5,-9860 7222.5,-9928"/>
<text text-anchor="middle" x="6992.5" y="-9912.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6992.5" y="-9897.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6992.5" y="-9882.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9867.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_mha_qkv&#45;&gt;layer10_mha_attn -->
<g id="edge1042" class="edge">
<title>layer10_mha_qkv&#45;&gt;layer10_mha_attn</title>
<path fill="none" stroke="black" d="M6992.5,-9963.88C6992.5,-9955.78 6992.5,-9946.98 6992.5,-9938.47"/>
<polygon fill="black" stroke="black" points="6996,-9938.3 6992.5,-9928.3 6989,-9938.3 6996,-9938.3"/>
</g>
<!-- layer10_mha_out -->
<g id="node735" class="node">
<title>layer10_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7205,-9824 6780,-9824 6780,-9756 7205,-9756 7205,-9824"/>
<text text-anchor="middle" x="6992.5" y="-9808.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6992.5" y="-9793.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9778.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9763.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_mha_attn&#45;&gt;layer10_mha_out -->
<g id="edge1043" class="edge">
<title>layer10_mha_attn&#45;&gt;layer10_mha_out</title>
<path fill="none" stroke="black" d="M6992.5,-9859.88C6992.5,-9851.78 6992.5,-9842.98 6992.5,-9834.47"/>
<polygon fill="black" stroke="black" points="6996,-9834.3 6992.5,-9824.3 6989,-9834.3 6996,-9834.3"/>
</g>
<!-- layer10_res1 -->
<g id="node736" class="node">
<title>layer10_res1</title>
<polygon fill="none" stroke="black" points="7433.24,-9720 6732.12,-9720 6551.76,-9554 7252.88,-9554 7433.24,-9720"/>
<text text-anchor="middle" x="6992.5" y="-9663.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6992.5" y="-9648.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9633.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9618.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9603.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_mha_out&#45;&gt;layer10_res1 -->
<g id="edge1044" class="edge">
<title>layer10_mha_out&#45;&gt;layer10_res1</title>
<path fill="none" stroke="black" d="M6992.5,-9755.86C6992.5,-9748.1 6992.5,-9739.46 6992.5,-9730.48"/>
<polygon fill="black" stroke="black" points="6996,-9730.23 6992.5,-9720.23 6989,-9730.23 6996,-9730.23"/>
</g>
<!-- layer10_ln1 -->
<g id="node737" class="node">
<title>layer10_ln1</title>
<polygon fill="yellow" stroke="black" points="7205,-9518 6780,-9518 6780,-9450 7205,-9450 7205,-9518"/>
<text text-anchor="middle" x="6992.5" y="-9502.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6992.5" y="-9487.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9472.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9457.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_res1&#45;&gt;layer10_ln1 -->
<g id="edge1045" class="edge">
<title>layer10_res1&#45;&gt;layer10_ln1</title>
<path fill="none" stroke="black" d="M6992.5,-9553.87C6992.5,-9545.12 6992.5,-9536.48 6992.5,-9528.45"/>
<polygon fill="black" stroke="black" points="6996,-9528.26 6992.5,-9518.26 6989,-9528.26 6996,-9528.26"/>
</g>
<!-- layer10_expert_routing -->
<g id="node738" class="node">
<title>layer10_expert_routing</title>
<polygon fill="orange" stroke="black" points="6992.5,-9414 6576.5,-9331 6992.5,-9248 7408.5,-9331 6992.5,-9414"/>
<text text-anchor="middle" x="6992.5" y="-9357.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6992.5" y="-9342.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6992.5" y="-9327.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9312.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6992.5" y="-9297.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_ln1&#45;&gt;layer10_expert_routing -->
<g id="edge1046" class="edge">
<title>layer10_ln1&#45;&gt;layer10_expert_routing</title>
<path fill="none" stroke="black" d="M6992.5,-9449.86C6992.5,-9442.1 6992.5,-9433.46 6992.5,-9424.48"/>
<polygon fill="black" stroke="black" points="6996,-9424.23 6992.5,-9414.23 6989,-9424.23 6996,-9424.23"/>
</g>
<!-- layer10_token_distribution -->
<g id="node739" class="node">
<title>layer10_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7420.86,-9212 6739.44,-9212 6564.14,-9076 7245.56,-9076 7420.86,-9212"/>
<text text-anchor="middle" x="6992.5" y="-9162.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6992.5" y="-9147.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6992.5" y="-9132.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6992.5" y="-9117.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer10_expert_routing&#45;&gt;layer10_token_distribution -->
<g id="edge1047" class="edge">
<title>layer10_expert_routing&#45;&gt;layer10_token_distribution</title>
<path fill="none" stroke="black" d="M6992.5,-9247.78C6992.5,-9239.34 6992.5,-9230.79 6992.5,-9222.4"/>
<polygon fill="black" stroke="black" points="6996,-9222.28 6992.5,-9212.28 6989,-9222.28 6996,-9222.28"/>
</g>
<!-- layer10_expert0_gate -->
<g id="node740" class="node">
<title>layer10_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="789,-9040 394,-9040 394,-8972 789,-8972 789,-9040"/>
<text text-anchor="middle" x="591.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="591.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="591.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="591.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert0_gate -->
<g id="edge1048" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6651.42,-9143.72C5530.99,-9145.09 1969.01,-9141.23 799.31,-9040.11"/>
<polygon fill="black" stroke="black" points="799.32,-9036.6 789.06,-9039.22 798.71,-9043.57 799.32,-9036.6"/>
</g>
<!-- layer10_expert0_up -->
<g id="node741" class="node">
<title>layer10_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1202,-9040 807,-9040 807,-8972 1202,-8972 1202,-9040"/>
<text text-anchor="middle" x="1004.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1004.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1004.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1004.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert0_up -->
<g id="edge1049" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6650.42,-9143.24C5579.28,-9143 2297.27,-9134.44 1212.35,-9040.12"/>
<polygon fill="black" stroke="black" points="1212.32,-9036.6 1202.06,-9039.21 1211.71,-9043.57 1212.32,-9036.6"/>
</g>
<!-- layer10_expert1_gate -->
<g id="node744" class="node">
<title>layer10_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1615,-9040 1220,-9040 1220,-8972 1615,-8972 1615,-9040"/>
<text text-anchor="middle" x="1417.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1417.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1417.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1417.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert1_gate -->
<g id="edge1054" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6649.86,-9142.69C5630.38,-9140.77 2625.69,-9127.69 1625.28,-9040.11"/>
<polygon fill="black" stroke="black" points="1625.33,-9036.6 1615.06,-9039.21 1624.71,-9043.57 1625.33,-9036.6"/>
</g>
<!-- layer10_expert1_up -->
<g id="node745" class="node">
<title>layer10_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2028,-9040 1633,-9040 1633,-8972 2028,-8972 2028,-9040"/>
<text text-anchor="middle" x="1830.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1830.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1830.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1830.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert1_up -->
<g id="edge1055" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6648.92,-9142.04C5682.86,-9138.35 2954.03,-9120.95 2038.08,-9040.09"/>
<polygon fill="black" stroke="black" points="2038.33,-9036.6 2028.06,-9039.2 2037.71,-9043.58 2038.33,-9036.6"/>
</g>
<!-- layer10_expert2_gate -->
<g id="node748" class="node">
<title>layer10_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2441,-9040 2046,-9040 2046,-8972 2441,-8972 2441,-9040"/>
<text text-anchor="middle" x="2243.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2243.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2243.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2243.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert2_gate -->
<g id="edge1060" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6647.93,-9141.27C5737.78,-9135.72 3283.04,-9114.22 2451.07,-9040.1"/>
<polygon fill="black" stroke="black" points="2451.33,-9036.6 2441.06,-9039.19 2450.7,-9043.58 2451.33,-9036.6"/>
</g>
<!-- layer10_expert2_up -->
<g id="node749" class="node">
<title>layer10_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2854,-9040 2459,-9040 2459,-8972 2854,-8972 2854,-9040"/>
<text text-anchor="middle" x="2656.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2656.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2656.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2656.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert2_up -->
<g id="edge1061" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6646.99,-9140.34C5795.65,-9132.84 3612.62,-9107.52 2864.16,-9040.1"/>
<polygon fill="black" stroke="black" points="2864.34,-9036.61 2854.06,-9039.18 2863.7,-9043.58 2864.34,-9036.61"/>
</g>
<!-- layer10_expert3_gate -->
<g id="node752" class="node">
<title>layer10_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3267,-9040 2872,-9040 2872,-8972 3267,-8972 3267,-9040"/>
<text text-anchor="middle" x="3069.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3069.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3069.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3069.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert3_gate -->
<g id="edge1066" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6645.41,-9139.2C5855.73,-9129.62 3942.42,-9100.84 3277.24,-9040.11"/>
<polygon fill="black" stroke="black" points="3277.34,-9036.61 3267.06,-9039.17 3276.7,-9043.58 3277.34,-9036.61"/>
</g>
<!-- layer10_expert3_up -->
<g id="node753" class="node">
<title>layer10_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3680,-9040 3285,-9040 3285,-8972 3680,-8972 3680,-9040"/>
<text text-anchor="middle" x="3482.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3482.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3482.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3482.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert3_up -->
<g id="edge1067" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6643.52,-9137.77C5919.21,-9125.98 4272.46,-9094.17 3690.25,-9040.12"/>
<polygon fill="black" stroke="black" points="3690.35,-9036.61 3680.06,-9039.16 3689.69,-9043.58 3690.35,-9036.61"/>
</g>
<!-- layer10_expert4_gate -->
<g id="node756" class="node">
<title>layer10_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4093,-9040 3698,-9040 3698,-8972 4093,-8972 4093,-9040"/>
<text text-anchor="middle" x="3895.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3895.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3895.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3895.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert4_gate -->
<g id="edge1072" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6641.06,-9135.9C5986.59,-9121.8 4602.94,-9087.52 4103.26,-9040.12"/>
<polygon fill="black" stroke="black" points="4103.35,-9036.62 4093.06,-9039.14 4102.68,-9043.58 4103.35,-9036.62"/>
</g>
<!-- layer10_expert4_up -->
<g id="node757" class="node">
<title>layer10_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4506,-9040 4111,-9040 4111,-8972 4506,-8972 4506,-9040"/>
<text text-anchor="middle" x="4308.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4308.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4308.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4308.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert4_up -->
<g id="edge1073" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6648.37,-9141.42C6171.11,-9136.35 5281.47,-9116.49 4516.19,-9040.13"/>
<polygon fill="black" stroke="black" points="4516.36,-9036.63 4506.07,-9039.12 4515.67,-9043.6 4516.36,-9036.63"/>
</g>
<!-- layer10_expert5_gate -->
<g id="node760" class="node">
<title>layer10_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4919,-9040 4524,-9040 4524,-8972 4919,-8972 4919,-9040"/>
<text text-anchor="middle" x="4721.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4721.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4721.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4721.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert5_gate -->
<g id="edge1078" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6642.68,-9137.16C6233.56,-9127.67 5536.04,-9103.18 4929.34,-9040.16"/>
<polygon fill="black" stroke="black" points="4929.38,-9036.64 4919.07,-9039.09 4928.65,-9043.61 4929.38,-9036.64"/>
</g>
<!-- layer10_expert5_up -->
<g id="node761" class="node">
<title>layer10_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5332,-9040 4937,-9040 4937,-8972 5332,-8972 5332,-9040"/>
<text text-anchor="middle" x="5134.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5134.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5134.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5134.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert5_up -->
<g id="edge1079" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6634.34,-9130.65C6301.6,-9116.84 5792.32,-9089.72 5342.03,-9040.14"/>
<polygon fill="black" stroke="black" points="5342.4,-9036.66 5332.07,-9039.04 5341.63,-9043.62 5342.4,-9036.66"/>
</g>
<!-- layer10_expert6_gate -->
<g id="node764" class="node">
<title>layer10_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5745,-9040 5350,-9040 5350,-8972 5745,-8972 5745,-9040"/>
<text text-anchor="middle" x="5547.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5547.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5547.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5547.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert6_gate -->
<g id="edge1084" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6620.03,-9119.44C6376.4,-9102.23 6051.1,-9075.86 5755.16,-9040.18"/>
<polygon fill="black" stroke="black" points="5755.43,-9036.68 5745.08,-9038.96 5754.59,-9043.63 5755.43,-9036.68"/>
</g>
<!-- layer10_expert6_up -->
<g id="node765" class="node">
<title>layer10_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6158,-9040 5763,-9040 5763,-8972 6158,-8972 6158,-9040"/>
<text text-anchor="middle" x="5960.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5960.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5960.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5960.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert6_up -->
<g id="edge1085" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6589.33,-9095.57C6457.89,-9079.37 6311.08,-9060.49 6168.37,-9040.25"/>
<polygon fill="black" stroke="black" points="6168.5,-9036.74 6158.11,-9038.79 6167.51,-9043.67 6168.5,-9036.74"/>
</g>
<!-- layer10_expert7_gate -->
<g id="node768" class="node">
<title>layer10_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6571,-9040 6176,-9040 6176,-8972 6571,-8972 6571,-9040"/>
<text text-anchor="middle" x="6373.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6373.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6373.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6373.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert7_gate -->
<g id="edge1090" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.53,-9076C6634.4,-9064.32 6581.09,-9052.61 6533.86,-9042.23"/>
<polygon fill="black" stroke="black" points="6534.4,-9038.77 6523.88,-9040.04 6532.89,-9045.6 6534.4,-9038.77"/>
</g>
<!-- layer10_expert7_up -->
<g id="node769" class="node">
<title>layer10_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6984,-9040 6589,-9040 6589,-8972 6984,-8972 6984,-9040"/>
<text text-anchor="middle" x="6786.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6786.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6786.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6786.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert7_up -->
<g id="edge1091" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6891.01,-9076C6875.37,-9065.67 6859.68,-9055.31 6845.38,-9045.87"/>
<polygon fill="black" stroke="black" points="6846.95,-9042.72 6836.68,-9040.13 6843.1,-9048.56 6846.95,-9042.72"/>
</g>
<!-- layer10_expert8_gate -->
<g id="node772" class="node">
<title>layer10_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7397,-9040 7002,-9040 7002,-8972 7397,-8972 7397,-9040"/>
<text text-anchor="middle" x="7199.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7199.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7199.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7199.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert8_gate -->
<g id="edge1096" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7094.48,-9076C7110.2,-9065.67 7125.97,-9055.31 7140.33,-9045.87"/>
<polygon fill="black" stroke="black" points="7142.64,-9048.54 7149.08,-9040.13 7138.8,-9042.69 7142.64,-9048.54"/>
</g>
<!-- layer10_expert8_up -->
<g id="node773" class="node">
<title>layer10_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7810,-9040 7415,-9040 7415,-8972 7810,-8972 7810,-9040"/>
<text text-anchor="middle" x="7612.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7612.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7612.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7612.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert8_up -->
<g id="edge1097" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7257.23,-9084.93C7323.49,-9070.4 7392.56,-9055.25 7451.99,-9042.21"/>
<polygon fill="black" stroke="black" points="7452.81,-9045.61 7461.82,-9040.05 7451.31,-9038.78 7452.81,-9045.61"/>
</g>
<!-- layer10_expert9_gate -->
<g id="node776" class="node">
<title>layer10_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8223,-9040 7828,-9040 7828,-8972 8223,-8972 8223,-9040"/>
<text text-anchor="middle" x="8025.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8025.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8025.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8025.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert9_gate -->
<g id="edge1102" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7288.03,-9108.73C7443.07,-9090.13 7636.37,-9065.94 7817.89,-9040.22"/>
<polygon fill="black" stroke="black" points="7818.49,-9043.67 7827.89,-9038.8 7817.5,-9036.74 7818.49,-9043.67"/>
</g>
<!-- layer10_expert9_up -->
<g id="node777" class="node">
<title>layer10_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8636,-9040 8241,-9040 8241,-8972 8636,-8972 8636,-9040"/>
<text text-anchor="middle" x="8438.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8438.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8438.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8438.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert9_up -->
<g id="edge1103" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7306.91,-9123.51C7555.39,-9106.52 7911.09,-9078.72 8230.99,-9040.16"/>
<polygon fill="black" stroke="black" points="8231.41,-9043.63 8240.92,-9038.96 8230.57,-9036.68 8231.41,-9043.63"/>
</g>
<!-- layer10_expert10_gate -->
<g id="node780" class="node">
<title>layer10_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9049,-9040 8654,-9040 8654,-8972 9049,-8972 9049,-9040"/>
<text text-anchor="middle" x="8851.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8851.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8851.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8851.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert10_gate -->
<g id="edge1108" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7317.93,-9132.01C7649.51,-9118.65 8178.55,-9091.38 8643.98,-9040.14"/>
<polygon fill="black" stroke="black" points="8644.37,-9043.62 8653.93,-9039.04 8643.6,-9036.66 8644.37,-9043.62"/>
</g>
<!-- layer10_expert10_up -->
<g id="node781" class="node">
<title>layer10_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9462,-9040 9067,-9040 9067,-8972 9462,-8972 9462,-9040"/>
<text text-anchor="middle" x="9264.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9264.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9264.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9264.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert10_up -->
<g id="edge1109" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7325.24,-9137.57C7732.05,-9128.37 8441.4,-9104.08 9056.97,-9040.13"/>
<polygon fill="black" stroke="black" points="9057.35,-9043.61 9066.93,-9039.09 9056.62,-9036.64 9057.35,-9043.61"/>
</g>
<!-- layer10_expert11_gate -->
<g id="node784" class="node">
<title>layer10_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9875,-9040 9480,-9040 9480,-8972 9875,-8972 9875,-9040"/>
<text text-anchor="middle" x="9677.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9677.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9677.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9677.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert11_gate -->
<g id="edge1114" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7330.2,-9141.5C7806.01,-9136.55 8700.7,-9116.86 9469.76,-9040.14"/>
<polygon fill="black" stroke="black" points="9470.33,-9043.6 9479.93,-9039.12 9469.64,-9036.63 9470.33,-9043.6"/>
</g>
<!-- layer10_expert11_up -->
<g id="node785" class="node">
<title>layer10_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10288,-9040 9893,-9040 9893,-8972 10288,-8972 10288,-9040"/>
<text text-anchor="middle" x="10090.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10090.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10090.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10090.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert11_up -->
<g id="edge1115" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7323.5,-9136.35C7969.28,-9122.53 9377.47,-9088.03 9882.63,-9040.13"/>
<polygon fill="black" stroke="black" points="9883.32,-9043.58 9892.94,-9039.14 9882.65,-9036.62 9883.32,-9043.58"/>
</g>
<!-- layer10_expert12_gate -->
<g id="node788" class="node">
<title>layer10_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10701,-9040 10306,-9040 10306,-8972 10701,-8972 10701,-9040"/>
<text text-anchor="middle" x="10503.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10503.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10503.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10503.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert12_gate -->
<g id="edge1120" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7325.83,-9138.02C8041.92,-9126.46 9709.02,-9094.58 10295.68,-9040.13"/>
<polygon fill="black" stroke="black" points="10296.31,-9043.58 10305.94,-9039.16 10295.65,-9036.61 10296.31,-9043.58"/>
</g>
<!-- layer10_expert12_up -->
<g id="node789" class="node">
<title>layer10_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11114,-9040 10719,-9040 10719,-8972 11114,-8972 11114,-9040"/>
<text text-anchor="middle" x="10916.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10916.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10916.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10916.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert12_up -->
<g id="edge1121" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7327.57,-9139.35C8109.82,-9129.92 10039.91,-9101.16 10708.7,-9040.12"/>
<polygon fill="black" stroke="black" points="10709.3,-9043.58 10718.94,-9039.17 10708.66,-9036.61 10709.3,-9043.58"/>
</g>
<!-- layer10_expert13_gate -->
<g id="node792" class="node">
<title>layer10_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11527,-9040 11132,-9040 11132,-8972 11527,-8972 11527,-9040"/>
<text text-anchor="middle" x="11329.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11329.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11329.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11329.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert13_gate -->
<g id="edge1126" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7328.74,-9140.43C8173.52,-9133.03 10370.4,-9107.78 11121.8,-9040.11"/>
<polygon fill="black" stroke="black" points="11122.3,-9043.58 11131.94,-9039.18 11121.66,-9036.61 11122.3,-9043.58"/>
</g>
<!-- layer10_expert13_up -->
<g id="node793" class="node">
<title>layer10_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11940,-9040 11545,-9040 11545,-8972 11940,-8972 11940,-9040"/>
<text text-anchor="middle" x="11742.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11742.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11742.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11742.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert13_up -->
<g id="edge1127" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7330.14,-9141.31C8234.83,-9135.84 10700.6,-9114.43 11534.9,-9040.1"/>
<polygon fill="black" stroke="black" points="11535.3,-9043.58 11544.94,-9039.19 11534.67,-9036.6 11535.3,-9043.58"/>
</g>
<!-- layer10_expert14_gate -->
<g id="node796" class="node">
<title>layer10_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12353,-9040 11958,-9040 11958,-8972 12353,-8972 12353,-9040"/>
<text text-anchor="middle" x="12155.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12155.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12155.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12155.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert14_gate -->
<g id="edge1132" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7330.95,-9142.06C8292.58,-9138.42 11030.12,-9121.11 11947.9,-9040.1"/>
<polygon fill="black" stroke="black" points="11948.29,-9043.58 11957.94,-9039.2 11947.67,-9036.6 11948.29,-9043.58"/>
</g>
<!-- layer10_expert14_up -->
<g id="node797" class="node">
<title>layer10_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12766,-9040 12371,-9040 12371,-8972 12766,-8972 12766,-9040"/>
<text text-anchor="middle" x="12568.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12568.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12568.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12568.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert14_up -->
<g id="edge1133" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7331.58,-9142.7C8347.74,-9140.8 11358.92,-9127.81 12360.71,-9040.11"/>
<polygon fill="black" stroke="black" points="12361.29,-9043.57 12370.94,-9039.21 12360.67,-9036.6 12361.29,-9043.57"/>
</g>
<!-- layer10_expert15_gate -->
<g id="node800" class="node">
<title>layer10_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13179,-9040 12784,-9040 12784,-8972 13179,-8972 13179,-9040"/>
<text text-anchor="middle" x="12981.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12981.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12981.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12981.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert15_gate -->
<g id="edge1138" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7332.27,-9143.24C8401.13,-9143.02 11687.73,-9134.53 12773.64,-9040.12"/>
<polygon fill="black" stroke="black" points="12774.29,-9043.57 12783.94,-9039.21 12773.68,-9036.6 12774.29,-9043.57"/>
</g>
<!-- layer10_expert15_up -->
<g id="node801" class="node">
<title>layer10_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13592,-9040 13197,-9040 13197,-8972 13592,-8972 13592,-9040"/>
<text text-anchor="middle" x="13394.5" y="-9024.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13394.5" y="-9009.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13394.5" y="-8994.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13394.5" y="-8979.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_token_distribution&#45;&gt;layer10_expert15_up -->
<g id="edge1139" class="edge">
<title>layer10_token_distribution&#45;&gt;layer10_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7333.15,-9143.72C8453.21,-9145.1 12016.63,-9141.26 13186.69,-9040.11"/>
<polygon fill="black" stroke="black" points="13187.29,-9043.57 13196.94,-9039.22 13186.68,-9036.6 13187.29,-9043.57"/>
</g>
<!-- layer10_expert0_act -->
<g id="node742" class="node">
<title>layer10_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1202,-8936 807,-8936 807,-8868 1202,-8868 1202,-8936"/>
<text text-anchor="middle" x="1004.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1004.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1004.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1004.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer10_expert0_gate&#45;&gt;layer10_expert0_act -->
<g id="edge1050" class="edge">
<title>layer10_expert0_gate&#45;&gt;layer10_expert0_act</title>
<path fill="none" stroke="black" d="M725.3,-8971.95C768.56,-8961.27 816.7,-8949.38 860.66,-8938.53"/>
<polygon fill="black" stroke="black" points="861.69,-8941.88 870.56,-8936.08 860.01,-8935.08 861.69,-8941.88"/>
</g>
<!-- layer10_expert0_up&#45;&gt;layer10_expert0_act -->
<g id="edge1051" class="edge">
<title>layer10_expert0_up&#45;&gt;layer10_expert0_act</title>
<path fill="none" stroke="black" d="M1004.5,-8971.88C1004.5,-8963.78 1004.5,-8954.98 1004.5,-8946.47"/>
<polygon fill="black" stroke="black" points="1008,-8946.3 1004.5,-8936.3 1001,-8946.3 1008,-8946.3"/>
</g>
<!-- layer10_expert0_down -->
<g id="node743" class="node">
<title>layer10_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1648,-8832 1265,-8832 1265,-8764 1648,-8764 1648,-8832"/>
<text text-anchor="middle" x="1456.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1456.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1456.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1456.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer10_expert0_act&#45;&gt;layer10_expert0_down -->
<g id="edge1052" class="edge">
<title>layer10_expert0_act&#45;&gt;layer10_expert0_down</title>
<path fill="none" stroke="black" d="M1150.94,-8867.95C1198.58,-8857.2 1251.63,-8845.23 1299.98,-8834.32"/>
<polygon fill="black" stroke="black" points="1300.92,-8837.7 1309.91,-8832.08 1299.38,-8830.87 1300.92,-8837.7"/>
</g>
<!-- layer10_token_aggregation -->
<g id="node804" class="node">
<title>layer10_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7465.24,-8728 6708.44,-8728 6513.76,-8592 7270.56,-8592 7465.24,-8728"/>
<text text-anchor="middle" x="6989.5" y="-8678.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6989.5" y="-8663.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6989.5" y="-8648.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8633.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_expert0_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1053" class="edge">
<title>layer10_expert0_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M1648.03,-8788.5C1817.66,-8781.19 2072.01,-8770.79 2293.5,-8764 3898.2,-8714.77 5812.06,-8680.34 6610.51,-8667.07"/>
<polygon fill="black" stroke="black" points="6610.79,-8670.56 6620.73,-8666.9 6610.67,-8663.56 6610.79,-8670.56"/>
</g>
<!-- layer10_expert1_act -->
<g id="node746" class="node">
<title>layer10_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2028,-8936 1633,-8936 1633,-8868 2028,-8868 2028,-8936"/>
<text text-anchor="middle" x="1830.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1830.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1830.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1830.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer10_expert1_gate&#45;&gt;layer10_expert1_act -->
<g id="edge1056" class="edge">
<title>layer10_expert1_gate&#45;&gt;layer10_expert1_act</title>
<path fill="none" stroke="black" d="M1551.3,-8971.95C1594.56,-8961.27 1642.7,-8949.38 1686.66,-8938.53"/>
<polygon fill="black" stroke="black" points="1687.69,-8941.88 1696.56,-8936.08 1686.01,-8935.08 1687.69,-8941.88"/>
</g>
<!-- layer10_expert1_up&#45;&gt;layer10_expert1_act -->
<g id="edge1057" class="edge">
<title>layer10_expert1_up&#45;&gt;layer10_expert1_act</title>
<path fill="none" stroke="black" d="M1830.5,-8971.88C1830.5,-8963.78 1830.5,-8954.98 1830.5,-8946.47"/>
<polygon fill="black" stroke="black" points="1834,-8946.3 1830.5,-8936.3 1827,-8946.3 1834,-8946.3"/>
</g>
<!-- layer10_expert1_down -->
<g id="node747" class="node">
<title>layer10_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2686,-8832 2303,-8832 2303,-8764 2686,-8764 2686,-8832"/>
<text text-anchor="middle" x="2494.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2494.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2494.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2494.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer10_expert1_act&#45;&gt;layer10_expert1_down -->
<g id="edge1058" class="edge">
<title>layer10_expert1_act&#45;&gt;layer10_expert1_down</title>
<path fill="none" stroke="black" d="M2028.37,-8870.6C2111.92,-8857.77 2209.1,-8842.84 2293.03,-8829.95"/>
<polygon fill="black" stroke="black" points="2293.59,-8833.4 2302.94,-8828.43 2292.52,-8826.49 2293.59,-8833.4"/>
</g>
<!-- layer10_expert1_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1059" class="edge">
<title>layer10_expert1_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M2686.04,-8783.1C2783.96,-8776.43 2905.04,-8768.85 3013.5,-8764 4333.36,-8704.96 5901.32,-8676.64 6609.23,-8666.1"/>
<polygon fill="black" stroke="black" points="6609.39,-8669.59 6619.33,-8665.95 6609.28,-8662.59 6609.39,-8669.59"/>
</g>
<!-- layer10_expert2_act -->
<g id="node750" class="node">
<title>layer10_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2854,-8936 2459,-8936 2459,-8868 2854,-8868 2854,-8936"/>
<text text-anchor="middle" x="2656.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2656.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2656.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2656.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer10_expert2_gate&#45;&gt;layer10_expert2_act -->
<g id="edge1062" class="edge">
<title>layer10_expert2_gate&#45;&gt;layer10_expert2_act</title>
<path fill="none" stroke="black" d="M2377.3,-8971.95C2420.56,-8961.27 2468.7,-8949.38 2512.66,-8938.53"/>
<polygon fill="black" stroke="black" points="2513.69,-8941.88 2522.56,-8936.08 2512.01,-8935.08 2513.69,-8941.88"/>
</g>
<!-- layer10_expert2_up&#45;&gt;layer10_expert2_act -->
<g id="edge1063" class="edge">
<title>layer10_expert2_up&#45;&gt;layer10_expert2_act</title>
<path fill="none" stroke="black" d="M2656.5,-8971.88C2656.5,-8963.78 2656.5,-8954.98 2656.5,-8946.47"/>
<polygon fill="black" stroke="black" points="2660,-8946.3 2656.5,-8936.3 2653,-8946.3 2660,-8946.3"/>
</g>
<!-- layer10_expert2_down -->
<g id="node751" class="node">
<title>layer10_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3406,-8832 3023,-8832 3023,-8764 3406,-8764 3406,-8832"/>
<text text-anchor="middle" x="3214.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="3214.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3214.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3214.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer10_expert2_act&#45;&gt;layer10_expert2_down -->
<g id="edge1064" class="edge">
<title>layer10_expert2_act&#45;&gt;layer10_expert2_down</title>
<path fill="none" stroke="black" d="M2837.28,-8867.95C2896.83,-8857.07 2963.23,-8844.93 3023.52,-8833.91"/>
<polygon fill="black" stroke="black" points="3024.32,-8837.32 3033.53,-8832.08 3023.06,-8830.44 3024.32,-8837.32"/>
</g>
<!-- layer10_expert2_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1065" class="edge">
<title>layer10_expert2_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M3406.23,-8777.18C3460.28,-8772.19 3519.15,-8767.31 3573.5,-8764 4673.54,-8696.92 5975.64,-8672.96 6607.45,-8664.86"/>
<polygon fill="black" stroke="black" points="6607.68,-8668.36 6617.63,-8664.73 6607.59,-8661.36 6607.68,-8668.36"/>
</g>
<!-- layer10_expert3_act -->
<g id="node754" class="node">
<title>layer10_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3680,-8936 3285,-8936 3285,-8868 3680,-8868 3680,-8936"/>
<text text-anchor="middle" x="3482.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3482.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3482.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3482.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer10_expert3_gate&#45;&gt;layer10_expert3_act -->
<g id="edge1068" class="edge">
<title>layer10_expert3_gate&#45;&gt;layer10_expert3_act</title>
<path fill="none" stroke="black" d="M3203.3,-8971.95C3246.56,-8961.27 3294.7,-8949.38 3338.66,-8938.53"/>
<polygon fill="black" stroke="black" points="3339.69,-8941.88 3348.56,-8936.08 3338.01,-8935.08 3339.69,-8941.88"/>
</g>
<!-- layer10_expert3_up&#45;&gt;layer10_expert3_act -->
<g id="edge1069" class="edge">
<title>layer10_expert3_up&#45;&gt;layer10_expert3_act</title>
<path fill="none" stroke="black" d="M3482.5,-8971.88C3482.5,-8963.78 3482.5,-8954.98 3482.5,-8946.47"/>
<polygon fill="black" stroke="black" points="3486,-8946.3 3482.5,-8936.3 3479,-8946.3 3486,-8946.3"/>
</g>
<!-- layer10_expert3_down -->
<g id="node755" class="node">
<title>layer10_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3966,-8832 3583,-8832 3583,-8764 3966,-8764 3966,-8832"/>
<text text-anchor="middle" x="3774.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3774.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3774.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3774.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer10_expert3_act&#45;&gt;layer10_expert3_down -->
<g id="edge1070" class="edge">
<title>layer10_expert3_act&#45;&gt;layer10_expert3_down</title>
<path fill="none" stroke="black" d="M3577.3,-8867.88C3606.91,-8857.54 3639.72,-8846.08 3669.96,-8835.52"/>
<polygon fill="black" stroke="black" points="3671.39,-8838.73 3679.67,-8832.12 3669.08,-8832.12 3671.39,-8838.73"/>
</g>
<!-- layer10_expert3_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1071" class="edge">
<title>layer10_expert3_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M3966.09,-8782.97C4058.12,-8776.56 4169.99,-8769.25 4270.5,-8764 5108.63,-8720.25 6093.01,-8687.62 6616.97,-8671.74"/>
<polygon fill="black" stroke="black" points="6617.45,-8675.23 6627.34,-8671.43 6617.23,-8668.23 6617.45,-8675.23"/>
</g>
<!-- layer10_expert4_act -->
<g id="node758" class="node">
<title>layer10_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4506,-8936 4111,-8936 4111,-8868 4506,-8868 4506,-8936"/>
<text text-anchor="middle" x="4308.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4308.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4308.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4308.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer10_expert4_gate&#45;&gt;layer10_expert4_act -->
<g id="edge1074" class="edge">
<title>layer10_expert4_gate&#45;&gt;layer10_expert4_act</title>
<path fill="none" stroke="black" d="M4029.3,-8971.95C4072.56,-8961.27 4120.7,-8949.38 4164.66,-8938.53"/>
<polygon fill="black" stroke="black" points="4165.69,-8941.88 4174.56,-8936.08 4164.01,-8935.08 4165.69,-8941.88"/>
</g>
<!-- layer10_expert4_up&#45;&gt;layer10_expert4_act -->
<g id="edge1075" class="edge">
<title>layer10_expert4_up&#45;&gt;layer10_expert4_act</title>
<path fill="none" stroke="black" d="M4308.5,-8971.88C4308.5,-8963.78 4308.5,-8954.98 4308.5,-8946.47"/>
<polygon fill="black" stroke="black" points="4312,-8946.3 4308.5,-8936.3 4305,-8946.3 4312,-8946.3"/>
</g>
<!-- layer10_expert4_down -->
<g id="node759" class="node">
<title>layer10_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4663,-8832 4280,-8832 4280,-8764 4663,-8764 4663,-8832"/>
<text text-anchor="middle" x="4471.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4471.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4471.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4471.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer10_expert4_act&#45;&gt;layer10_expert4_down -->
<g id="edge1076" class="edge">
<title>layer10_expert4_act&#45;&gt;layer10_expert4_down</title>
<path fill="none" stroke="black" d="M4361.42,-8867.88C4376.87,-8858.21 4393.89,-8847.56 4409.84,-8837.59"/>
<polygon fill="black" stroke="black" points="4411.94,-8840.4 4418.57,-8832.12 4408.23,-8834.46 4411.94,-8840.4"/>
</g>
<!-- layer10_expert4_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1077" class="edge">
<title>layer10_expert4_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M4663.08,-8786.65C5082.5,-8764 6087.65,-8709.71 6629.24,-8680.46"/>
<polygon fill="black" stroke="black" points="6629.77,-8683.93 6639.56,-8679.9 6629.39,-8676.94 6629.77,-8683.93"/>
</g>
<!-- layer10_expert5_act -->
<g id="node762" class="node">
<title>layer10_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5332,-8936 4937,-8936 4937,-8868 5332,-8868 5332,-8936"/>
<text text-anchor="middle" x="5134.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5134.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5134.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5134.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer10_expert5_gate&#45;&gt;layer10_expert5_act -->
<g id="edge1080" class="edge">
<title>layer10_expert5_gate&#45;&gt;layer10_expert5_act</title>
<path fill="none" stroke="black" d="M4855.3,-8971.95C4898.56,-8961.27 4946.7,-8949.38 4990.66,-8938.53"/>
<polygon fill="black" stroke="black" points="4991.69,-8941.88 5000.56,-8936.08 4990.01,-8935.08 4991.69,-8941.88"/>
</g>
<!-- layer10_expert5_up&#45;&gt;layer10_expert5_act -->
<g id="edge1081" class="edge">
<title>layer10_expert5_up&#45;&gt;layer10_expert5_act</title>
<path fill="none" stroke="black" d="M5134.5,-8971.88C5134.5,-8963.78 5134.5,-8954.98 5134.5,-8946.47"/>
<polygon fill="black" stroke="black" points="5138,-8946.3 5134.5,-8936.3 5131,-8946.3 5138,-8946.3"/>
</g>
<!-- layer10_expert5_down -->
<g id="node763" class="node">
<title>layer10_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5701,-8832 5318,-8832 5318,-8764 5701,-8764 5701,-8832"/>
<text text-anchor="middle" x="5509.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5509.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5509.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5509.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer10_expert5_act&#45;&gt;layer10_expert5_down -->
<g id="edge1082" class="edge">
<title>layer10_expert5_act&#45;&gt;layer10_expert5_down</title>
<path fill="none" stroke="black" d="M5255.99,-8867.95C5295.02,-8857.34 5338.43,-8845.53 5378.14,-8834.73"/>
<polygon fill="black" stroke="black" points="5379.15,-8838.08 5387.88,-8832.08 5377.31,-8831.33 5379.15,-8838.08"/>
</g>
<!-- layer10_expert5_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1083" class="edge">
<title>layer10_expert5_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M5701.09,-8779.39C5939.85,-8757.45 6352.2,-8719.56 6646.09,-8692.56"/>
<polygon fill="black" stroke="black" points="6646.42,-8696.04 6656.06,-8691.64 6645.78,-8689.07 6646.42,-8696.04"/>
</g>
<!-- layer10_expert6_act -->
<g id="node766" class="node">
<title>layer10_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6158,-8936 5763,-8936 5763,-8868 6158,-8868 6158,-8936"/>
<text text-anchor="middle" x="5960.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5960.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5960.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5960.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer10_expert6_gate&#45;&gt;layer10_expert6_act -->
<g id="edge1086" class="edge">
<title>layer10_expert6_gate&#45;&gt;layer10_expert6_act</title>
<path fill="none" stroke="black" d="M5681.3,-8971.95C5724.56,-8961.27 5772.7,-8949.38 5816.66,-8938.53"/>
<polygon fill="black" stroke="black" points="5817.69,-8941.88 5826.56,-8936.08 5816.01,-8935.08 5817.69,-8941.88"/>
</g>
<!-- layer10_expert6_up&#45;&gt;layer10_expert6_act -->
<g id="edge1087" class="edge">
<title>layer10_expert6_up&#45;&gt;layer10_expert6_act</title>
<path fill="none" stroke="black" d="M5960.5,-8971.88C5960.5,-8963.78 5960.5,-8954.98 5960.5,-8946.47"/>
<polygon fill="black" stroke="black" points="5964,-8946.3 5960.5,-8936.3 5957,-8946.3 5964,-8946.3"/>
</g>
<!-- layer10_expert6_down -->
<g id="node767" class="node">
<title>layer10_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6421,-8832 6038,-8832 6038,-8764 6421,-8764 6421,-8832"/>
<text text-anchor="middle" x="6229.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6229.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6229.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6229.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer10_expert6_act&#45;&gt;layer10_expert6_down -->
<g id="edge1088" class="edge">
<title>layer10_expert6_act&#45;&gt;layer10_expert6_down</title>
<path fill="none" stroke="black" d="M6047.84,-8867.88C6074.87,-8857.63 6104.82,-8846.28 6132.47,-8835.79"/>
<polygon fill="black" stroke="black" points="6134.03,-8838.94 6142.14,-8832.12 6131.55,-8832.4 6134.03,-8838.94"/>
</g>
<!-- layer10_expert6_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1089" class="edge">
<title>layer10_expert6_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M6413.96,-8763.99C6493.68,-8749.73 6589.18,-8732.64 6679.26,-8716.52"/>
<polygon fill="black" stroke="black" points="6680.14,-8719.91 6689.37,-8714.71 6678.91,-8713.02 6680.14,-8719.91"/>
</g>
<!-- layer10_expert7_act -->
<g id="node770" class="node">
<title>layer10_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6984,-8936 6589,-8936 6589,-8868 6984,-8868 6984,-8936"/>
<text text-anchor="middle" x="6786.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6786.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6786.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6786.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer10_expert7_gate&#45;&gt;layer10_expert7_act -->
<g id="edge1092" class="edge">
<title>layer10_expert7_gate&#45;&gt;layer10_expert7_act</title>
<path fill="none" stroke="black" d="M6507.3,-8971.95C6550.56,-8961.27 6598.7,-8949.38 6642.66,-8938.53"/>
<polygon fill="black" stroke="black" points="6643.69,-8941.88 6652.56,-8936.08 6642.01,-8935.08 6643.69,-8941.88"/>
</g>
<!-- layer10_expert7_up&#45;&gt;layer10_expert7_act -->
<g id="edge1093" class="edge">
<title>layer10_expert7_up&#45;&gt;layer10_expert7_act</title>
<path fill="none" stroke="black" d="M6786.5,-8971.88C6786.5,-8963.78 6786.5,-8954.98 6786.5,-8946.47"/>
<polygon fill="black" stroke="black" points="6790,-8946.3 6786.5,-8936.3 6783,-8946.3 6790,-8946.3"/>
</g>
<!-- layer10_expert7_down -->
<g id="node771" class="node">
<title>layer10_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6981,-8832 6598,-8832 6598,-8764 6981,-8764 6981,-8832"/>
<text text-anchor="middle" x="6789.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6789.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6789.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6789.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer10_expert7_act&#45;&gt;layer10_expert7_down -->
<g id="edge1094" class="edge">
<title>layer10_expert7_act&#45;&gt;layer10_expert7_down</title>
<path fill="none" stroke="black" d="M6787.47,-8867.88C6787.71,-8859.78 6787.97,-8850.98 6788.22,-8842.47"/>
<polygon fill="black" stroke="black" points="6791.73,-8842.4 6788.52,-8832.3 6784.73,-8842.19 6791.73,-8842.4"/>
</g>
<!-- layer10_expert7_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1095" class="edge">
<title>layer10_expert7_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M6838.17,-8763.9C6851.63,-8754.75 6866.8,-8744.44 6882.2,-8733.97"/>
<polygon fill="black" stroke="black" points="6884.47,-8736.66 6890.77,-8728.14 6880.53,-8730.87 6884.47,-8736.66"/>
</g>
<!-- layer10_expert8_act -->
<g id="node774" class="node">
<title>layer10_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7397,-8936 7002,-8936 7002,-8868 7397,-8868 7397,-8936"/>
<text text-anchor="middle" x="7199.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7199.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7199.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7199.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_expert8_gate&#45;&gt;layer10_expert8_act -->
<g id="edge1098" class="edge">
<title>layer10_expert8_gate&#45;&gt;layer10_expert8_act</title>
<path fill="none" stroke="black" d="M7199.5,-8971.88C7199.5,-8963.78 7199.5,-8954.98 7199.5,-8946.47"/>
<polygon fill="black" stroke="black" points="7203,-8946.3 7199.5,-8936.3 7196,-8946.3 7203,-8946.3"/>
</g>
<!-- layer10_expert8_up&#45;&gt;layer10_expert8_act -->
<g id="edge1099" class="edge">
<title>layer10_expert8_up&#45;&gt;layer10_expert8_act</title>
<path fill="none" stroke="black" d="M7478.7,-8971.95C7435.44,-8961.27 7387.3,-8949.38 7343.34,-8938.53"/>
<polygon fill="black" stroke="black" points="7343.99,-8935.08 7333.44,-8936.08 7342.31,-8941.88 7343.99,-8935.08"/>
</g>
<!-- layer10_expert8_down -->
<g id="node775" class="node">
<title>layer10_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7388,-8832 7005,-8832 7005,-8764 7388,-8764 7388,-8832"/>
<text text-anchor="middle" x="7196.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7196.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7196.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7196.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_expert8_act&#45;&gt;layer10_expert8_down -->
<g id="edge1100" class="edge">
<title>layer10_expert8_act&#45;&gt;layer10_expert8_down</title>
<path fill="none" stroke="black" d="M7198.53,-8867.88C7198.29,-8859.78 7198.03,-8850.98 7197.78,-8842.47"/>
<polygon fill="black" stroke="black" points="7201.27,-8842.19 7197.48,-8832.3 7194.27,-8842.4 7201.27,-8842.19"/>
</g>
<!-- layer10_expert8_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1101" class="edge">
<title>layer10_expert8_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M7146.13,-8763.9C7132.06,-8754.66 7116.2,-8744.25 7100.12,-8733.67"/>
<polygon fill="black" stroke="black" points="7101.97,-8730.7 7091.69,-8728.14 7098.12,-8736.55 7101.97,-8730.7"/>
</g>
<!-- layer10_expert9_act -->
<g id="node778" class="node">
<title>layer10_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8223,-8936 7828,-8936 7828,-8868 8223,-8868 8223,-8936"/>
<text text-anchor="middle" x="8025.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8025.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8025.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8025.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_expert9_gate&#45;&gt;layer10_expert9_act -->
<g id="edge1104" class="edge">
<title>layer10_expert9_gate&#45;&gt;layer10_expert9_act</title>
<path fill="none" stroke="black" d="M8025.5,-8971.88C8025.5,-8963.78 8025.5,-8954.98 8025.5,-8946.47"/>
<polygon fill="black" stroke="black" points="8029,-8946.3 8025.5,-8936.3 8022,-8946.3 8029,-8946.3"/>
</g>
<!-- layer10_expert9_up&#45;&gt;layer10_expert9_act -->
<g id="edge1105" class="edge">
<title>layer10_expert9_up&#45;&gt;layer10_expert9_act</title>
<path fill="none" stroke="black" d="M8304.7,-8971.95C8261.44,-8961.27 8213.3,-8949.38 8169.34,-8938.53"/>
<polygon fill="black" stroke="black" points="8169.99,-8935.08 8159.44,-8936.08 8168.31,-8941.88 8169.99,-8935.08"/>
</g>
<!-- layer10_expert9_down -->
<g id="node779" class="node">
<title>layer10_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8004,-8832 7621,-8832 7621,-8764 8004,-8764 8004,-8832"/>
<text text-anchor="middle" x="7812.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7812.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7812.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7812.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_expert9_act&#45;&gt;layer10_expert9_down -->
<g id="edge1106" class="edge">
<title>layer10_expert9_act&#45;&gt;layer10_expert9_down</title>
<path fill="none" stroke="black" d="M7956.35,-8867.88C7935.41,-8857.86 7912.26,-8846.77 7890.77,-8836.48"/>
<polygon fill="black" stroke="black" points="7892.2,-8833.29 7881.67,-8832.12 7889.18,-8839.6 7892.2,-8833.29"/>
</g>
<!-- layer10_expert9_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1107" class="edge">
<title>layer10_expert9_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M7620.84,-8765.33C7555.96,-8754.61 7480.75,-8742.18 7405.34,-8729.72"/>
<polygon fill="black" stroke="black" points="7405.62,-8726.22 7395.19,-8728.04 7404.48,-8733.12 7405.62,-8726.22"/>
</g>
<!-- layer10_expert10_act -->
<g id="node782" class="node">
<title>layer10_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9049,-8936 8654,-8936 8654,-8868 9049,-8868 9049,-8936"/>
<text text-anchor="middle" x="8851.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8851.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8851.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8851.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_expert10_gate&#45;&gt;layer10_expert10_act -->
<g id="edge1110" class="edge">
<title>layer10_expert10_gate&#45;&gt;layer10_expert10_act</title>
<path fill="none" stroke="black" d="M8851.5,-8971.88C8851.5,-8963.78 8851.5,-8954.98 8851.5,-8946.47"/>
<polygon fill="black" stroke="black" points="8855,-8946.3 8851.5,-8936.3 8848,-8946.3 8855,-8946.3"/>
</g>
<!-- layer10_expert10_up&#45;&gt;layer10_expert10_act -->
<g id="edge1111" class="edge">
<title>layer10_expert10_up&#45;&gt;layer10_expert10_act</title>
<path fill="none" stroke="black" d="M9130.7,-8971.95C9087.44,-8961.27 9039.3,-8949.38 8995.34,-8938.53"/>
<polygon fill="black" stroke="black" points="8995.99,-8935.08 8985.44,-8936.08 8994.31,-8941.88 8995.99,-8935.08"/>
</g>
<!-- layer10_expert10_down -->
<g id="node783" class="node">
<title>layer10_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8725,-8832 8342,-8832 8342,-8764 8725,-8764 8725,-8832"/>
<text text-anchor="middle" x="8533.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8533.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8533.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8533.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_expert10_act&#45;&gt;layer10_expert10_down -->
<g id="edge1112" class="edge">
<title>layer10_expert10_act&#45;&gt;layer10_expert10_down</title>
<path fill="none" stroke="black" d="M8748.25,-8867.88C8715.65,-8857.43 8679.47,-8845.82 8646.25,-8835.16"/>
<polygon fill="black" stroke="black" points="8647.09,-8831.76 8636.5,-8832.04 8644.95,-8838.42 8647.09,-8831.76"/>
</g>
<!-- layer10_expert10_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1113" class="edge">
<title>layer10_expert10_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M8341.85,-8780.12C8116.46,-8760.27 7734.98,-8726.66 7434.54,-8700.2"/>
<polygon fill="black" stroke="black" points="7434.61,-8696.69 7424.34,-8699.3 7433.99,-8703.67 7434.61,-8696.69"/>
</g>
<!-- layer10_expert11_act -->
<g id="node786" class="node">
<title>layer10_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9875,-8936 9480,-8936 9480,-8868 9875,-8868 9875,-8936"/>
<text text-anchor="middle" x="9677.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9677.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9677.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9677.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_expert11_gate&#45;&gt;layer10_expert11_act -->
<g id="edge1116" class="edge">
<title>layer10_expert11_gate&#45;&gt;layer10_expert11_act</title>
<path fill="none" stroke="black" d="M9677.5,-8971.88C9677.5,-8963.78 9677.5,-8954.98 9677.5,-8946.47"/>
<polygon fill="black" stroke="black" points="9681,-8946.3 9677.5,-8936.3 9674,-8946.3 9681,-8946.3"/>
</g>
<!-- layer10_expert11_up&#45;&gt;layer10_expert11_act -->
<g id="edge1117" class="edge">
<title>layer10_expert11_up&#45;&gt;layer10_expert11_act</title>
<path fill="none" stroke="black" d="M9956.7,-8971.95C9913.44,-8961.27 9865.3,-8949.38 9821.34,-8938.53"/>
<polygon fill="black" stroke="black" points="9821.99,-8935.08 9811.44,-8936.08 9820.31,-8941.88 9821.99,-8935.08"/>
</g>
<!-- layer10_expert11_down -->
<g id="node787" class="node">
<title>layer10_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9499,-8832 9116,-8832 9116,-8764 9499,-8764 9499,-8832"/>
<text text-anchor="middle" x="9307.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9307.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9307.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9307.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_expert11_act&#45;&gt;layer10_expert11_down -->
<g id="edge1118" class="edge">
<title>layer10_expert11_act&#45;&gt;layer10_expert11_down</title>
<path fill="none" stroke="black" d="M9557.63,-8867.95C9519.2,-8857.36 9476.47,-8845.58 9437.36,-8834.8"/>
<polygon fill="black" stroke="black" points="9438.07,-8831.36 9427.5,-8832.08 9436.21,-8838.11 9438.07,-8831.36"/>
</g>
<!-- layer10_expert11_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1119" class="edge">
<title>layer10_expert11_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M9115.84,-8785.75C8744.82,-8763.99 7920.55,-8715.63 7414.2,-8685.92"/>
<polygon fill="black" stroke="black" points="7414.35,-8682.42 7404.17,-8685.33 7413.94,-8689.41 7414.35,-8682.42"/>
</g>
<!-- layer10_expert12_act -->
<g id="node790" class="node">
<title>layer10_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10701,-8936 10306,-8936 10306,-8868 10701,-8868 10701,-8936"/>
<text text-anchor="middle" x="10503.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10503.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10503.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10503.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_expert12_gate&#45;&gt;layer10_expert12_act -->
<g id="edge1122" class="edge">
<title>layer10_expert12_gate&#45;&gt;layer10_expert12_act</title>
<path fill="none" stroke="black" d="M10503.5,-8971.88C10503.5,-8963.78 10503.5,-8954.98 10503.5,-8946.47"/>
<polygon fill="black" stroke="black" points="10507,-8946.3 10503.5,-8936.3 10500,-8946.3 10507,-8946.3"/>
</g>
<!-- layer10_expert12_up&#45;&gt;layer10_expert12_act -->
<g id="edge1123" class="edge">
<title>layer10_expert12_up&#45;&gt;layer10_expert12_act</title>
<path fill="none" stroke="black" d="M10782.7,-8971.95C10739.44,-8961.27 10691.3,-8949.38 10647.34,-8938.53"/>
<polygon fill="black" stroke="black" points="10647.99,-8935.08 10637.44,-8936.08 10646.31,-8941.88 10647.99,-8935.08"/>
</g>
<!-- layer10_expert12_down -->
<g id="node791" class="node">
<title>layer10_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10299,-8832 9916,-8832 9916,-8764 10299,-8764 10299,-8832"/>
<text text-anchor="middle" x="10107.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10107.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10107.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10107.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_expert12_act&#45;&gt;layer10_expert12_down -->
<g id="edge1124" class="edge">
<title>layer10_expert12_act&#45;&gt;layer10_expert12_down</title>
<path fill="none" stroke="black" d="M10375.2,-8867.95C10333.81,-8857.29 10287.76,-8845.43 10245.69,-8834.59"/>
<polygon fill="black" stroke="black" points="10246.49,-8831.19 10235.93,-8832.08 10244.74,-8837.96 10246.49,-8831.19"/>
</g>
<!-- layer10_expert12_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1125" class="edge">
<title>layer10_expert12_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M9915.67,-8785.74C9798.15,-8779.01 9644.65,-8770.53 9508.5,-8764 8765.75,-8728.36 7899.41,-8694.66 7400.65,-8676.02"/>
<polygon fill="black" stroke="black" points="7400.53,-8672.52 7390.41,-8675.64 7400.27,-8679.51 7400.53,-8672.52"/>
</g>
<!-- layer10_expert13_act -->
<g id="node794" class="node">
<title>layer10_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11527,-8936 11132,-8936 11132,-8868 11527,-8868 11527,-8936"/>
<text text-anchor="middle" x="11329.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11329.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11329.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11329.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_expert13_gate&#45;&gt;layer10_expert13_act -->
<g id="edge1128" class="edge">
<title>layer10_expert13_gate&#45;&gt;layer10_expert13_act</title>
<path fill="none" stroke="black" d="M11329.5,-8971.88C11329.5,-8963.78 11329.5,-8954.98 11329.5,-8946.47"/>
<polygon fill="black" stroke="black" points="11333,-8946.3 11329.5,-8936.3 11326,-8946.3 11333,-8946.3"/>
</g>
<!-- layer10_expert13_up&#45;&gt;layer10_expert13_act -->
<g id="edge1129" class="edge">
<title>layer10_expert13_up&#45;&gt;layer10_expert13_act</title>
<path fill="none" stroke="black" d="M11608.7,-8971.95C11565.44,-8961.27 11517.3,-8949.38 11473.34,-8938.53"/>
<polygon fill="black" stroke="black" points="11473.99,-8935.08 11463.44,-8936.08 11472.31,-8941.88 11473.99,-8935.08"/>
</g>
<!-- layer10_expert13_down -->
<g id="node795" class="node">
<title>layer10_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11112,-8832 10729,-8832 10729,-8764 11112,-8764 11112,-8832"/>
<text text-anchor="middle" x="10920.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10920.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10920.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10920.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_expert13_act&#45;&gt;layer10_expert13_down -->
<g id="edge1130" class="edge">
<title>layer10_expert13_act&#45;&gt;layer10_expert13_down</title>
<path fill="none" stroke="black" d="M11196.99,-8867.95C11154.15,-8857.27 11106.48,-8845.38 11062.95,-8834.53"/>
<polygon fill="black" stroke="black" points="11063.7,-8831.1 11053.15,-8832.08 11062,-8837.9 11063.7,-8831.1"/>
</g>
<!-- layer10_expert13_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1131" class="edge">
<title>layer10_expert13_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M10728.98,-8785.55C10608.35,-8778.61 10449.36,-8769.98 10308.5,-8764 9257.09,-8719.34 8017.53,-8686 7392.76,-8670.54"/>
<polygon fill="black" stroke="black" points="7392.78,-8667.04 7382.69,-8670.3 7392.6,-8674.04 7392.78,-8667.04"/>
</g>
<!-- layer10_expert14_act -->
<g id="node798" class="node">
<title>layer10_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12353,-8936 11958,-8936 11958,-8868 12353,-8868 12353,-8936"/>
<text text-anchor="middle" x="12155.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12155.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12155.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12155.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_expert14_gate&#45;&gt;layer10_expert14_act -->
<g id="edge1134" class="edge">
<title>layer10_expert14_gate&#45;&gt;layer10_expert14_act</title>
<path fill="none" stroke="black" d="M12155.5,-8971.88C12155.5,-8963.78 12155.5,-8954.98 12155.5,-8946.47"/>
<polygon fill="black" stroke="black" points="12159,-8946.3 12155.5,-8936.3 12152,-8946.3 12159,-8946.3"/>
</g>
<!-- layer10_expert14_up&#45;&gt;layer10_expert14_act -->
<g id="edge1135" class="edge">
<title>layer10_expert14_up&#45;&gt;layer10_expert14_act</title>
<path fill="none" stroke="black" d="M12434.7,-8971.95C12391.44,-8961.27 12343.3,-8949.38 12299.34,-8938.53"/>
<polygon fill="black" stroke="black" points="12299.99,-8935.08 12289.44,-8936.08 12298.31,-8941.88 12299.99,-8935.08"/>
</g>
<!-- layer10_expert14_down -->
<g id="node799" class="node">
<title>layer10_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11931,-8832 11548,-8832 11548,-8764 11931,-8764 11931,-8832"/>
<text text-anchor="middle" x="11739.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11739.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11739.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11739.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_expert14_act&#45;&gt;layer10_expert14_down -->
<g id="edge1136" class="edge">
<title>layer10_expert14_act&#45;&gt;layer10_expert14_down</title>
<path fill="none" stroke="black" d="M12020.72,-8867.95C11977.15,-8857.27 11928.66,-8845.38 11884.39,-8834.53"/>
<polygon fill="black" stroke="black" points="11884.96,-8831.06 11874.42,-8832.08 11883.3,-8837.86 11884.96,-8831.06"/>
</g>
<!-- layer10_expert14_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1137" class="edge">
<title>layer10_expert14_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M11547.83,-8785.36C11425.82,-8778.3 11264.43,-8769.6 11121.5,-8764 9751.85,-8710.37 8125.66,-8679.43 7388.32,-8667.17"/>
<polygon fill="black" stroke="black" points="7388.12,-8663.67 7378.07,-8667 7388.01,-8670.67 7388.12,-8663.67"/>
</g>
<!-- layer10_expert15_act -->
<g id="node802" class="node">
<title>layer10_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13179,-8936 12784,-8936 12784,-8868 13179,-8868 13179,-8936"/>
<text text-anchor="middle" x="12981.5" y="-8920.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12981.5" y="-8905.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12981.5" y="-8890.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12981.5" y="-8875.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_expert15_gate&#45;&gt;layer10_expert15_act -->
<g id="edge1140" class="edge">
<title>layer10_expert15_gate&#45;&gt;layer10_expert15_act</title>
<path fill="none" stroke="black" d="M12981.5,-8971.88C12981.5,-8963.78 12981.5,-8954.98 12981.5,-8946.47"/>
<polygon fill="black" stroke="black" points="12985,-8946.3 12981.5,-8936.3 12978,-8946.3 12985,-8946.3"/>
</g>
<!-- layer10_expert15_up&#45;&gt;layer10_expert15_act -->
<g id="edge1141" class="edge">
<title>layer10_expert15_up&#45;&gt;layer10_expert15_act</title>
<path fill="none" stroke="black" d="M13260.7,-8971.95C13217.44,-8961.27 13169.3,-8949.38 13125.34,-8938.53"/>
<polygon fill="black" stroke="black" points="13125.99,-8935.08 13115.44,-8936.08 13124.31,-8941.88 13125.99,-8935.08"/>
</g>
<!-- layer10_expert15_down -->
<g id="node803" class="node">
<title>layer10_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12754,-8832 12371,-8832 12371,-8764 12754,-8764 12754,-8832"/>
<text text-anchor="middle" x="12562.5" y="-8816.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12562.5" y="-8801.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12562.5" y="-8786.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12562.5" y="-8771.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_expert15_act&#45;&gt;layer10_expert15_down -->
<g id="edge1142" class="edge">
<title>layer10_expert15_act&#45;&gt;layer10_expert15_down</title>
<path fill="none" stroke="black" d="M12845.75,-8867.95C12801.77,-8857.25 12752.82,-8845.33 12708.15,-8834.46"/>
<polygon fill="black" stroke="black" points="12708.93,-8831.05 12698.39,-8832.08 12707.28,-8837.85 12708.93,-8831.05"/>
</g>
<!-- layer10_expert15_down&#45;&gt;layer10_token_aggregation -->
<g id="edge1143" class="edge">
<title>layer10_expert15_down&#45;&gt;layer10_token_aggregation</title>
<path fill="none" stroke="black" d="M12370.98,-8785.24C12248.02,-8778.09 12084.9,-8769.33 11940.5,-8764 10246.24,-8701.45 8224.33,-8674.15 7384.93,-8664.91"/>
<polygon fill="black" stroke="black" points="7384.84,-8661.4 7374.8,-8664.79 7384.76,-8668.4 7384.84,-8661.4"/>
</g>
<!-- layer10_res2 -->
<g id="node805" class="node">
<title>layer10_res2</title>
<polygon fill="none" stroke="black" points="7430.24,-8556 6729.12,-8556 6548.76,-8390 7249.88,-8390 7430.24,-8556"/>
<text text-anchor="middle" x="6989.5" y="-8499.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6989.5" y="-8484.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8469.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8454.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8439.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_token_aggregation&#45;&gt;layer10_res2 -->
<g id="edge1144" class="edge">
<title>layer10_token_aggregation&#45;&gt;layer10_res2</title>
<path fill="none" stroke="black" d="M6989.5,-8591.95C6989.5,-8583.63 6989.5,-8575 6989.5,-8566.38"/>
<polygon fill="black" stroke="black" points="6993,-8566.28 6989.5,-8556.28 6986,-8566.28 6993,-8566.28"/>
</g>
<!-- layer11_mha_qkv -->
<g id="node806" class="node">
<title>layer11_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7225.5,-8354 6753.5,-8354 6753.5,-8286 7225.5,-8286 7225.5,-8354"/>
<text text-anchor="middle" x="6989.5" y="-8338.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6989.5" y="-8323.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8308.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6989.5" y="-8293.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_res2&#45;&gt;layer11_mha_qkv -->
<g id="edge1145" class="edge">
<title>layer10_res2&#45;&gt;layer11_mha_qkv</title>
<path fill="none" stroke="black" d="M6989.5,-8389.87C6989.5,-8381.12 6989.5,-8372.48 6989.5,-8364.45"/>
<polygon fill="black" stroke="black" points="6993,-8364.26 6989.5,-8354.26 6986,-8364.26 6993,-8364.26"/>
</g>
<!-- layer11_mha_attn -->
<g id="node807" class="node">
<title>layer11_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7219.5,-8250 6759.5,-8250 6759.5,-8182 7219.5,-8182 7219.5,-8250"/>
<text text-anchor="middle" x="6989.5" y="-8234.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6989.5" y="-8219.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6989.5" y="-8204.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8189.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_mha_qkv&#45;&gt;layer11_mha_attn -->
<g id="edge1146" class="edge">
<title>layer11_mha_qkv&#45;&gt;layer11_mha_attn</title>
<path fill="none" stroke="black" d="M6989.5,-8285.88C6989.5,-8277.78 6989.5,-8268.98 6989.5,-8260.47"/>
<polygon fill="black" stroke="black" points="6993,-8260.3 6989.5,-8250.3 6986,-8260.3 6993,-8260.3"/>
</g>
<!-- layer11_mha_out -->
<g id="node808" class="node">
<title>layer11_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7202,-8146 6777,-8146 6777,-8078 7202,-8078 7202,-8146"/>
<text text-anchor="middle" x="6989.5" y="-8130.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6989.5" y="-8115.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8100.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-8085.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_mha_attn&#45;&gt;layer11_mha_out -->
<g id="edge1147" class="edge">
<title>layer11_mha_attn&#45;&gt;layer11_mha_out</title>
<path fill="none" stroke="black" d="M6989.5,-8181.88C6989.5,-8173.78 6989.5,-8164.98 6989.5,-8156.47"/>
<polygon fill="black" stroke="black" points="6993,-8156.3 6989.5,-8146.3 6986,-8156.3 6993,-8156.3"/>
</g>
<!-- layer11_res1 -->
<g id="node809" class="node">
<title>layer11_res1</title>
<polygon fill="none" stroke="black" points="7430.24,-8042 6729.12,-8042 6548.76,-7876 7249.88,-7876 7430.24,-8042"/>
<text text-anchor="middle" x="6989.5" y="-7985.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6989.5" y="-7970.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7955.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7940.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7925.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_mha_out&#45;&gt;layer11_res1 -->
<g id="edge1148" class="edge">
<title>layer11_mha_out&#45;&gt;layer11_res1</title>
<path fill="none" stroke="black" d="M6989.5,-8077.86C6989.5,-8070.1 6989.5,-8061.46 6989.5,-8052.48"/>
<polygon fill="black" stroke="black" points="6993,-8052.23 6989.5,-8042.23 6986,-8052.23 6993,-8052.23"/>
</g>
<!-- layer11_ln1 -->
<g id="node810" class="node">
<title>layer11_ln1</title>
<polygon fill="yellow" stroke="black" points="7202,-7840 6777,-7840 6777,-7772 7202,-7772 7202,-7840"/>
<text text-anchor="middle" x="6989.5" y="-7824.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6989.5" y="-7809.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7794.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7779.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_res1&#45;&gt;layer11_ln1 -->
<g id="edge1149" class="edge">
<title>layer11_res1&#45;&gt;layer11_ln1</title>
<path fill="none" stroke="black" d="M6989.5,-7875.87C6989.5,-7867.12 6989.5,-7858.48 6989.5,-7850.45"/>
<polygon fill="black" stroke="black" points="6993,-7850.26 6989.5,-7840.26 6986,-7850.26 6993,-7850.26"/>
</g>
<!-- layer11_expert_routing -->
<g id="node811" class="node">
<title>layer11_expert_routing</title>
<polygon fill="orange" stroke="black" points="6989.5,-7736 6573.5,-7653 6989.5,-7570 7405.5,-7653 6989.5,-7736"/>
<text text-anchor="middle" x="6989.5" y="-7679.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6989.5" y="-7664.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6989.5" y="-7649.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7634.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6989.5" y="-7619.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_ln1&#45;&gt;layer11_expert_routing -->
<g id="edge1150" class="edge">
<title>layer11_ln1&#45;&gt;layer11_expert_routing</title>
<path fill="none" stroke="black" d="M6989.5,-7771.86C6989.5,-7764.1 6989.5,-7755.46 6989.5,-7746.48"/>
<polygon fill="black" stroke="black" points="6993,-7746.23 6989.5,-7736.23 6986,-7746.23 6993,-7746.23"/>
</g>
<!-- layer11_token_distribution -->
<g id="node812" class="node">
<title>layer11_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7417.86,-7534 6736.44,-7534 6561.14,-7398 7242.56,-7398 7417.86,-7534"/>
<text text-anchor="middle" x="6989.5" y="-7484.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6989.5" y="-7469.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6989.5" y="-7454.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6989.5" y="-7439.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer11_expert_routing&#45;&gt;layer11_token_distribution -->
<g id="edge1151" class="edge">
<title>layer11_expert_routing&#45;&gt;layer11_token_distribution</title>
<path fill="none" stroke="black" d="M6989.5,-7569.78C6989.5,-7561.34 6989.5,-7552.79 6989.5,-7544.4"/>
<polygon fill="black" stroke="black" points="6993,-7544.28 6989.5,-7534.28 6986,-7544.28 6993,-7544.28"/>
</g>
<!-- layer11_expert0_gate -->
<g id="node813" class="node">
<title>layer11_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="786,-7362 391,-7362 391,-7294 786,-7294 786,-7362"/>
<text text-anchor="middle" x="588.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="588.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="588.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="588.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert0_gate -->
<g id="edge1152" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6648.42,-7465.72C5527.99,-7467.09 1966.01,-7463.23 796.31,-7362.11"/>
<polygon fill="black" stroke="black" points="796.32,-7358.6 786.06,-7361.22 795.71,-7365.57 796.32,-7358.6"/>
</g>
<!-- layer11_expert0_up -->
<g id="node814" class="node">
<title>layer11_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1199,-7362 804,-7362 804,-7294 1199,-7294 1199,-7362"/>
<text text-anchor="middle" x="1001.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="1001.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1001.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1001.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert0_up -->
<g id="edge1153" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6647.42,-7465.24C5576.28,-7465 2294.27,-7456.44 1209.35,-7362.12"/>
<polygon fill="black" stroke="black" points="1209.32,-7358.6 1199.06,-7361.21 1208.71,-7365.57 1209.32,-7358.6"/>
</g>
<!-- layer11_expert1_gate -->
<g id="node817" class="node">
<title>layer11_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1612,-7362 1217,-7362 1217,-7294 1612,-7294 1612,-7362"/>
<text text-anchor="middle" x="1414.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1414.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1414.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1414.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert1_gate -->
<g id="edge1158" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6646.86,-7464.69C5627.38,-7462.77 2622.69,-7449.69 1622.28,-7362.11"/>
<polygon fill="black" stroke="black" points="1622.33,-7358.6 1612.06,-7361.21 1621.71,-7365.57 1622.33,-7358.6"/>
</g>
<!-- layer11_expert1_up -->
<g id="node818" class="node">
<title>layer11_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2025,-7362 1630,-7362 1630,-7294 2025,-7294 2025,-7362"/>
<text text-anchor="middle" x="1827.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1827.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1827.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1827.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert1_up -->
<g id="edge1159" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6645.92,-7464.04C5679.86,-7460.35 2951.03,-7442.95 2035.08,-7362.09"/>
<polygon fill="black" stroke="black" points="2035.33,-7358.6 2025.06,-7361.2 2034.71,-7365.58 2035.33,-7358.6"/>
</g>
<!-- layer11_expert2_gate -->
<g id="node821" class="node">
<title>layer11_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2438,-7362 2043,-7362 2043,-7294 2438,-7294 2438,-7362"/>
<text text-anchor="middle" x="2240.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2240.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2240.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2240.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert2_gate -->
<g id="edge1164" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.93,-7463.27C5734.78,-7457.72 3280.04,-7436.22 2448.07,-7362.1"/>
<polygon fill="black" stroke="black" points="2448.33,-7358.6 2438.06,-7361.19 2447.7,-7365.58 2448.33,-7358.6"/>
</g>
<!-- layer11_expert2_up -->
<g id="node822" class="node">
<title>layer11_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2851,-7362 2456,-7362 2456,-7294 2851,-7294 2851,-7362"/>
<text text-anchor="middle" x="2653.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2653.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2653.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2653.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert2_up -->
<g id="edge1165" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6643.99,-7462.34C5792.65,-7454.84 3609.62,-7429.52 2861.16,-7362.1"/>
<polygon fill="black" stroke="black" points="2861.34,-7358.61 2851.06,-7361.18 2860.7,-7365.58 2861.34,-7358.61"/>
</g>
<!-- layer11_expert3_gate -->
<g id="node825" class="node">
<title>layer11_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3264,-7362 2869,-7362 2869,-7294 3264,-7294 3264,-7362"/>
<text text-anchor="middle" x="3066.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3066.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3066.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3066.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert3_gate -->
<g id="edge1170" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6642.41,-7461.2C5852.73,-7451.62 3939.42,-7422.84 3274.24,-7362.11"/>
<polygon fill="black" stroke="black" points="3274.34,-7358.61 3264.06,-7361.17 3273.7,-7365.58 3274.34,-7358.61"/>
</g>
<!-- layer11_expert3_up -->
<g id="node826" class="node">
<title>layer11_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3677,-7362 3282,-7362 3282,-7294 3677,-7294 3677,-7362"/>
<text text-anchor="middle" x="3479.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3479.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3479.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3479.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert3_up -->
<g id="edge1171" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6640.52,-7459.77C5916.21,-7447.98 4269.46,-7416.17 3687.25,-7362.12"/>
<polygon fill="black" stroke="black" points="3687.35,-7358.61 3677.06,-7361.16 3686.69,-7365.58 3687.35,-7358.61"/>
</g>
<!-- layer11_expert4_gate -->
<g id="node829" class="node">
<title>layer11_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4090,-7362 3695,-7362 3695,-7294 4090,-7294 4090,-7362"/>
<text text-anchor="middle" x="3892.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3892.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3892.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3892.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert4_gate -->
<g id="edge1176" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6638.06,-7457.9C5983.59,-7443.8 4599.94,-7409.52 4100.26,-7362.12"/>
<polygon fill="black" stroke="black" points="4100.35,-7358.62 4090.06,-7361.14 4099.68,-7365.58 4100.35,-7358.62"/>
</g>
<!-- layer11_expert4_up -->
<g id="node830" class="node">
<title>layer11_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4503,-7362 4108,-7362 4108,-7294 4503,-7294 4503,-7362"/>
<text text-anchor="middle" x="4305.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4305.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4305.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4305.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert4_up -->
<g id="edge1177" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6645.37,-7463.42C6168.11,-7458.35 5278.47,-7438.49 4513.19,-7362.13"/>
<polygon fill="black" stroke="black" points="4513.36,-7358.63 4503.07,-7361.12 4512.67,-7365.6 4513.36,-7358.63"/>
</g>
<!-- layer11_expert5_gate -->
<g id="node833" class="node">
<title>layer11_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4916,-7362 4521,-7362 4521,-7294 4916,-7294 4916,-7362"/>
<text text-anchor="middle" x="4718.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4718.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4718.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4718.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert5_gate -->
<g id="edge1182" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6639.68,-7459.16C6230.56,-7449.67 5533.04,-7425.18 4926.34,-7362.16"/>
<polygon fill="black" stroke="black" points="4926.38,-7358.64 4916.07,-7361.09 4925.65,-7365.61 4926.38,-7358.64"/>
</g>
<!-- layer11_expert5_up -->
<g id="node834" class="node">
<title>layer11_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5329,-7362 4934,-7362 4934,-7294 5329,-7294 5329,-7362"/>
<text text-anchor="middle" x="5131.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5131.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5131.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5131.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert5_up -->
<g id="edge1183" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6631.34,-7452.65C6298.6,-7438.84 5789.32,-7411.72 5339.03,-7362.14"/>
<polygon fill="black" stroke="black" points="5339.4,-7358.66 5329.07,-7361.04 5338.63,-7365.62 5339.4,-7358.66"/>
</g>
<!-- layer11_expert6_gate -->
<g id="node837" class="node">
<title>layer11_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5742,-7362 5347,-7362 5347,-7294 5742,-7294 5742,-7362"/>
<text text-anchor="middle" x="5544.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5544.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5544.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5544.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert6_gate -->
<g id="edge1188" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6617.03,-7441.44C6373.4,-7424.23 6048.1,-7397.86 5752.16,-7362.18"/>
<polygon fill="black" stroke="black" points="5752.43,-7358.68 5742.08,-7360.96 5751.59,-7365.63 5752.43,-7358.68"/>
</g>
<!-- layer11_expert6_up -->
<g id="node838" class="node">
<title>layer11_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6155,-7362 5760,-7362 5760,-7294 6155,-7294 6155,-7362"/>
<text text-anchor="middle" x="5957.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5957.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5957.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5957.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert6_up -->
<g id="edge1189" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6586.33,-7417.57C6454.89,-7401.37 6308.08,-7382.49 6165.37,-7362.25"/>
<polygon fill="black" stroke="black" points="6165.5,-7358.74 6155.11,-7360.79 6164.51,-7365.67 6165.5,-7358.74"/>
</g>
<!-- layer11_expert7_gate -->
<g id="node841" class="node">
<title>layer11_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6568,-7362 6173,-7362 6173,-7294 6568,-7294 6568,-7362"/>
<text text-anchor="middle" x="6370.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6370.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6370.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6370.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert7_gate -->
<g id="edge1194" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6684.53,-7398C6631.4,-7386.32 6578.09,-7374.61 6530.86,-7364.23"/>
<polygon fill="black" stroke="black" points="6531.4,-7360.77 6520.88,-7362.04 6529.89,-7367.6 6531.4,-7360.77"/>
</g>
<!-- layer11_expert7_up -->
<g id="node842" class="node">
<title>layer11_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6981,-7362 6586,-7362 6586,-7294 6981,-7294 6981,-7362"/>
<text text-anchor="middle" x="6783.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6783.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6783.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6783.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert7_up -->
<g id="edge1195" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6888.01,-7398C6872.37,-7387.67 6856.68,-7377.31 6842.38,-7367.87"/>
<polygon fill="black" stroke="black" points="6843.95,-7364.72 6833.68,-7362.13 6840.1,-7370.56 6843.95,-7364.72"/>
</g>
<!-- layer11_expert8_gate -->
<g id="node845" class="node">
<title>layer11_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7394,-7362 6999,-7362 6999,-7294 7394,-7294 7394,-7362"/>
<text text-anchor="middle" x="7196.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7196.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7196.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7196.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert8_gate -->
<g id="edge1200" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7091.48,-7398C7107.2,-7387.67 7122.97,-7377.31 7137.33,-7367.87"/>
<polygon fill="black" stroke="black" points="7139.64,-7370.54 7146.08,-7362.13 7135.8,-7364.69 7139.64,-7370.54"/>
</g>
<!-- layer11_expert8_up -->
<g id="node846" class="node">
<title>layer11_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7807,-7362 7412,-7362 7412,-7294 7807,-7294 7807,-7362"/>
<text text-anchor="middle" x="7609.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7609.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7609.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7609.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert8_up -->
<g id="edge1201" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7254.23,-7406.93C7320.49,-7392.4 7389.56,-7377.25 7448.99,-7364.21"/>
<polygon fill="black" stroke="black" points="7449.81,-7367.61 7458.82,-7362.05 7448.31,-7360.78 7449.81,-7367.61"/>
</g>
<!-- layer11_expert9_gate -->
<g id="node849" class="node">
<title>layer11_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8220,-7362 7825,-7362 7825,-7294 8220,-7294 8220,-7362"/>
<text text-anchor="middle" x="8022.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8022.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8022.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8022.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert9_gate -->
<g id="edge1206" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7285.03,-7430.73C7440.07,-7412.13 7633.37,-7387.94 7814.89,-7362.22"/>
<polygon fill="black" stroke="black" points="7815.49,-7365.67 7824.89,-7360.8 7814.5,-7358.74 7815.49,-7365.67"/>
</g>
<!-- layer11_expert9_up -->
<g id="node850" class="node">
<title>layer11_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8633,-7362 8238,-7362 8238,-7294 8633,-7294 8633,-7362"/>
<text text-anchor="middle" x="8435.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8435.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8435.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8435.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert9_up -->
<g id="edge1207" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7303.91,-7445.51C7552.39,-7428.52 7908.09,-7400.72 8227.99,-7362.16"/>
<polygon fill="black" stroke="black" points="8228.41,-7365.63 8237.92,-7360.96 8227.57,-7358.68 8228.41,-7365.63"/>
</g>
<!-- layer11_expert10_gate -->
<g id="node853" class="node">
<title>layer11_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9046,-7362 8651,-7362 8651,-7294 9046,-7294 9046,-7362"/>
<text text-anchor="middle" x="8848.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8848.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8848.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8848.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert10_gate -->
<g id="edge1212" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7314.93,-7454.01C7646.51,-7440.65 8175.55,-7413.38 8640.98,-7362.14"/>
<polygon fill="black" stroke="black" points="8641.37,-7365.62 8650.93,-7361.04 8640.6,-7358.66 8641.37,-7365.62"/>
</g>
<!-- layer11_expert10_up -->
<g id="node854" class="node">
<title>layer11_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9459,-7362 9064,-7362 9064,-7294 9459,-7294 9459,-7362"/>
<text text-anchor="middle" x="9261.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9261.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9261.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9261.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert10_up -->
<g id="edge1213" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7322.24,-7459.57C7729.05,-7450.37 8438.4,-7426.08 9053.97,-7362.13"/>
<polygon fill="black" stroke="black" points="9054.35,-7365.61 9063.93,-7361.09 9053.62,-7358.64 9054.35,-7365.61"/>
</g>
<!-- layer11_expert11_gate -->
<g id="node857" class="node">
<title>layer11_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9872,-7362 9477,-7362 9477,-7294 9872,-7294 9872,-7362"/>
<text text-anchor="middle" x="9674.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9674.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9674.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9674.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert11_gate -->
<g id="edge1218" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7327.2,-7463.5C7803.01,-7458.55 8697.7,-7438.86 9466.76,-7362.14"/>
<polygon fill="black" stroke="black" points="9467.33,-7365.6 9476.93,-7361.12 9466.64,-7358.63 9467.33,-7365.6"/>
</g>
<!-- layer11_expert11_up -->
<g id="node858" class="node">
<title>layer11_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10285,-7362 9890,-7362 9890,-7294 10285,-7294 10285,-7362"/>
<text text-anchor="middle" x="10087.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10087.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10087.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10087.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert11_up -->
<g id="edge1219" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.5,-7458.35C7966.28,-7444.53 9374.47,-7410.03 9879.63,-7362.13"/>
<polygon fill="black" stroke="black" points="9880.32,-7365.58 9889.94,-7361.14 9879.65,-7358.62 9880.32,-7365.58"/>
</g>
<!-- layer11_expert12_gate -->
<g id="node861" class="node">
<title>layer11_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10698,-7362 10303,-7362 10303,-7294 10698,-7294 10698,-7362"/>
<text text-anchor="middle" x="10500.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10500.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10500.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10500.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert12_gate -->
<g id="edge1224" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7322.83,-7460.02C8038.92,-7448.46 9706.02,-7416.58 10292.68,-7362.13"/>
<polygon fill="black" stroke="black" points="10293.31,-7365.58 10302.94,-7361.16 10292.65,-7358.61 10293.31,-7365.58"/>
</g>
<!-- layer11_expert12_up -->
<g id="node862" class="node">
<title>layer11_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11111,-7362 10716,-7362 10716,-7294 11111,-7294 11111,-7362"/>
<text text-anchor="middle" x="10913.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10913.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10913.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10913.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert12_up -->
<g id="edge1225" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7324.57,-7461.35C8106.82,-7451.92 10036.91,-7423.16 10705.7,-7362.12"/>
<polygon fill="black" stroke="black" points="10706.3,-7365.58 10715.94,-7361.17 10705.66,-7358.61 10706.3,-7365.58"/>
</g>
<!-- layer11_expert13_gate -->
<g id="node865" class="node">
<title>layer11_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11524,-7362 11129,-7362 11129,-7294 11524,-7294 11524,-7362"/>
<text text-anchor="middle" x="11326.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11326.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11326.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11326.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert13_gate -->
<g id="edge1230" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7325.74,-7462.43C8170.52,-7455.03 10367.4,-7429.78 11118.8,-7362.11"/>
<polygon fill="black" stroke="black" points="11119.3,-7365.58 11128.94,-7361.18 11118.66,-7358.61 11119.3,-7365.58"/>
</g>
<!-- layer11_expert13_up -->
<g id="node866" class="node">
<title>layer11_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11937,-7362 11542,-7362 11542,-7294 11937,-7294 11937,-7362"/>
<text text-anchor="middle" x="11739.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11739.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11739.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11739.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert13_up -->
<g id="edge1231" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7327.14,-7463.31C8231.83,-7457.84 10697.6,-7436.43 11531.9,-7362.1"/>
<polygon fill="black" stroke="black" points="11532.3,-7365.58 11541.94,-7361.19 11531.67,-7358.6 11532.3,-7365.58"/>
</g>
<!-- layer11_expert14_gate -->
<g id="node869" class="node">
<title>layer11_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12350,-7362 11955,-7362 11955,-7294 12350,-7294 12350,-7362"/>
<text text-anchor="middle" x="12152.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12152.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12152.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12152.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert14_gate -->
<g id="edge1236" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7327.95,-7464.06C8289.58,-7460.42 11027.12,-7443.11 11944.9,-7362.1"/>
<polygon fill="black" stroke="black" points="11945.29,-7365.58 11954.94,-7361.2 11944.67,-7358.6 11945.29,-7365.58"/>
</g>
<!-- layer11_expert14_up -->
<g id="node870" class="node">
<title>layer11_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12763,-7362 12368,-7362 12368,-7294 12763,-7294 12763,-7362"/>
<text text-anchor="middle" x="12565.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12565.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12565.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12565.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert14_up -->
<g id="edge1237" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7328.58,-7464.7C8344.74,-7462.8 11355.92,-7449.81 12357.71,-7362.11"/>
<polygon fill="black" stroke="black" points="12358.29,-7365.57 12367.94,-7361.21 12357.67,-7358.6 12358.29,-7365.57"/>
</g>
<!-- layer11_expert15_gate -->
<g id="node873" class="node">
<title>layer11_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13176,-7362 12781,-7362 12781,-7294 13176,-7294 13176,-7362"/>
<text text-anchor="middle" x="12978.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12978.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12978.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12978.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert15_gate -->
<g id="edge1242" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7329.27,-7465.24C8398.13,-7465.02 11684.73,-7456.53 12770.64,-7362.12"/>
<polygon fill="black" stroke="black" points="12771.29,-7365.57 12780.94,-7361.21 12770.68,-7358.6 12771.29,-7365.57"/>
</g>
<!-- layer11_expert15_up -->
<g id="node874" class="node">
<title>layer11_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13589,-7362 13194,-7362 13194,-7294 13589,-7294 13589,-7362"/>
<text text-anchor="middle" x="13391.5" y="-7346.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13391.5" y="-7331.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13391.5" y="-7316.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13391.5" y="-7301.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_token_distribution&#45;&gt;layer11_expert15_up -->
<g id="edge1243" class="edge">
<title>layer11_token_distribution&#45;&gt;layer11_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7330.15,-7465.72C8450.21,-7467.1 12013.63,-7463.26 13183.69,-7362.11"/>
<polygon fill="black" stroke="black" points="13184.29,-7365.57 13193.94,-7361.22 13183.68,-7358.6 13184.29,-7365.57"/>
</g>
<!-- layer11_expert0_act -->
<g id="node815" class="node">
<title>layer11_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1199,-7258 804,-7258 804,-7190 1199,-7190 1199,-7258"/>
<text text-anchor="middle" x="1001.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="1001.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1001.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1001.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer11_expert0_gate&#45;&gt;layer11_expert0_act -->
<g id="edge1154" class="edge">
<title>layer11_expert0_gate&#45;&gt;layer11_expert0_act</title>
<path fill="none" stroke="black" d="M722.3,-7293.95C765.56,-7283.27 813.7,-7271.38 857.66,-7260.53"/>
<polygon fill="black" stroke="black" points="858.69,-7263.88 867.56,-7258.08 857.01,-7257.08 858.69,-7263.88"/>
</g>
<!-- layer11_expert0_up&#45;&gt;layer11_expert0_act -->
<g id="edge1155" class="edge">
<title>layer11_expert0_up&#45;&gt;layer11_expert0_act</title>
<path fill="none" stroke="black" d="M1001.5,-7293.88C1001.5,-7285.78 1001.5,-7276.98 1001.5,-7268.47"/>
<polygon fill="black" stroke="black" points="1005,-7268.3 1001.5,-7258.3 998,-7268.3 1005,-7268.3"/>
</g>
<!-- layer11_expert0_down -->
<g id="node816" class="node">
<title>layer11_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1405,-7154 1022,-7154 1022,-7086 1405,-7086 1405,-7154"/>
<text text-anchor="middle" x="1213.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1213.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1213.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1213.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer11_expert0_act&#45;&gt;layer11_expert0_down -->
<g id="edge1156" class="edge">
<title>layer11_expert0_act&#45;&gt;layer11_expert0_down</title>
<path fill="none" stroke="black" d="M1070.33,-7189.88C1091.17,-7179.86 1114.21,-7168.77 1135.6,-7158.48"/>
<polygon fill="black" stroke="black" points="1137.16,-7161.61 1144.65,-7154.12 1134.12,-7155.31 1137.16,-7161.61"/>
</g>
<!-- layer11_token_aggregation -->
<g id="node877" class="node">
<title>layer11_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7462.24,-7050 6705.44,-7050 6510.76,-6914 7267.56,-6914 7462.24,-7050"/>
<text text-anchor="middle" x="6986.5" y="-7000.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6986.5" y="-6985.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6986.5" y="-6970.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6955.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_expert0_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1157" class="edge">
<title>layer11_expert0_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M1405.25,-7107.25C1528.88,-7100.07 1693.13,-7091.29 1838.5,-7086 3619.65,-7021.18 5749.04,-6994.85 6603.82,-6986.37"/>
<polygon fill="black" stroke="black" points="6604.16,-6989.87 6614.13,-6986.27 6604.09,-6982.87 6604.16,-6989.87"/>
</g>
<!-- layer11_expert1_act -->
<g id="node819" class="node">
<title>layer11_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2025,-7258 1630,-7258 1630,-7190 2025,-7190 2025,-7258"/>
<text text-anchor="middle" x="1827.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1827.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1827.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1827.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer11_expert1_gate&#45;&gt;layer11_expert1_act -->
<g id="edge1160" class="edge">
<title>layer11_expert1_gate&#45;&gt;layer11_expert1_act</title>
<path fill="none" stroke="black" d="M1548.3,-7293.95C1591.56,-7283.27 1639.7,-7271.38 1683.66,-7260.53"/>
<polygon fill="black" stroke="black" points="1684.69,-7263.88 1693.56,-7258.08 1683.01,-7257.08 1684.69,-7263.88"/>
</g>
<!-- layer11_expert1_up&#45;&gt;layer11_expert1_act -->
<g id="edge1161" class="edge">
<title>layer11_expert1_up&#45;&gt;layer11_expert1_act</title>
<path fill="none" stroke="black" d="M1827.5,-7293.88C1827.5,-7285.78 1827.5,-7276.98 1827.5,-7268.47"/>
<polygon fill="black" stroke="black" points="1831,-7268.3 1827.5,-7258.3 1824,-7268.3 1831,-7268.3"/>
</g>
<!-- layer11_expert1_down -->
<g id="node820" class="node">
<title>layer11_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2231,-7154 1848,-7154 1848,-7086 2231,-7086 2231,-7154"/>
<text text-anchor="middle" x="2039.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2039.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2039.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2039.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer11_expert1_act&#45;&gt;layer11_expert1_down -->
<g id="edge1162" class="edge">
<title>layer11_expert1_act&#45;&gt;layer11_expert1_down</title>
<path fill="none" stroke="black" d="M1896.33,-7189.88C1917.17,-7179.86 1940.21,-7168.77 1961.6,-7158.48"/>
<polygon fill="black" stroke="black" points="1963.16,-7161.61 1970.65,-7154.12 1960.12,-7155.31 1963.16,-7161.61"/>
</g>
<!-- layer11_expert1_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1163" class="edge">
<title>layer11_expert1_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M2231.26,-7107.44C2354.89,-7100.34 2519.14,-7091.57 2664.5,-7086 4120.65,-7030.22 5854,-6999.8 6606.56,-6988.36"/>
<polygon fill="black" stroke="black" points="6606.79,-6991.86 6616.74,-6988.21 6606.69,-6984.86 6606.79,-6991.86"/>
</g>
<!-- layer11_expert2_act -->
<g id="node823" class="node">
<title>layer11_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2851,-7258 2456,-7258 2456,-7190 2851,-7190 2851,-7258"/>
<text text-anchor="middle" x="2653.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2653.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2653.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2653.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer11_expert2_gate&#45;&gt;layer11_expert2_act -->
<g id="edge1166" class="edge">
<title>layer11_expert2_gate&#45;&gt;layer11_expert2_act</title>
<path fill="none" stroke="black" d="M2374.3,-7293.95C2417.56,-7283.27 2465.7,-7271.38 2509.66,-7260.53"/>
<polygon fill="black" stroke="black" points="2510.69,-7263.88 2519.56,-7258.08 2509.01,-7257.08 2510.69,-7263.88"/>
</g>
<!-- layer11_expert2_up&#45;&gt;layer11_expert2_act -->
<g id="edge1167" class="edge">
<title>layer11_expert2_up&#45;&gt;layer11_expert2_act</title>
<path fill="none" stroke="black" d="M2653.5,-7293.88C2653.5,-7285.78 2653.5,-7276.98 2653.5,-7268.47"/>
<polygon fill="black" stroke="black" points="2657,-7268.3 2653.5,-7258.3 2650,-7268.3 2657,-7268.3"/>
</g>
<!-- layer11_expert2_down -->
<g id="node824" class="node">
<title>layer11_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3057,-7154 2674,-7154 2674,-7086 3057,-7086 3057,-7154"/>
<text text-anchor="middle" x="2865.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2865.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2865.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2865.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer11_expert2_act&#45;&gt;layer11_expert2_down -->
<g id="edge1168" class="edge">
<title>layer11_expert2_act&#45;&gt;layer11_expert2_down</title>
<path fill="none" stroke="black" d="M2722.33,-7189.88C2743.17,-7179.86 2766.21,-7168.77 2787.6,-7158.48"/>
<polygon fill="black" stroke="black" points="2789.16,-7161.61 2796.65,-7154.12 2786.12,-7155.31 2789.16,-7161.61"/>
</g>
<!-- layer11_expert2_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1169" class="edge">
<title>layer11_expert2_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M3057.34,-7109.16C3199.09,-7102.09 3396.79,-7092.68 3570.5,-7086 4676.01,-7043.46 5983.33,-7008.25 6611.99,-6992.25"/>
<polygon fill="black" stroke="black" points="6612.21,-6995.75 6622.12,-6992 6612.03,-6988.75 6612.21,-6995.75"/>
</g>
<!-- layer11_expert3_act -->
<g id="node827" class="node">
<title>layer11_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3677,-7258 3282,-7258 3282,-7190 3677,-7190 3677,-7258"/>
<text text-anchor="middle" x="3479.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3479.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3479.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3479.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer11_expert3_gate&#45;&gt;layer11_expert3_act -->
<g id="edge1172" class="edge">
<title>layer11_expert3_gate&#45;&gt;layer11_expert3_act</title>
<path fill="none" stroke="black" d="M3200.3,-7293.95C3243.56,-7283.27 3291.7,-7271.38 3335.66,-7260.53"/>
<polygon fill="black" stroke="black" points="3336.69,-7263.88 3345.56,-7258.08 3335.01,-7257.08 3336.69,-7263.88"/>
</g>
<!-- layer11_expert3_up&#45;&gt;layer11_expert3_act -->
<g id="edge1173" class="edge">
<title>layer11_expert3_up&#45;&gt;layer11_expert3_act</title>
<path fill="none" stroke="black" d="M3479.5,-7293.88C3479.5,-7285.78 3479.5,-7276.98 3479.5,-7268.47"/>
<polygon fill="black" stroke="black" points="3483,-7268.3 3479.5,-7258.3 3476,-7268.3 3483,-7268.3"/>
</g>
<!-- layer11_expert3_down -->
<g id="node828" class="node">
<title>layer11_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3963,-7154 3580,-7154 3580,-7086 3963,-7086 3963,-7154"/>
<text text-anchor="middle" x="3771.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3771.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3771.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3771.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer11_expert3_act&#45;&gt;layer11_expert3_down -->
<g id="edge1174" class="edge">
<title>layer11_expert3_act&#45;&gt;layer11_expert3_down</title>
<path fill="none" stroke="black" d="M3574.3,-7189.88C3603.91,-7179.54 3636.72,-7168.08 3666.96,-7157.52"/>
<polygon fill="black" stroke="black" points="3668.39,-7160.73 3676.67,-7154.12 3666.08,-7154.12 3668.39,-7160.73"/>
</g>
<!-- layer11_expert3_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1175" class="edge">
<title>layer11_expert3_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M3963.09,-7104.97C4055.12,-7098.56 4166.99,-7091.25 4267.5,-7086 5105.63,-7042.25 6090.01,-7009.62 6613.97,-6993.74"/>
<polygon fill="black" stroke="black" points="6614.45,-6997.23 6624.34,-6993.43 6614.23,-6990.23 6614.45,-6997.23"/>
</g>
<!-- layer11_expert4_act -->
<g id="node831" class="node">
<title>layer11_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4503,-7258 4108,-7258 4108,-7190 4503,-7190 4503,-7258"/>
<text text-anchor="middle" x="4305.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4305.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4305.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4305.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer11_expert4_gate&#45;&gt;layer11_expert4_act -->
<g id="edge1178" class="edge">
<title>layer11_expert4_gate&#45;&gt;layer11_expert4_act</title>
<path fill="none" stroke="black" d="M4026.3,-7293.95C4069.56,-7283.27 4117.7,-7271.38 4161.66,-7260.53"/>
<polygon fill="black" stroke="black" points="4162.69,-7263.88 4171.56,-7258.08 4161.01,-7257.08 4162.69,-7263.88"/>
</g>
<!-- layer11_expert4_up&#45;&gt;layer11_expert4_act -->
<g id="edge1179" class="edge">
<title>layer11_expert4_up&#45;&gt;layer11_expert4_act</title>
<path fill="none" stroke="black" d="M4305.5,-7293.88C4305.5,-7285.78 4305.5,-7276.98 4305.5,-7268.47"/>
<polygon fill="black" stroke="black" points="4309,-7268.3 4305.5,-7258.3 4302,-7268.3 4309,-7268.3"/>
</g>
<!-- layer11_expert4_down -->
<g id="node832" class="node">
<title>layer11_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4660,-7154 4277,-7154 4277,-7086 4660,-7086 4660,-7154"/>
<text text-anchor="middle" x="4468.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4468.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4468.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4468.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer11_expert4_act&#45;&gt;layer11_expert4_down -->
<g id="edge1180" class="edge">
<title>layer11_expert4_act&#45;&gt;layer11_expert4_down</title>
<path fill="none" stroke="black" d="M4358.42,-7189.88C4373.87,-7180.21 4390.89,-7169.56 4406.84,-7159.59"/>
<polygon fill="black" stroke="black" points="4408.94,-7162.4 4415.57,-7154.12 4405.23,-7156.46 4408.94,-7162.4"/>
</g>
<!-- layer11_expert4_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1181" class="edge">
<title>layer11_expert4_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M4660.08,-7108.65C5079.5,-7086 6084.65,-7031.71 6626.24,-7002.46"/>
<polygon fill="black" stroke="black" points="6626.77,-7005.93 6636.56,-7001.9 6626.39,-6998.94 6626.77,-7005.93"/>
</g>
<!-- layer11_expert5_act -->
<g id="node835" class="node">
<title>layer11_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5329,-7258 4934,-7258 4934,-7190 5329,-7190 5329,-7258"/>
<text text-anchor="middle" x="5131.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5131.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5131.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5131.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer11_expert5_gate&#45;&gt;layer11_expert5_act -->
<g id="edge1184" class="edge">
<title>layer11_expert5_gate&#45;&gt;layer11_expert5_act</title>
<path fill="none" stroke="black" d="M4852.3,-7293.95C4895.56,-7283.27 4943.7,-7271.38 4987.66,-7260.53"/>
<polygon fill="black" stroke="black" points="4988.69,-7263.88 4997.56,-7258.08 4987.01,-7257.08 4988.69,-7263.88"/>
</g>
<!-- layer11_expert5_up&#45;&gt;layer11_expert5_act -->
<g id="edge1185" class="edge">
<title>layer11_expert5_up&#45;&gt;layer11_expert5_act</title>
<path fill="none" stroke="black" d="M5131.5,-7293.88C5131.5,-7285.78 5131.5,-7276.98 5131.5,-7268.47"/>
<polygon fill="black" stroke="black" points="5135,-7268.3 5131.5,-7258.3 5128,-7268.3 5135,-7268.3"/>
</g>
<!-- layer11_expert5_down -->
<g id="node836" class="node">
<title>layer11_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5698,-7154 5315,-7154 5315,-7086 5698,-7086 5698,-7154"/>
<text text-anchor="middle" x="5506.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5506.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5506.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5506.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer11_expert5_act&#45;&gt;layer11_expert5_down -->
<g id="edge1186" class="edge">
<title>layer11_expert5_act&#45;&gt;layer11_expert5_down</title>
<path fill="none" stroke="black" d="M5252.99,-7189.95C5292.02,-7179.34 5335.43,-7167.53 5375.14,-7156.73"/>
<polygon fill="black" stroke="black" points="5376.15,-7160.08 5384.88,-7154.08 5374.31,-7153.33 5376.15,-7160.08"/>
</g>
<!-- layer11_expert5_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1187" class="edge">
<title>layer11_expert5_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M5698.09,-7101.39C5936.85,-7079.45 6349.2,-7041.56 6643.09,-7014.56"/>
<polygon fill="black" stroke="black" points="6643.42,-7018.04 6653.06,-7013.64 6642.78,-7011.07 6643.42,-7018.04"/>
</g>
<!-- layer11_expert6_act -->
<g id="node839" class="node">
<title>layer11_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6155,-7258 5760,-7258 5760,-7190 6155,-7190 6155,-7258"/>
<text text-anchor="middle" x="5957.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5957.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5957.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5957.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer11_expert6_gate&#45;&gt;layer11_expert6_act -->
<g id="edge1190" class="edge">
<title>layer11_expert6_gate&#45;&gt;layer11_expert6_act</title>
<path fill="none" stroke="black" d="M5678.3,-7293.95C5721.56,-7283.27 5769.7,-7271.38 5813.66,-7260.53"/>
<polygon fill="black" stroke="black" points="5814.69,-7263.88 5823.56,-7258.08 5813.01,-7257.08 5814.69,-7263.88"/>
</g>
<!-- layer11_expert6_up&#45;&gt;layer11_expert6_act -->
<g id="edge1191" class="edge">
<title>layer11_expert6_up&#45;&gt;layer11_expert6_act</title>
<path fill="none" stroke="black" d="M5957.5,-7293.88C5957.5,-7285.78 5957.5,-7276.98 5957.5,-7268.47"/>
<polygon fill="black" stroke="black" points="5961,-7268.3 5957.5,-7258.3 5954,-7268.3 5961,-7268.3"/>
</g>
<!-- layer11_expert6_down -->
<g id="node840" class="node">
<title>layer11_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6418,-7154 6035,-7154 6035,-7086 6418,-7086 6418,-7154"/>
<text text-anchor="middle" x="6226.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6226.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6226.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6226.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer11_expert6_act&#45;&gt;layer11_expert6_down -->
<g id="edge1192" class="edge">
<title>layer11_expert6_act&#45;&gt;layer11_expert6_down</title>
<path fill="none" stroke="black" d="M6044.84,-7189.88C6071.87,-7179.63 6101.82,-7168.28 6129.47,-7157.79"/>
<polygon fill="black" stroke="black" points="6131.03,-7160.94 6139.14,-7154.12 6128.55,-7154.4 6131.03,-7160.94"/>
</g>
<!-- layer11_expert6_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1193" class="edge">
<title>layer11_expert6_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M6410.96,-7085.99C6490.68,-7071.73 6586.18,-7054.64 6676.26,-7038.52"/>
<polygon fill="black" stroke="black" points="6677.14,-7041.91 6686.37,-7036.71 6675.91,-7035.02 6677.14,-7041.91"/>
</g>
<!-- layer11_expert7_act -->
<g id="node843" class="node">
<title>layer11_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6981,-7258 6586,-7258 6586,-7190 6981,-7190 6981,-7258"/>
<text text-anchor="middle" x="6783.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6783.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6783.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6783.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer11_expert7_gate&#45;&gt;layer11_expert7_act -->
<g id="edge1196" class="edge">
<title>layer11_expert7_gate&#45;&gt;layer11_expert7_act</title>
<path fill="none" stroke="black" d="M6504.3,-7293.95C6547.56,-7283.27 6595.7,-7271.38 6639.66,-7260.53"/>
<polygon fill="black" stroke="black" points="6640.69,-7263.88 6649.56,-7258.08 6639.01,-7257.08 6640.69,-7263.88"/>
</g>
<!-- layer11_expert7_up&#45;&gt;layer11_expert7_act -->
<g id="edge1197" class="edge">
<title>layer11_expert7_up&#45;&gt;layer11_expert7_act</title>
<path fill="none" stroke="black" d="M6783.5,-7293.88C6783.5,-7285.78 6783.5,-7276.98 6783.5,-7268.47"/>
<polygon fill="black" stroke="black" points="6787,-7268.3 6783.5,-7258.3 6780,-7268.3 6787,-7268.3"/>
</g>
<!-- layer11_expert7_down -->
<g id="node844" class="node">
<title>layer11_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6978,-7154 6595,-7154 6595,-7086 6978,-7086 6978,-7154"/>
<text text-anchor="middle" x="6786.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6786.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6786.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6786.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer11_expert7_act&#45;&gt;layer11_expert7_down -->
<g id="edge1198" class="edge">
<title>layer11_expert7_act&#45;&gt;layer11_expert7_down</title>
<path fill="none" stroke="black" d="M6784.47,-7189.88C6784.71,-7181.78 6784.97,-7172.98 6785.22,-7164.47"/>
<polygon fill="black" stroke="black" points="6788.73,-7164.4 6785.52,-7154.3 6781.73,-7164.19 6788.73,-7164.4"/>
</g>
<!-- layer11_expert7_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1199" class="edge">
<title>layer11_expert7_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M6835.17,-7085.9C6848.63,-7076.75 6863.8,-7066.44 6879.2,-7055.97"/>
<polygon fill="black" stroke="black" points="6881.47,-7058.66 6887.77,-7050.14 6877.53,-7052.87 6881.47,-7058.66"/>
</g>
<!-- layer11_expert8_act -->
<g id="node847" class="node">
<title>layer11_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7394,-7258 6999,-7258 6999,-7190 7394,-7190 7394,-7258"/>
<text text-anchor="middle" x="7196.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7196.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7196.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7196.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_expert8_gate&#45;&gt;layer11_expert8_act -->
<g id="edge1202" class="edge">
<title>layer11_expert8_gate&#45;&gt;layer11_expert8_act</title>
<path fill="none" stroke="black" d="M7196.5,-7293.88C7196.5,-7285.78 7196.5,-7276.98 7196.5,-7268.47"/>
<polygon fill="black" stroke="black" points="7200,-7268.3 7196.5,-7258.3 7193,-7268.3 7200,-7268.3"/>
</g>
<!-- layer11_expert8_up&#45;&gt;layer11_expert8_act -->
<g id="edge1203" class="edge">
<title>layer11_expert8_up&#45;&gt;layer11_expert8_act</title>
<path fill="none" stroke="black" d="M7475.7,-7293.95C7432.44,-7283.27 7384.3,-7271.38 7340.34,-7260.53"/>
<polygon fill="black" stroke="black" points="7340.99,-7257.08 7330.44,-7258.08 7339.31,-7263.88 7340.99,-7257.08"/>
</g>
<!-- layer11_expert8_down -->
<g id="node848" class="node">
<title>layer11_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7385,-7154 7002,-7154 7002,-7086 7385,-7086 7385,-7154"/>
<text text-anchor="middle" x="7193.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7193.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7193.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7193.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_expert8_act&#45;&gt;layer11_expert8_down -->
<g id="edge1204" class="edge">
<title>layer11_expert8_act&#45;&gt;layer11_expert8_down</title>
<path fill="none" stroke="black" d="M7195.53,-7189.88C7195.29,-7181.78 7195.03,-7172.98 7194.78,-7164.47"/>
<polygon fill="black" stroke="black" points="7198.27,-7164.19 7194.48,-7154.3 7191.27,-7164.4 7198.27,-7164.19"/>
</g>
<!-- layer11_expert8_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1205" class="edge">
<title>layer11_expert8_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M7143.13,-7085.9C7129.06,-7076.66 7113.2,-7066.25 7097.12,-7055.67"/>
<polygon fill="black" stroke="black" points="7098.97,-7052.7 7088.69,-7050.14 7095.12,-7058.55 7098.97,-7052.7"/>
</g>
<!-- layer11_expert9_act -->
<g id="node851" class="node">
<title>layer11_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8220,-7258 7825,-7258 7825,-7190 8220,-7190 8220,-7258"/>
<text text-anchor="middle" x="8022.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8022.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8022.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8022.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_expert9_gate&#45;&gt;layer11_expert9_act -->
<g id="edge1208" class="edge">
<title>layer11_expert9_gate&#45;&gt;layer11_expert9_act</title>
<path fill="none" stroke="black" d="M8022.5,-7293.88C8022.5,-7285.78 8022.5,-7276.98 8022.5,-7268.47"/>
<polygon fill="black" stroke="black" points="8026,-7268.3 8022.5,-7258.3 8019,-7268.3 8026,-7268.3"/>
</g>
<!-- layer11_expert9_up&#45;&gt;layer11_expert9_act -->
<g id="edge1209" class="edge">
<title>layer11_expert9_up&#45;&gt;layer11_expert9_act</title>
<path fill="none" stroke="black" d="M8301.7,-7293.95C8258.44,-7283.27 8210.3,-7271.38 8166.34,-7260.53"/>
<polygon fill="black" stroke="black" points="8166.99,-7257.08 8156.44,-7258.08 8165.31,-7263.88 8166.99,-7257.08"/>
</g>
<!-- layer11_expert9_down -->
<g id="node852" class="node">
<title>layer11_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="8001,-7154 7618,-7154 7618,-7086 8001,-7086 8001,-7154"/>
<text text-anchor="middle" x="7809.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7809.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7809.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7809.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_expert9_act&#45;&gt;layer11_expert9_down -->
<g id="edge1210" class="edge">
<title>layer11_expert9_act&#45;&gt;layer11_expert9_down</title>
<path fill="none" stroke="black" d="M7953.35,-7189.88C7932.41,-7179.86 7909.26,-7168.77 7887.77,-7158.48"/>
<polygon fill="black" stroke="black" points="7889.2,-7155.29 7878.67,-7154.12 7886.18,-7161.6 7889.2,-7155.29"/>
</g>
<!-- layer11_expert9_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1211" class="edge">
<title>layer11_expert9_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M7617.84,-7087.33C7552.96,-7076.61 7477.75,-7064.18 7402.34,-7051.72"/>
<polygon fill="black" stroke="black" points="7402.62,-7048.22 7392.19,-7050.04 7401.48,-7055.12 7402.62,-7048.22"/>
</g>
<!-- layer11_expert10_act -->
<g id="node855" class="node">
<title>layer11_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9046,-7258 8651,-7258 8651,-7190 9046,-7190 9046,-7258"/>
<text text-anchor="middle" x="8848.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8848.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8848.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8848.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_expert10_gate&#45;&gt;layer11_expert10_act -->
<g id="edge1214" class="edge">
<title>layer11_expert10_gate&#45;&gt;layer11_expert10_act</title>
<path fill="none" stroke="black" d="M8848.5,-7293.88C8848.5,-7285.78 8848.5,-7276.98 8848.5,-7268.47"/>
<polygon fill="black" stroke="black" points="8852,-7268.3 8848.5,-7258.3 8845,-7268.3 8852,-7268.3"/>
</g>
<!-- layer11_expert10_up&#45;&gt;layer11_expert10_act -->
<g id="edge1215" class="edge">
<title>layer11_expert10_up&#45;&gt;layer11_expert10_act</title>
<path fill="none" stroke="black" d="M9127.7,-7293.95C9084.44,-7283.27 9036.3,-7271.38 8992.34,-7260.53"/>
<polygon fill="black" stroke="black" points="8992.99,-7257.08 8982.44,-7258.08 8991.31,-7263.88 8992.99,-7257.08"/>
</g>
<!-- layer11_expert10_down -->
<g id="node856" class="node">
<title>layer11_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8722,-7154 8339,-7154 8339,-7086 8722,-7086 8722,-7154"/>
<text text-anchor="middle" x="8530.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8530.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8530.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8530.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_expert10_act&#45;&gt;layer11_expert10_down -->
<g id="edge1216" class="edge">
<title>layer11_expert10_act&#45;&gt;layer11_expert10_down</title>
<path fill="none" stroke="black" d="M8745.25,-7189.88C8712.65,-7179.43 8676.47,-7167.82 8643.25,-7157.16"/>
<polygon fill="black" stroke="black" points="8644.09,-7153.76 8633.5,-7154.04 8641.95,-7160.42 8644.09,-7153.76"/>
</g>
<!-- layer11_expert10_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1217" class="edge">
<title>layer11_expert10_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M8338.85,-7102.12C8113.46,-7082.27 7731.98,-7048.66 7431.54,-7022.2"/>
<polygon fill="black" stroke="black" points="7431.61,-7018.69 7421.34,-7021.3 7430.99,-7025.67 7431.61,-7018.69"/>
</g>
<!-- layer11_expert11_act -->
<g id="node859" class="node">
<title>layer11_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9872,-7258 9477,-7258 9477,-7190 9872,-7190 9872,-7258"/>
<text text-anchor="middle" x="9674.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9674.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9674.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9674.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_expert11_gate&#45;&gt;layer11_expert11_act -->
<g id="edge1220" class="edge">
<title>layer11_expert11_gate&#45;&gt;layer11_expert11_act</title>
<path fill="none" stroke="black" d="M9674.5,-7293.88C9674.5,-7285.78 9674.5,-7276.98 9674.5,-7268.47"/>
<polygon fill="black" stroke="black" points="9678,-7268.3 9674.5,-7258.3 9671,-7268.3 9678,-7268.3"/>
</g>
<!-- layer11_expert11_up&#45;&gt;layer11_expert11_act -->
<g id="edge1221" class="edge">
<title>layer11_expert11_up&#45;&gt;layer11_expert11_act</title>
<path fill="none" stroke="black" d="M9953.7,-7293.95C9910.44,-7283.27 9862.3,-7271.38 9818.34,-7260.53"/>
<polygon fill="black" stroke="black" points="9818.99,-7257.08 9808.44,-7258.08 9817.31,-7263.88 9818.99,-7257.08"/>
</g>
<!-- layer11_expert11_down -->
<g id="node860" class="node">
<title>layer11_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9496,-7154 9113,-7154 9113,-7086 9496,-7086 9496,-7154"/>
<text text-anchor="middle" x="9304.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9304.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9304.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9304.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_expert11_act&#45;&gt;layer11_expert11_down -->
<g id="edge1222" class="edge">
<title>layer11_expert11_act&#45;&gt;layer11_expert11_down</title>
<path fill="none" stroke="black" d="M9554.63,-7189.95C9516.2,-7179.36 9473.47,-7167.58 9434.36,-7156.8"/>
<polygon fill="black" stroke="black" points="9435.07,-7153.36 9424.5,-7154.08 9433.21,-7160.11 9435.07,-7153.36"/>
</g>
<!-- layer11_expert11_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1223" class="edge">
<title>layer11_expert11_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M9112.84,-7107.75C8741.82,-7085.99 7917.55,-7037.63 7411.2,-7007.92"/>
<polygon fill="black" stroke="black" points="7411.35,-7004.42 7401.17,-7007.33 7410.94,-7011.41 7411.35,-7004.42"/>
</g>
<!-- layer11_expert12_act -->
<g id="node863" class="node">
<title>layer11_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10698,-7258 10303,-7258 10303,-7190 10698,-7190 10698,-7258"/>
<text text-anchor="middle" x="10500.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10500.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10500.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10500.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_expert12_gate&#45;&gt;layer11_expert12_act -->
<g id="edge1226" class="edge">
<title>layer11_expert12_gate&#45;&gt;layer11_expert12_act</title>
<path fill="none" stroke="black" d="M10500.5,-7293.88C10500.5,-7285.78 10500.5,-7276.98 10500.5,-7268.47"/>
<polygon fill="black" stroke="black" points="10504,-7268.3 10500.5,-7258.3 10497,-7268.3 10504,-7268.3"/>
</g>
<!-- layer11_expert12_up&#45;&gt;layer11_expert12_act -->
<g id="edge1227" class="edge">
<title>layer11_expert12_up&#45;&gt;layer11_expert12_act</title>
<path fill="none" stroke="black" d="M10779.7,-7293.95C10736.44,-7283.27 10688.3,-7271.38 10644.34,-7260.53"/>
<polygon fill="black" stroke="black" points="10644.99,-7257.08 10634.44,-7258.08 10643.31,-7263.88 10644.99,-7257.08"/>
</g>
<!-- layer11_expert12_down -->
<g id="node864" class="node">
<title>layer11_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10296,-7154 9913,-7154 9913,-7086 10296,-7086 10296,-7154"/>
<text text-anchor="middle" x="10104.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10104.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10104.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10104.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_expert12_act&#45;&gt;layer11_expert12_down -->
<g id="edge1228" class="edge">
<title>layer11_expert12_act&#45;&gt;layer11_expert12_down</title>
<path fill="none" stroke="black" d="M10372.2,-7189.95C10330.81,-7179.29 10284.76,-7167.43 10242.69,-7156.59"/>
<polygon fill="black" stroke="black" points="10243.49,-7153.19 10232.93,-7154.08 10241.74,-7159.96 10243.49,-7153.19"/>
</g>
<!-- layer11_expert12_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1229" class="edge">
<title>layer11_expert12_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M9912.67,-7107.74C9795.15,-7101.01 9641.65,-7092.53 9505.5,-7086 8762.75,-7050.36 7896.41,-7016.66 7397.65,-6998.02"/>
<polygon fill="black" stroke="black" points="7397.53,-6994.52 7387.41,-6997.64 7397.27,-7001.51 7397.53,-6994.52"/>
</g>
<!-- layer11_expert13_act -->
<g id="node867" class="node">
<title>layer11_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11524,-7258 11129,-7258 11129,-7190 11524,-7190 11524,-7258"/>
<text text-anchor="middle" x="11326.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11326.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11326.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11326.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_expert13_gate&#45;&gt;layer11_expert13_act -->
<g id="edge1232" class="edge">
<title>layer11_expert13_gate&#45;&gt;layer11_expert13_act</title>
<path fill="none" stroke="black" d="M11326.5,-7293.88C11326.5,-7285.78 11326.5,-7276.98 11326.5,-7268.47"/>
<polygon fill="black" stroke="black" points="11330,-7268.3 11326.5,-7258.3 11323,-7268.3 11330,-7268.3"/>
</g>
<!-- layer11_expert13_up&#45;&gt;layer11_expert13_act -->
<g id="edge1233" class="edge">
<title>layer11_expert13_up&#45;&gt;layer11_expert13_act</title>
<path fill="none" stroke="black" d="M11605.7,-7293.95C11562.44,-7283.27 11514.3,-7271.38 11470.34,-7260.53"/>
<polygon fill="black" stroke="black" points="11470.99,-7257.08 11460.44,-7258.08 11469.31,-7263.88 11470.99,-7257.08"/>
</g>
<!-- layer11_expert13_down -->
<g id="node868" class="node">
<title>layer11_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11109,-7154 10726,-7154 10726,-7086 11109,-7086 11109,-7154"/>
<text text-anchor="middle" x="10917.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10917.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10917.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10917.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_expert13_act&#45;&gt;layer11_expert13_down -->
<g id="edge1234" class="edge">
<title>layer11_expert13_act&#45;&gt;layer11_expert13_down</title>
<path fill="none" stroke="black" d="M11193.99,-7189.95C11151.15,-7179.27 11103.48,-7167.38 11059.95,-7156.53"/>
<polygon fill="black" stroke="black" points="11060.7,-7153.1 11050.15,-7154.08 11059,-7159.9 11060.7,-7153.1"/>
</g>
<!-- layer11_expert13_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1235" class="edge">
<title>layer11_expert13_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M10725.98,-7107.55C10605.35,-7100.61 10446.36,-7091.98 10305.5,-7086 9254.09,-7041.34 8014.53,-7008 7389.76,-6992.54"/>
<polygon fill="black" stroke="black" points="7389.78,-6989.04 7379.69,-6992.3 7389.6,-6996.04 7389.78,-6989.04"/>
</g>
<!-- layer11_expert14_act -->
<g id="node871" class="node">
<title>layer11_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12350,-7258 11955,-7258 11955,-7190 12350,-7190 12350,-7258"/>
<text text-anchor="middle" x="12152.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12152.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12152.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12152.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_expert14_gate&#45;&gt;layer11_expert14_act -->
<g id="edge1238" class="edge">
<title>layer11_expert14_gate&#45;&gt;layer11_expert14_act</title>
<path fill="none" stroke="black" d="M12152.5,-7293.88C12152.5,-7285.78 12152.5,-7276.98 12152.5,-7268.47"/>
<polygon fill="black" stroke="black" points="12156,-7268.3 12152.5,-7258.3 12149,-7268.3 12156,-7268.3"/>
</g>
<!-- layer11_expert14_up&#45;&gt;layer11_expert14_act -->
<g id="edge1239" class="edge">
<title>layer11_expert14_up&#45;&gt;layer11_expert14_act</title>
<path fill="none" stroke="black" d="M12431.7,-7293.95C12388.44,-7283.27 12340.3,-7271.38 12296.34,-7260.53"/>
<polygon fill="black" stroke="black" points="12296.99,-7257.08 12286.44,-7258.08 12295.31,-7263.88 12296.99,-7257.08"/>
</g>
<!-- layer11_expert14_down -->
<g id="node872" class="node">
<title>layer11_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11928,-7154 11545,-7154 11545,-7086 11928,-7086 11928,-7154"/>
<text text-anchor="middle" x="11736.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11736.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11736.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11736.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_expert14_act&#45;&gt;layer11_expert14_down -->
<g id="edge1240" class="edge">
<title>layer11_expert14_act&#45;&gt;layer11_expert14_down</title>
<path fill="none" stroke="black" d="M12017.72,-7189.95C11974.15,-7179.27 11925.66,-7167.38 11881.39,-7156.53"/>
<polygon fill="black" stroke="black" points="11881.96,-7153.06 11871.42,-7154.08 11880.3,-7159.86 11881.96,-7153.06"/>
</g>
<!-- layer11_expert14_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1241" class="edge">
<title>layer11_expert14_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M11544.83,-7107.36C11422.82,-7100.3 11261.43,-7091.6 11118.5,-7086 9748.85,-7032.37 8122.66,-7001.43 7385.32,-6989.17"/>
<polygon fill="black" stroke="black" points="7385.12,-6985.67 7375.07,-6989 7385.01,-6992.67 7385.12,-6985.67"/>
</g>
<!-- layer11_expert15_act -->
<g id="node875" class="node">
<title>layer11_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13176,-7258 12781,-7258 12781,-7190 13176,-7190 13176,-7258"/>
<text text-anchor="middle" x="12978.5" y="-7242.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12978.5" y="-7227.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12978.5" y="-7212.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12978.5" y="-7197.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_expert15_gate&#45;&gt;layer11_expert15_act -->
<g id="edge1244" class="edge">
<title>layer11_expert15_gate&#45;&gt;layer11_expert15_act</title>
<path fill="none" stroke="black" d="M12978.5,-7293.88C12978.5,-7285.78 12978.5,-7276.98 12978.5,-7268.47"/>
<polygon fill="black" stroke="black" points="12982,-7268.3 12978.5,-7258.3 12975,-7268.3 12982,-7268.3"/>
</g>
<!-- layer11_expert15_up&#45;&gt;layer11_expert15_act -->
<g id="edge1245" class="edge">
<title>layer11_expert15_up&#45;&gt;layer11_expert15_act</title>
<path fill="none" stroke="black" d="M13257.7,-7293.95C13214.44,-7283.27 13166.3,-7271.38 13122.34,-7260.53"/>
<polygon fill="black" stroke="black" points="13122.99,-7257.08 13112.44,-7258.08 13121.31,-7263.88 13122.99,-7257.08"/>
</g>
<!-- layer11_expert15_down -->
<g id="node876" class="node">
<title>layer11_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12751,-7154 12368,-7154 12368,-7086 12751,-7086 12751,-7154"/>
<text text-anchor="middle" x="12559.5" y="-7138.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12559.5" y="-7123.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12559.5" y="-7108.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12559.5" y="-7093.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_expert15_act&#45;&gt;layer11_expert15_down -->
<g id="edge1246" class="edge">
<title>layer11_expert15_act&#45;&gt;layer11_expert15_down</title>
<path fill="none" stroke="black" d="M12842.75,-7189.95C12798.77,-7179.25 12749.82,-7167.33 12705.15,-7156.46"/>
<polygon fill="black" stroke="black" points="12705.93,-7153.05 12695.39,-7154.08 12704.28,-7159.85 12705.93,-7153.05"/>
</g>
<!-- layer11_expert15_down&#45;&gt;layer11_token_aggregation -->
<g id="edge1247" class="edge">
<title>layer11_expert15_down&#45;&gt;layer11_token_aggregation</title>
<path fill="none" stroke="black" d="M12367.98,-7107.24C12245.02,-7100.09 12081.9,-7091.33 11937.5,-7086 10243.24,-7023.45 8221.33,-6996.15 7381.93,-6986.91"/>
<polygon fill="black" stroke="black" points="7381.84,-6983.4 7371.8,-6986.79 7381.76,-6990.4 7381.84,-6983.4"/>
</g>
<!-- layer11_res2 -->
<g id="node878" class="node">
<title>layer11_res2</title>
<polygon fill="none" stroke="black" points="7427.24,-6878 6726.12,-6878 6545.76,-6712 7246.88,-6712 7427.24,-6878"/>
<text text-anchor="middle" x="6986.5" y="-6821.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6986.5" y="-6806.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6791.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6776.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6761.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_token_aggregation&#45;&gt;layer11_res2 -->
<g id="edge1248" class="edge">
<title>layer11_token_aggregation&#45;&gt;layer11_res2</title>
<path fill="none" stroke="black" d="M6986.5,-6913.95C6986.5,-6905.63 6986.5,-6897 6986.5,-6888.38"/>
<polygon fill="black" stroke="black" points="6990,-6888.28 6986.5,-6878.28 6983,-6888.28 6990,-6888.28"/>
</g>
<!-- layer12_mha_qkv -->
<g id="node879" class="node">
<title>layer12_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7222.5,-6676 6750.5,-6676 6750.5,-6608 7222.5,-6608 7222.5,-6676"/>
<text text-anchor="middle" x="6986.5" y="-6660.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6986.5" y="-6645.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6630.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6986.5" y="-6615.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_res2&#45;&gt;layer12_mha_qkv -->
<g id="edge1249" class="edge">
<title>layer11_res2&#45;&gt;layer12_mha_qkv</title>
<path fill="none" stroke="black" d="M6986.5,-6711.87C6986.5,-6703.12 6986.5,-6694.48 6986.5,-6686.45"/>
<polygon fill="black" stroke="black" points="6990,-6686.26 6986.5,-6676.26 6983,-6686.26 6990,-6686.26"/>
</g>
<!-- layer12_mha_attn -->
<g id="node880" class="node">
<title>layer12_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7216.5,-6572 6756.5,-6572 6756.5,-6504 7216.5,-6504 7216.5,-6572"/>
<text text-anchor="middle" x="6986.5" y="-6556.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6986.5" y="-6541.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6986.5" y="-6526.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6511.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_mha_qkv&#45;&gt;layer12_mha_attn -->
<g id="edge1250" class="edge">
<title>layer12_mha_qkv&#45;&gt;layer12_mha_attn</title>
<path fill="none" stroke="black" d="M6986.5,-6607.88C6986.5,-6599.78 6986.5,-6590.98 6986.5,-6582.47"/>
<polygon fill="black" stroke="black" points="6990,-6582.3 6986.5,-6572.3 6983,-6582.3 6990,-6582.3"/>
</g>
<!-- layer12_mha_out -->
<g id="node881" class="node">
<title>layer12_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7199,-6468 6774,-6468 6774,-6400 7199,-6400 7199,-6468"/>
<text text-anchor="middle" x="6986.5" y="-6452.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6986.5" y="-6437.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6422.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6407.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_mha_attn&#45;&gt;layer12_mha_out -->
<g id="edge1251" class="edge">
<title>layer12_mha_attn&#45;&gt;layer12_mha_out</title>
<path fill="none" stroke="black" d="M6986.5,-6503.88C6986.5,-6495.78 6986.5,-6486.98 6986.5,-6478.47"/>
<polygon fill="black" stroke="black" points="6990,-6478.3 6986.5,-6468.3 6983,-6478.3 6990,-6478.3"/>
</g>
<!-- layer12_res1 -->
<g id="node882" class="node">
<title>layer12_res1</title>
<polygon fill="none" stroke="black" points="7427.24,-6364 6726.12,-6364 6545.76,-6198 7246.88,-6198 7427.24,-6364"/>
<text text-anchor="middle" x="6986.5" y="-6307.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6986.5" y="-6292.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6277.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6262.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6247.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_mha_out&#45;&gt;layer12_res1 -->
<g id="edge1252" class="edge">
<title>layer12_mha_out&#45;&gt;layer12_res1</title>
<path fill="none" stroke="black" d="M6986.5,-6399.86C6986.5,-6392.1 6986.5,-6383.46 6986.5,-6374.48"/>
<polygon fill="black" stroke="black" points="6990,-6374.23 6986.5,-6364.23 6983,-6374.23 6990,-6374.23"/>
</g>
<!-- layer12_ln1 -->
<g id="node883" class="node">
<title>layer12_ln1</title>
<polygon fill="yellow" stroke="black" points="7199,-6162 6774,-6162 6774,-6094 7199,-6094 7199,-6162"/>
<text text-anchor="middle" x="6986.5" y="-6146.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6986.5" y="-6131.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6116.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-6101.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_res1&#45;&gt;layer12_ln1 -->
<g id="edge1253" class="edge">
<title>layer12_res1&#45;&gt;layer12_ln1</title>
<path fill="none" stroke="black" d="M6986.5,-6197.87C6986.5,-6189.12 6986.5,-6180.48 6986.5,-6172.45"/>
<polygon fill="black" stroke="black" points="6990,-6172.26 6986.5,-6162.26 6983,-6172.26 6990,-6172.26"/>
</g>
<!-- layer12_expert_routing -->
<g id="node884" class="node">
<title>layer12_expert_routing</title>
<polygon fill="orange" stroke="black" points="6986.5,-6058 6570.5,-5975 6986.5,-5892 7402.5,-5975 6986.5,-6058"/>
<text text-anchor="middle" x="6986.5" y="-6001.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6986.5" y="-5986.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6986.5" y="-5971.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-5956.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6986.5" y="-5941.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_ln1&#45;&gt;layer12_expert_routing -->
<g id="edge1254" class="edge">
<title>layer12_ln1&#45;&gt;layer12_expert_routing</title>
<path fill="none" stroke="black" d="M6986.5,-6093.86C6986.5,-6086.1 6986.5,-6077.46 6986.5,-6068.48"/>
<polygon fill="black" stroke="black" points="6990,-6068.23 6986.5,-6058.23 6983,-6068.23 6990,-6068.23"/>
</g>
<!-- layer12_token_distribution -->
<g id="node885" class="node">
<title>layer12_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7414.86,-5856 6733.44,-5856 6558.14,-5720 7239.56,-5720 7414.86,-5856"/>
<text text-anchor="middle" x="6986.5" y="-5806.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6986.5" y="-5791.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6986.5" y="-5776.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6986.5" y="-5761.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer12_expert_routing&#45;&gt;layer12_token_distribution -->
<g id="edge1255" class="edge">
<title>layer12_expert_routing&#45;&gt;layer12_token_distribution</title>
<path fill="none" stroke="black" d="M6986.5,-5891.78C6986.5,-5883.34 6986.5,-5874.79 6986.5,-5866.4"/>
<polygon fill="black" stroke="black" points="6990,-5866.28 6986.5,-5856.28 6983,-5866.28 6990,-5866.28"/>
</g>
<!-- layer12_expert0_gate -->
<g id="node886" class="node">
<title>layer12_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="783,-5684 388,-5684 388,-5616 783,-5616 783,-5684"/>
<text text-anchor="middle" x="585.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="585.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="585.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="585.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert0_gate -->
<g id="edge1256" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6645.42,-5787.72C5524.99,-5789.09 1963.01,-5785.23 793.31,-5684.11"/>
<polygon fill="black" stroke="black" points="793.32,-5680.6 783.06,-5683.22 792.71,-5687.57 793.32,-5680.6"/>
</g>
<!-- layer12_expert0_up -->
<g id="node887" class="node">
<title>layer12_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1196,-5684 801,-5684 801,-5616 1196,-5616 1196,-5684"/>
<text text-anchor="middle" x="998.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="998.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="998.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="998.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert0_up -->
<g id="edge1257" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.42,-5787.24C5573.28,-5787 2291.27,-5778.44 1206.35,-5684.12"/>
<polygon fill="black" stroke="black" points="1206.32,-5680.6 1196.06,-5683.21 1205.71,-5687.57 1206.32,-5680.6"/>
</g>
<!-- layer12_expert1_gate -->
<g id="node890" class="node">
<title>layer12_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1609,-5684 1214,-5684 1214,-5616 1609,-5616 1609,-5684"/>
<text text-anchor="middle" x="1411.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1411.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1411.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1411.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert1_gate -->
<g id="edge1262" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6643.86,-5786.69C5624.38,-5784.77 2619.69,-5771.69 1619.28,-5684.11"/>
<polygon fill="black" stroke="black" points="1619.33,-5680.6 1609.06,-5683.21 1618.71,-5687.57 1619.33,-5680.6"/>
</g>
<!-- layer12_expert1_up -->
<g id="node891" class="node">
<title>layer12_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2022,-5684 1627,-5684 1627,-5616 2022,-5616 2022,-5684"/>
<text text-anchor="middle" x="1824.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1824.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1824.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1824.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert1_up -->
<g id="edge1263" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6642.92,-5786.04C5676.86,-5782.35 2948.03,-5764.95 2032.08,-5684.09"/>
<polygon fill="black" stroke="black" points="2032.33,-5680.6 2022.06,-5683.2 2031.71,-5687.58 2032.33,-5680.6"/>
</g>
<!-- layer12_expert2_gate -->
<g id="node894" class="node">
<title>layer12_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2435,-5684 2040,-5684 2040,-5616 2435,-5616 2435,-5684"/>
<text text-anchor="middle" x="2237.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2237.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2237.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2237.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert2_gate -->
<g id="edge1268" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6641.93,-5785.27C5731.78,-5779.72 3277.04,-5758.22 2445.07,-5684.1"/>
<polygon fill="black" stroke="black" points="2445.33,-5680.6 2435.06,-5683.19 2444.7,-5687.58 2445.33,-5680.6"/>
</g>
<!-- layer12_expert2_up -->
<g id="node895" class="node">
<title>layer12_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2848,-5684 2453,-5684 2453,-5616 2848,-5616 2848,-5684"/>
<text text-anchor="middle" x="2650.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2650.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2650.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2650.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert2_up -->
<g id="edge1269" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6640.99,-5784.34C5789.65,-5776.84 3606.62,-5751.52 2858.16,-5684.1"/>
<polygon fill="black" stroke="black" points="2858.34,-5680.61 2848.06,-5683.18 2857.7,-5687.58 2858.34,-5680.61"/>
</g>
<!-- layer12_expert3_gate -->
<g id="node898" class="node">
<title>layer12_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3261,-5684 2866,-5684 2866,-5616 3261,-5616 3261,-5684"/>
<text text-anchor="middle" x="3063.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3063.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3063.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3063.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert3_gate -->
<g id="edge1274" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6639.41,-5783.2C5849.73,-5773.62 3936.42,-5744.84 3271.24,-5684.11"/>
<polygon fill="black" stroke="black" points="3271.34,-5680.61 3261.06,-5683.17 3270.7,-5687.58 3271.34,-5680.61"/>
</g>
<!-- layer12_expert3_up -->
<g id="node899" class="node">
<title>layer12_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3674,-5684 3279,-5684 3279,-5616 3674,-5616 3674,-5684"/>
<text text-anchor="middle" x="3476.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3476.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3476.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3476.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert3_up -->
<g id="edge1275" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6637.52,-5781.77C5913.21,-5769.98 4266.46,-5738.17 3684.25,-5684.12"/>
<polygon fill="black" stroke="black" points="3684.35,-5680.61 3674.06,-5683.16 3683.69,-5687.58 3684.35,-5680.61"/>
</g>
<!-- layer12_expert4_gate -->
<g id="node902" class="node">
<title>layer12_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4087,-5684 3692,-5684 3692,-5616 4087,-5616 4087,-5684"/>
<text text-anchor="middle" x="3889.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3889.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3889.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3889.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert4_gate -->
<g id="edge1280" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6635.06,-5779.9C5980.59,-5765.8 4596.94,-5731.52 4097.26,-5684.12"/>
<polygon fill="black" stroke="black" points="4097.35,-5680.62 4087.06,-5683.14 4096.68,-5687.58 4097.35,-5680.62"/>
</g>
<!-- layer12_expert4_up -->
<g id="node903" class="node">
<title>layer12_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4500,-5684 4105,-5684 4105,-5616 4500,-5616 4500,-5684"/>
<text text-anchor="middle" x="4302.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4302.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4302.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4302.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert4_up -->
<g id="edge1281" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6642.37,-5785.42C6165.11,-5780.35 5275.47,-5760.49 4510.19,-5684.13"/>
<polygon fill="black" stroke="black" points="4510.36,-5680.63 4500.07,-5683.12 4509.67,-5687.6 4510.36,-5680.63"/>
</g>
<!-- layer12_expert5_gate -->
<g id="node906" class="node">
<title>layer12_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4913,-5684 4518,-5684 4518,-5616 4913,-5616 4913,-5684"/>
<text text-anchor="middle" x="4715.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4715.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4715.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4715.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert5_gate -->
<g id="edge1286" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6636.68,-5781.16C6227.56,-5771.67 5530.04,-5747.18 4923.34,-5684.16"/>
<polygon fill="black" stroke="black" points="4923.38,-5680.64 4913.07,-5683.09 4922.65,-5687.61 4923.38,-5680.64"/>
</g>
<!-- layer12_expert5_up -->
<g id="node907" class="node">
<title>layer12_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5326,-5684 4931,-5684 4931,-5616 5326,-5616 5326,-5684"/>
<text text-anchor="middle" x="5128.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5128.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5128.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5128.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert5_up -->
<g id="edge1287" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6628.34,-5774.65C6295.6,-5760.84 5786.32,-5733.72 5336.03,-5684.14"/>
<polygon fill="black" stroke="black" points="5336.4,-5680.66 5326.07,-5683.04 5335.63,-5687.62 5336.4,-5680.66"/>
</g>
<!-- layer12_expert6_gate -->
<g id="node910" class="node">
<title>layer12_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5739,-5684 5344,-5684 5344,-5616 5739,-5616 5739,-5684"/>
<text text-anchor="middle" x="5541.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5541.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5541.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5541.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert6_gate -->
<g id="edge1292" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6614.03,-5763.44C6370.4,-5746.23 6045.1,-5719.86 5749.16,-5684.18"/>
<polygon fill="black" stroke="black" points="5749.43,-5680.68 5739.08,-5682.96 5748.59,-5687.63 5749.43,-5680.68"/>
</g>
<!-- layer12_expert6_up -->
<g id="node911" class="node">
<title>layer12_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6152,-5684 5757,-5684 5757,-5616 6152,-5616 6152,-5684"/>
<text text-anchor="middle" x="5954.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5954.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5954.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5954.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert6_up -->
<g id="edge1293" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6583.33,-5739.57C6451.89,-5723.37 6305.08,-5704.49 6162.37,-5684.25"/>
<polygon fill="black" stroke="black" points="6162.5,-5680.74 6152.11,-5682.79 6161.51,-5687.67 6162.5,-5680.74"/>
</g>
<!-- layer12_expert7_gate -->
<g id="node914" class="node">
<title>layer12_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6565,-5684 6170,-5684 6170,-5616 6565,-5616 6565,-5684"/>
<text text-anchor="middle" x="6367.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6367.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6367.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6367.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert7_gate -->
<g id="edge1298" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6681.53,-5720C6628.4,-5708.32 6575.09,-5696.61 6527.86,-5686.23"/>
<polygon fill="black" stroke="black" points="6528.4,-5682.77 6517.88,-5684.04 6526.89,-5689.6 6528.4,-5682.77"/>
</g>
<!-- layer12_expert7_up -->
<g id="node915" class="node">
<title>layer12_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6978,-5684 6583,-5684 6583,-5616 6978,-5616 6978,-5684"/>
<text text-anchor="middle" x="6780.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6780.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6780.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6780.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert7_up -->
<g id="edge1299" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6885.01,-5720C6869.37,-5709.67 6853.68,-5699.31 6839.38,-5689.87"/>
<polygon fill="black" stroke="black" points="6840.95,-5686.72 6830.68,-5684.13 6837.1,-5692.56 6840.95,-5686.72"/>
</g>
<!-- layer12_expert8_gate -->
<g id="node918" class="node">
<title>layer12_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7391,-5684 6996,-5684 6996,-5616 7391,-5616 7391,-5684"/>
<text text-anchor="middle" x="7193.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7193.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7193.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7193.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert8_gate -->
<g id="edge1304" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7088.48,-5720C7104.2,-5709.67 7119.97,-5699.31 7134.33,-5689.87"/>
<polygon fill="black" stroke="black" points="7136.64,-5692.54 7143.08,-5684.13 7132.8,-5686.69 7136.64,-5692.54"/>
</g>
<!-- layer12_expert8_up -->
<g id="node919" class="node">
<title>layer12_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7804,-5684 7409,-5684 7409,-5616 7804,-5616 7804,-5684"/>
<text text-anchor="middle" x="7606.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7606.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7606.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7606.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert8_up -->
<g id="edge1305" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7251.23,-5728.93C7317.49,-5714.4 7386.56,-5699.25 7445.99,-5686.21"/>
<polygon fill="black" stroke="black" points="7446.81,-5689.61 7455.82,-5684.05 7445.31,-5682.78 7446.81,-5689.61"/>
</g>
<!-- layer12_expert9_gate -->
<g id="node922" class="node">
<title>layer12_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8217,-5684 7822,-5684 7822,-5616 8217,-5616 8217,-5684"/>
<text text-anchor="middle" x="8019.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8019.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8019.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8019.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert9_gate -->
<g id="edge1310" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7282.03,-5752.73C7437.07,-5734.13 7630.37,-5709.94 7811.89,-5684.22"/>
<polygon fill="black" stroke="black" points="7812.49,-5687.67 7821.89,-5682.8 7811.5,-5680.74 7812.49,-5687.67"/>
</g>
<!-- layer12_expert9_up -->
<g id="node923" class="node">
<title>layer12_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8630,-5684 8235,-5684 8235,-5616 8630,-5616 8630,-5684"/>
<text text-anchor="middle" x="8432.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8432.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8432.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8432.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert9_up -->
<g id="edge1311" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7300.91,-5767.51C7549.39,-5750.52 7905.09,-5722.72 8224.99,-5684.16"/>
<polygon fill="black" stroke="black" points="8225.41,-5687.63 8234.92,-5682.96 8224.57,-5680.68 8225.41,-5687.63"/>
</g>
<!-- layer12_expert10_gate -->
<g id="node926" class="node">
<title>layer12_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9043,-5684 8648,-5684 8648,-5616 9043,-5616 9043,-5684"/>
<text text-anchor="middle" x="8845.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8845.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8845.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8845.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert10_gate -->
<g id="edge1316" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7311.93,-5776.01C7643.51,-5762.65 8172.55,-5735.38 8637.98,-5684.14"/>
<polygon fill="black" stroke="black" points="8638.37,-5687.62 8647.93,-5683.04 8637.6,-5680.66 8638.37,-5687.62"/>
</g>
<!-- layer12_expert10_up -->
<g id="node927" class="node">
<title>layer12_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9456,-5684 9061,-5684 9061,-5616 9456,-5616 9456,-5684"/>
<text text-anchor="middle" x="9258.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9258.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9258.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9258.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert10_up -->
<g id="edge1317" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7319.24,-5781.57C7726.05,-5772.37 8435.4,-5748.08 9050.97,-5684.13"/>
<polygon fill="black" stroke="black" points="9051.35,-5687.61 9060.93,-5683.09 9050.62,-5680.64 9051.35,-5687.61"/>
</g>
<!-- layer12_expert11_gate -->
<g id="node930" class="node">
<title>layer12_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9869,-5684 9474,-5684 9474,-5616 9869,-5616 9869,-5684"/>
<text text-anchor="middle" x="9671.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9671.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9671.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9671.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert11_gate -->
<g id="edge1322" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7324.2,-5785.5C7800.01,-5780.55 8694.7,-5760.86 9463.76,-5684.14"/>
<polygon fill="black" stroke="black" points="9464.33,-5687.6 9473.93,-5683.12 9463.64,-5680.63 9464.33,-5687.6"/>
</g>
<!-- layer12_expert11_up -->
<g id="node931" class="node">
<title>layer12_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10282,-5684 9887,-5684 9887,-5616 10282,-5616 10282,-5684"/>
<text text-anchor="middle" x="10084.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10084.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10084.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10084.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert11_up -->
<g id="edge1323" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7317.5,-5780.35C7963.28,-5766.53 9371.47,-5732.03 9876.63,-5684.13"/>
<polygon fill="black" stroke="black" points="9877.32,-5687.58 9886.94,-5683.14 9876.65,-5680.62 9877.32,-5687.58"/>
</g>
<!-- layer12_expert12_gate -->
<g id="node934" class="node">
<title>layer12_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10695,-5684 10300,-5684 10300,-5616 10695,-5616 10695,-5684"/>
<text text-anchor="middle" x="10497.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10497.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10497.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10497.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert12_gate -->
<g id="edge1328" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7319.83,-5782.02C8035.92,-5770.46 9703.02,-5738.58 10289.68,-5684.13"/>
<polygon fill="black" stroke="black" points="10290.31,-5687.58 10299.94,-5683.16 10289.65,-5680.61 10290.31,-5687.58"/>
</g>
<!-- layer12_expert12_up -->
<g id="node935" class="node">
<title>layer12_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11108,-5684 10713,-5684 10713,-5616 11108,-5616 11108,-5684"/>
<text text-anchor="middle" x="10910.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10910.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10910.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10910.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert12_up -->
<g id="edge1329" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.57,-5783.35C8103.82,-5773.92 10033.91,-5745.16 10702.7,-5684.12"/>
<polygon fill="black" stroke="black" points="10703.3,-5687.58 10712.94,-5683.17 10702.66,-5680.61 10703.3,-5687.58"/>
</g>
<!-- layer12_expert13_gate -->
<g id="node938" class="node">
<title>layer12_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11521,-5684 11126,-5684 11126,-5616 11521,-5616 11521,-5684"/>
<text text-anchor="middle" x="11323.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11323.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11323.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11323.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert13_gate -->
<g id="edge1334" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7322.74,-5784.43C8167.52,-5777.03 10364.4,-5751.78 11115.8,-5684.11"/>
<polygon fill="black" stroke="black" points="11116.3,-5687.58 11125.94,-5683.18 11115.66,-5680.61 11116.3,-5687.58"/>
</g>
<!-- layer12_expert13_up -->
<g id="node939" class="node">
<title>layer12_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11934,-5684 11539,-5684 11539,-5616 11934,-5616 11934,-5684"/>
<text text-anchor="middle" x="11736.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11736.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11736.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11736.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert13_up -->
<g id="edge1335" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7324.14,-5785.31C8228.83,-5779.84 10694.6,-5758.43 11528.9,-5684.1"/>
<polygon fill="black" stroke="black" points="11529.3,-5687.58 11538.94,-5683.19 11528.67,-5680.6 11529.3,-5687.58"/>
</g>
<!-- layer12_expert14_gate -->
<g id="node942" class="node">
<title>layer12_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12347,-5684 11952,-5684 11952,-5616 12347,-5616 12347,-5684"/>
<text text-anchor="middle" x="12149.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12149.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12149.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12149.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert14_gate -->
<g id="edge1340" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7324.95,-5786.06C8286.58,-5782.42 11024.12,-5765.11 11941.9,-5684.1"/>
<polygon fill="black" stroke="black" points="11942.29,-5687.58 11951.94,-5683.2 11941.67,-5680.6 11942.29,-5687.58"/>
</g>
<!-- layer12_expert14_up -->
<g id="node943" class="node">
<title>layer12_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12760,-5684 12365,-5684 12365,-5616 12760,-5616 12760,-5684"/>
<text text-anchor="middle" x="12562.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12562.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12562.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12562.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert14_up -->
<g id="edge1341" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7325.58,-5786.7C8341.74,-5784.8 11352.92,-5771.81 12354.71,-5684.11"/>
<polygon fill="black" stroke="black" points="12355.29,-5687.57 12364.94,-5683.21 12354.67,-5680.6 12355.29,-5687.57"/>
</g>
<!-- layer12_expert15_gate -->
<g id="node946" class="node">
<title>layer12_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13173,-5684 12778,-5684 12778,-5616 13173,-5616 13173,-5684"/>
<text text-anchor="middle" x="12975.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12975.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12975.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12975.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert15_gate -->
<g id="edge1346" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7326.27,-5787.24C8395.13,-5787.02 11681.73,-5778.53 12767.64,-5684.12"/>
<polygon fill="black" stroke="black" points="12768.29,-5687.57 12777.94,-5683.21 12767.68,-5680.6 12768.29,-5687.57"/>
</g>
<!-- layer12_expert15_up -->
<g id="node947" class="node">
<title>layer12_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13586,-5684 13191,-5684 13191,-5616 13586,-5616 13586,-5684"/>
<text text-anchor="middle" x="13388.5" y="-5668.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13388.5" y="-5653.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13388.5" y="-5638.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13388.5" y="-5623.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_token_distribution&#45;&gt;layer12_expert15_up -->
<g id="edge1347" class="edge">
<title>layer12_token_distribution&#45;&gt;layer12_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7327.15,-5787.72C8447.21,-5789.1 12010.63,-5785.26 13180.69,-5684.11"/>
<polygon fill="black" stroke="black" points="13181.29,-5687.57 13190.94,-5683.22 13180.68,-5680.6 13181.29,-5687.57"/>
</g>
<!-- layer12_expert0_act -->
<g id="node888" class="node">
<title>layer12_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1196,-5580 801,-5580 801,-5512 1196,-5512 1196,-5580"/>
<text text-anchor="middle" x="998.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="998.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="998.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="998.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer12_expert0_gate&#45;&gt;layer12_expert0_act -->
<g id="edge1258" class="edge">
<title>layer12_expert0_gate&#45;&gt;layer12_expert0_act</title>
<path fill="none" stroke="black" d="M719.3,-5615.95C762.56,-5605.27 810.7,-5593.38 854.66,-5582.53"/>
<polygon fill="black" stroke="black" points="855.69,-5585.88 864.56,-5580.08 854.01,-5579.08 855.69,-5585.88"/>
</g>
<!-- layer12_expert0_up&#45;&gt;layer12_expert0_act -->
<g id="edge1259" class="edge">
<title>layer12_expert0_up&#45;&gt;layer12_expert0_act</title>
<path fill="none" stroke="black" d="M998.5,-5615.88C998.5,-5607.78 998.5,-5598.98 998.5,-5590.47"/>
<polygon fill="black" stroke="black" points="1002,-5590.3 998.5,-5580.3 995,-5590.3 1002,-5590.3"/>
</g>
<!-- layer12_expert0_down -->
<g id="node889" class="node">
<title>layer12_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1402,-5476 1019,-5476 1019,-5408 1402,-5408 1402,-5476"/>
<text text-anchor="middle" x="1210.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1210.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1210.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1210.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer12_expert0_act&#45;&gt;layer12_expert0_down -->
<g id="edge1260" class="edge">
<title>layer12_expert0_act&#45;&gt;layer12_expert0_down</title>
<path fill="none" stroke="black" d="M1067.33,-5511.88C1088.17,-5501.86 1111.21,-5490.77 1132.6,-5480.48"/>
<polygon fill="black" stroke="black" points="1134.16,-5483.61 1141.65,-5476.12 1131.12,-5477.31 1134.16,-5483.61"/>
</g>
<!-- layer12_token_aggregation -->
<g id="node950" class="node">
<title>layer12_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7459.24,-5372 6702.44,-5372 6507.76,-5236 7264.56,-5236 7459.24,-5372"/>
<text text-anchor="middle" x="6983.5" y="-5322.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6983.5" y="-5307.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6983.5" y="-5292.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-5277.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_expert0_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1261" class="edge">
<title>layer12_expert0_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M1402.25,-5429.25C1525.88,-5422.07 1690.13,-5413.29 1835.5,-5408 3616.65,-5343.18 5746.04,-5316.85 6600.82,-5308.37"/>
<polygon fill="black" stroke="black" points="6601.16,-5311.87 6611.13,-5308.27 6601.09,-5304.87 6601.16,-5311.87"/>
</g>
<!-- layer12_expert1_act -->
<g id="node892" class="node">
<title>layer12_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2022,-5580 1627,-5580 1627,-5512 2022,-5512 2022,-5580"/>
<text text-anchor="middle" x="1824.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1824.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1824.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1824.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer12_expert1_gate&#45;&gt;layer12_expert1_act -->
<g id="edge1264" class="edge">
<title>layer12_expert1_gate&#45;&gt;layer12_expert1_act</title>
<path fill="none" stroke="black" d="M1545.3,-5615.95C1588.56,-5605.27 1636.7,-5593.38 1680.66,-5582.53"/>
<polygon fill="black" stroke="black" points="1681.69,-5585.88 1690.56,-5580.08 1680.01,-5579.08 1681.69,-5585.88"/>
</g>
<!-- layer12_expert1_up&#45;&gt;layer12_expert1_act -->
<g id="edge1265" class="edge">
<title>layer12_expert1_up&#45;&gt;layer12_expert1_act</title>
<path fill="none" stroke="black" d="M1824.5,-5615.88C1824.5,-5607.78 1824.5,-5598.98 1824.5,-5590.47"/>
<polygon fill="black" stroke="black" points="1828,-5590.3 1824.5,-5580.3 1821,-5590.3 1828,-5590.3"/>
</g>
<!-- layer12_expert1_down -->
<g id="node893" class="node">
<title>layer12_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2228,-5476 1845,-5476 1845,-5408 2228,-5408 2228,-5476"/>
<text text-anchor="middle" x="2036.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2036.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2036.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2036.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer12_expert1_act&#45;&gt;layer12_expert1_down -->
<g id="edge1266" class="edge">
<title>layer12_expert1_act&#45;&gt;layer12_expert1_down</title>
<path fill="none" stroke="black" d="M1893.33,-5511.88C1914.17,-5501.86 1937.21,-5490.77 1958.6,-5480.48"/>
<polygon fill="black" stroke="black" points="1960.16,-5483.61 1967.65,-5476.12 1957.12,-5477.31 1960.16,-5483.61"/>
</g>
<!-- layer12_expert1_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1267" class="edge">
<title>layer12_expert1_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M2228.34,-5431.27C2375.97,-5424.04 2585.11,-5414.37 2768.5,-5408 4183.85,-5358.81 5867.35,-5325.14 6605.29,-5311.63"/>
<polygon fill="black" stroke="black" points="6605.61,-5315.12 6615.54,-5311.44 6605.48,-5308.12 6605.61,-5315.12"/>
</g>
<!-- layer12_expert2_act -->
<g id="node896" class="node">
<title>layer12_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2848,-5580 2453,-5580 2453,-5512 2848,-5512 2848,-5580"/>
<text text-anchor="middle" x="2650.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2650.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2650.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2650.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer12_expert2_gate&#45;&gt;layer12_expert2_act -->
<g id="edge1270" class="edge">
<title>layer12_expert2_gate&#45;&gt;layer12_expert2_act</title>
<path fill="none" stroke="black" d="M2371.3,-5615.95C2414.56,-5605.27 2462.7,-5593.38 2506.66,-5582.53"/>
<polygon fill="black" stroke="black" points="2507.69,-5585.88 2516.56,-5580.08 2506.01,-5579.08 2507.69,-5585.88"/>
</g>
<!-- layer12_expert2_up&#45;&gt;layer12_expert2_act -->
<g id="edge1271" class="edge">
<title>layer12_expert2_up&#45;&gt;layer12_expert2_act</title>
<path fill="none" stroke="black" d="M2650.5,-5615.88C2650.5,-5607.78 2650.5,-5598.98 2650.5,-5590.47"/>
<polygon fill="black" stroke="black" points="2654,-5590.3 2650.5,-5580.3 2647,-5590.3 2654,-5590.3"/>
</g>
<!-- layer12_expert2_down -->
<g id="node897" class="node">
<title>layer12_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3161,-5476 2778,-5476 2778,-5408 3161,-5408 3161,-5476"/>
<text text-anchor="middle" x="2969.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2969.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2969.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2969.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer12_expert2_act&#45;&gt;layer12_expert2_down -->
<g id="edge1272" class="edge">
<title>layer12_expert2_act&#45;&gt;layer12_expert2_down</title>
<path fill="none" stroke="black" d="M2754.07,-5511.88C2786.77,-5501.43 2823.07,-5489.82 2856.4,-5479.16"/>
<polygon fill="black" stroke="black" points="2857.72,-5482.42 2866.18,-5476.04 2855.59,-5475.75 2857.72,-5482.42"/>
</g>
<!-- layer12_expert2_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1273" class="edge">
<title>layer12_expert2_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M3161.28,-5433.07C3331.12,-5426.14 3585.79,-5415.96 3807.5,-5408 4821.81,-5371.58 6018.56,-5334.31 6611.65,-5316.22"/>
<polygon fill="black" stroke="black" points="6612.19,-5319.71 6622.08,-5315.9 6611.98,-5312.71 6612.19,-5319.71"/>
</g>
<!-- layer12_expert3_act -->
<g id="node900" class="node">
<title>layer12_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3674,-5580 3279,-5580 3279,-5512 3674,-5512 3674,-5580"/>
<text text-anchor="middle" x="3476.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3476.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3476.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3476.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer12_expert3_gate&#45;&gt;layer12_expert3_act -->
<g id="edge1276" class="edge">
<title>layer12_expert3_gate&#45;&gt;layer12_expert3_act</title>
<path fill="none" stroke="black" d="M3197.3,-5615.95C3240.56,-5605.27 3288.7,-5593.38 3332.66,-5582.53"/>
<polygon fill="black" stroke="black" points="3333.69,-5585.88 3342.56,-5580.08 3332.01,-5579.08 3333.69,-5585.88"/>
</g>
<!-- layer12_expert3_up&#45;&gt;layer12_expert3_act -->
<g id="edge1277" class="edge">
<title>layer12_expert3_up&#45;&gt;layer12_expert3_act</title>
<path fill="none" stroke="black" d="M3476.5,-5615.88C3476.5,-5607.78 3476.5,-5598.98 3476.5,-5590.47"/>
<polygon fill="black" stroke="black" points="3480,-5590.3 3476.5,-5580.3 3473,-5590.3 3480,-5590.3"/>
</g>
<!-- layer12_expert3_down -->
<g id="node901" class="node">
<title>layer12_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="4200,-5476 3817,-5476 3817,-5408 4200,-5408 4200,-5476"/>
<text text-anchor="middle" x="4008.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="4008.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4008.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4008.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer12_expert3_act&#45;&gt;layer12_expert3_down -->
<g id="edge1278" class="edge">
<title>layer12_expert3_act&#45;&gt;layer12_expert3_down</title>
<path fill="none" stroke="black" d="M3648.86,-5511.95C3705.52,-5501.09 3768.68,-5488.98 3826.06,-5477.98"/>
<polygon fill="black" stroke="black" points="3826.8,-5481.4 3835.96,-5476.08 3825.48,-5474.53 3826.8,-5481.4"/>
</g>
<!-- layer12_expert3_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1279" class="edge">
<title>layer12_expert3_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M4200.19,-5424.05C4269.55,-5418.34 4348.51,-5412.33 4420.5,-5408 5198.75,-5361.21 6111.26,-5330.25 6610.39,-5315.34"/>
<polygon fill="black" stroke="black" points="6610.75,-5318.84 6620.64,-5315.04 6610.54,-5311.84 6610.75,-5318.84"/>
</g>
<!-- layer12_expert4_act -->
<g id="node904" class="node">
<title>layer12_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4500,-5580 4105,-5580 4105,-5512 4500,-5512 4500,-5580"/>
<text text-anchor="middle" x="4302.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4302.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4302.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4302.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer12_expert4_gate&#45;&gt;layer12_expert4_act -->
<g id="edge1282" class="edge">
<title>layer12_expert4_gate&#45;&gt;layer12_expert4_act</title>
<path fill="none" stroke="black" d="M4023.3,-5615.95C4066.56,-5605.27 4114.7,-5593.38 4158.66,-5582.53"/>
<polygon fill="black" stroke="black" points="4159.69,-5585.88 4168.56,-5580.08 4158.01,-5579.08 4159.69,-5585.88"/>
</g>
<!-- layer12_expert4_up&#45;&gt;layer12_expert4_act -->
<g id="edge1283" class="edge">
<title>layer12_expert4_up&#45;&gt;layer12_expert4_act</title>
<path fill="none" stroke="black" d="M4302.5,-5615.88C4302.5,-5607.78 4302.5,-5598.98 4302.5,-5590.47"/>
<polygon fill="black" stroke="black" points="4306,-5590.3 4302.5,-5580.3 4299,-5590.3 4306,-5590.3"/>
</g>
<!-- layer12_expert4_down -->
<g id="node905" class="node">
<title>layer12_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4813,-5476 4430,-5476 4430,-5408 4813,-5408 4813,-5476"/>
<text text-anchor="middle" x="4621.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4621.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4621.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4621.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer12_expert4_act&#45;&gt;layer12_expert4_down -->
<g id="edge1284" class="edge">
<title>layer12_expert4_act&#45;&gt;layer12_expert4_down</title>
<path fill="none" stroke="black" d="M4406.07,-5511.88C4438.77,-5501.43 4475.07,-5489.82 4508.4,-5479.16"/>
<polygon fill="black" stroke="black" points="4509.72,-5482.42 4518.18,-5476.04 4507.59,-5475.75 4509.72,-5482.42"/>
</g>
<!-- layer12_expert4_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1285" class="edge">
<title>layer12_expert4_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M4813.3,-5428.54C4911.96,-5422.22 5034.16,-5414.52 5143.5,-5408 5657.41,-5377.37 6252.22,-5344.55 6623.2,-5324.4"/>
<polygon fill="black" stroke="black" points="6623.49,-5327.89 6633.28,-5323.85 6623.11,-5320.9 6623.49,-5327.89"/>
</g>
<!-- layer12_expert5_act -->
<g id="node908" class="node">
<title>layer12_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5326,-5580 4931,-5580 4931,-5512 5326,-5512 5326,-5580"/>
<text text-anchor="middle" x="5128.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5128.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5128.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5128.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer12_expert5_gate&#45;&gt;layer12_expert5_act -->
<g id="edge1288" class="edge">
<title>layer12_expert5_gate&#45;&gt;layer12_expert5_act</title>
<path fill="none" stroke="black" d="M4849.3,-5615.95C4892.56,-5605.27 4940.7,-5593.38 4984.66,-5582.53"/>
<polygon fill="black" stroke="black" points="4985.69,-5585.88 4994.56,-5580.08 4984.01,-5579.08 4985.69,-5585.88"/>
</g>
<!-- layer12_expert5_up&#45;&gt;layer12_expert5_act -->
<g id="edge1289" class="edge">
<title>layer12_expert5_up&#45;&gt;layer12_expert5_act</title>
<path fill="none" stroke="black" d="M5128.5,-5615.88C5128.5,-5607.78 5128.5,-5598.98 5128.5,-5590.47"/>
<polygon fill="black" stroke="black" points="5132,-5590.3 5128.5,-5580.3 5125,-5590.3 5132,-5590.3"/>
</g>
<!-- layer12_expert5_down -->
<g id="node909" class="node">
<title>layer12_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5536,-5476 5153,-5476 5153,-5408 5536,-5408 5536,-5476"/>
<text text-anchor="middle" x="5344.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5344.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5344.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5344.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer12_expert5_act&#45;&gt;layer12_expert5_down -->
<g id="edge1290" class="edge">
<title>layer12_expert5_act&#45;&gt;layer12_expert5_down</title>
<path fill="none" stroke="black" d="M5198.63,-5511.88C5219.86,-5501.86 5243.33,-5490.77 5265.13,-5480.48"/>
<polygon fill="black" stroke="black" points="5266.81,-5483.56 5274.35,-5476.12 5263.82,-5477.23 5266.81,-5483.56"/>
</g>
<!-- layer12_expert5_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1291" class="edge">
<title>layer12_expert5_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M5536.12,-5425.1C5805.49,-5402.75 6300.61,-5361.66 6635.89,-5333.84"/>
<polygon fill="black" stroke="black" points="6636.58,-5337.3 6646.26,-5332.98 6636,-5330.32 6636.58,-5337.3"/>
</g>
<!-- layer12_expert6_act -->
<g id="node912" class="node">
<title>layer12_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6152,-5580 5757,-5580 5757,-5512 6152,-5512 6152,-5580"/>
<text text-anchor="middle" x="5954.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5954.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5954.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5954.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer12_expert6_gate&#45;&gt;layer12_expert6_act -->
<g id="edge1294" class="edge">
<title>layer12_expert6_gate&#45;&gt;layer12_expert6_act</title>
<path fill="none" stroke="black" d="M5675.3,-5615.95C5718.56,-5605.27 5766.7,-5593.38 5810.66,-5582.53"/>
<polygon fill="black" stroke="black" points="5811.69,-5585.88 5820.56,-5580.08 5810.01,-5579.08 5811.69,-5585.88"/>
</g>
<!-- layer12_expert6_up&#45;&gt;layer12_expert6_act -->
<g id="edge1295" class="edge">
<title>layer12_expert6_up&#45;&gt;layer12_expert6_act</title>
<path fill="none" stroke="black" d="M5954.5,-5615.88C5954.5,-5607.78 5954.5,-5598.98 5954.5,-5590.47"/>
<polygon fill="black" stroke="black" points="5958,-5590.3 5954.5,-5580.3 5951,-5590.3 5958,-5590.3"/>
</g>
<!-- layer12_expert6_down -->
<g id="node913" class="node">
<title>layer12_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6362,-5476 5979,-5476 5979,-5408 6362,-5408 6362,-5476"/>
<text text-anchor="middle" x="6170.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6170.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6170.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6170.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer12_expert6_act&#45;&gt;layer12_expert6_down -->
<g id="edge1296" class="edge">
<title>layer12_expert6_act&#45;&gt;layer12_expert6_down</title>
<path fill="none" stroke="black" d="M6024.63,-5511.88C6045.86,-5501.86 6069.33,-5490.77 6091.13,-5480.48"/>
<polygon fill="black" stroke="black" points="6092.81,-5483.56 6100.35,-5476.12 6089.82,-5477.23 6092.81,-5483.56"/>
</g>
<!-- layer12_expert6_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1297" class="edge">
<title>layer12_expert6_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M6362.14,-5408.94C6453.66,-5393.63 6565.58,-5374.91 6669.09,-5357.59"/>
<polygon fill="black" stroke="black" points="6669.79,-5361.03 6679.08,-5355.92 6668.64,-5354.12 6669.79,-5361.03"/>
</g>
<!-- layer12_expert7_act -->
<g id="node916" class="node">
<title>layer12_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6978,-5580 6583,-5580 6583,-5512 6978,-5512 6978,-5580"/>
<text text-anchor="middle" x="6780.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6780.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6780.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6780.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer12_expert7_gate&#45;&gt;layer12_expert7_act -->
<g id="edge1300" class="edge">
<title>layer12_expert7_gate&#45;&gt;layer12_expert7_act</title>
<path fill="none" stroke="black" d="M6501.3,-5615.95C6544.56,-5605.27 6592.7,-5593.38 6636.66,-5582.53"/>
<polygon fill="black" stroke="black" points="6637.69,-5585.88 6646.56,-5580.08 6636.01,-5579.08 6637.69,-5585.88"/>
</g>
<!-- layer12_expert7_up&#45;&gt;layer12_expert7_act -->
<g id="edge1301" class="edge">
<title>layer12_expert7_up&#45;&gt;layer12_expert7_act</title>
<path fill="none" stroke="black" d="M6780.5,-5615.88C6780.5,-5607.78 6780.5,-5598.98 6780.5,-5590.47"/>
<polygon fill="black" stroke="black" points="6784,-5590.3 6780.5,-5580.3 6777,-5590.3 6784,-5590.3"/>
</g>
<!-- layer12_expert7_down -->
<g id="node917" class="node">
<title>layer12_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6975,-5476 6592,-5476 6592,-5408 6975,-5408 6975,-5476"/>
<text text-anchor="middle" x="6783.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6783.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6783.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6783.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer12_expert7_act&#45;&gt;layer12_expert7_down -->
<g id="edge1302" class="edge">
<title>layer12_expert7_act&#45;&gt;layer12_expert7_down</title>
<path fill="none" stroke="black" d="M6781.47,-5511.88C6781.71,-5503.78 6781.97,-5494.98 6782.22,-5486.47"/>
<polygon fill="black" stroke="black" points="6785.73,-5486.4 6782.52,-5476.3 6778.73,-5486.19 6785.73,-5486.4"/>
</g>
<!-- layer12_expert7_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1303" class="edge">
<title>layer12_expert7_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M6832.17,-5407.9C6845.63,-5398.75 6860.8,-5388.44 6876.2,-5377.97"/>
<polygon fill="black" stroke="black" points="6878.47,-5380.66 6884.77,-5372.14 6874.53,-5374.87 6878.47,-5380.66"/>
</g>
<!-- layer12_expert8_act -->
<g id="node920" class="node">
<title>layer12_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7391,-5580 6996,-5580 6996,-5512 7391,-5512 7391,-5580"/>
<text text-anchor="middle" x="7193.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7193.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7193.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7193.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_expert8_gate&#45;&gt;layer12_expert8_act -->
<g id="edge1306" class="edge">
<title>layer12_expert8_gate&#45;&gt;layer12_expert8_act</title>
<path fill="none" stroke="black" d="M7193.5,-5615.88C7193.5,-5607.78 7193.5,-5598.98 7193.5,-5590.47"/>
<polygon fill="black" stroke="black" points="7197,-5590.3 7193.5,-5580.3 7190,-5590.3 7197,-5590.3"/>
</g>
<!-- layer12_expert8_up&#45;&gt;layer12_expert8_act -->
<g id="edge1307" class="edge">
<title>layer12_expert8_up&#45;&gt;layer12_expert8_act</title>
<path fill="none" stroke="black" d="M7472.7,-5615.95C7429.44,-5605.27 7381.3,-5593.38 7337.34,-5582.53"/>
<polygon fill="black" stroke="black" points="7337.99,-5579.08 7327.44,-5580.08 7336.31,-5585.88 7337.99,-5579.08"/>
</g>
<!-- layer12_expert8_down -->
<g id="node921" class="node">
<title>layer12_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7382,-5476 6999,-5476 6999,-5408 7382,-5408 7382,-5476"/>
<text text-anchor="middle" x="7190.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7190.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7190.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7190.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_expert8_act&#45;&gt;layer12_expert8_down -->
<g id="edge1308" class="edge">
<title>layer12_expert8_act&#45;&gt;layer12_expert8_down</title>
<path fill="none" stroke="black" d="M7192.53,-5511.88C7192.29,-5503.78 7192.03,-5494.98 7191.78,-5486.47"/>
<polygon fill="black" stroke="black" points="7195.27,-5486.19 7191.48,-5476.3 7188.27,-5486.4 7195.27,-5486.19"/>
</g>
<!-- layer12_expert8_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1309" class="edge">
<title>layer12_expert8_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M7140.13,-5407.9C7126.06,-5398.66 7110.2,-5388.25 7094.12,-5377.67"/>
<polygon fill="black" stroke="black" points="7095.97,-5374.7 7085.69,-5372.14 7092.12,-5380.55 7095.97,-5374.7"/>
</g>
<!-- layer12_expert9_act -->
<g id="node924" class="node">
<title>layer12_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8217,-5580 7822,-5580 7822,-5512 8217,-5512 8217,-5580"/>
<text text-anchor="middle" x="8019.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8019.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8019.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8019.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_expert9_gate&#45;&gt;layer12_expert9_act -->
<g id="edge1312" class="edge">
<title>layer12_expert9_gate&#45;&gt;layer12_expert9_act</title>
<path fill="none" stroke="black" d="M8019.5,-5615.88C8019.5,-5607.78 8019.5,-5598.98 8019.5,-5590.47"/>
<polygon fill="black" stroke="black" points="8023,-5590.3 8019.5,-5580.3 8016,-5590.3 8023,-5590.3"/>
</g>
<!-- layer12_expert9_up&#45;&gt;layer12_expert9_act -->
<g id="edge1313" class="edge">
<title>layer12_expert9_up&#45;&gt;layer12_expert9_act</title>
<path fill="none" stroke="black" d="M8298.7,-5615.95C8255.44,-5605.27 8207.3,-5593.38 8163.34,-5582.53"/>
<polygon fill="black" stroke="black" points="8163.99,-5579.08 8153.44,-5580.08 8162.31,-5585.88 8163.99,-5579.08"/>
</g>
<!-- layer12_expert9_down -->
<g id="node925" class="node">
<title>layer12_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="7998,-5476 7615,-5476 7615,-5408 7998,-5408 7998,-5476"/>
<text text-anchor="middle" x="7806.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7806.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7806.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7806.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_expert9_act&#45;&gt;layer12_expert9_down -->
<g id="edge1314" class="edge">
<title>layer12_expert9_act&#45;&gt;layer12_expert9_down</title>
<path fill="none" stroke="black" d="M7950.35,-5511.88C7929.41,-5501.86 7906.26,-5490.77 7884.77,-5480.48"/>
<polygon fill="black" stroke="black" points="7886.2,-5477.29 7875.67,-5476.12 7883.18,-5483.6 7886.2,-5477.29"/>
</g>
<!-- layer12_expert9_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1315" class="edge">
<title>layer12_expert9_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M7614.84,-5409.33C7549.96,-5398.61 7474.75,-5386.18 7399.34,-5373.72"/>
<polygon fill="black" stroke="black" points="7399.62,-5370.22 7389.19,-5372.04 7398.48,-5377.12 7399.62,-5370.22"/>
</g>
<!-- layer12_expert10_act -->
<g id="node928" class="node">
<title>layer12_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9043,-5580 8648,-5580 8648,-5512 9043,-5512 9043,-5580"/>
<text text-anchor="middle" x="8845.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8845.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8845.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8845.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_expert10_gate&#45;&gt;layer12_expert10_act -->
<g id="edge1318" class="edge">
<title>layer12_expert10_gate&#45;&gt;layer12_expert10_act</title>
<path fill="none" stroke="black" d="M8845.5,-5615.88C8845.5,-5607.78 8845.5,-5598.98 8845.5,-5590.47"/>
<polygon fill="black" stroke="black" points="8849,-5590.3 8845.5,-5580.3 8842,-5590.3 8849,-5590.3"/>
</g>
<!-- layer12_expert10_up&#45;&gt;layer12_expert10_act -->
<g id="edge1319" class="edge">
<title>layer12_expert10_up&#45;&gt;layer12_expert10_act</title>
<path fill="none" stroke="black" d="M9124.7,-5615.95C9081.44,-5605.27 9033.3,-5593.38 8989.34,-5582.53"/>
<polygon fill="black" stroke="black" points="8989.99,-5579.08 8979.44,-5580.08 8988.31,-5585.88 8989.99,-5579.08"/>
</g>
<!-- layer12_expert10_down -->
<g id="node929" class="node">
<title>layer12_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8719,-5476 8336,-5476 8336,-5408 8719,-5408 8719,-5476"/>
<text text-anchor="middle" x="8527.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8527.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8527.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8527.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_expert10_act&#45;&gt;layer12_expert10_down -->
<g id="edge1320" class="edge">
<title>layer12_expert10_act&#45;&gt;layer12_expert10_down</title>
<path fill="none" stroke="black" d="M8742.25,-5511.88C8709.65,-5501.43 8673.47,-5489.82 8640.25,-5479.16"/>
<polygon fill="black" stroke="black" points="8641.09,-5475.76 8630.5,-5476.04 8638.95,-5482.42 8641.09,-5475.76"/>
</g>
<!-- layer12_expert10_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1321" class="edge">
<title>layer12_expert10_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M8335.85,-5424.12C8110.46,-5404.27 7728.98,-5370.66 7428.54,-5344.2"/>
<polygon fill="black" stroke="black" points="7428.61,-5340.69 7418.34,-5343.3 7427.99,-5347.67 7428.61,-5340.69"/>
</g>
<!-- layer12_expert11_act -->
<g id="node932" class="node">
<title>layer12_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9869,-5580 9474,-5580 9474,-5512 9869,-5512 9869,-5580"/>
<text text-anchor="middle" x="9671.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9671.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9671.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9671.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_expert11_gate&#45;&gt;layer12_expert11_act -->
<g id="edge1324" class="edge">
<title>layer12_expert11_gate&#45;&gt;layer12_expert11_act</title>
<path fill="none" stroke="black" d="M9671.5,-5615.88C9671.5,-5607.78 9671.5,-5598.98 9671.5,-5590.47"/>
<polygon fill="black" stroke="black" points="9675,-5590.3 9671.5,-5580.3 9668,-5590.3 9675,-5590.3"/>
</g>
<!-- layer12_expert11_up&#45;&gt;layer12_expert11_act -->
<g id="edge1325" class="edge">
<title>layer12_expert11_up&#45;&gt;layer12_expert11_act</title>
<path fill="none" stroke="black" d="M9950.7,-5615.95C9907.44,-5605.27 9859.3,-5593.38 9815.34,-5582.53"/>
<polygon fill="black" stroke="black" points="9815.99,-5579.08 9805.44,-5580.08 9814.31,-5585.88 9815.99,-5579.08"/>
</g>
<!-- layer12_expert11_down -->
<g id="node933" class="node">
<title>layer12_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9493,-5476 9110,-5476 9110,-5408 9493,-5408 9493,-5476"/>
<text text-anchor="middle" x="9301.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9301.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9301.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9301.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_expert11_act&#45;&gt;layer12_expert11_down -->
<g id="edge1326" class="edge">
<title>layer12_expert11_act&#45;&gt;layer12_expert11_down</title>
<path fill="none" stroke="black" d="M9551.63,-5511.95C9513.2,-5501.36 9470.47,-5489.58 9431.36,-5478.8"/>
<polygon fill="black" stroke="black" points="9432.07,-5475.36 9421.5,-5476.08 9430.21,-5482.11 9432.07,-5475.36"/>
</g>
<!-- layer12_expert11_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1327" class="edge">
<title>layer12_expert11_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M9109.84,-5429.75C8738.82,-5407.99 7914.55,-5359.63 7408.2,-5329.92"/>
<polygon fill="black" stroke="black" points="7408.35,-5326.42 7398.17,-5329.33 7407.94,-5333.41 7408.35,-5326.42"/>
</g>
<!-- layer12_expert12_act -->
<g id="node936" class="node">
<title>layer12_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10695,-5580 10300,-5580 10300,-5512 10695,-5512 10695,-5580"/>
<text text-anchor="middle" x="10497.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10497.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10497.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10497.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_expert12_gate&#45;&gt;layer12_expert12_act -->
<g id="edge1330" class="edge">
<title>layer12_expert12_gate&#45;&gt;layer12_expert12_act</title>
<path fill="none" stroke="black" d="M10497.5,-5615.88C10497.5,-5607.78 10497.5,-5598.98 10497.5,-5590.47"/>
<polygon fill="black" stroke="black" points="10501,-5590.3 10497.5,-5580.3 10494,-5590.3 10501,-5590.3"/>
</g>
<!-- layer12_expert12_up&#45;&gt;layer12_expert12_act -->
<g id="edge1331" class="edge">
<title>layer12_expert12_up&#45;&gt;layer12_expert12_act</title>
<path fill="none" stroke="black" d="M10776.7,-5615.95C10733.44,-5605.27 10685.3,-5593.38 10641.34,-5582.53"/>
<polygon fill="black" stroke="black" points="10641.99,-5579.08 10631.44,-5580.08 10640.31,-5585.88 10641.99,-5579.08"/>
</g>
<!-- layer12_expert12_down -->
<g id="node937" class="node">
<title>layer12_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10293,-5476 9910,-5476 9910,-5408 10293,-5408 10293,-5476"/>
<text text-anchor="middle" x="10101.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10101.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10101.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10101.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_expert12_act&#45;&gt;layer12_expert12_down -->
<g id="edge1332" class="edge">
<title>layer12_expert12_act&#45;&gt;layer12_expert12_down</title>
<path fill="none" stroke="black" d="M10369.2,-5511.95C10327.81,-5501.29 10281.76,-5489.43 10239.69,-5478.59"/>
<polygon fill="black" stroke="black" points="10240.49,-5475.19 10229.93,-5476.08 10238.74,-5481.96 10240.49,-5475.19"/>
</g>
<!-- layer12_expert12_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1333" class="edge">
<title>layer12_expert12_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M9909.67,-5429.74C9792.15,-5423.01 9638.65,-5414.53 9502.5,-5408 8759.75,-5372.36 7893.41,-5338.66 7394.65,-5320.02"/>
<polygon fill="black" stroke="black" points="7394.53,-5316.52 7384.41,-5319.64 7394.27,-5323.51 7394.53,-5316.52"/>
</g>
<!-- layer12_expert13_act -->
<g id="node940" class="node">
<title>layer12_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11521,-5580 11126,-5580 11126,-5512 11521,-5512 11521,-5580"/>
<text text-anchor="middle" x="11323.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11323.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11323.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11323.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_expert13_gate&#45;&gt;layer12_expert13_act -->
<g id="edge1336" class="edge">
<title>layer12_expert13_gate&#45;&gt;layer12_expert13_act</title>
<path fill="none" stroke="black" d="M11323.5,-5615.88C11323.5,-5607.78 11323.5,-5598.98 11323.5,-5590.47"/>
<polygon fill="black" stroke="black" points="11327,-5590.3 11323.5,-5580.3 11320,-5590.3 11327,-5590.3"/>
</g>
<!-- layer12_expert13_up&#45;&gt;layer12_expert13_act -->
<g id="edge1337" class="edge">
<title>layer12_expert13_up&#45;&gt;layer12_expert13_act</title>
<path fill="none" stroke="black" d="M11602.7,-5615.95C11559.44,-5605.27 11511.3,-5593.38 11467.34,-5582.53"/>
<polygon fill="black" stroke="black" points="11467.99,-5579.08 11457.44,-5580.08 11466.31,-5585.88 11467.99,-5579.08"/>
</g>
<!-- layer12_expert13_down -->
<g id="node941" class="node">
<title>layer12_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11106,-5476 10723,-5476 10723,-5408 11106,-5408 11106,-5476"/>
<text text-anchor="middle" x="10914.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10914.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10914.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10914.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_expert13_act&#45;&gt;layer12_expert13_down -->
<g id="edge1338" class="edge">
<title>layer12_expert13_act&#45;&gt;layer12_expert13_down</title>
<path fill="none" stroke="black" d="M11190.99,-5511.95C11148.15,-5501.27 11100.48,-5489.38 11056.95,-5478.53"/>
<polygon fill="black" stroke="black" points="11057.7,-5475.1 11047.15,-5476.08 11056,-5481.9 11057.7,-5475.1"/>
</g>
<!-- layer12_expert13_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1339" class="edge">
<title>layer12_expert13_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M10722.98,-5429.55C10602.35,-5422.61 10443.36,-5413.98 10302.5,-5408 9251.09,-5363.34 8011.53,-5330 7386.76,-5314.54"/>
<polygon fill="black" stroke="black" points="7386.78,-5311.04 7376.69,-5314.3 7386.6,-5318.04 7386.78,-5311.04"/>
</g>
<!-- layer12_expert14_act -->
<g id="node944" class="node">
<title>layer12_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12347,-5580 11952,-5580 11952,-5512 12347,-5512 12347,-5580"/>
<text text-anchor="middle" x="12149.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12149.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12149.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12149.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_expert14_gate&#45;&gt;layer12_expert14_act -->
<g id="edge1342" class="edge">
<title>layer12_expert14_gate&#45;&gt;layer12_expert14_act</title>
<path fill="none" stroke="black" d="M12149.5,-5615.88C12149.5,-5607.78 12149.5,-5598.98 12149.5,-5590.47"/>
<polygon fill="black" stroke="black" points="12153,-5590.3 12149.5,-5580.3 12146,-5590.3 12153,-5590.3"/>
</g>
<!-- layer12_expert14_up&#45;&gt;layer12_expert14_act -->
<g id="edge1343" class="edge">
<title>layer12_expert14_up&#45;&gt;layer12_expert14_act</title>
<path fill="none" stroke="black" d="M12428.7,-5615.95C12385.44,-5605.27 12337.3,-5593.38 12293.34,-5582.53"/>
<polygon fill="black" stroke="black" points="12293.99,-5579.08 12283.44,-5580.08 12292.31,-5585.88 12293.99,-5579.08"/>
</g>
<!-- layer12_expert14_down -->
<g id="node945" class="node">
<title>layer12_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11925,-5476 11542,-5476 11542,-5408 11925,-5408 11925,-5476"/>
<text text-anchor="middle" x="11733.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11733.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11733.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11733.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_expert14_act&#45;&gt;layer12_expert14_down -->
<g id="edge1344" class="edge">
<title>layer12_expert14_act&#45;&gt;layer12_expert14_down</title>
<path fill="none" stroke="black" d="M12014.72,-5511.95C11971.15,-5501.27 11922.66,-5489.38 11878.39,-5478.53"/>
<polygon fill="black" stroke="black" points="11878.96,-5475.06 11868.42,-5476.08 11877.3,-5481.86 11878.96,-5475.06"/>
</g>
<!-- layer12_expert14_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1345" class="edge">
<title>layer12_expert14_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M11541.83,-5429.36C11419.82,-5422.3 11258.43,-5413.6 11115.5,-5408 9745.85,-5354.37 8119.66,-5323.43 7382.32,-5311.17"/>
<polygon fill="black" stroke="black" points="7382.12,-5307.67 7372.07,-5311 7382.01,-5314.67 7382.12,-5307.67"/>
</g>
<!-- layer12_expert15_act -->
<g id="node948" class="node">
<title>layer12_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13173,-5580 12778,-5580 12778,-5512 13173,-5512 13173,-5580"/>
<text text-anchor="middle" x="12975.5" y="-5564.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12975.5" y="-5549.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12975.5" y="-5534.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12975.5" y="-5519.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_expert15_gate&#45;&gt;layer12_expert15_act -->
<g id="edge1348" class="edge">
<title>layer12_expert15_gate&#45;&gt;layer12_expert15_act</title>
<path fill="none" stroke="black" d="M12975.5,-5615.88C12975.5,-5607.78 12975.5,-5598.98 12975.5,-5590.47"/>
<polygon fill="black" stroke="black" points="12979,-5590.3 12975.5,-5580.3 12972,-5590.3 12979,-5590.3"/>
</g>
<!-- layer12_expert15_up&#45;&gt;layer12_expert15_act -->
<g id="edge1349" class="edge">
<title>layer12_expert15_up&#45;&gt;layer12_expert15_act</title>
<path fill="none" stroke="black" d="M13254.7,-5615.95C13211.44,-5605.27 13163.3,-5593.38 13119.34,-5582.53"/>
<polygon fill="black" stroke="black" points="13119.99,-5579.08 13109.44,-5580.08 13118.31,-5585.88 13119.99,-5579.08"/>
</g>
<!-- layer12_expert15_down -->
<g id="node949" class="node">
<title>layer12_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12748,-5476 12365,-5476 12365,-5408 12748,-5408 12748,-5476"/>
<text text-anchor="middle" x="12556.5" y="-5460.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12556.5" y="-5445.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12556.5" y="-5430.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12556.5" y="-5415.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_expert15_act&#45;&gt;layer12_expert15_down -->
<g id="edge1350" class="edge">
<title>layer12_expert15_act&#45;&gt;layer12_expert15_down</title>
<path fill="none" stroke="black" d="M12839.75,-5511.95C12795.77,-5501.25 12746.82,-5489.33 12702.15,-5478.46"/>
<polygon fill="black" stroke="black" points="12702.93,-5475.05 12692.39,-5476.08 12701.28,-5481.85 12702.93,-5475.05"/>
</g>
<!-- layer12_expert15_down&#45;&gt;layer12_token_aggregation -->
<g id="edge1351" class="edge">
<title>layer12_expert15_down&#45;&gt;layer12_token_aggregation</title>
<path fill="none" stroke="black" d="M12364.98,-5429.24C12242.02,-5422.09 12078.9,-5413.33 11934.5,-5408 10240.24,-5345.45 8218.33,-5318.15 7378.93,-5308.91"/>
<polygon fill="black" stroke="black" points="7378.84,-5305.4 7368.8,-5308.79 7378.76,-5312.4 7378.84,-5305.4"/>
</g>
<!-- layer12_res2 -->
<g id="node951" class="node">
<title>layer12_res2</title>
<polygon fill="none" stroke="black" points="7424.24,-5200 6723.12,-5200 6542.76,-5034 7243.88,-5034 7424.24,-5200"/>
<text text-anchor="middle" x="6983.5" y="-5143.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6983.5" y="-5128.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-5113.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-5098.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-5083.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_token_aggregation&#45;&gt;layer12_res2 -->
<g id="edge1352" class="edge">
<title>layer12_token_aggregation&#45;&gt;layer12_res2</title>
<path fill="none" stroke="black" d="M6983.5,-5235.95C6983.5,-5227.63 6983.5,-5219 6983.5,-5210.38"/>
<polygon fill="black" stroke="black" points="6987,-5210.28 6983.5,-5200.28 6980,-5210.28 6987,-5210.28"/>
</g>
<!-- layer13_mha_qkv -->
<g id="node952" class="node">
<title>layer13_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7219.5,-4998 6747.5,-4998 6747.5,-4930 7219.5,-4930 7219.5,-4998"/>
<text text-anchor="middle" x="6983.5" y="-4982.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6983.5" y="-4967.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4952.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6983.5" y="-4937.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_res2&#45;&gt;layer13_mha_qkv -->
<g id="edge1353" class="edge">
<title>layer12_res2&#45;&gt;layer13_mha_qkv</title>
<path fill="none" stroke="black" d="M6983.5,-5033.87C6983.5,-5025.12 6983.5,-5016.48 6983.5,-5008.45"/>
<polygon fill="black" stroke="black" points="6987,-5008.26 6983.5,-4998.26 6980,-5008.26 6987,-5008.26"/>
</g>
<!-- layer13_mha_attn -->
<g id="node953" class="node">
<title>layer13_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7213.5,-4894 6753.5,-4894 6753.5,-4826 7213.5,-4826 7213.5,-4894"/>
<text text-anchor="middle" x="6983.5" y="-4878.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6983.5" y="-4863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6983.5" y="-4848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4833.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_mha_qkv&#45;&gt;layer13_mha_attn -->
<g id="edge1354" class="edge">
<title>layer13_mha_qkv&#45;&gt;layer13_mha_attn</title>
<path fill="none" stroke="black" d="M6983.5,-4929.88C6983.5,-4921.78 6983.5,-4912.98 6983.5,-4904.47"/>
<polygon fill="black" stroke="black" points="6987,-4904.3 6983.5,-4894.3 6980,-4904.3 6987,-4904.3"/>
</g>
<!-- layer13_mha_out -->
<g id="node954" class="node">
<title>layer13_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7196,-4790 6771,-4790 6771,-4722 7196,-4722 7196,-4790"/>
<text text-anchor="middle" x="6983.5" y="-4774.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6983.5" y="-4759.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4744.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4729.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_mha_attn&#45;&gt;layer13_mha_out -->
<g id="edge1355" class="edge">
<title>layer13_mha_attn&#45;&gt;layer13_mha_out</title>
<path fill="none" stroke="black" d="M6983.5,-4825.88C6983.5,-4817.78 6983.5,-4808.98 6983.5,-4800.47"/>
<polygon fill="black" stroke="black" points="6987,-4800.3 6983.5,-4790.3 6980,-4800.3 6987,-4800.3"/>
</g>
<!-- layer13_res1 -->
<g id="node955" class="node">
<title>layer13_res1</title>
<polygon fill="none" stroke="black" points="7424.24,-4686 6723.12,-4686 6542.76,-4520 7243.88,-4520 7424.24,-4686"/>
<text text-anchor="middle" x="6983.5" y="-4629.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6983.5" y="-4614.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4599.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4584.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4569.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_mha_out&#45;&gt;layer13_res1 -->
<g id="edge1356" class="edge">
<title>layer13_mha_out&#45;&gt;layer13_res1</title>
<path fill="none" stroke="black" d="M6983.5,-4721.86C6983.5,-4714.1 6983.5,-4705.46 6983.5,-4696.48"/>
<polygon fill="black" stroke="black" points="6987,-4696.23 6983.5,-4686.23 6980,-4696.23 6987,-4696.23"/>
</g>
<!-- layer13_ln1 -->
<g id="node956" class="node">
<title>layer13_ln1</title>
<polygon fill="yellow" stroke="black" points="7196,-4484 6771,-4484 6771,-4416 7196,-4416 7196,-4484"/>
<text text-anchor="middle" x="6983.5" y="-4468.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6983.5" y="-4453.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4438.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4423.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_res1&#45;&gt;layer13_ln1 -->
<g id="edge1357" class="edge">
<title>layer13_res1&#45;&gt;layer13_ln1</title>
<path fill="none" stroke="black" d="M6983.5,-4519.87C6983.5,-4511.12 6983.5,-4502.48 6983.5,-4494.45"/>
<polygon fill="black" stroke="black" points="6987,-4494.26 6983.5,-4484.26 6980,-4494.26 6987,-4494.26"/>
</g>
<!-- layer13_expert_routing -->
<g id="node957" class="node">
<title>layer13_expert_routing</title>
<polygon fill="orange" stroke="black" points="6983.5,-4380 6567.5,-4297 6983.5,-4214 7399.5,-4297 6983.5,-4380"/>
<text text-anchor="middle" x="6983.5" y="-4323.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6983.5" y="-4308.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6983.5" y="-4293.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4278.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6983.5" y="-4263.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_ln1&#45;&gt;layer13_expert_routing -->
<g id="edge1358" class="edge">
<title>layer13_ln1&#45;&gt;layer13_expert_routing</title>
<path fill="none" stroke="black" d="M6983.5,-4415.86C6983.5,-4408.1 6983.5,-4399.46 6983.5,-4390.48"/>
<polygon fill="black" stroke="black" points="6987,-4390.23 6983.5,-4380.23 6980,-4390.23 6987,-4390.23"/>
</g>
<!-- layer13_token_distribution -->
<g id="node958" class="node">
<title>layer13_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7411.86,-4178 6730.44,-4178 6555.14,-4042 7236.56,-4042 7411.86,-4178"/>
<text text-anchor="middle" x="6983.5" y="-4128.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6983.5" y="-4113.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6983.5" y="-4098.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6983.5" y="-4083.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer13_expert_routing&#45;&gt;layer13_token_distribution -->
<g id="edge1359" class="edge">
<title>layer13_expert_routing&#45;&gt;layer13_token_distribution</title>
<path fill="none" stroke="black" d="M6983.5,-4213.78C6983.5,-4205.34 6983.5,-4196.79 6983.5,-4188.4"/>
<polygon fill="black" stroke="black" points="6987,-4188.28 6983.5,-4178.28 6980,-4188.28 6987,-4188.28"/>
</g>
<!-- layer13_expert0_gate -->
<g id="node959" class="node">
<title>layer13_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="780,-4006 385,-4006 385,-3938 780,-3938 780,-4006"/>
<text text-anchor="middle" x="582.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="582.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="582.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="582.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert0_gate -->
<g id="edge1360" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6642.42,-4109.72C5521.99,-4111.09 1960.01,-4107.23 790.31,-4006.11"/>
<polygon fill="black" stroke="black" points="790.32,-4002.6 780.06,-4005.22 789.71,-4009.57 790.32,-4002.6"/>
</g>
<!-- layer13_expert0_up -->
<g id="node960" class="node">
<title>layer13_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1193,-4006 798,-4006 798,-3938 1193,-3938 1193,-4006"/>
<text text-anchor="middle" x="995.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="995.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="995.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="995.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert0_up -->
<g id="edge1361" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6641.42,-4109.24C5570.28,-4109 2288.27,-4100.44 1203.35,-4006.12"/>
<polygon fill="black" stroke="black" points="1203.32,-4002.6 1193.06,-4005.21 1202.71,-4009.57 1203.32,-4002.6"/>
</g>
<!-- layer13_expert1_gate -->
<g id="node963" class="node">
<title>layer13_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1606,-4006 1211,-4006 1211,-3938 1606,-3938 1606,-4006"/>
<text text-anchor="middle" x="1408.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1408.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1408.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1408.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert1_gate -->
<g id="edge1366" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6640.86,-4108.69C5621.38,-4106.77 2616.69,-4093.69 1616.28,-4006.11"/>
<polygon fill="black" stroke="black" points="1616.33,-4002.6 1606.06,-4005.21 1615.71,-4009.57 1616.33,-4002.6"/>
</g>
<!-- layer13_expert1_up -->
<g id="node964" class="node">
<title>layer13_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2019,-4006 1624,-4006 1624,-3938 2019,-3938 2019,-4006"/>
<text text-anchor="middle" x="1821.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1821.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1821.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1821.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert1_up -->
<g id="edge1367" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6639.92,-4108.04C5673.86,-4104.35 2945.03,-4086.95 2029.08,-4006.09"/>
<polygon fill="black" stroke="black" points="2029.33,-4002.6 2019.06,-4005.2 2028.71,-4009.58 2029.33,-4002.6"/>
</g>
<!-- layer13_expert2_gate -->
<g id="node967" class="node">
<title>layer13_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2432,-4006 2037,-4006 2037,-3938 2432,-3938 2432,-4006"/>
<text text-anchor="middle" x="2234.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2234.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2234.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2234.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert2_gate -->
<g id="edge1372" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6638.93,-4107.27C5728.78,-4101.72 3274.04,-4080.22 2442.07,-4006.1"/>
<polygon fill="black" stroke="black" points="2442.33,-4002.6 2432.06,-4005.19 2441.7,-4009.58 2442.33,-4002.6"/>
</g>
<!-- layer13_expert2_up -->
<g id="node968" class="node">
<title>layer13_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2845,-4006 2450,-4006 2450,-3938 2845,-3938 2845,-4006"/>
<text text-anchor="middle" x="2647.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2647.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2647.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2647.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert2_up -->
<g id="edge1373" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6637.99,-4106.34C5786.65,-4098.84 3603.62,-4073.52 2855.16,-4006.1"/>
<polygon fill="black" stroke="black" points="2855.34,-4002.61 2845.06,-4005.18 2854.7,-4009.58 2855.34,-4002.61"/>
</g>
<!-- layer13_expert3_gate -->
<g id="node971" class="node">
<title>layer13_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3258,-4006 2863,-4006 2863,-3938 3258,-3938 3258,-4006"/>
<text text-anchor="middle" x="3060.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3060.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3060.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3060.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert3_gate -->
<g id="edge1378" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6636.41,-4105.2C5846.73,-4095.62 3933.42,-4066.84 3268.24,-4006.11"/>
<polygon fill="black" stroke="black" points="3268.34,-4002.61 3258.06,-4005.17 3267.7,-4009.58 3268.34,-4002.61"/>
</g>
<!-- layer13_expert3_up -->
<g id="node972" class="node">
<title>layer13_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3671,-4006 3276,-4006 3276,-3938 3671,-3938 3671,-4006"/>
<text text-anchor="middle" x="3473.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3473.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3473.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3473.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert3_up -->
<g id="edge1379" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6634.52,-4103.77C5910.21,-4091.98 4263.46,-4060.17 3681.25,-4006.12"/>
<polygon fill="black" stroke="black" points="3681.35,-4002.61 3671.06,-4005.16 3680.69,-4009.58 3681.35,-4002.61"/>
</g>
<!-- layer13_expert4_gate -->
<g id="node975" class="node">
<title>layer13_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4084,-4006 3689,-4006 3689,-3938 4084,-3938 4084,-4006"/>
<text text-anchor="middle" x="3886.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3886.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3886.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3886.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert4_gate -->
<g id="edge1384" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6632.06,-4101.9C5977.59,-4087.8 4593.94,-4053.52 4094.26,-4006.12"/>
<polygon fill="black" stroke="black" points="4094.35,-4002.62 4084.06,-4005.14 4093.68,-4009.58 4094.35,-4002.62"/>
</g>
<!-- layer13_expert4_up -->
<g id="node976" class="node">
<title>layer13_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4497,-4006 4102,-4006 4102,-3938 4497,-3938 4497,-4006"/>
<text text-anchor="middle" x="4299.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4299.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4299.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4299.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert4_up -->
<g id="edge1385" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6639.37,-4107.42C6162.11,-4102.35 5272.47,-4082.49 4507.19,-4006.13"/>
<polygon fill="black" stroke="black" points="4507.36,-4002.63 4497.07,-4005.12 4506.67,-4009.6 4507.36,-4002.63"/>
</g>
<!-- layer13_expert5_gate -->
<g id="node979" class="node">
<title>layer13_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4910,-4006 4515,-4006 4515,-3938 4910,-3938 4910,-4006"/>
<text text-anchor="middle" x="4712.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4712.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4712.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4712.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert5_gate -->
<g id="edge1390" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6633.68,-4103.16C6224.56,-4093.67 5527.04,-4069.18 4920.34,-4006.16"/>
<polygon fill="black" stroke="black" points="4920.38,-4002.64 4910.07,-4005.09 4919.65,-4009.61 4920.38,-4002.64"/>
</g>
<!-- layer13_expert5_up -->
<g id="node980" class="node">
<title>layer13_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5323,-4006 4928,-4006 4928,-3938 5323,-3938 5323,-4006"/>
<text text-anchor="middle" x="5125.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5125.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5125.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5125.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert5_up -->
<g id="edge1391" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6625.34,-4096.65C6292.6,-4082.84 5783.32,-4055.72 5333.03,-4006.14"/>
<polygon fill="black" stroke="black" points="5333.4,-4002.66 5323.07,-4005.04 5332.63,-4009.62 5333.4,-4002.66"/>
</g>
<!-- layer13_expert6_gate -->
<g id="node983" class="node">
<title>layer13_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5736,-4006 5341,-4006 5341,-3938 5736,-3938 5736,-4006"/>
<text text-anchor="middle" x="5538.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5538.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5538.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5538.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert6_gate -->
<g id="edge1396" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6611.03,-4085.44C6367.4,-4068.23 6042.1,-4041.86 5746.16,-4006.18"/>
<polygon fill="black" stroke="black" points="5746.43,-4002.68 5736.08,-4004.96 5745.59,-4009.63 5746.43,-4002.68"/>
</g>
<!-- layer13_expert6_up -->
<g id="node984" class="node">
<title>layer13_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6149,-4006 5754,-4006 5754,-3938 6149,-3938 6149,-4006"/>
<text text-anchor="middle" x="5951.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5951.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5951.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5951.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert6_up -->
<g id="edge1397" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6580.33,-4061.57C6448.89,-4045.37 6302.08,-4026.49 6159.37,-4006.25"/>
<polygon fill="black" stroke="black" points="6159.5,-4002.74 6149.11,-4004.79 6158.51,-4009.67 6159.5,-4002.74"/>
</g>
<!-- layer13_expert7_gate -->
<g id="node987" class="node">
<title>layer13_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6562,-4006 6167,-4006 6167,-3938 6562,-3938 6562,-4006"/>
<text text-anchor="middle" x="6364.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6364.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6364.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6364.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert7_gate -->
<g id="edge1402" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6678.53,-4042C6625.4,-4030.32 6572.09,-4018.61 6524.86,-4008.23"/>
<polygon fill="black" stroke="black" points="6525.4,-4004.77 6514.88,-4006.04 6523.89,-4011.6 6525.4,-4004.77"/>
</g>
<!-- layer13_expert7_up -->
<g id="node988" class="node">
<title>layer13_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6975,-4006 6580,-4006 6580,-3938 6975,-3938 6975,-4006"/>
<text text-anchor="middle" x="6777.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6777.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6777.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6777.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert7_up -->
<g id="edge1403" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6882.01,-4042C6866.37,-4031.67 6850.68,-4021.31 6836.38,-4011.87"/>
<polygon fill="black" stroke="black" points="6837.95,-4008.72 6827.68,-4006.13 6834.1,-4014.56 6837.95,-4008.72"/>
</g>
<!-- layer13_expert8_gate -->
<g id="node991" class="node">
<title>layer13_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7388,-4006 6993,-4006 6993,-3938 7388,-3938 7388,-4006"/>
<text text-anchor="middle" x="7190.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7190.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7190.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7190.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert8_gate -->
<g id="edge1408" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7085.48,-4042C7101.2,-4031.67 7116.97,-4021.31 7131.33,-4011.87"/>
<polygon fill="black" stroke="black" points="7133.64,-4014.54 7140.08,-4006.13 7129.8,-4008.69 7133.64,-4014.54"/>
</g>
<!-- layer13_expert8_up -->
<g id="node992" class="node">
<title>layer13_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7801,-4006 7406,-4006 7406,-3938 7801,-3938 7801,-4006"/>
<text text-anchor="middle" x="7603.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7603.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7603.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7603.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert8_up -->
<g id="edge1409" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7248.23,-4050.93C7314.49,-4036.4 7383.56,-4021.25 7442.99,-4008.21"/>
<polygon fill="black" stroke="black" points="7443.81,-4011.61 7452.82,-4006.05 7442.31,-4004.78 7443.81,-4011.61"/>
</g>
<!-- layer13_expert9_gate -->
<g id="node995" class="node">
<title>layer13_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8214,-4006 7819,-4006 7819,-3938 8214,-3938 8214,-4006"/>
<text text-anchor="middle" x="8016.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8016.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8016.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8016.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert9_gate -->
<g id="edge1414" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.03,-4074.73C7434.07,-4056.13 7627.37,-4031.94 7808.89,-4006.22"/>
<polygon fill="black" stroke="black" points="7809.49,-4009.67 7818.89,-4004.8 7808.5,-4002.74 7809.49,-4009.67"/>
</g>
<!-- layer13_expert9_up -->
<g id="node996" class="node">
<title>layer13_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8627,-4006 8232,-4006 8232,-3938 8627,-3938 8627,-4006"/>
<text text-anchor="middle" x="8429.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8429.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8429.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8429.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert9_up -->
<g id="edge1415" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7297.91,-4089.51C7546.39,-4072.52 7902.09,-4044.72 8221.99,-4006.16"/>
<polygon fill="black" stroke="black" points="8222.41,-4009.63 8231.92,-4004.96 8221.57,-4002.68 8222.41,-4009.63"/>
</g>
<!-- layer13_expert10_gate -->
<g id="node999" class="node">
<title>layer13_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9040,-4006 8645,-4006 8645,-3938 9040,-3938 9040,-4006"/>
<text text-anchor="middle" x="8842.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8842.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8842.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8842.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert10_gate -->
<g id="edge1420" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7308.93,-4098.01C7640.51,-4084.65 8169.55,-4057.38 8634.98,-4006.14"/>
<polygon fill="black" stroke="black" points="8635.37,-4009.62 8644.93,-4005.04 8634.6,-4002.66 8635.37,-4009.62"/>
</g>
<!-- layer13_expert10_up -->
<g id="node1000" class="node">
<title>layer13_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9453,-4006 9058,-4006 9058,-3938 9453,-3938 9453,-4006"/>
<text text-anchor="middle" x="9255.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9255.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9255.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9255.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert10_up -->
<g id="edge1421" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7316.24,-4103.57C7723.05,-4094.37 8432.4,-4070.08 9047.97,-4006.13"/>
<polygon fill="black" stroke="black" points="9048.35,-4009.61 9057.93,-4005.09 9047.62,-4002.64 9048.35,-4009.61"/>
</g>
<!-- layer13_expert11_gate -->
<g id="node1003" class="node">
<title>layer13_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9866,-4006 9471,-4006 9471,-3938 9866,-3938 9866,-4006"/>
<text text-anchor="middle" x="9668.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9668.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9668.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9668.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert11_gate -->
<g id="edge1426" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.2,-4107.5C7797.01,-4102.55 8691.7,-4082.86 9460.76,-4006.14"/>
<polygon fill="black" stroke="black" points="9461.33,-4009.6 9470.93,-4005.12 9460.64,-4002.63 9461.33,-4009.6"/>
</g>
<!-- layer13_expert11_up -->
<g id="node1004" class="node">
<title>layer13_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10279,-4006 9884,-4006 9884,-3938 10279,-3938 10279,-4006"/>
<text text-anchor="middle" x="10081.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10081.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10081.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10081.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert11_up -->
<g id="edge1427" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7314.5,-4102.35C7960.28,-4088.53 9368.47,-4054.03 9873.63,-4006.13"/>
<polygon fill="black" stroke="black" points="9874.32,-4009.58 9883.94,-4005.14 9873.65,-4002.62 9874.32,-4009.58"/>
</g>
<!-- layer13_expert12_gate -->
<g id="node1007" class="node">
<title>layer13_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10692,-4006 10297,-4006 10297,-3938 10692,-3938 10692,-4006"/>
<text text-anchor="middle" x="10494.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10494.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10494.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10494.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert12_gate -->
<g id="edge1432" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7316.83,-4104.02C8032.92,-4092.46 9700.02,-4060.58 10286.68,-4006.13"/>
<polygon fill="black" stroke="black" points="10287.31,-4009.58 10296.94,-4005.16 10286.65,-4002.61 10287.31,-4009.58"/>
</g>
<!-- layer13_expert12_up -->
<g id="node1008" class="node">
<title>layer13_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11105,-4006 10710,-4006 10710,-3938 11105,-3938 11105,-4006"/>
<text text-anchor="middle" x="10907.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10907.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10907.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10907.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert12_up -->
<g id="edge1433" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.57,-4105.35C8100.82,-4095.92 10030.91,-4067.16 10699.7,-4006.12"/>
<polygon fill="black" stroke="black" points="10700.3,-4009.58 10709.94,-4005.17 10699.66,-4002.61 10700.3,-4009.58"/>
</g>
<!-- layer13_expert13_gate -->
<g id="node1011" class="node">
<title>layer13_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11518,-4006 11123,-4006 11123,-3938 11518,-3938 11518,-4006"/>
<text text-anchor="middle" x="11320.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11320.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11320.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11320.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert13_gate -->
<g id="edge1438" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7319.74,-4106.43C8164.52,-4099.03 10361.4,-4073.78 11112.8,-4006.11"/>
<polygon fill="black" stroke="black" points="11113.3,-4009.58 11122.94,-4005.18 11112.66,-4002.61 11113.3,-4009.58"/>
</g>
<!-- layer13_expert13_up -->
<g id="node1012" class="node">
<title>layer13_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11931,-4006 11536,-4006 11536,-3938 11931,-3938 11931,-4006"/>
<text text-anchor="middle" x="11733.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11733.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11733.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11733.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert13_up -->
<g id="edge1439" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.14,-4107.31C8225.83,-4101.84 10691.6,-4080.43 11525.9,-4006.1"/>
<polygon fill="black" stroke="black" points="11526.3,-4009.58 11535.94,-4005.19 11525.67,-4002.6 11526.3,-4009.58"/>
</g>
<!-- layer13_expert14_gate -->
<g id="node1015" class="node">
<title>layer13_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12344,-4006 11949,-4006 11949,-3938 12344,-3938 12344,-4006"/>
<text text-anchor="middle" x="12146.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12146.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12146.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12146.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert14_gate -->
<g id="edge1444" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.95,-4108.06C8283.58,-4104.42 11021.12,-4087.11 11938.9,-4006.1"/>
<polygon fill="black" stroke="black" points="11939.29,-4009.58 11948.94,-4005.2 11938.67,-4002.6 11939.29,-4009.58"/>
</g>
<!-- layer13_expert14_up -->
<g id="node1016" class="node">
<title>layer13_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12757,-4006 12362,-4006 12362,-3938 12757,-3938 12757,-4006"/>
<text text-anchor="middle" x="12559.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12559.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12559.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12559.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert14_up -->
<g id="edge1445" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7322.58,-4108.7C8338.74,-4106.8 11349.92,-4093.81 12351.71,-4006.11"/>
<polygon fill="black" stroke="black" points="12352.29,-4009.57 12361.94,-4005.21 12351.67,-4002.6 12352.29,-4009.57"/>
</g>
<!-- layer13_expert15_gate -->
<g id="node1019" class="node">
<title>layer13_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13170,-4006 12775,-4006 12775,-3938 13170,-3938 13170,-4006"/>
<text text-anchor="middle" x="12972.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12972.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12972.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12972.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert15_gate -->
<g id="edge1450" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7323.27,-4109.24C8392.13,-4109.02 11678.73,-4100.53 12764.64,-4006.12"/>
<polygon fill="black" stroke="black" points="12765.29,-4009.57 12774.94,-4005.21 12764.68,-4002.6 12765.29,-4009.57"/>
</g>
<!-- layer13_expert15_up -->
<g id="node1020" class="node">
<title>layer13_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13583,-4006 13188,-4006 13188,-3938 13583,-3938 13583,-4006"/>
<text text-anchor="middle" x="13385.5" y="-3990.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13385.5" y="-3975.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13385.5" y="-3960.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13385.5" y="-3945.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_token_distribution&#45;&gt;layer13_expert15_up -->
<g id="edge1451" class="edge">
<title>layer13_token_distribution&#45;&gt;layer13_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7324.15,-4109.72C8444.21,-4111.1 12007.63,-4107.26 13177.69,-4006.11"/>
<polygon fill="black" stroke="black" points="13178.29,-4009.57 13187.94,-4005.22 13177.68,-4002.6 13178.29,-4009.57"/>
</g>
<!-- layer13_expert0_act -->
<g id="node961" class="node">
<title>layer13_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1193,-3902 798,-3902 798,-3834 1193,-3834 1193,-3902"/>
<text text-anchor="middle" x="995.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="995.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="995.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="995.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer13_expert0_gate&#45;&gt;layer13_expert0_act -->
<g id="edge1362" class="edge">
<title>layer13_expert0_gate&#45;&gt;layer13_expert0_act</title>
<path fill="none" stroke="black" d="M716.3,-3937.95C759.56,-3927.27 807.7,-3915.38 851.66,-3904.53"/>
<polygon fill="black" stroke="black" points="852.69,-3907.88 861.56,-3902.08 851.01,-3901.08 852.69,-3907.88"/>
</g>
<!-- layer13_expert0_up&#45;&gt;layer13_expert0_act -->
<g id="edge1363" class="edge">
<title>layer13_expert0_up&#45;&gt;layer13_expert0_act</title>
<path fill="none" stroke="black" d="M995.5,-3937.88C995.5,-3929.78 995.5,-3920.98 995.5,-3912.47"/>
<polygon fill="black" stroke="black" points="999,-3912.3 995.5,-3902.3 992,-3912.3 999,-3912.3"/>
</g>
<!-- layer13_expert0_down -->
<g id="node962" class="node">
<title>layer13_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1612,-3798 1229,-3798 1229,-3730 1612,-3730 1612,-3798"/>
<text text-anchor="middle" x="1420.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1420.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1420.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1420.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer13_expert0_act&#45;&gt;layer13_expert0_down -->
<g id="edge1364" class="edge">
<title>layer13_expert0_act&#45;&gt;layer13_expert0_down</title>
<path fill="none" stroke="black" d="M1133.19,-3833.95C1177.8,-3823.25 1227.45,-3811.33 1272.76,-3800.46"/>
<polygon fill="black" stroke="black" points="1273.76,-3803.82 1282.66,-3798.08 1272.12,-3797.01 1273.76,-3803.82"/>
</g>
<!-- layer13_token_aggregation -->
<g id="node1023" class="node">
<title>layer13_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7456.24,-3694 6699.44,-3694 6504.76,-3558 7261.56,-3558 7456.24,-3694"/>
<text text-anchor="middle" x="6980.5" y="-3644.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6980.5" y="-3629.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6980.5" y="-3614.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3599.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_expert0_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1365" class="edge">
<title>layer13_expert0_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M1612.25,-3751.29C1735.88,-3744.13 1900.13,-3735.35 2045.5,-3730 3742.56,-3667.5 5769.4,-3640.04 6598.55,-3630.83"/>
<polygon fill="black" stroke="black" points="6598.59,-3634.33 6608.55,-3630.72 6598.51,-3627.33 6598.59,-3634.33"/>
</g>
<!-- layer13_expert1_act -->
<g id="node965" class="node">
<title>layer13_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2019,-3902 1624,-3902 1624,-3834 2019,-3834 2019,-3902"/>
<text text-anchor="middle" x="1821.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1821.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1821.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1821.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer13_expert1_gate&#45;&gt;layer13_expert1_act -->
<g id="edge1368" class="edge">
<title>layer13_expert1_gate&#45;&gt;layer13_expert1_act</title>
<path fill="none" stroke="black" d="M1542.3,-3937.95C1585.56,-3927.27 1633.7,-3915.38 1677.66,-3904.53"/>
<polygon fill="black" stroke="black" points="1678.69,-3907.88 1687.56,-3902.08 1677.01,-3901.08 1678.69,-3907.88"/>
</g>
<!-- layer13_expert1_up&#45;&gt;layer13_expert1_act -->
<g id="edge1369" class="edge">
<title>layer13_expert1_up&#45;&gt;layer13_expert1_act</title>
<path fill="none" stroke="black" d="M1821.5,-3937.88C1821.5,-3929.78 1821.5,-3920.98 1821.5,-3912.47"/>
<polygon fill="black" stroke="black" points="1825,-3912.3 1821.5,-3902.3 1818,-3912.3 1825,-3912.3"/>
</g>
<!-- layer13_expert1_down -->
<g id="node966" class="node">
<title>layer13_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2438,-3798 2055,-3798 2055,-3730 2438,-3730 2438,-3798"/>
<text text-anchor="middle" x="2246.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2246.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2246.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2246.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer13_expert1_act&#45;&gt;layer13_expert1_down -->
<g id="edge1370" class="edge">
<title>layer13_expert1_act&#45;&gt;layer13_expert1_down</title>
<path fill="none" stroke="black" d="M1959.19,-3833.95C2003.8,-3823.25 2053.45,-3811.33 2098.76,-3800.46"/>
<polygon fill="black" stroke="black" points="2099.76,-3803.82 2108.66,-3798.08 2098.12,-3797.01 2099.76,-3803.82"/>
</g>
<!-- layer13_expert1_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1371" class="edge">
<title>layer13_expert1_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M2438.15,-3745.4C2507.51,-3739.63 2586.48,-3733.74 2658.5,-3730 4110.72,-3654.6 5840.34,-3634.33 6595.68,-3628.93"/>
<polygon fill="black" stroke="black" points="6595.93,-3632.43 6605.9,-3628.86 6595.88,-3625.43 6595.93,-3632.43"/>
</g>
<!-- layer13_expert2_act -->
<g id="node969" class="node">
<title>layer13_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2845,-3902 2450,-3902 2450,-3834 2845,-3834 2845,-3902"/>
<text text-anchor="middle" x="2647.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2647.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2647.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2647.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer13_expert2_gate&#45;&gt;layer13_expert2_act -->
<g id="edge1374" class="edge">
<title>layer13_expert2_gate&#45;&gt;layer13_expert2_act</title>
<path fill="none" stroke="black" d="M2368.3,-3937.95C2411.56,-3927.27 2459.7,-3915.38 2503.66,-3904.53"/>
<polygon fill="black" stroke="black" points="2504.69,-3907.88 2513.56,-3902.08 2503.01,-3901.08 2504.69,-3907.88"/>
</g>
<!-- layer13_expert2_up&#45;&gt;layer13_expert2_act -->
<g id="edge1375" class="edge">
<title>layer13_expert2_up&#45;&gt;layer13_expert2_act</title>
<path fill="none" stroke="black" d="M2647.5,-3937.88C2647.5,-3929.78 2647.5,-3920.98 2647.5,-3912.47"/>
<polygon fill="black" stroke="black" points="2651,-3912.3 2647.5,-3902.3 2644,-3912.3 2651,-3912.3"/>
</g>
<!-- layer13_expert2_down -->
<g id="node970" class="node">
<title>layer13_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3051,-3798 2668,-3798 2668,-3730 3051,-3730 3051,-3798"/>
<text text-anchor="middle" x="2859.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2859.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2859.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2859.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer13_expert2_act&#45;&gt;layer13_expert2_down -->
<g id="edge1376" class="edge">
<title>layer13_expert2_act&#45;&gt;layer13_expert2_down</title>
<path fill="none" stroke="black" d="M2716.33,-3833.88C2737.17,-3823.86 2760.21,-3812.77 2781.6,-3802.48"/>
<polygon fill="black" stroke="black" points="2783.16,-3805.61 2790.65,-3798.12 2780.12,-3799.31 2783.16,-3805.61"/>
</g>
<!-- layer13_expert2_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1377" class="edge">
<title>layer13_expert2_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M3051.34,-3753.16C3193.09,-3746.09 3390.79,-3736.68 3564.5,-3730 4670.01,-3687.46 5977.33,-3652.25 6605.99,-3636.25"/>
<polygon fill="black" stroke="black" points="6606.21,-3639.75 6616.12,-3636 6606.03,-3632.75 6606.21,-3639.75"/>
</g>
<!-- layer13_expert3_act -->
<g id="node973" class="node">
<title>layer13_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3671,-3902 3276,-3902 3276,-3834 3671,-3834 3671,-3902"/>
<text text-anchor="middle" x="3473.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3473.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3473.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3473.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer13_expert3_gate&#45;&gt;layer13_expert3_act -->
<g id="edge1380" class="edge">
<title>layer13_expert3_gate&#45;&gt;layer13_expert3_act</title>
<path fill="none" stroke="black" d="M3194.3,-3937.95C3237.56,-3927.27 3285.7,-3915.38 3329.66,-3904.53"/>
<polygon fill="black" stroke="black" points="3330.69,-3907.88 3339.56,-3902.08 3329.01,-3901.08 3330.69,-3907.88"/>
</g>
<!-- layer13_expert3_up&#45;&gt;layer13_expert3_act -->
<g id="edge1381" class="edge">
<title>layer13_expert3_up&#45;&gt;layer13_expert3_act</title>
<path fill="none" stroke="black" d="M3473.5,-3937.88C3473.5,-3929.78 3473.5,-3920.98 3473.5,-3912.47"/>
<polygon fill="black" stroke="black" points="3477,-3912.3 3473.5,-3902.3 3470,-3912.3 3477,-3912.3"/>
</g>
<!-- layer13_expert3_down -->
<g id="node974" class="node">
<title>layer13_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3957,-3798 3574,-3798 3574,-3730 3957,-3730 3957,-3798"/>
<text text-anchor="middle" x="3765.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3765.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3765.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3765.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer13_expert3_act&#45;&gt;layer13_expert3_down -->
<g id="edge1382" class="edge">
<title>layer13_expert3_act&#45;&gt;layer13_expert3_down</title>
<path fill="none" stroke="black" d="M3568.3,-3833.88C3597.91,-3823.54 3630.72,-3812.08 3660.96,-3801.52"/>
<polygon fill="black" stroke="black" points="3662.39,-3804.73 3670.67,-3798.12 3660.08,-3798.12 3662.39,-3804.73"/>
</g>
<!-- layer13_expert3_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1383" class="edge">
<title>layer13_expert3_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M3957.09,-3748.97C4049.12,-3742.56 4160.99,-3735.25 4261.5,-3730 5099.63,-3686.25 6084.01,-3653.62 6607.97,-3637.74"/>
<polygon fill="black" stroke="black" points="6608.45,-3641.23 6618.34,-3637.43 6608.23,-3634.23 6608.45,-3641.23"/>
</g>
<!-- layer13_expert4_act -->
<g id="node977" class="node">
<title>layer13_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4497,-3902 4102,-3902 4102,-3834 4497,-3834 4497,-3902"/>
<text text-anchor="middle" x="4299.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4299.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4299.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4299.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer13_expert4_gate&#45;&gt;layer13_expert4_act -->
<g id="edge1386" class="edge">
<title>layer13_expert4_gate&#45;&gt;layer13_expert4_act</title>
<path fill="none" stroke="black" d="M4020.3,-3937.95C4063.56,-3927.27 4111.7,-3915.38 4155.66,-3904.53"/>
<polygon fill="black" stroke="black" points="4156.69,-3907.88 4165.56,-3902.08 4155.01,-3901.08 4156.69,-3907.88"/>
</g>
<!-- layer13_expert4_up&#45;&gt;layer13_expert4_act -->
<g id="edge1387" class="edge">
<title>layer13_expert4_up&#45;&gt;layer13_expert4_act</title>
<path fill="none" stroke="black" d="M4299.5,-3937.88C4299.5,-3929.78 4299.5,-3920.98 4299.5,-3912.47"/>
<polygon fill="black" stroke="black" points="4303,-3912.3 4299.5,-3902.3 4296,-3912.3 4303,-3912.3"/>
</g>
<!-- layer13_expert4_down -->
<g id="node978" class="node">
<title>layer13_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4654,-3798 4271,-3798 4271,-3730 4654,-3730 4654,-3798"/>
<text text-anchor="middle" x="4462.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4462.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4462.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4462.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer13_expert4_act&#45;&gt;layer13_expert4_down -->
<g id="edge1388" class="edge">
<title>layer13_expert4_act&#45;&gt;layer13_expert4_down</title>
<path fill="none" stroke="black" d="M4352.42,-3833.88C4367.87,-3824.21 4384.89,-3813.56 4400.84,-3803.59"/>
<polygon fill="black" stroke="black" points="4402.94,-3806.4 4409.57,-3798.12 4399.23,-3800.46 4402.94,-3806.4"/>
</g>
<!-- layer13_expert4_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1389" class="edge">
<title>layer13_expert4_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M4654.08,-3752.65C5073.5,-3730 6078.65,-3675.71 6620.24,-3646.46"/>
<polygon fill="black" stroke="black" points="6620.77,-3649.93 6630.56,-3645.9 6620.39,-3642.94 6620.77,-3649.93"/>
</g>
<!-- layer13_expert5_act -->
<g id="node981" class="node">
<title>layer13_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5323,-3902 4928,-3902 4928,-3834 5323,-3834 5323,-3902"/>
<text text-anchor="middle" x="5125.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5125.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5125.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5125.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer13_expert5_gate&#45;&gt;layer13_expert5_act -->
<g id="edge1392" class="edge">
<title>layer13_expert5_gate&#45;&gt;layer13_expert5_act</title>
<path fill="none" stroke="black" d="M4846.3,-3937.95C4889.56,-3927.27 4937.7,-3915.38 4981.66,-3904.53"/>
<polygon fill="black" stroke="black" points="4982.69,-3907.88 4991.56,-3902.08 4981.01,-3901.08 4982.69,-3907.88"/>
</g>
<!-- layer13_expert5_up&#45;&gt;layer13_expert5_act -->
<g id="edge1393" class="edge">
<title>layer13_expert5_up&#45;&gt;layer13_expert5_act</title>
<path fill="none" stroke="black" d="M5125.5,-3937.88C5125.5,-3929.78 5125.5,-3920.98 5125.5,-3912.47"/>
<polygon fill="black" stroke="black" points="5129,-3912.3 5125.5,-3902.3 5122,-3912.3 5129,-3912.3"/>
</g>
<!-- layer13_expert5_down -->
<g id="node982" class="node">
<title>layer13_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5692,-3798 5309,-3798 5309,-3730 5692,-3730 5692,-3798"/>
<text text-anchor="middle" x="5500.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5500.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5500.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5500.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer13_expert5_act&#45;&gt;layer13_expert5_down -->
<g id="edge1394" class="edge">
<title>layer13_expert5_act&#45;&gt;layer13_expert5_down</title>
<path fill="none" stroke="black" d="M5246.99,-3833.95C5286.02,-3823.34 5329.43,-3811.53 5369.14,-3800.73"/>
<polygon fill="black" stroke="black" points="5370.15,-3804.08 5378.88,-3798.08 5368.31,-3797.33 5370.15,-3804.08"/>
</g>
<!-- layer13_expert5_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1395" class="edge">
<title>layer13_expert5_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M5692.09,-3745.39C5930.85,-3723.45 6343.2,-3685.56 6637.09,-3658.56"/>
<polygon fill="black" stroke="black" points="6637.42,-3662.04 6647.06,-3657.64 6636.78,-3655.07 6637.42,-3662.04"/>
</g>
<!-- layer13_expert6_act -->
<g id="node985" class="node">
<title>layer13_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6149,-3902 5754,-3902 5754,-3834 6149,-3834 6149,-3902"/>
<text text-anchor="middle" x="5951.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5951.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5951.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5951.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer13_expert6_gate&#45;&gt;layer13_expert6_act -->
<g id="edge1398" class="edge">
<title>layer13_expert6_gate&#45;&gt;layer13_expert6_act</title>
<path fill="none" stroke="black" d="M5672.3,-3937.95C5715.56,-3927.27 5763.7,-3915.38 5807.66,-3904.53"/>
<polygon fill="black" stroke="black" points="5808.69,-3907.88 5817.56,-3902.08 5807.01,-3901.08 5808.69,-3907.88"/>
</g>
<!-- layer13_expert6_up&#45;&gt;layer13_expert6_act -->
<g id="edge1399" class="edge">
<title>layer13_expert6_up&#45;&gt;layer13_expert6_act</title>
<path fill="none" stroke="black" d="M5951.5,-3937.88C5951.5,-3929.78 5951.5,-3920.98 5951.5,-3912.47"/>
<polygon fill="black" stroke="black" points="5955,-3912.3 5951.5,-3902.3 5948,-3912.3 5955,-3912.3"/>
</g>
<!-- layer13_expert6_down -->
<g id="node986" class="node">
<title>layer13_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6412,-3798 6029,-3798 6029,-3730 6412,-3730 6412,-3798"/>
<text text-anchor="middle" x="6220.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6220.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6220.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6220.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer13_expert6_act&#45;&gt;layer13_expert6_down -->
<g id="edge1400" class="edge">
<title>layer13_expert6_act&#45;&gt;layer13_expert6_down</title>
<path fill="none" stroke="black" d="M6038.84,-3833.88C6065.87,-3823.63 6095.82,-3812.28 6123.47,-3801.79"/>
<polygon fill="black" stroke="black" points="6125.03,-3804.94 6133.14,-3798.12 6122.55,-3798.4 6125.03,-3804.94"/>
</g>
<!-- layer13_expert6_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1401" class="edge">
<title>layer13_expert6_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M6404.96,-3729.99C6484.68,-3715.73 6580.18,-3698.64 6670.26,-3682.52"/>
<polygon fill="black" stroke="black" points="6671.14,-3685.91 6680.37,-3680.71 6669.91,-3679.02 6671.14,-3685.91"/>
</g>
<!-- layer13_expert7_act -->
<g id="node989" class="node">
<title>layer13_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6975,-3902 6580,-3902 6580,-3834 6975,-3834 6975,-3902"/>
<text text-anchor="middle" x="6777.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6777.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6777.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6777.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer13_expert7_gate&#45;&gt;layer13_expert7_act -->
<g id="edge1404" class="edge">
<title>layer13_expert7_gate&#45;&gt;layer13_expert7_act</title>
<path fill="none" stroke="black" d="M6498.3,-3937.95C6541.56,-3927.27 6589.7,-3915.38 6633.66,-3904.53"/>
<polygon fill="black" stroke="black" points="6634.69,-3907.88 6643.56,-3902.08 6633.01,-3901.08 6634.69,-3907.88"/>
</g>
<!-- layer13_expert7_up&#45;&gt;layer13_expert7_act -->
<g id="edge1405" class="edge">
<title>layer13_expert7_up&#45;&gt;layer13_expert7_act</title>
<path fill="none" stroke="black" d="M6777.5,-3937.88C6777.5,-3929.78 6777.5,-3920.98 6777.5,-3912.47"/>
<polygon fill="black" stroke="black" points="6781,-3912.3 6777.5,-3902.3 6774,-3912.3 6781,-3912.3"/>
</g>
<!-- layer13_expert7_down -->
<g id="node990" class="node">
<title>layer13_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6972,-3798 6589,-3798 6589,-3730 6972,-3730 6972,-3798"/>
<text text-anchor="middle" x="6780.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6780.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6780.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6780.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer13_expert7_act&#45;&gt;layer13_expert7_down -->
<g id="edge1406" class="edge">
<title>layer13_expert7_act&#45;&gt;layer13_expert7_down</title>
<path fill="none" stroke="black" d="M6778.47,-3833.88C6778.71,-3825.78 6778.97,-3816.98 6779.22,-3808.47"/>
<polygon fill="black" stroke="black" points="6782.73,-3808.4 6779.52,-3798.3 6775.73,-3808.19 6782.73,-3808.4"/>
</g>
<!-- layer13_expert7_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1407" class="edge">
<title>layer13_expert7_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M6829.17,-3729.9C6842.63,-3720.75 6857.8,-3710.44 6873.2,-3699.97"/>
<polygon fill="black" stroke="black" points="6875.47,-3702.66 6881.77,-3694.14 6871.53,-3696.87 6875.47,-3702.66"/>
</g>
<!-- layer13_expert8_act -->
<g id="node993" class="node">
<title>layer13_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7388,-3902 6993,-3902 6993,-3834 7388,-3834 7388,-3902"/>
<text text-anchor="middle" x="7190.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7190.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7190.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7190.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_expert8_gate&#45;&gt;layer13_expert8_act -->
<g id="edge1410" class="edge">
<title>layer13_expert8_gate&#45;&gt;layer13_expert8_act</title>
<path fill="none" stroke="black" d="M7190.5,-3937.88C7190.5,-3929.78 7190.5,-3920.98 7190.5,-3912.47"/>
<polygon fill="black" stroke="black" points="7194,-3912.3 7190.5,-3902.3 7187,-3912.3 7194,-3912.3"/>
</g>
<!-- layer13_expert8_up&#45;&gt;layer13_expert8_act -->
<g id="edge1411" class="edge">
<title>layer13_expert8_up&#45;&gt;layer13_expert8_act</title>
<path fill="none" stroke="black" d="M7469.7,-3937.95C7426.44,-3927.27 7378.3,-3915.38 7334.34,-3904.53"/>
<polygon fill="black" stroke="black" points="7334.99,-3901.08 7324.44,-3902.08 7333.31,-3907.88 7334.99,-3901.08"/>
</g>
<!-- layer13_expert8_down -->
<g id="node994" class="node">
<title>layer13_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7379,-3798 6996,-3798 6996,-3730 7379,-3730 7379,-3798"/>
<text text-anchor="middle" x="7187.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7187.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7187.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7187.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_expert8_act&#45;&gt;layer13_expert8_down -->
<g id="edge1412" class="edge">
<title>layer13_expert8_act&#45;&gt;layer13_expert8_down</title>
<path fill="none" stroke="black" d="M7189.53,-3833.88C7189.29,-3825.78 7189.03,-3816.98 7188.78,-3808.47"/>
<polygon fill="black" stroke="black" points="7192.27,-3808.19 7188.48,-3798.3 7185.27,-3808.4 7192.27,-3808.19"/>
</g>
<!-- layer13_expert8_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1413" class="edge">
<title>layer13_expert8_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M7137.13,-3729.9C7123.06,-3720.66 7107.2,-3710.25 7091.12,-3699.67"/>
<polygon fill="black" stroke="black" points="7092.97,-3696.7 7082.69,-3694.14 7089.12,-3702.55 7092.97,-3696.7"/>
</g>
<!-- layer13_expert9_act -->
<g id="node997" class="node">
<title>layer13_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8214,-3902 7819,-3902 7819,-3834 8214,-3834 8214,-3902"/>
<text text-anchor="middle" x="8016.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8016.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8016.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8016.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_expert9_gate&#45;&gt;layer13_expert9_act -->
<g id="edge1416" class="edge">
<title>layer13_expert9_gate&#45;&gt;layer13_expert9_act</title>
<path fill="none" stroke="black" d="M8016.5,-3937.88C8016.5,-3929.78 8016.5,-3920.98 8016.5,-3912.47"/>
<polygon fill="black" stroke="black" points="8020,-3912.3 8016.5,-3902.3 8013,-3912.3 8020,-3912.3"/>
</g>
<!-- layer13_expert9_up&#45;&gt;layer13_expert9_act -->
<g id="edge1417" class="edge">
<title>layer13_expert9_up&#45;&gt;layer13_expert9_act</title>
<path fill="none" stroke="black" d="M8295.7,-3937.95C8252.44,-3927.27 8204.3,-3915.38 8160.34,-3904.53"/>
<polygon fill="black" stroke="black" points="8160.99,-3901.08 8150.44,-3902.08 8159.31,-3907.88 8160.99,-3901.08"/>
</g>
<!-- layer13_expert9_down -->
<g id="node998" class="node">
<title>layer13_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="7995,-3798 7612,-3798 7612,-3730 7995,-3730 7995,-3798"/>
<text text-anchor="middle" x="7803.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7803.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7803.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7803.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_expert9_act&#45;&gt;layer13_expert9_down -->
<g id="edge1418" class="edge">
<title>layer13_expert9_act&#45;&gt;layer13_expert9_down</title>
<path fill="none" stroke="black" d="M7947.35,-3833.88C7926.41,-3823.86 7903.26,-3812.77 7881.77,-3802.48"/>
<polygon fill="black" stroke="black" points="7883.2,-3799.29 7872.67,-3798.12 7880.18,-3805.6 7883.2,-3799.29"/>
</g>
<!-- layer13_expert9_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1419" class="edge">
<title>layer13_expert9_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M7611.84,-3731.33C7546.96,-3720.61 7471.75,-3708.18 7396.34,-3695.72"/>
<polygon fill="black" stroke="black" points="7396.62,-3692.22 7386.19,-3694.04 7395.48,-3699.12 7396.62,-3692.22"/>
</g>
<!-- layer13_expert10_act -->
<g id="node1001" class="node">
<title>layer13_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9040,-3902 8645,-3902 8645,-3834 9040,-3834 9040,-3902"/>
<text text-anchor="middle" x="8842.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8842.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8842.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8842.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_expert10_gate&#45;&gt;layer13_expert10_act -->
<g id="edge1422" class="edge">
<title>layer13_expert10_gate&#45;&gt;layer13_expert10_act</title>
<path fill="none" stroke="black" d="M8842.5,-3937.88C8842.5,-3929.78 8842.5,-3920.98 8842.5,-3912.47"/>
<polygon fill="black" stroke="black" points="8846,-3912.3 8842.5,-3902.3 8839,-3912.3 8846,-3912.3"/>
</g>
<!-- layer13_expert10_up&#45;&gt;layer13_expert10_act -->
<g id="edge1423" class="edge">
<title>layer13_expert10_up&#45;&gt;layer13_expert10_act</title>
<path fill="none" stroke="black" d="M9121.7,-3937.95C9078.44,-3927.27 9030.3,-3915.38 8986.34,-3904.53"/>
<polygon fill="black" stroke="black" points="8986.99,-3901.08 8976.44,-3902.08 8985.31,-3907.88 8986.99,-3901.08"/>
</g>
<!-- layer13_expert10_down -->
<g id="node1002" class="node">
<title>layer13_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8716,-3798 8333,-3798 8333,-3730 8716,-3730 8716,-3798"/>
<text text-anchor="middle" x="8524.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8524.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8524.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8524.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_expert10_act&#45;&gt;layer13_expert10_down -->
<g id="edge1424" class="edge">
<title>layer13_expert10_act&#45;&gt;layer13_expert10_down</title>
<path fill="none" stroke="black" d="M8739.25,-3833.88C8706.65,-3823.43 8670.47,-3811.82 8637.25,-3801.16"/>
<polygon fill="black" stroke="black" points="8638.09,-3797.76 8627.5,-3798.04 8635.95,-3804.42 8638.09,-3797.76"/>
</g>
<!-- layer13_expert10_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1425" class="edge">
<title>layer13_expert10_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M8332.85,-3746.12C8107.46,-3726.27 7725.98,-3692.66 7425.54,-3666.2"/>
<polygon fill="black" stroke="black" points="7425.61,-3662.69 7415.34,-3665.3 7424.99,-3669.67 7425.61,-3662.69"/>
</g>
<!-- layer13_expert11_act -->
<g id="node1005" class="node">
<title>layer13_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9866,-3902 9471,-3902 9471,-3834 9866,-3834 9866,-3902"/>
<text text-anchor="middle" x="9668.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9668.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9668.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9668.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_expert11_gate&#45;&gt;layer13_expert11_act -->
<g id="edge1428" class="edge">
<title>layer13_expert11_gate&#45;&gt;layer13_expert11_act</title>
<path fill="none" stroke="black" d="M9668.5,-3937.88C9668.5,-3929.78 9668.5,-3920.98 9668.5,-3912.47"/>
<polygon fill="black" stroke="black" points="9672,-3912.3 9668.5,-3902.3 9665,-3912.3 9672,-3912.3"/>
</g>
<!-- layer13_expert11_up&#45;&gt;layer13_expert11_act -->
<g id="edge1429" class="edge">
<title>layer13_expert11_up&#45;&gt;layer13_expert11_act</title>
<path fill="none" stroke="black" d="M9947.7,-3937.95C9904.44,-3927.27 9856.3,-3915.38 9812.34,-3904.53"/>
<polygon fill="black" stroke="black" points="9812.99,-3901.08 9802.44,-3902.08 9811.31,-3907.88 9812.99,-3901.08"/>
</g>
<!-- layer13_expert11_down -->
<g id="node1006" class="node">
<title>layer13_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9490,-3798 9107,-3798 9107,-3730 9490,-3730 9490,-3798"/>
<text text-anchor="middle" x="9298.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9298.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9298.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9298.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_expert11_act&#45;&gt;layer13_expert11_down -->
<g id="edge1430" class="edge">
<title>layer13_expert11_act&#45;&gt;layer13_expert11_down</title>
<path fill="none" stroke="black" d="M9548.63,-3833.95C9510.2,-3823.36 9467.47,-3811.58 9428.36,-3800.8"/>
<polygon fill="black" stroke="black" points="9429.07,-3797.36 9418.5,-3798.08 9427.21,-3804.11 9429.07,-3797.36"/>
</g>
<!-- layer13_expert11_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1431" class="edge">
<title>layer13_expert11_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M9106.84,-3751.75C8735.82,-3729.99 7911.55,-3681.63 7405.2,-3651.92"/>
<polygon fill="black" stroke="black" points="7405.35,-3648.42 7395.17,-3651.33 7404.94,-3655.41 7405.35,-3648.42"/>
</g>
<!-- layer13_expert12_act -->
<g id="node1009" class="node">
<title>layer13_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10692,-3902 10297,-3902 10297,-3834 10692,-3834 10692,-3902"/>
<text text-anchor="middle" x="10494.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10494.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10494.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10494.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_expert12_gate&#45;&gt;layer13_expert12_act -->
<g id="edge1434" class="edge">
<title>layer13_expert12_gate&#45;&gt;layer13_expert12_act</title>
<path fill="none" stroke="black" d="M10494.5,-3937.88C10494.5,-3929.78 10494.5,-3920.98 10494.5,-3912.47"/>
<polygon fill="black" stroke="black" points="10498,-3912.3 10494.5,-3902.3 10491,-3912.3 10498,-3912.3"/>
</g>
<!-- layer13_expert12_up&#45;&gt;layer13_expert12_act -->
<g id="edge1435" class="edge">
<title>layer13_expert12_up&#45;&gt;layer13_expert12_act</title>
<path fill="none" stroke="black" d="M10773.7,-3937.95C10730.44,-3927.27 10682.3,-3915.38 10638.34,-3904.53"/>
<polygon fill="black" stroke="black" points="10638.99,-3901.08 10628.44,-3902.08 10637.31,-3907.88 10638.99,-3901.08"/>
</g>
<!-- layer13_expert12_down -->
<g id="node1010" class="node">
<title>layer13_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10290,-3798 9907,-3798 9907,-3730 10290,-3730 10290,-3798"/>
<text text-anchor="middle" x="10098.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10098.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10098.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10098.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_expert12_act&#45;&gt;layer13_expert12_down -->
<g id="edge1436" class="edge">
<title>layer13_expert12_act&#45;&gt;layer13_expert12_down</title>
<path fill="none" stroke="black" d="M10366.2,-3833.95C10324.81,-3823.29 10278.76,-3811.43 10236.69,-3800.59"/>
<polygon fill="black" stroke="black" points="10237.49,-3797.19 10226.93,-3798.08 10235.74,-3803.96 10237.49,-3797.19"/>
</g>
<!-- layer13_expert12_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1437" class="edge">
<title>layer13_expert12_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M9906.67,-3751.74C9789.15,-3745.01 9635.65,-3736.53 9499.5,-3730 8756.75,-3694.36 7890.41,-3660.66 7391.65,-3642.02"/>
<polygon fill="black" stroke="black" points="7391.53,-3638.52 7381.41,-3641.64 7391.27,-3645.51 7391.53,-3638.52"/>
</g>
<!-- layer13_expert13_act -->
<g id="node1013" class="node">
<title>layer13_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11518,-3902 11123,-3902 11123,-3834 11518,-3834 11518,-3902"/>
<text text-anchor="middle" x="11320.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11320.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11320.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11320.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_expert13_gate&#45;&gt;layer13_expert13_act -->
<g id="edge1440" class="edge">
<title>layer13_expert13_gate&#45;&gt;layer13_expert13_act</title>
<path fill="none" stroke="black" d="M11320.5,-3937.88C11320.5,-3929.78 11320.5,-3920.98 11320.5,-3912.47"/>
<polygon fill="black" stroke="black" points="11324,-3912.3 11320.5,-3902.3 11317,-3912.3 11324,-3912.3"/>
</g>
<!-- layer13_expert13_up&#45;&gt;layer13_expert13_act -->
<g id="edge1441" class="edge">
<title>layer13_expert13_up&#45;&gt;layer13_expert13_act</title>
<path fill="none" stroke="black" d="M11599.7,-3937.95C11556.44,-3927.27 11508.3,-3915.38 11464.34,-3904.53"/>
<polygon fill="black" stroke="black" points="11464.99,-3901.08 11454.44,-3902.08 11463.31,-3907.88 11464.99,-3901.08"/>
</g>
<!-- layer13_expert13_down -->
<g id="node1014" class="node">
<title>layer13_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11103,-3798 10720,-3798 10720,-3730 11103,-3730 11103,-3798"/>
<text text-anchor="middle" x="10911.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10911.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10911.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10911.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_expert13_act&#45;&gt;layer13_expert13_down -->
<g id="edge1442" class="edge">
<title>layer13_expert13_act&#45;&gt;layer13_expert13_down</title>
<path fill="none" stroke="black" d="M11187.99,-3833.95C11145.15,-3823.27 11097.48,-3811.38 11053.95,-3800.53"/>
<polygon fill="black" stroke="black" points="11054.7,-3797.1 11044.15,-3798.08 11053,-3803.9 11054.7,-3797.1"/>
</g>
<!-- layer13_expert13_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1443" class="edge">
<title>layer13_expert13_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M10719.98,-3751.55C10599.35,-3744.61 10440.36,-3735.98 10299.5,-3730 9248.09,-3685.34 8008.53,-3652 7383.76,-3636.54"/>
<polygon fill="black" stroke="black" points="7383.78,-3633.04 7373.69,-3636.3 7383.6,-3640.04 7383.78,-3633.04"/>
</g>
<!-- layer13_expert14_act -->
<g id="node1017" class="node">
<title>layer13_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12344,-3902 11949,-3902 11949,-3834 12344,-3834 12344,-3902"/>
<text text-anchor="middle" x="12146.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12146.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12146.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12146.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_expert14_gate&#45;&gt;layer13_expert14_act -->
<g id="edge1446" class="edge">
<title>layer13_expert14_gate&#45;&gt;layer13_expert14_act</title>
<path fill="none" stroke="black" d="M12146.5,-3937.88C12146.5,-3929.78 12146.5,-3920.98 12146.5,-3912.47"/>
<polygon fill="black" stroke="black" points="12150,-3912.3 12146.5,-3902.3 12143,-3912.3 12150,-3912.3"/>
</g>
<!-- layer13_expert14_up&#45;&gt;layer13_expert14_act -->
<g id="edge1447" class="edge">
<title>layer13_expert14_up&#45;&gt;layer13_expert14_act</title>
<path fill="none" stroke="black" d="M12425.7,-3937.95C12382.44,-3927.27 12334.3,-3915.38 12290.34,-3904.53"/>
<polygon fill="black" stroke="black" points="12290.99,-3901.08 12280.44,-3902.08 12289.31,-3907.88 12290.99,-3901.08"/>
</g>
<!-- layer13_expert14_down -->
<g id="node1018" class="node">
<title>layer13_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11922,-3798 11539,-3798 11539,-3730 11922,-3730 11922,-3798"/>
<text text-anchor="middle" x="11730.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11730.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11730.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11730.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_expert14_act&#45;&gt;layer13_expert14_down -->
<g id="edge1448" class="edge">
<title>layer13_expert14_act&#45;&gt;layer13_expert14_down</title>
<path fill="none" stroke="black" d="M12011.72,-3833.95C11968.15,-3823.27 11919.66,-3811.38 11875.39,-3800.53"/>
<polygon fill="black" stroke="black" points="11875.96,-3797.06 11865.42,-3798.08 11874.3,-3803.86 11875.96,-3797.06"/>
</g>
<!-- layer13_expert14_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1449" class="edge">
<title>layer13_expert14_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M11538.83,-3751.36C11416.82,-3744.3 11255.43,-3735.6 11112.5,-3730 9742.85,-3676.37 8116.66,-3645.43 7379.32,-3633.17"/>
<polygon fill="black" stroke="black" points="7379.12,-3629.67 7369.07,-3633 7379.01,-3636.67 7379.12,-3629.67"/>
</g>
<!-- layer13_expert15_act -->
<g id="node1021" class="node">
<title>layer13_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13170,-3902 12775,-3902 12775,-3834 13170,-3834 13170,-3902"/>
<text text-anchor="middle" x="12972.5" y="-3886.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12972.5" y="-3871.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12972.5" y="-3856.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12972.5" y="-3841.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_expert15_gate&#45;&gt;layer13_expert15_act -->
<g id="edge1452" class="edge">
<title>layer13_expert15_gate&#45;&gt;layer13_expert15_act</title>
<path fill="none" stroke="black" d="M12972.5,-3937.88C12972.5,-3929.78 12972.5,-3920.98 12972.5,-3912.47"/>
<polygon fill="black" stroke="black" points="12976,-3912.3 12972.5,-3902.3 12969,-3912.3 12976,-3912.3"/>
</g>
<!-- layer13_expert15_up&#45;&gt;layer13_expert15_act -->
<g id="edge1453" class="edge">
<title>layer13_expert15_up&#45;&gt;layer13_expert15_act</title>
<path fill="none" stroke="black" d="M13251.7,-3937.95C13208.44,-3927.27 13160.3,-3915.38 13116.34,-3904.53"/>
<polygon fill="black" stroke="black" points="13116.99,-3901.08 13106.44,-3902.08 13115.31,-3907.88 13116.99,-3901.08"/>
</g>
<!-- layer13_expert15_down -->
<g id="node1022" class="node">
<title>layer13_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12745,-3798 12362,-3798 12362,-3730 12745,-3730 12745,-3798"/>
<text text-anchor="middle" x="12553.5" y="-3782.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12553.5" y="-3767.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12553.5" y="-3752.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12553.5" y="-3737.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_expert15_act&#45;&gt;layer13_expert15_down -->
<g id="edge1454" class="edge">
<title>layer13_expert15_act&#45;&gt;layer13_expert15_down</title>
<path fill="none" stroke="black" d="M12836.75,-3833.95C12792.77,-3823.25 12743.82,-3811.33 12699.15,-3800.46"/>
<polygon fill="black" stroke="black" points="12699.93,-3797.05 12689.39,-3798.08 12698.28,-3803.85 12699.93,-3797.05"/>
</g>
<!-- layer13_expert15_down&#45;&gt;layer13_token_aggregation -->
<g id="edge1455" class="edge">
<title>layer13_expert15_down&#45;&gt;layer13_token_aggregation</title>
<path fill="none" stroke="black" d="M12361.98,-3751.24C12239.02,-3744.09 12075.9,-3735.33 11931.5,-3730 10237.24,-3667.45 8215.33,-3640.15 7375.93,-3630.91"/>
<polygon fill="black" stroke="black" points="7375.84,-3627.4 7365.8,-3630.79 7375.76,-3634.4 7375.84,-3627.4"/>
</g>
<!-- layer13_res2 -->
<g id="node1024" class="node">
<title>layer13_res2</title>
<polygon fill="none" stroke="black" points="7421.24,-3522 6720.12,-3522 6539.76,-3356 7240.88,-3356 7421.24,-3522"/>
<text text-anchor="middle" x="6980.5" y="-3465.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6980.5" y="-3450.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3435.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3420.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3405.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_token_aggregation&#45;&gt;layer13_res2 -->
<g id="edge1456" class="edge">
<title>layer13_token_aggregation&#45;&gt;layer13_res2</title>
<path fill="none" stroke="black" d="M6980.5,-3557.95C6980.5,-3549.63 6980.5,-3541 6980.5,-3532.38"/>
<polygon fill="black" stroke="black" points="6984,-3532.28 6980.5,-3522.28 6977,-3532.28 6984,-3532.28"/>
</g>
<!-- layer14_mha_qkv -->
<g id="node1025" class="node">
<title>layer14_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7216.5,-3320 6744.5,-3320 6744.5,-3252 7216.5,-3252 7216.5,-3320"/>
<text text-anchor="middle" x="6980.5" y="-3304.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6980.5" y="-3289.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3274.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6980.5" y="-3259.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_res2&#45;&gt;layer14_mha_qkv -->
<g id="edge1457" class="edge">
<title>layer13_res2&#45;&gt;layer14_mha_qkv</title>
<path fill="none" stroke="black" d="M6980.5,-3355.87C6980.5,-3347.12 6980.5,-3338.48 6980.5,-3330.45"/>
<polygon fill="black" stroke="black" points="6984,-3330.26 6980.5,-3320.26 6977,-3330.26 6984,-3330.26"/>
</g>
<!-- layer14_mha_attn -->
<g id="node1026" class="node">
<title>layer14_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7210.5,-3216 6750.5,-3216 6750.5,-3148 7210.5,-3148 7210.5,-3216"/>
<text text-anchor="middle" x="6980.5" y="-3200.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6980.5" y="-3185.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6980.5" y="-3170.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3155.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_mha_qkv&#45;&gt;layer14_mha_attn -->
<g id="edge1458" class="edge">
<title>layer14_mha_qkv&#45;&gt;layer14_mha_attn</title>
<path fill="none" stroke="black" d="M6980.5,-3251.88C6980.5,-3243.78 6980.5,-3234.98 6980.5,-3226.47"/>
<polygon fill="black" stroke="black" points="6984,-3226.3 6980.5,-3216.3 6977,-3226.3 6984,-3226.3"/>
</g>
<!-- layer14_mha_out -->
<g id="node1027" class="node">
<title>layer14_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7193,-3112 6768,-3112 6768,-3044 7193,-3044 7193,-3112"/>
<text text-anchor="middle" x="6980.5" y="-3096.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6980.5" y="-3081.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3066.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-3051.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_mha_attn&#45;&gt;layer14_mha_out -->
<g id="edge1459" class="edge">
<title>layer14_mha_attn&#45;&gt;layer14_mha_out</title>
<path fill="none" stroke="black" d="M6980.5,-3147.88C6980.5,-3139.78 6980.5,-3130.98 6980.5,-3122.47"/>
<polygon fill="black" stroke="black" points="6984,-3122.3 6980.5,-3112.3 6977,-3122.3 6984,-3122.3"/>
</g>
<!-- layer14_res1 -->
<g id="node1028" class="node">
<title>layer14_res1</title>
<polygon fill="none" stroke="black" points="7421.24,-3008 6720.12,-3008 6539.76,-2842 7240.88,-2842 7421.24,-3008"/>
<text text-anchor="middle" x="6980.5" y="-2951.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6980.5" y="-2936.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2921.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2906.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2891.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_mha_out&#45;&gt;layer14_res1 -->
<g id="edge1460" class="edge">
<title>layer14_mha_out&#45;&gt;layer14_res1</title>
<path fill="none" stroke="black" d="M6980.5,-3043.86C6980.5,-3036.1 6980.5,-3027.46 6980.5,-3018.48"/>
<polygon fill="black" stroke="black" points="6984,-3018.23 6980.5,-3008.23 6977,-3018.23 6984,-3018.23"/>
</g>
<!-- layer14_ln1 -->
<g id="node1029" class="node">
<title>layer14_ln1</title>
<polygon fill="yellow" stroke="black" points="7193,-2806 6768,-2806 6768,-2738 7193,-2738 7193,-2806"/>
<text text-anchor="middle" x="6980.5" y="-2790.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6980.5" y="-2775.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2760.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2745.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_res1&#45;&gt;layer14_ln1 -->
<g id="edge1461" class="edge">
<title>layer14_res1&#45;&gt;layer14_ln1</title>
<path fill="none" stroke="black" d="M6980.5,-2841.87C6980.5,-2833.12 6980.5,-2824.48 6980.5,-2816.45"/>
<polygon fill="black" stroke="black" points="6984,-2816.26 6980.5,-2806.26 6977,-2816.26 6984,-2816.26"/>
</g>
<!-- layer14_expert_routing -->
<g id="node1030" class="node">
<title>layer14_expert_routing</title>
<polygon fill="orange" stroke="black" points="6980.5,-2702 6564.5,-2619 6980.5,-2536 7396.5,-2619 6980.5,-2702"/>
<text text-anchor="middle" x="6980.5" y="-2645.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6980.5" y="-2630.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6980.5" y="-2615.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2600.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6980.5" y="-2585.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_ln1&#45;&gt;layer14_expert_routing -->
<g id="edge1462" class="edge">
<title>layer14_ln1&#45;&gt;layer14_expert_routing</title>
<path fill="none" stroke="black" d="M6980.5,-2737.86C6980.5,-2730.1 6980.5,-2721.46 6980.5,-2712.48"/>
<polygon fill="black" stroke="black" points="6984,-2712.23 6980.5,-2702.23 6977,-2712.23 6984,-2712.23"/>
</g>
<!-- layer14_token_distribution -->
<g id="node1031" class="node">
<title>layer14_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7408.86,-2500 6727.44,-2500 6552.14,-2364 7233.56,-2364 7408.86,-2500"/>
<text text-anchor="middle" x="6980.5" y="-2450.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6980.5" y="-2435.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6980.5" y="-2420.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6980.5" y="-2405.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer14_expert_routing&#45;&gt;layer14_token_distribution -->
<g id="edge1463" class="edge">
<title>layer14_expert_routing&#45;&gt;layer14_token_distribution</title>
<path fill="none" stroke="black" d="M6980.5,-2535.78C6980.5,-2527.34 6980.5,-2518.79 6980.5,-2510.4"/>
<polygon fill="black" stroke="black" points="6984,-2510.28 6980.5,-2500.28 6977,-2510.28 6984,-2510.28"/>
</g>
<!-- layer14_expert0_gate -->
<g id="node1032" class="node">
<title>layer14_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="777,-2328 382,-2328 382,-2260 777,-2260 777,-2328"/>
<text text-anchor="middle" x="579.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="579.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="579.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="579.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert0_gate -->
<g id="edge1464" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6639.42,-2431.72C5518.99,-2433.09 1957.01,-2429.23 787.31,-2328.11"/>
<polygon fill="black" stroke="black" points="787.32,-2324.6 777.06,-2327.22 786.71,-2331.57 787.32,-2324.6"/>
</g>
<!-- layer14_expert0_up -->
<g id="node1033" class="node">
<title>layer14_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="1190,-2328 795,-2328 795,-2260 1190,-2260 1190,-2328"/>
<text text-anchor="middle" x="992.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="992.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="992.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="992.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert0_up -->
<g id="edge1465" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6638.42,-2431.24C5567.28,-2431 2285.27,-2422.44 1200.35,-2328.12"/>
<polygon fill="black" stroke="black" points="1200.32,-2324.6 1190.06,-2327.21 1199.71,-2331.57 1200.32,-2324.6"/>
</g>
<!-- layer14_expert1_gate -->
<g id="node1036" class="node">
<title>layer14_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1603,-2328 1208,-2328 1208,-2260 1603,-2260 1603,-2328"/>
<text text-anchor="middle" x="1405.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1405.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1405.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1405.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert1_gate -->
<g id="edge1470" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6637.86,-2430.69C5618.38,-2428.77 2613.69,-2415.69 1613.28,-2328.11"/>
<polygon fill="black" stroke="black" points="1613.33,-2324.6 1603.06,-2327.21 1612.71,-2331.57 1613.33,-2324.6"/>
</g>
<!-- layer14_expert1_up -->
<g id="node1037" class="node">
<title>layer14_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="2016,-2328 1621,-2328 1621,-2260 2016,-2260 2016,-2328"/>
<text text-anchor="middle" x="1818.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1818.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1818.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1818.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert1_up -->
<g id="edge1471" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6636.92,-2430.04C5670.86,-2426.35 2942.03,-2408.95 2026.08,-2328.09"/>
<polygon fill="black" stroke="black" points="2026.33,-2324.6 2016.06,-2327.2 2025.71,-2331.58 2026.33,-2324.6"/>
</g>
<!-- layer14_expert2_gate -->
<g id="node1040" class="node">
<title>layer14_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2429,-2328 2034,-2328 2034,-2260 2429,-2260 2429,-2328"/>
<text text-anchor="middle" x="2231.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2231.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2231.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2231.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert2_gate -->
<g id="edge1476" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6635.93,-2429.27C5725.78,-2423.72 3271.04,-2402.22 2439.07,-2328.1"/>
<polygon fill="black" stroke="black" points="2439.33,-2324.6 2429.06,-2327.19 2438.7,-2331.58 2439.33,-2324.6"/>
</g>
<!-- layer14_expert2_up -->
<g id="node1041" class="node">
<title>layer14_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2842,-2328 2447,-2328 2447,-2260 2842,-2260 2842,-2328"/>
<text text-anchor="middle" x="2644.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2644.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2644.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2644.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert2_up -->
<g id="edge1477" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6634.99,-2428.34C5783.65,-2420.84 3600.62,-2395.52 2852.16,-2328.1"/>
<polygon fill="black" stroke="black" points="2852.34,-2324.61 2842.06,-2327.18 2851.7,-2331.58 2852.34,-2324.61"/>
</g>
<!-- layer14_expert3_gate -->
<g id="node1044" class="node">
<title>layer14_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="3255,-2328 2860,-2328 2860,-2260 3255,-2260 3255,-2328"/>
<text text-anchor="middle" x="3057.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3057.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3057.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3057.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert3_gate -->
<g id="edge1482" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6633.41,-2427.2C5843.73,-2417.62 3930.42,-2388.84 3265.24,-2328.11"/>
<polygon fill="black" stroke="black" points="3265.34,-2324.61 3255.06,-2327.17 3264.7,-2331.58 3265.34,-2324.61"/>
</g>
<!-- layer14_expert3_up -->
<g id="node1045" class="node">
<title>layer14_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3668,-2328 3273,-2328 3273,-2260 3668,-2260 3668,-2328"/>
<text text-anchor="middle" x="3470.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3470.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3470.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3470.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert3_up -->
<g id="edge1483" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6631.52,-2425.77C5907.21,-2413.98 4260.46,-2382.17 3678.25,-2328.12"/>
<polygon fill="black" stroke="black" points="3678.35,-2324.61 3668.06,-2327.16 3677.69,-2331.58 3678.35,-2324.61"/>
</g>
<!-- layer14_expert4_gate -->
<g id="node1048" class="node">
<title>layer14_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="4081,-2328 3686,-2328 3686,-2260 4081,-2260 4081,-2328"/>
<text text-anchor="middle" x="3883.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3883.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3883.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3883.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert4_gate -->
<g id="edge1488" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6629.06,-2423.9C5974.59,-2409.8 4590.94,-2375.52 4091.26,-2328.12"/>
<polygon fill="black" stroke="black" points="4091.35,-2324.62 4081.06,-2327.14 4090.68,-2331.58 4091.35,-2324.62"/>
</g>
<!-- layer14_expert4_up -->
<g id="node1049" class="node">
<title>layer14_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4494,-2328 4099,-2328 4099,-2260 4494,-2260 4494,-2328"/>
<text text-anchor="middle" x="4296.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="4296.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4296.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4296.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert4_up -->
<g id="edge1489" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6636.37,-2429.42C6159.11,-2424.35 5269.47,-2404.49 4504.19,-2328.13"/>
<polygon fill="black" stroke="black" points="4504.36,-2324.63 4494.07,-2327.12 4503.67,-2331.6 4504.36,-2324.63"/>
</g>
<!-- layer14_expert5_gate -->
<g id="node1052" class="node">
<title>layer14_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4907,-2328 4512,-2328 4512,-2260 4907,-2260 4907,-2328"/>
<text text-anchor="middle" x="4709.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4709.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4709.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4709.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert5_gate -->
<g id="edge1494" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6630.68,-2425.16C6221.56,-2415.67 5524.04,-2391.18 4917.34,-2328.16"/>
<polygon fill="black" stroke="black" points="4917.38,-2324.64 4907.07,-2327.09 4916.65,-2331.61 4917.38,-2324.64"/>
</g>
<!-- layer14_expert5_up -->
<g id="node1053" class="node">
<title>layer14_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="5320,-2328 4925,-2328 4925,-2260 5320,-2260 5320,-2328"/>
<text text-anchor="middle" x="5122.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="5122.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5122.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5122.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert5_up -->
<g id="edge1495" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6622.34,-2418.65C6289.6,-2404.84 5780.32,-2377.72 5330.03,-2328.14"/>
<polygon fill="black" stroke="black" points="5330.4,-2324.66 5320.07,-2327.04 5329.63,-2331.62 5330.4,-2324.66"/>
</g>
<!-- layer14_expert6_gate -->
<g id="node1056" class="node">
<title>layer14_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5733,-2328 5338,-2328 5338,-2260 5733,-2260 5733,-2328"/>
<text text-anchor="middle" x="5535.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5535.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5535.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5535.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert6_gate -->
<g id="edge1500" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6608.03,-2407.44C6364.4,-2390.23 6039.1,-2363.86 5743.16,-2328.18"/>
<polygon fill="black" stroke="black" points="5743.43,-2324.68 5733.08,-2326.96 5742.59,-2331.63 5743.43,-2324.68"/>
</g>
<!-- layer14_expert6_up -->
<g id="node1057" class="node">
<title>layer14_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="6146,-2328 5751,-2328 5751,-2260 6146,-2260 6146,-2328"/>
<text text-anchor="middle" x="5948.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5948.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5948.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5948.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert6_up -->
<g id="edge1501" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6577.33,-2383.57C6445.89,-2367.37 6299.08,-2348.49 6156.37,-2328.25"/>
<polygon fill="black" stroke="black" points="6156.5,-2324.74 6146.11,-2326.79 6155.51,-2331.67 6156.5,-2324.74"/>
</g>
<!-- layer14_expert7_gate -->
<g id="node1060" class="node">
<title>layer14_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6559,-2328 6164,-2328 6164,-2260 6559,-2260 6559,-2328"/>
<text text-anchor="middle" x="6361.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="6361.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6361.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6361.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert7_gate -->
<g id="edge1506" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6675.53,-2364C6622.4,-2352.32 6569.09,-2340.61 6521.86,-2330.23"/>
<polygon fill="black" stroke="black" points="6522.4,-2326.77 6511.88,-2328.04 6520.89,-2333.6 6522.4,-2326.77"/>
</g>
<!-- layer14_expert7_up -->
<g id="node1061" class="node">
<title>layer14_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6972,-2328 6577,-2328 6577,-2260 6972,-2260 6972,-2328"/>
<text text-anchor="middle" x="6774.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6774.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6774.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6774.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert7_up -->
<g id="edge1507" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6879.01,-2364C6863.37,-2353.67 6847.68,-2343.31 6833.38,-2333.87"/>
<polygon fill="black" stroke="black" points="6834.95,-2330.72 6824.68,-2328.13 6831.1,-2336.56 6834.95,-2330.72"/>
</g>
<!-- layer14_expert8_gate -->
<g id="node1064" class="node">
<title>layer14_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7385,-2328 6990,-2328 6990,-2260 7385,-2260 7385,-2328"/>
<text text-anchor="middle" x="7187.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="7187.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7187.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7187.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert8_gate -->
<g id="edge1512" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7082.48,-2364C7098.2,-2353.67 7113.97,-2343.31 7128.33,-2333.87"/>
<polygon fill="black" stroke="black" points="7130.64,-2336.54 7137.08,-2328.13 7126.8,-2330.69 7130.64,-2336.54"/>
</g>
<!-- layer14_expert8_up -->
<g id="node1065" class="node">
<title>layer14_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7798,-2328 7403,-2328 7403,-2260 7798,-2260 7798,-2328"/>
<text text-anchor="middle" x="7600.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7600.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7600.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7600.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert8_up -->
<g id="edge1513" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7245.23,-2372.93C7311.49,-2358.4 7380.56,-2343.25 7439.99,-2330.21"/>
<polygon fill="black" stroke="black" points="7440.81,-2333.61 7449.82,-2328.05 7439.31,-2326.78 7440.81,-2333.61"/>
</g>
<!-- layer14_expert9_gate -->
<g id="node1068" class="node">
<title>layer14_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="8211,-2328 7816,-2328 7816,-2260 8211,-2260 8211,-2328"/>
<text text-anchor="middle" x="8013.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="8013.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8013.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8013.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert9_gate -->
<g id="edge1518" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7276.03,-2396.73C7431.07,-2378.13 7624.37,-2353.94 7805.89,-2328.22"/>
<polygon fill="black" stroke="black" points="7806.49,-2331.67 7815.89,-2326.8 7805.5,-2324.74 7806.49,-2331.67"/>
</g>
<!-- layer14_expert9_up -->
<g id="node1069" class="node">
<title>layer14_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8624,-2328 8229,-2328 8229,-2260 8624,-2260 8624,-2328"/>
<text text-anchor="middle" x="8426.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8426.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8426.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8426.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert9_up -->
<g id="edge1519" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7294.91,-2411.51C7543.39,-2394.52 7899.09,-2366.72 8218.99,-2328.16"/>
<polygon fill="black" stroke="black" points="8219.41,-2331.63 8228.92,-2326.96 8218.57,-2324.68 8219.41,-2331.63"/>
</g>
<!-- layer14_expert10_gate -->
<g id="node1072" class="node">
<title>layer14_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="9037,-2328 8642,-2328 8642,-2260 9037,-2260 9037,-2328"/>
<text text-anchor="middle" x="8839.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8839.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8839.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8839.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert10_gate -->
<g id="edge1524" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7305.93,-2420.01C7637.51,-2406.65 8166.55,-2379.38 8631.98,-2328.14"/>
<polygon fill="black" stroke="black" points="8632.37,-2331.62 8641.93,-2327.04 8631.6,-2324.66 8632.37,-2331.62"/>
</g>
<!-- layer14_expert10_up -->
<g id="node1073" class="node">
<title>layer14_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9450,-2328 9055,-2328 9055,-2260 9450,-2260 9450,-2328"/>
<text text-anchor="middle" x="9252.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="9252.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9252.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9252.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert10_up -->
<g id="edge1525" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7313.24,-2425.57C7720.05,-2416.37 8429.4,-2392.08 9044.97,-2328.13"/>
<polygon fill="black" stroke="black" points="9045.35,-2331.61 9054.93,-2327.09 9044.62,-2324.64 9045.35,-2331.61"/>
</g>
<!-- layer14_expert11_gate -->
<g id="node1076" class="node">
<title>layer14_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9863,-2328 9468,-2328 9468,-2260 9863,-2260 9863,-2328"/>
<text text-anchor="middle" x="9665.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9665.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9665.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9665.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert11_gate -->
<g id="edge1530" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.2,-2429.5C7794.01,-2424.55 8688.7,-2404.86 9457.76,-2328.14"/>
<polygon fill="black" stroke="black" points="9458.33,-2331.6 9467.93,-2327.12 9457.64,-2324.63 9458.33,-2331.6"/>
</g>
<!-- layer14_expert11_up -->
<g id="node1077" class="node">
<title>layer14_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="10276,-2328 9881,-2328 9881,-2260 10276,-2260 10276,-2328"/>
<text text-anchor="middle" x="10078.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="10078.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10078.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10078.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert11_up -->
<g id="edge1531" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7311.5,-2424.35C7957.28,-2410.53 9365.47,-2376.03 9870.63,-2328.13"/>
<polygon fill="black" stroke="black" points="9871.32,-2331.58 9880.94,-2327.14 9870.65,-2324.62 9871.32,-2331.58"/>
</g>
<!-- layer14_expert12_gate -->
<g id="node1080" class="node">
<title>layer14_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10689,-2328 10294,-2328 10294,-2260 10689,-2260 10689,-2328"/>
<text text-anchor="middle" x="10491.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10491.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10491.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10491.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert12_gate -->
<g id="edge1536" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7313.83,-2426.02C8029.92,-2414.46 9697.02,-2382.58 10283.68,-2328.13"/>
<polygon fill="black" stroke="black" points="10284.31,-2331.58 10293.94,-2327.16 10283.65,-2324.61 10284.31,-2331.58"/>
</g>
<!-- layer14_expert12_up -->
<g id="node1081" class="node">
<title>layer14_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="11102,-2328 10707,-2328 10707,-2260 11102,-2260 11102,-2328"/>
<text text-anchor="middle" x="10904.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10904.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10904.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10904.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert12_up -->
<g id="edge1537" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7315.57,-2427.35C8097.82,-2417.92 10027.91,-2389.16 10696.7,-2328.12"/>
<polygon fill="black" stroke="black" points="10697.3,-2331.58 10706.94,-2327.17 10696.66,-2324.61 10697.3,-2331.58"/>
</g>
<!-- layer14_expert13_gate -->
<g id="node1084" class="node">
<title>layer14_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11515,-2328 11120,-2328 11120,-2260 11515,-2260 11515,-2328"/>
<text text-anchor="middle" x="11317.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="11317.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11317.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11317.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert13_gate -->
<g id="edge1542" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7316.74,-2428.43C8161.52,-2421.03 10358.4,-2395.78 11109.8,-2328.11"/>
<polygon fill="black" stroke="black" points="11110.3,-2331.58 11119.94,-2327.18 11109.66,-2324.61 11110.3,-2331.58"/>
</g>
<!-- layer14_expert13_up -->
<g id="node1085" class="node">
<title>layer14_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11928,-2328 11533,-2328 11533,-2260 11928,-2260 11928,-2328"/>
<text text-anchor="middle" x="11730.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11730.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11730.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11730.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert13_up -->
<g id="edge1543" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.14,-2429.31C8222.83,-2423.84 10688.6,-2402.43 11522.9,-2328.1"/>
<polygon fill="black" stroke="black" points="11523.3,-2331.58 11532.94,-2327.19 11522.67,-2324.6 11523.3,-2331.58"/>
</g>
<!-- layer14_expert14_gate -->
<g id="node1088" class="node">
<title>layer14_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="12341,-2328 11946,-2328 11946,-2260 12341,-2260 12341,-2328"/>
<text text-anchor="middle" x="12143.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="12143.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12143.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12143.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert14_gate -->
<g id="edge1548" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.95,-2430.06C8280.58,-2426.42 11018.12,-2409.11 11935.9,-2328.1"/>
<polygon fill="black" stroke="black" points="11936.29,-2331.58 11945.94,-2327.2 11935.67,-2324.6 11936.29,-2331.58"/>
</g>
<!-- layer14_expert14_up -->
<g id="node1089" class="node">
<title>layer14_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12754,-2328 12359,-2328 12359,-2260 12754,-2260 12754,-2328"/>
<text text-anchor="middle" x="12556.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12556.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12556.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12556.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert14_up -->
<g id="edge1549" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7319.58,-2430.7C8335.74,-2428.8 11346.92,-2415.81 12348.71,-2328.11"/>
<polygon fill="black" stroke="black" points="12349.29,-2331.57 12358.94,-2327.21 12348.67,-2324.6 12349.29,-2331.57"/>
</g>
<!-- layer14_expert15_gate -->
<g id="node1092" class="node">
<title>layer14_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="13167,-2328 12772,-2328 12772,-2260 13167,-2260 13167,-2328"/>
<text text-anchor="middle" x="12969.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12969.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12969.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12969.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert15_gate -->
<g id="edge1554" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.27,-2431.24C8389.13,-2431.02 11675.73,-2422.53 12761.64,-2328.12"/>
<polygon fill="black" stroke="black" points="12762.29,-2331.57 12771.94,-2327.21 12761.68,-2324.6 12762.29,-2331.57"/>
</g>
<!-- layer14_expert15_up -->
<g id="node1093" class="node">
<title>layer14_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13580,-2328 13185,-2328 13185,-2260 13580,-2260 13580,-2328"/>
<text text-anchor="middle" x="13382.5" y="-2312.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13382.5" y="-2297.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13382.5" y="-2282.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13382.5" y="-2267.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_token_distribution&#45;&gt;layer14_expert15_up -->
<g id="edge1555" class="edge">
<title>layer14_token_distribution&#45;&gt;layer14_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.15,-2431.72C8441.21,-2433.1 12004.63,-2429.26 13174.69,-2328.11"/>
<polygon fill="black" stroke="black" points="13175.29,-2331.57 13184.94,-2327.22 13174.68,-2324.6 13175.29,-2331.57"/>
</g>
<!-- layer14_expert0_act -->
<g id="node1034" class="node">
<title>layer14_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="1190,-2224 795,-2224 795,-2156 1190,-2156 1190,-2224"/>
<text text-anchor="middle" x="992.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="992.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="992.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="992.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer14_expert0_gate&#45;&gt;layer14_expert0_act -->
<g id="edge1466" class="edge">
<title>layer14_expert0_gate&#45;&gt;layer14_expert0_act</title>
<path fill="none" stroke="black" d="M713.3,-2259.95C756.56,-2249.27 804.7,-2237.38 848.66,-2226.53"/>
<polygon fill="black" stroke="black" points="849.69,-2229.88 858.56,-2224.08 848.01,-2223.08 849.69,-2229.88"/>
</g>
<!-- layer14_expert0_up&#45;&gt;layer14_expert0_act -->
<g id="edge1467" class="edge">
<title>layer14_expert0_up&#45;&gt;layer14_expert0_act</title>
<path fill="none" stroke="black" d="M992.5,-2259.88C992.5,-2251.78 992.5,-2242.98 992.5,-2234.47"/>
<polygon fill="black" stroke="black" points="996,-2234.3 992.5,-2224.3 989,-2234.3 996,-2234.3"/>
</g>
<!-- layer14_expert0_down -->
<g id="node1035" class="node">
<title>layer14_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1609,-2120 1226,-2120 1226,-2052 1609,-2052 1609,-2120"/>
<text text-anchor="middle" x="1417.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1417.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1417.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1417.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer14_expert0_act&#45;&gt;layer14_expert0_down -->
<g id="edge1468" class="edge">
<title>layer14_expert0_act&#45;&gt;layer14_expert0_down</title>
<path fill="none" stroke="black" d="M1130.19,-2155.95C1174.8,-2145.25 1224.45,-2133.33 1269.76,-2122.46"/>
<polygon fill="black" stroke="black" points="1270.76,-2125.82 1279.66,-2120.08 1269.12,-2119.01 1270.76,-2125.82"/>
</g>
<!-- layer14_token_aggregation -->
<g id="node1096" class="node">
<title>layer14_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7453.24,-2016 6696.44,-2016 6501.76,-1880 7258.56,-1880 7453.24,-2016"/>
<text text-anchor="middle" x="6977.5" y="-1966.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6977.5" y="-1951.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6977.5" y="-1936.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1921.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_expert0_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1469" class="edge">
<title>layer14_expert0_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M1609.14,-2067.25C1678.5,-2061.46 1757.47,-2055.6 1829.5,-2052 3606.48,-1963.14 5732.12,-1950.19 6590.16,-1948.83"/>
<polygon fill="black" stroke="black" points="6590.2,-1952.33 6600.2,-1948.81 6590.19,-1945.33 6590.2,-1952.33"/>
</g>
<!-- layer14_expert1_act -->
<g id="node1038" class="node">
<title>layer14_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="2016,-2224 1621,-2224 1621,-2156 2016,-2156 2016,-2224"/>
<text text-anchor="middle" x="1818.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1818.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1818.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1818.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer14_expert1_gate&#45;&gt;layer14_expert1_act -->
<g id="edge1472" class="edge">
<title>layer14_expert1_gate&#45;&gt;layer14_expert1_act</title>
<path fill="none" stroke="black" d="M1539.3,-2259.95C1582.56,-2249.27 1630.7,-2237.38 1674.66,-2226.53"/>
<polygon fill="black" stroke="black" points="1675.69,-2229.88 1684.56,-2224.08 1674.01,-2223.08 1675.69,-2229.88"/>
</g>
<!-- layer14_expert1_up&#45;&gt;layer14_expert1_act -->
<g id="edge1473" class="edge">
<title>layer14_expert1_up&#45;&gt;layer14_expert1_act</title>
<path fill="none" stroke="black" d="M1818.5,-2259.88C1818.5,-2251.78 1818.5,-2242.98 1818.5,-2234.47"/>
<polygon fill="black" stroke="black" points="1822,-2234.3 1818.5,-2224.3 1815,-2234.3 1822,-2234.3"/>
</g>
<!-- layer14_expert1_down -->
<g id="node1039" class="node">
<title>layer14_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2222,-2120 1839,-2120 1839,-2052 2222,-2052 2222,-2120"/>
<text text-anchor="middle" x="2030.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2030.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2030.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2030.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer14_expert1_act&#45;&gt;layer14_expert1_down -->
<g id="edge1474" class="edge">
<title>layer14_expert1_act&#45;&gt;layer14_expert1_down</title>
<path fill="none" stroke="black" d="M1887.33,-2155.88C1908.17,-2145.86 1931.21,-2134.77 1952.6,-2124.48"/>
<polygon fill="black" stroke="black" points="1954.16,-2127.61 1961.65,-2120.12 1951.12,-2121.31 1954.16,-2127.61"/>
</g>
<!-- layer14_expert1_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1475" class="edge">
<title>layer14_expert1_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M2222.15,-2074.43C2358.13,-2067.24 2544.97,-2057.98 2709.5,-2052 4145.26,-1999.79 5853.72,-1967.59 6598.74,-1955.04"/>
<polygon fill="black" stroke="black" points="6598.89,-1958.53 6608.82,-1954.87 6598.77,-1951.53 6598.89,-1958.53"/>
</g>
<!-- layer14_expert2_act -->
<g id="node1042" class="node">
<title>layer14_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2842,-2224 2447,-2224 2447,-2156 2842,-2156 2842,-2224"/>
<text text-anchor="middle" x="2644.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2644.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2644.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2644.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer14_expert2_gate&#45;&gt;layer14_expert2_act -->
<g id="edge1478" class="edge">
<title>layer14_expert2_gate&#45;&gt;layer14_expert2_act</title>
<path fill="none" stroke="black" d="M2365.3,-2259.95C2408.56,-2249.27 2456.7,-2237.38 2500.66,-2226.53"/>
<polygon fill="black" stroke="black" points="2501.69,-2229.88 2510.56,-2224.08 2500.01,-2223.08 2501.69,-2229.88"/>
</g>
<!-- layer14_expert2_up&#45;&gt;layer14_expert2_act -->
<g id="edge1479" class="edge">
<title>layer14_expert2_up&#45;&gt;layer14_expert2_act</title>
<path fill="none" stroke="black" d="M2644.5,-2259.88C2644.5,-2251.78 2644.5,-2242.98 2644.5,-2234.47"/>
<polygon fill="black" stroke="black" points="2648,-2234.3 2644.5,-2224.3 2641,-2234.3 2648,-2234.3"/>
</g>
<!-- layer14_expert2_down -->
<g id="node1043" class="node">
<title>layer14_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3102,-2120 2719,-2120 2719,-2052 3102,-2052 3102,-2120"/>
<text text-anchor="middle" x="2910.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="2910.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2910.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2910.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer14_expert2_act&#45;&gt;layer14_expert2_down -->
<g id="edge1480" class="edge">
<title>layer14_expert2_act&#45;&gt;layer14_expert2_down</title>
<path fill="none" stroke="black" d="M2730.86,-2155.88C2757.6,-2145.63 2787.21,-2134.28 2814.55,-2123.79"/>
<polygon fill="black" stroke="black" points="2816.03,-2126.97 2824.12,-2120.12 2813.53,-2120.44 2816.03,-2126.97"/>
</g>
<!-- layer14_expert2_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1481" class="edge">
<title>layer14_expert2_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M3102.07,-2069.71C3187.01,-2063.4 3288.19,-2056.52 3379.5,-2052 4552.31,-1993.98 5941.91,-1965.64 6598.17,-1954.67"/>
<polygon fill="black" stroke="black" points="6598.32,-1958.17 6608.26,-1954.5 6598.2,-1951.17 6598.32,-1958.17"/>
</g>
<!-- layer14_expert3_act -->
<g id="node1046" class="node">
<title>layer14_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3668,-2224 3273,-2224 3273,-2156 3668,-2156 3668,-2224"/>
<text text-anchor="middle" x="3470.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3470.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3470.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3470.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer14_expert3_gate&#45;&gt;layer14_expert3_act -->
<g id="edge1484" class="edge">
<title>layer14_expert3_gate&#45;&gt;layer14_expert3_act</title>
<path fill="none" stroke="black" d="M3191.3,-2259.95C3234.56,-2249.27 3282.7,-2237.38 3326.66,-2226.53"/>
<polygon fill="black" stroke="black" points="3327.69,-2229.88 3336.56,-2224.08 3326.01,-2223.08 3327.69,-2229.88"/>
</g>
<!-- layer14_expert3_up&#45;&gt;layer14_expert3_act -->
<g id="edge1485" class="edge">
<title>layer14_expert3_up&#45;&gt;layer14_expert3_act</title>
<path fill="none" stroke="black" d="M3470.5,-2259.88C3470.5,-2251.78 3470.5,-2242.98 3470.5,-2234.47"/>
<polygon fill="black" stroke="black" points="3474,-2234.3 3470.5,-2224.3 3467,-2234.3 3474,-2234.3"/>
</g>
<!-- layer14_expert3_down -->
<g id="node1047" class="node">
<title>layer14_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3772,-2120 3389,-2120 3389,-2052 3772,-2052 3772,-2120"/>
<text text-anchor="middle" x="3580.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3580.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3580.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3580.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer14_expert3_act&#45;&gt;layer14_expert3_down -->
<g id="edge1486" class="edge">
<title>layer14_expert3_act&#45;&gt;layer14_expert3_down</title>
<path fill="none" stroke="black" d="M3506.21,-2155.88C3516.11,-2146.71 3526.96,-2136.65 3537.23,-2127.12"/>
<polygon fill="black" stroke="black" points="3539.64,-2129.67 3544.59,-2120.3 3534.88,-2124.53 3539.64,-2129.67"/>
</g>
<!-- layer14_expert3_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1487" class="edge">
<title>layer14_expert3_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M3772.26,-2077.32C4318.84,-2055.44 5891.51,-1992.48 6610.68,-1963.69"/>
<polygon fill="black" stroke="black" points="6610.83,-1967.18 6620.68,-1963.29 6610.55,-1960.19 6610.83,-1967.18"/>
</g>
<!-- layer14_expert4_act -->
<g id="node1050" class="node">
<title>layer14_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4494,-2224 4099,-2224 4099,-2156 4494,-2156 4494,-2224"/>
<text text-anchor="middle" x="4296.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="4296.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4296.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4296.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer14_expert4_gate&#45;&gt;layer14_expert4_act -->
<g id="edge1490" class="edge">
<title>layer14_expert4_gate&#45;&gt;layer14_expert4_act</title>
<path fill="none" stroke="black" d="M4017.3,-2259.95C4060.56,-2249.27 4108.7,-2237.38 4152.66,-2226.53"/>
<polygon fill="black" stroke="black" points="4153.69,-2229.88 4162.56,-2224.08 4152.01,-2223.08 4153.69,-2229.88"/>
</g>
<!-- layer14_expert4_up&#45;&gt;layer14_expert4_act -->
<g id="edge1491" class="edge">
<title>layer14_expert4_up&#45;&gt;layer14_expert4_act</title>
<path fill="none" stroke="black" d="M4296.5,-2259.88C4296.5,-2251.78 4296.5,-2242.98 4296.5,-2234.47"/>
<polygon fill="black" stroke="black" points="4300,-2234.3 4296.5,-2224.3 4293,-2234.3 4300,-2234.3"/>
</g>
<!-- layer14_expert4_down -->
<g id="node1051" class="node">
<title>layer14_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="5023,-2120 4640,-2120 4640,-2052 5023,-2052 5023,-2120"/>
<text text-anchor="middle" x="4831.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4831.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4831.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4831.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer14_expert4_act&#45;&gt;layer14_expert4_down -->
<g id="edge1492" class="edge">
<title>layer14_expert4_act&#45;&gt;layer14_expert4_down</title>
<path fill="none" stroke="black" d="M4469.83,-2155.95C4526.81,-2145.09 4590.33,-2132.98 4648.03,-2121.98"/>
<polygon fill="black" stroke="black" points="4648.82,-2125.39 4657.99,-2120.08 4647.51,-2118.52 4648.82,-2125.39"/>
</g>
<!-- layer14_expert4_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1493" class="edge">
<title>layer14_expert4_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M5023.36,-2072.84C5382.96,-2050.05 6163.31,-2000.6 6621.65,-1971.55"/>
<polygon fill="black" stroke="black" points="6621.99,-1975.04 6631.75,-1970.91 6621.54,-1968.05 6621.99,-1975.04"/>
</g>
<!-- layer14_expert5_act -->
<g id="node1054" class="node">
<title>layer14_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="5320,-2224 4925,-2224 4925,-2156 5320,-2156 5320,-2224"/>
<text text-anchor="middle" x="5122.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="5122.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5122.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5122.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer14_expert5_gate&#45;&gt;layer14_expert5_act -->
<g id="edge1496" class="edge">
<title>layer14_expert5_gate&#45;&gt;layer14_expert5_act</title>
<path fill="none" stroke="black" d="M4843.3,-2259.95C4886.56,-2249.27 4934.7,-2237.38 4978.66,-2226.53"/>
<polygon fill="black" stroke="black" points="4979.69,-2229.88 4988.56,-2224.08 4978.01,-2223.08 4979.69,-2229.88"/>
</g>
<!-- layer14_expert5_up&#45;&gt;layer14_expert5_act -->
<g id="edge1497" class="edge">
<title>layer14_expert5_up&#45;&gt;layer14_expert5_act</title>
<path fill="none" stroke="black" d="M5122.5,-2259.88C5122.5,-2251.78 5122.5,-2242.98 5122.5,-2234.47"/>
<polygon fill="black" stroke="black" points="5126,-2234.3 5122.5,-2224.3 5119,-2234.3 5126,-2234.3"/>
</g>
<!-- layer14_expert5_down -->
<g id="node1055" class="node">
<title>layer14_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5849,-2120 5466,-2120 5466,-2052 5849,-2052 5849,-2120"/>
<text text-anchor="middle" x="5657.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="5657.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5657.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5657.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer14_expert5_act&#45;&gt;layer14_expert5_down -->
<g id="edge1498" class="edge">
<title>layer14_expert5_act&#45;&gt;layer14_expert5_down</title>
<path fill="none" stroke="black" d="M5295.83,-2155.95C5352.81,-2145.09 5416.33,-2132.98 5474.03,-2121.98"/>
<polygon fill="black" stroke="black" points="5474.82,-2125.39 5483.99,-2120.08 5473.51,-2118.52 5474.82,-2125.39"/>
</g>
<!-- layer14_expert5_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1499" class="edge">
<title>layer14_expert5_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M5849.09,-2065.26C6055.49,-2044 6388.01,-2009.74 6638.74,-1983.9"/>
<polygon fill="black" stroke="black" points="6639.15,-1987.38 6648.74,-1982.87 6638.43,-1980.42 6639.15,-1987.38"/>
</g>
<!-- layer14_expert6_act -->
<g id="node1058" class="node">
<title>layer14_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="6146,-2224 5751,-2224 5751,-2156 6146,-2156 6146,-2224"/>
<text text-anchor="middle" x="5948.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5948.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5948.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5948.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer14_expert6_gate&#45;&gt;layer14_expert6_act -->
<g id="edge1502" class="edge">
<title>layer14_expert6_gate&#45;&gt;layer14_expert6_act</title>
<path fill="none" stroke="black" d="M5669.3,-2259.95C5712.56,-2249.27 5760.7,-2237.38 5804.66,-2226.53"/>
<polygon fill="black" stroke="black" points="5805.69,-2229.88 5814.56,-2224.08 5804.01,-2223.08 5805.69,-2229.88"/>
</g>
<!-- layer14_expert6_up&#45;&gt;layer14_expert6_act -->
<g id="edge1503" class="edge">
<title>layer14_expert6_up&#45;&gt;layer14_expert6_act</title>
<path fill="none" stroke="black" d="M5948.5,-2259.88C5948.5,-2251.78 5948.5,-2242.98 5948.5,-2234.47"/>
<polygon fill="black" stroke="black" points="5952,-2234.3 5948.5,-2224.3 5945,-2234.3 5952,-2234.3"/>
</g>
<!-- layer14_expert6_down -->
<g id="node1059" class="node">
<title>layer14_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="6462,-2120 6079,-2120 6079,-2052 6462,-2052 6462,-2120"/>
<text text-anchor="middle" x="6270.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6270.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6270.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6270.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer14_expert6_act&#45;&gt;layer14_expert6_down -->
<g id="edge1504" class="edge">
<title>layer14_expert6_act&#45;&gt;layer14_expert6_down</title>
<path fill="none" stroke="black" d="M6053.04,-2155.88C6086.05,-2145.43 6122.69,-2133.82 6156.34,-2123.16"/>
<polygon fill="black" stroke="black" points="6157.73,-2126.39 6166.21,-2120.04 6155.62,-2119.72 6157.73,-2126.39"/>
</g>
<!-- layer14_expert6_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1505" class="edge">
<title>layer14_expert6_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M6442.1,-2051.99C6511.18,-2038.7 6592.99,-2022.96 6671.61,-2007.84"/>
<polygon fill="black" stroke="black" points="6672.52,-2011.23 6681.68,-2005.9 6671.2,-2004.36 6672.52,-2011.23"/>
</g>
<!-- layer14_expert7_act -->
<g id="node1062" class="node">
<title>layer14_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6972,-2224 6577,-2224 6577,-2156 6972,-2156 6972,-2224"/>
<text text-anchor="middle" x="6774.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6774.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6774.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6774.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer14_expert7_gate&#45;&gt;layer14_expert7_act -->
<g id="edge1508" class="edge">
<title>layer14_expert7_gate&#45;&gt;layer14_expert7_act</title>
<path fill="none" stroke="black" d="M6495.3,-2259.95C6538.56,-2249.27 6586.7,-2237.38 6630.66,-2226.53"/>
<polygon fill="black" stroke="black" points="6631.69,-2229.88 6640.56,-2224.08 6630.01,-2223.08 6631.69,-2229.88"/>
</g>
<!-- layer14_expert7_up&#45;&gt;layer14_expert7_act -->
<g id="edge1509" class="edge">
<title>layer14_expert7_up&#45;&gt;layer14_expert7_act</title>
<path fill="none" stroke="black" d="M6774.5,-2259.88C6774.5,-2251.78 6774.5,-2242.98 6774.5,-2234.47"/>
<polygon fill="black" stroke="black" points="6778,-2234.3 6774.5,-2224.3 6771,-2234.3 6778,-2234.3"/>
</g>
<!-- layer14_expert7_down -->
<g id="node1063" class="node">
<title>layer14_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6969,-2120 6586,-2120 6586,-2052 6969,-2052 6969,-2120"/>
<text text-anchor="middle" x="6777.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6777.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6777.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6777.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer14_expert7_act&#45;&gt;layer14_expert7_down -->
<g id="edge1510" class="edge">
<title>layer14_expert7_act&#45;&gt;layer14_expert7_down</title>
<path fill="none" stroke="black" d="M6775.47,-2155.88C6775.71,-2147.78 6775.97,-2138.98 6776.22,-2130.47"/>
<polygon fill="black" stroke="black" points="6779.73,-2130.4 6776.52,-2120.3 6772.73,-2130.19 6779.73,-2130.4"/>
</g>
<!-- layer14_expert7_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1511" class="edge">
<title>layer14_expert7_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M6826.17,-2051.9C6839.63,-2042.75 6854.8,-2032.44 6870.2,-2021.97"/>
<polygon fill="black" stroke="black" points="6872.47,-2024.66 6878.77,-2016.14 6868.53,-2018.87 6872.47,-2024.66"/>
</g>
<!-- layer14_expert8_act -->
<g id="node1066" class="node">
<title>layer14_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7385,-2224 6990,-2224 6990,-2156 7385,-2156 7385,-2224"/>
<text text-anchor="middle" x="7187.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="7187.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7187.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7187.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_expert8_gate&#45;&gt;layer14_expert8_act -->
<g id="edge1514" class="edge">
<title>layer14_expert8_gate&#45;&gt;layer14_expert8_act</title>
<path fill="none" stroke="black" d="M7187.5,-2259.88C7187.5,-2251.78 7187.5,-2242.98 7187.5,-2234.47"/>
<polygon fill="black" stroke="black" points="7191,-2234.3 7187.5,-2224.3 7184,-2234.3 7191,-2234.3"/>
</g>
<!-- layer14_expert8_up&#45;&gt;layer14_expert8_act -->
<g id="edge1515" class="edge">
<title>layer14_expert8_up&#45;&gt;layer14_expert8_act</title>
<path fill="none" stroke="black" d="M7466.7,-2259.95C7423.44,-2249.27 7375.3,-2237.38 7331.34,-2226.53"/>
<polygon fill="black" stroke="black" points="7331.99,-2223.08 7321.44,-2224.08 7330.31,-2229.88 7331.99,-2223.08"/>
</g>
<!-- layer14_expert8_down -->
<g id="node1067" class="node">
<title>layer14_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="7376,-2120 6993,-2120 6993,-2052 7376,-2052 7376,-2120"/>
<text text-anchor="middle" x="7184.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="7184.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7184.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7184.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_expert8_act&#45;&gt;layer14_expert8_down -->
<g id="edge1516" class="edge">
<title>layer14_expert8_act&#45;&gt;layer14_expert8_down</title>
<path fill="none" stroke="black" d="M7186.53,-2155.88C7186.29,-2147.78 7186.03,-2138.98 7185.78,-2130.47"/>
<polygon fill="black" stroke="black" points="7189.27,-2130.19 7185.48,-2120.3 7182.27,-2130.4 7189.27,-2130.19"/>
</g>
<!-- layer14_expert8_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1517" class="edge">
<title>layer14_expert8_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M7134.13,-2051.9C7120.06,-2042.66 7104.2,-2032.25 7088.12,-2021.67"/>
<polygon fill="black" stroke="black" points="7089.97,-2018.7 7079.69,-2016.14 7086.12,-2024.55 7089.97,-2018.7"/>
</g>
<!-- layer14_expert9_act -->
<g id="node1070" class="node">
<title>layer14_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="8211,-2224 7816,-2224 7816,-2156 8211,-2156 8211,-2224"/>
<text text-anchor="middle" x="8013.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="8013.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8013.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8013.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_expert9_gate&#45;&gt;layer14_expert9_act -->
<g id="edge1520" class="edge">
<title>layer14_expert9_gate&#45;&gt;layer14_expert9_act</title>
<path fill="none" stroke="black" d="M8013.5,-2259.88C8013.5,-2251.78 8013.5,-2242.98 8013.5,-2234.47"/>
<polygon fill="black" stroke="black" points="8017,-2234.3 8013.5,-2224.3 8010,-2234.3 8017,-2234.3"/>
</g>
<!-- layer14_expert9_up&#45;&gt;layer14_expert9_act -->
<g id="edge1521" class="edge">
<title>layer14_expert9_up&#45;&gt;layer14_expert9_act</title>
<path fill="none" stroke="black" d="M8292.7,-2259.95C8249.44,-2249.27 8201.3,-2237.38 8157.34,-2226.53"/>
<polygon fill="black" stroke="black" points="8157.99,-2223.08 8147.44,-2224.08 8156.31,-2229.88 8157.99,-2223.08"/>
</g>
<!-- layer14_expert9_down -->
<g id="node1071" class="node">
<title>layer14_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="7992,-2120 7609,-2120 7609,-2052 7992,-2052 7992,-2120"/>
<text text-anchor="middle" x="7800.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7800.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7800.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7800.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_expert9_act&#45;&gt;layer14_expert9_down -->
<g id="edge1522" class="edge">
<title>layer14_expert9_act&#45;&gt;layer14_expert9_down</title>
<path fill="none" stroke="black" d="M7944.35,-2155.88C7923.41,-2145.86 7900.26,-2134.77 7878.77,-2124.48"/>
<polygon fill="black" stroke="black" points="7880.2,-2121.29 7869.67,-2120.12 7877.18,-2127.6 7880.2,-2121.29"/>
</g>
<!-- layer14_expert9_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1523" class="edge">
<title>layer14_expert9_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M7608.84,-2053.33C7543.96,-2042.61 7468.75,-2030.18 7393.34,-2017.72"/>
<polygon fill="black" stroke="black" points="7393.62,-2014.22 7383.19,-2016.04 7392.48,-2021.12 7393.62,-2014.22"/>
</g>
<!-- layer14_expert10_act -->
<g id="node1074" class="node">
<title>layer14_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="9037,-2224 8642,-2224 8642,-2156 9037,-2156 9037,-2224"/>
<text text-anchor="middle" x="8839.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8839.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8839.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8839.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_expert10_gate&#45;&gt;layer14_expert10_act -->
<g id="edge1526" class="edge">
<title>layer14_expert10_gate&#45;&gt;layer14_expert10_act</title>
<path fill="none" stroke="black" d="M8839.5,-2259.88C8839.5,-2251.78 8839.5,-2242.98 8839.5,-2234.47"/>
<polygon fill="black" stroke="black" points="8843,-2234.3 8839.5,-2224.3 8836,-2234.3 8843,-2234.3"/>
</g>
<!-- layer14_expert10_up&#45;&gt;layer14_expert10_act -->
<g id="edge1527" class="edge">
<title>layer14_expert10_up&#45;&gt;layer14_expert10_act</title>
<path fill="none" stroke="black" d="M9118.7,-2259.95C9075.44,-2249.27 9027.3,-2237.38 8983.34,-2226.53"/>
<polygon fill="black" stroke="black" points="8983.99,-2223.08 8973.44,-2224.08 8982.31,-2229.88 8983.99,-2223.08"/>
</g>
<!-- layer14_expert10_down -->
<g id="node1075" class="node">
<title>layer14_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8713,-2120 8330,-2120 8330,-2052 8713,-2052 8713,-2120"/>
<text text-anchor="middle" x="8521.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8521.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8521.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8521.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_expert10_act&#45;&gt;layer14_expert10_down -->
<g id="edge1528" class="edge">
<title>layer14_expert10_act&#45;&gt;layer14_expert10_down</title>
<path fill="none" stroke="black" d="M8736.25,-2155.88C8703.65,-2145.43 8667.47,-2133.82 8634.25,-2123.16"/>
<polygon fill="black" stroke="black" points="8635.09,-2119.76 8624.5,-2120.04 8632.95,-2126.42 8635.09,-2119.76"/>
</g>
<!-- layer14_expert10_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1529" class="edge">
<title>layer14_expert10_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M8329.85,-2068.12C8104.46,-2048.27 7722.98,-2014.66 7422.54,-1988.2"/>
<polygon fill="black" stroke="black" points="7422.61,-1984.69 7412.34,-1987.3 7421.99,-1991.67 7422.61,-1984.69"/>
</g>
<!-- layer14_expert11_act -->
<g id="node1078" class="node">
<title>layer14_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9863,-2224 9468,-2224 9468,-2156 9863,-2156 9863,-2224"/>
<text text-anchor="middle" x="9665.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9665.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9665.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9665.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_expert11_gate&#45;&gt;layer14_expert11_act -->
<g id="edge1532" class="edge">
<title>layer14_expert11_gate&#45;&gt;layer14_expert11_act</title>
<path fill="none" stroke="black" d="M9665.5,-2259.88C9665.5,-2251.78 9665.5,-2242.98 9665.5,-2234.47"/>
<polygon fill="black" stroke="black" points="9669,-2234.3 9665.5,-2224.3 9662,-2234.3 9669,-2234.3"/>
</g>
<!-- layer14_expert11_up&#45;&gt;layer14_expert11_act -->
<g id="edge1533" class="edge">
<title>layer14_expert11_up&#45;&gt;layer14_expert11_act</title>
<path fill="none" stroke="black" d="M9944.7,-2259.95C9901.44,-2249.27 9853.3,-2237.38 9809.34,-2226.53"/>
<polygon fill="black" stroke="black" points="9809.99,-2223.08 9799.44,-2224.08 9808.31,-2229.88 9809.99,-2223.08"/>
</g>
<!-- layer14_expert11_down -->
<g id="node1079" class="node">
<title>layer14_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9487,-2120 9104,-2120 9104,-2052 9487,-2052 9487,-2120"/>
<text text-anchor="middle" x="9295.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9295.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9295.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9295.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_expert11_act&#45;&gt;layer14_expert11_down -->
<g id="edge1534" class="edge">
<title>layer14_expert11_act&#45;&gt;layer14_expert11_down</title>
<path fill="none" stroke="black" d="M9545.63,-2155.95C9507.2,-2145.36 9464.47,-2133.58 9425.36,-2122.8"/>
<polygon fill="black" stroke="black" points="9426.07,-2119.36 9415.5,-2120.08 9424.21,-2126.11 9426.07,-2119.36"/>
</g>
<!-- layer14_expert11_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1535" class="edge">
<title>layer14_expert11_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M9103.84,-2073.75C8732.82,-2051.99 7908.55,-2003.63 7402.2,-1973.92"/>
<polygon fill="black" stroke="black" points="7402.35,-1970.42 7392.17,-1973.33 7401.94,-1977.41 7402.35,-1970.42"/>
</g>
<!-- layer14_expert12_act -->
<g id="node1082" class="node">
<title>layer14_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10689,-2224 10294,-2224 10294,-2156 10689,-2156 10689,-2224"/>
<text text-anchor="middle" x="10491.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10491.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10491.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10491.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_expert12_gate&#45;&gt;layer14_expert12_act -->
<g id="edge1538" class="edge">
<title>layer14_expert12_gate&#45;&gt;layer14_expert12_act</title>
<path fill="none" stroke="black" d="M10491.5,-2259.88C10491.5,-2251.78 10491.5,-2242.98 10491.5,-2234.47"/>
<polygon fill="black" stroke="black" points="10495,-2234.3 10491.5,-2224.3 10488,-2234.3 10495,-2234.3"/>
</g>
<!-- layer14_expert12_up&#45;&gt;layer14_expert12_act -->
<g id="edge1539" class="edge">
<title>layer14_expert12_up&#45;&gt;layer14_expert12_act</title>
<path fill="none" stroke="black" d="M10770.7,-2259.95C10727.44,-2249.27 10679.3,-2237.38 10635.34,-2226.53"/>
<polygon fill="black" stroke="black" points="10635.99,-2223.08 10625.44,-2224.08 10634.31,-2229.88 10635.99,-2223.08"/>
</g>
<!-- layer14_expert12_down -->
<g id="node1083" class="node">
<title>layer14_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="10287,-2120 9904,-2120 9904,-2052 10287,-2052 10287,-2120"/>
<text text-anchor="middle" x="10095.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10095.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10095.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10095.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_expert12_act&#45;&gt;layer14_expert12_down -->
<g id="edge1540" class="edge">
<title>layer14_expert12_act&#45;&gt;layer14_expert12_down</title>
<path fill="none" stroke="black" d="M10363.2,-2155.95C10321.81,-2145.29 10275.76,-2133.43 10233.69,-2122.59"/>
<polygon fill="black" stroke="black" points="10234.49,-2119.19 10223.93,-2120.08 10232.74,-2125.96 10234.49,-2119.19"/>
</g>
<!-- layer14_expert12_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1541" class="edge">
<title>layer14_expert12_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M9903.67,-2073.74C9786.15,-2067.01 9632.65,-2058.53 9496.5,-2052 8753.75,-2016.36 7887.41,-1982.66 7388.65,-1964.02"/>
<polygon fill="black" stroke="black" points="7388.53,-1960.52 7378.41,-1963.64 7388.27,-1967.51 7388.53,-1960.52"/>
</g>
<!-- layer14_expert13_act -->
<g id="node1086" class="node">
<title>layer14_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11515,-2224 11120,-2224 11120,-2156 11515,-2156 11515,-2224"/>
<text text-anchor="middle" x="11317.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="11317.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11317.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11317.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_expert13_gate&#45;&gt;layer14_expert13_act -->
<g id="edge1544" class="edge">
<title>layer14_expert13_gate&#45;&gt;layer14_expert13_act</title>
<path fill="none" stroke="black" d="M11317.5,-2259.88C11317.5,-2251.78 11317.5,-2242.98 11317.5,-2234.47"/>
<polygon fill="black" stroke="black" points="11321,-2234.3 11317.5,-2224.3 11314,-2234.3 11321,-2234.3"/>
</g>
<!-- layer14_expert13_up&#45;&gt;layer14_expert13_act -->
<g id="edge1545" class="edge">
<title>layer14_expert13_up&#45;&gt;layer14_expert13_act</title>
<path fill="none" stroke="black" d="M11596.7,-2259.95C11553.44,-2249.27 11505.3,-2237.38 11461.34,-2226.53"/>
<polygon fill="black" stroke="black" points="11461.99,-2223.08 11451.44,-2224.08 11460.31,-2229.88 11461.99,-2223.08"/>
</g>
<!-- layer14_expert13_down -->
<g id="node1087" class="node">
<title>layer14_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="11100,-2120 10717,-2120 10717,-2052 11100,-2052 11100,-2120"/>
<text text-anchor="middle" x="10908.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10908.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10908.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10908.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_expert13_act&#45;&gt;layer14_expert13_down -->
<g id="edge1546" class="edge">
<title>layer14_expert13_act&#45;&gt;layer14_expert13_down</title>
<path fill="none" stroke="black" d="M11184.99,-2155.95C11142.15,-2145.27 11094.48,-2133.38 11050.95,-2122.53"/>
<polygon fill="black" stroke="black" points="11051.7,-2119.1 11041.15,-2120.08 11050,-2125.9 11051.7,-2119.1"/>
</g>
<!-- layer14_expert13_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1547" class="edge">
<title>layer14_expert13_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M10716.98,-2073.55C10596.35,-2066.61 10437.36,-2057.98 10296.5,-2052 9245.09,-2007.34 8005.53,-1974 7380.76,-1958.54"/>
<polygon fill="black" stroke="black" points="7380.78,-1955.04 7370.69,-1958.3 7380.6,-1962.04 7380.78,-1955.04"/>
</g>
<!-- layer14_expert14_act -->
<g id="node1090" class="node">
<title>layer14_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="12341,-2224 11946,-2224 11946,-2156 12341,-2156 12341,-2224"/>
<text text-anchor="middle" x="12143.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="12143.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12143.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12143.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_expert14_gate&#45;&gt;layer14_expert14_act -->
<g id="edge1550" class="edge">
<title>layer14_expert14_gate&#45;&gt;layer14_expert14_act</title>
<path fill="none" stroke="black" d="M12143.5,-2259.88C12143.5,-2251.78 12143.5,-2242.98 12143.5,-2234.47"/>
<polygon fill="black" stroke="black" points="12147,-2234.3 12143.5,-2224.3 12140,-2234.3 12147,-2234.3"/>
</g>
<!-- layer14_expert14_up&#45;&gt;layer14_expert14_act -->
<g id="edge1551" class="edge">
<title>layer14_expert14_up&#45;&gt;layer14_expert14_act</title>
<path fill="none" stroke="black" d="M12422.7,-2259.95C12379.44,-2249.27 12331.3,-2237.38 12287.34,-2226.53"/>
<polygon fill="black" stroke="black" points="12287.99,-2223.08 12277.44,-2224.08 12286.31,-2229.88 12287.99,-2223.08"/>
</g>
<!-- layer14_expert14_down -->
<g id="node1091" class="node">
<title>layer14_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11919,-2120 11536,-2120 11536,-2052 11919,-2052 11919,-2120"/>
<text text-anchor="middle" x="11727.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11727.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11727.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11727.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_expert14_act&#45;&gt;layer14_expert14_down -->
<g id="edge1552" class="edge">
<title>layer14_expert14_act&#45;&gt;layer14_expert14_down</title>
<path fill="none" stroke="black" d="M12008.72,-2155.95C11965.15,-2145.27 11916.66,-2133.38 11872.39,-2122.53"/>
<polygon fill="black" stroke="black" points="11872.96,-2119.06 11862.42,-2120.08 11871.3,-2125.86 11872.96,-2119.06"/>
</g>
<!-- layer14_expert14_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1553" class="edge">
<title>layer14_expert14_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M11535.83,-2073.36C11413.82,-2066.3 11252.43,-2057.6 11109.5,-2052 9739.85,-1998.37 8113.66,-1967.43 7376.32,-1955.17"/>
<polygon fill="black" stroke="black" points="7376.12,-1951.67 7366.07,-1955 7376.01,-1958.67 7376.12,-1951.67"/>
</g>
<!-- layer14_expert15_act -->
<g id="node1094" class="node">
<title>layer14_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="13167,-2224 12772,-2224 12772,-2156 13167,-2156 13167,-2224"/>
<text text-anchor="middle" x="12969.5" y="-2208.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12969.5" y="-2193.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12969.5" y="-2178.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12969.5" y="-2163.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_expert15_gate&#45;&gt;layer14_expert15_act -->
<g id="edge1556" class="edge">
<title>layer14_expert15_gate&#45;&gt;layer14_expert15_act</title>
<path fill="none" stroke="black" d="M12969.5,-2259.88C12969.5,-2251.78 12969.5,-2242.98 12969.5,-2234.47"/>
<polygon fill="black" stroke="black" points="12973,-2234.3 12969.5,-2224.3 12966,-2234.3 12973,-2234.3"/>
</g>
<!-- layer14_expert15_up&#45;&gt;layer14_expert15_act -->
<g id="edge1557" class="edge">
<title>layer14_expert15_up&#45;&gt;layer14_expert15_act</title>
<path fill="none" stroke="black" d="M13248.7,-2259.95C13205.44,-2249.27 13157.3,-2237.38 13113.34,-2226.53"/>
<polygon fill="black" stroke="black" points="13113.99,-2223.08 13103.44,-2224.08 13112.31,-2229.88 13113.99,-2223.08"/>
</g>
<!-- layer14_expert15_down -->
<g id="node1095" class="node">
<title>layer14_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12742,-2120 12359,-2120 12359,-2052 12742,-2052 12742,-2120"/>
<text text-anchor="middle" x="12550.5" y="-2104.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12550.5" y="-2089.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12550.5" y="-2074.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12550.5" y="-2059.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_expert15_act&#45;&gt;layer14_expert15_down -->
<g id="edge1558" class="edge">
<title>layer14_expert15_act&#45;&gt;layer14_expert15_down</title>
<path fill="none" stroke="black" d="M12833.75,-2155.95C12789.77,-2145.25 12740.82,-2133.33 12696.15,-2122.46"/>
<polygon fill="black" stroke="black" points="12696.93,-2119.05 12686.39,-2120.08 12695.28,-2125.85 12696.93,-2119.05"/>
</g>
<!-- layer14_expert15_down&#45;&gt;layer14_token_aggregation -->
<g id="edge1559" class="edge">
<title>layer14_expert15_down&#45;&gt;layer14_token_aggregation</title>
<path fill="none" stroke="black" d="M12358.98,-2073.24C12236.02,-2066.09 12072.9,-2057.33 11928.5,-2052 10234.24,-1989.45 8212.33,-1962.15 7372.93,-1952.91"/>
<polygon fill="black" stroke="black" points="7372.84,-1949.4 7362.8,-1952.79 7372.76,-1956.4 7372.84,-1949.4"/>
</g>
<!-- layer14_res2 -->
<g id="node1097" class="node">
<title>layer14_res2</title>
<polygon fill="none" stroke="black" points="7418.24,-1844 6717.12,-1844 6536.76,-1678 7237.88,-1678 7418.24,-1844"/>
<text text-anchor="middle" x="6977.5" y="-1787.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6977.5" y="-1772.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1757.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1742.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1727.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_token_aggregation&#45;&gt;layer14_res2 -->
<g id="edge1560" class="edge">
<title>layer14_token_aggregation&#45;&gt;layer14_res2</title>
<path fill="none" stroke="black" d="M6977.5,-1879.95C6977.5,-1871.63 6977.5,-1863 6977.5,-1854.38"/>
<polygon fill="black" stroke="black" points="6981,-1854.28 6977.5,-1844.28 6974,-1854.28 6981,-1854.28"/>
</g>
<!-- layer15_mha_qkv -->
<g id="node1098" class="node">
<title>layer15_mha_qkv</title>
<polygon fill="lightblue" stroke="black" points="7213.5,-1642 6741.5,-1642 6741.5,-1574 7213.5,-1574 7213.5,-1642"/>
<text text-anchor="middle" x="6977.5" y="-1626.8" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6977.5" y="-1611.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1596.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6977.5" y="-1581.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_res2&#45;&gt;layer15_mha_qkv -->
<g id="edge1561" class="edge">
<title>layer14_res2&#45;&gt;layer15_mha_qkv</title>
<path fill="none" stroke="black" d="M6977.5,-1677.87C6977.5,-1669.12 6977.5,-1660.48 6977.5,-1652.45"/>
<polygon fill="black" stroke="black" points="6981,-1652.26 6977.5,-1642.26 6974,-1652.26 6981,-1652.26"/>
</g>
<!-- layer15_mha_attn -->
<g id="node1099" class="node">
<title>layer15_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="7207.5,-1538 6747.5,-1538 6747.5,-1470 7207.5,-1470 7207.5,-1538"/>
<text text-anchor="middle" x="6977.5" y="-1522.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6977.5" y="-1507.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6977.5" y="-1492.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1477.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_mha_qkv&#45;&gt;layer15_mha_attn -->
<g id="edge1562" class="edge">
<title>layer15_mha_qkv&#45;&gt;layer15_mha_attn</title>
<path fill="none" stroke="black" d="M6977.5,-1573.88C6977.5,-1565.78 6977.5,-1556.98 6977.5,-1548.47"/>
<polygon fill="black" stroke="black" points="6981,-1548.3 6977.5,-1538.3 6974,-1548.3 6981,-1548.3"/>
</g>
<!-- layer15_mha_out -->
<g id="node1100" class="node">
<title>layer15_mha_out</title>
<polygon fill="lightblue" stroke="black" points="7190,-1434 6765,-1434 6765,-1366 7190,-1366 7190,-1434"/>
<text text-anchor="middle" x="6977.5" y="-1418.8" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6977.5" y="-1403.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1388.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6977.5" y="-1373.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_mha_attn&#45;&gt;layer15_mha_out -->
<g id="edge1563" class="edge">
<title>layer15_mha_attn&#45;&gt;layer15_mha_out</title>
<path fill="none" stroke="black" d="M6977.5,-1469.88C6977.5,-1461.78 6977.5,-1452.98 6977.5,-1444.47"/>
<polygon fill="black" stroke="black" points="6981,-1444.3 6977.5,-1434.3 6974,-1444.3 6981,-1444.3"/>
</g>
<!-- layer15_res1 -->
<g id="node1101" class="node">
<title>layer15_res1</title>
<polygon fill="none" stroke="black" points="7039.24,-1330 6338.12,-1330 6157.76,-1164 6858.88,-1164 7039.24,-1330"/>
<text text-anchor="middle" x="6598.5" y="-1273.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6598.5" y="-1258.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-1243.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-1228.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-1213.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_mha_out&#45;&gt;layer15_res1 -->
<g id="edge1564" class="edge">
<title>layer15_mha_out&#45;&gt;layer15_res1</title>
<path fill="none" stroke="black" d="M6894.33,-1365.86C6870.15,-1356.23 6842.56,-1345.24 6814.17,-1333.93"/>
<polygon fill="black" stroke="black" points="6815.1,-1330.53 6804.51,-1330.08 6812.51,-1337.03 6815.1,-1330.53"/>
</g>
<!-- output -->
<g id="node1171" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="7357.5" cy="-1247" rx="300.54" ry="26.74"/>
<text text-anchor="middle" x="7357.5" y="-1250.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7357.5" y="-1235.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- layer15_mha_out&#45;&gt;output -->
<g id="edge1667" class="edge">
<title>layer15_mha_out&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7060.89,-1365.86C7127.6,-1339.36 7220.23,-1302.55 7284.14,-1277.15"/>
<polygon fill="black" stroke="black" points="7285.74,-1280.28 7293.74,-1273.33 7283.16,-1273.77 7285.74,-1280.28"/>
</g>
<!-- layer15_ln1 -->
<g id="node1102" class="node">
<title>layer15_ln1</title>
<polygon fill="yellow" stroke="black" points="6811,-1128 6386,-1128 6386,-1060 6811,-1060 6811,-1128"/>
<text text-anchor="middle" x="6598.5" y="-1112.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6598.5" y="-1097.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-1082.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-1067.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_res1&#45;&gt;layer15_ln1 -->
<g id="edge1565" class="edge">
<title>layer15_res1&#45;&gt;layer15_ln1</title>
<path fill="none" stroke="black" d="M6598.5,-1163.87C6598.5,-1155.12 6598.5,-1146.48 6598.5,-1138.45"/>
<polygon fill="black" stroke="black" points="6602,-1138.26 6598.5,-1128.26 6595,-1138.26 6602,-1138.26"/>
</g>
<!-- layer15_expert_routing -->
<g id="node1103" class="node">
<title>layer15_expert_routing</title>
<polygon fill="orange" stroke="black" points="6598.5,-1024 6182.5,-941 6598.5,-858 7014.5,-941 6598.5,-1024"/>
<text text-anchor="middle" x="6598.5" y="-967.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="6598.5" y="-952.3" font-family="Times,serif" font-size="14.00">Top&#45;2 Selection</text>
<text text-anchor="middle" x="6598.5" y="-937.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-922.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, expert_id=2]</text>
<text text-anchor="middle" x="6598.5" y="-907.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_ln1&#45;&gt;layer15_expert_routing -->
<g id="edge1566" class="edge">
<title>layer15_ln1&#45;&gt;layer15_expert_routing</title>
<path fill="none" stroke="black" d="M6598.5,-1059.86C6598.5,-1052.1 6598.5,-1043.46 6598.5,-1034.48"/>
<polygon fill="black" stroke="black" points="6602,-1034.23 6598.5,-1024.23 6595,-1034.23 6602,-1034.23"/>
</g>
<!-- layer15_token_distribution -->
<g id="node1104" class="node">
<title>layer15_token_distribution</title>
<polygon fill="lightcoral" stroke="black" points="7026.86,-822 6345.44,-822 6170.14,-686 6851.56,-686 7026.86,-822"/>
<text text-anchor="middle" x="6598.5" y="-772.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="6598.5" y="-757.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6598.5" y="-742.8" font-family="Times,serif" font-size="14.00">Output: Tokens routed to 2 experts</text>
<text text-anchor="middle" x="6598.5" y="-727.8" font-family="Times,serif" font-size="14.00">All GPUs â†’ Expert GPUs</text>
</g>
<!-- layer15_expert_routing&#45;&gt;layer15_token_distribution -->
<g id="edge1567" class="edge">
<title>layer15_expert_routing&#45;&gt;layer15_token_distribution</title>
<path fill="none" stroke="black" d="M6598.5,-857.78C6598.5,-849.34 6598.5,-840.79 6598.5,-832.4"/>
<polygon fill="black" stroke="black" points="6602,-832.28 6598.5,-822.28 6595,-832.28 6602,-832.28"/>
</g>
<!-- layer15_expert0_gate -->
<g id="node1105" class="node">
<title>layer15_expert0_gate</title>
<polygon fill="lightblue" stroke="black" points="395,-650 0,-650 0,-582 395,-582 395,-650"/>
<text text-anchor="middle" x="197.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="197.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="197.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="197.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert0_gate -->
<g id="edge1568" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6257.42,-753.72C5136.99,-755.09 1575.01,-751.23 405.31,-650.11"/>
<polygon fill="black" stroke="black" points="405.32,-646.6 395.06,-649.22 404.71,-653.57 405.32,-646.6"/>
</g>
<!-- layer15_expert0_up -->
<g id="node1106" class="node">
<title>layer15_expert0_up</title>
<polygon fill="lightblue" stroke="black" points="808,-650 413,-650 413,-582 808,-582 808,-650"/>
<text text-anchor="middle" x="610.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="610.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="610.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="610.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert0_up -->
<g id="edge1569" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert0_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6256.42,-753.24C5185.28,-753 1903.27,-744.44 818.35,-650.12"/>
<polygon fill="black" stroke="black" points="818.32,-646.6 808.06,-649.21 817.71,-653.57 818.32,-646.6"/>
</g>
<!-- layer15_expert1_gate -->
<g id="node1109" class="node">
<title>layer15_expert1_gate</title>
<polygon fill="lightblue" stroke="black" points="1221,-650 826,-650 826,-582 1221,-582 1221,-650"/>
<text text-anchor="middle" x="1023.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1023.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1023.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1023.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert1_gate -->
<g id="edge1574" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6255.86,-752.69C5236.38,-750.77 2231.69,-737.69 1231.28,-650.11"/>
<polygon fill="black" stroke="black" points="1231.33,-646.6 1221.06,-649.21 1230.71,-653.57 1231.33,-646.6"/>
</g>
<!-- layer15_expert1_up -->
<g id="node1110" class="node">
<title>layer15_expert1_up</title>
<polygon fill="lightblue" stroke="black" points="1634,-650 1239,-650 1239,-582 1634,-582 1634,-650"/>
<text text-anchor="middle" x="1436.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1436.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1436.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1436.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert1_up -->
<g id="edge1575" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert1_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6254.92,-752.04C5288.86,-748.35 2560.03,-730.95 1644.08,-650.09"/>
<polygon fill="black" stroke="black" points="1644.33,-646.6 1634.06,-649.2 1643.71,-653.58 1644.33,-646.6"/>
</g>
<!-- layer15_expert2_gate -->
<g id="node1113" class="node">
<title>layer15_expert2_gate</title>
<polygon fill="lightblue" stroke="black" points="2047,-650 1652,-650 1652,-582 2047,-582 2047,-650"/>
<text text-anchor="middle" x="1849.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="1849.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1849.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1849.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert2_gate -->
<g id="edge1580" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6253.93,-751.27C5343.78,-745.72 2889.04,-724.22 2057.07,-650.1"/>
<polygon fill="black" stroke="black" points="2057.33,-646.6 2047.06,-649.19 2056.7,-653.58 2057.33,-646.6"/>
</g>
<!-- layer15_expert2_up -->
<g id="node1114" class="node">
<title>layer15_expert2_up</title>
<polygon fill="lightblue" stroke="black" points="2460,-650 2065,-650 2065,-582 2460,-582 2460,-650"/>
<text text-anchor="middle" x="2262.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="2262.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2262.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2262.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert2_up -->
<g id="edge1581" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert2_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6252.99,-750.34C5401.65,-742.84 3218.62,-717.52 2470.16,-650.1"/>
<polygon fill="black" stroke="black" points="2470.34,-646.61 2460.06,-649.18 2469.7,-653.58 2470.34,-646.61"/>
</g>
<!-- layer15_expert3_gate -->
<g id="node1117" class="node">
<title>layer15_expert3_gate</title>
<polygon fill="lightblue" stroke="black" points="2873,-650 2478,-650 2478,-582 2873,-582 2873,-650"/>
<text text-anchor="middle" x="2675.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="2675.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2675.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2675.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert3_gate -->
<g id="edge1586" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6251.41,-749.2C5461.73,-739.62 3548.42,-710.84 2883.24,-650.11"/>
<polygon fill="black" stroke="black" points="2883.34,-646.61 2873.06,-649.17 2882.7,-653.58 2883.34,-646.61"/>
</g>
<!-- layer15_expert3_up -->
<g id="node1118" class="node">
<title>layer15_expert3_up</title>
<polygon fill="lightblue" stroke="black" points="3286,-650 2891,-650 2891,-582 3286,-582 3286,-650"/>
<text text-anchor="middle" x="3088.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="3088.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3088.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3088.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert3_up -->
<g id="edge1587" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert3_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6249.52,-747.77C5525.21,-735.98 3878.46,-704.17 3296.25,-650.12"/>
<polygon fill="black" stroke="black" points="3296.35,-646.61 3286.06,-649.16 3295.69,-653.58 3296.35,-646.61"/>
</g>
<!-- layer15_expert4_gate -->
<g id="node1121" class="node">
<title>layer15_expert4_gate</title>
<polygon fill="lightblue" stroke="black" points="3699,-650 3304,-650 3304,-582 3699,-582 3699,-650"/>
<text text-anchor="middle" x="3501.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3501.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3501.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3501.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert4_gate -->
<g id="edge1592" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6247.06,-745.9C5592.59,-731.8 4208.94,-697.52 3709.26,-650.12"/>
<polygon fill="black" stroke="black" points="3709.35,-646.62 3699.06,-649.14 3708.68,-653.58 3709.35,-646.62"/>
</g>
<!-- layer15_expert4_up -->
<g id="node1122" class="node">
<title>layer15_expert4_up</title>
<polygon fill="lightblue" stroke="black" points="4112,-650 3717,-650 3717,-582 4112,-582 4112,-650"/>
<text text-anchor="middle" x="3914.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="3914.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3914.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3914.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert4_up -->
<g id="edge1593" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert4_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6254.37,-751.42C5777.11,-746.35 4887.47,-726.49 4122.19,-650.13"/>
<polygon fill="black" stroke="black" points="4122.36,-646.63 4112.07,-649.12 4121.67,-653.6 4122.36,-646.63"/>
</g>
<!-- layer15_expert5_gate -->
<g id="node1125" class="node">
<title>layer15_expert5_gate</title>
<polygon fill="lightblue" stroke="black" points="4525,-650 4130,-650 4130,-582 4525,-582 4525,-650"/>
<text text-anchor="middle" x="4327.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4327.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4327.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4327.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert5_gate -->
<g id="edge1598" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6248.68,-747.16C5839.56,-737.67 5142.04,-713.18 4535.34,-650.16"/>
<polygon fill="black" stroke="black" points="4535.38,-646.64 4525.07,-649.09 4534.65,-653.61 4535.38,-646.64"/>
</g>
<!-- layer15_expert5_up -->
<g id="node1126" class="node">
<title>layer15_expert5_up</title>
<polygon fill="lightblue" stroke="black" points="4938,-650 4543,-650 4543,-582 4938,-582 4938,-650"/>
<text text-anchor="middle" x="4740.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="4740.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4740.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4740.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert5_up -->
<g id="edge1599" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert5_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6240.34,-740.65C5907.6,-726.84 5398.32,-699.72 4948.03,-650.14"/>
<polygon fill="black" stroke="black" points="4948.4,-646.66 4938.07,-649.04 4947.63,-653.62 4948.4,-646.66"/>
</g>
<!-- layer15_expert6_gate -->
<g id="node1129" class="node">
<title>layer15_expert6_gate</title>
<polygon fill="lightblue" stroke="black" points="5351,-650 4956,-650 4956,-582 5351,-582 5351,-650"/>
<text text-anchor="middle" x="5153.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5153.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5153.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5153.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert6_gate -->
<g id="edge1604" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6226.03,-729.44C5982.4,-712.23 5657.1,-685.86 5361.16,-650.18"/>
<polygon fill="black" stroke="black" points="5361.43,-646.68 5351.08,-648.96 5360.59,-653.63 5361.43,-646.68"/>
</g>
<!-- layer15_expert6_up -->
<g id="node1130" class="node">
<title>layer15_expert6_up</title>
<polygon fill="lightblue" stroke="black" points="5764,-650 5369,-650 5369,-582 5764,-582 5764,-650"/>
<text text-anchor="middle" x="5566.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="5566.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5566.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5566.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert6_up -->
<g id="edge1605" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert6_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6195.33,-705.57C6063.89,-689.37 5917.08,-670.49 5774.37,-650.25"/>
<polygon fill="black" stroke="black" points="5774.5,-646.74 5764.11,-648.79 5773.51,-653.67 5774.5,-646.74"/>
</g>
<!-- layer15_expert7_gate -->
<g id="node1133" class="node">
<title>layer15_expert7_gate</title>
<polygon fill="lightblue" stroke="black" points="6177,-650 5782,-650 5782,-582 6177,-582 6177,-650"/>
<text text-anchor="middle" x="5979.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="5979.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5979.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5979.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert7_gate -->
<g id="edge1610" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6293.53,-686C6240.4,-674.32 6187.09,-662.61 6139.86,-652.23"/>
<polygon fill="black" stroke="black" points="6140.4,-648.77 6129.88,-650.04 6138.89,-655.6 6140.4,-648.77"/>
</g>
<!-- layer15_expert7_up -->
<g id="node1134" class="node">
<title>layer15_expert7_up</title>
<polygon fill="lightblue" stroke="black" points="6590,-650 6195,-650 6195,-582 6590,-582 6590,-650"/>
<text text-anchor="middle" x="6392.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="6392.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6392.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6392.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert7_up -->
<g id="edge1611" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert7_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6497.01,-686C6481.37,-675.67 6465.68,-665.31 6451.38,-655.87"/>
<polygon fill="black" stroke="black" points="6452.95,-652.72 6442.68,-650.13 6449.1,-658.56 6452.95,-652.72"/>
</g>
<!-- layer15_expert8_gate -->
<g id="node1137" class="node">
<title>layer15_expert8_gate</title>
<polygon fill="lightblue" stroke="black" points="7003,-650 6608,-650 6608,-582 7003,-582 7003,-650"/>
<text text-anchor="middle" x="6805.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="6805.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6805.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6805.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert8_gate -->
<g id="edge1616" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6700.48,-686C6716.2,-675.67 6731.97,-665.31 6746.33,-655.87"/>
<polygon fill="black" stroke="black" points="6748.64,-658.54 6755.08,-650.13 6744.8,-652.69 6748.64,-658.54"/>
</g>
<!-- layer15_expert8_up -->
<g id="node1138" class="node">
<title>layer15_expert8_up</title>
<polygon fill="lightblue" stroke="black" points="7416,-650 7021,-650 7021,-582 7416,-582 7416,-650"/>
<text text-anchor="middle" x="7218.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="7218.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7218.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7218.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert8_up -->
<g id="edge1617" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert8_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6863.23,-694.93C6929.49,-680.4 6998.56,-665.25 7057.99,-652.21"/>
<polygon fill="black" stroke="black" points="7058.81,-655.61 7067.82,-650.05 7057.31,-648.78 7058.81,-655.61"/>
</g>
<!-- layer15_expert9_gate -->
<g id="node1141" class="node">
<title>layer15_expert9_gate</title>
<polygon fill="lightblue" stroke="black" points="7829,-650 7434,-650 7434,-582 7829,-582 7829,-650"/>
<text text-anchor="middle" x="7631.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="7631.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7631.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7631.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert9_gate -->
<g id="edge1622" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6894.03,-718.73C7049.07,-700.13 7242.37,-675.94 7423.89,-650.22"/>
<polygon fill="black" stroke="black" points="7424.49,-653.67 7433.89,-648.8 7423.5,-646.74 7424.49,-653.67"/>
</g>
<!-- layer15_expert9_up -->
<g id="node1142" class="node">
<title>layer15_expert9_up</title>
<polygon fill="lightblue" stroke="black" points="8242,-650 7847,-650 7847,-582 8242,-582 8242,-650"/>
<text text-anchor="middle" x="8044.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="8044.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8044.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8044.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert9_up -->
<g id="edge1623" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert9_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6912.91,-733.51C7161.39,-716.52 7517.09,-688.72 7836.99,-650.16"/>
<polygon fill="black" stroke="black" points="7837.41,-653.63 7846.92,-648.96 7836.57,-646.68 7837.41,-653.63"/>
</g>
<!-- layer15_expert10_gate -->
<g id="node1145" class="node">
<title>layer15_expert10_gate</title>
<polygon fill="lightblue" stroke="black" points="8655,-650 8260,-650 8260,-582 8655,-582 8655,-650"/>
<text text-anchor="middle" x="8457.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8457.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8457.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8457.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert10_gate -->
<g id="edge1628" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6923.93,-742.01C7255.51,-728.65 7784.55,-701.38 8249.98,-650.14"/>
<polygon fill="black" stroke="black" points="8250.37,-653.62 8259.93,-649.04 8249.6,-646.66 8250.37,-653.62"/>
</g>
<!-- layer15_expert10_up -->
<g id="node1146" class="node">
<title>layer15_expert10_up</title>
<polygon fill="lightblue" stroke="black" points="9068,-650 8673,-650 8673,-582 9068,-582 9068,-650"/>
<text text-anchor="middle" x="8870.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="8870.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8870.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8870.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert10_up -->
<g id="edge1629" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert10_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6931.24,-747.57C7338.05,-738.37 8047.4,-714.08 8662.97,-650.13"/>
<polygon fill="black" stroke="black" points="8663.35,-653.61 8672.93,-649.09 8662.62,-646.64 8663.35,-653.61"/>
</g>
<!-- layer15_expert11_gate -->
<g id="node1149" class="node">
<title>layer15_expert11_gate</title>
<polygon fill="lightblue" stroke="black" points="9481,-650 9086,-650 9086,-582 9481,-582 9481,-650"/>
<text text-anchor="middle" x="9283.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="9283.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9283.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9283.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert11_gate -->
<g id="edge1634" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6936.2,-751.5C7412.01,-746.55 8306.7,-726.86 9075.76,-650.14"/>
<polygon fill="black" stroke="black" points="9076.33,-653.6 9085.93,-649.12 9075.64,-646.63 9076.33,-653.6"/>
</g>
<!-- layer15_expert11_up -->
<g id="node1150" class="node">
<title>layer15_expert11_up</title>
<polygon fill="lightblue" stroke="black" points="9894,-650 9499,-650 9499,-582 9894,-582 9894,-650"/>
<text text-anchor="middle" x="9696.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="9696.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9696.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9696.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert11_up -->
<g id="edge1635" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert11_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6929.5,-746.35C7575.28,-732.53 8983.47,-698.03 9488.63,-650.13"/>
<polygon fill="black" stroke="black" points="9489.32,-653.58 9498.94,-649.14 9488.65,-646.62 9489.32,-653.58"/>
</g>
<!-- layer15_expert12_gate -->
<g id="node1153" class="node">
<title>layer15_expert12_gate</title>
<polygon fill="lightblue" stroke="black" points="10307,-650 9912,-650 9912,-582 10307,-582 10307,-650"/>
<text text-anchor="middle" x="10109.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="10109.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10109.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10109.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert12_gate -->
<g id="edge1640" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6931.83,-748.02C7647.92,-736.46 9315.02,-704.58 9901.68,-650.13"/>
<polygon fill="black" stroke="black" points="9902.31,-653.58 9911.94,-649.16 9901.65,-646.61 9902.31,-653.58"/>
</g>
<!-- layer15_expert12_up -->
<g id="node1154" class="node">
<title>layer15_expert12_up</title>
<polygon fill="lightblue" stroke="black" points="10720,-650 10325,-650 10325,-582 10720,-582 10720,-650"/>
<text text-anchor="middle" x="10522.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10522.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10522.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10522.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert12_up -->
<g id="edge1641" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert12_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6933.57,-749.35C7715.82,-739.92 9645.91,-711.16 10314.7,-650.12"/>
<polygon fill="black" stroke="black" points="10315.3,-653.58 10324.94,-649.17 10314.66,-646.61 10315.3,-653.58"/>
</g>
<!-- layer15_expert13_gate -->
<g id="node1157" class="node">
<title>layer15_expert13_gate</title>
<polygon fill="lightblue" stroke="black" points="11133,-650 10738,-650 10738,-582 11133,-582 11133,-650"/>
<text text-anchor="middle" x="10935.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="10935.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10935.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10935.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert13_gate -->
<g id="edge1646" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6934.74,-750.43C7779.52,-743.03 9976.4,-717.78 10727.8,-650.11"/>
<polygon fill="black" stroke="black" points="10728.3,-653.58 10737.94,-649.18 10727.66,-646.61 10728.3,-653.58"/>
</g>
<!-- layer15_expert13_up -->
<g id="node1158" class="node">
<title>layer15_expert13_up</title>
<polygon fill="lightblue" stroke="black" points="11546,-650 11151,-650 11151,-582 11546,-582 11546,-650"/>
<text text-anchor="middle" x="11348.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11348.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11348.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11348.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert13_up -->
<g id="edge1647" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert13_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6936.14,-751.31C7840.83,-745.84 10306.6,-724.43 11140.9,-650.1"/>
<polygon fill="black" stroke="black" points="11141.3,-653.58 11150.94,-649.19 11140.67,-646.6 11141.3,-653.58"/>
</g>
<!-- layer15_expert14_gate -->
<g id="node1161" class="node">
<title>layer15_expert14_gate</title>
<polygon fill="lightblue" stroke="black" points="11959,-650 11564,-650 11564,-582 11959,-582 11959,-650"/>
<text text-anchor="middle" x="11761.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="11761.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11761.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11761.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert14_gate -->
<g id="edge1652" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6936.95,-752.06C7898.58,-748.42 10636.12,-731.11 11553.9,-650.1"/>
<polygon fill="black" stroke="black" points="11554.29,-653.58 11563.94,-649.2 11553.67,-646.6 11554.29,-653.58"/>
</g>
<!-- layer15_expert14_up -->
<g id="node1162" class="node">
<title>layer15_expert14_up</title>
<polygon fill="lightblue" stroke="black" points="12372,-650 11977,-650 11977,-582 12372,-582 12372,-650"/>
<text text-anchor="middle" x="12174.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12174.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12174.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12174.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert14_up -->
<g id="edge1653" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert14_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6937.58,-752.7C7953.74,-750.8 10964.92,-737.81 11966.71,-650.11"/>
<polygon fill="black" stroke="black" points="11967.29,-653.57 11976.94,-649.21 11966.67,-646.6 11967.29,-653.57"/>
</g>
<!-- layer15_expert15_gate -->
<g id="node1165" class="node">
<title>layer15_expert15_gate</title>
<polygon fill="lightblue" stroke="black" points="12785,-650 12390,-650 12390,-582 12785,-582 12785,-650"/>
<text text-anchor="middle" x="12587.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="12587.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12587.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12587.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert15_gate -->
<g id="edge1658" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6938.27,-753.24C8007.13,-753.02 11293.73,-744.53 12379.64,-650.12"/>
<polygon fill="black" stroke="black" points="12380.29,-653.57 12389.94,-649.21 12379.68,-646.6 12380.29,-653.57"/>
</g>
<!-- layer15_expert15_up -->
<g id="node1166" class="node">
<title>layer15_expert15_up</title>
<polygon fill="lightblue" stroke="black" points="13198,-650 12803,-650 12803,-582 13198,-582 13198,-650"/>
<text text-anchor="middle" x="13000.5" y="-634.8" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13000.5" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="13000.5" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13000.5" y="-589.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_token_distribution&#45;&gt;layer15_expert15_up -->
<g id="edge1659" class="edge">
<title>layer15_token_distribution&#45;&gt;layer15_expert15_up</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6939.15,-753.72C8059.21,-755.1 11622.63,-751.26 12792.69,-650.11"/>
<polygon fill="black" stroke="black" points="12793.29,-653.57 12802.94,-649.22 12792.68,-646.6 12793.29,-653.57"/>
</g>
<!-- layer15_expert0_act -->
<g id="node1107" class="node">
<title>layer15_expert0_act</title>
<polygon fill="lightgreen" stroke="black" points="808,-546 413,-546 413,-478 808,-478 808,-546"/>
<text text-anchor="middle" x="610.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="610.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="610.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="610.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer15_expert0_gate&#45;&gt;layer15_expert0_act -->
<g id="edge1570" class="edge">
<title>layer15_expert0_gate&#45;&gt;layer15_expert0_act</title>
<path fill="none" stroke="black" d="M331.3,-581.95C374.56,-571.27 422.7,-559.38 466.66,-548.53"/>
<polygon fill="black" stroke="black" points="467.69,-551.88 476.56,-546.08 466.01,-545.08 467.69,-551.88"/>
</g>
<!-- layer15_expert0_up&#45;&gt;layer15_expert0_act -->
<g id="edge1571" class="edge">
<title>layer15_expert0_up&#45;&gt;layer15_expert0_act</title>
<path fill="none" stroke="black" d="M610.5,-581.88C610.5,-573.78 610.5,-564.98 610.5,-556.47"/>
<polygon fill="black" stroke="black" points="614,-556.3 610.5,-546.3 607,-556.3 614,-556.3"/>
</g>
<!-- layer15_expert0_down -->
<g id="node1108" class="node">
<title>layer15_expert0_down</title>
<polygon fill="lightblue" stroke="black" points="1228,-442 845,-442 845,-374 1228,-374 1228,-442"/>
<text text-anchor="middle" x="1036.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1036.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1036.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="1036.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer15_expert0_act&#45;&gt;layer15_expert0_down -->
<g id="edge1572" class="edge">
<title>layer15_expert0_act&#45;&gt;layer15_expert0_down</title>
<path fill="none" stroke="black" d="M748.52,-477.95C793.23,-467.25 843,-455.33 888.42,-444.46"/>
<polygon fill="black" stroke="black" points="889.43,-447.81 898.34,-442.08 887.8,-441.01 889.43,-447.81"/>
</g>
<!-- layer15_token_aggregation -->
<g id="node1169" class="node">
<title>layer15_token_aggregation</title>
<polygon fill="lightcoral" stroke="black" points="7071.24,-338 6314.44,-338 6119.76,-202 6876.56,-202 7071.24,-338"/>
<text text-anchor="middle" x="6595.5" y="-288.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="6595.5" y="-273.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, hidden=4096] from 2 experts</text>
<text text-anchor="middle" x="6595.5" y="-258.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6595.5" y="-243.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_expert0_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1573" class="edge">
<title>layer15_expert0_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M1228.09,-400.49C1438.56,-393.44 1786.59,-382.14 2086.5,-374 3618.78,-332.42 5444.27,-294.2 6218.53,-278.52"/>
<polygon fill="black" stroke="black" points="6218.79,-282.01 6228.72,-278.31 6218.65,-275.02 6218.79,-282.01"/>
</g>
<!-- layer15_expert1_act -->
<g id="node1111" class="node">
<title>layer15_expert1_act</title>
<polygon fill="lightgreen" stroke="black" points="1634,-546 1239,-546 1239,-478 1634,-478 1634,-546"/>
<text text-anchor="middle" x="1436.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1436.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1436.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1436.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer15_expert1_gate&#45;&gt;layer15_expert1_act -->
<g id="edge1576" class="edge">
<title>layer15_expert1_gate&#45;&gt;layer15_expert1_act</title>
<path fill="none" stroke="black" d="M1157.3,-581.95C1200.56,-571.27 1248.7,-559.38 1292.66,-548.53"/>
<polygon fill="black" stroke="black" points="1293.69,-551.88 1302.56,-546.08 1292.01,-545.08 1293.69,-551.88"/>
</g>
<!-- layer15_expert1_up&#45;&gt;layer15_expert1_act -->
<g id="edge1577" class="edge">
<title>layer15_expert1_up&#45;&gt;layer15_expert1_act</title>
<path fill="none" stroke="black" d="M1436.5,-581.88C1436.5,-573.78 1436.5,-564.98 1436.5,-556.47"/>
<polygon fill="black" stroke="black" points="1440,-556.3 1436.5,-546.3 1433,-556.3 1440,-556.3"/>
</g>
<!-- layer15_expert1_down -->
<g id="node1112" class="node">
<title>layer15_expert1_down</title>
<polygon fill="lightblue" stroke="black" points="2479,-442 2096,-442 2096,-374 2479,-374 2479,-442"/>
<text text-anchor="middle" x="2287.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2287.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2287.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="2287.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer15_expert1_act&#45;&gt;layer15_expert1_down -->
<g id="edge1578" class="edge">
<title>layer15_expert1_act&#45;&gt;layer15_expert1_down</title>
<path fill="none" stroke="black" d="M1634.14,-487.31C1769.71,-471.06 1949.06,-449.57 2085.54,-433.21"/>
<polygon fill="black" stroke="black" points="2086.2,-436.65 2095.71,-431.99 2085.36,-429.7 2086.2,-436.65"/>
</g>
<!-- layer15_expert1_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1579" class="edge">
<title>layer15_expert1_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M2479.27,-395.64C2602.9,-388.62 2767.15,-379.87 2912.5,-374 4120.24,-325.24 5551.7,-292.34 6218.57,-278.46"/>
<polygon fill="black" stroke="black" points="6218.9,-281.95 6228.82,-278.24 6218.75,-274.95 6218.9,-281.95"/>
</g>
<!-- layer15_expert2_act -->
<g id="node1115" class="node">
<title>layer15_expert2_act</title>
<polygon fill="lightgreen" stroke="black" points="2460,-546 2065,-546 2065,-478 2460,-478 2460,-546"/>
<text text-anchor="middle" x="2262.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2262.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2262.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2262.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer15_expert2_gate&#45;&gt;layer15_expert2_act -->
<g id="edge1582" class="edge">
<title>layer15_expert2_gate&#45;&gt;layer15_expert2_act</title>
<path fill="none" stroke="black" d="M1983.3,-581.95C2026.56,-571.27 2074.7,-559.38 2118.66,-548.53"/>
<polygon fill="black" stroke="black" points="2119.69,-551.88 2128.56,-546.08 2118.01,-545.08 2119.69,-551.88"/>
</g>
<!-- layer15_expert2_up&#45;&gt;layer15_expert2_act -->
<g id="edge1583" class="edge">
<title>layer15_expert2_up&#45;&gt;layer15_expert2_act</title>
<path fill="none" stroke="black" d="M2262.5,-581.88C2262.5,-573.78 2262.5,-564.98 2262.5,-556.47"/>
<polygon fill="black" stroke="black" points="2266,-556.3 2262.5,-546.3 2259,-556.3 2266,-556.3"/>
</g>
<!-- layer15_expert2_down -->
<g id="node1116" class="node">
<title>layer15_expert2_down</title>
<polygon fill="lightblue" stroke="black" points="3305,-442 2922,-442 2922,-374 3305,-374 3305,-442"/>
<text text-anchor="middle" x="3113.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="3113.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3113.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3113.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer15_expert2_act&#45;&gt;layer15_expert2_down -->
<g id="edge1584" class="edge">
<title>layer15_expert2_act&#45;&gt;layer15_expert2_down</title>
<path fill="none" stroke="black" d="M2460.14,-487.31C2595.71,-471.06 2775.06,-449.57 2911.54,-433.21"/>
<polygon fill="black" stroke="black" points="2912.2,-436.65 2921.71,-431.99 2911.36,-429.7 2912.2,-436.65"/>
</g>
<!-- layer15_expert2_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1585" class="edge">
<title>layer15_expert2_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M3305.17,-389.79C3374.54,-384.05 3453.5,-378.09 3525.5,-374 4494.96,-318.94 5638.43,-290.1 6217.94,-278.03"/>
<polygon fill="black" stroke="black" points="6218.2,-281.53 6228.13,-277.82 6218.06,-274.53 6218.2,-281.53"/>
</g>
<!-- layer15_expert3_act -->
<g id="node1119" class="node">
<title>layer15_expert3_act</title>
<polygon fill="lightgreen" stroke="black" points="3286,-546 2891,-546 2891,-478 3286,-478 3286,-546"/>
<text text-anchor="middle" x="3088.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3088.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3088.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3088.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer15_expert3_gate&#45;&gt;layer15_expert3_act -->
<g id="edge1588" class="edge">
<title>layer15_expert3_gate&#45;&gt;layer15_expert3_act</title>
<path fill="none" stroke="black" d="M2809.3,-581.95C2852.56,-571.27 2900.7,-559.38 2944.66,-548.53"/>
<polygon fill="black" stroke="black" points="2945.69,-551.88 2954.56,-546.08 2944.01,-545.08 2945.69,-551.88"/>
</g>
<!-- layer15_expert3_up&#45;&gt;layer15_expert3_act -->
<g id="edge1589" class="edge">
<title>layer15_expert3_up&#45;&gt;layer15_expert3_act</title>
<path fill="none" stroke="black" d="M3088.5,-581.88C3088.5,-573.78 3088.5,-564.98 3088.5,-556.47"/>
<polygon fill="black" stroke="black" points="3092,-556.3 3088.5,-546.3 3085,-556.3 3092,-556.3"/>
</g>
<!-- layer15_expert3_down -->
<g id="node1120" class="node">
<title>layer15_expert3_down</title>
<polygon fill="lightblue" stroke="black" points="3918,-442 3535,-442 3535,-374 3918,-374 3918,-442"/>
<text text-anchor="middle" x="3726.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="3726.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3726.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="3726.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer15_expert3_act&#45;&gt;layer15_expert3_down -->
<g id="edge1590" class="edge">
<title>layer15_expert3_act&#45;&gt;layer15_expert3_down</title>
<path fill="none" stroke="black" d="M3286.43,-479.36C3362.16,-467.25 3448.56,-453.43 3524.65,-441.27"/>
<polygon fill="black" stroke="black" points="3525.51,-444.68 3534.83,-439.64 3524.4,-437.77 3525.51,-444.68"/>
</g>
<!-- layer15_expert3_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1591" class="edge">
<title>layer15_expert3_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M3918.12,-384.34C3955.99,-380.42 3995.47,-376.74 4032.5,-374 4807.97,-316.67 5717.95,-289.63 6218.19,-278.23"/>
<polygon fill="black" stroke="black" points="6218.54,-281.72 6228.46,-278 6218.38,-274.72 6218.54,-281.72"/>
</g>
<!-- layer15_expert4_act -->
<g id="node1123" class="node">
<title>layer15_expert4_act</title>
<polygon fill="lightgreen" stroke="black" points="4112,-546 3717,-546 3717,-478 4112,-478 4112,-546"/>
<text text-anchor="middle" x="3914.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="3914.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3914.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3914.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer15_expert4_gate&#45;&gt;layer15_expert4_act -->
<g id="edge1594" class="edge">
<title>layer15_expert4_gate&#45;&gt;layer15_expert4_act</title>
<path fill="none" stroke="black" d="M3635.3,-581.95C3678.56,-571.27 3726.7,-559.38 3770.66,-548.53"/>
<polygon fill="black" stroke="black" points="3771.69,-551.88 3780.56,-546.08 3770.01,-545.08 3771.69,-551.88"/>
</g>
<!-- layer15_expert4_up&#45;&gt;layer15_expert4_act -->
<g id="edge1595" class="edge">
<title>layer15_expert4_up&#45;&gt;layer15_expert4_act</title>
<path fill="none" stroke="black" d="M3914.5,-581.88C3914.5,-573.78 3914.5,-564.98 3914.5,-556.47"/>
<polygon fill="black" stroke="black" points="3918,-556.3 3914.5,-546.3 3911,-556.3 3918,-556.3"/>
</g>
<!-- layer15_expert4_down -->
<g id="node1124" class="node">
<title>layer15_expert4_down</title>
<polygon fill="lightblue" stroke="black" points="4425,-442 4042,-442 4042,-374 4425,-374 4425,-442"/>
<text text-anchor="middle" x="4233.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="4233.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4233.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4233.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer15_expert4_act&#45;&gt;layer15_expert4_down -->
<g id="edge1596" class="edge">
<title>layer15_expert4_act&#45;&gt;layer15_expert4_down</title>
<path fill="none" stroke="black" d="M4018.07,-477.88C4050.77,-467.43 4087.07,-455.82 4120.4,-445.16"/>
<polygon fill="black" stroke="black" points="4121.72,-448.42 4130.18,-442.04 4119.59,-441.75 4121.72,-448.42"/>
</g>
<!-- layer15_expert4_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1597" class="edge">
<title>layer15_expert4_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M4425.3,-394.54C4523.96,-388.22 4646.16,-380.52 4755.5,-374 5269.41,-343.37 5864.22,-310.55 6235.2,-290.4"/>
<polygon fill="black" stroke="black" points="6235.49,-293.89 6245.28,-289.85 6235.11,-286.9 6235.49,-293.89"/>
</g>
<!-- layer15_expert5_act -->
<g id="node1127" class="node">
<title>layer15_expert5_act</title>
<polygon fill="lightgreen" stroke="black" points="4938,-546 4543,-546 4543,-478 4938,-478 4938,-546"/>
<text text-anchor="middle" x="4740.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="4740.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4740.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4740.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer15_expert5_gate&#45;&gt;layer15_expert5_act -->
<g id="edge1600" class="edge">
<title>layer15_expert5_gate&#45;&gt;layer15_expert5_act</title>
<path fill="none" stroke="black" d="M4461.3,-581.95C4504.56,-571.27 4552.7,-559.38 4596.66,-548.53"/>
<polygon fill="black" stroke="black" points="4597.69,-551.88 4606.56,-546.08 4596.01,-545.08 4597.69,-551.88"/>
</g>
<!-- layer15_expert5_up&#45;&gt;layer15_expert5_act -->
<g id="edge1601" class="edge">
<title>layer15_expert5_up&#45;&gt;layer15_expert5_act</title>
<path fill="none" stroke="black" d="M4740.5,-581.88C4740.5,-573.78 4740.5,-564.98 4740.5,-556.47"/>
<polygon fill="black" stroke="black" points="4744,-556.3 4740.5,-546.3 4737,-556.3 4744,-556.3"/>
</g>
<!-- layer15_expert5_down -->
<g id="node1128" class="node">
<title>layer15_expert5_down</title>
<polygon fill="lightblue" stroke="black" points="5148,-442 4765,-442 4765,-374 5148,-374 5148,-442"/>
<text text-anchor="middle" x="4956.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="4956.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4956.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="4956.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer15_expert5_act&#45;&gt;layer15_expert5_down -->
<g id="edge1602" class="edge">
<title>layer15_expert5_act&#45;&gt;layer15_expert5_down</title>
<path fill="none" stroke="black" d="M4810.63,-477.88C4831.86,-467.86 4855.33,-456.77 4877.13,-446.48"/>
<polygon fill="black" stroke="black" points="4878.81,-449.56 4886.35,-442.12 4875.82,-443.23 4878.81,-449.56"/>
</g>
<!-- layer15_expert5_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1603" class="edge">
<title>layer15_expert5_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M5148.12,-391.1C5417.49,-368.75 5912.61,-327.66 6247.89,-299.84"/>
<polygon fill="black" stroke="black" points="6248.58,-303.3 6258.26,-298.98 6248,-296.32 6248.58,-303.3"/>
</g>
<!-- layer15_expert6_act -->
<g id="node1131" class="node">
<title>layer15_expert6_act</title>
<polygon fill="lightgreen" stroke="black" points="5764,-546 5369,-546 5369,-478 5764,-478 5764,-546"/>
<text text-anchor="middle" x="5566.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="5566.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5566.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5566.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer15_expert6_gate&#45;&gt;layer15_expert6_act -->
<g id="edge1606" class="edge">
<title>layer15_expert6_gate&#45;&gt;layer15_expert6_act</title>
<path fill="none" stroke="black" d="M5287.3,-581.95C5330.56,-571.27 5378.7,-559.38 5422.66,-548.53"/>
<polygon fill="black" stroke="black" points="5423.69,-551.88 5432.56,-546.08 5422.01,-545.08 5423.69,-551.88"/>
</g>
<!-- layer15_expert6_up&#45;&gt;layer15_expert6_act -->
<g id="edge1607" class="edge">
<title>layer15_expert6_up&#45;&gt;layer15_expert6_act</title>
<path fill="none" stroke="black" d="M5566.5,-581.88C5566.5,-573.78 5566.5,-564.98 5566.5,-556.47"/>
<polygon fill="black" stroke="black" points="5570,-556.3 5566.5,-546.3 5563,-556.3 5570,-556.3"/>
</g>
<!-- layer15_expert6_down -->
<g id="node1132" class="node">
<title>layer15_expert6_down</title>
<polygon fill="lightblue" stroke="black" points="5974,-442 5591,-442 5591,-374 5974,-374 5974,-442"/>
<text text-anchor="middle" x="5782.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="5782.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5782.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="5782.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer15_expert6_act&#45;&gt;layer15_expert6_down -->
<g id="edge1608" class="edge">
<title>layer15_expert6_act&#45;&gt;layer15_expert6_down</title>
<path fill="none" stroke="black" d="M5636.63,-477.88C5657.86,-467.86 5681.33,-456.77 5703.13,-446.48"/>
<polygon fill="black" stroke="black" points="5704.81,-449.56 5712.35,-442.12 5701.82,-443.23 5704.81,-449.56"/>
</g>
<!-- layer15_expert6_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1609" class="edge">
<title>layer15_expert6_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M5974.14,-374.94C6065.66,-359.63 6177.58,-340.91 6281.09,-323.59"/>
<polygon fill="black" stroke="black" points="6281.79,-327.03 6291.08,-321.92 6280.64,-320.12 6281.79,-327.03"/>
</g>
<!-- layer15_expert7_act -->
<g id="node1135" class="node">
<title>layer15_expert7_act</title>
<polygon fill="lightgreen" stroke="black" points="6590,-546 6195,-546 6195,-478 6590,-478 6590,-546"/>
<text text-anchor="middle" x="6392.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="6392.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6392.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6392.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer15_expert7_gate&#45;&gt;layer15_expert7_act -->
<g id="edge1612" class="edge">
<title>layer15_expert7_gate&#45;&gt;layer15_expert7_act</title>
<path fill="none" stroke="black" d="M6113.3,-581.95C6156.56,-571.27 6204.7,-559.38 6248.66,-548.53"/>
<polygon fill="black" stroke="black" points="6249.69,-551.88 6258.56,-546.08 6248.01,-545.08 6249.69,-551.88"/>
</g>
<!-- layer15_expert7_up&#45;&gt;layer15_expert7_act -->
<g id="edge1613" class="edge">
<title>layer15_expert7_up&#45;&gt;layer15_expert7_act</title>
<path fill="none" stroke="black" d="M6392.5,-581.88C6392.5,-573.78 6392.5,-564.98 6392.5,-556.47"/>
<polygon fill="black" stroke="black" points="6396,-556.3 6392.5,-546.3 6389,-556.3 6396,-556.3"/>
</g>
<!-- layer15_expert7_down -->
<g id="node1136" class="node">
<title>layer15_expert7_down</title>
<polygon fill="lightblue" stroke="black" points="6587,-442 6204,-442 6204,-374 6587,-374 6587,-442"/>
<text text-anchor="middle" x="6395.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="6395.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6395.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6395.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer15_expert7_act&#45;&gt;layer15_expert7_down -->
<g id="edge1614" class="edge">
<title>layer15_expert7_act&#45;&gt;layer15_expert7_down</title>
<path fill="none" stroke="black" d="M6393.47,-477.88C6393.71,-469.78 6393.97,-460.98 6394.22,-452.47"/>
<polygon fill="black" stroke="black" points="6397.73,-452.4 6394.52,-442.3 6390.73,-452.19 6397.73,-452.4"/>
</g>
<!-- layer15_expert7_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1615" class="edge">
<title>layer15_expert7_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M6444.17,-373.9C6457.63,-364.75 6472.8,-354.44 6488.2,-343.97"/>
<polygon fill="black" stroke="black" points="6490.47,-346.66 6496.77,-338.14 6486.53,-340.87 6490.47,-346.66"/>
</g>
<!-- layer15_expert8_act -->
<g id="node1139" class="node">
<title>layer15_expert8_act</title>
<polygon fill="lightgreen" stroke="black" points="7003,-546 6608,-546 6608,-478 7003,-478 7003,-546"/>
<text text-anchor="middle" x="6805.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="6805.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6805.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6805.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_expert8_gate&#45;&gt;layer15_expert8_act -->
<g id="edge1618" class="edge">
<title>layer15_expert8_gate&#45;&gt;layer15_expert8_act</title>
<path fill="none" stroke="black" d="M6805.5,-581.88C6805.5,-573.78 6805.5,-564.98 6805.5,-556.47"/>
<polygon fill="black" stroke="black" points="6809,-556.3 6805.5,-546.3 6802,-556.3 6809,-556.3"/>
</g>
<!-- layer15_expert8_up&#45;&gt;layer15_expert8_act -->
<g id="edge1619" class="edge">
<title>layer15_expert8_up&#45;&gt;layer15_expert8_act</title>
<path fill="none" stroke="black" d="M7084.7,-581.95C7041.44,-571.27 6993.3,-559.38 6949.34,-548.53"/>
<polygon fill="black" stroke="black" points="6949.99,-545.08 6939.44,-546.08 6948.31,-551.88 6949.99,-545.08"/>
</g>
<!-- layer15_expert8_down -->
<g id="node1140" class="node">
<title>layer15_expert8_down</title>
<polygon fill="lightblue" stroke="black" points="6994,-442 6611,-442 6611,-374 6994,-374 6994,-442"/>
<text text-anchor="middle" x="6802.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="6802.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6802.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="6802.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_expert8_act&#45;&gt;layer15_expert8_down -->
<g id="edge1620" class="edge">
<title>layer15_expert8_act&#45;&gt;layer15_expert8_down</title>
<path fill="none" stroke="black" d="M6804.53,-477.88C6804.29,-469.78 6804.03,-460.98 6803.78,-452.47"/>
<polygon fill="black" stroke="black" points="6807.27,-452.19 6803.48,-442.3 6800.27,-452.4 6807.27,-452.19"/>
</g>
<!-- layer15_expert8_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1621" class="edge">
<title>layer15_expert8_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M6752.13,-373.9C6738.06,-364.66 6722.2,-354.25 6706.12,-343.67"/>
<polygon fill="black" stroke="black" points="6707.97,-340.7 6697.69,-338.14 6704.12,-346.55 6707.97,-340.7"/>
</g>
<!-- layer15_expert9_act -->
<g id="node1143" class="node">
<title>layer15_expert9_act</title>
<polygon fill="lightgreen" stroke="black" points="7829,-546 7434,-546 7434,-478 7829,-478 7829,-546"/>
<text text-anchor="middle" x="7631.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="7631.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7631.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7631.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_expert9_gate&#45;&gt;layer15_expert9_act -->
<g id="edge1624" class="edge">
<title>layer15_expert9_gate&#45;&gt;layer15_expert9_act</title>
<path fill="none" stroke="black" d="M7631.5,-581.88C7631.5,-573.78 7631.5,-564.98 7631.5,-556.47"/>
<polygon fill="black" stroke="black" points="7635,-556.3 7631.5,-546.3 7628,-556.3 7635,-556.3"/>
</g>
<!-- layer15_expert9_up&#45;&gt;layer15_expert9_act -->
<g id="edge1625" class="edge">
<title>layer15_expert9_up&#45;&gt;layer15_expert9_act</title>
<path fill="none" stroke="black" d="M7910.7,-581.95C7867.44,-571.27 7819.3,-559.38 7775.34,-548.53"/>
<polygon fill="black" stroke="black" points="7775.99,-545.08 7765.44,-546.08 7774.31,-551.88 7775.99,-545.08"/>
</g>
<!-- layer15_expert9_down -->
<g id="node1144" class="node">
<title>layer15_expert9_down</title>
<polygon fill="lightblue" stroke="black" points="7610,-442 7227,-442 7227,-374 7610,-374 7610,-442"/>
<text text-anchor="middle" x="7418.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="7418.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7418.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="7418.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_expert9_act&#45;&gt;layer15_expert9_down -->
<g id="edge1626" class="edge">
<title>layer15_expert9_act&#45;&gt;layer15_expert9_down</title>
<path fill="none" stroke="black" d="M7562.35,-477.88C7541.41,-467.86 7518.26,-456.77 7496.77,-446.48"/>
<polygon fill="black" stroke="black" points="7498.2,-443.29 7487.67,-442.12 7495.18,-449.6 7498.2,-443.29"/>
</g>
<!-- layer15_expert9_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1627" class="edge">
<title>layer15_expert9_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M7226.84,-375.33C7161.96,-364.61 7086.75,-352.18 7011.34,-339.72"/>
<polygon fill="black" stroke="black" points="7011.62,-336.22 7001.19,-338.04 7010.48,-343.12 7011.62,-336.22"/>
</g>
<!-- layer15_expert10_act -->
<g id="node1147" class="node">
<title>layer15_expert10_act</title>
<polygon fill="lightgreen" stroke="black" points="8655,-546 8260,-546 8260,-478 8655,-478 8655,-546"/>
<text text-anchor="middle" x="8457.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="8457.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8457.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8457.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_expert10_gate&#45;&gt;layer15_expert10_act -->
<g id="edge1630" class="edge">
<title>layer15_expert10_gate&#45;&gt;layer15_expert10_act</title>
<path fill="none" stroke="black" d="M8457.5,-581.88C8457.5,-573.78 8457.5,-564.98 8457.5,-556.47"/>
<polygon fill="black" stroke="black" points="8461,-556.3 8457.5,-546.3 8454,-556.3 8461,-556.3"/>
</g>
<!-- layer15_expert10_up&#45;&gt;layer15_expert10_act -->
<g id="edge1631" class="edge">
<title>layer15_expert10_up&#45;&gt;layer15_expert10_act</title>
<path fill="none" stroke="black" d="M8736.7,-581.95C8693.44,-571.27 8645.3,-559.38 8601.34,-548.53"/>
<polygon fill="black" stroke="black" points="8601.99,-545.08 8591.44,-546.08 8600.31,-551.88 8601.99,-545.08"/>
</g>
<!-- layer15_expert10_down -->
<g id="node1148" class="node">
<title>layer15_expert10_down</title>
<polygon fill="lightblue" stroke="black" points="8331,-442 7948,-442 7948,-374 8331,-374 8331,-442"/>
<text text-anchor="middle" x="8139.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8139.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8139.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8139.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_expert10_act&#45;&gt;layer15_expert10_down -->
<g id="edge1632" class="edge">
<title>layer15_expert10_act&#45;&gt;layer15_expert10_down</title>
<path fill="none" stroke="black" d="M8354.25,-477.88C8321.65,-467.43 8285.47,-455.82 8252.25,-445.16"/>
<polygon fill="black" stroke="black" points="8253.09,-441.76 8242.5,-442.04 8250.95,-448.42 8253.09,-441.76"/>
</g>
<!-- layer15_expert10_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1633" class="edge">
<title>layer15_expert10_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M7947.85,-390.12C7722.46,-370.27 7340.98,-336.66 7040.54,-310.2"/>
<polygon fill="black" stroke="black" points="7040.61,-306.69 7030.34,-309.3 7039.99,-313.67 7040.61,-306.69"/>
</g>
<!-- layer15_expert11_act -->
<g id="node1151" class="node">
<title>layer15_expert11_act</title>
<polygon fill="lightgreen" stroke="black" points="9481,-546 9086,-546 9086,-478 9481,-478 9481,-546"/>
<text text-anchor="middle" x="9283.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="9283.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9283.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9283.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_expert11_gate&#45;&gt;layer15_expert11_act -->
<g id="edge1636" class="edge">
<title>layer15_expert11_gate&#45;&gt;layer15_expert11_act</title>
<path fill="none" stroke="black" d="M9283.5,-581.88C9283.5,-573.78 9283.5,-564.98 9283.5,-556.47"/>
<polygon fill="black" stroke="black" points="9287,-556.3 9283.5,-546.3 9280,-556.3 9287,-556.3"/>
</g>
<!-- layer15_expert11_up&#45;&gt;layer15_expert11_act -->
<g id="edge1637" class="edge">
<title>layer15_expert11_up&#45;&gt;layer15_expert11_act</title>
<path fill="none" stroke="black" d="M9562.7,-581.95C9519.44,-571.27 9471.3,-559.38 9427.34,-548.53"/>
<polygon fill="black" stroke="black" points="9427.99,-545.08 9417.44,-546.08 9426.31,-551.88 9427.99,-545.08"/>
</g>
<!-- layer15_expert11_down -->
<g id="node1152" class="node">
<title>layer15_expert11_down</title>
<polygon fill="lightblue" stroke="black" points="9105,-442 8722,-442 8722,-374 9105,-374 9105,-442"/>
<text text-anchor="middle" x="8913.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="8913.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8913.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="8913.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_expert11_act&#45;&gt;layer15_expert11_down -->
<g id="edge1638" class="edge">
<title>layer15_expert11_act&#45;&gt;layer15_expert11_down</title>
<path fill="none" stroke="black" d="M9163.63,-477.95C9125.2,-467.36 9082.47,-455.58 9043.36,-444.8"/>
<polygon fill="black" stroke="black" points="9044.07,-441.36 9033.5,-442.08 9042.21,-448.11 9044.07,-441.36"/>
</g>
<!-- layer15_expert11_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1639" class="edge">
<title>layer15_expert11_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M8721.84,-395.75C8350.82,-373.99 7526.55,-325.63 7020.2,-295.92"/>
<polygon fill="black" stroke="black" points="7020.35,-292.42 7010.17,-295.33 7019.94,-299.41 7020.35,-292.42"/>
</g>
<!-- layer15_expert12_act -->
<g id="node1155" class="node">
<title>layer15_expert12_act</title>
<polygon fill="lightgreen" stroke="black" points="10307,-546 9912,-546 9912,-478 10307,-478 10307,-546"/>
<text text-anchor="middle" x="10109.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="10109.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10109.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10109.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_expert12_gate&#45;&gt;layer15_expert12_act -->
<g id="edge1642" class="edge">
<title>layer15_expert12_gate&#45;&gt;layer15_expert12_act</title>
<path fill="none" stroke="black" d="M10109.5,-581.88C10109.5,-573.78 10109.5,-564.98 10109.5,-556.47"/>
<polygon fill="black" stroke="black" points="10113,-556.3 10109.5,-546.3 10106,-556.3 10113,-556.3"/>
</g>
<!-- layer15_expert12_up&#45;&gt;layer15_expert12_act -->
<g id="edge1643" class="edge">
<title>layer15_expert12_up&#45;&gt;layer15_expert12_act</title>
<path fill="none" stroke="black" d="M10388.7,-581.95C10345.44,-571.27 10297.3,-559.38 10253.34,-548.53"/>
<polygon fill="black" stroke="black" points="10253.99,-545.08 10243.44,-546.08 10252.31,-551.88 10253.99,-545.08"/>
</g>
<!-- layer15_expert12_down -->
<g id="node1156" class="node">
<title>layer15_expert12_down</title>
<polygon fill="lightblue" stroke="black" points="9905,-442 9522,-442 9522,-374 9905,-374 9905,-442"/>
<text text-anchor="middle" x="9713.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="9713.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9713.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="9713.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_expert12_act&#45;&gt;layer15_expert12_down -->
<g id="edge1644" class="edge">
<title>layer15_expert12_act&#45;&gt;layer15_expert12_down</title>
<path fill="none" stroke="black" d="M9981.2,-477.95C9939.81,-467.29 9893.76,-455.43 9851.69,-444.59"/>
<polygon fill="black" stroke="black" points="9852.49,-441.19 9841.93,-442.08 9850.74,-447.96 9852.49,-441.19"/>
</g>
<!-- layer15_expert12_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1645" class="edge">
<title>layer15_expert12_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M9521.67,-395.74C9404.15,-389.01 9250.65,-380.53 9114.5,-374 8371.75,-338.36 7505.41,-304.66 7006.65,-286.02"/>
<polygon fill="black" stroke="black" points="7006.53,-282.52 6996.41,-285.64 7006.27,-289.51 7006.53,-282.52"/>
</g>
<!-- layer15_expert13_act -->
<g id="node1159" class="node">
<title>layer15_expert13_act</title>
<polygon fill="lightgreen" stroke="black" points="11133,-546 10738,-546 10738,-478 11133,-478 11133,-546"/>
<text text-anchor="middle" x="10935.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="10935.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10935.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10935.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_expert13_gate&#45;&gt;layer15_expert13_act -->
<g id="edge1648" class="edge">
<title>layer15_expert13_gate&#45;&gt;layer15_expert13_act</title>
<path fill="none" stroke="black" d="M10935.5,-581.88C10935.5,-573.78 10935.5,-564.98 10935.5,-556.47"/>
<polygon fill="black" stroke="black" points="10939,-556.3 10935.5,-546.3 10932,-556.3 10939,-556.3"/>
</g>
<!-- layer15_expert13_up&#45;&gt;layer15_expert13_act -->
<g id="edge1649" class="edge">
<title>layer15_expert13_up&#45;&gt;layer15_expert13_act</title>
<path fill="none" stroke="black" d="M11214.7,-581.95C11171.44,-571.27 11123.3,-559.38 11079.34,-548.53"/>
<polygon fill="black" stroke="black" points="11079.99,-545.08 11069.44,-546.08 11078.31,-551.88 11079.99,-545.08"/>
</g>
<!-- layer15_expert13_down -->
<g id="node1160" class="node">
<title>layer15_expert13_down</title>
<polygon fill="lightblue" stroke="black" points="10718,-442 10335,-442 10335,-374 10718,-374 10718,-442"/>
<text text-anchor="middle" x="10526.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10526.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10526.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="10526.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_expert13_act&#45;&gt;layer15_expert13_down -->
<g id="edge1650" class="edge">
<title>layer15_expert13_act&#45;&gt;layer15_expert13_down</title>
<path fill="none" stroke="black" d="M10802.99,-477.95C10760.15,-467.27 10712.48,-455.38 10668.95,-444.53"/>
<polygon fill="black" stroke="black" points="10669.7,-441.1 10659.15,-442.08 10668,-447.9 10669.7,-441.1"/>
</g>
<!-- layer15_expert13_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1651" class="edge">
<title>layer15_expert13_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M10334.98,-395.55C10214.35,-388.61 10055.36,-379.98 9914.5,-374 8863.09,-329.34 7623.53,-296 6998.76,-280.54"/>
<polygon fill="black" stroke="black" points="6998.78,-277.04 6988.69,-280.3 6998.6,-284.04 6998.78,-277.04"/>
</g>
<!-- layer15_expert14_act -->
<g id="node1163" class="node">
<title>layer15_expert14_act</title>
<polygon fill="lightgreen" stroke="black" points="11959,-546 11564,-546 11564,-478 11959,-478 11959,-546"/>
<text text-anchor="middle" x="11761.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="11761.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11761.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11761.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_expert14_gate&#45;&gt;layer15_expert14_act -->
<g id="edge1654" class="edge">
<title>layer15_expert14_gate&#45;&gt;layer15_expert14_act</title>
<path fill="none" stroke="black" d="M11761.5,-581.88C11761.5,-573.78 11761.5,-564.98 11761.5,-556.47"/>
<polygon fill="black" stroke="black" points="11765,-556.3 11761.5,-546.3 11758,-556.3 11765,-556.3"/>
</g>
<!-- layer15_expert14_up&#45;&gt;layer15_expert14_act -->
<g id="edge1655" class="edge">
<title>layer15_expert14_up&#45;&gt;layer15_expert14_act</title>
<path fill="none" stroke="black" d="M12040.7,-581.95C11997.44,-571.27 11949.3,-559.38 11905.34,-548.53"/>
<polygon fill="black" stroke="black" points="11905.99,-545.08 11895.44,-546.08 11904.31,-551.88 11905.99,-545.08"/>
</g>
<!-- layer15_expert14_down -->
<g id="node1164" class="node">
<title>layer15_expert14_down</title>
<polygon fill="lightblue" stroke="black" points="11537,-442 11154,-442 11154,-374 11537,-374 11537,-442"/>
<text text-anchor="middle" x="11345.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11345.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11345.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="11345.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_expert14_act&#45;&gt;layer15_expert14_down -->
<g id="edge1656" class="edge">
<title>layer15_expert14_act&#45;&gt;layer15_expert14_down</title>
<path fill="none" stroke="black" d="M11626.72,-477.95C11583.15,-467.27 11534.66,-455.38 11490.39,-444.53"/>
<polygon fill="black" stroke="black" points="11490.96,-441.06 11480.42,-442.08 11489.3,-447.86 11490.96,-441.06"/>
</g>
<!-- layer15_expert14_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1657" class="edge">
<title>layer15_expert14_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M11153.83,-395.36C11031.82,-388.3 10870.43,-379.6 10727.5,-374 9357.85,-320.37 7731.66,-289.43 6994.32,-277.17"/>
<polygon fill="black" stroke="black" points="6994.12,-273.67 6984.07,-277 6994.01,-280.67 6994.12,-273.67"/>
</g>
<!-- layer15_expert15_act -->
<g id="node1167" class="node">
<title>layer15_expert15_act</title>
<polygon fill="lightgreen" stroke="black" points="12785,-546 12390,-546 12390,-478 12785,-478 12785,-546"/>
<text text-anchor="middle" x="12587.5" y="-530.8" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="12587.5" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12587.5" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12587.5" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_expert15_gate&#45;&gt;layer15_expert15_act -->
<g id="edge1660" class="edge">
<title>layer15_expert15_gate&#45;&gt;layer15_expert15_act</title>
<path fill="none" stroke="black" d="M12587.5,-581.88C12587.5,-573.78 12587.5,-564.98 12587.5,-556.47"/>
<polygon fill="black" stroke="black" points="12591,-556.3 12587.5,-546.3 12584,-556.3 12591,-556.3"/>
</g>
<!-- layer15_expert15_up&#45;&gt;layer15_expert15_act -->
<g id="edge1661" class="edge">
<title>layer15_expert15_up&#45;&gt;layer15_expert15_act</title>
<path fill="none" stroke="black" d="M12866.7,-581.95C12823.44,-571.27 12775.3,-559.38 12731.34,-548.53"/>
<polygon fill="black" stroke="black" points="12731.99,-545.08 12721.44,-546.08 12730.31,-551.88 12731.99,-545.08"/>
</g>
<!-- layer15_expert15_down -->
<g id="node1168" class="node">
<title>layer15_expert15_down</title>
<polygon fill="lightblue" stroke="black" points="12360,-442 11977,-442 11977,-374 12360,-374 12360,-442"/>
<text text-anchor="middle" x="12168.5" y="-426.8" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12168.5" y="-411.8" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, seq_len, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12168.5" y="-396.8" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, seq_len, hidden=4096]</text>
<text text-anchor="middle" x="12168.5" y="-381.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_expert15_act&#45;&gt;layer15_expert15_down -->
<g id="edge1662" class="edge">
<title>layer15_expert15_act&#45;&gt;layer15_expert15_down</title>
<path fill="none" stroke="black" d="M12451.75,-477.95C12407.77,-467.25 12358.82,-455.33 12314.15,-444.46"/>
<polygon fill="black" stroke="black" points="12314.93,-441.05 12304.39,-442.08 12313.28,-447.85 12314.93,-441.05"/>
</g>
<!-- layer15_expert15_down&#45;&gt;layer15_token_aggregation -->
<g id="edge1663" class="edge">
<title>layer15_expert15_down&#45;&gt;layer15_token_aggregation</title>
<path fill="none" stroke="black" d="M11976.98,-395.24C11854.02,-388.09 11690.9,-379.33 11546.5,-374 9852.24,-311.45 7830.33,-284.15 6990.93,-274.91"/>
<polygon fill="black" stroke="black" points="6990.84,-271.4 6980.8,-274.79 6990.76,-278.4 6990.84,-271.4"/>
</g>
<!-- layer15_res2 -->
<g id="node1170" class="node">
<title>layer15_res2</title>
<polygon fill="none" stroke="black" points="7036.24,-166 6335.12,-166 6154.76,0 6855.88,0 7036.24,-166"/>
<text text-anchor="middle" x="6595.5" y="-109.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6595.5" y="-94.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6595.5" y="-79.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6595.5" y="-64.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6595.5" y="-49.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_token_aggregation&#45;&gt;layer15_res2 -->
<g id="edge1664" class="edge">
<title>layer15_token_aggregation&#45;&gt;layer15_res2</title>
<path fill="none" stroke="black" d="M6595.5,-201.95C6595.5,-193.63 6595.5,-185 6595.5,-176.38"/>
<polygon fill="black" stroke="black" points="6599,-176.28 6595.5,-166.28 6592,-176.28 6599,-176.28"/>
</g>
</g>
</svg>
