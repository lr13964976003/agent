<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_deployment Pages: 1 -->
<svg width="1440pt" height="894pt"
 viewBox="0.00 0.00 1440.00 894.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.08 0.08) rotate(0) translate(4 11286.74)">
<title>baseline_moe_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11286.74 18175.02,-11286.74 18175.02,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="4739.5" cy="-11255.87" rx="292.07" ry="26.74"/>
<text text-anchor="middle" x="4739.5" y="-11259.67" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4739.5" y="-11244.67" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- layer0_mha_qkv_0 -->
<g id="node2" class="node">
<title>layer0_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="3295.5,-11166.5 2739.5,-11166.5 2739.5,-11083.5 3295.5,-11083.5 3295.5,-11166.5"/>
<text text-anchor="middle" x="3017.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3017.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="3017.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3017.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3017.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_0</title>
<path fill="none" stroke="black" d="M4456.7,-11249.07C4101.18,-11240.61 3511.36,-11222.59 3295.5,-11193 3253.85,-11187.29 3209.37,-11178.35 3168.47,-11168.83"/>
<polygon fill="black" stroke="black" points="3169.24,-11165.41 3158.7,-11166.53 3167.63,-11172.23 3169.24,-11165.41"/>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_0 -->
<g id="edge1409" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_0</title>
<path fill="none" stroke="black" d="M4457.63,-11248.79C4106.57,-11240.22 3527.05,-11222.27 3313.5,-11193 3271.85,-11187.29 3227.37,-11178.35 3185.87,-11168.83"/>
<polygon fill="black" stroke="black" points="3186.48,-11165.38 3175.95,-11166.53 3184.9,-11172.2 3186.48,-11165.38"/>
</g>
<!-- layer0_mha_qkv_1 -->
<g id="node3" class="node">
<title>layer0_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="3869.5,-11166.5 3313.5,-11166.5 3313.5,-11083.5 3869.5,-11083.5 3869.5,-11166.5"/>
<text text-anchor="middle" x="3591.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3591.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="3591.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3591.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3591.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_1 -->
<g id="edge12" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_1</title>
<path fill="none" stroke="black" d="M4466.35,-11246.24C4296.46,-11238.16 4073.9,-11222.64 3878.5,-11193 3838.19,-11186.89 3795.17,-11178.09 3755.03,-11168.87"/>
<polygon fill="black" stroke="black" points="3755.7,-11165.43 3745.17,-11166.58 3754.12,-11172.25 3755.7,-11165.43"/>
</g>
<!-- layer0_mha_qkv_2 -->
<g id="node4" class="node">
<title>layer0_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="4443.5,-11166.5 3887.5,-11166.5 3887.5,-11083.5 4443.5,-11083.5 4443.5,-11166.5"/>
<text text-anchor="middle" x="4165.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4165.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="4165.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4165.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4165.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_2 -->
<g id="edge23" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_2</title>
<path fill="none" stroke="black" d="M4626.95,-11231.07C4573.97,-11219.75 4509.94,-11205.9 4452.5,-11193 4418.28,-11185.32 4381.8,-11176.94 4346.73,-11168.8"/>
<polygon fill="black" stroke="black" points="4347.41,-11165.37 4336.88,-11166.51 4345.83,-11172.18 4347.41,-11165.37"/>
</g>
<!-- layer0_mha_qkv_3 -->
<g id="node5" class="node">
<title>layer0_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="5017.5,-11166.5 4461.5,-11166.5 4461.5,-11083.5 5017.5,-11083.5 5017.5,-11166.5"/>
<text text-anchor="middle" x="4739.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4739.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4739.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4739.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4739.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_3 -->
<g id="edge34" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4739.5,-11228.79C4739.5,-11213.85 4739.5,-11194.59 4739.5,-11176.78"/>
<polygon fill="black" stroke="black" points="4743,-11176.51 4739.5,-11166.51 4736,-11176.51 4743,-11176.51"/>
</g>
<!-- layer0_mha_qkv_4 -->
<g id="node6" class="node">
<title>layer0_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="5591.5,-11166.5 5035.5,-11166.5 5035.5,-11083.5 5591.5,-11083.5 5591.5,-11166.5"/>
<text text-anchor="middle" x="5313.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5313.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5313.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5313.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5313.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_4 -->
<g id="edge45" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_4</title>
<path fill="none" stroke="black" d="M4852.05,-11231.07C4905.03,-11219.75 4969.06,-11205.9 5026.5,-11193 5060.72,-11185.32 5097.2,-11176.94 5132.27,-11168.8"/>
<polygon fill="black" stroke="black" points="5133.17,-11172.18 5142.12,-11166.51 5131.59,-11165.37 5133.17,-11172.18"/>
</g>
<!-- layer0_mha_qkv_5 -->
<g id="node7" class="node">
<title>layer0_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="6192.5,-11166.5 5636.5,-11166.5 5636.5,-11083.5 6192.5,-11083.5 6192.5,-11166.5"/>
<text text-anchor="middle" x="5914.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5914.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="5914.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5914.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5914.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_5 -->
<g id="edge56" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_5</title>
<path fill="none" stroke="black" d="M5007.64,-11245.17C5178.05,-11236.64 5402.97,-11221.03 5600.5,-11193 5644.5,-11186.76 5691.54,-11177.9 5735.47,-11168.67"/>
<polygon fill="black" stroke="black" points="5736.32,-11172.07 5745.38,-11166.57 5734.87,-11165.22 5736.32,-11172.07"/>
</g>
<!-- layer0_mha_qkv_6 -->
<g id="node8" class="node">
<title>layer0_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="6941.5,-11166.5 6385.5,-11166.5 6385.5,-11083.5 6941.5,-11083.5 6941.5,-11166.5"/>
<text text-anchor="middle" x="6663.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6663.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="6663.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6663.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6663.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_6 -->
<g id="edge67" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_6</title>
<path fill="none" stroke="black" d="M5027.55,-11251.32C5322.83,-11245.65 5795.05,-11230.97 6201.5,-11193 6268.18,-11186.77 6339.95,-11177.58 6406.58,-11167.99"/>
<polygon fill="black" stroke="black" points="6407.4,-11171.41 6416.8,-11166.51 6406.4,-11164.48 6407.4,-11171.41"/>
</g>
<!-- layer0_mha_qkv_7 -->
<g id="node9" class="node">
<title>layer0_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="7603.5,-11166.5 7047.5,-11166.5 7047.5,-11083.5 7603.5,-11083.5 7603.5,-11166.5"/>
<text text-anchor="middle" x="7325.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7325.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="7325.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7325.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7325.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv_7 -->
<g id="edge78" class="edge">
<title>input&#45;&gt;layer0_mha_qkv_7</title>
<path fill="none" stroke="black" d="M5028.7,-11252.13C5540.67,-11246.38 6586.77,-11230.37 6950.5,-11193 7005.89,-11187.31 7065.41,-11178.11 7120.35,-11168.34"/>
<polygon fill="black" stroke="black" points="7120.97,-11171.78 7130.19,-11166.57 7119.73,-11164.89 7120.97,-11171.78"/>
</g>
<!-- layer0_mha_attn_0 -->
<g id="node47" class="node">
<title>layer0_mha_attn_0</title>
<polygon fill="none" stroke="black" points="2888,-10956 2737,-10956 2737,-10920 2888,-10920 2888,-10956"/>
<text text-anchor="middle" x="2812.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_0</text>
</g>
<!-- layer0_mha_qkv_0&#45;&gt;layer0_mha_attn_0 -->
<g id="edge2" class="edge">
<title>layer0_mha_qkv_0&#45;&gt;layer0_mha_attn_0</title>
<path fill="none" stroke="black" d="M2972.51,-11083.4C2931.7,-11046.57 2872.91,-10993.52 2839.12,-10963.03"/>
<polygon fill="black" stroke="black" points="2841.27,-10960.25 2831.5,-10956.15 2836.58,-10965.44 2841.27,-10960.25"/>
</g>
<!-- layer0_mha_attn_1 -->
<g id="node52" class="node">
<title>layer0_mha_attn_1</title>
<polygon fill="none" stroke="black" points="3200,-10956 3049,-10956 3049,-10920 3200,-10920 3200,-10956"/>
<text text-anchor="middle" x="3124.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_1</text>
</g>
<!-- layer0_mha_qkv_1&#45;&gt;layer0_mha_attn_1 -->
<g id="edge13" class="edge">
<title>layer0_mha_qkv_1&#45;&gt;layer0_mha_attn_1</title>
<path fill="none" stroke="black" d="M3489.01,-11083.4C3392.78,-11045.28 3252.66,-10989.77 3177.25,-10959.9"/>
<polygon fill="black" stroke="black" points="3178.08,-10956.46 3167.49,-10956.03 3175.5,-10962.97 3178.08,-10956.46"/>
</g>
<!-- layer0_mha_attn_2 -->
<g id="node57" class="node">
<title>layer0_mha_attn_2</title>
<polygon fill="none" stroke="black" points="4139,-10956 3988,-10956 3988,-10920 4139,-10920 4139,-10956"/>
<text text-anchor="middle" x="4063.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_2</text>
</g>
<!-- layer0_mha_qkv_2&#45;&gt;layer0_mha_attn_2 -->
<g id="edge24" class="edge">
<title>layer0_mha_qkv_2&#45;&gt;layer0_mha_attn_2</title>
<path fill="none" stroke="black" d="M4143.12,-11083.4C4123.24,-11047.35 4094.79,-10995.75 4077.83,-10964.98"/>
<polygon fill="black" stroke="black" points="4080.85,-10963.21 4072.95,-10956.15 4074.72,-10966.59 4080.85,-10963.21"/>
</g>
<!-- layer0_mha_attn_3 -->
<g id="node62" class="node">
<title>layer0_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4815,-10956 4664,-10956 4664,-10920 4815,-10920 4815,-10956"/>
<text text-anchor="middle" x="4739.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_3</text>
</g>
<!-- layer0_mha_qkv_3&#45;&gt;layer0_mha_attn_3 -->
<g id="edge35" class="edge">
<title>layer0_mha_qkv_3&#45;&gt;layer0_mha_attn_3</title>
<path fill="none" stroke="black" d="M4739.5,-11083.4C4739.5,-11047.82 4739.5,-10997.08 4739.5,-10966.19"/>
<polygon fill="black" stroke="black" points="4743,-10966.15 4739.5,-10956.15 4736,-10966.15 4743,-10966.15"/>
</g>
<!-- layer0_mha_attn_4 -->
<g id="node67" class="node">
<title>layer0_mha_attn_4</title>
<polygon fill="none" stroke="black" points="5389,-10956 5238,-10956 5238,-10920 5389,-10920 5389,-10956"/>
<text text-anchor="middle" x="5313.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_4</text>
</g>
<!-- layer0_mha_qkv_4&#45;&gt;layer0_mha_attn_4 -->
<g id="edge46" class="edge">
<title>layer0_mha_qkv_4&#45;&gt;layer0_mha_attn_4</title>
<path fill="none" stroke="black" d="M5313.5,-11083.4C5313.5,-11047.82 5313.5,-10997.08 5313.5,-10966.19"/>
<polygon fill="black" stroke="black" points="5317,-10966.15 5313.5,-10956.15 5310,-10966.15 5317,-10966.15"/>
</g>
<!-- layer0_mha_attn_5 -->
<g id="node72" class="node">
<title>layer0_mha_attn_5</title>
<polygon fill="none" stroke="black" points="6017,-10956 5866,-10956 5866,-10920 6017,-10920 6017,-10956"/>
<text text-anchor="middle" x="5941.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_5</text>
</g>
<!-- layer0_mha_qkv_5&#45;&gt;layer0_mha_attn_5 -->
<g id="edge57" class="edge">
<title>layer0_mha_qkv_5&#45;&gt;layer0_mha_attn_5</title>
<path fill="none" stroke="black" d="M5920.43,-11083.4C5925.62,-11047.82 5933.02,-10997.08 5937.53,-10966.19"/>
<polygon fill="black" stroke="black" points="5941.02,-10966.55 5939,-10956.15 5934.09,-10965.54 5941.02,-10966.55"/>
</g>
<!-- layer0_mha_attn_6 -->
<g id="node77" class="node">
<title>layer0_mha_attn_6</title>
<polygon fill="none" stroke="black" points="6895,-10956 6744,-10956 6744,-10920 6895,-10920 6895,-10956"/>
<text text-anchor="middle" x="6819.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer0_mha_attn_6</text>
</g>
<!-- layer0_mha_qkv_6&#45;&gt;layer0_mha_attn_6 -->
<g id="edge68" class="edge">
<title>layer0_mha_qkv_6&#45;&gt;layer0_mha_attn_6</title>
<path fill="none" stroke="black" d="M6697.73,-11083.4C6728.53,-11046.88 6772.77,-10994.41 6798.59,-10963.8"/>
<polygon fill="black" stroke="black" points="6801.27,-10966.05 6805.04,-10956.15 6795.92,-10961.53 6801.27,-10966.05"/>
</g>
<!-- layer0_mha_attn_7 -->
<g id="node10" class="node">
<title>layer0_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="7912.31,-11021 7153.81,-11021 6958.69,-10855 7717.19,-10855 7912.31,-11021"/>
<text text-anchor="middle" x="7435.5" y="-10964.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7435.5" y="-10949.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="7435.5" y="-10934.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7435.5" y="-10919.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7435.5" y="-10904.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_mha_qkv_7&#45;&gt;layer0_mha_attn_7 -->
<g id="edge79" class="edge">
<title>layer0_mha_qkv_7&#45;&gt;layer0_mha_attn_7</title>
<path fill="none" stroke="black" d="M7349.64,-11083.4C7359.07,-11067.54 7370.3,-11048.66 7381.47,-11029.87"/>
<polygon fill="black" stroke="black" points="7384.49,-11031.64 7386.59,-11021.26 7378.47,-11028.07 7384.49,-11031.64"/>
</g>
<!-- layer0_mha_out_7 -->
<g id="node18" class="node">
<title>layer0_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="7811.5,-10819 7373.5,-10819 7373.5,-10736 7811.5,-10736 7811.5,-10819"/>
<text text-anchor="middle" x="7592.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7592.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="7592.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7592.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7592.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_mha_attn_7&#45;&gt;layer0_mha_out_7 -->
<g id="edge80" class="edge">
<title>layer0_mha_attn_7&#45;&gt;layer0_mha_out_7</title>
<path fill="none" stroke="black" d="M7516.76,-10854.96C7526.44,-10845.19 7536.07,-10835.47 7545.05,-10826.4"/>
<polygon fill="black" stroke="black" points="7547.55,-10828.85 7552.1,-10819.29 7542.58,-10823.93 7547.55,-10828.85"/>
</g>
<!-- layer0_mha_out_0 -->
<g id="node11" class="node">
<title>layer0_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="2609.5,-10819 2171.5,-10819 2171.5,-10736 2609.5,-10736 2609.5,-10819"/>
<text text-anchor="middle" x="2390.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="2390.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="2390.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2390.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2390.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_res1_0 -->
<g id="node48" class="node">
<title>layer0_res1_0</title>
<polygon fill="none" stroke="black" points="1980.5,-10635 1864.5,-10635 1864.5,-10599 1980.5,-10599 1980.5,-10635"/>
<text text-anchor="middle" x="1922.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_0</text>
</g>
<!-- layer0_mha_out_0&#45;&gt;layer0_res1_0 -->
<g id="edge4" class="edge">
<title>layer0_mha_out_0&#45;&gt;layer0_res1_0</title>
<path fill="none" stroke="black" d="M2270.89,-10735.99C2178.81,-10704.81 2055.39,-10663.01 1982.86,-10638.44"/>
<polygon fill="black" stroke="black" points="1983.56,-10634.99 1972.97,-10635.09 1981.32,-10641.62 1983.56,-10634.99"/>
</g>
<!-- layer0_mha_out_1 -->
<g id="node12" class="node">
<title>layer0_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="3268.5,-10819 2830.5,-10819 2830.5,-10736 3268.5,-10736 3268.5,-10819"/>
<text text-anchor="middle" x="3049.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3049.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="3049.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3049.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3049.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_res1_1 -->
<g id="node53" class="node">
<title>layer0_res1_1</title>
<polygon fill="none" stroke="black" points="2933.5,-10635 2817.5,-10635 2817.5,-10599 2933.5,-10599 2933.5,-10635"/>
<text text-anchor="middle" x="2875.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_1</text>
</g>
<!-- layer0_mha_out_1&#45;&gt;layer0_res1_1 -->
<g id="edge15" class="edge">
<title>layer0_mha_out_1&#45;&gt;layer0_res1_1</title>
<path fill="none" stroke="black" d="M3004.69,-10735.68C2972.06,-10705.96 2928.99,-10666.73 2901.76,-10641.92"/>
<polygon fill="black" stroke="black" points="2903.94,-10639.17 2894.19,-10635.02 2899.22,-10644.34 2903.94,-10639.17"/>
</g>
<!-- layer0_mha_out_2 -->
<g id="node13" class="node">
<title>layer0_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="4231.5,-10819 3793.5,-10819 3793.5,-10736 4231.5,-10736 4231.5,-10819"/>
<text text-anchor="middle" x="4012.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4012.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="4012.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4012.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4012.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_res1_2 -->
<g id="node58" class="node">
<title>layer0_res1_2</title>
<polygon fill="none" stroke="black" points="4044.5,-10635 3928.5,-10635 3928.5,-10599 4044.5,-10599 4044.5,-10635"/>
<text text-anchor="middle" x="3986.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_2</text>
</g>
<!-- layer0_mha_out_2&#45;&gt;layer0_res1_2 -->
<g id="edge26" class="edge">
<title>layer0_mha_out_2&#45;&gt;layer0_res1_2</title>
<path fill="none" stroke="black" d="M4005.8,-10735.68C4001.14,-10707.24 3995.04,-10670.08 3990.96,-10645.2"/>
<polygon fill="black" stroke="black" points="3994.37,-10644.32 3989.29,-10635.02 3987.46,-10645.46 3994.37,-10644.32"/>
</g>
<!-- layer0_mha_out_3 -->
<g id="node14" class="node">
<title>layer0_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4958.5,-10819 4520.5,-10819 4520.5,-10736 4958.5,-10736 4958.5,-10819"/>
<text text-anchor="middle" x="4739.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4739.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4739.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4739.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4739.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_res1_3 -->
<g id="node63" class="node">
<title>layer0_res1_3</title>
<polygon fill="none" stroke="black" points="4797.5,-10635 4681.5,-10635 4681.5,-10599 4797.5,-10599 4797.5,-10635"/>
<text text-anchor="middle" x="4739.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_3</text>
</g>
<!-- layer0_mha_out_3&#45;&gt;layer0_res1_3 -->
<g id="edge37" class="edge">
<title>layer0_mha_out_3&#45;&gt;layer0_res1_3</title>
<path fill="none" stroke="black" d="M4739.5,-10735.68C4739.5,-10707.24 4739.5,-10670.08 4739.5,-10645.2"/>
<polygon fill="black" stroke="black" points="4743,-10645.02 4739.5,-10635.02 4736,-10645.02 4743,-10645.02"/>
</g>
<!-- layer0_mha_out_4 -->
<g id="node15" class="node">
<title>layer0_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="5532.5,-10819 5094.5,-10819 5094.5,-10736 5532.5,-10736 5532.5,-10819"/>
<text text-anchor="middle" x="5313.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="5313.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5313.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5313.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5313.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_res1_4 -->
<g id="node68" class="node">
<title>layer0_res1_4</title>
<polygon fill="none" stroke="black" points="5371.5,-10635 5255.5,-10635 5255.5,-10599 5371.5,-10599 5371.5,-10635"/>
<text text-anchor="middle" x="5313.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_4</text>
</g>
<!-- layer0_mha_out_4&#45;&gt;layer0_res1_4 -->
<g id="edge48" class="edge">
<title>layer0_mha_out_4&#45;&gt;layer0_res1_4</title>
<path fill="none" stroke="black" d="M5313.5,-10735.68C5313.5,-10707.24 5313.5,-10670.08 5313.5,-10645.2"/>
<polygon fill="black" stroke="black" points="5317,-10645.02 5313.5,-10635.02 5310,-10645.02 5317,-10645.02"/>
</g>
<!-- layer0_mha_out_5 -->
<g id="node16" class="node">
<title>layer0_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="6322.5,-10819 5884.5,-10819 5884.5,-10736 6322.5,-10736 6322.5,-10819"/>
<text text-anchor="middle" x="6103.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6103.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6103.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6103.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6103.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_res1_5 -->
<g id="node73" class="node">
<title>layer0_res1_5</title>
<polygon fill="none" stroke="black" points="6214.5,-10635 6098.5,-10635 6098.5,-10599 6214.5,-10599 6214.5,-10635"/>
<text text-anchor="middle" x="6156.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_5</text>
</g>
<!-- layer0_mha_out_5&#45;&gt;layer0_res1_5 -->
<g id="edge59" class="edge">
<title>layer0_mha_out_5&#45;&gt;layer0_res1_5</title>
<path fill="none" stroke="black" d="M6117.15,-10735.68C6126.75,-10706.98 6139.31,-10669.41 6147.63,-10644.53"/>
<polygon fill="black" stroke="black" points="6150.96,-10645.62 6150.81,-10635.02 6144.32,-10643.4 6150.96,-10645.62"/>
</g>
<!-- layer0_mha_out_6 -->
<g id="node17" class="node">
<title>layer0_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="7108.5,-10819 6670.5,-10819 6670.5,-10736 7108.5,-10736 7108.5,-10819"/>
<text text-anchor="middle" x="6889.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6889.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="6889.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6889.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6889.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_res1_6 -->
<g id="node78" class="node">
<title>layer0_res1_6</title>
<polygon fill="none" stroke="black" points="7057.5,-10635 6941.5,-10635 6941.5,-10599 7057.5,-10599 7057.5,-10635"/>
<text text-anchor="middle" x="6999.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer0_res1_6</text>
</g>
<!-- layer0_mha_out_6&#45;&gt;layer0_res1_6 -->
<g id="edge70" class="edge">
<title>layer0_mha_out_6&#45;&gt;layer0_res1_6</title>
<path fill="none" stroke="black" d="M6917.83,-10735.68C6938.01,-10706.6 6964.52,-10668.41 6981.77,-10643.54"/>
<polygon fill="black" stroke="black" points="6984.86,-10645.23 6987.69,-10635.02 6979.11,-10641.24 6984.86,-10645.23"/>
</g>
<!-- layer0_res1_7 -->
<g id="node19" class="node">
<title>layer0_res1_7</title>
<polygon fill="none" stroke="black" points="8189.24,-10700 7488.12,-10700 7307.76,-10534 8008.88,-10534 8189.24,-10700"/>
<text text-anchor="middle" x="7748.5" y="-10643.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7748.5" y="-10628.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7748.5" y="-10613.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7748.5" y="-10598.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7748.5" y="-10583.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_mha_out_7&#45;&gt;layer0_res1_7 -->
<g id="edge81" class="edge">
<title>layer0_mha_out_7&#45;&gt;layer0_res1_7</title>
<path fill="none" stroke="black" d="M7632.67,-10735.68C7641.32,-10726.9 7650.78,-10717.28 7660.45,-10707.46"/>
<polygon fill="black" stroke="black" points="7663,-10709.86 7667.52,-10700.27 7658.02,-10704.95 7663,-10709.86"/>
</g>
<!-- layer0_ln1_7 -->
<g id="node20" class="node">
<title>layer0_ln1_7</title>
<polygon fill="yellow" stroke="black" points="8414,-10498 7989,-10498 7989,-10430 8414,-10430 8414,-10498"/>
<text text-anchor="middle" x="8201.5" y="-10482.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="8201.5" y="-10467.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8201.5" y="-10452.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8201.5" y="-10437.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_res1_7&#45;&gt;layer0_ln1_7 -->
<g id="edge82" class="edge">
<title>layer0_res1_7&#45;&gt;layer0_ln1_7</title>
<path fill="none" stroke="black" d="M7994.55,-10533.98C8028.95,-10522.52 8062.75,-10511.25 8092.73,-10501.26"/>
<polygon fill="black" stroke="black" points="8093.95,-10504.54 8102.33,-10498.06 8091.73,-10497.9 8093.95,-10504.54"/>
</g>
<!-- layer0_ffn_gate_7 -->
<g id="node28" class="node">
<title>layer0_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="8438,-10394 7965,-10394 7965,-10311 8438,-10311 8438,-10394"/>
<text text-anchor="middle" x="8201.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8201.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8201.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8201.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8201.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_ln1_7&#45;&gt;layer0_ffn_gate_7 -->
<g id="edge83" class="edge">
<title>layer0_ln1_7&#45;&gt;layer0_ffn_gate_7</title>
<path fill="none" stroke="black" d="M8201.5,-10429.85C8201.5,-10421.8 8201.5,-10413 8201.5,-10404.34"/>
<polygon fill="black" stroke="black" points="8205,-10404.28 8201.5,-10394.28 8198,-10404.28 8205,-10404.28"/>
</g>
<!-- layer0_ffn_up_7 -->
<g id="node36" class="node">
<title>layer0_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="8929,-10394 8456,-10394 8456,-10311 8929,-10311 8929,-10394"/>
<text text-anchor="middle" x="8692.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8692.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8692.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8692.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8692.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_ln1_7&#45;&gt;layer0_ffn_up_7 -->
<g id="edge84" class="edge">
<title>layer0_ln1_7&#45;&gt;layer0_ffn_up_7</title>
<path fill="none" stroke="black" d="M8349.48,-10430C8397,-10419.4 8450.34,-10407.51 8500.53,-10396.31"/>
<polygon fill="black" stroke="black" points="8501.53,-10399.67 8510.53,-10394.08 8500.01,-10392.84 8501.53,-10399.67"/>
</g>
<!-- layer0_ffn_gate_0 -->
<g id="node21" class="node">
<title>layer0_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="1564,-10394 1091,-10394 1091,-10311 1564,-10311 1564,-10394"/>
<text text-anchor="middle" x="1327.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1327.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1327.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1327.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1327.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_ffn_act_0 -->
<g id="node50" class="node">
<title>layer0_ffn_act_0</title>
<polygon fill="none" stroke="black" points="1432,-10210 1301,-10210 1301,-10174 1432,-10174 1432,-10210"/>
<text text-anchor="middle" x="1366.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_0</text>
</g>
<!-- layer0_ffn_gate_0&#45;&gt;layer0_ffn_act_0 -->
<g id="edge8" class="edge">
<title>layer0_ffn_gate_0&#45;&gt;layer0_ffn_act_0</title>
<path fill="none" stroke="black" d="M1337.54,-10310.68C1344.57,-10282.11 1353.77,-10244.74 1359.89,-10219.86"/>
<polygon fill="black" stroke="black" points="1363.32,-10220.57 1362.31,-10210.02 1356.52,-10218.9 1363.32,-10220.57"/>
</g>
<!-- layer0_ffn_gate_1 -->
<g id="node22" class="node">
<title>layer0_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="2546,-10394 2073,-10394 2073,-10311 2546,-10311 2546,-10394"/>
<text text-anchor="middle" x="2309.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2309.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2309.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2309.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2309.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_ffn_act_1 -->
<g id="node55" class="node">
<title>layer0_ffn_act_1</title>
<polygon fill="none" stroke="black" points="2426,-10210 2295,-10210 2295,-10174 2426,-10174 2426,-10210"/>
<text text-anchor="middle" x="2360.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_1</text>
</g>
<!-- layer0_ffn_gate_1&#45;&gt;layer0_ffn_act_1 -->
<g id="edge19" class="edge">
<title>layer0_ffn_gate_1&#45;&gt;layer0_ffn_act_1</title>
<path fill="none" stroke="black" d="M2322.63,-10310.68C2331.83,-10282.11 2343.85,-10244.74 2351.86,-10219.86"/>
<polygon fill="black" stroke="black" points="2355.29,-10220.61 2355.02,-10210.02 2348.63,-10218.47 2355.29,-10220.61"/>
</g>
<!-- layer0_ffn_gate_2 -->
<g id="node23" class="node">
<title>layer0_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3528,-10394 3055,-10394 3055,-10311 3528,-10311 3528,-10394"/>
<text text-anchor="middle" x="3291.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3291.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3291.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3291.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3291.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_ffn_act_2 -->
<g id="node60" class="node">
<title>layer0_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3529,-10210 3398,-10210 3398,-10174 3529,-10174 3529,-10210"/>
<text text-anchor="middle" x="3463.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_2</text>
</g>
<!-- layer0_ffn_gate_2&#45;&gt;layer0_ffn_act_2 -->
<g id="edge30" class="edge">
<title>layer0_ffn_gate_2&#45;&gt;layer0_ffn_act_2</title>
<path fill="none" stroke="black" d="M3335.79,-10310.68C3368.05,-10280.96 3410.62,-10241.73 3437.54,-10216.92"/>
<polygon fill="black" stroke="black" points="3440.04,-10219.37 3445.03,-10210.02 3435.3,-10214.23 3440.04,-10219.37"/>
</g>
<!-- layer0_ffn_gate_3 -->
<g id="node24" class="node">
<title>layer0_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4510,-10394 4037,-10394 4037,-10311 4510,-10311 4510,-10394"/>
<text text-anchor="middle" x="4273.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4273.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4273.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4273.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4273.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_ffn_act_3 -->
<g id="node65" class="node">
<title>layer0_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4769,-10210 4638,-10210 4638,-10174 4769,-10174 4769,-10210"/>
<text text-anchor="middle" x="4703.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_3</text>
</g>
<!-- layer0_ffn_gate_3&#45;&gt;layer0_ffn_act_3 -->
<g id="edge41" class="edge">
<title>layer0_ffn_gate_3&#45;&gt;layer0_ffn_act_3</title>
<path fill="none" stroke="black" d="M4383.4,-10310.99C4467.83,-10279.87 4580.94,-10238.18 4647.64,-10213.59"/>
<polygon fill="black" stroke="black" points="4648.96,-10216.83 4657.13,-10210.09 4646.54,-10210.27 4648.96,-10216.83"/>
</g>
<!-- layer0_ffn_gate_4 -->
<g id="node25" class="node">
<title>layer0_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5492,-10394 5019,-10394 5019,-10311 5492,-10311 5492,-10394"/>
<text text-anchor="middle" x="5255.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5255.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5255.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5255.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5255.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_ffn_act_4 -->
<g id="node70" class="node">
<title>layer0_ffn_act_4</title>
<polygon fill="none" stroke="black" points="5353,-10210 5222,-10210 5222,-10174 5353,-10174 5353,-10210"/>
<text text-anchor="middle" x="5287.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_4</text>
</g>
<!-- layer0_ffn_gate_4&#45;&gt;layer0_ffn_act_4 -->
<g id="edge52" class="edge">
<title>layer0_ffn_gate_4&#45;&gt;layer0_ffn_act_4</title>
<path fill="none" stroke="black" d="M5263.74,-10310.68C5269.51,-10282.11 5277.05,-10244.74 5282.08,-10219.86"/>
<polygon fill="black" stroke="black" points="5285.51,-10220.52 5284.06,-10210.02 5278.65,-10219.13 5285.51,-10220.52"/>
</g>
<!-- layer0_ffn_gate_5 -->
<g id="node26" class="node">
<title>layer0_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6474,-10394 6001,-10394 6001,-10311 6474,-10311 6474,-10394"/>
<text text-anchor="middle" x="6237.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6237.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6237.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6237.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6237.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_ffn_act_5 -->
<g id="node75" class="node">
<title>layer0_ffn_act_5</title>
<polygon fill="none" stroke="black" points="6724,-10210 6593,-10210 6593,-10174 6724,-10174 6724,-10210"/>
<text text-anchor="middle" x="6658.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_5</text>
</g>
<!-- layer0_ffn_gate_5&#45;&gt;layer0_ffn_act_5 -->
<g id="edge63" class="edge">
<title>layer0_ffn_gate_5&#45;&gt;layer0_ffn_act_5</title>
<path fill="none" stroke="black" d="M6345.1,-10310.99C6427.59,-10279.93 6538.05,-10238.35 6603.4,-10213.74"/>
<polygon fill="black" stroke="black" points="6604.97,-10216.89 6613.1,-10210.09 6602.51,-10210.34 6604.97,-10216.89"/>
</g>
<!-- layer0_ffn_gate_6 -->
<g id="node27" class="node">
<title>layer0_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="7456,-10394 6983,-10394 6983,-10311 7456,-10311 7456,-10394"/>
<text text-anchor="middle" x="7219.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7219.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7219.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7219.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7219.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_ffn_act_6 -->
<g id="node80" class="node">
<title>layer0_ffn_act_6</title>
<polygon fill="none" stroke="black" points="7502,-10210 7371,-10210 7371,-10174 7502,-10174 7502,-10210"/>
<text text-anchor="middle" x="7436.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer0_ffn_act_6</text>
</g>
<!-- layer0_ffn_gate_6&#45;&gt;layer0_ffn_act_6 -->
<g id="edge74" class="edge">
<title>layer0_ffn_gate_6&#45;&gt;layer0_ffn_act_6</title>
<path fill="none" stroke="black" d="M7275.1,-10310.89C7316.31,-10280.79 7371.01,-10240.84 7404.96,-10216.03"/>
<polygon fill="black" stroke="black" points="7407.12,-10218.79 7413.13,-10210.07 7402.99,-10213.14 7407.12,-10218.79"/>
</g>
<!-- layer0_ffn_act_7 -->
<g id="node37" class="node">
<title>layer0_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9152.24,-10275 8395.44,-10275 8200.76,-10109 8957.56,-10109 9152.24,-10275"/>
<text text-anchor="middle" x="8676.5" y="-10218.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="8676.5" y="-10203.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="8676.5" y="-10188.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8676.5" y="-10173.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8676.5" y="-10158.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_ffn_gate_7&#45;&gt;layer0_ffn_act_7 -->
<g id="edge85" class="edge">
<title>layer0_ffn_gate_7&#45;&gt;layer0_ffn_act_7</title>
<path fill="none" stroke="black" d="M8322.9,-10310.99C8353.17,-10300.89 8386.79,-10289.67 8420.9,-10278.29"/>
<polygon fill="black" stroke="black" points="8422.16,-10281.56 8430.54,-10275.07 8419.94,-10274.92 8422.16,-10281.56"/>
</g>
<!-- layer0_ffn_up_0 -->
<g id="node29" class="node">
<title>layer0_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="2055,-10394 1582,-10394 1582,-10311 2055,-10311 2055,-10394"/>
<text text-anchor="middle" x="1818.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1818.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1818.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1818.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1818.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_ffn_up_0&#45;&gt;layer0_ffn_act_0 -->
<g id="edge9" class="edge">
<title>layer0_ffn_up_0&#45;&gt;layer0_ffn_act_0</title>
<path fill="none" stroke="black" d="M1702.98,-10310.99C1614.05,-10279.81 1494.84,-10238.01 1424.79,-10213.44"/>
<polygon fill="black" stroke="black" points="1425.84,-10210.1 1415.24,-10210.09 1423.52,-10216.7 1425.84,-10210.1"/>
</g>
<!-- layer0_ffn_up_1 -->
<g id="node30" class="node">
<title>layer0_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="3037,-10394 2564,-10394 2564,-10311 3037,-10311 3037,-10394"/>
<text text-anchor="middle" x="2800.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2800.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2800.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2800.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2800.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_ffn_up_1&#45;&gt;layer0_ffn_act_1 -->
<g id="edge20" class="edge">
<title>layer0_ffn_up_1&#45;&gt;layer0_ffn_act_1</title>
<path fill="none" stroke="black" d="M2688.05,-10310.99C2601.65,-10279.87 2485.91,-10238.18 2417.66,-10213.59"/>
<polygon fill="black" stroke="black" points="2418.54,-10210.19 2407.95,-10210.09 2416.17,-10216.77 2418.54,-10210.19"/>
</g>
<!-- layer0_ffn_up_2 -->
<g id="node31" class="node">
<title>layer0_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="4019,-10394 3546,-10394 3546,-10311 4019,-10311 4019,-10394"/>
<text text-anchor="middle" x="3782.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3782.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3782.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3782.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3782.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_ffn_up_2&#45;&gt;layer0_ffn_act_2 -->
<g id="edge31" class="edge">
<title>layer0_ffn_up_2&#45;&gt;layer0_ffn_act_2</title>
<path fill="none" stroke="black" d="M3700.76,-10310.89C3639.03,-10280.21 3556.71,-10239.31 3507.04,-10214.63"/>
<polygon fill="black" stroke="black" points="3508.37,-10211.38 3497.85,-10210.07 3505.25,-10217.65 3508.37,-10211.38"/>
</g>
<!-- layer0_ffn_up_3 -->
<g id="node32" class="node">
<title>layer0_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="5001,-10394 4528,-10394 4528,-10311 5001,-10311 5001,-10394"/>
<text text-anchor="middle" x="4764.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4764.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4764.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4764.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4764.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_ffn_up_3&#45;&gt;layer0_ffn_act_3 -->
<g id="edge42" class="edge">
<title>layer0_ffn_up_3&#45;&gt;layer0_ffn_act_3</title>
<path fill="none" stroke="black" d="M4748.79,-10310.68C4737.75,-10281.98 4723.29,-10244.41 4713.71,-10219.53"/>
<polygon fill="black" stroke="black" points="4716.91,-10218.1 4710.05,-10210.02 4710.38,-10220.61 4716.91,-10218.1"/>
</g>
<!-- layer0_ffn_up_4 -->
<g id="node33" class="node">
<title>layer0_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="5983,-10394 5510,-10394 5510,-10311 5983,-10311 5983,-10394"/>
<text text-anchor="middle" x="5746.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5746.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5746.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5746.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5746.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_ffn_up_4&#45;&gt;layer0_ffn_act_4 -->
<g id="edge53" class="edge">
<title>layer0_ffn_up_4&#45;&gt;layer0_ffn_act_4</title>
<path fill="none" stroke="black" d="M5629.19,-10310.99C5538.88,-10279.81 5417.83,-10238.01 5346.7,-10213.44"/>
<polygon fill="black" stroke="black" points="5347.59,-10210.05 5337,-10210.09 5345.31,-10216.66 5347.59,-10210.05"/>
</g>
<!-- layer0_ffn_up_5 -->
<g id="node34" class="node">
<title>layer0_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="6965,-10394 6492,-10394 6492,-10311 6965,-10311 6965,-10394"/>
<text text-anchor="middle" x="6728.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6728.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6728.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6728.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6728.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_ffn_up_5&#45;&gt;layer0_ffn_act_5 -->
<g id="edge64" class="edge">
<title>layer0_ffn_up_5&#45;&gt;layer0_ffn_act_5</title>
<path fill="none" stroke="black" d="M6710.47,-10310.68C6697.74,-10281.86 6681.06,-10244.08 6670.07,-10219.2"/>
<polygon fill="black" stroke="black" points="6673.26,-10217.76 6666.02,-10210.02 6666.86,-10220.59 6673.26,-10217.76"/>
</g>
<!-- layer0_ffn_up_6 -->
<g id="node35" class="node">
<title>layer0_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="7947,-10394 7474,-10394 7474,-10311 7947,-10311 7947,-10394"/>
<text text-anchor="middle" x="7710.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7710.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7710.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7710.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7710.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_ffn_up_6&#45;&gt;layer0_ffn_act_6 -->
<g id="edge75" class="edge">
<title>layer0_ffn_up_6&#45;&gt;layer0_ffn_act_6</title>
<path fill="none" stroke="black" d="M7640.29,-10310.89C7587.6,-10280.4 7517.44,-10239.82 7474.7,-10215.1"/>
<polygon fill="black" stroke="black" points="7476.42,-10212.05 7466.01,-10210.07 7472.91,-10218.11 7476.42,-10212.05"/>
</g>
<!-- layer0_ffn_up_7&#45;&gt;layer0_ffn_act_7 -->
<g id="edge86" class="edge">
<title>layer0_ffn_up_7&#45;&gt;layer0_ffn_act_7</title>
<path fill="none" stroke="black" d="M8688.38,-10310.68C8687.58,-10302.75 8686.71,-10294.14 8685.82,-10285.31"/>
<polygon fill="black" stroke="black" points="8689.29,-10284.87 8684.81,-10275.27 8682.33,-10285.57 8689.29,-10284.87"/>
</g>
<!-- layer0_ffn_down_7 -->
<g id="node45" class="node">
<title>layer0_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="8900,-10073 8453,-10073 8453,-9990 8900,-9990 8900,-10073"/>
<text text-anchor="middle" x="8676.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8676.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8676.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8676.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8676.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_ffn_act_7&#45;&gt;layer0_ffn_down_7 -->
<g id="edge87" class="edge">
<title>layer0_ffn_act_7&#45;&gt;layer0_ffn_down_7</title>
<path fill="none" stroke="black" d="M8676.5,-10108.96C8676.5,-10100.25 8676.5,-10091.59 8676.5,-10083.39"/>
<polygon fill="black" stroke="black" points="8680,-10083.29 8676.5,-10073.29 8673,-10083.29 8680,-10083.29"/>
</g>
<!-- layer0_ffn_down_0 -->
<g id="node38" class="node">
<title>layer0_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="1590,-10073 1143,-10073 1143,-9990 1590,-9990 1590,-10073"/>
<text text-anchor="middle" x="1366.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1366.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1366.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1366.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1366.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_res2_0 -->
<g id="node51" class="node">
<title>layer0_res2_0</title>
<polygon fill="none" stroke="black" points="1424.5,-9889 1308.5,-9889 1308.5,-9853 1424.5,-9853 1424.5,-9889"/>
<text text-anchor="middle" x="1366.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_0</text>
</g>
<!-- layer0_ffn_down_0&#45;&gt;layer0_res2_0 -->
<g id="edge11" class="edge">
<title>layer0_ffn_down_0&#45;&gt;layer0_res2_0</title>
<path fill="none" stroke="black" d="M1366.5,-9989.68C1366.5,-9961.24 1366.5,-9924.08 1366.5,-9899.2"/>
<polygon fill="black" stroke="black" points="1370,-9899.02 1366.5,-9889.02 1363,-9899.02 1370,-9899.02"/>
</g>
<!-- layer0_ffn_down_1 -->
<g id="node39" class="node">
<title>layer0_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="2584,-10073 2137,-10073 2137,-9990 2584,-9990 2584,-10073"/>
<text text-anchor="middle" x="2360.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2360.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2360.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2360.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2360.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_res2_1 -->
<g id="node56" class="node">
<title>layer0_res2_1</title>
<polygon fill="none" stroke="black" points="2418.5,-9889 2302.5,-9889 2302.5,-9853 2418.5,-9853 2418.5,-9889"/>
<text text-anchor="middle" x="2360.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_1</text>
</g>
<!-- layer0_ffn_down_1&#45;&gt;layer0_res2_1 -->
<g id="edge22" class="edge">
<title>layer0_ffn_down_1&#45;&gt;layer0_res2_1</title>
<path fill="none" stroke="black" d="M2360.5,-9989.68C2360.5,-9961.24 2360.5,-9924.08 2360.5,-9899.2"/>
<polygon fill="black" stroke="black" points="2364,-9899.02 2360.5,-9889.02 2357,-9899.02 2364,-9899.02"/>
</g>
<!-- layer0_ffn_down_2 -->
<g id="node40" class="node">
<title>layer0_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3687,-10073 3240,-10073 3240,-9990 3687,-9990 3687,-10073"/>
<text text-anchor="middle" x="3463.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3463.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3463.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3463.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3463.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_res2_2 -->
<g id="node61" class="node">
<title>layer0_res2_2</title>
<polygon fill="none" stroke="black" points="3521.5,-9889 3405.5,-9889 3405.5,-9853 3521.5,-9853 3521.5,-9889"/>
<text text-anchor="middle" x="3463.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_2</text>
</g>
<!-- layer0_ffn_down_2&#45;&gt;layer0_res2_2 -->
<g id="edge33" class="edge">
<title>layer0_ffn_down_2&#45;&gt;layer0_res2_2</title>
<path fill="none" stroke="black" d="M3463.5,-9989.68C3463.5,-9961.24 3463.5,-9924.08 3463.5,-9899.2"/>
<polygon fill="black" stroke="black" points="3467,-9899.02 3463.5,-9889.02 3460,-9899.02 3467,-9899.02"/>
</g>
<!-- layer0_ffn_down_3 -->
<g id="node41" class="node">
<title>layer0_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4927,-10073 4480,-10073 4480,-9990 4927,-9990 4927,-10073"/>
<text text-anchor="middle" x="4703.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4703.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4703.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4703.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4703.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_res2_3 -->
<g id="node66" class="node">
<title>layer0_res2_3</title>
<polygon fill="none" stroke="black" points="4761.5,-9889 4645.5,-9889 4645.5,-9853 4761.5,-9853 4761.5,-9889"/>
<text text-anchor="middle" x="4703.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_3</text>
</g>
<!-- layer0_ffn_down_3&#45;&gt;layer0_res2_3 -->
<g id="edge44" class="edge">
<title>layer0_ffn_down_3&#45;&gt;layer0_res2_3</title>
<path fill="none" stroke="black" d="M4703.5,-9989.68C4703.5,-9961.24 4703.5,-9924.08 4703.5,-9899.2"/>
<polygon fill="black" stroke="black" points="4707,-9899.02 4703.5,-9889.02 4700,-9899.02 4707,-9899.02"/>
</g>
<!-- layer0_ffn_down_4 -->
<g id="node42" class="node">
<title>layer0_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="5511,-10073 5064,-10073 5064,-9990 5511,-9990 5511,-10073"/>
<text text-anchor="middle" x="5287.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5287.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5287.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5287.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5287.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_res2_4 -->
<g id="node71" class="node">
<title>layer0_res2_4</title>
<polygon fill="none" stroke="black" points="5345.5,-9889 5229.5,-9889 5229.5,-9853 5345.5,-9853 5345.5,-9889"/>
<text text-anchor="middle" x="5287.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_4</text>
</g>
<!-- layer0_ffn_down_4&#45;&gt;layer0_res2_4 -->
<g id="edge55" class="edge">
<title>layer0_ffn_down_4&#45;&gt;layer0_res2_4</title>
<path fill="none" stroke="black" d="M5287.5,-9989.68C5287.5,-9961.24 5287.5,-9924.08 5287.5,-9899.2"/>
<polygon fill="black" stroke="black" points="5291,-9899.02 5287.5,-9889.02 5284,-9899.02 5291,-9899.02"/>
</g>
<!-- layer0_ffn_down_5 -->
<g id="node43" class="node">
<title>layer0_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="6882,-10073 6435,-10073 6435,-9990 6882,-9990 6882,-10073"/>
<text text-anchor="middle" x="6658.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6658.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6658.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6658.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6658.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_res2_5 -->
<g id="node76" class="node">
<title>layer0_res2_5</title>
<polygon fill="none" stroke="black" points="6716.5,-9889 6600.5,-9889 6600.5,-9853 6716.5,-9853 6716.5,-9889"/>
<text text-anchor="middle" x="6658.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_5</text>
</g>
<!-- layer0_ffn_down_5&#45;&gt;layer0_res2_5 -->
<g id="edge66" class="edge">
<title>layer0_ffn_down_5&#45;&gt;layer0_res2_5</title>
<path fill="none" stroke="black" d="M6658.5,-9989.68C6658.5,-9961.24 6658.5,-9924.08 6658.5,-9899.2"/>
<polygon fill="black" stroke="black" points="6662,-9899.02 6658.5,-9889.02 6655,-9899.02 6662,-9899.02"/>
</g>
<!-- layer0_ffn_down_6 -->
<g id="node44" class="node">
<title>layer0_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="7660,-10073 7213,-10073 7213,-9990 7660,-9990 7660,-10073"/>
<text text-anchor="middle" x="7436.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7436.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7436.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7436.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7436.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_res2_6 -->
<g id="node81" class="node">
<title>layer0_res2_6</title>
<polygon fill="none" stroke="black" points="7494.5,-9889 7378.5,-9889 7378.5,-9853 7494.5,-9853 7494.5,-9889"/>
<text text-anchor="middle" x="7436.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer0_res2_6</text>
</g>
<!-- layer0_ffn_down_6&#45;&gt;layer0_res2_6 -->
<g id="edge77" class="edge">
<title>layer0_ffn_down_6&#45;&gt;layer0_res2_6</title>
<path fill="none" stroke="black" d="M7436.5,-9989.68C7436.5,-9961.24 7436.5,-9924.08 7436.5,-9899.2"/>
<polygon fill="black" stroke="black" points="7440,-9899.02 7436.5,-9889.02 7433,-9899.02 7440,-9899.02"/>
</g>
<!-- layer0_res2_7 -->
<g id="node46" class="node">
<title>layer0_res2_7</title>
<polygon fill="none" stroke="black" points="9117.24,-9954 8416.12,-9954 8235.76,-9788 8936.88,-9788 9117.24,-9954"/>
<text text-anchor="middle" x="8676.5" y="-9897.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8676.5" y="-9882.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9867.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9852.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9837.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_ffn_down_7&#45;&gt;layer0_res2_7 -->
<g id="edge88" class="edge">
<title>layer0_ffn_down_7&#45;&gt;layer0_res2_7</title>
<path fill="none" stroke="black" d="M8676.5,-9989.68C8676.5,-9981.75 8676.5,-9973.14 8676.5,-9964.31"/>
<polygon fill="black" stroke="black" points="8680,-9964.27 8676.5,-9954.27 8673,-9964.27 8680,-9964.27"/>
</g>
<!-- layer1_mha_qkv_7 -->
<g id="node89" class="node">
<title>layer1_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="8954.5,-9752 8398.5,-9752 8398.5,-9669 8954.5,-9669 8954.5,-9752"/>
<text text-anchor="middle" x="8676.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8676.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8676.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8676.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_res2_7&#45;&gt;layer1_mha_qkv_7 -->
<g id="edge166" class="edge">
<title>layer0_res2_7&#45;&gt;layer1_mha_qkv_7</title>
<path fill="none" stroke="black" d="M8676.5,-9787.96C8676.5,-9779.25 8676.5,-9770.59 8676.5,-9762.39"/>
<polygon fill="black" stroke="black" points="8680,-9762.29 8676.5,-9752.29 8673,-9762.29 8680,-9762.29"/>
</g>
<!-- layer0_mha_attn_0&#45;&gt;layer0_mha_out_0 -->
<g id="edge3" class="edge">
<title>layer0_mha_attn_0&#45;&gt;layer0_mha_out_0</title>
<path fill="none" stroke="black" d="M2766.94,-10919.89C2705.52,-10896.82 2593.97,-10854.92 2508.19,-10822.7"/>
<polygon fill="black" stroke="black" points="2509.25,-10819.36 2498.66,-10819.12 2506.79,-10825.92 2509.25,-10819.36"/>
</g>
<!-- layer0_ln1_0 -->
<g id="node49" class="node">
<title>layer0_ln1_0</title>
<polygon fill="none" stroke="black" points="1872,-10482 1765,-10482 1765,-10446 1872,-10446 1872,-10482"/>
<text text-anchor="middle" x="1818.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_0</text>
</g>
<!-- layer0_res1_0&#45;&gt;layer0_ln1_0 -->
<g id="edge5" class="edge">
<title>layer0_res1_0&#45;&gt;layer0_ln1_0</title>
<path fill="none" stroke="black" d="M1910.77,-10598.97C1892.59,-10572.58 1857.49,-10521.61 1836.21,-10490.72"/>
<polygon fill="black" stroke="black" points="1838.9,-10488.45 1830.34,-10482.2 1833.13,-10492.42 1838.9,-10488.45"/>
</g>
<!-- layer0_ln1_0&#45;&gt;layer0_ffn_gate_0 -->
<g id="edge6" class="edge">
<title>layer0_ln1_0&#45;&gt;layer0_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1764.55,-10450.97C1705.48,-10437.8 1607.39,-10415.92 1519.09,-10396.23"/>
<polygon fill="black" stroke="black" points="1519.72,-10392.78 1509.2,-10394.02 1518.2,-10399.61 1519.72,-10392.78"/>
</g>
<!-- layer0_ln1_0&#45;&gt;layer0_ffn_up_0 -->
<g id="edge7" class="edge">
<title>layer0_ln1_0&#45;&gt;layer0_ffn_up_0</title>
<path fill="none" stroke="black" d="M1818.5,-10445.89C1818.5,-10434.65 1818.5,-10419.31 1818.5,-10404.35"/>
<polygon fill="black" stroke="black" points="1822,-10404.12 1818.5,-10394.12 1815,-10404.12 1822,-10404.12"/>
</g>
<!-- layer0_ffn_act_0&#45;&gt;layer0_ffn_down_0 -->
<g id="edge10" class="edge">
<title>layer0_ffn_act_0&#45;&gt;layer0_ffn_down_0</title>
<path fill="none" stroke="black" d="M1366.5,-10173.74C1366.5,-10152.18 1366.5,-10114.37 1366.5,-10083.29"/>
<polygon fill="black" stroke="black" points="1370,-10083.04 1366.5,-10073.04 1363,-10083.04 1370,-10083.04"/>
</g>
<!-- layer1_mha_qkv_0 -->
<g id="node82" class="node">
<title>layer1_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="1644.5,-9752 1088.5,-9752 1088.5,-9669 1644.5,-9669 1644.5,-9752"/>
<text text-anchor="middle" x="1366.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="1366.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1366.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1366.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="1366.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_res2_0&#45;&gt;layer1_mha_qkv_0 -->
<g id="edge89" class="edge">
<title>layer0_res2_0&#45;&gt;layer1_mha_qkv_0</title>
<path fill="none" stroke="black" d="M1366.5,-9852.74C1366.5,-9831.18 1366.5,-9793.37 1366.5,-9762.29"/>
<polygon fill="black" stroke="black" points="1370,-9762.04 1366.5,-9752.04 1363,-9762.04 1370,-9762.04"/>
</g>
<!-- layer0_mha_attn_1&#45;&gt;layer0_mha_out_1 -->
<g id="edge14" class="edge">
<title>layer0_mha_attn_1&#45;&gt;layer0_mha_out_1</title>
<path fill="none" stroke="black" d="M3116.33,-10919.74C3106.04,-10898 3087.93,-10859.71 3073.15,-10828.48"/>
<polygon fill="black" stroke="black" points="3076.12,-10826.58 3068.68,-10819.04 3069.8,-10829.57 3076.12,-10826.58"/>
</g>
<!-- layer0_ln1_1 -->
<g id="node54" class="node">
<title>layer0_ln1_1</title>
<polygon fill="none" stroke="black" points="2854,-10482 2747,-10482 2747,-10446 2854,-10446 2854,-10482"/>
<text text-anchor="middle" x="2800.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_1</text>
</g>
<!-- layer0_res1_1&#45;&gt;layer0_ln1_1 -->
<g id="edge16" class="edge">
<title>layer0_res1_1&#45;&gt;layer0_ln1_1</title>
<path fill="none" stroke="black" d="M2867.04,-10598.97C2854.04,-10572.8 2829.05,-10522.49 2813.67,-10491.52"/>
<polygon fill="black" stroke="black" points="2816.62,-10489.6 2809.04,-10482.2 2810.36,-10492.71 2816.62,-10489.6"/>
</g>
<!-- layer0_ln1_1&#45;&gt;layer0_ffn_gate_1 -->
<g id="edge17" class="edge">
<title>layer0_ln1_1&#45;&gt;layer0_ffn_gate_1</title>
<path fill="none" stroke="black" d="M2746.55,-10450.97C2687.48,-10437.8 2589.39,-10415.92 2501.09,-10396.23"/>
<polygon fill="black" stroke="black" points="2501.72,-10392.78 2491.2,-10394.02 2500.2,-10399.61 2501.72,-10392.78"/>
</g>
<!-- layer0_ln1_1&#45;&gt;layer0_ffn_up_1 -->
<g id="edge18" class="edge">
<title>layer0_ln1_1&#45;&gt;layer0_ffn_up_1</title>
<path fill="none" stroke="black" d="M2800.5,-10445.89C2800.5,-10434.65 2800.5,-10419.31 2800.5,-10404.35"/>
<polygon fill="black" stroke="black" points="2804,-10404.12 2800.5,-10394.12 2797,-10404.12 2804,-10404.12"/>
</g>
<!-- layer0_ffn_act_1&#45;&gt;layer0_ffn_down_1 -->
<g id="edge21" class="edge">
<title>layer0_ffn_act_1&#45;&gt;layer0_ffn_down_1</title>
<path fill="none" stroke="black" d="M2360.5,-10173.74C2360.5,-10152.18 2360.5,-10114.37 2360.5,-10083.29"/>
<polygon fill="black" stroke="black" points="2364,-10083.04 2360.5,-10073.04 2357,-10083.04 2364,-10083.04"/>
</g>
<!-- layer1_mha_qkv_1 -->
<g id="node83" class="node">
<title>layer1_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2638.5,-9752 2082.5,-9752 2082.5,-9669 2638.5,-9669 2638.5,-9752"/>
<text text-anchor="middle" x="2360.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="2360.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2360.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2360.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="2360.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_res2_1&#45;&gt;layer1_mha_qkv_1 -->
<g id="edge100" class="edge">
<title>layer0_res2_1&#45;&gt;layer1_mha_qkv_1</title>
<path fill="none" stroke="black" d="M2360.5,-9852.74C2360.5,-9831.18 2360.5,-9793.37 2360.5,-9762.29"/>
<polygon fill="black" stroke="black" points="2364,-9762.04 2360.5,-9752.04 2357,-9762.04 2364,-9762.04"/>
</g>
<!-- layer0_mha_attn_2&#45;&gt;layer0_mha_out_2 -->
<g id="edge25" class="edge">
<title>layer0_mha_attn_2&#45;&gt;layer0_mha_out_2</title>
<path fill="none" stroke="black" d="M4057.95,-10919.74C4050.98,-10898.09 4038.74,-10860.04 4028.71,-10828.88"/>
<polygon fill="black" stroke="black" points="4031.94,-10827.48 4025.54,-10819.04 4025.27,-10829.63 4031.94,-10827.48"/>
</g>
<!-- layer0_ln1_2 -->
<g id="node59" class="node">
<title>layer0_ln1_2</title>
<polygon fill="none" stroke="black" points="3836,-10482 3729,-10482 3729,-10446 3836,-10446 3836,-10482"/>
<text text-anchor="middle" x="3782.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_2</text>
</g>
<!-- layer0_res1_2&#45;&gt;layer0_ln1_2 -->
<g id="edge27" class="edge">
<title>layer0_res1_2&#45;&gt;layer0_ln1_2</title>
<path fill="none" stroke="black" d="M3963.5,-10598.97C3926.84,-10571.84 3855.12,-10518.75 3813.82,-10488.18"/>
<polygon fill="black" stroke="black" points="3815.85,-10485.33 3805.73,-10482.2 3811.69,-10490.96 3815.85,-10485.33"/>
</g>
<!-- layer0_ln1_2&#45;&gt;layer0_ffn_gate_2 -->
<g id="edge28" class="edge">
<title>layer0_ln1_2&#45;&gt;layer0_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3728.55,-10450.97C3669.48,-10437.8 3571.39,-10415.92 3483.09,-10396.23"/>
<polygon fill="black" stroke="black" points="3483.72,-10392.78 3473.2,-10394.02 3482.2,-10399.61 3483.72,-10392.78"/>
</g>
<!-- layer0_ln1_2&#45;&gt;layer0_ffn_up_2 -->
<g id="edge29" class="edge">
<title>layer0_ln1_2&#45;&gt;layer0_ffn_up_2</title>
<path fill="none" stroke="black" d="M3782.5,-10445.89C3782.5,-10434.65 3782.5,-10419.31 3782.5,-10404.35"/>
<polygon fill="black" stroke="black" points="3786,-10404.12 3782.5,-10394.12 3779,-10404.12 3786,-10404.12"/>
</g>
<!-- layer0_ffn_act_2&#45;&gt;layer0_ffn_down_2 -->
<g id="edge32" class="edge">
<title>layer0_ffn_act_2&#45;&gt;layer0_ffn_down_2</title>
<path fill="none" stroke="black" d="M3463.5,-10173.74C3463.5,-10152.18 3463.5,-10114.37 3463.5,-10083.29"/>
<polygon fill="black" stroke="black" points="3467,-10083.04 3463.5,-10073.04 3460,-10083.04 3467,-10083.04"/>
</g>
<!-- layer1_mha_qkv_2 -->
<g id="node84" class="node">
<title>layer1_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3741.5,-9752 3185.5,-9752 3185.5,-9669 3741.5,-9669 3741.5,-9752"/>
<text text-anchor="middle" x="3463.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3463.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3463.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3463.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3463.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_res2_2&#45;&gt;layer1_mha_qkv_2 -->
<g id="edge111" class="edge">
<title>layer0_res2_2&#45;&gt;layer1_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3463.5,-9852.74C3463.5,-9831.18 3463.5,-9793.37 3463.5,-9762.29"/>
<polygon fill="black" stroke="black" points="3467,-9762.04 3463.5,-9752.04 3460,-9762.04 3467,-9762.04"/>
</g>
<!-- layer0_mha_attn_3&#45;&gt;layer0_mha_out_3 -->
<g id="edge36" class="edge">
<title>layer0_mha_attn_3&#45;&gt;layer0_mha_out_3</title>
<path fill="none" stroke="black" d="M4739.5,-10919.74C4739.5,-10898.18 4739.5,-10860.37 4739.5,-10829.29"/>
<polygon fill="black" stroke="black" points="4743,-10829.04 4739.5,-10819.04 4736,-10829.04 4743,-10829.04"/>
</g>
<!-- layer0_ln1_3 -->
<g id="node64" class="node">
<title>layer0_ln1_3</title>
<polygon fill="none" stroke="black" points="4793,-10482 4686,-10482 4686,-10446 4793,-10446 4793,-10482"/>
<text text-anchor="middle" x="4739.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_3</text>
</g>
<!-- layer0_res1_3&#45;&gt;layer0_ln1_3 -->
<g id="edge38" class="edge">
<title>layer0_res1_3&#45;&gt;layer0_ln1_3</title>
<path fill="none" stroke="black" d="M4739.5,-10598.97C4739.5,-10573.03 4739.5,-10523.36 4739.5,-10492.33"/>
<polygon fill="black" stroke="black" points="4743,-10492.2 4739.5,-10482.2 4736,-10492.2 4743,-10492.2"/>
</g>
<!-- layer0_ln1_3&#45;&gt;layer0_ffn_gate_3 -->
<g id="edge39" class="edge">
<title>layer0_ln1_3&#45;&gt;layer0_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4685.59,-10450.33C4629.36,-10437.12 4538.08,-10415.67 4455.71,-10396.32"/>
<polygon fill="black" stroke="black" points="4456.51,-10392.91 4445.97,-10394.03 4454.91,-10399.72 4456.51,-10392.91"/>
</g>
<!-- layer0_ln1_3&#45;&gt;layer0_ffn_up_3 -->
<g id="edge40" class="edge">
<title>layer0_ln1_3&#45;&gt;layer0_ffn_up_3</title>
<path fill="none" stroke="black" d="M4743.41,-10445.89C4746,-10434.54 4749.54,-10419.01 4752.99,-10403.92"/>
<polygon fill="black" stroke="black" points="4756.41,-10404.65 4755.23,-10394.12 4749.59,-10403.09 4756.41,-10404.65"/>
</g>
<!-- layer0_ffn_act_3&#45;&gt;layer0_ffn_down_3 -->
<g id="edge43" class="edge">
<title>layer0_ffn_act_3&#45;&gt;layer0_ffn_down_3</title>
<path fill="none" stroke="black" d="M4703.5,-10173.74C4703.5,-10152.18 4703.5,-10114.37 4703.5,-10083.29"/>
<polygon fill="black" stroke="black" points="4707,-10083.04 4703.5,-10073.04 4700,-10083.04 4707,-10083.04"/>
</g>
<!-- layer1_mha_qkv_3 -->
<g id="node85" class="node">
<title>layer1_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4981.5,-9752 4425.5,-9752 4425.5,-9669 4981.5,-9669 4981.5,-9752"/>
<text text-anchor="middle" x="4703.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4703.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4703.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4703.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4703.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_res2_3&#45;&gt;layer1_mha_qkv_3 -->
<g id="edge122" class="edge">
<title>layer0_res2_3&#45;&gt;layer1_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4703.5,-9852.74C4703.5,-9831.18 4703.5,-9793.37 4703.5,-9762.29"/>
<polygon fill="black" stroke="black" points="4707,-9762.04 4703.5,-9752.04 4700,-9762.04 4707,-9762.04"/>
</g>
<!-- layer0_mha_attn_4&#45;&gt;layer0_mha_out_4 -->
<g id="edge47" class="edge">
<title>layer0_mha_attn_4&#45;&gt;layer0_mha_out_4</title>
<path fill="none" stroke="black" d="M5313.5,-10919.74C5313.5,-10898.18 5313.5,-10860.37 5313.5,-10829.29"/>
<polygon fill="black" stroke="black" points="5317,-10829.04 5313.5,-10819.04 5310,-10829.04 5317,-10829.04"/>
</g>
<!-- layer0_ln1_4 -->
<g id="node69" class="node">
<title>layer0_ln1_4</title>
<polygon fill="none" stroke="black" points="5367,-10482 5260,-10482 5260,-10446 5367,-10446 5367,-10482"/>
<text text-anchor="middle" x="5313.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_4</text>
</g>
<!-- layer0_res1_4&#45;&gt;layer0_ln1_4 -->
<g id="edge49" class="edge">
<title>layer0_res1_4&#45;&gt;layer0_ln1_4</title>
<path fill="none" stroke="black" d="M5313.5,-10598.97C5313.5,-10573.03 5313.5,-10523.36 5313.5,-10492.33"/>
<polygon fill="black" stroke="black" points="5317,-10492.2 5313.5,-10482.2 5310,-10492.2 5317,-10492.2"/>
</g>
<!-- layer0_ln1_4&#45;&gt;layer0_ffn_gate_4 -->
<g id="edge50" class="edge">
<title>layer0_ln1_4&#45;&gt;layer0_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5304.44,-10445.89C5298.31,-10434.33 5289.89,-10418.42 5281.75,-10403.06"/>
<polygon fill="black" stroke="black" points="5284.79,-10401.32 5277.01,-10394.12 5278.6,-10404.59 5284.79,-10401.32"/>
</g>
<!-- layer0_ln1_4&#45;&gt;layer0_ffn_up_4 -->
<g id="edge51" class="edge">
<title>layer0_ln1_4&#45;&gt;layer0_ffn_up_4</title>
<path fill="none" stroke="black" d="M5367.03,-10449.46C5419.22,-10436.27 5501.39,-10415.48 5575.95,-10396.63"/>
<polygon fill="black" stroke="black" points="5577.1,-10399.95 5585.94,-10394.1 5575.39,-10393.16 5577.1,-10399.95"/>
</g>
<!-- layer0_ffn_act_4&#45;&gt;layer0_ffn_down_4 -->
<g id="edge54" class="edge">
<title>layer0_ffn_act_4&#45;&gt;layer0_ffn_down_4</title>
<path fill="none" stroke="black" d="M5287.5,-10173.74C5287.5,-10152.18 5287.5,-10114.37 5287.5,-10083.29"/>
<polygon fill="black" stroke="black" points="5291,-10083.04 5287.5,-10073.04 5284,-10083.04 5291,-10083.04"/>
</g>
<!-- layer1_mha_qkv_4 -->
<g id="node86" class="node">
<title>layer1_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="5565.5,-9752 5009.5,-9752 5009.5,-9669 5565.5,-9669 5565.5,-9752"/>
<text text-anchor="middle" x="5287.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5287.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5287.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5287.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5287.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_res2_4&#45;&gt;layer1_mha_qkv_4 -->
<g id="edge133" class="edge">
<title>layer0_res2_4&#45;&gt;layer1_mha_qkv_4</title>
<path fill="none" stroke="black" d="M5287.5,-9852.74C5287.5,-9831.18 5287.5,-9793.37 5287.5,-9762.29"/>
<polygon fill="black" stroke="black" points="5291,-9762.04 5287.5,-9752.04 5284,-9762.04 5291,-9762.04"/>
</g>
<!-- layer0_mha_attn_5&#45;&gt;layer0_mha_out_5 -->
<g id="edge58" class="edge">
<title>layer0_mha_attn_5&#45;&gt;layer0_mha_out_5</title>
<path fill="none" stroke="black" d="M5959.15,-10919.74C5981.94,-10897.43 6022.53,-10857.72 6054.88,-10826.07"/>
<polygon fill="black" stroke="black" points="6057.37,-10828.53 6062.07,-10819.04 6052.47,-10823.53 6057.37,-10828.53"/>
</g>
<!-- layer0_ln1_5 -->
<g id="node74" class="node">
<title>layer0_ln1_5</title>
<polygon fill="none" stroke="black" points="6291,-10482 6184,-10482 6184,-10446 6291,-10446 6291,-10482"/>
<text text-anchor="middle" x="6237.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_5</text>
</g>
<!-- layer0_res1_5&#45;&gt;layer0_ln1_5 -->
<g id="edge60" class="edge">
<title>layer0_res1_5&#45;&gt;layer0_ln1_5</title>
<path fill="none" stroke="black" d="M6165.63,-10598.97C6179.73,-10572.69 6206.9,-10522.05 6223.49,-10491.12"/>
<polygon fill="black" stroke="black" points="6226.63,-10492.66 6228.27,-10482.2 6220.46,-10489.36 6226.63,-10492.66"/>
</g>
<!-- layer0_ln1_5&#45;&gt;layer0_ffn_gate_5 -->
<g id="edge61" class="edge">
<title>layer0_ln1_5&#45;&gt;layer0_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6237.5,-10445.89C6237.5,-10434.65 6237.5,-10419.31 6237.5,-10404.35"/>
<polygon fill="black" stroke="black" points="6241,-10404.12 6237.5,-10394.12 6234,-10404.12 6241,-10404.12"/>
</g>
<!-- layer0_ln1_5&#45;&gt;layer0_ffn_up_5 -->
<g id="edge62" class="edge">
<title>layer0_ln1_5&#45;&gt;layer0_ffn_up_5</title>
<path fill="none" stroke="black" d="M6291.45,-10450.97C6350.52,-10437.8 6448.61,-10415.92 6536.91,-10396.23"/>
<polygon fill="black" stroke="black" points="6537.8,-10399.61 6546.8,-10394.02 6536.28,-10392.78 6537.8,-10399.61"/>
</g>
<!-- layer0_ffn_act_5&#45;&gt;layer0_ffn_down_5 -->
<g id="edge65" class="edge">
<title>layer0_ffn_act_5&#45;&gt;layer0_ffn_down_5</title>
<path fill="none" stroke="black" d="M6658.5,-10173.74C6658.5,-10152.18 6658.5,-10114.37 6658.5,-10083.29"/>
<polygon fill="black" stroke="black" points="6662,-10083.04 6658.5,-10073.04 6655,-10083.04 6662,-10083.04"/>
</g>
<!-- layer1_mha_qkv_5 -->
<g id="node87" class="node">
<title>layer1_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="6936.5,-9752 6380.5,-9752 6380.5,-9669 6936.5,-9669 6936.5,-9752"/>
<text text-anchor="middle" x="6658.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6658.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6658.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6658.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6658.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_res2_5&#45;&gt;layer1_mha_qkv_5 -->
<g id="edge144" class="edge">
<title>layer0_res2_5&#45;&gt;layer1_mha_qkv_5</title>
<path fill="none" stroke="black" d="M6658.5,-9852.74C6658.5,-9831.18 6658.5,-9793.37 6658.5,-9762.29"/>
<polygon fill="black" stroke="black" points="6662,-9762.04 6658.5,-9752.04 6655,-9762.04 6662,-9762.04"/>
</g>
<!-- layer0_mha_attn_6&#45;&gt;layer0_mha_out_6 -->
<g id="edge69" class="edge">
<title>layer0_mha_attn_6&#45;&gt;layer0_mha_out_6</title>
<path fill="none" stroke="black" d="M6827.12,-10919.74C6836.73,-10898 6853.64,-10859.71 6867.43,-10828.48"/>
<polygon fill="black" stroke="black" points="6870.76,-10829.6 6871.6,-10819.04 6864.36,-10826.77 6870.76,-10829.6"/>
</g>
<!-- layer0_ln1_6 -->
<g id="node79" class="node">
<title>layer0_ln1_6</title>
<polygon fill="none" stroke="black" points="7273,-10482 7166,-10482 7166,-10446 7273,-10446 7273,-10482"/>
<text text-anchor="middle" x="7219.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer0_ln1_6</text>
</g>
<!-- layer0_res1_6&#45;&gt;layer0_ln1_6 -->
<g id="edge71" class="edge">
<title>layer0_res1_6&#45;&gt;layer0_ln1_6</title>
<path fill="none" stroke="black" d="M7024.31,-10598.97C7063.92,-10571.78 7141.51,-10518.53 7186.01,-10487.99"/>
<polygon fill="black" stroke="black" points="7188.18,-10490.74 7194.44,-10482.2 7184.22,-10484.97 7188.18,-10490.74"/>
</g>
<!-- layer0_ln1_6&#45;&gt;layer0_ffn_gate_6 -->
<g id="edge72" class="edge">
<title>layer0_ln1_6&#45;&gt;layer0_ffn_gate_6</title>
<path fill="none" stroke="black" d="M7219.5,-10445.89C7219.5,-10434.65 7219.5,-10419.31 7219.5,-10404.35"/>
<polygon fill="black" stroke="black" points="7223,-10404.12 7219.5,-10394.12 7216,-10404.12 7223,-10404.12"/>
</g>
<!-- layer0_ln1_6&#45;&gt;layer0_ffn_up_6 -->
<g id="edge73" class="edge">
<title>layer0_ln1_6&#45;&gt;layer0_ffn_up_6</title>
<path fill="none" stroke="black" d="M7273.45,-10450.97C7332.52,-10437.8 7430.61,-10415.92 7518.91,-10396.23"/>
<polygon fill="black" stroke="black" points="7519.8,-10399.61 7528.8,-10394.02 7518.28,-10392.78 7519.8,-10399.61"/>
</g>
<!-- layer0_ffn_act_6&#45;&gt;layer0_ffn_down_6 -->
<g id="edge76" class="edge">
<title>layer0_ffn_act_6&#45;&gt;layer0_ffn_down_6</title>
<path fill="none" stroke="black" d="M7436.5,-10173.74C7436.5,-10152.18 7436.5,-10114.37 7436.5,-10083.29"/>
<polygon fill="black" stroke="black" points="7440,-10083.04 7436.5,-10073.04 7433,-10083.04 7440,-10083.04"/>
</g>
<!-- layer1_mha_qkv_6 -->
<g id="node88" class="node">
<title>layer1_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="7714.5,-9752 7158.5,-9752 7158.5,-9669 7714.5,-9669 7714.5,-9752"/>
<text text-anchor="middle" x="7436.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7436.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7436.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7436.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7436.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_res2_6&#45;&gt;layer1_mha_qkv_6 -->
<g id="edge155" class="edge">
<title>layer0_res2_6&#45;&gt;layer1_mha_qkv_6</title>
<path fill="none" stroke="black" d="M7436.5,-9852.74C7436.5,-9831.18 7436.5,-9793.37 7436.5,-9762.29"/>
<polygon fill="black" stroke="black" points="7440,-9762.04 7436.5,-9752.04 7433,-9762.04 7440,-9762.04"/>
</g>
<!-- layer1_mha_attn_0 -->
<g id="node127" class="node">
<title>layer1_mha_attn_0</title>
<polygon fill="none" stroke="black" points="1442,-9568 1291,-9568 1291,-9532 1442,-9532 1442,-9568"/>
<text text-anchor="middle" x="1366.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_0</text>
</g>
<!-- layer1_mha_qkv_0&#45;&gt;layer1_mha_attn_0 -->
<g id="edge90" class="edge">
<title>layer1_mha_qkv_0&#45;&gt;layer1_mha_attn_0</title>
<path fill="none" stroke="black" d="M1366.5,-9668.68C1366.5,-9640.24 1366.5,-9603.08 1366.5,-9578.2"/>
<polygon fill="black" stroke="black" points="1370,-9578.02 1366.5,-9568.02 1363,-9578.02 1370,-9578.02"/>
</g>
<!-- layer1_mha_attn_1 -->
<g id="node132" class="node">
<title>layer1_mha_attn_1</title>
<polygon fill="none" stroke="black" points="2436,-9568 2285,-9568 2285,-9532 2436,-9532 2436,-9568"/>
<text text-anchor="middle" x="2360.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_1</text>
</g>
<!-- layer1_mha_qkv_1&#45;&gt;layer1_mha_attn_1 -->
<g id="edge101" class="edge">
<title>layer1_mha_qkv_1&#45;&gt;layer1_mha_attn_1</title>
<path fill="none" stroke="black" d="M2360.5,-9668.68C2360.5,-9640.24 2360.5,-9603.08 2360.5,-9578.2"/>
<polygon fill="black" stroke="black" points="2364,-9578.02 2360.5,-9568.02 2357,-9578.02 2364,-9578.02"/>
</g>
<!-- layer1_mha_attn_2 -->
<g id="node137" class="node">
<title>layer1_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3539,-9568 3388,-9568 3388,-9532 3539,-9532 3539,-9568"/>
<text text-anchor="middle" x="3463.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_2</text>
</g>
<!-- layer1_mha_qkv_2&#45;&gt;layer1_mha_attn_2 -->
<g id="edge112" class="edge">
<title>layer1_mha_qkv_2&#45;&gt;layer1_mha_attn_2</title>
<path fill="none" stroke="black" d="M3463.5,-9668.68C3463.5,-9640.24 3463.5,-9603.08 3463.5,-9578.2"/>
<polygon fill="black" stroke="black" points="3467,-9578.02 3463.5,-9568.02 3460,-9578.02 3467,-9578.02"/>
</g>
<!-- layer1_mha_attn_3 -->
<g id="node142" class="node">
<title>layer1_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4779,-9568 4628,-9568 4628,-9532 4779,-9532 4779,-9568"/>
<text text-anchor="middle" x="4703.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_3</text>
</g>
<!-- layer1_mha_qkv_3&#45;&gt;layer1_mha_attn_3 -->
<g id="edge123" class="edge">
<title>layer1_mha_qkv_3&#45;&gt;layer1_mha_attn_3</title>
<path fill="none" stroke="black" d="M4703.5,-9668.68C4703.5,-9640.24 4703.5,-9603.08 4703.5,-9578.2"/>
<polygon fill="black" stroke="black" points="4707,-9578.02 4703.5,-9568.02 4700,-9578.02 4707,-9578.02"/>
</g>
<!-- layer1_mha_attn_4 -->
<g id="node147" class="node">
<title>layer1_mha_attn_4</title>
<polygon fill="none" stroke="black" points="5363,-9568 5212,-9568 5212,-9532 5363,-9532 5363,-9568"/>
<text text-anchor="middle" x="5287.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_4</text>
</g>
<!-- layer1_mha_qkv_4&#45;&gt;layer1_mha_attn_4 -->
<g id="edge134" class="edge">
<title>layer1_mha_qkv_4&#45;&gt;layer1_mha_attn_4</title>
<path fill="none" stroke="black" d="M5287.5,-9668.68C5287.5,-9640.24 5287.5,-9603.08 5287.5,-9578.2"/>
<polygon fill="black" stroke="black" points="5291,-9578.02 5287.5,-9568.02 5284,-9578.02 5291,-9578.02"/>
</g>
<!-- layer1_mha_attn_5 -->
<g id="node152" class="node">
<title>layer1_mha_attn_5</title>
<polygon fill="none" stroke="black" points="6734,-9568 6583,-9568 6583,-9532 6734,-9532 6734,-9568"/>
<text text-anchor="middle" x="6658.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_5</text>
</g>
<!-- layer1_mha_qkv_5&#45;&gt;layer1_mha_attn_5 -->
<g id="edge145" class="edge">
<title>layer1_mha_qkv_5&#45;&gt;layer1_mha_attn_5</title>
<path fill="none" stroke="black" d="M6658.5,-9668.68C6658.5,-9640.24 6658.5,-9603.08 6658.5,-9578.2"/>
<polygon fill="black" stroke="black" points="6662,-9578.02 6658.5,-9568.02 6655,-9578.02 6662,-9578.02"/>
</g>
<!-- layer1_mha_attn_6 -->
<g id="node157" class="node">
<title>layer1_mha_attn_6</title>
<polygon fill="none" stroke="black" points="7512,-9568 7361,-9568 7361,-9532 7512,-9532 7512,-9568"/>
<text text-anchor="middle" x="7436.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer1_mha_attn_6</text>
</g>
<!-- layer1_mha_qkv_6&#45;&gt;layer1_mha_attn_6 -->
<g id="edge156" class="edge">
<title>layer1_mha_qkv_6&#45;&gt;layer1_mha_attn_6</title>
<path fill="none" stroke="black" d="M7436.5,-9668.68C7436.5,-9640.24 7436.5,-9603.08 7436.5,-9578.2"/>
<polygon fill="black" stroke="black" points="7440,-9578.02 7436.5,-9568.02 7433,-9578.02 7440,-9578.02"/>
</g>
<!-- layer1_mha_attn_7 -->
<g id="node90" class="node">
<title>layer1_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9153.31,-9633 8394.81,-9633 8199.69,-9467 8958.19,-9467 9153.31,-9633"/>
<text text-anchor="middle" x="8676.5" y="-9576.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="8676.5" y="-9561.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="8676.5" y="-9546.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8676.5" y="-9531.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9516.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_mha_qkv_7&#45;&gt;layer1_mha_attn_7 -->
<g id="edge167" class="edge">
<title>layer1_mha_qkv_7&#45;&gt;layer1_mha_attn_7</title>
<path fill="none" stroke="black" d="M8676.5,-9668.68C8676.5,-9660.75 8676.5,-9652.14 8676.5,-9643.31"/>
<polygon fill="black" stroke="black" points="8680,-9643.27 8676.5,-9633.27 8673,-9643.27 8680,-9643.27"/>
</g>
<!-- layer1_mha_out_7 -->
<g id="node98" class="node">
<title>layer1_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="8895.5,-9431 8457.5,-9431 8457.5,-9348 8895.5,-9348 8895.5,-9431"/>
<text text-anchor="middle" x="8676.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8676.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8676.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8676.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_mha_attn_7&#45;&gt;layer1_mha_out_7 -->
<g id="edge168" class="edge">
<title>layer1_mha_attn_7&#45;&gt;layer1_mha_out_7</title>
<path fill="none" stroke="black" d="M8676.5,-9466.96C8676.5,-9458.25 8676.5,-9449.59 8676.5,-9441.39"/>
<polygon fill="black" stroke="black" points="8680,-9441.29 8676.5,-9431.29 8673,-9441.29 8680,-9441.29"/>
</g>
<!-- layer1_mha_out_0 -->
<g id="node91" class="node">
<title>layer1_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="1585.5,-9431 1147.5,-9431 1147.5,-9348 1585.5,-9348 1585.5,-9431"/>
<text text-anchor="middle" x="1366.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="1366.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1366.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1366.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1366.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_res1_0 -->
<g id="node128" class="node">
<title>layer1_res1_0</title>
<polygon fill="none" stroke="black" points="1424.5,-9247 1308.5,-9247 1308.5,-9211 1424.5,-9211 1424.5,-9247"/>
<text text-anchor="middle" x="1366.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_0</text>
</g>
<!-- layer1_mha_out_0&#45;&gt;layer1_res1_0 -->
<g id="edge92" class="edge">
<title>layer1_mha_out_0&#45;&gt;layer1_res1_0</title>
<path fill="none" stroke="black" d="M1366.5,-9347.68C1366.5,-9319.24 1366.5,-9282.08 1366.5,-9257.2"/>
<polygon fill="black" stroke="black" points="1370,-9257.02 1366.5,-9247.02 1363,-9257.02 1370,-9257.02"/>
</g>
<!-- layer1_mha_out_1 -->
<g id="node92" class="node">
<title>layer1_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2579.5,-9431 2141.5,-9431 2141.5,-9348 2579.5,-9348 2579.5,-9431"/>
<text text-anchor="middle" x="2360.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="2360.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2360.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2360.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2360.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_res1_1 -->
<g id="node133" class="node">
<title>layer1_res1_1</title>
<polygon fill="none" stroke="black" points="2418.5,-9247 2302.5,-9247 2302.5,-9211 2418.5,-9211 2418.5,-9247"/>
<text text-anchor="middle" x="2360.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_1</text>
</g>
<!-- layer1_mha_out_1&#45;&gt;layer1_res1_1 -->
<g id="edge103" class="edge">
<title>layer1_mha_out_1&#45;&gt;layer1_res1_1</title>
<path fill="none" stroke="black" d="M2360.5,-9347.68C2360.5,-9319.24 2360.5,-9282.08 2360.5,-9257.2"/>
<polygon fill="black" stroke="black" points="2364,-9257.02 2360.5,-9247.02 2357,-9257.02 2364,-9257.02"/>
</g>
<!-- layer1_mha_out_2 -->
<g id="node93" class="node">
<title>layer1_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3682.5,-9431 3244.5,-9431 3244.5,-9348 3682.5,-9348 3682.5,-9431"/>
<text text-anchor="middle" x="3463.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3463.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3463.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3463.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3463.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_res1_2 -->
<g id="node138" class="node">
<title>layer1_res1_2</title>
<polygon fill="none" stroke="black" points="3521.5,-9247 3405.5,-9247 3405.5,-9211 3521.5,-9211 3521.5,-9247"/>
<text text-anchor="middle" x="3463.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_2</text>
</g>
<!-- layer1_mha_out_2&#45;&gt;layer1_res1_2 -->
<g id="edge114" class="edge">
<title>layer1_mha_out_2&#45;&gt;layer1_res1_2</title>
<path fill="none" stroke="black" d="M3463.5,-9347.68C3463.5,-9319.24 3463.5,-9282.08 3463.5,-9257.2"/>
<polygon fill="black" stroke="black" points="3467,-9257.02 3463.5,-9247.02 3460,-9257.02 3467,-9257.02"/>
</g>
<!-- layer1_mha_out_3 -->
<g id="node94" class="node">
<title>layer1_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4922.5,-9431 4484.5,-9431 4484.5,-9348 4922.5,-9348 4922.5,-9431"/>
<text text-anchor="middle" x="4703.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4703.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4703.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4703.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4703.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_res1_3 -->
<g id="node143" class="node">
<title>layer1_res1_3</title>
<polygon fill="none" stroke="black" points="4761.5,-9247 4645.5,-9247 4645.5,-9211 4761.5,-9211 4761.5,-9247"/>
<text text-anchor="middle" x="4703.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_3</text>
</g>
<!-- layer1_mha_out_3&#45;&gt;layer1_res1_3 -->
<g id="edge125" class="edge">
<title>layer1_mha_out_3&#45;&gt;layer1_res1_3</title>
<path fill="none" stroke="black" d="M4703.5,-9347.68C4703.5,-9319.24 4703.5,-9282.08 4703.5,-9257.2"/>
<polygon fill="black" stroke="black" points="4707,-9257.02 4703.5,-9247.02 4700,-9257.02 4707,-9257.02"/>
</g>
<!-- layer1_mha_out_4 -->
<g id="node95" class="node">
<title>layer1_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="5506.5,-9431 5068.5,-9431 5068.5,-9348 5506.5,-9348 5506.5,-9431"/>
<text text-anchor="middle" x="5287.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="5287.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5287.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5287.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5287.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_res1_4 -->
<g id="node148" class="node">
<title>layer1_res1_4</title>
<polygon fill="none" stroke="black" points="5345.5,-9247 5229.5,-9247 5229.5,-9211 5345.5,-9211 5345.5,-9247"/>
<text text-anchor="middle" x="5287.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_4</text>
</g>
<!-- layer1_mha_out_4&#45;&gt;layer1_res1_4 -->
<g id="edge136" class="edge">
<title>layer1_mha_out_4&#45;&gt;layer1_res1_4</title>
<path fill="none" stroke="black" d="M5287.5,-9347.68C5287.5,-9319.24 5287.5,-9282.08 5287.5,-9257.2"/>
<polygon fill="black" stroke="black" points="5291,-9257.02 5287.5,-9247.02 5284,-9257.02 5291,-9257.02"/>
</g>
<!-- layer1_mha_out_5 -->
<g id="node96" class="node">
<title>layer1_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="6877.5,-9431 6439.5,-9431 6439.5,-9348 6877.5,-9348 6877.5,-9431"/>
<text text-anchor="middle" x="6658.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6658.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6658.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6658.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6658.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_res1_5 -->
<g id="node153" class="node">
<title>layer1_res1_5</title>
<polygon fill="none" stroke="black" points="6716.5,-9247 6600.5,-9247 6600.5,-9211 6716.5,-9211 6716.5,-9247"/>
<text text-anchor="middle" x="6658.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_5</text>
</g>
<!-- layer1_mha_out_5&#45;&gt;layer1_res1_5 -->
<g id="edge147" class="edge">
<title>layer1_mha_out_5&#45;&gt;layer1_res1_5</title>
<path fill="none" stroke="black" d="M6658.5,-9347.68C6658.5,-9319.24 6658.5,-9282.08 6658.5,-9257.2"/>
<polygon fill="black" stroke="black" points="6662,-9257.02 6658.5,-9247.02 6655,-9257.02 6662,-9257.02"/>
</g>
<!-- layer1_mha_out_6 -->
<g id="node97" class="node">
<title>layer1_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="7655.5,-9431 7217.5,-9431 7217.5,-9348 7655.5,-9348 7655.5,-9431"/>
<text text-anchor="middle" x="7436.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7436.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7436.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7436.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7436.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_res1_6 -->
<g id="node158" class="node">
<title>layer1_res1_6</title>
<polygon fill="none" stroke="black" points="7494.5,-9247 7378.5,-9247 7378.5,-9211 7494.5,-9211 7494.5,-9247"/>
<text text-anchor="middle" x="7436.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer1_res1_6</text>
</g>
<!-- layer1_mha_out_6&#45;&gt;layer1_res1_6 -->
<g id="edge158" class="edge">
<title>layer1_mha_out_6&#45;&gt;layer1_res1_6</title>
<path fill="none" stroke="black" d="M7436.5,-9347.68C7436.5,-9319.24 7436.5,-9282.08 7436.5,-9257.2"/>
<polygon fill="black" stroke="black" points="7440,-9257.02 7436.5,-9247.02 7433,-9257.02 7440,-9257.02"/>
</g>
<!-- layer1_res1_7 -->
<g id="node99" class="node">
<title>layer1_res1_7</title>
<polygon fill="none" stroke="black" points="9117.24,-9312 8416.12,-9312 8235.76,-9146 8936.88,-9146 9117.24,-9312"/>
<text text-anchor="middle" x="8676.5" y="-9255.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8676.5" y="-9240.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9225.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9210.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9195.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_mha_out_7&#45;&gt;layer1_res1_7 -->
<g id="edge169" class="edge">
<title>layer1_mha_out_7&#45;&gt;layer1_res1_7</title>
<path fill="none" stroke="black" d="M8676.5,-9347.68C8676.5,-9339.75 8676.5,-9331.14 8676.5,-9322.31"/>
<polygon fill="black" stroke="black" points="8680,-9322.27 8676.5,-9312.27 8673,-9322.27 8680,-9322.27"/>
</g>
<!-- layer1_ln1_7 -->
<g id="node100" class="node">
<title>layer1_ln1_7</title>
<polygon fill="yellow" stroke="black" points="8889,-9110 8464,-9110 8464,-9042 8889,-9042 8889,-9110"/>
<text text-anchor="middle" x="8676.5" y="-9094.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="8676.5" y="-9079.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9064.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8676.5" y="-9049.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_res1_7&#45;&gt;layer1_ln1_7 -->
<g id="edge170" class="edge">
<title>layer1_res1_7&#45;&gt;layer1_ln1_7</title>
<path fill="none" stroke="black" d="M8676.5,-9145.87C8676.5,-9137.12 8676.5,-9128.48 8676.5,-9120.45"/>
<polygon fill="black" stroke="black" points="8680,-9120.26 8676.5,-9110.26 8673,-9120.26 8680,-9120.26"/>
</g>
<!-- layer1_ffn_gate_7 -->
<g id="node108" class="node">
<title>layer1_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="8908,-9006 8435,-9006 8435,-8923 8908,-8923 8908,-9006"/>
<text text-anchor="middle" x="8671.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8671.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8671.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8671.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8671.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_ln1_7&#45;&gt;layer1_ffn_gate_7 -->
<g id="edge171" class="edge">
<title>layer1_ln1_7&#45;&gt;layer1_ffn_gate_7</title>
<path fill="none" stroke="black" d="M8674.99,-9041.85C8674.62,-9033.8 8674.22,-9025 8673.82,-9016.34"/>
<polygon fill="black" stroke="black" points="8677.31,-9016.11 8673.36,-9006.28 8670.32,-9016.43 8677.31,-9016.11"/>
</g>
<!-- layer1_ffn_up_7 -->
<g id="node116" class="node">
<title>layer1_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9399,-9006 8926,-9006 8926,-8923 9399,-8923 9399,-9006"/>
<text text-anchor="middle" x="9162.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9162.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9162.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9162.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9162.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_ln1_7&#45;&gt;layer1_ffn_up_7 -->
<g id="edge172" class="edge">
<title>layer1_ln1_7&#45;&gt;layer1_ffn_up_7</title>
<path fill="none" stroke="black" d="M8822.98,-9042C8870.01,-9031.4 8922.8,-9019.51 8972.49,-9008.31"/>
<polygon fill="black" stroke="black" points="8973.4,-9011.69 8982.38,-9006.08 8971.86,-9004.87 8973.4,-9011.69"/>
</g>
<!-- layer1_ffn_gate_0 -->
<g id="node101" class="node">
<title>layer1_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="1133,-9006 660,-9006 660,-8923 1133,-8923 1133,-9006"/>
<text text-anchor="middle" x="896.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="896.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="896.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="896.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="896.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_ffn_act_0 -->
<g id="node130" class="node">
<title>layer1_ffn_act_0</title>
<polygon fill="none" stroke="black" points="1124,-8822 993,-8822 993,-8786 1124,-8786 1124,-8822"/>
<text text-anchor="middle" x="1058.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_0</text>
</g>
<!-- layer1_ffn_gate_0&#45;&gt;layer1_ffn_act_0 -->
<g id="edge96" class="edge">
<title>layer1_ffn_gate_0&#45;&gt;layer1_ffn_act_0</title>
<path fill="none" stroke="black" d="M938.22,-8922.68C968.46,-8893.09 1008.35,-8854.06 1033.72,-8829.24"/>
<polygon fill="black" stroke="black" points="1036.4,-8831.52 1041.1,-8822.02 1031.51,-8826.52 1036.4,-8831.52"/>
</g>
<!-- layer1_ffn_gate_1 -->
<g id="node102" class="node">
<title>layer1_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="2135,-9006 1662,-9006 1662,-8923 2135,-8923 2135,-9006"/>
<text text-anchor="middle" x="1898.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1898.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1898.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1898.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1898.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_ffn_act_1 -->
<g id="node135" class="node">
<title>layer1_ffn_act_1</title>
<polygon fill="none" stroke="black" points="2455,-8822 2324,-8822 2324,-8786 2455,-8786 2455,-8822"/>
<text text-anchor="middle" x="2389.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_1</text>
</g>
<!-- layer1_ffn_gate_1&#45;&gt;layer1_ffn_act_1 -->
<g id="edge107" class="edge">
<title>layer1_ffn_gate_1&#45;&gt;layer1_ffn_act_1</title>
<path fill="none" stroke="black" d="M2023.99,-8922.99C2120.79,-8891.74 2250.61,-8849.83 2326.64,-8825.29"/>
<polygon fill="black" stroke="black" points="2328.11,-8828.5 2336.55,-8822.09 2325.96,-8821.83 2328.11,-8828.5"/>
</g>
<!-- layer1_ffn_gate_2 -->
<g id="node103" class="node">
<title>layer1_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3381,-9006 2908,-9006 2908,-8923 3381,-8923 3381,-9006"/>
<text text-anchor="middle" x="3144.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3144.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3144.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3144.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3144.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_ffn_act_2 -->
<g id="node140" class="node">
<title>layer1_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3412,-8822 3281,-8822 3281,-8786 3412,-8786 3412,-8822"/>
<text text-anchor="middle" x="3346.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_2</text>
</g>
<!-- layer1_ffn_gate_2&#45;&gt;layer1_ffn_act_2 -->
<g id="edge118" class="edge">
<title>layer1_ffn_gate_2&#45;&gt;layer1_ffn_act_2</title>
<path fill="none" stroke="black" d="M3196.26,-8922.89C3234.46,-8892.91 3285.1,-8853.18 3316.74,-8828.35"/>
<polygon fill="black" stroke="black" points="3319.04,-8831 3324.75,-8822.07 3314.72,-8825.49 3319.04,-8831"/>
</g>
<!-- layer1_ffn_gate_3 -->
<g id="node104" class="node">
<title>layer1_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4457,-9006 3984,-9006 3984,-8923 4457,-8923 4457,-9006"/>
<text text-anchor="middle" x="4220.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4220.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4220.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4220.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4220.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_ffn_act_3 -->
<g id="node145" class="node">
<title>layer1_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4762,-8822 4631,-8822 4631,-8786 4762,-8786 4762,-8822"/>
<text text-anchor="middle" x="4696.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_3</text>
</g>
<!-- layer1_ffn_gate_3&#45;&gt;layer1_ffn_act_3 -->
<g id="edge129" class="edge">
<title>layer1_ffn_gate_3&#45;&gt;layer1_ffn_act_3</title>
<path fill="none" stroke="black" d="M4342.15,-8922.99C4436,-8891.74 4561.86,-8849.83 4635.56,-8825.29"/>
<polygon fill="black" stroke="black" points="4636.79,-8828.57 4645.17,-8822.09 4634.58,-8821.93 4636.79,-8828.57"/>
</g>
<!-- layer1_ffn_gate_4 -->
<g id="node105" class="node">
<title>layer1_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5476,-9006 5003,-9006 5003,-8923 5476,-8923 5476,-9006"/>
<text text-anchor="middle" x="5239.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5239.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5239.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5239.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5239.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_ffn_act_4 -->
<g id="node150" class="node">
<title>layer1_ffn_act_4</title>
<polygon fill="none" stroke="black" points="5785,-8822 5654,-8822 5654,-8786 5785,-8786 5785,-8822"/>
<text text-anchor="middle" x="5719.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_4</text>
</g>
<!-- layer1_ffn_gate_4&#45;&gt;layer1_ffn_act_4 -->
<g id="edge140" class="edge">
<title>layer1_ffn_gate_4&#45;&gt;layer1_ffn_act_4</title>
<path fill="none" stroke="black" d="M5362.18,-8922.99C5456.81,-8891.74 5583.72,-8849.83 5658.05,-8825.29"/>
<polygon fill="black" stroke="black" points="5659.34,-8828.55 5667.74,-8822.09 5657.14,-8821.9 5659.34,-8828.55"/>
</g>
<!-- layer1_ffn_gate_5 -->
<g id="node106" class="node">
<title>layer1_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6476,-9006 6003,-9006 6003,-8923 6476,-8923 6476,-9006"/>
<text text-anchor="middle" x="6239.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6239.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6239.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6239.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6239.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_ffn_act_5 -->
<g id="node155" class="node">
<title>layer1_ffn_act_5</title>
<polygon fill="none" stroke="black" points="6742,-8822 6611,-8822 6611,-8786 6742,-8786 6742,-8822"/>
<text text-anchor="middle" x="6676.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_5</text>
</g>
<!-- layer1_ffn_gate_5&#45;&gt;layer1_ffn_act_5 -->
<g id="edge151" class="edge">
<title>layer1_ffn_gate_5&#45;&gt;layer1_ffn_act_5</title>
<path fill="none" stroke="black" d="M6351.19,-8922.99C6436.99,-8891.87 6551.94,-8850.18 6619.73,-8825.59"/>
<polygon fill="black" stroke="black" points="6621.17,-8828.79 6629.37,-8822.09 6618.78,-8822.21 6621.17,-8828.79"/>
</g>
<!-- layer1_ffn_gate_6 -->
<g id="node107" class="node">
<title>layer1_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="7601,-9006 7128,-9006 7128,-8923 7601,-8923 7601,-9006"/>
<text text-anchor="middle" x="7364.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7364.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7364.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7364.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7364.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_ffn_act_6 -->
<g id="node160" class="node">
<title>layer1_ffn_act_6</title>
<polygon fill="none" stroke="black" points="7737,-8822 7606,-8822 7606,-8786 7737,-8786 7737,-8822"/>
<text text-anchor="middle" x="7671.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer1_ffn_act_6</text>
</g>
<!-- layer1_ffn_gate_6&#45;&gt;layer1_ffn_act_6 -->
<g id="edge162" class="edge">
<title>layer1_ffn_gate_6&#45;&gt;layer1_ffn_act_6</title>
<path fill="none" stroke="black" d="M7443.16,-8922.89C7502.45,-8892.28 7581.47,-8851.48 7629.3,-8826.79"/>
<polygon fill="black" stroke="black" points="7631.16,-8829.77 7638.44,-8822.07 7627.95,-8823.55 7631.16,-8829.77"/>
</g>
<!-- layer1_ffn_act_7 -->
<g id="node117" class="node">
<title>layer1_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9150.24,-8887 8393.44,-8887 8198.76,-8721 8955.56,-8721 9150.24,-8887"/>
<text text-anchor="middle" x="8674.5" y="-8830.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="8674.5" y="-8815.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="8674.5" y="-8800.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8674.5" y="-8785.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8674.5" y="-8770.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_ffn_gate_7&#45;&gt;layer1_ffn_act_7 -->
<g id="edge173" class="edge">
<title>layer1_ffn_gate_7&#45;&gt;layer1_ffn_act_7</title>
<path fill="none" stroke="black" d="M8672.27,-8922.68C8672.42,-8914.75 8672.59,-8906.14 8672.75,-8897.31"/>
<polygon fill="black" stroke="black" points="8676.25,-8897.34 8672.94,-8887.27 8669.25,-8897.21 8676.25,-8897.34"/>
</g>
<!-- layer1_ffn_up_0 -->
<g id="node109" class="node">
<title>layer1_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="1624,-9006 1151,-9006 1151,-8923 1624,-8923 1624,-9006"/>
<text text-anchor="middle" x="1387.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1387.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1387.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1387.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1387.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_ffn_up_0&#45;&gt;layer1_ffn_act_0 -->
<g id="edge97" class="edge">
<title>layer1_ffn_up_0&#45;&gt;layer1_ffn_act_0</title>
<path fill="none" stroke="black" d="M1303.2,-8922.89C1239.4,-8892.15 1154.27,-8851.14 1103.08,-8826.48"/>
<polygon fill="black" stroke="black" points="1104.46,-8823.26 1093.93,-8822.07 1101.42,-8829.56 1104.46,-8823.26"/>
</g>
<!-- layer1_ffn_up_1 -->
<g id="node110" class="node">
<title>layer1_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2626,-9006 2153,-9006 2153,-8923 2626,-8923 2626,-9006"/>
<text text-anchor="middle" x="2389.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2389.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2389.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2389.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2389.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_ffn_up_1&#45;&gt;layer1_ffn_act_1 -->
<g id="edge108" class="edge">
<title>layer1_ffn_up_1&#45;&gt;layer1_ffn_act_1</title>
<path fill="none" stroke="black" d="M2389.5,-8922.68C2389.5,-8894.24 2389.5,-8857.08 2389.5,-8832.2"/>
<polygon fill="black" stroke="black" points="2393,-8832.02 2389.5,-8822.02 2386,-8832.02 2393,-8832.02"/>
</g>
<!-- layer1_ffn_up_2 -->
<g id="node111" class="node">
<title>layer1_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="3872,-9006 3399,-9006 3399,-8923 3872,-8923 3872,-9006"/>
<text text-anchor="middle" x="3635.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3635.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3635.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3635.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3635.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_ffn_up_2&#45;&gt;layer1_ffn_act_2 -->
<g id="edge119" class="edge">
<title>layer1_ffn_up_2&#45;&gt;layer1_ffn_act_2</title>
<path fill="none" stroke="black" d="M3561.45,-8922.89C3505.75,-8892.34 3431.56,-8851.65 3386.5,-8826.94"/>
<polygon fill="black" stroke="black" points="3388.07,-8823.81 3377.62,-8822.07 3384.71,-8829.95 3388.07,-8823.81"/>
</g>
<!-- layer1_ffn_up_3 -->
<g id="node112" class="node">
<title>layer1_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="4948,-9006 4475,-9006 4475,-8923 4948,-8923 4948,-9006"/>
<text text-anchor="middle" x="4711.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4711.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4711.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4711.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4711.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_ffn_up_3&#45;&gt;layer1_ffn_act_3 -->
<g id="edge130" class="edge">
<title>layer1_ffn_up_3&#45;&gt;layer1_ffn_act_3</title>
<path fill="none" stroke="black" d="M4707.64,-8922.68C4704.95,-8894.24 4701.43,-8857.08 4699.07,-8832.2"/>
<polygon fill="black" stroke="black" points="4702.54,-8831.65 4698.11,-8822.02 4695.57,-8832.31 4702.54,-8831.65"/>
</g>
<!-- layer1_ffn_up_4 -->
<g id="node113" class="node">
<title>layer1_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="5967,-9006 5494,-9006 5494,-8923 5967,-8923 5967,-9006"/>
<text text-anchor="middle" x="5730.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5730.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5730.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5730.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5730.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_ffn_up_4&#45;&gt;layer1_ffn_act_4 -->
<g id="edge141" class="edge">
<title>layer1_ffn_up_4&#45;&gt;layer1_ffn_act_4</title>
<path fill="none" stroke="black" d="M5727.67,-8922.68C5725.69,-8894.24 5723.11,-8857.08 5721.39,-8832.2"/>
<polygon fill="black" stroke="black" points="5724.87,-8831.76 5720.68,-8822.02 5717.88,-8832.24 5724.87,-8831.76"/>
</g>
<!-- layer1_ffn_up_5 -->
<g id="node114" class="node">
<title>layer1_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="6967,-9006 6494,-9006 6494,-8923 6967,-8923 6967,-9006"/>
<text text-anchor="middle" x="6730.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6730.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6730.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6730.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6730.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_ffn_up_5&#45;&gt;layer1_ffn_act_5 -->
<g id="edge152" class="edge">
<title>layer1_ffn_up_5&#45;&gt;layer1_ffn_act_5</title>
<path fill="none" stroke="black" d="M6716.59,-8922.68C6706.82,-8893.98 6694.02,-8856.41 6685.54,-8831.53"/>
<polygon fill="black" stroke="black" points="6688.84,-8830.36 6682.3,-8822.02 6682.21,-8832.62 6688.84,-8830.36"/>
</g>
<!-- layer1_ffn_up_6 -->
<g id="node115" class="node">
<title>layer1_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8092,-9006 7619,-9006 7619,-8923 8092,-8923 8092,-9006"/>
<text text-anchor="middle" x="7855.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7855.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7855.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7855.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7855.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_ffn_up_6&#45;&gt;layer1_ffn_act_6 -->
<g id="edge163" class="edge">
<title>layer1_ffn_up_6&#45;&gt;layer1_ffn_act_6</title>
<path fill="none" stroke="black" d="M7808.12,-8922.68C7773.47,-8892.83 7727.68,-8853.39 7698.9,-8828.61"/>
<polygon fill="black" stroke="black" points="7701.12,-8825.9 7691.26,-8822.02 7696.55,-8831.2 7701.12,-8825.9"/>
</g>
<!-- layer1_ffn_up_7&#45;&gt;layer1_ffn_act_7 -->
<g id="edge174" class="edge">
<title>layer1_ffn_up_7&#45;&gt;layer1_ffn_act_7</title>
<path fill="none" stroke="black" d="M9037.78,-8922.99C9006.67,-8912.89 8972.14,-8901.67 8937.09,-8890.29"/>
<polygon fill="black" stroke="black" points="8937.79,-8886.83 8927.2,-8887.07 8935.63,-8893.49 8937.79,-8886.83"/>
</g>
<!-- layer1_ffn_down_7 -->
<g id="node125" class="node">
<title>layer1_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="8898,-8685 8451,-8685 8451,-8602 8898,-8602 8898,-8685"/>
<text text-anchor="middle" x="8674.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8674.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8674.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8674.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8674.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_ffn_act_7&#45;&gt;layer1_ffn_down_7 -->
<g id="edge175" class="edge">
<title>layer1_ffn_act_7&#45;&gt;layer1_ffn_down_7</title>
<path fill="none" stroke="black" d="M8674.5,-8720.96C8674.5,-8712.25 8674.5,-8703.59 8674.5,-8695.39"/>
<polygon fill="black" stroke="black" points="8678,-8695.29 8674.5,-8685.29 8671,-8695.29 8678,-8695.29"/>
</g>
<!-- layer1_ffn_down_0 -->
<g id="node118" class="node">
<title>layer1_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="1282,-8685 835,-8685 835,-8602 1282,-8602 1282,-8685"/>
<text text-anchor="middle" x="1058.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1058.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1058.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1058.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1058.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_res2_0 -->
<g id="node131" class="node">
<title>layer1_res2_0</title>
<polygon fill="none" stroke="black" points="1116.5,-8501 1000.5,-8501 1000.5,-8465 1116.5,-8465 1116.5,-8501"/>
<text text-anchor="middle" x="1058.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_0</text>
</g>
<!-- layer1_ffn_down_0&#45;&gt;layer1_res2_0 -->
<g id="edge99" class="edge">
<title>layer1_ffn_down_0&#45;&gt;layer1_res2_0</title>
<path fill="none" stroke="black" d="M1058.5,-8601.68C1058.5,-8573.24 1058.5,-8536.08 1058.5,-8511.2"/>
<polygon fill="black" stroke="black" points="1062,-8511.02 1058.5,-8501.02 1055,-8511.02 1062,-8511.02"/>
</g>
<!-- layer1_ffn_down_1 -->
<g id="node119" class="node">
<title>layer1_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="2613,-8685 2166,-8685 2166,-8602 2613,-8602 2613,-8685"/>
<text text-anchor="middle" x="2389.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2389.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2389.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2389.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2389.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_res2_1 -->
<g id="node136" class="node">
<title>layer1_res2_1</title>
<polygon fill="none" stroke="black" points="2447.5,-8501 2331.5,-8501 2331.5,-8465 2447.5,-8465 2447.5,-8501"/>
<text text-anchor="middle" x="2389.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_1</text>
</g>
<!-- layer1_ffn_down_1&#45;&gt;layer1_res2_1 -->
<g id="edge110" class="edge">
<title>layer1_ffn_down_1&#45;&gt;layer1_res2_1</title>
<path fill="none" stroke="black" d="M2389.5,-8601.68C2389.5,-8573.24 2389.5,-8536.08 2389.5,-8511.2"/>
<polygon fill="black" stroke="black" points="2393,-8511.02 2389.5,-8501.02 2386,-8511.02 2393,-8511.02"/>
</g>
<!-- layer1_ffn_down_2 -->
<g id="node120" class="node">
<title>layer1_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3570,-8685 3123,-8685 3123,-8602 3570,-8602 3570,-8685"/>
<text text-anchor="middle" x="3346.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3346.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3346.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3346.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3346.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_res2_2 -->
<g id="node141" class="node">
<title>layer1_res2_2</title>
<polygon fill="none" stroke="black" points="3404.5,-8501 3288.5,-8501 3288.5,-8465 3404.5,-8465 3404.5,-8501"/>
<text text-anchor="middle" x="3346.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_2</text>
</g>
<!-- layer1_ffn_down_2&#45;&gt;layer1_res2_2 -->
<g id="edge121" class="edge">
<title>layer1_ffn_down_2&#45;&gt;layer1_res2_2</title>
<path fill="none" stroke="black" d="M3346.5,-8601.68C3346.5,-8573.24 3346.5,-8536.08 3346.5,-8511.2"/>
<polygon fill="black" stroke="black" points="3350,-8511.02 3346.5,-8501.02 3343,-8511.02 3350,-8511.02"/>
</g>
<!-- layer1_ffn_down_3 -->
<g id="node121" class="node">
<title>layer1_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4920,-8685 4473,-8685 4473,-8602 4920,-8602 4920,-8685"/>
<text text-anchor="middle" x="4696.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4696.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4696.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4696.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4696.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_res2_3 -->
<g id="node146" class="node">
<title>layer1_res2_3</title>
<polygon fill="none" stroke="black" points="4754.5,-8501 4638.5,-8501 4638.5,-8465 4754.5,-8465 4754.5,-8501"/>
<text text-anchor="middle" x="4696.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_3</text>
</g>
<!-- layer1_ffn_down_3&#45;&gt;layer1_res2_3 -->
<g id="edge132" class="edge">
<title>layer1_ffn_down_3&#45;&gt;layer1_res2_3</title>
<path fill="none" stroke="black" d="M4696.5,-8601.68C4696.5,-8573.24 4696.5,-8536.08 4696.5,-8511.2"/>
<polygon fill="black" stroke="black" points="4700,-8511.02 4696.5,-8501.02 4693,-8511.02 4700,-8511.02"/>
</g>
<!-- layer1_ffn_down_4 -->
<g id="node122" class="node">
<title>layer1_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="5943,-8685 5496,-8685 5496,-8602 5943,-8602 5943,-8685"/>
<text text-anchor="middle" x="5719.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5719.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5719.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5719.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5719.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_res2_4 -->
<g id="node151" class="node">
<title>layer1_res2_4</title>
<polygon fill="none" stroke="black" points="5777.5,-8501 5661.5,-8501 5661.5,-8465 5777.5,-8465 5777.5,-8501"/>
<text text-anchor="middle" x="5719.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_4</text>
</g>
<!-- layer1_ffn_down_4&#45;&gt;layer1_res2_4 -->
<g id="edge143" class="edge">
<title>layer1_ffn_down_4&#45;&gt;layer1_res2_4</title>
<path fill="none" stroke="black" d="M5719.5,-8601.68C5719.5,-8573.24 5719.5,-8536.08 5719.5,-8511.2"/>
<polygon fill="black" stroke="black" points="5723,-8511.02 5719.5,-8501.02 5716,-8511.02 5723,-8511.02"/>
</g>
<!-- layer1_ffn_down_5 -->
<g id="node123" class="node">
<title>layer1_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="6900,-8685 6453,-8685 6453,-8602 6900,-8602 6900,-8685"/>
<text text-anchor="middle" x="6676.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6676.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6676.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6676.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6676.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_res2_5 -->
<g id="node156" class="node">
<title>layer1_res2_5</title>
<polygon fill="none" stroke="black" points="6734.5,-8501 6618.5,-8501 6618.5,-8465 6734.5,-8465 6734.5,-8501"/>
<text text-anchor="middle" x="6676.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_5</text>
</g>
<!-- layer1_ffn_down_5&#45;&gt;layer1_res2_5 -->
<g id="edge154" class="edge">
<title>layer1_ffn_down_5&#45;&gt;layer1_res2_5</title>
<path fill="none" stroke="black" d="M6676.5,-8601.68C6676.5,-8573.24 6676.5,-8536.08 6676.5,-8511.2"/>
<polygon fill="black" stroke="black" points="6680,-8511.02 6676.5,-8501.02 6673,-8511.02 6680,-8511.02"/>
</g>
<!-- layer1_ffn_down_6 -->
<g id="node124" class="node">
<title>layer1_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="7895,-8685 7448,-8685 7448,-8602 7895,-8602 7895,-8685"/>
<text text-anchor="middle" x="7671.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7671.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7671.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7671.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7671.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_res2_6 -->
<g id="node161" class="node">
<title>layer1_res2_6</title>
<polygon fill="none" stroke="black" points="7729.5,-8501 7613.5,-8501 7613.5,-8465 7729.5,-8465 7729.5,-8501"/>
<text text-anchor="middle" x="7671.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer1_res2_6</text>
</g>
<!-- layer1_ffn_down_6&#45;&gt;layer1_res2_6 -->
<g id="edge165" class="edge">
<title>layer1_ffn_down_6&#45;&gt;layer1_res2_6</title>
<path fill="none" stroke="black" d="M7671.5,-8601.68C7671.5,-8573.24 7671.5,-8536.08 7671.5,-8511.2"/>
<polygon fill="black" stroke="black" points="7675,-8511.02 7671.5,-8501.02 7668,-8511.02 7675,-8511.02"/>
</g>
<!-- layer1_res2_7 -->
<g id="node126" class="node">
<title>layer1_res2_7</title>
<polygon fill="none" stroke="black" points="9115.24,-8566 8414.12,-8566 8233.76,-8400 8934.88,-8400 9115.24,-8566"/>
<text text-anchor="middle" x="8674.5" y="-8509.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8674.5" y="-8494.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-8479.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-8464.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-8449.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_ffn_down_7&#45;&gt;layer1_res2_7 -->
<g id="edge176" class="edge">
<title>layer1_ffn_down_7&#45;&gt;layer1_res2_7</title>
<path fill="none" stroke="black" d="M8674.5,-8601.68C8674.5,-8593.75 8674.5,-8585.14 8674.5,-8576.31"/>
<polygon fill="black" stroke="black" points="8678,-8576.27 8674.5,-8566.27 8671,-8576.27 8678,-8576.27"/>
</g>
<!-- layer2_mha_qkv_7 -->
<g id="node169" class="node">
<title>layer2_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="8952.5,-8364 8396.5,-8364 8396.5,-8281 8952.5,-8281 8952.5,-8364"/>
<text text-anchor="middle" x="8674.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8674.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8674.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8674.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_res2_7&#45;&gt;layer2_mha_qkv_7 -->
<g id="edge254" class="edge">
<title>layer1_res2_7&#45;&gt;layer2_mha_qkv_7</title>
<path fill="none" stroke="black" d="M8674.5,-8399.96C8674.5,-8391.25 8674.5,-8382.59 8674.5,-8374.39"/>
<polygon fill="black" stroke="black" points="8678,-8374.29 8674.5,-8364.29 8671,-8374.29 8678,-8374.29"/>
</g>
<!-- layer1_mha_attn_0&#45;&gt;layer1_mha_out_0 -->
<g id="edge91" class="edge">
<title>layer1_mha_attn_0&#45;&gt;layer1_mha_out_0</title>
<path fill="none" stroke="black" d="M1366.5,-9531.74C1366.5,-9510.18 1366.5,-9472.37 1366.5,-9441.29"/>
<polygon fill="black" stroke="black" points="1370,-9441.04 1366.5,-9431.04 1363,-9441.04 1370,-9441.04"/>
</g>
<!-- layer1_ln1_0 -->
<g id="node129" class="node">
<title>layer1_ln1_0</title>
<polygon fill="none" stroke="black" points="1420,-9094 1313,-9094 1313,-9058 1420,-9058 1420,-9094"/>
<text text-anchor="middle" x="1366.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_0</text>
</g>
<!-- layer1_res1_0&#45;&gt;layer1_ln1_0 -->
<g id="edge93" class="edge">
<title>layer1_res1_0&#45;&gt;layer1_ln1_0</title>
<path fill="none" stroke="black" d="M1366.5,-9210.97C1366.5,-9185.03 1366.5,-9135.36 1366.5,-9104.33"/>
<polygon fill="black" stroke="black" points="1370,-9104.2 1366.5,-9094.2 1363,-9104.2 1370,-9104.2"/>
</g>
<!-- layer1_ln1_0&#45;&gt;layer1_ffn_gate_0 -->
<g id="edge94" class="edge">
<title>layer1_ln1_0&#45;&gt;layer1_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1312.59,-9062.44C1255.93,-9049.24 1163.66,-9027.74 1080.38,-9008.34"/>
<polygon fill="black" stroke="black" points="1081.07,-9004.91 1070.54,-9006.05 1079.48,-9011.72 1081.07,-9004.91"/>
</g>
<!-- layer1_ln1_0&#45;&gt;layer1_ffn_up_0 -->
<g id="edge95" class="edge">
<title>layer1_ln1_0&#45;&gt;layer1_ffn_up_0</title>
<path fill="none" stroke="black" d="M1369.78,-9057.89C1371.94,-9046.65 1374.88,-9031.31 1377.75,-9016.35"/>
<polygon fill="black" stroke="black" points="1381.26,-9016.6 1379.71,-9006.12 1374.39,-9015.28 1381.26,-9016.6"/>
</g>
<!-- layer1_ffn_act_0&#45;&gt;layer1_ffn_down_0 -->
<g id="edge98" class="edge">
<title>layer1_ffn_act_0&#45;&gt;layer1_ffn_down_0</title>
<path fill="none" stroke="black" d="M1058.5,-8785.74C1058.5,-8764.18 1058.5,-8726.37 1058.5,-8695.29"/>
<polygon fill="black" stroke="black" points="1062,-8695.04 1058.5,-8685.04 1055,-8695.04 1062,-8695.04"/>
</g>
<!-- layer2_mha_qkv_0 -->
<g id="node162" class="node">
<title>layer2_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="1336.5,-8364 780.5,-8364 780.5,-8281 1336.5,-8281 1336.5,-8364"/>
<text text-anchor="middle" x="1058.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="1058.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1058.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1058.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="1058.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_res2_0&#45;&gt;layer2_mha_qkv_0 -->
<g id="edge177" class="edge">
<title>layer1_res2_0&#45;&gt;layer2_mha_qkv_0</title>
<path fill="none" stroke="black" d="M1058.5,-8464.74C1058.5,-8443.18 1058.5,-8405.37 1058.5,-8374.29"/>
<polygon fill="black" stroke="black" points="1062,-8374.04 1058.5,-8364.04 1055,-8374.04 1062,-8374.04"/>
</g>
<!-- layer1_mha_attn_1&#45;&gt;layer1_mha_out_1 -->
<g id="edge102" class="edge">
<title>layer1_mha_attn_1&#45;&gt;layer1_mha_out_1</title>
<path fill="none" stroke="black" d="M2360.5,-9531.74C2360.5,-9510.18 2360.5,-9472.37 2360.5,-9441.29"/>
<polygon fill="black" stroke="black" points="2364,-9441.04 2360.5,-9431.04 2357,-9441.04 2364,-9441.04"/>
</g>
<!-- layer1_ln1_1 -->
<g id="node134" class="node">
<title>layer1_ln1_1</title>
<polygon fill="none" stroke="black" points="2414,-9094 2307,-9094 2307,-9058 2414,-9058 2414,-9094"/>
<text text-anchor="middle" x="2360.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_1</text>
</g>
<!-- layer1_res1_1&#45;&gt;layer1_ln1_1 -->
<g id="edge104" class="edge">
<title>layer1_res1_1&#45;&gt;layer1_ln1_1</title>
<path fill="none" stroke="black" d="M2360.5,-9210.97C2360.5,-9185.03 2360.5,-9135.36 2360.5,-9104.33"/>
<polygon fill="black" stroke="black" points="2364,-9104.2 2360.5,-9094.2 2357,-9104.2 2364,-9104.2"/>
</g>
<!-- layer1_ln1_1&#45;&gt;layer1_ffn_gate_1 -->
<g id="edge105" class="edge">
<title>layer1_ln1_1&#45;&gt;layer1_ffn_gate_1</title>
<path fill="none" stroke="black" d="M2306.6,-9062.22C2250.85,-9049.01 2160.69,-9027.64 2079.29,-9008.35"/>
<polygon fill="black" stroke="black" points="2079.94,-9004.91 2069.41,-9006.01 2078.33,-9011.72 2079.94,-9004.91"/>
</g>
<!-- layer1_ln1_1&#45;&gt;layer1_ffn_up_1 -->
<g id="edge106" class="edge">
<title>layer1_ln1_1&#45;&gt;layer1_ffn_up_1</title>
<path fill="none" stroke="black" d="M2365.03,-9057.89C2368.04,-9046.54 2372.15,-9031.01 2376.15,-9015.92"/>
<polygon fill="black" stroke="black" points="2379.57,-9016.68 2378.74,-9006.12 2372.8,-9014.89 2379.57,-9016.68"/>
</g>
<!-- layer1_ffn_act_1&#45;&gt;layer1_ffn_down_1 -->
<g id="edge109" class="edge">
<title>layer1_ffn_act_1&#45;&gt;layer1_ffn_down_1</title>
<path fill="none" stroke="black" d="M2389.5,-8785.74C2389.5,-8764.18 2389.5,-8726.37 2389.5,-8695.29"/>
<polygon fill="black" stroke="black" points="2393,-8695.04 2389.5,-8685.04 2386,-8695.04 2393,-8695.04"/>
</g>
<!-- layer2_mha_qkv_1 -->
<g id="node163" class="node">
<title>layer2_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2667.5,-8364 2111.5,-8364 2111.5,-8281 2667.5,-8281 2667.5,-8364"/>
<text text-anchor="middle" x="2389.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="2389.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2389.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2389.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="2389.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_res2_1&#45;&gt;layer2_mha_qkv_1 -->
<g id="edge188" class="edge">
<title>layer1_res2_1&#45;&gt;layer2_mha_qkv_1</title>
<path fill="none" stroke="black" d="M2389.5,-8464.74C2389.5,-8443.18 2389.5,-8405.37 2389.5,-8374.29"/>
<polygon fill="black" stroke="black" points="2393,-8374.04 2389.5,-8364.04 2386,-8374.04 2393,-8374.04"/>
</g>
<!-- layer1_mha_attn_2&#45;&gt;layer1_mha_out_2 -->
<g id="edge113" class="edge">
<title>layer1_mha_attn_2&#45;&gt;layer1_mha_out_2</title>
<path fill="none" stroke="black" d="M3463.5,-9531.74C3463.5,-9510.18 3463.5,-9472.37 3463.5,-9441.29"/>
<polygon fill="black" stroke="black" points="3467,-9441.04 3463.5,-9431.04 3460,-9441.04 3467,-9441.04"/>
</g>
<!-- layer1_ln1_2 -->
<g id="node139" class="node">
<title>layer1_ln1_2</title>
<polygon fill="none" stroke="black" points="3517,-9094 3410,-9094 3410,-9058 3517,-9058 3517,-9094"/>
<text text-anchor="middle" x="3463.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_2</text>
</g>
<!-- layer1_res1_2&#45;&gt;layer1_ln1_2 -->
<g id="edge115" class="edge">
<title>layer1_res1_2&#45;&gt;layer1_ln1_2</title>
<path fill="none" stroke="black" d="M3463.5,-9210.97C3463.5,-9185.03 3463.5,-9135.36 3463.5,-9104.33"/>
<polygon fill="black" stroke="black" points="3467,-9104.2 3463.5,-9094.2 3460,-9104.2 3467,-9104.2"/>
</g>
<!-- layer1_ln1_2&#45;&gt;layer1_ffn_gate_2 -->
<g id="edge116" class="edge">
<title>layer1_ln1_2&#45;&gt;layer1_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3413.66,-9057.89C3375.71,-9044.87 3321.72,-9026.33 3272.04,-9009.28"/>
<polygon fill="black" stroke="black" points="3273.09,-9005.94 3262.49,-9006 3270.81,-9012.56 3273.09,-9005.94"/>
</g>
<!-- layer1_ln1_2&#45;&gt;layer1_ffn_up_2 -->
<g id="edge117" class="edge">
<title>layer1_ln1_2&#45;&gt;layer1_ffn_up_2</title>
<path fill="none" stroke="black" d="M3490.38,-9057.89C3509.9,-9045.46 3537.3,-9028.02 3563.05,-9011.63"/>
<polygon fill="black" stroke="black" points="3565.14,-9014.44 3571.7,-9006.12 3561.38,-9008.54 3565.14,-9014.44"/>
</g>
<!-- layer1_ffn_act_2&#45;&gt;layer1_ffn_down_2 -->
<g id="edge120" class="edge">
<title>layer1_ffn_act_2&#45;&gt;layer1_ffn_down_2</title>
<path fill="none" stroke="black" d="M3346.5,-8785.74C3346.5,-8764.18 3346.5,-8726.37 3346.5,-8695.29"/>
<polygon fill="black" stroke="black" points="3350,-8695.04 3346.5,-8685.04 3343,-8695.04 3350,-8695.04"/>
</g>
<!-- layer2_mha_qkv_2 -->
<g id="node164" class="node">
<title>layer2_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3624.5,-8364 3068.5,-8364 3068.5,-8281 3624.5,-8281 3624.5,-8364"/>
<text text-anchor="middle" x="3346.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3346.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3346.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3346.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3346.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_res2_2&#45;&gt;layer2_mha_qkv_2 -->
<g id="edge199" class="edge">
<title>layer1_res2_2&#45;&gt;layer2_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3346.5,-8464.74C3346.5,-8443.18 3346.5,-8405.37 3346.5,-8374.29"/>
<polygon fill="black" stroke="black" points="3350,-8374.04 3346.5,-8364.04 3343,-8374.04 3350,-8374.04"/>
</g>
<!-- layer1_mha_attn_3&#45;&gt;layer1_mha_out_3 -->
<g id="edge124" class="edge">
<title>layer1_mha_attn_3&#45;&gt;layer1_mha_out_3</title>
<path fill="none" stroke="black" d="M4703.5,-9531.74C4703.5,-9510.18 4703.5,-9472.37 4703.5,-9441.29"/>
<polygon fill="black" stroke="black" points="4707,-9441.04 4703.5,-9431.04 4700,-9441.04 4707,-9441.04"/>
</g>
<!-- layer1_ln1_3 -->
<g id="node144" class="node">
<title>layer1_ln1_3</title>
<polygon fill="none" stroke="black" points="4757,-9094 4650,-9094 4650,-9058 4757,-9058 4757,-9094"/>
<text text-anchor="middle" x="4703.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_3</text>
</g>
<!-- layer1_res1_3&#45;&gt;layer1_ln1_3 -->
<g id="edge126" class="edge">
<title>layer1_res1_3&#45;&gt;layer1_ln1_3</title>
<path fill="none" stroke="black" d="M4703.5,-9210.97C4703.5,-9185.03 4703.5,-9135.36 4703.5,-9104.33"/>
<polygon fill="black" stroke="black" points="4707,-9104.2 4703.5,-9094.2 4700,-9104.2 4707,-9104.2"/>
</g>
<!-- layer1_ln1_3&#45;&gt;layer1_ffn_gate_3 -->
<g id="edge127" class="edge">
<title>layer1_ln1_3&#45;&gt;layer1_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4649.97,-9062.86C4591.85,-9049.69 4495.71,-9027.89 4409.12,-9008.26"/>
<polygon fill="black" stroke="black" points="4409.68,-9004.8 4399.15,-9006 4408.13,-9011.63 4409.68,-9004.8"/>
</g>
<!-- layer1_ln1_3&#45;&gt;layer1_ffn_up_3 -->
<g id="edge128" class="edge">
<title>layer1_ln1_3&#45;&gt;layer1_ffn_up_3</title>
<path fill="none" stroke="black" d="M4704.75,-9057.89C4705.57,-9046.65 4706.69,-9031.31 4707.78,-9016.35"/>
<polygon fill="black" stroke="black" points="4711.29,-9016.35 4708.53,-9006.12 4704.31,-9015.84 4711.29,-9016.35"/>
</g>
<!-- layer1_ffn_act_3&#45;&gt;layer1_ffn_down_3 -->
<g id="edge131" class="edge">
<title>layer1_ffn_act_3&#45;&gt;layer1_ffn_down_3</title>
<path fill="none" stroke="black" d="M4696.5,-8785.74C4696.5,-8764.18 4696.5,-8726.37 4696.5,-8695.29"/>
<polygon fill="black" stroke="black" points="4700,-8695.04 4696.5,-8685.04 4693,-8695.04 4700,-8695.04"/>
</g>
<!-- layer2_mha_qkv_3 -->
<g id="node165" class="node">
<title>layer2_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4974.5,-8364 4418.5,-8364 4418.5,-8281 4974.5,-8281 4974.5,-8364"/>
<text text-anchor="middle" x="4696.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4696.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4696.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4696.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4696.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_res2_3&#45;&gt;layer2_mha_qkv_3 -->
<g id="edge210" class="edge">
<title>layer1_res2_3&#45;&gt;layer2_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4696.5,-8464.74C4696.5,-8443.18 4696.5,-8405.37 4696.5,-8374.29"/>
<polygon fill="black" stroke="black" points="4700,-8374.04 4696.5,-8364.04 4693,-8374.04 4700,-8374.04"/>
</g>
<!-- layer1_mha_attn_4&#45;&gt;layer1_mha_out_4 -->
<g id="edge135" class="edge">
<title>layer1_mha_attn_4&#45;&gt;layer1_mha_out_4</title>
<path fill="none" stroke="black" d="M5287.5,-9531.74C5287.5,-9510.18 5287.5,-9472.37 5287.5,-9441.29"/>
<polygon fill="black" stroke="black" points="5291,-9441.04 5287.5,-9431.04 5284,-9441.04 5291,-9441.04"/>
</g>
<!-- layer1_ln1_4 -->
<g id="node149" class="node">
<title>layer1_ln1_4</title>
<polygon fill="none" stroke="black" points="5341,-9094 5234,-9094 5234,-9058 5341,-9058 5341,-9094"/>
<text text-anchor="middle" x="5287.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_4</text>
</g>
<!-- layer1_res1_4&#45;&gt;layer1_ln1_4 -->
<g id="edge137" class="edge">
<title>layer1_res1_4&#45;&gt;layer1_ln1_4</title>
<path fill="none" stroke="black" d="M5287.5,-9210.97C5287.5,-9185.03 5287.5,-9135.36 5287.5,-9104.33"/>
<polygon fill="black" stroke="black" points="5291,-9104.2 5287.5,-9094.2 5284,-9104.2 5291,-9104.2"/>
</g>
<!-- layer1_ln1_4&#45;&gt;layer1_ffn_gate_4 -->
<g id="edge138" class="edge">
<title>layer1_ln1_4&#45;&gt;layer1_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5280,-9057.89C5274.98,-9046.43 5268.09,-9030.72 5261.41,-9015.49"/>
<polygon fill="black" stroke="black" points="5264.53,-9013.87 5257.31,-9006.12 5258.11,-9016.68 5264.53,-9013.87"/>
</g>
<!-- layer1_ln1_4&#45;&gt;layer1_ffn_up_4 -->
<g id="edge139" class="edge">
<title>layer1_ln1_4&#45;&gt;layer1_ffn_up_4</title>
<path fill="none" stroke="black" d="M5341.38,-9061.68C5394.89,-9048.46 5479.84,-9027.46 5556.73,-9008.45"/>
<polygon fill="black" stroke="black" points="5557.68,-9011.82 5566.55,-9006.03 5556,-9005.03 5557.68,-9011.82"/>
</g>
<!-- layer1_ffn_act_4&#45;&gt;layer1_ffn_down_4 -->
<g id="edge142" class="edge">
<title>layer1_ffn_act_4&#45;&gt;layer1_ffn_down_4</title>
<path fill="none" stroke="black" d="M5719.5,-8785.74C5719.5,-8764.18 5719.5,-8726.37 5719.5,-8695.29"/>
<polygon fill="black" stroke="black" points="5723,-8695.04 5719.5,-8685.04 5716,-8695.04 5723,-8695.04"/>
</g>
<!-- layer2_mha_qkv_4 -->
<g id="node166" class="node">
<title>layer2_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="5997.5,-8364 5441.5,-8364 5441.5,-8281 5997.5,-8281 5997.5,-8364"/>
<text text-anchor="middle" x="5719.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5719.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5719.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5719.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5719.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_res2_4&#45;&gt;layer2_mha_qkv_4 -->
<g id="edge221" class="edge">
<title>layer1_res2_4&#45;&gt;layer2_mha_qkv_4</title>
<path fill="none" stroke="black" d="M5719.5,-8464.74C5719.5,-8443.18 5719.5,-8405.37 5719.5,-8374.29"/>
<polygon fill="black" stroke="black" points="5723,-8374.04 5719.5,-8364.04 5716,-8374.04 5723,-8374.04"/>
</g>
<!-- layer1_mha_attn_5&#45;&gt;layer1_mha_out_5 -->
<g id="edge146" class="edge">
<title>layer1_mha_attn_5&#45;&gt;layer1_mha_out_5</title>
<path fill="none" stroke="black" d="M6658.5,-9531.74C6658.5,-9510.18 6658.5,-9472.37 6658.5,-9441.29"/>
<polygon fill="black" stroke="black" points="6662,-9441.04 6658.5,-9431.04 6655,-9441.04 6662,-9441.04"/>
</g>
<!-- layer1_ln1_5 -->
<g id="node154" class="node">
<title>layer1_ln1_5</title>
<polygon fill="none" stroke="black" points="6712,-9094 6605,-9094 6605,-9058 6712,-9058 6712,-9094"/>
<text text-anchor="middle" x="6658.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_5</text>
</g>
<!-- layer1_res1_5&#45;&gt;layer1_ln1_5 -->
<g id="edge148" class="edge">
<title>layer1_res1_5&#45;&gt;layer1_ln1_5</title>
<path fill="none" stroke="black" d="M6658.5,-9210.97C6658.5,-9185.03 6658.5,-9135.36 6658.5,-9104.33"/>
<polygon fill="black" stroke="black" points="6662,-9104.2 6658.5,-9094.2 6655,-9104.2 6662,-9104.2"/>
</g>
<!-- layer1_ln1_5&#45;&gt;layer1_ffn_gate_5 -->
<g id="edge149" class="edge">
<title>layer1_ln1_5&#45;&gt;layer1_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6604.58,-9060.91C6554.02,-9047.7 6475.77,-9027.25 6404.66,-9008.66"/>
<polygon fill="black" stroke="black" points="6405.24,-9005.2 6394.68,-9006.05 6403.47,-9011.97 6405.24,-9005.2"/>
</g>
<!-- layer1_ln1_5&#45;&gt;layer1_ffn_up_5 -->
<g id="edge150" class="edge">
<title>layer1_ln1_5&#45;&gt;layer1_ffn_up_5</title>
<path fill="none" stroke="black" d="M6669.75,-9057.89C6677.43,-9046.22 6688.01,-9030.12 6698.2,-9014.63"/>
<polygon fill="black" stroke="black" points="6701.22,-9016.4 6703.79,-9006.12 6695.37,-9012.55 6701.22,-9016.4"/>
</g>
<!-- layer1_ffn_act_5&#45;&gt;layer1_ffn_down_5 -->
<g id="edge153" class="edge">
<title>layer1_ffn_act_5&#45;&gt;layer1_ffn_down_5</title>
<path fill="none" stroke="black" d="M6676.5,-8785.74C6676.5,-8764.18 6676.5,-8726.37 6676.5,-8695.29"/>
<polygon fill="black" stroke="black" points="6680,-8695.04 6676.5,-8685.04 6673,-8695.04 6680,-8695.04"/>
</g>
<!-- layer2_mha_qkv_5 -->
<g id="node167" class="node">
<title>layer2_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="6954.5,-8364 6398.5,-8364 6398.5,-8281 6954.5,-8281 6954.5,-8364"/>
<text text-anchor="middle" x="6676.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6676.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6676.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6676.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6676.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_res2_5&#45;&gt;layer2_mha_qkv_5 -->
<g id="edge232" class="edge">
<title>layer1_res2_5&#45;&gt;layer2_mha_qkv_5</title>
<path fill="none" stroke="black" d="M6676.5,-8464.74C6676.5,-8443.18 6676.5,-8405.37 6676.5,-8374.29"/>
<polygon fill="black" stroke="black" points="6680,-8374.04 6676.5,-8364.04 6673,-8374.04 6680,-8374.04"/>
</g>
<!-- layer1_mha_attn_6&#45;&gt;layer1_mha_out_6 -->
<g id="edge157" class="edge">
<title>layer1_mha_attn_6&#45;&gt;layer1_mha_out_6</title>
<path fill="none" stroke="black" d="M7436.5,-9531.74C7436.5,-9510.18 7436.5,-9472.37 7436.5,-9441.29"/>
<polygon fill="black" stroke="black" points="7440,-9441.04 7436.5,-9431.04 7433,-9441.04 7440,-9441.04"/>
</g>
<!-- layer1_ln1_6 -->
<g id="node159" class="node">
<title>layer1_ln1_6</title>
<polygon fill="none" stroke="black" points="7490,-9094 7383,-9094 7383,-9058 7490,-9058 7490,-9094"/>
<text text-anchor="middle" x="7436.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer1_ln1_6</text>
</g>
<!-- layer1_res1_6&#45;&gt;layer1_ln1_6 -->
<g id="edge159" class="edge">
<title>layer1_res1_6&#45;&gt;layer1_ln1_6</title>
<path fill="none" stroke="black" d="M7436.5,-9210.97C7436.5,-9185.03 7436.5,-9135.36 7436.5,-9104.33"/>
<polygon fill="black" stroke="black" points="7440,-9104.2 7436.5,-9094.2 7433,-9104.2 7440,-9104.2"/>
</g>
<!-- layer1_ln1_6&#45;&gt;layer1_ffn_gate_6 -->
<g id="edge160" class="edge">
<title>layer1_ln1_6&#45;&gt;layer1_ffn_gate_6</title>
<path fill="none" stroke="black" d="M7425.25,-9057.89C7417.57,-9046.22 7406.99,-9030.12 7396.8,-9014.63"/>
<polygon fill="black" stroke="black" points="7399.63,-9012.55 7391.21,-9006.12 7393.78,-9016.4 7399.63,-9012.55"/>
</g>
<!-- layer1_ln1_6&#45;&gt;layer1_ffn_up_6 -->
<g id="edge161" class="edge">
<title>layer1_ln1_6&#45;&gt;layer1_ffn_up_6</title>
<path fill="none" stroke="black" d="M7490.42,-9060.91C7540.98,-9047.7 7619.23,-9027.25 7690.34,-9008.66"/>
<polygon fill="black" stroke="black" points="7691.53,-9011.97 7700.32,-9006.05 7689.76,-9005.2 7691.53,-9011.97"/>
</g>
<!-- layer1_ffn_act_6&#45;&gt;layer1_ffn_down_6 -->
<g id="edge164" class="edge">
<title>layer1_ffn_act_6&#45;&gt;layer1_ffn_down_6</title>
<path fill="none" stroke="black" d="M7671.5,-8785.74C7671.5,-8764.18 7671.5,-8726.37 7671.5,-8695.29"/>
<polygon fill="black" stroke="black" points="7675,-8695.04 7671.5,-8685.04 7668,-8695.04 7675,-8695.04"/>
</g>
<!-- layer2_mha_qkv_6 -->
<g id="node168" class="node">
<title>layer2_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="7949.5,-8364 7393.5,-8364 7393.5,-8281 7949.5,-8281 7949.5,-8364"/>
<text text-anchor="middle" x="7671.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7671.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7671.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7671.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7671.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_res2_6&#45;&gt;layer2_mha_qkv_6 -->
<g id="edge243" class="edge">
<title>layer1_res2_6&#45;&gt;layer2_mha_qkv_6</title>
<path fill="none" stroke="black" d="M7671.5,-8464.74C7671.5,-8443.18 7671.5,-8405.37 7671.5,-8374.29"/>
<polygon fill="black" stroke="black" points="7675,-8374.04 7671.5,-8364.04 7668,-8374.04 7675,-8374.04"/>
</g>
<!-- layer2_mha_attn_0 -->
<g id="node207" class="node">
<title>layer2_mha_attn_0</title>
<polygon fill="none" stroke="black" points="1134,-8180 983,-8180 983,-8144 1134,-8144 1134,-8180"/>
<text text-anchor="middle" x="1058.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_0</text>
</g>
<!-- layer2_mha_qkv_0&#45;&gt;layer2_mha_attn_0 -->
<g id="edge178" class="edge">
<title>layer2_mha_qkv_0&#45;&gt;layer2_mha_attn_0</title>
<path fill="none" stroke="black" d="M1058.5,-8280.68C1058.5,-8252.24 1058.5,-8215.08 1058.5,-8190.2"/>
<polygon fill="black" stroke="black" points="1062,-8190.02 1058.5,-8180.02 1055,-8190.02 1062,-8190.02"/>
</g>
<!-- layer2_mha_attn_1 -->
<g id="node212" class="node">
<title>layer2_mha_attn_1</title>
<polygon fill="none" stroke="black" points="2465,-8180 2314,-8180 2314,-8144 2465,-8144 2465,-8180"/>
<text text-anchor="middle" x="2389.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_1</text>
</g>
<!-- layer2_mha_qkv_1&#45;&gt;layer2_mha_attn_1 -->
<g id="edge189" class="edge">
<title>layer2_mha_qkv_1&#45;&gt;layer2_mha_attn_1</title>
<path fill="none" stroke="black" d="M2389.5,-8280.68C2389.5,-8252.24 2389.5,-8215.08 2389.5,-8190.2"/>
<polygon fill="black" stroke="black" points="2393,-8190.02 2389.5,-8180.02 2386,-8190.02 2393,-8190.02"/>
</g>
<!-- layer2_mha_attn_2 -->
<g id="node217" class="node">
<title>layer2_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3422,-8180 3271,-8180 3271,-8144 3422,-8144 3422,-8180"/>
<text text-anchor="middle" x="3346.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_2</text>
</g>
<!-- layer2_mha_qkv_2&#45;&gt;layer2_mha_attn_2 -->
<g id="edge200" class="edge">
<title>layer2_mha_qkv_2&#45;&gt;layer2_mha_attn_2</title>
<path fill="none" stroke="black" d="M3346.5,-8280.68C3346.5,-8252.24 3346.5,-8215.08 3346.5,-8190.2"/>
<polygon fill="black" stroke="black" points="3350,-8190.02 3346.5,-8180.02 3343,-8190.02 3350,-8190.02"/>
</g>
<!-- layer2_mha_attn_3 -->
<g id="node222" class="node">
<title>layer2_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4772,-8180 4621,-8180 4621,-8144 4772,-8144 4772,-8180"/>
<text text-anchor="middle" x="4696.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_3</text>
</g>
<!-- layer2_mha_qkv_3&#45;&gt;layer2_mha_attn_3 -->
<g id="edge211" class="edge">
<title>layer2_mha_qkv_3&#45;&gt;layer2_mha_attn_3</title>
<path fill="none" stroke="black" d="M4696.5,-8280.68C4696.5,-8252.24 4696.5,-8215.08 4696.5,-8190.2"/>
<polygon fill="black" stroke="black" points="4700,-8190.02 4696.5,-8180.02 4693,-8190.02 4700,-8190.02"/>
</g>
<!-- layer2_mha_attn_4 -->
<g id="node227" class="node">
<title>layer2_mha_attn_4</title>
<polygon fill="none" stroke="black" points="5795,-8180 5644,-8180 5644,-8144 5795,-8144 5795,-8180"/>
<text text-anchor="middle" x="5719.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_4</text>
</g>
<!-- layer2_mha_qkv_4&#45;&gt;layer2_mha_attn_4 -->
<g id="edge222" class="edge">
<title>layer2_mha_qkv_4&#45;&gt;layer2_mha_attn_4</title>
<path fill="none" stroke="black" d="M5719.5,-8280.68C5719.5,-8252.24 5719.5,-8215.08 5719.5,-8190.2"/>
<polygon fill="black" stroke="black" points="5723,-8190.02 5719.5,-8180.02 5716,-8190.02 5723,-8190.02"/>
</g>
<!-- layer2_mha_attn_5 -->
<g id="node232" class="node">
<title>layer2_mha_attn_5</title>
<polygon fill="none" stroke="black" points="6752,-8180 6601,-8180 6601,-8144 6752,-8144 6752,-8180"/>
<text text-anchor="middle" x="6676.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_5</text>
</g>
<!-- layer2_mha_qkv_5&#45;&gt;layer2_mha_attn_5 -->
<g id="edge233" class="edge">
<title>layer2_mha_qkv_5&#45;&gt;layer2_mha_attn_5</title>
<path fill="none" stroke="black" d="M6676.5,-8280.68C6676.5,-8252.24 6676.5,-8215.08 6676.5,-8190.2"/>
<polygon fill="black" stroke="black" points="6680,-8190.02 6676.5,-8180.02 6673,-8190.02 6680,-8190.02"/>
</g>
<!-- layer2_mha_attn_6 -->
<g id="node237" class="node">
<title>layer2_mha_attn_6</title>
<polygon fill="none" stroke="black" points="7747,-8180 7596,-8180 7596,-8144 7747,-8144 7747,-8180"/>
<text text-anchor="middle" x="7671.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer2_mha_attn_6</text>
</g>
<!-- layer2_mha_qkv_6&#45;&gt;layer2_mha_attn_6 -->
<g id="edge244" class="edge">
<title>layer2_mha_qkv_6&#45;&gt;layer2_mha_attn_6</title>
<path fill="none" stroke="black" d="M7671.5,-8280.68C7671.5,-8252.24 7671.5,-8215.08 7671.5,-8190.2"/>
<polygon fill="black" stroke="black" points="7675,-8190.02 7671.5,-8180.02 7668,-8190.02 7675,-8190.02"/>
</g>
<!-- layer2_mha_attn_7 -->
<g id="node170" class="node">
<title>layer2_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9151.31,-8245 8392.81,-8245 8197.69,-8079 8956.19,-8079 9151.31,-8245"/>
<text text-anchor="middle" x="8674.5" y="-8188.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="8674.5" y="-8173.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="8674.5" y="-8158.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8674.5" y="-8143.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-8128.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_mha_qkv_7&#45;&gt;layer2_mha_attn_7 -->
<g id="edge255" class="edge">
<title>layer2_mha_qkv_7&#45;&gt;layer2_mha_attn_7</title>
<path fill="none" stroke="black" d="M8674.5,-8280.68C8674.5,-8272.75 8674.5,-8264.14 8674.5,-8255.31"/>
<polygon fill="black" stroke="black" points="8678,-8255.27 8674.5,-8245.27 8671,-8255.27 8678,-8255.27"/>
</g>
<!-- layer2_mha_out_7 -->
<g id="node178" class="node">
<title>layer2_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="8893.5,-8043 8455.5,-8043 8455.5,-7960 8893.5,-7960 8893.5,-8043"/>
<text text-anchor="middle" x="8674.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8674.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8674.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8674.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_mha_attn_7&#45;&gt;layer2_mha_out_7 -->
<g id="edge256" class="edge">
<title>layer2_mha_attn_7&#45;&gt;layer2_mha_out_7</title>
<path fill="none" stroke="black" d="M8674.5,-8078.96C8674.5,-8070.25 8674.5,-8061.59 8674.5,-8053.39"/>
<polygon fill="black" stroke="black" points="8678,-8053.29 8674.5,-8043.29 8671,-8053.29 8678,-8053.29"/>
</g>
<!-- layer2_mha_out_0 -->
<g id="node171" class="node">
<title>layer2_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="1277.5,-8043 839.5,-8043 839.5,-7960 1277.5,-7960 1277.5,-8043"/>
<text text-anchor="middle" x="1058.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="1058.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1058.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1058.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1058.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_res1_0 -->
<g id="node208" class="node">
<title>layer2_res1_0</title>
<polygon fill="none" stroke="black" points="1116.5,-7859 1000.5,-7859 1000.5,-7823 1116.5,-7823 1116.5,-7859"/>
<text text-anchor="middle" x="1058.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_0</text>
</g>
<!-- layer2_mha_out_0&#45;&gt;layer2_res1_0 -->
<g id="edge180" class="edge">
<title>layer2_mha_out_0&#45;&gt;layer2_res1_0</title>
<path fill="none" stroke="black" d="M1058.5,-7959.68C1058.5,-7931.24 1058.5,-7894.08 1058.5,-7869.2"/>
<polygon fill="black" stroke="black" points="1062,-7869.02 1058.5,-7859.02 1055,-7869.02 1062,-7869.02"/>
</g>
<!-- layer2_mha_out_1 -->
<g id="node172" class="node">
<title>layer2_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2608.5,-8043 2170.5,-8043 2170.5,-7960 2608.5,-7960 2608.5,-8043"/>
<text text-anchor="middle" x="2389.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="2389.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2389.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2389.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2389.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_res1_1 -->
<g id="node213" class="node">
<title>layer2_res1_1</title>
<polygon fill="none" stroke="black" points="2447.5,-7859 2331.5,-7859 2331.5,-7823 2447.5,-7823 2447.5,-7859"/>
<text text-anchor="middle" x="2389.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_1</text>
</g>
<!-- layer2_mha_out_1&#45;&gt;layer2_res1_1 -->
<g id="edge191" class="edge">
<title>layer2_mha_out_1&#45;&gt;layer2_res1_1</title>
<path fill="none" stroke="black" d="M2389.5,-7959.68C2389.5,-7931.24 2389.5,-7894.08 2389.5,-7869.2"/>
<polygon fill="black" stroke="black" points="2393,-7869.02 2389.5,-7859.02 2386,-7869.02 2393,-7869.02"/>
</g>
<!-- layer2_mha_out_2 -->
<g id="node173" class="node">
<title>layer2_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3565.5,-8043 3127.5,-8043 3127.5,-7960 3565.5,-7960 3565.5,-8043"/>
<text text-anchor="middle" x="3346.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3346.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3346.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3346.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3346.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_res1_2 -->
<g id="node218" class="node">
<title>layer2_res1_2</title>
<polygon fill="none" stroke="black" points="3404.5,-7859 3288.5,-7859 3288.5,-7823 3404.5,-7823 3404.5,-7859"/>
<text text-anchor="middle" x="3346.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_2</text>
</g>
<!-- layer2_mha_out_2&#45;&gt;layer2_res1_2 -->
<g id="edge202" class="edge">
<title>layer2_mha_out_2&#45;&gt;layer2_res1_2</title>
<path fill="none" stroke="black" d="M3346.5,-7959.68C3346.5,-7931.24 3346.5,-7894.08 3346.5,-7869.2"/>
<polygon fill="black" stroke="black" points="3350,-7869.02 3346.5,-7859.02 3343,-7869.02 3350,-7869.02"/>
</g>
<!-- layer2_mha_out_3 -->
<g id="node174" class="node">
<title>layer2_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4915.5,-8043 4477.5,-8043 4477.5,-7960 4915.5,-7960 4915.5,-8043"/>
<text text-anchor="middle" x="4696.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4696.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4696.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4696.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4696.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_res1_3 -->
<g id="node223" class="node">
<title>layer2_res1_3</title>
<polygon fill="none" stroke="black" points="4754.5,-7859 4638.5,-7859 4638.5,-7823 4754.5,-7823 4754.5,-7859"/>
<text text-anchor="middle" x="4696.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_3</text>
</g>
<!-- layer2_mha_out_3&#45;&gt;layer2_res1_3 -->
<g id="edge213" class="edge">
<title>layer2_mha_out_3&#45;&gt;layer2_res1_3</title>
<path fill="none" stroke="black" d="M4696.5,-7959.68C4696.5,-7931.24 4696.5,-7894.08 4696.5,-7869.2"/>
<polygon fill="black" stroke="black" points="4700,-7869.02 4696.5,-7859.02 4693,-7869.02 4700,-7869.02"/>
</g>
<!-- layer2_mha_out_4 -->
<g id="node175" class="node">
<title>layer2_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="5938.5,-8043 5500.5,-8043 5500.5,-7960 5938.5,-7960 5938.5,-8043"/>
<text text-anchor="middle" x="5719.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="5719.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5719.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5719.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5719.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_res1_4 -->
<g id="node228" class="node">
<title>layer2_res1_4</title>
<polygon fill="none" stroke="black" points="5777.5,-7859 5661.5,-7859 5661.5,-7823 5777.5,-7823 5777.5,-7859"/>
<text text-anchor="middle" x="5719.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_4</text>
</g>
<!-- layer2_mha_out_4&#45;&gt;layer2_res1_4 -->
<g id="edge224" class="edge">
<title>layer2_mha_out_4&#45;&gt;layer2_res1_4</title>
<path fill="none" stroke="black" d="M5719.5,-7959.68C5719.5,-7931.24 5719.5,-7894.08 5719.5,-7869.2"/>
<polygon fill="black" stroke="black" points="5723,-7869.02 5719.5,-7859.02 5716,-7869.02 5723,-7869.02"/>
</g>
<!-- layer2_mha_out_5 -->
<g id="node176" class="node">
<title>layer2_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="6895.5,-8043 6457.5,-8043 6457.5,-7960 6895.5,-7960 6895.5,-8043"/>
<text text-anchor="middle" x="6676.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6676.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6676.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6676.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6676.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_res1_5 -->
<g id="node233" class="node">
<title>layer2_res1_5</title>
<polygon fill="none" stroke="black" points="6734.5,-7859 6618.5,-7859 6618.5,-7823 6734.5,-7823 6734.5,-7859"/>
<text text-anchor="middle" x="6676.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_5</text>
</g>
<!-- layer2_mha_out_5&#45;&gt;layer2_res1_5 -->
<g id="edge235" class="edge">
<title>layer2_mha_out_5&#45;&gt;layer2_res1_5</title>
<path fill="none" stroke="black" d="M6676.5,-7959.68C6676.5,-7931.24 6676.5,-7894.08 6676.5,-7869.2"/>
<polygon fill="black" stroke="black" points="6680,-7869.02 6676.5,-7859.02 6673,-7869.02 6680,-7869.02"/>
</g>
<!-- layer2_mha_out_6 -->
<g id="node177" class="node">
<title>layer2_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="7890.5,-8043 7452.5,-8043 7452.5,-7960 7890.5,-7960 7890.5,-8043"/>
<text text-anchor="middle" x="7671.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7671.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7671.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7671.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7671.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_res1_6 -->
<g id="node238" class="node">
<title>layer2_res1_6</title>
<polygon fill="none" stroke="black" points="7729.5,-7859 7613.5,-7859 7613.5,-7823 7729.5,-7823 7729.5,-7859"/>
<text text-anchor="middle" x="7671.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer2_res1_6</text>
</g>
<!-- layer2_mha_out_6&#45;&gt;layer2_res1_6 -->
<g id="edge246" class="edge">
<title>layer2_mha_out_6&#45;&gt;layer2_res1_6</title>
<path fill="none" stroke="black" d="M7671.5,-7959.68C7671.5,-7931.24 7671.5,-7894.08 7671.5,-7869.2"/>
<polygon fill="black" stroke="black" points="7675,-7869.02 7671.5,-7859.02 7668,-7869.02 7675,-7869.02"/>
</g>
<!-- layer2_res1_7 -->
<g id="node179" class="node">
<title>layer2_res1_7</title>
<polygon fill="none" stroke="black" points="9115.24,-7924 8414.12,-7924 8233.76,-7758 8934.88,-7758 9115.24,-7924"/>
<text text-anchor="middle" x="8674.5" y="-7867.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8674.5" y="-7852.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-7837.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-7822.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-7807.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_mha_out_7&#45;&gt;layer2_res1_7 -->
<g id="edge257" class="edge">
<title>layer2_mha_out_7&#45;&gt;layer2_res1_7</title>
<path fill="none" stroke="black" d="M8674.5,-7959.68C8674.5,-7951.75 8674.5,-7943.14 8674.5,-7934.31"/>
<polygon fill="black" stroke="black" points="8678,-7934.27 8674.5,-7924.27 8671,-7934.27 8678,-7934.27"/>
</g>
<!-- layer2_ln1_7 -->
<g id="node180" class="node">
<title>layer2_ln1_7</title>
<polygon fill="yellow" stroke="black" points="8887,-7722 8462,-7722 8462,-7654 8887,-7654 8887,-7722"/>
<text text-anchor="middle" x="8674.5" y="-7706.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="8674.5" y="-7691.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-7676.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8674.5" y="-7661.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_res1_7&#45;&gt;layer2_ln1_7 -->
<g id="edge258" class="edge">
<title>layer2_res1_7&#45;&gt;layer2_ln1_7</title>
<path fill="none" stroke="black" d="M8674.5,-7757.87C8674.5,-7749.12 8674.5,-7740.48 8674.5,-7732.45"/>
<polygon fill="black" stroke="black" points="8678,-7732.26 8674.5,-7722.26 8671,-7732.26 8678,-7732.26"/>
</g>
<!-- layer2_ffn_gate_7 -->
<g id="node188" class="node">
<title>layer2_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="8885,-7618 8412,-7618 8412,-7535 8885,-7535 8885,-7618"/>
<text text-anchor="middle" x="8648.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8648.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8648.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8648.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8648.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_ln1_7&#45;&gt;layer2_ffn_gate_7 -->
<g id="edge259" class="edge">
<title>layer2_ln1_7&#45;&gt;layer2_ffn_gate_7</title>
<path fill="none" stroke="black" d="M8666.63,-7653.85C8664.7,-7645.71 8662.58,-7636.81 8660.5,-7628.05"/>
<polygon fill="black" stroke="black" points="8663.9,-7627.2 8658.18,-7618.28 8657.09,-7628.82 8663.9,-7627.2"/>
</g>
<!-- layer2_ffn_up_7 -->
<g id="node196" class="node">
<title>layer2_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9376,-7618 8903,-7618 8903,-7535 9376,-7535 9376,-7618"/>
<text text-anchor="middle" x="9139.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9139.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9139.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9139.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9139.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_ln1_7&#45;&gt;layer2_ffn_up_7 -->
<g id="edge260" class="edge">
<title>layer2_ln1_7&#45;&gt;layer2_ffn_up_7</title>
<path fill="none" stroke="black" d="M8814.65,-7654C8859.55,-7643.42 8909.95,-7631.56 8957.4,-7620.38"/>
<polygon fill="black" stroke="black" points="8958.23,-7623.78 8967.16,-7618.08 8956.63,-7616.97 8958.23,-7623.78"/>
</g>
<!-- layer2_ffn_gate_0 -->
<g id="node181" class="node">
<title>layer2_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="1060,-7618 587,-7618 587,-7535 1060,-7535 1060,-7618"/>
<text text-anchor="middle" x="823.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="823.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="823.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="823.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="823.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_ffn_act_0 -->
<g id="node210" class="node">
<title>layer2_ffn_act_0</title>
<polygon fill="none" stroke="black" points="1199,-7434 1068,-7434 1068,-7398 1199,-7398 1199,-7434"/>
<text text-anchor="middle" x="1133.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_0</text>
</g>
<!-- layer2_ffn_gate_0&#45;&gt;layer2_ffn_act_0 -->
<g id="edge184" class="edge">
<title>layer2_ffn_gate_0&#45;&gt;layer2_ffn_act_0</title>
<path fill="none" stroke="black" d="M902.93,-7534.89C962.93,-7504.21 1042.92,-7463.31 1091.19,-7438.63"/>
<polygon fill="black" stroke="black" points="1092.8,-7441.74 1100.12,-7434.07 1089.62,-7435.51 1092.8,-7441.74"/>
</g>
<!-- layer2_ffn_gate_1 -->
<g id="node182" class="node">
<title>layer2_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="2145,-7618 1672,-7618 1672,-7535 2145,-7535 2145,-7618"/>
<text text-anchor="middle" x="1908.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1908.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1908.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1908.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1908.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_ffn_act_1 -->
<g id="node215" class="node">
<title>layer2_ffn_act_1</title>
<polygon fill="none" stroke="black" points="2313,-7434 2182,-7434 2182,-7398 2313,-7398 2313,-7434"/>
<text text-anchor="middle" x="2247.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_1</text>
</g>
<!-- layer2_ffn_gate_1&#45;&gt;layer2_ffn_act_1 -->
<g id="edge195" class="edge">
<title>layer2_ffn_gate_1&#45;&gt;layer2_ffn_act_1</title>
<path fill="none" stroke="black" d="M1995.36,-7534.89C2061.24,-7504.08 2149.18,-7462.97 2201.89,-7438.32"/>
<polygon fill="black" stroke="black" points="2203.42,-7441.48 2210.99,-7434.07 2200.45,-7435.13 2203.42,-7441.48"/>
</g>
<!-- layer2_ffn_gate_2 -->
<g id="node183" class="node">
<title>layer2_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3287,-7618 2814,-7618 2814,-7535 3287,-7535 3287,-7618"/>
<text text-anchor="middle" x="3050.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3050.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3050.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3050.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3050.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_ffn_act_2 -->
<g id="node220" class="node">
<title>layer2_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3389,-7434 3258,-7434 3258,-7398 3389,-7398 3389,-7434"/>
<text text-anchor="middle" x="3323.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_2</text>
</g>
<!-- layer2_ffn_gate_2&#45;&gt;layer2_ffn_act_2 -->
<g id="edge206" class="edge">
<title>layer2_ffn_gate_2&#45;&gt;layer2_ffn_act_2</title>
<path fill="none" stroke="black" d="M3120.45,-7534.89C3172.96,-7504.4 3242.86,-7463.82 3285.44,-7439.1"/>
<polygon fill="black" stroke="black" points="3287.21,-7442.12 3294.1,-7434.07 3283.69,-7436.06 3287.21,-7442.12"/>
</g>
<!-- layer2_ffn_gate_3 -->
<g id="node184" class="node">
<title>layer2_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4907,-7618 4434,-7618 4434,-7535 4907,-7535 4907,-7618"/>
<text text-anchor="middle" x="4670.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4670.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4670.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4670.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4670.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_ffn_act_3 -->
<g id="node225" class="node">
<title>layer2_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4743,-7434 4612,-7434 4612,-7398 4743,-7398 4743,-7434"/>
<text text-anchor="middle" x="4677.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_3</text>
</g>
<!-- layer2_ffn_gate_3&#45;&gt;layer2_ffn_act_3 -->
<g id="edge217" class="edge">
<title>layer2_ffn_gate_3&#45;&gt;layer2_ffn_act_3</title>
<path fill="none" stroke="black" d="M4672.3,-7534.68C4673.56,-7506.24 4675.2,-7469.08 4676.3,-7444.2"/>
<polygon fill="black" stroke="black" points="4679.8,-7444.17 4676.75,-7434.02 4672.81,-7443.86 4679.8,-7444.17"/>
</g>
<!-- layer2_ffn_gate_4 -->
<g id="node185" class="node">
<title>layer2_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5918,-7618 5445,-7618 5445,-7535 5918,-7535 5918,-7618"/>
<text text-anchor="middle" x="5681.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5681.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5681.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5681.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5681.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_ffn_act_4 -->
<g id="node230" class="node">
<title>layer2_ffn_act_4</title>
<polygon fill="none" stroke="black" points="5798,-7434 5667,-7434 5667,-7398 5798,-7398 5798,-7434"/>
<text text-anchor="middle" x="5732.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_4</text>
</g>
<!-- layer2_ffn_gate_4&#45;&gt;layer2_ffn_act_4 -->
<g id="edge228" class="edge">
<title>layer2_ffn_gate_4&#45;&gt;layer2_ffn_act_4</title>
<path fill="none" stroke="black" d="M5694.63,-7534.68C5703.83,-7506.11 5715.85,-7468.74 5723.86,-7443.86"/>
<polygon fill="black" stroke="black" points="5727.29,-7444.61 5727.02,-7434.02 5720.63,-7442.47 5727.29,-7444.61"/>
</g>
<!-- layer2_ffn_gate_5 -->
<g id="node186" class="node">
<title>layer2_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6904,-7618 6431,-7618 6431,-7535 6904,-7535 6904,-7618"/>
<text text-anchor="middle" x="6667.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6667.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6667.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6667.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6667.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_ffn_act_5 -->
<g id="node235" class="node">
<title>layer2_ffn_act_5</title>
<polygon fill="none" stroke="black" points="6733,-7434 6602,-7434 6602,-7398 6733,-7398 6733,-7434"/>
<text text-anchor="middle" x="6667.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_5</text>
</g>
<!-- layer2_ffn_gate_5&#45;&gt;layer2_ffn_act_5 -->
<g id="edge239" class="edge">
<title>layer2_ffn_gate_5&#45;&gt;layer2_ffn_act_5</title>
<path fill="none" stroke="black" d="M6667.5,-7534.68C6667.5,-7506.24 6667.5,-7469.08 6667.5,-7444.2"/>
<polygon fill="black" stroke="black" points="6671,-7444.02 6667.5,-7434.02 6664,-7444.02 6671,-7444.02"/>
</g>
<!-- layer2_ffn_gate_6 -->
<g id="node187" class="node">
<title>layer2_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="7896,-7618 7423,-7618 7423,-7535 7896,-7535 7896,-7618"/>
<text text-anchor="middle" x="7659.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7659.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7659.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7659.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7659.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_ffn_act_6 -->
<g id="node240" class="node">
<title>layer2_ffn_act_6</title>
<polygon fill="none" stroke="black" points="7949,-7434 7818,-7434 7818,-7398 7949,-7398 7949,-7434"/>
<text text-anchor="middle" x="7883.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer2_ffn_act_6</text>
</g>
<!-- layer2_ffn_gate_6&#45;&gt;layer2_ffn_act_6 -->
<g id="edge250" class="edge">
<title>layer2_ffn_gate_6&#45;&gt;layer2_ffn_act_6</title>
<path fill="none" stroke="black" d="M7716.89,-7534.89C7759.44,-7504.79 7815.89,-7464.84 7850.95,-7440.03"/>
<polygon fill="black" stroke="black" points="7853.24,-7442.7 7859.38,-7434.07 7849.19,-7436.99 7853.24,-7442.7"/>
</g>
<!-- layer2_ffn_act_7 -->
<g id="node197" class="node">
<title>layer2_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9135.24,-7499 8378.44,-7499 8183.76,-7333 8940.56,-7333 9135.24,-7499"/>
<text text-anchor="middle" x="8659.5" y="-7442.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="8659.5" y="-7427.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="8659.5" y="-7412.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8659.5" y="-7397.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8659.5" y="-7382.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_ffn_gate_7&#45;&gt;layer2_ffn_act_7 -->
<g id="edge261" class="edge">
<title>layer2_ffn_gate_7&#45;&gt;layer2_ffn_act_7</title>
<path fill="none" stroke="black" d="M8651.33,-7534.68C8651.88,-7526.75 8652.48,-7518.14 8653.09,-7509.31"/>
<polygon fill="black" stroke="black" points="8656.59,-7509.49 8653.79,-7499.27 8649.61,-7509.01 8656.59,-7509.49"/>
</g>
<!-- layer2_ffn_up_0 -->
<g id="node189" class="node">
<title>layer2_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="1551,-7618 1078,-7618 1078,-7535 1551,-7535 1551,-7618"/>
<text text-anchor="middle" x="1314.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1314.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1314.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1314.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1314.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_ffn_up_0&#45;&gt;layer2_ffn_act_0 -->
<g id="edge185" class="edge">
<title>layer2_ffn_up_0&#45;&gt;layer2_ffn_act_0</title>
<path fill="none" stroke="black" d="M1267.89,-7534.68C1233.95,-7504.96 1189.15,-7465.73 1160.82,-7440.92"/>
<polygon fill="black" stroke="black" points="1162.77,-7437.98 1152.94,-7434.02 1158.16,-7443.24 1162.77,-7437.98"/>
</g>
<!-- layer2_ffn_up_1 -->
<g id="node190" class="node">
<title>layer2_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2636,-7618 2163,-7618 2163,-7535 2636,-7535 2636,-7618"/>
<text text-anchor="middle" x="2399.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2399.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2399.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2399.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2399.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_ffn_up_1&#45;&gt;layer2_ffn_act_1 -->
<g id="edge196" class="edge">
<title>layer2_ffn_up_1&#45;&gt;layer2_ffn_act_1</title>
<path fill="none" stroke="black" d="M2360.36,-7534.68C2331.98,-7505.09 2294.55,-7466.06 2270.75,-7441.24"/>
<polygon fill="black" stroke="black" points="2273.27,-7438.82 2263.83,-7434.02 2268.22,-7443.66 2273.27,-7438.82"/>
</g>
<!-- layer2_ffn_up_2 -->
<g id="node191" class="node">
<title>layer2_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="3778,-7618 3305,-7618 3305,-7535 3778,-7535 3778,-7618"/>
<text text-anchor="middle" x="3541.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3541.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3541.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3541.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3541.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_ffn_up_2&#45;&gt;layer2_ffn_act_2 -->
<g id="edge207" class="edge">
<title>layer2_ffn_up_2&#45;&gt;layer2_ffn_act_2</title>
<path fill="none" stroke="black" d="M3485.64,-7534.89C3444.24,-7504.79 3389.3,-7464.84 3355.18,-7440.03"/>
<polygon fill="black" stroke="black" points="3357.12,-7437.12 3346.98,-7434.07 3353.01,-7442.78 3357.12,-7437.12"/>
</g>
<!-- layer2_ffn_up_3 -->
<g id="node192" class="node">
<title>layer2_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="5398,-7618 4925,-7618 4925,-7535 5398,-7535 5398,-7618"/>
<text text-anchor="middle" x="5161.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5161.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="5161.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5161.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5161.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_ffn_up_3&#45;&gt;layer2_ffn_act_3 -->
<g id="edge218" class="edge">
<title>layer2_ffn_up_3&#45;&gt;layer2_ffn_act_3</title>
<path fill="none" stroke="black" d="M5037.8,-7534.99C4942.38,-7503.74 4814.41,-7461.83 4739.46,-7437.29"/>
<polygon fill="black" stroke="black" points="4740.29,-7433.88 4729.69,-7434.09 4738.11,-7440.53 4740.29,-7433.88"/>
</g>
<!-- layer2_ffn_up_4 -->
<g id="node193" class="node">
<title>layer2_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="6409,-7618 5936,-7618 5936,-7535 6409,-7535 6409,-7618"/>
<text text-anchor="middle" x="6172.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6172.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6172.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6172.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6172.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_ffn_up_4&#45;&gt;layer2_ffn_act_4 -->
<g id="edge229" class="edge">
<title>layer2_ffn_up_4&#45;&gt;layer2_ffn_act_4</title>
<path fill="none" stroke="black" d="M6060.05,-7534.99C5973.65,-7503.87 5857.91,-7462.18 5789.66,-7437.59"/>
<polygon fill="black" stroke="black" points="5790.54,-7434.19 5779.95,-7434.09 5788.17,-7440.77 5790.54,-7434.19"/>
</g>
<!-- layer2_ffn_up_5 -->
<g id="node194" class="node">
<title>layer2_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="7395,-7618 6922,-7618 6922,-7535 7395,-7535 7395,-7618"/>
<text text-anchor="middle" x="7158.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7158.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7158.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7158.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7158.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_ffn_up_5&#45;&gt;layer2_ffn_act_5 -->
<g id="edge240" class="edge">
<title>layer2_ffn_up_5&#45;&gt;layer2_ffn_act_5</title>
<path fill="none" stroke="black" d="M7033.01,-7534.99C6936.21,-7503.74 6806.39,-7461.83 6730.36,-7437.29"/>
<polygon fill="black" stroke="black" points="6731.04,-7433.83 6720.45,-7434.09 6728.89,-7440.5 6731.04,-7433.83"/>
</g>
<!-- layer2_ffn_up_6 -->
<g id="node195" class="node">
<title>layer2_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8387,-7618 7914,-7618 7914,-7535 8387,-7535 8387,-7618"/>
<text text-anchor="middle" x="8150.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8150.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8150.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8150.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8150.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_ffn_up_6&#45;&gt;layer2_ffn_act_6 -->
<g id="edge251" class="edge">
<title>layer2_ffn_up_6&#45;&gt;layer2_ffn_act_6</title>
<path fill="none" stroke="black" d="M8082.09,-7534.89C8030.84,-7504.47 7962.66,-7463.99 7920.98,-7439.25"/>
<polygon fill="black" stroke="black" points="7922.64,-7436.16 7912.25,-7434.07 7919.07,-7442.18 7922.64,-7436.16"/>
</g>
<!-- layer2_ffn_up_7&#45;&gt;layer2_ffn_act_7 -->
<g id="edge262" class="edge">
<title>layer2_ffn_up_7&#45;&gt;layer2_ffn_act_7</title>
<path fill="none" stroke="black" d="M9016.82,-7534.99C8986.23,-7524.89 8952.26,-7513.67 8917.79,-7502.29"/>
<polygon fill="black" stroke="black" points="8918.65,-7498.89 8908.05,-7499.07 8916.45,-7505.53 8918.65,-7498.89"/>
</g>
<!-- layer2_ffn_down_7 -->
<g id="node205" class="node">
<title>layer2_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="8883,-7297 8436,-7297 8436,-7214 8883,-7214 8883,-7297"/>
<text text-anchor="middle" x="8659.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8659.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8659.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8659.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8659.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_ffn_act_7&#45;&gt;layer2_ffn_down_7 -->
<g id="edge263" class="edge">
<title>layer2_ffn_act_7&#45;&gt;layer2_ffn_down_7</title>
<path fill="none" stroke="black" d="M8659.5,-7332.96C8659.5,-7324.25 8659.5,-7315.59 8659.5,-7307.39"/>
<polygon fill="black" stroke="black" points="8663,-7307.29 8659.5,-7297.29 8656,-7307.29 8663,-7307.29"/>
</g>
<!-- layer2_ffn_down_0 -->
<g id="node198" class="node">
<title>layer2_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="1357,-7297 910,-7297 910,-7214 1357,-7214 1357,-7297"/>
<text text-anchor="middle" x="1133.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1133.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1133.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1133.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1133.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_res2_0 -->
<g id="node211" class="node">
<title>layer2_res2_0</title>
<polygon fill="none" stroke="black" points="1191.5,-7113 1075.5,-7113 1075.5,-7077 1191.5,-7077 1191.5,-7113"/>
<text text-anchor="middle" x="1133.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_0</text>
</g>
<!-- layer2_ffn_down_0&#45;&gt;layer2_res2_0 -->
<g id="edge187" class="edge">
<title>layer2_ffn_down_0&#45;&gt;layer2_res2_0</title>
<path fill="none" stroke="black" d="M1133.5,-7213.68C1133.5,-7185.24 1133.5,-7148.08 1133.5,-7123.2"/>
<polygon fill="black" stroke="black" points="1137,-7123.02 1133.5,-7113.02 1130,-7123.02 1137,-7123.02"/>
</g>
<!-- layer2_ffn_down_1 -->
<g id="node199" class="node">
<title>layer2_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="2471,-7297 2024,-7297 2024,-7214 2471,-7214 2471,-7297"/>
<text text-anchor="middle" x="2247.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2247.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2247.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2247.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2247.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_res2_1 -->
<g id="node216" class="node">
<title>layer2_res2_1</title>
<polygon fill="none" stroke="black" points="2305.5,-7113 2189.5,-7113 2189.5,-7077 2305.5,-7077 2305.5,-7113"/>
<text text-anchor="middle" x="2247.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_1</text>
</g>
<!-- layer2_ffn_down_1&#45;&gt;layer2_res2_1 -->
<g id="edge198" class="edge">
<title>layer2_ffn_down_1&#45;&gt;layer2_res2_1</title>
<path fill="none" stroke="black" d="M2247.5,-7213.68C2247.5,-7185.24 2247.5,-7148.08 2247.5,-7123.2"/>
<polygon fill="black" stroke="black" points="2251,-7123.02 2247.5,-7113.02 2244,-7123.02 2251,-7123.02"/>
</g>
<!-- layer2_ffn_down_2 -->
<g id="node200" class="node">
<title>layer2_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3547,-7297 3100,-7297 3100,-7214 3547,-7214 3547,-7297"/>
<text text-anchor="middle" x="3323.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3323.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3323.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3323.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3323.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_res2_2 -->
<g id="node221" class="node">
<title>layer2_res2_2</title>
<polygon fill="none" stroke="black" points="3381.5,-7113 3265.5,-7113 3265.5,-7077 3381.5,-7077 3381.5,-7113"/>
<text text-anchor="middle" x="3323.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_2</text>
</g>
<!-- layer2_ffn_down_2&#45;&gt;layer2_res2_2 -->
<g id="edge209" class="edge">
<title>layer2_ffn_down_2&#45;&gt;layer2_res2_2</title>
<path fill="none" stroke="black" d="M3323.5,-7213.68C3323.5,-7185.24 3323.5,-7148.08 3323.5,-7123.2"/>
<polygon fill="black" stroke="black" points="3327,-7123.02 3323.5,-7113.02 3320,-7123.02 3327,-7123.02"/>
</g>
<!-- layer2_ffn_down_3 -->
<g id="node201" class="node">
<title>layer2_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4901,-7297 4454,-7297 4454,-7214 4901,-7214 4901,-7297"/>
<text text-anchor="middle" x="4677.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4677.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4677.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4677.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4677.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_res2_3 -->
<g id="node226" class="node">
<title>layer2_res2_3</title>
<polygon fill="none" stroke="black" points="4735.5,-7113 4619.5,-7113 4619.5,-7077 4735.5,-7077 4735.5,-7113"/>
<text text-anchor="middle" x="4677.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_3</text>
</g>
<!-- layer2_ffn_down_3&#45;&gt;layer2_res2_3 -->
<g id="edge220" class="edge">
<title>layer2_ffn_down_3&#45;&gt;layer2_res2_3</title>
<path fill="none" stroke="black" d="M4677.5,-7213.68C4677.5,-7185.24 4677.5,-7148.08 4677.5,-7123.2"/>
<polygon fill="black" stroke="black" points="4681,-7123.02 4677.5,-7113.02 4674,-7123.02 4681,-7123.02"/>
</g>
<!-- layer2_ffn_down_4 -->
<g id="node202" class="node">
<title>layer2_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="5956,-7297 5509,-7297 5509,-7214 5956,-7214 5956,-7297"/>
<text text-anchor="middle" x="5732.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5732.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5732.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5732.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5732.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_res2_4 -->
<g id="node231" class="node">
<title>layer2_res2_4</title>
<polygon fill="none" stroke="black" points="5790.5,-7113 5674.5,-7113 5674.5,-7077 5790.5,-7077 5790.5,-7113"/>
<text text-anchor="middle" x="5732.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_4</text>
</g>
<!-- layer2_ffn_down_4&#45;&gt;layer2_res2_4 -->
<g id="edge231" class="edge">
<title>layer2_ffn_down_4&#45;&gt;layer2_res2_4</title>
<path fill="none" stroke="black" d="M5732.5,-7213.68C5732.5,-7185.24 5732.5,-7148.08 5732.5,-7123.2"/>
<polygon fill="black" stroke="black" points="5736,-7123.02 5732.5,-7113.02 5729,-7123.02 5736,-7123.02"/>
</g>
<!-- layer2_ffn_down_5 -->
<g id="node203" class="node">
<title>layer2_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="6891,-7297 6444,-7297 6444,-7214 6891,-7214 6891,-7297"/>
<text text-anchor="middle" x="6667.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6667.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6667.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6667.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6667.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_res2_5 -->
<g id="node236" class="node">
<title>layer2_res2_5</title>
<polygon fill="none" stroke="black" points="6725.5,-7113 6609.5,-7113 6609.5,-7077 6725.5,-7077 6725.5,-7113"/>
<text text-anchor="middle" x="6667.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_5</text>
</g>
<!-- layer2_ffn_down_5&#45;&gt;layer2_res2_5 -->
<g id="edge242" class="edge">
<title>layer2_ffn_down_5&#45;&gt;layer2_res2_5</title>
<path fill="none" stroke="black" d="M6667.5,-7213.68C6667.5,-7185.24 6667.5,-7148.08 6667.5,-7123.2"/>
<polygon fill="black" stroke="black" points="6671,-7123.02 6667.5,-7113.02 6664,-7123.02 6671,-7123.02"/>
</g>
<!-- layer2_ffn_down_6 -->
<g id="node204" class="node">
<title>layer2_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="8107,-7297 7660,-7297 7660,-7214 8107,-7214 8107,-7297"/>
<text text-anchor="middle" x="7883.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7883.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7883.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7883.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7883.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_res2_6 -->
<g id="node241" class="node">
<title>layer2_res2_6</title>
<polygon fill="none" stroke="black" points="7941.5,-7113 7825.5,-7113 7825.5,-7077 7941.5,-7077 7941.5,-7113"/>
<text text-anchor="middle" x="7883.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer2_res2_6</text>
</g>
<!-- layer2_ffn_down_6&#45;&gt;layer2_res2_6 -->
<g id="edge253" class="edge">
<title>layer2_ffn_down_6&#45;&gt;layer2_res2_6</title>
<path fill="none" stroke="black" d="M7883.5,-7213.68C7883.5,-7185.24 7883.5,-7148.08 7883.5,-7123.2"/>
<polygon fill="black" stroke="black" points="7887,-7123.02 7883.5,-7113.02 7880,-7123.02 7887,-7123.02"/>
</g>
<!-- layer2_res2_7 -->
<g id="node206" class="node">
<title>layer2_res2_7</title>
<polygon fill="none" stroke="black" points="9100.24,-7178 8399.12,-7178 8218.76,-7012 8919.88,-7012 9100.24,-7178"/>
<text text-anchor="middle" x="8659.5" y="-7121.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8659.5" y="-7106.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-7091.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-7076.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-7061.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_ffn_down_7&#45;&gt;layer2_res2_7 -->
<g id="edge264" class="edge">
<title>layer2_ffn_down_7&#45;&gt;layer2_res2_7</title>
<path fill="none" stroke="black" d="M8659.5,-7213.68C8659.5,-7205.75 8659.5,-7197.14 8659.5,-7188.31"/>
<polygon fill="black" stroke="black" points="8663,-7188.27 8659.5,-7178.27 8656,-7188.27 8663,-7188.27"/>
</g>
<!-- layer3_mha_qkv_7 -->
<g id="node249" class="node">
<title>layer3_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="8937.5,-6976 8381.5,-6976 8381.5,-6893 8937.5,-6893 8937.5,-6976"/>
<text text-anchor="middle" x="8659.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8659.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8659.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8659.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_res2_7&#45;&gt;layer3_mha_qkv_7 -->
<g id="edge342" class="edge">
<title>layer2_res2_7&#45;&gt;layer3_mha_qkv_7</title>
<path fill="none" stroke="black" d="M8659.5,-7011.96C8659.5,-7003.25 8659.5,-6994.59 8659.5,-6986.39"/>
<polygon fill="black" stroke="black" points="8663,-6986.29 8659.5,-6976.29 8656,-6986.29 8663,-6986.29"/>
</g>
<!-- layer2_mha_attn_0&#45;&gt;layer2_mha_out_0 -->
<g id="edge179" class="edge">
<title>layer2_mha_attn_0&#45;&gt;layer2_mha_out_0</title>
<path fill="none" stroke="black" d="M1058.5,-8143.74C1058.5,-8122.18 1058.5,-8084.37 1058.5,-8053.29"/>
<polygon fill="black" stroke="black" points="1062,-8053.04 1058.5,-8043.04 1055,-8053.04 1062,-8053.04"/>
</g>
<!-- layer2_ln1_0 -->
<g id="node209" class="node">
<title>layer2_ln1_0</title>
<polygon fill="none" stroke="black" points="1112,-7706 1005,-7706 1005,-7670 1112,-7670 1112,-7706"/>
<text text-anchor="middle" x="1058.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_0</text>
</g>
<!-- layer2_res1_0&#45;&gt;layer2_ln1_0 -->
<g id="edge181" class="edge">
<title>layer2_res1_0&#45;&gt;layer2_ln1_0</title>
<path fill="none" stroke="black" d="M1058.5,-7822.97C1058.5,-7797.03 1058.5,-7747.36 1058.5,-7716.33"/>
<polygon fill="black" stroke="black" points="1062,-7716.2 1058.5,-7706.2 1055,-7716.2 1062,-7716.2"/>
</g>
<!-- layer2_ln1_0&#45;&gt;layer2_ffn_gate_0 -->
<g id="edge182" class="edge">
<title>layer2_ln1_0&#45;&gt;layer2_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1021.78,-7669.89C994.35,-7657.11 955.54,-7639.02 919.51,-7622.24"/>
<polygon fill="black" stroke="black" points="920.96,-7619.05 910.42,-7618 918.01,-7625.4 920.96,-7619.05"/>
</g>
<!-- layer2_ln1_0&#45;&gt;layer2_ffn_up_0 -->
<g id="edge183" class="edge">
<title>layer2_ln1_0&#45;&gt;layer2_ffn_up_0</title>
<path fill="none" stroke="black" d="M1098.5,-7669.89C1128.51,-7657.06 1171.02,-7638.87 1210.41,-7622.02"/>
<polygon fill="black" stroke="black" points="1211.99,-7625.15 1219.81,-7618 1209.24,-7618.72 1211.99,-7625.15"/>
</g>
<!-- layer2_ffn_act_0&#45;&gt;layer2_ffn_down_0 -->
<g id="edge186" class="edge">
<title>layer2_ffn_act_0&#45;&gt;layer2_ffn_down_0</title>
<path fill="none" stroke="black" d="M1133.5,-7397.74C1133.5,-7376.18 1133.5,-7338.37 1133.5,-7307.29"/>
<polygon fill="black" stroke="black" points="1137,-7307.04 1133.5,-7297.04 1130,-7307.04 1137,-7307.04"/>
</g>
<!-- layer3_mha_qkv_0 -->
<g id="node242" class="node">
<title>layer3_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="1411.5,-6976 855.5,-6976 855.5,-6893 1411.5,-6893 1411.5,-6976"/>
<text text-anchor="middle" x="1133.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="1133.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1133.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1133.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="1133.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_res2_0&#45;&gt;layer3_mha_qkv_0 -->
<g id="edge265" class="edge">
<title>layer2_res2_0&#45;&gt;layer3_mha_qkv_0</title>
<path fill="none" stroke="black" d="M1133.5,-7076.74C1133.5,-7055.18 1133.5,-7017.37 1133.5,-6986.29"/>
<polygon fill="black" stroke="black" points="1137,-6986.04 1133.5,-6976.04 1130,-6986.04 1137,-6986.04"/>
</g>
<!-- layer2_mha_attn_1&#45;&gt;layer2_mha_out_1 -->
<g id="edge190" class="edge">
<title>layer2_mha_attn_1&#45;&gt;layer2_mha_out_1</title>
<path fill="none" stroke="black" d="M2389.5,-8143.74C2389.5,-8122.18 2389.5,-8084.37 2389.5,-8053.29"/>
<polygon fill="black" stroke="black" points="2393,-8053.04 2389.5,-8043.04 2386,-8053.04 2393,-8053.04"/>
</g>
<!-- layer2_ln1_1 -->
<g id="node214" class="node">
<title>layer2_ln1_1</title>
<polygon fill="none" stroke="black" points="2443,-7706 2336,-7706 2336,-7670 2443,-7670 2443,-7706"/>
<text text-anchor="middle" x="2389.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_1</text>
</g>
<!-- layer2_res1_1&#45;&gt;layer2_ln1_1 -->
<g id="edge192" class="edge">
<title>layer2_res1_1&#45;&gt;layer2_ln1_1</title>
<path fill="none" stroke="black" d="M2389.5,-7822.97C2389.5,-7797.03 2389.5,-7747.36 2389.5,-7716.33"/>
<polygon fill="black" stroke="black" points="2393,-7716.2 2389.5,-7706.2 2386,-7716.2 2393,-7716.2"/>
</g>
<!-- layer2_ln1_1&#45;&gt;layer2_ffn_gate_1 -->
<g id="edge193" class="edge">
<title>layer2_ln1_1&#45;&gt;layer2_ffn_gate_1</title>
<path fill="none" stroke="black" d="M2335.72,-7674.76C2277.83,-7661.58 2182.46,-7639.87 2096.49,-7620.3"/>
<polygon fill="black" stroke="black" points="2097.13,-7616.85 2086.6,-7618.04 2095.57,-7623.68 2097.13,-7616.85"/>
</g>
<!-- layer2_ln1_1&#45;&gt;layer2_ffn_up_1 -->
<g id="edge194" class="edge">
<title>layer2_ln1_1&#45;&gt;layer2_ffn_up_1</title>
<path fill="none" stroke="black" d="M2391.06,-7669.89C2392.09,-7658.65 2393.49,-7643.31 2394.86,-7628.35"/>
<polygon fill="black" stroke="black" points="2398.37,-7628.4 2395.79,-7618.12 2391.4,-7627.76 2398.37,-7628.4"/>
</g>
<!-- layer2_ffn_act_1&#45;&gt;layer2_ffn_down_1 -->
<g id="edge197" class="edge">
<title>layer2_ffn_act_1&#45;&gt;layer2_ffn_down_1</title>
<path fill="none" stroke="black" d="M2247.5,-7397.74C2247.5,-7376.18 2247.5,-7338.37 2247.5,-7307.29"/>
<polygon fill="black" stroke="black" points="2251,-7307.04 2247.5,-7297.04 2244,-7307.04 2251,-7307.04"/>
</g>
<!-- layer3_mha_qkv_1 -->
<g id="node243" class="node">
<title>layer3_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2525.5,-6976 1969.5,-6976 1969.5,-6893 2525.5,-6893 2525.5,-6976"/>
<text text-anchor="middle" x="2247.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="2247.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2247.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2247.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="2247.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_res2_1&#45;&gt;layer3_mha_qkv_1 -->
<g id="edge276" class="edge">
<title>layer2_res2_1&#45;&gt;layer3_mha_qkv_1</title>
<path fill="none" stroke="black" d="M2247.5,-7076.74C2247.5,-7055.18 2247.5,-7017.37 2247.5,-6986.29"/>
<polygon fill="black" stroke="black" points="2251,-6986.04 2247.5,-6976.04 2244,-6986.04 2251,-6986.04"/>
</g>
<!-- layer2_mha_attn_2&#45;&gt;layer2_mha_out_2 -->
<g id="edge201" class="edge">
<title>layer2_mha_attn_2&#45;&gt;layer2_mha_out_2</title>
<path fill="none" stroke="black" d="M3346.5,-8143.74C3346.5,-8122.18 3346.5,-8084.37 3346.5,-8053.29"/>
<polygon fill="black" stroke="black" points="3350,-8053.04 3346.5,-8043.04 3343,-8053.04 3350,-8053.04"/>
</g>
<!-- layer2_ln1_2 -->
<g id="node219" class="node">
<title>layer2_ln1_2</title>
<polygon fill="none" stroke="black" points="3400,-7706 3293,-7706 3293,-7670 3400,-7670 3400,-7706"/>
<text text-anchor="middle" x="3346.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_2</text>
</g>
<!-- layer2_res1_2&#45;&gt;layer2_ln1_2 -->
<g id="edge203" class="edge">
<title>layer2_res1_2&#45;&gt;layer2_ln1_2</title>
<path fill="none" stroke="black" d="M3346.5,-7822.97C3346.5,-7797.03 3346.5,-7747.36 3346.5,-7716.33"/>
<polygon fill="black" stroke="black" points="3350,-7716.2 3346.5,-7706.2 3343,-7716.2 3350,-7716.2"/>
</g>
<!-- layer2_ln1_2&#45;&gt;layer2_ffn_gate_2 -->
<g id="edge204" class="edge">
<title>layer2_ln1_2&#45;&gt;layer2_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3300.25,-7669.89C3265.19,-7656.92 3215.36,-7638.49 3169.42,-7621.49"/>
<polygon fill="black" stroke="black" points="3170.58,-7618.19 3159.98,-7618 3168.15,-7624.75 3170.58,-7618.19"/>
</g>
<!-- layer2_ln1_2&#45;&gt;layer2_ffn_up_2 -->
<g id="edge205" class="edge">
<title>layer2_ln1_2&#45;&gt;layer2_ffn_up_2</title>
<path fill="none" stroke="black" d="M3376.97,-7669.89C3399.3,-7657.35 3430.71,-7639.71 3460.12,-7623.2"/>
<polygon fill="black" stroke="black" points="3462.16,-7626.07 3469.17,-7618.12 3458.73,-7619.96 3462.16,-7626.07"/>
</g>
<!-- layer2_ffn_act_2&#45;&gt;layer2_ffn_down_2 -->
<g id="edge208" class="edge">
<title>layer2_ffn_act_2&#45;&gt;layer2_ffn_down_2</title>
<path fill="none" stroke="black" d="M3323.5,-7397.74C3323.5,-7376.18 3323.5,-7338.37 3323.5,-7307.29"/>
<polygon fill="black" stroke="black" points="3327,-7307.04 3323.5,-7297.04 3320,-7307.04 3327,-7307.04"/>
</g>
<!-- layer3_mha_qkv_2 -->
<g id="node244" class="node">
<title>layer3_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3601.5,-6976 3045.5,-6976 3045.5,-6893 3601.5,-6893 3601.5,-6976"/>
<text text-anchor="middle" x="3323.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3323.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3323.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3323.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3323.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_res2_2&#45;&gt;layer3_mha_qkv_2 -->
<g id="edge287" class="edge">
<title>layer2_res2_2&#45;&gt;layer3_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3323.5,-7076.74C3323.5,-7055.18 3323.5,-7017.37 3323.5,-6986.29"/>
<polygon fill="black" stroke="black" points="3327,-6986.04 3323.5,-6976.04 3320,-6986.04 3327,-6986.04"/>
</g>
<!-- layer2_mha_attn_3&#45;&gt;layer2_mha_out_3 -->
<g id="edge212" class="edge">
<title>layer2_mha_attn_3&#45;&gt;layer2_mha_out_3</title>
<path fill="none" stroke="black" d="M4696.5,-8143.74C4696.5,-8122.18 4696.5,-8084.37 4696.5,-8053.29"/>
<polygon fill="black" stroke="black" points="4700,-8053.04 4696.5,-8043.04 4693,-8053.04 4700,-8053.04"/>
</g>
<!-- layer2_ln1_3 -->
<g id="node224" class="node">
<title>layer2_ln1_3</title>
<polygon fill="none" stroke="black" points="4750,-7706 4643,-7706 4643,-7670 4750,-7670 4750,-7706"/>
<text text-anchor="middle" x="4696.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_3</text>
</g>
<!-- layer2_res1_3&#45;&gt;layer2_ln1_3 -->
<g id="edge214" class="edge">
<title>layer2_res1_3&#45;&gt;layer2_ln1_3</title>
<path fill="none" stroke="black" d="M4696.5,-7822.97C4696.5,-7797.03 4696.5,-7747.36 4696.5,-7716.33"/>
<polygon fill="black" stroke="black" points="4700,-7716.2 4696.5,-7706.2 4693,-7716.2 4700,-7716.2"/>
</g>
<!-- layer2_ln1_3&#45;&gt;layer2_ffn_gate_3 -->
<g id="edge215" class="edge">
<title>layer2_ln1_3&#45;&gt;layer2_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4692.44,-7669.89C4689.74,-7658.54 4686.06,-7643.01 4682.47,-7627.92"/>
<polygon fill="black" stroke="black" points="4685.86,-7627.04 4680.14,-7618.12 4679.05,-7628.66 4685.86,-7627.04"/>
</g>
<!-- layer2_ln1_3&#45;&gt;layer2_ffn_up_3 -->
<g id="edge216" class="edge">
<title>layer2_ln1_3&#45;&gt;layer2_ffn_up_3</title>
<path fill="none" stroke="black" d="M4750.3,-7674.33C4806.35,-7661.13 4897.3,-7639.71 4979.43,-7620.37"/>
<polygon fill="black" stroke="black" points="4980.47,-7623.73 4989.4,-7618.03 4978.86,-7616.91 4980.47,-7623.73"/>
</g>
<!-- layer2_ffn_act_3&#45;&gt;layer2_ffn_down_3 -->
<g id="edge219" class="edge">
<title>layer2_ffn_act_3&#45;&gt;layer2_ffn_down_3</title>
<path fill="none" stroke="black" d="M4677.5,-7397.74C4677.5,-7376.18 4677.5,-7338.37 4677.5,-7307.29"/>
<polygon fill="black" stroke="black" points="4681,-7307.04 4677.5,-7297.04 4674,-7307.04 4681,-7307.04"/>
</g>
<!-- layer3_mha_qkv_3 -->
<g id="node245" class="node">
<title>layer3_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4955.5,-6976 4399.5,-6976 4399.5,-6893 4955.5,-6893 4955.5,-6976"/>
<text text-anchor="middle" x="4677.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4677.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4677.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4677.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4677.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_res2_3&#45;&gt;layer3_mha_qkv_3 -->
<g id="edge298" class="edge">
<title>layer2_res2_3&#45;&gt;layer3_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4677.5,-7076.74C4677.5,-7055.18 4677.5,-7017.37 4677.5,-6986.29"/>
<polygon fill="black" stroke="black" points="4681,-6986.04 4677.5,-6976.04 4674,-6986.04 4681,-6986.04"/>
</g>
<!-- layer2_mha_attn_4&#45;&gt;layer2_mha_out_4 -->
<g id="edge223" class="edge">
<title>layer2_mha_attn_4&#45;&gt;layer2_mha_out_4</title>
<path fill="none" stroke="black" d="M5719.5,-8143.74C5719.5,-8122.18 5719.5,-8084.37 5719.5,-8053.29"/>
<polygon fill="black" stroke="black" points="5723,-8053.04 5719.5,-8043.04 5716,-8053.04 5723,-8053.04"/>
</g>
<!-- layer2_ln1_4 -->
<g id="node229" class="node">
<title>layer2_ln1_4</title>
<polygon fill="none" stroke="black" points="5773,-7706 5666,-7706 5666,-7670 5773,-7670 5773,-7706"/>
<text text-anchor="middle" x="5719.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_4</text>
</g>
<!-- layer2_res1_4&#45;&gt;layer2_ln1_4 -->
<g id="edge225" class="edge">
<title>layer2_res1_4&#45;&gt;layer2_ln1_4</title>
<path fill="none" stroke="black" d="M5719.5,-7822.97C5719.5,-7797.03 5719.5,-7747.36 5719.5,-7716.33"/>
<polygon fill="black" stroke="black" points="5723,-7716.2 5719.5,-7706.2 5716,-7716.2 5723,-7716.2"/>
</g>
<!-- layer2_ln1_4&#45;&gt;layer2_ffn_gate_4 -->
<g id="edge226" class="edge">
<title>layer2_ln1_4&#45;&gt;layer2_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5713.56,-7669.89C5709.62,-7658.54 5704.23,-7643.01 5699,-7627.92"/>
<polygon fill="black" stroke="black" points="5702.18,-7626.42 5695.6,-7618.12 5695.57,-7628.71 5702.18,-7626.42"/>
</g>
<!-- layer2_ln1_4&#45;&gt;layer2_ffn_up_4 -->
<g id="edge227" class="edge">
<title>layer2_ln1_4&#45;&gt;layer2_ffn_up_4</title>
<path fill="none" stroke="black" d="M5773.24,-7674.01C5827.86,-7660.81 5915.47,-7639.63 5994.72,-7620.47"/>
<polygon fill="black" stroke="black" points="5995.94,-7623.78 6004.84,-7618.03 5994.3,-7616.97 5995.94,-7623.78"/>
</g>
<!-- layer2_ffn_act_4&#45;&gt;layer2_ffn_down_4 -->
<g id="edge230" class="edge">
<title>layer2_ffn_act_4&#45;&gt;layer2_ffn_down_4</title>
<path fill="none" stroke="black" d="M5732.5,-7397.74C5732.5,-7376.18 5732.5,-7338.37 5732.5,-7307.29"/>
<polygon fill="black" stroke="black" points="5736,-7307.04 5732.5,-7297.04 5729,-7307.04 5736,-7307.04"/>
</g>
<!-- layer3_mha_qkv_4 -->
<g id="node246" class="node">
<title>layer3_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="6010.5,-6976 5454.5,-6976 5454.5,-6893 6010.5,-6893 6010.5,-6976"/>
<text text-anchor="middle" x="5732.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5732.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5732.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5732.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5732.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_res2_4&#45;&gt;layer3_mha_qkv_4 -->
<g id="edge309" class="edge">
<title>layer2_res2_4&#45;&gt;layer3_mha_qkv_4</title>
<path fill="none" stroke="black" d="M5732.5,-7076.74C5732.5,-7055.18 5732.5,-7017.37 5732.5,-6986.29"/>
<polygon fill="black" stroke="black" points="5736,-6986.04 5732.5,-6976.04 5729,-6986.04 5736,-6986.04"/>
</g>
<!-- layer2_mha_attn_5&#45;&gt;layer2_mha_out_5 -->
<g id="edge234" class="edge">
<title>layer2_mha_attn_5&#45;&gt;layer2_mha_out_5</title>
<path fill="none" stroke="black" d="M6676.5,-8143.74C6676.5,-8122.18 6676.5,-8084.37 6676.5,-8053.29"/>
<polygon fill="black" stroke="black" points="6680,-8053.04 6676.5,-8043.04 6673,-8053.04 6680,-8053.04"/>
</g>
<!-- layer2_ln1_5 -->
<g id="node234" class="node">
<title>layer2_ln1_5</title>
<polygon fill="none" stroke="black" points="6730,-7706 6623,-7706 6623,-7670 6730,-7670 6730,-7706"/>
<text text-anchor="middle" x="6676.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_5</text>
</g>
<!-- layer2_res1_5&#45;&gt;layer2_ln1_5 -->
<g id="edge236" class="edge">
<title>layer2_res1_5&#45;&gt;layer2_ln1_5</title>
<path fill="none" stroke="black" d="M6676.5,-7822.97C6676.5,-7797.03 6676.5,-7747.36 6676.5,-7716.33"/>
<polygon fill="black" stroke="black" points="6680,-7716.2 6676.5,-7706.2 6673,-7716.2 6680,-7716.2"/>
</g>
<!-- layer2_ln1_5&#45;&gt;layer2_ffn_gate_5 -->
<g id="edge237" class="edge">
<title>layer2_ln1_5&#45;&gt;layer2_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6675.09,-7669.89C6674.17,-7658.65 6672.91,-7643.31 6671.68,-7628.35"/>
<polygon fill="black" stroke="black" points="6675.15,-7627.8 6670.84,-7618.12 6668.17,-7628.37 6675.15,-7627.8"/>
</g>
<!-- layer2_ln1_5&#45;&gt;layer2_ffn_up_5 -->
<g id="edge238" class="edge">
<title>layer2_ln1_5&#45;&gt;layer2_ffn_up_5</title>
<path fill="none" stroke="black" d="M6730.39,-7674.76C6788.4,-7661.58 6883.97,-7639.87 6970.11,-7620.3"/>
<polygon fill="black" stroke="black" points="6971.05,-7623.67 6980.03,-7618.04 6969.5,-7616.85 6971.05,-7623.67"/>
</g>
<!-- layer2_ffn_act_5&#45;&gt;layer2_ffn_down_5 -->
<g id="edge241" class="edge">
<title>layer2_ffn_act_5&#45;&gt;layer2_ffn_down_5</title>
<path fill="none" stroke="black" d="M6667.5,-7397.74C6667.5,-7376.18 6667.5,-7338.37 6667.5,-7307.29"/>
<polygon fill="black" stroke="black" points="6671,-7307.04 6667.5,-7297.04 6664,-7307.04 6671,-7307.04"/>
</g>
<!-- layer3_mha_qkv_5 -->
<g id="node247" class="node">
<title>layer3_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="6945.5,-6976 6389.5,-6976 6389.5,-6893 6945.5,-6893 6945.5,-6976"/>
<text text-anchor="middle" x="6667.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6667.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6667.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6667.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6667.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_res2_5&#45;&gt;layer3_mha_qkv_5 -->
<g id="edge320" class="edge">
<title>layer2_res2_5&#45;&gt;layer3_mha_qkv_5</title>
<path fill="none" stroke="black" d="M6667.5,-7076.74C6667.5,-7055.18 6667.5,-7017.37 6667.5,-6986.29"/>
<polygon fill="black" stroke="black" points="6671,-6986.04 6667.5,-6976.04 6664,-6986.04 6671,-6986.04"/>
</g>
<!-- layer2_mha_attn_6&#45;&gt;layer2_mha_out_6 -->
<g id="edge245" class="edge">
<title>layer2_mha_attn_6&#45;&gt;layer2_mha_out_6</title>
<path fill="none" stroke="black" d="M7671.5,-8143.74C7671.5,-8122.18 7671.5,-8084.37 7671.5,-8053.29"/>
<polygon fill="black" stroke="black" points="7675,-8053.04 7671.5,-8043.04 7668,-8053.04 7675,-8053.04"/>
</g>
<!-- layer2_ln1_6 -->
<g id="node239" class="node">
<title>layer2_ln1_6</title>
<polygon fill="none" stroke="black" points="7725,-7706 7618,-7706 7618,-7670 7725,-7670 7725,-7706"/>
<text text-anchor="middle" x="7671.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer2_ln1_6</text>
</g>
<!-- layer2_res1_6&#45;&gt;layer2_ln1_6 -->
<g id="edge247" class="edge">
<title>layer2_res1_6&#45;&gt;layer2_ln1_6</title>
<path fill="none" stroke="black" d="M7671.5,-7822.97C7671.5,-7797.03 7671.5,-7747.36 7671.5,-7716.33"/>
<polygon fill="black" stroke="black" points="7675,-7716.2 7671.5,-7706.2 7668,-7716.2 7675,-7716.2"/>
</g>
<!-- layer2_ln1_6&#45;&gt;layer2_ffn_gate_6 -->
<g id="edge248" class="edge">
<title>layer2_ln1_6&#45;&gt;layer2_ffn_gate_6</title>
<path fill="none" stroke="black" d="M7669.62,-7669.89C7668.39,-7658.65 7666.71,-7643.31 7665.07,-7628.35"/>
<polygon fill="black" stroke="black" points="7668.52,-7627.68 7663.95,-7618.12 7661.56,-7628.44 7668.52,-7627.68"/>
</g>
<!-- layer2_ln1_6&#45;&gt;layer2_ffn_up_6 -->
<g id="edge249" class="edge">
<title>layer2_ln1_6&#45;&gt;layer2_ffn_up_6</title>
<path fill="none" stroke="black" d="M7725.05,-7674.76C7782.7,-7661.58 7877.68,-7639.87 7963.29,-7620.3"/>
<polygon fill="black" stroke="black" points="7964.17,-7623.69 7973.14,-7618.04 7962.61,-7616.86 7964.17,-7623.69"/>
</g>
<!-- layer2_ffn_act_6&#45;&gt;layer2_ffn_down_6 -->
<g id="edge252" class="edge">
<title>layer2_ffn_act_6&#45;&gt;layer2_ffn_down_6</title>
<path fill="none" stroke="black" d="M7883.5,-7397.74C7883.5,-7376.18 7883.5,-7338.37 7883.5,-7307.29"/>
<polygon fill="black" stroke="black" points="7887,-7307.04 7883.5,-7297.04 7880,-7307.04 7887,-7307.04"/>
</g>
<!-- layer3_mha_qkv_6 -->
<g id="node248" class="node">
<title>layer3_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="8161.5,-6976 7605.5,-6976 7605.5,-6893 8161.5,-6893 8161.5,-6976"/>
<text text-anchor="middle" x="7883.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7883.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7883.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7883.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7883.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_res2_6&#45;&gt;layer3_mha_qkv_6 -->
<g id="edge331" class="edge">
<title>layer2_res2_6&#45;&gt;layer3_mha_qkv_6</title>
<path fill="none" stroke="black" d="M7883.5,-7076.74C7883.5,-7055.18 7883.5,-7017.37 7883.5,-6986.29"/>
<polygon fill="black" stroke="black" points="7887,-6986.04 7883.5,-6976.04 7880,-6986.04 7887,-6986.04"/>
</g>
<!-- layer3_mha_attn_0 -->
<g id="node287" class="node">
<title>layer3_mha_attn_0</title>
<polygon fill="none" stroke="black" points="1209,-6792 1058,-6792 1058,-6756 1209,-6756 1209,-6792"/>
<text text-anchor="middle" x="1133.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_0</text>
</g>
<!-- layer3_mha_qkv_0&#45;&gt;layer3_mha_attn_0 -->
<g id="edge266" class="edge">
<title>layer3_mha_qkv_0&#45;&gt;layer3_mha_attn_0</title>
<path fill="none" stroke="black" d="M1133.5,-6892.68C1133.5,-6864.24 1133.5,-6827.08 1133.5,-6802.2"/>
<polygon fill="black" stroke="black" points="1137,-6802.02 1133.5,-6792.02 1130,-6802.02 1137,-6802.02"/>
</g>
<!-- layer3_mha_attn_1 -->
<g id="node292" class="node">
<title>layer3_mha_attn_1</title>
<polygon fill="none" stroke="black" points="2323,-6792 2172,-6792 2172,-6756 2323,-6756 2323,-6792"/>
<text text-anchor="middle" x="2247.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_1</text>
</g>
<!-- layer3_mha_qkv_1&#45;&gt;layer3_mha_attn_1 -->
<g id="edge277" class="edge">
<title>layer3_mha_qkv_1&#45;&gt;layer3_mha_attn_1</title>
<path fill="none" stroke="black" d="M2247.5,-6892.68C2247.5,-6864.24 2247.5,-6827.08 2247.5,-6802.2"/>
<polygon fill="black" stroke="black" points="2251,-6802.02 2247.5,-6792.02 2244,-6802.02 2251,-6802.02"/>
</g>
<!-- layer3_mha_attn_2 -->
<g id="node297" class="node">
<title>layer3_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3399,-6792 3248,-6792 3248,-6756 3399,-6756 3399,-6792"/>
<text text-anchor="middle" x="3323.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_2</text>
</g>
<!-- layer3_mha_qkv_2&#45;&gt;layer3_mha_attn_2 -->
<g id="edge288" class="edge">
<title>layer3_mha_qkv_2&#45;&gt;layer3_mha_attn_2</title>
<path fill="none" stroke="black" d="M3323.5,-6892.68C3323.5,-6864.24 3323.5,-6827.08 3323.5,-6802.2"/>
<polygon fill="black" stroke="black" points="3327,-6802.02 3323.5,-6792.02 3320,-6802.02 3327,-6802.02"/>
</g>
<!-- layer3_mha_attn_3 -->
<g id="node302" class="node">
<title>layer3_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4753,-6792 4602,-6792 4602,-6756 4753,-6756 4753,-6792"/>
<text text-anchor="middle" x="4677.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_3</text>
</g>
<!-- layer3_mha_qkv_3&#45;&gt;layer3_mha_attn_3 -->
<g id="edge299" class="edge">
<title>layer3_mha_qkv_3&#45;&gt;layer3_mha_attn_3</title>
<path fill="none" stroke="black" d="M4677.5,-6892.68C4677.5,-6864.24 4677.5,-6827.08 4677.5,-6802.2"/>
<polygon fill="black" stroke="black" points="4681,-6802.02 4677.5,-6792.02 4674,-6802.02 4681,-6802.02"/>
</g>
<!-- layer3_mha_attn_4 -->
<g id="node307" class="node">
<title>layer3_mha_attn_4</title>
<polygon fill="none" stroke="black" points="5808,-6792 5657,-6792 5657,-6756 5808,-6756 5808,-6792"/>
<text text-anchor="middle" x="5732.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_4</text>
</g>
<!-- layer3_mha_qkv_4&#45;&gt;layer3_mha_attn_4 -->
<g id="edge310" class="edge">
<title>layer3_mha_qkv_4&#45;&gt;layer3_mha_attn_4</title>
<path fill="none" stroke="black" d="M5732.5,-6892.68C5732.5,-6864.24 5732.5,-6827.08 5732.5,-6802.2"/>
<polygon fill="black" stroke="black" points="5736,-6802.02 5732.5,-6792.02 5729,-6802.02 5736,-6802.02"/>
</g>
<!-- layer3_mha_attn_5 -->
<g id="node312" class="node">
<title>layer3_mha_attn_5</title>
<polygon fill="none" stroke="black" points="6743,-6792 6592,-6792 6592,-6756 6743,-6756 6743,-6792"/>
<text text-anchor="middle" x="6667.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_5</text>
</g>
<!-- layer3_mha_qkv_5&#45;&gt;layer3_mha_attn_5 -->
<g id="edge321" class="edge">
<title>layer3_mha_qkv_5&#45;&gt;layer3_mha_attn_5</title>
<path fill="none" stroke="black" d="M6667.5,-6892.68C6667.5,-6864.24 6667.5,-6827.08 6667.5,-6802.2"/>
<polygon fill="black" stroke="black" points="6671,-6802.02 6667.5,-6792.02 6664,-6802.02 6671,-6802.02"/>
</g>
<!-- layer3_mha_attn_6 -->
<g id="node317" class="node">
<title>layer3_mha_attn_6</title>
<polygon fill="none" stroke="black" points="7959,-6792 7808,-6792 7808,-6756 7959,-6756 7959,-6792"/>
<text text-anchor="middle" x="7883.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer3_mha_attn_6</text>
</g>
<!-- layer3_mha_qkv_6&#45;&gt;layer3_mha_attn_6 -->
<g id="edge332" class="edge">
<title>layer3_mha_qkv_6&#45;&gt;layer3_mha_attn_6</title>
<path fill="none" stroke="black" d="M7883.5,-6892.68C7883.5,-6864.24 7883.5,-6827.08 7883.5,-6802.2"/>
<polygon fill="black" stroke="black" points="7887,-6802.02 7883.5,-6792.02 7880,-6802.02 7887,-6802.02"/>
</g>
<!-- layer3_mha_attn_7 -->
<g id="node250" class="node">
<title>layer3_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9136.31,-6857 8377.81,-6857 8182.69,-6691 8941.19,-6691 9136.31,-6857"/>
<text text-anchor="middle" x="8659.5" y="-6800.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="8659.5" y="-6785.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="8659.5" y="-6770.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8659.5" y="-6755.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6740.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_mha_qkv_7&#45;&gt;layer3_mha_attn_7 -->
<g id="edge343" class="edge">
<title>layer3_mha_qkv_7&#45;&gt;layer3_mha_attn_7</title>
<path fill="none" stroke="black" d="M8659.5,-6892.68C8659.5,-6884.75 8659.5,-6876.14 8659.5,-6867.31"/>
<polygon fill="black" stroke="black" points="8663,-6867.27 8659.5,-6857.27 8656,-6867.27 8663,-6867.27"/>
</g>
<!-- layer3_mha_out_7 -->
<g id="node258" class="node">
<title>layer3_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="8878.5,-6655 8440.5,-6655 8440.5,-6572 8878.5,-6572 8878.5,-6655"/>
<text text-anchor="middle" x="8659.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8659.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8659.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8659.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_mha_attn_7&#45;&gt;layer3_mha_out_7 -->
<g id="edge344" class="edge">
<title>layer3_mha_attn_7&#45;&gt;layer3_mha_out_7</title>
<path fill="none" stroke="black" d="M8659.5,-6690.96C8659.5,-6682.25 8659.5,-6673.59 8659.5,-6665.39"/>
<polygon fill="black" stroke="black" points="8663,-6665.29 8659.5,-6655.29 8656,-6665.29 8663,-6665.29"/>
</g>
<!-- layer3_mha_out_0 -->
<g id="node251" class="node">
<title>layer3_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="1352.5,-6655 914.5,-6655 914.5,-6572 1352.5,-6572 1352.5,-6655"/>
<text text-anchor="middle" x="1133.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="1133.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1133.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1133.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1133.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_res1_0 -->
<g id="node288" class="node">
<title>layer3_res1_0</title>
<polygon fill="none" stroke="black" points="1191.5,-6471 1075.5,-6471 1075.5,-6435 1191.5,-6435 1191.5,-6471"/>
<text text-anchor="middle" x="1133.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_0</text>
</g>
<!-- layer3_mha_out_0&#45;&gt;layer3_res1_0 -->
<g id="edge268" class="edge">
<title>layer3_mha_out_0&#45;&gt;layer3_res1_0</title>
<path fill="none" stroke="black" d="M1133.5,-6571.68C1133.5,-6543.24 1133.5,-6506.08 1133.5,-6481.2"/>
<polygon fill="black" stroke="black" points="1137,-6481.02 1133.5,-6471.02 1130,-6481.02 1137,-6481.02"/>
</g>
<!-- layer3_mha_out_1 -->
<g id="node252" class="node">
<title>layer3_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2466.5,-6655 2028.5,-6655 2028.5,-6572 2466.5,-6572 2466.5,-6655"/>
<text text-anchor="middle" x="2247.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="2247.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2247.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2247.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2247.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_res1_1 -->
<g id="node293" class="node">
<title>layer3_res1_1</title>
<polygon fill="none" stroke="black" points="2305.5,-6471 2189.5,-6471 2189.5,-6435 2305.5,-6435 2305.5,-6471"/>
<text text-anchor="middle" x="2247.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_1</text>
</g>
<!-- layer3_mha_out_1&#45;&gt;layer3_res1_1 -->
<g id="edge279" class="edge">
<title>layer3_mha_out_1&#45;&gt;layer3_res1_1</title>
<path fill="none" stroke="black" d="M2247.5,-6571.68C2247.5,-6543.24 2247.5,-6506.08 2247.5,-6481.2"/>
<polygon fill="black" stroke="black" points="2251,-6481.02 2247.5,-6471.02 2244,-6481.02 2251,-6481.02"/>
</g>
<!-- layer3_mha_out_2 -->
<g id="node253" class="node">
<title>layer3_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3542.5,-6655 3104.5,-6655 3104.5,-6572 3542.5,-6572 3542.5,-6655"/>
<text text-anchor="middle" x="3323.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3323.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3323.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3323.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3323.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_res1_2 -->
<g id="node298" class="node">
<title>layer3_res1_2</title>
<polygon fill="none" stroke="black" points="3381.5,-6471 3265.5,-6471 3265.5,-6435 3381.5,-6435 3381.5,-6471"/>
<text text-anchor="middle" x="3323.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_2</text>
</g>
<!-- layer3_mha_out_2&#45;&gt;layer3_res1_2 -->
<g id="edge290" class="edge">
<title>layer3_mha_out_2&#45;&gt;layer3_res1_2</title>
<path fill="none" stroke="black" d="M3323.5,-6571.68C3323.5,-6543.24 3323.5,-6506.08 3323.5,-6481.2"/>
<polygon fill="black" stroke="black" points="3327,-6481.02 3323.5,-6471.02 3320,-6481.02 3327,-6481.02"/>
</g>
<!-- layer3_mha_out_3 -->
<g id="node254" class="node">
<title>layer3_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4896.5,-6655 4458.5,-6655 4458.5,-6572 4896.5,-6572 4896.5,-6655"/>
<text text-anchor="middle" x="4677.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4677.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4677.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4677.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4677.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_res1_3 -->
<g id="node303" class="node">
<title>layer3_res1_3</title>
<polygon fill="none" stroke="black" points="4735.5,-6471 4619.5,-6471 4619.5,-6435 4735.5,-6435 4735.5,-6471"/>
<text text-anchor="middle" x="4677.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_3</text>
</g>
<!-- layer3_mha_out_3&#45;&gt;layer3_res1_3 -->
<g id="edge301" class="edge">
<title>layer3_mha_out_3&#45;&gt;layer3_res1_3</title>
<path fill="none" stroke="black" d="M4677.5,-6571.68C4677.5,-6543.24 4677.5,-6506.08 4677.5,-6481.2"/>
<polygon fill="black" stroke="black" points="4681,-6481.02 4677.5,-6471.02 4674,-6481.02 4681,-6481.02"/>
</g>
<!-- layer3_mha_out_4 -->
<g id="node255" class="node">
<title>layer3_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="5951.5,-6655 5513.5,-6655 5513.5,-6572 5951.5,-6572 5951.5,-6655"/>
<text text-anchor="middle" x="5732.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="5732.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5732.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5732.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5732.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_res1_4 -->
<g id="node308" class="node">
<title>layer3_res1_4</title>
<polygon fill="none" stroke="black" points="5790.5,-6471 5674.5,-6471 5674.5,-6435 5790.5,-6435 5790.5,-6471"/>
<text text-anchor="middle" x="5732.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_4</text>
</g>
<!-- layer3_mha_out_4&#45;&gt;layer3_res1_4 -->
<g id="edge312" class="edge">
<title>layer3_mha_out_4&#45;&gt;layer3_res1_4</title>
<path fill="none" stroke="black" d="M5732.5,-6571.68C5732.5,-6543.24 5732.5,-6506.08 5732.5,-6481.2"/>
<polygon fill="black" stroke="black" points="5736,-6481.02 5732.5,-6471.02 5729,-6481.02 5736,-6481.02"/>
</g>
<!-- layer3_mha_out_5 -->
<g id="node256" class="node">
<title>layer3_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="6886.5,-6655 6448.5,-6655 6448.5,-6572 6886.5,-6572 6886.5,-6655"/>
<text text-anchor="middle" x="6667.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6667.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6667.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6667.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6667.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_res1_5 -->
<g id="node313" class="node">
<title>layer3_res1_5</title>
<polygon fill="none" stroke="black" points="6725.5,-6471 6609.5,-6471 6609.5,-6435 6725.5,-6435 6725.5,-6471"/>
<text text-anchor="middle" x="6667.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_5</text>
</g>
<!-- layer3_mha_out_5&#45;&gt;layer3_res1_5 -->
<g id="edge323" class="edge">
<title>layer3_mha_out_5&#45;&gt;layer3_res1_5</title>
<path fill="none" stroke="black" d="M6667.5,-6571.68C6667.5,-6543.24 6667.5,-6506.08 6667.5,-6481.2"/>
<polygon fill="black" stroke="black" points="6671,-6481.02 6667.5,-6471.02 6664,-6481.02 6671,-6481.02"/>
</g>
<!-- layer3_mha_out_6 -->
<g id="node257" class="node">
<title>layer3_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="8102.5,-6655 7664.5,-6655 7664.5,-6572 8102.5,-6572 8102.5,-6655"/>
<text text-anchor="middle" x="7883.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7883.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7883.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7883.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7883.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_res1_6 -->
<g id="node318" class="node">
<title>layer3_res1_6</title>
<polygon fill="none" stroke="black" points="7941.5,-6471 7825.5,-6471 7825.5,-6435 7941.5,-6435 7941.5,-6471"/>
<text text-anchor="middle" x="7883.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer3_res1_6</text>
</g>
<!-- layer3_mha_out_6&#45;&gt;layer3_res1_6 -->
<g id="edge334" class="edge">
<title>layer3_mha_out_6&#45;&gt;layer3_res1_6</title>
<path fill="none" stroke="black" d="M7883.5,-6571.68C7883.5,-6543.24 7883.5,-6506.08 7883.5,-6481.2"/>
<polygon fill="black" stroke="black" points="7887,-6481.02 7883.5,-6471.02 7880,-6481.02 7887,-6481.02"/>
</g>
<!-- layer3_res1_7 -->
<g id="node259" class="node">
<title>layer3_res1_7</title>
<polygon fill="none" stroke="black" points="9100.24,-6536 8399.12,-6536 8218.76,-6370 8919.88,-6370 9100.24,-6536"/>
<text text-anchor="middle" x="8659.5" y="-6479.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8659.5" y="-6464.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6449.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6434.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6419.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_mha_out_7&#45;&gt;layer3_res1_7 -->
<g id="edge345" class="edge">
<title>layer3_mha_out_7&#45;&gt;layer3_res1_7</title>
<path fill="none" stroke="black" d="M8659.5,-6571.68C8659.5,-6563.75 8659.5,-6555.14 8659.5,-6546.31"/>
<polygon fill="black" stroke="black" points="8663,-6546.27 8659.5,-6536.27 8656,-6546.27 8663,-6546.27"/>
</g>
<!-- layer3_ln1_7 -->
<g id="node260" class="node">
<title>layer3_ln1_7</title>
<polygon fill="yellow" stroke="black" points="8872,-6334 8447,-6334 8447,-6266 8872,-6266 8872,-6334"/>
<text text-anchor="middle" x="8659.5" y="-6318.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="8659.5" y="-6303.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6288.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8659.5" y="-6273.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_res1_7&#45;&gt;layer3_ln1_7 -->
<g id="edge346" class="edge">
<title>layer3_res1_7&#45;&gt;layer3_ln1_7</title>
<path fill="none" stroke="black" d="M8659.5,-6369.87C8659.5,-6361.12 8659.5,-6352.48 8659.5,-6344.45"/>
<polygon fill="black" stroke="black" points="8663,-6344.26 8659.5,-6334.26 8656,-6344.26 8663,-6344.26"/>
</g>
<!-- layer3_ffn_gate_7 -->
<g id="node268" class="node">
<title>layer3_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="8868,-6230 8395,-6230 8395,-6147 8868,-6147 8868,-6230"/>
<text text-anchor="middle" x="8631.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8631.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8631.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8631.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8631.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_ln1_7&#45;&gt;layer3_ffn_gate_7 -->
<g id="edge347" class="edge">
<title>layer3_ln1_7&#45;&gt;layer3_ffn_gate_7</title>
<path fill="none" stroke="black" d="M8651.02,-6265.85C8648.94,-6257.71 8646.67,-6248.81 8644.43,-6240.05"/>
<polygon fill="black" stroke="black" points="8647.8,-6239.1 8641.93,-6230.28 8641.01,-6240.83 8647.8,-6239.1"/>
</g>
<!-- layer3_ffn_up_7 -->
<g id="node276" class="node">
<title>layer3_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9359,-6230 8886,-6230 8886,-6147 9359,-6147 9359,-6230"/>
<text text-anchor="middle" x="9122.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9122.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9122.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9122.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9122.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_ln1_7&#45;&gt;layer3_ffn_up_7 -->
<g id="edge348" class="edge">
<title>layer3_ln1_7&#45;&gt;layer3_ffn_up_7</title>
<path fill="none" stroke="black" d="M8799.04,-6266C8843.66,-6255.45 8893.73,-6243.61 8940.89,-6232.45"/>
<polygon fill="black" stroke="black" points="8941.98,-6235.79 8950.91,-6230.08 8940.37,-6228.98 8941.98,-6235.79"/>
</g>
<!-- layer3_ffn_gate_0 -->
<g id="node261" class="node">
<title>layer3_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="995,-6230 522,-6230 522,-6147 995,-6147 995,-6230"/>
<text text-anchor="middle" x="758.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="758.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="758.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="758.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="758.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_ffn_act_0 -->
<g id="node290" class="node">
<title>layer3_ffn_act_0</title>
<polygon fill="none" stroke="black" points="1211,-6046 1080,-6046 1080,-6010 1211,-6010 1211,-6046"/>
<text text-anchor="middle" x="1145.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_0</text>
</g>
<!-- layer3_ffn_gate_0&#45;&gt;layer3_ffn_act_0 -->
<g id="edge272" class="edge">
<title>layer3_ffn_gate_0&#45;&gt;layer3_ffn_act_0</title>
<path fill="none" stroke="black" d="M857.41,-6146.99C933.09,-6116 1034.36,-6074.52 1094.48,-6049.9"/>
<polygon fill="black" stroke="black" points="1095.84,-6053.12 1103.77,-6046.09 1093.19,-6046.64 1095.84,-6053.12"/>
</g>
<!-- layer3_ffn_gate_1 -->
<g id="node262" class="node">
<title>layer3_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="2352,-6230 1879,-6230 1879,-6147 2352,-6147 2352,-6230"/>
<text text-anchor="middle" x="2115.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2115.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2115.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2115.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2115.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_ffn_act_1 -->
<g id="node295" class="node">
<title>layer3_ffn_act_1</title>
<polygon fill="none" stroke="black" points="2657,-6046 2526,-6046 2526,-6010 2657,-6010 2657,-6046"/>
<text text-anchor="middle" x="2591.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_1</text>
</g>
<!-- layer3_ffn_gate_1&#45;&gt;layer3_ffn_act_1 -->
<g id="edge283" class="edge">
<title>layer3_ffn_gate_1&#45;&gt;layer3_ffn_act_1</title>
<path fill="none" stroke="black" d="M2237.15,-6146.99C2331,-6115.74 2456.86,-6073.83 2530.56,-6049.29"/>
<polygon fill="black" stroke="black" points="2531.79,-6052.57 2540.17,-6046.09 2529.58,-6045.93 2531.79,-6052.57"/>
</g>
<!-- layer3_ffn_gate_2 -->
<g id="node263" class="node">
<title>layer3_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3369,-6230 2896,-6230 2896,-6147 3369,-6147 3369,-6230"/>
<text text-anchor="middle" x="3132.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3132.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3132.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3132.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3132.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_ffn_act_2 -->
<g id="node300" class="node">
<title>layer3_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3233,-6046 3102,-6046 3102,-6010 3233,-6010 3233,-6046"/>
<text text-anchor="middle" x="3167.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_2</text>
</g>
<!-- layer3_ffn_gate_2&#45;&gt;layer3_ffn_act_2 -->
<g id="edge294" class="edge">
<title>layer3_ffn_gate_2&#45;&gt;layer3_ffn_act_2</title>
<path fill="none" stroke="black" d="M3141.51,-6146.68C3147.82,-6118.11 3156.07,-6080.74 3161.57,-6055.86"/>
<polygon fill="black" stroke="black" points="3165,-6056.54 3163.74,-6046.02 3158.17,-6055.03 3165,-6056.54"/>
</g>
<!-- layer3_ffn_gate_3 -->
<g id="node264" class="node">
<title>layer3_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4430,-6230 3957,-6230 3957,-6147 4430,-6147 4430,-6230"/>
<text text-anchor="middle" x="4193.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4193.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4193.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4193.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4193.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_ffn_act_3 -->
<g id="node305" class="node">
<title>layer3_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4743,-6046 4612,-6046 4612,-6010 4743,-6010 4743,-6046"/>
<text text-anchor="middle" x="4677.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_3</text>
</g>
<!-- layer3_ffn_gate_3&#45;&gt;layer3_ffn_act_3 -->
<g id="edge305" class="edge">
<title>layer3_ffn_gate_3&#45;&gt;layer3_ffn_act_3</title>
<path fill="none" stroke="black" d="M4317.2,-6146.99C4412.62,-6115.74 4540.59,-6073.83 4615.54,-6049.29"/>
<polygon fill="black" stroke="black" points="4616.89,-6052.53 4625.31,-6046.09 4614.71,-6045.88 4616.89,-6052.53"/>
</g>
<!-- layer3_ffn_gate_4 -->
<g id="node265" class="node">
<title>layer3_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5514,-6230 5041,-6230 5041,-6147 5514,-6147 5514,-6230"/>
<text text-anchor="middle" x="5277.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5277.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5277.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5277.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5277.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_ffn_act_4 -->
<g id="node310" class="node">
<title>layer3_ffn_act_4</title>
<polygon fill="none" stroke="black" points="5390,-6046 5259,-6046 5259,-6010 5390,-6010 5390,-6046"/>
<text text-anchor="middle" x="5324.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_4</text>
</g>
<!-- layer3_ffn_gate_4&#45;&gt;layer3_ffn_act_4 -->
<g id="edge316" class="edge">
<title>layer3_ffn_gate_4&#45;&gt;layer3_ffn_act_4</title>
<path fill="none" stroke="black" d="M5289.6,-6146.68C5298.08,-6118.11 5309.16,-6080.74 5316.53,-6055.86"/>
<polygon fill="black" stroke="black" points="5319.96,-6056.61 5319.45,-6046.02 5313.25,-6054.62 5319.96,-6056.61"/>
</g>
<!-- layer3_ffn_gate_5 -->
<g id="node266" class="node">
<title>layer3_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6900,-6230 6427,-6230 6427,-6147 6900,-6147 6900,-6230"/>
<text text-anchor="middle" x="6663.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6663.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6663.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6663.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6663.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_ffn_act_5 -->
<g id="node315" class="node">
<title>layer3_ffn_act_5</title>
<polygon fill="none" stroke="black" points="7075,-6046 6944,-6046 6944,-6010 7075,-6010 7075,-6046"/>
<text text-anchor="middle" x="7009.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_5</text>
</g>
<!-- layer3_ffn_gate_5&#45;&gt;layer3_ffn_act_5 -->
<g id="edge327" class="edge">
<title>layer3_ffn_gate_5&#45;&gt;layer3_ffn_act_5</title>
<path fill="none" stroke="black" d="M6752.15,-6146.89C6819.4,-6116.08 6909.15,-6074.97 6962.95,-6050.32"/>
<polygon fill="black" stroke="black" points="6964.6,-6053.42 6972.24,-6046.07 6961.69,-6047.05 6964.6,-6053.42"/>
</g>
<!-- layer3_ffn_gate_6 -->
<g id="node267" class="node">
<title>layer3_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="7882,-6230 7409,-6230 7409,-6147 7882,-6147 7882,-6230"/>
<text text-anchor="middle" x="7645.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7645.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7645.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7645.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7645.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_ffn_act_6 -->
<g id="node320" class="node">
<title>layer3_ffn_act_6</title>
<polygon fill="none" stroke="black" points="8163,-6046 8032,-6046 8032,-6010 8163,-6010 8163,-6046"/>
<text text-anchor="middle" x="8097.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer3_ffn_act_6</text>
</g>
<!-- layer3_ffn_gate_6&#45;&gt;layer3_ffn_act_6 -->
<g id="edge338" class="edge">
<title>layer3_ffn_gate_6&#45;&gt;layer3_ffn_act_6</title>
<path fill="none" stroke="black" d="M7761.02,-6146.99C7849.95,-6115.81 7969.16,-6074.01 8039.21,-6049.44"/>
<polygon fill="black" stroke="black" points="8040.48,-6052.7 8048.76,-6046.09 8038.16,-6046.1 8040.48,-6052.7"/>
</g>
<!-- layer3_ffn_act_7 -->
<g id="node277" class="node">
<title>layer3_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9584.24,-6111 8827.44,-6111 8632.76,-5945 9389.56,-5945 9584.24,-6111"/>
<text text-anchor="middle" x="9108.5" y="-6054.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="9108.5" y="-6039.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="9108.5" y="-6024.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9108.5" y="-6009.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9108.5" y="-5994.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_ffn_gate_7&#45;&gt;layer3_ffn_act_7 -->
<g id="edge349" class="edge">
<title>layer3_ffn_gate_7&#45;&gt;layer3_ffn_act_7</title>
<path fill="none" stroke="black" d="M8753.41,-6146.99C8783.81,-6136.89 8817.57,-6125.67 8851.83,-6114.29"/>
<polygon fill="black" stroke="black" points="8853.11,-6117.55 8861.5,-6111.07 8850.91,-6110.91 8853.11,-6117.55"/>
</g>
<!-- layer3_ffn_up_0 -->
<g id="node269" class="node">
<title>layer3_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="1486,-6230 1013,-6230 1013,-6147 1486,-6147 1486,-6230"/>
<text text-anchor="middle" x="1249.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1249.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1249.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1249.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1249.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_ffn_up_0&#45;&gt;layer3_ffn_act_0 -->
<g id="edge273" class="edge">
<title>layer3_ffn_up_0&#45;&gt;layer3_ffn_act_0</title>
<path fill="none" stroke="black" d="M1222.72,-6146.68C1203.64,-6117.6 1178.57,-6079.41 1162.26,-6054.54"/>
<polygon fill="black" stroke="black" points="1165.08,-6052.46 1156.67,-6046.02 1159.23,-6056.3 1165.08,-6052.46"/>
</g>
<!-- layer3_ffn_up_1 -->
<g id="node270" class="node">
<title>layer3_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2843,-6230 2370,-6230 2370,-6147 2843,-6147 2843,-6230"/>
<text text-anchor="middle" x="2606.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2606.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2606.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2606.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2606.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_ffn_up_1&#45;&gt;layer3_ffn_act_1 -->
<g id="edge284" class="edge">
<title>layer3_ffn_up_1&#45;&gt;layer3_ffn_act_1</title>
<path fill="none" stroke="black" d="M2602.64,-6146.68C2599.95,-6118.24 2596.43,-6081.08 2594.07,-6056.2"/>
<polygon fill="black" stroke="black" points="2597.54,-6055.65 2593.11,-6046.02 2590.57,-6056.31 2597.54,-6055.65"/>
</g>
<!-- layer3_ffn_up_2 -->
<g id="node271" class="node">
<title>layer3_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="3860,-6230 3387,-6230 3387,-6147 3860,-6147 3860,-6230"/>
<text text-anchor="middle" x="3623.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3623.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3623.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3623.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3623.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_ffn_up_2&#45;&gt;layer3_ffn_act_2 -->
<g id="edge295" class="edge">
<title>layer3_ffn_up_2&#45;&gt;layer3_ffn_act_2</title>
<path fill="none" stroke="black" d="M3506.96,-6146.99C3417.24,-6115.81 3296.98,-6074.01 3226.31,-6049.44"/>
<polygon fill="black" stroke="black" points="3227.27,-6046.07 3216.67,-6046.09 3224.97,-6052.68 3227.27,-6046.07"/>
</g>
<!-- layer3_ffn_up_3 -->
<g id="node272" class="node">
<title>layer3_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="4921,-6230 4448,-6230 4448,-6147 4921,-6147 4921,-6230"/>
<text text-anchor="middle" x="4684.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4684.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4684.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4684.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4684.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_ffn_up_3&#45;&gt;layer3_ffn_act_3 -->
<g id="edge306" class="edge">
<title>layer3_ffn_up_3&#45;&gt;layer3_ffn_act_3</title>
<path fill="none" stroke="black" d="M4682.7,-6146.68C4681.44,-6118.24 4679.8,-6081.08 4678.7,-6056.2"/>
<polygon fill="black" stroke="black" points="4682.19,-6055.86 4678.25,-6046.02 4675.2,-6056.17 4682.19,-6055.86"/>
</g>
<!-- layer3_ffn_up_4 -->
<g id="node273" class="node">
<title>layer3_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="6005,-6230 5532,-6230 5532,-6147 6005,-6147 6005,-6230"/>
<text text-anchor="middle" x="5768.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5768.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5768.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5768.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5768.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_ffn_up_4&#45;&gt;layer3_ffn_act_4 -->
<g id="edge317" class="edge">
<title>layer3_ffn_up_4&#45;&gt;layer3_ffn_act_4</title>
<path fill="none" stroke="black" d="M5655.02,-6146.99C5567.84,-6115.87 5451.05,-6074.18 5382.18,-6049.59"/>
<polygon fill="black" stroke="black" points="5382.97,-6046.16 5372.38,-6046.09 5380.62,-6052.75 5382.97,-6046.16"/>
</g>
<!-- layer3_ffn_up_5 -->
<g id="node274" class="node">
<title>layer3_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="7391,-6230 6918,-6230 6918,-6147 7391,-6147 7391,-6230"/>
<text text-anchor="middle" x="7154.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7154.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7154.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7154.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7154.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_ffn_up_5&#45;&gt;layer3_ffn_act_5 -->
<g id="edge328" class="edge">
<title>layer3_ffn_up_5&#45;&gt;layer3_ffn_act_5</title>
<path fill="none" stroke="black" d="M7117.16,-6146.68C7090.2,-6117.22 7054.69,-6078.4 7031.97,-6053.57"/>
<polygon fill="black" stroke="black" points="7034.41,-6051.04 7025.07,-6046.02 7029.24,-6055.76 7034.41,-6051.04"/>
</g>
<!-- layer3_ffn_up_6 -->
<g id="node275" class="node">
<title>layer3_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8373,-6230 7900,-6230 7900,-6147 8373,-6147 8373,-6230"/>
<text text-anchor="middle" x="8136.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8136.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8136.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8136.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8136.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_ffn_up_6&#45;&gt;layer3_ffn_act_6 -->
<g id="edge339" class="edge">
<title>layer3_ffn_up_6&#45;&gt;layer3_ffn_act_6</title>
<path fill="none" stroke="black" d="M8126.46,-6146.68C8119.43,-6118.11 8110.23,-6080.74 8104.11,-6055.86"/>
<polygon fill="black" stroke="black" points="8107.48,-6054.9 8101.69,-6046.02 8100.68,-6056.57 8107.48,-6054.9"/>
</g>
<!-- layer3_ffn_up_7&#45;&gt;layer3_ffn_act_7 -->
<g id="edge350" class="edge">
<title>layer3_ffn_up_7&#45;&gt;layer3_ffn_act_7</title>
<path fill="none" stroke="black" d="M9118.89,-6146.68C9118.19,-6138.75 9117.43,-6130.14 9116.65,-6121.31"/>
<polygon fill="black" stroke="black" points="9120.13,-6120.93 9115.77,-6111.27 9113.16,-6121.54 9120.13,-6120.93"/>
</g>
<!-- layer3_ffn_down_7 -->
<g id="node285" class="node">
<title>layer3_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="9332,-5909 8885,-5909 8885,-5826 9332,-5826 9332,-5909"/>
<text text-anchor="middle" x="9108.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9108.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9108.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9108.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9108.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_ffn_act_7&#45;&gt;layer3_ffn_down_7 -->
<g id="edge351" class="edge">
<title>layer3_ffn_act_7&#45;&gt;layer3_ffn_down_7</title>
<path fill="none" stroke="black" d="M9108.5,-5944.96C9108.5,-5936.25 9108.5,-5927.59 9108.5,-5919.39"/>
<polygon fill="black" stroke="black" points="9112,-5919.29 9108.5,-5909.29 9105,-5919.29 9112,-5919.29"/>
</g>
<!-- layer3_ffn_down_0 -->
<g id="node278" class="node">
<title>layer3_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="1369,-5909 922,-5909 922,-5826 1369,-5826 1369,-5909"/>
<text text-anchor="middle" x="1145.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1145.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1145.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1145.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1145.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_res2_0 -->
<g id="node291" class="node">
<title>layer3_res2_0</title>
<polygon fill="none" stroke="black" points="1203.5,-5725 1087.5,-5725 1087.5,-5689 1203.5,-5689 1203.5,-5725"/>
<text text-anchor="middle" x="1145.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_0</text>
</g>
<!-- layer3_ffn_down_0&#45;&gt;layer3_res2_0 -->
<g id="edge275" class="edge">
<title>layer3_ffn_down_0&#45;&gt;layer3_res2_0</title>
<path fill="none" stroke="black" d="M1145.5,-5825.68C1145.5,-5797.24 1145.5,-5760.08 1145.5,-5735.2"/>
<polygon fill="black" stroke="black" points="1149,-5735.02 1145.5,-5725.02 1142,-5735.02 1149,-5735.02"/>
</g>
<!-- layer3_ffn_down_1 -->
<g id="node279" class="node">
<title>layer3_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="2815,-5909 2368,-5909 2368,-5826 2815,-5826 2815,-5909"/>
<text text-anchor="middle" x="2591.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2591.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2591.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2591.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2591.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_res2_1 -->
<g id="node296" class="node">
<title>layer3_res2_1</title>
<polygon fill="none" stroke="black" points="2649.5,-5725 2533.5,-5725 2533.5,-5689 2649.5,-5689 2649.5,-5725"/>
<text text-anchor="middle" x="2591.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_1</text>
</g>
<!-- layer3_ffn_down_1&#45;&gt;layer3_res2_1 -->
<g id="edge286" class="edge">
<title>layer3_ffn_down_1&#45;&gt;layer3_res2_1</title>
<path fill="none" stroke="black" d="M2591.5,-5825.68C2591.5,-5797.24 2591.5,-5760.08 2591.5,-5735.2"/>
<polygon fill="black" stroke="black" points="2595,-5735.02 2591.5,-5725.02 2588,-5735.02 2595,-5735.02"/>
</g>
<!-- layer3_ffn_down_2 -->
<g id="node280" class="node">
<title>layer3_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3391,-5909 2944,-5909 2944,-5826 3391,-5826 3391,-5909"/>
<text text-anchor="middle" x="3167.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3167.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3167.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3167.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3167.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_res2_2 -->
<g id="node301" class="node">
<title>layer3_res2_2</title>
<polygon fill="none" stroke="black" points="3225.5,-5725 3109.5,-5725 3109.5,-5689 3225.5,-5689 3225.5,-5725"/>
<text text-anchor="middle" x="3167.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_2</text>
</g>
<!-- layer3_ffn_down_2&#45;&gt;layer3_res2_2 -->
<g id="edge297" class="edge">
<title>layer3_ffn_down_2&#45;&gt;layer3_res2_2</title>
<path fill="none" stroke="black" d="M3167.5,-5825.68C3167.5,-5797.24 3167.5,-5760.08 3167.5,-5735.2"/>
<polygon fill="black" stroke="black" points="3171,-5735.02 3167.5,-5725.02 3164,-5735.02 3171,-5735.02"/>
</g>
<!-- layer3_ffn_down_3 -->
<g id="node281" class="node">
<title>layer3_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4901,-5909 4454,-5909 4454,-5826 4901,-5826 4901,-5909"/>
<text text-anchor="middle" x="4677.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4677.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4677.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4677.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4677.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_res2_3 -->
<g id="node306" class="node">
<title>layer3_res2_3</title>
<polygon fill="none" stroke="black" points="4735.5,-5725 4619.5,-5725 4619.5,-5689 4735.5,-5689 4735.5,-5725"/>
<text text-anchor="middle" x="4677.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_3</text>
</g>
<!-- layer3_ffn_down_3&#45;&gt;layer3_res2_3 -->
<g id="edge308" class="edge">
<title>layer3_ffn_down_3&#45;&gt;layer3_res2_3</title>
<path fill="none" stroke="black" d="M4677.5,-5825.68C4677.5,-5797.24 4677.5,-5760.08 4677.5,-5735.2"/>
<polygon fill="black" stroke="black" points="4681,-5735.02 4677.5,-5725.02 4674,-5735.02 4681,-5735.02"/>
</g>
<!-- layer3_ffn_down_4 -->
<g id="node282" class="node">
<title>layer3_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="5548,-5909 5101,-5909 5101,-5826 5548,-5826 5548,-5909"/>
<text text-anchor="middle" x="5324.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5324.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5324.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5324.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5324.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_res2_4 -->
<g id="node311" class="node">
<title>layer3_res2_4</title>
<polygon fill="none" stroke="black" points="5382.5,-5725 5266.5,-5725 5266.5,-5689 5382.5,-5689 5382.5,-5725"/>
<text text-anchor="middle" x="5324.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_4</text>
</g>
<!-- layer3_ffn_down_4&#45;&gt;layer3_res2_4 -->
<g id="edge319" class="edge">
<title>layer3_ffn_down_4&#45;&gt;layer3_res2_4</title>
<path fill="none" stroke="black" d="M5324.5,-5825.68C5324.5,-5797.24 5324.5,-5760.08 5324.5,-5735.2"/>
<polygon fill="black" stroke="black" points="5328,-5735.02 5324.5,-5725.02 5321,-5735.02 5328,-5735.02"/>
</g>
<!-- layer3_ffn_down_5 -->
<g id="node283" class="node">
<title>layer3_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="7233,-5909 6786,-5909 6786,-5826 7233,-5826 7233,-5909"/>
<text text-anchor="middle" x="7009.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7009.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7009.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7009.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7009.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_res2_5 -->
<g id="node316" class="node">
<title>layer3_res2_5</title>
<polygon fill="none" stroke="black" points="7067.5,-5725 6951.5,-5725 6951.5,-5689 7067.5,-5689 7067.5,-5725"/>
<text text-anchor="middle" x="7009.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_5</text>
</g>
<!-- layer3_ffn_down_5&#45;&gt;layer3_res2_5 -->
<g id="edge330" class="edge">
<title>layer3_ffn_down_5&#45;&gt;layer3_res2_5</title>
<path fill="none" stroke="black" d="M7009.5,-5825.68C7009.5,-5797.24 7009.5,-5760.08 7009.5,-5735.2"/>
<polygon fill="black" stroke="black" points="7013,-5735.02 7009.5,-5725.02 7006,-5735.02 7013,-5735.02"/>
</g>
<!-- layer3_ffn_down_6 -->
<g id="node284" class="node">
<title>layer3_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="8321,-5909 7874,-5909 7874,-5826 8321,-5826 8321,-5909"/>
<text text-anchor="middle" x="8097.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8097.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8097.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8097.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8097.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_res2_6 -->
<g id="node321" class="node">
<title>layer3_res2_6</title>
<polygon fill="none" stroke="black" points="8155.5,-5725 8039.5,-5725 8039.5,-5689 8155.5,-5689 8155.5,-5725"/>
<text text-anchor="middle" x="8097.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer3_res2_6</text>
</g>
<!-- layer3_ffn_down_6&#45;&gt;layer3_res2_6 -->
<g id="edge341" class="edge">
<title>layer3_ffn_down_6&#45;&gt;layer3_res2_6</title>
<path fill="none" stroke="black" d="M8097.5,-5825.68C8097.5,-5797.24 8097.5,-5760.08 8097.5,-5735.2"/>
<polygon fill="black" stroke="black" points="8101,-5735.02 8097.5,-5725.02 8094,-5735.02 8101,-5735.02"/>
</g>
<!-- layer3_res2_7 -->
<g id="node286" class="node">
<title>layer3_res2_7</title>
<polygon fill="none" stroke="black" points="9549.24,-5790 8848.12,-5790 8667.76,-5624 9368.88,-5624 9549.24,-5790"/>
<text text-anchor="middle" x="9108.5" y="-5733.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9108.5" y="-5718.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5703.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5688.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5673.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_ffn_down_7&#45;&gt;layer3_res2_7 -->
<g id="edge352" class="edge">
<title>layer3_ffn_down_7&#45;&gt;layer3_res2_7</title>
<path fill="none" stroke="black" d="M9108.5,-5825.68C9108.5,-5817.75 9108.5,-5809.14 9108.5,-5800.31"/>
<polygon fill="black" stroke="black" points="9112,-5800.27 9108.5,-5790.27 9105,-5800.27 9112,-5800.27"/>
</g>
<!-- layer4_mha_qkv_7 -->
<g id="node329" class="node">
<title>layer4_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="9386.5,-5588 8830.5,-5588 8830.5,-5505 9386.5,-5505 9386.5,-5588"/>
<text text-anchor="middle" x="9108.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9108.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9108.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9108.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_res2_7&#45;&gt;layer4_mha_qkv_7 -->
<g id="edge430" class="edge">
<title>layer3_res2_7&#45;&gt;layer4_mha_qkv_7</title>
<path fill="none" stroke="black" d="M9108.5,-5623.96C9108.5,-5615.25 9108.5,-5606.59 9108.5,-5598.39"/>
<polygon fill="black" stroke="black" points="9112,-5598.29 9108.5,-5588.29 9105,-5598.29 9112,-5598.29"/>
</g>
<!-- layer3_mha_attn_0&#45;&gt;layer3_mha_out_0 -->
<g id="edge267" class="edge">
<title>layer3_mha_attn_0&#45;&gt;layer3_mha_out_0</title>
<path fill="none" stroke="black" d="M1133.5,-6755.74C1133.5,-6734.18 1133.5,-6696.37 1133.5,-6665.29"/>
<polygon fill="black" stroke="black" points="1137,-6665.04 1133.5,-6655.04 1130,-6665.04 1137,-6665.04"/>
</g>
<!-- layer3_ln1_0 -->
<g id="node289" class="node">
<title>layer3_ln1_0</title>
<polygon fill="none" stroke="black" points="1187,-6318 1080,-6318 1080,-6282 1187,-6282 1187,-6318"/>
<text text-anchor="middle" x="1133.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_0</text>
</g>
<!-- layer3_res1_0&#45;&gt;layer3_ln1_0 -->
<g id="edge269" class="edge">
<title>layer3_res1_0&#45;&gt;layer3_ln1_0</title>
<path fill="none" stroke="black" d="M1133.5,-6434.97C1133.5,-6409.03 1133.5,-6359.36 1133.5,-6328.33"/>
<polygon fill="black" stroke="black" points="1137,-6328.2 1133.5,-6318.2 1130,-6328.2 1137,-6328.2"/>
</g>
<!-- layer3_ln1_0&#45;&gt;layer3_ffn_gate_0 -->
<g id="edge270" class="edge">
<title>layer3_ln1_0&#45;&gt;layer3_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1079.77,-6283.31C1034.69,-6270.15 968.09,-6250.7 907.19,-6232.92"/>
<polygon fill="black" stroke="black" points="908.05,-6229.52 897.47,-6230.08 906.09,-6236.24 908.05,-6229.52"/>
</g>
<!-- layer3_ln1_0&#45;&gt;layer3_ffn_up_0 -->
<g id="edge271" class="edge">
<title>layer3_ln1_0&#45;&gt;layer3_ffn_up_0</title>
<path fill="none" stroke="black" d="M1151.62,-6281.89C1164.33,-6269.89 1181.99,-6253.22 1198.82,-6237.34"/>
<polygon fill="black" stroke="black" points="1201.6,-6239.53 1206.47,-6230.12 1196.8,-6234.44 1201.6,-6239.53"/>
</g>
<!-- layer3_ffn_act_0&#45;&gt;layer3_ffn_down_0 -->
<g id="edge274" class="edge">
<title>layer3_ffn_act_0&#45;&gt;layer3_ffn_down_0</title>
<path fill="none" stroke="black" d="M1145.5,-6009.74C1145.5,-5988.18 1145.5,-5950.37 1145.5,-5919.29"/>
<polygon fill="black" stroke="black" points="1149,-5919.04 1145.5,-5909.04 1142,-5919.04 1149,-5919.04"/>
</g>
<!-- layer4_mha_qkv_0 -->
<g id="node322" class="node">
<title>layer4_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="1423.5,-5588 867.5,-5588 867.5,-5505 1423.5,-5505 1423.5,-5588"/>
<text text-anchor="middle" x="1145.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="1145.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1145.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1145.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="1145.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_res2_0&#45;&gt;layer4_mha_qkv_0 -->
<g id="edge353" class="edge">
<title>layer3_res2_0&#45;&gt;layer4_mha_qkv_0</title>
<path fill="none" stroke="black" d="M1145.5,-5688.74C1145.5,-5667.18 1145.5,-5629.37 1145.5,-5598.29"/>
<polygon fill="black" stroke="black" points="1149,-5598.04 1145.5,-5588.04 1142,-5598.04 1149,-5598.04"/>
</g>
<!-- layer3_mha_attn_1&#45;&gt;layer3_mha_out_1 -->
<g id="edge278" class="edge">
<title>layer3_mha_attn_1&#45;&gt;layer3_mha_out_1</title>
<path fill="none" stroke="black" d="M2247.5,-6755.74C2247.5,-6734.18 2247.5,-6696.37 2247.5,-6665.29"/>
<polygon fill="black" stroke="black" points="2251,-6665.04 2247.5,-6655.04 2244,-6665.04 2251,-6665.04"/>
</g>
<!-- layer3_ln1_1 -->
<g id="node294" class="node">
<title>layer3_ln1_1</title>
<polygon fill="none" stroke="black" points="2301,-6318 2194,-6318 2194,-6282 2301,-6282 2301,-6318"/>
<text text-anchor="middle" x="2247.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_1</text>
</g>
<!-- layer3_res1_1&#45;&gt;layer3_ln1_1 -->
<g id="edge280" class="edge">
<title>layer3_res1_1&#45;&gt;layer3_ln1_1</title>
<path fill="none" stroke="black" d="M2247.5,-6434.97C2247.5,-6409.03 2247.5,-6359.36 2247.5,-6328.33"/>
<polygon fill="black" stroke="black" points="2251,-6328.2 2247.5,-6318.2 2244,-6328.2 2251,-6328.2"/>
</g>
<!-- layer3_ln1_1&#45;&gt;layer3_ffn_gate_1 -->
<g id="edge281" class="edge">
<title>layer3_ln1_1&#45;&gt;layer3_ffn_gate_1</title>
<path fill="none" stroke="black" d="M2226.88,-6281.89C2212.22,-6269.73 2191.77,-6252.77 2172.39,-6236.7"/>
<polygon fill="black" stroke="black" points="2174.4,-6233.81 2164.46,-6230.12 2169.93,-6239.2 2174.4,-6233.81"/>
</g>
<!-- layer3_ln1_1&#45;&gt;layer3_ffn_up_1 -->
<g id="edge282" class="edge">
<title>layer3_ln1_1&#45;&gt;layer3_ffn_up_1</title>
<path fill="none" stroke="black" d="M2301.25,-6282.61C2344.24,-6269.49 2406.57,-6250.48 2463.71,-6233.05"/>
<polygon fill="black" stroke="black" points="2465.03,-6236.31 2473.57,-6230.04 2462.99,-6229.61 2465.03,-6236.31"/>
</g>
<!-- layer3_ffn_act_1&#45;&gt;layer3_ffn_down_1 -->
<g id="edge285" class="edge">
<title>layer3_ffn_act_1&#45;&gt;layer3_ffn_down_1</title>
<path fill="none" stroke="black" d="M2591.5,-6009.74C2591.5,-5988.18 2591.5,-5950.37 2591.5,-5919.29"/>
<polygon fill="black" stroke="black" points="2595,-5919.04 2591.5,-5909.04 2588,-5919.04 2595,-5919.04"/>
</g>
<!-- layer4_mha_qkv_1 -->
<g id="node323" class="node">
<title>layer4_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2869.5,-5588 2313.5,-5588 2313.5,-5505 2869.5,-5505 2869.5,-5588"/>
<text text-anchor="middle" x="2591.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="2591.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2591.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2591.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="2591.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_res2_1&#45;&gt;layer4_mha_qkv_1 -->
<g id="edge364" class="edge">
<title>layer3_res2_1&#45;&gt;layer4_mha_qkv_1</title>
<path fill="none" stroke="black" d="M2591.5,-5688.74C2591.5,-5667.18 2591.5,-5629.37 2591.5,-5598.29"/>
<polygon fill="black" stroke="black" points="2595,-5598.04 2591.5,-5588.04 2588,-5598.04 2595,-5598.04"/>
</g>
<!-- layer3_mha_attn_2&#45;&gt;layer3_mha_out_2 -->
<g id="edge289" class="edge">
<title>layer3_mha_attn_2&#45;&gt;layer3_mha_out_2</title>
<path fill="none" stroke="black" d="M3323.5,-6755.74C3323.5,-6734.18 3323.5,-6696.37 3323.5,-6665.29"/>
<polygon fill="black" stroke="black" points="3327,-6665.04 3323.5,-6655.04 3320,-6665.04 3327,-6665.04"/>
</g>
<!-- layer3_ln1_2 -->
<g id="node299" class="node">
<title>layer3_ln1_2</title>
<polygon fill="none" stroke="black" points="3377,-6318 3270,-6318 3270,-6282 3377,-6282 3377,-6318"/>
<text text-anchor="middle" x="3323.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_2</text>
</g>
<!-- layer3_res1_2&#45;&gt;layer3_ln1_2 -->
<g id="edge291" class="edge">
<title>layer3_res1_2&#45;&gt;layer3_ln1_2</title>
<path fill="none" stroke="black" d="M3323.5,-6434.97C3323.5,-6409.03 3323.5,-6359.36 3323.5,-6328.33"/>
<polygon fill="black" stroke="black" points="3327,-6328.2 3323.5,-6318.2 3320,-6328.2 3327,-6328.2"/>
</g>
<!-- layer3_ln1_2&#45;&gt;layer3_ffn_gate_2 -->
<g id="edge292" class="edge">
<title>layer3_ln1_2&#45;&gt;layer3_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3293.66,-6281.89C3271.79,-6269.35 3241.01,-6251.71 3212.21,-6235.2"/>
<polygon fill="black" stroke="black" points="3213.77,-6232.06 3203.35,-6230.12 3210.28,-6238.13 3213.77,-6232.06"/>
</g>
<!-- layer3_ln1_2&#45;&gt;layer3_ffn_up_2 -->
<g id="edge293" class="edge">
<title>layer3_ln1_2&#45;&gt;layer3_ffn_up_2</title>
<path fill="none" stroke="black" d="M3370.38,-6281.89C3405.91,-6268.92 3456.42,-6250.49 3502.98,-6233.49"/>
<polygon fill="black" stroke="black" points="3504.34,-6236.72 3512.54,-6230 3501.94,-6230.14 3504.34,-6236.72"/>
</g>
<!-- layer3_ffn_act_2&#45;&gt;layer3_ffn_down_2 -->
<g id="edge296" class="edge">
<title>layer3_ffn_act_2&#45;&gt;layer3_ffn_down_2</title>
<path fill="none" stroke="black" d="M3167.5,-6009.74C3167.5,-5988.18 3167.5,-5950.37 3167.5,-5919.29"/>
<polygon fill="black" stroke="black" points="3171,-5919.04 3167.5,-5909.04 3164,-5919.04 3171,-5919.04"/>
</g>
<!-- layer4_mha_qkv_2 -->
<g id="node324" class="node">
<title>layer4_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3445.5,-5588 2889.5,-5588 2889.5,-5505 3445.5,-5505 3445.5,-5588"/>
<text text-anchor="middle" x="3167.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3167.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3167.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3167.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_res2_2&#45;&gt;layer4_mha_qkv_2 -->
<g id="edge375" class="edge">
<title>layer3_res2_2&#45;&gt;layer4_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3167.5,-5688.74C3167.5,-5667.18 3167.5,-5629.37 3167.5,-5598.29"/>
<polygon fill="black" stroke="black" points="3171,-5598.04 3167.5,-5588.04 3164,-5598.04 3171,-5598.04"/>
</g>
<!-- layer3_mha_attn_3&#45;&gt;layer3_mha_out_3 -->
<g id="edge300" class="edge">
<title>layer3_mha_attn_3&#45;&gt;layer3_mha_out_3</title>
<path fill="none" stroke="black" d="M4677.5,-6755.74C4677.5,-6734.18 4677.5,-6696.37 4677.5,-6665.29"/>
<polygon fill="black" stroke="black" points="4681,-6665.04 4677.5,-6655.04 4674,-6665.04 4681,-6665.04"/>
</g>
<!-- layer3_ln1_3 -->
<g id="node304" class="node">
<title>layer3_ln1_3</title>
<polygon fill="none" stroke="black" points="4731,-6318 4624,-6318 4624,-6282 4731,-6282 4731,-6318"/>
<text text-anchor="middle" x="4677.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_3</text>
</g>
<!-- layer3_res1_3&#45;&gt;layer3_ln1_3 -->
<g id="edge302" class="edge">
<title>layer3_res1_3&#45;&gt;layer3_ln1_3</title>
<path fill="none" stroke="black" d="M4677.5,-6434.97C4677.5,-6409.03 4677.5,-6359.36 4677.5,-6328.33"/>
<polygon fill="black" stroke="black" points="4681,-6328.2 4677.5,-6318.2 4674,-6328.2 4681,-6328.2"/>
</g>
<!-- layer3_ln1_3&#45;&gt;layer3_ffn_gate_3 -->
<g id="edge303" class="edge">
<title>layer3_ln1_3&#45;&gt;layer3_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4623.85,-6286.86C4565.61,-6273.69 4469.28,-6251.89 4382.51,-6232.26"/>
<polygon fill="black" stroke="black" points="4383.05,-6228.8 4372.52,-6230 4381.51,-6235.62 4383.05,-6228.8"/>
</g>
<!-- layer3_ln1_3&#45;&gt;layer3_ffn_up_3 -->
<g id="edge304" class="edge">
<title>layer3_ln1_3&#45;&gt;layer3_ffn_up_3</title>
<path fill="none" stroke="black" d="M4678.59,-6281.89C4679.31,-6270.65 4680.29,-6255.31 4681.25,-6240.35"/>
<polygon fill="black" stroke="black" points="4684.76,-6240.32 4681.9,-6230.12 4677.77,-6239.87 4684.76,-6240.32"/>
</g>
<!-- layer3_ffn_act_3&#45;&gt;layer3_ffn_down_3 -->
<g id="edge307" class="edge">
<title>layer3_ffn_act_3&#45;&gt;layer3_ffn_down_3</title>
<path fill="none" stroke="black" d="M4677.5,-6009.74C4677.5,-5988.18 4677.5,-5950.37 4677.5,-5919.29"/>
<polygon fill="black" stroke="black" points="4681,-5919.04 4677.5,-5909.04 4674,-5919.04 4681,-5919.04"/>
</g>
<!-- layer4_mha_qkv_3 -->
<g id="node325" class="node">
<title>layer4_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4955.5,-5588 4399.5,-5588 4399.5,-5505 4955.5,-5505 4955.5,-5588"/>
<text text-anchor="middle" x="4677.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4677.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4677.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4677.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4677.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_res2_3&#45;&gt;layer4_mha_qkv_3 -->
<g id="edge386" class="edge">
<title>layer3_res2_3&#45;&gt;layer4_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4677.5,-5688.74C4677.5,-5667.18 4677.5,-5629.37 4677.5,-5598.29"/>
<polygon fill="black" stroke="black" points="4681,-5598.04 4677.5,-5588.04 4674,-5598.04 4681,-5598.04"/>
</g>
<!-- layer3_mha_attn_4&#45;&gt;layer3_mha_out_4 -->
<g id="edge311" class="edge">
<title>layer3_mha_attn_4&#45;&gt;layer3_mha_out_4</title>
<path fill="none" stroke="black" d="M5732.5,-6755.74C5732.5,-6734.18 5732.5,-6696.37 5732.5,-6665.29"/>
<polygon fill="black" stroke="black" points="5736,-6665.04 5732.5,-6655.04 5729,-6665.04 5736,-6665.04"/>
</g>
<!-- layer3_ln1_4 -->
<g id="node309" class="node">
<title>layer3_ln1_4</title>
<polygon fill="none" stroke="black" points="5786,-6318 5679,-6318 5679,-6282 5786,-6282 5786,-6318"/>
<text text-anchor="middle" x="5732.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_4</text>
</g>
<!-- layer3_res1_4&#45;&gt;layer3_ln1_4 -->
<g id="edge313" class="edge">
<title>layer3_res1_4&#45;&gt;layer3_ln1_4</title>
<path fill="none" stroke="black" d="M5732.5,-6434.97C5732.5,-6409.03 5732.5,-6359.36 5732.5,-6328.33"/>
<polygon fill="black" stroke="black" points="5736,-6328.2 5732.5,-6318.2 5729,-6328.2 5736,-6328.2"/>
</g>
<!-- layer3_ln1_4&#45;&gt;layer3_ffn_gate_4 -->
<g id="edge314" class="edge">
<title>layer3_ln1_4&#45;&gt;layer3_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5678.97,-6286.12C5624.17,-6272.93 5535.97,-6251.7 5456.17,-6232.5"/>
<polygon fill="black" stroke="black" points="5456.53,-6228.98 5445.99,-6230.05 5454.89,-6235.79 5456.53,-6228.98"/>
</g>
<!-- layer3_ln1_4&#45;&gt;layer3_ffn_up_4 -->
<g id="edge315" class="edge">
<title>layer3_ln1_4&#45;&gt;layer3_ffn_up_4</title>
<path fill="none" stroke="black" d="M5738.12,-6281.89C5741.86,-6270.54 5746.96,-6255.01 5751.92,-6239.92"/>
<polygon fill="black" stroke="black" points="5755.35,-6240.71 5755.15,-6230.12 5748.7,-6238.52 5755.35,-6240.71"/>
</g>
<!-- layer3_ffn_act_4&#45;&gt;layer3_ffn_down_4 -->
<g id="edge318" class="edge">
<title>layer3_ffn_act_4&#45;&gt;layer3_ffn_down_4</title>
<path fill="none" stroke="black" d="M5324.5,-6009.74C5324.5,-5988.18 5324.5,-5950.37 5324.5,-5919.29"/>
<polygon fill="black" stroke="black" points="5328,-5919.04 5324.5,-5909.04 5321,-5919.04 5328,-5919.04"/>
</g>
<!-- layer4_mha_qkv_4 -->
<g id="node326" class="node">
<title>layer4_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="5602.5,-5588 5046.5,-5588 5046.5,-5505 5602.5,-5505 5602.5,-5588"/>
<text text-anchor="middle" x="5324.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5324.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5324.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5324.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5324.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_res2_4&#45;&gt;layer4_mha_qkv_4 -->
<g id="edge397" class="edge">
<title>layer3_res2_4&#45;&gt;layer4_mha_qkv_4</title>
<path fill="none" stroke="black" d="M5324.5,-5688.74C5324.5,-5667.18 5324.5,-5629.37 5324.5,-5598.29"/>
<polygon fill="black" stroke="black" points="5328,-5598.04 5324.5,-5588.04 5321,-5598.04 5328,-5598.04"/>
</g>
<!-- layer3_mha_attn_5&#45;&gt;layer3_mha_out_5 -->
<g id="edge322" class="edge">
<title>layer3_mha_attn_5&#45;&gt;layer3_mha_out_5</title>
<path fill="none" stroke="black" d="M6667.5,-6755.74C6667.5,-6734.18 6667.5,-6696.37 6667.5,-6665.29"/>
<polygon fill="black" stroke="black" points="6671,-6665.04 6667.5,-6655.04 6664,-6665.04 6671,-6665.04"/>
</g>
<!-- layer3_ln1_5 -->
<g id="node314" class="node">
<title>layer3_ln1_5</title>
<polygon fill="none" stroke="black" points="6721,-6318 6614,-6318 6614,-6282 6721,-6282 6721,-6318"/>
<text text-anchor="middle" x="6667.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_5</text>
</g>
<!-- layer3_res1_5&#45;&gt;layer3_ln1_5 -->
<g id="edge324" class="edge">
<title>layer3_res1_5&#45;&gt;layer3_ln1_5</title>
<path fill="none" stroke="black" d="M6667.5,-6434.97C6667.5,-6409.03 6667.5,-6359.36 6667.5,-6328.33"/>
<polygon fill="black" stroke="black" points="6671,-6328.2 6667.5,-6318.2 6664,-6328.2 6671,-6328.2"/>
</g>
<!-- layer3_ln1_5&#45;&gt;layer3_ffn_gate_5 -->
<g id="edge325" class="edge">
<title>layer3_ln1_5&#45;&gt;layer3_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6666.88,-6281.89C6666.46,-6270.65 6665.9,-6255.31 6665.36,-6240.35"/>
<polygon fill="black" stroke="black" points="6668.85,-6239.98 6664.98,-6230.12 6661.85,-6240.24 6668.85,-6239.98"/>
</g>
<!-- layer3_ln1_5&#45;&gt;layer3_ffn_up_5 -->
<g id="edge326" class="edge">
<title>layer3_ln1_5&#45;&gt;layer3_ffn_up_5</title>
<path fill="none" stroke="black" d="M6721.01,-6286.97C6779.6,-6273.8 6876.89,-6251.92 6964.47,-6232.23"/>
<polygon fill="black" stroke="black" points="6965.29,-6235.63 6974.28,-6230.02 6963.76,-6228.8 6965.29,-6235.63"/>
</g>
<!-- layer3_ffn_act_5&#45;&gt;layer3_ffn_down_5 -->
<g id="edge329" class="edge">
<title>layer3_ffn_act_5&#45;&gt;layer3_ffn_down_5</title>
<path fill="none" stroke="black" d="M7009.5,-6009.74C7009.5,-5988.18 7009.5,-5950.37 7009.5,-5919.29"/>
<polygon fill="black" stroke="black" points="7013,-5919.04 7009.5,-5909.04 7006,-5919.04 7013,-5919.04"/>
</g>
<!-- layer4_mha_qkv_5 -->
<g id="node327" class="node">
<title>layer4_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="7287.5,-5588 6731.5,-5588 6731.5,-5505 7287.5,-5505 7287.5,-5588"/>
<text text-anchor="middle" x="7009.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7009.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7009.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7009.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7009.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_res2_5&#45;&gt;layer4_mha_qkv_5 -->
<g id="edge408" class="edge">
<title>layer3_res2_5&#45;&gt;layer4_mha_qkv_5</title>
<path fill="none" stroke="black" d="M7009.5,-5688.74C7009.5,-5667.18 7009.5,-5629.37 7009.5,-5598.29"/>
<polygon fill="black" stroke="black" points="7013,-5598.04 7009.5,-5588.04 7006,-5598.04 7013,-5598.04"/>
</g>
<!-- layer3_mha_attn_6&#45;&gt;layer3_mha_out_6 -->
<g id="edge333" class="edge">
<title>layer3_mha_attn_6&#45;&gt;layer3_mha_out_6</title>
<path fill="none" stroke="black" d="M7883.5,-6755.74C7883.5,-6734.18 7883.5,-6696.37 7883.5,-6665.29"/>
<polygon fill="black" stroke="black" points="7887,-6665.04 7883.5,-6655.04 7880,-6665.04 7887,-6665.04"/>
</g>
<!-- layer3_ln1_6 -->
<g id="node319" class="node">
<title>layer3_ln1_6</title>
<polygon fill="none" stroke="black" points="7937,-6318 7830,-6318 7830,-6282 7937,-6282 7937,-6318"/>
<text text-anchor="middle" x="7883.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer3_ln1_6</text>
</g>
<!-- layer3_res1_6&#45;&gt;layer3_ln1_6 -->
<g id="edge335" class="edge">
<title>layer3_res1_6&#45;&gt;layer3_ln1_6</title>
<path fill="none" stroke="black" d="M7883.5,-6434.97C7883.5,-6409.03 7883.5,-6359.36 7883.5,-6328.33"/>
<polygon fill="black" stroke="black" points="7887,-6328.2 7883.5,-6318.2 7880,-6328.2 7887,-6328.2"/>
</g>
<!-- layer3_ln1_6&#45;&gt;layer3_ffn_gate_6 -->
<g id="edge336" class="edge">
<title>layer3_ln1_6&#45;&gt;layer3_ffn_gate_6</title>
<path fill="none" stroke="black" d="M7846.31,-6281.89C7818.53,-6269.11 7779.22,-6251.02 7742.74,-6234.24"/>
<polygon fill="black" stroke="black" points="7744.08,-6231 7733.53,-6230 7741.15,-6237.36 7744.08,-6231"/>
</g>
<!-- layer3_ln1_6&#45;&gt;layer3_ffn_up_6 -->
<g id="edge337" class="edge">
<title>layer3_ln1_6&#45;&gt;layer3_ffn_up_6</title>
<path fill="none" stroke="black" d="M7923.03,-6281.89C7952.69,-6269.06 7994.7,-6250.87 8033.63,-6234.02"/>
<polygon fill="black" stroke="black" points="8035.13,-6237.19 8042.92,-6230 8032.35,-6230.76 8035.13,-6237.19"/>
</g>
<!-- layer3_ffn_act_6&#45;&gt;layer3_ffn_down_6 -->
<g id="edge340" class="edge">
<title>layer3_ffn_act_6&#45;&gt;layer3_ffn_down_6</title>
<path fill="none" stroke="black" d="M8097.5,-6009.74C8097.5,-5988.18 8097.5,-5950.37 8097.5,-5919.29"/>
<polygon fill="black" stroke="black" points="8101,-5919.04 8097.5,-5909.04 8094,-5919.04 8101,-5919.04"/>
</g>
<!-- layer4_mha_qkv_6 -->
<g id="node328" class="node">
<title>layer4_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="8375.5,-5588 7819.5,-5588 7819.5,-5505 8375.5,-5505 8375.5,-5588"/>
<text text-anchor="middle" x="8097.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8097.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8097.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8097.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8097.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_res2_6&#45;&gt;layer4_mha_qkv_6 -->
<g id="edge419" class="edge">
<title>layer3_res2_6&#45;&gt;layer4_mha_qkv_6</title>
<path fill="none" stroke="black" d="M8097.5,-5688.74C8097.5,-5667.18 8097.5,-5629.37 8097.5,-5598.29"/>
<polygon fill="black" stroke="black" points="8101,-5598.04 8097.5,-5588.04 8094,-5598.04 8101,-5598.04"/>
</g>
<!-- layer4_mha_attn_0 -->
<g id="node367" class="node">
<title>layer4_mha_attn_0</title>
<polygon fill="none" stroke="black" points="1221,-5404 1070,-5404 1070,-5368 1221,-5368 1221,-5404"/>
<text text-anchor="middle" x="1145.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_0</text>
</g>
<!-- layer4_mha_qkv_0&#45;&gt;layer4_mha_attn_0 -->
<g id="edge354" class="edge">
<title>layer4_mha_qkv_0&#45;&gt;layer4_mha_attn_0</title>
<path fill="none" stroke="black" d="M1145.5,-5504.68C1145.5,-5476.24 1145.5,-5439.08 1145.5,-5414.2"/>
<polygon fill="black" stroke="black" points="1149,-5414.02 1145.5,-5404.02 1142,-5414.02 1149,-5414.02"/>
</g>
<!-- layer4_mha_attn_1 -->
<g id="node372" class="node">
<title>layer4_mha_attn_1</title>
<polygon fill="none" stroke="black" points="2667,-5404 2516,-5404 2516,-5368 2667,-5368 2667,-5404"/>
<text text-anchor="middle" x="2591.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_1</text>
</g>
<!-- layer4_mha_qkv_1&#45;&gt;layer4_mha_attn_1 -->
<g id="edge365" class="edge">
<title>layer4_mha_qkv_1&#45;&gt;layer4_mha_attn_1</title>
<path fill="none" stroke="black" d="M2591.5,-5504.68C2591.5,-5476.24 2591.5,-5439.08 2591.5,-5414.2"/>
<polygon fill="black" stroke="black" points="2595,-5414.02 2591.5,-5404.02 2588,-5414.02 2595,-5414.02"/>
</g>
<!-- layer4_mha_attn_2 -->
<g id="node377" class="node">
<title>layer4_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3243,-5404 3092,-5404 3092,-5368 3243,-5368 3243,-5404"/>
<text text-anchor="middle" x="3167.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_2</text>
</g>
<!-- layer4_mha_qkv_2&#45;&gt;layer4_mha_attn_2 -->
<g id="edge376" class="edge">
<title>layer4_mha_qkv_2&#45;&gt;layer4_mha_attn_2</title>
<path fill="none" stroke="black" d="M3167.5,-5504.68C3167.5,-5476.24 3167.5,-5439.08 3167.5,-5414.2"/>
<polygon fill="black" stroke="black" points="3171,-5414.02 3167.5,-5404.02 3164,-5414.02 3171,-5414.02"/>
</g>
<!-- layer4_mha_attn_3 -->
<g id="node382" class="node">
<title>layer4_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4753,-5404 4602,-5404 4602,-5368 4753,-5368 4753,-5404"/>
<text text-anchor="middle" x="4677.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_3</text>
</g>
<!-- layer4_mha_qkv_3&#45;&gt;layer4_mha_attn_3 -->
<g id="edge387" class="edge">
<title>layer4_mha_qkv_3&#45;&gt;layer4_mha_attn_3</title>
<path fill="none" stroke="black" d="M4677.5,-5504.68C4677.5,-5476.24 4677.5,-5439.08 4677.5,-5414.2"/>
<polygon fill="black" stroke="black" points="4681,-5414.02 4677.5,-5404.02 4674,-5414.02 4681,-5414.02"/>
</g>
<!-- layer4_mha_attn_4 -->
<g id="node387" class="node">
<title>layer4_mha_attn_4</title>
<polygon fill="none" stroke="black" points="5400,-5404 5249,-5404 5249,-5368 5400,-5368 5400,-5404"/>
<text text-anchor="middle" x="5324.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_4</text>
</g>
<!-- layer4_mha_qkv_4&#45;&gt;layer4_mha_attn_4 -->
<g id="edge398" class="edge">
<title>layer4_mha_qkv_4&#45;&gt;layer4_mha_attn_4</title>
<path fill="none" stroke="black" d="M5324.5,-5504.68C5324.5,-5476.24 5324.5,-5439.08 5324.5,-5414.2"/>
<polygon fill="black" stroke="black" points="5328,-5414.02 5324.5,-5404.02 5321,-5414.02 5328,-5414.02"/>
</g>
<!-- layer4_mha_attn_5 -->
<g id="node392" class="node">
<title>layer4_mha_attn_5</title>
<polygon fill="none" stroke="black" points="7085,-5404 6934,-5404 6934,-5368 7085,-5368 7085,-5404"/>
<text text-anchor="middle" x="7009.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_5</text>
</g>
<!-- layer4_mha_qkv_5&#45;&gt;layer4_mha_attn_5 -->
<g id="edge409" class="edge">
<title>layer4_mha_qkv_5&#45;&gt;layer4_mha_attn_5</title>
<path fill="none" stroke="black" d="M7009.5,-5504.68C7009.5,-5476.24 7009.5,-5439.08 7009.5,-5414.2"/>
<polygon fill="black" stroke="black" points="7013,-5414.02 7009.5,-5404.02 7006,-5414.02 7013,-5414.02"/>
</g>
<!-- layer4_mha_attn_6 -->
<g id="node397" class="node">
<title>layer4_mha_attn_6</title>
<polygon fill="none" stroke="black" points="8173,-5404 8022,-5404 8022,-5368 8173,-5368 8173,-5404"/>
<text text-anchor="middle" x="8097.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer4_mha_attn_6</text>
</g>
<!-- layer4_mha_qkv_6&#45;&gt;layer4_mha_attn_6 -->
<g id="edge420" class="edge">
<title>layer4_mha_qkv_6&#45;&gt;layer4_mha_attn_6</title>
<path fill="none" stroke="black" d="M8097.5,-5504.68C8097.5,-5476.24 8097.5,-5439.08 8097.5,-5414.2"/>
<polygon fill="black" stroke="black" points="8101,-5414.02 8097.5,-5404.02 8094,-5414.02 8101,-5414.02"/>
</g>
<!-- layer4_mha_attn_7 -->
<g id="node330" class="node">
<title>layer4_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9585.31,-5469 8826.81,-5469 8631.69,-5303 9390.19,-5303 9585.31,-5469"/>
<text text-anchor="middle" x="9108.5" y="-5412.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="9108.5" y="-5397.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="9108.5" y="-5382.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9108.5" y="-5367.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5352.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_mha_qkv_7&#45;&gt;layer4_mha_attn_7 -->
<g id="edge431" class="edge">
<title>layer4_mha_qkv_7&#45;&gt;layer4_mha_attn_7</title>
<path fill="none" stroke="black" d="M9108.5,-5504.68C9108.5,-5496.75 9108.5,-5488.14 9108.5,-5479.31"/>
<polygon fill="black" stroke="black" points="9112,-5479.27 9108.5,-5469.27 9105,-5479.27 9112,-5479.27"/>
</g>
<!-- layer4_mha_out_7 -->
<g id="node338" class="node">
<title>layer4_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="9327.5,-5267 8889.5,-5267 8889.5,-5184 9327.5,-5184 9327.5,-5267"/>
<text text-anchor="middle" x="9108.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9108.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9108.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9108.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_mha_attn_7&#45;&gt;layer4_mha_out_7 -->
<g id="edge432" class="edge">
<title>layer4_mha_attn_7&#45;&gt;layer4_mha_out_7</title>
<path fill="none" stroke="black" d="M9108.5,-5302.96C9108.5,-5294.25 9108.5,-5285.59 9108.5,-5277.39"/>
<polygon fill="black" stroke="black" points="9112,-5277.29 9108.5,-5267.29 9105,-5277.29 9112,-5277.29"/>
</g>
<!-- layer4_mha_out_0 -->
<g id="node331" class="node">
<title>layer4_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="1364.5,-5267 926.5,-5267 926.5,-5184 1364.5,-5184 1364.5,-5267"/>
<text text-anchor="middle" x="1145.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="1145.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1145.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1145.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1145.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_res1_0 -->
<g id="node368" class="node">
<title>layer4_res1_0</title>
<polygon fill="none" stroke="black" points="1203.5,-5083 1087.5,-5083 1087.5,-5047 1203.5,-5047 1203.5,-5083"/>
<text text-anchor="middle" x="1145.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_0</text>
</g>
<!-- layer4_mha_out_0&#45;&gt;layer4_res1_0 -->
<g id="edge356" class="edge">
<title>layer4_mha_out_0&#45;&gt;layer4_res1_0</title>
<path fill="none" stroke="black" d="M1145.5,-5183.68C1145.5,-5155.24 1145.5,-5118.08 1145.5,-5093.2"/>
<polygon fill="black" stroke="black" points="1149,-5093.02 1145.5,-5083.02 1142,-5093.02 1149,-5093.02"/>
</g>
<!-- layer4_mha_out_1 -->
<g id="node332" class="node">
<title>layer4_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2810.5,-5267 2372.5,-5267 2372.5,-5184 2810.5,-5184 2810.5,-5267"/>
<text text-anchor="middle" x="2591.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="2591.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2591.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2591.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2591.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_res1_1 -->
<g id="node373" class="node">
<title>layer4_res1_1</title>
<polygon fill="none" stroke="black" points="2649.5,-5083 2533.5,-5083 2533.5,-5047 2649.5,-5047 2649.5,-5083"/>
<text text-anchor="middle" x="2591.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_1</text>
</g>
<!-- layer4_mha_out_1&#45;&gt;layer4_res1_1 -->
<g id="edge367" class="edge">
<title>layer4_mha_out_1&#45;&gt;layer4_res1_1</title>
<path fill="none" stroke="black" d="M2591.5,-5183.68C2591.5,-5155.24 2591.5,-5118.08 2591.5,-5093.2"/>
<polygon fill="black" stroke="black" points="2595,-5093.02 2591.5,-5083.02 2588,-5093.02 2595,-5093.02"/>
</g>
<!-- layer4_mha_out_2 -->
<g id="node333" class="node">
<title>layer4_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3386.5,-5267 2948.5,-5267 2948.5,-5184 3386.5,-5184 3386.5,-5267"/>
<text text-anchor="middle" x="3167.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3167.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3167.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3167.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_res1_2 -->
<g id="node378" class="node">
<title>layer4_res1_2</title>
<polygon fill="none" stroke="black" points="3225.5,-5083 3109.5,-5083 3109.5,-5047 3225.5,-5047 3225.5,-5083"/>
<text text-anchor="middle" x="3167.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_2</text>
</g>
<!-- layer4_mha_out_2&#45;&gt;layer4_res1_2 -->
<g id="edge378" class="edge">
<title>layer4_mha_out_2&#45;&gt;layer4_res1_2</title>
<path fill="none" stroke="black" d="M3167.5,-5183.68C3167.5,-5155.24 3167.5,-5118.08 3167.5,-5093.2"/>
<polygon fill="black" stroke="black" points="3171,-5093.02 3167.5,-5083.02 3164,-5093.02 3171,-5093.02"/>
</g>
<!-- layer4_mha_out_3 -->
<g id="node334" class="node">
<title>layer4_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4896.5,-5267 4458.5,-5267 4458.5,-5184 4896.5,-5184 4896.5,-5267"/>
<text text-anchor="middle" x="4677.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4677.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4677.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4677.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4677.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_res1_3 -->
<g id="node383" class="node">
<title>layer4_res1_3</title>
<polygon fill="none" stroke="black" points="4735.5,-5083 4619.5,-5083 4619.5,-5047 4735.5,-5047 4735.5,-5083"/>
<text text-anchor="middle" x="4677.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_3</text>
</g>
<!-- layer4_mha_out_3&#45;&gt;layer4_res1_3 -->
<g id="edge389" class="edge">
<title>layer4_mha_out_3&#45;&gt;layer4_res1_3</title>
<path fill="none" stroke="black" d="M4677.5,-5183.68C4677.5,-5155.24 4677.5,-5118.08 4677.5,-5093.2"/>
<polygon fill="black" stroke="black" points="4681,-5093.02 4677.5,-5083.02 4674,-5093.02 4681,-5093.02"/>
</g>
<!-- layer4_mha_out_4 -->
<g id="node335" class="node">
<title>layer4_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="5543.5,-5267 5105.5,-5267 5105.5,-5184 5543.5,-5184 5543.5,-5267"/>
<text text-anchor="middle" x="5324.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="5324.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5324.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5324.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5324.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_res1_4 -->
<g id="node388" class="node">
<title>layer4_res1_4</title>
<polygon fill="none" stroke="black" points="5382.5,-5083 5266.5,-5083 5266.5,-5047 5382.5,-5047 5382.5,-5083"/>
<text text-anchor="middle" x="5324.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_4</text>
</g>
<!-- layer4_mha_out_4&#45;&gt;layer4_res1_4 -->
<g id="edge400" class="edge">
<title>layer4_mha_out_4&#45;&gt;layer4_res1_4</title>
<path fill="none" stroke="black" d="M5324.5,-5183.68C5324.5,-5155.24 5324.5,-5118.08 5324.5,-5093.2"/>
<polygon fill="black" stroke="black" points="5328,-5093.02 5324.5,-5083.02 5321,-5093.02 5328,-5093.02"/>
</g>
<!-- layer4_mha_out_5 -->
<g id="node336" class="node">
<title>layer4_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="7228.5,-5267 6790.5,-5267 6790.5,-5184 7228.5,-5184 7228.5,-5267"/>
<text text-anchor="middle" x="7009.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7009.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7009.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7009.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7009.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_res1_5 -->
<g id="node393" class="node">
<title>layer4_res1_5</title>
<polygon fill="none" stroke="black" points="7067.5,-5083 6951.5,-5083 6951.5,-5047 7067.5,-5047 7067.5,-5083"/>
<text text-anchor="middle" x="7009.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_5</text>
</g>
<!-- layer4_mha_out_5&#45;&gt;layer4_res1_5 -->
<g id="edge411" class="edge">
<title>layer4_mha_out_5&#45;&gt;layer4_res1_5</title>
<path fill="none" stroke="black" d="M7009.5,-5183.68C7009.5,-5155.24 7009.5,-5118.08 7009.5,-5093.2"/>
<polygon fill="black" stroke="black" points="7013,-5093.02 7009.5,-5083.02 7006,-5093.02 7013,-5093.02"/>
</g>
<!-- layer4_mha_out_6 -->
<g id="node337" class="node">
<title>layer4_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="8316.5,-5267 7878.5,-5267 7878.5,-5184 8316.5,-5184 8316.5,-5267"/>
<text text-anchor="middle" x="8097.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8097.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8097.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8097.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8097.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_res1_6 -->
<g id="node398" class="node">
<title>layer4_res1_6</title>
<polygon fill="none" stroke="black" points="8155.5,-5083 8039.5,-5083 8039.5,-5047 8155.5,-5047 8155.5,-5083"/>
<text text-anchor="middle" x="8097.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer4_res1_6</text>
</g>
<!-- layer4_mha_out_6&#45;&gt;layer4_res1_6 -->
<g id="edge422" class="edge">
<title>layer4_mha_out_6&#45;&gt;layer4_res1_6</title>
<path fill="none" stroke="black" d="M8097.5,-5183.68C8097.5,-5155.24 8097.5,-5118.08 8097.5,-5093.2"/>
<polygon fill="black" stroke="black" points="8101,-5093.02 8097.5,-5083.02 8094,-5093.02 8101,-5093.02"/>
</g>
<!-- layer4_res1_7 -->
<g id="node339" class="node">
<title>layer4_res1_7</title>
<polygon fill="none" stroke="black" points="9549.24,-5148 8848.12,-5148 8667.76,-4982 9368.88,-4982 9549.24,-5148"/>
<text text-anchor="middle" x="9108.5" y="-5091.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9108.5" y="-5076.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5061.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5046.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-5031.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_mha_out_7&#45;&gt;layer4_res1_7 -->
<g id="edge433" class="edge">
<title>layer4_mha_out_7&#45;&gt;layer4_res1_7</title>
<path fill="none" stroke="black" d="M9108.5,-5183.68C9108.5,-5175.75 9108.5,-5167.14 9108.5,-5158.31"/>
<polygon fill="black" stroke="black" points="9112,-5158.27 9108.5,-5148.27 9105,-5158.27 9112,-5158.27"/>
</g>
<!-- layer4_ln1_7 -->
<g id="node340" class="node">
<title>layer4_ln1_7</title>
<polygon fill="yellow" stroke="black" points="9321,-4946 8896,-4946 8896,-4878 9321,-4878 9321,-4946"/>
<text text-anchor="middle" x="9108.5" y="-4930.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="9108.5" y="-4915.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-4900.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9108.5" y="-4885.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_res1_7&#45;&gt;layer4_ln1_7 -->
<g id="edge434" class="edge">
<title>layer4_res1_7&#45;&gt;layer4_ln1_7</title>
<path fill="none" stroke="black" d="M9108.5,-4981.87C9108.5,-4973.12 9108.5,-4964.48 9108.5,-4956.45"/>
<polygon fill="black" stroke="black" points="9112,-4956.26 9108.5,-4946.26 9105,-4956.26 9112,-4956.26"/>
</g>
<!-- layer4_ffn_gate_7 -->
<g id="node348" class="node">
<title>layer4_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="9329,-4842 8856,-4842 8856,-4759 9329,-4759 9329,-4842"/>
<text text-anchor="middle" x="9092.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9092.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9092.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9092.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9092.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_ln1_7&#45;&gt;layer4_ffn_gate_7 -->
<g id="edge435" class="edge">
<title>layer4_ln1_7&#45;&gt;layer4_ffn_gate_7</title>
<path fill="none" stroke="black" d="M9103.66,-4877.85C9102.48,-4869.8 9101.19,-4861 9099.93,-4852.34"/>
<polygon fill="black" stroke="black" points="9103.37,-4851.67 9098.46,-4842.28 9096.44,-4852.68 9103.37,-4851.67"/>
</g>
<!-- layer4_ffn_up_7 -->
<g id="node356" class="node">
<title>layer4_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9820,-4842 9347,-4842 9347,-4759 9820,-4759 9820,-4842"/>
<text text-anchor="middle" x="9583.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9583.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9583.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9583.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9583.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_ln1_7&#45;&gt;layer4_ffn_up_7 -->
<g id="edge436" class="edge">
<title>layer4_ln1_7&#45;&gt;layer4_ffn_up_7</title>
<path fill="none" stroke="black" d="M9251.66,-4878C9297.53,-4867.42 9349.01,-4855.56 9397.49,-4844.38"/>
<polygon fill="black" stroke="black" points="9398.5,-4847.74 9407.46,-4842.08 9396.93,-4840.92 9398.5,-4847.74"/>
</g>
<!-- layer4_ffn_gate_0 -->
<g id="node341" class="node">
<title>layer4_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="1142,-4842 669,-4842 669,-4759 1142,-4759 1142,-4842"/>
<text text-anchor="middle" x="905.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="905.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="905.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="905.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="905.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_ffn_act_0 -->
<g id="node370" class="node">
<title>layer4_ffn_act_0</title>
<polygon fill="none" stroke="black" points="1045,-4658 914,-4658 914,-4622 1045,-4622 1045,-4658"/>
<text text-anchor="middle" x="979.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_0</text>
</g>
<!-- layer4_ffn_gate_0&#45;&gt;layer4_ffn_act_0 -->
<g id="edge360" class="edge">
<title>layer4_ffn_gate_0&#45;&gt;layer4_ffn_act_0</title>
<path fill="none" stroke="black" d="M924.56,-4758.68C938.02,-4729.86 955.65,-4692.08 967.27,-4667.2"/>
<polygon fill="black" stroke="black" points="970.49,-4668.57 971.55,-4658.02 964.15,-4665.6 970.49,-4668.57"/>
</g>
<!-- layer4_ffn_gate_1 -->
<g id="node342" class="node">
<title>layer4_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="2359,-4842 1886,-4842 1886,-4759 2359,-4759 2359,-4842"/>
<text text-anchor="middle" x="2122.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2122.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2122.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2122.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2122.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_ffn_act_1 -->
<g id="node375" class="node">
<title>layer4_ffn_act_1</title>
<polygon fill="none" stroke="black" points="2313,-4658 2182,-4658 2182,-4622 2313,-4622 2313,-4658"/>
<text text-anchor="middle" x="2247.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_1</text>
</g>
<!-- layer4_ffn_gate_1&#45;&gt;layer4_ffn_act_1 -->
<g id="edge371" class="edge">
<title>layer4_ffn_gate_1&#45;&gt;layer4_ffn_act_1</title>
<path fill="none" stroke="black" d="M2154.69,-4758.68C2177.83,-4729.35 2208.28,-4690.74 2227.87,-4665.89"/>
<polygon fill="black" stroke="black" points="2230.63,-4668.04 2234.07,-4658.02 2225.13,-4663.71 2230.63,-4668.04"/>
</g>
<!-- layer4_ffn_gate_2 -->
<g id="node343" class="node">
<title>layer4_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3383,-4842 2910,-4842 2910,-4759 3383,-4759 3383,-4842"/>
<text text-anchor="middle" x="3146.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3146.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3146.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3146.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3146.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_ffn_act_2 -->
<g id="node380" class="node">
<title>layer4_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3444,-4658 3313,-4658 3313,-4622 3444,-4622 3444,-4658"/>
<text text-anchor="middle" x="3378.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_2</text>
</g>
<!-- layer4_ffn_gate_2&#45;&gt;layer4_ffn_act_2 -->
<g id="edge382" class="edge">
<title>layer4_ffn_gate_2&#45;&gt;layer4_ffn_act_2</title>
<path fill="none" stroke="black" d="M3205.94,-4758.89C3250.19,-4728.66 3308.97,-4688.5 3345.25,-4663.72"/>
<polygon fill="black" stroke="black" points="3347.23,-4666.6 3353.52,-4658.07 3343.28,-4660.82 3347.23,-4666.6"/>
</g>
<!-- layer4_ffn_gate_3 -->
<g id="node344" class="node">
<title>layer4_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4499,-4842 4026,-4842 4026,-4759 4499,-4759 4499,-4842"/>
<text text-anchor="middle" x="4262.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4262.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4262.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4262.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4262.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_ffn_act_3 -->
<g id="node385" class="node">
<title>layer4_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4744,-4658 4613,-4658 4613,-4622 4744,-4622 4744,-4658"/>
<text text-anchor="middle" x="4678.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_3</text>
</g>
<!-- layer4_ffn_gate_3&#45;&gt;layer4_ffn_act_3 -->
<g id="edge393" class="edge">
<title>layer4_ffn_gate_3&#45;&gt;layer4_ffn_act_3</title>
<path fill="none" stroke="black" d="M4368.82,-4758.99C4450.34,-4727.93 4559.48,-4686.35 4624.06,-4661.74"/>
<polygon fill="black" stroke="black" points="4625.54,-4664.92 4633.64,-4658.09 4623.05,-4658.38 4625.54,-4664.92"/>
</g>
<!-- layer4_ffn_gate_4 -->
<g id="node345" class="node">
<title>layer4_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5557,-4842 5084,-4842 5084,-4759 5557,-4759 5557,-4842"/>
<text text-anchor="middle" x="5320.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5320.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5320.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5320.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5320.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_ffn_act_4 -->
<g id="node390" class="node">
<title>layer4_ffn_act_4</title>
<polygon fill="none" stroke="black" points="5770,-4658 5639,-4658 5639,-4622 5770,-4622 5770,-4658"/>
<text text-anchor="middle" x="5704.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_4</text>
</g>
<!-- layer4_ffn_gate_4&#45;&gt;layer4_ffn_act_4 -->
<g id="edge404" class="edge">
<title>layer4_ffn_gate_4&#45;&gt;layer4_ffn_act_4</title>
<path fill="none" stroke="black" d="M5418.89,-4758.89C5493.83,-4727.96 5593.95,-4686.63 5653.58,-4662.02"/>
<polygon fill="black" stroke="black" points="5655.24,-4665.12 5663.15,-4658.07 5652.57,-4658.65 5655.24,-4665.12"/>
</g>
<!-- layer4_ffn_gate_5 -->
<g id="node346" class="node">
<title>layer4_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6837,-4842 6364,-4842 6364,-4759 6837,-4759 6837,-4842"/>
<text text-anchor="middle" x="6600.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6600.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6600.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6600.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6600.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_ffn_act_5 -->
<g id="node395" class="node">
<title>layer4_ffn_act_5</title>
<polygon fill="none" stroke="black" points="6855,-4658 6724,-4658 6724,-4622 6855,-4622 6855,-4658"/>
<text text-anchor="middle" x="6789.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_5</text>
</g>
<!-- layer4_ffn_gate_5&#45;&gt;layer4_ffn_act_5 -->
<g id="edge415" class="edge">
<title>layer4_ffn_gate_5&#45;&gt;layer4_ffn_act_5</title>
<path fill="none" stroke="black" d="M6649.17,-4758.68C6684.76,-4728.83 6731.8,-4689.39 6761.35,-4664.61"/>
<polygon fill="black" stroke="black" points="6763.79,-4667.13 6769.2,-4658.02 6759.29,-4661.77 6763.79,-4667.13"/>
</g>
<!-- layer4_ffn_gate_6 -->
<g id="node347" class="node">
<title>layer4_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="8279,-4842 7806,-4842 7806,-4759 8279,-4759 8279,-4842"/>
<text text-anchor="middle" x="8042.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8042.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8042.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8042.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8042.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_ffn_act_6 -->
<g id="node400" class="node">
<title>layer4_ffn_act_6</title>
<polygon fill="none" stroke="black" points="8147,-4658 8016,-4658 8016,-4622 8147,-4622 8147,-4658"/>
<text text-anchor="middle" x="8081.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer4_ffn_act_6</text>
</g>
<!-- layer4_ffn_gate_6&#45;&gt;layer4_ffn_act_6 -->
<g id="edge426" class="edge">
<title>layer4_ffn_gate_6&#45;&gt;layer4_ffn_act_6</title>
<path fill="none" stroke="black" d="M8052.54,-4758.68C8059.57,-4730.11 8068.77,-4692.74 8074.89,-4667.86"/>
<polygon fill="black" stroke="black" points="8078.32,-4668.57 8077.31,-4658.02 8071.52,-4666.9 8078.32,-4668.57"/>
</g>
<!-- layer4_ffn_act_7 -->
<g id="node357" class="node">
<title>layer4_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9582.24,-4723 8825.44,-4723 8630.76,-4557 9387.56,-4557 9582.24,-4723"/>
<text text-anchor="middle" x="9106.5" y="-4666.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="9106.5" y="-4651.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="9106.5" y="-4636.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9106.5" y="-4621.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9106.5" y="-4606.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_ffn_gate_7&#45;&gt;layer4_ffn_act_7 -->
<g id="edge437" class="edge">
<title>layer4_ffn_gate_7&#45;&gt;layer4_ffn_act_7</title>
<path fill="none" stroke="black" d="M9096.11,-4758.68C9096.81,-4750.75 9097.57,-4742.14 9098.35,-4733.31"/>
<polygon fill="black" stroke="black" points="9101.84,-4733.54 9099.23,-4723.27 9094.87,-4732.93 9101.84,-4733.54"/>
</g>
<!-- layer4_ffn_up_0 -->
<g id="node349" class="node">
<title>layer4_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="1633,-4842 1160,-4842 1160,-4759 1633,-4759 1633,-4842"/>
<text text-anchor="middle" x="1396.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1396.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1396.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1396.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1396.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_ffn_up_0&#45;&gt;layer4_ffn_act_0 -->
<g id="edge361" class="edge">
<title>layer4_ffn_up_0&#45;&gt;layer4_ffn_act_0</title>
<path fill="none" stroke="black" d="M1289.92,-4758.99C1208.21,-4727.93 1098.8,-4686.35 1034.07,-4661.74"/>
<polygon fill="black" stroke="black" points="1035.06,-4658.37 1024.47,-4658.09 1032.57,-4664.92 1035.06,-4658.37"/>
</g>
<!-- layer4_ffn_up_1 -->
<g id="node350" class="node">
<title>layer4_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2850,-4842 2377,-4842 2377,-4759 2850,-4759 2850,-4842"/>
<text text-anchor="middle" x="2613.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2613.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2613.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2613.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2613.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_ffn_up_1&#45;&gt;layer4_ffn_act_1 -->
<g id="edge372" class="edge">
<title>layer4_ffn_up_1&#45;&gt;layer4_ffn_act_1</title>
<path fill="none" stroke="black" d="M2519.72,-4758.89C2448.44,-4728.02 2353.26,-4686.8 2296.39,-4662.17"/>
<polygon fill="black" stroke="black" points="2297.48,-4658.83 2286.92,-4658.07 2294.7,-4665.26 2297.48,-4658.83"/>
</g>
<!-- layer4_ffn_up_2 -->
<g id="node351" class="node">
<title>layer4_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="3874,-4842 3401,-4842 3401,-4759 3874,-4759 3874,-4842"/>
<text text-anchor="middle" x="3637.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3637.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3637.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3637.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3637.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_ffn_up_2&#45;&gt;layer4_ffn_act_2 -->
<g id="edge383" class="edge">
<title>layer4_ffn_up_2&#45;&gt;layer4_ffn_act_2</title>
<path fill="none" stroke="black" d="M3571.14,-4758.89C3521.53,-4728.53 3455.56,-4688.16 3415.11,-4663.41"/>
<polygon fill="black" stroke="black" points="3416.75,-4660.3 3406.39,-4658.07 3413.1,-4666.27 3416.75,-4660.3"/>
</g>
<!-- layer4_ffn_up_3 -->
<g id="node352" class="node">
<title>layer4_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="4990,-4842 4517,-4842 4517,-4759 4990,-4759 4990,-4842"/>
<text text-anchor="middle" x="4753.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4753.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4753.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4753.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4753.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_ffn_up_3&#45;&gt;layer4_ffn_act_3 -->
<g id="edge394" class="edge">
<title>layer4_ffn_up_3&#45;&gt;layer4_ffn_act_3</title>
<path fill="none" stroke="black" d="M4734.19,-4758.68C4720.55,-4729.86 4702.67,-4692.08 4690.9,-4667.2"/>
<polygon fill="black" stroke="black" points="4694,-4665.57 4686.56,-4658.02 4687.67,-4668.56 4694,-4665.57"/>
</g>
<!-- layer4_ffn_up_4 -->
<g id="node353" class="node">
<title>layer4_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="6048,-4842 5575,-4842 5575,-4759 6048,-4759 6048,-4842"/>
<text text-anchor="middle" x="5811.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5811.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5811.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5811.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5811.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_ffn_up_4&#45;&gt;layer4_ffn_act_4 -->
<g id="edge405" class="edge">
<title>layer4_ffn_up_4&#45;&gt;layer4_ffn_act_4</title>
<path fill="none" stroke="black" d="M5783.94,-4758.68C5764.31,-4729.6 5738.53,-4691.41 5721.74,-4666.54"/>
<polygon fill="black" stroke="black" points="5724.49,-4664.35 5715.99,-4658.02 5718.69,-4668.27 5724.49,-4664.35"/>
</g>
<!-- layer4_ffn_up_5 -->
<g id="node354" class="node">
<title>layer4_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="7328,-4842 6855,-4842 6855,-4759 7328,-4759 7328,-4842"/>
<text text-anchor="middle" x="7091.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7091.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7091.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7091.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7091.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_ffn_up_5&#45;&gt;layer4_ffn_act_5 -->
<g id="edge416" class="edge">
<title>layer4_ffn_up_5&#45;&gt;layer4_ffn_act_5</title>
<path fill="none" stroke="black" d="M7014.12,-4758.89C6955.79,-4728.28 6878.06,-4687.48 6831.01,-4662.79"/>
<polygon fill="black" stroke="black" points="6832.5,-4659.62 6822.02,-4658.07 6829.25,-4665.82 6832.5,-4659.62"/>
</g>
<!-- layer4_ffn_up_6 -->
<g id="node355" class="node">
<title>layer4_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8770,-4842 8297,-4842 8297,-4759 8770,-4759 8770,-4842"/>
<text text-anchor="middle" x="8533.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8533.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8533.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8533.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8533.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_ffn_up_6&#45;&gt;layer4_ffn_act_6 -->
<g id="edge427" class="edge">
<title>layer4_ffn_up_6&#45;&gt;layer4_ffn_act_6</title>
<path fill="none" stroke="black" d="M8417.98,-4758.99C8329.05,-4727.81 8209.84,-4686.01 8139.79,-4661.44"/>
<polygon fill="black" stroke="black" points="8140.84,-4658.1 8130.24,-4658.09 8138.52,-4664.7 8140.84,-4658.1"/>
</g>
<!-- layer4_ffn_up_7&#45;&gt;layer4_ffn_act_7 -->
<g id="edge438" class="edge">
<title>layer4_ffn_up_7&#45;&gt;layer4_ffn_act_7</title>
<path fill="none" stroke="black" d="M9461.59,-4758.99C9431.19,-4748.89 9397.43,-4737.67 9363.17,-4726.29"/>
<polygon fill="black" stroke="black" points="9364.09,-4722.91 9353.5,-4723.07 9361.89,-4729.55 9364.09,-4722.91"/>
</g>
<!-- layer4_ffn_down_7 -->
<g id="node365" class="node">
<title>layer4_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="9330,-4521 8883,-4521 8883,-4438 9330,-4438 9330,-4521"/>
<text text-anchor="middle" x="9106.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9106.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9106.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9106.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9106.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_ffn_act_7&#45;&gt;layer4_ffn_down_7 -->
<g id="edge439" class="edge">
<title>layer4_ffn_act_7&#45;&gt;layer4_ffn_down_7</title>
<path fill="none" stroke="black" d="M9106.5,-4556.96C9106.5,-4548.25 9106.5,-4539.59 9106.5,-4531.39"/>
<polygon fill="black" stroke="black" points="9110,-4531.29 9106.5,-4521.29 9103,-4531.29 9110,-4531.29"/>
</g>
<!-- layer4_ffn_down_0 -->
<g id="node358" class="node">
<title>layer4_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="1203,-4521 756,-4521 756,-4438 1203,-4438 1203,-4521"/>
<text text-anchor="middle" x="979.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="979.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="979.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="979.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="979.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_res2_0 -->
<g id="node371" class="node">
<title>layer4_res2_0</title>
<polygon fill="none" stroke="black" points="1037.5,-4337 921.5,-4337 921.5,-4301 1037.5,-4301 1037.5,-4337"/>
<text text-anchor="middle" x="979.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_0</text>
</g>
<!-- layer4_ffn_down_0&#45;&gt;layer4_res2_0 -->
<g id="edge363" class="edge">
<title>layer4_ffn_down_0&#45;&gt;layer4_res2_0</title>
<path fill="none" stroke="black" d="M979.5,-4437.68C979.5,-4409.24 979.5,-4372.08 979.5,-4347.2"/>
<polygon fill="black" stroke="black" points="983,-4347.02 979.5,-4337.02 976,-4347.02 983,-4347.02"/>
</g>
<!-- layer4_ffn_down_1 -->
<g id="node359" class="node">
<title>layer4_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="2471,-4521 2024,-4521 2024,-4438 2471,-4438 2471,-4521"/>
<text text-anchor="middle" x="2247.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2247.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2247.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="2247.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2247.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_res2_1 -->
<g id="node376" class="node">
<title>layer4_res2_1</title>
<polygon fill="none" stroke="black" points="2305.5,-4337 2189.5,-4337 2189.5,-4301 2305.5,-4301 2305.5,-4337"/>
<text text-anchor="middle" x="2247.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_1</text>
</g>
<!-- layer4_ffn_down_1&#45;&gt;layer4_res2_1 -->
<g id="edge374" class="edge">
<title>layer4_ffn_down_1&#45;&gt;layer4_res2_1</title>
<path fill="none" stroke="black" d="M2247.5,-4437.68C2247.5,-4409.24 2247.5,-4372.08 2247.5,-4347.2"/>
<polygon fill="black" stroke="black" points="2251,-4347.02 2247.5,-4337.02 2244,-4347.02 2251,-4347.02"/>
</g>
<!-- layer4_ffn_down_2 -->
<g id="node360" class="node">
<title>layer4_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3602,-4521 3155,-4521 3155,-4438 3602,-4438 3602,-4521"/>
<text text-anchor="middle" x="3378.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3378.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3378.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3378.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3378.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_res2_2 -->
<g id="node381" class="node">
<title>layer4_res2_2</title>
<polygon fill="none" stroke="black" points="3436.5,-4337 3320.5,-4337 3320.5,-4301 3436.5,-4301 3436.5,-4337"/>
<text text-anchor="middle" x="3378.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_2</text>
</g>
<!-- layer4_ffn_down_2&#45;&gt;layer4_res2_2 -->
<g id="edge385" class="edge">
<title>layer4_ffn_down_2&#45;&gt;layer4_res2_2</title>
<path fill="none" stroke="black" d="M3378.5,-4437.68C3378.5,-4409.24 3378.5,-4372.08 3378.5,-4347.2"/>
<polygon fill="black" stroke="black" points="3382,-4347.02 3378.5,-4337.02 3375,-4347.02 3382,-4347.02"/>
</g>
<!-- layer4_ffn_down_3 -->
<g id="node361" class="node">
<title>layer4_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4902,-4521 4455,-4521 4455,-4438 4902,-4438 4902,-4521"/>
<text text-anchor="middle" x="4678.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4678.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4678.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4678.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4678.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_res2_3 -->
<g id="node386" class="node">
<title>layer4_res2_3</title>
<polygon fill="none" stroke="black" points="4736.5,-4337 4620.5,-4337 4620.5,-4301 4736.5,-4301 4736.5,-4337"/>
<text text-anchor="middle" x="4678.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_3</text>
</g>
<!-- layer4_ffn_down_3&#45;&gt;layer4_res2_3 -->
<g id="edge396" class="edge">
<title>layer4_ffn_down_3&#45;&gt;layer4_res2_3</title>
<path fill="none" stroke="black" d="M4678.5,-4437.68C4678.5,-4409.24 4678.5,-4372.08 4678.5,-4347.2"/>
<polygon fill="black" stroke="black" points="4682,-4347.02 4678.5,-4337.02 4675,-4347.02 4682,-4347.02"/>
</g>
<!-- layer4_ffn_down_4 -->
<g id="node362" class="node">
<title>layer4_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="5928,-4521 5481,-4521 5481,-4438 5928,-4438 5928,-4521"/>
<text text-anchor="middle" x="5704.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5704.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5704.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="5704.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5704.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_res2_4 -->
<g id="node391" class="node">
<title>layer4_res2_4</title>
<polygon fill="none" stroke="black" points="5762.5,-4337 5646.5,-4337 5646.5,-4301 5762.5,-4301 5762.5,-4337"/>
<text text-anchor="middle" x="5704.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_4</text>
</g>
<!-- layer4_ffn_down_4&#45;&gt;layer4_res2_4 -->
<g id="edge407" class="edge">
<title>layer4_ffn_down_4&#45;&gt;layer4_res2_4</title>
<path fill="none" stroke="black" d="M5704.5,-4437.68C5704.5,-4409.24 5704.5,-4372.08 5704.5,-4347.2"/>
<polygon fill="black" stroke="black" points="5708,-4347.02 5704.5,-4337.02 5701,-4347.02 5708,-4347.02"/>
</g>
<!-- layer4_ffn_down_5 -->
<g id="node363" class="node">
<title>layer4_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="7013,-4521 6566,-4521 6566,-4438 7013,-4438 7013,-4521"/>
<text text-anchor="middle" x="6789.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6789.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6789.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6789.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6789.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_res2_5 -->
<g id="node396" class="node">
<title>layer4_res2_5</title>
<polygon fill="none" stroke="black" points="6847.5,-4337 6731.5,-4337 6731.5,-4301 6847.5,-4301 6847.5,-4337"/>
<text text-anchor="middle" x="6789.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_5</text>
</g>
<!-- layer4_ffn_down_5&#45;&gt;layer4_res2_5 -->
<g id="edge418" class="edge">
<title>layer4_ffn_down_5&#45;&gt;layer4_res2_5</title>
<path fill="none" stroke="black" d="M6789.5,-4437.68C6789.5,-4409.24 6789.5,-4372.08 6789.5,-4347.2"/>
<polygon fill="black" stroke="black" points="6793,-4347.02 6789.5,-4337.02 6786,-4347.02 6793,-4347.02"/>
</g>
<!-- layer4_ffn_down_6 -->
<g id="node364" class="node">
<title>layer4_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="8305,-4521 7858,-4521 7858,-4438 8305,-4438 8305,-4521"/>
<text text-anchor="middle" x="8081.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8081.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8081.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8081.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8081.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_res2_6 -->
<g id="node401" class="node">
<title>layer4_res2_6</title>
<polygon fill="none" stroke="black" points="8139.5,-4337 8023.5,-4337 8023.5,-4301 8139.5,-4301 8139.5,-4337"/>
<text text-anchor="middle" x="8081.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer4_res2_6</text>
</g>
<!-- layer4_ffn_down_6&#45;&gt;layer4_res2_6 -->
<g id="edge429" class="edge">
<title>layer4_ffn_down_6&#45;&gt;layer4_res2_6</title>
<path fill="none" stroke="black" d="M8081.5,-4437.68C8081.5,-4409.24 8081.5,-4372.08 8081.5,-4347.2"/>
<polygon fill="black" stroke="black" points="8085,-4347.02 8081.5,-4337.02 8078,-4347.02 8085,-4347.02"/>
</g>
<!-- layer4_res2_7 -->
<g id="node366" class="node">
<title>layer4_res2_7</title>
<polygon fill="none" stroke="black" points="9547.24,-4402 8846.12,-4402 8665.76,-4236 9366.88,-4236 9547.24,-4402"/>
<text text-anchor="middle" x="9106.5" y="-4345.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9106.5" y="-4330.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-4315.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-4300.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-4285.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_ffn_down_7&#45;&gt;layer4_res2_7 -->
<g id="edge440" class="edge">
<title>layer4_ffn_down_7&#45;&gt;layer4_res2_7</title>
<path fill="none" stroke="black" d="M9106.5,-4437.68C9106.5,-4429.75 9106.5,-4421.14 9106.5,-4412.31"/>
<polygon fill="black" stroke="black" points="9110,-4412.27 9106.5,-4402.27 9103,-4412.27 9110,-4412.27"/>
</g>
<!-- layer5_mha_qkv_7 -->
<g id="node409" class="node">
<title>layer5_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="9384.5,-4200 8828.5,-4200 8828.5,-4117 9384.5,-4117 9384.5,-4200"/>
<text text-anchor="middle" x="9106.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9106.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9106.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9106.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_res2_7&#45;&gt;layer5_mha_qkv_7 -->
<g id="edge518" class="edge">
<title>layer4_res2_7&#45;&gt;layer5_mha_qkv_7</title>
<path fill="none" stroke="black" d="M9106.5,-4235.96C9106.5,-4227.25 9106.5,-4218.59 9106.5,-4210.39"/>
<polygon fill="black" stroke="black" points="9110,-4210.29 9106.5,-4200.29 9103,-4210.29 9110,-4210.29"/>
</g>
<!-- layer4_mha_attn_0&#45;&gt;layer4_mha_out_0 -->
<g id="edge355" class="edge">
<title>layer4_mha_attn_0&#45;&gt;layer4_mha_out_0</title>
<path fill="none" stroke="black" d="M1145.5,-5367.74C1145.5,-5346.18 1145.5,-5308.37 1145.5,-5277.29"/>
<polygon fill="black" stroke="black" points="1149,-5277.04 1145.5,-5267.04 1142,-5277.04 1149,-5277.04"/>
</g>
<!-- layer4_ln1_0 -->
<g id="node369" class="node">
<title>layer4_ln1_0</title>
<polygon fill="none" stroke="black" points="1199,-4930 1092,-4930 1092,-4894 1199,-4894 1199,-4930"/>
<text text-anchor="middle" x="1145.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_0</text>
</g>
<!-- layer4_res1_0&#45;&gt;layer4_ln1_0 -->
<g id="edge357" class="edge">
<title>layer4_res1_0&#45;&gt;layer4_ln1_0</title>
<path fill="none" stroke="black" d="M1145.5,-5046.97C1145.5,-5021.03 1145.5,-4971.36 1145.5,-4940.33"/>
<polygon fill="black" stroke="black" points="1149,-4940.2 1145.5,-4930.2 1142,-4940.2 1149,-4940.2"/>
</g>
<!-- layer4_ln1_0&#45;&gt;layer4_ffn_gate_0 -->
<g id="edge358" class="edge">
<title>layer4_ln1_0&#45;&gt;layer4_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1108,-4893.89C1079.99,-4881.11 1040.35,-4863.02 1003.55,-4846.24"/>
<polygon fill="black" stroke="black" points="1004.82,-4842.97 994.27,-4842 1001.92,-4849.34 1004.82,-4842.97"/>
</g>
<!-- layer4_ln1_0&#45;&gt;layer4_ffn_up_0 -->
<g id="edge359" class="edge">
<title>layer4_ln1_0&#45;&gt;layer4_ffn_up_0</title>
<path fill="none" stroke="black" d="M1184.72,-4893.89C1214.14,-4881.06 1255.83,-4862.87 1294.44,-4846.02"/>
<polygon fill="black" stroke="black" points="1295.89,-4849.21 1303.66,-4842 1293.1,-4842.79 1295.89,-4849.21"/>
</g>
<!-- layer4_ffn_act_0&#45;&gt;layer4_ffn_down_0 -->
<g id="edge362" class="edge">
<title>layer4_ffn_act_0&#45;&gt;layer4_ffn_down_0</title>
<path fill="none" stroke="black" d="M979.5,-4621.74C979.5,-4600.18 979.5,-4562.37 979.5,-4531.29"/>
<polygon fill="black" stroke="black" points="983,-4531.04 979.5,-4521.04 976,-4531.04 983,-4531.04"/>
</g>
<!-- layer5_mha_qkv_0 -->
<g id="node402" class="node">
<title>layer5_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="1257.5,-4200 701.5,-4200 701.5,-4117 1257.5,-4117 1257.5,-4200"/>
<text text-anchor="middle" x="979.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="979.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="979.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="979.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="979.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_res2_0&#45;&gt;layer5_mha_qkv_0 -->
<g id="edge441" class="edge">
<title>layer4_res2_0&#45;&gt;layer5_mha_qkv_0</title>
<path fill="none" stroke="black" d="M979.5,-4300.74C979.5,-4279.18 979.5,-4241.37 979.5,-4210.29"/>
<polygon fill="black" stroke="black" points="983,-4210.04 979.5,-4200.04 976,-4210.04 983,-4210.04"/>
</g>
<!-- layer4_mha_attn_1&#45;&gt;layer4_mha_out_1 -->
<g id="edge366" class="edge">
<title>layer4_mha_attn_1&#45;&gt;layer4_mha_out_1</title>
<path fill="none" stroke="black" d="M2591.5,-5367.74C2591.5,-5346.18 2591.5,-5308.37 2591.5,-5277.29"/>
<polygon fill="black" stroke="black" points="2595,-5277.04 2591.5,-5267.04 2588,-5277.04 2595,-5277.04"/>
</g>
<!-- layer4_ln1_1 -->
<g id="node374" class="node">
<title>layer4_ln1_1</title>
<polygon fill="none" stroke="black" points="2645,-4930 2538,-4930 2538,-4894 2645,-4894 2645,-4930"/>
<text text-anchor="middle" x="2591.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_1</text>
</g>
<!-- layer4_res1_1&#45;&gt;layer4_ln1_1 -->
<g id="edge368" class="edge">
<title>layer4_res1_1&#45;&gt;layer4_ln1_1</title>
<path fill="none" stroke="black" d="M2591.5,-5046.97C2591.5,-5021.03 2591.5,-4971.36 2591.5,-4940.33"/>
<polygon fill="black" stroke="black" points="2595,-4940.2 2591.5,-4930.2 2588,-4940.2 2595,-4940.2"/>
</g>
<!-- layer4_ln1_1&#45;&gt;layer4_ffn_gate_1 -->
<g id="edge369" class="edge">
<title>layer4_ln1_1&#45;&gt;layer4_ffn_gate_1</title>
<path fill="none" stroke="black" d="M2537.7,-4898.44C2481.17,-4885.24 2389.09,-4863.74 2305.99,-4844.34"/>
<polygon fill="black" stroke="black" points="2306.7,-4840.91 2296.17,-4842.05 2305.11,-4847.73 2306.7,-4840.91"/>
</g>
<!-- layer4_ln1_1&#45;&gt;layer4_ffn_up_1 -->
<g id="edge370" class="edge">
<title>layer4_ln1_1&#45;&gt;layer4_ffn_up_1</title>
<path fill="none" stroke="black" d="M2594.94,-4893.89C2597.2,-4882.65 2600.28,-4867.31 2603.28,-4852.35"/>
<polygon fill="black" stroke="black" points="2606.8,-4852.61 2605.34,-4842.12 2599.94,-4851.23 2606.8,-4852.61"/>
</g>
<!-- layer4_ffn_act_1&#45;&gt;layer4_ffn_down_1 -->
<g id="edge373" class="edge">
<title>layer4_ffn_act_1&#45;&gt;layer4_ffn_down_1</title>
<path fill="none" stroke="black" d="M2247.5,-4621.74C2247.5,-4600.18 2247.5,-4562.37 2247.5,-4531.29"/>
<polygon fill="black" stroke="black" points="2251,-4531.04 2247.5,-4521.04 2244,-4531.04 2251,-4531.04"/>
</g>
<!-- layer5_mha_qkv_1 -->
<g id="node403" class="node">
<title>layer5_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2525.5,-4200 1969.5,-4200 1969.5,-4117 2525.5,-4117 2525.5,-4200"/>
<text text-anchor="middle" x="2247.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="2247.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2247.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2247.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="2247.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_res2_1&#45;&gt;layer5_mha_qkv_1 -->
<g id="edge452" class="edge">
<title>layer4_res2_1&#45;&gt;layer5_mha_qkv_1</title>
<path fill="none" stroke="black" d="M2247.5,-4300.74C2247.5,-4279.18 2247.5,-4241.37 2247.5,-4210.29"/>
<polygon fill="black" stroke="black" points="2251,-4210.04 2247.5,-4200.04 2244,-4210.04 2251,-4210.04"/>
</g>
<!-- layer4_mha_attn_2&#45;&gt;layer4_mha_out_2 -->
<g id="edge377" class="edge">
<title>layer4_mha_attn_2&#45;&gt;layer4_mha_out_2</title>
<path fill="none" stroke="black" d="M3167.5,-5367.74C3167.5,-5346.18 3167.5,-5308.37 3167.5,-5277.29"/>
<polygon fill="black" stroke="black" points="3171,-5277.04 3167.5,-5267.04 3164,-5277.04 3171,-5277.04"/>
</g>
<!-- layer4_ln1_2 -->
<g id="node379" class="node">
<title>layer4_ln1_2</title>
<polygon fill="none" stroke="black" points="3221,-4930 3114,-4930 3114,-4894 3221,-4894 3221,-4930"/>
<text text-anchor="middle" x="3167.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_2</text>
</g>
<!-- layer4_res1_2&#45;&gt;layer4_ln1_2 -->
<g id="edge379" class="edge">
<title>layer4_res1_2&#45;&gt;layer4_ln1_2</title>
<path fill="none" stroke="black" d="M3167.5,-5046.97C3167.5,-5021.03 3167.5,-4971.36 3167.5,-4940.33"/>
<polygon fill="black" stroke="black" points="3171,-4940.2 3167.5,-4930.2 3164,-4940.2 3171,-4940.2"/>
</g>
<!-- layer4_ln1_2&#45;&gt;layer4_ffn_gate_2 -->
<g id="edge380" class="edge">
<title>layer4_ln1_2&#45;&gt;layer4_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3164.22,-4893.89C3162.06,-4882.65 3159.12,-4867.31 3156.25,-4852.35"/>
<polygon fill="black" stroke="black" points="3159.61,-4851.28 3154.29,-4842.12 3152.74,-4852.6 3159.61,-4851.28"/>
</g>
<!-- layer4_ln1_2&#45;&gt;layer4_ffn_up_2 -->
<g id="edge381" class="edge">
<title>layer4_ln1_2&#45;&gt;layer4_ffn_up_2</title>
<path fill="none" stroke="black" d="M3221.41,-4898.44C3278.07,-4885.24 3370.34,-4863.74 3453.62,-4844.34"/>
<polygon fill="black" stroke="black" points="3454.52,-4847.72 3463.46,-4842.05 3452.93,-4840.91 3454.52,-4847.72"/>
</g>
<!-- layer4_ffn_act_2&#45;&gt;layer4_ffn_down_2 -->
<g id="edge384" class="edge">
<title>layer4_ffn_act_2&#45;&gt;layer4_ffn_down_2</title>
<path fill="none" stroke="black" d="M3378.5,-4621.74C3378.5,-4600.18 3378.5,-4562.37 3378.5,-4531.29"/>
<polygon fill="black" stroke="black" points="3382,-4531.04 3378.5,-4521.04 3375,-4531.04 3382,-4531.04"/>
</g>
<!-- layer5_mha_qkv_2 -->
<g id="node404" class="node">
<title>layer5_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3656.5,-4200 3100.5,-4200 3100.5,-4117 3656.5,-4117 3656.5,-4200"/>
<text text-anchor="middle" x="3378.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3378.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3378.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3378.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3378.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_res2_2&#45;&gt;layer5_mha_qkv_2 -->
<g id="edge463" class="edge">
<title>layer4_res2_2&#45;&gt;layer5_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3378.5,-4300.74C3378.5,-4279.18 3378.5,-4241.37 3378.5,-4210.29"/>
<polygon fill="black" stroke="black" points="3382,-4210.04 3378.5,-4200.04 3375,-4210.04 3382,-4210.04"/>
</g>
<!-- layer4_mha_attn_3&#45;&gt;layer4_mha_out_3 -->
<g id="edge388" class="edge">
<title>layer4_mha_attn_3&#45;&gt;layer4_mha_out_3</title>
<path fill="none" stroke="black" d="M4677.5,-5367.74C4677.5,-5346.18 4677.5,-5308.37 4677.5,-5277.29"/>
<polygon fill="black" stroke="black" points="4681,-5277.04 4677.5,-5267.04 4674,-5277.04 4681,-5277.04"/>
</g>
<!-- layer4_ln1_3 -->
<g id="node384" class="node">
<title>layer4_ln1_3</title>
<polygon fill="none" stroke="black" points="4731,-4930 4624,-4930 4624,-4894 4731,-4894 4731,-4930"/>
<text text-anchor="middle" x="4677.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_3</text>
</g>
<!-- layer4_res1_3&#45;&gt;layer4_ln1_3 -->
<g id="edge390" class="edge">
<title>layer4_res1_3&#45;&gt;layer4_ln1_3</title>
<path fill="none" stroke="black" d="M4677.5,-5046.97C4677.5,-5021.03 4677.5,-4971.36 4677.5,-4940.33"/>
<polygon fill="black" stroke="black" points="4681,-4940.2 4677.5,-4930.2 4674,-4940.2 4681,-4940.2"/>
</g>
<!-- layer4_ln1_3&#45;&gt;layer4_ffn_gate_3 -->
<g id="edge391" class="edge">
<title>layer4_ln1_3&#45;&gt;layer4_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4623.67,-4896.8C4573.61,-4883.59 4496.4,-4863.22 4426.2,-4844.69"/>
<polygon fill="black" stroke="black" points="4426.9,-4841.26 4416.34,-4842.09 4425.12,-4848.03 4426.9,-4841.26"/>
</g>
<!-- layer4_ln1_3&#45;&gt;layer4_ffn_up_3 -->
<g id="edge392" class="edge">
<title>layer4_ln1_3&#45;&gt;layer4_ffn_up_3</title>
<path fill="none" stroke="black" d="M4689.38,-4893.89C4697.48,-4882.22 4708.65,-4866.12 4719.4,-4850.63"/>
<polygon fill="black" stroke="black" points="4722.48,-4852.33 4725.31,-4842.12 4716.73,-4848.34 4722.48,-4852.33"/>
</g>
<!-- layer4_ffn_act_3&#45;&gt;layer4_ffn_down_3 -->
<g id="edge395" class="edge">
<title>layer4_ffn_act_3&#45;&gt;layer4_ffn_down_3</title>
<path fill="none" stroke="black" d="M4678.5,-4621.74C4678.5,-4600.18 4678.5,-4562.37 4678.5,-4531.29"/>
<polygon fill="black" stroke="black" points="4682,-4531.04 4678.5,-4521.04 4675,-4531.04 4682,-4531.04"/>
</g>
<!-- layer5_mha_qkv_3 -->
<g id="node405" class="node">
<title>layer5_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4956.5,-4200 4400.5,-4200 4400.5,-4117 4956.5,-4117 4956.5,-4200"/>
<text text-anchor="middle" x="4678.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4678.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4678.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4678.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4678.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_res2_3&#45;&gt;layer5_mha_qkv_3 -->
<g id="edge474" class="edge">
<title>layer4_res2_3&#45;&gt;layer5_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4678.5,-4300.74C4678.5,-4279.18 4678.5,-4241.37 4678.5,-4210.29"/>
<polygon fill="black" stroke="black" points="4682,-4210.04 4678.5,-4200.04 4675,-4210.04 4682,-4210.04"/>
</g>
<!-- layer4_mha_attn_4&#45;&gt;layer4_mha_out_4 -->
<g id="edge399" class="edge">
<title>layer4_mha_attn_4&#45;&gt;layer4_mha_out_4</title>
<path fill="none" stroke="black" d="M5324.5,-5367.74C5324.5,-5346.18 5324.5,-5308.37 5324.5,-5277.29"/>
<polygon fill="black" stroke="black" points="5328,-5277.04 5324.5,-5267.04 5321,-5277.04 5328,-5277.04"/>
</g>
<!-- layer4_ln1_4 -->
<g id="node389" class="node">
<title>layer4_ln1_4</title>
<polygon fill="none" stroke="black" points="5378,-4930 5271,-4930 5271,-4894 5378,-4894 5378,-4930"/>
<text text-anchor="middle" x="5324.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_4</text>
</g>
<!-- layer4_res1_4&#45;&gt;layer4_ln1_4 -->
<g id="edge401" class="edge">
<title>layer4_res1_4&#45;&gt;layer4_ln1_4</title>
<path fill="none" stroke="black" d="M5324.5,-5046.97C5324.5,-5021.03 5324.5,-4971.36 5324.5,-4940.33"/>
<polygon fill="black" stroke="black" points="5328,-4940.2 5324.5,-4930.2 5321,-4940.2 5328,-4940.2"/>
</g>
<!-- layer4_ln1_4&#45;&gt;layer4_ffn_gate_4 -->
<g id="edge402" class="edge">
<title>layer4_ln1_4&#45;&gt;layer4_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5323.88,-4893.89C5323.46,-4882.65 5322.9,-4867.31 5322.36,-4852.35"/>
<polygon fill="black" stroke="black" points="5325.85,-4851.98 5321.98,-4842.12 5318.85,-4852.24 5325.85,-4851.98"/>
</g>
<!-- layer4_ln1_4&#45;&gt;layer4_ffn_up_4 -->
<g id="edge403" class="edge">
<title>layer4_ln1_4&#45;&gt;layer4_ffn_up_4</title>
<path fill="none" stroke="black" d="M5378.01,-4898.97C5436.6,-4885.8 5533.89,-4863.92 5621.47,-4844.23"/>
<polygon fill="black" stroke="black" points="5622.29,-4847.63 5631.28,-4842.02 5620.76,-4840.8 5622.29,-4847.63"/>
</g>
<!-- layer4_ffn_act_4&#45;&gt;layer4_ffn_down_4 -->
<g id="edge406" class="edge">
<title>layer4_ffn_act_4&#45;&gt;layer4_ffn_down_4</title>
<path fill="none" stroke="black" d="M5704.5,-4621.74C5704.5,-4600.18 5704.5,-4562.37 5704.5,-4531.29"/>
<polygon fill="black" stroke="black" points="5708,-4531.04 5704.5,-4521.04 5701,-4531.04 5708,-4531.04"/>
</g>
<!-- layer5_mha_qkv_4 -->
<g id="node406" class="node">
<title>layer5_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="5982.5,-4200 5426.5,-4200 5426.5,-4117 5982.5,-4117 5982.5,-4200"/>
<text text-anchor="middle" x="5704.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="5704.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5704.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5704.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="5704.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_res2_4&#45;&gt;layer5_mha_qkv_4 -->
<g id="edge485" class="edge">
<title>layer4_res2_4&#45;&gt;layer5_mha_qkv_4</title>
<path fill="none" stroke="black" d="M5704.5,-4300.74C5704.5,-4279.18 5704.5,-4241.37 5704.5,-4210.29"/>
<polygon fill="black" stroke="black" points="5708,-4210.04 5704.5,-4200.04 5701,-4210.04 5708,-4210.04"/>
</g>
<!-- layer4_mha_attn_5&#45;&gt;layer4_mha_out_5 -->
<g id="edge410" class="edge">
<title>layer4_mha_attn_5&#45;&gt;layer4_mha_out_5</title>
<path fill="none" stroke="black" d="M7009.5,-5367.74C7009.5,-5346.18 7009.5,-5308.37 7009.5,-5277.29"/>
<polygon fill="black" stroke="black" points="7013,-5277.04 7009.5,-5267.04 7006,-5277.04 7013,-5277.04"/>
</g>
<!-- layer4_ln1_5 -->
<g id="node394" class="node">
<title>layer4_ln1_5</title>
<polygon fill="none" stroke="black" points="7063,-4930 6956,-4930 6956,-4894 7063,-4894 7063,-4930"/>
<text text-anchor="middle" x="7009.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_5</text>
</g>
<!-- layer4_res1_5&#45;&gt;layer4_ln1_5 -->
<g id="edge412" class="edge">
<title>layer4_res1_5&#45;&gt;layer4_ln1_5</title>
<path fill="none" stroke="black" d="M7009.5,-5046.97C7009.5,-5021.03 7009.5,-4971.36 7009.5,-4940.33"/>
<polygon fill="black" stroke="black" points="7013,-4940.2 7009.5,-4930.2 7006,-4940.2 7013,-4940.2"/>
</g>
<!-- layer4_ln1_5&#45;&gt;layer4_ffn_gate_5 -->
<g id="edge413" class="edge">
<title>layer4_ln1_5&#45;&gt;layer4_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6955.61,-4896.57C6906.2,-4883.34 6830.47,-4863.07 6761.61,-4844.63"/>
<polygon fill="black" stroke="black" points="6762.51,-4841.25 6751.95,-4842.05 6760.7,-4848.01 6762.51,-4841.25"/>
</g>
<!-- layer4_ln1_5&#45;&gt;layer4_ffn_up_5 -->
<g id="edge414" class="edge">
<title>layer4_ln1_5&#45;&gt;layer4_ffn_up_5</title>
<path fill="none" stroke="black" d="M7022.31,-4893.89C7031.13,-4882.11 7043.33,-4865.82 7055.03,-4850.2"/>
<polygon fill="black" stroke="black" points="7057.89,-4852.22 7061.08,-4842.12 7052.29,-4848.02 7057.89,-4852.22"/>
</g>
<!-- layer4_ffn_act_5&#45;&gt;layer4_ffn_down_5 -->
<g id="edge417" class="edge">
<title>layer4_ffn_act_5&#45;&gt;layer4_ffn_down_5</title>
<path fill="none" stroke="black" d="M6789.5,-4621.74C6789.5,-4600.18 6789.5,-4562.37 6789.5,-4531.29"/>
<polygon fill="black" stroke="black" points="6793,-4531.04 6789.5,-4521.04 6786,-4531.04 6793,-4531.04"/>
</g>
<!-- layer5_mha_qkv_5 -->
<g id="node407" class="node">
<title>layer5_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="7067.5,-4200 6511.5,-4200 6511.5,-4117 7067.5,-4117 7067.5,-4200"/>
<text text-anchor="middle" x="6789.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6789.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6789.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6789.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6789.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_res2_5&#45;&gt;layer5_mha_qkv_5 -->
<g id="edge496" class="edge">
<title>layer4_res2_5&#45;&gt;layer5_mha_qkv_5</title>
<path fill="none" stroke="black" d="M6789.5,-4300.74C6789.5,-4279.18 6789.5,-4241.37 6789.5,-4210.29"/>
<polygon fill="black" stroke="black" points="6793,-4210.04 6789.5,-4200.04 6786,-4210.04 6793,-4210.04"/>
</g>
<!-- layer4_mha_attn_6&#45;&gt;layer4_mha_out_6 -->
<g id="edge421" class="edge">
<title>layer4_mha_attn_6&#45;&gt;layer4_mha_out_6</title>
<path fill="none" stroke="black" d="M8097.5,-5367.74C8097.5,-5346.18 8097.5,-5308.37 8097.5,-5277.29"/>
<polygon fill="black" stroke="black" points="8101,-5277.04 8097.5,-5267.04 8094,-5277.04 8101,-5277.04"/>
</g>
<!-- layer4_ln1_6 -->
<g id="node399" class="node">
<title>layer4_ln1_6</title>
<polygon fill="none" stroke="black" points="8151,-4930 8044,-4930 8044,-4894 8151,-4894 8151,-4930"/>
<text text-anchor="middle" x="8097.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer4_ln1_6</text>
</g>
<!-- layer4_res1_6&#45;&gt;layer4_ln1_6 -->
<g id="edge423" class="edge">
<title>layer4_res1_6&#45;&gt;layer4_ln1_6</title>
<path fill="none" stroke="black" d="M8097.5,-5046.97C8097.5,-5021.03 8097.5,-4971.36 8097.5,-4940.33"/>
<polygon fill="black" stroke="black" points="8101,-4940.2 8097.5,-4930.2 8094,-4940.2 8101,-4940.2"/>
</g>
<!-- layer4_ln1_6&#45;&gt;layer4_ffn_gate_6 -->
<g id="edge424" class="edge">
<title>layer4_ln1_6&#45;&gt;layer4_ffn_gate_6</title>
<path fill="none" stroke="black" d="M8088.91,-4893.89C8083.1,-4882.33 8075.11,-4866.42 8067.39,-4851.06"/>
<polygon fill="black" stroke="black" points="8070.52,-4849.48 8062.9,-4842.12 8064.26,-4852.63 8070.52,-4849.48"/>
</g>
<!-- layer4_ln1_6&#45;&gt;layer4_ffn_up_6 -->
<g id="edge425" class="edge">
<title>layer4_ln1_6&#45;&gt;layer4_ffn_up_6</title>
<path fill="none" stroke="black" d="M8151.4,-4897.46C8203.95,-4884.27 8286.69,-4863.48 8361.76,-4844.63"/>
<polygon fill="black" stroke="black" points="8362.98,-4847.93 8371.83,-4842.1 8361.27,-4841.15 8362.98,-4847.93"/>
</g>
<!-- layer4_ffn_act_6&#45;&gt;layer4_ffn_down_6 -->
<g id="edge428" class="edge">
<title>layer4_ffn_act_6&#45;&gt;layer4_ffn_down_6</title>
<path fill="none" stroke="black" d="M8081.5,-4621.74C8081.5,-4600.18 8081.5,-4562.37 8081.5,-4531.29"/>
<polygon fill="black" stroke="black" points="8085,-4531.04 8081.5,-4521.04 8078,-4531.04 8085,-4531.04"/>
</g>
<!-- layer5_mha_qkv_6 -->
<g id="node408" class="node">
<title>layer5_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="8359.5,-4200 7803.5,-4200 7803.5,-4117 8359.5,-4117 8359.5,-4200"/>
<text text-anchor="middle" x="8081.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8081.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8081.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8081.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8081.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_res2_6&#45;&gt;layer5_mha_qkv_6 -->
<g id="edge507" class="edge">
<title>layer4_res2_6&#45;&gt;layer5_mha_qkv_6</title>
<path fill="none" stroke="black" d="M8081.5,-4300.74C8081.5,-4279.18 8081.5,-4241.37 8081.5,-4210.29"/>
<polygon fill="black" stroke="black" points="8085,-4210.04 8081.5,-4200.04 8078,-4210.04 8085,-4210.04"/>
</g>
<!-- layer5_mha_attn_0 -->
<g id="node447" class="node">
<title>layer5_mha_attn_0</title>
<polygon fill="none" stroke="black" points="1055,-4016 904,-4016 904,-3980 1055,-3980 1055,-4016"/>
<text text-anchor="middle" x="979.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_0</text>
</g>
<!-- layer5_mha_qkv_0&#45;&gt;layer5_mha_attn_0 -->
<g id="edge442" class="edge">
<title>layer5_mha_qkv_0&#45;&gt;layer5_mha_attn_0</title>
<path fill="none" stroke="black" d="M979.5,-4116.68C979.5,-4088.24 979.5,-4051.08 979.5,-4026.2"/>
<polygon fill="black" stroke="black" points="983,-4026.02 979.5,-4016.02 976,-4026.02 983,-4026.02"/>
</g>
<!-- layer5_mha_attn_1 -->
<g id="node452" class="node">
<title>layer5_mha_attn_1</title>
<polygon fill="none" stroke="black" points="2323,-4016 2172,-4016 2172,-3980 2323,-3980 2323,-4016"/>
<text text-anchor="middle" x="2247.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_1</text>
</g>
<!-- layer5_mha_qkv_1&#45;&gt;layer5_mha_attn_1 -->
<g id="edge453" class="edge">
<title>layer5_mha_qkv_1&#45;&gt;layer5_mha_attn_1</title>
<path fill="none" stroke="black" d="M2247.5,-4116.68C2247.5,-4088.24 2247.5,-4051.08 2247.5,-4026.2"/>
<polygon fill="black" stroke="black" points="2251,-4026.02 2247.5,-4016.02 2244,-4026.02 2251,-4026.02"/>
</g>
<!-- layer5_mha_attn_2 -->
<g id="node457" class="node">
<title>layer5_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3454,-4016 3303,-4016 3303,-3980 3454,-3980 3454,-4016"/>
<text text-anchor="middle" x="3378.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_2</text>
</g>
<!-- layer5_mha_qkv_2&#45;&gt;layer5_mha_attn_2 -->
<g id="edge464" class="edge">
<title>layer5_mha_qkv_2&#45;&gt;layer5_mha_attn_2</title>
<path fill="none" stroke="black" d="M3378.5,-4116.68C3378.5,-4088.24 3378.5,-4051.08 3378.5,-4026.2"/>
<polygon fill="black" stroke="black" points="3382,-4026.02 3378.5,-4016.02 3375,-4026.02 3382,-4026.02"/>
</g>
<!-- layer5_mha_attn_3 -->
<g id="node462" class="node">
<title>layer5_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4754,-4016 4603,-4016 4603,-3980 4754,-3980 4754,-4016"/>
<text text-anchor="middle" x="4678.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_3</text>
</g>
<!-- layer5_mha_qkv_3&#45;&gt;layer5_mha_attn_3 -->
<g id="edge475" class="edge">
<title>layer5_mha_qkv_3&#45;&gt;layer5_mha_attn_3</title>
<path fill="none" stroke="black" d="M4678.5,-4116.68C4678.5,-4088.24 4678.5,-4051.08 4678.5,-4026.2"/>
<polygon fill="black" stroke="black" points="4682,-4026.02 4678.5,-4016.02 4675,-4026.02 4682,-4026.02"/>
</g>
<!-- layer5_mha_attn_4 -->
<g id="node467" class="node">
<title>layer5_mha_attn_4</title>
<polygon fill="none" stroke="black" points="5780,-4016 5629,-4016 5629,-3980 5780,-3980 5780,-4016"/>
<text text-anchor="middle" x="5704.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_4</text>
</g>
<!-- layer5_mha_qkv_4&#45;&gt;layer5_mha_attn_4 -->
<g id="edge486" class="edge">
<title>layer5_mha_qkv_4&#45;&gt;layer5_mha_attn_4</title>
<path fill="none" stroke="black" d="M5704.5,-4116.68C5704.5,-4088.24 5704.5,-4051.08 5704.5,-4026.2"/>
<polygon fill="black" stroke="black" points="5708,-4026.02 5704.5,-4016.02 5701,-4026.02 5708,-4026.02"/>
</g>
<!-- layer5_mha_attn_5 -->
<g id="node472" class="node">
<title>layer5_mha_attn_5</title>
<polygon fill="none" stroke="black" points="6865,-4016 6714,-4016 6714,-3980 6865,-3980 6865,-4016"/>
<text text-anchor="middle" x="6789.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_5</text>
</g>
<!-- layer5_mha_qkv_5&#45;&gt;layer5_mha_attn_5 -->
<g id="edge497" class="edge">
<title>layer5_mha_qkv_5&#45;&gt;layer5_mha_attn_5</title>
<path fill="none" stroke="black" d="M6789.5,-4116.68C6789.5,-4088.24 6789.5,-4051.08 6789.5,-4026.2"/>
<polygon fill="black" stroke="black" points="6793,-4026.02 6789.5,-4016.02 6786,-4026.02 6793,-4026.02"/>
</g>
<!-- layer5_mha_attn_6 -->
<g id="node477" class="node">
<title>layer5_mha_attn_6</title>
<polygon fill="none" stroke="black" points="8157,-4016 8006,-4016 8006,-3980 8157,-3980 8157,-4016"/>
<text text-anchor="middle" x="8081.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer5_mha_attn_6</text>
</g>
<!-- layer5_mha_qkv_6&#45;&gt;layer5_mha_attn_6 -->
<g id="edge508" class="edge">
<title>layer5_mha_qkv_6&#45;&gt;layer5_mha_attn_6</title>
<path fill="none" stroke="black" d="M8081.5,-4116.68C8081.5,-4088.24 8081.5,-4051.08 8081.5,-4026.2"/>
<polygon fill="black" stroke="black" points="8085,-4026.02 8081.5,-4016.02 8078,-4026.02 8085,-4026.02"/>
</g>
<!-- layer5_mha_attn_7 -->
<g id="node410" class="node">
<title>layer5_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9583.31,-4081 8824.81,-4081 8629.69,-3915 9388.19,-3915 9583.31,-4081"/>
<text text-anchor="middle" x="9106.5" y="-4024.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="9106.5" y="-4009.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="9106.5" y="-3994.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9106.5" y="-3979.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3964.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_mha_qkv_7&#45;&gt;layer5_mha_attn_7 -->
<g id="edge519" class="edge">
<title>layer5_mha_qkv_7&#45;&gt;layer5_mha_attn_7</title>
<path fill="none" stroke="black" d="M9106.5,-4116.68C9106.5,-4108.75 9106.5,-4100.14 9106.5,-4091.31"/>
<polygon fill="black" stroke="black" points="9110,-4091.27 9106.5,-4081.27 9103,-4091.27 9110,-4091.27"/>
</g>
<!-- layer5_mha_out_7 -->
<g id="node418" class="node">
<title>layer5_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="9325.5,-3879 8887.5,-3879 8887.5,-3796 9325.5,-3796 9325.5,-3879"/>
<text text-anchor="middle" x="9106.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9106.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9106.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9106.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_mha_attn_7&#45;&gt;layer5_mha_out_7 -->
<g id="edge520" class="edge">
<title>layer5_mha_attn_7&#45;&gt;layer5_mha_out_7</title>
<path fill="none" stroke="black" d="M9106.5,-3914.96C9106.5,-3906.25 9106.5,-3897.59 9106.5,-3889.39"/>
<polygon fill="black" stroke="black" points="9110,-3889.29 9106.5,-3879.29 9103,-3889.29 9110,-3889.29"/>
</g>
<!-- layer5_mha_out_0 -->
<g id="node411" class="node">
<title>layer5_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="1198.5,-3879 760.5,-3879 760.5,-3796 1198.5,-3796 1198.5,-3879"/>
<text text-anchor="middle" x="979.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="979.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="979.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="979.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="979.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_res1_0 -->
<g id="node448" class="node">
<title>layer5_res1_0</title>
<polygon fill="none" stroke="black" points="1037.5,-3695 921.5,-3695 921.5,-3659 1037.5,-3659 1037.5,-3695"/>
<text text-anchor="middle" x="979.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_0</text>
</g>
<!-- layer5_mha_out_0&#45;&gt;layer5_res1_0 -->
<g id="edge444" class="edge">
<title>layer5_mha_out_0&#45;&gt;layer5_res1_0</title>
<path fill="none" stroke="black" d="M979.5,-3795.68C979.5,-3767.24 979.5,-3730.08 979.5,-3705.2"/>
<polygon fill="black" stroke="black" points="983,-3705.02 979.5,-3695.02 976,-3705.02 983,-3705.02"/>
</g>
<!-- layer5_mha_out_1 -->
<g id="node412" class="node">
<title>layer5_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2466.5,-3879 2028.5,-3879 2028.5,-3796 2466.5,-3796 2466.5,-3879"/>
<text text-anchor="middle" x="2247.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="2247.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2247.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2247.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="2247.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_res1_1 -->
<g id="node453" class="node">
<title>layer5_res1_1</title>
<polygon fill="none" stroke="black" points="2305.5,-3695 2189.5,-3695 2189.5,-3659 2305.5,-3659 2305.5,-3695"/>
<text text-anchor="middle" x="2247.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_1</text>
</g>
<!-- layer5_mha_out_1&#45;&gt;layer5_res1_1 -->
<g id="edge455" class="edge">
<title>layer5_mha_out_1&#45;&gt;layer5_res1_1</title>
<path fill="none" stroke="black" d="M2247.5,-3795.68C2247.5,-3767.24 2247.5,-3730.08 2247.5,-3705.2"/>
<polygon fill="black" stroke="black" points="2251,-3705.02 2247.5,-3695.02 2244,-3705.02 2251,-3705.02"/>
</g>
<!-- layer5_mha_out_2 -->
<g id="node413" class="node">
<title>layer5_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3597.5,-3879 3159.5,-3879 3159.5,-3796 3597.5,-3796 3597.5,-3879"/>
<text text-anchor="middle" x="3378.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3378.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3378.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3378.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3378.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_res1_2 -->
<g id="node458" class="node">
<title>layer5_res1_2</title>
<polygon fill="none" stroke="black" points="3436.5,-3695 3320.5,-3695 3320.5,-3659 3436.5,-3659 3436.5,-3695"/>
<text text-anchor="middle" x="3378.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_2</text>
</g>
<!-- layer5_mha_out_2&#45;&gt;layer5_res1_2 -->
<g id="edge466" class="edge">
<title>layer5_mha_out_2&#45;&gt;layer5_res1_2</title>
<path fill="none" stroke="black" d="M3378.5,-3795.68C3378.5,-3767.24 3378.5,-3730.08 3378.5,-3705.2"/>
<polygon fill="black" stroke="black" points="3382,-3705.02 3378.5,-3695.02 3375,-3705.02 3382,-3705.02"/>
</g>
<!-- layer5_mha_out_3 -->
<g id="node414" class="node">
<title>layer5_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4897.5,-3879 4459.5,-3879 4459.5,-3796 4897.5,-3796 4897.5,-3879"/>
<text text-anchor="middle" x="4678.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4678.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4678.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4678.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4678.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_res1_3 -->
<g id="node463" class="node">
<title>layer5_res1_3</title>
<polygon fill="none" stroke="black" points="4736.5,-3695 4620.5,-3695 4620.5,-3659 4736.5,-3659 4736.5,-3695"/>
<text text-anchor="middle" x="4678.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_3</text>
</g>
<!-- layer5_mha_out_3&#45;&gt;layer5_res1_3 -->
<g id="edge477" class="edge">
<title>layer5_mha_out_3&#45;&gt;layer5_res1_3</title>
<path fill="none" stroke="black" d="M4678.5,-3795.68C4678.5,-3767.24 4678.5,-3730.08 4678.5,-3705.2"/>
<polygon fill="black" stroke="black" points="4682,-3705.02 4678.5,-3695.02 4675,-3705.02 4682,-3705.02"/>
</g>
<!-- layer5_mha_out_4 -->
<g id="node415" class="node">
<title>layer5_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="5923.5,-3879 5485.5,-3879 5485.5,-3796 5923.5,-3796 5923.5,-3879"/>
<text text-anchor="middle" x="5704.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="5704.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5704.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5704.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="5704.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_res1_4 -->
<g id="node468" class="node">
<title>layer5_res1_4</title>
<polygon fill="none" stroke="black" points="5762.5,-3695 5646.5,-3695 5646.5,-3659 5762.5,-3659 5762.5,-3695"/>
<text text-anchor="middle" x="5704.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_4</text>
</g>
<!-- layer5_mha_out_4&#45;&gt;layer5_res1_4 -->
<g id="edge488" class="edge">
<title>layer5_mha_out_4&#45;&gt;layer5_res1_4</title>
<path fill="none" stroke="black" d="M5704.5,-3795.68C5704.5,-3767.24 5704.5,-3730.08 5704.5,-3705.2"/>
<polygon fill="black" stroke="black" points="5708,-3705.02 5704.5,-3695.02 5701,-3705.02 5708,-3705.02"/>
</g>
<!-- layer5_mha_out_5 -->
<g id="node416" class="node">
<title>layer5_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="7008.5,-3879 6570.5,-3879 6570.5,-3796 7008.5,-3796 7008.5,-3879"/>
<text text-anchor="middle" x="6789.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6789.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6789.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6789.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6789.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_res1_5 -->
<g id="node473" class="node">
<title>layer5_res1_5</title>
<polygon fill="none" stroke="black" points="6847.5,-3695 6731.5,-3695 6731.5,-3659 6847.5,-3659 6847.5,-3695"/>
<text text-anchor="middle" x="6789.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_5</text>
</g>
<!-- layer5_mha_out_5&#45;&gt;layer5_res1_5 -->
<g id="edge499" class="edge">
<title>layer5_mha_out_5&#45;&gt;layer5_res1_5</title>
<path fill="none" stroke="black" d="M6789.5,-3795.68C6789.5,-3767.24 6789.5,-3730.08 6789.5,-3705.2"/>
<polygon fill="black" stroke="black" points="6793,-3705.02 6789.5,-3695.02 6786,-3705.02 6793,-3705.02"/>
</g>
<!-- layer5_mha_out_6 -->
<g id="node417" class="node">
<title>layer5_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="8300.5,-3879 7862.5,-3879 7862.5,-3796 8300.5,-3796 8300.5,-3879"/>
<text text-anchor="middle" x="8081.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8081.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8081.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8081.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8081.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_res1_6 -->
<g id="node478" class="node">
<title>layer5_res1_6</title>
<polygon fill="none" stroke="black" points="8139.5,-3695 8023.5,-3695 8023.5,-3659 8139.5,-3659 8139.5,-3695"/>
<text text-anchor="middle" x="8081.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer5_res1_6</text>
</g>
<!-- layer5_mha_out_6&#45;&gt;layer5_res1_6 -->
<g id="edge510" class="edge">
<title>layer5_mha_out_6&#45;&gt;layer5_res1_6</title>
<path fill="none" stroke="black" d="M8081.5,-3795.68C8081.5,-3767.24 8081.5,-3730.08 8081.5,-3705.2"/>
<polygon fill="black" stroke="black" points="8085,-3705.02 8081.5,-3695.02 8078,-3705.02 8085,-3705.02"/>
</g>
<!-- layer5_res1_7 -->
<g id="node419" class="node">
<title>layer5_res1_7</title>
<polygon fill="none" stroke="black" points="9547.24,-3760 8846.12,-3760 8665.76,-3594 9366.88,-3594 9547.24,-3760"/>
<text text-anchor="middle" x="9106.5" y="-3703.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9106.5" y="-3688.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3673.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3658.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3643.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_mha_out_7&#45;&gt;layer5_res1_7 -->
<g id="edge521" class="edge">
<title>layer5_mha_out_7&#45;&gt;layer5_res1_7</title>
<path fill="none" stroke="black" d="M9106.5,-3795.68C9106.5,-3787.75 9106.5,-3779.14 9106.5,-3770.31"/>
<polygon fill="black" stroke="black" points="9110,-3770.27 9106.5,-3760.27 9103,-3770.27 9110,-3770.27"/>
</g>
<!-- layer5_ln1_7 -->
<g id="node420" class="node">
<title>layer5_ln1_7</title>
<polygon fill="yellow" stroke="black" points="9319,-3558 8894,-3558 8894,-3490 9319,-3490 9319,-3558"/>
<text text-anchor="middle" x="9106.5" y="-3542.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="9106.5" y="-3527.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3512.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9106.5" y="-3497.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_res1_7&#45;&gt;layer5_ln1_7 -->
<g id="edge522" class="edge">
<title>layer5_res1_7&#45;&gt;layer5_ln1_7</title>
<path fill="none" stroke="black" d="M9106.5,-3593.87C9106.5,-3585.12 9106.5,-3576.48 9106.5,-3568.45"/>
<polygon fill="black" stroke="black" points="9110,-3568.26 9106.5,-3558.26 9103,-3568.26 9110,-3568.26"/>
</g>
<!-- layer5_ffn_gate_7 -->
<g id="node428" class="node">
<title>layer5_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="8872,-3454 8399,-3454 8399,-3371 8872,-3371 8872,-3454"/>
<text text-anchor="middle" x="8635.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8635.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8635.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8635.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8635.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_ln1_7&#45;&gt;layer5_ffn_gate_7 -->
<g id="edge523" class="edge">
<title>layer5_ln1_7&#45;&gt;layer5_ffn_gate_7</title>
<path fill="none" stroke="black" d="M8964.55,-3490C8919.06,-3479.42 8868.01,-3467.56 8819.95,-3456.38"/>
<polygon fill="black" stroke="black" points="8820.59,-3452.94 8810.06,-3454.08 8819.01,-3459.76 8820.59,-3452.94"/>
</g>
<!-- layer5_ffn_up_7 -->
<g id="node436" class="node">
<title>layer5_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9363,-3454 8890,-3454 8890,-3371 9363,-3371 9363,-3454"/>
<text text-anchor="middle" x="9126.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9126.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9126.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9126.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9126.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_ln1_7&#45;&gt;layer5_ffn_up_7 -->
<g id="edge524" class="edge">
<title>layer5_ln1_7&#45;&gt;layer5_ffn_up_7</title>
<path fill="none" stroke="black" d="M9112.55,-3489.85C9114.03,-3481.8 9115.63,-3473 9117.21,-3464.34"/>
<polygon fill="black" stroke="black" points="9120.7,-3464.74 9119.05,-3454.28 9113.81,-3463.49 9120.7,-3464.74"/>
</g>
<!-- layer5_ffn_gate_0 -->
<g id="node421" class="node">
<title>layer5_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="954,-3454 481,-3454 481,-3371 954,-3371 954,-3454"/>
<text text-anchor="middle" x="717.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="717.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="717.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="717.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="717.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_ffn_act_0 -->
<g id="node450" class="node">
<title>layer5_ffn_act_0</title>
<polygon fill="none" stroke="black" points="897,-3270 766,-3270 766,-3234 897,-3234 897,-3270"/>
<text text-anchor="middle" x="831.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_0</text>
</g>
<!-- layer5_ffn_gate_0&#45;&gt;layer5_ffn_act_0 -->
<g id="edge448" class="edge">
<title>layer5_ffn_gate_0&#45;&gt;layer5_ffn_act_0</title>
<path fill="none" stroke="black" d="M746.86,-3370.68C767.87,-3341.47 795.49,-3303.07 813.36,-3278.21"/>
<polygon fill="black" stroke="black" points="816.26,-3280.19 819.26,-3270.02 810.58,-3276.1 816.26,-3280.19"/>
</g>
<!-- layer5_ffn_gate_1 -->
<g id="node422" class="node">
<title>layer5_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="2118,-3454 1645,-3454 1645,-3371 2118,-3371 2118,-3454"/>
<text text-anchor="middle" x="1881.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1881.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1881.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1881.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1881.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_ffn_act_1 -->
<g id="node455" class="node">
<title>layer5_ffn_act_1</title>
<polygon fill="none" stroke="black" points="1957,-3270 1826,-3270 1826,-3234 1957,-3234 1957,-3270"/>
<text text-anchor="middle" x="1891.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_1</text>
</g>
<!-- layer5_ffn_gate_1&#45;&gt;layer5_ffn_act_1 -->
<g id="edge459" class="edge">
<title>layer5_ffn_gate_1&#45;&gt;layer5_ffn_act_1</title>
<path fill="none" stroke="black" d="M1884.08,-3370.68C1885.87,-3342.24 1888.21,-3305.08 1889.78,-3280.2"/>
<polygon fill="black" stroke="black" points="1893.29,-3280.22 1890.43,-3270.02 1886.3,-3279.78 1893.29,-3280.22"/>
</g>
<!-- layer5_ffn_gate_2 -->
<g id="node423" class="node">
<title>layer5_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3293,-3454 2820,-3454 2820,-3371 3293,-3371 3293,-3454"/>
<text text-anchor="middle" x="3056.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3056.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3056.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3056.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3056.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_ffn_act_2 -->
<g id="node460" class="node">
<title>layer5_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3564,-3270 3433,-3270 3433,-3234 3564,-3234 3564,-3270"/>
<text text-anchor="middle" x="3498.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_2</text>
</g>
<!-- layer5_ffn_gate_2&#45;&gt;layer5_ffn_act_2 -->
<g id="edge470" class="edge">
<title>layer5_ffn_gate_2&#45;&gt;layer5_ffn_act_2</title>
<path fill="none" stroke="black" d="M3169.47,-3370.99C3256.25,-3339.87 3372.52,-3298.18 3441.08,-3273.59"/>
<polygon fill="black" stroke="black" points="3442.6,-3276.76 3450.84,-3270.09 3440.24,-3270.17 3442.6,-3276.76"/>
</g>
<!-- layer5_ffn_gate_3 -->
<g id="node424" class="node">
<title>layer5_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4801,-3454 4328,-3454 4328,-3371 4801,-3371 4801,-3454"/>
<text text-anchor="middle" x="4564.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4564.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4564.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4564.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4564.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_ffn_act_3 -->
<g id="node465" class="node">
<title>layer5_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4651,-3270 4520,-3270 4520,-3234 4651,-3234 4651,-3270"/>
<text text-anchor="middle" x="4585.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_3</text>
</g>
<!-- layer5_ffn_gate_3&#45;&gt;layer5_ffn_act_3 -->
<g id="edge481" class="edge">
<title>layer5_ffn_gate_3&#45;&gt;layer5_ffn_act_3</title>
<path fill="none" stroke="black" d="M4569.91,-3370.68C4573.68,-3342.24 4578.6,-3305.08 4581.9,-3280.2"/>
<polygon fill="black" stroke="black" points="4585.4,-3280.4 4583.24,-3270.02 4578.46,-3279.48 4585.4,-3280.4"/>
</g>
<!-- layer5_ffn_gate_4 -->
<g id="node425" class="node">
<title>layer5_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5794,-3454 5321,-3454 5321,-3371 5794,-3371 5794,-3454"/>
<text text-anchor="middle" x="5557.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5557.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5557.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5557.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5557.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_ffn_act_4 -->
<g id="node470" class="node">
<title>layer5_ffn_act_4</title>
<polygon fill="none" stroke="black" points="6073,-3270 5942,-3270 5942,-3234 6073,-3234 6073,-3270"/>
<text text-anchor="middle" x="6007.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_4</text>
</g>
<!-- layer5_ffn_gate_4&#45;&gt;layer5_ffn_act_4 -->
<g id="edge492" class="edge">
<title>layer5_ffn_gate_4&#45;&gt;layer5_ffn_act_4</title>
<path fill="none" stroke="black" d="M5672.51,-3370.99C5761.05,-3339.81 5879.72,-3298.01 5949.47,-3273.44"/>
<polygon fill="black" stroke="black" points="5950.7,-3276.72 5958.97,-3270.09 5948.38,-3270.11 5950.7,-3276.72"/>
</g>
<!-- layer5_ffn_gate_5 -->
<g id="node426" class="node">
<title>layer5_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6815,-3454 6342,-3454 6342,-3371 6815,-3371 6815,-3454"/>
<text text-anchor="middle" x="6578.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6578.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6578.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6578.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6578.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_ffn_act_5 -->
<g id="node475" class="node">
<title>layer5_ffn_act_5</title>
<polygon fill="none" stroke="black" points="6689,-3270 6558,-3270 6558,-3234 6689,-3234 6689,-3270"/>
<text text-anchor="middle" x="6623.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_5</text>
</g>
<!-- layer5_ffn_gate_5&#45;&gt;layer5_ffn_act_5 -->
<g id="edge503" class="edge">
<title>layer5_ffn_gate_5&#45;&gt;layer5_ffn_act_5</title>
<path fill="none" stroke="black" d="M6590.09,-3370.68C6598.2,-3342.11 6608.81,-3304.74 6615.87,-3279.86"/>
<polygon fill="black" stroke="black" points="6619.3,-3280.6 6618.67,-3270.02 6612.57,-3278.69 6619.3,-3280.6"/>
</g>
<!-- layer5_ffn_gate_6 -->
<g id="node427" class="node">
<title>layer5_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="7837,-3454 7364,-3454 7364,-3371 7837,-3371 7837,-3454"/>
<text text-anchor="middle" x="7600.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7600.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7600.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7600.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7600.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_ffn_act_6 -->
<g id="node480" class="node">
<title>layer5_ffn_act_6</title>
<polygon fill="none" stroke="black" points="7920,-3270 7789,-3270 7789,-3234 7920,-3234 7920,-3270"/>
<text text-anchor="middle" x="7854.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer5_ffn_act_6</text>
</g>
<!-- layer5_ffn_gate_6&#45;&gt;layer5_ffn_act_6 -->
<g id="edge514" class="edge">
<title>layer5_ffn_gate_6&#45;&gt;layer5_ffn_act_6</title>
<path fill="none" stroke="black" d="M7665.58,-3370.89C7714.23,-3340.53 7778.92,-3300.16 7818.59,-3275.41"/>
<polygon fill="black" stroke="black" points="7820.52,-3278.33 7827.15,-3270.07 7816.81,-3272.39 7820.52,-3278.33"/>
</g>
<!-- layer5_ffn_act_7 -->
<g id="node437" class="node">
<title>layer5_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9132.24,-3335 8375.44,-3335 8180.76,-3169 8937.56,-3169 9132.24,-3335"/>
<text text-anchor="middle" x="8656.5" y="-3278.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="8656.5" y="-3263.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="8656.5" y="-3248.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8656.5" y="-3233.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8656.5" y="-3218.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_ffn_gate_7&#45;&gt;layer5_ffn_act_7 -->
<g id="edge525" class="edge">
<title>layer5_ffn_gate_7&#45;&gt;layer5_ffn_act_7</title>
<path fill="none" stroke="black" d="M8640.91,-3370.68C8641.96,-3362.75 8643.1,-3354.14 8644.27,-3345.31"/>
<polygon fill="black" stroke="black" points="8647.76,-3345.65 8645.6,-3335.27 8640.82,-3344.73 8647.76,-3345.65"/>
</g>
<!-- layer5_ffn_up_0 -->
<g id="node429" class="node">
<title>layer5_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="1445,-3454 972,-3454 972,-3371 1445,-3371 1445,-3454"/>
<text text-anchor="middle" x="1208.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1208.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="1208.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1208.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1208.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_ffn_up_0&#45;&gt;layer5_ffn_act_0 -->
<g id="edge449" class="edge">
<title>layer5_ffn_up_0&#45;&gt;layer5_ffn_act_0</title>
<path fill="none" stroke="black" d="M1111.9,-3370.89C1038.33,-3339.96 940.03,-3298.63 881.5,-3274.02"/>
<polygon fill="black" stroke="black" points="882.68,-3270.72 872.1,-3270.07 879.96,-3277.17 882.68,-3270.72"/>
</g>
<!-- layer5_ffn_up_1 -->
<g id="node430" class="node">
<title>layer5_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2609,-3454 2136,-3454 2136,-3371 2609,-3371 2609,-3454"/>
<text text-anchor="middle" x="2372.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2372.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="2372.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2372.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="2372.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_ffn_up_1&#45;&gt;layer5_ffn_act_1 -->
<g id="edge460" class="edge">
<title>layer5_ffn_up_1&#45;&gt;layer5_ffn_act_1</title>
<path fill="none" stroke="black" d="M2249.57,-3370.99C2154.74,-3339.74 2027.56,-3297.83 1953.08,-3273.29"/>
<polygon fill="black" stroke="black" points="1953.96,-3269.9 1943.37,-3270.09 1951.77,-3276.55 1953.96,-3269.9"/>
</g>
<!-- layer5_ffn_up_2 -->
<g id="node431" class="node">
<title>layer5_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="3784,-3454 3311,-3454 3311,-3371 3784,-3371 3784,-3454"/>
<text text-anchor="middle" x="3547.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3547.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3547.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3547.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3547.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_ffn_up_2&#45;&gt;layer5_ffn_act_2 -->
<g id="edge471" class="edge">
<title>layer5_ffn_up_2&#45;&gt;layer5_ffn_act_2</title>
<path fill="none" stroke="black" d="M3534.88,-3370.68C3526.05,-3342.11 3514.5,-3304.74 3506.8,-3279.86"/>
<polygon fill="black" stroke="black" points="3510.06,-3278.54 3503.76,-3270.02 3503.37,-3280.61 3510.06,-3278.54"/>
</g>
<!-- layer5_ffn_up_3 -->
<g id="node432" class="node">
<title>layer5_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="5292,-3454 4819,-3454 4819,-3371 5292,-3371 5292,-3454"/>
<text text-anchor="middle" x="5055.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5055.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="5055.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5055.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5055.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_ffn_up_3&#45;&gt;layer5_ffn_act_3 -->
<g id="edge482" class="edge">
<title>layer5_ffn_up_3&#45;&gt;layer5_ffn_act_3</title>
<path fill="none" stroke="black" d="M4935.38,-3370.99C4842.72,-3339.74 4718.45,-3297.83 4645.67,-3273.29"/>
<polygon fill="black" stroke="black" points="4646.78,-3269.97 4636.18,-3270.09 4644.54,-3276.6 4646.78,-3269.97"/>
</g>
<!-- layer5_ffn_up_4 -->
<g id="node433" class="node">
<title>layer5_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="6285,-3454 5812,-3454 5812,-3371 6285,-3371 6285,-3454"/>
<text text-anchor="middle" x="6048.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6048.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6048.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6048.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6048.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_ffn_up_4&#45;&gt;layer5_ffn_act_4 -->
<g id="edge493" class="edge">
<title>layer5_ffn_up_4&#45;&gt;layer5_ffn_act_4</title>
<path fill="none" stroke="black" d="M6037.94,-3370.68C6030.55,-3342.11 6020.89,-3304.74 6014.45,-3279.86"/>
<polygon fill="black" stroke="black" points="6017.8,-3278.83 6011.9,-3270.02 6011.02,-3280.58 6017.8,-3278.83"/>
</g>
<!-- layer5_ffn_up_5 -->
<g id="node434" class="node">
<title>layer5_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="7306,-3454 6833,-3454 6833,-3371 7306,-3371 7306,-3454"/>
<text text-anchor="middle" x="7069.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7069.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7069.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7069.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7069.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_ffn_up_5&#45;&gt;layer5_ffn_act_5 -->
<g id="edge504" class="edge">
<title>layer5_ffn_up_5&#45;&gt;layer5_ffn_act_5</title>
<path fill="none" stroke="black" d="M6955.51,-3370.99C6867.76,-3339.81 6750.14,-3298.01 6681.02,-3273.44"/>
<polygon fill="black" stroke="black" points="6682.19,-3270.14 6671.6,-3270.09 6679.85,-3276.74 6682.19,-3270.14"/>
</g>
<!-- layer5_ffn_up_6 -->
<g id="node435" class="node">
<title>layer5_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8328,-3454 7855,-3454 7855,-3371 8328,-3371 8328,-3454"/>
<text text-anchor="middle" x="8091.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8091.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8091.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8091.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8091.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_ffn_up_6&#45;&gt;layer5_ffn_act_6 -->
<g id="edge515" class="edge">
<title>layer5_ffn_up_6&#45;&gt;layer5_ffn_act_6</title>
<path fill="none" stroke="black" d="M8030.77,-3370.89C7985.57,-3340.66 7925.52,-3300.5 7888.47,-3275.72"/>
<polygon fill="black" stroke="black" points="7890.28,-3272.72 7880.02,-3270.07 7886.39,-3278.54 7890.28,-3272.72"/>
</g>
<!-- layer5_ffn_up_7&#45;&gt;layer5_ffn_act_7 -->
<g id="edge526" class="edge">
<title>layer5_ffn_up_7&#45;&gt;layer5_ffn_act_7</title>
<path fill="none" stroke="black" d="M9006.38,-3370.99C8976.42,-3360.89 8943.16,-3349.67 8909.41,-3338.29"/>
<polygon fill="black" stroke="black" points="8910.47,-3334.95 8899.87,-3335.07 8908.23,-3341.59 8910.47,-3334.95"/>
</g>
<!-- layer5_ffn_down_7 -->
<g id="node445" class="node">
<title>layer5_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="8880,-3133 8433,-3133 8433,-3050 8880,-3050 8880,-3133"/>
<text text-anchor="middle" x="8656.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8656.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8656.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8656.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8656.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_ffn_act_7&#45;&gt;layer5_ffn_down_7 -->
<g id="edge527" class="edge">
<title>layer5_ffn_act_7&#45;&gt;layer5_ffn_down_7</title>
<path fill="none" stroke="black" d="M8656.5,-3168.96C8656.5,-3160.25 8656.5,-3151.59 8656.5,-3143.39"/>
<polygon fill="black" stroke="black" points="8660,-3143.29 8656.5,-3133.29 8653,-3143.29 8660,-3143.29"/>
</g>
<!-- layer5_ffn_down_0 -->
<g id="node438" class="node">
<title>layer5_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="1055,-3133 608,-3133 608,-3050 1055,-3050 1055,-3133"/>
<text text-anchor="middle" x="831.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="831.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="831.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="831.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="831.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_res2_0 -->
<g id="node451" class="node">
<title>layer5_res2_0</title>
<polygon fill="none" stroke="black" points="889.5,-2949 773.5,-2949 773.5,-2913 889.5,-2913 889.5,-2949"/>
<text text-anchor="middle" x="831.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_0</text>
</g>
<!-- layer5_ffn_down_0&#45;&gt;layer5_res2_0 -->
<g id="edge451" class="edge">
<title>layer5_ffn_down_0&#45;&gt;layer5_res2_0</title>
<path fill="none" stroke="black" d="M831.5,-3049.68C831.5,-3021.24 831.5,-2984.08 831.5,-2959.2"/>
<polygon fill="black" stroke="black" points="835,-2959.02 831.5,-2949.02 828,-2959.02 835,-2959.02"/>
</g>
<!-- layer5_ffn_down_1 -->
<g id="node439" class="node">
<title>layer5_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="2115,-3133 1668,-3133 1668,-3050 2115,-3050 2115,-3133"/>
<text text-anchor="middle" x="1891.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1891.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1891.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1891.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1891.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_res2_1 -->
<g id="node456" class="node">
<title>layer5_res2_1</title>
<polygon fill="none" stroke="black" points="1949.5,-2949 1833.5,-2949 1833.5,-2913 1949.5,-2913 1949.5,-2949"/>
<text text-anchor="middle" x="1891.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_1</text>
</g>
<!-- layer5_ffn_down_1&#45;&gt;layer5_res2_1 -->
<g id="edge462" class="edge">
<title>layer5_ffn_down_1&#45;&gt;layer5_res2_1</title>
<path fill="none" stroke="black" d="M1891.5,-3049.68C1891.5,-3021.24 1891.5,-2984.08 1891.5,-2959.2"/>
<polygon fill="black" stroke="black" points="1895,-2959.02 1891.5,-2949.02 1888,-2959.02 1895,-2959.02"/>
</g>
<!-- layer5_ffn_down_2 -->
<g id="node440" class="node">
<title>layer5_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3722,-3133 3275,-3133 3275,-3050 3722,-3050 3722,-3133"/>
<text text-anchor="middle" x="3498.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3498.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3498.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3498.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3498.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_res2_2 -->
<g id="node461" class="node">
<title>layer5_res2_2</title>
<polygon fill="none" stroke="black" points="3556.5,-2949 3440.5,-2949 3440.5,-2913 3556.5,-2913 3556.5,-2949"/>
<text text-anchor="middle" x="3498.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_2</text>
</g>
<!-- layer5_ffn_down_2&#45;&gt;layer5_res2_2 -->
<g id="edge473" class="edge">
<title>layer5_ffn_down_2&#45;&gt;layer5_res2_2</title>
<path fill="none" stroke="black" d="M3498.5,-3049.68C3498.5,-3021.24 3498.5,-2984.08 3498.5,-2959.2"/>
<polygon fill="black" stroke="black" points="3502,-2959.02 3498.5,-2949.02 3495,-2959.02 3502,-2959.02"/>
</g>
<!-- layer5_ffn_down_3 -->
<g id="node441" class="node">
<title>layer5_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4809,-3133 4362,-3133 4362,-3050 4809,-3050 4809,-3133"/>
<text text-anchor="middle" x="4585.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4585.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4585.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4585.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_res2_3 -->
<g id="node466" class="node">
<title>layer5_res2_3</title>
<polygon fill="none" stroke="black" points="4643.5,-2949 4527.5,-2949 4527.5,-2913 4643.5,-2913 4643.5,-2949"/>
<text text-anchor="middle" x="4585.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_3</text>
</g>
<!-- layer5_ffn_down_3&#45;&gt;layer5_res2_3 -->
<g id="edge484" class="edge">
<title>layer5_ffn_down_3&#45;&gt;layer5_res2_3</title>
<path fill="none" stroke="black" d="M4585.5,-3049.68C4585.5,-3021.24 4585.5,-2984.08 4585.5,-2959.2"/>
<polygon fill="black" stroke="black" points="4589,-2959.02 4585.5,-2949.02 4582,-2959.02 4589,-2959.02"/>
</g>
<!-- layer5_ffn_down_4 -->
<g id="node442" class="node">
<title>layer5_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="6231,-3133 5784,-3133 5784,-3050 6231,-3050 6231,-3133"/>
<text text-anchor="middle" x="6007.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6007.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6007.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6007.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6007.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_res2_4 -->
<g id="node471" class="node">
<title>layer5_res2_4</title>
<polygon fill="none" stroke="black" points="6065.5,-2949 5949.5,-2949 5949.5,-2913 6065.5,-2913 6065.5,-2949"/>
<text text-anchor="middle" x="6007.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_4</text>
</g>
<!-- layer5_ffn_down_4&#45;&gt;layer5_res2_4 -->
<g id="edge495" class="edge">
<title>layer5_ffn_down_4&#45;&gt;layer5_res2_4</title>
<path fill="none" stroke="black" d="M6007.5,-3049.68C6007.5,-3021.24 6007.5,-2984.08 6007.5,-2959.2"/>
<polygon fill="black" stroke="black" points="6011,-2959.02 6007.5,-2949.02 6004,-2959.02 6011,-2959.02"/>
</g>
<!-- layer5_ffn_down_5 -->
<g id="node443" class="node">
<title>layer5_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="6847,-3133 6400,-3133 6400,-3050 6847,-3050 6847,-3133"/>
<text text-anchor="middle" x="6623.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6623.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6623.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6623.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6623.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_res2_5 -->
<g id="node476" class="node">
<title>layer5_res2_5</title>
<polygon fill="none" stroke="black" points="6681.5,-2949 6565.5,-2949 6565.5,-2913 6681.5,-2913 6681.5,-2949"/>
<text text-anchor="middle" x="6623.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_5</text>
</g>
<!-- layer5_ffn_down_5&#45;&gt;layer5_res2_5 -->
<g id="edge506" class="edge">
<title>layer5_ffn_down_5&#45;&gt;layer5_res2_5</title>
<path fill="none" stroke="black" d="M6623.5,-3049.68C6623.5,-3021.24 6623.5,-2984.08 6623.5,-2959.2"/>
<polygon fill="black" stroke="black" points="6627,-2959.02 6623.5,-2949.02 6620,-2959.02 6627,-2959.02"/>
</g>
<!-- layer5_ffn_down_6 -->
<g id="node444" class="node">
<title>layer5_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="8078,-3133 7631,-3133 7631,-3050 8078,-3050 8078,-3133"/>
<text text-anchor="middle" x="7854.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7854.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7854.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7854.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7854.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_res2_6 -->
<g id="node481" class="node">
<title>layer5_res2_6</title>
<polygon fill="none" stroke="black" points="7912.5,-2949 7796.5,-2949 7796.5,-2913 7912.5,-2913 7912.5,-2949"/>
<text text-anchor="middle" x="7854.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer5_res2_6</text>
</g>
<!-- layer5_ffn_down_6&#45;&gt;layer5_res2_6 -->
<g id="edge517" class="edge">
<title>layer5_ffn_down_6&#45;&gt;layer5_res2_6</title>
<path fill="none" stroke="black" d="M7854.5,-3049.68C7854.5,-3021.24 7854.5,-2984.08 7854.5,-2959.2"/>
<polygon fill="black" stroke="black" points="7858,-2959.02 7854.5,-2949.02 7851,-2959.02 7858,-2959.02"/>
</g>
<!-- layer5_res2_7 -->
<g id="node446" class="node">
<title>layer5_res2_7</title>
<polygon fill="none" stroke="black" points="9097.24,-3014 8396.12,-3014 8215.76,-2848 8916.88,-2848 9097.24,-3014"/>
<text text-anchor="middle" x="8656.5" y="-2957.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8656.5" y="-2942.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2927.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2912.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2897.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer5_ffn_down_7&#45;&gt;layer5_res2_7 -->
<g id="edge528" class="edge">
<title>layer5_ffn_down_7&#45;&gt;layer5_res2_7</title>
<path fill="none" stroke="black" d="M8656.5,-3049.68C8656.5,-3041.75 8656.5,-3033.14 8656.5,-3024.31"/>
<polygon fill="black" stroke="black" points="8660,-3024.27 8656.5,-3014.27 8653,-3024.27 8660,-3024.27"/>
</g>
<!-- layer6_mha_qkv_7 -->
<g id="node489" class="node">
<title>layer6_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="8934.5,-2812 8378.5,-2812 8378.5,-2729 8934.5,-2729 8934.5,-2812"/>
<text text-anchor="middle" x="8656.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8656.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8656.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8656.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer5_res2_7&#45;&gt;layer6_mha_qkv_7 -->
<g id="edge606" class="edge">
<title>layer5_res2_7&#45;&gt;layer6_mha_qkv_7</title>
<path fill="none" stroke="black" d="M8656.5,-2847.96C8656.5,-2839.25 8656.5,-2830.59 8656.5,-2822.39"/>
<polygon fill="black" stroke="black" points="8660,-2822.29 8656.5,-2812.29 8653,-2822.29 8660,-2822.29"/>
</g>
<!-- layer5_mha_attn_0&#45;&gt;layer5_mha_out_0 -->
<g id="edge443" class="edge">
<title>layer5_mha_attn_0&#45;&gt;layer5_mha_out_0</title>
<path fill="none" stroke="black" d="M979.5,-3979.74C979.5,-3958.18 979.5,-3920.37 979.5,-3889.29"/>
<polygon fill="black" stroke="black" points="983,-3889.04 979.5,-3879.04 976,-3889.04 983,-3889.04"/>
</g>
<!-- layer5_ln1_0 -->
<g id="node449" class="node">
<title>layer5_ln1_0</title>
<polygon fill="none" stroke="black" points="1033,-3542 926,-3542 926,-3506 1033,-3506 1033,-3542"/>
<text text-anchor="middle" x="979.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_0</text>
</g>
<!-- layer5_res1_0&#45;&gt;layer5_ln1_0 -->
<g id="edge445" class="edge">
<title>layer5_res1_0&#45;&gt;layer5_ln1_0</title>
<path fill="none" stroke="black" d="M979.5,-3658.97C979.5,-3633.03 979.5,-3583.36 979.5,-3552.33"/>
<polygon fill="black" stroke="black" points="983,-3552.2 979.5,-3542.2 976,-3552.2 983,-3552.2"/>
</g>
<!-- layer5_ln1_0&#45;&gt;layer5_ffn_gate_0 -->
<g id="edge446" class="edge">
<title>layer5_ln1_0&#45;&gt;layer5_ffn_gate_0</title>
<path fill="none" stroke="black" d="M938.56,-3505.89C907.79,-3493.03 864.16,-3474.79 823.78,-3457.92"/>
<polygon fill="black" stroke="black" points="824.98,-3454.63 814.41,-3454 822.28,-3461.09 824.98,-3454.63"/>
</g>
<!-- layer5_ln1_0&#45;&gt;layer5_ffn_up_0 -->
<g id="edge447" class="edge">
<title>layer5_ln1_0&#45;&gt;layer5_ffn_up_0</title>
<path fill="none" stroke="black" d="M1015.28,-3505.89C1041.84,-3493.19 1079.35,-3475.25 1114.27,-3458.56"/>
<polygon fill="black" stroke="black" points="1116.04,-3461.59 1123.55,-3454.12 1113.02,-3455.27 1116.04,-3461.59"/>
</g>
<!-- layer5_ffn_act_0&#45;&gt;layer5_ffn_down_0 -->
<g id="edge450" class="edge">
<title>layer5_ffn_act_0&#45;&gt;layer5_ffn_down_0</title>
<path fill="none" stroke="black" d="M831.5,-3233.74C831.5,-3212.18 831.5,-3174.37 831.5,-3143.29"/>
<polygon fill="black" stroke="black" points="835,-3143.04 831.5,-3133.04 828,-3143.04 835,-3143.04"/>
</g>
<!-- layer6_mha_qkv_0 -->
<g id="node482" class="node">
<title>layer6_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="1109.5,-2812 553.5,-2812 553.5,-2729 1109.5,-2729 1109.5,-2812"/>
<text text-anchor="middle" x="831.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="831.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="831.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="831.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="831.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer5_res2_0&#45;&gt;layer6_mha_qkv_0 -->
<g id="edge529" class="edge">
<title>layer5_res2_0&#45;&gt;layer6_mha_qkv_0</title>
<path fill="none" stroke="black" d="M831.5,-2912.74C831.5,-2891.18 831.5,-2853.37 831.5,-2822.29"/>
<polygon fill="black" stroke="black" points="835,-2822.04 831.5,-2812.04 828,-2822.04 835,-2822.04"/>
</g>
<!-- layer5_mha_attn_1&#45;&gt;layer5_mha_out_1 -->
<g id="edge454" class="edge">
<title>layer5_mha_attn_1&#45;&gt;layer5_mha_out_1</title>
<path fill="none" stroke="black" d="M2247.5,-3979.74C2247.5,-3958.18 2247.5,-3920.37 2247.5,-3889.29"/>
<polygon fill="black" stroke="black" points="2251,-3889.04 2247.5,-3879.04 2244,-3889.04 2251,-3889.04"/>
</g>
<!-- layer5_ln1_1 -->
<g id="node454" class="node">
<title>layer5_ln1_1</title>
<polygon fill="none" stroke="black" points="2301,-3542 2194,-3542 2194,-3506 2301,-3506 2301,-3542"/>
<text text-anchor="middle" x="2247.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_1</text>
</g>
<!-- layer5_res1_1&#45;&gt;layer5_ln1_1 -->
<g id="edge456" class="edge">
<title>layer5_res1_1&#45;&gt;layer5_ln1_1</title>
<path fill="none" stroke="black" d="M2247.5,-3658.97C2247.5,-3633.03 2247.5,-3583.36 2247.5,-3552.33"/>
<polygon fill="black" stroke="black" points="2251,-3552.2 2247.5,-3542.2 2244,-3552.2 2251,-3552.2"/>
</g>
<!-- layer5_ln1_1&#45;&gt;layer5_ffn_gate_1 -->
<g id="edge457" class="edge">
<title>layer5_ln1_1&#45;&gt;layer5_ffn_gate_1</title>
<path fill="none" stroke="black" d="M2193.89,-3506.96C2149.97,-3493.82 2085.7,-3474.59 2026.85,-3456.99"/>
<polygon fill="black" stroke="black" points="2027.66,-3453.58 2017.08,-3454.06 2025.66,-3460.28 2027.66,-3453.58"/>
</g>
<!-- layer5_ln1_1&#45;&gt;layer5_ffn_up_1 -->
<g id="edge458" class="edge">
<title>layer5_ln1_1&#45;&gt;layer5_ffn_up_1</title>
<path fill="none" stroke="black" d="M2267.03,-3505.89C2280.85,-3493.79 2300.1,-3476.92 2318.38,-3460.91"/>
<polygon fill="black" stroke="black" points="2320.92,-3463.34 2326.13,-3454.12 2316.3,-3458.07 2320.92,-3463.34"/>
</g>
<!-- layer5_ffn_act_1&#45;&gt;layer5_ffn_down_1 -->
<g id="edge461" class="edge">
<title>layer5_ffn_act_1&#45;&gt;layer5_ffn_down_1</title>
<path fill="none" stroke="black" d="M1891.5,-3233.74C1891.5,-3212.18 1891.5,-3174.37 1891.5,-3143.29"/>
<polygon fill="black" stroke="black" points="1895,-3143.04 1891.5,-3133.04 1888,-3143.04 1895,-3143.04"/>
</g>
<!-- layer6_mha_qkv_1 -->
<g id="node483" class="node">
<title>layer6_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2169.5,-2812 1613.5,-2812 1613.5,-2729 2169.5,-2729 2169.5,-2812"/>
<text text-anchor="middle" x="1891.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="1891.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1891.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1891.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="1891.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer5_res2_1&#45;&gt;layer6_mha_qkv_1 -->
<g id="edge540" class="edge">
<title>layer5_res2_1&#45;&gt;layer6_mha_qkv_1</title>
<path fill="none" stroke="black" d="M1891.5,-2912.74C1891.5,-2891.18 1891.5,-2853.37 1891.5,-2822.29"/>
<polygon fill="black" stroke="black" points="1895,-2822.04 1891.5,-2812.04 1888,-2822.04 1895,-2822.04"/>
</g>
<!-- layer5_mha_attn_2&#45;&gt;layer5_mha_out_2 -->
<g id="edge465" class="edge">
<title>layer5_mha_attn_2&#45;&gt;layer5_mha_out_2</title>
<path fill="none" stroke="black" d="M3378.5,-3979.74C3378.5,-3958.18 3378.5,-3920.37 3378.5,-3889.29"/>
<polygon fill="black" stroke="black" points="3382,-3889.04 3378.5,-3879.04 3375,-3889.04 3382,-3889.04"/>
</g>
<!-- layer5_ln1_2 -->
<g id="node459" class="node">
<title>layer5_ln1_2</title>
<polygon fill="none" stroke="black" points="3432,-3542 3325,-3542 3325,-3506 3432,-3506 3432,-3542"/>
<text text-anchor="middle" x="3378.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_2</text>
</g>
<!-- layer5_res1_2&#45;&gt;layer5_ln1_2 -->
<g id="edge467" class="edge">
<title>layer5_res1_2&#45;&gt;layer5_ln1_2</title>
<path fill="none" stroke="black" d="M3378.5,-3658.97C3378.5,-3633.03 3378.5,-3583.36 3378.5,-3552.33"/>
<polygon fill="black" stroke="black" points="3382,-3552.2 3378.5,-3542.2 3375,-3552.2 3382,-3552.2"/>
</g>
<!-- layer5_ln1_2&#45;&gt;layer5_ffn_gate_2 -->
<g id="edge468" class="edge">
<title>layer5_ln1_2&#45;&gt;layer5_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3328.19,-3505.89C3289.89,-3492.87 3235.38,-3474.33 3185.24,-3457.28"/>
<polygon fill="black" stroke="black" points="3186.19,-3453.91 3175.6,-3454 3183.94,-3460.53 3186.19,-3453.91"/>
</g>
<!-- layer5_ln1_2&#45;&gt;layer5_ffn_up_2 -->
<g id="edge469" class="edge">
<title>layer5_ln1_2&#45;&gt;layer5_ffn_up_2</title>
<path fill="none" stroke="black" d="M3404.91,-3505.89C3424.09,-3493.46 3451.02,-3476.02 3476.31,-3459.63"/>
<polygon fill="black" stroke="black" points="3478.32,-3462.49 3484.81,-3454.12 3474.52,-3456.62 3478.32,-3462.49"/>
</g>
<!-- layer5_ffn_act_2&#45;&gt;layer5_ffn_down_2 -->
<g id="edge472" class="edge">
<title>layer5_ffn_act_2&#45;&gt;layer5_ffn_down_2</title>
<path fill="none" stroke="black" d="M3498.5,-3233.74C3498.5,-3212.18 3498.5,-3174.37 3498.5,-3143.29"/>
<polygon fill="black" stroke="black" points="3502,-3143.04 3498.5,-3133.04 3495,-3143.04 3502,-3143.04"/>
</g>
<!-- layer6_mha_qkv_2 -->
<g id="node484" class="node">
<title>layer6_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3776.5,-2812 3220.5,-2812 3220.5,-2729 3776.5,-2729 3776.5,-2812"/>
<text text-anchor="middle" x="3498.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3498.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3498.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3498.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3498.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer5_res2_2&#45;&gt;layer6_mha_qkv_2 -->
<g id="edge551" class="edge">
<title>layer5_res2_2&#45;&gt;layer6_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3498.5,-2912.74C3498.5,-2891.18 3498.5,-2853.37 3498.5,-2822.29"/>
<polygon fill="black" stroke="black" points="3502,-2822.04 3498.5,-2812.04 3495,-2822.04 3502,-2822.04"/>
</g>
<!-- layer5_mha_attn_3&#45;&gt;layer5_mha_out_3 -->
<g id="edge476" class="edge">
<title>layer5_mha_attn_3&#45;&gt;layer5_mha_out_3</title>
<path fill="none" stroke="black" d="M4678.5,-3979.74C4678.5,-3958.18 4678.5,-3920.37 4678.5,-3889.29"/>
<polygon fill="black" stroke="black" points="4682,-3889.04 4678.5,-3879.04 4675,-3889.04 4682,-3889.04"/>
</g>
<!-- layer5_ln1_3 -->
<g id="node464" class="node">
<title>layer5_ln1_3</title>
<polygon fill="none" stroke="black" points="4732,-3542 4625,-3542 4625,-3506 4732,-3506 4732,-3542"/>
<text text-anchor="middle" x="4678.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_3</text>
</g>
<!-- layer5_res1_3&#45;&gt;layer5_ln1_3 -->
<g id="edge478" class="edge">
<title>layer5_res1_3&#45;&gt;layer5_ln1_3</title>
<path fill="none" stroke="black" d="M4678.5,-3658.97C4678.5,-3633.03 4678.5,-3583.36 4678.5,-3552.33"/>
<polygon fill="black" stroke="black" points="4682,-3552.2 4678.5,-3542.2 4675,-3552.2 4682,-3552.2"/>
</g>
<!-- layer5_ln1_3&#45;&gt;layer5_ffn_gate_3 -->
<g id="edge479" class="edge">
<title>layer5_ln1_3&#45;&gt;layer5_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4660.69,-3505.89C4648.2,-3493.89 4630.84,-3477.22 4614.31,-3461.34"/>
<polygon fill="black" stroke="black" points="4616.42,-3458.52 4606.79,-3454.12 4611.57,-3463.57 4616.42,-3458.52"/>
</g>
<!-- layer5_ln1_3&#45;&gt;layer5_ffn_up_3 -->
<g id="edge480" class="edge">
<title>layer5_ln1_3&#45;&gt;layer5_ffn_up_3</title>
<path fill="none" stroke="black" d="M4732.11,-3507.43C4777.46,-3494.26 4844.68,-3474.73 4906.1,-3456.89"/>
<polygon fill="black" stroke="black" points="4907.28,-3460.2 4915.9,-3454.05 4905.33,-3453.47 4907.28,-3460.2"/>
</g>
<!-- layer5_ffn_act_3&#45;&gt;layer5_ffn_down_3 -->
<g id="edge483" class="edge">
<title>layer5_ffn_act_3&#45;&gt;layer5_ffn_down_3</title>
<path fill="none" stroke="black" d="M4585.5,-3233.74C4585.5,-3212.18 4585.5,-3174.37 4585.5,-3143.29"/>
<polygon fill="black" stroke="black" points="4589,-3143.04 4585.5,-3133.04 4582,-3143.04 4589,-3143.04"/>
</g>
<!-- layer6_mha_qkv_3 -->
<g id="node485" class="node">
<title>layer6_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4863.5,-2812 4307.5,-2812 4307.5,-2729 4863.5,-2729 4863.5,-2812"/>
<text text-anchor="middle" x="4585.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4585.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4585.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4585.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer5_res2_3&#45;&gt;layer6_mha_qkv_3 -->
<g id="edge562" class="edge">
<title>layer5_res2_3&#45;&gt;layer6_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4585.5,-2912.74C4585.5,-2891.18 4585.5,-2853.37 4585.5,-2822.29"/>
<polygon fill="black" stroke="black" points="4589,-2822.04 4585.5,-2812.04 4582,-2822.04 4589,-2822.04"/>
</g>
<!-- layer5_mha_attn_4&#45;&gt;layer5_mha_out_4 -->
<g id="edge487" class="edge">
<title>layer5_mha_attn_4&#45;&gt;layer5_mha_out_4</title>
<path fill="none" stroke="black" d="M5704.5,-3979.74C5704.5,-3958.18 5704.5,-3920.37 5704.5,-3889.29"/>
<polygon fill="black" stroke="black" points="5708,-3889.04 5704.5,-3879.04 5701,-3889.04 5708,-3889.04"/>
</g>
<!-- layer5_ln1_4 -->
<g id="node469" class="node">
<title>layer5_ln1_4</title>
<polygon fill="none" stroke="black" points="5758,-3542 5651,-3542 5651,-3506 5758,-3506 5758,-3542"/>
<text text-anchor="middle" x="5704.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_4</text>
</g>
<!-- layer5_res1_4&#45;&gt;layer5_ln1_4 -->
<g id="edge489" class="edge">
<title>layer5_res1_4&#45;&gt;layer5_ln1_4</title>
<path fill="none" stroke="black" d="M5704.5,-3658.97C5704.5,-3633.03 5704.5,-3583.36 5704.5,-3552.33"/>
<polygon fill="black" stroke="black" points="5708,-3552.2 5704.5,-3542.2 5701,-3552.2 5708,-3552.2"/>
</g>
<!-- layer5_ln1_4&#45;&gt;layer5_ffn_gate_4 -->
<g id="edge490" class="edge">
<title>layer5_ln1_4&#45;&gt;layer5_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5681.53,-3505.89C5665.06,-3493.62 5642.03,-3476.47 5620.29,-3460.27"/>
<polygon fill="black" stroke="black" points="5622.14,-3457.29 5612.03,-3454.12 5617.96,-3462.9 5622.14,-3457.29"/>
</g>
<!-- layer5_ln1_4&#45;&gt;layer5_ffn_up_4 -->
<g id="edge491" class="edge">
<title>layer5_ln1_4&#45;&gt;layer5_ffn_up_4</title>
<path fill="none" stroke="black" d="M5758.25,-3505.89C5799.34,-3492.81 5857.88,-3474.18 5911.64,-3457.07"/>
<polygon fill="black" stroke="black" points="5912.8,-3460.37 5921.26,-3454 5910.67,-3453.7 5912.8,-3460.37"/>
</g>
<!-- layer5_ffn_act_4&#45;&gt;layer5_ffn_down_4 -->
<g id="edge494" class="edge">
<title>layer5_ffn_act_4&#45;&gt;layer5_ffn_down_4</title>
<path fill="none" stroke="black" d="M6007.5,-3233.74C6007.5,-3212.18 6007.5,-3174.37 6007.5,-3143.29"/>
<polygon fill="black" stroke="black" points="6011,-3143.04 6007.5,-3133.04 6004,-3143.04 6011,-3143.04"/>
</g>
<!-- layer6_mha_qkv_4 -->
<g id="node486" class="node">
<title>layer6_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="6285.5,-2812 5729.5,-2812 5729.5,-2729 6285.5,-2729 6285.5,-2812"/>
<text text-anchor="middle" x="6007.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6007.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6007.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6007.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6007.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer5_res2_4&#45;&gt;layer6_mha_qkv_4 -->
<g id="edge573" class="edge">
<title>layer5_res2_4&#45;&gt;layer6_mha_qkv_4</title>
<path fill="none" stroke="black" d="M6007.5,-2912.74C6007.5,-2891.18 6007.5,-2853.37 6007.5,-2822.29"/>
<polygon fill="black" stroke="black" points="6011,-2822.04 6007.5,-2812.04 6004,-2822.04 6011,-2822.04"/>
</g>
<!-- layer5_mha_attn_5&#45;&gt;layer5_mha_out_5 -->
<g id="edge498" class="edge">
<title>layer5_mha_attn_5&#45;&gt;layer5_mha_out_5</title>
<path fill="none" stroke="black" d="M6789.5,-3979.74C6789.5,-3958.18 6789.5,-3920.37 6789.5,-3889.29"/>
<polygon fill="black" stroke="black" points="6793,-3889.04 6789.5,-3879.04 6786,-3889.04 6793,-3889.04"/>
</g>
<!-- layer5_ln1_5 -->
<g id="node474" class="node">
<title>layer5_ln1_5</title>
<polygon fill="none" stroke="black" points="6843,-3542 6736,-3542 6736,-3506 6843,-3506 6843,-3542"/>
<text text-anchor="middle" x="6789.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_5</text>
</g>
<!-- layer5_res1_5&#45;&gt;layer5_ln1_5 -->
<g id="edge500" class="edge">
<title>layer5_res1_5&#45;&gt;layer5_ln1_5</title>
<path fill="none" stroke="black" d="M6789.5,-3658.97C6789.5,-3633.03 6789.5,-3583.36 6789.5,-3552.33"/>
<polygon fill="black" stroke="black" points="6793,-3552.2 6789.5,-3542.2 6786,-3552.2 6793,-3552.2"/>
</g>
<!-- layer5_ln1_5&#45;&gt;layer5_ffn_gate_5 -->
<g id="edge501" class="edge">
<title>layer5_ln1_5&#45;&gt;layer5_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6756.53,-3505.89C6732.16,-3493.24 6697.79,-3475.41 6665.74,-3458.77"/>
<polygon fill="black" stroke="black" points="6667.26,-3455.62 6656.77,-3454.12 6664.03,-3461.83 6667.26,-3455.62"/>
</g>
<!-- layer5_ln1_5&#45;&gt;layer5_ffn_up_5 -->
<g id="edge502" class="edge">
<title>layer5_ln1_5&#45;&gt;layer5_ffn_up_5</title>
<path fill="none" stroke="black" d="M6833.25,-3505.89C6866.28,-3492.97 6913.16,-3474.64 6956.47,-3457.7"/>
<polygon fill="black" stroke="black" points="6957.9,-3460.9 6965.93,-3454 6955.35,-3454.38 6957.9,-3460.9"/>
</g>
<!-- layer5_ffn_act_5&#45;&gt;layer5_ffn_down_5 -->
<g id="edge505" class="edge">
<title>layer5_ffn_act_5&#45;&gt;layer5_ffn_down_5</title>
<path fill="none" stroke="black" d="M6623.5,-3233.74C6623.5,-3212.18 6623.5,-3174.37 6623.5,-3143.29"/>
<polygon fill="black" stroke="black" points="6627,-3143.04 6623.5,-3133.04 6620,-3143.04 6627,-3143.04"/>
</g>
<!-- layer6_mha_qkv_5 -->
<g id="node487" class="node">
<title>layer6_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="6901.5,-2812 6345.5,-2812 6345.5,-2729 6901.5,-2729 6901.5,-2812"/>
<text text-anchor="middle" x="6623.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6623.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6623.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6623.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6623.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer5_res2_5&#45;&gt;layer6_mha_qkv_5 -->
<g id="edge584" class="edge">
<title>layer5_res2_5&#45;&gt;layer6_mha_qkv_5</title>
<path fill="none" stroke="black" d="M6623.5,-2912.74C6623.5,-2891.18 6623.5,-2853.37 6623.5,-2822.29"/>
<polygon fill="black" stroke="black" points="6627,-2822.04 6623.5,-2812.04 6620,-2822.04 6627,-2822.04"/>
</g>
<!-- layer5_mha_attn_6&#45;&gt;layer5_mha_out_6 -->
<g id="edge509" class="edge">
<title>layer5_mha_attn_6&#45;&gt;layer5_mha_out_6</title>
<path fill="none" stroke="black" d="M8081.5,-3979.74C8081.5,-3958.18 8081.5,-3920.37 8081.5,-3889.29"/>
<polygon fill="black" stroke="black" points="8085,-3889.04 8081.5,-3879.04 8078,-3889.04 8085,-3889.04"/>
</g>
<!-- layer5_ln1_6 -->
<g id="node479" class="node">
<title>layer5_ln1_6</title>
<polygon fill="none" stroke="black" points="8135,-3542 8028,-3542 8028,-3506 8135,-3506 8135,-3542"/>
<text text-anchor="middle" x="8081.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer5_ln1_6</text>
</g>
<!-- layer5_res1_6&#45;&gt;layer5_ln1_6 -->
<g id="edge511" class="edge">
<title>layer5_res1_6&#45;&gt;layer5_ln1_6</title>
<path fill="none" stroke="black" d="M8081.5,-3658.97C8081.5,-3633.03 8081.5,-3583.36 8081.5,-3552.33"/>
<polygon fill="black" stroke="black" points="8085,-3552.2 8081.5,-3542.2 8078,-3552.2 8085,-3552.2"/>
</g>
<!-- layer5_ln1_6&#45;&gt;layer5_ffn_gate_6 -->
<g id="edge512" class="edge">
<title>layer5_ln1_6&#45;&gt;layer5_ffn_gate_6</title>
<path fill="none" stroke="black" d="M8027.72,-3510.76C7969.83,-3497.58 7874.46,-3475.87 7788.49,-3456.3"/>
<polygon fill="black" stroke="black" points="7789.13,-3452.85 7778.6,-3454.04 7787.57,-3459.68 7789.13,-3452.85"/>
</g>
<!-- layer5_ln1_6&#45;&gt;layer5_ffn_up_6 -->
<g id="edge513" class="edge">
<title>layer5_ln1_6&#45;&gt;layer5_ffn_up_6</title>
<path fill="none" stroke="black" d="M8083.06,-3505.89C8084.09,-3494.65 8085.49,-3479.31 8086.86,-3464.35"/>
<polygon fill="black" stroke="black" points="8090.37,-3464.4 8087.79,-3454.12 8083.4,-3463.76 8090.37,-3464.4"/>
</g>
<!-- layer5_ffn_act_6&#45;&gt;layer5_ffn_down_6 -->
<g id="edge516" class="edge">
<title>layer5_ffn_act_6&#45;&gt;layer5_ffn_down_6</title>
<path fill="none" stroke="black" d="M7854.5,-3233.74C7854.5,-3212.18 7854.5,-3174.37 7854.5,-3143.29"/>
<polygon fill="black" stroke="black" points="7858,-3143.04 7854.5,-3133.04 7851,-3143.04 7858,-3143.04"/>
</g>
<!-- layer6_mha_qkv_6 -->
<g id="node488" class="node">
<title>layer6_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="8132.5,-2812 7576.5,-2812 7576.5,-2729 8132.5,-2729 8132.5,-2812"/>
<text text-anchor="middle" x="7854.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7854.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7854.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7854.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7854.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer5_res2_6&#45;&gt;layer6_mha_qkv_6 -->
<g id="edge595" class="edge">
<title>layer5_res2_6&#45;&gt;layer6_mha_qkv_6</title>
<path fill="none" stroke="black" d="M7854.5,-2912.74C7854.5,-2891.18 7854.5,-2853.37 7854.5,-2822.29"/>
<polygon fill="black" stroke="black" points="7858,-2822.04 7854.5,-2812.04 7851,-2822.04 7858,-2822.04"/>
</g>
<!-- layer6_mha_attn_0 -->
<g id="node527" class="node">
<title>layer6_mha_attn_0</title>
<polygon fill="none" stroke="black" points="907,-2628 756,-2628 756,-2592 907,-2592 907,-2628"/>
<text text-anchor="middle" x="831.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_0</text>
</g>
<!-- layer6_mha_qkv_0&#45;&gt;layer6_mha_attn_0 -->
<g id="edge530" class="edge">
<title>layer6_mha_qkv_0&#45;&gt;layer6_mha_attn_0</title>
<path fill="none" stroke="black" d="M831.5,-2728.68C831.5,-2700.24 831.5,-2663.08 831.5,-2638.2"/>
<polygon fill="black" stroke="black" points="835,-2638.02 831.5,-2628.02 828,-2638.02 835,-2638.02"/>
</g>
<!-- layer6_mha_attn_1 -->
<g id="node532" class="node">
<title>layer6_mha_attn_1</title>
<polygon fill="none" stroke="black" points="1967,-2628 1816,-2628 1816,-2592 1967,-2592 1967,-2628"/>
<text text-anchor="middle" x="1891.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_1</text>
</g>
<!-- layer6_mha_qkv_1&#45;&gt;layer6_mha_attn_1 -->
<g id="edge541" class="edge">
<title>layer6_mha_qkv_1&#45;&gt;layer6_mha_attn_1</title>
<path fill="none" stroke="black" d="M1891.5,-2728.68C1891.5,-2700.24 1891.5,-2663.08 1891.5,-2638.2"/>
<polygon fill="black" stroke="black" points="1895,-2638.02 1891.5,-2628.02 1888,-2638.02 1895,-2638.02"/>
</g>
<!-- layer6_mha_attn_2 -->
<g id="node537" class="node">
<title>layer6_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3574,-2628 3423,-2628 3423,-2592 3574,-2592 3574,-2628"/>
<text text-anchor="middle" x="3498.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_2</text>
</g>
<!-- layer6_mha_qkv_2&#45;&gt;layer6_mha_attn_2 -->
<g id="edge552" class="edge">
<title>layer6_mha_qkv_2&#45;&gt;layer6_mha_attn_2</title>
<path fill="none" stroke="black" d="M3498.5,-2728.68C3498.5,-2700.24 3498.5,-2663.08 3498.5,-2638.2"/>
<polygon fill="black" stroke="black" points="3502,-2638.02 3498.5,-2628.02 3495,-2638.02 3502,-2638.02"/>
</g>
<!-- layer6_mha_attn_3 -->
<g id="node542" class="node">
<title>layer6_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4661,-2628 4510,-2628 4510,-2592 4661,-2592 4661,-2628"/>
<text text-anchor="middle" x="4585.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_3</text>
</g>
<!-- layer6_mha_qkv_3&#45;&gt;layer6_mha_attn_3 -->
<g id="edge563" class="edge">
<title>layer6_mha_qkv_3&#45;&gt;layer6_mha_attn_3</title>
<path fill="none" stroke="black" d="M4585.5,-2728.68C4585.5,-2700.24 4585.5,-2663.08 4585.5,-2638.2"/>
<polygon fill="black" stroke="black" points="4589,-2638.02 4585.5,-2628.02 4582,-2638.02 4589,-2638.02"/>
</g>
<!-- layer6_mha_attn_4 -->
<g id="node547" class="node">
<title>layer6_mha_attn_4</title>
<polygon fill="none" stroke="black" points="6083,-2628 5932,-2628 5932,-2592 6083,-2592 6083,-2628"/>
<text text-anchor="middle" x="6007.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_4</text>
</g>
<!-- layer6_mha_qkv_4&#45;&gt;layer6_mha_attn_4 -->
<g id="edge574" class="edge">
<title>layer6_mha_qkv_4&#45;&gt;layer6_mha_attn_4</title>
<path fill="none" stroke="black" d="M6007.5,-2728.68C6007.5,-2700.24 6007.5,-2663.08 6007.5,-2638.2"/>
<polygon fill="black" stroke="black" points="6011,-2638.02 6007.5,-2628.02 6004,-2638.02 6011,-2638.02"/>
</g>
<!-- layer6_mha_attn_5 -->
<g id="node552" class="node">
<title>layer6_mha_attn_5</title>
<polygon fill="none" stroke="black" points="6699,-2628 6548,-2628 6548,-2592 6699,-2592 6699,-2628"/>
<text text-anchor="middle" x="6623.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_5</text>
</g>
<!-- layer6_mha_qkv_5&#45;&gt;layer6_mha_attn_5 -->
<g id="edge585" class="edge">
<title>layer6_mha_qkv_5&#45;&gt;layer6_mha_attn_5</title>
<path fill="none" stroke="black" d="M6623.5,-2728.68C6623.5,-2700.24 6623.5,-2663.08 6623.5,-2638.2"/>
<polygon fill="black" stroke="black" points="6627,-2638.02 6623.5,-2628.02 6620,-2638.02 6627,-2638.02"/>
</g>
<!-- layer6_mha_attn_6 -->
<g id="node557" class="node">
<title>layer6_mha_attn_6</title>
<polygon fill="none" stroke="black" points="7930,-2628 7779,-2628 7779,-2592 7930,-2592 7930,-2628"/>
<text text-anchor="middle" x="7854.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer6_mha_attn_6</text>
</g>
<!-- layer6_mha_qkv_6&#45;&gt;layer6_mha_attn_6 -->
<g id="edge596" class="edge">
<title>layer6_mha_qkv_6&#45;&gt;layer6_mha_attn_6</title>
<path fill="none" stroke="black" d="M7854.5,-2728.68C7854.5,-2700.24 7854.5,-2663.08 7854.5,-2638.2"/>
<polygon fill="black" stroke="black" points="7858,-2638.02 7854.5,-2628.02 7851,-2638.02 7858,-2638.02"/>
</g>
<!-- layer6_mha_attn_7 -->
<g id="node490" class="node">
<title>layer6_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9133.31,-2693 8374.81,-2693 8179.69,-2527 8938.19,-2527 9133.31,-2693"/>
<text text-anchor="middle" x="8656.5" y="-2636.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="8656.5" y="-2621.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="8656.5" y="-2606.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8656.5" y="-2591.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2576.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_mha_qkv_7&#45;&gt;layer6_mha_attn_7 -->
<g id="edge607" class="edge">
<title>layer6_mha_qkv_7&#45;&gt;layer6_mha_attn_7</title>
<path fill="none" stroke="black" d="M8656.5,-2728.68C8656.5,-2720.75 8656.5,-2712.14 8656.5,-2703.31"/>
<polygon fill="black" stroke="black" points="8660,-2703.27 8656.5,-2693.27 8653,-2703.27 8660,-2703.27"/>
</g>
<!-- layer6_mha_out_7 -->
<g id="node498" class="node">
<title>layer6_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="8875.5,-2491 8437.5,-2491 8437.5,-2408 8875.5,-2408 8875.5,-2491"/>
<text text-anchor="middle" x="8656.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8656.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8656.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8656.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_mha_attn_7&#45;&gt;layer6_mha_out_7 -->
<g id="edge608" class="edge">
<title>layer6_mha_attn_7&#45;&gt;layer6_mha_out_7</title>
<path fill="none" stroke="black" d="M8656.5,-2526.96C8656.5,-2518.25 8656.5,-2509.59 8656.5,-2501.39"/>
<polygon fill="black" stroke="black" points="8660,-2501.29 8656.5,-2491.29 8653,-2501.29 8660,-2501.29"/>
</g>
<!-- layer6_mha_out_0 -->
<g id="node491" class="node">
<title>layer6_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="1050.5,-2491 612.5,-2491 612.5,-2408 1050.5,-2408 1050.5,-2491"/>
<text text-anchor="middle" x="831.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="831.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="831.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="831.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="831.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_res1_0 -->
<g id="node528" class="node">
<title>layer6_res1_0</title>
<polygon fill="none" stroke="black" points="889.5,-2307 773.5,-2307 773.5,-2271 889.5,-2271 889.5,-2307"/>
<text text-anchor="middle" x="831.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_0</text>
</g>
<!-- layer6_mha_out_0&#45;&gt;layer6_res1_0 -->
<g id="edge532" class="edge">
<title>layer6_mha_out_0&#45;&gt;layer6_res1_0</title>
<path fill="none" stroke="black" d="M831.5,-2407.68C831.5,-2379.24 831.5,-2342.08 831.5,-2317.2"/>
<polygon fill="black" stroke="black" points="835,-2317.02 831.5,-2307.02 828,-2317.02 835,-2317.02"/>
</g>
<!-- layer6_mha_out_1 -->
<g id="node492" class="node">
<title>layer6_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="2110.5,-2491 1672.5,-2491 1672.5,-2408 2110.5,-2408 2110.5,-2491"/>
<text text-anchor="middle" x="1891.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="1891.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1891.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1891.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1891.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_res1_1 -->
<g id="node533" class="node">
<title>layer6_res1_1</title>
<polygon fill="none" stroke="black" points="1949.5,-2307 1833.5,-2307 1833.5,-2271 1949.5,-2271 1949.5,-2307"/>
<text text-anchor="middle" x="1891.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_1</text>
</g>
<!-- layer6_mha_out_1&#45;&gt;layer6_res1_1 -->
<g id="edge543" class="edge">
<title>layer6_mha_out_1&#45;&gt;layer6_res1_1</title>
<path fill="none" stroke="black" d="M1891.5,-2407.68C1891.5,-2379.24 1891.5,-2342.08 1891.5,-2317.2"/>
<polygon fill="black" stroke="black" points="1895,-2317.02 1891.5,-2307.02 1888,-2317.02 1895,-2317.02"/>
</g>
<!-- layer6_mha_out_2 -->
<g id="node493" class="node">
<title>layer6_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3717.5,-2491 3279.5,-2491 3279.5,-2408 3717.5,-2408 3717.5,-2491"/>
<text text-anchor="middle" x="3498.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3498.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3498.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3498.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3498.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_res1_2 -->
<g id="node538" class="node">
<title>layer6_res1_2</title>
<polygon fill="none" stroke="black" points="3556.5,-2307 3440.5,-2307 3440.5,-2271 3556.5,-2271 3556.5,-2307"/>
<text text-anchor="middle" x="3498.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_2</text>
</g>
<!-- layer6_mha_out_2&#45;&gt;layer6_res1_2 -->
<g id="edge554" class="edge">
<title>layer6_mha_out_2&#45;&gt;layer6_res1_2</title>
<path fill="none" stroke="black" d="M3498.5,-2407.68C3498.5,-2379.24 3498.5,-2342.08 3498.5,-2317.2"/>
<polygon fill="black" stroke="black" points="3502,-2317.02 3498.5,-2307.02 3495,-2317.02 3502,-2317.02"/>
</g>
<!-- layer6_mha_out_3 -->
<g id="node494" class="node">
<title>layer6_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4804.5,-2491 4366.5,-2491 4366.5,-2408 4804.5,-2408 4804.5,-2491"/>
<text text-anchor="middle" x="4585.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4585.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4585.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4585.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_res1_3 -->
<g id="node543" class="node">
<title>layer6_res1_3</title>
<polygon fill="none" stroke="black" points="4643.5,-2307 4527.5,-2307 4527.5,-2271 4643.5,-2271 4643.5,-2307"/>
<text text-anchor="middle" x="4585.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_3</text>
</g>
<!-- layer6_mha_out_3&#45;&gt;layer6_res1_3 -->
<g id="edge565" class="edge">
<title>layer6_mha_out_3&#45;&gt;layer6_res1_3</title>
<path fill="none" stroke="black" d="M4585.5,-2407.68C4585.5,-2379.24 4585.5,-2342.08 4585.5,-2317.2"/>
<polygon fill="black" stroke="black" points="4589,-2317.02 4585.5,-2307.02 4582,-2317.02 4589,-2317.02"/>
</g>
<!-- layer6_mha_out_4 -->
<g id="node495" class="node">
<title>layer6_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="6226.5,-2491 5788.5,-2491 5788.5,-2408 6226.5,-2408 6226.5,-2491"/>
<text text-anchor="middle" x="6007.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6007.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6007.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6007.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6007.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_res1_4 -->
<g id="node548" class="node">
<title>layer6_res1_4</title>
<polygon fill="none" stroke="black" points="6065.5,-2307 5949.5,-2307 5949.5,-2271 6065.5,-2271 6065.5,-2307"/>
<text text-anchor="middle" x="6007.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_4</text>
</g>
<!-- layer6_mha_out_4&#45;&gt;layer6_res1_4 -->
<g id="edge576" class="edge">
<title>layer6_mha_out_4&#45;&gt;layer6_res1_4</title>
<path fill="none" stroke="black" d="M6007.5,-2407.68C6007.5,-2379.24 6007.5,-2342.08 6007.5,-2317.2"/>
<polygon fill="black" stroke="black" points="6011,-2317.02 6007.5,-2307.02 6004,-2317.02 6011,-2317.02"/>
</g>
<!-- layer6_mha_out_5 -->
<g id="node496" class="node">
<title>layer6_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="6842.5,-2491 6404.5,-2491 6404.5,-2408 6842.5,-2408 6842.5,-2491"/>
<text text-anchor="middle" x="6623.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6623.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6623.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6623.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6623.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_res1_5 -->
<g id="node553" class="node">
<title>layer6_res1_5</title>
<polygon fill="none" stroke="black" points="6681.5,-2307 6565.5,-2307 6565.5,-2271 6681.5,-2271 6681.5,-2307"/>
<text text-anchor="middle" x="6623.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_5</text>
</g>
<!-- layer6_mha_out_5&#45;&gt;layer6_res1_5 -->
<g id="edge587" class="edge">
<title>layer6_mha_out_5&#45;&gt;layer6_res1_5</title>
<path fill="none" stroke="black" d="M6623.5,-2407.68C6623.5,-2379.24 6623.5,-2342.08 6623.5,-2317.2"/>
<polygon fill="black" stroke="black" points="6627,-2317.02 6623.5,-2307.02 6620,-2317.02 6627,-2317.02"/>
</g>
<!-- layer6_mha_out_6 -->
<g id="node497" class="node">
<title>layer6_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="8073.5,-2491 7635.5,-2491 7635.5,-2408 8073.5,-2408 8073.5,-2491"/>
<text text-anchor="middle" x="7854.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7854.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7854.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7854.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7854.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_res1_6 -->
<g id="node558" class="node">
<title>layer6_res1_6</title>
<polygon fill="none" stroke="black" points="7912.5,-2307 7796.5,-2307 7796.5,-2271 7912.5,-2271 7912.5,-2307"/>
<text text-anchor="middle" x="7854.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer6_res1_6</text>
</g>
<!-- layer6_mha_out_6&#45;&gt;layer6_res1_6 -->
<g id="edge598" class="edge">
<title>layer6_mha_out_6&#45;&gt;layer6_res1_6</title>
<path fill="none" stroke="black" d="M7854.5,-2407.68C7854.5,-2379.24 7854.5,-2342.08 7854.5,-2317.2"/>
<polygon fill="black" stroke="black" points="7858,-2317.02 7854.5,-2307.02 7851,-2317.02 7858,-2317.02"/>
</g>
<!-- layer6_res1_7 -->
<g id="node499" class="node">
<title>layer6_res1_7</title>
<polygon fill="none" stroke="black" points="9097.24,-2372 8396.12,-2372 8215.76,-2206 8916.88,-2206 9097.24,-2372"/>
<text text-anchor="middle" x="8656.5" y="-2315.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8656.5" y="-2300.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2285.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2270.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2255.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_mha_out_7&#45;&gt;layer6_res1_7 -->
<g id="edge609" class="edge">
<title>layer6_mha_out_7&#45;&gt;layer6_res1_7</title>
<path fill="none" stroke="black" d="M8656.5,-2407.68C8656.5,-2399.75 8656.5,-2391.14 8656.5,-2382.31"/>
<polygon fill="black" stroke="black" points="8660,-2382.27 8656.5,-2372.27 8653,-2382.27 8660,-2382.27"/>
</g>
<!-- layer6_ln1_7 -->
<g id="node500" class="node">
<title>layer6_ln1_7</title>
<polygon fill="yellow" stroke="black" points="8869,-2170 8444,-2170 8444,-2102 8869,-2102 8869,-2170"/>
<text text-anchor="middle" x="8656.5" y="-2154.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="8656.5" y="-2139.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2124.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8656.5" y="-2109.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_res1_7&#45;&gt;layer6_ln1_7 -->
<g id="edge610" class="edge">
<title>layer6_res1_7&#45;&gt;layer6_ln1_7</title>
<path fill="none" stroke="black" d="M8656.5,-2205.87C8656.5,-2197.12 8656.5,-2188.48 8656.5,-2180.45"/>
<polygon fill="black" stroke="black" points="8660,-2180.26 8656.5,-2170.26 8653,-2180.26 8660,-2180.26"/>
</g>
<!-- layer6_ffn_gate_7 -->
<g id="node508" class="node">
<title>layer6_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="8884,-2066 8411,-2066 8411,-1983 8884,-1983 8884,-2066"/>
<text text-anchor="middle" x="8647.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8647.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="8647.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8647.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8647.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_ln1_7&#45;&gt;layer6_ffn_gate_7 -->
<g id="edge611" class="edge">
<title>layer6_ln1_7&#45;&gt;layer6_ffn_gate_7</title>
<path fill="none" stroke="black" d="M8653.78,-2101.85C8653.11,-2093.8 8652.39,-2085 8651.68,-2076.34"/>
<polygon fill="black" stroke="black" points="8655.16,-2075.96 8650.85,-2066.28 8648.18,-2076.53 8655.16,-2075.96"/>
</g>
<!-- layer6_ffn_up_7 -->
<g id="node516" class="node">
<title>layer6_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9375,-2066 8902,-2066 8902,-1983 9375,-1983 9375,-2066"/>
<text text-anchor="middle" x="9138.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9138.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9138.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9138.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9138.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_ln1_7&#45;&gt;layer6_ffn_up_7 -->
<g id="edge612" class="edge">
<title>layer6_ln1_7&#45;&gt;layer6_ffn_up_7</title>
<path fill="none" stroke="black" d="M8801.77,-2102C8848.42,-2091.4 8900.77,-2079.51 8950.05,-2068.31"/>
<polygon fill="black" stroke="black" points="8950.89,-2071.71 8959.86,-2066.08 8949.34,-2064.88 8950.89,-2071.71"/>
</g>
<!-- layer6_ffn_gate_0 -->
<g id="node501" class="node">
<title>layer6_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="598,-2066 125,-2066 125,-1983 598,-1983 598,-2066"/>
<text text-anchor="middle" x="361.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="361.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="361.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="361.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="361.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_ffn_act_0 -->
<g id="node530" class="node">
<title>layer6_ffn_act_0</title>
<polygon fill="none" stroke="black" points="732,-1882 601,-1882 601,-1846 732,-1846 732,-1882"/>
<text text-anchor="middle" x="666.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_0</text>
</g>
<!-- layer6_ffn_gate_0&#45;&gt;layer6_ffn_act_0 -->
<g id="edge536" class="edge">
<title>layer6_ffn_gate_0&#45;&gt;layer6_ffn_act_0</title>
<path fill="none" stroke="black" d="M439.65,-1982.89C498.56,-1952.28 577.06,-1911.48 624.58,-1886.79"/>
<polygon fill="black" stroke="black" points="626.39,-1889.79 633.65,-1882.07 623.17,-1883.57 626.39,-1889.79"/>
</g>
<!-- layer6_ffn_gate_1 -->
<g id="node502" class="node">
<title>layer6_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="1637,-2066 1164,-2066 1164,-1983 1637,-1983 1637,-2066"/>
<text text-anchor="middle" x="1400.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1400.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1400.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1400.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1400.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_ffn_act_1 -->
<g id="node535" class="node">
<title>layer6_ffn_act_1</title>
<polygon fill="none" stroke="black" points="1834,-1882 1703,-1882 1703,-1846 1834,-1846 1834,-1882"/>
<text text-anchor="middle" x="1768.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_1</text>
</g>
<!-- layer6_ffn_gate_1&#45;&gt;layer6_ffn_act_1 -->
<g id="edge547" class="edge">
<title>layer6_ffn_gate_1&#45;&gt;layer6_ffn_act_1</title>
<path fill="none" stroke="black" d="M1494.79,-1982.89C1566.46,-1952.02 1662.16,-1910.8 1719.34,-1886.17"/>
<polygon fill="black" stroke="black" points="1721.07,-1889.24 1728.87,-1882.07 1718.3,-1882.81 1721.07,-1889.24"/>
</g>
<!-- layer6_ffn_gate_2 -->
<g id="node503" class="node">
<title>layer6_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3713,-2066 3240,-2066 3240,-1983 3713,-1983 3713,-2066"/>
<text text-anchor="middle" x="3476.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3476.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3476.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3476.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3476.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_ffn_act_2 -->
<g id="node540" class="node">
<title>layer6_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3697,-1882 3566,-1882 3566,-1846 3697,-1846 3697,-1882"/>
<text text-anchor="middle" x="3631.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_2</text>
</g>
<!-- layer6_ffn_gate_2&#45;&gt;layer6_ffn_act_2 -->
<g id="edge558" class="edge">
<title>layer6_ffn_gate_2&#45;&gt;layer6_ffn_act_2</title>
<path fill="none" stroke="black" d="M3516.42,-1982.68C3545.36,-1953.09 3583.52,-1914.06 3607.79,-1889.24"/>
<polygon fill="black" stroke="black" points="3610.36,-1891.62 3614.85,-1882.02 3605.36,-1886.73 3610.36,-1891.62"/>
</g>
<!-- layer6_ffn_gate_3 -->
<g id="node504" class="node">
<title>layer6_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4822,-2066 4349,-2066 4349,-1983 4822,-1983 4822,-2066"/>
<text text-anchor="middle" x="4585.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4585.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4585.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4585.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_ffn_act_3 -->
<g id="node545" class="node">
<title>layer6_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4651,-1882 4520,-1882 4520,-1846 4651,-1846 4651,-1882"/>
<text text-anchor="middle" x="4585.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_3</text>
</g>
<!-- layer6_ffn_gate_3&#45;&gt;layer6_ffn_act_3 -->
<g id="edge569" class="edge">
<title>layer6_ffn_gate_3&#45;&gt;layer6_ffn_act_3</title>
<path fill="none" stroke="black" d="M4585.5,-1982.68C4585.5,-1954.24 4585.5,-1917.08 4585.5,-1892.2"/>
<polygon fill="black" stroke="black" points="4589,-1892.02 4585.5,-1882.02 4582,-1892.02 4589,-1892.02"/>
</g>
<!-- layer6_ffn_gate_4 -->
<g id="node505" class="node">
<title>layer6_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="5841,-2066 5368,-2066 5368,-1983 5841,-1983 5841,-2066"/>
<text text-anchor="middle" x="5604.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5604.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5604.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5604.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5604.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_ffn_act_4 -->
<g id="node550" class="node">
<title>layer6_ffn_act_4</title>
<polygon fill="none" stroke="black" points="6161,-1882 6030,-1882 6030,-1846 6161,-1846 6161,-1882"/>
<text text-anchor="middle" x="6095.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_4</text>
</g>
<!-- layer6_ffn_gate_4&#45;&gt;layer6_ffn_act_4 -->
<g id="edge580" class="edge">
<title>layer6_ffn_gate_4&#45;&gt;layer6_ffn_act_4</title>
<path fill="none" stroke="black" d="M5729.99,-1982.99C5826.79,-1951.74 5956.61,-1909.83 6032.64,-1885.29"/>
<polygon fill="black" stroke="black" points="6034.11,-1888.5 6042.55,-1882.09 6031.96,-1881.83 6034.11,-1888.5"/>
</g>
<!-- layer6_ffn_gate_5 -->
<g id="node506" class="node">
<title>layer6_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="6842,-2066 6369,-2066 6369,-1983 6842,-1983 6842,-2066"/>
<text text-anchor="middle" x="6605.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6605.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6605.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6605.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6605.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_ffn_act_5 -->
<g id="node555" class="node">
<title>layer6_ffn_act_5</title>
<polygon fill="none" stroke="black" points="7096,-1882 6965,-1882 6965,-1846 7096,-1846 7096,-1882"/>
<text text-anchor="middle" x="7030.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_5</text>
</g>
<!-- layer6_ffn_gate_5&#45;&gt;layer6_ffn_act_5 -->
<g id="edge591" class="edge">
<title>layer6_ffn_gate_5&#45;&gt;layer6_ffn_act_5</title>
<path fill="none" stroke="black" d="M6714.12,-1982.99C6797.57,-1951.87 6909.37,-1910.18 6975.28,-1885.59"/>
<polygon fill="black" stroke="black" points="6976.52,-1888.87 6984.67,-1882.09 6974.08,-1882.31 6976.52,-1888.87"/>
</g>
<!-- layer6_ffn_gate_6 -->
<g id="node507" class="node">
<title>layer6_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="7887,-2066 7414,-2066 7414,-1983 7887,-1983 7887,-2066"/>
<text text-anchor="middle" x="7650.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7650.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="7650.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7650.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7650.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_ffn_act_6 -->
<g id="node560" class="node">
<title>layer6_ffn_act_6</title>
<polygon fill="none" stroke="black" points="8189,-1882 8058,-1882 8058,-1846 8189,-1846 8189,-1882"/>
<text text-anchor="middle" x="8123.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer6_ffn_act_6</text>
</g>
<!-- layer6_ffn_gate_6&#45;&gt;layer6_ffn_act_6 -->
<g id="edge602" class="edge">
<title>layer6_ffn_gate_6&#45;&gt;layer6_ffn_act_6</title>
<path fill="none" stroke="black" d="M7771.39,-1982.99C7864.64,-1951.74 7989.7,-1909.83 8062.95,-1885.29"/>
<polygon fill="black" stroke="black" points="8064.12,-1888.59 8072.49,-1882.09 8061.9,-1881.95 8064.12,-1888.59"/>
</g>
<!-- layer6_ffn_act_7 -->
<g id="node517" class="node">
<title>layer6_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9564.24,-1947 8807.44,-1947 8612.76,-1781 9369.56,-1781 9564.24,-1947"/>
<text text-anchor="middle" x="9088.5" y="-1890.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="9088.5" y="-1875.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="9088.5" y="-1860.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9088.5" y="-1845.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9088.5" y="-1830.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_ffn_gate_7&#45;&gt;layer6_ffn_act_7 -->
<g id="edge613" class="edge">
<title>layer6_ffn_gate_7&#45;&gt;layer6_ffn_act_7</title>
<path fill="none" stroke="black" d="M8760.21,-1982.99C8788.08,-1972.97 8818.99,-1961.86 8850.39,-1950.58"/>
<polygon fill="black" stroke="black" points="8851.92,-1953.75 8860.14,-1947.07 8849.55,-1947.16 8851.92,-1953.75"/>
</g>
<!-- layer6_ffn_up_0 -->
<g id="node509" class="node">
<title>layer6_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="1089,-2066 616,-2066 616,-1983 1089,-1983 1089,-2066"/>
<text text-anchor="middle" x="852.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="852.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="852.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="852.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="852.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_ffn_up_0&#45;&gt;layer6_ffn_act_0 -->
<g id="edge537" class="edge">
<title>layer6_ffn_up_0&#45;&gt;layer6_ffn_act_0</title>
<path fill="none" stroke="black" d="M804.6,-1982.68C769.57,-1952.83 723.29,-1913.39 694.2,-1888.61"/>
<polygon fill="black" stroke="black" points="696.36,-1885.85 686.48,-1882.02 691.82,-1891.17 696.36,-1885.85"/>
</g>
<!-- layer6_ffn_up_1 -->
<g id="node510" class="node">
<title>layer6_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2128,-2066 1655,-2066 1655,-1983 2128,-1983 2128,-2066"/>
<text text-anchor="middle" x="1891.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1891.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1891.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1891.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1891.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_ffn_up_1&#45;&gt;layer6_ffn_act_1 -->
<g id="edge548" class="edge">
<title>layer6_ffn_up_1&#45;&gt;layer6_ffn_act_1</title>
<path fill="none" stroke="black" d="M1859.82,-1982.68C1837.16,-1953.47 1807.36,-1915.07 1788.07,-1890.21"/>
<polygon fill="black" stroke="black" points="1790.61,-1887.78 1781.71,-1882.02 1785.08,-1892.07 1790.61,-1887.78"/>
</g>
<!-- layer6_ffn_up_2 -->
<g id="node511" class="node">
<title>layer6_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="4204,-2066 3731,-2066 3731,-1983 4204,-1983 4204,-2066"/>
<text text-anchor="middle" x="3967.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3967.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3967.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3967.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3967.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_ffn_up_2&#45;&gt;layer6_ffn_act_2 -->
<g id="edge559" class="edge">
<title>layer6_ffn_up_2&#45;&gt;layer6_ffn_act_2</title>
<path fill="none" stroke="black" d="M3881.41,-1982.89C3816.24,-1952.15 3729.31,-1911.14 3677.03,-1886.48"/>
<polygon fill="black" stroke="black" points="3678.22,-1883.17 3667.68,-1882.07 3675.24,-1889.5 3678.22,-1883.17"/>
</g>
<!-- layer6_ffn_up_3 -->
<g id="node512" class="node">
<title>layer6_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="5313,-2066 4840,-2066 4840,-1983 5313,-1983 5313,-2066"/>
<text text-anchor="middle" x="5076.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5076.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="5076.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5076.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5076.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_ffn_up_3&#45;&gt;layer6_ffn_act_3 -->
<g id="edge570" class="edge">
<title>layer6_ffn_up_3&#45;&gt;layer6_ffn_act_3</title>
<path fill="none" stroke="black" d="M4951.01,-1982.99C4854.21,-1951.74 4724.39,-1909.83 4648.36,-1885.29"/>
<polygon fill="black" stroke="black" points="4649.04,-1881.83 4638.45,-1882.09 4646.89,-1888.5 4649.04,-1881.83"/>
</g>
<!-- layer6_ffn_up_4 -->
<g id="node513" class="node">
<title>layer6_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="6332,-2066 5859,-2066 5859,-1983 6332,-1983 6332,-2066"/>
<text text-anchor="middle" x="6095.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6095.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6095.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6095.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6095.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_ffn_up_4&#45;&gt;layer6_ffn_act_4 -->
<g id="edge581" class="edge">
<title>layer6_ffn_up_4&#45;&gt;layer6_ffn_act_4</title>
<path fill="none" stroke="black" d="M6095.5,-1982.68C6095.5,-1954.24 6095.5,-1917.08 6095.5,-1892.2"/>
<polygon fill="black" stroke="black" points="6099,-1892.02 6095.5,-1882.02 6092,-1892.02 6099,-1892.02"/>
</g>
<!-- layer6_ffn_up_5 -->
<g id="node514" class="node">
<title>layer6_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="7333,-2066 6860,-2066 6860,-1983 7333,-1983 7333,-2066"/>
<text text-anchor="middle" x="7096.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7096.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7096.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7096.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7096.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_ffn_up_5&#45;&gt;layer6_ffn_act_5 -->
<g id="edge592" class="edge">
<title>layer6_ffn_up_5&#45;&gt;layer6_ffn_act_5</title>
<path fill="none" stroke="black" d="M7079.5,-1982.68C7067.55,-1953.98 7051.91,-1916.41 7041.55,-1891.53"/>
<polygon fill="black" stroke="black" points="7044.66,-1889.91 7037.59,-1882.02 7038.2,-1892.6 7044.66,-1889.91"/>
</g>
<!-- layer6_ffn_up_6 -->
<g id="node515" class="node">
<title>layer6_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8378,-2066 7905,-2066 7905,-1983 8378,-1983 8378,-2066"/>
<text text-anchor="middle" x="8141.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8141.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8141.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8141.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8141.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_ffn_up_6&#45;&gt;layer6_ffn_act_6 -->
<g id="edge603" class="edge">
<title>layer6_ffn_up_6&#45;&gt;layer6_ffn_act_6</title>
<path fill="none" stroke="black" d="M8136.86,-1982.68C8133.63,-1954.24 8129.41,-1917.08 8126.59,-1892.2"/>
<polygon fill="black" stroke="black" points="8130.04,-1891.56 8125.43,-1882.02 8123.08,-1892.35 8130.04,-1891.56"/>
</g>
<!-- layer6_ffn_up_7&#45;&gt;layer6_ffn_act_7 -->
<g id="edge614" class="edge">
<title>layer6_ffn_up_7&#45;&gt;layer6_ffn_act_7</title>
<path fill="none" stroke="black" d="M9125.62,-1982.68C9123.1,-1974.67 9120.35,-1965.96 9117.53,-1957.03"/>
<polygon fill="black" stroke="black" points="9120.8,-1955.76 9114.45,-1947.27 9114.12,-1957.86 9120.8,-1955.76"/>
</g>
<!-- layer6_ffn_down_7 -->
<g id="node525" class="node">
<title>layer6_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="9312,-1745 8865,-1745 8865,-1662 9312,-1662 9312,-1745"/>
<text text-anchor="middle" x="9088.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9088.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9088.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9088.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9088.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_ffn_act_7&#45;&gt;layer6_ffn_down_7 -->
<g id="edge615" class="edge">
<title>layer6_ffn_act_7&#45;&gt;layer6_ffn_down_7</title>
<path fill="none" stroke="black" d="M9088.5,-1780.96C9088.5,-1772.25 9088.5,-1763.59 9088.5,-1755.39"/>
<polygon fill="black" stroke="black" points="9092,-1755.29 9088.5,-1745.29 9085,-1755.29 9092,-1755.29"/>
</g>
<!-- layer6_ffn_down_0 -->
<g id="node518" class="node">
<title>layer6_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="890,-1745 443,-1745 443,-1662 890,-1662 890,-1745"/>
<text text-anchor="middle" x="666.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="666.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="666.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="666.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="666.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_res2_0 -->
<g id="node531" class="node">
<title>layer6_res2_0</title>
<polygon fill="none" stroke="black" points="724.5,-1561 608.5,-1561 608.5,-1525 724.5,-1525 724.5,-1561"/>
<text text-anchor="middle" x="666.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_0</text>
</g>
<!-- layer6_ffn_down_0&#45;&gt;layer6_res2_0 -->
<g id="edge539" class="edge">
<title>layer6_ffn_down_0&#45;&gt;layer6_res2_0</title>
<path fill="none" stroke="black" d="M666.5,-1661.68C666.5,-1633.24 666.5,-1596.08 666.5,-1571.2"/>
<polygon fill="black" stroke="black" points="670,-1571.02 666.5,-1561.02 663,-1571.02 670,-1571.02"/>
</g>
<!-- layer6_ffn_down_1 -->
<g id="node519" class="node">
<title>layer6_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="1992,-1745 1545,-1745 1545,-1662 1992,-1662 1992,-1745"/>
<text text-anchor="middle" x="1768.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1768.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1768.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1768.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1768.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_res2_1 -->
<g id="node536" class="node">
<title>layer6_res2_1</title>
<polygon fill="none" stroke="black" points="1826.5,-1561 1710.5,-1561 1710.5,-1525 1826.5,-1525 1826.5,-1561"/>
<text text-anchor="middle" x="1768.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_1</text>
</g>
<!-- layer6_ffn_down_1&#45;&gt;layer6_res2_1 -->
<g id="edge550" class="edge">
<title>layer6_ffn_down_1&#45;&gt;layer6_res2_1</title>
<path fill="none" stroke="black" d="M1768.5,-1661.68C1768.5,-1633.24 1768.5,-1596.08 1768.5,-1571.2"/>
<polygon fill="black" stroke="black" points="1772,-1571.02 1768.5,-1561.02 1765,-1571.02 1772,-1571.02"/>
</g>
<!-- layer6_ffn_down_2 -->
<g id="node520" class="node">
<title>layer6_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3855,-1745 3408,-1745 3408,-1662 3855,-1662 3855,-1745"/>
<text text-anchor="middle" x="3631.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3631.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3631.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3631.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3631.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_res2_2 -->
<g id="node541" class="node">
<title>layer6_res2_2</title>
<polygon fill="none" stroke="black" points="3689.5,-1561 3573.5,-1561 3573.5,-1525 3689.5,-1525 3689.5,-1561"/>
<text text-anchor="middle" x="3631.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_2</text>
</g>
<!-- layer6_ffn_down_2&#45;&gt;layer6_res2_2 -->
<g id="edge561" class="edge">
<title>layer6_ffn_down_2&#45;&gt;layer6_res2_2</title>
<path fill="none" stroke="black" d="M3631.5,-1661.68C3631.5,-1633.24 3631.5,-1596.08 3631.5,-1571.2"/>
<polygon fill="black" stroke="black" points="3635,-1571.02 3631.5,-1561.02 3628,-1571.02 3635,-1571.02"/>
</g>
<!-- layer6_ffn_down_3 -->
<g id="node521" class="node">
<title>layer6_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4809,-1745 4362,-1745 4362,-1662 4809,-1662 4809,-1745"/>
<text text-anchor="middle" x="4585.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4585.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4585.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4585.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_res2_3 -->
<g id="node546" class="node">
<title>layer6_res2_3</title>
<polygon fill="none" stroke="black" points="4643.5,-1561 4527.5,-1561 4527.5,-1525 4643.5,-1525 4643.5,-1561"/>
<text text-anchor="middle" x="4585.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_3</text>
</g>
<!-- layer6_ffn_down_3&#45;&gt;layer6_res2_3 -->
<g id="edge572" class="edge">
<title>layer6_ffn_down_3&#45;&gt;layer6_res2_3</title>
<path fill="none" stroke="black" d="M4585.5,-1661.68C4585.5,-1633.24 4585.5,-1596.08 4585.5,-1571.2"/>
<polygon fill="black" stroke="black" points="4589,-1571.02 4585.5,-1561.02 4582,-1571.02 4589,-1571.02"/>
</g>
<!-- layer6_ffn_down_4 -->
<g id="node522" class="node">
<title>layer6_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="6319,-1745 5872,-1745 5872,-1662 6319,-1662 6319,-1745"/>
<text text-anchor="middle" x="6095.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6095.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6095.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6095.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6095.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_res2_4 -->
<g id="node551" class="node">
<title>layer6_res2_4</title>
<polygon fill="none" stroke="black" points="6153.5,-1561 6037.5,-1561 6037.5,-1525 6153.5,-1525 6153.5,-1561"/>
<text text-anchor="middle" x="6095.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_4</text>
</g>
<!-- layer6_ffn_down_4&#45;&gt;layer6_res2_4 -->
<g id="edge583" class="edge">
<title>layer6_ffn_down_4&#45;&gt;layer6_res2_4</title>
<path fill="none" stroke="black" d="M6095.5,-1661.68C6095.5,-1633.24 6095.5,-1596.08 6095.5,-1571.2"/>
<polygon fill="black" stroke="black" points="6099,-1571.02 6095.5,-1561.02 6092,-1571.02 6099,-1571.02"/>
</g>
<!-- layer6_ffn_down_5 -->
<g id="node523" class="node">
<title>layer6_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="7254,-1745 6807,-1745 6807,-1662 7254,-1662 7254,-1745"/>
<text text-anchor="middle" x="7030.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7030.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7030.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7030.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7030.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_res2_5 -->
<g id="node556" class="node">
<title>layer6_res2_5</title>
<polygon fill="none" stroke="black" points="7088.5,-1561 6972.5,-1561 6972.5,-1525 7088.5,-1525 7088.5,-1561"/>
<text text-anchor="middle" x="7030.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_5</text>
</g>
<!-- layer6_ffn_down_5&#45;&gt;layer6_res2_5 -->
<g id="edge594" class="edge">
<title>layer6_ffn_down_5&#45;&gt;layer6_res2_5</title>
<path fill="none" stroke="black" d="M7030.5,-1661.68C7030.5,-1633.24 7030.5,-1596.08 7030.5,-1571.2"/>
<polygon fill="black" stroke="black" points="7034,-1571.02 7030.5,-1561.02 7027,-1571.02 7034,-1571.02"/>
</g>
<!-- layer6_ffn_down_6 -->
<g id="node524" class="node">
<title>layer6_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="8347,-1745 7900,-1745 7900,-1662 8347,-1662 8347,-1745"/>
<text text-anchor="middle" x="8123.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8123.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8123.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8123.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8123.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_res2_6 -->
<g id="node561" class="node">
<title>layer6_res2_6</title>
<polygon fill="none" stroke="black" points="8181.5,-1561 8065.5,-1561 8065.5,-1525 8181.5,-1525 8181.5,-1561"/>
<text text-anchor="middle" x="8123.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer6_res2_6</text>
</g>
<!-- layer6_ffn_down_6&#45;&gt;layer6_res2_6 -->
<g id="edge605" class="edge">
<title>layer6_ffn_down_6&#45;&gt;layer6_res2_6</title>
<path fill="none" stroke="black" d="M8123.5,-1661.68C8123.5,-1633.24 8123.5,-1596.08 8123.5,-1571.2"/>
<polygon fill="black" stroke="black" points="8127,-1571.02 8123.5,-1561.02 8120,-1571.02 8127,-1571.02"/>
</g>
<!-- layer6_res2_7 -->
<g id="node526" class="node">
<title>layer6_res2_7</title>
<polygon fill="none" stroke="black" points="9529.24,-1626 8828.12,-1626 8647.76,-1460 9348.88,-1460 9529.24,-1626"/>
<text text-anchor="middle" x="9088.5" y="-1569.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9088.5" y="-1554.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-1539.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-1524.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-1509.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer6_ffn_down_7&#45;&gt;layer6_res2_7 -->
<g id="edge616" class="edge">
<title>layer6_ffn_down_7&#45;&gt;layer6_res2_7</title>
<path fill="none" stroke="black" d="M9088.5,-1661.68C9088.5,-1653.75 9088.5,-1645.14 9088.5,-1636.31"/>
<polygon fill="black" stroke="black" points="9092,-1636.27 9088.5,-1626.27 9085,-1636.27 9092,-1636.27"/>
</g>
<!-- layer7_mha_qkv_7 -->
<g id="node569" class="node">
<title>layer7_mha_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="9366.5,-1424 8810.5,-1424 8810.5,-1341 9366.5,-1341 9366.5,-1424"/>
<text text-anchor="middle" x="9088.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9088.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9088.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9088.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer6_res2_7&#45;&gt;layer7_mha_qkv_7 -->
<g id="edge694" class="edge">
<title>layer6_res2_7&#45;&gt;layer7_mha_qkv_7</title>
<path fill="none" stroke="black" d="M9088.5,-1459.96C9088.5,-1451.25 9088.5,-1442.59 9088.5,-1434.39"/>
<polygon fill="black" stroke="black" points="9092,-1434.29 9088.5,-1424.29 9085,-1434.29 9092,-1434.29"/>
</g>
<!-- layer6_mha_attn_0&#45;&gt;layer6_mha_out_0 -->
<g id="edge531" class="edge">
<title>layer6_mha_attn_0&#45;&gt;layer6_mha_out_0</title>
<path fill="none" stroke="black" d="M831.5,-2591.74C831.5,-2570.18 831.5,-2532.37 831.5,-2501.29"/>
<polygon fill="black" stroke="black" points="835,-2501.04 831.5,-2491.04 828,-2501.04 835,-2501.04"/>
</g>
<!-- layer6_ln1_0 -->
<g id="node529" class="node">
<title>layer6_ln1_0</title>
<polygon fill="none" stroke="black" points="885,-2154 778,-2154 778,-2118 885,-2118 885,-2154"/>
<text text-anchor="middle" x="831.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_0</text>
</g>
<!-- layer6_res1_0&#45;&gt;layer6_ln1_0 -->
<g id="edge533" class="edge">
<title>layer6_res1_0&#45;&gt;layer6_ln1_0</title>
<path fill="none" stroke="black" d="M831.5,-2270.97C831.5,-2245.03 831.5,-2195.36 831.5,-2164.33"/>
<polygon fill="black" stroke="black" points="835,-2164.2 831.5,-2154.2 828,-2164.2 835,-2164.2"/>
</g>
<!-- layer6_ln1_0&#45;&gt;layer6_ffn_gate_0 -->
<g id="edge534" class="edge">
<title>layer6_ln1_0&#45;&gt;layer6_ffn_gate_0</title>
<path fill="none" stroke="black" d="M777.59,-2122.44C720.93,-2109.24 628.66,-2087.74 545.38,-2068.34"/>
<polygon fill="black" stroke="black" points="546.07,-2064.91 535.54,-2066.05 544.48,-2071.72 546.07,-2064.91"/>
</g>
<!-- layer6_ln1_0&#45;&gt;layer6_ffn_up_0 -->
<g id="edge535" class="edge">
<title>layer6_ln1_0&#45;&gt;layer6_ffn_up_0</title>
<path fill="none" stroke="black" d="M834.78,-2117.89C836.94,-2106.65 839.88,-2091.31 842.75,-2076.35"/>
<polygon fill="black" stroke="black" points="846.26,-2076.6 844.71,-2066.12 839.39,-2075.28 846.26,-2076.6"/>
</g>
<!-- layer6_ffn_act_0&#45;&gt;layer6_ffn_down_0 -->
<g id="edge538" class="edge">
<title>layer6_ffn_act_0&#45;&gt;layer6_ffn_down_0</title>
<path fill="none" stroke="black" d="M666.5,-1845.74C666.5,-1824.18 666.5,-1786.37 666.5,-1755.29"/>
<polygon fill="black" stroke="black" points="670,-1755.04 666.5,-1745.04 663,-1755.04 670,-1755.04"/>
</g>
<!-- layer7_mha_qkv_0 -->
<g id="node562" class="node">
<title>layer7_mha_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="944.5,-1424 388.5,-1424 388.5,-1341 944.5,-1341 944.5,-1424"/>
<text text-anchor="middle" x="666.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="666.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="666.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="666.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="666.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer6_res2_0&#45;&gt;layer7_mha_qkv_0 -->
<g id="edge617" class="edge">
<title>layer6_res2_0&#45;&gt;layer7_mha_qkv_0</title>
<path fill="none" stroke="black" d="M666.5,-1524.74C666.5,-1503.18 666.5,-1465.37 666.5,-1434.29"/>
<polygon fill="black" stroke="black" points="670,-1434.04 666.5,-1424.04 663,-1434.04 670,-1434.04"/>
</g>
<!-- layer6_mha_attn_1&#45;&gt;layer6_mha_out_1 -->
<g id="edge542" class="edge">
<title>layer6_mha_attn_1&#45;&gt;layer6_mha_out_1</title>
<path fill="none" stroke="black" d="M1891.5,-2591.74C1891.5,-2570.18 1891.5,-2532.37 1891.5,-2501.29"/>
<polygon fill="black" stroke="black" points="1895,-2501.04 1891.5,-2491.04 1888,-2501.04 1895,-2501.04"/>
</g>
<!-- layer6_ln1_1 -->
<g id="node534" class="node">
<title>layer6_ln1_1</title>
<polygon fill="none" stroke="black" points="1945,-2154 1838,-2154 1838,-2118 1945,-2118 1945,-2154"/>
<text text-anchor="middle" x="1891.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_1</text>
</g>
<!-- layer6_res1_1&#45;&gt;layer6_ln1_1 -->
<g id="edge544" class="edge">
<title>layer6_res1_1&#45;&gt;layer6_ln1_1</title>
<path fill="none" stroke="black" d="M1891.5,-2270.97C1891.5,-2245.03 1891.5,-2195.36 1891.5,-2164.33"/>
<polygon fill="black" stroke="black" points="1895,-2164.2 1891.5,-2154.2 1888,-2164.2 1895,-2164.2"/>
</g>
<!-- layer6_ln1_1&#45;&gt;layer6_ffn_gate_1 -->
<g id="edge545" class="edge">
<title>layer6_ln1_1&#45;&gt;layer6_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1837.55,-2122.97C1778.48,-2109.8 1680.39,-2087.92 1592.09,-2068.23"/>
<polygon fill="black" stroke="black" points="1592.72,-2064.78 1582.2,-2066.02 1591.2,-2071.61 1592.72,-2064.78"/>
</g>
<!-- layer6_ln1_1&#45;&gt;layer6_ffn_up_1 -->
<g id="edge546" class="edge">
<title>layer6_ln1_1&#45;&gt;layer6_ffn_up_1</title>
<path fill="none" stroke="black" d="M1891.5,-2117.89C1891.5,-2106.65 1891.5,-2091.31 1891.5,-2076.35"/>
<polygon fill="black" stroke="black" points="1895,-2076.12 1891.5,-2066.12 1888,-2076.12 1895,-2076.12"/>
</g>
<!-- layer6_ffn_act_1&#45;&gt;layer6_ffn_down_1 -->
<g id="edge549" class="edge">
<title>layer6_ffn_act_1&#45;&gt;layer6_ffn_down_1</title>
<path fill="none" stroke="black" d="M1768.5,-1845.74C1768.5,-1824.18 1768.5,-1786.37 1768.5,-1755.29"/>
<polygon fill="black" stroke="black" points="1772,-1755.04 1768.5,-1745.04 1765,-1755.04 1772,-1755.04"/>
</g>
<!-- layer7_mha_qkv_1 -->
<g id="node563" class="node">
<title>layer7_mha_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="2046.5,-1424 1490.5,-1424 1490.5,-1341 2046.5,-1341 2046.5,-1424"/>
<text text-anchor="middle" x="1768.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="1768.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1768.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1768.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="1768.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer6_res2_1&#45;&gt;layer7_mha_qkv_1 -->
<g id="edge628" class="edge">
<title>layer6_res2_1&#45;&gt;layer7_mha_qkv_1</title>
<path fill="none" stroke="black" d="M1768.5,-1524.74C1768.5,-1503.18 1768.5,-1465.37 1768.5,-1434.29"/>
<polygon fill="black" stroke="black" points="1772,-1434.04 1768.5,-1424.04 1765,-1434.04 1772,-1434.04"/>
</g>
<!-- layer6_mha_attn_2&#45;&gt;layer6_mha_out_2 -->
<g id="edge553" class="edge">
<title>layer6_mha_attn_2&#45;&gt;layer6_mha_out_2</title>
<path fill="none" stroke="black" d="M3498.5,-2591.74C3498.5,-2570.18 3498.5,-2532.37 3498.5,-2501.29"/>
<polygon fill="black" stroke="black" points="3502,-2501.04 3498.5,-2491.04 3495,-2501.04 3502,-2501.04"/>
</g>
<!-- layer6_ln1_2 -->
<g id="node539" class="node">
<title>layer6_ln1_2</title>
<polygon fill="none" stroke="black" points="3552,-2154 3445,-2154 3445,-2118 3552,-2118 3552,-2154"/>
<text text-anchor="middle" x="3498.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_2</text>
</g>
<!-- layer6_res1_2&#45;&gt;layer6_ln1_2 -->
<g id="edge555" class="edge">
<title>layer6_res1_2&#45;&gt;layer6_ln1_2</title>
<path fill="none" stroke="black" d="M3498.5,-2270.97C3498.5,-2245.03 3498.5,-2195.36 3498.5,-2164.33"/>
<polygon fill="black" stroke="black" points="3502,-2164.2 3498.5,-2154.2 3495,-2164.2 3502,-2164.2"/>
</g>
<!-- layer6_ln1_2&#45;&gt;layer6_ffn_gate_2 -->
<g id="edge556" class="edge">
<title>layer6_ln1_2&#45;&gt;layer6_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3495.06,-2117.89C3492.8,-2106.65 3489.72,-2091.31 3486.72,-2076.35"/>
<polygon fill="black" stroke="black" points="3490.06,-2075.23 3484.66,-2066.12 3483.2,-2076.61 3490.06,-2075.23"/>
</g>
<!-- layer6_ln1_2&#45;&gt;layer6_ffn_up_2 -->
<g id="edge557" class="edge">
<title>layer6_ln1_2&#45;&gt;layer6_ffn_up_2</title>
<path fill="none" stroke="black" d="M3552.3,-2122.44C3608.83,-2109.24 3700.91,-2087.74 3784.01,-2068.34"/>
<polygon fill="black" stroke="black" points="3784.89,-2071.73 3793.83,-2066.05 3783.3,-2064.91 3784.89,-2071.73"/>
</g>
<!-- layer6_ffn_act_2&#45;&gt;layer6_ffn_down_2 -->
<g id="edge560" class="edge">
<title>layer6_ffn_act_2&#45;&gt;layer6_ffn_down_2</title>
<path fill="none" stroke="black" d="M3631.5,-1845.74C3631.5,-1824.18 3631.5,-1786.37 3631.5,-1755.29"/>
<polygon fill="black" stroke="black" points="3635,-1755.04 3631.5,-1745.04 3628,-1755.04 3635,-1755.04"/>
</g>
<!-- layer7_mha_qkv_2 -->
<g id="node564" class="node">
<title>layer7_mha_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="3909.5,-1424 3353.5,-1424 3353.5,-1341 3909.5,-1341 3909.5,-1424"/>
<text text-anchor="middle" x="3631.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="3631.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3631.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3631.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="3631.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer6_res2_2&#45;&gt;layer7_mha_qkv_2 -->
<g id="edge639" class="edge">
<title>layer6_res2_2&#45;&gt;layer7_mha_qkv_2</title>
<path fill="none" stroke="black" d="M3631.5,-1524.74C3631.5,-1503.18 3631.5,-1465.37 3631.5,-1434.29"/>
<polygon fill="black" stroke="black" points="3635,-1434.04 3631.5,-1424.04 3628,-1434.04 3635,-1434.04"/>
</g>
<!-- layer6_mha_attn_3&#45;&gt;layer6_mha_out_3 -->
<g id="edge564" class="edge">
<title>layer6_mha_attn_3&#45;&gt;layer6_mha_out_3</title>
<path fill="none" stroke="black" d="M4585.5,-2591.74C4585.5,-2570.18 4585.5,-2532.37 4585.5,-2501.29"/>
<polygon fill="black" stroke="black" points="4589,-2501.04 4585.5,-2491.04 4582,-2501.04 4589,-2501.04"/>
</g>
<!-- layer6_ln1_3 -->
<g id="node544" class="node">
<title>layer6_ln1_3</title>
<polygon fill="none" stroke="black" points="4639,-2154 4532,-2154 4532,-2118 4639,-2118 4639,-2154"/>
<text text-anchor="middle" x="4585.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_3</text>
</g>
<!-- layer6_res1_3&#45;&gt;layer6_ln1_3 -->
<g id="edge566" class="edge">
<title>layer6_res1_3&#45;&gt;layer6_ln1_3</title>
<path fill="none" stroke="black" d="M4585.5,-2270.97C4585.5,-2245.03 4585.5,-2195.36 4585.5,-2164.33"/>
<polygon fill="black" stroke="black" points="4589,-2164.2 4585.5,-2154.2 4582,-2164.2 4589,-2164.2"/>
</g>
<!-- layer6_ln1_3&#45;&gt;layer6_ffn_gate_3 -->
<g id="edge567" class="edge">
<title>layer6_ln1_3&#45;&gt;layer6_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4585.5,-2117.89C4585.5,-2106.65 4585.5,-2091.31 4585.5,-2076.35"/>
<polygon fill="black" stroke="black" points="4589,-2076.12 4585.5,-2066.12 4582,-2076.12 4589,-2076.12"/>
</g>
<!-- layer6_ln1_3&#45;&gt;layer6_ffn_up_3 -->
<g id="edge568" class="edge">
<title>layer6_ln1_3&#45;&gt;layer6_ffn_up_3</title>
<path fill="none" stroke="black" d="M4639.45,-2122.97C4698.52,-2109.8 4796.61,-2087.92 4884.91,-2068.23"/>
<polygon fill="black" stroke="black" points="4885.8,-2071.61 4894.8,-2066.02 4884.28,-2064.78 4885.8,-2071.61"/>
</g>
<!-- layer6_ffn_act_3&#45;&gt;layer6_ffn_down_3 -->
<g id="edge571" class="edge">
<title>layer6_ffn_act_3&#45;&gt;layer6_ffn_down_3</title>
<path fill="none" stroke="black" d="M4585.5,-1845.74C4585.5,-1824.18 4585.5,-1786.37 4585.5,-1755.29"/>
<polygon fill="black" stroke="black" points="4589,-1755.04 4585.5,-1745.04 4582,-1755.04 4589,-1755.04"/>
</g>
<!-- layer7_mha_qkv_3 -->
<g id="node565" class="node">
<title>layer7_mha_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4863.5,-1424 4307.5,-1424 4307.5,-1341 4863.5,-1341 4863.5,-1424"/>
<text text-anchor="middle" x="4585.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="4585.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4585.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="4585.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer6_res2_3&#45;&gt;layer7_mha_qkv_3 -->
<g id="edge650" class="edge">
<title>layer6_res2_3&#45;&gt;layer7_mha_qkv_3</title>
<path fill="none" stroke="black" d="M4585.5,-1524.74C4585.5,-1503.18 4585.5,-1465.37 4585.5,-1434.29"/>
<polygon fill="black" stroke="black" points="4589,-1434.04 4585.5,-1424.04 4582,-1434.04 4589,-1434.04"/>
</g>
<!-- layer6_mha_attn_4&#45;&gt;layer6_mha_out_4 -->
<g id="edge575" class="edge">
<title>layer6_mha_attn_4&#45;&gt;layer6_mha_out_4</title>
<path fill="none" stroke="black" d="M6007.5,-2591.74C6007.5,-2570.18 6007.5,-2532.37 6007.5,-2501.29"/>
<polygon fill="black" stroke="black" points="6011,-2501.04 6007.5,-2491.04 6004,-2501.04 6011,-2501.04"/>
</g>
<!-- layer6_ln1_4 -->
<g id="node549" class="node">
<title>layer6_ln1_4</title>
<polygon fill="none" stroke="black" points="6061,-2154 5954,-2154 5954,-2118 6061,-2118 6061,-2154"/>
<text text-anchor="middle" x="6007.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_4</text>
</g>
<!-- layer6_res1_4&#45;&gt;layer6_ln1_4 -->
<g id="edge577" class="edge">
<title>layer6_res1_4&#45;&gt;layer6_ln1_4</title>
<path fill="none" stroke="black" d="M6007.5,-2270.97C6007.5,-2245.03 6007.5,-2195.36 6007.5,-2164.33"/>
<polygon fill="black" stroke="black" points="6011,-2164.2 6007.5,-2154.2 6004,-2164.2 6011,-2164.2"/>
</g>
<!-- layer6_ln1_4&#45;&gt;layer6_ffn_gate_4 -->
<g id="edge578" class="edge">
<title>layer6_ln1_4&#45;&gt;layer6_ffn_gate_4</title>
<path fill="none" stroke="black" d="M5953.98,-2120.46C5905.42,-2107.26 5831.28,-2087.12 5763.77,-2068.78"/>
<polygon fill="black" stroke="black" points="5764.43,-2065.33 5753.86,-2066.08 5762.59,-2072.08 5764.43,-2065.33"/>
</g>
<!-- layer6_ln1_4&#45;&gt;layer6_ffn_up_4 -->
<g id="edge579" class="edge">
<title>layer6_ln1_4&#45;&gt;layer6_ffn_up_4</title>
<path fill="none" stroke="black" d="M6021.25,-2117.89C6030.72,-2106.11 6043.81,-2089.82 6056.36,-2074.2"/>
<polygon fill="black" stroke="black" points="6059.32,-2076.11 6062.86,-2066.12 6053.86,-2071.72 6059.32,-2076.11"/>
</g>
<!-- layer6_ffn_act_4&#45;&gt;layer6_ffn_down_4 -->
<g id="edge582" class="edge">
<title>layer6_ffn_act_4&#45;&gt;layer6_ffn_down_4</title>
<path fill="none" stroke="black" d="M6095.5,-1845.74C6095.5,-1824.18 6095.5,-1786.37 6095.5,-1755.29"/>
<polygon fill="black" stroke="black" points="6099,-1755.04 6095.5,-1745.04 6092,-1755.04 6099,-1755.04"/>
</g>
<!-- layer7_mha_qkv_4 -->
<g id="node566" class="node">
<title>layer7_mha_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="6373.5,-1424 5817.5,-1424 5817.5,-1341 6373.5,-1341 6373.5,-1424"/>
<text text-anchor="middle" x="6095.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="6095.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6095.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6095.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="6095.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer6_res2_4&#45;&gt;layer7_mha_qkv_4 -->
<g id="edge661" class="edge">
<title>layer6_res2_4&#45;&gt;layer7_mha_qkv_4</title>
<path fill="none" stroke="black" d="M6095.5,-1524.74C6095.5,-1503.18 6095.5,-1465.37 6095.5,-1434.29"/>
<polygon fill="black" stroke="black" points="6099,-1434.04 6095.5,-1424.04 6092,-1434.04 6099,-1434.04"/>
</g>
<!-- layer6_mha_attn_5&#45;&gt;layer6_mha_out_5 -->
<g id="edge586" class="edge">
<title>layer6_mha_attn_5&#45;&gt;layer6_mha_out_5</title>
<path fill="none" stroke="black" d="M6623.5,-2591.74C6623.5,-2570.18 6623.5,-2532.37 6623.5,-2501.29"/>
<polygon fill="black" stroke="black" points="6627,-2501.04 6623.5,-2491.04 6620,-2501.04 6627,-2501.04"/>
</g>
<!-- layer6_ln1_5 -->
<g id="node554" class="node">
<title>layer6_ln1_5</title>
<polygon fill="none" stroke="black" points="6677,-2154 6570,-2154 6570,-2118 6677,-2118 6677,-2154"/>
<text text-anchor="middle" x="6623.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_5</text>
</g>
<!-- layer6_res1_5&#45;&gt;layer6_ln1_5 -->
<g id="edge588" class="edge">
<title>layer6_res1_5&#45;&gt;layer6_ln1_5</title>
<path fill="none" stroke="black" d="M6623.5,-2270.97C6623.5,-2245.03 6623.5,-2195.36 6623.5,-2164.33"/>
<polygon fill="black" stroke="black" points="6627,-2164.2 6623.5,-2154.2 6620,-2164.2 6627,-2164.2"/>
</g>
<!-- layer6_ln1_5&#45;&gt;layer6_ffn_gate_5 -->
<g id="edge589" class="edge">
<title>layer6_ln1_5&#45;&gt;layer6_ffn_gate_5</title>
<path fill="none" stroke="black" d="M6620.69,-2117.89C6618.84,-2106.65 6616.32,-2091.31 6613.86,-2076.35"/>
<polygon fill="black" stroke="black" points="6617.25,-2075.42 6612.18,-2066.12 6610.35,-2076.55 6617.25,-2075.42"/>
</g>
<!-- layer6_ln1_5&#45;&gt;layer6_ffn_up_5 -->
<g id="edge590" class="edge">
<title>layer6_ln1_5&#45;&gt;layer6_ffn_up_5</title>
<path fill="none" stroke="black" d="M6677.3,-2122.55C6734.3,-2109.35 6827.52,-2087.77 6911.59,-2068.31"/>
<polygon fill="black" stroke="black" points="6912.58,-2071.67 6921.53,-2066.01 6911,-2064.85 6912.58,-2071.67"/>
</g>
<!-- layer6_ffn_act_5&#45;&gt;layer6_ffn_down_5 -->
<g id="edge593" class="edge">
<title>layer6_ffn_act_5&#45;&gt;layer6_ffn_down_5</title>
<path fill="none" stroke="black" d="M7030.5,-1845.74C7030.5,-1824.18 7030.5,-1786.37 7030.5,-1755.29"/>
<polygon fill="black" stroke="black" points="7034,-1755.04 7030.5,-1745.04 7027,-1755.04 7034,-1755.04"/>
</g>
<!-- layer7_mha_qkv_5 -->
<g id="node567" class="node">
<title>layer7_mha_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="7308.5,-1424 6752.5,-1424 6752.5,-1341 7308.5,-1341 7308.5,-1424"/>
<text text-anchor="middle" x="7030.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="7030.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7030.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7030.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="7030.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer6_res2_5&#45;&gt;layer7_mha_qkv_5 -->
<g id="edge672" class="edge">
<title>layer6_res2_5&#45;&gt;layer7_mha_qkv_5</title>
<path fill="none" stroke="black" d="M7030.5,-1524.74C7030.5,-1503.18 7030.5,-1465.37 7030.5,-1434.29"/>
<polygon fill="black" stroke="black" points="7034,-1434.04 7030.5,-1424.04 7027,-1434.04 7034,-1434.04"/>
</g>
<!-- layer6_mha_attn_6&#45;&gt;layer6_mha_out_6 -->
<g id="edge597" class="edge">
<title>layer6_mha_attn_6&#45;&gt;layer6_mha_out_6</title>
<path fill="none" stroke="black" d="M7854.5,-2591.74C7854.5,-2570.18 7854.5,-2532.37 7854.5,-2501.29"/>
<polygon fill="black" stroke="black" points="7858,-2501.04 7854.5,-2491.04 7851,-2501.04 7858,-2501.04"/>
</g>
<!-- layer6_ln1_6 -->
<g id="node559" class="node">
<title>layer6_ln1_6</title>
<polygon fill="none" stroke="black" points="7908,-2154 7801,-2154 7801,-2118 7908,-2118 7908,-2154"/>
<text text-anchor="middle" x="7854.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer6_ln1_6</text>
</g>
<!-- layer6_res1_6&#45;&gt;layer6_ln1_6 -->
<g id="edge599" class="edge">
<title>layer6_res1_6&#45;&gt;layer6_ln1_6</title>
<path fill="none" stroke="black" d="M7854.5,-2270.97C7854.5,-2245.03 7854.5,-2195.36 7854.5,-2164.33"/>
<polygon fill="black" stroke="black" points="7858,-2164.2 7854.5,-2154.2 7851,-2164.2 7858,-2164.2"/>
</g>
<!-- layer6_ln1_6&#45;&gt;layer6_ffn_gate_6 -->
<g id="edge600" class="edge">
<title>layer6_ln1_6&#45;&gt;layer6_ffn_gate_6</title>
<path fill="none" stroke="black" d="M7822.62,-2117.89C7799.17,-2105.3 7766.12,-2087.56 7735.24,-2070.99"/>
<polygon fill="black" stroke="black" points="7736.64,-2067.76 7726.17,-2066.12 7733.33,-2073.93 7736.64,-2067.76"/>
</g>
<!-- layer6_ln1_6&#45;&gt;layer6_ffn_up_6 -->
<g id="edge601" class="edge">
<title>layer6_ln1_6&#45;&gt;layer6_ffn_up_6</title>
<path fill="none" stroke="black" d="M7899.34,-2117.89C7933.27,-2104.95 7981.45,-2086.56 8025.92,-2069.6"/>
<polygon fill="black" stroke="black" points="8027.25,-2072.84 8035.35,-2066 8024.75,-2066.3 8027.25,-2072.84"/>
</g>
<!-- layer6_ffn_act_6&#45;&gt;layer6_ffn_down_6 -->
<g id="edge604" class="edge">
<title>layer6_ffn_act_6&#45;&gt;layer6_ffn_down_6</title>
<path fill="none" stroke="black" d="M8123.5,-1845.74C8123.5,-1824.18 8123.5,-1786.37 8123.5,-1755.29"/>
<polygon fill="black" stroke="black" points="8127,-1755.04 8123.5,-1745.04 8120,-1755.04 8127,-1755.04"/>
</g>
<!-- layer7_mha_qkv_6 -->
<g id="node568" class="node">
<title>layer7_mha_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="8401.5,-1424 7845.5,-1424 7845.5,-1341 8401.5,-1341 8401.5,-1424"/>
<text text-anchor="middle" x="8123.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="8123.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8123.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8123.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="8123.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer6_res2_6&#45;&gt;layer7_mha_qkv_6 -->
<g id="edge683" class="edge">
<title>layer6_res2_6&#45;&gt;layer7_mha_qkv_6</title>
<path fill="none" stroke="black" d="M8123.5,-1524.74C8123.5,-1503.18 8123.5,-1465.37 8123.5,-1434.29"/>
<polygon fill="black" stroke="black" points="8127,-1434.04 8123.5,-1424.04 8120,-1434.04 8127,-1434.04"/>
</g>
<!-- layer7_mha_attn_0 -->
<g id="node607" class="node">
<title>layer7_mha_attn_0</title>
<polygon fill="none" stroke="black" points="742,-1240 591,-1240 591,-1204 742,-1204 742,-1240"/>
<text text-anchor="middle" x="666.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_0</text>
</g>
<!-- layer7_mha_qkv_0&#45;&gt;layer7_mha_attn_0 -->
<g id="edge618" class="edge">
<title>layer7_mha_qkv_0&#45;&gt;layer7_mha_attn_0</title>
<path fill="none" stroke="black" d="M666.5,-1340.68C666.5,-1312.24 666.5,-1275.08 666.5,-1250.2"/>
<polygon fill="black" stroke="black" points="670,-1250.02 666.5,-1240.02 663,-1250.02 670,-1250.02"/>
</g>
<!-- layer7_mha_attn_1 -->
<g id="node612" class="node">
<title>layer7_mha_attn_1</title>
<polygon fill="none" stroke="black" points="1844,-1240 1693,-1240 1693,-1204 1844,-1204 1844,-1240"/>
<text text-anchor="middle" x="1768.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_1</text>
</g>
<!-- layer7_mha_qkv_1&#45;&gt;layer7_mha_attn_1 -->
<g id="edge629" class="edge">
<title>layer7_mha_qkv_1&#45;&gt;layer7_mha_attn_1</title>
<path fill="none" stroke="black" d="M1768.5,-1340.68C1768.5,-1312.24 1768.5,-1275.08 1768.5,-1250.2"/>
<polygon fill="black" stroke="black" points="1772,-1250.02 1768.5,-1240.02 1765,-1250.02 1772,-1250.02"/>
</g>
<!-- layer7_mha_attn_2 -->
<g id="node617" class="node">
<title>layer7_mha_attn_2</title>
<polygon fill="none" stroke="black" points="3707,-1240 3556,-1240 3556,-1204 3707,-1204 3707,-1240"/>
<text text-anchor="middle" x="3631.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_2</text>
</g>
<!-- layer7_mha_qkv_2&#45;&gt;layer7_mha_attn_2 -->
<g id="edge640" class="edge">
<title>layer7_mha_qkv_2&#45;&gt;layer7_mha_attn_2</title>
<path fill="none" stroke="black" d="M3631.5,-1340.68C3631.5,-1312.24 3631.5,-1275.08 3631.5,-1250.2"/>
<polygon fill="black" stroke="black" points="3635,-1250.02 3631.5,-1240.02 3628,-1250.02 3635,-1250.02"/>
</g>
<!-- layer7_mha_attn_3 -->
<g id="node622" class="node">
<title>layer7_mha_attn_3</title>
<polygon fill="none" stroke="black" points="4661,-1240 4510,-1240 4510,-1204 4661,-1204 4661,-1240"/>
<text text-anchor="middle" x="4585.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_3</text>
</g>
<!-- layer7_mha_qkv_3&#45;&gt;layer7_mha_attn_3 -->
<g id="edge651" class="edge">
<title>layer7_mha_qkv_3&#45;&gt;layer7_mha_attn_3</title>
<path fill="none" stroke="black" d="M4585.5,-1340.68C4585.5,-1312.24 4585.5,-1275.08 4585.5,-1250.2"/>
<polygon fill="black" stroke="black" points="4589,-1250.02 4585.5,-1240.02 4582,-1250.02 4589,-1250.02"/>
</g>
<!-- layer7_mha_attn_4 -->
<g id="node627" class="node">
<title>layer7_mha_attn_4</title>
<polygon fill="none" stroke="black" points="6171,-1240 6020,-1240 6020,-1204 6171,-1204 6171,-1240"/>
<text text-anchor="middle" x="6095.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_4</text>
</g>
<!-- layer7_mha_qkv_4&#45;&gt;layer7_mha_attn_4 -->
<g id="edge662" class="edge">
<title>layer7_mha_qkv_4&#45;&gt;layer7_mha_attn_4</title>
<path fill="none" stroke="black" d="M6095.5,-1340.68C6095.5,-1312.24 6095.5,-1275.08 6095.5,-1250.2"/>
<polygon fill="black" stroke="black" points="6099,-1250.02 6095.5,-1240.02 6092,-1250.02 6099,-1250.02"/>
</g>
<!-- layer7_mha_attn_5 -->
<g id="node632" class="node">
<title>layer7_mha_attn_5</title>
<polygon fill="none" stroke="black" points="7106,-1240 6955,-1240 6955,-1204 7106,-1204 7106,-1240"/>
<text text-anchor="middle" x="7030.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_5</text>
</g>
<!-- layer7_mha_qkv_5&#45;&gt;layer7_mha_attn_5 -->
<g id="edge673" class="edge">
<title>layer7_mha_qkv_5&#45;&gt;layer7_mha_attn_5</title>
<path fill="none" stroke="black" d="M7030.5,-1340.68C7030.5,-1312.24 7030.5,-1275.08 7030.5,-1250.2"/>
<polygon fill="black" stroke="black" points="7034,-1250.02 7030.5,-1240.02 7027,-1250.02 7034,-1250.02"/>
</g>
<!-- layer7_mha_attn_6 -->
<g id="node637" class="node">
<title>layer7_mha_attn_6</title>
<polygon fill="none" stroke="black" points="8199,-1240 8048,-1240 8048,-1204 8199,-1204 8199,-1240"/>
<text text-anchor="middle" x="8123.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer7_mha_attn_6</text>
</g>
<!-- layer7_mha_qkv_6&#45;&gt;layer7_mha_attn_6 -->
<g id="edge684" class="edge">
<title>layer7_mha_qkv_6&#45;&gt;layer7_mha_attn_6</title>
<path fill="none" stroke="black" d="M8123.5,-1340.68C8123.5,-1312.24 8123.5,-1275.08 8123.5,-1250.2"/>
<polygon fill="black" stroke="black" points="8127,-1250.02 8123.5,-1240.02 8120,-1250.02 8127,-1250.02"/>
</g>
<!-- layer7_mha_attn_7 -->
<g id="node570" class="node">
<title>layer7_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="9565.31,-1305 8806.81,-1305 8611.69,-1139 9370.19,-1139 9565.31,-1305"/>
<text text-anchor="middle" x="9088.5" y="-1248.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="9088.5" y="-1233.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="9088.5" y="-1218.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9088.5" y="-1203.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-1188.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_mha_qkv_7&#45;&gt;layer7_mha_attn_7 -->
<g id="edge695" class="edge">
<title>layer7_mha_qkv_7&#45;&gt;layer7_mha_attn_7</title>
<path fill="none" stroke="black" d="M9088.5,-1340.68C9088.5,-1332.75 9088.5,-1324.14 9088.5,-1315.31"/>
<polygon fill="black" stroke="black" points="9092,-1315.27 9088.5,-1305.27 9085,-1315.27 9092,-1315.27"/>
</g>
<!-- layer7_mha_out_7 -->
<g id="node578" class="node">
<title>layer7_mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="9307.5,-1103 8869.5,-1103 8869.5,-1020 9307.5,-1020 9307.5,-1103"/>
<text text-anchor="middle" x="9088.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9088.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9088.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9088.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_mha_attn_7&#45;&gt;layer7_mha_out_7 -->
<g id="edge696" class="edge">
<title>layer7_mha_attn_7&#45;&gt;layer7_mha_out_7</title>
<path fill="none" stroke="black" d="M9088.5,-1138.96C9088.5,-1130.25 9088.5,-1121.59 9088.5,-1113.39"/>
<polygon fill="black" stroke="black" points="9092,-1113.29 9088.5,-1103.29 9085,-1113.29 9092,-1113.29"/>
</g>
<!-- layer7_mha_out_0 -->
<g id="node571" class="node">
<title>layer7_mha_out_0</title>
<polygon fill="lightblue" stroke="black" points="885.5,-1103 447.5,-1103 447.5,-1020 885.5,-1020 885.5,-1103"/>
<text text-anchor="middle" x="666.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="666.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="666.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="666.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="666.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_res1_0 -->
<g id="node608" class="node">
<title>layer7_res1_0</title>
<polygon fill="none" stroke="black" points="724.5,-919 608.5,-919 608.5,-883 724.5,-883 724.5,-919"/>
<text text-anchor="middle" x="666.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_0</text>
</g>
<!-- layer7_mha_out_0&#45;&gt;layer7_res1_0 -->
<g id="edge620" class="edge">
<title>layer7_mha_out_0&#45;&gt;layer7_res1_0</title>
<path fill="none" stroke="black" d="M666.5,-1019.68C666.5,-991.24 666.5,-954.08 666.5,-929.2"/>
<polygon fill="black" stroke="black" points="670,-929.02 666.5,-919.02 663,-929.02 670,-929.02"/>
</g>
<!-- layer7_mha_out_1 -->
<g id="node572" class="node">
<title>layer7_mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="1987.5,-1103 1549.5,-1103 1549.5,-1020 1987.5,-1020 1987.5,-1103"/>
<text text-anchor="middle" x="1768.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="1768.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1768.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1768.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1768.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_res1_1 -->
<g id="node613" class="node">
<title>layer7_res1_1</title>
<polygon fill="none" stroke="black" points="1826.5,-919 1710.5,-919 1710.5,-883 1826.5,-883 1826.5,-919"/>
<text text-anchor="middle" x="1768.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_1</text>
</g>
<!-- layer7_mha_out_1&#45;&gt;layer7_res1_1 -->
<g id="edge631" class="edge">
<title>layer7_mha_out_1&#45;&gt;layer7_res1_1</title>
<path fill="none" stroke="black" d="M1768.5,-1019.68C1768.5,-991.24 1768.5,-954.08 1768.5,-929.2"/>
<polygon fill="black" stroke="black" points="1772,-929.02 1768.5,-919.02 1765,-929.02 1772,-929.02"/>
</g>
<!-- layer7_mha_out_2 -->
<g id="node573" class="node">
<title>layer7_mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="3850.5,-1103 3412.5,-1103 3412.5,-1020 3850.5,-1020 3850.5,-1103"/>
<text text-anchor="middle" x="3631.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="3631.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3631.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3631.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3631.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_res1_2 -->
<g id="node618" class="node">
<title>layer7_res1_2</title>
<polygon fill="none" stroke="black" points="3689.5,-919 3573.5,-919 3573.5,-883 3689.5,-883 3689.5,-919"/>
<text text-anchor="middle" x="3631.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_2</text>
</g>
<!-- layer7_mha_out_2&#45;&gt;layer7_res1_2 -->
<g id="edge642" class="edge">
<title>layer7_mha_out_2&#45;&gt;layer7_res1_2</title>
<path fill="none" stroke="black" d="M3631.5,-1019.68C3631.5,-991.24 3631.5,-954.08 3631.5,-929.2"/>
<polygon fill="black" stroke="black" points="3635,-929.02 3631.5,-919.02 3628,-929.02 3635,-929.02"/>
</g>
<!-- layer7_mha_out_3 -->
<g id="node574" class="node">
<title>layer7_mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="4804.5,-1103 4366.5,-1103 4366.5,-1020 4804.5,-1020 4804.5,-1103"/>
<text text-anchor="middle" x="4585.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="4585.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4585.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4585.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4585.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_res1_3 -->
<g id="node623" class="node">
<title>layer7_res1_3</title>
<polygon fill="none" stroke="black" points="4643.5,-919 4527.5,-919 4527.5,-883 4643.5,-883 4643.5,-919"/>
<text text-anchor="middle" x="4585.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_3</text>
</g>
<!-- layer7_mha_out_3&#45;&gt;layer7_res1_3 -->
<g id="edge653" class="edge">
<title>layer7_mha_out_3&#45;&gt;layer7_res1_3</title>
<path fill="none" stroke="black" d="M4585.5,-1019.68C4585.5,-991.24 4585.5,-954.08 4585.5,-929.2"/>
<polygon fill="black" stroke="black" points="4589,-929.02 4585.5,-919.02 4582,-929.02 4589,-929.02"/>
</g>
<!-- layer7_mha_out_4 -->
<g id="node575" class="node">
<title>layer7_mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="6314.5,-1103 5876.5,-1103 5876.5,-1020 6314.5,-1020 6314.5,-1103"/>
<text text-anchor="middle" x="6095.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="6095.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6095.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6095.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6095.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_res1_4 -->
<g id="node628" class="node">
<title>layer7_res1_4</title>
<polygon fill="none" stroke="black" points="6153.5,-919 6037.5,-919 6037.5,-883 6153.5,-883 6153.5,-919"/>
<text text-anchor="middle" x="6095.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_4</text>
</g>
<!-- layer7_mha_out_4&#45;&gt;layer7_res1_4 -->
<g id="edge664" class="edge">
<title>layer7_mha_out_4&#45;&gt;layer7_res1_4</title>
<path fill="none" stroke="black" d="M6095.5,-1019.68C6095.5,-991.24 6095.5,-954.08 6095.5,-929.2"/>
<polygon fill="black" stroke="black" points="6099,-929.02 6095.5,-919.02 6092,-929.02 6099,-929.02"/>
</g>
<!-- layer7_mha_out_5 -->
<g id="node576" class="node">
<title>layer7_mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="7249.5,-1103 6811.5,-1103 6811.5,-1020 7249.5,-1020 7249.5,-1103"/>
<text text-anchor="middle" x="7030.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="7030.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7030.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7030.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7030.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_res1_5 -->
<g id="node633" class="node">
<title>layer7_res1_5</title>
<polygon fill="none" stroke="black" points="7088.5,-919 6972.5,-919 6972.5,-883 7088.5,-883 7088.5,-919"/>
<text text-anchor="middle" x="7030.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_5</text>
</g>
<!-- layer7_mha_out_5&#45;&gt;layer7_res1_5 -->
<g id="edge675" class="edge">
<title>layer7_mha_out_5&#45;&gt;layer7_res1_5</title>
<path fill="none" stroke="black" d="M7030.5,-1019.68C7030.5,-991.24 7030.5,-954.08 7030.5,-929.2"/>
<polygon fill="black" stroke="black" points="7034,-929.02 7030.5,-919.02 7027,-929.02 7034,-929.02"/>
</g>
<!-- layer7_mha_out_6 -->
<g id="node577" class="node">
<title>layer7_mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="8342.5,-1103 7904.5,-1103 7904.5,-1020 8342.5,-1020 8342.5,-1103"/>
<text text-anchor="middle" x="8123.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="8123.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8123.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8123.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8123.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_res1_6 -->
<g id="node638" class="node">
<title>layer7_res1_6</title>
<polygon fill="none" stroke="black" points="8181.5,-919 8065.5,-919 8065.5,-883 8181.5,-883 8181.5,-919"/>
<text text-anchor="middle" x="8123.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer7_res1_6</text>
</g>
<!-- layer7_mha_out_6&#45;&gt;layer7_res1_6 -->
<g id="edge686" class="edge">
<title>layer7_mha_out_6&#45;&gt;layer7_res1_6</title>
<path fill="none" stroke="black" d="M8123.5,-1019.68C8123.5,-991.24 8123.5,-954.08 8123.5,-929.2"/>
<polygon fill="black" stroke="black" points="8127,-929.02 8123.5,-919.02 8120,-929.02 8127,-929.02"/>
</g>
<!-- layer7_res1_7 -->
<g id="node579" class="node">
<title>layer7_res1_7</title>
<polygon fill="none" stroke="black" points="9529.24,-984 8828.12,-984 8647.76,-818 9348.88,-818 9529.24,-984"/>
<text text-anchor="middle" x="9088.5" y="-927.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9088.5" y="-912.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-897.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-882.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-867.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_mha_out_7&#45;&gt;layer7_res1_7 -->
<g id="edge697" class="edge">
<title>layer7_mha_out_7&#45;&gt;layer7_res1_7</title>
<path fill="none" stroke="black" d="M9088.5,-1019.68C9088.5,-1011.75 9088.5,-1003.14 9088.5,-994.31"/>
<polygon fill="black" stroke="black" points="9092,-994.27 9088.5,-984.27 9085,-994.27 9092,-994.27"/>
</g>
<!-- layer7_ln1_7 -->
<g id="node580" class="node">
<title>layer7_ln1_7</title>
<polygon fill="yellow" stroke="black" points="9301,-782 8876,-782 8876,-714 9301,-714 9301,-782"/>
<text text-anchor="middle" x="9088.5" y="-766.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="9088.5" y="-751.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-736.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-721.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_res1_7&#45;&gt;layer7_ln1_7 -->
<g id="edge698" class="edge">
<title>layer7_res1_7&#45;&gt;layer7_ln1_7</title>
<path fill="none" stroke="black" d="M9088.5,-817.87C9088.5,-809.12 9088.5,-800.48 9088.5,-792.45"/>
<polygon fill="black" stroke="black" points="9092,-792.26 9088.5,-782.26 9085,-792.26 9092,-792.26"/>
</g>
<!-- layer7_ffn_gate_7 -->
<g id="node588" class="node">
<title>layer7_ffn_gate_7</title>
<polygon fill="lightblue" stroke="black" points="9325,-678 8852,-678 8852,-595 9325,-595 9325,-678"/>
<text text-anchor="middle" x="9088.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9088.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9088.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9088.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9088.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_ln1_7&#45;&gt;layer7_ffn_gate_7 -->
<g id="edge699" class="edge">
<title>layer7_ln1_7&#45;&gt;layer7_ffn_gate_7</title>
<path fill="none" stroke="black" d="M9088.5,-713.85C9088.5,-705.8 9088.5,-697 9088.5,-688.34"/>
<polygon fill="black" stroke="black" points="9092,-688.28 9088.5,-678.28 9085,-688.28 9092,-688.28"/>
</g>
<!-- layer7_ffn_up_7 -->
<g id="node596" class="node">
<title>layer7_ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="9816,-678 9343,-678 9343,-595 9816,-595 9816,-678"/>
<text text-anchor="middle" x="9579.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9579.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9579.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9579.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9579.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_ln1_7&#45;&gt;layer7_ffn_up_7 -->
<g id="edge700" class="edge">
<title>layer7_ln1_7&#45;&gt;layer7_ffn_up_7</title>
<path fill="none" stroke="black" d="M9236.48,-714C9284,-703.4 9337.34,-691.51 9387.53,-680.31"/>
<polygon fill="black" stroke="black" points="9388.53,-683.67 9397.53,-678.08 9387.01,-676.84 9388.53,-683.67"/>
</g>
<!-- layer7_ffn_gate_0 -->
<g id="node581" class="node">
<title>layer7_ffn_gate_0</title>
<polygon fill="lightblue" stroke="black" points="473,-678 0,-678 0,-595 473,-595 473,-678"/>
<text text-anchor="middle" x="236.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="236.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="236.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="236.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="236.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_ffn_act_0 -->
<g id="node610" class="node">
<title>layer7_ffn_act_0</title>
<polygon fill="none" stroke="black" points="548,-494 417,-494 417,-458 548,-458 548,-494"/>
<text text-anchor="middle" x="482.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_0</text>
</g>
<!-- layer7_ffn_gate_0&#45;&gt;layer7_ffn_act_0 -->
<g id="edge624" class="edge">
<title>layer7_ffn_gate_0&#45;&gt;layer7_ffn_act_0</title>
<path fill="none" stroke="black" d="M299.53,-594.89C346.45,-564.66 408.78,-524.5 447.24,-499.72"/>
<polygon fill="black" stroke="black" points="449.5,-502.43 456.01,-494.07 445.71,-496.54 449.5,-502.43"/>
</g>
<!-- layer7_ffn_gate_1 -->
<g id="node582" class="node">
<title>layer7_ffn_gate_1</title>
<polygon fill="lightblue" stroke="black" points="1700,-678 1227,-678 1227,-595 1700,-595 1700,-678"/>
<text text-anchor="middle" x="1463.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1463.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1463.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1463.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1463.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_ffn_act_1 -->
<g id="node615" class="node">
<title>layer7_ffn_act_1</title>
<polygon fill="none" stroke="black" points="1774,-494 1643,-494 1643,-458 1774,-458 1774,-494"/>
<text text-anchor="middle" x="1708.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_1</text>
</g>
<!-- layer7_ffn_gate_1&#45;&gt;layer7_ffn_act_1 -->
<g id="edge635" class="edge">
<title>layer7_ffn_gate_1&#45;&gt;layer7_ffn_act_1</title>
<path fill="none" stroke="black" d="M1526.28,-594.89C1573,-564.66 1635.08,-524.5 1673.38,-499.72"/>
<polygon fill="black" stroke="black" points="1675.62,-502.44 1682.12,-494.07 1671.82,-496.56 1675.62,-502.44"/>
</g>
<!-- layer7_ffn_gate_2 -->
<g id="node583" class="node">
<title>layer7_ffn_gate_2</title>
<polygon fill="lightblue" stroke="black" points="3686,-678 3213,-678 3213,-595 3686,-595 3686,-678"/>
<text text-anchor="middle" x="3449.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3449.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3449.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3449.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3449.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_ffn_act_2 -->
<g id="node620" class="node">
<title>layer7_ffn_act_2</title>
<polygon fill="none" stroke="black" points="3760,-494 3629,-494 3629,-458 3760,-458 3760,-494"/>
<text text-anchor="middle" x="3694.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_2</text>
</g>
<!-- layer7_ffn_gate_2&#45;&gt;layer7_ffn_act_2 -->
<g id="edge646" class="edge">
<title>layer7_ffn_gate_2&#45;&gt;layer7_ffn_act_2</title>
<path fill="none" stroke="black" d="M3512.28,-594.89C3559,-564.66 3621.08,-524.5 3659.38,-499.72"/>
<polygon fill="black" stroke="black" points="3661.62,-502.44 3668.12,-494.07 3657.82,-496.56 3661.62,-502.44"/>
</g>
<!-- layer7_ffn_gate_3 -->
<g id="node584" class="node">
<title>layer7_ffn_gate_3</title>
<polygon fill="lightblue" stroke="black" points="4668,-678 4195,-678 4195,-595 4668,-595 4668,-678"/>
<text text-anchor="middle" x="4431.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4431.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4431.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4431.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4431.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_ffn_act_3 -->
<g id="node625" class="node">
<title>layer7_ffn_act_3</title>
<polygon fill="none" stroke="black" points="4742,-494 4611,-494 4611,-458 4742,-458 4742,-494"/>
<text text-anchor="middle" x="4676.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_3</text>
</g>
<!-- layer7_ffn_gate_3&#45;&gt;layer7_ffn_act_3 -->
<g id="edge657" class="edge">
<title>layer7_ffn_gate_3&#45;&gt;layer7_ffn_act_3</title>
<path fill="none" stroke="black" d="M4494.28,-594.89C4541,-564.66 4603.08,-524.5 4641.38,-499.72"/>
<polygon fill="black" stroke="black" points="4643.62,-502.44 4650.12,-494.07 4639.82,-496.56 4643.62,-502.44"/>
</g>
<!-- layer7_ffn_gate_4 -->
<g id="node585" class="node">
<title>layer7_ffn_gate_4</title>
<polygon fill="lightblue" stroke="black" points="6086,-678 5613,-678 5613,-595 6086,-595 6086,-678"/>
<text text-anchor="middle" x="5849.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5849.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="5849.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5849.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="5849.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_ffn_act_4 -->
<g id="node630" class="node">
<title>layer7_ffn_act_4</title>
<polygon fill="none" stroke="black" points="6160,-494 6029,-494 6029,-458 6160,-458 6160,-494"/>
<text text-anchor="middle" x="6094.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_4</text>
</g>
<!-- layer7_ffn_gate_4&#45;&gt;layer7_ffn_act_4 -->
<g id="edge668" class="edge">
<title>layer7_ffn_gate_4&#45;&gt;layer7_ffn_act_4</title>
<path fill="none" stroke="black" d="M5912.28,-594.89C5959,-564.66 6021.08,-524.5 6059.38,-499.72"/>
<polygon fill="black" stroke="black" points="6061.62,-502.44 6068.12,-494.07 6057.82,-496.56 6061.62,-502.44"/>
</g>
<!-- layer7_ffn_gate_5 -->
<g id="node586" class="node">
<title>layer7_ffn_gate_5</title>
<polygon fill="lightblue" stroke="black" points="7135,-678 6662,-678 6662,-595 7135,-595 7135,-678"/>
<text text-anchor="middle" x="6898.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6898.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="6898.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6898.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6898.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_ffn_act_5 -->
<g id="node635" class="node">
<title>layer7_ffn_act_5</title>
<polygon fill="none" stroke="black" points="7209,-494 7078,-494 7078,-458 7209,-458 7209,-494"/>
<text text-anchor="middle" x="7143.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_5</text>
</g>
<!-- layer7_ffn_gate_5&#45;&gt;layer7_ffn_act_5 -->
<g id="edge679" class="edge">
<title>layer7_ffn_gate_5&#45;&gt;layer7_ffn_act_5</title>
<path fill="none" stroke="black" d="M6961.28,-594.89C7008,-564.66 7070.08,-524.5 7108.38,-499.72"/>
<polygon fill="black" stroke="black" points="7110.62,-502.44 7117.12,-494.07 7106.82,-496.56 7110.62,-502.44"/>
</g>
<!-- layer7_ffn_gate_6 -->
<g id="node587" class="node">
<title>layer7_ffn_gate_6</title>
<polygon fill="lightblue" stroke="black" points="8343,-678 7870,-678 7870,-595 8343,-595 8343,-678"/>
<text text-anchor="middle" x="8106.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8106.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8106.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8106.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8106.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_ffn_act_6 -->
<g id="node640" class="node">
<title>layer7_ffn_act_6</title>
<polygon fill="none" stroke="black" points="8383,-494 8252,-494 8252,-458 8383,-458 8383,-494"/>
<text text-anchor="middle" x="8317.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer7_ffn_act_6</text>
</g>
<!-- layer7_ffn_gate_6&#45;&gt;layer7_ffn_act_6 -->
<g id="edge690" class="edge">
<title>layer7_ffn_gate_6&#45;&gt;layer7_ffn_act_6</title>
<path fill="none" stroke="black" d="M8160.56,-594.89C8200.47,-564.91 8253.37,-525.18 8286.42,-500.35"/>
<polygon fill="black" stroke="black" points="8288.88,-502.87 8294.78,-494.07 8284.68,-497.28 8288.88,-502.87"/>
</g>
<!-- layer7_ffn_act_7 -->
<g id="node597" class="node">
<title>layer7_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="9630.24,-559 8873.44,-559 8678.76,-393 9435.56,-393 9630.24,-559"/>
<text text-anchor="middle" x="9154.5" y="-502.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="9154.5" y="-487.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="9154.5" y="-472.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9154.5" y="-457.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9154.5" y="-442.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_ffn_gate_7&#45;&gt;layer7_ffn_act_7 -->
<g id="edge701" class="edge">
<title>layer7_ffn_gate_7&#45;&gt;layer7_ffn_act_7</title>
<path fill="none" stroke="black" d="M9105.5,-594.68C9108.87,-586.58 9112.54,-577.77 9116.3,-568.74"/>
<polygon fill="black" stroke="black" points="9119.63,-569.85 9120.24,-559.27 9113.17,-567.16 9119.63,-569.85"/>
</g>
<!-- layer7_ffn_up_0 -->
<g id="node589" class="node">
<title>layer7_ffn_up_0</title>
<polygon fill="lightblue" stroke="black" points="964,-678 491,-678 491,-595 964,-595 964,-678"/>
<text text-anchor="middle" x="727.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="727.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="727.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="727.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="727.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_ffn_up_0&#45;&gt;layer7_ffn_act_0 -->
<g id="edge625" class="edge">
<title>layer7_ffn_up_0&#45;&gt;layer7_ffn_act_0</title>
<path fill="none" stroke="black" d="M664.72,-594.89C618,-564.66 555.92,-524.5 517.62,-499.72"/>
<polygon fill="black" stroke="black" points="519.18,-496.56 508.88,-494.07 515.38,-502.44 519.18,-496.56"/>
</g>
<!-- layer7_ffn_up_1 -->
<g id="node590" class="node">
<title>layer7_ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="2191,-678 1718,-678 1718,-595 2191,-595 2191,-678"/>
<text text-anchor="middle" x="1954.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1954.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1954.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1954.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="1954.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_ffn_up_1&#45;&gt;layer7_ffn_act_1 -->
<g id="edge636" class="edge">
<title>layer7_ffn_up_1&#45;&gt;layer7_ffn_act_1</title>
<path fill="none" stroke="black" d="M1891.47,-594.89C1844.55,-564.66 1782.22,-524.5 1743.76,-499.72"/>
<polygon fill="black" stroke="black" points="1745.29,-496.54 1734.99,-494.07 1741.5,-502.43 1745.29,-496.54"/>
</g>
<!-- layer7_ffn_up_2 -->
<g id="node591" class="node">
<title>layer7_ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="4177,-678 3704,-678 3704,-595 4177,-595 4177,-678"/>
<text text-anchor="middle" x="3940.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3940.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3940.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3940.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="3940.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_ffn_up_2&#45;&gt;layer7_ffn_act_2 -->
<g id="edge647" class="edge">
<title>layer7_ffn_up_2&#45;&gt;layer7_ffn_act_2</title>
<path fill="none" stroke="black" d="M3877.47,-594.89C3830.55,-564.66 3768.22,-524.5 3729.76,-499.72"/>
<polygon fill="black" stroke="black" points="3731.29,-496.54 3720.99,-494.07 3727.5,-502.43 3731.29,-496.54"/>
</g>
<!-- layer7_ffn_up_3 -->
<g id="node592" class="node">
<title>layer7_ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="5159,-678 4686,-678 4686,-595 5159,-595 5159,-678"/>
<text text-anchor="middle" x="4922.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4922.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4922.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4922.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="4922.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_ffn_up_3&#45;&gt;layer7_ffn_act_3 -->
<g id="edge658" class="edge">
<title>layer7_ffn_up_3&#45;&gt;layer7_ffn_act_3</title>
<path fill="none" stroke="black" d="M4859.47,-594.89C4812.55,-564.66 4750.22,-524.5 4711.76,-499.72"/>
<polygon fill="black" stroke="black" points="4713.29,-496.54 4702.99,-494.07 4709.5,-502.43 4713.29,-496.54"/>
</g>
<!-- layer7_ffn_up_4 -->
<g id="node593" class="node">
<title>layer7_ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="6577,-678 6104,-678 6104,-595 6577,-595 6577,-678"/>
<text text-anchor="middle" x="6340.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6340.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6340.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6340.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="6340.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_ffn_up_4&#45;&gt;layer7_ffn_act_4 -->
<g id="edge669" class="edge">
<title>layer7_ffn_up_4&#45;&gt;layer7_ffn_act_4</title>
<path fill="none" stroke="black" d="M6277.47,-594.89C6230.55,-564.66 6168.22,-524.5 6129.76,-499.72"/>
<polygon fill="black" stroke="black" points="6131.29,-496.54 6120.99,-494.07 6127.5,-502.43 6131.29,-496.54"/>
</g>
<!-- layer7_ffn_up_5 -->
<g id="node594" class="node">
<title>layer7_ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="7626,-678 7153,-678 7153,-595 7626,-595 7626,-678"/>
<text text-anchor="middle" x="7389.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7389.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7389.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="7389.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="7389.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_ffn_up_5&#45;&gt;layer7_ffn_act_5 -->
<g id="edge680" class="edge">
<title>layer7_ffn_up_5&#45;&gt;layer7_ffn_act_5</title>
<path fill="none" stroke="black" d="M7326.47,-594.89C7279.55,-564.66 7217.22,-524.5 7178.76,-499.72"/>
<polygon fill="black" stroke="black" points="7180.29,-496.54 7169.99,-494.07 7176.5,-502.43 7180.29,-496.54"/>
</g>
<!-- layer7_ffn_up_6 -->
<g id="node595" class="node">
<title>layer7_ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="8834,-678 8361,-678 8361,-595 8834,-595 8834,-678"/>
<text text-anchor="middle" x="8597.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8597.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8597.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="8597.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="8597.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_ffn_up_6&#45;&gt;layer7_ffn_act_6 -->
<g id="edge691" class="edge">
<title>layer7_ffn_up_6&#45;&gt;layer7_ffn_act_6</title>
<path fill="none" stroke="black" d="M8525.76,-594.89C8471.9,-564.4 8400.21,-523.82 8356.53,-499.1"/>
<polygon fill="black" stroke="black" points="8358.08,-495.95 8347.65,-494.07 8354.63,-502.04 8358.08,-495.95"/>
</g>
<!-- layer7_ffn_up_7&#45;&gt;layer7_ffn_act_7 -->
<g id="edge702" class="edge">
<title>layer7_ffn_up_7&#45;&gt;layer7_ffn_act_7</title>
<path fill="none" stroke="black" d="M9470.88,-594.99C9444.02,-584.97 9414.23,-573.86 9383.97,-562.58"/>
<polygon fill="black" stroke="black" points="9385.17,-559.29 9374.57,-559.07 9382.72,-565.85 9385.17,-559.29"/>
</g>
<!-- layer7_ffn_down_7 -->
<g id="node605" class="node">
<title>layer7_ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="9378,-357 8931,-357 8931,-274 9378,-274 9378,-357"/>
<text text-anchor="middle" x="9154.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9154.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="9154.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9154.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9154.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer7_ffn_act_7&#45;&gt;layer7_ffn_down_7 -->
<g id="edge703" class="edge">
<title>layer7_ffn_act_7&#45;&gt;layer7_ffn_down_7</title>
<path fill="none" stroke="black" d="M9154.5,-392.96C9154.5,-384.25 9154.5,-375.59 9154.5,-367.39"/>
<polygon fill="black" stroke="black" points="9158,-367.29 9154.5,-357.29 9151,-367.29 9158,-367.29"/>
</g>
<!-- layer7_ffn_down_0 -->
<g id="node598" class="node">
<title>layer7_ffn_down_0</title>
<polygon fill="lightblue" stroke="black" points="706,-357 259,-357 259,-274 706,-274 706,-357"/>
<text text-anchor="middle" x="482.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="482.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="482.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="482.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="482.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer7_res2_0 -->
<g id="node611" class="node">
<title>layer7_res2_0</title>
<polygon fill="none" stroke="black" points="540.5,-173 424.5,-173 424.5,-137 540.5,-137 540.5,-173"/>
<text text-anchor="middle" x="482.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_0</text>
</g>
<!-- layer7_ffn_down_0&#45;&gt;layer7_res2_0 -->
<g id="edge627" class="edge">
<title>layer7_ffn_down_0&#45;&gt;layer7_res2_0</title>
<path fill="none" stroke="black" d="M482.5,-273.68C482.5,-245.24 482.5,-208.08 482.5,-183.2"/>
<polygon fill="black" stroke="black" points="486,-183.02 482.5,-173.02 479,-183.02 486,-183.02"/>
</g>
<!-- layer7_ffn_down_1 -->
<g id="node599" class="node">
<title>layer7_ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="1932,-357 1485,-357 1485,-274 1932,-274 1932,-357"/>
<text text-anchor="middle" x="1708.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1708.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="1708.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="1708.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="1708.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer7_res2_1 -->
<g id="node616" class="node">
<title>layer7_res2_1</title>
<polygon fill="none" stroke="black" points="1766.5,-173 1650.5,-173 1650.5,-137 1766.5,-137 1766.5,-173"/>
<text text-anchor="middle" x="1708.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_1</text>
</g>
<!-- layer7_ffn_down_1&#45;&gt;layer7_res2_1 -->
<g id="edge638" class="edge">
<title>layer7_ffn_down_1&#45;&gt;layer7_res2_1</title>
<path fill="none" stroke="black" d="M1708.5,-273.68C1708.5,-245.24 1708.5,-208.08 1708.5,-183.2"/>
<polygon fill="black" stroke="black" points="1712,-183.02 1708.5,-173.02 1705,-183.02 1712,-183.02"/>
</g>
<!-- layer7_ffn_down_2 -->
<g id="node600" class="node">
<title>layer7_ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="3918,-357 3471,-357 3471,-274 3918,-274 3918,-357"/>
<text text-anchor="middle" x="3694.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3694.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="3694.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="3694.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="3694.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer7_res2_2 -->
<g id="node621" class="node">
<title>layer7_res2_2</title>
<polygon fill="none" stroke="black" points="3752.5,-173 3636.5,-173 3636.5,-137 3752.5,-137 3752.5,-173"/>
<text text-anchor="middle" x="3694.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_2</text>
</g>
<!-- layer7_ffn_down_2&#45;&gt;layer7_res2_2 -->
<g id="edge649" class="edge">
<title>layer7_ffn_down_2&#45;&gt;layer7_res2_2</title>
<path fill="none" stroke="black" d="M3694.5,-273.68C3694.5,-245.24 3694.5,-208.08 3694.5,-183.2"/>
<polygon fill="black" stroke="black" points="3698,-183.02 3694.5,-173.02 3691,-183.02 3698,-183.02"/>
</g>
<!-- layer7_ffn_down_3 -->
<g id="node601" class="node">
<title>layer7_ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="4900,-357 4453,-357 4453,-274 4900,-274 4900,-357"/>
<text text-anchor="middle" x="4676.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4676.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="4676.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="4676.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="4676.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer7_res2_3 -->
<g id="node626" class="node">
<title>layer7_res2_3</title>
<polygon fill="none" stroke="black" points="4734.5,-173 4618.5,-173 4618.5,-137 4734.5,-137 4734.5,-173"/>
<text text-anchor="middle" x="4676.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_3</text>
</g>
<!-- layer7_ffn_down_3&#45;&gt;layer7_res2_3 -->
<g id="edge660" class="edge">
<title>layer7_ffn_down_3&#45;&gt;layer7_res2_3</title>
<path fill="none" stroke="black" d="M4676.5,-273.68C4676.5,-245.24 4676.5,-208.08 4676.5,-183.2"/>
<polygon fill="black" stroke="black" points="4680,-183.02 4676.5,-173.02 4673,-183.02 4680,-183.02"/>
</g>
<!-- layer7_ffn_down_4 -->
<g id="node602" class="node">
<title>layer7_ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="6318,-357 5871,-357 5871,-274 6318,-274 6318,-357"/>
<text text-anchor="middle" x="6094.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6094.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="6094.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="6094.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="6094.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer7_res2_4 -->
<g id="node631" class="node">
<title>layer7_res2_4</title>
<polygon fill="none" stroke="black" points="6152.5,-173 6036.5,-173 6036.5,-137 6152.5,-137 6152.5,-173"/>
<text text-anchor="middle" x="6094.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_4</text>
</g>
<!-- layer7_ffn_down_4&#45;&gt;layer7_res2_4 -->
<g id="edge671" class="edge">
<title>layer7_ffn_down_4&#45;&gt;layer7_res2_4</title>
<path fill="none" stroke="black" d="M6094.5,-273.68C6094.5,-245.24 6094.5,-208.08 6094.5,-183.2"/>
<polygon fill="black" stroke="black" points="6098,-183.02 6094.5,-173.02 6091,-183.02 6098,-183.02"/>
</g>
<!-- layer7_ffn_down_5 -->
<g id="node603" class="node">
<title>layer7_ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="7367,-357 6920,-357 6920,-274 7367,-274 7367,-357"/>
<text text-anchor="middle" x="7143.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7143.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="7143.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="7143.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="7143.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer7_res2_5 -->
<g id="node636" class="node">
<title>layer7_res2_5</title>
<polygon fill="none" stroke="black" points="7201.5,-173 7085.5,-173 7085.5,-137 7201.5,-137 7201.5,-173"/>
<text text-anchor="middle" x="7143.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_5</text>
</g>
<!-- layer7_ffn_down_5&#45;&gt;layer7_res2_5 -->
<g id="edge682" class="edge">
<title>layer7_ffn_down_5&#45;&gt;layer7_res2_5</title>
<path fill="none" stroke="black" d="M7143.5,-273.68C7143.5,-245.24 7143.5,-208.08 7143.5,-183.2"/>
<polygon fill="black" stroke="black" points="7147,-183.02 7143.5,-173.02 7140,-183.02 7147,-183.02"/>
</g>
<!-- layer7_ffn_down_6 -->
<g id="node604" class="node">
<title>layer7_ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="8541,-357 8094,-357 8094,-274 8541,-274 8541,-357"/>
<text text-anchor="middle" x="8317.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8317.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="8317.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="8317.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="8317.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer7_res2_6 -->
<g id="node641" class="node">
<title>layer7_res2_6</title>
<polygon fill="none" stroke="black" points="8375.5,-173 8259.5,-173 8259.5,-137 8375.5,-137 8375.5,-173"/>
<text text-anchor="middle" x="8317.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer7_res2_6</text>
</g>
<!-- layer7_ffn_down_6&#45;&gt;layer7_res2_6 -->
<g id="edge693" class="edge">
<title>layer7_ffn_down_6&#45;&gt;layer7_res2_6</title>
<path fill="none" stroke="black" d="M8317.5,-273.68C8317.5,-245.24 8317.5,-208.08 8317.5,-183.2"/>
<polygon fill="black" stroke="black" points="8321,-183.02 8317.5,-173.02 8314,-183.02 8321,-183.02"/>
</g>
<!-- layer7_res2_7 -->
<g id="node606" class="node">
<title>layer7_res2_7</title>
<polygon fill="none" stroke="black" points="9595.24,-238 8894.12,-238 8713.76,-72 9414.88,-72 9595.24,-238"/>
<text text-anchor="middle" x="9154.5" y="-181.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9154.5" y="-166.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9154.5" y="-151.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9154.5" y="-136.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9154.5" y="-121.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer7_ffn_down_7&#45;&gt;layer7_res2_7 -->
<g id="edge704" class="edge">
<title>layer7_ffn_down_7&#45;&gt;layer7_res2_7</title>
<path fill="none" stroke="black" d="M9154.5,-273.68C9154.5,-265.75 9154.5,-257.14 9154.5,-248.31"/>
<polygon fill="black" stroke="black" points="9158,-248.27 9154.5,-238.27 9151,-248.27 9158,-248.27"/>
</g>
<!-- layer7_mha_attn_0&#45;&gt;layer7_mha_out_0 -->
<g id="edge619" class="edge">
<title>layer7_mha_attn_0&#45;&gt;layer7_mha_out_0</title>
<path fill="none" stroke="black" d="M666.5,-1203.74C666.5,-1182.18 666.5,-1144.37 666.5,-1113.29"/>
<polygon fill="black" stroke="black" points="670,-1113.04 666.5,-1103.04 663,-1113.04 670,-1113.04"/>
</g>
<!-- layer7_ln1_0 -->
<g id="node609" class="node">
<title>layer7_ln1_0</title>
<polygon fill="none" stroke="black" points="720,-766 613,-766 613,-730 720,-730 720,-766"/>
<text text-anchor="middle" x="666.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_0</text>
</g>
<!-- layer7_res1_0&#45;&gt;layer7_ln1_0 -->
<g id="edge621" class="edge">
<title>layer7_res1_0&#45;&gt;layer7_ln1_0</title>
<path fill="none" stroke="black" d="M666.5,-882.97C666.5,-857.03 666.5,-807.36 666.5,-776.33"/>
<polygon fill="black" stroke="black" points="670,-776.2 666.5,-766.2 663,-776.2 670,-776.2"/>
</g>
<!-- layer7_ln1_0&#45;&gt;layer7_ffn_gate_0 -->
<g id="edge622" class="edge">
<title>layer7_ln1_0&#45;&gt;layer7_ffn_gate_0</title>
<path fill="none" stroke="black" d="M612.91,-733.35C560.98,-720.13 479.46,-699.37 405.53,-680.54"/>
<polygon fill="black" stroke="black" points="406.18,-677.1 395.63,-678.02 404.45,-683.88 406.18,-677.1"/>
</g>
<!-- layer7_ln1_0&#45;&gt;layer7_ffn_up_0 -->
<g id="edge623" class="edge">
<title>layer7_ln1_0&#45;&gt;layer7_ffn_up_0</title>
<path fill="none" stroke="black" d="M676.03,-729.89C682.47,-718.33 691.34,-702.42 699.89,-687.06"/>
<polygon fill="black" stroke="black" points="703.06,-688.56 704.87,-678.12 696.95,-685.15 703.06,-688.56"/>
</g>
<!-- layer7_ffn_act_0&#45;&gt;layer7_ffn_down_0 -->
<g id="edge626" class="edge">
<title>layer7_ffn_act_0&#45;&gt;layer7_ffn_down_0</title>
<path fill="none" stroke="black" d="M482.5,-457.74C482.5,-436.18 482.5,-398.37 482.5,-367.29"/>
<polygon fill="black" stroke="black" points="486,-367.04 482.5,-357.04 479,-367.04 486,-367.04"/>
</g>
<!-- layer7_mha_attn_1&#45;&gt;layer7_mha_out_1 -->
<g id="edge630" class="edge">
<title>layer7_mha_attn_1&#45;&gt;layer7_mha_out_1</title>
<path fill="none" stroke="black" d="M1768.5,-1203.74C1768.5,-1182.18 1768.5,-1144.37 1768.5,-1113.29"/>
<polygon fill="black" stroke="black" points="1772,-1113.04 1768.5,-1103.04 1765,-1113.04 1772,-1113.04"/>
</g>
<!-- layer7_ln1_1 -->
<g id="node614" class="node">
<title>layer7_ln1_1</title>
<polygon fill="none" stroke="black" points="1822,-766 1715,-766 1715,-730 1822,-730 1822,-766"/>
<text text-anchor="middle" x="1768.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_1</text>
</g>
<!-- layer7_res1_1&#45;&gt;layer7_ln1_1 -->
<g id="edge632" class="edge">
<title>layer7_res1_1&#45;&gt;layer7_ln1_1</title>
<path fill="none" stroke="black" d="M1768.5,-882.97C1768.5,-857.03 1768.5,-807.36 1768.5,-776.33"/>
<polygon fill="black" stroke="black" points="1772,-776.2 1768.5,-766.2 1765,-776.2 1772,-776.2"/>
</g>
<!-- layer7_ln1_1&#45;&gt;layer7_ffn_gate_1 -->
<g id="edge633" class="edge">
<title>layer7_ln1_1&#45;&gt;layer7_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1720.84,-729.89C1684.64,-716.89 1633.15,-698.41 1585.74,-681.38"/>
<polygon fill="black" stroke="black" points="1586.91,-678.09 1576.31,-678 1584.54,-684.67 1586.91,-678.09"/>
</g>
<!-- layer7_ln1_1&#45;&gt;layer7_ffn_up_1 -->
<g id="edge634" class="edge">
<title>layer7_ln1_1&#45;&gt;layer7_ffn_up_1</title>
<path fill="none" stroke="black" d="M1797.56,-729.89C1818.86,-717.35 1848.83,-699.71 1876.87,-683.2"/>
<polygon fill="black" stroke="black" points="1878.66,-686.21 1885.5,-678.12 1875.11,-680.18 1878.66,-686.21"/>
</g>
<!-- layer7_ffn_act_1&#45;&gt;layer7_ffn_down_1 -->
<g id="edge637" class="edge">
<title>layer7_ffn_act_1&#45;&gt;layer7_ffn_down_1</title>
<path fill="none" stroke="black" d="M1708.5,-457.74C1708.5,-436.18 1708.5,-398.37 1708.5,-367.29"/>
<polygon fill="black" stroke="black" points="1712,-367.04 1708.5,-357.04 1705,-367.04 1712,-367.04"/>
</g>
<!-- layer7_mha_attn_2&#45;&gt;layer7_mha_out_2 -->
<g id="edge641" class="edge">
<title>layer7_mha_attn_2&#45;&gt;layer7_mha_out_2</title>
<path fill="none" stroke="black" d="M3631.5,-1203.74C3631.5,-1182.18 3631.5,-1144.37 3631.5,-1113.29"/>
<polygon fill="black" stroke="black" points="3635,-1113.04 3631.5,-1103.04 3628,-1113.04 3635,-1113.04"/>
</g>
<!-- layer7_ln1_2 -->
<g id="node619" class="node">
<title>layer7_ln1_2</title>
<polygon fill="none" stroke="black" points="3685,-766 3578,-766 3578,-730 3685,-730 3685,-766"/>
<text text-anchor="middle" x="3631.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_2</text>
</g>
<!-- layer7_res1_2&#45;&gt;layer7_ln1_2 -->
<g id="edge643" class="edge">
<title>layer7_res1_2&#45;&gt;layer7_ln1_2</title>
<path fill="none" stroke="black" d="M3631.5,-882.97C3631.5,-857.03 3631.5,-807.36 3631.5,-776.33"/>
<polygon fill="black" stroke="black" points="3635,-776.2 3631.5,-766.2 3628,-776.2 3635,-776.2"/>
</g>
<!-- layer7_ln1_2&#45;&gt;layer7_ffn_gate_2 -->
<g id="edge644" class="edge">
<title>layer7_ln1_2&#45;&gt;layer7_ffn_gate_2</title>
<path fill="none" stroke="black" d="M3603.06,-729.89C3582.31,-717.41 3553.15,-699.86 3525.81,-683.41"/>
<polygon fill="black" stroke="black" points="3527.38,-680.27 3517.01,-678.12 3523.78,-686.27 3527.38,-680.27"/>
</g>
<!-- layer7_ln1_2&#45;&gt;layer7_ffn_up_2 -->
<g id="edge645" class="edge">
<title>layer7_ln1_2&#45;&gt;layer7_ffn_up_2</title>
<path fill="none" stroke="black" d="M3679.78,-729.89C3716.46,-716.89 3768.62,-698.41 3816.66,-681.38"/>
<polygon fill="black" stroke="black" points="3817.95,-684.64 3826.21,-678 3815.61,-678.04 3817.95,-684.64"/>
</g>
<!-- layer7_ffn_act_2&#45;&gt;layer7_ffn_down_2 -->
<g id="edge648" class="edge">
<title>layer7_ffn_act_2&#45;&gt;layer7_ffn_down_2</title>
<path fill="none" stroke="black" d="M3694.5,-457.74C3694.5,-436.18 3694.5,-398.37 3694.5,-367.29"/>
<polygon fill="black" stroke="black" points="3698,-367.04 3694.5,-357.04 3691,-367.04 3698,-367.04"/>
</g>
<!-- layer7_mha_attn_3&#45;&gt;layer7_mha_out_3 -->
<g id="edge652" class="edge">
<title>layer7_mha_attn_3&#45;&gt;layer7_mha_out_3</title>
<path fill="none" stroke="black" d="M4585.5,-1203.74C4585.5,-1182.18 4585.5,-1144.37 4585.5,-1113.29"/>
<polygon fill="black" stroke="black" points="4589,-1113.04 4585.5,-1103.04 4582,-1113.04 4589,-1113.04"/>
</g>
<!-- layer7_ln1_3 -->
<g id="node624" class="node">
<title>layer7_ln1_3</title>
<polygon fill="none" stroke="black" points="4639,-766 4532,-766 4532,-730 4639,-730 4639,-766"/>
<text text-anchor="middle" x="4585.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_3</text>
</g>
<!-- layer7_res1_3&#45;&gt;layer7_ln1_3 -->
<g id="edge654" class="edge">
<title>layer7_res1_3&#45;&gt;layer7_ln1_3</title>
<path fill="none" stroke="black" d="M4585.5,-882.97C4585.5,-857.03 4585.5,-807.36 4585.5,-776.33"/>
<polygon fill="black" stroke="black" points="4589,-776.2 4585.5,-766.2 4582,-776.2 4589,-776.2"/>
</g>
<!-- layer7_ln1_3&#45;&gt;layer7_ffn_gate_3 -->
<g id="edge655" class="edge">
<title>layer7_ln1_3&#45;&gt;layer7_ffn_gate_3</title>
<path fill="none" stroke="black" d="M4561.44,-729.89C4544.11,-717.57 4519.85,-700.32 4496.97,-684.05"/>
<polygon fill="black" stroke="black" points="4498.8,-681.06 4488.63,-678.12 4494.75,-686.77 4498.8,-681.06"/>
</g>
<!-- layer7_ln1_3&#45;&gt;layer7_ffn_up_3 -->
<g id="edge656" class="edge">
<title>layer7_ln1_3&#45;&gt;layer7_ffn_up_3</title>
<path fill="none" stroke="black" d="M4638.16,-729.89C4678.33,-716.84 4735.52,-698.25 4788.09,-681.17"/>
<polygon fill="black" stroke="black" points="4789.42,-684.42 4797.85,-678 4787.26,-677.76 4789.42,-684.42"/>
</g>
<!-- layer7_ffn_act_3&#45;&gt;layer7_ffn_down_3 -->
<g id="edge659" class="edge">
<title>layer7_ffn_act_3&#45;&gt;layer7_ffn_down_3</title>
<path fill="none" stroke="black" d="M4676.5,-457.74C4676.5,-436.18 4676.5,-398.37 4676.5,-367.29"/>
<polygon fill="black" stroke="black" points="4680,-367.04 4676.5,-357.04 4673,-367.04 4680,-367.04"/>
</g>
<!-- layer7_mha_attn_4&#45;&gt;layer7_mha_out_4 -->
<g id="edge663" class="edge">
<title>layer7_mha_attn_4&#45;&gt;layer7_mha_out_4</title>
<path fill="none" stroke="black" d="M6095.5,-1203.74C6095.5,-1182.18 6095.5,-1144.37 6095.5,-1113.29"/>
<polygon fill="black" stroke="black" points="6099,-1113.04 6095.5,-1103.04 6092,-1113.04 6099,-1113.04"/>
</g>
<!-- layer7_ln1_4 -->
<g id="node629" class="node">
<title>layer7_ln1_4</title>
<polygon fill="none" stroke="black" points="6149,-766 6042,-766 6042,-730 6149,-730 6149,-766"/>
<text text-anchor="middle" x="6095.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_4</text>
</g>
<!-- layer7_res1_4&#45;&gt;layer7_ln1_4 -->
<g id="edge665" class="edge">
<title>layer7_res1_4&#45;&gt;layer7_ln1_4</title>
<path fill="none" stroke="black" d="M6095.5,-882.97C6095.5,-857.03 6095.5,-807.36 6095.5,-776.33"/>
<polygon fill="black" stroke="black" points="6099,-776.2 6095.5,-766.2 6092,-776.2 6099,-776.2"/>
</g>
<!-- layer7_ln1_4&#45;&gt;layer7_ffn_gate_4 -->
<g id="edge666" class="edge">
<title>layer7_ln1_4&#45;&gt;layer7_ffn_gate_4</title>
<path fill="none" stroke="black" d="M6057.06,-729.89C6028.35,-717.11 5987.72,-699.02 5950.01,-682.24"/>
<polygon fill="black" stroke="black" points="5951.05,-678.87 5940.49,-678 5948.2,-685.27 5951.05,-678.87"/>
</g>
<!-- layer7_ln1_4&#45;&gt;layer7_ffn_up_4 -->
<g id="edge667" class="edge">
<title>layer7_ln1_4&#45;&gt;layer7_ffn_up_4</title>
<path fill="none" stroke="black" d="M6133.78,-729.89C6162.38,-717.11 6202.85,-699.02 6240.4,-682.24"/>
<polygon fill="black" stroke="black" points="6242.18,-685.28 6249.88,-678 6239.32,-678.89 6242.18,-685.28"/>
</g>
<!-- layer7_ffn_act_4&#45;&gt;layer7_ffn_down_4 -->
<g id="edge670" class="edge">
<title>layer7_ffn_act_4&#45;&gt;layer7_ffn_down_4</title>
<path fill="none" stroke="black" d="M6094.5,-457.74C6094.5,-436.18 6094.5,-398.37 6094.5,-367.29"/>
<polygon fill="black" stroke="black" points="6098,-367.04 6094.5,-357.04 6091,-367.04 6098,-367.04"/>
</g>
<!-- layer7_mha_attn_5&#45;&gt;layer7_mha_out_5 -->
<g id="edge674" class="edge">
<title>layer7_mha_attn_5&#45;&gt;layer7_mha_out_5</title>
<path fill="none" stroke="black" d="M7030.5,-1203.74C7030.5,-1182.18 7030.5,-1144.37 7030.5,-1113.29"/>
<polygon fill="black" stroke="black" points="7034,-1113.04 7030.5,-1103.04 7027,-1113.04 7034,-1113.04"/>
</g>
<!-- layer7_ln1_5 -->
<g id="node634" class="node">
<title>layer7_ln1_5</title>
<polygon fill="none" stroke="black" points="7084,-766 6977,-766 6977,-730 7084,-730 7084,-766"/>
<text text-anchor="middle" x="7030.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_5</text>
</g>
<!-- layer7_res1_5&#45;&gt;layer7_ln1_5 -->
<g id="edge676" class="edge">
<title>layer7_res1_5&#45;&gt;layer7_ln1_5</title>
<path fill="none" stroke="black" d="M7030.5,-882.97C7030.5,-857.03 7030.5,-807.36 7030.5,-776.33"/>
<polygon fill="black" stroke="black" points="7034,-776.2 7030.5,-766.2 7027,-776.2 7034,-776.2"/>
</g>
<!-- layer7_ln1_5&#45;&gt;layer7_ffn_gate_5 -->
<g id="edge677" class="edge">
<title>layer7_ln1_5&#45;&gt;layer7_ffn_gate_5</title>
<path fill="none" stroke="black" d="M7009.88,-729.89C6995.22,-717.73 6974.77,-700.77 6955.39,-684.7"/>
<polygon fill="black" stroke="black" points="6957.4,-681.81 6947.46,-678.12 6952.93,-687.2 6957.4,-681.81"/>
</g>
<!-- layer7_ln1_5&#45;&gt;layer7_ffn_up_5 -->
<g id="edge678" class="edge">
<title>layer7_ln1_5&#45;&gt;layer7_ffn_up_5</title>
<path fill="none" stroke="black" d="M7084.25,-730.61C7127.24,-717.49 7189.57,-698.48 7246.71,-681.05"/>
<polygon fill="black" stroke="black" points="7248.03,-684.31 7256.57,-678.04 7245.99,-677.61 7248.03,-684.31"/>
</g>
<!-- layer7_ffn_act_5&#45;&gt;layer7_ffn_down_5 -->
<g id="edge681" class="edge">
<title>layer7_ffn_act_5&#45;&gt;layer7_ffn_down_5</title>
<path fill="none" stroke="black" d="M7143.5,-457.74C7143.5,-436.18 7143.5,-398.37 7143.5,-367.29"/>
<polygon fill="black" stroke="black" points="7147,-367.04 7143.5,-357.04 7140,-367.04 7147,-367.04"/>
</g>
<!-- layer7_mha_attn_6&#45;&gt;layer7_mha_out_6 -->
<g id="edge685" class="edge">
<title>layer7_mha_attn_6&#45;&gt;layer7_mha_out_6</title>
<path fill="none" stroke="black" d="M8123.5,-1203.74C8123.5,-1182.18 8123.5,-1144.37 8123.5,-1113.29"/>
<polygon fill="black" stroke="black" points="8127,-1113.04 8123.5,-1103.04 8120,-1113.04 8127,-1113.04"/>
</g>
<!-- layer7_ln1_6 -->
<g id="node639" class="node">
<title>layer7_ln1_6</title>
<polygon fill="none" stroke="black" points="8177,-766 8070,-766 8070,-730 8177,-730 8177,-766"/>
<text text-anchor="middle" x="8123.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer7_ln1_6</text>
</g>
<!-- layer7_res1_6&#45;&gt;layer7_ln1_6 -->
<g id="edge687" class="edge">
<title>layer7_res1_6&#45;&gt;layer7_ln1_6</title>
<path fill="none" stroke="black" d="M8123.5,-882.97C8123.5,-857.03 8123.5,-807.36 8123.5,-776.33"/>
<polygon fill="black" stroke="black" points="8127,-776.2 8123.5,-766.2 8120,-776.2 8127,-776.2"/>
</g>
<!-- layer7_ln1_6&#45;&gt;layer7_ffn_gate_6 -->
<g id="edge688" class="edge">
<title>layer7_ln1_6&#45;&gt;layer7_ffn_gate_6</title>
<path fill="none" stroke="black" d="M8120.84,-729.89C8119.1,-718.65 8116.72,-703.31 8114.4,-688.35"/>
<polygon fill="black" stroke="black" points="8117.8,-687.46 8112.81,-678.12 8110.88,-688.54 8117.8,-687.46"/>
</g>
<!-- layer7_ln1_6&#45;&gt;layer7_ffn_up_6 -->
<g id="edge689" class="edge">
<title>layer7_ln1_6&#45;&gt;layer7_ffn_up_6</title>
<path fill="none" stroke="black" d="M8177.41,-734.55C8234.54,-721.35 8327.95,-699.77 8412.2,-680.31"/>
<polygon fill="black" stroke="black" points="8413.21,-683.67 8422.16,-678.01 8411.63,-676.85 8413.21,-683.67"/>
</g>
<!-- layer7_ffn_act_6&#45;&gt;layer7_ffn_down_6 -->
<g id="edge692" class="edge">
<title>layer7_ffn_act_6&#45;&gt;layer7_ffn_down_6</title>
<path fill="none" stroke="black" d="M8317.5,-457.74C8317.5,-436.18 8317.5,-398.37 8317.5,-367.29"/>
<polygon fill="black" stroke="black" points="8321,-367.04 8317.5,-357.04 8314,-367.04 8321,-367.04"/>
</g>
<!-- stage0_to_stage1 -->
<g id="node642" class="node">
<title>stage0_to_stage1</title>
<polygon fill="none" stroke="black" points="9988.54,-11193 9673.5,-11193 9592.46,-11057 9907.5,-11057 9988.54,-11193"/>
<text text-anchor="middle" x="9790.5" y="-11143.8" font-family="Times,serif" font-size="14.00">Cross&#45;Stage Transfer</text>
<text text-anchor="middle" x="9790.5" y="-11128.8" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="9790.5" y="-11113.8" font-family="Times,serif" font-size="14.00">128100004096 BF16</text>
<text text-anchor="middle" x="9790.5" y="-11098.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7  8&#45;15</text>
</g>
<!-- layer8_mha_qkv_8 -->
<g id="node643" class="node">
<title>layer8_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="9931.5,-10979.5 9375.5,-10979.5 9375.5,-10896.5 9931.5,-10896.5 9931.5,-10979.5"/>
<text text-anchor="middle" x="9653.5" y="-10964.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9653.5" y="-10949.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9653.5" y="-10934.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9653.5" y="-10919.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9653.5" y="-10904.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- stage0_to_stage1&#45;&gt;layer8_mha_qkv_8 -->
<g id="edge1411" class="edge">
<title>stage0_to_stage1&#45;&gt;layer8_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9740.85,-11056.95C9723.95,-11034.13 9705.39,-11009.06 9689.74,-10987.93"/>
<polygon fill="black" stroke="black" points="9692.43,-10985.69 9683.67,-10979.74 9686.81,-10989.86 9692.43,-10985.69"/>
</g>
<!-- layer8_mha_attn_8 -->
<g id="node689" class="node">
<title>layer8_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9729,-10795.5 9578,-10795.5 9578,-10759.5 9729,-10759.5 9729,-10795.5"/>
<text text-anchor="middle" x="9653.5" y="-10773.8" font-family="Times,serif" font-size="14.00">layer8_mha_attn_8</text>
</g>
<!-- layer8_mha_qkv_8&#45;&gt;layer8_mha_attn_8 -->
<g id="edge706" class="edge">
<title>layer8_mha_qkv_8&#45;&gt;layer8_mha_attn_8</title>
<path fill="none" stroke="black" d="M9653.5,-10896.18C9653.5,-10867.74 9653.5,-10830.58 9653.5,-10805.7"/>
<polygon fill="black" stroke="black" points="9657,-10805.52 9653.5,-10795.52 9650,-10805.52 9657,-10805.52"/>
</g>
<!-- layer8_mha_qkv_9 -->
<g id="node644" class="node">
<title>layer8_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="11270.5,-11166.5 10714.5,-11166.5 10714.5,-11083.5 11270.5,-11083.5 11270.5,-11166.5"/>
<text text-anchor="middle" x="10992.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10992.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10992.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10992.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10992.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_mha_attn_9 -->
<g id="node695" class="node">
<title>layer8_mha_attn_9</title>
<polygon fill="none" stroke="black" points="11068,-10956 10917,-10956 10917,-10920 11068,-10920 11068,-10956"/>
<text text-anchor="middle" x="10992.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer8_mha_attn_9</text>
</g>
<!-- layer8_mha_qkv_9&#45;&gt;layer8_mha_attn_9 -->
<g id="edge717" class="edge">
<title>layer8_mha_qkv_9&#45;&gt;layer8_mha_attn_9</title>
<path fill="none" stroke="black" d="M10992.5,-11083.4C10992.5,-11047.82 10992.5,-10997.08 10992.5,-10966.19"/>
<polygon fill="black" stroke="black" points="10996,-10966.15 10992.5,-10956.15 10989,-10966.15 10996,-10966.15"/>
</g>
<!-- layer8_mha_qkv_10 -->
<g id="node645" class="node">
<title>layer8_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="12473.5,-11166.5 11917.5,-11166.5 11917.5,-11083.5 12473.5,-11083.5 12473.5,-11166.5"/>
<text text-anchor="middle" x="12195.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12195.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12195.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12195.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12195.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_mha_attn_10 -->
<g id="node701" class="node">
<title>layer8_mha_attn_10</title>
<polygon fill="none" stroke="black" points="12275.5,-10956 12115.5,-10956 12115.5,-10920 12275.5,-10920 12275.5,-10956"/>
<text text-anchor="middle" x="12195.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer8_mha_attn_10</text>
</g>
<!-- layer8_mha_qkv_10&#45;&gt;layer8_mha_attn_10 -->
<g id="edge728" class="edge">
<title>layer8_mha_qkv_10&#45;&gt;layer8_mha_attn_10</title>
<path fill="none" stroke="black" d="M12195.5,-11083.4C12195.5,-11047.82 12195.5,-10997.08 12195.5,-10966.19"/>
<polygon fill="black" stroke="black" points="12199,-10966.15 12195.5,-10956.15 12192,-10966.15 12199,-10966.15"/>
</g>
<!-- layer8_mha_qkv_11 -->
<g id="node646" class="node">
<title>layer8_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="13251.5,-11166.5 12695.5,-11166.5 12695.5,-11083.5 13251.5,-11083.5 13251.5,-11166.5"/>
<text text-anchor="middle" x="12973.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12973.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12973.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12973.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12973.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_mha_attn_11 -->
<g id="node707" class="node">
<title>layer8_mha_attn_11</title>
<polygon fill="none" stroke="black" points="13053.5,-10956 12893.5,-10956 12893.5,-10920 13053.5,-10920 13053.5,-10956"/>
<text text-anchor="middle" x="12973.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer8_mha_attn_11</text>
</g>
<!-- layer8_mha_qkv_11&#45;&gt;layer8_mha_attn_11 -->
<g id="edge739" class="edge">
<title>layer8_mha_qkv_11&#45;&gt;layer8_mha_attn_11</title>
<path fill="none" stroke="black" d="M12973.5,-11083.4C12973.5,-11047.82 12973.5,-10997.08 12973.5,-10966.19"/>
<polygon fill="black" stroke="black" points="12977,-10966.15 12973.5,-10956.15 12970,-10966.15 12977,-10966.15"/>
</g>
<!-- layer8_mha_qkv_12 -->
<g id="node647" class="node">
<title>layer8_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14492.5,-11166.5 13936.5,-11166.5 13936.5,-11083.5 14492.5,-11083.5 14492.5,-11166.5"/>
<text text-anchor="middle" x="14214.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14214.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14214.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14214.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14214.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_mha_attn_12 -->
<g id="node713" class="node">
<title>layer8_mha_attn_12</title>
<polygon fill="none" stroke="black" points="14294.5,-10956 14134.5,-10956 14134.5,-10920 14294.5,-10920 14294.5,-10956"/>
<text text-anchor="middle" x="14214.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer8_mha_attn_12</text>
</g>
<!-- layer8_mha_qkv_12&#45;&gt;layer8_mha_attn_12 -->
<g id="edge750" class="edge">
<title>layer8_mha_qkv_12&#45;&gt;layer8_mha_attn_12</title>
<path fill="none" stroke="black" d="M14214.5,-11083.4C14214.5,-11047.82 14214.5,-10997.08 14214.5,-10966.19"/>
<polygon fill="black" stroke="black" points="14218,-10966.15 14214.5,-10956.15 14211,-10966.15 14218,-10966.15"/>
</g>
<!-- layer8_mha_qkv_13 -->
<g id="node648" class="node">
<title>layer8_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15648.5,-11166.5 15092.5,-11166.5 15092.5,-11083.5 15648.5,-11083.5 15648.5,-11166.5"/>
<text text-anchor="middle" x="15370.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="15370.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15370.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15370.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="15370.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_mha_attn_13 -->
<g id="node719" class="node">
<title>layer8_mha_attn_13</title>
<polygon fill="none" stroke="black" points="15450.5,-10956 15290.5,-10956 15290.5,-10920 15450.5,-10920 15450.5,-10956"/>
<text text-anchor="middle" x="15370.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer8_mha_attn_13</text>
</g>
<!-- layer8_mha_qkv_13&#45;&gt;layer8_mha_attn_13 -->
<g id="edge761" class="edge">
<title>layer8_mha_qkv_13&#45;&gt;layer8_mha_attn_13</title>
<path fill="none" stroke="black" d="M15370.5,-11083.4C15370.5,-11047.82 15370.5,-10997.08 15370.5,-10966.19"/>
<polygon fill="black" stroke="black" points="15374,-10966.15 15370.5,-10956.15 15367,-10966.15 15374,-10966.15"/>
</g>
<!-- layer8_mha_qkv_14 -->
<g id="node649" class="node">
<title>layer8_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16773.5,-11166.5 16217.5,-11166.5 16217.5,-11083.5 16773.5,-11083.5 16773.5,-11166.5"/>
<text text-anchor="middle" x="16495.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16495.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16495.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16495.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16495.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_mha_attn_14 -->
<g id="node725" class="node">
<title>layer8_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16575.5,-10956 16415.5,-10956 16415.5,-10920 16575.5,-10920 16575.5,-10956"/>
<text text-anchor="middle" x="16495.5" y="-10934.3" font-family="Times,serif" font-size="14.00">layer8_mha_attn_14</text>
</g>
<!-- layer8_mha_qkv_14&#45;&gt;layer8_mha_attn_14 -->
<g id="edge772" class="edge">
<title>layer8_mha_qkv_14&#45;&gt;layer8_mha_attn_14</title>
<path fill="none" stroke="black" d="M16495.5,-11083.4C16495.5,-11047.82 16495.5,-10997.08 16495.5,-10966.19"/>
<polygon fill="black" stroke="black" points="16499,-10966.15 16495.5,-10956.15 16492,-10966.15 16499,-10966.15"/>
</g>
<!-- layer8_mha_qkv_15 -->
<g id="node650" class="node">
<title>layer8_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17551.5,-11166.5 16995.5,-11166.5 16995.5,-11083.5 17551.5,-11083.5 17551.5,-11166.5"/>
<text text-anchor="middle" x="17273.5" y="-11151.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="17273.5" y="-11136.3" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17273.5" y="-11121.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-11106.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="17273.5" y="-11091.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_mha_attn_15 -->
<g id="node651" class="node">
<title>layer8_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17750.31,-11021 16991.81,-11021 16796.69,-10855 17555.19,-10855 17750.31,-11021"/>
<text text-anchor="middle" x="17273.5" y="-10964.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17273.5" y="-10949.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="17273.5" y="-10934.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17273.5" y="-10919.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10904.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_mha_qkv_15&#45;&gt;layer8_mha_attn_15 -->
<g id="edge783" class="edge">
<title>layer8_mha_qkv_15&#45;&gt;layer8_mha_attn_15</title>
<path fill="none" stroke="black" d="M17273.5,-11083.4C17273.5,-11067.97 17273.5,-11049.68 17273.5,-11031.4"/>
<polygon fill="black" stroke="black" points="17277,-11031.26 17273.5,-11021.26 17270,-11031.26 17277,-11031.26"/>
</g>
<!-- layer8_mha_out_15 -->
<g id="node659" class="node">
<title>layer8_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17492.5,-10819 17054.5,-10819 17054.5,-10736 17492.5,-10736 17492.5,-10819"/>
<text text-anchor="middle" x="17273.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="17273.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17273.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17273.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_mha_attn_15&#45;&gt;layer8_mha_out_15 -->
<g id="edge784" class="edge">
<title>layer8_mha_attn_15&#45;&gt;layer8_mha_out_15</title>
<path fill="none" stroke="black" d="M17273.5,-10854.96C17273.5,-10846.25 17273.5,-10837.59 17273.5,-10829.39"/>
<polygon fill="black" stroke="black" points="17277,-10829.29 17273.5,-10819.29 17270,-10829.29 17277,-10829.29"/>
</g>
<!-- layer8_mha_out_8 -->
<g id="node652" class="node">
<title>layer8_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="9872.5,-10658.5 9434.5,-10658.5 9434.5,-10575.5 9872.5,-10575.5 9872.5,-10658.5"/>
<text text-anchor="middle" x="9653.5" y="-10643.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9653.5" y="-10628.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9653.5" y="-10613.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9653.5" y="-10598.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9653.5" y="-10583.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_res1_8 -->
<g id="node690" class="node">
<title>layer8_res1_8</title>
<polygon fill="none" stroke="black" points="9711.5,-10482 9595.5,-10482 9595.5,-10446 9711.5,-10446 9711.5,-10482"/>
<text text-anchor="middle" x="9653.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_res1_8</text>
</g>
<!-- layer8_mha_out_8&#45;&gt;layer8_res1_8 -->
<g id="edge708" class="edge">
<title>layer8_mha_out_8&#45;&gt;layer8_res1_8</title>
<path fill="none" stroke="black" d="M9653.5,-10575.14C9653.5,-10548.9 9653.5,-10515.53 9653.5,-10492.44"/>
<polygon fill="black" stroke="black" points="9657,-10492.31 9653.5,-10482.31 9650,-10492.31 9657,-10492.31"/>
</g>
<!-- layer8_mha_out_9 -->
<g id="node653" class="node">
<title>layer8_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="11211.5,-10819 10773.5,-10819 10773.5,-10736 11211.5,-10736 11211.5,-10819"/>
<text text-anchor="middle" x="10992.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10992.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10992.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10992.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10992.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_res1_9 -->
<g id="node696" class="node">
<title>layer8_res1_9</title>
<polygon fill="none" stroke="black" points="11050.5,-10635 10934.5,-10635 10934.5,-10599 11050.5,-10599 11050.5,-10635"/>
<text text-anchor="middle" x="10992.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer8_res1_9</text>
</g>
<!-- layer8_mha_out_9&#45;&gt;layer8_res1_9 -->
<g id="edge719" class="edge">
<title>layer8_mha_out_9&#45;&gt;layer8_res1_9</title>
<path fill="none" stroke="black" d="M10992.5,-10735.68C10992.5,-10707.24 10992.5,-10670.08 10992.5,-10645.2"/>
<polygon fill="black" stroke="black" points="10996,-10645.02 10992.5,-10635.02 10989,-10645.02 10996,-10645.02"/>
</g>
<!-- layer8_mha_out_10 -->
<g id="node654" class="node">
<title>layer8_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="12414.5,-10819 11976.5,-10819 11976.5,-10736 12414.5,-10736 12414.5,-10819"/>
<text text-anchor="middle" x="12195.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12195.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12195.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12195.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12195.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_res1_10 -->
<g id="node702" class="node">
<title>layer8_res1_10</title>
<polygon fill="none" stroke="black" points="12258,-10635 12133,-10635 12133,-10599 12258,-10599 12258,-10635"/>
<text text-anchor="middle" x="12195.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer8_res1_10</text>
</g>
<!-- layer8_mha_out_10&#45;&gt;layer8_res1_10 -->
<g id="edge730" class="edge">
<title>layer8_mha_out_10&#45;&gt;layer8_res1_10</title>
<path fill="none" stroke="black" d="M12195.5,-10735.68C12195.5,-10707.24 12195.5,-10670.08 12195.5,-10645.2"/>
<polygon fill="black" stroke="black" points="12199,-10645.02 12195.5,-10635.02 12192,-10645.02 12199,-10645.02"/>
</g>
<!-- layer8_mha_out_11 -->
<g id="node655" class="node">
<title>layer8_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="13192.5,-10819 12754.5,-10819 12754.5,-10736 13192.5,-10736 13192.5,-10819"/>
<text text-anchor="middle" x="12973.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12973.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12973.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12973.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12973.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_res1_11 -->
<g id="node708" class="node">
<title>layer8_res1_11</title>
<polygon fill="none" stroke="black" points="13036,-10635 12911,-10635 12911,-10599 13036,-10599 13036,-10635"/>
<text text-anchor="middle" x="12973.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer8_res1_11</text>
</g>
<!-- layer8_mha_out_11&#45;&gt;layer8_res1_11 -->
<g id="edge741" class="edge">
<title>layer8_mha_out_11&#45;&gt;layer8_res1_11</title>
<path fill="none" stroke="black" d="M12973.5,-10735.68C12973.5,-10707.24 12973.5,-10670.08 12973.5,-10645.2"/>
<polygon fill="black" stroke="black" points="12977,-10645.02 12973.5,-10635.02 12970,-10645.02 12977,-10645.02"/>
</g>
<!-- layer8_mha_out_12 -->
<g id="node656" class="node">
<title>layer8_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14433.5,-10819 13995.5,-10819 13995.5,-10736 14433.5,-10736 14433.5,-10819"/>
<text text-anchor="middle" x="14214.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14214.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14214.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14214.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14214.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_res1_12 -->
<g id="node714" class="node">
<title>layer8_res1_12</title>
<polygon fill="none" stroke="black" points="14277,-10635 14152,-10635 14152,-10599 14277,-10599 14277,-10635"/>
<text text-anchor="middle" x="14214.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer8_res1_12</text>
</g>
<!-- layer8_mha_out_12&#45;&gt;layer8_res1_12 -->
<g id="edge752" class="edge">
<title>layer8_mha_out_12&#45;&gt;layer8_res1_12</title>
<path fill="none" stroke="black" d="M14214.5,-10735.68C14214.5,-10707.24 14214.5,-10670.08 14214.5,-10645.2"/>
<polygon fill="black" stroke="black" points="14218,-10645.02 14214.5,-10635.02 14211,-10645.02 14218,-10645.02"/>
</g>
<!-- layer8_mha_out_13 -->
<g id="node657" class="node">
<title>layer8_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="15589.5,-10819 15151.5,-10819 15151.5,-10736 15589.5,-10736 15589.5,-10819"/>
<text text-anchor="middle" x="15370.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="15370.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15370.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15370.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15370.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_res1_13 -->
<g id="node720" class="node">
<title>layer8_res1_13</title>
<polygon fill="none" stroke="black" points="15433,-10635 15308,-10635 15308,-10599 15433,-10599 15433,-10635"/>
<text text-anchor="middle" x="15370.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer8_res1_13</text>
</g>
<!-- layer8_mha_out_13&#45;&gt;layer8_res1_13 -->
<g id="edge763" class="edge">
<title>layer8_mha_out_13&#45;&gt;layer8_res1_13</title>
<path fill="none" stroke="black" d="M15370.5,-10735.68C15370.5,-10707.24 15370.5,-10670.08 15370.5,-10645.2"/>
<polygon fill="black" stroke="black" points="15374,-10645.02 15370.5,-10635.02 15367,-10645.02 15374,-10645.02"/>
</g>
<!-- layer8_mha_out_14 -->
<g id="node658" class="node">
<title>layer8_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16714.5,-10819 16276.5,-10819 16276.5,-10736 16714.5,-10736 16714.5,-10819"/>
<text text-anchor="middle" x="16495.5" y="-10803.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16495.5" y="-10788.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16495.5" y="-10773.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16495.5" y="-10758.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16495.5" y="-10743.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_res1_14 -->
<g id="node726" class="node">
<title>layer8_res1_14</title>
<polygon fill="none" stroke="black" points="16558,-10635 16433,-10635 16433,-10599 16558,-10599 16558,-10635"/>
<text text-anchor="middle" x="16495.5" y="-10613.3" font-family="Times,serif" font-size="14.00">layer8_res1_14</text>
</g>
<!-- layer8_mha_out_14&#45;&gt;layer8_res1_14 -->
<g id="edge774" class="edge">
<title>layer8_mha_out_14&#45;&gt;layer8_res1_14</title>
<path fill="none" stroke="black" d="M16495.5,-10735.68C16495.5,-10707.24 16495.5,-10670.08 16495.5,-10645.2"/>
<polygon fill="black" stroke="black" points="16499,-10645.02 16495.5,-10635.02 16492,-10645.02 16499,-10645.02"/>
</g>
<!-- layer8_res1_15 -->
<g id="node660" class="node">
<title>layer8_res1_15</title>
<polygon fill="none" stroke="black" points="17714.24,-10700 17013.12,-10700 16832.76,-10534 17533.88,-10534 17714.24,-10700"/>
<text text-anchor="middle" x="17273.5" y="-10643.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17273.5" y="-10628.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10613.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10598.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10583.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_mha_out_15&#45;&gt;layer8_res1_15 -->
<g id="edge785" class="edge">
<title>layer8_mha_out_15&#45;&gt;layer8_res1_15</title>
<path fill="none" stroke="black" d="M17273.5,-10735.68C17273.5,-10727.75 17273.5,-10719.14 17273.5,-10710.31"/>
<polygon fill="black" stroke="black" points="17277,-10710.27 17273.5,-10700.27 17270,-10710.27 17277,-10710.27"/>
</g>
<!-- layer8_ln1_15 -->
<g id="node661" class="node">
<title>layer8_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17486,-10498 17061,-10498 17061,-10430 17486,-10430 17486,-10498"/>
<text text-anchor="middle" x="17273.5" y="-10482.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="17273.5" y="-10467.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10452.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17273.5" y="-10437.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_res1_15&#45;&gt;layer8_ln1_15 -->
<g id="edge786" class="edge">
<title>layer8_res1_15&#45;&gt;layer8_ln1_15</title>
<path fill="none" stroke="black" d="M17273.5,-10533.87C17273.5,-10525.12 17273.5,-10516.48 17273.5,-10508.45"/>
<polygon fill="black" stroke="black" points="17277,-10508.26 17273.5,-10498.26 17270,-10508.26 17277,-10508.26"/>
</g>
<!-- layer8_ffn_gate_15 -->
<g id="node669" class="node">
<title>layer8_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="17367,-10394 16894,-10394 16894,-10311 17367,-10311 17367,-10394"/>
<text text-anchor="middle" x="17130.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="17130.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17130.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17130.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17130.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_ln1_15&#45;&gt;layer8_ffn_gate_15 -->
<g id="edge787" class="edge">
<title>layer8_ln1_15&#45;&gt;layer8_ffn_gate_15</title>
<path fill="none" stroke="black" d="M17230.21,-10429.85C17218.02,-10420.52 17204.53,-10410.19 17191.52,-10400.23"/>
<polygon fill="black" stroke="black" points="17193.56,-10397.38 17183.49,-10394.08 17189.31,-10402.94 17193.56,-10397.38"/>
</g>
<!-- layer8_ffn_up_15 -->
<g id="node677" class="node">
<title>layer8_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17858,-10394 17385,-10394 17385,-10311 17858,-10311 17858,-10394"/>
<text text-anchor="middle" x="17621.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17621.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17621.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17621.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17621.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_ln1_15&#45;&gt;layer8_ffn_up_15 -->
<g id="edge788" class="edge">
<title>layer8_ln1_15&#45;&gt;layer8_ffn_up_15</title>
<path fill="none" stroke="black" d="M17378.38,-10430C17411.22,-10419.67 17447.98,-10408.1 17482.77,-10397.15"/>
<polygon fill="black" stroke="black" points="17484.04,-10400.42 17492.53,-10394.08 17481.94,-10393.75 17484.04,-10400.42"/>
</g>
<!-- layer8_ffn_gate_8 -->
<g id="node662" class="node">
<title>layer8_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="9644,-10233.5 9171,-10233.5 9171,-10150.5 9644,-10150.5 9644,-10233.5"/>
<text text-anchor="middle" x="9407.5" y="-10218.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9407.5" y="-10203.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9407.5" y="-10188.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9407.5" y="-10173.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9407.5" y="-10158.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_ffn_act_8 -->
<g id="node692" class="node">
<title>layer8_ffn_act_8</title>
<polygon fill="none" stroke="black" points="9747,-10049.5 9616,-10049.5 9616,-10013.5 9747,-10013.5 9747,-10049.5"/>
<text text-anchor="middle" x="9681.5" y="-10027.8" font-family="Times,serif" font-size="14.00">layer8_ffn_act_8</text>
</g>
<!-- layer8_ffn_gate_8&#45;&gt;layer8_ffn_act_8 -->
<g id="edge712" class="edge">
<title>layer8_ffn_gate_8&#45;&gt;layer8_ffn_act_8</title>
<path fill="none" stroke="black" d="M9477.71,-10150.39C9530.4,-10119.9 9600.56,-10079.32 9643.3,-10054.6"/>
<polygon fill="black" stroke="black" points="9645.09,-10057.61 9651.99,-10049.57 9641.58,-10051.55 9645.09,-10057.61"/>
</g>
<!-- layer8_ffn_gate_9 -->
<g id="node663" class="node">
<title>layer8_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10984,-10394 10511,-10394 10511,-10311 10984,-10311 10984,-10394"/>
<text text-anchor="middle" x="10747.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10747.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10747.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10747.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10747.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_ffn_act_9 -->
<g id="node698" class="node">
<title>layer8_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10852,-10210 10721,-10210 10721,-10174 10852,-10174 10852,-10210"/>
<text text-anchor="middle" x="10786.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer8_ffn_act_9</text>
</g>
<!-- layer8_ffn_gate_9&#45;&gt;layer8_ffn_act_9 -->
<g id="edge723" class="edge">
<title>layer8_ffn_gate_9&#45;&gt;layer8_ffn_act_9</title>
<path fill="none" stroke="black" d="M10757.54,-10310.68C10764.57,-10282.11 10773.77,-10244.74 10779.89,-10219.86"/>
<polygon fill="black" stroke="black" points="10783.32,-10220.57 10782.31,-10210.02 10776.52,-10218.9 10783.32,-10220.57"/>
</g>
<!-- layer8_ffn_gate_10 -->
<g id="node664" class="node">
<title>layer8_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="12013,-10394 11540,-10394 11540,-10311 12013,-10311 12013,-10394"/>
<text text-anchor="middle" x="11776.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11776.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11776.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11776.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11776.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_ffn_act_10 -->
<g id="node704" class="node">
<title>layer8_ffn_act_10</title>
<polygon fill="none" stroke="black" points="12066.5,-10210 11926.5,-10210 11926.5,-10174 12066.5,-10174 12066.5,-10210"/>
<text text-anchor="middle" x="11996.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer8_ffn_act_10</text>
</g>
<!-- layer8_ffn_gate_10&#45;&gt;layer8_ffn_act_10 -->
<g id="edge734" class="edge">
<title>layer8_ffn_gate_10&#45;&gt;layer8_ffn_act_10</title>
<path fill="none" stroke="black" d="M11832.87,-10310.89C11874.65,-10280.79 11930.1,-10240.84 11964.53,-10216.03"/>
<polygon fill="black" stroke="black" points="11966.74,-10218.75 11972.81,-10210.07 11962.65,-10213.08 11966.74,-10218.75"/>
</g>
<!-- layer8_ffn_gate_11 -->
<g id="node665" class="node">
<title>layer8_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="13138,-10394 12665,-10394 12665,-10311 13138,-10311 13138,-10394"/>
<text text-anchor="middle" x="12901.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12901.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12901.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12901.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12901.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_ffn_act_11 -->
<g id="node710" class="node">
<title>layer8_ffn_act_11</title>
<polygon fill="none" stroke="black" points="13063.5,-10210 12923.5,-10210 12923.5,-10174 13063.5,-10174 13063.5,-10210"/>
<text text-anchor="middle" x="12993.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer8_ffn_act_11</text>
</g>
<!-- layer8_ffn_gate_11&#45;&gt;layer8_ffn_act_11 -->
<g id="edge745" class="edge">
<title>layer8_ffn_gate_11&#45;&gt;layer8_ffn_act_11</title>
<path fill="none" stroke="black" d="M12925.19,-10310.68C12942,-10281.73 12964.05,-10243.74 12978.48,-10218.87"/>
<polygon fill="black" stroke="black" points="12981.63,-10220.43 12983.62,-10210.02 12975.57,-10216.92 12981.63,-10220.43"/>
</g>
<!-- layer8_ffn_gate_12 -->
<g id="node666" class="node">
<title>layer8_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="14206,-10394 13733,-10394 13733,-10311 14206,-10311 14206,-10394"/>
<text text-anchor="middle" x="13969.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13969.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13969.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13969.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13969.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_ffn_act_12 -->
<g id="node716" class="node">
<title>layer8_ffn_act_12</title>
<polygon fill="none" stroke="black" points="14111.5,-10210 13971.5,-10210 13971.5,-10174 14111.5,-10174 14111.5,-10210"/>
<text text-anchor="middle" x="14041.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer8_ffn_act_12</text>
</g>
<!-- layer8_ffn_gate_12&#45;&gt;layer8_ffn_act_12 -->
<g id="edge756" class="edge">
<title>layer8_ffn_gate_12&#45;&gt;layer8_ffn_act_12</title>
<path fill="none" stroke="black" d="M13988.04,-10310.68C14001.14,-10281.86 14018.3,-10244.08 14029.6,-10219.2"/>
<polygon fill="black" stroke="black" points="14032.82,-10220.58 14033.77,-10210.02 14026.44,-10217.68 14032.82,-10220.58"/>
</g>
<!-- layer8_ffn_gate_13 -->
<g id="node667" class="node">
<title>layer8_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="15362,-10394 14889,-10394 14889,-10311 15362,-10311 15362,-10394"/>
<text text-anchor="middle" x="15125.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15125.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15125.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15125.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15125.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_ffn_act_13 -->
<g id="node722" class="node">
<title>layer8_ffn_act_13</title>
<polygon fill="none" stroke="black" points="15488.5,-10210 15348.5,-10210 15348.5,-10174 15488.5,-10174 15488.5,-10210"/>
<text text-anchor="middle" x="15418.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer8_ffn_act_13</text>
</g>
<!-- layer8_ffn_gate_13&#45;&gt;layer8_ffn_act_13 -->
<g id="edge767" class="edge">
<title>layer8_ffn_gate_13&#45;&gt;layer8_ffn_act_13</title>
<path fill="none" stroke="black" d="M15200.57,-10310.89C15257.05,-10280.34 15332.26,-10239.65 15377.94,-10214.94"/>
<polygon fill="black" stroke="black" points="15379.82,-10217.91 15386.95,-10210.07 15376.49,-10211.75 15379.82,-10217.91"/>
</g>
<!-- layer8_ffn_gate_14 -->
<g id="node668" class="node">
<title>layer8_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="16385,-10394 15912,-10394 15912,-10311 16385,-10311 16385,-10394"/>
<text text-anchor="middle" x="16148.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16148.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16148.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16148.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16148.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_ffn_act_14 -->
<g id="node728" class="node">
<title>layer8_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16277.5,-10210 16137.5,-10210 16137.5,-10174 16277.5,-10174 16277.5,-10210"/>
<text text-anchor="middle" x="16207.5" y="-10188.3" font-family="Times,serif" font-size="14.00">layer8_ffn_act_14</text>
</g>
<!-- layer8_ffn_gate_14&#45;&gt;layer8_ffn_act_14 -->
<g id="edge778" class="edge">
<title>layer8_ffn_gate_14&#45;&gt;layer8_ffn_act_14</title>
<path fill="none" stroke="black" d="M16163.69,-10310.68C16174.38,-10281.98 16188.36,-10244.41 16197.62,-10219.53"/>
<polygon fill="black" stroke="black" points="16200.95,-10220.62 16201.16,-10210.02 16194.39,-10218.17 16200.95,-10220.62"/>
</g>
<!-- layer8_ffn_act_15 -->
<g id="node678" class="node">
<title>layer8_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17921.24,-10275 17164.44,-10275 16969.76,-10109 17726.56,-10109 17921.24,-10275"/>
<text text-anchor="middle" x="17445.5" y="-10218.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="17445.5" y="-10203.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="17445.5" y="-10188.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17445.5" y="-10173.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17445.5" y="-10158.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_ffn_gate_15&#45;&gt;layer8_ffn_act_15 -->
<g id="edge789" class="edge">
<title>layer8_ffn_gate_15&#45;&gt;layer8_ffn_act_15</title>
<path fill="none" stroke="black" d="M17211.21,-10310.89C17230.44,-10301.21 17251.68,-10290.52 17273.3,-10279.65"/>
<polygon fill="black" stroke="black" points="17274.9,-10282.76 17282.25,-10275.14 17271.75,-10276.51 17274.9,-10282.76"/>
</g>
<!-- layer8_ffn_up_8 -->
<g id="node670" class="node">
<title>layer8_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10135,-10233.5 9662,-10233.5 9662,-10150.5 10135,-10150.5 10135,-10233.5"/>
<text text-anchor="middle" x="9898.5" y="-10218.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9898.5" y="-10203.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9898.5" y="-10188.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9898.5" y="-10173.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9898.5" y="-10158.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_ffn_up_8&#45;&gt;layer8_ffn_act_8 -->
<g id="edge713" class="edge">
<title>layer8_ffn_up_8&#45;&gt;layer8_ffn_act_8</title>
<path fill="none" stroke="black" d="M9842.9,-10150.39C9801.69,-10120.29 9746.99,-10080.34 9713.04,-10055.53"/>
<polygon fill="black" stroke="black" points="9715.01,-10052.64 9704.87,-10049.57 9710.88,-10058.29 9715.01,-10052.64"/>
</g>
<!-- layer8_ffn_up_9 -->
<g id="node671" class="node">
<title>layer8_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="11475,-10394 11002,-10394 11002,-10311 11475,-10311 11475,-10394"/>
<text text-anchor="middle" x="11238.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11238.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="11238.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11238.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11238.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_ffn_up_9&#45;&gt;layer8_ffn_act_9 -->
<g id="edge724" class="edge">
<title>layer8_ffn_up_9&#45;&gt;layer8_ffn_act_9</title>
<path fill="none" stroke="black" d="M11122.98,-10310.99C11034.05,-10279.81 10914.84,-10238.01 10844.79,-10213.44"/>
<polygon fill="black" stroke="black" points="10845.84,-10210.1 10835.24,-10210.09 10843.52,-10216.7 10845.84,-10210.1"/>
</g>
<!-- layer8_ffn_up_10 -->
<g id="node672" class="node">
<title>layer8_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12504,-10394 12031,-10394 12031,-10311 12504,-10311 12504,-10394"/>
<text text-anchor="middle" x="12267.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12267.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12267.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12267.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12267.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_ffn_up_10&#45;&gt;layer8_ffn_act_10 -->
<g id="edge735" class="edge">
<title>layer8_ffn_up_10&#45;&gt;layer8_ffn_act_10</title>
<path fill="none" stroke="black" d="M12198.06,-10310.89C12146.05,-10280.47 12076.84,-10239.99 12034.54,-10215.25"/>
<polygon fill="black" stroke="black" points="12036.08,-10212.1 12025.68,-10210.07 12032.55,-10218.14 12036.08,-10212.1"/>
</g>
<!-- layer8_ffn_up_11 -->
<g id="node673" class="node">
<title>layer8_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13629,-10394 13156,-10394 13156,-10311 13629,-10311 13629,-10394"/>
<text text-anchor="middle" x="13392.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13392.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13392.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13392.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13392.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_ffn_up_11&#45;&gt;layer8_ffn_act_11 -->
<g id="edge746" class="edge">
<title>layer8_ffn_up_11&#45;&gt;layer8_ffn_act_11</title>
<path fill="none" stroke="black" d="M13290.52,-10310.99C13212.5,-10280 13108.08,-10238.52 13046.1,-10213.9"/>
<polygon fill="black" stroke="black" points="13047.11,-10210.53 13036.53,-10210.09 13044.53,-10217.04 13047.11,-10210.53"/>
</g>
<!-- layer8_ffn_up_12 -->
<g id="node674" class="node">
<title>layer8_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14697,-10394 14224,-10394 14224,-10311 14697,-10311 14697,-10394"/>
<text text-anchor="middle" x="14460.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14460.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14460.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14460.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14460.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_ffn_up_12&#45;&gt;layer8_ffn_act_12 -->
<g id="edge757" class="edge">
<title>layer8_ffn_up_12&#45;&gt;layer8_ffn_act_12</title>
<path fill="none" stroke="black" d="M14353.41,-10310.99C14271.31,-10279.93 14161.38,-10238.35 14096.34,-10213.74"/>
<polygon fill="black" stroke="black" points="14097.28,-10210.36 14086.68,-10210.09 14094.8,-10216.9 14097.28,-10210.36"/>
</g>
<!-- layer8_ffn_up_13 -->
<g id="node675" class="node">
<title>layer8_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15853,-10394 15380,-10394 15380,-10311 15853,-10311 15853,-10394"/>
<text text-anchor="middle" x="15616.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15616.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15616.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15616.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15616.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_ffn_up_13&#45;&gt;layer8_ffn_act_13 -->
<g id="edge768" class="edge">
<title>layer8_ffn_up_13&#45;&gt;layer8_ffn_act_13</title>
<path fill="none" stroke="black" d="M15565.77,-10310.89C15528.32,-10280.91 15478.68,-10241.18 15447.67,-10216.35"/>
<polygon fill="black" stroke="black" points="15449.82,-10213.59 15439.82,-10210.07 15445.44,-10219.05 15449.82,-10213.59"/>
</g>
<!-- layer8_ffn_up_14 -->
<g id="node676" class="node">
<title>layer8_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16876,-10394 16403,-10394 16403,-10311 16876,-10311 16876,-10394"/>
<text text-anchor="middle" x="16639.5" y="-10378.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16639.5" y="-10363.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16639.5" y="-10348.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16639.5" y="-10333.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16639.5" y="-10318.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_ffn_up_14&#45;&gt;layer8_ffn_act_14 -->
<g id="edge779" class="edge">
<title>layer8_ffn_up_14&#45;&gt;layer8_ffn_act_14</title>
<path fill="none" stroke="black" d="M16529.09,-10310.99C16444.27,-10279.87 16330.63,-10238.18 16263.62,-10213.59"/>
<polygon fill="black" stroke="black" points="16264.68,-10210.25 16254.09,-10210.09 16262.27,-10216.82 16264.68,-10210.25"/>
</g>
<!-- layer8_ffn_up_15&#45;&gt;layer8_ffn_act_15 -->
<g id="edge790" class="edge">
<title>layer8_ffn_up_15&#45;&gt;layer8_ffn_act_15</title>
<path fill="none" stroke="black" d="M17576.18,-10310.68C17566.33,-10301.81 17555.54,-10292.1 17544.52,-10282.17"/>
<polygon fill="black" stroke="black" points="17546.63,-10279.36 17536.86,-10275.27 17541.95,-10284.57 17546.63,-10279.36"/>
</g>
<!-- layer8_ffn_down_15 -->
<g id="node686" class="node">
<title>layer8_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17669,-10073 17222,-10073 17222,-9990 17669,-9990 17669,-10073"/>
<text text-anchor="middle" x="17445.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="17445.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17445.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17445.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17445.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_ffn_act_15&#45;&gt;layer8_ffn_down_15 -->
<g id="edge791" class="edge">
<title>layer8_ffn_act_15&#45;&gt;layer8_ffn_down_15</title>
<path fill="none" stroke="black" d="M17445.5,-10108.96C17445.5,-10100.25 17445.5,-10091.59 17445.5,-10083.39"/>
<polygon fill="black" stroke="black" points="17449,-10083.29 17445.5,-10073.29 17442,-10083.29 17449,-10083.29"/>
</g>
<!-- layer8_ffn_down_8 -->
<g id="node679" class="node">
<title>layer8_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="9905,-9912.5 9458,-9912.5 9458,-9829.5 9905,-9829.5 9905,-9912.5"/>
<text text-anchor="middle" x="9681.5" y="-9897.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9681.5" y="-9882.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9681.5" y="-9867.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9681.5" y="-9852.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9681.5" y="-9837.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_res2_8 -->
<g id="node693" class="node">
<title>layer8_res2_8</title>
<polygon fill="none" stroke="black" points="9739.5,-9728.5 9623.5,-9728.5 9623.5,-9692.5 9739.5,-9692.5 9739.5,-9728.5"/>
<text text-anchor="middle" x="9681.5" y="-9706.8" font-family="Times,serif" font-size="14.00">layer8_res2_8</text>
</g>
<!-- layer8_ffn_down_8&#45;&gt;layer8_res2_8 -->
<g id="edge715" class="edge">
<title>layer8_ffn_down_8&#45;&gt;layer8_res2_8</title>
<path fill="none" stroke="black" d="M9681.5,-9829.18C9681.5,-9800.74 9681.5,-9763.58 9681.5,-9738.7"/>
<polygon fill="black" stroke="black" points="9685,-9738.52 9681.5,-9728.52 9678,-9738.52 9685,-9738.52"/>
</g>
<!-- layer8_ffn_down_9 -->
<g id="node680" class="node">
<title>layer8_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="11010,-10073 10563,-10073 10563,-9990 11010,-9990 11010,-10073"/>
<text text-anchor="middle" x="10786.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10786.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10786.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10786.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10786.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_res2_9 -->
<g id="node699" class="node">
<title>layer8_res2_9</title>
<polygon fill="none" stroke="black" points="10844.5,-9889 10728.5,-9889 10728.5,-9853 10844.5,-9853 10844.5,-9889"/>
<text text-anchor="middle" x="10786.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer8_res2_9</text>
</g>
<!-- layer8_ffn_down_9&#45;&gt;layer8_res2_9 -->
<g id="edge726" class="edge">
<title>layer8_ffn_down_9&#45;&gt;layer8_res2_9</title>
<path fill="none" stroke="black" d="M10786.5,-9989.68C10786.5,-9961.24 10786.5,-9924.08 10786.5,-9899.2"/>
<polygon fill="black" stroke="black" points="10790,-9899.02 10786.5,-9889.02 10783,-9899.02 10790,-9899.02"/>
</g>
<!-- layer8_ffn_down_10 -->
<g id="node681" class="node">
<title>layer8_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="12220,-10073 11773,-10073 11773,-9990 12220,-9990 12220,-10073"/>
<text text-anchor="middle" x="11996.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11996.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11996.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11996.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11996.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_res2_10 -->
<g id="node705" class="node">
<title>layer8_res2_10</title>
<polygon fill="none" stroke="black" points="12059,-9889 11934,-9889 11934,-9853 12059,-9853 12059,-9889"/>
<text text-anchor="middle" x="11996.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer8_res2_10</text>
</g>
<!-- layer8_ffn_down_10&#45;&gt;layer8_res2_10 -->
<g id="edge737" class="edge">
<title>layer8_ffn_down_10&#45;&gt;layer8_res2_10</title>
<path fill="none" stroke="black" d="M11996.5,-9989.68C11996.5,-9961.24 11996.5,-9924.08 11996.5,-9899.2"/>
<polygon fill="black" stroke="black" points="12000,-9899.02 11996.5,-9889.02 11993,-9899.02 12000,-9899.02"/>
</g>
<!-- layer8_ffn_down_11 -->
<g id="node682" class="node">
<title>layer8_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="13217,-10073 12770,-10073 12770,-9990 13217,-9990 13217,-10073"/>
<text text-anchor="middle" x="12993.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12993.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12993.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12993.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12993.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_res2_11 -->
<g id="node711" class="node">
<title>layer8_res2_11</title>
<polygon fill="none" stroke="black" points="13056,-9889 12931,-9889 12931,-9853 13056,-9853 13056,-9889"/>
<text text-anchor="middle" x="12993.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer8_res2_11</text>
</g>
<!-- layer8_ffn_down_11&#45;&gt;layer8_res2_11 -->
<g id="edge748" class="edge">
<title>layer8_ffn_down_11&#45;&gt;layer8_res2_11</title>
<path fill="none" stroke="black" d="M12993.5,-9989.68C12993.5,-9961.24 12993.5,-9924.08 12993.5,-9899.2"/>
<polygon fill="black" stroke="black" points="12997,-9899.02 12993.5,-9889.02 12990,-9899.02 12997,-9899.02"/>
</g>
<!-- layer8_ffn_down_12 -->
<g id="node683" class="node">
<title>layer8_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14265,-10073 13818,-10073 13818,-9990 14265,-9990 14265,-10073"/>
<text text-anchor="middle" x="14041.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14041.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14041.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14041.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14041.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_res2_12 -->
<g id="node717" class="node">
<title>layer8_res2_12</title>
<polygon fill="none" stroke="black" points="14104,-9889 13979,-9889 13979,-9853 14104,-9853 14104,-9889"/>
<text text-anchor="middle" x="14041.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer8_res2_12</text>
</g>
<!-- layer8_ffn_down_12&#45;&gt;layer8_res2_12 -->
<g id="edge759" class="edge">
<title>layer8_ffn_down_12&#45;&gt;layer8_res2_12</title>
<path fill="none" stroke="black" d="M14041.5,-9989.68C14041.5,-9961.24 14041.5,-9924.08 14041.5,-9899.2"/>
<polygon fill="black" stroke="black" points="14045,-9899.02 14041.5,-9889.02 14038,-9899.02 14045,-9899.02"/>
</g>
<!-- layer8_ffn_down_13 -->
<g id="node684" class="node">
<title>layer8_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="15642,-10073 15195,-10073 15195,-9990 15642,-9990 15642,-10073"/>
<text text-anchor="middle" x="15418.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15418.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15418.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="15418.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15418.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_res2_13 -->
<g id="node723" class="node">
<title>layer8_res2_13</title>
<polygon fill="none" stroke="black" points="15481,-9889 15356,-9889 15356,-9853 15481,-9853 15481,-9889"/>
<text text-anchor="middle" x="15418.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer8_res2_13</text>
</g>
<!-- layer8_ffn_down_13&#45;&gt;layer8_res2_13 -->
<g id="edge770" class="edge">
<title>layer8_ffn_down_13&#45;&gt;layer8_res2_13</title>
<path fill="none" stroke="black" d="M15418.5,-9989.68C15418.5,-9961.24 15418.5,-9924.08 15418.5,-9899.2"/>
<polygon fill="black" stroke="black" points="15422,-9899.02 15418.5,-9889.02 15415,-9899.02 15422,-9899.02"/>
</g>
<!-- layer8_ffn_down_14 -->
<g id="node685" class="node">
<title>layer8_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16431,-10073 15984,-10073 15984,-9990 16431,-9990 16431,-10073"/>
<text text-anchor="middle" x="16207.5" y="-10057.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16207.5" y="-10042.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16207.5" y="-10027.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16207.5" y="-10012.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16207.5" y="-9997.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_res2_14 -->
<g id="node729" class="node">
<title>layer8_res2_14</title>
<polygon fill="none" stroke="black" points="16270,-9889 16145,-9889 16145,-9853 16270,-9853 16270,-9889"/>
<text text-anchor="middle" x="16207.5" y="-9867.3" font-family="Times,serif" font-size="14.00">layer8_res2_14</text>
</g>
<!-- layer8_ffn_down_14&#45;&gt;layer8_res2_14 -->
<g id="edge781" class="edge">
<title>layer8_ffn_down_14&#45;&gt;layer8_res2_14</title>
<path fill="none" stroke="black" d="M16207.5,-9989.68C16207.5,-9961.24 16207.5,-9924.08 16207.5,-9899.2"/>
<polygon fill="black" stroke="black" points="16211,-9899.02 16207.5,-9889.02 16204,-9899.02 16211,-9899.02"/>
</g>
<!-- layer8_res2_15 -->
<g id="node687" class="node">
<title>layer8_res2_15</title>
<polygon fill="none" stroke="black" points="17886.24,-9954 17185.12,-9954 17004.76,-9788 17705.88,-9788 17886.24,-9954"/>
<text text-anchor="middle" x="17445.5" y="-9897.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17445.5" y="-9882.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9867.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9852.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9837.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer8_ffn_down_15&#45;&gt;layer8_res2_15 -->
<g id="edge792" class="edge">
<title>layer8_ffn_down_15&#45;&gt;layer8_res2_15</title>
<path fill="none" stroke="black" d="M17445.5,-9989.68C17445.5,-9981.75 17445.5,-9973.14 17445.5,-9964.31"/>
<polygon fill="black" stroke="black" points="17449,-9964.27 17445.5,-9954.27 17442,-9964.27 17449,-9964.27"/>
</g>
<!-- layer9_mha_qkv_15 -->
<g id="node738" class="node">
<title>layer9_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17723.5,-9752 17167.5,-9752 17167.5,-9669 17723.5,-9669 17723.5,-9752"/>
<text text-anchor="middle" x="17445.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="17445.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17445.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="17445.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer8_res2_15&#45;&gt;layer9_mha_qkv_15 -->
<g id="edge870" class="edge">
<title>layer8_res2_15&#45;&gt;layer9_mha_qkv_15</title>
<path fill="none" stroke="black" d="M17445.5,-9787.96C17445.5,-9779.25 17445.5,-9770.59 17445.5,-9762.39"/>
<polygon fill="black" stroke="black" points="17449,-9762.29 17445.5,-9752.29 17442,-9762.29 17449,-9762.29"/>
</g>
<!-- layer7_res2_8 -->
<g id="node688" class="node">
<title>layer7_res2_8</title>
<polygon fill="none" stroke="black" points="9574.5,-11143 9458.5,-11143 9458.5,-11107 9574.5,-11107 9574.5,-11143"/>
<text text-anchor="middle" x="9516.5" y="-11121.3" font-family="Times,serif" font-size="14.00">layer7_res2_8</text>
</g>
<!-- layer7_res2_8&#45;&gt;layer8_mha_qkv_8 -->
<g id="edge705" class="edge">
<title>layer7_res2_8&#45;&gt;layer8_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9529.14,-11106.93C9548.99,-11080.12 9588.21,-11027.16 9617.32,-10987.85"/>
<polygon fill="black" stroke="black" points="9620.23,-10989.8 9623.37,-10979.68 9614.61,-10985.64 9620.23,-10989.8"/>
</g>
<!-- layer8_mha_attn_8&#45;&gt;layer8_mha_out_8 -->
<g id="edge707" class="edge">
<title>layer8_mha_attn_8&#45;&gt;layer8_mha_out_8</title>
<path fill="none" stroke="black" d="M9653.5,-10759.24C9653.5,-10737.68 9653.5,-10699.87 9653.5,-10668.79"/>
<polygon fill="black" stroke="black" points="9657,-10668.54 9653.5,-10658.54 9650,-10668.54 9657,-10668.54"/>
</g>
<!-- layer8_ln1_8 -->
<g id="node691" class="node">
<title>layer8_ln1_8</title>
<polygon fill="none" stroke="black" points="9707,-10370.5 9600,-10370.5 9600,-10334.5 9707,-10334.5 9707,-10370.5"/>
<text text-anchor="middle" x="9653.5" y="-10348.8" font-family="Times,serif" font-size="14.00">layer8_ln1_8</text>
</g>
<!-- layer8_res1_8&#45;&gt;layer8_ln1_8 -->
<g id="edge709" class="edge">
<title>layer8_res1_8&#45;&gt;layer8_ln1_8</title>
<path fill="none" stroke="black" d="M9653.5,-10445.89C9653.5,-10428.56 9653.5,-10401.46 9653.5,-10381.09"/>
<polygon fill="black" stroke="black" points="9657,-10380.85 9653.5,-10370.85 9650,-10380.85 9657,-10380.85"/>
</g>
<!-- layer8_ln1_8&#45;&gt;layer8_ffn_gate_8 -->
<g id="edge710" class="edge">
<title>layer8_ln1_8&#45;&gt;layer8_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9626.71,-10334.24C9591.51,-10311.56 9528.37,-10270.88 9478.86,-10238.98"/>
<polygon fill="black" stroke="black" points="9480.72,-10236.01 9470.42,-10233.54 9476.93,-10241.9 9480.72,-10236.01"/>
</g>
<!-- layer8_ln1_8&#45;&gt;layer8_ffn_up_8 -->
<g id="edge711" class="edge">
<title>layer8_ln1_8&#45;&gt;layer8_ffn_up_8</title>
<path fill="none" stroke="black" d="M9680.19,-10334.24C9715.24,-10311.56 9778.12,-10270.88 9827.43,-10238.98"/>
<polygon fill="black" stroke="black" points="9829.34,-10241.91 9835.84,-10233.54 9825.54,-10236.03 9829.34,-10241.91"/>
</g>
<!-- layer8_ffn_act_8&#45;&gt;layer8_ffn_down_8 -->
<g id="edge714" class="edge">
<title>layer8_ffn_act_8&#45;&gt;layer8_ffn_down_8</title>
<path fill="none" stroke="black" d="M9681.5,-10013.24C9681.5,-9991.68 9681.5,-9953.87 9681.5,-9922.79"/>
<polygon fill="black" stroke="black" points="9685,-9922.54 9681.5,-9912.54 9678,-9922.54 9685,-9922.54"/>
</g>
<!-- layer9_mha_qkv_8 -->
<g id="node731" class="node">
<title>layer9_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="9959.5,-9591.5 9403.5,-9591.5 9403.5,-9508.5 9959.5,-9508.5 9959.5,-9591.5"/>
<text text-anchor="middle" x="9681.5" y="-9576.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9681.5" y="-9561.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9681.5" y="-9546.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9681.5" y="-9531.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9681.5" y="-9516.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer8_res2_8&#45;&gt;layer9_mha_qkv_8 -->
<g id="edge793" class="edge">
<title>layer8_res2_8&#45;&gt;layer9_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9681.5,-9692.24C9681.5,-9670.68 9681.5,-9632.87 9681.5,-9601.79"/>
<polygon fill="black" stroke="black" points="9685,-9601.54 9681.5,-9591.54 9678,-9601.54 9685,-9601.54"/>
</g>
<!-- layer7_res2_9 -->
<g id="node694" class="node">
<title>layer7_res2_9</title>
<polygon fill="none" stroke="black" points="11050.5,-11273.87 10934.5,-11273.87 10934.5,-11237.87 11050.5,-11237.87 11050.5,-11273.87"/>
<text text-anchor="middle" x="10992.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_9</text>
</g>
<!-- layer7_res2_9&#45;&gt;layer8_mha_qkv_9 -->
<g id="edge716" class="edge">
<title>layer7_res2_9&#45;&gt;layer8_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10992.5,-11237.76C10992.5,-11222.15 10992.5,-11198.3 10992.5,-11176.63"/>
<polygon fill="black" stroke="black" points="10996,-11176.54 10992.5,-11166.54 10989,-11176.54 10996,-11176.54"/>
</g>
<!-- layer8_mha_attn_9&#45;&gt;layer8_mha_out_9 -->
<g id="edge718" class="edge">
<title>layer8_mha_attn_9&#45;&gt;layer8_mha_out_9</title>
<path fill="none" stroke="black" d="M10992.5,-10919.74C10992.5,-10898.18 10992.5,-10860.37 10992.5,-10829.29"/>
<polygon fill="black" stroke="black" points="10996,-10829.04 10992.5,-10819.04 10989,-10829.04 10996,-10829.04"/>
</g>
<!-- layer8_ln1_9 -->
<g id="node697" class="node">
<title>layer8_ln1_9</title>
<polygon fill="none" stroke="black" points="11046,-10482 10939,-10482 10939,-10446 11046,-10446 11046,-10482"/>
<text text-anchor="middle" x="10992.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_ln1_9</text>
</g>
<!-- layer8_res1_9&#45;&gt;layer8_ln1_9 -->
<g id="edge720" class="edge">
<title>layer8_res1_9&#45;&gt;layer8_ln1_9</title>
<path fill="none" stroke="black" d="M10992.5,-10598.97C10992.5,-10573.03 10992.5,-10523.36 10992.5,-10492.33"/>
<polygon fill="black" stroke="black" points="10996,-10492.2 10992.5,-10482.2 10989,-10492.2 10996,-10492.2"/>
</g>
<!-- layer8_ln1_9&#45;&gt;layer8_ffn_gate_9 -->
<g id="edge721" class="edge">
<title>layer8_ln1_9&#45;&gt;layer8_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10954.22,-10445.89C10925.62,-10433.11 10885.15,-10415.02 10847.6,-10398.24"/>
<polygon fill="black" stroke="black" points="10848.68,-10394.89 10838.12,-10394 10845.82,-10401.28 10848.68,-10394.89"/>
</g>
<!-- layer8_ln1_9&#45;&gt;layer8_ffn_up_9 -->
<g id="edge722" class="edge">
<title>layer8_ln1_9&#45;&gt;layer8_ffn_up_9</title>
<path fill="none" stroke="black" d="M11030.94,-10445.89C11059.65,-10433.11 11100.28,-10415.02 11137.99,-10398.24"/>
<polygon fill="black" stroke="black" points="11139.8,-10401.27 11147.51,-10394 11136.95,-10394.87 11139.8,-10401.27"/>
</g>
<!-- layer8_ffn_act_9&#45;&gt;layer8_ffn_down_9 -->
<g id="edge725" class="edge">
<title>layer8_ffn_act_9&#45;&gt;layer8_ffn_down_9</title>
<path fill="none" stroke="black" d="M10786.5,-10173.74C10786.5,-10152.18 10786.5,-10114.37 10786.5,-10083.29"/>
<polygon fill="black" stroke="black" points="10790,-10083.04 10786.5,-10073.04 10783,-10083.04 10790,-10083.04"/>
</g>
<!-- layer9_mha_qkv_9 -->
<g id="node732" class="node">
<title>layer9_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="11064.5,-9752 10508.5,-9752 10508.5,-9669 11064.5,-9669 11064.5,-9752"/>
<text text-anchor="middle" x="10786.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10786.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10786.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10786.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10786.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer8_res2_9&#45;&gt;layer9_mha_qkv_9 -->
<g id="edge804" class="edge">
<title>layer8_res2_9&#45;&gt;layer9_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10786.5,-9852.74C10786.5,-9831.18 10786.5,-9793.37 10786.5,-9762.29"/>
<polygon fill="black" stroke="black" points="10790,-9762.04 10786.5,-9752.04 10783,-9762.04 10790,-9762.04"/>
</g>
<!-- layer7_res2_10 -->
<g id="node700" class="node">
<title>layer7_res2_10</title>
<polygon fill="none" stroke="black" points="12258,-11273.87 12133,-11273.87 12133,-11237.87 12258,-11237.87 12258,-11273.87"/>
<text text-anchor="middle" x="12195.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_10</text>
</g>
<!-- layer7_res2_10&#45;&gt;layer8_mha_qkv_10 -->
<g id="edge727" class="edge">
<title>layer7_res2_10&#45;&gt;layer8_mha_qkv_10</title>
<path fill="none" stroke="black" d="M12195.5,-11237.76C12195.5,-11222.15 12195.5,-11198.3 12195.5,-11176.63"/>
<polygon fill="black" stroke="black" points="12199,-11176.54 12195.5,-11166.54 12192,-11176.54 12199,-11176.54"/>
</g>
<!-- layer8_mha_attn_10&#45;&gt;layer8_mha_out_10 -->
<g id="edge729" class="edge">
<title>layer8_mha_attn_10&#45;&gt;layer8_mha_out_10</title>
<path fill="none" stroke="black" d="M12195.5,-10919.74C12195.5,-10898.18 12195.5,-10860.37 12195.5,-10829.29"/>
<polygon fill="black" stroke="black" points="12199,-10829.04 12195.5,-10819.04 12192,-10829.04 12199,-10829.04"/>
</g>
<!-- layer8_ln1_10 -->
<g id="node703" class="node">
<title>layer8_ln1_10</title>
<polygon fill="none" stroke="black" points="12253.5,-10482 12137.5,-10482 12137.5,-10446 12253.5,-10446 12253.5,-10482"/>
<text text-anchor="middle" x="12195.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_ln1_10</text>
</g>
<!-- layer8_res1_10&#45;&gt;layer8_ln1_10 -->
<g id="edge731" class="edge">
<title>layer8_res1_10&#45;&gt;layer8_ln1_10</title>
<path fill="none" stroke="black" d="M12195.5,-10598.97C12195.5,-10573.03 12195.5,-10523.36 12195.5,-10492.33"/>
<polygon fill="black" stroke="black" points="12199,-10492.2 12195.5,-10482.2 12192,-10492.2 12199,-10492.2"/>
</g>
<!-- layer8_ln1_10&#45;&gt;layer8_ffn_gate_10 -->
<g id="edge732" class="edge">
<title>layer8_ln1_10&#45;&gt;layer8_ffn_gate_10</title>
<path fill="none" stroke="black" d="M12137.24,-10447.77C12086.56,-10434.53 12010.58,-10414.67 11941.41,-10396.6"/>
<polygon fill="black" stroke="black" points="11942.26,-10393.2 11931.7,-10394.06 11940.49,-10399.97 11942.26,-10393.2"/>
</g>
<!-- layer8_ln1_10&#45;&gt;layer8_ffn_up_10 -->
<g id="edge733" class="edge">
<title>layer8_ln1_10&#45;&gt;layer8_ffn_up_10</title>
<path fill="none" stroke="black" d="M12206.75,-10445.89C12214.43,-10434.22 12225.01,-10418.12 12235.2,-10402.63"/>
<polygon fill="black" stroke="black" points="12238.22,-10404.4 12240.79,-10394.12 12232.37,-10400.55 12238.22,-10404.4"/>
</g>
<!-- layer8_ffn_act_10&#45;&gt;layer8_ffn_down_10 -->
<g id="edge736" class="edge">
<title>layer8_ffn_act_10&#45;&gt;layer8_ffn_down_10</title>
<path fill="none" stroke="black" d="M11996.5,-10173.74C11996.5,-10152.18 11996.5,-10114.37 11996.5,-10083.29"/>
<polygon fill="black" stroke="black" points="12000,-10083.04 11996.5,-10073.04 11993,-10083.04 12000,-10083.04"/>
</g>
<!-- layer9_mha_qkv_10 -->
<g id="node733" class="node">
<title>layer9_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="12274.5,-9752 11718.5,-9752 11718.5,-9669 12274.5,-9669 12274.5,-9752"/>
<text text-anchor="middle" x="11996.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="11996.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11996.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11996.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="11996.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer8_res2_10&#45;&gt;layer9_mha_qkv_10 -->
<g id="edge815" class="edge">
<title>layer8_res2_10&#45;&gt;layer9_mha_qkv_10</title>
<path fill="none" stroke="black" d="M11996.5,-9852.74C11996.5,-9831.18 11996.5,-9793.37 11996.5,-9762.29"/>
<polygon fill="black" stroke="black" points="12000,-9762.04 11996.5,-9752.04 11993,-9762.04 12000,-9762.04"/>
</g>
<!-- layer7_res2_11 -->
<g id="node706" class="node">
<title>layer7_res2_11</title>
<polygon fill="none" stroke="black" points="13036,-11273.87 12911,-11273.87 12911,-11237.87 13036,-11237.87 13036,-11273.87"/>
<text text-anchor="middle" x="12973.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_11</text>
</g>
<!-- layer7_res2_11&#45;&gt;layer8_mha_qkv_11 -->
<g id="edge738" class="edge">
<title>layer7_res2_11&#45;&gt;layer8_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12973.5,-11237.76C12973.5,-11222.15 12973.5,-11198.3 12973.5,-11176.63"/>
<polygon fill="black" stroke="black" points="12977,-11176.54 12973.5,-11166.54 12970,-11176.54 12977,-11176.54"/>
</g>
<!-- layer8_mha_attn_11&#45;&gt;layer8_mha_out_11 -->
<g id="edge740" class="edge">
<title>layer8_mha_attn_11&#45;&gt;layer8_mha_out_11</title>
<path fill="none" stroke="black" d="M12973.5,-10919.74C12973.5,-10898.18 12973.5,-10860.37 12973.5,-10829.29"/>
<polygon fill="black" stroke="black" points="12977,-10829.04 12973.5,-10819.04 12970,-10829.04 12977,-10829.04"/>
</g>
<!-- layer8_ln1_11 -->
<g id="node709" class="node">
<title>layer8_ln1_11</title>
<polygon fill="none" stroke="black" points="13031.5,-10482 12915.5,-10482 12915.5,-10446 13031.5,-10446 13031.5,-10482"/>
<text text-anchor="middle" x="12973.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_ln1_11</text>
</g>
<!-- layer8_res1_11&#45;&gt;layer8_ln1_11 -->
<g id="edge742" class="edge">
<title>layer8_res1_11&#45;&gt;layer8_ln1_11</title>
<path fill="none" stroke="black" d="M12973.5,-10598.97C12973.5,-10573.03 12973.5,-10523.36 12973.5,-10492.33"/>
<polygon fill="black" stroke="black" points="12977,-10492.2 12973.5,-10482.2 12970,-10492.2 12977,-10492.2"/>
</g>
<!-- layer8_ln1_11&#45;&gt;layer8_ffn_gate_11 -->
<g id="edge743" class="edge">
<title>layer8_ln1_11&#45;&gt;layer8_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12962.25,-10445.89C12954.57,-10434.22 12943.99,-10418.12 12933.8,-10402.63"/>
<polygon fill="black" stroke="black" points="12936.63,-10400.55 12928.21,-10394.12 12930.78,-10404.4 12936.63,-10400.55"/>
</g>
<!-- layer8_ln1_11&#45;&gt;layer8_ffn_up_11 -->
<g id="edge744" class="edge">
<title>layer8_ln1_11&#45;&gt;layer8_ffn_up_11</title>
<path fill="none" stroke="black" d="M13031.76,-10447.77C13082.44,-10434.53 13158.42,-10414.67 13227.59,-10396.6"/>
<polygon fill="black" stroke="black" points="13228.51,-10399.97 13237.3,-10394.06 13226.74,-10393.2 13228.51,-10399.97"/>
</g>
<!-- layer8_ffn_act_11&#45;&gt;layer8_ffn_down_11 -->
<g id="edge747" class="edge">
<title>layer8_ffn_act_11&#45;&gt;layer8_ffn_down_11</title>
<path fill="none" stroke="black" d="M12993.5,-10173.74C12993.5,-10152.18 12993.5,-10114.37 12993.5,-10083.29"/>
<polygon fill="black" stroke="black" points="12997,-10083.04 12993.5,-10073.04 12990,-10083.04 12997,-10083.04"/>
</g>
<!-- layer9_mha_qkv_11 -->
<g id="node734" class="node">
<title>layer9_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="13271.5,-9752 12715.5,-9752 12715.5,-9669 13271.5,-9669 13271.5,-9752"/>
<text text-anchor="middle" x="12993.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12993.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12993.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12993.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12993.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer8_res2_11&#45;&gt;layer9_mha_qkv_11 -->
<g id="edge826" class="edge">
<title>layer8_res2_11&#45;&gt;layer9_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12993.5,-9852.74C12993.5,-9831.18 12993.5,-9793.37 12993.5,-9762.29"/>
<polygon fill="black" stroke="black" points="12997,-9762.04 12993.5,-9752.04 12990,-9762.04 12997,-9762.04"/>
</g>
<!-- layer7_res2_12 -->
<g id="node712" class="node">
<title>layer7_res2_12</title>
<polygon fill="none" stroke="black" points="14277,-11273.87 14152,-11273.87 14152,-11237.87 14277,-11237.87 14277,-11273.87"/>
<text text-anchor="middle" x="14214.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_12</text>
</g>
<!-- layer7_res2_12&#45;&gt;layer8_mha_qkv_12 -->
<g id="edge749" class="edge">
<title>layer7_res2_12&#45;&gt;layer8_mha_qkv_12</title>
<path fill="none" stroke="black" d="M14214.5,-11237.76C14214.5,-11222.15 14214.5,-11198.3 14214.5,-11176.63"/>
<polygon fill="black" stroke="black" points="14218,-11176.54 14214.5,-11166.54 14211,-11176.54 14218,-11176.54"/>
</g>
<!-- layer8_mha_attn_12&#45;&gt;layer8_mha_out_12 -->
<g id="edge751" class="edge">
<title>layer8_mha_attn_12&#45;&gt;layer8_mha_out_12</title>
<path fill="none" stroke="black" d="M14214.5,-10919.74C14214.5,-10898.18 14214.5,-10860.37 14214.5,-10829.29"/>
<polygon fill="black" stroke="black" points="14218,-10829.04 14214.5,-10819.04 14211,-10829.04 14218,-10829.04"/>
</g>
<!-- layer8_ln1_12 -->
<g id="node715" class="node">
<title>layer8_ln1_12</title>
<polygon fill="none" stroke="black" points="14272.5,-10482 14156.5,-10482 14156.5,-10446 14272.5,-10446 14272.5,-10482"/>
<text text-anchor="middle" x="14214.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_ln1_12</text>
</g>
<!-- layer8_res1_12&#45;&gt;layer8_ln1_12 -->
<g id="edge753" class="edge">
<title>layer8_res1_12&#45;&gt;layer8_ln1_12</title>
<path fill="none" stroke="black" d="M14214.5,-10598.97C14214.5,-10573.03 14214.5,-10523.36 14214.5,-10492.33"/>
<polygon fill="black" stroke="black" points="14218,-10492.2 14214.5,-10482.2 14211,-10492.2 14218,-10492.2"/>
</g>
<!-- layer8_ln1_12&#45;&gt;layer8_ffn_gate_12 -->
<g id="edge754" class="edge">
<title>layer8_ln1_12&#45;&gt;layer8_ffn_gate_12</title>
<path fill="none" stroke="black" d="M14176.22,-10445.89C14147.62,-10433.11 14107.15,-10415.02 14069.6,-10398.24"/>
<polygon fill="black" stroke="black" points="14070.68,-10394.89 14060.12,-10394 14067.82,-10401.28 14070.68,-10394.89"/>
</g>
<!-- layer8_ln1_12&#45;&gt;layer8_ffn_up_12 -->
<g id="edge755" class="edge">
<title>layer8_ln1_12&#45;&gt;layer8_ffn_up_12</title>
<path fill="none" stroke="black" d="M14252.94,-10445.89C14281.65,-10433.11 14322.28,-10415.02 14359.99,-10398.24"/>
<polygon fill="black" stroke="black" points="14361.8,-10401.27 14369.51,-10394 14358.95,-10394.87 14361.8,-10401.27"/>
</g>
<!-- layer8_ffn_act_12&#45;&gt;layer8_ffn_down_12 -->
<g id="edge758" class="edge">
<title>layer8_ffn_act_12&#45;&gt;layer8_ffn_down_12</title>
<path fill="none" stroke="black" d="M14041.5,-10173.74C14041.5,-10152.18 14041.5,-10114.37 14041.5,-10083.29"/>
<polygon fill="black" stroke="black" points="14045,-10083.04 14041.5,-10073.04 14038,-10083.04 14045,-10083.04"/>
</g>
<!-- layer9_mha_qkv_12 -->
<g id="node735" class="node">
<title>layer9_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14319.5,-9752 13763.5,-9752 13763.5,-9669 14319.5,-9669 14319.5,-9752"/>
<text text-anchor="middle" x="14041.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14041.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14041.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14041.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14041.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer8_res2_12&#45;&gt;layer9_mha_qkv_12 -->
<g id="edge837" class="edge">
<title>layer8_res2_12&#45;&gt;layer9_mha_qkv_12</title>
<path fill="none" stroke="black" d="M14041.5,-9852.74C14041.5,-9831.18 14041.5,-9793.37 14041.5,-9762.29"/>
<polygon fill="black" stroke="black" points="14045,-9762.04 14041.5,-9752.04 14038,-9762.04 14045,-9762.04"/>
</g>
<!-- layer7_res2_13 -->
<g id="node718" class="node">
<title>layer7_res2_13</title>
<polygon fill="none" stroke="black" points="15433,-11273.87 15308,-11273.87 15308,-11237.87 15433,-11237.87 15433,-11273.87"/>
<text text-anchor="middle" x="15370.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_13</text>
</g>
<!-- layer7_res2_13&#45;&gt;layer8_mha_qkv_13 -->
<g id="edge760" class="edge">
<title>layer7_res2_13&#45;&gt;layer8_mha_qkv_13</title>
<path fill="none" stroke="black" d="M15370.5,-11237.76C15370.5,-11222.15 15370.5,-11198.3 15370.5,-11176.63"/>
<polygon fill="black" stroke="black" points="15374,-11176.54 15370.5,-11166.54 15367,-11176.54 15374,-11176.54"/>
</g>
<!-- layer8_mha_attn_13&#45;&gt;layer8_mha_out_13 -->
<g id="edge762" class="edge">
<title>layer8_mha_attn_13&#45;&gt;layer8_mha_out_13</title>
<path fill="none" stroke="black" d="M15370.5,-10919.74C15370.5,-10898.18 15370.5,-10860.37 15370.5,-10829.29"/>
<polygon fill="black" stroke="black" points="15374,-10829.04 15370.5,-10819.04 15367,-10829.04 15374,-10829.04"/>
</g>
<!-- layer8_ln1_13 -->
<g id="node721" class="node">
<title>layer8_ln1_13</title>
<polygon fill="none" stroke="black" points="15428.5,-10482 15312.5,-10482 15312.5,-10446 15428.5,-10446 15428.5,-10482"/>
<text text-anchor="middle" x="15370.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_ln1_13</text>
</g>
<!-- layer8_res1_13&#45;&gt;layer8_ln1_13 -->
<g id="edge764" class="edge">
<title>layer8_res1_13&#45;&gt;layer8_ln1_13</title>
<path fill="none" stroke="black" d="M15370.5,-10598.97C15370.5,-10573.03 15370.5,-10523.36 15370.5,-10492.33"/>
<polygon fill="black" stroke="black" points="15374,-10492.2 15370.5,-10482.2 15367,-10492.2 15374,-10492.2"/>
</g>
<!-- layer8_ln1_13&#45;&gt;layer8_ffn_gate_13 -->
<g id="edge765" class="edge">
<title>layer8_ln1_13&#45;&gt;layer8_ffn_gate_13</title>
<path fill="none" stroke="black" d="M15332.22,-10445.89C15303.62,-10433.11 15263.15,-10415.02 15225.6,-10398.24"/>
<polygon fill="black" stroke="black" points="15226.68,-10394.89 15216.12,-10394 15223.82,-10401.28 15226.68,-10394.89"/>
</g>
<!-- layer8_ln1_13&#45;&gt;layer8_ffn_up_13 -->
<g id="edge766" class="edge">
<title>layer8_ln1_13&#45;&gt;layer8_ffn_up_13</title>
<path fill="none" stroke="black" d="M15408.94,-10445.89C15437.65,-10433.11 15478.28,-10415.02 15515.99,-10398.24"/>
<polygon fill="black" stroke="black" points="15517.8,-10401.27 15525.51,-10394 15514.95,-10394.87 15517.8,-10401.27"/>
</g>
<!-- layer8_ffn_act_13&#45;&gt;layer8_ffn_down_13 -->
<g id="edge769" class="edge">
<title>layer8_ffn_act_13&#45;&gt;layer8_ffn_down_13</title>
<path fill="none" stroke="black" d="M15418.5,-10173.74C15418.5,-10152.18 15418.5,-10114.37 15418.5,-10083.29"/>
<polygon fill="black" stroke="black" points="15422,-10083.04 15418.5,-10073.04 15415,-10083.04 15422,-10083.04"/>
</g>
<!-- layer9_mha_qkv_13 -->
<g id="node736" class="node">
<title>layer9_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15696.5,-9752 15140.5,-9752 15140.5,-9669 15696.5,-9669 15696.5,-9752"/>
<text text-anchor="middle" x="15418.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="15418.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15418.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15418.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="15418.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer8_res2_13&#45;&gt;layer9_mha_qkv_13 -->
<g id="edge848" class="edge">
<title>layer8_res2_13&#45;&gt;layer9_mha_qkv_13</title>
<path fill="none" stroke="black" d="M15418.5,-9852.74C15418.5,-9831.18 15418.5,-9793.37 15418.5,-9762.29"/>
<polygon fill="black" stroke="black" points="15422,-9762.04 15418.5,-9752.04 15415,-9762.04 15422,-9762.04"/>
</g>
<!-- layer7_res2_14 -->
<g id="node724" class="node">
<title>layer7_res2_14</title>
<polygon fill="none" stroke="black" points="16558,-11273.87 16433,-11273.87 16433,-11237.87 16558,-11237.87 16558,-11273.87"/>
<text text-anchor="middle" x="16495.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_14</text>
</g>
<!-- layer7_res2_14&#45;&gt;layer8_mha_qkv_14 -->
<g id="edge771" class="edge">
<title>layer7_res2_14&#45;&gt;layer8_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16495.5,-11237.76C16495.5,-11222.15 16495.5,-11198.3 16495.5,-11176.63"/>
<polygon fill="black" stroke="black" points="16499,-11176.54 16495.5,-11166.54 16492,-11176.54 16499,-11176.54"/>
</g>
<!-- layer8_mha_attn_14&#45;&gt;layer8_mha_out_14 -->
<g id="edge773" class="edge">
<title>layer8_mha_attn_14&#45;&gt;layer8_mha_out_14</title>
<path fill="none" stroke="black" d="M16495.5,-10919.74C16495.5,-10898.18 16495.5,-10860.37 16495.5,-10829.29"/>
<polygon fill="black" stroke="black" points="16499,-10829.04 16495.5,-10819.04 16492,-10829.04 16499,-10829.04"/>
</g>
<!-- layer8_ln1_14 -->
<g id="node727" class="node">
<title>layer8_ln1_14</title>
<polygon fill="none" stroke="black" points="16553.5,-10482 16437.5,-10482 16437.5,-10446 16553.5,-10446 16553.5,-10482"/>
<text text-anchor="middle" x="16495.5" y="-10460.3" font-family="Times,serif" font-size="14.00">layer8_ln1_14</text>
</g>
<!-- layer8_res1_14&#45;&gt;layer8_ln1_14 -->
<g id="edge775" class="edge">
<title>layer8_res1_14&#45;&gt;layer8_ln1_14</title>
<path fill="none" stroke="black" d="M16495.5,-10598.97C16495.5,-10573.03 16495.5,-10523.36 16495.5,-10492.33"/>
<polygon fill="black" stroke="black" points="16499,-10492.2 16495.5,-10482.2 16492,-10492.2 16499,-10492.2"/>
</g>
<!-- layer8_ln1_14&#45;&gt;layer8_ffn_gate_14 -->
<g id="edge776" class="edge">
<title>layer8_ln1_14&#45;&gt;layer8_ffn_gate_14</title>
<path fill="none" stroke="black" d="M16441.28,-10445.89C16399.83,-10432.81 16340.78,-10414.18 16286.56,-10397.07"/>
<polygon fill="black" stroke="black" points="16287.44,-10393.67 16276.85,-10394 16285.33,-10400.35 16287.44,-10393.67"/>
</g>
<!-- layer8_ln1_14&#45;&gt;layer8_ffn_up_14 -->
<g id="edge777" class="edge">
<title>layer8_ln1_14&#45;&gt;layer8_ffn_up_14</title>
<path fill="none" stroke="black" d="M16518,-10445.89C16534.13,-10433.62 16556.69,-10416.47 16578,-10400.27"/>
<polygon fill="black" stroke="black" points="16580.24,-10402.96 16586.08,-10394.12 16576.01,-10397.39 16580.24,-10402.96"/>
</g>
<!-- layer8_ffn_act_14&#45;&gt;layer8_ffn_down_14 -->
<g id="edge780" class="edge">
<title>layer8_ffn_act_14&#45;&gt;layer8_ffn_down_14</title>
<path fill="none" stroke="black" d="M16207.5,-10173.74C16207.5,-10152.18 16207.5,-10114.37 16207.5,-10083.29"/>
<polygon fill="black" stroke="black" points="16211,-10083.04 16207.5,-10073.04 16204,-10083.04 16211,-10083.04"/>
</g>
<!-- layer9_mha_qkv_14 -->
<g id="node737" class="node">
<title>layer9_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16485.5,-9752 15929.5,-9752 15929.5,-9669 16485.5,-9669 16485.5,-9752"/>
<text text-anchor="middle" x="16207.5" y="-9736.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16207.5" y="-9721.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16207.5" y="-9706.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16207.5" y="-9691.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16207.5" y="-9676.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer8_res2_14&#45;&gt;layer9_mha_qkv_14 -->
<g id="edge859" class="edge">
<title>layer8_res2_14&#45;&gt;layer9_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16207.5,-9852.74C16207.5,-9831.18 16207.5,-9793.37 16207.5,-9762.29"/>
<polygon fill="black" stroke="black" points="16211,-9762.04 16207.5,-9752.04 16204,-9762.04 16211,-9762.04"/>
</g>
<!-- layer7_res2_15 -->
<g id="node730" class="node">
<title>layer7_res2_15</title>
<polygon fill="none" stroke="black" points="17336,-11273.87 17211,-11273.87 17211,-11237.87 17336,-11237.87 17336,-11273.87"/>
<text text-anchor="middle" x="17273.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_res2_15</text>
</g>
<!-- layer7_res2_15&#45;&gt;layer8_mha_qkv_15 -->
<g id="edge782" class="edge">
<title>layer7_res2_15&#45;&gt;layer8_mha_qkv_15</title>
<path fill="none" stroke="black" d="M17273.5,-11237.76C17273.5,-11222.15 17273.5,-11198.3 17273.5,-11176.63"/>
<polygon fill="black" stroke="black" points="17277,-11176.54 17273.5,-11166.54 17270,-11176.54 17277,-11176.54"/>
</g>
<!-- layer9_mha_attn_8 -->
<g id="node776" class="node">
<title>layer9_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9757,-9407.5 9606,-9407.5 9606,-9371.5 9757,-9371.5 9757,-9407.5"/>
<text text-anchor="middle" x="9681.5" y="-9385.8" font-family="Times,serif" font-size="14.00">layer9_mha_attn_8</text>
</g>
<!-- layer9_mha_qkv_8&#45;&gt;layer9_mha_attn_8 -->
<g id="edge794" class="edge">
<title>layer9_mha_qkv_8&#45;&gt;layer9_mha_attn_8</title>
<path fill="none" stroke="black" d="M9681.5,-9508.18C9681.5,-9479.74 9681.5,-9442.58 9681.5,-9417.7"/>
<polygon fill="black" stroke="black" points="9685,-9417.52 9681.5,-9407.52 9678,-9417.52 9685,-9417.52"/>
</g>
<!-- layer9_mha_attn_9 -->
<g id="node781" class="node">
<title>layer9_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10862,-9568 10711,-9568 10711,-9532 10862,-9532 10862,-9568"/>
<text text-anchor="middle" x="10786.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer9_mha_attn_9</text>
</g>
<!-- layer9_mha_qkv_9&#45;&gt;layer9_mha_attn_9 -->
<g id="edge805" class="edge">
<title>layer9_mha_qkv_9&#45;&gt;layer9_mha_attn_9</title>
<path fill="none" stroke="black" d="M10786.5,-9668.68C10786.5,-9640.24 10786.5,-9603.08 10786.5,-9578.2"/>
<polygon fill="black" stroke="black" points="10790,-9578.02 10786.5,-9568.02 10783,-9578.02 10790,-9578.02"/>
</g>
<!-- layer9_mha_attn_10 -->
<g id="node786" class="node">
<title>layer9_mha_attn_10</title>
<polygon fill="none" stroke="black" points="12076.5,-9568 11916.5,-9568 11916.5,-9532 12076.5,-9532 12076.5,-9568"/>
<text text-anchor="middle" x="11996.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer9_mha_attn_10</text>
</g>
<!-- layer9_mha_qkv_10&#45;&gt;layer9_mha_attn_10 -->
<g id="edge816" class="edge">
<title>layer9_mha_qkv_10&#45;&gt;layer9_mha_attn_10</title>
<path fill="none" stroke="black" d="M11996.5,-9668.68C11996.5,-9640.24 11996.5,-9603.08 11996.5,-9578.2"/>
<polygon fill="black" stroke="black" points="12000,-9578.02 11996.5,-9568.02 11993,-9578.02 12000,-9578.02"/>
</g>
<!-- layer9_mha_attn_11 -->
<g id="node791" class="node">
<title>layer9_mha_attn_11</title>
<polygon fill="none" stroke="black" points="13073.5,-9568 12913.5,-9568 12913.5,-9532 13073.5,-9532 13073.5,-9568"/>
<text text-anchor="middle" x="12993.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer9_mha_attn_11</text>
</g>
<!-- layer9_mha_qkv_11&#45;&gt;layer9_mha_attn_11 -->
<g id="edge827" class="edge">
<title>layer9_mha_qkv_11&#45;&gt;layer9_mha_attn_11</title>
<path fill="none" stroke="black" d="M12993.5,-9668.68C12993.5,-9640.24 12993.5,-9603.08 12993.5,-9578.2"/>
<polygon fill="black" stroke="black" points="12997,-9578.02 12993.5,-9568.02 12990,-9578.02 12997,-9578.02"/>
</g>
<!-- layer9_mha_attn_12 -->
<g id="node796" class="node">
<title>layer9_mha_attn_12</title>
<polygon fill="none" stroke="black" points="14121.5,-9568 13961.5,-9568 13961.5,-9532 14121.5,-9532 14121.5,-9568"/>
<text text-anchor="middle" x="14041.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer9_mha_attn_12</text>
</g>
<!-- layer9_mha_qkv_12&#45;&gt;layer9_mha_attn_12 -->
<g id="edge838" class="edge">
<title>layer9_mha_qkv_12&#45;&gt;layer9_mha_attn_12</title>
<path fill="none" stroke="black" d="M14041.5,-9668.68C14041.5,-9640.24 14041.5,-9603.08 14041.5,-9578.2"/>
<polygon fill="black" stroke="black" points="14045,-9578.02 14041.5,-9568.02 14038,-9578.02 14045,-9578.02"/>
</g>
<!-- layer9_mha_attn_13 -->
<g id="node801" class="node">
<title>layer9_mha_attn_13</title>
<polygon fill="none" stroke="black" points="15498.5,-9568 15338.5,-9568 15338.5,-9532 15498.5,-9532 15498.5,-9568"/>
<text text-anchor="middle" x="15418.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer9_mha_attn_13</text>
</g>
<!-- layer9_mha_qkv_13&#45;&gt;layer9_mha_attn_13 -->
<g id="edge849" class="edge">
<title>layer9_mha_qkv_13&#45;&gt;layer9_mha_attn_13</title>
<path fill="none" stroke="black" d="M15418.5,-9668.68C15418.5,-9640.24 15418.5,-9603.08 15418.5,-9578.2"/>
<polygon fill="black" stroke="black" points="15422,-9578.02 15418.5,-9568.02 15415,-9578.02 15422,-9578.02"/>
</g>
<!-- layer9_mha_attn_14 -->
<g id="node806" class="node">
<title>layer9_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16287.5,-9568 16127.5,-9568 16127.5,-9532 16287.5,-9532 16287.5,-9568"/>
<text text-anchor="middle" x="16207.5" y="-9546.3" font-family="Times,serif" font-size="14.00">layer9_mha_attn_14</text>
</g>
<!-- layer9_mha_qkv_14&#45;&gt;layer9_mha_attn_14 -->
<g id="edge860" class="edge">
<title>layer9_mha_qkv_14&#45;&gt;layer9_mha_attn_14</title>
<path fill="none" stroke="black" d="M16207.5,-9668.68C16207.5,-9640.24 16207.5,-9603.08 16207.5,-9578.2"/>
<polygon fill="black" stroke="black" points="16211,-9578.02 16207.5,-9568.02 16204,-9578.02 16211,-9578.02"/>
</g>
<!-- layer9_mha_attn_15 -->
<g id="node739" class="node">
<title>layer9_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17922.31,-9633 17163.81,-9633 16968.69,-9467 17727.19,-9467 17922.31,-9633"/>
<text text-anchor="middle" x="17445.5" y="-9576.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17445.5" y="-9561.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="17445.5" y="-9546.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17445.5" y="-9531.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9516.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_mha_qkv_15&#45;&gt;layer9_mha_attn_15 -->
<g id="edge871" class="edge">
<title>layer9_mha_qkv_15&#45;&gt;layer9_mha_attn_15</title>
<path fill="none" stroke="black" d="M17445.5,-9668.68C17445.5,-9660.75 17445.5,-9652.14 17445.5,-9643.31"/>
<polygon fill="black" stroke="black" points="17449,-9643.27 17445.5,-9633.27 17442,-9643.27 17449,-9643.27"/>
</g>
<!-- layer9_mha_out_15 -->
<g id="node747" class="node">
<title>layer9_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17664.5,-9431 17226.5,-9431 17226.5,-9348 17664.5,-9348 17664.5,-9431"/>
<text text-anchor="middle" x="17445.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="17445.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17445.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17445.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_mha_attn_15&#45;&gt;layer9_mha_out_15 -->
<g id="edge872" class="edge">
<title>layer9_mha_attn_15&#45;&gt;layer9_mha_out_15</title>
<path fill="none" stroke="black" d="M17445.5,-9466.96C17445.5,-9458.25 17445.5,-9449.59 17445.5,-9441.39"/>
<polygon fill="black" stroke="black" points="17449,-9441.29 17445.5,-9431.29 17442,-9441.29 17449,-9441.29"/>
</g>
<!-- layer9_mha_out_8 -->
<g id="node740" class="node">
<title>layer9_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="9900.5,-9270.5 9462.5,-9270.5 9462.5,-9187.5 9900.5,-9187.5 9900.5,-9270.5"/>
<text text-anchor="middle" x="9681.5" y="-9255.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9681.5" y="-9240.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9681.5" y="-9225.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9681.5" y="-9210.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9681.5" y="-9195.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_res1_8 -->
<g id="node777" class="node">
<title>layer9_res1_8</title>
<polygon fill="none" stroke="black" points="9739.5,-9094 9623.5,-9094 9623.5,-9058 9739.5,-9058 9739.5,-9094"/>
<text text-anchor="middle" x="9681.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_res1_8</text>
</g>
<!-- layer9_mha_out_8&#45;&gt;layer9_res1_8 -->
<g id="edge796" class="edge">
<title>layer9_mha_out_8&#45;&gt;layer9_res1_8</title>
<path fill="none" stroke="black" d="M9681.5,-9187.14C9681.5,-9160.9 9681.5,-9127.53 9681.5,-9104.44"/>
<polygon fill="black" stroke="black" points="9685,-9104.31 9681.5,-9094.31 9678,-9104.31 9685,-9104.31"/>
</g>
<!-- layer9_mha_out_9 -->
<g id="node741" class="node">
<title>layer9_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="11005.5,-9431 10567.5,-9431 10567.5,-9348 11005.5,-9348 11005.5,-9431"/>
<text text-anchor="middle" x="10786.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10786.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10786.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10786.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10786.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_res1_9 -->
<g id="node782" class="node">
<title>layer9_res1_9</title>
<polygon fill="none" stroke="black" points="10844.5,-9247 10728.5,-9247 10728.5,-9211 10844.5,-9211 10844.5,-9247"/>
<text text-anchor="middle" x="10786.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer9_res1_9</text>
</g>
<!-- layer9_mha_out_9&#45;&gt;layer9_res1_9 -->
<g id="edge807" class="edge">
<title>layer9_mha_out_9&#45;&gt;layer9_res1_9</title>
<path fill="none" stroke="black" d="M10786.5,-9347.68C10786.5,-9319.24 10786.5,-9282.08 10786.5,-9257.2"/>
<polygon fill="black" stroke="black" points="10790,-9257.02 10786.5,-9247.02 10783,-9257.02 10790,-9257.02"/>
</g>
<!-- layer9_mha_out_10 -->
<g id="node742" class="node">
<title>layer9_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="12215.5,-9431 11777.5,-9431 11777.5,-9348 12215.5,-9348 12215.5,-9431"/>
<text text-anchor="middle" x="11996.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="11996.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11996.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11996.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11996.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_res1_10 -->
<g id="node787" class="node">
<title>layer9_res1_10</title>
<polygon fill="none" stroke="black" points="12059,-9247 11934,-9247 11934,-9211 12059,-9211 12059,-9247"/>
<text text-anchor="middle" x="11996.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer9_res1_10</text>
</g>
<!-- layer9_mha_out_10&#45;&gt;layer9_res1_10 -->
<g id="edge818" class="edge">
<title>layer9_mha_out_10&#45;&gt;layer9_res1_10</title>
<path fill="none" stroke="black" d="M11996.5,-9347.68C11996.5,-9319.24 11996.5,-9282.08 11996.5,-9257.2"/>
<polygon fill="black" stroke="black" points="12000,-9257.02 11996.5,-9247.02 11993,-9257.02 12000,-9257.02"/>
</g>
<!-- layer9_mha_out_11 -->
<g id="node743" class="node">
<title>layer9_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="13212.5,-9431 12774.5,-9431 12774.5,-9348 13212.5,-9348 13212.5,-9431"/>
<text text-anchor="middle" x="12993.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12993.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12993.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12993.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12993.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_res1_11 -->
<g id="node792" class="node">
<title>layer9_res1_11</title>
<polygon fill="none" stroke="black" points="13056,-9247 12931,-9247 12931,-9211 13056,-9211 13056,-9247"/>
<text text-anchor="middle" x="12993.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer9_res1_11</text>
</g>
<!-- layer9_mha_out_11&#45;&gt;layer9_res1_11 -->
<g id="edge829" class="edge">
<title>layer9_mha_out_11&#45;&gt;layer9_res1_11</title>
<path fill="none" stroke="black" d="M12993.5,-9347.68C12993.5,-9319.24 12993.5,-9282.08 12993.5,-9257.2"/>
<polygon fill="black" stroke="black" points="12997,-9257.02 12993.5,-9247.02 12990,-9257.02 12997,-9257.02"/>
</g>
<!-- layer9_mha_out_12 -->
<g id="node744" class="node">
<title>layer9_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14260.5,-9431 13822.5,-9431 13822.5,-9348 14260.5,-9348 14260.5,-9431"/>
<text text-anchor="middle" x="14041.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14041.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14041.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14041.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14041.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_res1_12 -->
<g id="node797" class="node">
<title>layer9_res1_12</title>
<polygon fill="none" stroke="black" points="14104,-9247 13979,-9247 13979,-9211 14104,-9211 14104,-9247"/>
<text text-anchor="middle" x="14041.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer9_res1_12</text>
</g>
<!-- layer9_mha_out_12&#45;&gt;layer9_res1_12 -->
<g id="edge840" class="edge">
<title>layer9_mha_out_12&#45;&gt;layer9_res1_12</title>
<path fill="none" stroke="black" d="M14041.5,-9347.68C14041.5,-9319.24 14041.5,-9282.08 14041.5,-9257.2"/>
<polygon fill="black" stroke="black" points="14045,-9257.02 14041.5,-9247.02 14038,-9257.02 14045,-9257.02"/>
</g>
<!-- layer9_mha_out_13 -->
<g id="node745" class="node">
<title>layer9_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="15637.5,-9431 15199.5,-9431 15199.5,-9348 15637.5,-9348 15637.5,-9431"/>
<text text-anchor="middle" x="15418.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="15418.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15418.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15418.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15418.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_res1_13 -->
<g id="node802" class="node">
<title>layer9_res1_13</title>
<polygon fill="none" stroke="black" points="15481,-9247 15356,-9247 15356,-9211 15481,-9211 15481,-9247"/>
<text text-anchor="middle" x="15418.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer9_res1_13</text>
</g>
<!-- layer9_mha_out_13&#45;&gt;layer9_res1_13 -->
<g id="edge851" class="edge">
<title>layer9_mha_out_13&#45;&gt;layer9_res1_13</title>
<path fill="none" stroke="black" d="M15418.5,-9347.68C15418.5,-9319.24 15418.5,-9282.08 15418.5,-9257.2"/>
<polygon fill="black" stroke="black" points="15422,-9257.02 15418.5,-9247.02 15415,-9257.02 15422,-9257.02"/>
</g>
<!-- layer9_mha_out_14 -->
<g id="node746" class="node">
<title>layer9_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16426.5,-9431 15988.5,-9431 15988.5,-9348 16426.5,-9348 16426.5,-9431"/>
<text text-anchor="middle" x="16207.5" y="-9415.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16207.5" y="-9400.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16207.5" y="-9385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16207.5" y="-9370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16207.5" y="-9355.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_res1_14 -->
<g id="node807" class="node">
<title>layer9_res1_14</title>
<polygon fill="none" stroke="black" points="16270,-9247 16145,-9247 16145,-9211 16270,-9211 16270,-9247"/>
<text text-anchor="middle" x="16207.5" y="-9225.3" font-family="Times,serif" font-size="14.00">layer9_res1_14</text>
</g>
<!-- layer9_mha_out_14&#45;&gt;layer9_res1_14 -->
<g id="edge862" class="edge">
<title>layer9_mha_out_14&#45;&gt;layer9_res1_14</title>
<path fill="none" stroke="black" d="M16207.5,-9347.68C16207.5,-9319.24 16207.5,-9282.08 16207.5,-9257.2"/>
<polygon fill="black" stroke="black" points="16211,-9257.02 16207.5,-9247.02 16204,-9257.02 16211,-9257.02"/>
</g>
<!-- layer9_res1_15 -->
<g id="node748" class="node">
<title>layer9_res1_15</title>
<polygon fill="none" stroke="black" points="17886.24,-9312 17185.12,-9312 17004.76,-9146 17705.88,-9146 17886.24,-9312"/>
<text text-anchor="middle" x="17445.5" y="-9255.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17445.5" y="-9240.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9225.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9210.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9195.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_mha_out_15&#45;&gt;layer9_res1_15 -->
<g id="edge873" class="edge">
<title>layer9_mha_out_15&#45;&gt;layer9_res1_15</title>
<path fill="none" stroke="black" d="M17445.5,-9347.68C17445.5,-9339.75 17445.5,-9331.14 17445.5,-9322.31"/>
<polygon fill="black" stroke="black" points="17449,-9322.27 17445.5,-9312.27 17442,-9322.27 17449,-9322.27"/>
</g>
<!-- layer9_ln1_15 -->
<g id="node749" class="node">
<title>layer9_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17658,-9110 17233,-9110 17233,-9042 17658,-9042 17658,-9110"/>
<text text-anchor="middle" x="17445.5" y="-9094.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="17445.5" y="-9079.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9064.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17445.5" y="-9049.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_res1_15&#45;&gt;layer9_ln1_15 -->
<g id="edge874" class="edge">
<title>layer9_res1_15&#45;&gt;layer9_ln1_15</title>
<path fill="none" stroke="black" d="M17445.5,-9145.87C17445.5,-9137.12 17445.5,-9128.48 17445.5,-9120.45"/>
<polygon fill="black" stroke="black" points="17449,-9120.26 17445.5,-9110.26 17442,-9120.26 17449,-9120.26"/>
</g>
<!-- layer9_ffn_gate_15 -->
<g id="node757" class="node">
<title>layer9_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="17507,-9006 17034,-9006 17034,-8923 17507,-8923 17507,-9006"/>
<text text-anchor="middle" x="17270.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="17270.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17270.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17270.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17270.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_ln1_15&#45;&gt;layer9_ffn_gate_15 -->
<g id="edge875" class="edge">
<title>layer9_ln1_15&#45;&gt;layer9_ffn_gate_15</title>
<path fill="none" stroke="black" d="M17392.52,-9041.85C17377.33,-9032.34 17360.48,-9021.8 17344.27,-9011.66"/>
<polygon fill="black" stroke="black" points="17345.69,-9008.42 17335.35,-9006.08 17341.97,-9014.35 17345.69,-9008.42"/>
</g>
<!-- layer9_ffn_up_15 -->
<g id="node765" class="node">
<title>layer9_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17998,-9006 17525,-9006 17525,-8923 17998,-8923 17998,-9006"/>
<text text-anchor="middle" x="17761.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17761.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17761.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17761.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17761.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_ln1_15&#45;&gt;layer9_ffn_up_15 -->
<g id="edge876" class="edge">
<title>layer9_ln1_15&#45;&gt;layer9_ffn_up_15</title>
<path fill="none" stroke="black" d="M17540.74,-9042C17570.3,-9031.75 17603.36,-9020.3 17634.72,-9009.43"/>
<polygon fill="black" stroke="black" points="17636.08,-9012.66 17644.39,-9006.08 17633.79,-9006.05 17636.08,-9012.66"/>
</g>
<!-- layer9_ffn_gate_8 -->
<g id="node750" class="node">
<title>layer9_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="9669,-8845.5 9196,-8845.5 9196,-8762.5 9669,-8762.5 9669,-8845.5"/>
<text text-anchor="middle" x="9432.5" y="-8830.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9432.5" y="-8815.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9432.5" y="-8800.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9432.5" y="-8785.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9432.5" y="-8770.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_ffn_act_8 -->
<g id="node779" class="node">
<title>layer9_ffn_act_8</title>
<polygon fill="none" stroke="black" points="9519,-8661.5 9388,-8661.5 9388,-8625.5 9519,-8625.5 9519,-8661.5"/>
<text text-anchor="middle" x="9453.5" y="-8639.8" font-family="Times,serif" font-size="14.00">layer9_ffn_act_8</text>
</g>
<!-- layer9_ffn_gate_8&#45;&gt;layer9_ffn_act_8 -->
<g id="edge800" class="edge">
<title>layer9_ffn_gate_8&#45;&gt;layer9_ffn_act_8</title>
<path fill="none" stroke="black" d="M9437.91,-8762.18C9441.68,-8733.74 9446.6,-8696.58 9449.9,-8671.7"/>
<polygon fill="black" stroke="black" points="9453.4,-8671.9 9451.24,-8661.52 9446.46,-8670.98 9453.4,-8671.9"/>
</g>
<!-- layer9_ffn_gate_9 -->
<g id="node751" class="node">
<title>layer9_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10922,-9006 10449,-9006 10449,-8923 10922,-8923 10922,-9006"/>
<text text-anchor="middle" x="10685.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10685.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10685.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10685.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10685.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_ffn_act_9 -->
<g id="node784" class="node">
<title>layer9_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10758,-8822 10627,-8822 10627,-8786 10758,-8786 10758,-8822"/>
<text text-anchor="middle" x="10692.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer9_ffn_act_9</text>
</g>
<!-- layer9_ffn_gate_9&#45;&gt;layer9_ffn_act_9 -->
<g id="edge811" class="edge">
<title>layer9_ffn_gate_9&#45;&gt;layer9_ffn_act_9</title>
<path fill="none" stroke="black" d="M10687.3,-8922.68C10688.56,-8894.24 10690.2,-8857.08 10691.3,-8832.2"/>
<polygon fill="black" stroke="black" points="10694.8,-8832.17 10691.75,-8822.02 10687.81,-8831.86 10694.8,-8832.17"/>
</g>
<!-- layer9_ffn_gate_10 -->
<g id="node752" class="node">
<title>layer9_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11921,-9006 11448,-9006 11448,-8923 11921,-8923 11921,-9006"/>
<text text-anchor="middle" x="11684.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11684.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11684.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11684.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11684.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_ffn_act_10 -->
<g id="node789" class="node">
<title>layer9_ffn_act_10</title>
<polygon fill="none" stroke="black" points="11762.5,-8822 11622.5,-8822 11622.5,-8786 11762.5,-8786 11762.5,-8822"/>
<text text-anchor="middle" x="11692.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer9_ffn_act_10</text>
</g>
<!-- layer9_ffn_gate_10&#45;&gt;layer9_ffn_act_10 -->
<g id="edge822" class="edge">
<title>layer9_ffn_gate_10&#45;&gt;layer9_ffn_act_10</title>
<path fill="none" stroke="black" d="M11686.56,-8922.68C11688,-8894.24 11689.87,-8857.08 11691.13,-8832.2"/>
<polygon fill="black" stroke="black" points="11694.63,-8832.19 11691.64,-8822.02 11687.64,-8831.83 11694.63,-8832.19"/>
</g>
<!-- layer9_ffn_gate_11 -->
<g id="node753" class="node">
<title>layer9_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="13031,-9006 12558,-9006 12558,-8923 13031,-8923 13031,-9006"/>
<text text-anchor="middle" x="12794.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12794.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12794.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12794.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12794.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_ffn_act_11 -->
<g id="node794" class="node">
<title>layer9_ffn_act_11</title>
<polygon fill="none" stroke="black" points="13121.5,-8822 12981.5,-8822 12981.5,-8786 13121.5,-8786 13121.5,-8822"/>
<text text-anchor="middle" x="13051.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer9_ffn_act_11</text>
</g>
<!-- layer9_ffn_gate_11&#45;&gt;layer9_ffn_act_11 -->
<g id="edge833" class="edge">
<title>layer9_ffn_gate_11&#45;&gt;layer9_ffn_act_11</title>
<path fill="none" stroke="black" d="M12860.35,-8922.89C12909.57,-8892.53 12975.03,-8852.16 13015.17,-8827.41"/>
<polygon fill="black" stroke="black" points="13017.15,-8830.3 13023.82,-8822.07 13013.47,-8824.34 13017.15,-8830.3"/>
</g>
<!-- layer9_ffn_gate_12 -->
<g id="node754" class="node">
<title>layer9_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="14123,-9006 13650,-9006 13650,-8923 14123,-8923 14123,-9006"/>
<text text-anchor="middle" x="13886.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13886.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13886.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13886.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13886.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_ffn_act_12 -->
<g id="node799" class="node">
<title>layer9_ffn_act_12</title>
<polygon fill="none" stroke="black" points="14220.5,-8822 14080.5,-8822 14080.5,-8786 14220.5,-8786 14220.5,-8822"/>
<text text-anchor="middle" x="14150.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer9_ffn_act_12</text>
</g>
<!-- layer9_ffn_gate_12&#45;&gt;layer9_ffn_act_12 -->
<g id="edge844" class="edge">
<title>layer9_ffn_gate_12&#45;&gt;layer9_ffn_act_12</title>
<path fill="none" stroke="black" d="M13954.14,-8922.89C14004.81,-8892.47 14072.23,-8851.99 14113.44,-8827.25"/>
<polygon fill="black" stroke="black" points="14115.3,-8830.22 14122.07,-8822.07 14111.69,-8824.22 14115.3,-8830.22"/>
</g>
<!-- layer9_ffn_gate_13 -->
<g id="node755" class="node">
<title>layer9_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="15377,-9006 14904,-9006 14904,-8923 15377,-8923 15377,-9006"/>
<text text-anchor="middle" x="15140.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15140.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15140.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15140.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15140.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_ffn_act_13 -->
<g id="node804" class="node">
<title>layer9_ffn_act_13</title>
<polygon fill="none" stroke="black" points="15240.5,-8822 15100.5,-8822 15100.5,-8786 15240.5,-8786 15240.5,-8822"/>
<text text-anchor="middle" x="15170.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer9_ffn_act_13</text>
</g>
<!-- layer9_ffn_gate_13&#45;&gt;layer9_ffn_act_13 -->
<g id="edge855" class="edge">
<title>layer9_ffn_gate_13&#45;&gt;layer9_ffn_act_13</title>
<path fill="none" stroke="black" d="M15148.23,-8922.68C15153.63,-8894.11 15160.71,-8856.74 15165.42,-8831.86"/>
<polygon fill="black" stroke="black" points="15168.86,-8832.5 15167.28,-8822.02 15161.98,-8831.2 15168.86,-8832.5"/>
</g>
<!-- layer9_ffn_gate_14 -->
<g id="node756" class="node">
<title>layer9_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="16381,-9006 15908,-9006 15908,-8923 16381,-8923 16381,-9006"/>
<text text-anchor="middle" x="16144.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16144.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16144.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16144.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16144.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_ffn_act_14 -->
<g id="node809" class="node">
<title>layer9_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16633.5,-8822 16493.5,-8822 16493.5,-8786 16633.5,-8786 16633.5,-8822"/>
<text text-anchor="middle" x="16563.5" y="-8800.3" font-family="Times,serif" font-size="14.00">layer9_ffn_act_14</text>
</g>
<!-- layer9_ffn_gate_14&#45;&gt;layer9_ffn_act_14 -->
<g id="edge866" class="edge">
<title>layer9_ffn_gate_14&#45;&gt;layer9_ffn_act_14</title>
<path fill="none" stroke="black" d="M16251.59,-8922.99C16333.69,-8891.93 16443.62,-8850.35 16508.66,-8825.74"/>
<polygon fill="black" stroke="black" points="16510.2,-8828.9 16518.32,-8822.09 16507.72,-8822.36 16510.2,-8828.9"/>
</g>
<!-- layer9_ffn_act_15 -->
<g id="node766" class="node">
<title>layer9_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17819.24,-8887 17062.44,-8887 16867.76,-8721 17624.56,-8721 17819.24,-8887"/>
<text text-anchor="middle" x="17343.5" y="-8830.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="17343.5" y="-8815.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="17343.5" y="-8800.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17343.5" y="-8785.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17343.5" y="-8770.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_ffn_gate_15&#45;&gt;layer9_ffn_act_15 -->
<g id="edge877" class="edge">
<title>layer9_ffn_gate_15&#45;&gt;layer9_ffn_act_15</title>
<path fill="none" stroke="black" d="M17289.3,-8922.68C17293.07,-8914.5 17297.17,-8905.59 17301.38,-8896.46"/>
<polygon fill="black" stroke="black" points="17304.6,-8897.82 17305.61,-8887.27 17298.25,-8894.89 17304.6,-8897.82"/>
</g>
<!-- layer9_ffn_up_8 -->
<g id="node758" class="node">
<title>layer9_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10160,-8845.5 9687,-8845.5 9687,-8762.5 10160,-8762.5 10160,-8845.5"/>
<text text-anchor="middle" x="9923.5" y="-8830.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9923.5" y="-8815.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9923.5" y="-8800.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9923.5" y="-8785.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9923.5" y="-8770.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_ffn_up_8&#45;&gt;layer9_ffn_act_8 -->
<g id="edge801" class="edge">
<title>layer9_ffn_up_8&#45;&gt;layer9_ffn_act_8</title>
<path fill="none" stroke="black" d="M9803.38,-8762.49C9710.72,-8731.24 9586.45,-8689.33 9513.67,-8664.79"/>
<polygon fill="black" stroke="black" points="9514.78,-8661.47 9504.18,-8661.59 9512.54,-8668.1 9514.78,-8661.47"/>
</g>
<!-- layer9_ffn_up_9 -->
<g id="node759" class="node">
<title>layer9_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="11413,-9006 10940,-9006 10940,-8923 11413,-8923 11413,-9006"/>
<text text-anchor="middle" x="11176.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11176.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="11176.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11176.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11176.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_ffn_up_9&#45;&gt;layer9_ffn_act_9 -->
<g id="edge812" class="edge">
<title>layer9_ffn_up_9&#45;&gt;layer9_ffn_act_9</title>
<path fill="none" stroke="black" d="M11052.8,-8922.99C10957.38,-8891.74 10829.41,-8849.83 10754.46,-8825.29"/>
<polygon fill="black" stroke="black" points="10755.29,-8821.88 10744.69,-8822.09 10753.11,-8828.53 10755.29,-8821.88"/>
</g>
<!-- layer9_ffn_up_10 -->
<g id="node760" class="node">
<title>layer9_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12412,-9006 11939,-9006 11939,-8923 12412,-8923 12412,-9006"/>
<text text-anchor="middle" x="12175.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12175.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12175.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12175.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12175.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_ffn_up_10&#45;&gt;layer9_ffn_act_10 -->
<g id="edge823" class="edge">
<title>layer9_ffn_up_10&#45;&gt;layer9_ffn_act_10</title>
<path fill="none" stroke="black" d="M12052.06,-8922.99C11956.83,-8891.74 11829.12,-8849.83 11754.33,-8825.29"/>
<polygon fill="black" stroke="black" points="11755.18,-8821.88 11744.59,-8822.09 11753,-8828.54 11755.18,-8821.88"/>
</g>
<!-- layer9_ffn_up_11 -->
<g id="node761" class="node">
<title>layer9_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13522,-9006 13049,-9006 13049,-8923 13522,-8923 13522,-9006"/>
<text text-anchor="middle" x="13285.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13285.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13285.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13285.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13285.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_ffn_up_11&#45;&gt;layer9_ffn_act_11 -->
<g id="edge834" class="edge">
<title>layer9_ffn_up_11&#45;&gt;layer9_ffn_act_11</title>
<path fill="none" stroke="black" d="M13225.54,-8922.89C13180.91,-8892.66 13121.62,-8852.5 13085.04,-8827.72"/>
<polygon fill="black" stroke="black" points="13086.94,-8824.78 13076.7,-8822.07 13083.02,-8830.58 13086.94,-8824.78"/>
</g>
<!-- layer9_ffn_up_12 -->
<g id="node762" class="node">
<title>layer9_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14614,-9006 14141,-9006 14141,-8923 14614,-8923 14614,-9006"/>
<text text-anchor="middle" x="14377.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14377.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14377.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14377.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14377.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_ffn_up_12&#45;&gt;layer9_ffn_act_12 -->
<g id="edge845" class="edge">
<title>layer9_ffn_up_12&#45;&gt;layer9_ffn_act_12</title>
<path fill="none" stroke="black" d="M14319.34,-8922.89C14276.23,-8892.79 14219.01,-8852.84 14183.49,-8828.03"/>
<polygon fill="black" stroke="black" points="14185.15,-8824.92 14174.95,-8822.07 14181.14,-8830.66 14185.15,-8824.92"/>
</g>
<!-- layer9_ffn_up_13 -->
<g id="node763" class="node">
<title>layer9_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15868,-9006 15395,-9006 15395,-8923 15868,-8923 15868,-9006"/>
<text text-anchor="middle" x="15631.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15631.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15631.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15631.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15631.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_ffn_up_13&#45;&gt;layer9_ffn_act_13 -->
<g id="edge856" class="edge">
<title>layer9_ffn_up_13&#45;&gt;layer9_ffn_act_13</title>
<path fill="none" stroke="black" d="M15513.68,-8922.99C15422.98,-8891.81 15301.4,-8850.01 15229.95,-8825.44"/>
<polygon fill="black" stroke="black" points="15230.81,-8822.03 15220.21,-8822.09 15228.53,-8828.65 15230.81,-8822.03"/>
</g>
<!-- layer9_ffn_up_14 -->
<g id="node764" class="node">
<title>layer9_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16872,-9006 16399,-9006 16399,-8923 16872,-8923 16872,-9006"/>
<text text-anchor="middle" x="16635.5" y="-8990.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16635.5" y="-8975.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16635.5" y="-8960.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16635.5" y="-8945.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16635.5" y="-8930.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_ffn_up_14&#45;&gt;layer9_ffn_act_14 -->
<g id="edge867" class="edge">
<title>layer9_ffn_up_14&#45;&gt;layer9_ffn_act_14</title>
<path fill="none" stroke="black" d="M16616.96,-8922.68C16603.86,-8893.86 16586.7,-8856.08 16575.4,-8831.2"/>
<polygon fill="black" stroke="black" points="16578.56,-8829.68 16571.23,-8822.02 16572.18,-8832.58 16578.56,-8829.68"/>
</g>
<!-- layer9_ffn_up_15&#45;&gt;layer9_ffn_act_15 -->
<g id="edge878" class="edge">
<title>layer9_ffn_up_15&#45;&gt;layer9_ffn_act_15</title>
<path fill="none" stroke="black" d="M17654.67,-8922.99C17628.37,-8913.02 17599.2,-8901.96 17569.58,-8890.73"/>
<polygon fill="black" stroke="black" points="17570.54,-8887.35 17559.95,-8887.07 17568.06,-8893.89 17570.54,-8887.35"/>
</g>
<!-- layer9_ffn_down_15 -->
<g id="node774" class="node">
<title>layer9_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17567,-8685 17120,-8685 17120,-8602 17567,-8602 17567,-8685"/>
<text text-anchor="middle" x="17343.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="17343.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17343.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17343.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17343.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_ffn_act_15&#45;&gt;layer9_ffn_down_15 -->
<g id="edge879" class="edge">
<title>layer9_ffn_act_15&#45;&gt;layer9_ffn_down_15</title>
<path fill="none" stroke="black" d="M17343.5,-8720.96C17343.5,-8712.25 17343.5,-8703.59 17343.5,-8695.39"/>
<polygon fill="black" stroke="black" points="17347,-8695.29 17343.5,-8685.29 17340,-8695.29 17347,-8695.29"/>
</g>
<!-- layer9_ffn_down_8 -->
<g id="node767" class="node">
<title>layer9_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="9677,-8524.5 9230,-8524.5 9230,-8441.5 9677,-8441.5 9677,-8524.5"/>
<text text-anchor="middle" x="9453.5" y="-8509.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9453.5" y="-8494.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9453.5" y="-8479.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9453.5" y="-8464.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9453.5" y="-8449.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_res2_8 -->
<g id="node780" class="node">
<title>layer9_res2_8</title>
<polygon fill="none" stroke="black" points="9511.5,-8340.5 9395.5,-8340.5 9395.5,-8304.5 9511.5,-8304.5 9511.5,-8340.5"/>
<text text-anchor="middle" x="9453.5" y="-8318.8" font-family="Times,serif" font-size="14.00">layer9_res2_8</text>
</g>
<!-- layer9_ffn_down_8&#45;&gt;layer9_res2_8 -->
<g id="edge803" class="edge">
<title>layer9_ffn_down_8&#45;&gt;layer9_res2_8</title>
<path fill="none" stroke="black" d="M9453.5,-8441.18C9453.5,-8412.74 9453.5,-8375.58 9453.5,-8350.7"/>
<polygon fill="black" stroke="black" points="9457,-8350.52 9453.5,-8340.52 9450,-8350.52 9457,-8350.52"/>
</g>
<!-- layer9_ffn_down_9 -->
<g id="node768" class="node">
<title>layer9_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="10916,-8685 10469,-8685 10469,-8602 10916,-8602 10916,-8685"/>
<text text-anchor="middle" x="10692.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10692.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10692.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10692.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10692.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_res2_9 -->
<g id="node785" class="node">
<title>layer9_res2_9</title>
<polygon fill="none" stroke="black" points="10750.5,-8501 10634.5,-8501 10634.5,-8465 10750.5,-8465 10750.5,-8501"/>
<text text-anchor="middle" x="10692.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer9_res2_9</text>
</g>
<!-- layer9_ffn_down_9&#45;&gt;layer9_res2_9 -->
<g id="edge814" class="edge">
<title>layer9_ffn_down_9&#45;&gt;layer9_res2_9</title>
<path fill="none" stroke="black" d="M10692.5,-8601.68C10692.5,-8573.24 10692.5,-8536.08 10692.5,-8511.2"/>
<polygon fill="black" stroke="black" points="10696,-8511.02 10692.5,-8501.02 10689,-8511.02 10696,-8511.02"/>
</g>
<!-- layer9_ffn_down_10 -->
<g id="node769" class="node">
<title>layer9_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="11916,-8685 11469,-8685 11469,-8602 11916,-8602 11916,-8685"/>
<text text-anchor="middle" x="11692.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11692.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11692.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11692.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11692.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_res2_10 -->
<g id="node790" class="node">
<title>layer9_res2_10</title>
<polygon fill="none" stroke="black" points="11755,-8501 11630,-8501 11630,-8465 11755,-8465 11755,-8501"/>
<text text-anchor="middle" x="11692.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer9_res2_10</text>
</g>
<!-- layer9_ffn_down_10&#45;&gt;layer9_res2_10 -->
<g id="edge825" class="edge">
<title>layer9_ffn_down_10&#45;&gt;layer9_res2_10</title>
<path fill="none" stroke="black" d="M11692.5,-8601.68C11692.5,-8573.24 11692.5,-8536.08 11692.5,-8511.2"/>
<polygon fill="black" stroke="black" points="11696,-8511.02 11692.5,-8501.02 11689,-8511.02 11696,-8511.02"/>
</g>
<!-- layer9_ffn_down_11 -->
<g id="node770" class="node">
<title>layer9_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="13275,-8685 12828,-8685 12828,-8602 13275,-8602 13275,-8685"/>
<text text-anchor="middle" x="13051.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13051.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13051.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13051.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13051.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_res2_11 -->
<g id="node795" class="node">
<title>layer9_res2_11</title>
<polygon fill="none" stroke="black" points="13114,-8501 12989,-8501 12989,-8465 13114,-8465 13114,-8501"/>
<text text-anchor="middle" x="13051.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer9_res2_11</text>
</g>
<!-- layer9_ffn_down_11&#45;&gt;layer9_res2_11 -->
<g id="edge836" class="edge">
<title>layer9_ffn_down_11&#45;&gt;layer9_res2_11</title>
<path fill="none" stroke="black" d="M13051.5,-8601.68C13051.5,-8573.24 13051.5,-8536.08 13051.5,-8511.2"/>
<polygon fill="black" stroke="black" points="13055,-8511.02 13051.5,-8501.02 13048,-8511.02 13055,-8511.02"/>
</g>
<!-- layer9_ffn_down_12 -->
<g id="node771" class="node">
<title>layer9_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14374,-8685 13927,-8685 13927,-8602 14374,-8602 14374,-8685"/>
<text text-anchor="middle" x="14150.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14150.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14150.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14150.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14150.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_res2_12 -->
<g id="node800" class="node">
<title>layer9_res2_12</title>
<polygon fill="none" stroke="black" points="14213,-8501 14088,-8501 14088,-8465 14213,-8465 14213,-8501"/>
<text text-anchor="middle" x="14150.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer9_res2_12</text>
</g>
<!-- layer9_ffn_down_12&#45;&gt;layer9_res2_12 -->
<g id="edge847" class="edge">
<title>layer9_ffn_down_12&#45;&gt;layer9_res2_12</title>
<path fill="none" stroke="black" d="M14150.5,-8601.68C14150.5,-8573.24 14150.5,-8536.08 14150.5,-8511.2"/>
<polygon fill="black" stroke="black" points="14154,-8511.02 14150.5,-8501.02 14147,-8511.02 14154,-8511.02"/>
</g>
<!-- layer9_ffn_down_13 -->
<g id="node772" class="node">
<title>layer9_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="15394,-8685 14947,-8685 14947,-8602 15394,-8602 15394,-8685"/>
<text text-anchor="middle" x="15170.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15170.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15170.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="15170.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15170.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_res2_13 -->
<g id="node805" class="node">
<title>layer9_res2_13</title>
<polygon fill="none" stroke="black" points="15233,-8501 15108,-8501 15108,-8465 15233,-8465 15233,-8501"/>
<text text-anchor="middle" x="15170.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer9_res2_13</text>
</g>
<!-- layer9_ffn_down_13&#45;&gt;layer9_res2_13 -->
<g id="edge858" class="edge">
<title>layer9_ffn_down_13&#45;&gt;layer9_res2_13</title>
<path fill="none" stroke="black" d="M15170.5,-8601.68C15170.5,-8573.24 15170.5,-8536.08 15170.5,-8511.2"/>
<polygon fill="black" stroke="black" points="15174,-8511.02 15170.5,-8501.02 15167,-8511.02 15174,-8511.02"/>
</g>
<!-- layer9_ffn_down_14 -->
<g id="node773" class="node">
<title>layer9_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16787,-8685 16340,-8685 16340,-8602 16787,-8602 16787,-8685"/>
<text text-anchor="middle" x="16563.5" y="-8669.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16563.5" y="-8654.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16563.5" y="-8639.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16563.5" y="-8624.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16563.5" y="-8609.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_res2_14 -->
<g id="node810" class="node">
<title>layer9_res2_14</title>
<polygon fill="none" stroke="black" points="16626,-8501 16501,-8501 16501,-8465 16626,-8465 16626,-8501"/>
<text text-anchor="middle" x="16563.5" y="-8479.3" font-family="Times,serif" font-size="14.00">layer9_res2_14</text>
</g>
<!-- layer9_ffn_down_14&#45;&gt;layer9_res2_14 -->
<g id="edge869" class="edge">
<title>layer9_ffn_down_14&#45;&gt;layer9_res2_14</title>
<path fill="none" stroke="black" d="M16563.5,-8601.68C16563.5,-8573.24 16563.5,-8536.08 16563.5,-8511.2"/>
<polygon fill="black" stroke="black" points="16567,-8511.02 16563.5,-8501.02 16560,-8511.02 16567,-8511.02"/>
</g>
<!-- layer9_res2_15 -->
<g id="node775" class="node">
<title>layer9_res2_15</title>
<polygon fill="none" stroke="black" points="17784.24,-8566 17083.12,-8566 16902.76,-8400 17603.88,-8400 17784.24,-8566"/>
<text text-anchor="middle" x="17343.5" y="-8509.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17343.5" y="-8494.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-8479.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-8464.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-8449.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer9_ffn_down_15&#45;&gt;layer9_res2_15 -->
<g id="edge880" class="edge">
<title>layer9_ffn_down_15&#45;&gt;layer9_res2_15</title>
<path fill="none" stroke="black" d="M17343.5,-8601.68C17343.5,-8593.75 17343.5,-8585.14 17343.5,-8576.31"/>
<polygon fill="black" stroke="black" points="17347,-8576.27 17343.5,-8566.27 17340,-8576.27 17347,-8576.27"/>
</g>
<!-- layer10_mha_qkv_15 -->
<g id="node818" class="node">
<title>layer10_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17621.5,-8364 17065.5,-8364 17065.5,-8281 17621.5,-8281 17621.5,-8364"/>
<text text-anchor="middle" x="17343.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="17343.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17343.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="17343.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer9_res2_15&#45;&gt;layer10_mha_qkv_15 -->
<g id="edge958" class="edge">
<title>layer9_res2_15&#45;&gt;layer10_mha_qkv_15</title>
<path fill="none" stroke="black" d="M17343.5,-8399.96C17343.5,-8391.25 17343.5,-8382.59 17343.5,-8374.39"/>
<polygon fill="black" stroke="black" points="17347,-8374.29 17343.5,-8364.29 17340,-8374.29 17347,-8374.29"/>
</g>
<!-- layer9_mha_attn_8&#45;&gt;layer9_mha_out_8 -->
<g id="edge795" class="edge">
<title>layer9_mha_attn_8&#45;&gt;layer9_mha_out_8</title>
<path fill="none" stroke="black" d="M9681.5,-9371.24C9681.5,-9349.68 9681.5,-9311.87 9681.5,-9280.79"/>
<polygon fill="black" stroke="black" points="9685,-9280.54 9681.5,-9270.54 9678,-9280.54 9685,-9280.54"/>
</g>
<!-- layer9_ln1_8 -->
<g id="node778" class="node">
<title>layer9_ln1_8</title>
<polygon fill="none" stroke="black" points="9735,-8982.5 9628,-8982.5 9628,-8946.5 9735,-8946.5 9735,-8982.5"/>
<text text-anchor="middle" x="9681.5" y="-8960.8" font-family="Times,serif" font-size="14.00">layer9_ln1_8</text>
</g>
<!-- layer9_res1_8&#45;&gt;layer9_ln1_8 -->
<g id="edge797" class="edge">
<title>layer9_res1_8&#45;&gt;layer9_ln1_8</title>
<path fill="none" stroke="black" d="M9681.5,-9057.89C9681.5,-9040.56 9681.5,-9013.46 9681.5,-8993.09"/>
<polygon fill="black" stroke="black" points="9685,-8992.85 9681.5,-8982.85 9678,-8992.85 9685,-8992.85"/>
</g>
<!-- layer9_ln1_8&#45;&gt;layer9_ffn_gate_8 -->
<g id="edge798" class="edge">
<title>layer9_ln1_8&#45;&gt;layer9_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9654.38,-8946.24C9618.75,-8923.56 9554.84,-8882.88 9504.73,-8850.98"/>
<polygon fill="black" stroke="black" points="9506.5,-8847.95 9496.18,-8845.54 9502.74,-8853.86 9506.5,-8847.95"/>
</g>
<!-- layer9_ln1_8&#45;&gt;layer9_ffn_up_8 -->
<g id="edge799" class="edge">
<title>layer9_ln1_8&#45;&gt;layer9_ffn_up_8</title>
<path fill="none" stroke="black" d="M9707.86,-8946.24C9742.41,-8923.6 9804.34,-8883.04 9853,-8851.18"/>
<polygon fill="black" stroke="black" points="9855.16,-8853.94 9861.61,-8845.54 9851.32,-8848.09 9855.16,-8853.94"/>
</g>
<!-- layer9_ffn_act_8&#45;&gt;layer9_ffn_down_8 -->
<g id="edge802" class="edge">
<title>layer9_ffn_act_8&#45;&gt;layer9_ffn_down_8</title>
<path fill="none" stroke="black" d="M9453.5,-8625.24C9453.5,-8603.68 9453.5,-8565.87 9453.5,-8534.79"/>
<polygon fill="black" stroke="black" points="9457,-8534.54 9453.5,-8524.54 9450,-8534.54 9457,-8534.54"/>
</g>
<!-- layer10_mha_qkv_8 -->
<g id="node811" class="node">
<title>layer10_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="9731.5,-8203.5 9175.5,-8203.5 9175.5,-8120.5 9731.5,-8120.5 9731.5,-8203.5"/>
<text text-anchor="middle" x="9453.5" y="-8188.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9453.5" y="-8173.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9453.5" y="-8158.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9453.5" y="-8143.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9453.5" y="-8128.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer9_res2_8&#45;&gt;layer10_mha_qkv_8 -->
<g id="edge881" class="edge">
<title>layer9_res2_8&#45;&gt;layer10_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9453.5,-8304.24C9453.5,-8282.68 9453.5,-8244.87 9453.5,-8213.79"/>
<polygon fill="black" stroke="black" points="9457,-8213.54 9453.5,-8203.54 9450,-8213.54 9457,-8213.54"/>
</g>
<!-- layer9_mha_attn_9&#45;&gt;layer9_mha_out_9 -->
<g id="edge806" class="edge">
<title>layer9_mha_attn_9&#45;&gt;layer9_mha_out_9</title>
<path fill="none" stroke="black" d="M10786.5,-9531.74C10786.5,-9510.18 10786.5,-9472.37 10786.5,-9441.29"/>
<polygon fill="black" stroke="black" points="10790,-9441.04 10786.5,-9431.04 10783,-9441.04 10790,-9441.04"/>
</g>
<!-- layer9_ln1_9 -->
<g id="node783" class="node">
<title>layer9_ln1_9</title>
<polygon fill="none" stroke="black" points="10840,-9094 10733,-9094 10733,-9058 10840,-9058 10840,-9094"/>
<text text-anchor="middle" x="10786.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_ln1_9</text>
</g>
<!-- layer9_res1_9&#45;&gt;layer9_ln1_9 -->
<g id="edge808" class="edge">
<title>layer9_res1_9&#45;&gt;layer9_ln1_9</title>
<path fill="none" stroke="black" d="M10786.5,-9210.97C10786.5,-9185.03 10786.5,-9135.36 10786.5,-9104.33"/>
<polygon fill="black" stroke="black" points="10790,-9104.2 10786.5,-9094.2 10783,-9104.2 10790,-9104.2"/>
</g>
<!-- layer9_ln1_9&#45;&gt;layer9_ffn_gate_9 -->
<g id="edge809" class="edge">
<title>layer9_ln1_9&#45;&gt;layer9_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10770.72,-9057.89C10759.75,-9046 10744.55,-9029.52 10730.02,-9013.77"/>
<polygon fill="black" stroke="black" points="10732.32,-9011.1 10722.97,-9006.12 10727.17,-9015.84 10732.32,-9011.1"/>
</g>
<!-- layer9_ln1_9&#45;&gt;layer9_ffn_up_9 -->
<g id="edge810" class="edge">
<title>layer9_ln1_9&#45;&gt;layer9_ffn_up_9</title>
<path fill="none" stroke="black" d="M10840.32,-9059.89C10887.32,-9046.69 10957.92,-9026.87 11022.3,-9008.79"/>
<polygon fill="black" stroke="black" points="11023.48,-9012.1 11032.17,-9006.02 11021.59,-9005.36 11023.48,-9012.1"/>
</g>
<!-- layer9_ffn_act_9&#45;&gt;layer9_ffn_down_9 -->
<g id="edge813" class="edge">
<title>layer9_ffn_act_9&#45;&gt;layer9_ffn_down_9</title>
<path fill="none" stroke="black" d="M10692.5,-8785.74C10692.5,-8764.18 10692.5,-8726.37 10692.5,-8695.29"/>
<polygon fill="black" stroke="black" points="10696,-8695.04 10692.5,-8685.04 10689,-8695.04 10696,-8695.04"/>
</g>
<!-- layer10_mha_qkv_9 -->
<g id="node812" class="node">
<title>layer10_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="10970.5,-8364 10414.5,-8364 10414.5,-8281 10970.5,-8281 10970.5,-8364"/>
<text text-anchor="middle" x="10692.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10692.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10692.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10692.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10692.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer9_res2_9&#45;&gt;layer10_mha_qkv_9 -->
<g id="edge892" class="edge">
<title>layer9_res2_9&#45;&gt;layer10_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10692.5,-8464.74C10692.5,-8443.18 10692.5,-8405.37 10692.5,-8374.29"/>
<polygon fill="black" stroke="black" points="10696,-8374.04 10692.5,-8364.04 10689,-8374.04 10696,-8374.04"/>
</g>
<!-- layer9_mha_attn_10&#45;&gt;layer9_mha_out_10 -->
<g id="edge817" class="edge">
<title>layer9_mha_attn_10&#45;&gt;layer9_mha_out_10</title>
<path fill="none" stroke="black" d="M11996.5,-9531.74C11996.5,-9510.18 11996.5,-9472.37 11996.5,-9441.29"/>
<polygon fill="black" stroke="black" points="12000,-9441.04 11996.5,-9431.04 11993,-9441.04 12000,-9441.04"/>
</g>
<!-- layer9_ln1_10 -->
<g id="node788" class="node">
<title>layer9_ln1_10</title>
<polygon fill="none" stroke="black" points="12054.5,-9094 11938.5,-9094 11938.5,-9058 12054.5,-9058 12054.5,-9094"/>
<text text-anchor="middle" x="11996.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_ln1_10</text>
</g>
<!-- layer9_res1_10&#45;&gt;layer9_ln1_10 -->
<g id="edge819" class="edge">
<title>layer9_res1_10&#45;&gt;layer9_ln1_10</title>
<path fill="none" stroke="black" d="M11996.5,-9210.97C11996.5,-9185.03 11996.5,-9135.36 11996.5,-9104.33"/>
<polygon fill="black" stroke="black" points="12000,-9104.2 11996.5,-9094.2 11993,-9104.2 12000,-9104.2"/>
</g>
<!-- layer9_ln1_10&#45;&gt;layer9_ffn_gate_10 -->
<g id="edge820" class="edge">
<title>layer9_ln1_10&#45;&gt;layer9_ffn_gate_10</title>
<path fill="none" stroke="black" d="M11947.75,-9057.89C11910.71,-9044.89 11858.05,-9026.41 11809.54,-9009.38"/>
<polygon fill="black" stroke="black" points="11810.5,-9006.01 11799.9,-9006 11808.18,-9012.62 11810.5,-9006.01"/>
</g>
<!-- layer9_ln1_10&#45;&gt;layer9_ffn_up_10 -->
<g id="edge821" class="edge">
<title>layer9_ln1_10&#45;&gt;layer9_ffn_up_10</title>
<path fill="none" stroke="black" d="M12024.47,-9057.89C12044.88,-9045.41 12073.55,-9027.86 12100.45,-9011.41"/>
<polygon fill="black" stroke="black" points="12102.4,-9014.32 12109.1,-9006.12 12098.74,-9008.35 12102.4,-9014.32"/>
</g>
<!-- layer9_ffn_act_10&#45;&gt;layer9_ffn_down_10 -->
<g id="edge824" class="edge">
<title>layer9_ffn_act_10&#45;&gt;layer9_ffn_down_10</title>
<path fill="none" stroke="black" d="M11692.5,-8785.74C11692.5,-8764.18 11692.5,-8726.37 11692.5,-8695.29"/>
<polygon fill="black" stroke="black" points="11696,-8695.04 11692.5,-8685.04 11689,-8695.04 11696,-8695.04"/>
</g>
<!-- layer10_mha_qkv_10 -->
<g id="node813" class="node">
<title>layer10_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="11970.5,-8364 11414.5,-8364 11414.5,-8281 11970.5,-8281 11970.5,-8364"/>
<text text-anchor="middle" x="11692.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="11692.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11692.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11692.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="11692.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer9_res2_10&#45;&gt;layer10_mha_qkv_10 -->
<g id="edge903" class="edge">
<title>layer9_res2_10&#45;&gt;layer10_mha_qkv_10</title>
<path fill="none" stroke="black" d="M11692.5,-8464.74C11692.5,-8443.18 11692.5,-8405.37 11692.5,-8374.29"/>
<polygon fill="black" stroke="black" points="11696,-8374.04 11692.5,-8364.04 11689,-8374.04 11696,-8374.04"/>
</g>
<!-- layer9_mha_attn_11&#45;&gt;layer9_mha_out_11 -->
<g id="edge828" class="edge">
<title>layer9_mha_attn_11&#45;&gt;layer9_mha_out_11</title>
<path fill="none" stroke="black" d="M12993.5,-9531.74C12993.5,-9510.18 12993.5,-9472.37 12993.5,-9441.29"/>
<polygon fill="black" stroke="black" points="12997,-9441.04 12993.5,-9431.04 12990,-9441.04 12997,-9441.04"/>
</g>
<!-- layer9_ln1_11 -->
<g id="node793" class="node">
<title>layer9_ln1_11</title>
<polygon fill="none" stroke="black" points="13051.5,-9094 12935.5,-9094 12935.5,-9058 13051.5,-9058 13051.5,-9094"/>
<text text-anchor="middle" x="12993.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_ln1_11</text>
</g>
<!-- layer9_res1_11&#45;&gt;layer9_ln1_11 -->
<g id="edge830" class="edge">
<title>layer9_res1_11&#45;&gt;layer9_ln1_11</title>
<path fill="none" stroke="black" d="M12993.5,-9210.97C12993.5,-9185.03 12993.5,-9135.36 12993.5,-9104.33"/>
<polygon fill="black" stroke="black" points="12997,-9104.2 12993.5,-9094.2 12990,-9104.2 12997,-9104.2"/>
</g>
<!-- layer9_ln1_11&#45;&gt;layer9_ffn_gate_11 -->
<g id="edge831" class="edge">
<title>layer9_ln1_11&#45;&gt;layer9_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12962.41,-9057.89C12939.52,-9045.3 12907.28,-9027.56 12877.16,-9010.99"/>
<polygon fill="black" stroke="black" points="12878.77,-9007.87 12868.32,-9006.12 12875.39,-9014.01 12878.77,-9007.87"/>
</g>
<!-- layer9_ln1_11&#45;&gt;layer9_ffn_up_11 -->
<g id="edge832" class="edge">
<title>layer9_ln1_11&#45;&gt;layer9_ffn_up_11</title>
<path fill="none" stroke="black" d="M13039.12,-9057.89C13073.64,-9044.95 13122.67,-9026.56 13167.91,-9009.6"/>
<polygon fill="black" stroke="black" points="13169.36,-9012.79 13177.5,-9006 13166.9,-9006.24 13169.36,-9012.79"/>
</g>
<!-- layer9_ffn_act_11&#45;&gt;layer9_ffn_down_11 -->
<g id="edge835" class="edge">
<title>layer9_ffn_act_11&#45;&gt;layer9_ffn_down_11</title>
<path fill="none" stroke="black" d="M13051.5,-8785.74C13051.5,-8764.18 13051.5,-8726.37 13051.5,-8695.29"/>
<polygon fill="black" stroke="black" points="13055,-8695.04 13051.5,-8685.04 13048,-8695.04 13055,-8695.04"/>
</g>
<!-- layer10_mha_qkv_11 -->
<g id="node814" class="node">
<title>layer10_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="13329.5,-8364 12773.5,-8364 12773.5,-8281 13329.5,-8281 13329.5,-8364"/>
<text text-anchor="middle" x="13051.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="13051.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13051.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13051.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="13051.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer9_res2_11&#45;&gt;layer10_mha_qkv_11 -->
<g id="edge914" class="edge">
<title>layer9_res2_11&#45;&gt;layer10_mha_qkv_11</title>
<path fill="none" stroke="black" d="M13051.5,-8464.74C13051.5,-8443.18 13051.5,-8405.37 13051.5,-8374.29"/>
<polygon fill="black" stroke="black" points="13055,-8374.04 13051.5,-8364.04 13048,-8374.04 13055,-8374.04"/>
</g>
<!-- layer9_mha_attn_12&#45;&gt;layer9_mha_out_12 -->
<g id="edge839" class="edge">
<title>layer9_mha_attn_12&#45;&gt;layer9_mha_out_12</title>
<path fill="none" stroke="black" d="M14041.5,-9531.74C14041.5,-9510.18 14041.5,-9472.37 14041.5,-9441.29"/>
<polygon fill="black" stroke="black" points="14045,-9441.04 14041.5,-9431.04 14038,-9441.04 14045,-9441.04"/>
</g>
<!-- layer9_ln1_12 -->
<g id="node798" class="node">
<title>layer9_ln1_12</title>
<polygon fill="none" stroke="black" points="14099.5,-9094 13983.5,-9094 13983.5,-9058 14099.5,-9058 14099.5,-9094"/>
<text text-anchor="middle" x="14041.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_ln1_12</text>
</g>
<!-- layer9_res1_12&#45;&gt;layer9_ln1_12 -->
<g id="edge841" class="edge">
<title>layer9_res1_12&#45;&gt;layer9_ln1_12</title>
<path fill="none" stroke="black" d="M14041.5,-9210.97C14041.5,-9185.03 14041.5,-9135.36 14041.5,-9104.33"/>
<polygon fill="black" stroke="black" points="14045,-9104.2 14041.5,-9094.2 14038,-9104.2 14045,-9104.2"/>
</g>
<!-- layer9_ln1_12&#45;&gt;layer9_ffn_gate_12 -->
<g id="edge842" class="edge">
<title>layer9_ln1_12&#45;&gt;layer9_ffn_gate_12</title>
<path fill="none" stroke="black" d="M14017.28,-9057.89C13999.84,-9045.57 13975.42,-9028.32 13952.4,-9012.05"/>
<polygon fill="black" stroke="black" points="13954.18,-9009.03 13944,-9006.12 13950.14,-9014.75 13954.18,-9009.03"/>
</g>
<!-- layer9_ln1_12&#45;&gt;layer9_ffn_up_12 -->
<g id="edge843" class="edge">
<title>layer9_ln1_12&#45;&gt;layer9_ffn_up_12</title>
<path fill="none" stroke="black" d="M14094,-9057.89C14134.05,-9044.84 14191.08,-9026.25 14243.49,-9009.17"/>
<polygon fill="black" stroke="black" points="14244.8,-9012.43 14253.22,-9006 14242.63,-9005.77 14244.8,-9012.43"/>
</g>
<!-- layer9_ffn_act_12&#45;&gt;layer9_ffn_down_12 -->
<g id="edge846" class="edge">
<title>layer9_ffn_act_12&#45;&gt;layer9_ffn_down_12</title>
<path fill="none" stroke="black" d="M14150.5,-8785.74C14150.5,-8764.18 14150.5,-8726.37 14150.5,-8695.29"/>
<polygon fill="black" stroke="black" points="14154,-8695.04 14150.5,-8685.04 14147,-8695.04 14154,-8695.04"/>
</g>
<!-- layer10_mha_qkv_12 -->
<g id="node815" class="node">
<title>layer10_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14428.5,-8364 13872.5,-8364 13872.5,-8281 14428.5,-8281 14428.5,-8364"/>
<text text-anchor="middle" x="14150.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14150.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14150.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14150.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14150.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer9_res2_12&#45;&gt;layer10_mha_qkv_12 -->
<g id="edge925" class="edge">
<title>layer9_res2_12&#45;&gt;layer10_mha_qkv_12</title>
<path fill="none" stroke="black" d="M14150.5,-8464.74C14150.5,-8443.18 14150.5,-8405.37 14150.5,-8374.29"/>
<polygon fill="black" stroke="black" points="14154,-8374.04 14150.5,-8364.04 14147,-8374.04 14154,-8374.04"/>
</g>
<!-- layer9_mha_attn_13&#45;&gt;layer9_mha_out_13 -->
<g id="edge850" class="edge">
<title>layer9_mha_attn_13&#45;&gt;layer9_mha_out_13</title>
<path fill="none" stroke="black" d="M15418.5,-9531.74C15418.5,-9510.18 15418.5,-9472.37 15418.5,-9441.29"/>
<polygon fill="black" stroke="black" points="15422,-9441.04 15418.5,-9431.04 15415,-9441.04 15422,-9441.04"/>
</g>
<!-- layer9_ln1_13 -->
<g id="node803" class="node">
<title>layer9_ln1_13</title>
<polygon fill="none" stroke="black" points="15476.5,-9094 15360.5,-9094 15360.5,-9058 15476.5,-9058 15476.5,-9094"/>
<text text-anchor="middle" x="15418.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_ln1_13</text>
</g>
<!-- layer9_res1_13&#45;&gt;layer9_ln1_13 -->
<g id="edge852" class="edge">
<title>layer9_res1_13&#45;&gt;layer9_ln1_13</title>
<path fill="none" stroke="black" d="M15418.5,-9210.97C15418.5,-9185.03 15418.5,-9135.36 15418.5,-9104.33"/>
<polygon fill="black" stroke="black" points="15422,-9104.2 15418.5,-9094.2 15415,-9104.2 15422,-9104.2"/>
</g>
<!-- layer9_ln1_13&#45;&gt;layer9_ffn_gate_13 -->
<g id="edge853" class="edge">
<title>layer9_ln1_13&#45;&gt;layer9_ffn_gate_13</title>
<path fill="none" stroke="black" d="M15375.06,-9057.89C15342.27,-9044.97 15295.72,-9026.64 15252.73,-9009.7"/>
<polygon fill="black" stroke="black" points="15253.91,-9006.41 15243.33,-9006 15251.35,-9012.92 15253.91,-9006.41"/>
</g>
<!-- layer9_ln1_13&#45;&gt;layer9_ffn_up_13 -->
<g id="edge854" class="edge">
<title>layer9_ln1_13&#45;&gt;layer9_ffn_up_13</title>
<path fill="none" stroke="black" d="M15451.78,-9057.89C15476.38,-9045.24 15511.08,-9027.41 15543.44,-9010.77"/>
<polygon fill="black" stroke="black" points="15545.2,-9013.8 15552.49,-9006.12 15542,-9007.58 15545.2,-9013.8"/>
</g>
<!-- layer9_ffn_act_13&#45;&gt;layer9_ffn_down_13 -->
<g id="edge857" class="edge">
<title>layer9_ffn_act_13&#45;&gt;layer9_ffn_down_13</title>
<path fill="none" stroke="black" d="M15170.5,-8785.74C15170.5,-8764.18 15170.5,-8726.37 15170.5,-8695.29"/>
<polygon fill="black" stroke="black" points="15174,-8695.04 15170.5,-8685.04 15167,-8695.04 15174,-8695.04"/>
</g>
<!-- layer10_mha_qkv_13 -->
<g id="node816" class="node">
<title>layer10_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15448.5,-8364 14892.5,-8364 14892.5,-8281 15448.5,-8281 15448.5,-8364"/>
<text text-anchor="middle" x="15170.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="15170.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15170.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15170.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="15170.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer9_res2_13&#45;&gt;layer10_mha_qkv_13 -->
<g id="edge936" class="edge">
<title>layer9_res2_13&#45;&gt;layer10_mha_qkv_13</title>
<path fill="none" stroke="black" d="M15170.5,-8464.74C15170.5,-8443.18 15170.5,-8405.37 15170.5,-8374.29"/>
<polygon fill="black" stroke="black" points="15174,-8374.04 15170.5,-8364.04 15167,-8374.04 15174,-8374.04"/>
</g>
<!-- layer9_mha_attn_14&#45;&gt;layer9_mha_out_14 -->
<g id="edge861" class="edge">
<title>layer9_mha_attn_14&#45;&gt;layer9_mha_out_14</title>
<path fill="none" stroke="black" d="M16207.5,-9531.74C16207.5,-9510.18 16207.5,-9472.37 16207.5,-9441.29"/>
<polygon fill="black" stroke="black" points="16211,-9441.04 16207.5,-9431.04 16204,-9441.04 16211,-9441.04"/>
</g>
<!-- layer9_ln1_14 -->
<g id="node808" class="node">
<title>layer9_ln1_14</title>
<polygon fill="none" stroke="black" points="16265.5,-9094 16149.5,-9094 16149.5,-9058 16265.5,-9058 16265.5,-9094"/>
<text text-anchor="middle" x="16207.5" y="-9072.3" font-family="Times,serif" font-size="14.00">layer9_ln1_14</text>
</g>
<!-- layer9_res1_14&#45;&gt;layer9_ln1_14 -->
<g id="edge863" class="edge">
<title>layer9_res1_14&#45;&gt;layer9_ln1_14</title>
<path fill="none" stroke="black" d="M16207.5,-9210.97C16207.5,-9185.03 16207.5,-9135.36 16207.5,-9104.33"/>
<polygon fill="black" stroke="black" points="16211,-9104.2 16207.5,-9094.2 16204,-9104.2 16211,-9104.2"/>
</g>
<!-- layer9_ln1_14&#45;&gt;layer9_ffn_gate_14 -->
<g id="edge864" class="edge">
<title>layer9_ln1_14&#45;&gt;layer9_ffn_gate_14</title>
<path fill="none" stroke="black" d="M16197.66,-9057.89C16191,-9046.33 16181.85,-9030.42 16173.01,-9015.06"/>
<polygon fill="black" stroke="black" points="16175.89,-9013.04 16167.87,-9006.12 16169.82,-9016.53 16175.89,-9013.04"/>
</g>
<!-- layer9_ln1_14&#45;&gt;layer9_ffn_up_14 -->
<g id="edge865" class="edge">
<title>layer9_ln1_14&#45;&gt;layer9_ffn_up_14</title>
<path fill="none" stroke="black" d="M16265.67,-9060.12C16317.4,-9046.88 16395.68,-9026.86 16466.91,-9008.63"/>
<polygon fill="black" stroke="black" points="16468.1,-9011.94 16476.92,-9006.07 16466.36,-9005.16 16468.1,-9011.94"/>
</g>
<!-- layer9_ffn_act_14&#45;&gt;layer9_ffn_down_14 -->
<g id="edge868" class="edge">
<title>layer9_ffn_act_14&#45;&gt;layer9_ffn_down_14</title>
<path fill="none" stroke="black" d="M16563.5,-8785.74C16563.5,-8764.18 16563.5,-8726.37 16563.5,-8695.29"/>
<polygon fill="black" stroke="black" points="16567,-8695.04 16563.5,-8685.04 16560,-8695.04 16567,-8695.04"/>
</g>
<!-- layer10_mha_qkv_14 -->
<g id="node817" class="node">
<title>layer10_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16841.5,-8364 16285.5,-8364 16285.5,-8281 16841.5,-8281 16841.5,-8364"/>
<text text-anchor="middle" x="16563.5" y="-8348.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16563.5" y="-8333.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16563.5" y="-8318.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16563.5" y="-8303.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16563.5" y="-8288.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer9_res2_14&#45;&gt;layer10_mha_qkv_14 -->
<g id="edge947" class="edge">
<title>layer9_res2_14&#45;&gt;layer10_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16563.5,-8464.74C16563.5,-8443.18 16563.5,-8405.37 16563.5,-8374.29"/>
<polygon fill="black" stroke="black" points="16567,-8374.04 16563.5,-8364.04 16560,-8374.04 16567,-8374.04"/>
</g>
<!-- layer10_mha_attn_8 -->
<g id="node856" class="node">
<title>layer10_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9533.5,-8019.5 9373.5,-8019.5 9373.5,-7983.5 9533.5,-7983.5 9533.5,-8019.5"/>
<text text-anchor="middle" x="9453.5" y="-7997.8" font-family="Times,serif" font-size="14.00">layer10_mha_attn_8</text>
</g>
<!-- layer10_mha_qkv_8&#45;&gt;layer10_mha_attn_8 -->
<g id="edge882" class="edge">
<title>layer10_mha_qkv_8&#45;&gt;layer10_mha_attn_8</title>
<path fill="none" stroke="black" d="M9453.5,-8120.18C9453.5,-8091.74 9453.5,-8054.58 9453.5,-8029.7"/>
<polygon fill="black" stroke="black" points="9457,-8029.52 9453.5,-8019.52 9450,-8029.52 9457,-8029.52"/>
</g>
<!-- layer10_mha_attn_9 -->
<g id="node861" class="node">
<title>layer10_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10772.5,-8180 10612.5,-8180 10612.5,-8144 10772.5,-8144 10772.5,-8180"/>
<text text-anchor="middle" x="10692.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer10_mha_attn_9</text>
</g>
<!-- layer10_mha_qkv_9&#45;&gt;layer10_mha_attn_9 -->
<g id="edge893" class="edge">
<title>layer10_mha_qkv_9&#45;&gt;layer10_mha_attn_9</title>
<path fill="none" stroke="black" d="M10692.5,-8280.68C10692.5,-8252.24 10692.5,-8215.08 10692.5,-8190.2"/>
<polygon fill="black" stroke="black" points="10696,-8190.02 10692.5,-8180.02 10689,-8190.02 10696,-8190.02"/>
</g>
<!-- layer10_mha_attn_10 -->
<g id="node866" class="node">
<title>layer10_mha_attn_10</title>
<polygon fill="none" stroke="black" points="11777,-8180 11608,-8180 11608,-8144 11777,-8144 11777,-8180"/>
<text text-anchor="middle" x="11692.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer10_mha_attn_10</text>
</g>
<!-- layer10_mha_qkv_10&#45;&gt;layer10_mha_attn_10 -->
<g id="edge904" class="edge">
<title>layer10_mha_qkv_10&#45;&gt;layer10_mha_attn_10</title>
<path fill="none" stroke="black" d="M11692.5,-8280.68C11692.5,-8252.24 11692.5,-8215.08 11692.5,-8190.2"/>
<polygon fill="black" stroke="black" points="11696,-8190.02 11692.5,-8180.02 11689,-8190.02 11696,-8190.02"/>
</g>
<!-- layer10_mha_attn_11 -->
<g id="node871" class="node">
<title>layer10_mha_attn_11</title>
<polygon fill="none" stroke="black" points="13136,-8180 12967,-8180 12967,-8144 13136,-8144 13136,-8180"/>
<text text-anchor="middle" x="13051.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer10_mha_attn_11</text>
</g>
<!-- layer10_mha_qkv_11&#45;&gt;layer10_mha_attn_11 -->
<g id="edge915" class="edge">
<title>layer10_mha_qkv_11&#45;&gt;layer10_mha_attn_11</title>
<path fill="none" stroke="black" d="M13051.5,-8280.68C13051.5,-8252.24 13051.5,-8215.08 13051.5,-8190.2"/>
<polygon fill="black" stroke="black" points="13055,-8190.02 13051.5,-8180.02 13048,-8190.02 13055,-8190.02"/>
</g>
<!-- layer10_mha_attn_12 -->
<g id="node876" class="node">
<title>layer10_mha_attn_12</title>
<polygon fill="none" stroke="black" points="14235,-8180 14066,-8180 14066,-8144 14235,-8144 14235,-8180"/>
<text text-anchor="middle" x="14150.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer10_mha_attn_12</text>
</g>
<!-- layer10_mha_qkv_12&#45;&gt;layer10_mha_attn_12 -->
<g id="edge926" class="edge">
<title>layer10_mha_qkv_12&#45;&gt;layer10_mha_attn_12</title>
<path fill="none" stroke="black" d="M14150.5,-8280.68C14150.5,-8252.24 14150.5,-8215.08 14150.5,-8190.2"/>
<polygon fill="black" stroke="black" points="14154,-8190.02 14150.5,-8180.02 14147,-8190.02 14154,-8190.02"/>
</g>
<!-- layer10_mha_attn_13 -->
<g id="node881" class="node">
<title>layer10_mha_attn_13</title>
<polygon fill="none" stroke="black" points="15255,-8180 15086,-8180 15086,-8144 15255,-8144 15255,-8180"/>
<text text-anchor="middle" x="15170.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer10_mha_attn_13</text>
</g>
<!-- layer10_mha_qkv_13&#45;&gt;layer10_mha_attn_13 -->
<g id="edge937" class="edge">
<title>layer10_mha_qkv_13&#45;&gt;layer10_mha_attn_13</title>
<path fill="none" stroke="black" d="M15170.5,-8280.68C15170.5,-8252.24 15170.5,-8215.08 15170.5,-8190.2"/>
<polygon fill="black" stroke="black" points="15174,-8190.02 15170.5,-8180.02 15167,-8190.02 15174,-8190.02"/>
</g>
<!-- layer10_mha_attn_14 -->
<g id="node886" class="node">
<title>layer10_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16648,-8180 16479,-8180 16479,-8144 16648,-8144 16648,-8180"/>
<text text-anchor="middle" x="16563.5" y="-8158.3" font-family="Times,serif" font-size="14.00">layer10_mha_attn_14</text>
</g>
<!-- layer10_mha_qkv_14&#45;&gt;layer10_mha_attn_14 -->
<g id="edge948" class="edge">
<title>layer10_mha_qkv_14&#45;&gt;layer10_mha_attn_14</title>
<path fill="none" stroke="black" d="M16563.5,-8280.68C16563.5,-8252.24 16563.5,-8215.08 16563.5,-8190.2"/>
<polygon fill="black" stroke="black" points="16567,-8190.02 16563.5,-8180.02 16560,-8190.02 16567,-8190.02"/>
</g>
<!-- layer10_mha_attn_15 -->
<g id="node819" class="node">
<title>layer10_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17820.31,-8245 17061.81,-8245 16866.69,-8079 17625.19,-8079 17820.31,-8245"/>
<text text-anchor="middle" x="17343.5" y="-8188.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17343.5" y="-8173.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="17343.5" y="-8158.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17343.5" y="-8143.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-8128.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_mha_qkv_15&#45;&gt;layer10_mha_attn_15 -->
<g id="edge959" class="edge">
<title>layer10_mha_qkv_15&#45;&gt;layer10_mha_attn_15</title>
<path fill="none" stroke="black" d="M17343.5,-8280.68C17343.5,-8272.75 17343.5,-8264.14 17343.5,-8255.31"/>
<polygon fill="black" stroke="black" points="17347,-8255.27 17343.5,-8245.27 17340,-8255.27 17347,-8255.27"/>
</g>
<!-- layer10_mha_out_15 -->
<g id="node827" class="node">
<title>layer10_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17562.5,-8043 17124.5,-8043 17124.5,-7960 17562.5,-7960 17562.5,-8043"/>
<text text-anchor="middle" x="17343.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="17343.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17343.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17343.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_mha_attn_15&#45;&gt;layer10_mha_out_15 -->
<g id="edge960" class="edge">
<title>layer10_mha_attn_15&#45;&gt;layer10_mha_out_15</title>
<path fill="none" stroke="black" d="M17343.5,-8078.96C17343.5,-8070.25 17343.5,-8061.59 17343.5,-8053.39"/>
<polygon fill="black" stroke="black" points="17347,-8053.29 17343.5,-8043.29 17340,-8053.29 17347,-8053.29"/>
</g>
<!-- layer10_mha_out_8 -->
<g id="node820" class="node">
<title>layer10_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="9672.5,-7882.5 9234.5,-7882.5 9234.5,-7799.5 9672.5,-7799.5 9672.5,-7882.5"/>
<text text-anchor="middle" x="9453.5" y="-7867.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9453.5" y="-7852.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9453.5" y="-7837.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9453.5" y="-7822.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9453.5" y="-7807.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_res1_8 -->
<g id="node857" class="node">
<title>layer10_res1_8</title>
<polygon fill="none" stroke="black" points="9516,-7706 9391,-7706 9391,-7670 9516,-7670 9516,-7706"/>
<text text-anchor="middle" x="9453.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_res1_8</text>
</g>
<!-- layer10_mha_out_8&#45;&gt;layer10_res1_8 -->
<g id="edge884" class="edge">
<title>layer10_mha_out_8&#45;&gt;layer10_res1_8</title>
<path fill="none" stroke="black" d="M9453.5,-7799.14C9453.5,-7772.9 9453.5,-7739.53 9453.5,-7716.44"/>
<polygon fill="black" stroke="black" points="9457,-7716.31 9453.5,-7706.31 9450,-7716.31 9457,-7716.31"/>
</g>
<!-- layer10_mha_out_9 -->
<g id="node821" class="node">
<title>layer10_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="10911.5,-8043 10473.5,-8043 10473.5,-7960 10911.5,-7960 10911.5,-8043"/>
<text text-anchor="middle" x="10692.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10692.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10692.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10692.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10692.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_res1_9 -->
<g id="node862" class="node">
<title>layer10_res1_9</title>
<polygon fill="none" stroke="black" points="10755,-7859 10630,-7859 10630,-7823 10755,-7823 10755,-7859"/>
<text text-anchor="middle" x="10692.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer10_res1_9</text>
</g>
<!-- layer10_mha_out_9&#45;&gt;layer10_res1_9 -->
<g id="edge895" class="edge">
<title>layer10_mha_out_9&#45;&gt;layer10_res1_9</title>
<path fill="none" stroke="black" d="M10692.5,-7959.68C10692.5,-7931.24 10692.5,-7894.08 10692.5,-7869.2"/>
<polygon fill="black" stroke="black" points="10696,-7869.02 10692.5,-7859.02 10689,-7869.02 10696,-7869.02"/>
</g>
<!-- layer10_mha_out_10 -->
<g id="node822" class="node">
<title>layer10_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="11911.5,-8043 11473.5,-8043 11473.5,-7960 11911.5,-7960 11911.5,-8043"/>
<text text-anchor="middle" x="11692.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="11692.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11692.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11692.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11692.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_res1_10 -->
<g id="node867" class="node">
<title>layer10_res1_10</title>
<polygon fill="none" stroke="black" points="11759.5,-7859 11625.5,-7859 11625.5,-7823 11759.5,-7823 11759.5,-7859"/>
<text text-anchor="middle" x="11692.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer10_res1_10</text>
</g>
<!-- layer10_mha_out_10&#45;&gt;layer10_res1_10 -->
<g id="edge906" class="edge">
<title>layer10_mha_out_10&#45;&gt;layer10_res1_10</title>
<path fill="none" stroke="black" d="M11692.5,-7959.68C11692.5,-7931.24 11692.5,-7894.08 11692.5,-7869.2"/>
<polygon fill="black" stroke="black" points="11696,-7869.02 11692.5,-7859.02 11689,-7869.02 11696,-7869.02"/>
</g>
<!-- layer10_mha_out_11 -->
<g id="node823" class="node">
<title>layer10_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="13270.5,-8043 12832.5,-8043 12832.5,-7960 13270.5,-7960 13270.5,-8043"/>
<text text-anchor="middle" x="13051.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="13051.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13051.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13051.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13051.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_res1_11 -->
<g id="node872" class="node">
<title>layer10_res1_11</title>
<polygon fill="none" stroke="black" points="13118.5,-7859 12984.5,-7859 12984.5,-7823 13118.5,-7823 13118.5,-7859"/>
<text text-anchor="middle" x="13051.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer10_res1_11</text>
</g>
<!-- layer10_mha_out_11&#45;&gt;layer10_res1_11 -->
<g id="edge917" class="edge">
<title>layer10_mha_out_11&#45;&gt;layer10_res1_11</title>
<path fill="none" stroke="black" d="M13051.5,-7959.68C13051.5,-7931.24 13051.5,-7894.08 13051.5,-7869.2"/>
<polygon fill="black" stroke="black" points="13055,-7869.02 13051.5,-7859.02 13048,-7869.02 13055,-7869.02"/>
</g>
<!-- layer10_mha_out_12 -->
<g id="node824" class="node">
<title>layer10_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14369.5,-8043 13931.5,-8043 13931.5,-7960 14369.5,-7960 14369.5,-8043"/>
<text text-anchor="middle" x="14150.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14150.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14150.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14150.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14150.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_res1_12 -->
<g id="node877" class="node">
<title>layer10_res1_12</title>
<polygon fill="none" stroke="black" points="14217.5,-7859 14083.5,-7859 14083.5,-7823 14217.5,-7823 14217.5,-7859"/>
<text text-anchor="middle" x="14150.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer10_res1_12</text>
</g>
<!-- layer10_mha_out_12&#45;&gt;layer10_res1_12 -->
<g id="edge928" class="edge">
<title>layer10_mha_out_12&#45;&gt;layer10_res1_12</title>
<path fill="none" stroke="black" d="M14150.5,-7959.68C14150.5,-7931.24 14150.5,-7894.08 14150.5,-7869.2"/>
<polygon fill="black" stroke="black" points="14154,-7869.02 14150.5,-7859.02 14147,-7869.02 14154,-7869.02"/>
</g>
<!-- layer10_mha_out_13 -->
<g id="node825" class="node">
<title>layer10_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="15389.5,-8043 14951.5,-8043 14951.5,-7960 15389.5,-7960 15389.5,-8043"/>
<text text-anchor="middle" x="15170.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="15170.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15170.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15170.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15170.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_res1_13 -->
<g id="node882" class="node">
<title>layer10_res1_13</title>
<polygon fill="none" stroke="black" points="15237.5,-7859 15103.5,-7859 15103.5,-7823 15237.5,-7823 15237.5,-7859"/>
<text text-anchor="middle" x="15170.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer10_res1_13</text>
</g>
<!-- layer10_mha_out_13&#45;&gt;layer10_res1_13 -->
<g id="edge939" class="edge">
<title>layer10_mha_out_13&#45;&gt;layer10_res1_13</title>
<path fill="none" stroke="black" d="M15170.5,-7959.68C15170.5,-7931.24 15170.5,-7894.08 15170.5,-7869.2"/>
<polygon fill="black" stroke="black" points="15174,-7869.02 15170.5,-7859.02 15167,-7869.02 15174,-7869.02"/>
</g>
<!-- layer10_mha_out_14 -->
<g id="node826" class="node">
<title>layer10_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16782.5,-8043 16344.5,-8043 16344.5,-7960 16782.5,-7960 16782.5,-8043"/>
<text text-anchor="middle" x="16563.5" y="-8027.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16563.5" y="-8012.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16563.5" y="-7997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16563.5" y="-7982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16563.5" y="-7967.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_res1_14 -->
<g id="node887" class="node">
<title>layer10_res1_14</title>
<polygon fill="none" stroke="black" points="16630.5,-7859 16496.5,-7859 16496.5,-7823 16630.5,-7823 16630.5,-7859"/>
<text text-anchor="middle" x="16563.5" y="-7837.3" font-family="Times,serif" font-size="14.00">layer10_res1_14</text>
</g>
<!-- layer10_mha_out_14&#45;&gt;layer10_res1_14 -->
<g id="edge950" class="edge">
<title>layer10_mha_out_14&#45;&gt;layer10_res1_14</title>
<path fill="none" stroke="black" d="M16563.5,-7959.68C16563.5,-7931.24 16563.5,-7894.08 16563.5,-7869.2"/>
<polygon fill="black" stroke="black" points="16567,-7869.02 16563.5,-7859.02 16560,-7869.02 16567,-7869.02"/>
</g>
<!-- layer10_res1_15 -->
<g id="node828" class="node">
<title>layer10_res1_15</title>
<polygon fill="none" stroke="black" points="17784.24,-7924 17083.12,-7924 16902.76,-7758 17603.88,-7758 17784.24,-7924"/>
<text text-anchor="middle" x="17343.5" y="-7867.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17343.5" y="-7852.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-7837.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-7822.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-7807.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_mha_out_15&#45;&gt;layer10_res1_15 -->
<g id="edge961" class="edge">
<title>layer10_mha_out_15&#45;&gt;layer10_res1_15</title>
<path fill="none" stroke="black" d="M17343.5,-7959.68C17343.5,-7951.75 17343.5,-7943.14 17343.5,-7934.31"/>
<polygon fill="black" stroke="black" points="17347,-7934.27 17343.5,-7924.27 17340,-7934.27 17347,-7934.27"/>
</g>
<!-- layer10_ln1_15 -->
<g id="node829" class="node">
<title>layer10_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17556,-7722 17131,-7722 17131,-7654 17556,-7654 17556,-7722"/>
<text text-anchor="middle" x="17343.5" y="-7706.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="17343.5" y="-7691.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-7676.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17343.5" y="-7661.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_res1_15&#45;&gt;layer10_ln1_15 -->
<g id="edge962" class="edge">
<title>layer10_res1_15&#45;&gt;layer10_ln1_15</title>
<path fill="none" stroke="black" d="M17343.5,-7757.87C17343.5,-7749.12 17343.5,-7740.48 17343.5,-7732.45"/>
<polygon fill="black" stroke="black" points="17347,-7732.26 17343.5,-7722.26 17340,-7732.26 17347,-7732.26"/>
</g>
<!-- layer10_ffn_gate_15 -->
<g id="node837" class="node">
<title>layer10_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="17383,-7618 16910,-7618 16910,-7535 17383,-7535 17383,-7618"/>
<text text-anchor="middle" x="17146.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="17146.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17146.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17146.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17146.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_ln1_15&#45;&gt;layer10_ffn_gate_15 -->
<g id="edge963" class="edge">
<title>layer10_ln1_15&#45;&gt;layer10_ffn_gate_15</title>
<path fill="none" stroke="black" d="M17284.13,-7654C17266.62,-7644.27 17247.14,-7633.44 17228.48,-7623.07"/>
<polygon fill="black" stroke="black" points="17230.13,-7619.98 17219.69,-7618.18 17226.73,-7626.1 17230.13,-7619.98"/>
</g>
<!-- layer10_ffn_up_15 -->
<g id="node845" class="node">
<title>layer10_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17874,-7618 17401,-7618 17401,-7535 17874,-7535 17874,-7618"/>
<text text-anchor="middle" x="17637.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17637.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17637.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17637.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17637.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_ln1_15&#45;&gt;layer10_ffn_up_15 -->
<g id="edge964" class="edge">
<title>layer10_ln1_15&#45;&gt;layer10_ffn_up_15</title>
<path fill="none" stroke="black" d="M17432.11,-7654C17459.49,-7643.8 17490.11,-7632.4 17519.17,-7621.57"/>
<polygon fill="black" stroke="black" points="17520.39,-7624.85 17528.54,-7618.08 17517.95,-7618.29 17520.39,-7624.85"/>
</g>
<!-- layer10_ffn_gate_8 -->
<g id="node830" class="node">
<title>layer10_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="9638,-7457.5 9165,-7457.5 9165,-7374.5 9638,-7374.5 9638,-7457.5"/>
<text text-anchor="middle" x="9401.5" y="-7442.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9401.5" y="-7427.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9401.5" y="-7412.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9401.5" y="-7397.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9401.5" y="-7382.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_ffn_act_8 -->
<g id="node859" class="node">
<title>layer10_ffn_act_8</title>
<polygon fill="none" stroke="black" points="9938.5,-7273.5 9798.5,-7273.5 9798.5,-7237.5 9938.5,-7237.5 9938.5,-7273.5"/>
<text text-anchor="middle" x="9868.5" y="-7251.8" font-family="Times,serif" font-size="14.00">layer10_ffn_act_8</text>
</g>
<!-- layer10_ffn_gate_8&#45;&gt;layer10_ffn_act_8 -->
<g id="edge888" class="edge">
<title>layer10_ffn_gate_8&#45;&gt;layer10_ffn_act_8</title>
<path fill="none" stroke="black" d="M9520.85,-7374.49C9612.74,-7343.31 9735.9,-7301.51 9808.27,-7276.94"/>
<polygon fill="black" stroke="black" points="9809.8,-7280.12 9818.14,-7273.59 9807.55,-7273.49 9809.8,-7280.12"/>
</g>
<!-- layer10_ffn_gate_9 -->
<g id="node831" class="node">
<title>layer10_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10445,-7618 9972,-7618 9972,-7535 10445,-7535 10445,-7618"/>
<text text-anchor="middle" x="10208.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10208.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10208.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10208.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10208.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_ffn_act_9 -->
<g id="node864" class="node">
<title>layer10_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10766.5,-7434 10626.5,-7434 10626.5,-7398 10766.5,-7398 10766.5,-7434"/>
<text text-anchor="middle" x="10696.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer10_ffn_act_9</text>
</g>
<!-- layer10_ffn_gate_9&#45;&gt;layer10_ffn_act_9 -->
<g id="edge899" class="edge">
<title>layer10_ffn_gate_9&#45;&gt;layer10_ffn_act_9</title>
<path fill="none" stroke="black" d="M10333.22,-7534.99C10429.43,-7503.74 10558.46,-7461.83 10634.03,-7437.29"/>
<polygon fill="black" stroke="black" points="10635.45,-7440.51 10643.88,-7434.09 10633.28,-7433.85 10635.45,-7440.51"/>
</g>
<!-- layer10_ffn_gate_10 -->
<g id="node832" class="node">
<title>layer10_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11929,-7618 11456,-7618 11456,-7535 11929,-7535 11929,-7618"/>
<text text-anchor="middle" x="11692.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11692.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11692.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11692.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11692.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_ffn_act_10 -->
<g id="node869" class="node">
<title>layer10_ffn_act_10</title>
<polygon fill="none" stroke="black" points="12214,-7434 12065,-7434 12065,-7398 12214,-7398 12214,-7434"/>
<text text-anchor="middle" x="12139.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer10_ffn_act_10</text>
</g>
<!-- layer10_ffn_gate_10&#45;&gt;layer10_ffn_act_10 -->
<g id="edge910" class="edge">
<title>layer10_ffn_gate_10&#45;&gt;layer10_ffn_act_10</title>
<path fill="none" stroke="black" d="M11806.74,-7534.99C11894.69,-7503.81 12012.58,-7462.01 12081.85,-7437.44"/>
<polygon fill="black" stroke="black" points="12083.04,-7440.73 12091.3,-7434.09 12080.7,-7434.14 12083.04,-7440.73"/>
</g>
<!-- layer10_ffn_gate_11 -->
<g id="node833" class="node">
<title>layer10_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="12926,-7618 12453,-7618 12453,-7535 12926,-7535 12926,-7618"/>
<text text-anchor="middle" x="12689.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12689.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12689.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12689.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12689.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_ffn_act_11 -->
<g id="node874" class="node">
<title>layer10_ffn_act_11</title>
<polygon fill="none" stroke="black" points="13011,-7434 12862,-7434 12862,-7398 13011,-7398 13011,-7434"/>
<text text-anchor="middle" x="12936.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer10_ffn_act_11</text>
</g>
<!-- layer10_ffn_gate_11&#45;&gt;layer10_ffn_act_11 -->
<g id="edge921" class="edge">
<title>layer10_ffn_gate_11&#45;&gt;layer10_ffn_act_11</title>
<path fill="none" stroke="black" d="M12752.79,-7534.89C12799.9,-7504.66 12862.48,-7464.5 12901.1,-7439.72"/>
<polygon fill="black" stroke="black" points="12903.37,-7442.42 12909.9,-7434.07 12899.59,-7436.52 12903.37,-7442.42"/>
</g>
<!-- layer10_ffn_gate_12 -->
<g id="node834" class="node">
<title>layer10_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="13932,-7618 13459,-7618 13459,-7535 13932,-7535 13932,-7618"/>
<text text-anchor="middle" x="13695.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13695.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13695.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13695.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13695.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_ffn_act_12 -->
<g id="node879" class="node">
<title>layer10_ffn_act_12</title>
<polygon fill="none" stroke="black" points="14098,-7434 13949,-7434 13949,-7398 14098,-7398 14098,-7434"/>
<text text-anchor="middle" x="14023.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer10_ffn_act_12</text>
</g>
<!-- layer10_ffn_gate_12&#45;&gt;layer10_ffn_act_12 -->
<g id="edge932" class="edge">
<title>layer10_ffn_gate_12&#45;&gt;layer10_ffn_act_12</title>
<path fill="none" stroke="black" d="M13779.54,-7534.89C13843.15,-7504.15 13928.02,-7463.14 13979.05,-7438.48"/>
<polygon fill="black" stroke="black" points="13980.7,-7441.57 13988.18,-7434.07 13977.65,-7435.27 13980.7,-7441.57"/>
</g>
<!-- layer10_ffn_gate_13 -->
<g id="node835" class="node">
<title>layer10_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="14962,-7618 14489,-7618 14489,-7535 14962,-7535 14962,-7618"/>
<text text-anchor="middle" x="14725.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14725.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14725.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14725.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14725.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_ffn_act_13 -->
<g id="node884" class="node">
<title>layer10_ffn_act_13</title>
<polygon fill="none" stroke="black" points="15244,-7434 15095,-7434 15095,-7398 15244,-7398 15244,-7434"/>
<text text-anchor="middle" x="15169.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer10_ffn_act_13</text>
</g>
<!-- layer10_ffn_gate_13&#45;&gt;layer10_ffn_act_13 -->
<g id="edge943" class="edge">
<title>layer10_ffn_gate_13&#45;&gt;layer10_ffn_act_13</title>
<path fill="none" stroke="black" d="M14838.98,-7534.99C14926.16,-7503.87 15042.95,-7462.18 15111.82,-7437.59"/>
<polygon fill="black" stroke="black" points="15113.38,-7440.75 15121.62,-7434.09 15111.03,-7434.16 15113.38,-7440.75"/>
</g>
<!-- layer10_ffn_gate_14 -->
<g id="node836" class="node">
<title>layer10_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="16357,-7618 15884,-7618 15884,-7535 16357,-7535 16357,-7618"/>
<text text-anchor="middle" x="16120.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16120.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16120.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16120.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16120.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_ffn_act_14 -->
<g id="node889" class="node">
<title>layer10_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16664,-7434 16515,-7434 16515,-7398 16664,-7398 16664,-7434"/>
<text text-anchor="middle" x="16589.5" y="-7412.3" font-family="Times,serif" font-size="14.00">layer10_ffn_act_14</text>
</g>
<!-- layer10_ffn_gate_14&#45;&gt;layer10_ffn_act_14 -->
<g id="edge954" class="edge">
<title>layer10_ffn_gate_14&#45;&gt;layer10_ffn_act_14</title>
<path fill="none" stroke="black" d="M16240.37,-7534.99C16332.64,-7503.81 16456.33,-7462.01 16529.02,-7437.44"/>
<polygon fill="black" stroke="black" points="16530.57,-7440.61 16538.92,-7434.09 16528.33,-7433.98 16530.57,-7440.61"/>
</g>
<!-- layer10_ffn_act_15 -->
<g id="node846" class="node">
<title>layer10_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17644.24,-7499 16887.44,-7499 16692.76,-7333 17449.56,-7333 17644.24,-7499"/>
<text text-anchor="middle" x="17168.5" y="-7442.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="17168.5" y="-7427.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="17168.5" y="-7412.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17168.5" y="-7397.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17168.5" y="-7382.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_ffn_gate_15&#45;&gt;layer10_ffn_act_15 -->
<g id="edge965" class="edge">
<title>layer10_ffn_gate_15&#45;&gt;layer10_ffn_act_15</title>
<path fill="none" stroke="black" d="M17152.17,-7534.68C17153.27,-7526.75 17154.46,-7518.14 17155.69,-7509.31"/>
<polygon fill="black" stroke="black" points="17159.17,-7509.66 17157.08,-7499.27 17152.24,-7508.7 17159.17,-7509.66"/>
</g>
<!-- layer10_ffn_up_8 -->
<g id="node838" class="node">
<title>layer10_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10129,-7457.5 9656,-7457.5 9656,-7374.5 10129,-7374.5 10129,-7457.5"/>
<text text-anchor="middle" x="9892.5" y="-7442.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9892.5" y="-7427.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9892.5" y="-7412.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9892.5" y="-7397.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9892.5" y="-7382.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_ffn_up_8&#45;&gt;layer10_ffn_act_8 -->
<g id="edge889" class="edge">
<title>layer10_ffn_up_8&#45;&gt;layer10_ffn_act_8</title>
<path fill="none" stroke="black" d="M9886.32,-7374.18C9882.01,-7345.74 9876.39,-7308.58 9872.62,-7283.7"/>
<polygon fill="black" stroke="black" points="9876.04,-7282.89 9871.08,-7273.52 9869.11,-7283.93 9876.04,-7282.89"/>
</g>
<!-- layer10_ffn_up_9 -->
<g id="node839" class="node">
<title>layer10_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="10936,-7618 10463,-7618 10463,-7535 10936,-7535 10936,-7618"/>
<text text-anchor="middle" x="10699.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10699.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10699.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10699.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10699.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_ffn_up_9&#45;&gt;layer10_ffn_act_9 -->
<g id="edge900" class="edge">
<title>layer10_ffn_up_9&#45;&gt;layer10_ffn_act_9</title>
<path fill="none" stroke="black" d="M10698.73,-7534.68C10698.19,-7506.24 10697.49,-7469.08 10697.01,-7444.2"/>
<polygon fill="black" stroke="black" points="10700.51,-7443.96 10696.82,-7434.02 10693.51,-7444.09 10700.51,-7443.96"/>
</g>
<!-- layer10_ffn_up_10 -->
<g id="node840" class="node">
<title>layer10_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12420,-7618 11947,-7618 11947,-7535 12420,-7535 12420,-7618"/>
<text text-anchor="middle" x="12183.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12183.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12183.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12183.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12183.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_ffn_up_10&#45;&gt;layer10_ffn_act_10 -->
<g id="edge911" class="edge">
<title>layer10_ffn_up_10&#45;&gt;layer10_ffn_act_10</title>
<path fill="none" stroke="black" d="M12172.17,-7534.68C12164.24,-7506.11 12153.86,-7468.74 12146.96,-7443.86"/>
<polygon fill="black" stroke="black" points="12150.27,-7442.72 12144.23,-7434.02 12143.53,-7444.6 12150.27,-7442.72"/>
</g>
<!-- layer10_ffn_up_11 -->
<g id="node841" class="node">
<title>layer10_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13417,-7618 12944,-7618 12944,-7535 13417,-7535 13417,-7618"/>
<text text-anchor="middle" x="13180.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13180.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13180.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13180.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13180.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_ffn_up_11&#45;&gt;layer10_ffn_act_11 -->
<g id="edge922" class="edge">
<title>layer10_ffn_up_11&#45;&gt;layer10_ffn_act_11</title>
<path fill="none" stroke="black" d="M13117.98,-7534.89C13071.44,-7504.66 13009.62,-7464.5 12971.47,-7439.72"/>
<polygon fill="black" stroke="black" points="12973.07,-7436.58 12962.78,-7434.07 12969.26,-7442.45 12973.07,-7436.58"/>
</g>
<!-- layer10_ffn_up_12 -->
<g id="node842" class="node">
<title>layer10_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14423,-7618 13950,-7618 13950,-7535 14423,-7535 14423,-7618"/>
<text text-anchor="middle" x="14186.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14186.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14186.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14186.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14186.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_ffn_up_12&#45;&gt;layer10_ffn_act_12 -->
<g id="edge933" class="edge">
<title>layer10_ffn_up_12&#45;&gt;layer10_ffn_act_12</title>
<path fill="none" stroke="black" d="M14144.52,-7534.68C14114.09,-7505.09 14073.96,-7466.06 14048.43,-7441.24"/>
<polygon fill="black" stroke="black" points="14050.62,-7438.49 14041.01,-7434.02 14045.74,-7443.5 14050.62,-7438.49"/>
</g>
<!-- layer10_ffn_up_13 -->
<g id="node843" class="node">
<title>layer10_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15453,-7618 14980,-7618 14980,-7535 15453,-7535 15453,-7618"/>
<text text-anchor="middle" x="15216.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15216.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15216.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15216.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15216.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_ffn_up_13&#45;&gt;layer10_ffn_act_13 -->
<g id="edge944" class="edge">
<title>layer10_ffn_up_13&#45;&gt;layer10_ffn_act_13</title>
<path fill="none" stroke="black" d="M15204.4,-7534.68C15195.92,-7506.11 15184.84,-7468.74 15177.47,-7443.86"/>
<polygon fill="black" stroke="black" points="15180.75,-7442.62 15174.55,-7434.02 15174.04,-7444.61 15180.75,-7442.62"/>
</g>
<!-- layer10_ffn_up_14 -->
<g id="node844" class="node">
<title>layer10_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16848,-7618 16375,-7618 16375,-7535 16848,-7535 16848,-7618"/>
<text text-anchor="middle" x="16611.5" y="-7602.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16611.5" y="-7587.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16611.5" y="-7572.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16611.5" y="-7557.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16611.5" y="-7542.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_ffn_up_14&#45;&gt;layer10_ffn_act_14 -->
<g id="edge955" class="edge">
<title>layer10_ffn_up_14&#45;&gt;layer10_ffn_act_14</title>
<path fill="none" stroke="black" d="M16605.83,-7534.68C16601.89,-7506.24 16596.73,-7469.08 16593.27,-7444.2"/>
<polygon fill="black" stroke="black" points="16596.7,-7443.45 16591.86,-7434.02 16589.77,-7444.41 16596.7,-7443.45"/>
</g>
<!-- layer10_ffn_up_15&#45;&gt;layer10_ffn_act_15 -->
<g id="edge966" class="edge">
<title>layer10_ffn_up_15&#45;&gt;layer10_ffn_act_15</title>
<path fill="none" stroke="black" d="M17517.63,-7534.99C17487.74,-7524.89 17454.55,-7513.67 17420.87,-7502.29"/>
<polygon fill="black" stroke="black" points="17421.95,-7498.96 17411.36,-7499.07 17419.71,-7505.59 17421.95,-7498.96"/>
</g>
<!-- layer10_ffn_down_15 -->
<g id="node854" class="node">
<title>layer10_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17392,-7297 16945,-7297 16945,-7214 17392,-7214 17392,-7297"/>
<text text-anchor="middle" x="17168.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="17168.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17168.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17168.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17168.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_ffn_act_15&#45;&gt;layer10_ffn_down_15 -->
<g id="edge967" class="edge">
<title>layer10_ffn_act_15&#45;&gt;layer10_ffn_down_15</title>
<path fill="none" stroke="black" d="M17168.5,-7332.96C17168.5,-7324.25 17168.5,-7315.59 17168.5,-7307.39"/>
<polygon fill="black" stroke="black" points="17172,-7307.29 17168.5,-7297.29 17165,-7307.29 17172,-7307.29"/>
</g>
<!-- layer10_ffn_down_8 -->
<g id="node847" class="node">
<title>layer10_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="10092,-7136.5 9645,-7136.5 9645,-7053.5 10092,-7053.5 10092,-7136.5"/>
<text text-anchor="middle" x="9868.5" y="-7121.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9868.5" y="-7106.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9868.5" y="-7091.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9868.5" y="-7076.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9868.5" y="-7061.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_res2_8 -->
<g id="node860" class="node">
<title>layer10_res2_8</title>
<polygon fill="none" stroke="black" points="9931,-6952.5 9806,-6952.5 9806,-6916.5 9931,-6916.5 9931,-6952.5"/>
<text text-anchor="middle" x="9868.5" y="-6930.8" font-family="Times,serif" font-size="14.00">layer10_res2_8</text>
</g>
<!-- layer10_ffn_down_8&#45;&gt;layer10_res2_8 -->
<g id="edge891" class="edge">
<title>layer10_ffn_down_8&#45;&gt;layer10_res2_8</title>
<path fill="none" stroke="black" d="M9868.5,-7053.18C9868.5,-7024.74 9868.5,-6987.58 9868.5,-6962.7"/>
<polygon fill="black" stroke="black" points="9872,-6962.52 9868.5,-6952.52 9865,-6962.52 9872,-6962.52"/>
</g>
<!-- layer10_ffn_down_9 -->
<g id="node848" class="node">
<title>layer10_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="10920,-7297 10473,-7297 10473,-7214 10920,-7214 10920,-7297"/>
<text text-anchor="middle" x="10696.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10696.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10696.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10696.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10696.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_res2_9 -->
<g id="node865" class="node">
<title>layer10_res2_9</title>
<polygon fill="none" stroke="black" points="10759,-7113 10634,-7113 10634,-7077 10759,-7077 10759,-7113"/>
<text text-anchor="middle" x="10696.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer10_res2_9</text>
</g>
<!-- layer10_ffn_down_9&#45;&gt;layer10_res2_9 -->
<g id="edge902" class="edge">
<title>layer10_ffn_down_9&#45;&gt;layer10_res2_9</title>
<path fill="none" stroke="black" d="M10696.5,-7213.68C10696.5,-7185.24 10696.5,-7148.08 10696.5,-7123.2"/>
<polygon fill="black" stroke="black" points="10700,-7123.02 10696.5,-7113.02 10693,-7123.02 10700,-7123.02"/>
</g>
<!-- layer10_ffn_down_10 -->
<g id="node849" class="node">
<title>layer10_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="12363,-7297 11916,-7297 11916,-7214 12363,-7214 12363,-7297"/>
<text text-anchor="middle" x="12139.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12139.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12139.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12139.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12139.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_res2_10 -->
<g id="node870" class="node">
<title>layer10_res2_10</title>
<polygon fill="none" stroke="black" points="12206.5,-7113 12072.5,-7113 12072.5,-7077 12206.5,-7077 12206.5,-7113"/>
<text text-anchor="middle" x="12139.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer10_res2_10</text>
</g>
<!-- layer10_ffn_down_10&#45;&gt;layer10_res2_10 -->
<g id="edge913" class="edge">
<title>layer10_ffn_down_10&#45;&gt;layer10_res2_10</title>
<path fill="none" stroke="black" d="M12139.5,-7213.68C12139.5,-7185.24 12139.5,-7148.08 12139.5,-7123.2"/>
<polygon fill="black" stroke="black" points="12143,-7123.02 12139.5,-7113.02 12136,-7123.02 12143,-7123.02"/>
</g>
<!-- layer10_ffn_down_11 -->
<g id="node850" class="node">
<title>layer10_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="13160,-7297 12713,-7297 12713,-7214 13160,-7214 13160,-7297"/>
<text text-anchor="middle" x="12936.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12936.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12936.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12936.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12936.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_res2_11 -->
<g id="node875" class="node">
<title>layer10_res2_11</title>
<polygon fill="none" stroke="black" points="13003.5,-7113 12869.5,-7113 12869.5,-7077 13003.5,-7077 13003.5,-7113"/>
<text text-anchor="middle" x="12936.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer10_res2_11</text>
</g>
<!-- layer10_ffn_down_11&#45;&gt;layer10_res2_11 -->
<g id="edge924" class="edge">
<title>layer10_ffn_down_11&#45;&gt;layer10_res2_11</title>
<path fill="none" stroke="black" d="M12936.5,-7213.68C12936.5,-7185.24 12936.5,-7148.08 12936.5,-7123.2"/>
<polygon fill="black" stroke="black" points="12940,-7123.02 12936.5,-7113.02 12933,-7123.02 12940,-7123.02"/>
</g>
<!-- layer10_ffn_down_12 -->
<g id="node851" class="node">
<title>layer10_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14247,-7297 13800,-7297 13800,-7214 14247,-7214 14247,-7297"/>
<text text-anchor="middle" x="14023.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14023.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14023.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14023.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14023.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_res2_12 -->
<g id="node880" class="node">
<title>layer10_res2_12</title>
<polygon fill="none" stroke="black" points="14090.5,-7113 13956.5,-7113 13956.5,-7077 14090.5,-7077 14090.5,-7113"/>
<text text-anchor="middle" x="14023.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer10_res2_12</text>
</g>
<!-- layer10_ffn_down_12&#45;&gt;layer10_res2_12 -->
<g id="edge935" class="edge">
<title>layer10_ffn_down_12&#45;&gt;layer10_res2_12</title>
<path fill="none" stroke="black" d="M14023.5,-7213.68C14023.5,-7185.24 14023.5,-7148.08 14023.5,-7123.2"/>
<polygon fill="black" stroke="black" points="14027,-7123.02 14023.5,-7113.02 14020,-7123.02 14027,-7123.02"/>
</g>
<!-- layer10_ffn_down_13 -->
<g id="node852" class="node">
<title>layer10_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="15393,-7297 14946,-7297 14946,-7214 15393,-7214 15393,-7297"/>
<text text-anchor="middle" x="15169.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15169.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15169.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="15169.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15169.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_res2_13 -->
<g id="node885" class="node">
<title>layer10_res2_13</title>
<polygon fill="none" stroke="black" points="15236.5,-7113 15102.5,-7113 15102.5,-7077 15236.5,-7077 15236.5,-7113"/>
<text text-anchor="middle" x="15169.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer10_res2_13</text>
</g>
<!-- layer10_ffn_down_13&#45;&gt;layer10_res2_13 -->
<g id="edge946" class="edge">
<title>layer10_ffn_down_13&#45;&gt;layer10_res2_13</title>
<path fill="none" stroke="black" d="M15169.5,-7213.68C15169.5,-7185.24 15169.5,-7148.08 15169.5,-7123.2"/>
<polygon fill="black" stroke="black" points="15173,-7123.02 15169.5,-7113.02 15166,-7123.02 15173,-7123.02"/>
</g>
<!-- layer10_ffn_down_14 -->
<g id="node853" class="node">
<title>layer10_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16813,-7297 16366,-7297 16366,-7214 16813,-7214 16813,-7297"/>
<text text-anchor="middle" x="16589.5" y="-7281.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16589.5" y="-7266.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16589.5" y="-7251.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16589.5" y="-7236.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16589.5" y="-7221.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_res2_14 -->
<g id="node890" class="node">
<title>layer10_res2_14</title>
<polygon fill="none" stroke="black" points="16656.5,-7113 16522.5,-7113 16522.5,-7077 16656.5,-7077 16656.5,-7113"/>
<text text-anchor="middle" x="16589.5" y="-7091.3" font-family="Times,serif" font-size="14.00">layer10_res2_14</text>
</g>
<!-- layer10_ffn_down_14&#45;&gt;layer10_res2_14 -->
<g id="edge957" class="edge">
<title>layer10_ffn_down_14&#45;&gt;layer10_res2_14</title>
<path fill="none" stroke="black" d="M16589.5,-7213.68C16589.5,-7185.24 16589.5,-7148.08 16589.5,-7123.2"/>
<polygon fill="black" stroke="black" points="16593,-7123.02 16589.5,-7113.02 16586,-7123.02 16593,-7123.02"/>
</g>
<!-- layer10_res2_15 -->
<g id="node855" class="node">
<title>layer10_res2_15</title>
<polygon fill="none" stroke="black" points="17609.24,-7178 16908.12,-7178 16727.76,-7012 17428.88,-7012 17609.24,-7178"/>
<text text-anchor="middle" x="17168.5" y="-7121.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17168.5" y="-7106.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-7091.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-7076.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-7061.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer10_ffn_down_15&#45;&gt;layer10_res2_15 -->
<g id="edge968" class="edge">
<title>layer10_ffn_down_15&#45;&gt;layer10_res2_15</title>
<path fill="none" stroke="black" d="M17168.5,-7213.68C17168.5,-7205.75 17168.5,-7197.14 17168.5,-7188.31"/>
<polygon fill="black" stroke="black" points="17172,-7188.27 17168.5,-7178.27 17165,-7188.27 17172,-7188.27"/>
</g>
<!-- layer11_mha_qkv_15 -->
<g id="node898" class="node">
<title>layer11_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17446.5,-6976 16890.5,-6976 16890.5,-6893 17446.5,-6893 17446.5,-6976"/>
<text text-anchor="middle" x="17168.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="17168.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17168.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="17168.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer10_res2_15&#45;&gt;layer11_mha_qkv_15 -->
<g id="edge1046" class="edge">
<title>layer10_res2_15&#45;&gt;layer11_mha_qkv_15</title>
<path fill="none" stroke="black" d="M17168.5,-7011.96C17168.5,-7003.25 17168.5,-6994.59 17168.5,-6986.39"/>
<polygon fill="black" stroke="black" points="17172,-6986.29 17168.5,-6976.29 17165,-6986.29 17172,-6986.29"/>
</g>
<!-- layer10_mha_attn_8&#45;&gt;layer10_mha_out_8 -->
<g id="edge883" class="edge">
<title>layer10_mha_attn_8&#45;&gt;layer10_mha_out_8</title>
<path fill="none" stroke="black" d="M9453.5,-7983.24C9453.5,-7961.68 9453.5,-7923.87 9453.5,-7892.79"/>
<polygon fill="black" stroke="black" points="9457,-7892.54 9453.5,-7882.54 9450,-7892.54 9457,-7892.54"/>
</g>
<!-- layer10_ln1_8 -->
<g id="node858" class="node">
<title>layer10_ln1_8</title>
<polygon fill="none" stroke="black" points="9511.5,-7594.5 9395.5,-7594.5 9395.5,-7558.5 9511.5,-7558.5 9511.5,-7594.5"/>
<text text-anchor="middle" x="9453.5" y="-7572.8" font-family="Times,serif" font-size="14.00">layer10_ln1_8</text>
</g>
<!-- layer10_res1_8&#45;&gt;layer10_ln1_8 -->
<g id="edge885" class="edge">
<title>layer10_res1_8&#45;&gt;layer10_ln1_8</title>
<path fill="none" stroke="black" d="M9453.5,-7669.89C9453.5,-7652.56 9453.5,-7625.46 9453.5,-7605.09"/>
<polygon fill="black" stroke="black" points="9457,-7604.85 9453.5,-7594.85 9450,-7604.85 9457,-7604.85"/>
</g>
<!-- layer10_ln1_8&#45;&gt;layer10_ffn_gate_8 -->
<g id="edge886" class="edge">
<title>layer10_ln1_8&#45;&gt;layer10_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9447.84,-7558.24C9440.73,-7536.59 9428.25,-7498.54 9418.03,-7467.38"/>
<polygon fill="black" stroke="black" points="9421.24,-7465.95 9414.8,-7457.54 9414.59,-7468.13 9421.24,-7465.95"/>
</g>
<!-- layer10_ln1_8&#45;&gt;layer10_ffn_up_8 -->
<g id="edge887" class="edge">
<title>layer10_ln1_8&#45;&gt;layer10_ffn_up_8</title>
<path fill="none" stroke="black" d="M9500.9,-7558.39C9564.86,-7535.29 9681.07,-7493.34 9770.34,-7461.11"/>
<polygon fill="black" stroke="black" points="9771.77,-7464.31 9779.99,-7457.62 9769.39,-7457.73 9771.77,-7464.31"/>
</g>
<!-- layer10_ffn_act_8&#45;&gt;layer10_ffn_down_8 -->
<g id="edge890" class="edge">
<title>layer10_ffn_act_8&#45;&gt;layer10_ffn_down_8</title>
<path fill="none" stroke="black" d="M9868.5,-7237.24C9868.5,-7215.68 9868.5,-7177.87 9868.5,-7146.79"/>
<polygon fill="black" stroke="black" points="9872,-7146.54 9868.5,-7136.54 9865,-7146.54 9872,-7146.54"/>
</g>
<!-- layer11_mha_qkv_8 -->
<g id="node891" class="node">
<title>layer11_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="10146.5,-6815.5 9590.5,-6815.5 9590.5,-6732.5 10146.5,-6732.5 10146.5,-6815.5"/>
<text text-anchor="middle" x="9868.5" y="-6800.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9868.5" y="-6785.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9868.5" y="-6770.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9868.5" y="-6755.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9868.5" y="-6740.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer10_res2_8&#45;&gt;layer11_mha_qkv_8 -->
<g id="edge969" class="edge">
<title>layer10_res2_8&#45;&gt;layer11_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9868.5,-6916.24C9868.5,-6894.68 9868.5,-6856.87 9868.5,-6825.79"/>
<polygon fill="black" stroke="black" points="9872,-6825.54 9868.5,-6815.54 9865,-6825.54 9872,-6825.54"/>
</g>
<!-- layer10_mha_attn_9&#45;&gt;layer10_mha_out_9 -->
<g id="edge894" class="edge">
<title>layer10_mha_attn_9&#45;&gt;layer10_mha_out_9</title>
<path fill="none" stroke="black" d="M10692.5,-8143.74C10692.5,-8122.18 10692.5,-8084.37 10692.5,-8053.29"/>
<polygon fill="black" stroke="black" points="10696,-8053.04 10692.5,-8043.04 10689,-8053.04 10696,-8053.04"/>
</g>
<!-- layer10_ln1_9 -->
<g id="node863" class="node">
<title>layer10_ln1_9</title>
<polygon fill="none" stroke="black" points="10750.5,-7706 10634.5,-7706 10634.5,-7670 10750.5,-7670 10750.5,-7706"/>
<text text-anchor="middle" x="10692.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_ln1_9</text>
</g>
<!-- layer10_res1_9&#45;&gt;layer10_ln1_9 -->
<g id="edge896" class="edge">
<title>layer10_res1_9&#45;&gt;layer10_ln1_9</title>
<path fill="none" stroke="black" d="M10692.5,-7822.97C10692.5,-7797.03 10692.5,-7747.36 10692.5,-7716.33"/>
<polygon fill="black" stroke="black" points="10696,-7716.2 10692.5,-7706.2 10689,-7716.2 10696,-7716.2"/>
</g>
<!-- layer10_ln1_9&#45;&gt;layer10_ffn_gate_9 -->
<g id="edge897" class="edge">
<title>layer10_ln1_9&#45;&gt;layer10_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10634.12,-7673.79C10575.53,-7660.54 10482.11,-7639.4 10397.7,-7620.3"/>
<polygon fill="black" stroke="black" points="10398.24,-7616.84 10387.72,-7618.05 10396.7,-7623.67 10398.24,-7616.84"/>
</g>
<!-- layer10_ln1_9&#45;&gt;layer10_ffn_up_9 -->
<g id="edge898" class="edge">
<title>layer10_ln1_9&#45;&gt;layer10_ffn_up_9</title>
<path fill="none" stroke="black" d="M10693.59,-7669.89C10694.31,-7658.65 10695.29,-7643.31 10696.25,-7628.35"/>
<polygon fill="black" stroke="black" points="10699.76,-7628.32 10696.9,-7618.12 10692.77,-7627.87 10699.76,-7628.32"/>
</g>
<!-- layer10_ffn_act_9&#45;&gt;layer10_ffn_down_9 -->
<g id="edge901" class="edge">
<title>layer10_ffn_act_9&#45;&gt;layer10_ffn_down_9</title>
<path fill="none" stroke="black" d="M10696.5,-7397.74C10696.5,-7376.18 10696.5,-7338.37 10696.5,-7307.29"/>
<polygon fill="black" stroke="black" points="10700,-7307.04 10696.5,-7297.04 10693,-7307.04 10700,-7307.04"/>
</g>
<!-- layer11_mha_qkv_9 -->
<g id="node892" class="node">
<title>layer11_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="10974.5,-6976 10418.5,-6976 10418.5,-6893 10974.5,-6893 10974.5,-6976"/>
<text text-anchor="middle" x="10696.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10696.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10696.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10696.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10696.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer10_res2_9&#45;&gt;layer11_mha_qkv_9 -->
<g id="edge980" class="edge">
<title>layer10_res2_9&#45;&gt;layer11_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10696.5,-7076.74C10696.5,-7055.18 10696.5,-7017.37 10696.5,-6986.29"/>
<polygon fill="black" stroke="black" points="10700,-6986.04 10696.5,-6976.04 10693,-6986.04 10700,-6986.04"/>
</g>
<!-- layer10_mha_attn_10&#45;&gt;layer10_mha_out_10 -->
<g id="edge905" class="edge">
<title>layer10_mha_attn_10&#45;&gt;layer10_mha_out_10</title>
<path fill="none" stroke="black" d="M11692.5,-8143.74C11692.5,-8122.18 11692.5,-8084.37 11692.5,-8053.29"/>
<polygon fill="black" stroke="black" points="11696,-8053.04 11692.5,-8043.04 11689,-8053.04 11696,-8053.04"/>
</g>
<!-- layer10_ln1_10 -->
<g id="node868" class="node">
<title>layer10_ln1_10</title>
<polygon fill="none" stroke="black" points="11755,-7706 11630,-7706 11630,-7670 11755,-7670 11755,-7706"/>
<text text-anchor="middle" x="11692.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_ln1_10</text>
</g>
<!-- layer10_res1_10&#45;&gt;layer10_ln1_10 -->
<g id="edge907" class="edge">
<title>layer10_res1_10&#45;&gt;layer10_ln1_10</title>
<path fill="none" stroke="black" d="M11692.5,-7822.97C11692.5,-7797.03 11692.5,-7747.36 11692.5,-7716.33"/>
<polygon fill="black" stroke="black" points="11696,-7716.2 11692.5,-7706.2 11689,-7716.2 11696,-7716.2"/>
</g>
<!-- layer10_ln1_10&#45;&gt;layer10_ffn_gate_10 -->
<g id="edge908" class="edge">
<title>layer10_ln1_10&#45;&gt;layer10_ffn_gate_10</title>
<path fill="none" stroke="black" d="M11692.5,-7669.89C11692.5,-7658.65 11692.5,-7643.31 11692.5,-7628.35"/>
<polygon fill="black" stroke="black" points="11696,-7628.12 11692.5,-7618.12 11689,-7628.12 11696,-7628.12"/>
</g>
<!-- layer10_ln1_10&#45;&gt;layer10_ffn_up_10 -->
<g id="edge909" class="edge">
<title>layer10_ln1_10&#45;&gt;layer10_ffn_up_10</title>
<path fill="none" stroke="black" d="M11755.18,-7673.02C11814.87,-7659.71 11907.81,-7638.98 11991.88,-7620.23"/>
<polygon fill="black" stroke="black" points="11992.83,-7623.61 12001.83,-7618.02 11991.3,-7616.78 11992.83,-7623.61"/>
</g>
<!-- layer10_ffn_act_10&#45;&gt;layer10_ffn_down_10 -->
<g id="edge912" class="edge">
<title>layer10_ffn_act_10&#45;&gt;layer10_ffn_down_10</title>
<path fill="none" stroke="black" d="M12139.5,-7397.74C12139.5,-7376.18 12139.5,-7338.37 12139.5,-7307.29"/>
<polygon fill="black" stroke="black" points="12143,-7307.04 12139.5,-7297.04 12136,-7307.04 12143,-7307.04"/>
</g>
<!-- layer11_mha_qkv_10 -->
<g id="node893" class="node">
<title>layer11_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="12417.5,-6976 11861.5,-6976 11861.5,-6893 12417.5,-6893 12417.5,-6976"/>
<text text-anchor="middle" x="12139.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12139.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12139.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12139.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12139.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer10_res2_10&#45;&gt;layer11_mha_qkv_10 -->
<g id="edge991" class="edge">
<title>layer10_res2_10&#45;&gt;layer11_mha_qkv_10</title>
<path fill="none" stroke="black" d="M12139.5,-7076.74C12139.5,-7055.18 12139.5,-7017.37 12139.5,-6986.29"/>
<polygon fill="black" stroke="black" points="12143,-6986.04 12139.5,-6976.04 12136,-6986.04 12143,-6986.04"/>
</g>
<!-- layer10_mha_attn_11&#45;&gt;layer10_mha_out_11 -->
<g id="edge916" class="edge">
<title>layer10_mha_attn_11&#45;&gt;layer10_mha_out_11</title>
<path fill="none" stroke="black" d="M13051.5,-8143.74C13051.5,-8122.18 13051.5,-8084.37 13051.5,-8053.29"/>
<polygon fill="black" stroke="black" points="13055,-8053.04 13051.5,-8043.04 13048,-8053.04 13055,-8053.04"/>
</g>
<!-- layer10_ln1_11 -->
<g id="node873" class="node">
<title>layer10_ln1_11</title>
<polygon fill="none" stroke="black" points="13114,-7706 12989,-7706 12989,-7670 13114,-7670 13114,-7706"/>
<text text-anchor="middle" x="13051.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_ln1_11</text>
</g>
<!-- layer10_res1_11&#45;&gt;layer10_ln1_11 -->
<g id="edge918" class="edge">
<title>layer10_res1_11&#45;&gt;layer10_ln1_11</title>
<path fill="none" stroke="black" d="M13051.5,-7822.97C13051.5,-7797.03 13051.5,-7747.36 13051.5,-7716.33"/>
<polygon fill="black" stroke="black" points="13055,-7716.2 13051.5,-7706.2 13048,-7716.2 13055,-7716.2"/>
</g>
<!-- layer10_ln1_11&#45;&gt;layer10_ffn_gate_11 -->
<g id="edge919" class="edge">
<title>layer10_ln1_11&#45;&gt;layer10_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12994.94,-7669.89C12951.61,-7656.78 12889.84,-7638.1 12833.17,-7620.96"/>
<polygon fill="black" stroke="black" points="12833.98,-7617.55 12823.4,-7618 12831.95,-7624.25 12833.98,-7617.55"/>
</g>
<!-- layer10_ln1_11&#45;&gt;layer10_ffn_up_11 -->
<g id="edge920" class="edge">
<title>layer10_ln1_11&#45;&gt;layer10_ffn_up_11</title>
<path fill="none" stroke="black" d="M13071.66,-7669.89C13085.98,-7657.73 13105.96,-7640.77 13124.9,-7624.7"/>
<polygon fill="black" stroke="black" points="13127.29,-7627.26 13132.65,-7618.12 13122.76,-7621.92 13127.29,-7627.26"/>
</g>
<!-- layer10_ffn_act_11&#45;&gt;layer10_ffn_down_11 -->
<g id="edge923" class="edge">
<title>layer10_ffn_act_11&#45;&gt;layer10_ffn_down_11</title>
<path fill="none" stroke="black" d="M12936.5,-7397.74C12936.5,-7376.18 12936.5,-7338.37 12936.5,-7307.29"/>
<polygon fill="black" stroke="black" points="12940,-7307.04 12936.5,-7297.04 12933,-7307.04 12940,-7307.04"/>
</g>
<!-- layer11_mha_qkv_11 -->
<g id="node894" class="node">
<title>layer11_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="13214.5,-6976 12658.5,-6976 12658.5,-6893 13214.5,-6893 13214.5,-6976"/>
<text text-anchor="middle" x="12936.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12936.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12936.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12936.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12936.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer10_res2_11&#45;&gt;layer11_mha_qkv_11 -->
<g id="edge1002" class="edge">
<title>layer10_res2_11&#45;&gt;layer11_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12936.5,-7076.74C12936.5,-7055.18 12936.5,-7017.37 12936.5,-6986.29"/>
<polygon fill="black" stroke="black" points="12940,-6986.04 12936.5,-6976.04 12933,-6986.04 12940,-6986.04"/>
</g>
<!-- layer10_mha_attn_12&#45;&gt;layer10_mha_out_12 -->
<g id="edge927" class="edge">
<title>layer10_mha_attn_12&#45;&gt;layer10_mha_out_12</title>
<path fill="none" stroke="black" d="M14150.5,-8143.74C14150.5,-8122.18 14150.5,-8084.37 14150.5,-8053.29"/>
<polygon fill="black" stroke="black" points="14154,-8053.04 14150.5,-8043.04 14147,-8053.04 14154,-8053.04"/>
</g>
<!-- layer10_ln1_12 -->
<g id="node878" class="node">
<title>layer10_ln1_12</title>
<polygon fill="none" stroke="black" points="14213,-7706 14088,-7706 14088,-7670 14213,-7670 14213,-7706"/>
<text text-anchor="middle" x="14150.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_ln1_12</text>
</g>
<!-- layer10_res1_12&#45;&gt;layer10_ln1_12 -->
<g id="edge929" class="edge">
<title>layer10_res1_12&#45;&gt;layer10_ln1_12</title>
<path fill="none" stroke="black" d="M14150.5,-7822.97C14150.5,-7797.03 14150.5,-7747.36 14150.5,-7716.33"/>
<polygon fill="black" stroke="black" points="14154,-7716.2 14150.5,-7706.2 14147,-7716.2 14154,-7716.2"/>
</g>
<!-- layer10_ln1_12&#45;&gt;layer10_ffn_gate_12 -->
<g id="edge930" class="edge">
<title>layer10_ln1_12&#45;&gt;layer10_ffn_gate_12</title>
<path fill="none" stroke="black" d="M14087.71,-7671.89C14032.53,-7658.61 13949.49,-7638.63 13874.01,-7620.46"/>
<polygon fill="black" stroke="black" points="13874.43,-7616.96 13863.89,-7618.02 13872.79,-7623.77 13874.43,-7616.96"/>
</g>
<!-- layer10_ln1_12&#45;&gt;layer10_ffn_up_12 -->
<g id="edge931" class="edge">
<title>layer10_ln1_12&#45;&gt;layer10_ffn_up_12</title>
<path fill="none" stroke="black" d="M14156.12,-7669.89C14159.86,-7658.54 14164.96,-7643.01 14169.92,-7627.92"/>
<polygon fill="black" stroke="black" points="14173.35,-7628.71 14173.15,-7618.12 14166.7,-7626.52 14173.35,-7628.71"/>
</g>
<!-- layer10_ffn_act_12&#45;&gt;layer10_ffn_down_12 -->
<g id="edge934" class="edge">
<title>layer10_ffn_act_12&#45;&gt;layer10_ffn_down_12</title>
<path fill="none" stroke="black" d="M14023.5,-7397.74C14023.5,-7376.18 14023.5,-7338.37 14023.5,-7307.29"/>
<polygon fill="black" stroke="black" points="14027,-7307.04 14023.5,-7297.04 14020,-7307.04 14027,-7307.04"/>
</g>
<!-- layer11_mha_qkv_12 -->
<g id="node895" class="node">
<title>layer11_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14301.5,-6976 13745.5,-6976 13745.5,-6893 14301.5,-6893 14301.5,-6976"/>
<text text-anchor="middle" x="14023.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14023.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14023.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14023.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14023.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer10_res2_12&#45;&gt;layer11_mha_qkv_12 -->
<g id="edge1013" class="edge">
<title>layer10_res2_12&#45;&gt;layer11_mha_qkv_12</title>
<path fill="none" stroke="black" d="M14023.5,-7076.74C14023.5,-7055.18 14023.5,-7017.37 14023.5,-6986.29"/>
<polygon fill="black" stroke="black" points="14027,-6986.04 14023.5,-6976.04 14020,-6986.04 14027,-6986.04"/>
</g>
<!-- layer10_mha_attn_13&#45;&gt;layer10_mha_out_13 -->
<g id="edge938" class="edge">
<title>layer10_mha_attn_13&#45;&gt;layer10_mha_out_13</title>
<path fill="none" stroke="black" d="M15170.5,-8143.74C15170.5,-8122.18 15170.5,-8084.37 15170.5,-8053.29"/>
<polygon fill="black" stroke="black" points="15174,-8053.04 15170.5,-8043.04 15167,-8053.04 15174,-8053.04"/>
</g>
<!-- layer10_ln1_13 -->
<g id="node883" class="node">
<title>layer10_ln1_13</title>
<polygon fill="none" stroke="black" points="15233,-7706 15108,-7706 15108,-7670 15233,-7670 15233,-7706"/>
<text text-anchor="middle" x="15170.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_ln1_13</text>
</g>
<!-- layer10_res1_13&#45;&gt;layer10_ln1_13 -->
<g id="edge940" class="edge">
<title>layer10_res1_13&#45;&gt;layer10_ln1_13</title>
<path fill="none" stroke="black" d="M15170.5,-7822.97C15170.5,-7797.03 15170.5,-7747.36 15170.5,-7716.33"/>
<polygon fill="black" stroke="black" points="15174,-7716.2 15170.5,-7706.2 15167,-7716.2 15174,-7716.2"/>
</g>
<!-- layer10_ln1_13&#45;&gt;layer10_ffn_gate_13 -->
<g id="edge941" class="edge">
<title>layer10_ln1_13&#45;&gt;layer10_ffn_gate_13</title>
<path fill="none" stroke="black" d="M15107.69,-7671.54C15053.69,-7658.26 14973.17,-7638.44 14899.95,-7620.43"/>
<polygon fill="black" stroke="black" points="14900.68,-7617 14890.13,-7618.01 14899.01,-7623.8 14900.68,-7617"/>
</g>
<!-- layer10_ln1_13&#45;&gt;layer10_ffn_up_13 -->
<g id="edge942" class="edge">
<title>layer10_ln1_13&#45;&gt;layer10_ffn_up_13</title>
<path fill="none" stroke="black" d="M15177.69,-7669.89C15182.5,-7658.43 15189.1,-7642.72 15195.5,-7627.49"/>
<polygon fill="black" stroke="black" points="15198.79,-7628.69 15199.44,-7618.12 15192.34,-7625.98 15198.79,-7628.69"/>
</g>
<!-- layer10_ffn_act_13&#45;&gt;layer10_ffn_down_13 -->
<g id="edge945" class="edge">
<title>layer10_ffn_act_13&#45;&gt;layer10_ffn_down_13</title>
<path fill="none" stroke="black" d="M15169.5,-7397.74C15169.5,-7376.18 15169.5,-7338.37 15169.5,-7307.29"/>
<polygon fill="black" stroke="black" points="15173,-7307.04 15169.5,-7297.04 15166,-7307.04 15173,-7307.04"/>
</g>
<!-- layer11_mha_qkv_13 -->
<g id="node896" class="node">
<title>layer11_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15447.5,-6976 14891.5,-6976 14891.5,-6893 15447.5,-6893 15447.5,-6976"/>
<text text-anchor="middle" x="15169.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="15169.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15169.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15169.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="15169.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer10_res2_13&#45;&gt;layer11_mha_qkv_13 -->
<g id="edge1024" class="edge">
<title>layer10_res2_13&#45;&gt;layer11_mha_qkv_13</title>
<path fill="none" stroke="black" d="M15169.5,-7076.74C15169.5,-7055.18 15169.5,-7017.37 15169.5,-6986.29"/>
<polygon fill="black" stroke="black" points="15173,-6986.04 15169.5,-6976.04 15166,-6986.04 15173,-6986.04"/>
</g>
<!-- layer10_mha_attn_14&#45;&gt;layer10_mha_out_14 -->
<g id="edge949" class="edge">
<title>layer10_mha_attn_14&#45;&gt;layer10_mha_out_14</title>
<path fill="none" stroke="black" d="M16563.5,-8143.74C16563.5,-8122.18 16563.5,-8084.37 16563.5,-8053.29"/>
<polygon fill="black" stroke="black" points="16567,-8053.04 16563.5,-8043.04 16560,-8053.04 16567,-8053.04"/>
</g>
<!-- layer10_ln1_14 -->
<g id="node888" class="node">
<title>layer10_ln1_14</title>
<polygon fill="none" stroke="black" points="16626,-7706 16501,-7706 16501,-7670 16626,-7670 16626,-7706"/>
<text text-anchor="middle" x="16563.5" y="-7684.3" font-family="Times,serif" font-size="14.00">layer10_ln1_14</text>
</g>
<!-- layer10_res1_14&#45;&gt;layer10_ln1_14 -->
<g id="edge951" class="edge">
<title>layer10_res1_14&#45;&gt;layer10_ln1_14</title>
<path fill="none" stroke="black" d="M16563.5,-7822.97C16563.5,-7797.03 16563.5,-7747.36 16563.5,-7716.33"/>
<polygon fill="black" stroke="black" points="16567,-7716.2 16563.5,-7706.2 16560,-7716.2 16567,-7716.2"/>
</g>
<!-- layer10_ln1_14&#45;&gt;layer10_ffn_gate_14 -->
<g id="edge952" class="edge">
<title>layer10_ln1_14&#45;&gt;layer10_ffn_gate_14</title>
<path fill="none" stroke="black" d="M16500.97,-7671.54C16447.21,-7658.26 16367.06,-7638.44 16294.17,-7620.43"/>
<polygon fill="black" stroke="black" points="16294.94,-7617.01 16284.39,-7618.01 16293.26,-7623.81 16294.94,-7617.01"/>
</g>
<!-- layer10_ln1_14&#45;&gt;layer10_ffn_up_14 -->
<g id="edge953" class="edge">
<title>layer10_ln1_14&#45;&gt;layer10_ffn_up_14</title>
<path fill="none" stroke="black" d="M16571,-7669.89C16576.02,-7658.43 16582.91,-7642.72 16589.59,-7627.49"/>
<polygon fill="black" stroke="black" points="16592.89,-7628.68 16593.69,-7618.12 16586.47,-7625.87 16592.89,-7628.68"/>
</g>
<!-- layer10_ffn_act_14&#45;&gt;layer10_ffn_down_14 -->
<g id="edge956" class="edge">
<title>layer10_ffn_act_14&#45;&gt;layer10_ffn_down_14</title>
<path fill="none" stroke="black" d="M16589.5,-7397.74C16589.5,-7376.18 16589.5,-7338.37 16589.5,-7307.29"/>
<polygon fill="black" stroke="black" points="16593,-7307.04 16589.5,-7297.04 16586,-7307.04 16593,-7307.04"/>
</g>
<!-- layer11_mha_qkv_14 -->
<g id="node897" class="node">
<title>layer11_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16867.5,-6976 16311.5,-6976 16311.5,-6893 16867.5,-6893 16867.5,-6976"/>
<text text-anchor="middle" x="16589.5" y="-6960.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16589.5" y="-6945.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16589.5" y="-6930.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16589.5" y="-6915.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16589.5" y="-6900.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer10_res2_14&#45;&gt;layer11_mha_qkv_14 -->
<g id="edge1035" class="edge">
<title>layer10_res2_14&#45;&gt;layer11_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16589.5,-7076.74C16589.5,-7055.18 16589.5,-7017.37 16589.5,-6986.29"/>
<polygon fill="black" stroke="black" points="16593,-6986.04 16589.5,-6976.04 16586,-6986.04 16593,-6986.04"/>
</g>
<!-- layer11_mha_attn_8 -->
<g id="node936" class="node">
<title>layer11_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9948.5,-6631.5 9788.5,-6631.5 9788.5,-6595.5 9948.5,-6595.5 9948.5,-6631.5"/>
<text text-anchor="middle" x="9868.5" y="-6609.8" font-family="Times,serif" font-size="14.00">layer11_mha_attn_8</text>
</g>
<!-- layer11_mha_qkv_8&#45;&gt;layer11_mha_attn_8 -->
<g id="edge970" class="edge">
<title>layer11_mha_qkv_8&#45;&gt;layer11_mha_attn_8</title>
<path fill="none" stroke="black" d="M9868.5,-6732.18C9868.5,-6703.74 9868.5,-6666.58 9868.5,-6641.7"/>
<polygon fill="black" stroke="black" points="9872,-6641.52 9868.5,-6631.52 9865,-6641.52 9872,-6641.52"/>
</g>
<!-- layer11_mha_attn_9 -->
<g id="node941" class="node">
<title>layer11_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10776.5,-6792 10616.5,-6792 10616.5,-6756 10776.5,-6756 10776.5,-6792"/>
<text text-anchor="middle" x="10696.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer11_mha_attn_9</text>
</g>
<!-- layer11_mha_qkv_9&#45;&gt;layer11_mha_attn_9 -->
<g id="edge981" class="edge">
<title>layer11_mha_qkv_9&#45;&gt;layer11_mha_attn_9</title>
<path fill="none" stroke="black" d="M10696.5,-6892.68C10696.5,-6864.24 10696.5,-6827.08 10696.5,-6802.2"/>
<polygon fill="black" stroke="black" points="10700,-6802.02 10696.5,-6792.02 10693,-6802.02 10700,-6802.02"/>
</g>
<!-- layer11_mha_attn_10 -->
<g id="node946" class="node">
<title>layer11_mha_attn_10</title>
<polygon fill="none" stroke="black" points="12224,-6792 12055,-6792 12055,-6756 12224,-6756 12224,-6792"/>
<text text-anchor="middle" x="12139.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer11_mha_attn_10</text>
</g>
<!-- layer11_mha_qkv_10&#45;&gt;layer11_mha_attn_10 -->
<g id="edge992" class="edge">
<title>layer11_mha_qkv_10&#45;&gt;layer11_mha_attn_10</title>
<path fill="none" stroke="black" d="M12139.5,-6892.68C12139.5,-6864.24 12139.5,-6827.08 12139.5,-6802.2"/>
<polygon fill="black" stroke="black" points="12143,-6802.02 12139.5,-6792.02 12136,-6802.02 12143,-6802.02"/>
</g>
<!-- layer11_mha_attn_11 -->
<g id="node951" class="node">
<title>layer11_mha_attn_11</title>
<polygon fill="none" stroke="black" points="13021,-6792 12852,-6792 12852,-6756 13021,-6756 13021,-6792"/>
<text text-anchor="middle" x="12936.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer11_mha_attn_11</text>
</g>
<!-- layer11_mha_qkv_11&#45;&gt;layer11_mha_attn_11 -->
<g id="edge1003" class="edge">
<title>layer11_mha_qkv_11&#45;&gt;layer11_mha_attn_11</title>
<path fill="none" stroke="black" d="M12936.5,-6892.68C12936.5,-6864.24 12936.5,-6827.08 12936.5,-6802.2"/>
<polygon fill="black" stroke="black" points="12940,-6802.02 12936.5,-6792.02 12933,-6802.02 12940,-6802.02"/>
</g>
<!-- layer11_mha_attn_12 -->
<g id="node956" class="node">
<title>layer11_mha_attn_12</title>
<polygon fill="none" stroke="black" points="14108,-6792 13939,-6792 13939,-6756 14108,-6756 14108,-6792"/>
<text text-anchor="middle" x="14023.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer11_mha_attn_12</text>
</g>
<!-- layer11_mha_qkv_12&#45;&gt;layer11_mha_attn_12 -->
<g id="edge1014" class="edge">
<title>layer11_mha_qkv_12&#45;&gt;layer11_mha_attn_12</title>
<path fill="none" stroke="black" d="M14023.5,-6892.68C14023.5,-6864.24 14023.5,-6827.08 14023.5,-6802.2"/>
<polygon fill="black" stroke="black" points="14027,-6802.02 14023.5,-6792.02 14020,-6802.02 14027,-6802.02"/>
</g>
<!-- layer11_mha_attn_13 -->
<g id="node961" class="node">
<title>layer11_mha_attn_13</title>
<polygon fill="none" stroke="black" points="15254,-6792 15085,-6792 15085,-6756 15254,-6756 15254,-6792"/>
<text text-anchor="middle" x="15169.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer11_mha_attn_13</text>
</g>
<!-- layer11_mha_qkv_13&#45;&gt;layer11_mha_attn_13 -->
<g id="edge1025" class="edge">
<title>layer11_mha_qkv_13&#45;&gt;layer11_mha_attn_13</title>
<path fill="none" stroke="black" d="M15169.5,-6892.68C15169.5,-6864.24 15169.5,-6827.08 15169.5,-6802.2"/>
<polygon fill="black" stroke="black" points="15173,-6802.02 15169.5,-6792.02 15166,-6802.02 15173,-6802.02"/>
</g>
<!-- layer11_mha_attn_14 -->
<g id="node966" class="node">
<title>layer11_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16674,-6792 16505,-6792 16505,-6756 16674,-6756 16674,-6792"/>
<text text-anchor="middle" x="16589.5" y="-6770.3" font-family="Times,serif" font-size="14.00">layer11_mha_attn_14</text>
</g>
<!-- layer11_mha_qkv_14&#45;&gt;layer11_mha_attn_14 -->
<g id="edge1036" class="edge">
<title>layer11_mha_qkv_14&#45;&gt;layer11_mha_attn_14</title>
<path fill="none" stroke="black" d="M16589.5,-6892.68C16589.5,-6864.24 16589.5,-6827.08 16589.5,-6802.2"/>
<polygon fill="black" stroke="black" points="16593,-6802.02 16589.5,-6792.02 16586,-6802.02 16593,-6802.02"/>
</g>
<!-- layer11_mha_attn_15 -->
<g id="node899" class="node">
<title>layer11_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17645.31,-6857 16886.81,-6857 16691.69,-6691 17450.19,-6691 17645.31,-6857"/>
<text text-anchor="middle" x="17168.5" y="-6800.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17168.5" y="-6785.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="17168.5" y="-6770.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17168.5" y="-6755.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6740.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_mha_qkv_15&#45;&gt;layer11_mha_attn_15 -->
<g id="edge1047" class="edge">
<title>layer11_mha_qkv_15&#45;&gt;layer11_mha_attn_15</title>
<path fill="none" stroke="black" d="M17168.5,-6892.68C17168.5,-6884.75 17168.5,-6876.14 17168.5,-6867.31"/>
<polygon fill="black" stroke="black" points="17172,-6867.27 17168.5,-6857.27 17165,-6867.27 17172,-6867.27"/>
</g>
<!-- layer11_mha_out_15 -->
<g id="node907" class="node">
<title>layer11_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17387.5,-6655 16949.5,-6655 16949.5,-6572 17387.5,-6572 17387.5,-6655"/>
<text text-anchor="middle" x="17168.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="17168.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17168.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17168.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_mha_attn_15&#45;&gt;layer11_mha_out_15 -->
<g id="edge1048" class="edge">
<title>layer11_mha_attn_15&#45;&gt;layer11_mha_out_15</title>
<path fill="none" stroke="black" d="M17168.5,-6690.96C17168.5,-6682.25 17168.5,-6673.59 17168.5,-6665.39"/>
<polygon fill="black" stroke="black" points="17172,-6665.29 17168.5,-6655.29 17165,-6665.29 17172,-6665.29"/>
</g>
<!-- layer11_mha_out_8 -->
<g id="node900" class="node">
<title>layer11_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="10087.5,-6494.5 9649.5,-6494.5 9649.5,-6411.5 10087.5,-6411.5 10087.5,-6494.5"/>
<text text-anchor="middle" x="9868.5" y="-6479.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9868.5" y="-6464.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9868.5" y="-6449.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9868.5" y="-6434.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9868.5" y="-6419.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_res1_8 -->
<g id="node937" class="node">
<title>layer11_res1_8</title>
<polygon fill="none" stroke="black" points="9931,-6318 9806,-6318 9806,-6282 9931,-6282 9931,-6318"/>
<text text-anchor="middle" x="9868.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_res1_8</text>
</g>
<!-- layer11_mha_out_8&#45;&gt;layer11_res1_8 -->
<g id="edge972" class="edge">
<title>layer11_mha_out_8&#45;&gt;layer11_res1_8</title>
<path fill="none" stroke="black" d="M9868.5,-6411.14C9868.5,-6384.9 9868.5,-6351.53 9868.5,-6328.44"/>
<polygon fill="black" stroke="black" points="9872,-6328.31 9868.5,-6318.31 9865,-6328.31 9872,-6328.31"/>
</g>
<!-- layer11_mha_out_9 -->
<g id="node901" class="node">
<title>layer11_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="10915.5,-6655 10477.5,-6655 10477.5,-6572 10915.5,-6572 10915.5,-6655"/>
<text text-anchor="middle" x="10696.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10696.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10696.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10696.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10696.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_res1_9 -->
<g id="node942" class="node">
<title>layer11_res1_9</title>
<polygon fill="none" stroke="black" points="10759,-6471 10634,-6471 10634,-6435 10759,-6435 10759,-6471"/>
<text text-anchor="middle" x="10696.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer11_res1_9</text>
</g>
<!-- layer11_mha_out_9&#45;&gt;layer11_res1_9 -->
<g id="edge983" class="edge">
<title>layer11_mha_out_9&#45;&gt;layer11_res1_9</title>
<path fill="none" stroke="black" d="M10696.5,-6571.68C10696.5,-6543.24 10696.5,-6506.08 10696.5,-6481.2"/>
<polygon fill="black" stroke="black" points="10700,-6481.02 10696.5,-6471.02 10693,-6481.02 10700,-6481.02"/>
</g>
<!-- layer11_mha_out_10 -->
<g id="node902" class="node">
<title>layer11_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="12358.5,-6655 11920.5,-6655 11920.5,-6572 12358.5,-6572 12358.5,-6655"/>
<text text-anchor="middle" x="12139.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12139.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12139.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12139.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12139.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_res1_10 -->
<g id="node947" class="node">
<title>layer11_res1_10</title>
<polygon fill="none" stroke="black" points="12206.5,-6471 12072.5,-6471 12072.5,-6435 12206.5,-6435 12206.5,-6471"/>
<text text-anchor="middle" x="12139.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer11_res1_10</text>
</g>
<!-- layer11_mha_out_10&#45;&gt;layer11_res1_10 -->
<g id="edge994" class="edge">
<title>layer11_mha_out_10&#45;&gt;layer11_res1_10</title>
<path fill="none" stroke="black" d="M12139.5,-6571.68C12139.5,-6543.24 12139.5,-6506.08 12139.5,-6481.2"/>
<polygon fill="black" stroke="black" points="12143,-6481.02 12139.5,-6471.02 12136,-6481.02 12143,-6481.02"/>
</g>
<!-- layer11_mha_out_11 -->
<g id="node903" class="node">
<title>layer11_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="13155.5,-6655 12717.5,-6655 12717.5,-6572 13155.5,-6572 13155.5,-6655"/>
<text text-anchor="middle" x="12936.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12936.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12936.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12936.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12936.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_res1_11 -->
<g id="node952" class="node">
<title>layer11_res1_11</title>
<polygon fill="none" stroke="black" points="13003.5,-6471 12869.5,-6471 12869.5,-6435 13003.5,-6435 13003.5,-6471"/>
<text text-anchor="middle" x="12936.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer11_res1_11</text>
</g>
<!-- layer11_mha_out_11&#45;&gt;layer11_res1_11 -->
<g id="edge1005" class="edge">
<title>layer11_mha_out_11&#45;&gt;layer11_res1_11</title>
<path fill="none" stroke="black" d="M12936.5,-6571.68C12936.5,-6543.24 12936.5,-6506.08 12936.5,-6481.2"/>
<polygon fill="black" stroke="black" points="12940,-6481.02 12936.5,-6471.02 12933,-6481.02 12940,-6481.02"/>
</g>
<!-- layer11_mha_out_12 -->
<g id="node904" class="node">
<title>layer11_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14242.5,-6655 13804.5,-6655 13804.5,-6572 14242.5,-6572 14242.5,-6655"/>
<text text-anchor="middle" x="14023.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14023.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14023.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14023.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14023.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_res1_12 -->
<g id="node957" class="node">
<title>layer11_res1_12</title>
<polygon fill="none" stroke="black" points="14090.5,-6471 13956.5,-6471 13956.5,-6435 14090.5,-6435 14090.5,-6471"/>
<text text-anchor="middle" x="14023.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer11_res1_12</text>
</g>
<!-- layer11_mha_out_12&#45;&gt;layer11_res1_12 -->
<g id="edge1016" class="edge">
<title>layer11_mha_out_12&#45;&gt;layer11_res1_12</title>
<path fill="none" stroke="black" d="M14023.5,-6571.68C14023.5,-6543.24 14023.5,-6506.08 14023.5,-6481.2"/>
<polygon fill="black" stroke="black" points="14027,-6481.02 14023.5,-6471.02 14020,-6481.02 14027,-6481.02"/>
</g>
<!-- layer11_mha_out_13 -->
<g id="node905" class="node">
<title>layer11_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="15388.5,-6655 14950.5,-6655 14950.5,-6572 15388.5,-6572 15388.5,-6655"/>
<text text-anchor="middle" x="15169.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="15169.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15169.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15169.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15169.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_res1_13 -->
<g id="node962" class="node">
<title>layer11_res1_13</title>
<polygon fill="none" stroke="black" points="15236.5,-6471 15102.5,-6471 15102.5,-6435 15236.5,-6435 15236.5,-6471"/>
<text text-anchor="middle" x="15169.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer11_res1_13</text>
</g>
<!-- layer11_mha_out_13&#45;&gt;layer11_res1_13 -->
<g id="edge1027" class="edge">
<title>layer11_mha_out_13&#45;&gt;layer11_res1_13</title>
<path fill="none" stroke="black" d="M15169.5,-6571.68C15169.5,-6543.24 15169.5,-6506.08 15169.5,-6481.2"/>
<polygon fill="black" stroke="black" points="15173,-6481.02 15169.5,-6471.02 15166,-6481.02 15173,-6481.02"/>
</g>
<!-- layer11_mha_out_14 -->
<g id="node906" class="node">
<title>layer11_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16808.5,-6655 16370.5,-6655 16370.5,-6572 16808.5,-6572 16808.5,-6655"/>
<text text-anchor="middle" x="16589.5" y="-6639.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16589.5" y="-6624.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16589.5" y="-6609.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16589.5" y="-6594.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16589.5" y="-6579.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_res1_14 -->
<g id="node967" class="node">
<title>layer11_res1_14</title>
<polygon fill="none" stroke="black" points="16656.5,-6471 16522.5,-6471 16522.5,-6435 16656.5,-6435 16656.5,-6471"/>
<text text-anchor="middle" x="16589.5" y="-6449.3" font-family="Times,serif" font-size="14.00">layer11_res1_14</text>
</g>
<!-- layer11_mha_out_14&#45;&gt;layer11_res1_14 -->
<g id="edge1038" class="edge">
<title>layer11_mha_out_14&#45;&gt;layer11_res1_14</title>
<path fill="none" stroke="black" d="M16589.5,-6571.68C16589.5,-6543.24 16589.5,-6506.08 16589.5,-6481.2"/>
<polygon fill="black" stroke="black" points="16593,-6481.02 16589.5,-6471.02 16586,-6481.02 16593,-6481.02"/>
</g>
<!-- layer11_res1_15 -->
<g id="node908" class="node">
<title>layer11_res1_15</title>
<polygon fill="none" stroke="black" points="17609.24,-6536 16908.12,-6536 16727.76,-6370 17428.88,-6370 17609.24,-6536"/>
<text text-anchor="middle" x="17168.5" y="-6479.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17168.5" y="-6464.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6449.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6434.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6419.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_mha_out_15&#45;&gt;layer11_res1_15 -->
<g id="edge1049" class="edge">
<title>layer11_mha_out_15&#45;&gt;layer11_res1_15</title>
<path fill="none" stroke="black" d="M17168.5,-6571.68C17168.5,-6563.75 17168.5,-6555.14 17168.5,-6546.31"/>
<polygon fill="black" stroke="black" points="17172,-6546.27 17168.5,-6536.27 17165,-6546.27 17172,-6546.27"/>
</g>
<!-- layer11_ln1_15 -->
<g id="node909" class="node">
<title>layer11_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17381,-6334 16956,-6334 16956,-6266 17381,-6266 17381,-6334"/>
<text text-anchor="middle" x="17168.5" y="-6318.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="17168.5" y="-6303.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6288.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17168.5" y="-6273.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_res1_15&#45;&gt;layer11_ln1_15 -->
<g id="edge1050" class="edge">
<title>layer11_res1_15&#45;&gt;layer11_ln1_15</title>
<path fill="none" stroke="black" d="M17168.5,-6369.87C17168.5,-6361.12 17168.5,-6352.48 17168.5,-6344.45"/>
<polygon fill="black" stroke="black" points="17172,-6344.26 17168.5,-6334.26 17165,-6344.26 17172,-6344.26"/>
</g>
<!-- layer11_ffn_gate_15 -->
<g id="node917" class="node">
<title>layer11_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="17382,-6230 16909,-6230 16909,-6147 17382,-6147 17382,-6230"/>
<text text-anchor="middle" x="17145.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="17145.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17145.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17145.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17145.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_ln1_15&#45;&gt;layer11_ffn_gate_15 -->
<g id="edge1051" class="edge">
<title>layer11_ln1_15&#45;&gt;layer11_ffn_gate_15</title>
<path fill="none" stroke="black" d="M17161.54,-6265.85C17159.85,-6257.8 17158,-6249 17156.18,-6240.34"/>
<polygon fill="black" stroke="black" points="17159.55,-6239.34 17154.07,-6230.28 17152.7,-6240.78 17159.55,-6239.34"/>
</g>
<!-- layer11_ffn_up_15 -->
<g id="node925" class="node">
<title>layer11_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17873,-6230 17400,-6230 17400,-6147 17873,-6147 17873,-6230"/>
<text text-anchor="middle" x="17636.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17636.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17636.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17636.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17636.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_ln1_15&#45;&gt;layer11_ffn_up_15 -->
<g id="edge1052" class="edge">
<title>layer11_ln1_15&#45;&gt;layer11_ffn_up_15</title>
<path fill="none" stroke="black" d="M17309.55,-6266C17354.75,-6255.42 17405.47,-6243.56 17453.23,-6232.38"/>
<polygon fill="black" stroke="black" points="17454.11,-6235.77 17463.05,-6230.08 17452.52,-6228.95 17454.11,-6235.77"/>
</g>
<!-- layer11_ffn_gate_8 -->
<g id="node910" class="node">
<title>layer11_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="10103,-6069.5 9630,-6069.5 9630,-5986.5 10103,-5986.5 10103,-6069.5"/>
<text text-anchor="middle" x="9866.5" y="-6054.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9866.5" y="-6039.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9866.5" y="-6024.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9866.5" y="-6009.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9866.5" y="-5994.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_ffn_act_8 -->
<g id="node939" class="node">
<title>layer11_ffn_act_8</title>
<polygon fill="none" stroke="black" points="9972.5,-5885.5 9832.5,-5885.5 9832.5,-5849.5 9972.5,-5849.5 9972.5,-5885.5"/>
<text text-anchor="middle" x="9902.5" y="-5863.8" font-family="Times,serif" font-size="14.00">layer11_ffn_act_8</text>
</g>
<!-- layer11_ffn_gate_8&#45;&gt;layer11_ffn_act_8 -->
<g id="edge976" class="edge">
<title>layer11_ffn_gate_8&#45;&gt;layer11_ffn_act_8</title>
<path fill="none" stroke="black" d="M9875.77,-5986.18C9882.26,-5957.61 9890.75,-5920.24 9896.4,-5895.36"/>
<polygon fill="black" stroke="black" points="9899.83,-5896.05 9898.63,-5885.52 9893.01,-5894.5 9899.83,-5896.05"/>
</g>
<!-- layer11_ffn_gate_9 -->
<g id="node911" class="node">
<title>layer11_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10932,-6230 10459,-6230 10459,-6147 10932,-6147 10932,-6230"/>
<text text-anchor="middle" x="10695.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10695.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10695.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10695.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10695.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_ffn_act_9 -->
<g id="node944" class="node">
<title>layer11_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10776.5,-6046 10636.5,-6046 10636.5,-6010 10776.5,-6010 10776.5,-6046"/>
<text text-anchor="middle" x="10706.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer11_ffn_act_9</text>
</g>
<!-- layer11_ffn_gate_9&#45;&gt;layer11_ffn_act_9 -->
<g id="edge987" class="edge">
<title>layer11_ffn_gate_9&#45;&gt;layer11_ffn_act_9</title>
<path fill="none" stroke="black" d="M10698.33,-6146.68C10700.31,-6118.24 10702.89,-6081.08 10704.61,-6056.2"/>
<polygon fill="black" stroke="black" points="10708.12,-6056.24 10705.32,-6046.02 10701.13,-6055.76 10708.12,-6056.24"/>
</g>
<!-- layer11_ffn_gate_10 -->
<g id="node912" class="node">
<title>layer11_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11926,-6230 11453,-6230 11453,-6147 11926,-6147 11926,-6230"/>
<text text-anchor="middle" x="11689.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11689.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11689.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11689.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11689.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_ffn_act_10 -->
<g id="node949" class="node">
<title>layer11_ffn_act_10</title>
<polygon fill="none" stroke="black" points="11972,-6046 11823,-6046 11823,-6010 11972,-6010 11972,-6046"/>
<text text-anchor="middle" x="11897.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer11_ffn_act_10</text>
</g>
<!-- layer11_ffn_gate_10&#45;&gt;layer11_ffn_act_10 -->
<g id="edge998" class="edge">
<title>layer11_ffn_gate_10&#45;&gt;layer11_ffn_act_10</title>
<path fill="none" stroke="black" d="M11742.8,-6146.89C11782.13,-6116.91 11834.28,-6077.18 11866.86,-6052.35"/>
<polygon fill="black" stroke="black" points="11869.27,-6054.91 11875.1,-6046.07 11865.02,-6049.35 11869.27,-6054.91"/>
</g>
<!-- layer11_ffn_gate_11 -->
<g id="node913" class="node">
<title>layer11_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="12914,-6230 12441,-6230 12441,-6147 12914,-6147 12914,-6230"/>
<text text-anchor="middle" x="12677.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12677.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12677.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12677.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12677.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_ffn_act_11 -->
<g id="node954" class="node">
<title>layer11_ffn_act_11</title>
<polygon fill="none" stroke="black" points="12753,-6046 12604,-6046 12604,-6010 12753,-6010 12753,-6046"/>
<text text-anchor="middle" x="12678.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer11_ffn_act_11</text>
</g>
<!-- layer11_ffn_gate_11&#45;&gt;layer11_ffn_act_11 -->
<g id="edge1009" class="edge">
<title>layer11_ffn_gate_11&#45;&gt;layer11_ffn_act_11</title>
<path fill="none" stroke="black" d="M12677.76,-6146.68C12677.94,-6118.24 12678.17,-6081.08 12678.33,-6056.2"/>
<polygon fill="black" stroke="black" points="12681.83,-6056.05 12678.39,-6046.02 12674.83,-6056 12681.83,-6056.05"/>
</g>
<!-- layer11_ffn_gate_12 -->
<g id="node914" class="node">
<title>layer11_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="14015,-6230 13542,-6230 13542,-6147 14015,-6147 14015,-6230"/>
<text text-anchor="middle" x="13778.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13778.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13778.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13778.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13778.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_ffn_act_12 -->
<g id="node959" class="node">
<title>layer11_ffn_act_12</title>
<polygon fill="none" stroke="black" points="14099,-6046 13950,-6046 13950,-6010 14099,-6010 14099,-6046"/>
<text text-anchor="middle" x="14024.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer11_ffn_act_12</text>
</g>
<!-- layer11_ffn_gate_12&#45;&gt;layer11_ffn_act_12 -->
<g id="edge1020" class="edge">
<title>layer11_ffn_gate_12&#45;&gt;layer11_ffn_act_12</title>
<path fill="none" stroke="black" d="M13841.53,-6146.89C13888.45,-6116.66 13950.78,-6076.5 13989.24,-6051.72"/>
<polygon fill="black" stroke="black" points="13991.5,-6054.43 13998.01,-6046.07 13987.71,-6048.54 13991.5,-6054.43"/>
</g>
<!-- layer11_ffn_gate_13 -->
<g id="node915" class="node">
<title>layer11_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="15382,-6230 14909,-6230 14909,-6147 15382,-6147 15382,-6230"/>
<text text-anchor="middle" x="15145.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15145.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15145.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15145.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15145.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_ffn_act_13 -->
<g id="node964" class="node">
<title>layer11_ffn_act_13</title>
<polygon fill="none" stroke="black" points="15235,-6046 15086,-6046 15086,-6010 15235,-6010 15235,-6046"/>
<text text-anchor="middle" x="15160.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer11_ffn_act_13</text>
</g>
<!-- layer11_ffn_gate_13&#45;&gt;layer11_ffn_act_13 -->
<g id="edge1031" class="edge">
<title>layer11_ffn_gate_13&#45;&gt;layer11_ffn_act_13</title>
<path fill="none" stroke="black" d="M15149.36,-6146.68C15152.05,-6118.24 15155.57,-6081.08 15157.93,-6056.2"/>
<polygon fill="black" stroke="black" points="15161.43,-6056.31 15158.89,-6046.02 15154.46,-6055.65 15161.43,-6056.31"/>
</g>
<!-- layer11_ffn_gate_14 -->
<g id="node916" class="node">
<title>layer11_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="16364,-6230 15891,-6230 15891,-6147 16364,-6147 16364,-6230"/>
<text text-anchor="middle" x="16127.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16127.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16127.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16127.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16127.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_ffn_act_14 -->
<g id="node969" class="node">
<title>layer11_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16248,-6046 16099,-6046 16099,-6010 16248,-6010 16248,-6046"/>
<text text-anchor="middle" x="16173.5" y="-6024.3" font-family="Times,serif" font-size="14.00">layer11_ffn_act_14</text>
</g>
<!-- layer11_ffn_gate_14&#45;&gt;layer11_ffn_act_14 -->
<g id="edge1042" class="edge">
<title>layer11_ffn_gate_14&#45;&gt;layer11_ffn_act_14</title>
<path fill="none" stroke="black" d="M16139.35,-6146.68C16147.64,-6118.11 16158.48,-6080.74 16165.7,-6055.86"/>
<polygon fill="black" stroke="black" points="16169.13,-6056.6 16168.56,-6046.02 16162.41,-6054.65 16169.13,-6056.6"/>
</g>
<!-- layer11_ffn_act_15 -->
<g id="node926" class="node">
<title>layer11_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17655.24,-6111 16898.44,-6111 16703.76,-5945 17460.56,-5945 17655.24,-6111"/>
<text text-anchor="middle" x="17179.5" y="-6054.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="17179.5" y="-6039.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="17179.5" y="-6024.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17179.5" y="-6009.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17179.5" y="-5994.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_ffn_gate_15&#45;&gt;layer11_ffn_act_15 -->
<g id="edge1053" class="edge">
<title>layer11_ffn_gate_15&#45;&gt;layer11_ffn_act_15</title>
<path fill="none" stroke="black" d="M17154.26,-6146.68C17155.96,-6138.75 17157.8,-6130.14 17159.7,-6121.31"/>
<polygon fill="black" stroke="black" points="17163.18,-6121.78 17161.85,-6111.27 17156.33,-6120.32 17163.18,-6121.78"/>
</g>
<!-- layer11_ffn_up_8 -->
<g id="node918" class="node">
<title>layer11_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10594,-6069.5 10121,-6069.5 10121,-5986.5 10594,-5986.5 10594,-6069.5"/>
<text text-anchor="middle" x="10357.5" y="-6054.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10357.5" y="-6039.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10357.5" y="-6024.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10357.5" y="-6009.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10357.5" y="-5994.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_ffn_up_8&#45;&gt;layer11_ffn_act_8 -->
<g id="edge977" class="edge">
<title>layer11_ffn_up_8&#45;&gt;layer11_ffn_act_8</title>
<path fill="none" stroke="black" d="M10241.21,-5986.49C10151.69,-5955.31 10031.69,-5913.51 9961.18,-5888.94"/>
<polygon fill="black" stroke="black" points="9962.16,-5885.58 9951.57,-5885.59 9959.86,-5892.19 9962.16,-5885.58"/>
</g>
<!-- layer11_ffn_up_9 -->
<g id="node919" class="node">
<title>layer11_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="11423,-6230 10950,-6230 10950,-6147 11423,-6147 11423,-6230"/>
<text text-anchor="middle" x="11186.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11186.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="11186.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11186.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11186.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_ffn_up_9&#45;&gt;layer11_ffn_act_9 -->
<g id="edge988" class="edge">
<title>layer11_ffn_up_9&#45;&gt;layer11_ffn_act_9</title>
<path fill="none" stroke="black" d="M11063.82,-6146.99C10969.19,-6115.74 10842.28,-6073.83 10767.95,-6049.29"/>
<polygon fill="black" stroke="black" points="10768.86,-6045.9 10758.26,-6046.09 10766.66,-6052.55 10768.86,-6045.9"/>
</g>
<!-- layer11_ffn_up_10 -->
<g id="node920" class="node">
<title>layer11_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12417,-6230 11944,-6230 11944,-6147 12417,-6147 12417,-6230"/>
<text text-anchor="middle" x="12180.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12180.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12180.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12180.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12180.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_ffn_up_10&#45;&gt;layer11_ffn_act_10 -->
<g id="edge999" class="edge">
<title>layer11_ffn_up_10&#45;&gt;layer11_ffn_act_10</title>
<path fill="none" stroke="black" d="M12107.99,-6146.89C12053.56,-6116.4 11981.1,-6075.82 11936.95,-6051.1"/>
<polygon fill="black" stroke="black" points="11938.41,-6047.9 11927.98,-6046.07 11934.99,-6054.01 11938.41,-6047.9"/>
</g>
<!-- layer11_ffn_up_11 -->
<g id="node921" class="node">
<title>layer11_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13405,-6230 12932,-6230 12932,-6147 13405,-6147 13405,-6230"/>
<text text-anchor="middle" x="13168.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13168.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13168.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13168.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13168.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_ffn_up_11&#45;&gt;layer11_ffn_act_11 -->
<g id="edge1010" class="edge">
<title>layer11_ffn_up_11&#45;&gt;layer11_ffn_act_11</title>
<path fill="none" stroke="black" d="M13043.27,-6146.99C12946.66,-6115.74 12817.1,-6073.83 12741.23,-6049.29"/>
<polygon fill="black" stroke="black" points="12741.93,-6045.84 12731.34,-6046.09 12739.78,-6052.5 12741.93,-6045.84"/>
</g>
<!-- layer11_ffn_up_12 -->
<g id="node922" class="node">
<title>layer11_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14506,-6230 14033,-6230 14033,-6147 14506,-6147 14506,-6230"/>
<text text-anchor="middle" x="14269.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14269.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14269.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14269.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14269.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_ffn_up_12&#45;&gt;layer11_ffn_act_12 -->
<g id="edge1021" class="edge">
<title>layer11_ffn_up_12&#45;&gt;layer11_ffn_act_12</title>
<path fill="none" stroke="black" d="M14206.72,-6146.89C14160,-6116.66 14097.92,-6076.5 14059.62,-6051.72"/>
<polygon fill="black" stroke="black" points="14061.18,-6048.56 14050.88,-6046.07 14057.38,-6054.44 14061.18,-6048.56"/>
</g>
<!-- layer11_ffn_up_13 -->
<g id="node923" class="node">
<title>layer11_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15873,-6230 15400,-6230 15400,-6147 15873,-6147 15873,-6230"/>
<text text-anchor="middle" x="15636.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15636.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15636.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15636.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15636.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_ffn_up_13&#45;&gt;layer11_ffn_act_13 -->
<g id="edge1032" class="edge">
<title>layer11_ffn_up_13&#45;&gt;layer11_ffn_act_13</title>
<path fill="none" stroke="black" d="M15514.85,-6146.99C15421,-6115.74 15295.14,-6073.83 15221.44,-6049.29"/>
<polygon fill="black" stroke="black" points="15222.42,-6045.93 15211.83,-6046.09 15220.21,-6052.57 15222.42,-6045.93"/>
</g>
<!-- layer11_ffn_up_14 -->
<g id="node924" class="node">
<title>layer11_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16855,-6230 16382,-6230 16382,-6147 16855,-6147 16855,-6230"/>
<text text-anchor="middle" x="16618.5" y="-6214.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16618.5" y="-6199.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16618.5" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16618.5" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16618.5" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_ffn_up_14&#45;&gt;layer11_ffn_act_14 -->
<g id="edge1043" class="edge">
<title>layer11_ffn_up_14&#45;&gt;layer11_ffn_act_14</title>
<path fill="none" stroke="black" d="M16504.77,-6146.99C16417.39,-6115.87 16300.34,-6074.18 16231.31,-6049.59"/>
<polygon fill="black" stroke="black" points="16232.08,-6046.15 16221.49,-6046.09 16229.73,-6052.74 16232.08,-6046.15"/>
</g>
<!-- layer11_ffn_up_15&#45;&gt;layer11_ffn_act_15 -->
<g id="edge1054" class="edge">
<title>layer11_ffn_up_15&#45;&gt;layer11_ffn_act_15</title>
<path fill="none" stroke="black" d="M17519.7,-6146.99C17490.7,-6136.93 17458.51,-6125.77 17425.83,-6114.43"/>
<polygon fill="black" stroke="black" points="17426.74,-6111.04 17416.14,-6111.07 17424.44,-6117.66 17426.74,-6111.04"/>
</g>
<!-- layer11_ffn_down_15 -->
<g id="node934" class="node">
<title>layer11_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17403,-5909 16956,-5909 16956,-5826 17403,-5826 17403,-5909"/>
<text text-anchor="middle" x="17179.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="17179.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17179.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="17179.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17179.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_ffn_act_15&#45;&gt;layer11_ffn_down_15 -->
<g id="edge1055" class="edge">
<title>layer11_ffn_act_15&#45;&gt;layer11_ffn_down_15</title>
<path fill="none" stroke="black" d="M17179.5,-5944.96C17179.5,-5936.25 17179.5,-5927.59 17179.5,-5919.39"/>
<polygon fill="black" stroke="black" points="17183,-5919.29 17179.5,-5909.29 17176,-5919.29 17183,-5919.29"/>
</g>
<!-- layer11_ffn_down_8 -->
<g id="node927" class="node">
<title>layer11_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="10126,-5748.5 9679,-5748.5 9679,-5665.5 10126,-5665.5 10126,-5748.5"/>
<text text-anchor="middle" x="9902.5" y="-5733.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9902.5" y="-5718.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9902.5" y="-5703.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9902.5" y="-5688.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9902.5" y="-5673.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_res2_8 -->
<g id="node940" class="node">
<title>layer11_res2_8</title>
<polygon fill="none" stroke="black" points="9965,-5564.5 9840,-5564.5 9840,-5528.5 9965,-5528.5 9965,-5564.5"/>
<text text-anchor="middle" x="9902.5" y="-5542.8" font-family="Times,serif" font-size="14.00">layer11_res2_8</text>
</g>
<!-- layer11_ffn_down_8&#45;&gt;layer11_res2_8 -->
<g id="edge979" class="edge">
<title>layer11_ffn_down_8&#45;&gt;layer11_res2_8</title>
<path fill="none" stroke="black" d="M9902.5,-5665.18C9902.5,-5636.74 9902.5,-5599.58 9902.5,-5574.7"/>
<polygon fill="black" stroke="black" points="9906,-5574.52 9902.5,-5564.52 9899,-5574.52 9906,-5574.52"/>
</g>
<!-- layer11_ffn_down_9 -->
<g id="node928" class="node">
<title>layer11_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="10930,-5909 10483,-5909 10483,-5826 10930,-5826 10930,-5909"/>
<text text-anchor="middle" x="10706.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10706.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10706.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10706.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10706.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_res2_9 -->
<g id="node945" class="node">
<title>layer11_res2_9</title>
<polygon fill="none" stroke="black" points="10769,-5725 10644,-5725 10644,-5689 10769,-5689 10769,-5725"/>
<text text-anchor="middle" x="10706.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer11_res2_9</text>
</g>
<!-- layer11_ffn_down_9&#45;&gt;layer11_res2_9 -->
<g id="edge990" class="edge">
<title>layer11_ffn_down_9&#45;&gt;layer11_res2_9</title>
<path fill="none" stroke="black" d="M10706.5,-5825.68C10706.5,-5797.24 10706.5,-5760.08 10706.5,-5735.2"/>
<polygon fill="black" stroke="black" points="10710,-5735.02 10706.5,-5725.02 10703,-5735.02 10710,-5735.02"/>
</g>
<!-- layer11_ffn_down_10 -->
<g id="node929" class="node">
<title>layer11_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="12121,-5909 11674,-5909 11674,-5826 12121,-5826 12121,-5909"/>
<text text-anchor="middle" x="11897.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11897.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11897.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11897.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11897.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_res2_10 -->
<g id="node950" class="node">
<title>layer11_res2_10</title>
<polygon fill="none" stroke="black" points="11964.5,-5725 11830.5,-5725 11830.5,-5689 11964.5,-5689 11964.5,-5725"/>
<text text-anchor="middle" x="11897.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer11_res2_10</text>
</g>
<!-- layer11_ffn_down_10&#45;&gt;layer11_res2_10 -->
<g id="edge1001" class="edge">
<title>layer11_ffn_down_10&#45;&gt;layer11_res2_10</title>
<path fill="none" stroke="black" d="M11897.5,-5825.68C11897.5,-5797.24 11897.5,-5760.08 11897.5,-5735.2"/>
<polygon fill="black" stroke="black" points="11901,-5735.02 11897.5,-5725.02 11894,-5735.02 11901,-5735.02"/>
</g>
<!-- layer11_ffn_down_11 -->
<g id="node930" class="node">
<title>layer11_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="12902,-5909 12455,-5909 12455,-5826 12902,-5826 12902,-5909"/>
<text text-anchor="middle" x="12678.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12678.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12678.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12678.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12678.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_res2_11 -->
<g id="node955" class="node">
<title>layer11_res2_11</title>
<polygon fill="none" stroke="black" points="12745.5,-5725 12611.5,-5725 12611.5,-5689 12745.5,-5689 12745.5,-5725"/>
<text text-anchor="middle" x="12678.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer11_res2_11</text>
</g>
<!-- layer11_ffn_down_11&#45;&gt;layer11_res2_11 -->
<g id="edge1012" class="edge">
<title>layer11_ffn_down_11&#45;&gt;layer11_res2_11</title>
<path fill="none" stroke="black" d="M12678.5,-5825.68C12678.5,-5797.24 12678.5,-5760.08 12678.5,-5735.2"/>
<polygon fill="black" stroke="black" points="12682,-5735.02 12678.5,-5725.02 12675,-5735.02 12682,-5735.02"/>
</g>
<!-- layer11_ffn_down_12 -->
<g id="node931" class="node">
<title>layer11_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14248,-5909 13801,-5909 13801,-5826 14248,-5826 14248,-5909"/>
<text text-anchor="middle" x="14024.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14024.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14024.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14024.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14024.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_res2_12 -->
<g id="node960" class="node">
<title>layer11_res2_12</title>
<polygon fill="none" stroke="black" points="14091.5,-5725 13957.5,-5725 13957.5,-5689 14091.5,-5689 14091.5,-5725"/>
<text text-anchor="middle" x="14024.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer11_res2_12</text>
</g>
<!-- layer11_ffn_down_12&#45;&gt;layer11_res2_12 -->
<g id="edge1023" class="edge">
<title>layer11_ffn_down_12&#45;&gt;layer11_res2_12</title>
<path fill="none" stroke="black" d="M14024.5,-5825.68C14024.5,-5797.24 14024.5,-5760.08 14024.5,-5735.2"/>
<polygon fill="black" stroke="black" points="14028,-5735.02 14024.5,-5725.02 14021,-5735.02 14028,-5735.02"/>
</g>
<!-- layer11_ffn_down_13 -->
<g id="node932" class="node">
<title>layer11_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="15384,-5909 14937,-5909 14937,-5826 15384,-5826 15384,-5909"/>
<text text-anchor="middle" x="15160.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15160.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15160.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="15160.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15160.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_res2_13 -->
<g id="node965" class="node">
<title>layer11_res2_13</title>
<polygon fill="none" stroke="black" points="15227.5,-5725 15093.5,-5725 15093.5,-5689 15227.5,-5689 15227.5,-5725"/>
<text text-anchor="middle" x="15160.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer11_res2_13</text>
</g>
<!-- layer11_ffn_down_13&#45;&gt;layer11_res2_13 -->
<g id="edge1034" class="edge">
<title>layer11_ffn_down_13&#45;&gt;layer11_res2_13</title>
<path fill="none" stroke="black" d="M15160.5,-5825.68C15160.5,-5797.24 15160.5,-5760.08 15160.5,-5735.2"/>
<polygon fill="black" stroke="black" points="15164,-5735.02 15160.5,-5725.02 15157,-5735.02 15164,-5735.02"/>
</g>
<!-- layer11_ffn_down_14 -->
<g id="node933" class="node">
<title>layer11_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16397,-5909 15950,-5909 15950,-5826 16397,-5826 16397,-5909"/>
<text text-anchor="middle" x="16173.5" y="-5893.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16173.5" y="-5878.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16173.5" y="-5863.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16173.5" y="-5848.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16173.5" y="-5833.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_res2_14 -->
<g id="node970" class="node">
<title>layer11_res2_14</title>
<polygon fill="none" stroke="black" points="16240.5,-5725 16106.5,-5725 16106.5,-5689 16240.5,-5689 16240.5,-5725"/>
<text text-anchor="middle" x="16173.5" y="-5703.3" font-family="Times,serif" font-size="14.00">layer11_res2_14</text>
</g>
<!-- layer11_ffn_down_14&#45;&gt;layer11_res2_14 -->
<g id="edge1045" class="edge">
<title>layer11_ffn_down_14&#45;&gt;layer11_res2_14</title>
<path fill="none" stroke="black" d="M16173.5,-5825.68C16173.5,-5797.24 16173.5,-5760.08 16173.5,-5735.2"/>
<polygon fill="black" stroke="black" points="16177,-5735.02 16173.5,-5725.02 16170,-5735.02 16177,-5735.02"/>
</g>
<!-- layer11_res2_15 -->
<g id="node935" class="node">
<title>layer11_res2_15</title>
<polygon fill="none" stroke="black" points="17620.24,-5790 16919.12,-5790 16738.76,-5624 17439.88,-5624 17620.24,-5790"/>
<text text-anchor="middle" x="17179.5" y="-5733.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17179.5" y="-5718.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5703.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5688.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5673.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer11_ffn_down_15&#45;&gt;layer11_res2_15 -->
<g id="edge1056" class="edge">
<title>layer11_ffn_down_15&#45;&gt;layer11_res2_15</title>
<path fill="none" stroke="black" d="M17179.5,-5825.68C17179.5,-5817.75 17179.5,-5809.14 17179.5,-5800.31"/>
<polygon fill="black" stroke="black" points="17183,-5800.27 17179.5,-5790.27 17176,-5800.27 17183,-5800.27"/>
</g>
<!-- layer12_mha_qkv_15 -->
<g id="node978" class="node">
<title>layer12_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17457.5,-5588 16901.5,-5588 16901.5,-5505 17457.5,-5505 17457.5,-5588"/>
<text text-anchor="middle" x="17179.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="17179.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17179.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="17179.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer11_res2_15&#45;&gt;layer12_mha_qkv_15 -->
<g id="edge1134" class="edge">
<title>layer11_res2_15&#45;&gt;layer12_mha_qkv_15</title>
<path fill="none" stroke="black" d="M17179.5,-5623.96C17179.5,-5615.25 17179.5,-5606.59 17179.5,-5598.39"/>
<polygon fill="black" stroke="black" points="17183,-5598.29 17179.5,-5588.29 17176,-5598.29 17183,-5598.29"/>
</g>
<!-- layer11_mha_attn_8&#45;&gt;layer11_mha_out_8 -->
<g id="edge971" class="edge">
<title>layer11_mha_attn_8&#45;&gt;layer11_mha_out_8</title>
<path fill="none" stroke="black" d="M9868.5,-6595.24C9868.5,-6573.68 9868.5,-6535.87 9868.5,-6504.79"/>
<polygon fill="black" stroke="black" points="9872,-6504.54 9868.5,-6494.54 9865,-6504.54 9872,-6504.54"/>
</g>
<!-- layer11_ln1_8 -->
<g id="node938" class="node">
<title>layer11_ln1_8</title>
<polygon fill="none" stroke="black" points="9926.5,-6206.5 9810.5,-6206.5 9810.5,-6170.5 9926.5,-6170.5 9926.5,-6206.5"/>
<text text-anchor="middle" x="9868.5" y="-6184.8" font-family="Times,serif" font-size="14.00">layer11_ln1_8</text>
</g>
<!-- layer11_res1_8&#45;&gt;layer11_ln1_8 -->
<g id="edge973" class="edge">
<title>layer11_res1_8&#45;&gt;layer11_ln1_8</title>
<path fill="none" stroke="black" d="M9868.5,-6281.89C9868.5,-6264.56 9868.5,-6237.46 9868.5,-6217.09"/>
<polygon fill="black" stroke="black" points="9872,-6216.85 9868.5,-6206.85 9865,-6216.85 9872,-6216.85"/>
</g>
<!-- layer11_ln1_8&#45;&gt;layer11_ffn_gate_8 -->
<g id="edge974" class="edge">
<title>layer11_ln1_8&#45;&gt;layer11_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9868.28,-6170.24C9868.01,-6148.68 9867.53,-6110.87 9867.14,-6079.79"/>
<polygon fill="black" stroke="black" points="9870.64,-6079.49 9867.01,-6069.54 9863.64,-6079.58 9870.64,-6079.49"/>
</g>
<!-- layer11_ln1_8&#45;&gt;layer11_ffn_up_8 -->
<g id="edge975" class="edge">
<title>layer11_ln1_8&#45;&gt;layer11_ffn_up_8</title>
<path fill="none" stroke="black" d="M9923.59,-6170.44C9972.9,-6155.11 10047.13,-6131.86 10111.5,-6111 10149.14,-6098.8 10189.94,-6085.31 10227.28,-6072.86"/>
<polygon fill="black" stroke="black" points="10228.83,-6076.03 10237.2,-6069.55 10226.61,-6069.39 10228.83,-6076.03"/>
</g>
<!-- layer11_ffn_act_8&#45;&gt;layer11_ffn_down_8 -->
<g id="edge978" class="edge">
<title>layer11_ffn_act_8&#45;&gt;layer11_ffn_down_8</title>
<path fill="none" stroke="black" d="M9902.5,-5849.24C9902.5,-5827.68 9902.5,-5789.87 9902.5,-5758.79"/>
<polygon fill="black" stroke="black" points="9906,-5758.54 9902.5,-5748.54 9899,-5758.54 9906,-5758.54"/>
</g>
<!-- layer12_mha_qkv_8 -->
<g id="node971" class="node">
<title>layer12_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="10180.5,-5427.5 9624.5,-5427.5 9624.5,-5344.5 10180.5,-5344.5 10180.5,-5427.5"/>
<text text-anchor="middle" x="9902.5" y="-5412.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9902.5" y="-5397.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9902.5" y="-5382.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9902.5" y="-5367.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9902.5" y="-5352.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer11_res2_8&#45;&gt;layer12_mha_qkv_8 -->
<g id="edge1057" class="edge">
<title>layer11_res2_8&#45;&gt;layer12_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9902.5,-5528.24C9902.5,-5506.68 9902.5,-5468.87 9902.5,-5437.79"/>
<polygon fill="black" stroke="black" points="9906,-5437.54 9902.5,-5427.54 9899,-5437.54 9906,-5437.54"/>
</g>
<!-- layer11_mha_attn_9&#45;&gt;layer11_mha_out_9 -->
<g id="edge982" class="edge">
<title>layer11_mha_attn_9&#45;&gt;layer11_mha_out_9</title>
<path fill="none" stroke="black" d="M10696.5,-6755.74C10696.5,-6734.18 10696.5,-6696.37 10696.5,-6665.29"/>
<polygon fill="black" stroke="black" points="10700,-6665.04 10696.5,-6655.04 10693,-6665.04 10700,-6665.04"/>
</g>
<!-- layer11_ln1_9 -->
<g id="node943" class="node">
<title>layer11_ln1_9</title>
<polygon fill="none" stroke="black" points="10754.5,-6318 10638.5,-6318 10638.5,-6282 10754.5,-6282 10754.5,-6318"/>
<text text-anchor="middle" x="10696.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_ln1_9</text>
</g>
<!-- layer11_res1_9&#45;&gt;layer11_ln1_9 -->
<g id="edge984" class="edge">
<title>layer11_res1_9&#45;&gt;layer11_ln1_9</title>
<path fill="none" stroke="black" d="M10696.5,-6434.97C10696.5,-6409.03 10696.5,-6359.36 10696.5,-6328.33"/>
<polygon fill="black" stroke="black" points="10700,-6328.2 10696.5,-6318.2 10693,-6328.2 10700,-6328.2"/>
</g>
<!-- layer11_ln1_9&#45;&gt;layer11_ffn_gate_9 -->
<g id="edge985" class="edge">
<title>layer11_ln1_9&#45;&gt;layer11_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10696.34,-6281.89C10696.24,-6270.65 10696.1,-6255.31 10695.96,-6240.35"/>
<polygon fill="black" stroke="black" points="10699.46,-6240.09 10695.87,-6230.12 10692.46,-6240.15 10699.46,-6240.09"/>
</g>
<!-- layer11_ln1_9&#45;&gt;layer11_ffn_up_9 -->
<g id="edge986" class="edge">
<title>layer11_ln1_9&#45;&gt;layer11_ffn_up_9</title>
<path fill="none" stroke="black" d="M10754.63,-6286.01C10813.95,-6272.75 10909.25,-6251.46 10995.25,-6232.24"/>
<polygon fill="black" stroke="black" points="10996.15,-6235.62 11005.15,-6230.03 10994.62,-6228.79 10996.15,-6235.62"/>
</g>
<!-- layer11_ffn_act_9&#45;&gt;layer11_ffn_down_9 -->
<g id="edge989" class="edge">
<title>layer11_ffn_act_9&#45;&gt;layer11_ffn_down_9</title>
<path fill="none" stroke="black" d="M10706.5,-6009.74C10706.5,-5988.18 10706.5,-5950.37 10706.5,-5919.29"/>
<polygon fill="black" stroke="black" points="10710,-5919.04 10706.5,-5909.04 10703,-5919.04 10710,-5919.04"/>
</g>
<!-- layer12_mha_qkv_9 -->
<g id="node972" class="node">
<title>layer12_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="10984.5,-5588 10428.5,-5588 10428.5,-5505 10984.5,-5505 10984.5,-5588"/>
<text text-anchor="middle" x="10706.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10706.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10706.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10706.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10706.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer11_res2_9&#45;&gt;layer12_mha_qkv_9 -->
<g id="edge1068" class="edge">
<title>layer11_res2_9&#45;&gt;layer12_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10706.5,-5688.74C10706.5,-5667.18 10706.5,-5629.37 10706.5,-5598.29"/>
<polygon fill="black" stroke="black" points="10710,-5598.04 10706.5,-5588.04 10703,-5598.04 10710,-5598.04"/>
</g>
<!-- layer11_mha_attn_10&#45;&gt;layer11_mha_out_10 -->
<g id="edge993" class="edge">
<title>layer11_mha_attn_10&#45;&gt;layer11_mha_out_10</title>
<path fill="none" stroke="black" d="M12139.5,-6755.74C12139.5,-6734.18 12139.5,-6696.37 12139.5,-6665.29"/>
<polygon fill="black" stroke="black" points="12143,-6665.04 12139.5,-6655.04 12136,-6665.04 12143,-6665.04"/>
</g>
<!-- layer11_ln1_10 -->
<g id="node948" class="node">
<title>layer11_ln1_10</title>
<polygon fill="none" stroke="black" points="12202,-6318 12077,-6318 12077,-6282 12202,-6282 12202,-6318"/>
<text text-anchor="middle" x="12139.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_ln1_10</text>
</g>
<!-- layer11_res1_10&#45;&gt;layer11_ln1_10 -->
<g id="edge995" class="edge">
<title>layer11_res1_10&#45;&gt;layer11_ln1_10</title>
<path fill="none" stroke="black" d="M12139.5,-6434.97C12139.5,-6409.03 12139.5,-6359.36 12139.5,-6328.33"/>
<polygon fill="black" stroke="black" points="12143,-6328.2 12139.5,-6318.2 12136,-6328.2 12143,-6328.2"/>
</g>
<!-- layer11_ln1_10&#45;&gt;layer11_ffn_gate_10 -->
<g id="edge996" class="edge">
<title>layer11_ln1_10&#45;&gt;layer11_ffn_gate_10</title>
<path fill="none" stroke="black" d="M12076.93,-6283.77C12022.38,-6270.5 11940.57,-6250.59 11866.16,-6232.49"/>
<polygon fill="black" stroke="black" points="11866.73,-6229.02 11856.18,-6230.06 11865.07,-6235.83 11866.73,-6229.02"/>
</g>
<!-- layer11_ln1_10&#45;&gt;layer11_ffn_up_10 -->
<g id="edge997" class="edge">
<title>layer11_ln1_10&#45;&gt;layer11_ffn_up_10</title>
<path fill="none" stroke="black" d="M12145.91,-6281.89C12150.2,-6270.43 12156.08,-6254.72 12161.78,-6239.49"/>
<polygon fill="black" stroke="black" points="12165.06,-6240.71 12165.29,-6230.12 12158.51,-6238.26 12165.06,-6240.71"/>
</g>
<!-- layer11_ffn_act_10&#45;&gt;layer11_ffn_down_10 -->
<g id="edge1000" class="edge">
<title>layer11_ffn_act_10&#45;&gt;layer11_ffn_down_10</title>
<path fill="none" stroke="black" d="M11897.5,-6009.74C11897.5,-5988.18 11897.5,-5950.37 11897.5,-5919.29"/>
<polygon fill="black" stroke="black" points="11901,-5919.04 11897.5,-5909.04 11894,-5919.04 11901,-5919.04"/>
</g>
<!-- layer12_mha_qkv_10 -->
<g id="node973" class="node">
<title>layer12_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="12175.5,-5588 11619.5,-5588 11619.5,-5505 12175.5,-5505 12175.5,-5588"/>
<text text-anchor="middle" x="11897.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="11897.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11897.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11897.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="11897.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer11_res2_10&#45;&gt;layer12_mha_qkv_10 -->
<g id="edge1079" class="edge">
<title>layer11_res2_10&#45;&gt;layer12_mha_qkv_10</title>
<path fill="none" stroke="black" d="M11897.5,-5688.74C11897.5,-5667.18 11897.5,-5629.37 11897.5,-5598.29"/>
<polygon fill="black" stroke="black" points="11901,-5598.04 11897.5,-5588.04 11894,-5598.04 11901,-5598.04"/>
</g>
<!-- layer11_mha_attn_11&#45;&gt;layer11_mha_out_11 -->
<g id="edge1004" class="edge">
<title>layer11_mha_attn_11&#45;&gt;layer11_mha_out_11</title>
<path fill="none" stroke="black" d="M12936.5,-6755.74C12936.5,-6734.18 12936.5,-6696.37 12936.5,-6665.29"/>
<polygon fill="black" stroke="black" points="12940,-6665.04 12936.5,-6655.04 12933,-6665.04 12940,-6665.04"/>
</g>
<!-- layer11_ln1_11 -->
<g id="node953" class="node">
<title>layer11_ln1_11</title>
<polygon fill="none" stroke="black" points="12999,-6318 12874,-6318 12874,-6282 12999,-6282 12999,-6318"/>
<text text-anchor="middle" x="12936.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_ln1_11</text>
</g>
<!-- layer11_res1_11&#45;&gt;layer11_ln1_11 -->
<g id="edge1006" class="edge">
<title>layer11_res1_11&#45;&gt;layer11_ln1_11</title>
<path fill="none" stroke="black" d="M12936.5,-6434.97C12936.5,-6409.03 12936.5,-6359.36 12936.5,-6328.33"/>
<polygon fill="black" stroke="black" points="12940,-6328.2 12936.5,-6318.2 12933,-6328.2 12940,-6328.2"/>
</g>
<!-- layer11_ln1_11&#45;&gt;layer11_ffn_gate_11 -->
<g id="edge1007" class="edge">
<title>layer11_ln1_11&#45;&gt;layer11_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12896.03,-6281.89C12865.61,-6269.03 12822.48,-6250.79 12782.56,-6233.92"/>
<polygon fill="black" stroke="black" points="12783.87,-6230.67 12773.3,-6230 12781.15,-6237.12 12783.87,-6230.67"/>
</g>
<!-- layer11_ln1_11&#45;&gt;layer11_ffn_up_11 -->
<g id="edge1008" class="edge">
<title>layer11_ln1_11&#45;&gt;layer11_ffn_up_11</title>
<path fill="none" stroke="black" d="M12972.75,-6281.89C12999.66,-6269.19 13037.66,-6251.25 13073.03,-6234.56"/>
<polygon fill="black" stroke="black" points="13074.89,-6237.55 13082.44,-6230.12 13071.9,-6231.22 13074.89,-6237.55"/>
</g>
<!-- layer11_ffn_act_11&#45;&gt;layer11_ffn_down_11 -->
<g id="edge1011" class="edge">
<title>layer11_ffn_act_11&#45;&gt;layer11_ffn_down_11</title>
<path fill="none" stroke="black" d="M12678.5,-6009.74C12678.5,-5988.18 12678.5,-5950.37 12678.5,-5919.29"/>
<polygon fill="black" stroke="black" points="12682,-5919.04 12678.5,-5909.04 12675,-5919.04 12682,-5919.04"/>
</g>
<!-- layer12_mha_qkv_11 -->
<g id="node974" class="node">
<title>layer12_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="12956.5,-5588 12400.5,-5588 12400.5,-5505 12956.5,-5505 12956.5,-5588"/>
<text text-anchor="middle" x="12678.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12678.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12678.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12678.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12678.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer11_res2_11&#45;&gt;layer12_mha_qkv_11 -->
<g id="edge1090" class="edge">
<title>layer11_res2_11&#45;&gt;layer12_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12678.5,-5688.74C12678.5,-5667.18 12678.5,-5629.37 12678.5,-5598.29"/>
<polygon fill="black" stroke="black" points="12682,-5598.04 12678.5,-5588.04 12675,-5598.04 12682,-5598.04"/>
</g>
<!-- layer11_mha_attn_12&#45;&gt;layer11_mha_out_12 -->
<g id="edge1015" class="edge">
<title>layer11_mha_attn_12&#45;&gt;layer11_mha_out_12</title>
<path fill="none" stroke="black" d="M14023.5,-6755.74C14023.5,-6734.18 14023.5,-6696.37 14023.5,-6665.29"/>
<polygon fill="black" stroke="black" points="14027,-6665.04 14023.5,-6655.04 14020,-6665.04 14027,-6665.04"/>
</g>
<!-- layer11_ln1_12 -->
<g id="node958" class="node">
<title>layer11_ln1_12</title>
<polygon fill="none" stroke="black" points="14086,-6318 13961,-6318 13961,-6282 14086,-6282 14086,-6318"/>
<text text-anchor="middle" x="14023.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_ln1_12</text>
</g>
<!-- layer11_res1_12&#45;&gt;layer11_ln1_12 -->
<g id="edge1017" class="edge">
<title>layer11_res1_12&#45;&gt;layer11_ln1_12</title>
<path fill="none" stroke="black" d="M14023.5,-6434.97C14023.5,-6409.03 14023.5,-6359.36 14023.5,-6328.33"/>
<polygon fill="black" stroke="black" points="14027,-6328.2 14023.5,-6318.2 14020,-6328.2 14027,-6328.2"/>
</g>
<!-- layer11_ln1_12&#45;&gt;layer11_ffn_gate_12 -->
<g id="edge1018" class="edge">
<title>layer11_ln1_12&#45;&gt;layer11_ffn_gate_12</title>
<path fill="none" stroke="black" d="M13985.22,-6281.89C13956.62,-6269.11 13916.15,-6251.02 13878.6,-6234.24"/>
<polygon fill="black" stroke="black" points="13879.68,-6230.89 13869.12,-6230 13876.82,-6237.28 13879.68,-6230.89"/>
</g>
<!-- layer11_ln1_12&#45;&gt;layer11_ffn_up_12 -->
<g id="edge1019" class="edge">
<title>layer11_ln1_12&#45;&gt;layer11_ffn_up_12</title>
<path fill="none" stroke="black" d="M14061.94,-6281.89C14090.65,-6269.11 14131.28,-6251.02 14168.99,-6234.24"/>
<polygon fill="black" stroke="black" points="14170.8,-6237.27 14178.51,-6230 14167.95,-6230.87 14170.8,-6237.27"/>
</g>
<!-- layer11_ffn_act_12&#45;&gt;layer11_ffn_down_12 -->
<g id="edge1022" class="edge">
<title>layer11_ffn_act_12&#45;&gt;layer11_ffn_down_12</title>
<path fill="none" stroke="black" d="M14024.5,-6009.74C14024.5,-5988.18 14024.5,-5950.37 14024.5,-5919.29"/>
<polygon fill="black" stroke="black" points="14028,-5919.04 14024.5,-5909.04 14021,-5919.04 14028,-5919.04"/>
</g>
<!-- layer12_mha_qkv_12 -->
<g id="node975" class="node">
<title>layer12_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14302.5,-5588 13746.5,-5588 13746.5,-5505 14302.5,-5505 14302.5,-5588"/>
<text text-anchor="middle" x="14024.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14024.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14024.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14024.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14024.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer11_res2_12&#45;&gt;layer12_mha_qkv_12 -->
<g id="edge1101" class="edge">
<title>layer11_res2_12&#45;&gt;layer12_mha_qkv_12</title>
<path fill="none" stroke="black" d="M14024.5,-5688.74C14024.5,-5667.18 14024.5,-5629.37 14024.5,-5598.29"/>
<polygon fill="black" stroke="black" points="14028,-5598.04 14024.5,-5588.04 14021,-5598.04 14028,-5598.04"/>
</g>
<!-- layer11_mha_attn_13&#45;&gt;layer11_mha_out_13 -->
<g id="edge1026" class="edge">
<title>layer11_mha_attn_13&#45;&gt;layer11_mha_out_13</title>
<path fill="none" stroke="black" d="M15169.5,-6755.74C15169.5,-6734.18 15169.5,-6696.37 15169.5,-6665.29"/>
<polygon fill="black" stroke="black" points="15173,-6665.04 15169.5,-6655.04 15166,-6665.04 15173,-6665.04"/>
</g>
<!-- layer11_ln1_13 -->
<g id="node963" class="node">
<title>layer11_ln1_13</title>
<polygon fill="none" stroke="black" points="15232,-6318 15107,-6318 15107,-6282 15232,-6282 15232,-6318"/>
<text text-anchor="middle" x="15169.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_ln1_13</text>
</g>
<!-- layer11_res1_13&#45;&gt;layer11_ln1_13 -->
<g id="edge1028" class="edge">
<title>layer11_res1_13&#45;&gt;layer11_ln1_13</title>
<path fill="none" stroke="black" d="M15169.5,-6434.97C15169.5,-6409.03 15169.5,-6359.36 15169.5,-6328.33"/>
<polygon fill="black" stroke="black" points="15173,-6328.2 15169.5,-6318.2 15166,-6328.2 15173,-6328.2"/>
</g>
<!-- layer11_ln1_13&#45;&gt;layer11_ffn_gate_13 -->
<g id="edge1029" class="edge">
<title>layer11_ln1_13&#45;&gt;layer11_ffn_gate_13</title>
<path fill="none" stroke="black" d="M15165.75,-6281.89C15163.26,-6270.54 15159.86,-6255.01 15156.55,-6239.92"/>
<polygon fill="black" stroke="black" points="15159.96,-6239.14 15154.4,-6230.12 15153.12,-6240.64 15159.96,-6239.14"/>
</g>
<!-- layer11_ln1_13&#45;&gt;layer11_ffn_up_13 -->
<g id="edge1030" class="edge">
<title>layer11_ln1_13&#45;&gt;layer11_ffn_up_13</title>
<path fill="none" stroke="black" d="M15232.48,-6284.23C15289.19,-6270.94 15375.39,-6250.72 15453.63,-6232.38"/>
<polygon fill="black" stroke="black" points="15454.68,-6235.73 15463.62,-6230.04 15453.08,-6228.91 15454.68,-6235.73"/>
</g>
<!-- layer11_ffn_act_13&#45;&gt;layer11_ffn_down_13 -->
<g id="edge1033" class="edge">
<title>layer11_ffn_act_13&#45;&gt;layer11_ffn_down_13</title>
<path fill="none" stroke="black" d="M15160.5,-6009.74C15160.5,-5988.18 15160.5,-5950.37 15160.5,-5919.29"/>
<polygon fill="black" stroke="black" points="15164,-5919.04 15160.5,-5909.04 15157,-5919.04 15164,-5919.04"/>
</g>
<!-- layer12_mha_qkv_13 -->
<g id="node976" class="node">
<title>layer12_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15438.5,-5588 14882.5,-5588 14882.5,-5505 15438.5,-5505 15438.5,-5588"/>
<text text-anchor="middle" x="15160.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="15160.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15160.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15160.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="15160.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer11_res2_13&#45;&gt;layer12_mha_qkv_13 -->
<g id="edge1112" class="edge">
<title>layer11_res2_13&#45;&gt;layer12_mha_qkv_13</title>
<path fill="none" stroke="black" d="M15160.5,-5688.74C15160.5,-5667.18 15160.5,-5629.37 15160.5,-5598.29"/>
<polygon fill="black" stroke="black" points="15164,-5598.04 15160.5,-5588.04 15157,-5598.04 15164,-5598.04"/>
</g>
<!-- layer11_mha_attn_14&#45;&gt;layer11_mha_out_14 -->
<g id="edge1037" class="edge">
<title>layer11_mha_attn_14&#45;&gt;layer11_mha_out_14</title>
<path fill="none" stroke="black" d="M16589.5,-6755.74C16589.5,-6734.18 16589.5,-6696.37 16589.5,-6665.29"/>
<polygon fill="black" stroke="black" points="16593,-6665.04 16589.5,-6655.04 16586,-6665.04 16593,-6665.04"/>
</g>
<!-- layer11_ln1_14 -->
<g id="node968" class="node">
<title>layer11_ln1_14</title>
<polygon fill="none" stroke="black" points="16652,-6318 16527,-6318 16527,-6282 16652,-6282 16652,-6318"/>
<text text-anchor="middle" x="16589.5" y="-6296.3" font-family="Times,serif" font-size="14.00">layer11_ln1_14</text>
</g>
<!-- layer11_res1_14&#45;&gt;layer11_ln1_14 -->
<g id="edge1039" class="edge">
<title>layer11_res1_14&#45;&gt;layer11_ln1_14</title>
<path fill="none" stroke="black" d="M16589.5,-6434.97C16589.5,-6409.03 16589.5,-6359.36 16589.5,-6328.33"/>
<polygon fill="black" stroke="black" points="16593,-6328.2 16589.5,-6318.2 16586,-6328.2 16593,-6328.2"/>
</g>
<!-- layer11_ln1_14&#45;&gt;layer11_ffn_gate_14 -->
<g id="edge1040" class="edge">
<title>layer11_ln1_14&#45;&gt;layer11_ffn_gate_14</title>
<path fill="none" stroke="black" d="M16526.71,-6284.12C16470.58,-6270.81 16385.5,-6250.65 16308.29,-6232.35"/>
<polygon fill="black" stroke="black" points="16308.97,-6228.91 16298.43,-6230.01 16307.35,-6235.72 16308.97,-6228.91"/>
</g>
<!-- layer11_ln1_14&#45;&gt;layer11_ffn_up_14 -->
<g id="edge1041" class="edge">
<title>layer11_ln1_14&#45;&gt;layer11_ffn_up_14</title>
<path fill="none" stroke="black" d="M16594.03,-6281.89C16597.04,-6270.54 16601.15,-6255.01 16605.15,-6239.92"/>
<polygon fill="black" stroke="black" points="16608.57,-6240.68 16607.74,-6230.12 16601.8,-6238.89 16608.57,-6240.68"/>
</g>
<!-- layer11_ffn_act_14&#45;&gt;layer11_ffn_down_14 -->
<g id="edge1044" class="edge">
<title>layer11_ffn_act_14&#45;&gt;layer11_ffn_down_14</title>
<path fill="none" stroke="black" d="M16173.5,-6009.74C16173.5,-5988.18 16173.5,-5950.37 16173.5,-5919.29"/>
<polygon fill="black" stroke="black" points="16177,-5919.04 16173.5,-5909.04 16170,-5919.04 16177,-5919.04"/>
</g>
<!-- layer12_mha_qkv_14 -->
<g id="node977" class="node">
<title>layer12_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16451.5,-5588 15895.5,-5588 15895.5,-5505 16451.5,-5505 16451.5,-5588"/>
<text text-anchor="middle" x="16173.5" y="-5572.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16173.5" y="-5557.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16173.5" y="-5542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16173.5" y="-5527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16173.5" y="-5512.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer11_res2_14&#45;&gt;layer12_mha_qkv_14 -->
<g id="edge1123" class="edge">
<title>layer11_res2_14&#45;&gt;layer12_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16173.5,-5688.74C16173.5,-5667.18 16173.5,-5629.37 16173.5,-5598.29"/>
<polygon fill="black" stroke="black" points="16177,-5598.04 16173.5,-5588.04 16170,-5598.04 16177,-5598.04"/>
</g>
<!-- layer12_mha_attn_8 -->
<g id="node1016" class="node">
<title>layer12_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9982.5,-5243.5 9822.5,-5243.5 9822.5,-5207.5 9982.5,-5207.5 9982.5,-5243.5"/>
<text text-anchor="middle" x="9902.5" y="-5221.8" font-family="Times,serif" font-size="14.00">layer12_mha_attn_8</text>
</g>
<!-- layer12_mha_qkv_8&#45;&gt;layer12_mha_attn_8 -->
<g id="edge1058" class="edge">
<title>layer12_mha_qkv_8&#45;&gt;layer12_mha_attn_8</title>
<path fill="none" stroke="black" d="M9902.5,-5344.18C9902.5,-5315.74 9902.5,-5278.58 9902.5,-5253.7"/>
<polygon fill="black" stroke="black" points="9906,-5253.52 9902.5,-5243.52 9899,-5253.52 9906,-5253.52"/>
</g>
<!-- layer12_mha_attn_9 -->
<g id="node1021" class="node">
<title>layer12_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10786.5,-5404 10626.5,-5404 10626.5,-5368 10786.5,-5368 10786.5,-5404"/>
<text text-anchor="middle" x="10706.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer12_mha_attn_9</text>
</g>
<!-- layer12_mha_qkv_9&#45;&gt;layer12_mha_attn_9 -->
<g id="edge1069" class="edge">
<title>layer12_mha_qkv_9&#45;&gt;layer12_mha_attn_9</title>
<path fill="none" stroke="black" d="M10706.5,-5504.68C10706.5,-5476.24 10706.5,-5439.08 10706.5,-5414.2"/>
<polygon fill="black" stroke="black" points="10710,-5414.02 10706.5,-5404.02 10703,-5414.02 10710,-5414.02"/>
</g>
<!-- layer12_mha_attn_10 -->
<g id="node1026" class="node">
<title>layer12_mha_attn_10</title>
<polygon fill="none" stroke="black" points="11982,-5404 11813,-5404 11813,-5368 11982,-5368 11982,-5404"/>
<text text-anchor="middle" x="11897.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer12_mha_attn_10</text>
</g>
<!-- layer12_mha_qkv_10&#45;&gt;layer12_mha_attn_10 -->
<g id="edge1080" class="edge">
<title>layer12_mha_qkv_10&#45;&gt;layer12_mha_attn_10</title>
<path fill="none" stroke="black" d="M11897.5,-5504.68C11897.5,-5476.24 11897.5,-5439.08 11897.5,-5414.2"/>
<polygon fill="black" stroke="black" points="11901,-5414.02 11897.5,-5404.02 11894,-5414.02 11901,-5414.02"/>
</g>
<!-- layer12_mha_attn_11 -->
<g id="node1031" class="node">
<title>layer12_mha_attn_11</title>
<polygon fill="none" stroke="black" points="12763,-5404 12594,-5404 12594,-5368 12763,-5368 12763,-5404"/>
<text text-anchor="middle" x="12678.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer12_mha_attn_11</text>
</g>
<!-- layer12_mha_qkv_11&#45;&gt;layer12_mha_attn_11 -->
<g id="edge1091" class="edge">
<title>layer12_mha_qkv_11&#45;&gt;layer12_mha_attn_11</title>
<path fill="none" stroke="black" d="M12678.5,-5504.68C12678.5,-5476.24 12678.5,-5439.08 12678.5,-5414.2"/>
<polygon fill="black" stroke="black" points="12682,-5414.02 12678.5,-5404.02 12675,-5414.02 12682,-5414.02"/>
</g>
<!-- layer12_mha_attn_12 -->
<g id="node1036" class="node">
<title>layer12_mha_attn_12</title>
<polygon fill="none" stroke="black" points="14109,-5404 13940,-5404 13940,-5368 14109,-5368 14109,-5404"/>
<text text-anchor="middle" x="14024.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer12_mha_attn_12</text>
</g>
<!-- layer12_mha_qkv_12&#45;&gt;layer12_mha_attn_12 -->
<g id="edge1102" class="edge">
<title>layer12_mha_qkv_12&#45;&gt;layer12_mha_attn_12</title>
<path fill="none" stroke="black" d="M14024.5,-5504.68C14024.5,-5476.24 14024.5,-5439.08 14024.5,-5414.2"/>
<polygon fill="black" stroke="black" points="14028,-5414.02 14024.5,-5404.02 14021,-5414.02 14028,-5414.02"/>
</g>
<!-- layer12_mha_attn_13 -->
<g id="node1041" class="node">
<title>layer12_mha_attn_13</title>
<polygon fill="none" stroke="black" points="15245,-5404 15076,-5404 15076,-5368 15245,-5368 15245,-5404"/>
<text text-anchor="middle" x="15160.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer12_mha_attn_13</text>
</g>
<!-- layer12_mha_qkv_13&#45;&gt;layer12_mha_attn_13 -->
<g id="edge1113" class="edge">
<title>layer12_mha_qkv_13&#45;&gt;layer12_mha_attn_13</title>
<path fill="none" stroke="black" d="M15160.5,-5504.68C15160.5,-5476.24 15160.5,-5439.08 15160.5,-5414.2"/>
<polygon fill="black" stroke="black" points="15164,-5414.02 15160.5,-5404.02 15157,-5414.02 15164,-5414.02"/>
</g>
<!-- layer12_mha_attn_14 -->
<g id="node1046" class="node">
<title>layer12_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16258,-5404 16089,-5404 16089,-5368 16258,-5368 16258,-5404"/>
<text text-anchor="middle" x="16173.5" y="-5382.3" font-family="Times,serif" font-size="14.00">layer12_mha_attn_14</text>
</g>
<!-- layer12_mha_qkv_14&#45;&gt;layer12_mha_attn_14 -->
<g id="edge1124" class="edge">
<title>layer12_mha_qkv_14&#45;&gt;layer12_mha_attn_14</title>
<path fill="none" stroke="black" d="M16173.5,-5504.68C16173.5,-5476.24 16173.5,-5439.08 16173.5,-5414.2"/>
<polygon fill="black" stroke="black" points="16177,-5414.02 16173.5,-5404.02 16170,-5414.02 16177,-5414.02"/>
</g>
<!-- layer12_mha_attn_15 -->
<g id="node979" class="node">
<title>layer12_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17656.31,-5469 16897.81,-5469 16702.69,-5303 17461.19,-5303 17656.31,-5469"/>
<text text-anchor="middle" x="17179.5" y="-5412.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17179.5" y="-5397.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="17179.5" y="-5382.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17179.5" y="-5367.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5352.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_mha_qkv_15&#45;&gt;layer12_mha_attn_15 -->
<g id="edge1135" class="edge">
<title>layer12_mha_qkv_15&#45;&gt;layer12_mha_attn_15</title>
<path fill="none" stroke="black" d="M17179.5,-5504.68C17179.5,-5496.75 17179.5,-5488.14 17179.5,-5479.31"/>
<polygon fill="black" stroke="black" points="17183,-5479.27 17179.5,-5469.27 17176,-5479.27 17183,-5479.27"/>
</g>
<!-- layer12_mha_out_15 -->
<g id="node987" class="node">
<title>layer12_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17398.5,-5267 16960.5,-5267 16960.5,-5184 17398.5,-5184 17398.5,-5267"/>
<text text-anchor="middle" x="17179.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="17179.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17179.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="17179.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_mha_attn_15&#45;&gt;layer12_mha_out_15 -->
<g id="edge1136" class="edge">
<title>layer12_mha_attn_15&#45;&gt;layer12_mha_out_15</title>
<path fill="none" stroke="black" d="M17179.5,-5302.96C17179.5,-5294.25 17179.5,-5285.59 17179.5,-5277.39"/>
<polygon fill="black" stroke="black" points="17183,-5277.29 17179.5,-5267.29 17176,-5277.29 17183,-5277.29"/>
</g>
<!-- layer12_mha_out_8 -->
<g id="node980" class="node">
<title>layer12_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="10121.5,-5106.5 9683.5,-5106.5 9683.5,-5023.5 10121.5,-5023.5 10121.5,-5106.5"/>
<text text-anchor="middle" x="9902.5" y="-5091.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9902.5" y="-5076.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9902.5" y="-5061.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9902.5" y="-5046.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9902.5" y="-5031.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_res1_8 -->
<g id="node1017" class="node">
<title>layer12_res1_8</title>
<polygon fill="none" stroke="black" points="9965,-4930 9840,-4930 9840,-4894 9965,-4894 9965,-4930"/>
<text text-anchor="middle" x="9902.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_res1_8</text>
</g>
<!-- layer12_mha_out_8&#45;&gt;layer12_res1_8 -->
<g id="edge1060" class="edge">
<title>layer12_mha_out_8&#45;&gt;layer12_res1_8</title>
<path fill="none" stroke="black" d="M9902.5,-5023.14C9902.5,-4996.9 9902.5,-4963.53 9902.5,-4940.44"/>
<polygon fill="black" stroke="black" points="9906,-4940.31 9902.5,-4930.31 9899,-4940.31 9906,-4940.31"/>
</g>
<!-- layer12_mha_out_9 -->
<g id="node981" class="node">
<title>layer12_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="10925.5,-5267 10487.5,-5267 10487.5,-5184 10925.5,-5184 10925.5,-5267"/>
<text text-anchor="middle" x="10706.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10706.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10706.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10706.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10706.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_res1_9 -->
<g id="node1022" class="node">
<title>layer12_res1_9</title>
<polygon fill="none" stroke="black" points="10769,-5083 10644,-5083 10644,-5047 10769,-5047 10769,-5083"/>
<text text-anchor="middle" x="10706.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer12_res1_9</text>
</g>
<!-- layer12_mha_out_9&#45;&gt;layer12_res1_9 -->
<g id="edge1071" class="edge">
<title>layer12_mha_out_9&#45;&gt;layer12_res1_9</title>
<path fill="none" stroke="black" d="M10706.5,-5183.68C10706.5,-5155.24 10706.5,-5118.08 10706.5,-5093.2"/>
<polygon fill="black" stroke="black" points="10710,-5093.02 10706.5,-5083.02 10703,-5093.02 10710,-5093.02"/>
</g>
<!-- layer12_mha_out_10 -->
<g id="node982" class="node">
<title>layer12_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="12116.5,-5267 11678.5,-5267 11678.5,-5184 12116.5,-5184 12116.5,-5267"/>
<text text-anchor="middle" x="11897.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="11897.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11897.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11897.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11897.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_res1_10 -->
<g id="node1027" class="node">
<title>layer12_res1_10</title>
<polygon fill="none" stroke="black" points="11964.5,-5083 11830.5,-5083 11830.5,-5047 11964.5,-5047 11964.5,-5083"/>
<text text-anchor="middle" x="11897.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer12_res1_10</text>
</g>
<!-- layer12_mha_out_10&#45;&gt;layer12_res1_10 -->
<g id="edge1082" class="edge">
<title>layer12_mha_out_10&#45;&gt;layer12_res1_10</title>
<path fill="none" stroke="black" d="M11897.5,-5183.68C11897.5,-5155.24 11897.5,-5118.08 11897.5,-5093.2"/>
<polygon fill="black" stroke="black" points="11901,-5093.02 11897.5,-5083.02 11894,-5093.02 11901,-5093.02"/>
</g>
<!-- layer12_mha_out_11 -->
<g id="node983" class="node">
<title>layer12_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="12897.5,-5267 12459.5,-5267 12459.5,-5184 12897.5,-5184 12897.5,-5267"/>
<text text-anchor="middle" x="12678.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12678.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12678.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12678.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12678.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_res1_11 -->
<g id="node1032" class="node">
<title>layer12_res1_11</title>
<polygon fill="none" stroke="black" points="12745.5,-5083 12611.5,-5083 12611.5,-5047 12745.5,-5047 12745.5,-5083"/>
<text text-anchor="middle" x="12678.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer12_res1_11</text>
</g>
<!-- layer12_mha_out_11&#45;&gt;layer12_res1_11 -->
<g id="edge1093" class="edge">
<title>layer12_mha_out_11&#45;&gt;layer12_res1_11</title>
<path fill="none" stroke="black" d="M12678.5,-5183.68C12678.5,-5155.24 12678.5,-5118.08 12678.5,-5093.2"/>
<polygon fill="black" stroke="black" points="12682,-5093.02 12678.5,-5083.02 12675,-5093.02 12682,-5093.02"/>
</g>
<!-- layer12_mha_out_12 -->
<g id="node984" class="node">
<title>layer12_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14243.5,-5267 13805.5,-5267 13805.5,-5184 14243.5,-5184 14243.5,-5267"/>
<text text-anchor="middle" x="14024.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14024.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14024.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14024.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14024.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_res1_12 -->
<g id="node1037" class="node">
<title>layer12_res1_12</title>
<polygon fill="none" stroke="black" points="14091.5,-5083 13957.5,-5083 13957.5,-5047 14091.5,-5047 14091.5,-5083"/>
<text text-anchor="middle" x="14024.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer12_res1_12</text>
</g>
<!-- layer12_mha_out_12&#45;&gt;layer12_res1_12 -->
<g id="edge1104" class="edge">
<title>layer12_mha_out_12&#45;&gt;layer12_res1_12</title>
<path fill="none" stroke="black" d="M14024.5,-5183.68C14024.5,-5155.24 14024.5,-5118.08 14024.5,-5093.2"/>
<polygon fill="black" stroke="black" points="14028,-5093.02 14024.5,-5083.02 14021,-5093.02 14028,-5093.02"/>
</g>
<!-- layer12_mha_out_13 -->
<g id="node985" class="node">
<title>layer12_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="15379.5,-5267 14941.5,-5267 14941.5,-5184 15379.5,-5184 15379.5,-5267"/>
<text text-anchor="middle" x="15160.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="15160.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15160.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15160.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15160.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_res1_13 -->
<g id="node1042" class="node">
<title>layer12_res1_13</title>
<polygon fill="none" stroke="black" points="15227.5,-5083 15093.5,-5083 15093.5,-5047 15227.5,-5047 15227.5,-5083"/>
<text text-anchor="middle" x="15160.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer12_res1_13</text>
</g>
<!-- layer12_mha_out_13&#45;&gt;layer12_res1_13 -->
<g id="edge1115" class="edge">
<title>layer12_mha_out_13&#45;&gt;layer12_res1_13</title>
<path fill="none" stroke="black" d="M15160.5,-5183.68C15160.5,-5155.24 15160.5,-5118.08 15160.5,-5093.2"/>
<polygon fill="black" stroke="black" points="15164,-5093.02 15160.5,-5083.02 15157,-5093.02 15164,-5093.02"/>
</g>
<!-- layer12_mha_out_14 -->
<g id="node986" class="node">
<title>layer12_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16392.5,-5267 15954.5,-5267 15954.5,-5184 16392.5,-5184 16392.5,-5267"/>
<text text-anchor="middle" x="16173.5" y="-5251.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16173.5" y="-5236.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16173.5" y="-5221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16173.5" y="-5206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16173.5" y="-5191.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_res1_14 -->
<g id="node1047" class="node">
<title>layer12_res1_14</title>
<polygon fill="none" stroke="black" points="16240.5,-5083 16106.5,-5083 16106.5,-5047 16240.5,-5047 16240.5,-5083"/>
<text text-anchor="middle" x="16173.5" y="-5061.3" font-family="Times,serif" font-size="14.00">layer12_res1_14</text>
</g>
<!-- layer12_mha_out_14&#45;&gt;layer12_res1_14 -->
<g id="edge1126" class="edge">
<title>layer12_mha_out_14&#45;&gt;layer12_res1_14</title>
<path fill="none" stroke="black" d="M16173.5,-5183.68C16173.5,-5155.24 16173.5,-5118.08 16173.5,-5093.2"/>
<polygon fill="black" stroke="black" points="16177,-5093.02 16173.5,-5083.02 16170,-5093.02 16177,-5093.02"/>
</g>
<!-- layer12_res1_15 -->
<g id="node988" class="node">
<title>layer12_res1_15</title>
<polygon fill="none" stroke="black" points="17620.24,-5148 16919.12,-5148 16738.76,-4982 17439.88,-4982 17620.24,-5148"/>
<text text-anchor="middle" x="17179.5" y="-5091.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17179.5" y="-5076.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5061.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5046.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-5031.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_mha_out_15&#45;&gt;layer12_res1_15 -->
<g id="edge1137" class="edge">
<title>layer12_mha_out_15&#45;&gt;layer12_res1_15</title>
<path fill="none" stroke="black" d="M17179.5,-5183.68C17179.5,-5175.75 17179.5,-5167.14 17179.5,-5158.31"/>
<polygon fill="black" stroke="black" points="17183,-5158.27 17179.5,-5148.27 17176,-5158.27 17183,-5158.27"/>
</g>
<!-- layer12_ln1_15 -->
<g id="node989" class="node">
<title>layer12_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17392,-4946 16967,-4946 16967,-4878 17392,-4878 17392,-4946"/>
<text text-anchor="middle" x="17179.5" y="-4930.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="17179.5" y="-4915.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-4900.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17179.5" y="-4885.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_res1_15&#45;&gt;layer12_ln1_15 -->
<g id="edge1138" class="edge">
<title>layer12_res1_15&#45;&gt;layer12_ln1_15</title>
<path fill="none" stroke="black" d="M17179.5,-4981.87C17179.5,-4973.12 17179.5,-4964.48 17179.5,-4956.45"/>
<polygon fill="black" stroke="black" points="17183,-4956.26 17179.5,-4946.26 17176,-4956.26 17183,-4956.26"/>
</g>
<!-- layer12_ffn_gate_15 -->
<g id="node997" class="node">
<title>layer12_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="16969,-4842 16496,-4842 16496,-4759 16969,-4759 16969,-4842"/>
<text text-anchor="middle" x="16732.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16732.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16732.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16732.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16732.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_ln1_15&#45;&gt;layer12_ffn_gate_15 -->
<g id="edge1139" class="edge">
<title>layer12_ln1_15&#45;&gt;layer12_ffn_gate_15</title>
<path fill="none" stroke="black" d="M17044.78,-4878C17001.79,-4867.47 16953.57,-4855.65 16908.12,-4844.52"/>
<polygon fill="black" stroke="black" points="16908.71,-4841.06 16898.16,-4842.08 16907.04,-4847.86 16908.71,-4841.06"/>
</g>
<!-- layer12_ffn_up_15 -->
<g id="node1005" class="node">
<title>layer12_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17460,-4842 16987,-4842 16987,-4759 17460,-4759 17460,-4842"/>
<text text-anchor="middle" x="17223.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17223.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17223.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17223.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17223.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_ln1_15&#45;&gt;layer12_ffn_up_15 -->
<g id="edge1140" class="edge">
<title>layer12_ln1_15&#45;&gt;layer12_ffn_up_15</title>
<path fill="none" stroke="black" d="M17192.82,-4877.85C17196.13,-4869.62 17199.75,-4860.62 17203.3,-4851.77"/>
<polygon fill="black" stroke="black" points="17206.63,-4852.86 17207.11,-4842.28 17200.14,-4850.25 17206.63,-4852.86"/>
</g>
<!-- layer12_ffn_gate_8 -->
<g id="node990" class="node">
<title>layer12_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="10095,-4681.5 9622,-4681.5 9622,-4598.5 10095,-4598.5 10095,-4681.5"/>
<text text-anchor="middle" x="9858.5" y="-4666.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9858.5" y="-4651.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9858.5" y="-4636.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9858.5" y="-4621.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9858.5" y="-4606.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_ffn_act_8 -->
<g id="node1019" class="node">
<title>layer12_ffn_act_8</title>
<polygon fill="none" stroke="black" points="9956.5,-4497.5 9816.5,-4497.5 9816.5,-4461.5 9956.5,-4461.5 9956.5,-4497.5"/>
<text text-anchor="middle" x="9886.5" y="-4475.8" font-family="Times,serif" font-size="14.00">layer12_ffn_act_8</text>
</g>
<!-- layer12_ffn_gate_8&#45;&gt;layer12_ffn_act_8 -->
<g id="edge1064" class="edge">
<title>layer12_ffn_gate_8&#45;&gt;layer12_ffn_act_8</title>
<path fill="none" stroke="black" d="M9865.71,-4598.18C9870.74,-4569.74 9877.3,-4532.58 9881.7,-4507.7"/>
<polygon fill="black" stroke="black" points="9885.2,-4507.98 9883.49,-4497.52 9878.31,-4506.76 9885.2,-4507.98"/>
</g>
<!-- layer12_ffn_gate_9 -->
<g id="node991" class="node">
<title>layer12_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10456,-4842 9983,-4842 9983,-4759 10456,-4759 10456,-4842"/>
<text text-anchor="middle" x="10219.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10219.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10219.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10219.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10219.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_ffn_act_9 -->
<g id="node1024" class="node">
<title>layer12_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10758.5,-4658 10618.5,-4658 10618.5,-4622 10758.5,-4622 10758.5,-4658"/>
<text text-anchor="middle" x="10688.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer12_ffn_act_9</text>
</g>
<!-- layer12_ffn_gate_9&#45;&gt;layer12_ffn_act_9 -->
<g id="edge1075" class="edge">
<title>layer12_ffn_gate_9&#45;&gt;layer12_ffn_act_9</title>
<path fill="none" stroke="black" d="M10441.45,-4758.97C10513.44,-4744.89 10578.92,-4730.7 10594.5,-4723 10622.87,-4708.97 10649.48,-4684.24 10667.09,-4665.6"/>
<polygon fill="black" stroke="black" points="10669.87,-4667.75 10674.07,-4658.03 10664.72,-4663.01 10669.87,-4667.75"/>
</g>
<!-- layer12_ffn_gate_10 -->
<g id="node992" class="node">
<title>layer12_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11893,-4842 11420,-4842 11420,-4759 11893,-4759 11893,-4842"/>
<text text-anchor="middle" x="11656.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11656.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11656.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11656.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11656.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_ffn_act_10 -->
<g id="node1029" class="node">
<title>layer12_ffn_act_10</title>
<polygon fill="none" stroke="black" points="12182,-4658 12033,-4658 12033,-4622 12182,-4622 12182,-4658"/>
<text text-anchor="middle" x="12107.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer12_ffn_act_10</text>
</g>
<!-- layer12_ffn_gate_10&#45;&gt;layer12_ffn_act_10 -->
<g id="edge1086" class="edge">
<title>layer12_ffn_gate_10&#45;&gt;layer12_ffn_act_10</title>
<path fill="none" stroke="black" d="M11771.77,-4758.99C11860.5,-4727.81 11979.44,-4686.01 12049.34,-4661.44"/>
<polygon fill="black" stroke="black" points="12050.59,-4664.71 12058.87,-4658.09 12048.27,-4658.11 12050.59,-4664.71"/>
</g>
<!-- layer12_ffn_gate_11 -->
<g id="node993" class="node">
<title>layer12_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="12909,-4842 12436,-4842 12436,-4759 12909,-4759 12909,-4842"/>
<text text-anchor="middle" x="12672.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12672.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12672.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12672.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12672.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_ffn_act_11 -->
<g id="node1034" class="node">
<title>layer12_ffn_act_11</title>
<polygon fill="none" stroke="black" points="12761,-4658 12612,-4658 12612,-4622 12761,-4622 12761,-4658"/>
<text text-anchor="middle" x="12686.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer12_ffn_act_11</text>
</g>
<!-- layer12_ffn_gate_11&#45;&gt;layer12_ffn_act_11 -->
<g id="edge1097" class="edge">
<title>layer12_ffn_gate_11&#45;&gt;layer12_ffn_act_11</title>
<path fill="none" stroke="black" d="M12676.11,-4758.68C12678.62,-4730.24 12681.9,-4693.08 12684.1,-4668.2"/>
<polygon fill="black" stroke="black" points="12687.6,-4668.29 12685,-4658.02 12680.63,-4667.68 12687.6,-4668.29"/>
</g>
<!-- layer12_ffn_gate_12 -->
<g id="node994" class="node">
<title>layer12_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="13911,-4842 13438,-4842 13438,-4759 13911,-4759 13911,-4842"/>
<text text-anchor="middle" x="13674.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13674.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13674.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13674.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13674.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_ffn_act_12 -->
<g id="node1039" class="node">
<title>layer12_ffn_act_12</title>
<polygon fill="none" stroke="black" points="13952,-4658 13803,-4658 13803,-4622 13952,-4622 13952,-4658"/>
<text text-anchor="middle" x="13877.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer12_ffn_act_12</text>
</g>
<!-- layer12_ffn_gate_12&#45;&gt;layer12_ffn_act_12 -->
<g id="edge1108" class="edge">
<title>layer12_ffn_gate_12&#45;&gt;layer12_ffn_act_12</title>
<path fill="none" stroke="black" d="M13726.51,-4758.89C13764.9,-4728.91 13815.8,-4689.18 13847.59,-4664.35"/>
<polygon fill="black" stroke="black" points="13849.91,-4666.98 13855.64,-4658.07 13845.6,-4661.46 13849.91,-4666.98"/>
</g>
<!-- layer12_ffn_gate_13 -->
<g id="node995" class="node">
<title>layer12_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="14976,-4842 14503,-4842 14503,-4759 14976,-4759 14976,-4842"/>
<text text-anchor="middle" x="14739.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14739.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14739.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14739.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14739.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_ffn_act_13 -->
<g id="node1044" class="node">
<title>layer12_ffn_act_13</title>
<polygon fill="none" stroke="black" points="15024,-4658 14875,-4658 14875,-4622 15024,-4622 15024,-4658"/>
<text text-anchor="middle" x="14949.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer12_ffn_act_13</text>
</g>
<!-- layer12_ffn_gate_13&#45;&gt;layer12_ffn_act_13 -->
<g id="edge1119" class="edge">
<title>layer12_ffn_gate_13&#45;&gt;layer12_ffn_act_13</title>
<path fill="none" stroke="black" d="M14793.31,-4758.89C14833.02,-4728.91 14885.67,-4689.18 14918.56,-4664.35"/>
<polygon fill="black" stroke="black" points="14921.01,-4666.89 14926.88,-4658.07 14916.79,-4661.3 14921.01,-4666.89"/>
</g>
<!-- layer12_ffn_gate_14 -->
<g id="node996" class="node">
<title>layer12_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="15977,-4842 15504,-4842 15504,-4759 15977,-4759 15977,-4842"/>
<text text-anchor="middle" x="15740.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15740.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15740.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15740.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15740.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_ffn_act_14 -->
<g id="node1049" class="node">
<title>layer12_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16260,-4658 16111,-4658 16111,-4622 16260,-4622 16260,-4658"/>
<text text-anchor="middle" x="16185.5" y="-4636.3" font-family="Times,serif" font-size="14.00">layer12_ffn_act_14</text>
</g>
<!-- layer12_ffn_gate_14&#45;&gt;layer12_ffn_act_14 -->
<g id="edge1130" class="edge">
<title>layer12_ffn_gate_14&#45;&gt;layer12_ffn_act_14</title>
<path fill="none" stroke="black" d="M15854.23,-4758.99C15941.61,-4727.87 16058.66,-4686.18 16127.69,-4661.59"/>
<polygon fill="black" stroke="black" points="16129.27,-4664.74 16137.51,-4658.09 16126.92,-4658.15 16129.27,-4664.74"/>
</g>
<!-- layer12_ffn_act_15 -->
<g id="node1006" class="node">
<title>layer12_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17264.24,-4723 16507.44,-4723 16312.76,-4557 17069.56,-4557 17264.24,-4723"/>
<text text-anchor="middle" x="16788.5" y="-4666.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="16788.5" y="-4651.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="16788.5" y="-4636.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16788.5" y="-4621.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16788.5" y="-4606.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_ffn_gate_15&#45;&gt;layer12_ffn_act_15 -->
<g id="edge1141" class="edge">
<title>layer12_ffn_gate_15&#45;&gt;layer12_ffn_act_15</title>
<path fill="none" stroke="black" d="M16746.92,-4758.68C16749.78,-4750.58 16752.9,-4741.77 16756.09,-4732.74"/>
<polygon fill="black" stroke="black" points="16759.4,-4733.87 16759.43,-4723.27 16752.8,-4731.54 16759.4,-4733.87"/>
</g>
<!-- layer12_ffn_up_8 -->
<g id="node998" class="node">
<title>layer12_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10586,-4681.5 10113,-4681.5 10113,-4598.5 10586,-4598.5 10586,-4681.5"/>
<text text-anchor="middle" x="10349.5" y="-4666.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10349.5" y="-4651.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10349.5" y="-4636.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10349.5" y="-4621.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10349.5" y="-4606.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_ffn_up_8&#45;&gt;layer12_ffn_act_8 -->
<g id="edge1065" class="edge">
<title>layer12_ffn_up_8&#45;&gt;layer12_ffn_act_8</title>
<path fill="none" stroke="black" d="M10231.17,-4598.49C10140.07,-4567.31 10017.97,-4525.51 9946.21,-4500.94"/>
<polygon fill="black" stroke="black" points="9947.02,-4497.52 9936.43,-4497.59 9944.76,-4504.14 9947.02,-4497.52"/>
</g>
<!-- layer12_ffn_up_9 -->
<g id="node999" class="node">
<title>layer12_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="10947,-4842 10474,-4842 10474,-4759 10947,-4759 10947,-4842"/>
<text text-anchor="middle" x="10710.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10710.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10710.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10710.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10710.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_ffn_up_9&#45;&gt;layer12_ffn_act_9 -->
<g id="edge1076" class="edge">
<title>layer12_ffn_up_9&#45;&gt;layer12_ffn_act_9</title>
<path fill="none" stroke="black" d="M10704.83,-4758.68C10700.89,-4730.24 10695.73,-4693.08 10692.27,-4668.2"/>
<polygon fill="black" stroke="black" points="10695.7,-4667.45 10690.86,-4658.02 10688.77,-4668.41 10695.7,-4667.45"/>
</g>
<!-- layer12_ffn_up_10 -->
<g id="node1000" class="node">
<title>layer12_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12384,-4842 11911,-4842 11911,-4759 12384,-4759 12384,-4842"/>
<text text-anchor="middle" x="12147.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12147.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12147.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12147.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12147.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_ffn_up_10&#45;&gt;layer12_ffn_act_10 -->
<g id="edge1087" class="edge">
<title>layer12_ffn_up_10&#45;&gt;layer12_ffn_act_10</title>
<path fill="none" stroke="black" d="M12137.2,-4758.68C12129.99,-4730.11 12120.56,-4692.74 12114.28,-4667.86"/>
<polygon fill="black" stroke="black" points="12117.64,-4666.86 12111.8,-4658.02 12110.85,-4668.58 12117.64,-4666.86"/>
</g>
<!-- layer12_ffn_up_11 -->
<g id="node1001" class="node">
<title>layer12_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13400,-4842 12927,-4842 12927,-4759 13400,-4759 13400,-4842"/>
<text text-anchor="middle" x="13163.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13163.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13163.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13163.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13163.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_ffn_up_11&#45;&gt;layer12_ffn_act_11 -->
<g id="edge1098" class="edge">
<title>layer12_ffn_up_11&#45;&gt;layer12_ffn_act_11</title>
<path fill="none" stroke="black" d="M13041.59,-4758.99C12947.55,-4727.74 12821.43,-4685.83 12747.56,-4661.29"/>
<polygon fill="black" stroke="black" points="12748.53,-4657.92 12737.94,-4658.09 12746.32,-4664.57 12748.53,-4657.92"/>
</g>
<!-- layer12_ffn_up_12 -->
<g id="node1002" class="node">
<title>layer12_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14402,-4842 13929,-4842 13929,-4759 14402,-4759 14402,-4842"/>
<text text-anchor="middle" x="14165.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14165.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14165.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14165.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14165.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_ffn_up_12&#45;&gt;layer12_ffn_act_12 -->
<g id="edge1109" class="edge">
<title>layer12_ffn_up_12&#45;&gt;layer12_ffn_act_12</title>
<path fill="none" stroke="black" d="M14091.71,-4758.89C14036.2,-4728.34 13962.27,-4687.65 13917.37,-4662.94"/>
<polygon fill="black" stroke="black" points="13918.96,-4659.82 13908.52,-4658.07 13915.59,-4665.96 13918.96,-4659.82"/>
</g>
<!-- layer12_ffn_up_13 -->
<g id="node1003" class="node">
<title>layer12_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15467,-4842 14994,-4842 14994,-4759 15467,-4759 15467,-4842"/>
<text text-anchor="middle" x="15230.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15230.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15230.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15230.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15230.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_ffn_up_13&#45;&gt;layer12_ffn_act_13 -->
<g id="edge1120" class="edge">
<title>layer12_ffn_up_13&#45;&gt;layer12_ffn_act_13</title>
<path fill="none" stroke="black" d="M15158.5,-4758.89C15104.46,-4728.4 15032.51,-4687.82 14988.67,-4663.1"/>
<polygon fill="black" stroke="black" points="14990.19,-4659.93 14979.76,-4658.07 14986.75,-4666.03 14990.19,-4659.93"/>
</g>
<!-- layer12_ffn_up_14 -->
<g id="node1004" class="node">
<title>layer12_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16468,-4842 15995,-4842 15995,-4759 16468,-4759 16468,-4842"/>
<text text-anchor="middle" x="16231.5" y="-4826.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16231.5" y="-4811.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16231.5" y="-4796.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16231.5" y="-4781.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16231.5" y="-4766.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_ffn_up_14&#45;&gt;layer12_ffn_act_14 -->
<g id="edge1131" class="edge">
<title>layer12_ffn_up_14&#45;&gt;layer12_ffn_act_14</title>
<path fill="none" stroke="black" d="M16219.65,-4758.68C16211.36,-4730.11 16200.52,-4692.74 16193.3,-4667.86"/>
<polygon fill="black" stroke="black" points="16196.59,-4666.65 16190.44,-4658.02 16189.87,-4668.6 16196.59,-4666.65"/>
</g>
<!-- layer12_ffn_up_15&#45;&gt;layer12_ffn_act_15 -->
<g id="edge1142" class="edge">
<title>layer12_ffn_up_15&#45;&gt;layer12_ffn_act_15</title>
<path fill="none" stroke="black" d="M17112.32,-4758.99C17084.83,-4748.97 17054.34,-4737.86 17023.37,-4726.58"/>
<polygon fill="black" stroke="black" points="17024.35,-4723.21 17013.75,-4723.07 17021.95,-4729.79 17024.35,-4723.21"/>
</g>
<!-- layer12_ffn_down_15 -->
<g id="node1014" class="node">
<title>layer12_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17012,-4521 16565,-4521 16565,-4438 17012,-4438 17012,-4521"/>
<text text-anchor="middle" x="16788.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16788.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16788.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16788.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16788.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_ffn_act_15&#45;&gt;layer12_ffn_down_15 -->
<g id="edge1143" class="edge">
<title>layer12_ffn_act_15&#45;&gt;layer12_ffn_down_15</title>
<path fill="none" stroke="black" d="M16788.5,-4556.96C16788.5,-4548.25 16788.5,-4539.59 16788.5,-4531.39"/>
<polygon fill="black" stroke="black" points="16792,-4531.29 16788.5,-4521.29 16785,-4531.29 16792,-4531.29"/>
</g>
<!-- layer12_ffn_down_8 -->
<g id="node1007" class="node">
<title>layer12_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="10110,-4360.5 9663,-4360.5 9663,-4277.5 10110,-4277.5 10110,-4360.5"/>
<text text-anchor="middle" x="9886.5" y="-4345.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9886.5" y="-4330.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9886.5" y="-4315.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9886.5" y="-4300.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9886.5" y="-4285.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_res2_8 -->
<g id="node1020" class="node">
<title>layer12_res2_8</title>
<polygon fill="none" stroke="black" points="9949,-4176.5 9824,-4176.5 9824,-4140.5 9949,-4140.5 9949,-4176.5"/>
<text text-anchor="middle" x="9886.5" y="-4154.8" font-family="Times,serif" font-size="14.00">layer12_res2_8</text>
</g>
<!-- layer12_ffn_down_8&#45;&gt;layer12_res2_8 -->
<g id="edge1067" class="edge">
<title>layer12_ffn_down_8&#45;&gt;layer12_res2_8</title>
<path fill="none" stroke="black" d="M9886.5,-4277.18C9886.5,-4248.74 9886.5,-4211.58 9886.5,-4186.7"/>
<polygon fill="black" stroke="black" points="9890,-4186.52 9886.5,-4176.52 9883,-4186.52 9890,-4186.52"/>
</g>
<!-- layer12_ffn_down_9 -->
<g id="node1008" class="node">
<title>layer12_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="10912,-4521 10465,-4521 10465,-4438 10912,-4438 10912,-4521"/>
<text text-anchor="middle" x="10688.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10688.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10688.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10688.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10688.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_res2_9 -->
<g id="node1025" class="node">
<title>layer12_res2_9</title>
<polygon fill="none" stroke="black" points="10751,-4337 10626,-4337 10626,-4301 10751,-4301 10751,-4337"/>
<text text-anchor="middle" x="10688.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer12_res2_9</text>
</g>
<!-- layer12_ffn_down_9&#45;&gt;layer12_res2_9 -->
<g id="edge1078" class="edge">
<title>layer12_ffn_down_9&#45;&gt;layer12_res2_9</title>
<path fill="none" stroke="black" d="M10688.5,-4437.68C10688.5,-4409.24 10688.5,-4372.08 10688.5,-4347.2"/>
<polygon fill="black" stroke="black" points="10692,-4347.02 10688.5,-4337.02 10685,-4347.02 10692,-4347.02"/>
</g>
<!-- layer12_ffn_down_10 -->
<g id="node1009" class="node">
<title>layer12_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="12331,-4521 11884,-4521 11884,-4438 12331,-4438 12331,-4521"/>
<text text-anchor="middle" x="12107.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12107.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12107.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12107.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12107.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_res2_10 -->
<g id="node1030" class="node">
<title>layer12_res2_10</title>
<polygon fill="none" stroke="black" points="12174.5,-4337 12040.5,-4337 12040.5,-4301 12174.5,-4301 12174.5,-4337"/>
<text text-anchor="middle" x="12107.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer12_res2_10</text>
</g>
<!-- layer12_ffn_down_10&#45;&gt;layer12_res2_10 -->
<g id="edge1089" class="edge">
<title>layer12_ffn_down_10&#45;&gt;layer12_res2_10</title>
<path fill="none" stroke="black" d="M12107.5,-4437.68C12107.5,-4409.24 12107.5,-4372.08 12107.5,-4347.2"/>
<polygon fill="black" stroke="black" points="12111,-4347.02 12107.5,-4337.02 12104,-4347.02 12111,-4347.02"/>
</g>
<!-- layer12_ffn_down_11 -->
<g id="node1010" class="node">
<title>layer12_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="12910,-4521 12463,-4521 12463,-4438 12910,-4438 12910,-4521"/>
<text text-anchor="middle" x="12686.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12686.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12686.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12686.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12686.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_res2_11 -->
<g id="node1035" class="node">
<title>layer12_res2_11</title>
<polygon fill="none" stroke="black" points="12753.5,-4337 12619.5,-4337 12619.5,-4301 12753.5,-4301 12753.5,-4337"/>
<text text-anchor="middle" x="12686.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer12_res2_11</text>
</g>
<!-- layer12_ffn_down_11&#45;&gt;layer12_res2_11 -->
<g id="edge1100" class="edge">
<title>layer12_ffn_down_11&#45;&gt;layer12_res2_11</title>
<path fill="none" stroke="black" d="M12686.5,-4437.68C12686.5,-4409.24 12686.5,-4372.08 12686.5,-4347.2"/>
<polygon fill="black" stroke="black" points="12690,-4347.02 12686.5,-4337.02 12683,-4347.02 12690,-4347.02"/>
</g>
<!-- layer12_ffn_down_12 -->
<g id="node1011" class="node">
<title>layer12_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14101,-4521 13654,-4521 13654,-4438 14101,-4438 14101,-4521"/>
<text text-anchor="middle" x="13877.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13877.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13877.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13877.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13877.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_res2_12 -->
<g id="node1040" class="node">
<title>layer12_res2_12</title>
<polygon fill="none" stroke="black" points="13944.5,-4337 13810.5,-4337 13810.5,-4301 13944.5,-4301 13944.5,-4337"/>
<text text-anchor="middle" x="13877.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer12_res2_12</text>
</g>
<!-- layer12_ffn_down_12&#45;&gt;layer12_res2_12 -->
<g id="edge1111" class="edge">
<title>layer12_ffn_down_12&#45;&gt;layer12_res2_12</title>
<path fill="none" stroke="black" d="M13877.5,-4437.68C13877.5,-4409.24 13877.5,-4372.08 13877.5,-4347.2"/>
<polygon fill="black" stroke="black" points="13881,-4347.02 13877.5,-4337.02 13874,-4347.02 13881,-4347.02"/>
</g>
<!-- layer12_ffn_down_13 -->
<g id="node1012" class="node">
<title>layer12_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="15173,-4521 14726,-4521 14726,-4438 15173,-4438 15173,-4521"/>
<text text-anchor="middle" x="14949.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14949.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14949.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14949.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14949.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_res2_13 -->
<g id="node1045" class="node">
<title>layer12_res2_13</title>
<polygon fill="none" stroke="black" points="15016.5,-4337 14882.5,-4337 14882.5,-4301 15016.5,-4301 15016.5,-4337"/>
<text text-anchor="middle" x="14949.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer12_res2_13</text>
</g>
<!-- layer12_ffn_down_13&#45;&gt;layer12_res2_13 -->
<g id="edge1122" class="edge">
<title>layer12_ffn_down_13&#45;&gt;layer12_res2_13</title>
<path fill="none" stroke="black" d="M14949.5,-4437.68C14949.5,-4409.24 14949.5,-4372.08 14949.5,-4347.2"/>
<polygon fill="black" stroke="black" points="14953,-4347.02 14949.5,-4337.02 14946,-4347.02 14953,-4347.02"/>
</g>
<!-- layer12_ffn_down_14 -->
<g id="node1013" class="node">
<title>layer12_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16409,-4521 15962,-4521 15962,-4438 16409,-4438 16409,-4521"/>
<text text-anchor="middle" x="16185.5" y="-4505.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16185.5" y="-4490.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16185.5" y="-4475.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16185.5" y="-4460.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16185.5" y="-4445.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_res2_14 -->
<g id="node1050" class="node">
<title>layer12_res2_14</title>
<polygon fill="none" stroke="black" points="16252.5,-4337 16118.5,-4337 16118.5,-4301 16252.5,-4301 16252.5,-4337"/>
<text text-anchor="middle" x="16185.5" y="-4315.3" font-family="Times,serif" font-size="14.00">layer12_res2_14</text>
</g>
<!-- layer12_ffn_down_14&#45;&gt;layer12_res2_14 -->
<g id="edge1133" class="edge">
<title>layer12_ffn_down_14&#45;&gt;layer12_res2_14</title>
<path fill="none" stroke="black" d="M16185.5,-4437.68C16185.5,-4409.24 16185.5,-4372.08 16185.5,-4347.2"/>
<polygon fill="black" stroke="black" points="16189,-4347.02 16185.5,-4337.02 16182,-4347.02 16189,-4347.02"/>
</g>
<!-- layer12_res2_15 -->
<g id="node1015" class="node">
<title>layer12_res2_15</title>
<polygon fill="none" stroke="black" points="17229.24,-4402 16528.12,-4402 16347.76,-4236 17048.88,-4236 17229.24,-4402"/>
<text text-anchor="middle" x="16788.5" y="-4345.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16788.5" y="-4330.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-4315.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-4300.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-4285.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer12_ffn_down_15&#45;&gt;layer12_res2_15 -->
<g id="edge1144" class="edge">
<title>layer12_ffn_down_15&#45;&gt;layer12_res2_15</title>
<path fill="none" stroke="black" d="M16788.5,-4437.68C16788.5,-4429.75 16788.5,-4421.14 16788.5,-4412.31"/>
<polygon fill="black" stroke="black" points="16792,-4412.27 16788.5,-4402.27 16785,-4412.27 16792,-4412.27"/>
</g>
<!-- layer13_mha_qkv_15 -->
<g id="node1058" class="node">
<title>layer13_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17066.5,-4200 16510.5,-4200 16510.5,-4117 17066.5,-4117 17066.5,-4200"/>
<text text-anchor="middle" x="16788.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16788.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16788.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16788.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer12_res2_15&#45;&gt;layer13_mha_qkv_15 -->
<g id="edge1222" class="edge">
<title>layer12_res2_15&#45;&gt;layer13_mha_qkv_15</title>
<path fill="none" stroke="black" d="M16788.5,-4235.96C16788.5,-4227.25 16788.5,-4218.59 16788.5,-4210.39"/>
<polygon fill="black" stroke="black" points="16792,-4210.29 16788.5,-4200.29 16785,-4210.29 16792,-4210.29"/>
</g>
<!-- layer12_mha_attn_8&#45;&gt;layer12_mha_out_8 -->
<g id="edge1059" class="edge">
<title>layer12_mha_attn_8&#45;&gt;layer12_mha_out_8</title>
<path fill="none" stroke="black" d="M9902.5,-5207.24C9902.5,-5185.68 9902.5,-5147.87 9902.5,-5116.79"/>
<polygon fill="black" stroke="black" points="9906,-5116.54 9902.5,-5106.54 9899,-5116.54 9906,-5116.54"/>
</g>
<!-- layer12_ln1_8 -->
<g id="node1018" class="node">
<title>layer12_ln1_8</title>
<polygon fill="none" stroke="black" points="9960.5,-4818.5 9844.5,-4818.5 9844.5,-4782.5 9960.5,-4782.5 9960.5,-4818.5"/>
<text text-anchor="middle" x="9902.5" y="-4796.8" font-family="Times,serif" font-size="14.00">layer12_ln1_8</text>
</g>
<!-- layer12_res1_8&#45;&gt;layer12_ln1_8 -->
<g id="edge1061" class="edge">
<title>layer12_res1_8&#45;&gt;layer12_ln1_8</title>
<path fill="none" stroke="black" d="M9902.5,-4893.89C9902.5,-4876.56 9902.5,-4849.46 9902.5,-4829.09"/>
<polygon fill="black" stroke="black" points="9906,-4828.85 9902.5,-4818.85 9899,-4828.85 9906,-4828.85"/>
</g>
<!-- layer12_ln1_8&#45;&gt;layer12_ffn_gate_8 -->
<g id="edge1062" class="edge">
<title>layer12_ln1_8&#45;&gt;layer12_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9897.71,-4782.24C9891.7,-4760.59 9881.13,-4722.54 9872.49,-4691.38"/>
<polygon fill="black" stroke="black" points="9875.8,-4690.24 9869.75,-4681.54 9869.06,-4692.11 9875.8,-4690.24"/>
</g>
<!-- layer12_ln1_8&#45;&gt;layer12_ffn_up_8 -->
<g id="edge1063" class="edge">
<title>layer12_ln1_8&#45;&gt;layer12_ffn_up_8</title>
<path fill="none" stroke="black" d="M9928.67,-4782.49C9941.75,-4774.54 9958.04,-4765.43 9973.5,-4759 10028.85,-4735.97 10046.15,-4740.49 10103.5,-4723 10142.3,-4711.17 10184.27,-4697.51 10222.37,-4684.77"/>
<polygon fill="black" stroke="black" points="10223.59,-4688.05 10231.96,-4681.55 10221.37,-4681.41 10223.59,-4688.05"/>
</g>
<!-- layer12_ffn_act_8&#45;&gt;layer12_ffn_down_8 -->
<g id="edge1066" class="edge">
<title>layer12_ffn_act_8&#45;&gt;layer12_ffn_down_8</title>
<path fill="none" stroke="black" d="M9886.5,-4461.24C9886.5,-4439.68 9886.5,-4401.87 9886.5,-4370.79"/>
<polygon fill="black" stroke="black" points="9890,-4370.54 9886.5,-4360.54 9883,-4370.54 9890,-4370.54"/>
</g>
<!-- layer13_mha_qkv_8 -->
<g id="node1051" class="node">
<title>layer13_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="10164.5,-4039.5 9608.5,-4039.5 9608.5,-3956.5 10164.5,-3956.5 10164.5,-4039.5"/>
<text text-anchor="middle" x="9886.5" y="-4024.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9886.5" y="-4009.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9886.5" y="-3994.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9886.5" y="-3979.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9886.5" y="-3964.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer12_res2_8&#45;&gt;layer13_mha_qkv_8 -->
<g id="edge1145" class="edge">
<title>layer12_res2_8&#45;&gt;layer13_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9886.5,-4140.24C9886.5,-4118.68 9886.5,-4080.87 9886.5,-4049.79"/>
<polygon fill="black" stroke="black" points="9890,-4049.54 9886.5,-4039.54 9883,-4049.54 9890,-4049.54"/>
</g>
<!-- layer12_mha_attn_9&#45;&gt;layer12_mha_out_9 -->
<g id="edge1070" class="edge">
<title>layer12_mha_attn_9&#45;&gt;layer12_mha_out_9</title>
<path fill="none" stroke="black" d="M10706.5,-5367.74C10706.5,-5346.18 10706.5,-5308.37 10706.5,-5277.29"/>
<polygon fill="black" stroke="black" points="10710,-5277.04 10706.5,-5267.04 10703,-5277.04 10710,-5277.04"/>
</g>
<!-- layer12_ln1_9 -->
<g id="node1023" class="node">
<title>layer12_ln1_9</title>
<polygon fill="none" stroke="black" points="10764.5,-4930 10648.5,-4930 10648.5,-4894 10764.5,-4894 10764.5,-4930"/>
<text text-anchor="middle" x="10706.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_ln1_9</text>
</g>
<!-- layer12_res1_9&#45;&gt;layer12_ln1_9 -->
<g id="edge1072" class="edge">
<title>layer12_res1_9&#45;&gt;layer12_ln1_9</title>
<path fill="none" stroke="black" d="M10706.5,-5046.97C10706.5,-5021.03 10706.5,-4971.36 10706.5,-4940.33"/>
<polygon fill="black" stroke="black" points="10710,-4940.2 10706.5,-4930.2 10703,-4940.2 10710,-4940.2"/>
</g>
<!-- layer12_ln1_9&#45;&gt;layer12_ffn_gate_9 -->
<g id="edge1073" class="edge">
<title>layer12_ln1_9&#45;&gt;layer12_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10648.24,-4897.9C10589.23,-4884.63 10494.74,-4863.39 10409.47,-4844.21"/>
<polygon fill="black" stroke="black" points="10410.18,-4840.79 10399.65,-4842.01 10408.64,-4847.61 10410.18,-4840.79"/>
</g>
<!-- layer12_ln1_9&#45;&gt;layer12_ffn_up_9 -->
<g id="edge1074" class="edge">
<title>layer12_ln1_9&#45;&gt;layer12_ffn_up_9</title>
<path fill="none" stroke="black" d="M10707.12,-4893.89C10707.54,-4882.65 10708.1,-4867.31 10708.64,-4852.35"/>
<polygon fill="black" stroke="black" points="10712.15,-4852.24 10709.02,-4842.12 10705.15,-4851.98 10712.15,-4852.24"/>
</g>
<!-- layer12_ffn_act_9&#45;&gt;layer12_ffn_down_9 -->
<g id="edge1077" class="edge">
<title>layer12_ffn_act_9&#45;&gt;layer12_ffn_down_9</title>
<path fill="none" stroke="black" d="M10688.5,-4621.74C10688.5,-4600.18 10688.5,-4562.37 10688.5,-4531.29"/>
<polygon fill="black" stroke="black" points="10692,-4531.04 10688.5,-4521.04 10685,-4531.04 10692,-4531.04"/>
</g>
<!-- layer13_mha_qkv_9 -->
<g id="node1052" class="node">
<title>layer13_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="10966.5,-4200 10410.5,-4200 10410.5,-4117 10966.5,-4117 10966.5,-4200"/>
<text text-anchor="middle" x="10688.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10688.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10688.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10688.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10688.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer12_res2_9&#45;&gt;layer13_mha_qkv_9 -->
<g id="edge1156" class="edge">
<title>layer12_res2_9&#45;&gt;layer13_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10688.5,-4300.74C10688.5,-4279.18 10688.5,-4241.37 10688.5,-4210.29"/>
<polygon fill="black" stroke="black" points="10692,-4210.04 10688.5,-4200.04 10685,-4210.04 10692,-4210.04"/>
</g>
<!-- layer12_mha_attn_10&#45;&gt;layer12_mha_out_10 -->
<g id="edge1081" class="edge">
<title>layer12_mha_attn_10&#45;&gt;layer12_mha_out_10</title>
<path fill="none" stroke="black" d="M11897.5,-5367.74C11897.5,-5346.18 11897.5,-5308.37 11897.5,-5277.29"/>
<polygon fill="black" stroke="black" points="11901,-5277.04 11897.5,-5267.04 11894,-5277.04 11901,-5277.04"/>
</g>
<!-- layer12_ln1_10 -->
<g id="node1028" class="node">
<title>layer12_ln1_10</title>
<polygon fill="none" stroke="black" points="11960,-4930 11835,-4930 11835,-4894 11960,-4894 11960,-4930"/>
<text text-anchor="middle" x="11897.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_ln1_10</text>
</g>
<!-- layer12_res1_10&#45;&gt;layer12_ln1_10 -->
<g id="edge1083" class="edge">
<title>layer12_res1_10&#45;&gt;layer12_ln1_10</title>
<path fill="none" stroke="black" d="M11897.5,-5046.97C11897.5,-5021.03 11897.5,-4971.36 11897.5,-4940.33"/>
<polygon fill="black" stroke="black" points="11901,-4940.2 11897.5,-4930.2 11894,-4940.2 11901,-4940.2"/>
</g>
<!-- layer12_ln1_10&#45;&gt;layer12_ffn_gate_10 -->
<g id="edge1084" class="edge">
<title>layer12_ln1_10&#45;&gt;layer12_ffn_gate_10</title>
<path fill="none" stroke="black" d="M11859.84,-4893.89C11831.71,-4881.11 11791.91,-4863.02 11754.96,-4846.24"/>
<polygon fill="black" stroke="black" points="11756.19,-4842.95 11745.64,-4842 11753.3,-4849.32 11756.19,-4842.95"/>
</g>
<!-- layer12_ln1_10&#45;&gt;layer12_ffn_up_10 -->
<g id="edge1085" class="edge">
<title>layer12_ln1_10&#45;&gt;layer12_ffn_up_10</title>
<path fill="none" stroke="black" d="M11936.56,-4893.89C11965.87,-4881.06 12007.39,-4862.87 12045.85,-4846.02"/>
<polygon fill="black" stroke="black" points="12047.28,-4849.22 12055.03,-4842 12044.47,-4842.81 12047.28,-4849.22"/>
</g>
<!-- layer12_ffn_act_10&#45;&gt;layer12_ffn_down_10 -->
<g id="edge1088" class="edge">
<title>layer12_ffn_act_10&#45;&gt;layer12_ffn_down_10</title>
<path fill="none" stroke="black" d="M12107.5,-4621.74C12107.5,-4600.18 12107.5,-4562.37 12107.5,-4531.29"/>
<polygon fill="black" stroke="black" points="12111,-4531.04 12107.5,-4521.04 12104,-4531.04 12111,-4531.04"/>
</g>
<!-- layer13_mha_qkv_10 -->
<g id="node1053" class="node">
<title>layer13_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="12385.5,-4200 11829.5,-4200 11829.5,-4117 12385.5,-4117 12385.5,-4200"/>
<text text-anchor="middle" x="12107.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12107.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12107.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12107.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12107.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer12_res2_10&#45;&gt;layer13_mha_qkv_10 -->
<g id="edge1167" class="edge">
<title>layer12_res2_10&#45;&gt;layer13_mha_qkv_10</title>
<path fill="none" stroke="black" d="M12107.5,-4300.74C12107.5,-4279.18 12107.5,-4241.37 12107.5,-4210.29"/>
<polygon fill="black" stroke="black" points="12111,-4210.04 12107.5,-4200.04 12104,-4210.04 12111,-4210.04"/>
</g>
<!-- layer12_mha_attn_11&#45;&gt;layer12_mha_out_11 -->
<g id="edge1092" class="edge">
<title>layer12_mha_attn_11&#45;&gt;layer12_mha_out_11</title>
<path fill="none" stroke="black" d="M12678.5,-5367.74C12678.5,-5346.18 12678.5,-5308.37 12678.5,-5277.29"/>
<polygon fill="black" stroke="black" points="12682,-5277.04 12678.5,-5267.04 12675,-5277.04 12682,-5277.04"/>
</g>
<!-- layer12_ln1_11 -->
<g id="node1033" class="node">
<title>layer12_ln1_11</title>
<polygon fill="none" stroke="black" points="12741,-4930 12616,-4930 12616,-4894 12741,-4894 12741,-4930"/>
<text text-anchor="middle" x="12678.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_ln1_11</text>
</g>
<!-- layer12_res1_11&#45;&gt;layer12_ln1_11 -->
<g id="edge1094" class="edge">
<title>layer12_res1_11&#45;&gt;layer12_ln1_11</title>
<path fill="none" stroke="black" d="M12678.5,-5046.97C12678.5,-5021.03 12678.5,-4971.36 12678.5,-4940.33"/>
<polygon fill="black" stroke="black" points="12682,-4940.2 12678.5,-4930.2 12675,-4940.2 12682,-4940.2"/>
</g>
<!-- layer12_ln1_11&#45;&gt;layer12_ffn_gate_11 -->
<g id="edge1095" class="edge">
<title>layer12_ln1_11&#45;&gt;layer12_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12677.56,-4893.89C12676.95,-4882.65 12676.11,-4867.31 12675.29,-4852.35"/>
<polygon fill="black" stroke="black" points="12678.77,-4851.91 12674.73,-4842.12 12671.78,-4852.29 12678.77,-4851.91"/>
</g>
<!-- layer12_ln1_11&#45;&gt;layer12_ffn_up_11 -->
<g id="edge1096" class="edge">
<title>layer12_ln1_11&#45;&gt;layer12_ffn_up_11</title>
<path fill="none" stroke="black" d="M12741.41,-4896.8C12800.39,-4883.48 12891.63,-4862.88 12974.21,-4844.24"/>
<polygon fill="black" stroke="black" points="12974.99,-4847.65 12983.98,-4842.03 12973.45,-4840.82 12974.99,-4847.65"/>
</g>
<!-- layer12_ffn_act_11&#45;&gt;layer12_ffn_down_11 -->
<g id="edge1099" class="edge">
<title>layer12_ffn_act_11&#45;&gt;layer12_ffn_down_11</title>
<path fill="none" stroke="black" d="M12686.5,-4621.74C12686.5,-4600.18 12686.5,-4562.37 12686.5,-4531.29"/>
<polygon fill="black" stroke="black" points="12690,-4531.04 12686.5,-4521.04 12683,-4531.04 12690,-4531.04"/>
</g>
<!-- layer13_mha_qkv_11 -->
<g id="node1054" class="node">
<title>layer13_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="12964.5,-4200 12408.5,-4200 12408.5,-4117 12964.5,-4117 12964.5,-4200"/>
<text text-anchor="middle" x="12686.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12686.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12686.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12686.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12686.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer12_res2_11&#45;&gt;layer13_mha_qkv_11 -->
<g id="edge1178" class="edge">
<title>layer12_res2_11&#45;&gt;layer13_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12686.5,-4300.74C12686.5,-4279.18 12686.5,-4241.37 12686.5,-4210.29"/>
<polygon fill="black" stroke="black" points="12690,-4210.04 12686.5,-4200.04 12683,-4210.04 12690,-4210.04"/>
</g>
<!-- layer12_mha_attn_12&#45;&gt;layer12_mha_out_12 -->
<g id="edge1103" class="edge">
<title>layer12_mha_attn_12&#45;&gt;layer12_mha_out_12</title>
<path fill="none" stroke="black" d="M14024.5,-5367.74C14024.5,-5346.18 14024.5,-5308.37 14024.5,-5277.29"/>
<polygon fill="black" stroke="black" points="14028,-5277.04 14024.5,-5267.04 14021,-5277.04 14028,-5277.04"/>
</g>
<!-- layer12_ln1_12 -->
<g id="node1038" class="node">
<title>layer12_ln1_12</title>
<polygon fill="none" stroke="black" points="14087,-4930 13962,-4930 13962,-4894 14087,-4894 14087,-4930"/>
<text text-anchor="middle" x="14024.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_ln1_12</text>
</g>
<!-- layer12_res1_12&#45;&gt;layer12_ln1_12 -->
<g id="edge1105" class="edge">
<title>layer12_res1_12&#45;&gt;layer12_ln1_12</title>
<path fill="none" stroke="black" d="M14024.5,-5046.97C14024.5,-5021.03 14024.5,-4971.36 14024.5,-4940.33"/>
<polygon fill="black" stroke="black" points="14028,-4940.2 14024.5,-4930.2 14021,-4940.2 14028,-4940.2"/>
</g>
<!-- layer12_ln1_12&#45;&gt;layer12_ffn_gate_12 -->
<g id="edge1106" class="edge">
<title>layer12_ln1_12&#45;&gt;layer12_ffn_gate_12</title>
<path fill="none" stroke="black" d="M13969.81,-4893.89C13928.01,-4880.81 13868.45,-4862.18 13813.75,-4845.07"/>
<polygon fill="black" stroke="black" points="13814.55,-4841.65 13803.96,-4842 13812.46,-4848.33 13814.55,-4841.65"/>
</g>
<!-- layer12_ln1_12&#45;&gt;layer12_ffn_up_12 -->
<g id="edge1107" class="edge">
<title>layer12_ln1_12&#45;&gt;layer12_ffn_up_12</title>
<path fill="none" stroke="black" d="M14046.53,-4893.89C14062.33,-4881.62 14084.42,-4864.47 14105.28,-4848.27"/>
<polygon fill="black" stroke="black" points="14107.45,-4851.02 14113.2,-4842.12 14103.15,-4845.49 14107.45,-4851.02"/>
</g>
<!-- layer12_ffn_act_12&#45;&gt;layer12_ffn_down_12 -->
<g id="edge1110" class="edge">
<title>layer12_ffn_act_12&#45;&gt;layer12_ffn_down_12</title>
<path fill="none" stroke="black" d="M13877.5,-4621.74C13877.5,-4600.18 13877.5,-4562.37 13877.5,-4531.29"/>
<polygon fill="black" stroke="black" points="13881,-4531.04 13877.5,-4521.04 13874,-4531.04 13881,-4531.04"/>
</g>
<!-- layer13_mha_qkv_12 -->
<g id="node1055" class="node">
<title>layer13_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14155.5,-4200 13599.5,-4200 13599.5,-4117 14155.5,-4117 14155.5,-4200"/>
<text text-anchor="middle" x="13877.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="13877.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13877.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13877.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="13877.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer12_res2_12&#45;&gt;layer13_mha_qkv_12 -->
<g id="edge1189" class="edge">
<title>layer12_res2_12&#45;&gt;layer13_mha_qkv_12</title>
<path fill="none" stroke="black" d="M13877.5,-4300.74C13877.5,-4279.18 13877.5,-4241.37 13877.5,-4210.29"/>
<polygon fill="black" stroke="black" points="13881,-4210.04 13877.5,-4200.04 13874,-4210.04 13881,-4210.04"/>
</g>
<!-- layer12_mha_attn_13&#45;&gt;layer12_mha_out_13 -->
<g id="edge1114" class="edge">
<title>layer12_mha_attn_13&#45;&gt;layer12_mha_out_13</title>
<path fill="none" stroke="black" d="M15160.5,-5367.74C15160.5,-5346.18 15160.5,-5308.37 15160.5,-5277.29"/>
<polygon fill="black" stroke="black" points="15164,-5277.04 15160.5,-5267.04 15157,-5277.04 15164,-5277.04"/>
</g>
<!-- layer12_ln1_13 -->
<g id="node1043" class="node">
<title>layer12_ln1_13</title>
<polygon fill="none" stroke="black" points="15223,-4930 15098,-4930 15098,-4894 15223,-4894 15223,-4930"/>
<text text-anchor="middle" x="15160.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_ln1_13</text>
</g>
<!-- layer12_res1_13&#45;&gt;layer12_ln1_13 -->
<g id="edge1116" class="edge">
<title>layer12_res1_13&#45;&gt;layer12_ln1_13</title>
<path fill="none" stroke="black" d="M15160.5,-5046.97C15160.5,-5021.03 15160.5,-4971.36 15160.5,-4940.33"/>
<polygon fill="black" stroke="black" points="15164,-4940.2 15160.5,-4930.2 15157,-4940.2 15164,-4940.2"/>
</g>
<!-- layer12_ln1_13&#45;&gt;layer12_ffn_gate_13 -->
<g id="edge1117" class="edge">
<title>layer12_ln1_13&#45;&gt;layer12_ffn_gate_13</title>
<path fill="none" stroke="black" d="M15097.93,-4894.72C15047.06,-4881.49 14972.88,-4862.2 14905.19,-4844.6"/>
<polygon fill="black" stroke="black" points="14905.82,-4841.14 14895.26,-4842.01 14904.05,-4847.92 14905.82,-4841.14"/>
</g>
<!-- layer12_ln1_13&#45;&gt;layer12_ffn_up_13 -->
<g id="edge1118" class="edge">
<title>layer12_ln1_13&#45;&gt;layer12_ffn_up_13</title>
<path fill="none" stroke="black" d="M15171.44,-4893.89C15178.9,-4882.22 15189.19,-4866.12 15199.09,-4850.63"/>
<polygon fill="black" stroke="black" points="15202.1,-4852.43 15204.53,-4842.12 15196.2,-4848.66 15202.1,-4852.43"/>
</g>
<!-- layer12_ffn_act_13&#45;&gt;layer12_ffn_down_13 -->
<g id="edge1121" class="edge">
<title>layer12_ffn_act_13&#45;&gt;layer12_ffn_down_13</title>
<path fill="none" stroke="black" d="M14949.5,-4621.74C14949.5,-4600.18 14949.5,-4562.37 14949.5,-4531.29"/>
<polygon fill="black" stroke="black" points="14953,-4531.04 14949.5,-4521.04 14946,-4531.04 14953,-4531.04"/>
</g>
<!-- layer13_mha_qkv_13 -->
<g id="node1056" class="node">
<title>layer13_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15227.5,-4200 14671.5,-4200 14671.5,-4117 15227.5,-4117 15227.5,-4200"/>
<text text-anchor="middle" x="14949.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14949.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14949.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14949.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14949.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer12_res2_13&#45;&gt;layer13_mha_qkv_13 -->
<g id="edge1200" class="edge">
<title>layer12_res2_13&#45;&gt;layer13_mha_qkv_13</title>
<path fill="none" stroke="black" d="M14949.5,-4300.74C14949.5,-4279.18 14949.5,-4241.37 14949.5,-4210.29"/>
<polygon fill="black" stroke="black" points="14953,-4210.04 14949.5,-4200.04 14946,-4210.04 14953,-4210.04"/>
</g>
<!-- layer12_mha_attn_14&#45;&gt;layer12_mha_out_14 -->
<g id="edge1125" class="edge">
<title>layer12_mha_attn_14&#45;&gt;layer12_mha_out_14</title>
<path fill="none" stroke="black" d="M16173.5,-5367.74C16173.5,-5346.18 16173.5,-5308.37 16173.5,-5277.29"/>
<polygon fill="black" stroke="black" points="16177,-5277.04 16173.5,-5267.04 16170,-5277.04 16177,-5277.04"/>
</g>
<!-- layer12_ln1_14 -->
<g id="node1048" class="node">
<title>layer12_ln1_14</title>
<polygon fill="none" stroke="black" points="16236,-4930 16111,-4930 16111,-4894 16236,-4894 16236,-4930"/>
<text text-anchor="middle" x="16173.5" y="-4908.3" font-family="Times,serif" font-size="14.00">layer12_ln1_14</text>
</g>
<!-- layer12_res1_14&#45;&gt;layer12_ln1_14 -->
<g id="edge1127" class="edge">
<title>layer12_res1_14&#45;&gt;layer12_ln1_14</title>
<path fill="none" stroke="black" d="M16173.5,-5046.97C16173.5,-5021.03 16173.5,-4971.36 16173.5,-4940.33"/>
<polygon fill="black" stroke="black" points="16177,-4940.2 16173.5,-4930.2 16170,-4940.2 16177,-4940.2"/>
</g>
<!-- layer12_ln1_14&#45;&gt;layer12_ffn_gate_14 -->
<g id="edge1128" class="edge">
<title>layer12_ln1_14&#45;&gt;layer12_ffn_gate_14</title>
<path fill="none" stroke="black" d="M16110.54,-4895.08C16058.12,-4881.82 15980.96,-4862.31 15910.64,-4844.53"/>
<polygon fill="black" stroke="black" points="15911.32,-4841.09 15900.77,-4842.03 15909.6,-4847.87 15911.32,-4841.09"/>
</g>
<!-- layer12_ln1_14&#45;&gt;layer12_ffn_up_14 -->
<g id="edge1129" class="edge">
<title>layer12_ln1_14&#45;&gt;layer12_ffn_up_14</title>
<path fill="none" stroke="black" d="M16182.56,-4893.89C16188.69,-4882.33 16197.11,-4866.42 16205.25,-4851.06"/>
<polygon fill="black" stroke="black" points="16208.4,-4852.59 16209.99,-4842.12 16202.21,-4849.32 16208.4,-4852.59"/>
</g>
<!-- layer12_ffn_act_14&#45;&gt;layer12_ffn_down_14 -->
<g id="edge1132" class="edge">
<title>layer12_ffn_act_14&#45;&gt;layer12_ffn_down_14</title>
<path fill="none" stroke="black" d="M16185.5,-4621.74C16185.5,-4600.18 16185.5,-4562.37 16185.5,-4531.29"/>
<polygon fill="black" stroke="black" points="16189,-4531.04 16185.5,-4521.04 16182,-4531.04 16189,-4531.04"/>
</g>
<!-- layer13_mha_qkv_14 -->
<g id="node1057" class="node">
<title>layer13_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16463.5,-4200 15907.5,-4200 15907.5,-4117 16463.5,-4117 16463.5,-4200"/>
<text text-anchor="middle" x="16185.5" y="-4184.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16185.5" y="-4169.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16185.5" y="-4154.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16185.5" y="-4139.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16185.5" y="-4124.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer12_res2_14&#45;&gt;layer13_mha_qkv_14 -->
<g id="edge1211" class="edge">
<title>layer12_res2_14&#45;&gt;layer13_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16185.5,-4300.74C16185.5,-4279.18 16185.5,-4241.37 16185.5,-4210.29"/>
<polygon fill="black" stroke="black" points="16189,-4210.04 16185.5,-4200.04 16182,-4210.04 16189,-4210.04"/>
</g>
<!-- layer13_mha_attn_8 -->
<g id="node1096" class="node">
<title>layer13_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9966.5,-3855.5 9806.5,-3855.5 9806.5,-3819.5 9966.5,-3819.5 9966.5,-3855.5"/>
<text text-anchor="middle" x="9886.5" y="-3833.8" font-family="Times,serif" font-size="14.00">layer13_mha_attn_8</text>
</g>
<!-- layer13_mha_qkv_8&#45;&gt;layer13_mha_attn_8 -->
<g id="edge1146" class="edge">
<title>layer13_mha_qkv_8&#45;&gt;layer13_mha_attn_8</title>
<path fill="none" stroke="black" d="M9886.5,-3956.18C9886.5,-3927.74 9886.5,-3890.58 9886.5,-3865.7"/>
<polygon fill="black" stroke="black" points="9890,-3865.52 9886.5,-3855.52 9883,-3865.52 9890,-3865.52"/>
</g>
<!-- layer13_mha_attn_9 -->
<g id="node1101" class="node">
<title>layer13_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10768.5,-4016 10608.5,-4016 10608.5,-3980 10768.5,-3980 10768.5,-4016"/>
<text text-anchor="middle" x="10688.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer13_mha_attn_9</text>
</g>
<!-- layer13_mha_qkv_9&#45;&gt;layer13_mha_attn_9 -->
<g id="edge1157" class="edge">
<title>layer13_mha_qkv_9&#45;&gt;layer13_mha_attn_9</title>
<path fill="none" stroke="black" d="M10688.5,-4116.68C10688.5,-4088.24 10688.5,-4051.08 10688.5,-4026.2"/>
<polygon fill="black" stroke="black" points="10692,-4026.02 10688.5,-4016.02 10685,-4026.02 10692,-4026.02"/>
</g>
<!-- layer13_mha_attn_10 -->
<g id="node1106" class="node">
<title>layer13_mha_attn_10</title>
<polygon fill="none" stroke="black" points="12192,-4016 12023,-4016 12023,-3980 12192,-3980 12192,-4016"/>
<text text-anchor="middle" x="12107.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer13_mha_attn_10</text>
</g>
<!-- layer13_mha_qkv_10&#45;&gt;layer13_mha_attn_10 -->
<g id="edge1168" class="edge">
<title>layer13_mha_qkv_10&#45;&gt;layer13_mha_attn_10</title>
<path fill="none" stroke="black" d="M12107.5,-4116.68C12107.5,-4088.24 12107.5,-4051.08 12107.5,-4026.2"/>
<polygon fill="black" stroke="black" points="12111,-4026.02 12107.5,-4016.02 12104,-4026.02 12111,-4026.02"/>
</g>
<!-- layer13_mha_attn_11 -->
<g id="node1111" class="node">
<title>layer13_mha_attn_11</title>
<polygon fill="none" stroke="black" points="12771,-4016 12602,-4016 12602,-3980 12771,-3980 12771,-4016"/>
<text text-anchor="middle" x="12686.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer13_mha_attn_11</text>
</g>
<!-- layer13_mha_qkv_11&#45;&gt;layer13_mha_attn_11 -->
<g id="edge1179" class="edge">
<title>layer13_mha_qkv_11&#45;&gt;layer13_mha_attn_11</title>
<path fill="none" stroke="black" d="M12686.5,-4116.68C12686.5,-4088.24 12686.5,-4051.08 12686.5,-4026.2"/>
<polygon fill="black" stroke="black" points="12690,-4026.02 12686.5,-4016.02 12683,-4026.02 12690,-4026.02"/>
</g>
<!-- layer13_mha_attn_12 -->
<g id="node1116" class="node">
<title>layer13_mha_attn_12</title>
<polygon fill="none" stroke="black" points="13962,-4016 13793,-4016 13793,-3980 13962,-3980 13962,-4016"/>
<text text-anchor="middle" x="13877.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer13_mha_attn_12</text>
</g>
<!-- layer13_mha_qkv_12&#45;&gt;layer13_mha_attn_12 -->
<g id="edge1190" class="edge">
<title>layer13_mha_qkv_12&#45;&gt;layer13_mha_attn_12</title>
<path fill="none" stroke="black" d="M13877.5,-4116.68C13877.5,-4088.24 13877.5,-4051.08 13877.5,-4026.2"/>
<polygon fill="black" stroke="black" points="13881,-4026.02 13877.5,-4016.02 13874,-4026.02 13881,-4026.02"/>
</g>
<!-- layer13_mha_attn_13 -->
<g id="node1121" class="node">
<title>layer13_mha_attn_13</title>
<polygon fill="none" stroke="black" points="15034,-4016 14865,-4016 14865,-3980 15034,-3980 15034,-4016"/>
<text text-anchor="middle" x="14949.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer13_mha_attn_13</text>
</g>
<!-- layer13_mha_qkv_13&#45;&gt;layer13_mha_attn_13 -->
<g id="edge1201" class="edge">
<title>layer13_mha_qkv_13&#45;&gt;layer13_mha_attn_13</title>
<path fill="none" stroke="black" d="M14949.5,-4116.68C14949.5,-4088.24 14949.5,-4051.08 14949.5,-4026.2"/>
<polygon fill="black" stroke="black" points="14953,-4026.02 14949.5,-4016.02 14946,-4026.02 14953,-4026.02"/>
</g>
<!-- layer13_mha_attn_14 -->
<g id="node1126" class="node">
<title>layer13_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16270,-4016 16101,-4016 16101,-3980 16270,-3980 16270,-4016"/>
<text text-anchor="middle" x="16185.5" y="-3994.3" font-family="Times,serif" font-size="14.00">layer13_mha_attn_14</text>
</g>
<!-- layer13_mha_qkv_14&#45;&gt;layer13_mha_attn_14 -->
<g id="edge1212" class="edge">
<title>layer13_mha_qkv_14&#45;&gt;layer13_mha_attn_14</title>
<path fill="none" stroke="black" d="M16185.5,-4116.68C16185.5,-4088.24 16185.5,-4051.08 16185.5,-4026.2"/>
<polygon fill="black" stroke="black" points="16189,-4026.02 16185.5,-4016.02 16182,-4026.02 16189,-4026.02"/>
</g>
<!-- layer13_mha_attn_15 -->
<g id="node1059" class="node">
<title>layer13_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17265.31,-4081 16506.81,-4081 16311.69,-3915 17070.19,-3915 17265.31,-4081"/>
<text text-anchor="middle" x="16788.5" y="-4024.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="16788.5" y="-4009.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="16788.5" y="-3994.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16788.5" y="-3979.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3964.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_mha_qkv_15&#45;&gt;layer13_mha_attn_15 -->
<g id="edge1223" class="edge">
<title>layer13_mha_qkv_15&#45;&gt;layer13_mha_attn_15</title>
<path fill="none" stroke="black" d="M16788.5,-4116.68C16788.5,-4108.75 16788.5,-4100.14 16788.5,-4091.31"/>
<polygon fill="black" stroke="black" points="16792,-4091.27 16788.5,-4081.27 16785,-4091.27 16792,-4091.27"/>
</g>
<!-- layer13_mha_out_15 -->
<g id="node1067" class="node">
<title>layer13_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17007.5,-3879 16569.5,-3879 16569.5,-3796 17007.5,-3796 17007.5,-3879"/>
<text text-anchor="middle" x="16788.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16788.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16788.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16788.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_mha_attn_15&#45;&gt;layer13_mha_out_15 -->
<g id="edge1224" class="edge">
<title>layer13_mha_attn_15&#45;&gt;layer13_mha_out_15</title>
<path fill="none" stroke="black" d="M16788.5,-3914.96C16788.5,-3906.25 16788.5,-3897.59 16788.5,-3889.39"/>
<polygon fill="black" stroke="black" points="16792,-3889.29 16788.5,-3879.29 16785,-3889.29 16792,-3889.29"/>
</g>
<!-- layer13_mha_out_8 -->
<g id="node1060" class="node">
<title>layer13_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="10105.5,-3718.5 9667.5,-3718.5 9667.5,-3635.5 10105.5,-3635.5 10105.5,-3718.5"/>
<text text-anchor="middle" x="9886.5" y="-3703.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9886.5" y="-3688.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9886.5" y="-3673.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9886.5" y="-3658.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9886.5" y="-3643.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_res1_8 -->
<g id="node1097" class="node">
<title>layer13_res1_8</title>
<polygon fill="none" stroke="black" points="9949,-3542 9824,-3542 9824,-3506 9949,-3506 9949,-3542"/>
<text text-anchor="middle" x="9886.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_res1_8</text>
</g>
<!-- layer13_mha_out_8&#45;&gt;layer13_res1_8 -->
<g id="edge1148" class="edge">
<title>layer13_mha_out_8&#45;&gt;layer13_res1_8</title>
<path fill="none" stroke="black" d="M9886.5,-3635.14C9886.5,-3608.9 9886.5,-3575.53 9886.5,-3552.44"/>
<polygon fill="black" stroke="black" points="9890,-3552.31 9886.5,-3542.31 9883,-3552.31 9890,-3552.31"/>
</g>
<!-- layer13_mha_out_9 -->
<g id="node1061" class="node">
<title>layer13_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="10907.5,-3879 10469.5,-3879 10469.5,-3796 10907.5,-3796 10907.5,-3879"/>
<text text-anchor="middle" x="10688.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10688.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10688.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10688.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10688.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_res1_9 -->
<g id="node1102" class="node">
<title>layer13_res1_9</title>
<polygon fill="none" stroke="black" points="10751,-3695 10626,-3695 10626,-3659 10751,-3659 10751,-3695"/>
<text text-anchor="middle" x="10688.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer13_res1_9</text>
</g>
<!-- layer13_mha_out_9&#45;&gt;layer13_res1_9 -->
<g id="edge1159" class="edge">
<title>layer13_mha_out_9&#45;&gt;layer13_res1_9</title>
<path fill="none" stroke="black" d="M10688.5,-3795.68C10688.5,-3767.24 10688.5,-3730.08 10688.5,-3705.2"/>
<polygon fill="black" stroke="black" points="10692,-3705.02 10688.5,-3695.02 10685,-3705.02 10692,-3705.02"/>
</g>
<!-- layer13_mha_out_10 -->
<g id="node1062" class="node">
<title>layer13_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="12326.5,-3879 11888.5,-3879 11888.5,-3796 12326.5,-3796 12326.5,-3879"/>
<text text-anchor="middle" x="12107.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12107.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12107.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12107.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12107.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_res1_10 -->
<g id="node1107" class="node">
<title>layer13_res1_10</title>
<polygon fill="none" stroke="black" points="12174.5,-3695 12040.5,-3695 12040.5,-3659 12174.5,-3659 12174.5,-3695"/>
<text text-anchor="middle" x="12107.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer13_res1_10</text>
</g>
<!-- layer13_mha_out_10&#45;&gt;layer13_res1_10 -->
<g id="edge1170" class="edge">
<title>layer13_mha_out_10&#45;&gt;layer13_res1_10</title>
<path fill="none" stroke="black" d="M12107.5,-3795.68C12107.5,-3767.24 12107.5,-3730.08 12107.5,-3705.2"/>
<polygon fill="black" stroke="black" points="12111,-3705.02 12107.5,-3695.02 12104,-3705.02 12111,-3705.02"/>
</g>
<!-- layer13_mha_out_11 -->
<g id="node1063" class="node">
<title>layer13_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="12905.5,-3879 12467.5,-3879 12467.5,-3796 12905.5,-3796 12905.5,-3879"/>
<text text-anchor="middle" x="12686.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12686.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12686.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12686.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12686.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_res1_11 -->
<g id="node1112" class="node">
<title>layer13_res1_11</title>
<polygon fill="none" stroke="black" points="12753.5,-3695 12619.5,-3695 12619.5,-3659 12753.5,-3659 12753.5,-3695"/>
<text text-anchor="middle" x="12686.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer13_res1_11</text>
</g>
<!-- layer13_mha_out_11&#45;&gt;layer13_res1_11 -->
<g id="edge1181" class="edge">
<title>layer13_mha_out_11&#45;&gt;layer13_res1_11</title>
<path fill="none" stroke="black" d="M12686.5,-3795.68C12686.5,-3767.24 12686.5,-3730.08 12686.5,-3705.2"/>
<polygon fill="black" stroke="black" points="12690,-3705.02 12686.5,-3695.02 12683,-3705.02 12690,-3705.02"/>
</g>
<!-- layer13_mha_out_12 -->
<g id="node1064" class="node">
<title>layer13_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14096.5,-3879 13658.5,-3879 13658.5,-3796 14096.5,-3796 14096.5,-3879"/>
<text text-anchor="middle" x="13877.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="13877.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13877.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13877.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13877.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_res1_12 -->
<g id="node1117" class="node">
<title>layer13_res1_12</title>
<polygon fill="none" stroke="black" points="13944.5,-3695 13810.5,-3695 13810.5,-3659 13944.5,-3659 13944.5,-3695"/>
<text text-anchor="middle" x="13877.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer13_res1_12</text>
</g>
<!-- layer13_mha_out_12&#45;&gt;layer13_res1_12 -->
<g id="edge1192" class="edge">
<title>layer13_mha_out_12&#45;&gt;layer13_res1_12</title>
<path fill="none" stroke="black" d="M13877.5,-3795.68C13877.5,-3767.24 13877.5,-3730.08 13877.5,-3705.2"/>
<polygon fill="black" stroke="black" points="13881,-3705.02 13877.5,-3695.02 13874,-3705.02 13881,-3705.02"/>
</g>
<!-- layer13_mha_out_13 -->
<g id="node1065" class="node">
<title>layer13_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="15168.5,-3879 14730.5,-3879 14730.5,-3796 15168.5,-3796 15168.5,-3879"/>
<text text-anchor="middle" x="14949.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14949.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14949.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14949.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14949.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_res1_13 -->
<g id="node1122" class="node">
<title>layer13_res1_13</title>
<polygon fill="none" stroke="black" points="15016.5,-3695 14882.5,-3695 14882.5,-3659 15016.5,-3659 15016.5,-3695"/>
<text text-anchor="middle" x="14949.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer13_res1_13</text>
</g>
<!-- layer13_mha_out_13&#45;&gt;layer13_res1_13 -->
<g id="edge1203" class="edge">
<title>layer13_mha_out_13&#45;&gt;layer13_res1_13</title>
<path fill="none" stroke="black" d="M14949.5,-3795.68C14949.5,-3767.24 14949.5,-3730.08 14949.5,-3705.2"/>
<polygon fill="black" stroke="black" points="14953,-3705.02 14949.5,-3695.02 14946,-3705.02 14953,-3705.02"/>
</g>
<!-- layer13_mha_out_14 -->
<g id="node1066" class="node">
<title>layer13_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16404.5,-3879 15966.5,-3879 15966.5,-3796 16404.5,-3796 16404.5,-3879"/>
<text text-anchor="middle" x="16185.5" y="-3863.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16185.5" y="-3848.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16185.5" y="-3833.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16185.5" y="-3818.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16185.5" y="-3803.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_res1_14 -->
<g id="node1127" class="node">
<title>layer13_res1_14</title>
<polygon fill="none" stroke="black" points="16252.5,-3695 16118.5,-3695 16118.5,-3659 16252.5,-3659 16252.5,-3695"/>
<text text-anchor="middle" x="16185.5" y="-3673.3" font-family="Times,serif" font-size="14.00">layer13_res1_14</text>
</g>
<!-- layer13_mha_out_14&#45;&gt;layer13_res1_14 -->
<g id="edge1214" class="edge">
<title>layer13_mha_out_14&#45;&gt;layer13_res1_14</title>
<path fill="none" stroke="black" d="M16185.5,-3795.68C16185.5,-3767.24 16185.5,-3730.08 16185.5,-3705.2"/>
<polygon fill="black" stroke="black" points="16189,-3705.02 16185.5,-3695.02 16182,-3705.02 16189,-3705.02"/>
</g>
<!-- layer13_res1_15 -->
<g id="node1068" class="node">
<title>layer13_res1_15</title>
<polygon fill="none" stroke="black" points="17229.24,-3760 16528.12,-3760 16347.76,-3594 17048.88,-3594 17229.24,-3760"/>
<text text-anchor="middle" x="16788.5" y="-3703.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16788.5" y="-3688.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3673.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3658.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3643.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_mha_out_15&#45;&gt;layer13_res1_15 -->
<g id="edge1225" class="edge">
<title>layer13_mha_out_15&#45;&gt;layer13_res1_15</title>
<path fill="none" stroke="black" d="M16788.5,-3795.68C16788.5,-3787.75 16788.5,-3779.14 16788.5,-3770.31"/>
<polygon fill="black" stroke="black" points="16792,-3770.27 16788.5,-3760.27 16785,-3770.27 16792,-3770.27"/>
</g>
<!-- layer13_ln1_15 -->
<g id="node1069" class="node">
<title>layer13_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17001,-3558 16576,-3558 16576,-3490 17001,-3490 17001,-3558"/>
<text text-anchor="middle" x="16788.5" y="-3542.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="16788.5" y="-3527.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3512.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16788.5" y="-3497.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_res1_15&#45;&gt;layer13_ln1_15 -->
<g id="edge1226" class="edge">
<title>layer13_res1_15&#45;&gt;layer13_ln1_15</title>
<path fill="none" stroke="black" d="M16788.5,-3593.87C16788.5,-3585.12 16788.5,-3576.48 16788.5,-3568.45"/>
<polygon fill="black" stroke="black" points="16792,-3568.26 16788.5,-3558.26 16785,-3568.26 16792,-3568.26"/>
</g>
<!-- layer13_ffn_gate_15 -->
<g id="node1077" class="node">
<title>layer13_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="16974,-3454 16501,-3454 16501,-3371 16974,-3371 16974,-3454"/>
<text text-anchor="middle" x="16737.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16737.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16737.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16737.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16737.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_ln1_15&#45;&gt;layer13_ffn_gate_15 -->
<g id="edge1227" class="edge">
<title>layer13_ln1_15&#45;&gt;layer13_ffn_gate_15</title>
<path fill="none" stroke="black" d="M16773.06,-3489.85C16769.19,-3481.53 16764.94,-3472.43 16760.78,-3463.49"/>
<polygon fill="black" stroke="black" points="16763.89,-3461.86 16756.49,-3454.28 16757.54,-3464.82 16763.89,-3461.86"/>
</g>
<!-- layer13_ffn_up_15 -->
<g id="node1085" class="node">
<title>layer13_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17465,-3454 16992,-3454 16992,-3371 17465,-3371 17465,-3454"/>
<text text-anchor="middle" x="17228.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17228.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17228.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17228.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17228.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_ln1_15&#45;&gt;layer13_ffn_up_15 -->
<g id="edge1228" class="edge">
<title>layer13_ln1_15&#45;&gt;layer13_ffn_up_15</title>
<path fill="none" stroke="black" d="M16921.11,-3490C16963.43,-3479.47 17010.89,-3467.65 17055.63,-3456.52"/>
<polygon fill="black" stroke="black" points="17056.57,-3459.89 17065.43,-3454.08 17054.88,-3453.1 17056.57,-3459.89"/>
</g>
<!-- layer13_ffn_gate_8 -->
<g id="node1070" class="node">
<title>layer13_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="9866,-3293.5 9393,-3293.5 9393,-3210.5 9866,-3210.5 9866,-3293.5"/>
<text text-anchor="middle" x="9629.5" y="-3278.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9629.5" y="-3263.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9629.5" y="-3248.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9629.5" y="-3233.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9629.5" y="-3218.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_ffn_act_8 -->
<g id="node1099" class="node">
<title>layer13_ffn_act_8</title>
<polygon fill="none" stroke="black" points="9907.5,-3109.5 9767.5,-3109.5 9767.5,-3073.5 9907.5,-3073.5 9907.5,-3109.5"/>
<text text-anchor="middle" x="9837.5" y="-3087.8" font-family="Times,serif" font-size="14.00">layer13_ffn_act_8</text>
</g>
<!-- layer13_ffn_gate_8&#45;&gt;layer13_ffn_act_8 -->
<g id="edge1152" class="edge">
<title>layer13_ffn_gate_8&#45;&gt;layer13_ffn_act_8</title>
<path fill="none" stroke="black" d="M9682.8,-3210.39C9722.13,-3180.41 9774.28,-3140.68 9806.86,-3115.85"/>
<polygon fill="black" stroke="black" points="9809.27,-3118.41 9815.1,-3109.57 9805.02,-3112.85 9809.27,-3118.41"/>
</g>
<!-- layer13_ffn_gate_9 -->
<g id="node1071" class="node">
<title>layer13_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10454,-3454 9981,-3454 9981,-3371 10454,-3371 10454,-3454"/>
<text text-anchor="middle" x="10217.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10217.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10217.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10217.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10217.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_ffn_act_9 -->
<g id="node1104" class="node">
<title>layer13_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10765.5,-3270 10625.5,-3270 10625.5,-3234 10765.5,-3234 10765.5,-3270"/>
<text text-anchor="middle" x="10695.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer13_ffn_act_9</text>
</g>
<!-- layer13_ffn_gate_9&#45;&gt;layer13_ffn_act_9 -->
<g id="edge1163" class="edge">
<title>layer13_ffn_gate_9&#45;&gt;layer13_ffn_act_9</title>
<path fill="none" stroke="black" d="M10339.67,-3370.99C10433.91,-3339.74 10560.29,-3297.83 10634.31,-3273.29"/>
<polygon fill="black" stroke="black" points="10635.56,-3276.56 10643.95,-3270.09 10633.36,-3269.92 10635.56,-3276.56"/>
</g>
<!-- layer13_ffn_gate_10 -->
<g id="node1072" class="node">
<title>layer13_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11856,-3454 11383,-3454 11383,-3371 11856,-3371 11856,-3454"/>
<text text-anchor="middle" x="11619.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11619.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11619.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11619.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11619.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_ffn_act_10 -->
<g id="node1109" class="node">
<title>layer13_ffn_act_10</title>
<polygon fill="none" stroke="black" points="11696,-3270 11547,-3270 11547,-3234 11696,-3234 11696,-3270"/>
<text text-anchor="middle" x="11621.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer13_ffn_act_10</text>
</g>
<!-- layer13_ffn_gate_10&#45;&gt;layer13_ffn_act_10 -->
<g id="edge1174" class="edge">
<title>layer13_ffn_gate_10&#45;&gt;layer13_ffn_act_10</title>
<path fill="none" stroke="black" d="M11620.02,-3370.68C11620.37,-3342.24 11620.84,-3305.08 11621.16,-3280.2"/>
<polygon fill="black" stroke="black" points="11624.66,-3280.07 11621.29,-3270.02 11617.66,-3279.98 11624.66,-3280.07"/>
</g>
<!-- layer13_ffn_gate_11 -->
<g id="node1073" class="node">
<title>layer13_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="12853,-3454 12380,-3454 12380,-3371 12853,-3371 12853,-3454"/>
<text text-anchor="middle" x="12616.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12616.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12616.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12616.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12616.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_ffn_act_11 -->
<g id="node1114" class="node">
<title>layer13_ffn_act_11</title>
<polygon fill="none" stroke="black" points="12705,-3270 12556,-3270 12556,-3234 12705,-3234 12705,-3270"/>
<text text-anchor="middle" x="12630.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer13_ffn_act_11</text>
</g>
<!-- layer13_ffn_gate_11&#45;&gt;layer13_ffn_act_11 -->
<g id="edge1185" class="edge">
<title>layer13_ffn_gate_11&#45;&gt;layer13_ffn_act_11</title>
<path fill="none" stroke="black" d="M12620.11,-3370.68C12622.62,-3342.24 12625.9,-3305.08 12628.1,-3280.2"/>
<polygon fill="black" stroke="black" points="12631.6,-3280.29 12629,-3270.02 12624.63,-3279.68 12631.6,-3280.29"/>
</g>
<!-- layer13_ffn_gate_12 -->
<g id="node1074" class="node">
<title>layer13_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="13851,-3454 13378,-3454 13378,-3371 13851,-3371 13851,-3454"/>
<text text-anchor="middle" x="13614.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13614.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13614.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13614.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13614.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_ffn_act_12 -->
<g id="node1119" class="node">
<title>layer13_ffn_act_12</title>
<polygon fill="none" stroke="black" points="13903,-3270 13754,-3270 13754,-3234 13903,-3234 13903,-3270"/>
<text text-anchor="middle" x="13828.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer13_ffn_act_12</text>
</g>
<!-- layer13_ffn_gate_12&#45;&gt;layer13_ffn_act_12 -->
<g id="edge1196" class="edge">
<title>layer13_ffn_gate_12&#45;&gt;layer13_ffn_act_12</title>
<path fill="none" stroke="black" d="M13669.33,-3370.89C13709.97,-3340.79 13763.91,-3300.84 13797.4,-3276.03"/>
<polygon fill="black" stroke="black" points="13799.5,-3278.83 13805.45,-3270.07 13795.33,-3273.21 13799.5,-3278.83"/>
</g>
<!-- layer13_ffn_gate_13 -->
<g id="node1075" class="node">
<title>layer13_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="14850,-3454 14377,-3454 14377,-3371 14850,-3371 14850,-3454"/>
<text text-anchor="middle" x="14613.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14613.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14613.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14613.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14613.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_ffn_act_13 -->
<g id="node1124" class="node">
<title>layer13_ffn_act_13</title>
<polygon fill="none" stroke="black" points="14700,-3270 14551,-3270 14551,-3234 14700,-3234 14700,-3270"/>
<text text-anchor="middle" x="14625.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer13_ffn_act_13</text>
</g>
<!-- layer13_ffn_gate_13&#45;&gt;layer13_ffn_act_13 -->
<g id="edge1207" class="edge">
<title>layer13_ffn_gate_13&#45;&gt;layer13_ffn_act_13</title>
<path fill="none" stroke="black" d="M14616.59,-3370.68C14618.74,-3342.24 14621.56,-3305.08 14623.44,-3280.2"/>
<polygon fill="black" stroke="black" points="14626.95,-3280.26 14624.21,-3270.02 14619.97,-3279.73 14626.95,-3280.26"/>
</g>
<!-- layer13_ffn_gate_14 -->
<g id="node1076" class="node">
<title>layer13_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="15948,-3454 15475,-3454 15475,-3371 15948,-3371 15948,-3454"/>
<text text-anchor="middle" x="15711.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15711.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15711.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15711.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15711.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_ffn_act_14 -->
<g id="node1129" class="node">
<title>layer13_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16040,-3270 15891,-3270 15891,-3234 16040,-3234 16040,-3270"/>
<text text-anchor="middle" x="15965.5" y="-3248.3" font-family="Times,serif" font-size="14.00">layer13_ffn_act_14</text>
</g>
<!-- layer13_ffn_gate_14&#45;&gt;layer13_ffn_act_14 -->
<g id="edge1218" class="edge">
<title>layer13_ffn_gate_14&#45;&gt;layer13_ffn_act_14</title>
<path fill="none" stroke="black" d="M15776.58,-3370.89C15825.23,-3340.53 15889.92,-3300.16 15929.59,-3275.41"/>
<polygon fill="black" stroke="black" points="15931.52,-3278.33 15938.15,-3270.07 15927.81,-3272.39 15931.52,-3278.33"/>
</g>
<!-- layer13_ffn_act_15 -->
<g id="node1086" class="node">
<title>layer13_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17221.24,-3335 16464.44,-3335 16269.76,-3169 17026.56,-3169 17221.24,-3335"/>
<text text-anchor="middle" x="16745.5" y="-3278.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="16745.5" y="-3263.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="16745.5" y="-3248.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16745.5" y="-3233.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16745.5" y="-3218.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_ffn_gate_15&#45;&gt;layer13_ffn_act_15 -->
<g id="edge1229" class="edge">
<title>layer13_ffn_gate_15&#45;&gt;layer13_ffn_act_15</title>
<path fill="none" stroke="black" d="M16739.56,-3370.68C16739.96,-3362.75 16740.39,-3354.14 16740.84,-3345.31"/>
<polygon fill="black" stroke="black" points="16744.34,-3345.44 16741.35,-3335.27 16737.35,-3345.08 16744.34,-3345.44"/>
</g>
<!-- layer13_ffn_up_8 -->
<g id="node1078" class="node">
<title>layer13_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10357,-3293.5 9884,-3293.5 9884,-3210.5 10357,-3210.5 10357,-3293.5"/>
<text text-anchor="middle" x="10120.5" y="-3278.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10120.5" y="-3263.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10120.5" y="-3248.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10120.5" y="-3233.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10120.5" y="-3218.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_ffn_up_8&#45;&gt;layer13_ffn_act_8 -->
<g id="edge1153" class="edge">
<title>layer13_ffn_up_8&#45;&gt;layer13_ffn_act_8</title>
<path fill="none" stroke="black" d="M10047.99,-3210.39C9993.56,-3179.9 9921.1,-3139.32 9876.95,-3114.6"/>
<polygon fill="black" stroke="black" points="9878.41,-3111.4 9867.98,-3109.57 9874.99,-3117.51 9878.41,-3111.4"/>
</g>
<!-- layer13_ffn_up_9 -->
<g id="node1079" class="node">
<title>layer13_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="10945,-3454 10472,-3454 10472,-3371 10945,-3371 10945,-3454"/>
<text text-anchor="middle" x="10708.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10708.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10708.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10708.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10708.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_ffn_up_9&#45;&gt;layer13_ffn_act_9 -->
<g id="edge1164" class="edge">
<title>layer13_ffn_up_9&#45;&gt;layer13_ffn_act_9</title>
<path fill="none" stroke="black" d="M10705.15,-3370.68C10702.82,-3342.24 10699.77,-3305.08 10697.73,-3280.2"/>
<polygon fill="black" stroke="black" points="10701.2,-3279.7 10696.9,-3270.02 10694.23,-3280.28 10701.2,-3279.7"/>
</g>
<!-- layer13_ffn_up_10 -->
<g id="node1080" class="node">
<title>layer13_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12347,-3454 11874,-3454 11874,-3371 12347,-3371 12347,-3454"/>
<text text-anchor="middle" x="12110.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12110.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12110.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12110.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12110.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_ffn_up_10&#45;&gt;layer13_ffn_act_10 -->
<g id="edge1175" class="edge">
<title>layer13_ffn_up_10&#45;&gt;layer13_ffn_act_10</title>
<path fill="none" stroke="black" d="M11985.52,-3370.99C11889.11,-3339.74 11759.82,-3297.83 11684.1,-3273.29"/>
<polygon fill="black" stroke="black" points="11684.82,-3269.85 11674.23,-3270.09 11682.67,-3276.51 11684.82,-3269.85"/>
</g>
<!-- layer13_ffn_up_11 -->
<g id="node1081" class="node">
<title>layer13_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13344,-3454 12871,-3454 12871,-3371 13344,-3371 13344,-3454"/>
<text text-anchor="middle" x="13107.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13107.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13107.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13107.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13107.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_ffn_up_11&#45;&gt;layer13_ffn_act_11 -->
<g id="edge1186" class="edge">
<title>layer13_ffn_up_11&#45;&gt;layer13_ffn_act_11</title>
<path fill="none" stroke="black" d="M12985.59,-3370.99C12891.55,-3339.74 12765.43,-3297.83 12691.56,-3273.29"/>
<polygon fill="black" stroke="black" points="12692.53,-3269.92 12681.94,-3270.09 12690.32,-3276.57 12692.53,-3269.92"/>
</g>
<!-- layer13_ffn_up_12 -->
<g id="node1082" class="node">
<title>layer13_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14342,-3454 13869,-3454 13869,-3371 14342,-3371 14342,-3454"/>
<text text-anchor="middle" x="14105.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14105.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14105.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14105.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14105.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_ffn_up_12&#45;&gt;layer13_ffn_act_12 -->
<g id="edge1197" class="edge">
<title>layer13_ffn_up_12&#45;&gt;layer13_ffn_act_12</title>
<path fill="none" stroke="black" d="M14034.53,-3370.89C13981.25,-3340.4 13910.33,-3299.82 13867.11,-3275.1"/>
<polygon fill="black" stroke="black" points="13868.75,-3272 13858.33,-3270.07 13865.27,-3278.07 13868.75,-3272"/>
</g>
<!-- layer13_ffn_up_13 -->
<g id="node1083" class="node">
<title>layer13_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15341,-3454 14868,-3454 14868,-3371 15341,-3371 15341,-3454"/>
<text text-anchor="middle" x="15104.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15104.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15104.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15104.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15104.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_ffn_up_13&#45;&gt;layer13_ffn_act_13 -->
<g id="edge1208" class="edge">
<title>layer13_ffn_up_13&#45;&gt;layer13_ffn_act_13</title>
<path fill="none" stroke="black" d="M14982.08,-3370.99C14887.64,-3339.74 14760.99,-3297.83 14686.82,-3273.29"/>
<polygon fill="black" stroke="black" points="14687.75,-3269.91 14677.15,-3270.09 14685.55,-3276.56 14687.75,-3269.91"/>
</g>
<!-- layer13_ffn_up_14 -->
<g id="node1084" class="node">
<title>layer13_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16439,-3454 15966,-3454 15966,-3371 16439,-3371 16439,-3454"/>
<text text-anchor="middle" x="16202.5" y="-3438.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16202.5" y="-3423.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16202.5" y="-3408.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16202.5" y="-3393.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16202.5" y="-3378.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_ffn_up_14&#45;&gt;layer13_ffn_act_14 -->
<g id="edge1219" class="edge">
<title>layer13_ffn_up_14&#45;&gt;layer13_ffn_act_14</title>
<path fill="none" stroke="black" d="M16141.77,-3370.89C16096.57,-3340.66 16036.52,-3300.5 15999.47,-3275.72"/>
<polygon fill="black" stroke="black" points="16001.28,-3272.72 15991.02,-3270.07 15997.39,-3278.54 16001.28,-3272.72"/>
</g>
<!-- layer13_ffn_up_15&#45;&gt;layer13_ffn_act_15 -->
<g id="edge1230" class="edge">
<title>layer13_ffn_up_15&#45;&gt;layer13_ffn_act_15</title>
<path fill="none" stroke="black" d="M17105.06,-3370.99C17074.27,-3360.89 17040.09,-3349.67 17005.4,-3338.29"/>
<polygon fill="black" stroke="black" points="17006.2,-3334.87 16995.61,-3335.07 17004.02,-3341.52 17006.2,-3334.87"/>
</g>
<!-- layer13_ffn_down_15 -->
<g id="node1094" class="node">
<title>layer13_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="16969,-3133 16522,-3133 16522,-3050 16969,-3050 16969,-3133"/>
<text text-anchor="middle" x="16745.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16745.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16745.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16745.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16745.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_ffn_act_15&#45;&gt;layer13_ffn_down_15 -->
<g id="edge1231" class="edge">
<title>layer13_ffn_act_15&#45;&gt;layer13_ffn_down_15</title>
<path fill="none" stroke="black" d="M16745.5,-3168.96C16745.5,-3160.25 16745.5,-3151.59 16745.5,-3143.39"/>
<polygon fill="black" stroke="black" points="16749,-3143.29 16745.5,-3133.29 16742,-3143.29 16749,-3143.29"/>
</g>
<!-- layer13_ffn_down_8 -->
<g id="node1087" class="node">
<title>layer13_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="10061,-2972.5 9614,-2972.5 9614,-2889.5 10061,-2889.5 10061,-2972.5"/>
<text text-anchor="middle" x="9837.5" y="-2957.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9837.5" y="-2942.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9837.5" y="-2927.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="9837.5" y="-2912.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9837.5" y="-2897.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_res2_8 -->
<g id="node1100" class="node">
<title>layer13_res2_8</title>
<polygon fill="none" stroke="black" points="9900,-2788.5 9775,-2788.5 9775,-2752.5 9900,-2752.5 9900,-2788.5"/>
<text text-anchor="middle" x="9837.5" y="-2766.8" font-family="Times,serif" font-size="14.00">layer13_res2_8</text>
</g>
<!-- layer13_ffn_down_8&#45;&gt;layer13_res2_8 -->
<g id="edge1155" class="edge">
<title>layer13_ffn_down_8&#45;&gt;layer13_res2_8</title>
<path fill="none" stroke="black" d="M9837.5,-2889.18C9837.5,-2860.74 9837.5,-2823.58 9837.5,-2798.7"/>
<polygon fill="black" stroke="black" points="9841,-2798.52 9837.5,-2788.52 9834,-2798.52 9841,-2798.52"/>
</g>
<!-- layer13_ffn_down_9 -->
<g id="node1088" class="node">
<title>layer13_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="10919,-3133 10472,-3133 10472,-3050 10919,-3050 10919,-3133"/>
<text text-anchor="middle" x="10695.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10695.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10695.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10695.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10695.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_res2_9 -->
<g id="node1105" class="node">
<title>layer13_res2_9</title>
<polygon fill="none" stroke="black" points="10758,-2949 10633,-2949 10633,-2913 10758,-2913 10758,-2949"/>
<text text-anchor="middle" x="10695.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer13_res2_9</text>
</g>
<!-- layer13_ffn_down_9&#45;&gt;layer13_res2_9 -->
<g id="edge1166" class="edge">
<title>layer13_ffn_down_9&#45;&gt;layer13_res2_9</title>
<path fill="none" stroke="black" d="M10695.5,-3049.68C10695.5,-3021.24 10695.5,-2984.08 10695.5,-2959.2"/>
<polygon fill="black" stroke="black" points="10699,-2959.02 10695.5,-2949.02 10692,-2959.02 10699,-2959.02"/>
</g>
<!-- layer13_ffn_down_10 -->
<g id="node1089" class="node">
<title>layer13_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="11845,-3133 11398,-3133 11398,-3050 11845,-3050 11845,-3133"/>
<text text-anchor="middle" x="11621.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11621.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11621.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11621.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11621.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_res2_10 -->
<g id="node1110" class="node">
<title>layer13_res2_10</title>
<polygon fill="none" stroke="black" points="11688.5,-2949 11554.5,-2949 11554.5,-2913 11688.5,-2913 11688.5,-2949"/>
<text text-anchor="middle" x="11621.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer13_res2_10</text>
</g>
<!-- layer13_ffn_down_10&#45;&gt;layer13_res2_10 -->
<g id="edge1177" class="edge">
<title>layer13_ffn_down_10&#45;&gt;layer13_res2_10</title>
<path fill="none" stroke="black" d="M11621.5,-3049.68C11621.5,-3021.24 11621.5,-2984.08 11621.5,-2959.2"/>
<polygon fill="black" stroke="black" points="11625,-2959.02 11621.5,-2949.02 11618,-2959.02 11625,-2959.02"/>
</g>
<!-- layer13_ffn_down_11 -->
<g id="node1090" class="node">
<title>layer13_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="12854,-3133 12407,-3133 12407,-3050 12854,-3050 12854,-3133"/>
<text text-anchor="middle" x="12630.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12630.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12630.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12630.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12630.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_res2_11 -->
<g id="node1115" class="node">
<title>layer13_res2_11</title>
<polygon fill="none" stroke="black" points="12697.5,-2949 12563.5,-2949 12563.5,-2913 12697.5,-2913 12697.5,-2949"/>
<text text-anchor="middle" x="12630.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer13_res2_11</text>
</g>
<!-- layer13_ffn_down_11&#45;&gt;layer13_res2_11 -->
<g id="edge1188" class="edge">
<title>layer13_ffn_down_11&#45;&gt;layer13_res2_11</title>
<path fill="none" stroke="black" d="M12630.5,-3049.68C12630.5,-3021.24 12630.5,-2984.08 12630.5,-2959.2"/>
<polygon fill="black" stroke="black" points="12634,-2959.02 12630.5,-2949.02 12627,-2959.02 12634,-2959.02"/>
</g>
<!-- layer13_ffn_down_12 -->
<g id="node1091" class="node">
<title>layer13_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14052,-3133 13605,-3133 13605,-3050 14052,-3050 14052,-3133"/>
<text text-anchor="middle" x="13828.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13828.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13828.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13828.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13828.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_res2_12 -->
<g id="node1120" class="node">
<title>layer13_res2_12</title>
<polygon fill="none" stroke="black" points="13895.5,-2949 13761.5,-2949 13761.5,-2913 13895.5,-2913 13895.5,-2949"/>
<text text-anchor="middle" x="13828.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer13_res2_12</text>
</g>
<!-- layer13_ffn_down_12&#45;&gt;layer13_res2_12 -->
<g id="edge1199" class="edge">
<title>layer13_ffn_down_12&#45;&gt;layer13_res2_12</title>
<path fill="none" stroke="black" d="M13828.5,-3049.68C13828.5,-3021.24 13828.5,-2984.08 13828.5,-2959.2"/>
<polygon fill="black" stroke="black" points="13832,-2959.02 13828.5,-2949.02 13825,-2959.02 13832,-2959.02"/>
</g>
<!-- layer13_ffn_down_13 -->
<g id="node1092" class="node">
<title>layer13_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="14849,-3133 14402,-3133 14402,-3050 14849,-3050 14849,-3133"/>
<text text-anchor="middle" x="14625.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14625.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14625.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14625.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14625.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_res2_13 -->
<g id="node1125" class="node">
<title>layer13_res2_13</title>
<polygon fill="none" stroke="black" points="14692.5,-2949 14558.5,-2949 14558.5,-2913 14692.5,-2913 14692.5,-2949"/>
<text text-anchor="middle" x="14625.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer13_res2_13</text>
</g>
<!-- layer13_ffn_down_13&#45;&gt;layer13_res2_13 -->
<g id="edge1210" class="edge">
<title>layer13_ffn_down_13&#45;&gt;layer13_res2_13</title>
<path fill="none" stroke="black" d="M14625.5,-3049.68C14625.5,-3021.24 14625.5,-2984.08 14625.5,-2959.2"/>
<polygon fill="black" stroke="black" points="14629,-2959.02 14625.5,-2949.02 14622,-2959.02 14629,-2959.02"/>
</g>
<!-- layer13_ffn_down_14 -->
<g id="node1093" class="node">
<title>layer13_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16189,-3133 15742,-3133 15742,-3050 16189,-3050 16189,-3133"/>
<text text-anchor="middle" x="15965.5" y="-3117.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15965.5" y="-3102.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15965.5" y="-3087.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="15965.5" y="-3072.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15965.5" y="-3057.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_res2_14 -->
<g id="node1130" class="node">
<title>layer13_res2_14</title>
<polygon fill="none" stroke="black" points="16032.5,-2949 15898.5,-2949 15898.5,-2913 16032.5,-2913 16032.5,-2949"/>
<text text-anchor="middle" x="15965.5" y="-2927.3" font-family="Times,serif" font-size="14.00">layer13_res2_14</text>
</g>
<!-- layer13_ffn_down_14&#45;&gt;layer13_res2_14 -->
<g id="edge1221" class="edge">
<title>layer13_ffn_down_14&#45;&gt;layer13_res2_14</title>
<path fill="none" stroke="black" d="M15965.5,-3049.68C15965.5,-3021.24 15965.5,-2984.08 15965.5,-2959.2"/>
<polygon fill="black" stroke="black" points="15969,-2959.02 15965.5,-2949.02 15962,-2959.02 15969,-2959.02"/>
</g>
<!-- layer13_res2_15 -->
<g id="node1095" class="node">
<title>layer13_res2_15</title>
<polygon fill="none" stroke="black" points="17186.24,-3014 16485.12,-3014 16304.76,-2848 17005.88,-2848 17186.24,-3014"/>
<text text-anchor="middle" x="16745.5" y="-2957.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16745.5" y="-2942.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2927.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2912.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2897.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer13_ffn_down_15&#45;&gt;layer13_res2_15 -->
<g id="edge1232" class="edge">
<title>layer13_ffn_down_15&#45;&gt;layer13_res2_15</title>
<path fill="none" stroke="black" d="M16745.5,-3049.68C16745.5,-3041.75 16745.5,-3033.14 16745.5,-3024.31"/>
<polygon fill="black" stroke="black" points="16749,-3024.27 16745.5,-3014.27 16742,-3024.27 16749,-3024.27"/>
</g>
<!-- layer14_mha_qkv_15 -->
<g id="node1138" class="node">
<title>layer14_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17023.5,-2812 16467.5,-2812 16467.5,-2729 17023.5,-2729 17023.5,-2812"/>
<text text-anchor="middle" x="16745.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16745.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16745.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16745.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer13_res2_15&#45;&gt;layer14_mha_qkv_15 -->
<g id="edge1310" class="edge">
<title>layer13_res2_15&#45;&gt;layer14_mha_qkv_15</title>
<path fill="none" stroke="black" d="M16745.5,-2847.96C16745.5,-2839.25 16745.5,-2830.59 16745.5,-2822.39"/>
<polygon fill="black" stroke="black" points="16749,-2822.29 16745.5,-2812.29 16742,-2822.29 16749,-2822.29"/>
</g>
<!-- layer13_mha_attn_8&#45;&gt;layer13_mha_out_8 -->
<g id="edge1147" class="edge">
<title>layer13_mha_attn_8&#45;&gt;layer13_mha_out_8</title>
<path fill="none" stroke="black" d="M9886.5,-3819.24C9886.5,-3797.68 9886.5,-3759.87 9886.5,-3728.79"/>
<polygon fill="black" stroke="black" points="9890,-3728.54 9886.5,-3718.54 9883,-3728.54 9890,-3728.54"/>
</g>
<!-- layer13_ln1_8 -->
<g id="node1098" class="node">
<title>layer13_ln1_8</title>
<polygon fill="none" stroke="black" points="9944.5,-3430.5 9828.5,-3430.5 9828.5,-3394.5 9944.5,-3394.5 9944.5,-3430.5"/>
<text text-anchor="middle" x="9886.5" y="-3408.8" font-family="Times,serif" font-size="14.00">layer13_ln1_8</text>
</g>
<!-- layer13_res1_8&#45;&gt;layer13_ln1_8 -->
<g id="edge1149" class="edge">
<title>layer13_res1_8&#45;&gt;layer13_ln1_8</title>
<path fill="none" stroke="black" d="M9886.5,-3505.89C9886.5,-3488.56 9886.5,-3461.46 9886.5,-3441.09"/>
<polygon fill="black" stroke="black" points="9890,-3440.85 9886.5,-3430.85 9883,-3440.85 9890,-3440.85"/>
</g>
<!-- layer13_ln1_8&#45;&gt;layer13_ffn_gate_8 -->
<g id="edge1150" class="edge">
<title>layer13_ln1_8&#45;&gt;layer13_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9858.51,-3394.24C9821.74,-3371.56 9755.77,-3330.88 9704.05,-3298.98"/>
<polygon fill="black" stroke="black" points="9705.58,-3295.81 9695.23,-3293.54 9701.9,-3301.77 9705.58,-3295.81"/>
</g>
<!-- layer13_ln1_8&#45;&gt;layer13_ffn_up_8 -->
<g id="edge1151" class="edge">
<title>layer13_ln1_8&#45;&gt;layer13_ffn_up_8</title>
<path fill="none" stroke="black" d="M9911.99,-3394.24C9945.4,-3371.6 10005.28,-3331.04 10052.33,-3299.18"/>
<polygon fill="black" stroke="black" points="10054.34,-3302.04 10060.65,-3293.54 10050.41,-3296.25 10054.34,-3302.04"/>
</g>
<!-- layer13_ffn_act_8&#45;&gt;layer13_ffn_down_8 -->
<g id="edge1154" class="edge">
<title>layer13_ffn_act_8&#45;&gt;layer13_ffn_down_8</title>
<path fill="none" stroke="black" d="M9837.5,-3073.24C9837.5,-3051.68 9837.5,-3013.87 9837.5,-2982.79"/>
<polygon fill="black" stroke="black" points="9841,-2982.54 9837.5,-2972.54 9834,-2982.54 9841,-2982.54"/>
</g>
<!-- layer14_mha_qkv_8 -->
<g id="node1131" class="node">
<title>layer14_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="10115.5,-2651.5 9559.5,-2651.5 9559.5,-2568.5 10115.5,-2568.5 10115.5,-2651.5"/>
<text text-anchor="middle" x="9837.5" y="-2636.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="9837.5" y="-2621.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9837.5" y="-2606.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9837.5" y="-2591.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="9837.5" y="-2576.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer13_res2_8&#45;&gt;layer14_mha_qkv_8 -->
<g id="edge1233" class="edge">
<title>layer13_res2_8&#45;&gt;layer14_mha_qkv_8</title>
<path fill="none" stroke="black" d="M9837.5,-2752.24C9837.5,-2730.68 9837.5,-2692.87 9837.5,-2661.79"/>
<polygon fill="black" stroke="black" points="9841,-2661.54 9837.5,-2651.54 9834,-2661.54 9841,-2661.54"/>
</g>
<!-- layer13_mha_attn_9&#45;&gt;layer13_mha_out_9 -->
<g id="edge1158" class="edge">
<title>layer13_mha_attn_9&#45;&gt;layer13_mha_out_9</title>
<path fill="none" stroke="black" d="M10688.5,-3979.74C10688.5,-3958.18 10688.5,-3920.37 10688.5,-3889.29"/>
<polygon fill="black" stroke="black" points="10692,-3889.04 10688.5,-3879.04 10685,-3889.04 10692,-3889.04"/>
</g>
<!-- layer13_ln1_9 -->
<g id="node1103" class="node">
<title>layer13_ln1_9</title>
<polygon fill="none" stroke="black" points="10746.5,-3542 10630.5,-3542 10630.5,-3506 10746.5,-3506 10746.5,-3542"/>
<text text-anchor="middle" x="10688.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_ln1_9</text>
</g>
<!-- layer13_res1_9&#45;&gt;layer13_ln1_9 -->
<g id="edge1160" class="edge">
<title>layer13_res1_9&#45;&gt;layer13_ln1_9</title>
<path fill="none" stroke="black" d="M10688.5,-3658.97C10688.5,-3633.03 10688.5,-3583.36 10688.5,-3552.33"/>
<polygon fill="black" stroke="black" points="10692,-3552.2 10688.5,-3542.2 10685,-3552.2 10692,-3552.2"/>
</g>
<!-- layer13_ln1_9&#45;&gt;layer13_ffn_gate_9 -->
<g id="edge1161" class="edge">
<title>layer13_ln1_9&#45;&gt;layer13_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10630.27,-3509.46C10573.22,-3496.2 10483.2,-3475.27 10401.78,-3456.34"/>
<polygon fill="black" stroke="black" points="10402.42,-3452.9 10391.89,-3454.04 10400.84,-3459.72 10402.42,-3452.9"/>
</g>
<!-- layer13_ln1_9&#45;&gt;layer13_ffn_up_9 -->
<g id="edge1162" class="edge">
<title>layer13_ln1_9&#45;&gt;layer13_ffn_up_9</title>
<path fill="none" stroke="black" d="M10691.62,-3505.89C10693.68,-3494.65 10696.48,-3479.31 10699.21,-3464.35"/>
<polygon fill="black" stroke="black" points="10702.73,-3464.58 10701.08,-3454.12 10695.84,-3463.33 10702.73,-3464.58"/>
</g>
<!-- layer13_ffn_act_9&#45;&gt;layer13_ffn_down_9 -->
<g id="edge1165" class="edge">
<title>layer13_ffn_act_9&#45;&gt;layer13_ffn_down_9</title>
<path fill="none" stroke="black" d="M10695.5,-3233.74C10695.5,-3212.18 10695.5,-3174.37 10695.5,-3143.29"/>
<polygon fill="black" stroke="black" points="10699,-3143.04 10695.5,-3133.04 10692,-3143.04 10699,-3143.04"/>
</g>
<!-- layer14_mha_qkv_9 -->
<g id="node1132" class="node">
<title>layer14_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="10973.5,-2812 10417.5,-2812 10417.5,-2729 10973.5,-2729 10973.5,-2812"/>
<text text-anchor="middle" x="10695.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10695.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10695.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10695.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10695.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer13_res2_9&#45;&gt;layer14_mha_qkv_9 -->
<g id="edge1244" class="edge">
<title>layer13_res2_9&#45;&gt;layer14_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10695.5,-2912.74C10695.5,-2891.18 10695.5,-2853.37 10695.5,-2822.29"/>
<polygon fill="black" stroke="black" points="10699,-2822.04 10695.5,-2812.04 10692,-2822.04 10699,-2822.04"/>
</g>
<!-- layer13_mha_attn_10&#45;&gt;layer13_mha_out_10 -->
<g id="edge1169" class="edge">
<title>layer13_mha_attn_10&#45;&gt;layer13_mha_out_10</title>
<path fill="none" stroke="black" d="M12107.5,-3979.74C12107.5,-3958.18 12107.5,-3920.37 12107.5,-3889.29"/>
<polygon fill="black" stroke="black" points="12111,-3889.04 12107.5,-3879.04 12104,-3889.04 12111,-3889.04"/>
</g>
<!-- layer13_ln1_10 -->
<g id="node1108" class="node">
<title>layer13_ln1_10</title>
<polygon fill="none" stroke="black" points="12170,-3542 12045,-3542 12045,-3506 12170,-3506 12170,-3542"/>
<text text-anchor="middle" x="12107.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_ln1_10</text>
</g>
<!-- layer13_res1_10&#45;&gt;layer13_ln1_10 -->
<g id="edge1171" class="edge">
<title>layer13_res1_10&#45;&gt;layer13_ln1_10</title>
<path fill="none" stroke="black" d="M12107.5,-3658.97C12107.5,-3633.03 12107.5,-3583.36 12107.5,-3552.33"/>
<polygon fill="black" stroke="black" points="12111,-3552.2 12107.5,-3542.2 12104,-3552.2 12111,-3552.2"/>
</g>
<!-- layer13_ln1_10&#45;&gt;layer13_ffn_gate_10 -->
<g id="edge1172" class="edge">
<title>layer13_ln1_10&#45;&gt;layer13_ffn_gate_10</title>
<path fill="none" stroke="black" d="M12044.7,-3508.91C11985.4,-3495.6 11893.37,-3474.95 11810.08,-3456.26"/>
<polygon fill="black" stroke="black" points="11810.76,-3452.83 11800.23,-3454.05 11809.23,-3459.66 11810.76,-3452.83"/>
</g>
<!-- layer13_ln1_10&#45;&gt;layer13_ffn_up_10 -->
<g id="edge1173" class="edge">
<title>layer13_ln1_10&#45;&gt;layer13_ffn_up_10</title>
<path fill="none" stroke="black" d="M12107.97,-3505.89C12108.28,-3494.65 12108.7,-3479.31 12109.11,-3464.35"/>
<polygon fill="black" stroke="black" points="12112.61,-3464.21 12109.39,-3454.12 12105.61,-3464.02 12112.61,-3464.21"/>
</g>
<!-- layer13_ffn_act_10&#45;&gt;layer13_ffn_down_10 -->
<g id="edge1176" class="edge">
<title>layer13_ffn_act_10&#45;&gt;layer13_ffn_down_10</title>
<path fill="none" stroke="black" d="M11621.5,-3233.74C11621.5,-3212.18 11621.5,-3174.37 11621.5,-3143.29"/>
<polygon fill="black" stroke="black" points="11625,-3143.04 11621.5,-3133.04 11618,-3143.04 11625,-3143.04"/>
</g>
<!-- layer14_mha_qkv_10 -->
<g id="node1133" class="node">
<title>layer14_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="11899.5,-2812 11343.5,-2812 11343.5,-2729 11899.5,-2729 11899.5,-2812"/>
<text text-anchor="middle" x="11621.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="11621.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11621.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11621.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="11621.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer13_res2_10&#45;&gt;layer14_mha_qkv_10 -->
<g id="edge1255" class="edge">
<title>layer13_res2_10&#45;&gt;layer14_mha_qkv_10</title>
<path fill="none" stroke="black" d="M11621.5,-2912.74C11621.5,-2891.18 11621.5,-2853.37 11621.5,-2822.29"/>
<polygon fill="black" stroke="black" points="11625,-2822.04 11621.5,-2812.04 11618,-2822.04 11625,-2822.04"/>
</g>
<!-- layer13_mha_attn_11&#45;&gt;layer13_mha_out_11 -->
<g id="edge1180" class="edge">
<title>layer13_mha_attn_11&#45;&gt;layer13_mha_out_11</title>
<path fill="none" stroke="black" d="M12686.5,-3979.74C12686.5,-3958.18 12686.5,-3920.37 12686.5,-3889.29"/>
<polygon fill="black" stroke="black" points="12690,-3889.04 12686.5,-3879.04 12683,-3889.04 12690,-3889.04"/>
</g>
<!-- layer13_ln1_11 -->
<g id="node1113" class="node">
<title>layer13_ln1_11</title>
<polygon fill="none" stroke="black" points="12749,-3542 12624,-3542 12624,-3506 12749,-3506 12749,-3542"/>
<text text-anchor="middle" x="12686.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_ln1_11</text>
</g>
<!-- layer13_res1_11&#45;&gt;layer13_ln1_11 -->
<g id="edge1182" class="edge">
<title>layer13_res1_11&#45;&gt;layer13_ln1_11</title>
<path fill="none" stroke="black" d="M12686.5,-3658.97C12686.5,-3633.03 12686.5,-3583.36 12686.5,-3552.33"/>
<polygon fill="black" stroke="black" points="12690,-3552.2 12686.5,-3542.2 12683,-3552.2 12690,-3552.2"/>
</g>
<!-- layer13_ln1_11&#45;&gt;layer13_ffn_gate_11 -->
<g id="edge1183" class="edge">
<title>layer13_ln1_11&#45;&gt;layer13_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12675.56,-3505.89C12668.1,-3494.22 12657.81,-3478.12 12647.91,-3462.63"/>
<polygon fill="black" stroke="black" points="12650.8,-3460.66 12642.47,-3454.12 12644.9,-3464.43 12650.8,-3460.66"/>
</g>
<!-- layer13_ln1_11&#45;&gt;layer13_ffn_up_11 -->
<g id="edge1184" class="edge">
<title>layer13_ln1_11&#45;&gt;layer13_ffn_up_11</title>
<path fill="none" stroke="black" d="M12749.07,-3506.72C12799.94,-3493.49 12874.12,-3474.2 12941.81,-3456.6"/>
<polygon fill="black" stroke="black" points="12942.95,-3459.92 12951.74,-3454.01 12941.18,-3453.14 12942.95,-3459.92"/>
</g>
<!-- layer13_ffn_act_11&#45;&gt;layer13_ffn_down_11 -->
<g id="edge1187" class="edge">
<title>layer13_ffn_act_11&#45;&gt;layer13_ffn_down_11</title>
<path fill="none" stroke="black" d="M12630.5,-3233.74C12630.5,-3212.18 12630.5,-3174.37 12630.5,-3143.29"/>
<polygon fill="black" stroke="black" points="12634,-3143.04 12630.5,-3133.04 12627,-3143.04 12634,-3143.04"/>
</g>
<!-- layer14_mha_qkv_11 -->
<g id="node1134" class="node">
<title>layer14_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="12908.5,-2812 12352.5,-2812 12352.5,-2729 12908.5,-2729 12908.5,-2812"/>
<text text-anchor="middle" x="12630.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12630.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12630.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12630.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12630.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer13_res2_11&#45;&gt;layer14_mha_qkv_11 -->
<g id="edge1266" class="edge">
<title>layer13_res2_11&#45;&gt;layer14_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12630.5,-2912.74C12630.5,-2891.18 12630.5,-2853.37 12630.5,-2822.29"/>
<polygon fill="black" stroke="black" points="12634,-2822.04 12630.5,-2812.04 12627,-2822.04 12634,-2822.04"/>
</g>
<!-- layer13_mha_attn_12&#45;&gt;layer13_mha_out_12 -->
<g id="edge1191" class="edge">
<title>layer13_mha_attn_12&#45;&gt;layer13_mha_out_12</title>
<path fill="none" stroke="black" d="M13877.5,-3979.74C13877.5,-3958.18 13877.5,-3920.37 13877.5,-3889.29"/>
<polygon fill="black" stroke="black" points="13881,-3889.04 13877.5,-3879.04 13874,-3889.04 13881,-3889.04"/>
</g>
<!-- layer13_ln1_12 -->
<g id="node1118" class="node">
<title>layer13_ln1_12</title>
<polygon fill="none" stroke="black" points="13940,-3542 13815,-3542 13815,-3506 13940,-3506 13940,-3542"/>
<text text-anchor="middle" x="13877.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_ln1_12</text>
</g>
<!-- layer13_res1_12&#45;&gt;layer13_ln1_12 -->
<g id="edge1193" class="edge">
<title>layer13_res1_12&#45;&gt;layer13_ln1_12</title>
<path fill="none" stroke="black" d="M13877.5,-3658.97C13877.5,-3633.03 13877.5,-3583.36 13877.5,-3552.33"/>
<polygon fill="black" stroke="black" points="13881,-3552.2 13877.5,-3542.2 13874,-3552.2 13881,-3552.2"/>
</g>
<!-- layer13_ln1_12&#45;&gt;layer13_ffn_gate_12 -->
<g id="edge1194" class="edge">
<title>layer13_ln1_12&#45;&gt;layer13_ffn_gate_12</title>
<path fill="none" stroke="black" d="M13836.41,-3505.89C13805.51,-3493.03 13761.72,-3474.79 13721.18,-3457.92"/>
<polygon fill="black" stroke="black" points="13722.35,-3454.61 13711.78,-3454 13719.66,-3461.08 13722.35,-3454.61"/>
</g>
<!-- layer13_ln1_12&#45;&gt;layer13_ffn_up_12 -->
<g id="edge1195" class="edge">
<title>layer13_ln1_12&#45;&gt;layer13_ffn_up_12</title>
<path fill="none" stroke="black" d="M13913.12,-3505.89C13939.57,-3493.19 13976.92,-3475.25 14011.68,-3458.56"/>
<polygon fill="black" stroke="black" points="14013.43,-3461.6 14020.93,-3454.12 14010.4,-3455.29 14013.43,-3461.6"/>
</g>
<!-- layer13_ffn_act_12&#45;&gt;layer13_ffn_down_12 -->
<g id="edge1198" class="edge">
<title>layer13_ffn_act_12&#45;&gt;layer13_ffn_down_12</title>
<path fill="none" stroke="black" d="M13828.5,-3233.74C13828.5,-3212.18 13828.5,-3174.37 13828.5,-3143.29"/>
<polygon fill="black" stroke="black" points="13832,-3143.04 13828.5,-3133.04 13825,-3143.04 13832,-3143.04"/>
</g>
<!-- layer14_mha_qkv_12 -->
<g id="node1135" class="node">
<title>layer14_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14106.5,-2812 13550.5,-2812 13550.5,-2729 14106.5,-2729 14106.5,-2812"/>
<text text-anchor="middle" x="13828.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="13828.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13828.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13828.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="13828.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer13_res2_12&#45;&gt;layer14_mha_qkv_12 -->
<g id="edge1277" class="edge">
<title>layer13_res2_12&#45;&gt;layer14_mha_qkv_12</title>
<path fill="none" stroke="black" d="M13828.5,-2912.74C13828.5,-2891.18 13828.5,-2853.37 13828.5,-2822.29"/>
<polygon fill="black" stroke="black" points="13832,-2822.04 13828.5,-2812.04 13825,-2822.04 13832,-2822.04"/>
</g>
<!-- layer13_mha_attn_13&#45;&gt;layer13_mha_out_13 -->
<g id="edge1202" class="edge">
<title>layer13_mha_attn_13&#45;&gt;layer13_mha_out_13</title>
<path fill="none" stroke="black" d="M14949.5,-3979.74C14949.5,-3958.18 14949.5,-3920.37 14949.5,-3889.29"/>
<polygon fill="black" stroke="black" points="14953,-3889.04 14949.5,-3879.04 14946,-3889.04 14953,-3889.04"/>
</g>
<!-- layer13_ln1_13 -->
<g id="node1123" class="node">
<title>layer13_ln1_13</title>
<polygon fill="none" stroke="black" points="15012,-3542 14887,-3542 14887,-3506 15012,-3506 15012,-3542"/>
<text text-anchor="middle" x="14949.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_ln1_13</text>
</g>
<!-- layer13_res1_13&#45;&gt;layer13_ln1_13 -->
<g id="edge1204" class="edge">
<title>layer13_res1_13&#45;&gt;layer13_ln1_13</title>
<path fill="none" stroke="black" d="M14949.5,-3658.97C14949.5,-3633.03 14949.5,-3583.36 14949.5,-3552.33"/>
<polygon fill="black" stroke="black" points="14953,-3552.2 14949.5,-3542.2 14946,-3552.2 14953,-3552.2"/>
</g>
<!-- layer13_ln1_13&#45;&gt;layer13_ffn_gate_13 -->
<g id="edge1205" class="edge">
<title>layer13_ln1_13&#45;&gt;layer13_ffn_gate_13</title>
<path fill="none" stroke="black" d="M14897,-3505.89C14856.95,-3492.84 14799.92,-3474.25 14747.51,-3457.17"/>
<polygon fill="black" stroke="black" points="14748.37,-3453.77 14737.78,-3454 14746.2,-3460.43 14748.37,-3453.77"/>
</g>
<!-- layer13_ln1_13&#45;&gt;layer13_ffn_up_13 -->
<g id="edge1206" class="edge">
<title>layer13_ln1_13&#45;&gt;layer13_ffn_up_13</title>
<path fill="none" stroke="black" d="M14973.72,-3505.89C14991.16,-3493.57 15015.58,-3476.32 15038.6,-3460.05"/>
<polygon fill="black" stroke="black" points="15040.86,-3462.75 15047,-3454.12 15036.82,-3457.03 15040.86,-3462.75"/>
</g>
<!-- layer13_ffn_act_13&#45;&gt;layer13_ffn_down_13 -->
<g id="edge1209" class="edge">
<title>layer13_ffn_act_13&#45;&gt;layer13_ffn_down_13</title>
<path fill="none" stroke="black" d="M14625.5,-3233.74C14625.5,-3212.18 14625.5,-3174.37 14625.5,-3143.29"/>
<polygon fill="black" stroke="black" points="14629,-3143.04 14625.5,-3133.04 14622,-3143.04 14629,-3143.04"/>
</g>
<!-- layer14_mha_qkv_13 -->
<g id="node1136" class="node">
<title>layer14_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="14903.5,-2812 14347.5,-2812 14347.5,-2729 14903.5,-2729 14903.5,-2812"/>
<text text-anchor="middle" x="14625.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14625.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14625.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14625.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14625.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer13_res2_13&#45;&gt;layer14_mha_qkv_13 -->
<g id="edge1288" class="edge">
<title>layer13_res2_13&#45;&gt;layer14_mha_qkv_13</title>
<path fill="none" stroke="black" d="M14625.5,-2912.74C14625.5,-2891.18 14625.5,-2853.37 14625.5,-2822.29"/>
<polygon fill="black" stroke="black" points="14629,-2822.04 14625.5,-2812.04 14622,-2822.04 14629,-2822.04"/>
</g>
<!-- layer13_mha_attn_14&#45;&gt;layer13_mha_out_14 -->
<g id="edge1213" class="edge">
<title>layer13_mha_attn_14&#45;&gt;layer13_mha_out_14</title>
<path fill="none" stroke="black" d="M16185.5,-3979.74C16185.5,-3958.18 16185.5,-3920.37 16185.5,-3889.29"/>
<polygon fill="black" stroke="black" points="16189,-3889.04 16185.5,-3879.04 16182,-3889.04 16189,-3889.04"/>
</g>
<!-- layer13_ln1_14 -->
<g id="node1128" class="node">
<title>layer13_ln1_14</title>
<polygon fill="none" stroke="black" points="16248,-3542 16123,-3542 16123,-3506 16248,-3506 16248,-3542"/>
<text text-anchor="middle" x="16185.5" y="-3520.3" font-family="Times,serif" font-size="14.00">layer13_ln1_14</text>
</g>
<!-- layer13_res1_14&#45;&gt;layer13_ln1_14 -->
<g id="edge1215" class="edge">
<title>layer13_res1_14&#45;&gt;layer13_ln1_14</title>
<path fill="none" stroke="black" d="M16185.5,-3658.97C16185.5,-3633.03 16185.5,-3583.36 16185.5,-3552.33"/>
<polygon fill="black" stroke="black" points="16189,-3552.2 16185.5,-3542.2 16182,-3552.2 16189,-3552.2"/>
</g>
<!-- layer13_ln1_14&#45;&gt;layer13_ffn_gate_14 -->
<g id="edge1216" class="edge">
<title>layer13_ln1_14&#45;&gt;layer13_ffn_gate_14</title>
<path fill="none" stroke="black" d="M16122.56,-3508.46C16065.02,-3495.17 15976.98,-3474.83 15897.11,-3456.38"/>
<polygon fill="black" stroke="black" points="15897.45,-3452.86 15886.91,-3454.02 15895.87,-3459.68 15897.45,-3452.86"/>
</g>
<!-- layer13_ln1_14&#45;&gt;layer13_ffn_up_14 -->
<g id="edge1217" class="edge">
<title>layer13_ln1_14&#45;&gt;layer13_ffn_up_14</title>
<path fill="none" stroke="black" d="M16188.16,-3505.89C16189.9,-3494.65 16192.28,-3479.31 16194.6,-3464.35"/>
<polygon fill="black" stroke="black" points="16198.12,-3464.54 16196.19,-3454.12 16191.2,-3463.46 16198.12,-3464.54"/>
</g>
<!-- layer13_ffn_act_14&#45;&gt;layer13_ffn_down_14 -->
<g id="edge1220" class="edge">
<title>layer13_ffn_act_14&#45;&gt;layer13_ffn_down_14</title>
<path fill="none" stroke="black" d="M15965.5,-3233.74C15965.5,-3212.18 15965.5,-3174.37 15965.5,-3143.29"/>
<polygon fill="black" stroke="black" points="15969,-3143.04 15965.5,-3133.04 15962,-3143.04 15969,-3143.04"/>
</g>
<!-- layer14_mha_qkv_14 -->
<g id="node1137" class="node">
<title>layer14_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16243.5,-2812 15687.5,-2812 15687.5,-2729 16243.5,-2729 16243.5,-2812"/>
<text text-anchor="middle" x="15965.5" y="-2796.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="15965.5" y="-2781.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15965.5" y="-2766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15965.5" y="-2751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="15965.5" y="-2736.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer13_res2_14&#45;&gt;layer14_mha_qkv_14 -->
<g id="edge1299" class="edge">
<title>layer13_res2_14&#45;&gt;layer14_mha_qkv_14</title>
<path fill="none" stroke="black" d="M15965.5,-2912.74C15965.5,-2891.18 15965.5,-2853.37 15965.5,-2822.29"/>
<polygon fill="black" stroke="black" points="15969,-2822.04 15965.5,-2812.04 15962,-2822.04 15969,-2822.04"/>
</g>
<!-- layer14_mha_attn_8 -->
<g id="node1176" class="node">
<title>layer14_mha_attn_8</title>
<polygon fill="none" stroke="black" points="9917.5,-2467.5 9757.5,-2467.5 9757.5,-2431.5 9917.5,-2431.5 9917.5,-2467.5"/>
<text text-anchor="middle" x="9837.5" y="-2445.8" font-family="Times,serif" font-size="14.00">layer14_mha_attn_8</text>
</g>
<!-- layer14_mha_qkv_8&#45;&gt;layer14_mha_attn_8 -->
<g id="edge1234" class="edge">
<title>layer14_mha_qkv_8&#45;&gt;layer14_mha_attn_8</title>
<path fill="none" stroke="black" d="M9837.5,-2568.18C9837.5,-2539.74 9837.5,-2502.58 9837.5,-2477.7"/>
<polygon fill="black" stroke="black" points="9841,-2477.52 9837.5,-2467.52 9834,-2477.52 9841,-2477.52"/>
</g>
<!-- layer14_mha_attn_9 -->
<g id="node1181" class="node">
<title>layer14_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10775.5,-2628 10615.5,-2628 10615.5,-2592 10775.5,-2592 10775.5,-2628"/>
<text text-anchor="middle" x="10695.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer14_mha_attn_9</text>
</g>
<!-- layer14_mha_qkv_9&#45;&gt;layer14_mha_attn_9 -->
<g id="edge1245" class="edge">
<title>layer14_mha_qkv_9&#45;&gt;layer14_mha_attn_9</title>
<path fill="none" stroke="black" d="M10695.5,-2728.68C10695.5,-2700.24 10695.5,-2663.08 10695.5,-2638.2"/>
<polygon fill="black" stroke="black" points="10699,-2638.02 10695.5,-2628.02 10692,-2638.02 10699,-2638.02"/>
</g>
<!-- layer14_mha_attn_10 -->
<g id="node1186" class="node">
<title>layer14_mha_attn_10</title>
<polygon fill="none" stroke="black" points="11706,-2628 11537,-2628 11537,-2592 11706,-2592 11706,-2628"/>
<text text-anchor="middle" x="11621.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer14_mha_attn_10</text>
</g>
<!-- layer14_mha_qkv_10&#45;&gt;layer14_mha_attn_10 -->
<g id="edge1256" class="edge">
<title>layer14_mha_qkv_10&#45;&gt;layer14_mha_attn_10</title>
<path fill="none" stroke="black" d="M11621.5,-2728.68C11621.5,-2700.24 11621.5,-2663.08 11621.5,-2638.2"/>
<polygon fill="black" stroke="black" points="11625,-2638.02 11621.5,-2628.02 11618,-2638.02 11625,-2638.02"/>
</g>
<!-- layer14_mha_attn_11 -->
<g id="node1191" class="node">
<title>layer14_mha_attn_11</title>
<polygon fill="none" stroke="black" points="12715,-2628 12546,-2628 12546,-2592 12715,-2592 12715,-2628"/>
<text text-anchor="middle" x="12630.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer14_mha_attn_11</text>
</g>
<!-- layer14_mha_qkv_11&#45;&gt;layer14_mha_attn_11 -->
<g id="edge1267" class="edge">
<title>layer14_mha_qkv_11&#45;&gt;layer14_mha_attn_11</title>
<path fill="none" stroke="black" d="M12630.5,-2728.68C12630.5,-2700.24 12630.5,-2663.08 12630.5,-2638.2"/>
<polygon fill="black" stroke="black" points="12634,-2638.02 12630.5,-2628.02 12627,-2638.02 12634,-2638.02"/>
</g>
<!-- layer14_mha_attn_12 -->
<g id="node1196" class="node">
<title>layer14_mha_attn_12</title>
<polygon fill="none" stroke="black" points="13913,-2628 13744,-2628 13744,-2592 13913,-2592 13913,-2628"/>
<text text-anchor="middle" x="13828.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer14_mha_attn_12</text>
</g>
<!-- layer14_mha_qkv_12&#45;&gt;layer14_mha_attn_12 -->
<g id="edge1278" class="edge">
<title>layer14_mha_qkv_12&#45;&gt;layer14_mha_attn_12</title>
<path fill="none" stroke="black" d="M13828.5,-2728.68C13828.5,-2700.24 13828.5,-2663.08 13828.5,-2638.2"/>
<polygon fill="black" stroke="black" points="13832,-2638.02 13828.5,-2628.02 13825,-2638.02 13832,-2638.02"/>
</g>
<!-- layer14_mha_attn_13 -->
<g id="node1201" class="node">
<title>layer14_mha_attn_13</title>
<polygon fill="none" stroke="black" points="14710,-2628 14541,-2628 14541,-2592 14710,-2592 14710,-2628"/>
<text text-anchor="middle" x="14625.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer14_mha_attn_13</text>
</g>
<!-- layer14_mha_qkv_13&#45;&gt;layer14_mha_attn_13 -->
<g id="edge1289" class="edge">
<title>layer14_mha_qkv_13&#45;&gt;layer14_mha_attn_13</title>
<path fill="none" stroke="black" d="M14625.5,-2728.68C14625.5,-2700.24 14625.5,-2663.08 14625.5,-2638.2"/>
<polygon fill="black" stroke="black" points="14629,-2638.02 14625.5,-2628.02 14622,-2638.02 14629,-2638.02"/>
</g>
<!-- layer14_mha_attn_14 -->
<g id="node1206" class="node">
<title>layer14_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16050,-2628 15881,-2628 15881,-2592 16050,-2592 16050,-2628"/>
<text text-anchor="middle" x="15965.5" y="-2606.3" font-family="Times,serif" font-size="14.00">layer14_mha_attn_14</text>
</g>
<!-- layer14_mha_qkv_14&#45;&gt;layer14_mha_attn_14 -->
<g id="edge1300" class="edge">
<title>layer14_mha_qkv_14&#45;&gt;layer14_mha_attn_14</title>
<path fill="none" stroke="black" d="M15965.5,-2728.68C15965.5,-2700.24 15965.5,-2663.08 15965.5,-2638.2"/>
<polygon fill="black" stroke="black" points="15969,-2638.02 15965.5,-2628.02 15962,-2638.02 15969,-2638.02"/>
</g>
<!-- layer14_mha_attn_15 -->
<g id="node1139" class="node">
<title>layer14_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17222.31,-2693 16463.81,-2693 16268.69,-2527 17027.19,-2527 17222.31,-2693"/>
<text text-anchor="middle" x="16745.5" y="-2636.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="16745.5" y="-2621.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="16745.5" y="-2606.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16745.5" y="-2591.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2576.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_mha_qkv_15&#45;&gt;layer14_mha_attn_15 -->
<g id="edge1311" class="edge">
<title>layer14_mha_qkv_15&#45;&gt;layer14_mha_attn_15</title>
<path fill="none" stroke="black" d="M16745.5,-2728.68C16745.5,-2720.75 16745.5,-2712.14 16745.5,-2703.31"/>
<polygon fill="black" stroke="black" points="16749,-2703.27 16745.5,-2693.27 16742,-2703.27 16749,-2703.27"/>
</g>
<!-- layer14_mha_out_15 -->
<g id="node1147" class="node">
<title>layer14_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="16964.5,-2491 16526.5,-2491 16526.5,-2408 16964.5,-2408 16964.5,-2491"/>
<text text-anchor="middle" x="16745.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16745.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16745.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16745.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_mha_attn_15&#45;&gt;layer14_mha_out_15 -->
<g id="edge1312" class="edge">
<title>layer14_mha_attn_15&#45;&gt;layer14_mha_out_15</title>
<path fill="none" stroke="black" d="M16745.5,-2526.96C16745.5,-2518.25 16745.5,-2509.59 16745.5,-2501.39"/>
<polygon fill="black" stroke="black" points="16749,-2501.29 16745.5,-2491.29 16742,-2501.29 16749,-2501.29"/>
</g>
<!-- layer14_mha_out_8 -->
<g id="node1140" class="node">
<title>layer14_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="10056.5,-2330.5 9618.5,-2330.5 9618.5,-2247.5 10056.5,-2247.5 10056.5,-2330.5"/>
<text text-anchor="middle" x="9837.5" y="-2315.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="9837.5" y="-2300.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9837.5" y="-2285.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9837.5" y="-2270.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="9837.5" y="-2255.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_res1_8 -->
<g id="node1177" class="node">
<title>layer14_res1_8</title>
<polygon fill="none" stroke="black" points="9900,-2154 9775,-2154 9775,-2118 9900,-2118 9900,-2154"/>
<text text-anchor="middle" x="9837.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_res1_8</text>
</g>
<!-- layer14_mha_out_8&#45;&gt;layer14_res1_8 -->
<g id="edge1236" class="edge">
<title>layer14_mha_out_8&#45;&gt;layer14_res1_8</title>
<path fill="none" stroke="black" d="M9837.5,-2247.14C9837.5,-2220.9 9837.5,-2187.53 9837.5,-2164.44"/>
<polygon fill="black" stroke="black" points="9841,-2164.31 9837.5,-2154.31 9834,-2164.31 9841,-2164.31"/>
</g>
<!-- layer14_mha_out_9 -->
<g id="node1141" class="node">
<title>layer14_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="10914.5,-2491 10476.5,-2491 10476.5,-2408 10914.5,-2408 10914.5,-2491"/>
<text text-anchor="middle" x="10695.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10695.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10695.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10695.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10695.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_res1_9 -->
<g id="node1182" class="node">
<title>layer14_res1_9</title>
<polygon fill="none" stroke="black" points="10758,-2307 10633,-2307 10633,-2271 10758,-2271 10758,-2307"/>
<text text-anchor="middle" x="10695.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer14_res1_9</text>
</g>
<!-- layer14_mha_out_9&#45;&gt;layer14_res1_9 -->
<g id="edge1247" class="edge">
<title>layer14_mha_out_9&#45;&gt;layer14_res1_9</title>
<path fill="none" stroke="black" d="M10695.5,-2407.68C10695.5,-2379.24 10695.5,-2342.08 10695.5,-2317.2"/>
<polygon fill="black" stroke="black" points="10699,-2317.02 10695.5,-2307.02 10692,-2317.02 10699,-2317.02"/>
</g>
<!-- layer14_mha_out_10 -->
<g id="node1142" class="node">
<title>layer14_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="11840.5,-2491 11402.5,-2491 11402.5,-2408 11840.5,-2408 11840.5,-2491"/>
<text text-anchor="middle" x="11621.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="11621.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11621.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11621.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11621.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_res1_10 -->
<g id="node1187" class="node">
<title>layer14_res1_10</title>
<polygon fill="none" stroke="black" points="11688.5,-2307 11554.5,-2307 11554.5,-2271 11688.5,-2271 11688.5,-2307"/>
<text text-anchor="middle" x="11621.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer14_res1_10</text>
</g>
<!-- layer14_mha_out_10&#45;&gt;layer14_res1_10 -->
<g id="edge1258" class="edge">
<title>layer14_mha_out_10&#45;&gt;layer14_res1_10</title>
<path fill="none" stroke="black" d="M11621.5,-2407.68C11621.5,-2379.24 11621.5,-2342.08 11621.5,-2317.2"/>
<polygon fill="black" stroke="black" points="11625,-2317.02 11621.5,-2307.02 11618,-2317.02 11625,-2317.02"/>
</g>
<!-- layer14_mha_out_11 -->
<g id="node1143" class="node">
<title>layer14_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="12849.5,-2491 12411.5,-2491 12411.5,-2408 12849.5,-2408 12849.5,-2491"/>
<text text-anchor="middle" x="12630.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12630.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12630.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12630.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12630.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_res1_11 -->
<g id="node1192" class="node">
<title>layer14_res1_11</title>
<polygon fill="none" stroke="black" points="12697.5,-2307 12563.5,-2307 12563.5,-2271 12697.5,-2271 12697.5,-2307"/>
<text text-anchor="middle" x="12630.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer14_res1_11</text>
</g>
<!-- layer14_mha_out_11&#45;&gt;layer14_res1_11 -->
<g id="edge1269" class="edge">
<title>layer14_mha_out_11&#45;&gt;layer14_res1_11</title>
<path fill="none" stroke="black" d="M12630.5,-2407.68C12630.5,-2379.24 12630.5,-2342.08 12630.5,-2317.2"/>
<polygon fill="black" stroke="black" points="12634,-2317.02 12630.5,-2307.02 12627,-2317.02 12634,-2317.02"/>
</g>
<!-- layer14_mha_out_12 -->
<g id="node1144" class="node">
<title>layer14_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14047.5,-2491 13609.5,-2491 13609.5,-2408 14047.5,-2408 14047.5,-2491"/>
<text text-anchor="middle" x="13828.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="13828.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13828.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13828.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13828.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_res1_12 -->
<g id="node1197" class="node">
<title>layer14_res1_12</title>
<polygon fill="none" stroke="black" points="13895.5,-2307 13761.5,-2307 13761.5,-2271 13895.5,-2271 13895.5,-2307"/>
<text text-anchor="middle" x="13828.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer14_res1_12</text>
</g>
<!-- layer14_mha_out_12&#45;&gt;layer14_res1_12 -->
<g id="edge1280" class="edge">
<title>layer14_mha_out_12&#45;&gt;layer14_res1_12</title>
<path fill="none" stroke="black" d="M13828.5,-2407.68C13828.5,-2379.24 13828.5,-2342.08 13828.5,-2317.2"/>
<polygon fill="black" stroke="black" points="13832,-2317.02 13828.5,-2307.02 13825,-2317.02 13832,-2317.02"/>
</g>
<!-- layer14_mha_out_13 -->
<g id="node1145" class="node">
<title>layer14_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="14844.5,-2491 14406.5,-2491 14406.5,-2408 14844.5,-2408 14844.5,-2491"/>
<text text-anchor="middle" x="14625.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14625.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14625.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14625.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14625.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_res1_13 -->
<g id="node1202" class="node">
<title>layer14_res1_13</title>
<polygon fill="none" stroke="black" points="14692.5,-2307 14558.5,-2307 14558.5,-2271 14692.5,-2271 14692.5,-2307"/>
<text text-anchor="middle" x="14625.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer14_res1_13</text>
</g>
<!-- layer14_mha_out_13&#45;&gt;layer14_res1_13 -->
<g id="edge1291" class="edge">
<title>layer14_mha_out_13&#45;&gt;layer14_res1_13</title>
<path fill="none" stroke="black" d="M14625.5,-2407.68C14625.5,-2379.24 14625.5,-2342.08 14625.5,-2317.2"/>
<polygon fill="black" stroke="black" points="14629,-2317.02 14625.5,-2307.02 14622,-2317.02 14629,-2317.02"/>
</g>
<!-- layer14_mha_out_14 -->
<g id="node1146" class="node">
<title>layer14_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16184.5,-2491 15746.5,-2491 15746.5,-2408 16184.5,-2408 16184.5,-2491"/>
<text text-anchor="middle" x="15965.5" y="-2475.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="15965.5" y="-2460.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15965.5" y="-2445.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15965.5" y="-2430.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15965.5" y="-2415.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_res1_14 -->
<g id="node1207" class="node">
<title>layer14_res1_14</title>
<polygon fill="none" stroke="black" points="16032.5,-2307 15898.5,-2307 15898.5,-2271 16032.5,-2271 16032.5,-2307"/>
<text text-anchor="middle" x="15965.5" y="-2285.3" font-family="Times,serif" font-size="14.00">layer14_res1_14</text>
</g>
<!-- layer14_mha_out_14&#45;&gt;layer14_res1_14 -->
<g id="edge1302" class="edge">
<title>layer14_mha_out_14&#45;&gt;layer14_res1_14</title>
<path fill="none" stroke="black" d="M15965.5,-2407.68C15965.5,-2379.24 15965.5,-2342.08 15965.5,-2317.2"/>
<polygon fill="black" stroke="black" points="15969,-2317.02 15965.5,-2307.02 15962,-2317.02 15969,-2317.02"/>
</g>
<!-- layer14_res1_15 -->
<g id="node1148" class="node">
<title>layer14_res1_15</title>
<polygon fill="none" stroke="black" points="17186.24,-2372 16485.12,-2372 16304.76,-2206 17005.88,-2206 17186.24,-2372"/>
<text text-anchor="middle" x="16745.5" y="-2315.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16745.5" y="-2300.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2285.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2270.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2255.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_mha_out_15&#45;&gt;layer14_res1_15 -->
<g id="edge1313" class="edge">
<title>layer14_mha_out_15&#45;&gt;layer14_res1_15</title>
<path fill="none" stroke="black" d="M16745.5,-2407.68C16745.5,-2399.75 16745.5,-2391.14 16745.5,-2382.31"/>
<polygon fill="black" stroke="black" points="16749,-2382.27 16745.5,-2372.27 16742,-2382.27 16749,-2382.27"/>
</g>
<!-- layer14_ln1_15 -->
<g id="node1149" class="node">
<title>layer14_ln1_15</title>
<polygon fill="yellow" stroke="black" points="16958,-2170 16533,-2170 16533,-2102 16958,-2102 16958,-2170"/>
<text text-anchor="middle" x="16745.5" y="-2154.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="16745.5" y="-2139.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2124.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16745.5" y="-2109.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_res1_15&#45;&gt;layer14_ln1_15 -->
<g id="edge1314" class="edge">
<title>layer14_res1_15&#45;&gt;layer14_ln1_15</title>
<path fill="none" stroke="black" d="M16745.5,-2205.87C16745.5,-2197.12 16745.5,-2188.48 16745.5,-2180.45"/>
<polygon fill="black" stroke="black" points="16749,-2180.26 16745.5,-2170.26 16742,-2180.26 16749,-2180.26"/>
</g>
<!-- layer14_ffn_gate_15 -->
<g id="node1157" class="node">
<title>layer14_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="16910,-2066 16437,-2066 16437,-1983 16910,-1983 16910,-2066"/>
<text text-anchor="middle" x="16673.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16673.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16673.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16673.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16673.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_ln1_15&#45;&gt;layer14_ffn_gate_15 -->
<g id="edge1315" class="edge">
<title>layer14_ln1_15&#45;&gt;layer14_ffn_gate_15</title>
<path fill="none" stroke="black" d="M16723.7,-2101.85C16718.06,-2093.27 16711.87,-2083.85 16705.81,-2074.64"/>
<polygon fill="black" stroke="black" points="16708.73,-2072.71 16700.31,-2066.28 16702.88,-2076.56 16708.73,-2072.71"/>
</g>
<!-- layer14_ffn_up_15 -->
<g id="node1165" class="node">
<title>layer14_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17401,-2066 16928,-2066 16928,-1983 17401,-1983 17401,-2066"/>
<text text-anchor="middle" x="17164.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17164.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17164.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17164.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17164.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_ln1_15&#45;&gt;layer14_ffn_up_15 -->
<g id="edge1316" class="edge">
<title>layer14_ln1_15&#45;&gt;layer14_ffn_up_15</title>
<path fill="none" stroke="black" d="M16871.78,-2102C16911.91,-2091.51 16956.9,-2079.75 16999.34,-2068.66"/>
<polygon fill="black" stroke="black" points="17000.42,-2072 17009.21,-2066.08 16998.65,-2065.22 17000.42,-2072"/>
</g>
<!-- layer14_ffn_gate_8 -->
<g id="node1150" class="node">
<title>layer14_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="10064,-1905.5 9591,-1905.5 9591,-1822.5 10064,-1822.5 10064,-1905.5"/>
<text text-anchor="middle" x="9827.5" y="-1890.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9827.5" y="-1875.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9827.5" y="-1860.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9827.5" y="-1845.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9827.5" y="-1830.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_ffn_act_8 -->
<g id="node1179" class="node">
<title>layer14_ffn_act_8</title>
<polygon fill="none" stroke="black" points="10387.5,-1721.5 10247.5,-1721.5 10247.5,-1685.5 10387.5,-1685.5 10387.5,-1721.5"/>
<text text-anchor="middle" x="10317.5" y="-1699.8" font-family="Times,serif" font-size="14.00">layer14_ffn_act_8</text>
</g>
<!-- layer14_ffn_gate_8&#45;&gt;layer14_ffn_act_8 -->
<g id="edge1240" class="edge">
<title>layer14_ffn_gate_8&#45;&gt;layer14_ffn_act_8</title>
<path fill="none" stroke="black" d="M9946.97,-1822.47C9986.83,-1809.1 10031.53,-1794.25 10072.5,-1781 10133.12,-1761.4 10202.44,-1739.83 10251.84,-1724.61"/>
<polygon fill="black" stroke="black" points="10252.92,-1727.94 10261.45,-1721.65 10250.86,-1721.25 10252.92,-1727.94"/>
</g>
<!-- layer14_ffn_gate_9 -->
<g id="node1151" class="node">
<title>layer14_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10445,-2066 9972,-2066 9972,-1983 10445,-1983 10445,-2066"/>
<text text-anchor="middle" x="10208.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10208.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10208.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10208.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10208.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_ffn_act_9 -->
<g id="node1184" class="node">
<title>layer14_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10767.5,-1882 10627.5,-1882 10627.5,-1846 10767.5,-1846 10767.5,-1882"/>
<text text-anchor="middle" x="10697.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer14_ffn_act_9</text>
</g>
<!-- layer14_ffn_gate_9&#45;&gt;layer14_ffn_act_9 -->
<g id="edge1251" class="edge">
<title>layer14_ffn_gate_9&#45;&gt;layer14_ffn_act_9</title>
<path fill="none" stroke="black" d="M10445.29,-1984.14C10485.44,-1974.17 10526.19,-1961.93 10563.5,-1947 10601.26,-1931.89 10640.51,-1906.55 10666.69,-1888.03"/>
<polygon fill="black" stroke="black" points="10668.96,-1890.71 10675.04,-1882.04 10664.88,-1885.02 10668.96,-1890.71"/>
</g>
<!-- layer14_ffn_gate_10 -->
<g id="node1152" class="node">
<title>layer14_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11857,-2066 11384,-2066 11384,-1983 11857,-1983 11857,-2066"/>
<text text-anchor="middle" x="11620.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11620.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11620.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11620.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11620.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_ffn_act_10 -->
<g id="node1189" class="node">
<title>layer14_ffn_act_10</title>
<polygon fill="none" stroke="black" points="11696,-1882 11547,-1882 11547,-1846 11696,-1846 11696,-1882"/>
<text text-anchor="middle" x="11621.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer14_ffn_act_10</text>
</g>
<!-- layer14_ffn_gate_10&#45;&gt;layer14_ffn_act_10 -->
<g id="edge1262" class="edge">
<title>layer14_ffn_gate_10&#45;&gt;layer14_ffn_act_10</title>
<path fill="none" stroke="black" d="M11620.76,-1982.68C11620.94,-1954.24 11621.17,-1917.08 11621.33,-1892.2"/>
<polygon fill="black" stroke="black" points="11624.83,-1892.05 11621.39,-1882.02 11617.83,-1892 11624.83,-1892.05"/>
</g>
<!-- layer14_ffn_gate_11 -->
<g id="node1153" class="node">
<title>layer14_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="12859,-2066 12386,-2066 12386,-1983 12859,-1983 12859,-2066"/>
<text text-anchor="middle" x="12622.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12622.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12622.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12622.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12622.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_ffn_act_11 -->
<g id="node1194" class="node">
<title>layer14_ffn_act_11</title>
<polygon fill="none" stroke="black" points="12953,-1882 12804,-1882 12804,-1846 12953,-1846 12953,-1882"/>
<text text-anchor="middle" x="12878.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer14_ffn_act_11</text>
</g>
<!-- layer14_ffn_gate_11&#45;&gt;layer14_ffn_act_11 -->
<g id="edge1273" class="edge">
<title>layer14_ffn_gate_11&#45;&gt;layer14_ffn_act_11</title>
<path fill="none" stroke="black" d="M12688.09,-1982.89C12737.12,-1952.53 12802.33,-1912.16 12842.31,-1887.41"/>
<polygon fill="black" stroke="black" points="12844.27,-1890.31 12850.93,-1882.07 12840.59,-1884.36 12844.27,-1890.31"/>
</g>
<!-- layer14_ffn_gate_12 -->
<g id="node1154" class="node">
<title>layer14_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="13861,-2066 13388,-2066 13388,-1983 13861,-1983 13861,-2066"/>
<text text-anchor="middle" x="13624.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13624.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13624.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13624.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13624.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_ffn_act_12 -->
<g id="node1199" class="node">
<title>layer14_ffn_act_12</title>
<polygon fill="none" stroke="black" points="14059,-1882 13910,-1882 13910,-1846 14059,-1846 14059,-1882"/>
<text text-anchor="middle" x="13984.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer14_ffn_act_12</text>
</g>
<!-- layer14_ffn_gate_12&#45;&gt;layer14_ffn_act_12 -->
<g id="edge1284" class="edge">
<title>layer14_ffn_gate_12&#45;&gt;layer14_ffn_act_12</title>
<path fill="none" stroke="black" d="M13716.74,-1982.89C13786.85,-1952.02 13880.47,-1910.8 13936.41,-1886.17"/>
<polygon fill="black" stroke="black" points="13937.99,-1889.3 13945.73,-1882.07 13935.17,-1882.9 13937.99,-1889.3"/>
</g>
<!-- layer14_ffn_gate_13 -->
<g id="node1155" class="node">
<title>layer14_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="14843,-2066 14370,-2066 14370,-1983 14843,-1983 14843,-2066"/>
<text text-anchor="middle" x="14606.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14606.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14606.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14606.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14606.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_ffn_act_13 -->
<g id="node1204" class="node">
<title>layer14_ffn_act_13</title>
<polygon fill="none" stroke="black" points="14842,-1882 14693,-1882 14693,-1846 14842,-1846 14842,-1882"/>
<text text-anchor="middle" x="14767.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer14_ffn_act_13</text>
</g>
<!-- layer14_ffn_gate_13&#45;&gt;layer14_ffn_act_13 -->
<g id="edge1295" class="edge">
<title>layer14_ffn_gate_13&#45;&gt;layer14_ffn_act_13</title>
<path fill="none" stroke="black" d="M14647.96,-1982.68C14678.02,-1953.09 14717.66,-1914.06 14742.87,-1889.24"/>
<polygon fill="black" stroke="black" points="14745.54,-1891.53 14750.21,-1882.02 14740.63,-1886.54 14745.54,-1891.53"/>
</g>
<!-- layer14_ffn_gate_14 -->
<g id="node1156" class="node">
<title>layer14_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="15897,-2066 15424,-2066 15424,-1983 15897,-1983 15897,-2066"/>
<text text-anchor="middle" x="15660.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15660.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15660.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15660.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15660.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_ffn_act_14 -->
<g id="node1209" class="node">
<title>layer14_ffn_act_14</title>
<polygon fill="none" stroke="black" points="16109,-1882 15960,-1882 15960,-1846 16109,-1846 16109,-1882"/>
<text text-anchor="middle" x="16034.5" y="-1860.3" font-family="Times,serif" font-size="14.00">layer14_ffn_act_14</text>
</g>
<!-- layer14_ffn_gate_14&#45;&gt;layer14_ffn_act_14 -->
<g id="edge1306" class="edge">
<title>layer14_ffn_gate_14&#45;&gt;layer14_ffn_act_14</title>
<path fill="none" stroke="black" d="M15756.33,-1982.89C15829.31,-1951.96 15926.83,-1910.63 15984.9,-1886.02"/>
<polygon fill="black" stroke="black" points="15986.38,-1889.19 15994.22,-1882.07 15983.65,-1882.75 15986.38,-1889.19"/>
</g>
<!-- layer14_ffn_act_15 -->
<g id="node1166" class="node">
<title>layer14_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17290.24,-1947 16533.44,-1947 16338.76,-1781 17095.56,-1781 17290.24,-1947"/>
<text text-anchor="middle" x="16814.5" y="-1890.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="16814.5" y="-1875.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="16814.5" y="-1860.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16814.5" y="-1845.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16814.5" y="-1830.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_ffn_gate_15&#45;&gt;layer14_ffn_act_15 -->
<g id="edge1317" class="edge">
<title>layer14_ffn_gate_15&#45;&gt;layer14_ffn_act_15</title>
<path fill="none" stroke="black" d="M16709.81,-1982.68C16717.47,-1974.07 16725.85,-1964.66 16734.41,-1955.03"/>
<polygon fill="black" stroke="black" points="16737.28,-1957.07 16741.31,-1947.27 16732.05,-1952.42 16737.28,-1957.07"/>
</g>
<!-- layer14_ffn_up_8 -->
<g id="node1158" class="node">
<title>layer14_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10555,-1905.5 10082,-1905.5 10082,-1822.5 10555,-1822.5 10555,-1905.5"/>
<text text-anchor="middle" x="10318.5" y="-1890.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10318.5" y="-1875.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10318.5" y="-1860.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10318.5" y="-1845.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10318.5" y="-1830.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_ffn_up_8&#45;&gt;layer14_ffn_act_8 -->
<g id="edge1241" class="edge">
<title>layer14_ffn_up_8&#45;&gt;layer14_ffn_act_8</title>
<path fill="none" stroke="black" d="M10318.24,-1822.18C10318.06,-1793.74 10317.83,-1756.58 10317.67,-1731.7"/>
<polygon fill="black" stroke="black" points="10321.17,-1731.5 10317.61,-1721.52 10314.17,-1731.55 10321.17,-1731.5"/>
</g>
<!-- layer14_ffn_up_9 -->
<g id="node1159" class="node">
<title>layer14_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="10936,-2066 10463,-2066 10463,-1983 10936,-1983 10936,-2066"/>
<text text-anchor="middle" x="10699.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10699.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10699.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10699.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10699.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_ffn_up_9&#45;&gt;layer14_ffn_act_9 -->
<g id="edge1252" class="edge">
<title>layer14_ffn_up_9&#45;&gt;layer14_ffn_act_9</title>
<path fill="none" stroke="black" d="M10698.98,-1982.68C10698.63,-1954.24 10698.16,-1917.08 10697.84,-1892.2"/>
<polygon fill="black" stroke="black" points="10701.34,-1891.98 10697.71,-1882.02 10694.34,-1892.07 10701.34,-1891.98"/>
</g>
<!-- layer14_ffn_up_10 -->
<g id="node1160" class="node">
<title>layer14_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12348,-2066 11875,-2066 11875,-1983 12348,-1983 12348,-2066"/>
<text text-anchor="middle" x="12111.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12111.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12111.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12111.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12111.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_ffn_up_10&#45;&gt;layer14_ffn_act_10 -->
<g id="edge1263" class="edge">
<title>layer14_ffn_up_10&#45;&gt;layer14_ffn_act_10</title>
<path fill="none" stroke="black" d="M11986.27,-1982.99C11889.66,-1951.74 11760.1,-1909.83 11684.23,-1885.29"/>
<polygon fill="black" stroke="black" points="11684.93,-1881.84 11674.34,-1882.09 11682.78,-1888.5 11684.93,-1881.84"/>
</g>
<!-- layer14_ffn_up_11 -->
<g id="node1161" class="node">
<title>layer14_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13350,-2066 12877,-2066 12877,-1983 13350,-1983 13350,-2066"/>
<text text-anchor="middle" x="13113.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13113.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13113.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13113.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13113.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_ffn_up_11&#45;&gt;layer14_ffn_act_11 -->
<g id="edge1274" class="edge">
<title>layer14_ffn_up_11&#45;&gt;layer14_ffn_act_11</title>
<path fill="none" stroke="black" d="M13053.29,-1982.89C13008.47,-1952.66 12948.92,-1912.5 12912.18,-1887.72"/>
<polygon fill="black" stroke="black" points="12914.06,-1884.76 12903.81,-1882.07 12910.14,-1890.56 12914.06,-1884.76"/>
</g>
<!-- layer14_ffn_up_12 -->
<g id="node1162" class="node">
<title>layer14_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14352,-2066 13879,-2066 13879,-1983 14352,-1983 14352,-2066"/>
<text text-anchor="middle" x="14115.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14115.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14115.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14115.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14115.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_ffn_up_12&#45;&gt;layer14_ffn_act_12 -->
<g id="edge1285" class="edge">
<title>layer14_ffn_up_12&#45;&gt;layer14_ffn_act_12</title>
<path fill="none" stroke="black" d="M14081.76,-1982.68C14057.52,-1953.35 14025.61,-1914.74 14005.07,-1889.89"/>
<polygon fill="black" stroke="black" points="14007.64,-1887.5 13998.57,-1882.02 14002.24,-1891.96 14007.64,-1887.5"/>
</g>
<!-- layer14_ffn_up_13 -->
<g id="node1163" class="node">
<title>layer14_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15334,-2066 14861,-2066 14861,-1983 15334,-1983 15334,-2066"/>
<text text-anchor="middle" x="15097.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15097.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15097.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15097.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15097.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_ffn_up_13&#45;&gt;layer14_ffn_act_13 -->
<g id="edge1296" class="edge">
<title>layer14_ffn_up_13&#45;&gt;layer14_ffn_act_13</title>
<path fill="none" stroke="black" d="M15012.95,-1982.89C14948.95,-1952.15 14863.57,-1911.14 14812.22,-1886.48"/>
<polygon fill="black" stroke="black" points="14813.57,-1883.24 14803.04,-1882.07 14810.54,-1889.55 14813.57,-1883.24"/>
</g>
<!-- layer14_ffn_up_14 -->
<g id="node1164" class="node">
<title>layer14_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16388,-2066 15915,-2066 15915,-1983 16388,-1983 16388,-2066"/>
<text text-anchor="middle" x="16151.5" y="-2050.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16151.5" y="-2035.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16151.5" y="-2020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16151.5" y="-2005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16151.5" y="-1990.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_ffn_up_14&#45;&gt;layer14_ffn_act_14 -->
<g id="edge1307" class="edge">
<title>layer14_ffn_up_14&#45;&gt;layer14_ffn_act_14</title>
<path fill="none" stroke="black" d="M16121.37,-1982.68C16099.81,-1953.47 16071.46,-1915.07 16053.11,-1890.21"/>
<polygon fill="black" stroke="black" points="16055.82,-1887.99 16047.07,-1882.02 16050.19,-1892.15 16055.82,-1887.99"/>
</g>
<!-- layer14_ffn_up_15&#45;&gt;layer14_ffn_act_15 -->
<g id="edge1318" class="edge">
<title>layer14_ffn_up_15&#45;&gt;layer14_ffn_act_15</title>
<path fill="none" stroke="black" d="M17074.82,-1982.89C17053.27,-1973.13 17029.43,-1962.33 17005.19,-1951.36"/>
<polygon fill="black" stroke="black" points="17006.44,-1948.08 16995.88,-1947.14 17003.55,-1954.45 17006.44,-1948.08"/>
</g>
<!-- layer14_ffn_down_15 -->
<g id="node1174" class="node">
<title>layer14_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17038,-1745 16591,-1745 16591,-1662 17038,-1662 17038,-1745"/>
<text text-anchor="middle" x="16814.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16814.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16814.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16814.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16814.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_ffn_act_15&#45;&gt;layer14_ffn_down_15 -->
<g id="edge1319" class="edge">
<title>layer14_ffn_act_15&#45;&gt;layer14_ffn_down_15</title>
<path fill="none" stroke="black" d="M16814.5,-1780.96C16814.5,-1772.25 16814.5,-1763.59 16814.5,-1755.39"/>
<polygon fill="black" stroke="black" points="16818,-1755.29 16814.5,-1745.29 16811,-1755.29 16818,-1755.29"/>
</g>
<!-- layer14_ffn_down_8 -->
<g id="node1167" class="node">
<title>layer14_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="10541,-1584.5 10094,-1584.5 10094,-1501.5 10541,-1501.5 10541,-1584.5"/>
<text text-anchor="middle" x="10317.5" y="-1569.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10317.5" y="-1554.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10317.5" y="-1539.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10317.5" y="-1524.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10317.5" y="-1509.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_res2_8 -->
<g id="node1180" class="node">
<title>layer14_res2_8</title>
<polygon fill="none" stroke="black" points="10380,-1400.5 10255,-1400.5 10255,-1364.5 10380,-1364.5 10380,-1400.5"/>
<text text-anchor="middle" x="10317.5" y="-1378.8" font-family="Times,serif" font-size="14.00">layer14_res2_8</text>
</g>
<!-- layer14_ffn_down_8&#45;&gt;layer14_res2_8 -->
<g id="edge1243" class="edge">
<title>layer14_ffn_down_8&#45;&gt;layer14_res2_8</title>
<path fill="none" stroke="black" d="M10317.5,-1501.18C10317.5,-1472.74 10317.5,-1435.58 10317.5,-1410.7"/>
<polygon fill="black" stroke="black" points="10321,-1410.52 10317.5,-1400.52 10314,-1410.52 10321,-1410.52"/>
</g>
<!-- layer14_ffn_down_9 -->
<g id="node1168" class="node">
<title>layer14_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="10921,-1745 10474,-1745 10474,-1662 10921,-1662 10921,-1745"/>
<text text-anchor="middle" x="10697.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10697.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10697.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10697.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10697.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_res2_9 -->
<g id="node1185" class="node">
<title>layer14_res2_9</title>
<polygon fill="none" stroke="black" points="10760,-1561 10635,-1561 10635,-1525 10760,-1525 10760,-1561"/>
<text text-anchor="middle" x="10697.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer14_res2_9</text>
</g>
<!-- layer14_ffn_down_9&#45;&gt;layer14_res2_9 -->
<g id="edge1254" class="edge">
<title>layer14_ffn_down_9&#45;&gt;layer14_res2_9</title>
<path fill="none" stroke="black" d="M10697.5,-1661.68C10697.5,-1633.24 10697.5,-1596.08 10697.5,-1571.2"/>
<polygon fill="black" stroke="black" points="10701,-1571.02 10697.5,-1561.02 10694,-1571.02 10701,-1571.02"/>
</g>
<!-- layer14_ffn_down_10 -->
<g id="node1169" class="node">
<title>layer14_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="11845,-1745 11398,-1745 11398,-1662 11845,-1662 11845,-1745"/>
<text text-anchor="middle" x="11621.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11621.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11621.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11621.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11621.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_res2_10 -->
<g id="node1190" class="node">
<title>layer14_res2_10</title>
<polygon fill="none" stroke="black" points="11688.5,-1561 11554.5,-1561 11554.5,-1525 11688.5,-1525 11688.5,-1561"/>
<text text-anchor="middle" x="11621.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer14_res2_10</text>
</g>
<!-- layer14_ffn_down_10&#45;&gt;layer14_res2_10 -->
<g id="edge1265" class="edge">
<title>layer14_ffn_down_10&#45;&gt;layer14_res2_10</title>
<path fill="none" stroke="black" d="M11621.5,-1661.68C11621.5,-1633.24 11621.5,-1596.08 11621.5,-1571.2"/>
<polygon fill="black" stroke="black" points="11625,-1571.02 11621.5,-1561.02 11618,-1571.02 11625,-1571.02"/>
</g>
<!-- layer14_ffn_down_11 -->
<g id="node1170" class="node">
<title>layer14_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="13102,-1745 12655,-1745 12655,-1662 13102,-1662 13102,-1745"/>
<text text-anchor="middle" x="12878.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12878.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12878.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12878.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12878.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_res2_11 -->
<g id="node1195" class="node">
<title>layer14_res2_11</title>
<polygon fill="none" stroke="black" points="12945.5,-1561 12811.5,-1561 12811.5,-1525 12945.5,-1525 12945.5,-1561"/>
<text text-anchor="middle" x="12878.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer14_res2_11</text>
</g>
<!-- layer14_ffn_down_11&#45;&gt;layer14_res2_11 -->
<g id="edge1276" class="edge">
<title>layer14_ffn_down_11&#45;&gt;layer14_res2_11</title>
<path fill="none" stroke="black" d="M12878.5,-1661.68C12878.5,-1633.24 12878.5,-1596.08 12878.5,-1571.2"/>
<polygon fill="black" stroke="black" points="12882,-1571.02 12878.5,-1561.02 12875,-1571.02 12882,-1571.02"/>
</g>
<!-- layer14_ffn_down_12 -->
<g id="node1171" class="node">
<title>layer14_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14208,-1745 13761,-1745 13761,-1662 14208,-1662 14208,-1745"/>
<text text-anchor="middle" x="13984.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13984.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13984.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13984.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13984.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_res2_12 -->
<g id="node1200" class="node">
<title>layer14_res2_12</title>
<polygon fill="none" stroke="black" points="14051.5,-1561 13917.5,-1561 13917.5,-1525 14051.5,-1525 14051.5,-1561"/>
<text text-anchor="middle" x="13984.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer14_res2_12</text>
</g>
<!-- layer14_ffn_down_12&#45;&gt;layer14_res2_12 -->
<g id="edge1287" class="edge">
<title>layer14_ffn_down_12&#45;&gt;layer14_res2_12</title>
<path fill="none" stroke="black" d="M13984.5,-1661.68C13984.5,-1633.24 13984.5,-1596.08 13984.5,-1571.2"/>
<polygon fill="black" stroke="black" points="13988,-1571.02 13984.5,-1561.02 13981,-1571.02 13988,-1571.02"/>
</g>
<!-- layer14_ffn_down_13 -->
<g id="node1172" class="node">
<title>layer14_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="14991,-1745 14544,-1745 14544,-1662 14991,-1662 14991,-1745"/>
<text text-anchor="middle" x="14767.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14767.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14767.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14767.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14767.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_res2_13 -->
<g id="node1205" class="node">
<title>layer14_res2_13</title>
<polygon fill="none" stroke="black" points="14834.5,-1561 14700.5,-1561 14700.5,-1525 14834.5,-1525 14834.5,-1561"/>
<text text-anchor="middle" x="14767.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer14_res2_13</text>
</g>
<!-- layer14_ffn_down_13&#45;&gt;layer14_res2_13 -->
<g id="edge1298" class="edge">
<title>layer14_ffn_down_13&#45;&gt;layer14_res2_13</title>
<path fill="none" stroke="black" d="M14767.5,-1661.68C14767.5,-1633.24 14767.5,-1596.08 14767.5,-1571.2"/>
<polygon fill="black" stroke="black" points="14771,-1571.02 14767.5,-1561.02 14764,-1571.02 14771,-1571.02"/>
</g>
<!-- layer14_ffn_down_14 -->
<g id="node1173" class="node">
<title>layer14_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16258,-1745 15811,-1745 15811,-1662 16258,-1662 16258,-1745"/>
<text text-anchor="middle" x="16034.5" y="-1729.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16034.5" y="-1714.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16034.5" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16034.5" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16034.5" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_res2_14 -->
<g id="node1210" class="node">
<title>layer14_res2_14</title>
<polygon fill="none" stroke="black" points="16101.5,-1561 15967.5,-1561 15967.5,-1525 16101.5,-1525 16101.5,-1561"/>
<text text-anchor="middle" x="16034.5" y="-1539.3" font-family="Times,serif" font-size="14.00">layer14_res2_14</text>
</g>
<!-- layer14_ffn_down_14&#45;&gt;layer14_res2_14 -->
<g id="edge1309" class="edge">
<title>layer14_ffn_down_14&#45;&gt;layer14_res2_14</title>
<path fill="none" stroke="black" d="M16034.5,-1661.68C16034.5,-1633.24 16034.5,-1596.08 16034.5,-1571.2"/>
<polygon fill="black" stroke="black" points="16038,-1571.02 16034.5,-1561.02 16031,-1571.02 16038,-1571.02"/>
</g>
<!-- layer14_res2_15 -->
<g id="node1175" class="node">
<title>layer14_res2_15</title>
<polygon fill="none" stroke="black" points="17255.24,-1626 16554.12,-1626 16373.76,-1460 17074.88,-1460 17255.24,-1626"/>
<text text-anchor="middle" x="16814.5" y="-1569.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16814.5" y="-1554.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-1539.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-1524.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-1509.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer14_ffn_down_15&#45;&gt;layer14_res2_15 -->
<g id="edge1320" class="edge">
<title>layer14_ffn_down_15&#45;&gt;layer14_res2_15</title>
<path fill="none" stroke="black" d="M16814.5,-1661.68C16814.5,-1653.75 16814.5,-1645.14 16814.5,-1636.31"/>
<polygon fill="black" stroke="black" points="16818,-1636.27 16814.5,-1626.27 16811,-1636.27 16818,-1636.27"/>
</g>
<!-- layer15_mha_qkv_15 -->
<g id="node1218" class="node">
<title>layer15_mha_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="17092.5,-1424 16536.5,-1424 16536.5,-1341 17092.5,-1341 17092.5,-1424"/>
<text text-anchor="middle" x="16814.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16814.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16814.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16814.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer14_res2_15&#45;&gt;layer15_mha_qkv_15 -->
<g id="edge1398" class="edge">
<title>layer14_res2_15&#45;&gt;layer15_mha_qkv_15</title>
<path fill="none" stroke="black" d="M16814.5,-1459.96C16814.5,-1451.25 16814.5,-1442.59 16814.5,-1434.39"/>
<polygon fill="black" stroke="black" points="16818,-1434.29 16814.5,-1424.29 16811,-1434.29 16818,-1434.29"/>
</g>
<!-- layer14_mha_attn_8&#45;&gt;layer14_mha_out_8 -->
<g id="edge1235" class="edge">
<title>layer14_mha_attn_8&#45;&gt;layer14_mha_out_8</title>
<path fill="none" stroke="black" d="M9837.5,-2431.24C9837.5,-2409.68 9837.5,-2371.87 9837.5,-2340.79"/>
<polygon fill="black" stroke="black" points="9841,-2340.54 9837.5,-2330.54 9834,-2340.54 9841,-2340.54"/>
</g>
<!-- layer14_ln1_8 -->
<g id="node1178" class="node">
<title>layer14_ln1_8</title>
<polygon fill="none" stroke="black" points="9895.5,-2042.5 9779.5,-2042.5 9779.5,-2006.5 9895.5,-2006.5 9895.5,-2042.5"/>
<text text-anchor="middle" x="9837.5" y="-2020.8" font-family="Times,serif" font-size="14.00">layer14_ln1_8</text>
</g>
<!-- layer14_res1_8&#45;&gt;layer14_ln1_8 -->
<g id="edge1237" class="edge">
<title>layer14_res1_8&#45;&gt;layer14_ln1_8</title>
<path fill="none" stroke="black" d="M9837.5,-2117.89C9837.5,-2100.56 9837.5,-2073.46 9837.5,-2053.09"/>
<polygon fill="black" stroke="black" points="9841,-2052.85 9837.5,-2042.85 9834,-2052.85 9841,-2052.85"/>
</g>
<!-- layer14_ln1_8&#45;&gt;layer14_ffn_gate_8 -->
<g id="edge1238" class="edge">
<title>layer14_ln1_8&#45;&gt;layer14_ffn_gate_8</title>
<path fill="none" stroke="black" d="M9836.41,-2006.24C9835.05,-1984.68 9832.67,-1946.87 9830.7,-1915.79"/>
<polygon fill="black" stroke="black" points="9834.18,-1915.3 9830.06,-1905.54 9827.19,-1915.74 9834.18,-1915.3"/>
</g>
<!-- layer14_ln1_8&#45;&gt;layer14_ffn_up_8 -->
<g id="edge1239" class="edge">
<title>layer14_ln1_8&#45;&gt;layer14_ffn_up_8</title>
<path fill="none" stroke="black" d="M9890.27,-2006.44C9937.92,-1991.01 10009.95,-1967.61 10072.5,-1947 10109.89,-1934.68 10150.43,-1921.22 10187.62,-1908.82"/>
<polygon fill="black" stroke="black" points="10189.12,-1912.01 10197.5,-1905.52 10186.91,-1905.37 10189.12,-1912.01"/>
</g>
<!-- layer14_ffn_act_8&#45;&gt;layer14_ffn_down_8 -->
<g id="edge1242" class="edge">
<title>layer14_ffn_act_8&#45;&gt;layer14_ffn_down_8</title>
<path fill="none" stroke="black" d="M10317.5,-1685.24C10317.5,-1663.68 10317.5,-1625.87 10317.5,-1594.79"/>
<polygon fill="black" stroke="black" points="10321,-1594.54 10317.5,-1584.54 10314,-1594.54 10321,-1594.54"/>
</g>
<!-- layer15_mha_qkv_8 -->
<g id="node1211" class="node">
<title>layer15_mha_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="10595.5,-1263.5 10039.5,-1263.5 10039.5,-1180.5 10595.5,-1180.5 10595.5,-1263.5"/>
<text text-anchor="middle" x="10317.5" y="-1248.3" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10317.5" y="-1233.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10317.5" y="-1218.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10317.5" y="-1203.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10317.5" y="-1188.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer14_res2_8&#45;&gt;layer15_mha_qkv_8 -->
<g id="edge1321" class="edge">
<title>layer14_res2_8&#45;&gt;layer15_mha_qkv_8</title>
<path fill="none" stroke="black" d="M10317.5,-1364.24C10317.5,-1342.68 10317.5,-1304.87 10317.5,-1273.79"/>
<polygon fill="black" stroke="black" points="10321,-1273.54 10317.5,-1263.54 10314,-1273.54 10321,-1273.54"/>
</g>
<!-- layer14_mha_attn_9&#45;&gt;layer14_mha_out_9 -->
<g id="edge1246" class="edge">
<title>layer14_mha_attn_9&#45;&gt;layer14_mha_out_9</title>
<path fill="none" stroke="black" d="M10695.5,-2591.74C10695.5,-2570.18 10695.5,-2532.37 10695.5,-2501.29"/>
<polygon fill="black" stroke="black" points="10699,-2501.04 10695.5,-2491.04 10692,-2501.04 10699,-2501.04"/>
</g>
<!-- layer14_ln1_9 -->
<g id="node1183" class="node">
<title>layer14_ln1_9</title>
<polygon fill="none" stroke="black" points="10753.5,-2154 10637.5,-2154 10637.5,-2118 10753.5,-2118 10753.5,-2154"/>
<text text-anchor="middle" x="10695.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_ln1_9</text>
</g>
<!-- layer14_res1_9&#45;&gt;layer14_ln1_9 -->
<g id="edge1248" class="edge">
<title>layer14_res1_9&#45;&gt;layer14_ln1_9</title>
<path fill="none" stroke="black" d="M10695.5,-2270.97C10695.5,-2245.03 10695.5,-2195.36 10695.5,-2164.33"/>
<polygon fill="black" stroke="black" points="10699,-2164.2 10695.5,-2154.2 10692,-2164.2 10699,-2164.2"/>
</g>
<!-- layer14_ln1_9&#45;&gt;layer14_ffn_gate_9 -->
<g id="edge1249" class="edge">
<title>layer14_ln1_9&#45;&gt;layer14_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10637.24,-2121.9C10578.23,-2108.63 10483.74,-2087.39 10398.47,-2068.21"/>
<polygon fill="black" stroke="black" points="10399.18,-2064.79 10388.65,-2066.01 10397.64,-2071.61 10399.18,-2064.79"/>
</g>
<!-- layer14_ln1_9&#45;&gt;layer14_ffn_up_9 -->
<g id="edge1250" class="edge">
<title>layer14_ln1_9&#45;&gt;layer14_ffn_up_9</title>
<path fill="none" stroke="black" d="M10696.12,-2117.89C10696.54,-2106.65 10697.1,-2091.31 10697.64,-2076.35"/>
<polygon fill="black" stroke="black" points="10701.15,-2076.24 10698.02,-2066.12 10694.15,-2075.98 10701.15,-2076.24"/>
</g>
<!-- layer14_ffn_act_9&#45;&gt;layer14_ffn_down_9 -->
<g id="edge1253" class="edge">
<title>layer14_ffn_act_9&#45;&gt;layer14_ffn_down_9</title>
<path fill="none" stroke="black" d="M10697.5,-1845.74C10697.5,-1824.18 10697.5,-1786.37 10697.5,-1755.29"/>
<polygon fill="black" stroke="black" points="10701,-1755.04 10697.5,-1745.04 10694,-1755.04 10701,-1755.04"/>
</g>
<!-- layer15_mha_qkv_9 -->
<g id="node1212" class="node">
<title>layer15_mha_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="10975.5,-1424 10419.5,-1424 10419.5,-1341 10975.5,-1341 10975.5,-1424"/>
<text text-anchor="middle" x="10697.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="10697.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10697.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10697.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="10697.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer14_res2_9&#45;&gt;layer15_mha_qkv_9 -->
<g id="edge1332" class="edge">
<title>layer14_res2_9&#45;&gt;layer15_mha_qkv_9</title>
<path fill="none" stroke="black" d="M10697.5,-1524.74C10697.5,-1503.18 10697.5,-1465.37 10697.5,-1434.29"/>
<polygon fill="black" stroke="black" points="10701,-1434.04 10697.5,-1424.04 10694,-1434.04 10701,-1434.04"/>
</g>
<!-- layer14_mha_attn_10&#45;&gt;layer14_mha_out_10 -->
<g id="edge1257" class="edge">
<title>layer14_mha_attn_10&#45;&gt;layer14_mha_out_10</title>
<path fill="none" stroke="black" d="M11621.5,-2591.74C11621.5,-2570.18 11621.5,-2532.37 11621.5,-2501.29"/>
<polygon fill="black" stroke="black" points="11625,-2501.04 11621.5,-2491.04 11618,-2501.04 11625,-2501.04"/>
</g>
<!-- layer14_ln1_10 -->
<g id="node1188" class="node">
<title>layer14_ln1_10</title>
<polygon fill="none" stroke="black" points="11684,-2154 11559,-2154 11559,-2118 11684,-2118 11684,-2154"/>
<text text-anchor="middle" x="11621.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_ln1_10</text>
</g>
<!-- layer14_res1_10&#45;&gt;layer14_ln1_10 -->
<g id="edge1259" class="edge">
<title>layer14_res1_10&#45;&gt;layer14_ln1_10</title>
<path fill="none" stroke="black" d="M11621.5,-2270.97C11621.5,-2245.03 11621.5,-2195.36 11621.5,-2164.33"/>
<polygon fill="black" stroke="black" points="11625,-2164.2 11621.5,-2154.2 11618,-2164.2 11625,-2164.2"/>
</g>
<!-- layer14_ln1_10&#45;&gt;layer14_ffn_gate_10 -->
<g id="edge1260" class="edge">
<title>layer14_ln1_10&#45;&gt;layer14_ffn_gate_10</title>
<path fill="none" stroke="black" d="M11621.34,-2117.89C11621.24,-2106.65 11621.1,-2091.31 11620.96,-2076.35"/>
<polygon fill="black" stroke="black" points="11624.46,-2076.09 11620.87,-2066.12 11617.46,-2076.15 11624.46,-2076.09"/>
</g>
<!-- layer14_ln1_10&#45;&gt;layer14_ffn_up_10 -->
<g id="edge1261" class="edge">
<title>layer14_ln1_10&#45;&gt;layer14_ffn_up_10</title>
<path fill="none" stroke="black" d="M11684.06,-2121.02C11743.62,-2107.71 11836.37,-2086.98 11920.27,-2068.23"/>
<polygon fill="black" stroke="black" points="11921.2,-2071.61 11930.2,-2066.02 11919.67,-2064.78 11921.2,-2071.61"/>
</g>
<!-- layer14_ffn_act_10&#45;&gt;layer14_ffn_down_10 -->
<g id="edge1264" class="edge">
<title>layer14_ffn_act_10&#45;&gt;layer14_ffn_down_10</title>
<path fill="none" stroke="black" d="M11621.5,-1845.74C11621.5,-1824.18 11621.5,-1786.37 11621.5,-1755.29"/>
<polygon fill="black" stroke="black" points="11625,-1755.04 11621.5,-1745.04 11618,-1755.04 11625,-1755.04"/>
</g>
<!-- layer15_mha_qkv_10 -->
<g id="node1213" class="node">
<title>layer15_mha_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="11899.5,-1424 11343.5,-1424 11343.5,-1341 11899.5,-1341 11899.5,-1424"/>
<text text-anchor="middle" x="11621.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="11621.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11621.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11621.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="11621.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer14_res2_10&#45;&gt;layer15_mha_qkv_10 -->
<g id="edge1343" class="edge">
<title>layer14_res2_10&#45;&gt;layer15_mha_qkv_10</title>
<path fill="none" stroke="black" d="M11621.5,-1524.74C11621.5,-1503.18 11621.5,-1465.37 11621.5,-1434.29"/>
<polygon fill="black" stroke="black" points="11625,-1434.04 11621.5,-1424.04 11618,-1434.04 11625,-1434.04"/>
</g>
<!-- layer14_mha_attn_11&#45;&gt;layer14_mha_out_11 -->
<g id="edge1268" class="edge">
<title>layer14_mha_attn_11&#45;&gt;layer14_mha_out_11</title>
<path fill="none" stroke="black" d="M12630.5,-2591.74C12630.5,-2570.18 12630.5,-2532.37 12630.5,-2501.29"/>
<polygon fill="black" stroke="black" points="12634,-2501.04 12630.5,-2491.04 12627,-2501.04 12634,-2501.04"/>
</g>
<!-- layer14_ln1_11 -->
<g id="node1193" class="node">
<title>layer14_ln1_11</title>
<polygon fill="none" stroke="black" points="12693,-2154 12568,-2154 12568,-2118 12693,-2118 12693,-2154"/>
<text text-anchor="middle" x="12630.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_ln1_11</text>
</g>
<!-- layer14_res1_11&#45;&gt;layer14_ln1_11 -->
<g id="edge1270" class="edge">
<title>layer14_res1_11&#45;&gt;layer14_ln1_11</title>
<path fill="none" stroke="black" d="M12630.5,-2270.97C12630.5,-2245.03 12630.5,-2195.36 12630.5,-2164.33"/>
<polygon fill="black" stroke="black" points="12634,-2164.2 12630.5,-2154.2 12627,-2164.2 12634,-2164.2"/>
</g>
<!-- layer14_ln1_11&#45;&gt;layer14_ffn_gate_11 -->
<g id="edge1271" class="edge">
<title>layer14_ln1_11&#45;&gt;layer14_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12629.25,-2117.89C12628.43,-2106.65 12627.31,-2091.31 12626.22,-2076.35"/>
<polygon fill="black" stroke="black" points="12629.69,-2075.84 12625.47,-2066.12 12622.71,-2076.35 12629.69,-2075.84"/>
</g>
<!-- layer14_ln1_11&#45;&gt;layer14_ffn_up_11 -->
<g id="edge1272" class="edge">
<title>layer14_ln1_11&#45;&gt;layer14_ffn_up_11</title>
<path fill="none" stroke="black" d="M12693.15,-2120.8C12751.83,-2107.49 12842.57,-2086.92 12924.74,-2068.29"/>
<polygon fill="black" stroke="black" points="12925.74,-2071.66 12934.72,-2066.03 12924.19,-2064.83 12925.74,-2071.66"/>
</g>
<!-- layer14_ffn_act_11&#45;&gt;layer14_ffn_down_11 -->
<g id="edge1275" class="edge">
<title>layer14_ffn_act_11&#45;&gt;layer14_ffn_down_11</title>
<path fill="none" stroke="black" d="M12878.5,-1845.74C12878.5,-1824.18 12878.5,-1786.37 12878.5,-1755.29"/>
<polygon fill="black" stroke="black" points="12882,-1755.04 12878.5,-1745.04 12875,-1755.04 12882,-1755.04"/>
</g>
<!-- layer15_mha_qkv_11 -->
<g id="node1214" class="node">
<title>layer15_mha_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="13156.5,-1424 12600.5,-1424 12600.5,-1341 13156.5,-1341 13156.5,-1424"/>
<text text-anchor="middle" x="12878.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="12878.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12878.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12878.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="12878.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer14_res2_11&#45;&gt;layer15_mha_qkv_11 -->
<g id="edge1354" class="edge">
<title>layer14_res2_11&#45;&gt;layer15_mha_qkv_11</title>
<path fill="none" stroke="black" d="M12878.5,-1524.74C12878.5,-1503.18 12878.5,-1465.37 12878.5,-1434.29"/>
<polygon fill="black" stroke="black" points="12882,-1434.04 12878.5,-1424.04 12875,-1434.04 12882,-1434.04"/>
</g>
<!-- layer14_mha_attn_12&#45;&gt;layer14_mha_out_12 -->
<g id="edge1279" class="edge">
<title>layer14_mha_attn_12&#45;&gt;layer14_mha_out_12</title>
<path fill="none" stroke="black" d="M13828.5,-2591.74C13828.5,-2570.18 13828.5,-2532.37 13828.5,-2501.29"/>
<polygon fill="black" stroke="black" points="13832,-2501.04 13828.5,-2491.04 13825,-2501.04 13832,-2501.04"/>
</g>
<!-- layer14_ln1_12 -->
<g id="node1198" class="node">
<title>layer14_ln1_12</title>
<polygon fill="none" stroke="black" points="13891,-2154 13766,-2154 13766,-2118 13891,-2118 13891,-2154"/>
<text text-anchor="middle" x="13828.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_ln1_12</text>
</g>
<!-- layer14_res1_12&#45;&gt;layer14_ln1_12 -->
<g id="edge1281" class="edge">
<title>layer14_res1_12&#45;&gt;layer14_ln1_12</title>
<path fill="none" stroke="black" d="M13828.5,-2270.97C13828.5,-2245.03 13828.5,-2195.36 13828.5,-2164.33"/>
<polygon fill="black" stroke="black" points="13832,-2164.2 13828.5,-2154.2 13825,-2164.2 13832,-2164.2"/>
</g>
<!-- layer14_ln1_12&#45;&gt;layer14_ffn_gate_12 -->
<g id="edge1282" class="edge">
<title>layer14_ln1_12&#45;&gt;layer14_ffn_gate_12</title>
<path fill="none" stroke="black" d="M13796.62,-2117.89C13773.17,-2105.3 13740.12,-2087.56 13709.24,-2070.99"/>
<polygon fill="black" stroke="black" points="13710.64,-2067.76 13700.17,-2066.12 13707.33,-2073.93 13710.64,-2067.76"/>
</g>
<!-- layer14_ln1_12&#45;&gt;layer14_ffn_up_12 -->
<g id="edge1283" class="edge">
<title>layer14_ln1_12&#45;&gt;layer14_ffn_up_12</title>
<path fill="none" stroke="black" d="M13873.34,-2117.89C13907.27,-2104.95 13955.45,-2086.56 13999.92,-2069.6"/>
<polygon fill="black" stroke="black" points="14001.25,-2072.84 14009.35,-2066 13998.75,-2066.3 14001.25,-2072.84"/>
</g>
<!-- layer14_ffn_act_12&#45;&gt;layer14_ffn_down_12 -->
<g id="edge1286" class="edge">
<title>layer14_ffn_act_12&#45;&gt;layer14_ffn_down_12</title>
<path fill="none" stroke="black" d="M13984.5,-1845.74C13984.5,-1824.18 13984.5,-1786.37 13984.5,-1755.29"/>
<polygon fill="black" stroke="black" points="13988,-1755.04 13984.5,-1745.04 13981,-1755.04 13988,-1755.04"/>
</g>
<!-- layer15_mha_qkv_12 -->
<g id="node1215" class="node">
<title>layer15_mha_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="14262.5,-1424 13706.5,-1424 13706.5,-1341 14262.5,-1341 14262.5,-1424"/>
<text text-anchor="middle" x="13984.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="13984.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13984.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13984.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="13984.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer14_res2_12&#45;&gt;layer15_mha_qkv_12 -->
<g id="edge1365" class="edge">
<title>layer14_res2_12&#45;&gt;layer15_mha_qkv_12</title>
<path fill="none" stroke="black" d="M13984.5,-1524.74C13984.5,-1503.18 13984.5,-1465.37 13984.5,-1434.29"/>
<polygon fill="black" stroke="black" points="13988,-1434.04 13984.5,-1424.04 13981,-1434.04 13988,-1434.04"/>
</g>
<!-- layer14_mha_attn_13&#45;&gt;layer14_mha_out_13 -->
<g id="edge1290" class="edge">
<title>layer14_mha_attn_13&#45;&gt;layer14_mha_out_13</title>
<path fill="none" stroke="black" d="M14625.5,-2591.74C14625.5,-2570.18 14625.5,-2532.37 14625.5,-2501.29"/>
<polygon fill="black" stroke="black" points="14629,-2501.04 14625.5,-2491.04 14622,-2501.04 14629,-2501.04"/>
</g>
<!-- layer14_ln1_13 -->
<g id="node1203" class="node">
<title>layer14_ln1_13</title>
<polygon fill="none" stroke="black" points="14688,-2154 14563,-2154 14563,-2118 14688,-2118 14688,-2154"/>
<text text-anchor="middle" x="14625.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_ln1_13</text>
</g>
<!-- layer14_res1_13&#45;&gt;layer14_ln1_13 -->
<g id="edge1292" class="edge">
<title>layer14_res1_13&#45;&gt;layer14_ln1_13</title>
<path fill="none" stroke="black" d="M14625.5,-2270.97C14625.5,-2245.03 14625.5,-2195.36 14625.5,-2164.33"/>
<polygon fill="black" stroke="black" points="14629,-2164.2 14625.5,-2154.2 14622,-2164.2 14629,-2164.2"/>
</g>
<!-- layer14_ln1_13&#45;&gt;layer14_ffn_gate_13 -->
<g id="edge1293" class="edge">
<title>layer14_ln1_13&#45;&gt;layer14_ffn_gate_13</title>
<path fill="none" stroke="black" d="M14622.53,-2117.89C14620.58,-2106.65 14617.92,-2091.31 14615.32,-2076.35"/>
<polygon fill="black" stroke="black" points="14618.71,-2075.37 14613.55,-2066.12 14611.81,-2076.57 14618.71,-2075.37"/>
</g>
<!-- layer14_ln1_13&#45;&gt;layer14_ffn_up_13 -->
<g id="edge1294" class="edge">
<title>layer14_ln1_13&#45;&gt;layer14_ffn_up_13</title>
<path fill="none" stroke="black" d="M14688.18,-2120.46C14745.47,-2107.17 14833.14,-2086.83 14912.67,-2068.38"/>
<polygon fill="black" stroke="black" points="14913.88,-2071.69 14922.83,-2066.02 14912.29,-2064.87 14913.88,-2071.69"/>
</g>
<!-- layer14_ffn_act_13&#45;&gt;layer14_ffn_down_13 -->
<g id="edge1297" class="edge">
<title>layer14_ffn_act_13&#45;&gt;layer14_ffn_down_13</title>
<path fill="none" stroke="black" d="M14767.5,-1845.74C14767.5,-1824.18 14767.5,-1786.37 14767.5,-1755.29"/>
<polygon fill="black" stroke="black" points="14771,-1755.04 14767.5,-1745.04 14764,-1755.04 14771,-1755.04"/>
</g>
<!-- layer15_mha_qkv_13 -->
<g id="node1216" class="node">
<title>layer15_mha_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="15045.5,-1424 14489.5,-1424 14489.5,-1341 15045.5,-1341 15045.5,-1424"/>
<text text-anchor="middle" x="14767.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="14767.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14767.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14767.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="14767.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer14_res2_13&#45;&gt;layer15_mha_qkv_13 -->
<g id="edge1376" class="edge">
<title>layer14_res2_13&#45;&gt;layer15_mha_qkv_13</title>
<path fill="none" stroke="black" d="M14767.5,-1524.74C14767.5,-1503.18 14767.5,-1465.37 14767.5,-1434.29"/>
<polygon fill="black" stroke="black" points="14771,-1434.04 14767.5,-1424.04 14764,-1434.04 14771,-1434.04"/>
</g>
<!-- layer14_mha_attn_14&#45;&gt;layer14_mha_out_14 -->
<g id="edge1301" class="edge">
<title>layer14_mha_attn_14&#45;&gt;layer14_mha_out_14</title>
<path fill="none" stroke="black" d="M15965.5,-2591.74C15965.5,-2570.18 15965.5,-2532.37 15965.5,-2501.29"/>
<polygon fill="black" stroke="black" points="15969,-2501.04 15965.5,-2491.04 15962,-2501.04 15969,-2501.04"/>
</g>
<!-- layer14_ln1_14 -->
<g id="node1208" class="node">
<title>layer14_ln1_14</title>
<polygon fill="none" stroke="black" points="16028,-2154 15903,-2154 15903,-2118 16028,-2118 16028,-2154"/>
<text text-anchor="middle" x="15965.5" y="-2132.3" font-family="Times,serif" font-size="14.00">layer14_ln1_14</text>
</g>
<!-- layer14_res1_14&#45;&gt;layer14_ln1_14 -->
<g id="edge1303" class="edge">
<title>layer14_res1_14&#45;&gt;layer14_ln1_14</title>
<path fill="none" stroke="black" d="M15965.5,-2270.97C15965.5,-2245.03 15965.5,-2195.36 15965.5,-2164.33"/>
<polygon fill="black" stroke="black" points="15969,-2164.2 15965.5,-2154.2 15962,-2164.2 15969,-2164.2"/>
</g>
<!-- layer14_ln1_14&#45;&gt;layer14_ffn_gate_14 -->
<g id="edge1304" class="edge">
<title>layer14_ln1_14&#45;&gt;layer14_ffn_gate_14</title>
<path fill="none" stroke="black" d="M15917.84,-2117.89C15881.64,-2104.89 15830.15,-2086.41 15782.74,-2069.38"/>
<polygon fill="black" stroke="black" points="15783.91,-2066.09 15773.31,-2066 15781.54,-2072.67 15783.91,-2066.09"/>
</g>
<!-- layer14_ln1_14&#45;&gt;layer14_ffn_up_14 -->
<g id="edge1305" class="edge">
<title>layer14_ln1_14&#45;&gt;layer14_ffn_up_14</title>
<path fill="none" stroke="black" d="M15994.56,-2117.89C16015.86,-2105.35 16045.83,-2087.71 16073.87,-2071.2"/>
<polygon fill="black" stroke="black" points="16075.66,-2074.21 16082.5,-2066.12 16072.11,-2068.18 16075.66,-2074.21"/>
</g>
<!-- layer14_ffn_act_14&#45;&gt;layer14_ffn_down_14 -->
<g id="edge1308" class="edge">
<title>layer14_ffn_act_14&#45;&gt;layer14_ffn_down_14</title>
<path fill="none" stroke="black" d="M16034.5,-1845.74C16034.5,-1824.18 16034.5,-1786.37 16034.5,-1755.29"/>
<polygon fill="black" stroke="black" points="16038,-1755.04 16034.5,-1745.04 16031,-1755.04 16038,-1755.04"/>
</g>
<!-- layer15_mha_qkv_14 -->
<g id="node1217" class="node">
<title>layer15_mha_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="16312.5,-1424 15756.5,-1424 15756.5,-1341 16312.5,-1341 16312.5,-1424"/>
<text text-anchor="middle" x="16034.5" y="-1408.8" font-family="Times,serif" font-size="14.00">MHA QKV Proj</text>
<text text-anchor="middle" x="16034.5" y="-1393.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16034.5" y="-1378.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16034.5" y="-1363.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, heads=32, d_k=128, width=1/8]</text>
<text text-anchor="middle" x="16034.5" y="-1348.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer14_res2_14&#45;&gt;layer15_mha_qkv_14 -->
<g id="edge1387" class="edge">
<title>layer14_res2_14&#45;&gt;layer15_mha_qkv_14</title>
<path fill="none" stroke="black" d="M16034.5,-1524.74C16034.5,-1503.18 16034.5,-1465.37 16034.5,-1434.29"/>
<polygon fill="black" stroke="black" points="16038,-1434.04 16034.5,-1424.04 16031,-1434.04 16038,-1434.04"/>
</g>
<!-- layer15_mha_attn_8 -->
<g id="node1256" class="node">
<title>layer15_mha_attn_8</title>
<polygon fill="none" stroke="black" points="10397.5,-1079.5 10237.5,-1079.5 10237.5,-1043.5 10397.5,-1043.5 10397.5,-1079.5"/>
<text text-anchor="middle" x="10317.5" y="-1057.8" font-family="Times,serif" font-size="14.00">layer15_mha_attn_8</text>
</g>
<!-- layer15_mha_qkv_8&#45;&gt;layer15_mha_attn_8 -->
<g id="edge1322" class="edge">
<title>layer15_mha_qkv_8&#45;&gt;layer15_mha_attn_8</title>
<path fill="none" stroke="black" d="M10317.5,-1180.18C10317.5,-1151.74 10317.5,-1114.58 10317.5,-1089.7"/>
<polygon fill="black" stroke="black" points="10321,-1089.52 10317.5,-1079.52 10314,-1089.52 10321,-1089.52"/>
</g>
<!-- layer15_mha_attn_9 -->
<g id="node1261" class="node">
<title>layer15_mha_attn_9</title>
<polygon fill="none" stroke="black" points="10777.5,-1240 10617.5,-1240 10617.5,-1204 10777.5,-1204 10777.5,-1240"/>
<text text-anchor="middle" x="10697.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer15_mha_attn_9</text>
</g>
<!-- layer15_mha_qkv_9&#45;&gt;layer15_mha_attn_9 -->
<g id="edge1333" class="edge">
<title>layer15_mha_qkv_9&#45;&gt;layer15_mha_attn_9</title>
<path fill="none" stroke="black" d="M10697.5,-1340.68C10697.5,-1312.24 10697.5,-1275.08 10697.5,-1250.2"/>
<polygon fill="black" stroke="black" points="10701,-1250.02 10697.5,-1240.02 10694,-1250.02 10701,-1250.02"/>
</g>
<!-- layer15_mha_attn_10 -->
<g id="node1266" class="node">
<title>layer15_mha_attn_10</title>
<polygon fill="none" stroke="black" points="11706,-1240 11537,-1240 11537,-1204 11706,-1204 11706,-1240"/>
<text text-anchor="middle" x="11621.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer15_mha_attn_10</text>
</g>
<!-- layer15_mha_qkv_10&#45;&gt;layer15_mha_attn_10 -->
<g id="edge1344" class="edge">
<title>layer15_mha_qkv_10&#45;&gt;layer15_mha_attn_10</title>
<path fill="none" stroke="black" d="M11621.5,-1340.68C11621.5,-1312.24 11621.5,-1275.08 11621.5,-1250.2"/>
<polygon fill="black" stroke="black" points="11625,-1250.02 11621.5,-1240.02 11618,-1250.02 11625,-1250.02"/>
</g>
<!-- layer15_mha_attn_11 -->
<g id="node1271" class="node">
<title>layer15_mha_attn_11</title>
<polygon fill="none" stroke="black" points="12963,-1240 12794,-1240 12794,-1204 12963,-1204 12963,-1240"/>
<text text-anchor="middle" x="12878.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer15_mha_attn_11</text>
</g>
<!-- layer15_mha_qkv_11&#45;&gt;layer15_mha_attn_11 -->
<g id="edge1355" class="edge">
<title>layer15_mha_qkv_11&#45;&gt;layer15_mha_attn_11</title>
<path fill="none" stroke="black" d="M12878.5,-1340.68C12878.5,-1312.24 12878.5,-1275.08 12878.5,-1250.2"/>
<polygon fill="black" stroke="black" points="12882,-1250.02 12878.5,-1240.02 12875,-1250.02 12882,-1250.02"/>
</g>
<!-- layer15_mha_attn_12 -->
<g id="node1276" class="node">
<title>layer15_mha_attn_12</title>
<polygon fill="none" stroke="black" points="14069,-1240 13900,-1240 13900,-1204 14069,-1204 14069,-1240"/>
<text text-anchor="middle" x="13984.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer15_mha_attn_12</text>
</g>
<!-- layer15_mha_qkv_12&#45;&gt;layer15_mha_attn_12 -->
<g id="edge1366" class="edge">
<title>layer15_mha_qkv_12&#45;&gt;layer15_mha_attn_12</title>
<path fill="none" stroke="black" d="M13984.5,-1340.68C13984.5,-1312.24 13984.5,-1275.08 13984.5,-1250.2"/>
<polygon fill="black" stroke="black" points="13988,-1250.02 13984.5,-1240.02 13981,-1250.02 13988,-1250.02"/>
</g>
<!-- layer15_mha_attn_13 -->
<g id="node1281" class="node">
<title>layer15_mha_attn_13</title>
<polygon fill="none" stroke="black" points="14852,-1240 14683,-1240 14683,-1204 14852,-1204 14852,-1240"/>
<text text-anchor="middle" x="14767.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer15_mha_attn_13</text>
</g>
<!-- layer15_mha_qkv_13&#45;&gt;layer15_mha_attn_13 -->
<g id="edge1377" class="edge">
<title>layer15_mha_qkv_13&#45;&gt;layer15_mha_attn_13</title>
<path fill="none" stroke="black" d="M14767.5,-1340.68C14767.5,-1312.24 14767.5,-1275.08 14767.5,-1250.2"/>
<polygon fill="black" stroke="black" points="14771,-1250.02 14767.5,-1240.02 14764,-1250.02 14771,-1250.02"/>
</g>
<!-- layer15_mha_attn_14 -->
<g id="node1286" class="node">
<title>layer15_mha_attn_14</title>
<polygon fill="none" stroke="black" points="16119,-1240 15950,-1240 15950,-1204 16119,-1204 16119,-1240"/>
<text text-anchor="middle" x="16034.5" y="-1218.3" font-family="Times,serif" font-size="14.00">layer15_mha_attn_14</text>
</g>
<!-- layer15_mha_qkv_14&#45;&gt;layer15_mha_attn_14 -->
<g id="edge1388" class="edge">
<title>layer15_mha_qkv_14&#45;&gt;layer15_mha_attn_14</title>
<path fill="none" stroke="black" d="M16034.5,-1340.68C16034.5,-1312.24 16034.5,-1275.08 16034.5,-1250.2"/>
<polygon fill="black" stroke="black" points="16038,-1250.02 16034.5,-1240.02 16031,-1250.02 16038,-1250.02"/>
</g>
<!-- layer15_mha_attn_15 -->
<g id="node1219" class="node">
<title>layer15_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="17291.31,-1305 16532.81,-1305 16337.69,-1139 17096.19,-1139 17291.31,-1305"/>
<text text-anchor="middle" x="16814.5" y="-1248.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="16814.5" y="-1233.3" font-family="Times,serif" font-size="14.00">All heads combined</text>
<text text-anchor="middle" x="16814.5" y="-1218.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16814.5" y="-1203.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-1188.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_mha_qkv_15&#45;&gt;layer15_mha_attn_15 -->
<g id="edge1399" class="edge">
<title>layer15_mha_qkv_15&#45;&gt;layer15_mha_attn_15</title>
<path fill="none" stroke="black" d="M16814.5,-1340.68C16814.5,-1332.75 16814.5,-1324.14 16814.5,-1315.31"/>
<polygon fill="black" stroke="black" points="16818,-1315.27 16814.5,-1305.27 16811,-1315.27 16818,-1315.27"/>
</g>
<!-- layer15_mha_out_15 -->
<g id="node1227" class="node">
<title>layer15_mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="17033.5,-1103 16595.5,-1103 16595.5,-1020 17033.5,-1020 17033.5,-1103"/>
<text text-anchor="middle" x="16814.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16814.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16814.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16814.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_mha_attn_15&#45;&gt;layer15_mha_out_15 -->
<g id="edge1400" class="edge">
<title>layer15_mha_attn_15&#45;&gt;layer15_mha_out_15</title>
<path fill="none" stroke="black" d="M16814.5,-1138.96C16814.5,-1130.25 16814.5,-1121.59 16814.5,-1113.39"/>
<polygon fill="black" stroke="black" points="16818,-1113.29 16814.5,-1103.29 16811,-1113.29 16818,-1113.29"/>
</g>
<!-- layer15_mha_out_8 -->
<g id="node1220" class="node">
<title>layer15_mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="10536.5,-942.5 10098.5,-942.5 10098.5,-859.5 10536.5,-859.5 10536.5,-942.5"/>
<text text-anchor="middle" x="10317.5" y="-927.3" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10317.5" y="-912.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10317.5" y="-897.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10317.5" y="-882.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10317.5" y="-867.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_res1_8 -->
<g id="node1257" class="node">
<title>layer15_res1_8</title>
<polygon fill="none" stroke="black" points="10380,-766 10255,-766 10255,-730 10380,-730 10380,-766"/>
<text text-anchor="middle" x="10317.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_res1_8</text>
</g>
<!-- layer15_mha_out_8&#45;&gt;layer15_res1_8 -->
<g id="edge1324" class="edge">
<title>layer15_mha_out_8&#45;&gt;layer15_res1_8</title>
<path fill="none" stroke="black" d="M10317.5,-859.14C10317.5,-832.9 10317.5,-799.53 10317.5,-776.44"/>
<polygon fill="black" stroke="black" points="10321,-776.31 10317.5,-766.31 10314,-776.31 10321,-776.31"/>
</g>
<!-- layer15_mha_out_9 -->
<g id="node1221" class="node">
<title>layer15_mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="10916.5,-1103 10478.5,-1103 10478.5,-1020 10916.5,-1020 10916.5,-1103"/>
<text text-anchor="middle" x="10697.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="10697.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10697.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10697.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10697.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_res1_9 -->
<g id="node1262" class="node">
<title>layer15_res1_9</title>
<polygon fill="none" stroke="black" points="10760,-919 10635,-919 10635,-883 10760,-883 10760,-919"/>
<text text-anchor="middle" x="10697.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer15_res1_9</text>
</g>
<!-- layer15_mha_out_9&#45;&gt;layer15_res1_9 -->
<g id="edge1335" class="edge">
<title>layer15_mha_out_9&#45;&gt;layer15_res1_9</title>
<path fill="none" stroke="black" d="M10697.5,-1019.68C10697.5,-991.24 10697.5,-954.08 10697.5,-929.2"/>
<polygon fill="black" stroke="black" points="10701,-929.02 10697.5,-919.02 10694,-929.02 10701,-929.02"/>
</g>
<!-- layer15_mha_out_10 -->
<g id="node1222" class="node">
<title>layer15_mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="11840.5,-1103 11402.5,-1103 11402.5,-1020 11840.5,-1020 11840.5,-1103"/>
<text text-anchor="middle" x="11621.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="11621.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11621.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11621.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11621.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_res1_10 -->
<g id="node1267" class="node">
<title>layer15_res1_10</title>
<polygon fill="none" stroke="black" points="11688.5,-919 11554.5,-919 11554.5,-883 11688.5,-883 11688.5,-919"/>
<text text-anchor="middle" x="11621.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer15_res1_10</text>
</g>
<!-- layer15_mha_out_10&#45;&gt;layer15_res1_10 -->
<g id="edge1346" class="edge">
<title>layer15_mha_out_10&#45;&gt;layer15_res1_10</title>
<path fill="none" stroke="black" d="M11621.5,-1019.68C11621.5,-991.24 11621.5,-954.08 11621.5,-929.2"/>
<polygon fill="black" stroke="black" points="11625,-929.02 11621.5,-919.02 11618,-929.02 11625,-929.02"/>
</g>
<!-- layer15_mha_out_11 -->
<g id="node1223" class="node">
<title>layer15_mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="13097.5,-1103 12659.5,-1103 12659.5,-1020 13097.5,-1020 13097.5,-1103"/>
<text text-anchor="middle" x="12878.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="12878.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12878.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12878.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12878.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_res1_11 -->
<g id="node1272" class="node">
<title>layer15_res1_11</title>
<polygon fill="none" stroke="black" points="12945.5,-919 12811.5,-919 12811.5,-883 12945.5,-883 12945.5,-919"/>
<text text-anchor="middle" x="12878.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer15_res1_11</text>
</g>
<!-- layer15_mha_out_11&#45;&gt;layer15_res1_11 -->
<g id="edge1357" class="edge">
<title>layer15_mha_out_11&#45;&gt;layer15_res1_11</title>
<path fill="none" stroke="black" d="M12878.5,-1019.68C12878.5,-991.24 12878.5,-954.08 12878.5,-929.2"/>
<polygon fill="black" stroke="black" points="12882,-929.02 12878.5,-919.02 12875,-929.02 12882,-929.02"/>
</g>
<!-- layer15_mha_out_12 -->
<g id="node1224" class="node">
<title>layer15_mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="14203.5,-1103 13765.5,-1103 13765.5,-1020 14203.5,-1020 14203.5,-1103"/>
<text text-anchor="middle" x="13984.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="13984.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13984.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13984.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13984.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_res1_12 -->
<g id="node1277" class="node">
<title>layer15_res1_12</title>
<polygon fill="none" stroke="black" points="14051.5,-919 13917.5,-919 13917.5,-883 14051.5,-883 14051.5,-919"/>
<text text-anchor="middle" x="13984.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer15_res1_12</text>
</g>
<!-- layer15_mha_out_12&#45;&gt;layer15_res1_12 -->
<g id="edge1368" class="edge">
<title>layer15_mha_out_12&#45;&gt;layer15_res1_12</title>
<path fill="none" stroke="black" d="M13984.5,-1019.68C13984.5,-991.24 13984.5,-954.08 13984.5,-929.2"/>
<polygon fill="black" stroke="black" points="13988,-929.02 13984.5,-919.02 13981,-929.02 13988,-929.02"/>
</g>
<!-- layer15_mha_out_13 -->
<g id="node1225" class="node">
<title>layer15_mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="14986.5,-1103 14548.5,-1103 14548.5,-1020 14986.5,-1020 14986.5,-1103"/>
<text text-anchor="middle" x="14767.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="14767.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14767.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14767.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14767.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_res1_13 -->
<g id="node1282" class="node">
<title>layer15_res1_13</title>
<polygon fill="none" stroke="black" points="14834.5,-919 14700.5,-919 14700.5,-883 14834.5,-883 14834.5,-919"/>
<text text-anchor="middle" x="14767.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer15_res1_13</text>
</g>
<!-- layer15_mha_out_13&#45;&gt;layer15_res1_13 -->
<g id="edge1379" class="edge">
<title>layer15_mha_out_13&#45;&gt;layer15_res1_13</title>
<path fill="none" stroke="black" d="M14767.5,-1019.68C14767.5,-991.24 14767.5,-954.08 14767.5,-929.2"/>
<polygon fill="black" stroke="black" points="14771,-929.02 14767.5,-919.02 14764,-929.02 14771,-929.02"/>
</g>
<!-- layer15_mha_out_14 -->
<g id="node1226" class="node">
<title>layer15_mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="16253.5,-1103 15815.5,-1103 15815.5,-1020 16253.5,-1020 16253.5,-1103"/>
<text text-anchor="middle" x="16034.5" y="-1087.8" font-family="Times,serif" font-size="14.00">MHA Output Proj</text>
<text text-anchor="middle" x="16034.5" y="-1072.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16034.5" y="-1057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16034.5" y="-1042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16034.5" y="-1027.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_res1_14 -->
<g id="node1287" class="node">
<title>layer15_res1_14</title>
<polygon fill="none" stroke="black" points="16101.5,-919 15967.5,-919 15967.5,-883 16101.5,-883 16101.5,-919"/>
<text text-anchor="middle" x="16034.5" y="-897.3" font-family="Times,serif" font-size="14.00">layer15_res1_14</text>
</g>
<!-- layer15_mha_out_14&#45;&gt;layer15_res1_14 -->
<g id="edge1390" class="edge">
<title>layer15_mha_out_14&#45;&gt;layer15_res1_14</title>
<path fill="none" stroke="black" d="M16034.5,-1019.68C16034.5,-991.24 16034.5,-954.08 16034.5,-929.2"/>
<polygon fill="black" stroke="black" points="16038,-929.02 16034.5,-919.02 16031,-929.02 16038,-929.02"/>
</g>
<!-- layer15_res1_15 -->
<g id="node1228" class="node">
<title>layer15_res1_15</title>
<polygon fill="none" stroke="black" points="17255.24,-984 16554.12,-984 16373.76,-818 17074.88,-818 17255.24,-984"/>
<text text-anchor="middle" x="16814.5" y="-927.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16814.5" y="-912.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-897.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-882.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-867.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_mha_out_15&#45;&gt;layer15_res1_15 -->
<g id="edge1401" class="edge">
<title>layer15_mha_out_15&#45;&gt;layer15_res1_15</title>
<path fill="none" stroke="black" d="M16814.5,-1019.68C16814.5,-1011.75 16814.5,-1003.14 16814.5,-994.31"/>
<polygon fill="black" stroke="black" points="16818,-994.27 16814.5,-984.27 16811,-994.27 16818,-994.27"/>
</g>
<!-- layer15_ln1_15 -->
<g id="node1229" class="node">
<title>layer15_ln1_15</title>
<polygon fill="yellow" stroke="black" points="17027,-782 16602,-782 16602,-714 17027,-714 17027,-782"/>
<text text-anchor="middle" x="16814.5" y="-766.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="16814.5" y="-751.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-736.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16814.5" y="-721.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_res1_15&#45;&gt;layer15_ln1_15 -->
<g id="edge1402" class="edge">
<title>layer15_res1_15&#45;&gt;layer15_ln1_15</title>
<path fill="none" stroke="black" d="M16814.5,-817.87C16814.5,-809.12 16814.5,-800.48 16814.5,-792.45"/>
<polygon fill="black" stroke="black" points="16818,-792.26 16814.5,-782.26 16811,-792.26 16818,-792.26"/>
</g>
<!-- layer15_ffn_gate_15 -->
<g id="node1237" class="node">
<title>layer15_ffn_gate_15</title>
<polygon fill="lightblue" stroke="black" points="16846,-678 16373,-678 16373,-595 16846,-595 16846,-678"/>
<text text-anchor="middle" x="16609.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16609.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16609.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16609.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16609.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_ln1_15&#45;&gt;layer15_ffn_gate_15 -->
<g id="edge1403" class="edge">
<title>layer15_ln1_15&#45;&gt;layer15_ffn_gate_15</title>
<path fill="none" stroke="black" d="M16752.72,-714C16734.42,-704.22 16714.05,-693.34 16694.55,-682.93"/>
<polygon fill="black" stroke="black" points="16696.13,-679.81 16685.66,-678.18 16692.83,-685.98 16696.13,-679.81"/>
</g>
<!-- layer15_ffn_up_15 -->
<g id="node1245" class="node">
<title>layer15_ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="17337,-678 16864,-678 16864,-595 17337,-595 17337,-678"/>
<text text-anchor="middle" x="17100.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17100.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="17100.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="17100.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="17100.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_ln1_15&#45;&gt;layer15_ffn_up_15 -->
<g id="edge1404" class="edge">
<title>layer15_ln1_15&#45;&gt;layer15_ffn_up_15</title>
<path fill="none" stroke="black" d="M16900.7,-714C16927.22,-703.84 16956.86,-692.5 16985.02,-681.71"/>
<polygon fill="black" stroke="black" points="16986.42,-684.93 16994.5,-678.08 16983.91,-678.39 16986.42,-684.93"/>
</g>
<!-- layer15_ffn_gate_8 -->
<g id="node1230" class="node">
<title>layer15_ffn_gate_8</title>
<polygon fill="lightblue" stroke="black" points="10196,-517.5 9723,-517.5 9723,-434.5 10196,-434.5 10196,-517.5"/>
<text text-anchor="middle" x="9959.5" y="-502.3" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9959.5" y="-487.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="9959.5" y="-472.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="9959.5" y="-457.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="9959.5" y="-442.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_ffn_act_8 -->
<g id="node1259" class="node">
<title>layer15_ffn_act_8</title>
<polygon fill="none" stroke="black" points="10275.5,-333.5 10135.5,-333.5 10135.5,-297.5 10275.5,-297.5 10275.5,-333.5"/>
<text text-anchor="middle" x="10205.5" y="-311.8" font-family="Times,serif" font-size="14.00">layer15_ffn_act_8</text>
</g>
<!-- layer15_ffn_gate_8&#45;&gt;layer15_ffn_act_8 -->
<g id="edge1328" class="edge">
<title>layer15_ffn_gate_8&#45;&gt;layer15_ffn_act_8</title>
<path fill="none" stroke="black" d="M10022.53,-434.39C10069.45,-404.16 10131.78,-364 10170.24,-339.22"/>
<polygon fill="black" stroke="black" points="10172.5,-341.93 10179.01,-333.57 10168.71,-336.04 10172.5,-341.93"/>
</g>
<!-- layer15_ffn_gate_9 -->
<g id="node1231" class="node">
<title>layer15_ffn_gate_9</title>
<polygon fill="lightblue" stroke="black" points="10872,-678 10399,-678 10399,-595 10872,-595 10872,-678"/>
<text text-anchor="middle" x="10635.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10635.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10635.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10635.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10635.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_ffn_act_9 -->
<g id="node1264" class="node">
<title>layer15_ffn_act_9</title>
<polygon fill="none" stroke="black" points="10962.5,-494 10822.5,-494 10822.5,-458 10962.5,-458 10962.5,-494"/>
<text text-anchor="middle" x="10892.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer15_ffn_act_9</text>
</g>
<!-- layer15_ffn_gate_9&#45;&gt;layer15_ffn_act_9 -->
<g id="edge1339" class="edge">
<title>layer15_ffn_gate_9&#45;&gt;layer15_ffn_act_9</title>
<path fill="none" stroke="black" d="M10701.35,-594.89C10750.57,-564.53 10816.03,-524.16 10856.17,-499.41"/>
<polygon fill="black" stroke="black" points="10858.15,-502.3 10864.82,-494.07 10854.47,-496.34 10858.15,-502.3"/>
</g>
<!-- layer15_ffn_gate_10 -->
<g id="node1232" class="node">
<title>layer15_ffn_gate_10</title>
<polygon fill="lightblue" stroke="black" points="11856,-678 11383,-678 11383,-595 11856,-595 11856,-678"/>
<text text-anchor="middle" x="11619.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11619.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11619.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11619.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11619.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_ffn_act_10 -->
<g id="node1269" class="node">
<title>layer15_ffn_act_10</title>
<polygon fill="none" stroke="black" points="11940,-494 11791,-494 11791,-458 11940,-458 11940,-494"/>
<text text-anchor="middle" x="11865.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer15_ffn_act_10</text>
</g>
<!-- layer15_ffn_gate_10&#45;&gt;layer15_ffn_act_10 -->
<g id="edge1350" class="edge">
<title>layer15_ffn_gate_10&#45;&gt;layer15_ffn_act_10</title>
<path fill="none" stroke="black" d="M11682.53,-594.89C11729.45,-564.66 11791.78,-524.5 11830.24,-499.72"/>
<polygon fill="black" stroke="black" points="11832.5,-502.43 11839.01,-494.07 11828.71,-496.54 11832.5,-502.43"/>
</g>
<!-- layer15_ffn_gate_11 -->
<g id="node1233" class="node">
<title>layer15_ffn_gate_11</title>
<polygon fill="lightblue" stroke="black" points="12879,-678 12406,-678 12406,-595 12879,-595 12879,-678"/>
<text text-anchor="middle" x="12642.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12642.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12642.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12642.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12642.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_ffn_act_11 -->
<g id="node1274" class="node">
<title>layer15_ffn_act_11</title>
<polygon fill="none" stroke="black" points="12963,-494 12814,-494 12814,-458 12963,-458 12963,-494"/>
<text text-anchor="middle" x="12888.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer15_ffn_act_11</text>
</g>
<!-- layer15_ffn_gate_11&#45;&gt;layer15_ffn_act_11 -->
<g id="edge1361" class="edge">
<title>layer15_ffn_gate_11&#45;&gt;layer15_ffn_act_11</title>
<path fill="none" stroke="black" d="M12705.53,-594.89C12752.45,-564.66 12814.78,-524.5 12853.24,-499.72"/>
<polygon fill="black" stroke="black" points="12855.5,-502.43 12862.01,-494.07 12851.71,-496.54 12855.5,-502.43"/>
</g>
<!-- layer15_ffn_gate_12 -->
<g id="node1234" class="node">
<title>layer15_ffn_gate_12</title>
<polygon fill="lightblue" stroke="black" points="13882,-678 13409,-678 13409,-595 13882,-595 13882,-678"/>
<text text-anchor="middle" x="13645.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13645.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13645.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13645.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13645.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_ffn_act_12 -->
<g id="node1279" class="node">
<title>layer15_ffn_act_12</title>
<polygon fill="none" stroke="black" points="13965,-494 13816,-494 13816,-458 13965,-458 13965,-494"/>
<text text-anchor="middle" x="13890.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer15_ffn_act_12</text>
</g>
<!-- layer15_ffn_gate_12&#45;&gt;layer15_ffn_act_12 -->
<g id="edge1372" class="edge">
<title>layer15_ffn_gate_12&#45;&gt;layer15_ffn_act_12</title>
<path fill="none" stroke="black" d="M13708.28,-594.89C13755,-564.66 13817.08,-524.5 13855.38,-499.72"/>
<polygon fill="black" stroke="black" points="13857.62,-502.44 13864.12,-494.07 13853.82,-496.56 13857.62,-502.44"/>
</g>
<!-- layer15_ffn_gate_13 -->
<g id="node1235" class="node">
<title>layer15_ffn_gate_13</title>
<polygon fill="lightblue" stroke="black" points="14874,-678 14401,-678 14401,-595 14874,-595 14874,-678"/>
<text text-anchor="middle" x="14637.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14637.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14637.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14637.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14637.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_ffn_act_13 -->
<g id="node1284" class="node">
<title>layer15_ffn_act_13</title>
<polygon fill="none" stroke="black" points="14958,-494 14809,-494 14809,-458 14958,-458 14958,-494"/>
<text text-anchor="middle" x="14883.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer15_ffn_act_13</text>
</g>
<!-- layer15_ffn_gate_13&#45;&gt;layer15_ffn_act_13 -->
<g id="edge1383" class="edge">
<title>layer15_ffn_gate_13&#45;&gt;layer15_ffn_act_13</title>
<path fill="none" stroke="black" d="M14700.53,-594.89C14747.45,-564.66 14809.78,-524.5 14848.24,-499.72"/>
<polygon fill="black" stroke="black" points="14850.5,-502.43 14857.01,-494.07 14846.71,-496.54 14850.5,-502.43"/>
</g>
<!-- layer15_ffn_gate_14 -->
<g id="node1236" class="node">
<title>layer15_ffn_gate_14</title>
<polygon fill="lightblue" stroke="black" points="15861,-678 15388,-678 15388,-595 15861,-595 15861,-678"/>
<text text-anchor="middle" x="15624.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15624.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15624.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15624.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15624.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_ffn_act_14 -->
<g id="node1289" class="node">
<title>layer15_ffn_act_14</title>
<polygon fill="none" stroke="black" points="15907,-494 15758,-494 15758,-458 15907,-458 15907,-494"/>
<text text-anchor="middle" x="15832.5" y="-472.3" font-family="Times,serif" font-size="14.00">layer15_ffn_act_14</text>
</g>
<!-- layer15_ffn_gate_14&#45;&gt;layer15_ffn_act_14 -->
<g id="edge1394" class="edge">
<title>layer15_ffn_gate_14&#45;&gt;layer15_ffn_act_14</title>
<path fill="none" stroke="black" d="M15677.8,-594.89C15717.13,-564.91 15769.28,-525.18 15801.86,-500.35"/>
<polygon fill="black" stroke="black" points="15804.27,-502.91 15810.1,-494.07 15800.02,-497.35 15804.27,-502.91"/>
</g>
<!-- layer15_ffn_act_15 -->
<g id="node1246" class="node">
<title>layer15_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="17330.24,-559 16573.44,-559 16378.76,-393 17135.56,-393 17330.24,-559"/>
<text text-anchor="middle" x="16854.5" y="-502.3" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="16854.5" y="-487.3" font-family="Times,serif" font-size="14.00">SiLU(gate) * up</text>
<text text-anchor="middle" x="16854.5" y="-472.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16854.5" y="-457.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16854.5" y="-442.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_ffn_gate_15&#45;&gt;layer15_ffn_act_15 -->
<g id="edge1405" class="edge">
<title>layer15_ffn_gate_15&#45;&gt;layer15_ffn_act_15</title>
<path fill="none" stroke="black" d="M16672.28,-594.89C16686.76,-585.52 16702.73,-575.19 16719,-564.66"/>
<polygon fill="black" stroke="black" points="16721.04,-567.51 16727.53,-559.14 16717.23,-561.63 16721.04,-567.51"/>
</g>
<!-- layer15_ffn_up_8 -->
<g id="node1238" class="node">
<title>layer15_ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="10687,-517.5 10214,-517.5 10214,-434.5 10687,-434.5 10687,-517.5"/>
<text text-anchor="middle" x="10450.5" y="-502.3" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10450.5" y="-487.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10450.5" y="-472.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="10450.5" y="-457.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="10450.5" y="-442.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_ffn_up_8&#45;&gt;layer15_ffn_act_8 -->
<g id="edge1329" class="edge">
<title>layer15_ffn_up_8&#45;&gt;layer15_ffn_act_8</title>
<path fill="none" stroke="black" d="M10387.72,-434.39C10341,-404.16 10278.92,-364 10240.62,-339.22"/>
<polygon fill="black" stroke="black" points="10242.18,-336.06 10231.88,-333.57 10238.38,-341.94 10242.18,-336.06"/>
</g>
<!-- layer15_ffn_up_9 -->
<g id="node1239" class="node">
<title>layer15_ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="11363,-678 10890,-678 10890,-595 11363,-595 11363,-678"/>
<text text-anchor="middle" x="11126.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11126.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="11126.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="11126.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="11126.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_ffn_up_9&#45;&gt;layer15_ffn_act_9 -->
<g id="edge1340" class="edge">
<title>layer15_ffn_up_9&#45;&gt;layer15_ffn_act_9</title>
<path fill="none" stroke="black" d="M11066.54,-594.89C11021.91,-564.66 10962.62,-524.5 10926.04,-499.72"/>
<polygon fill="black" stroke="black" points="10927.94,-496.78 10917.7,-494.07 10924.02,-502.58 10927.94,-496.78"/>
</g>
<!-- layer15_ffn_up_10 -->
<g id="node1240" class="node">
<title>layer15_ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="12347,-678 11874,-678 11874,-595 12347,-595 12347,-678"/>
<text text-anchor="middle" x="12110.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12110.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="12110.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="12110.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="12110.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_ffn_up_10&#45;&gt;layer15_ffn_act_10 -->
<g id="edge1351" class="edge">
<title>layer15_ffn_up_10&#45;&gt;layer15_ffn_act_10</title>
<path fill="none" stroke="black" d="M12047.72,-594.89C12001,-564.66 11938.92,-524.5 11900.62,-499.72"/>
<polygon fill="black" stroke="black" points="11902.18,-496.56 11891.88,-494.07 11898.38,-502.44 11902.18,-496.56"/>
</g>
<!-- layer15_ffn_up_11 -->
<g id="node1241" class="node">
<title>layer15_ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="13370,-678 12897,-678 12897,-595 13370,-595 13370,-678"/>
<text text-anchor="middle" x="13133.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13133.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="13133.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="13133.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="13133.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_ffn_up_11&#45;&gt;layer15_ffn_act_11 -->
<g id="edge1362" class="edge">
<title>layer15_ffn_up_11&#45;&gt;layer15_ffn_act_11</title>
<path fill="none" stroke="black" d="M13070.72,-594.89C13024,-564.66 12961.92,-524.5 12923.62,-499.72"/>
<polygon fill="black" stroke="black" points="12925.18,-496.56 12914.88,-494.07 12921.38,-502.44 12925.18,-496.56"/>
</g>
<!-- layer15_ffn_up_12 -->
<g id="node1242" class="node">
<title>layer15_ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="14373,-678 13900,-678 13900,-595 14373,-595 14373,-678"/>
<text text-anchor="middle" x="14136.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14136.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="14136.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="14136.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="14136.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_ffn_up_12&#45;&gt;layer15_ffn_act_12 -->
<g id="edge1373" class="edge">
<title>layer15_ffn_up_12&#45;&gt;layer15_ffn_act_12</title>
<path fill="none" stroke="black" d="M14073.47,-594.89C14026.55,-564.66 13964.22,-524.5 13925.76,-499.72"/>
<polygon fill="black" stroke="black" points="13927.29,-496.54 13916.99,-494.07 13923.5,-502.43 13927.29,-496.54"/>
</g>
<!-- layer15_ffn_up_13 -->
<g id="node1243" class="node">
<title>layer15_ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="15365,-678 14892,-678 14892,-595 15365,-595 15365,-678"/>
<text text-anchor="middle" x="15128.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15128.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="15128.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="15128.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="15128.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_ffn_up_13&#45;&gt;layer15_ffn_act_13 -->
<g id="edge1384" class="edge">
<title>layer15_ffn_up_13&#45;&gt;layer15_ffn_act_13</title>
<path fill="none" stroke="black" d="M15065.72,-594.89C15019,-564.66 14956.92,-524.5 14918.62,-499.72"/>
<polygon fill="black" stroke="black" points="14920.18,-496.56 14909.88,-494.07 14916.38,-502.44 14920.18,-496.56"/>
</g>
<!-- layer15_ffn_up_14 -->
<g id="node1244" class="node">
<title>layer15_ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="16352,-678 15879,-678 15879,-595 16352,-595 16352,-678"/>
<text text-anchor="middle" x="16115.5" y="-662.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16115.5" y="-647.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="16115.5" y="-632.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16115.5" y="-617.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, ffn_hidden=16384/8]</text>
<text text-anchor="middle" x="16115.5" y="-602.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_ffn_up_14&#45;&gt;layer15_ffn_act_14 -->
<g id="edge1395" class="edge">
<title>layer15_ffn_up_14&#45;&gt;layer15_ffn_act_14</title>
<path fill="none" stroke="black" d="M16042.99,-594.89C15988.56,-564.4 15916.1,-523.82 15871.95,-499.1"/>
<polygon fill="black" stroke="black" points="15873.41,-495.9 15862.98,-494.07 15869.99,-502.01 15873.41,-495.9"/>
</g>
<!-- layer15_ffn_up_15&#45;&gt;layer15_ffn_act_15 -->
<g id="edge1406" class="edge">
<title>layer15_ffn_up_15&#45;&gt;layer15_ffn_act_15</title>
<path fill="none" stroke="black" d="M17037.47,-594.89C17022.92,-585.52 17006.89,-575.19 16990.55,-564.66"/>
<polygon fill="black" stroke="black" points="16992.29,-561.61 16981.99,-559.14 16988.5,-567.5 16992.29,-561.61"/>
</g>
<!-- layer15_ffn_down_15 -->
<g id="node1254" class="node">
<title>layer15_ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="17078,-357 16631,-357 16631,-274 17078,-274 17078,-357"/>
<text text-anchor="middle" x="16854.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16854.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 7/8</text>
<text text-anchor="middle" x="16854.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="16854.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="16854.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer15_ffn_act_15&#45;&gt;layer15_ffn_down_15 -->
<g id="edge1407" class="edge">
<title>layer15_ffn_act_15&#45;&gt;layer15_ffn_down_15</title>
<path fill="none" stroke="black" d="M16854.5,-392.96C16854.5,-384.25 16854.5,-375.59 16854.5,-367.39"/>
<polygon fill="black" stroke="black" points="16858,-367.29 16854.5,-357.29 16851,-367.29 16858,-367.29"/>
</g>
<!-- layer15_ffn_down_8 -->
<g id="node1247" class="node">
<title>layer15_ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="10429,-196.5 9982,-196.5 9982,-113.5 10429,-113.5 10429,-196.5"/>
<text text-anchor="middle" x="10205.5" y="-181.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10205.5" y="-166.3" font-family="Times,serif" font-size="14.00">TP Shard 0/8</text>
<text text-anchor="middle" x="10205.5" y="-151.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10205.5" y="-136.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10205.5" y="-121.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer15_res2_8 -->
<g id="node1260" class="node">
<title>layer15_res2_8</title>
<polygon fill="none" stroke="black" points="10268,-36 10143,-36 10143,0 10268,0 10268,-36"/>
<text text-anchor="middle" x="10205.5" y="-14.3" font-family="Times,serif" font-size="14.00">layer15_res2_8</text>
</g>
<!-- layer15_ffn_down_8&#45;&gt;layer15_res2_8 -->
<g id="edge1331" class="edge">
<title>layer15_ffn_down_8&#45;&gt;layer15_res2_8</title>
<path fill="none" stroke="black" d="M10205.5,-113.5C10205.5,-91.84 10205.5,-65.75 10205.5,-46.47"/>
<polygon fill="black" stroke="black" points="10209,-46.26 10205.5,-36.27 10202,-46.27 10209,-46.26"/>
</g>
<!-- layer15_ffn_down_9 -->
<g id="node1248" class="node">
<title>layer15_ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="11116,-357 10669,-357 10669,-274 11116,-274 11116,-357"/>
<text text-anchor="middle" x="10892.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10892.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 1/8</text>
<text text-anchor="middle" x="10892.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="10892.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="10892.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer15_res2_9 -->
<g id="node1265" class="node">
<title>layer15_res2_9</title>
<polygon fill="none" stroke="black" points="10955,-173 10830,-173 10830,-137 10955,-137 10955,-173"/>
<text text-anchor="middle" x="10892.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer15_res2_9</text>
</g>
<!-- layer15_ffn_down_9&#45;&gt;layer15_res2_9 -->
<g id="edge1342" class="edge">
<title>layer15_ffn_down_9&#45;&gt;layer15_res2_9</title>
<path fill="none" stroke="black" d="M10892.5,-273.68C10892.5,-245.24 10892.5,-208.08 10892.5,-183.2"/>
<polygon fill="black" stroke="black" points="10896,-183.02 10892.5,-173.02 10889,-183.02 10896,-183.02"/>
</g>
<!-- layer15_ffn_down_10 -->
<g id="node1249" class="node">
<title>layer15_ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="12089,-357 11642,-357 11642,-274 12089,-274 12089,-357"/>
<text text-anchor="middle" x="11865.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11865.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 2/8</text>
<text text-anchor="middle" x="11865.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="11865.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="11865.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer15_res2_10 -->
<g id="node1270" class="node">
<title>layer15_res2_10</title>
<polygon fill="none" stroke="black" points="11932.5,-173 11798.5,-173 11798.5,-137 11932.5,-137 11932.5,-173"/>
<text text-anchor="middle" x="11865.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer15_res2_10</text>
</g>
<!-- layer15_ffn_down_10&#45;&gt;layer15_res2_10 -->
<g id="edge1353" class="edge">
<title>layer15_ffn_down_10&#45;&gt;layer15_res2_10</title>
<path fill="none" stroke="black" d="M11865.5,-273.68C11865.5,-245.24 11865.5,-208.08 11865.5,-183.2"/>
<polygon fill="black" stroke="black" points="11869,-183.02 11865.5,-173.02 11862,-183.02 11869,-183.02"/>
</g>
<!-- layer15_ffn_down_11 -->
<g id="node1250" class="node">
<title>layer15_ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="13112,-357 12665,-357 12665,-274 13112,-274 13112,-357"/>
<text text-anchor="middle" x="12888.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12888.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 3/8</text>
<text text-anchor="middle" x="12888.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="12888.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="12888.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer15_res2_11 -->
<g id="node1275" class="node">
<title>layer15_res2_11</title>
<polygon fill="none" stroke="black" points="12955.5,-173 12821.5,-173 12821.5,-137 12955.5,-137 12955.5,-173"/>
<text text-anchor="middle" x="12888.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer15_res2_11</text>
</g>
<!-- layer15_ffn_down_11&#45;&gt;layer15_res2_11 -->
<g id="edge1364" class="edge">
<title>layer15_ffn_down_11&#45;&gt;layer15_res2_11</title>
<path fill="none" stroke="black" d="M12888.5,-273.68C12888.5,-245.24 12888.5,-208.08 12888.5,-183.2"/>
<polygon fill="black" stroke="black" points="12892,-183.02 12888.5,-173.02 12885,-183.02 12892,-183.02"/>
</g>
<!-- layer15_ffn_down_12 -->
<g id="node1251" class="node">
<title>layer15_ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="14114,-357 13667,-357 13667,-274 14114,-274 14114,-357"/>
<text text-anchor="middle" x="13890.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13890.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 4/8</text>
<text text-anchor="middle" x="13890.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="13890.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="13890.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer15_res2_12 -->
<g id="node1280" class="node">
<title>layer15_res2_12</title>
<polygon fill="none" stroke="black" points="13957.5,-173 13823.5,-173 13823.5,-137 13957.5,-137 13957.5,-173"/>
<text text-anchor="middle" x="13890.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer15_res2_12</text>
</g>
<!-- layer15_ffn_down_12&#45;&gt;layer15_res2_12 -->
<g id="edge1375" class="edge">
<title>layer15_ffn_down_12&#45;&gt;layer15_res2_12</title>
<path fill="none" stroke="black" d="M13890.5,-273.68C13890.5,-245.24 13890.5,-208.08 13890.5,-183.2"/>
<polygon fill="black" stroke="black" points="13894,-183.02 13890.5,-173.02 13887,-183.02 13894,-183.02"/>
</g>
<!-- layer15_ffn_down_13 -->
<g id="node1252" class="node">
<title>layer15_ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="15107,-357 14660,-357 14660,-274 15107,-274 15107,-357"/>
<text text-anchor="middle" x="14883.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14883.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 5/8</text>
<text text-anchor="middle" x="14883.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="14883.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="14883.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer15_res2_13 -->
<g id="node1285" class="node">
<title>layer15_res2_13</title>
<polygon fill="none" stroke="black" points="14950.5,-173 14816.5,-173 14816.5,-137 14950.5,-137 14950.5,-173"/>
<text text-anchor="middle" x="14883.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer15_res2_13</text>
</g>
<!-- layer15_ffn_down_13&#45;&gt;layer15_res2_13 -->
<g id="edge1386" class="edge">
<title>layer15_ffn_down_13&#45;&gt;layer15_res2_13</title>
<path fill="none" stroke="black" d="M14883.5,-273.68C14883.5,-245.24 14883.5,-208.08 14883.5,-183.2"/>
<polygon fill="black" stroke="black" points="14887,-183.02 14883.5,-173.02 14880,-183.02 14887,-183.02"/>
</g>
<!-- layer15_ffn_down_14 -->
<g id="node1253" class="node">
<title>layer15_ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="16056,-357 15609,-357 15609,-274 16056,-274 16056,-357"/>
<text text-anchor="middle" x="15832.5" y="-341.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15832.5" y="-326.8" font-family="Times,serif" font-size="14.00">TP Shard 6/8</text>
<text text-anchor="middle" x="15832.5" y="-311.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, ffn_hidden=16384]</text>
<text text-anchor="middle" x="15832.5" y="-296.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096/8]</text>
<text text-anchor="middle" x="15832.5" y="-281.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer15_res2_14 -->
<g id="node1290" class="node">
<title>layer15_res2_14</title>
<polygon fill="none" stroke="black" points="15899.5,-173 15765.5,-173 15765.5,-137 15899.5,-137 15899.5,-173"/>
<text text-anchor="middle" x="15832.5" y="-151.3" font-family="Times,serif" font-size="14.00">layer15_res2_14</text>
</g>
<!-- layer15_ffn_down_14&#45;&gt;layer15_res2_14 -->
<g id="edge1397" class="edge">
<title>layer15_ffn_down_14&#45;&gt;layer15_res2_14</title>
<path fill="none" stroke="black" d="M15832.5,-273.68C15832.5,-245.24 15832.5,-208.08 15832.5,-183.2"/>
<polygon fill="black" stroke="black" points="15836,-183.02 15832.5,-173.02 15829,-183.02 15836,-183.02"/>
</g>
<!-- layer15_res2_15 -->
<g id="node1255" class="node">
<title>layer15_res2_15</title>
<polygon fill="none" stroke="black" points="17295.24,-238 16594.12,-238 16413.76,-72 17114.88,-72 17295.24,-238"/>
<text text-anchor="middle" x="16854.5" y="-181.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16854.5" y="-166.3" font-family="Times,serif" font-size="14.00">Input1: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16854.5" y="-151.3" font-family="Times,serif" font-size="14.00">Input2: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16854.5" y="-136.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="16854.5" y="-121.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer15_ffn_down_15&#45;&gt;layer15_res2_15 -->
<g id="edge1408" class="edge">
<title>layer15_ffn_down_15&#45;&gt;layer15_res2_15</title>
<path fill="none" stroke="black" d="M16854.5,-273.68C16854.5,-265.75 16854.5,-257.14 16854.5,-248.31"/>
<polygon fill="black" stroke="black" points="16858,-248.27 16854.5,-238.27 16851,-248.27 16858,-248.27"/>
</g>
<!-- layer15_mha_attn_8&#45;&gt;layer15_mha_out_8 -->
<g id="edge1323" class="edge">
<title>layer15_mha_attn_8&#45;&gt;layer15_mha_out_8</title>
<path fill="none" stroke="black" d="M10317.5,-1043.24C10317.5,-1021.68 10317.5,-983.87 10317.5,-952.79"/>
<polygon fill="black" stroke="black" points="10321,-952.54 10317.5,-942.54 10314,-952.54 10321,-952.54"/>
</g>
<!-- layer15_ln1_8 -->
<g id="node1258" class="node">
<title>layer15_ln1_8</title>
<polygon fill="none" stroke="black" points="10375.5,-654.5 10259.5,-654.5 10259.5,-618.5 10375.5,-618.5 10375.5,-654.5"/>
<text text-anchor="middle" x="10317.5" y="-632.8" font-family="Times,serif" font-size="14.00">layer15_ln1_8</text>
</g>
<!-- layer15_res1_8&#45;&gt;layer15_ln1_8 -->
<g id="edge1325" class="edge">
<title>layer15_res1_8&#45;&gt;layer15_ln1_8</title>
<path fill="none" stroke="black" d="M10317.5,-729.89C10317.5,-712.56 10317.5,-685.46 10317.5,-665.09"/>
<polygon fill="black" stroke="black" points="10321,-664.85 10317.5,-654.85 10314,-664.85 10321,-664.85"/>
</g>
<!-- layer15_ln1_8&#45;&gt;layer15_ffn_gate_8 -->
<g id="edge1326" class="edge">
<title>layer15_ln1_8&#45;&gt;layer15_ffn_gate_8</title>
<path fill="none" stroke="black" d="M10278.85,-618.39C10227,-595.43 10133.07,-553.85 10060.45,-521.69"/>
<polygon fill="black" stroke="black" points="10061.81,-518.47 10051.25,-517.62 10058.98,-524.87 10061.81,-518.47"/>
</g>
<!-- layer15_ln1_8&#45;&gt;layer15_ffn_up_8 -->
<g id="edge1327" class="edge">
<title>layer15_ln1_8&#45;&gt;layer15_ffn_up_8</title>
<path fill="none" stroke="black" d="M10331.99,-618.24C10350.54,-596.12 10383.47,-556.88 10409.91,-525.37"/>
<polygon fill="black" stroke="black" points="10412.74,-527.45 10416.48,-517.54 10407.38,-522.95 10412.74,-527.45"/>
</g>
<!-- layer15_ffn_act_8&#45;&gt;layer15_ffn_down_8 -->
<g id="edge1330" class="edge">
<title>layer15_ffn_act_8&#45;&gt;layer15_ffn_down_8</title>
<path fill="none" stroke="black" d="M10205.5,-297.24C10205.5,-275.68 10205.5,-237.87 10205.5,-206.79"/>
<polygon fill="black" stroke="black" points="10209,-206.54 10205.5,-196.54 10202,-206.54 10209,-206.54"/>
</g>
<!-- layer15_mha_attn_9&#45;&gt;layer15_mha_out_9 -->
<g id="edge1334" class="edge">
<title>layer15_mha_attn_9&#45;&gt;layer15_mha_out_9</title>
<path fill="none" stroke="black" d="M10697.5,-1203.74C10697.5,-1182.18 10697.5,-1144.37 10697.5,-1113.29"/>
<polygon fill="black" stroke="black" points="10701,-1113.04 10697.5,-1103.04 10694,-1113.04 10701,-1113.04"/>
</g>
<!-- layer15_ln1_9 -->
<g id="node1263" class="node">
<title>layer15_ln1_9</title>
<polygon fill="none" stroke="black" points="10755.5,-766 10639.5,-766 10639.5,-730 10755.5,-730 10755.5,-766"/>
<text text-anchor="middle" x="10697.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_ln1_9</text>
</g>
<!-- layer15_res1_9&#45;&gt;layer15_ln1_9 -->
<g id="edge1336" class="edge">
<title>layer15_res1_9&#45;&gt;layer15_ln1_9</title>
<path fill="none" stroke="black" d="M10697.5,-882.97C10697.5,-857.03 10697.5,-807.36 10697.5,-776.33"/>
<polygon fill="black" stroke="black" points="10701,-776.2 10697.5,-766.2 10694,-776.2 10701,-776.2"/>
</g>
<!-- layer15_ln1_9&#45;&gt;layer15_ffn_gate_9 -->
<g id="edge1337" class="edge">
<title>layer15_ln1_9&#45;&gt;layer15_ffn_gate_9</title>
<path fill="none" stroke="black" d="M10687.81,-729.89C10681.26,-718.33 10672.26,-702.42 10663.56,-687.06"/>
<polygon fill="black" stroke="black" points="10666.47,-685.1 10658.5,-678.12 10660.38,-688.54 10666.47,-685.1"/>
</g>
<!-- layer15_ln1_9&#45;&gt;layer15_ffn_up_9 -->
<g id="edge1338" class="edge">
<title>layer15_ln1_9&#45;&gt;layer15_ffn_up_9</title>
<path fill="none" stroke="black" d="M10755.8,-732.12C10807.66,-718.88 10886.12,-698.86 10957.52,-680.63"/>
<polygon fill="black" stroke="black" points="10958.72,-683.94 10967.55,-678.07 10956.99,-677.15 10958.72,-683.94"/>
</g>
<!-- layer15_ffn_act_9&#45;&gt;layer15_ffn_down_9 -->
<g id="edge1341" class="edge">
<title>layer15_ffn_act_9&#45;&gt;layer15_ffn_down_9</title>
<path fill="none" stroke="black" d="M10892.5,-457.74C10892.5,-436.18 10892.5,-398.37 10892.5,-367.29"/>
<polygon fill="black" stroke="black" points="10896,-367.04 10892.5,-357.04 10889,-367.04 10896,-367.04"/>
</g>
<!-- layer15_mha_attn_10&#45;&gt;layer15_mha_out_10 -->
<g id="edge1345" class="edge">
<title>layer15_mha_attn_10&#45;&gt;layer15_mha_out_10</title>
<path fill="none" stroke="black" d="M11621.5,-1203.74C11621.5,-1182.18 11621.5,-1144.37 11621.5,-1113.29"/>
<polygon fill="black" stroke="black" points="11625,-1113.04 11621.5,-1103.04 11618,-1113.04 11625,-1113.04"/>
</g>
<!-- layer15_ln1_10 -->
<g id="node1268" class="node">
<title>layer15_ln1_10</title>
<polygon fill="none" stroke="black" points="11684,-766 11559,-766 11559,-730 11684,-730 11684,-766"/>
<text text-anchor="middle" x="11621.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_ln1_10</text>
</g>
<!-- layer15_res1_10&#45;&gt;layer15_ln1_10 -->
<g id="edge1347" class="edge">
<title>layer15_res1_10&#45;&gt;layer15_ln1_10</title>
<path fill="none" stroke="black" d="M11621.5,-882.97C11621.5,-857.03 11621.5,-807.36 11621.5,-776.33"/>
<polygon fill="black" stroke="black" points="11625,-776.2 11621.5,-766.2 11618,-776.2 11625,-776.2"/>
</g>
<!-- layer15_ln1_10&#45;&gt;layer15_ffn_gate_10 -->
<g id="edge1348" class="edge">
<title>layer15_ln1_10&#45;&gt;layer15_ffn_gate_10</title>
<path fill="none" stroke="black" d="M11621.19,-729.89C11620.98,-718.65 11620.7,-703.31 11620.43,-688.35"/>
<polygon fill="black" stroke="black" points="11623.92,-688.05 11620.24,-678.12 11616.93,-688.18 11623.92,-688.05"/>
</g>
<!-- layer15_ln1_10&#45;&gt;layer15_ffn_up_10 -->
<g id="edge1349" class="edge">
<title>layer15_ln1_10&#45;&gt;layer15_ffn_up_10</title>
<path fill="none" stroke="black" d="M11684.43,-732.91C11743.85,-719.6 11836.06,-698.95 11919.53,-680.26"/>
<polygon fill="black" stroke="black" points="11920.4,-683.65 11929.4,-678.05 11918.87,-676.82 11920.4,-683.65"/>
</g>
<!-- layer15_ffn_act_10&#45;&gt;layer15_ffn_down_10 -->
<g id="edge1352" class="edge">
<title>layer15_ffn_act_10&#45;&gt;layer15_ffn_down_10</title>
<path fill="none" stroke="black" d="M11865.5,-457.74C11865.5,-436.18 11865.5,-398.37 11865.5,-367.29"/>
<polygon fill="black" stroke="black" points="11869,-367.04 11865.5,-357.04 11862,-367.04 11869,-367.04"/>
</g>
<!-- layer15_mha_attn_11&#45;&gt;layer15_mha_out_11 -->
<g id="edge1356" class="edge">
<title>layer15_mha_attn_11&#45;&gt;layer15_mha_out_11</title>
<path fill="none" stroke="black" d="M12878.5,-1203.74C12878.5,-1182.18 12878.5,-1144.37 12878.5,-1113.29"/>
<polygon fill="black" stroke="black" points="12882,-1113.04 12878.5,-1103.04 12875,-1113.04 12882,-1113.04"/>
</g>
<!-- layer15_ln1_11 -->
<g id="node1273" class="node">
<title>layer15_ln1_11</title>
<polygon fill="none" stroke="black" points="12941,-766 12816,-766 12816,-730 12941,-730 12941,-766"/>
<text text-anchor="middle" x="12878.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_ln1_11</text>
</g>
<!-- layer15_res1_11&#45;&gt;layer15_ln1_11 -->
<g id="edge1358" class="edge">
<title>layer15_res1_11&#45;&gt;layer15_ln1_11</title>
<path fill="none" stroke="black" d="M12878.5,-882.97C12878.5,-857.03 12878.5,-807.36 12878.5,-776.33"/>
<polygon fill="black" stroke="black" points="12882,-776.2 12878.5,-766.2 12875,-776.2 12882,-776.2"/>
</g>
<!-- layer15_ln1_11&#45;&gt;layer15_ffn_gate_11 -->
<g id="edge1359" class="edge">
<title>layer15_ln1_11&#45;&gt;layer15_ffn_gate_11</title>
<path fill="none" stroke="black" d="M12841.62,-729.89C12814.08,-717.11 12775.1,-699.02 12738.92,-682.24"/>
<polygon fill="black" stroke="black" points="12740.34,-679.04 12729.79,-678 12737.39,-685.39 12740.34,-679.04"/>
</g>
<!-- layer15_ln1_11&#45;&gt;layer15_ffn_up_11 -->
<g id="edge1360" class="edge">
<title>layer15_ln1_11&#45;&gt;layer15_ffn_up_11</title>
<path fill="none" stroke="black" d="M12918.34,-729.89C12948.23,-717.06 12990.58,-698.87 13029.81,-682.02"/>
<polygon fill="black" stroke="black" points="13031.37,-685.16 13039.18,-678 13028.61,-678.73 13031.37,-685.16"/>
</g>
<!-- layer15_ffn_act_11&#45;&gt;layer15_ffn_down_11 -->
<g id="edge1363" class="edge">
<title>layer15_ffn_act_11&#45;&gt;layer15_ffn_down_11</title>
<path fill="none" stroke="black" d="M12888.5,-457.74C12888.5,-436.18 12888.5,-398.37 12888.5,-367.29"/>
<polygon fill="black" stroke="black" points="12892,-367.04 12888.5,-357.04 12885,-367.04 12892,-367.04"/>
</g>
<!-- layer15_mha_attn_12&#45;&gt;layer15_mha_out_12 -->
<g id="edge1367" class="edge">
<title>layer15_mha_attn_12&#45;&gt;layer15_mha_out_12</title>
<path fill="none" stroke="black" d="M13984.5,-1203.74C13984.5,-1182.18 13984.5,-1144.37 13984.5,-1113.29"/>
<polygon fill="black" stroke="black" points="13988,-1113.04 13984.5,-1103.04 13981,-1113.04 13988,-1113.04"/>
</g>
<!-- layer15_ln1_12 -->
<g id="node1278" class="node">
<title>layer15_ln1_12</title>
<polygon fill="none" stroke="black" points="14047,-766 13922,-766 13922,-730 14047,-730 14047,-766"/>
<text text-anchor="middle" x="13984.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_ln1_12</text>
</g>
<!-- layer15_res1_12&#45;&gt;layer15_ln1_12 -->
<g id="edge1369" class="edge">
<title>layer15_res1_12&#45;&gt;layer15_ln1_12</title>
<path fill="none" stroke="black" d="M13984.5,-882.97C13984.5,-857.03 13984.5,-807.36 13984.5,-776.33"/>
<polygon fill="black" stroke="black" points="13988,-776.2 13984.5,-766.2 13981,-776.2 13988,-776.2"/>
</g>
<!-- layer15_ln1_12&#45;&gt;layer15_ffn_gate_12 -->
<g id="edge1370" class="edge">
<title>layer15_ln1_12&#45;&gt;layer15_ffn_gate_12</title>
<path fill="none" stroke="black" d="M13931.53,-729.89C13891.12,-716.84 13833.59,-698.25 13780.7,-681.17"/>
<polygon fill="black" stroke="black" points="13781.48,-677.74 13770.89,-678 13779.33,-684.41 13781.48,-677.74"/>
</g>
<!-- layer15_ln1_12&#45;&gt;layer15_ffn_up_12 -->
<g id="edge1371" class="edge">
<title>layer15_ln1_12&#45;&gt;layer15_ffn_up_12</title>
<path fill="none" stroke="black" d="M14008.25,-729.89C14025.35,-717.57 14049.3,-700.32 14071.88,-684.05"/>
<polygon fill="black" stroke="black" points="14074.05,-686.8 14080.12,-678.12 14069.96,-681.12 14074.05,-686.8"/>
</g>
<!-- layer15_ffn_act_12&#45;&gt;layer15_ffn_down_12 -->
<g id="edge1374" class="edge">
<title>layer15_ffn_act_12&#45;&gt;layer15_ffn_down_12</title>
<path fill="none" stroke="black" d="M13890.5,-457.74C13890.5,-436.18 13890.5,-398.37 13890.5,-367.29"/>
<polygon fill="black" stroke="black" points="13894,-367.04 13890.5,-357.04 13887,-367.04 13894,-367.04"/>
</g>
<!-- layer15_mha_attn_13&#45;&gt;layer15_mha_out_13 -->
<g id="edge1378" class="edge">
<title>layer15_mha_attn_13&#45;&gt;layer15_mha_out_13</title>
<path fill="none" stroke="black" d="M14767.5,-1203.74C14767.5,-1182.18 14767.5,-1144.37 14767.5,-1113.29"/>
<polygon fill="black" stroke="black" points="14771,-1113.04 14767.5,-1103.04 14764,-1113.04 14771,-1113.04"/>
</g>
<!-- layer15_ln1_13 -->
<g id="node1283" class="node">
<title>layer15_ln1_13</title>
<polygon fill="none" stroke="black" points="14830,-766 14705,-766 14705,-730 14830,-730 14830,-766"/>
<text text-anchor="middle" x="14767.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_ln1_13</text>
</g>
<!-- layer15_res1_13&#45;&gt;layer15_ln1_13 -->
<g id="edge1380" class="edge">
<title>layer15_res1_13&#45;&gt;layer15_ln1_13</title>
<path fill="none" stroke="black" d="M14767.5,-882.97C14767.5,-857.03 14767.5,-807.36 14767.5,-776.33"/>
<polygon fill="black" stroke="black" points="14771,-776.2 14767.5,-766.2 14764,-776.2 14771,-776.2"/>
</g>
<!-- layer15_ln1_13&#45;&gt;layer15_ffn_gate_13 -->
<g id="edge1381" class="edge">
<title>layer15_ln1_13&#45;&gt;layer15_ffn_gate_13</title>
<path fill="none" stroke="black" d="M14747.19,-729.89C14732.75,-717.73 14712.62,-700.77 14693.53,-684.7"/>
<polygon fill="black" stroke="black" points="14695.63,-681.88 14685.72,-678.12 14691.12,-687.24 14695.63,-681.88"/>
</g>
<!-- layer15_ln1_13&#45;&gt;layer15_ffn_up_13 -->
<g id="edge1382" class="edge">
<title>layer15_ln1_13&#45;&gt;layer15_ffn_up_13</title>
<path fill="none" stroke="black" d="M14823.91,-729.89C14867.12,-716.78 14928.71,-698.1 14985.22,-680.96"/>
<polygon fill="black" stroke="black" points="14986.42,-684.25 14994.97,-678 14984.39,-677.55 14986.42,-684.25"/>
</g>
<!-- layer15_ffn_act_13&#45;&gt;layer15_ffn_down_13 -->
<g id="edge1385" class="edge">
<title>layer15_ffn_act_13&#45;&gt;layer15_ffn_down_13</title>
<path fill="none" stroke="black" d="M14883.5,-457.74C14883.5,-436.18 14883.5,-398.37 14883.5,-367.29"/>
<polygon fill="black" stroke="black" points="14887,-367.04 14883.5,-357.04 14880,-367.04 14887,-367.04"/>
</g>
<!-- layer15_mha_attn_14&#45;&gt;layer15_mha_out_14 -->
<g id="edge1389" class="edge">
<title>layer15_mha_attn_14&#45;&gt;layer15_mha_out_14</title>
<path fill="none" stroke="black" d="M16034.5,-1203.74C16034.5,-1182.18 16034.5,-1144.37 16034.5,-1113.29"/>
<polygon fill="black" stroke="black" points="16038,-1113.04 16034.5,-1103.04 16031,-1113.04 16038,-1113.04"/>
</g>
<!-- layer15_ln1_14 -->
<g id="node1288" class="node">
<title>layer15_ln1_14</title>
<polygon fill="none" stroke="black" points="16097,-766 15972,-766 15972,-730 16097,-730 16097,-766"/>
<text text-anchor="middle" x="16034.5" y="-744.3" font-family="Times,serif" font-size="14.00">layer15_ln1_14</text>
</g>
<!-- layer15_res1_14&#45;&gt;layer15_ln1_14 -->
<g id="edge1391" class="edge">
<title>layer15_res1_14&#45;&gt;layer15_ln1_14</title>
<path fill="none" stroke="black" d="M16034.5,-882.97C16034.5,-857.03 16034.5,-807.36 16034.5,-776.33"/>
<polygon fill="black" stroke="black" points="16038,-776.2 16034.5,-766.2 16031,-776.2 16038,-776.2"/>
</g>
<!-- layer15_ln1_14&#45;&gt;layer15_ffn_gate_14 -->
<g id="edge1392" class="edge">
<title>layer15_ln1_14&#45;&gt;layer15_ffn_gate_14</title>
<path fill="none" stroke="black" d="M15971.78,-730.25C15922.39,-717.06 15851.25,-698.06 15786.2,-680.69"/>
<polygon fill="black" stroke="black" points="15786.8,-677.22 15776.23,-678.02 15784.99,-683.99 15786.8,-677.22"/>
</g>
<!-- layer15_ln1_14&#45;&gt;layer15_ffn_up_14 -->
<g id="edge1393" class="edge">
<title>layer15_ln1_14&#45;&gt;layer15_ffn_up_14</title>
<path fill="none" stroke="black" d="M16047.16,-729.89C16055.87,-718.11 16067.92,-701.82 16079.48,-686.2"/>
<polygon fill="black" stroke="black" points="16082.32,-688.24 16085.45,-678.12 16076.69,-684.08 16082.32,-688.24"/>
</g>
<!-- layer15_ffn_act_14&#45;&gt;layer15_ffn_down_14 -->
<g id="edge1396" class="edge">
<title>layer15_ffn_act_14&#45;&gt;layer15_ffn_down_14</title>
<path fill="none" stroke="black" d="M15832.5,-457.74C15832.5,-436.18 15832.5,-398.37 15832.5,-367.29"/>
<polygon fill="black" stroke="black" points="15836,-367.04 15832.5,-357.04 15829,-367.04 15836,-367.04"/>
</g>
<!-- output -->
<g id="node1291" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="17870.5" cy="-11125" rx="300.54" ry="26.74"/>
<text text-anchor="middle" x="17870.5" y="-11128.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="17870.5" y="-11113.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- layer7_ffn2_7 -->
<g id="node1292" class="node">
<title>layer7_ffn2_7</title>
<polygon fill="none" stroke="black" points="9846.5,-11273.87 9734.5,-11273.87 9734.5,-11237.87 9846.5,-11237.87 9846.5,-11273.87"/>
<text text-anchor="middle" x="9790.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer7_ffn2_7</text>
</g>
<!-- layer7_ffn2_7&#45;&gt;stage0_to_stage1 -->
<g id="edge1410" class="edge">
<title>layer7_ffn2_7&#45;&gt;stage0_to_stage1</title>
<path fill="none" stroke="black" d="M9790.5,-11237.76C9790.5,-11228.43 9790.5,-11216.15 9790.5,-11203.15"/>
<polygon fill="black" stroke="black" points="9794,-11203.11 9790.5,-11193.11 9787,-11203.11 9794,-11203.11"/>
</g>
<!-- layer15_ffn2_15 -->
<g id="node1293" class="node">
<title>layer15_ffn2_15</title>
<polygon fill="none" stroke="black" points="17935.5,-11273.87 17805.5,-11273.87 17805.5,-11237.87 17935.5,-11237.87 17935.5,-11273.87"/>
<text text-anchor="middle" x="17870.5" y="-11252.17" font-family="Times,serif" font-size="14.00">layer15_ffn2_15</text>
</g>
<!-- layer15_ffn2_15&#45;&gt;output -->
<g id="edge1412" class="edge">
<title>layer15_ffn2_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M17870.5,-11237.76C17870.5,-11218.59 17870.5,-11186.96 17870.5,-11162.24"/>
<polygon fill="black" stroke="black" points="17874,-11162.12 17870.5,-11152.12 17867,-11162.12 17874,-11162.12"/>
</g>
</g>
</svg>
