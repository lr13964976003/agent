{
  "model_deployment": {
    "models": {
      "baseline": {
        "name": "dense_16layer_baseline",
        "parallel_strategy": {
          "type": "tensor_parallelism_plus_pipeline",
          "tensor_parallel_size": 8,
          "pipeline_parallel_size": 2,
          "total_devices": 16
        },
        "modules": {
          "stage_0": {
            "layers": [0, 1, 2, 3, 4, 5, 6, 7],
            "tensor_parallel_ranks": [0, 1, 2, 3, 4, 5, 6, 7],
            "pipeline_stage_id": 0
          },
          "stage_1": {
            "layers": [8, 9, 10, 11, 12, 13, 14, 15],
            "tensor_parallel_ranks": [8, 9, 10, 11, 12, 13, 14, 15],
            "pipeline_stage_id": 1
          }
        },
        "device_mapping": {
          "0": {"stage": 0, "tp_rank": 0},
          "1": {"stage": 0, "tp_rank": 1},
          "2": {"stage": 0, "tp_rank": 2},
          "3": {"stage": 0, "tp_rank": 3},
          "4": {"stage": 0, "tp_rank": 4},
          "5": {"stage": 0, "tp_rank": 5},
          "6": {"stage": 0, "tp_rank": 6},
          "7": {"stage": 0, "tp_rank": 7},
          "8": {"stage": 1, "tp_rank": 0},
          "9": {"stage": 1, "tp_rank": 1},
          "10": {"stage": 1, "tp_rank": 2},
          "11": {"stage": 1, "tp_rank": 3},
          "12": {"stage": 1, "tp_rank": 4},
          "13": {"stage": 1, "tp_rank": 5},
          "14": {"stage": 1, "tp_rank": 6},
          "15": {"stage": 1, "tp_rank": 7}
        }
      },
      "proposed": {
        "name": "dense_16layer_layerwise",
        "parallel_strategy": {
          "type": "layerwise_partitioning",
          "total_devices": 16,
          "cache_capacity_mb": 50,
          "partitioning_method": "greedy_layer_aggregation"
        },
        "memory_estimation": {
          "precision": "bf16",
          "bytes_per_parameter": 2,
          "total_model_size_gb": 60,
          "layers_total": 16,
          "per_layer_weights_gb": 3.75,
          "activation_memory_per_layer_gb": 5.24,
          "total_per_layer_gb": 9.5,
          "cache_constraint_mb": 50
        },
        "modules": {
          "partition_0": {
            "layers": [0],
            "layer_indices": [0],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_1": {
            "layers": [1],
            "layer_indices": [1],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_2": {
            "layers": [2],
            "layer_indices": [2],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_3": {
            "layers": [3],
            "layer_indices": [3],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_4": {
            "layers": [4],
            "layer_indices": [4],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_5": {
            "layers": [5],
            "layer_indices": [5],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_6": {
            "layers": [6],
            "layer_indices": [6],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_7": {
            "layers": [7],
            "layer_indices": [7],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_8": {
            "layers": [8],
            "layer_indices": [8],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_9": {
            "layers": [9],
            "layer_indices": [9],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_10": {
            "layers": [10],
            "layer_indices": [10],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_11": {
            "layers": [11],
            "layer_indices": [11],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_12": {
            "layers": [12],
            "layer_indices": [12],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_13": {
            "layers": [13],
            "layer_indices": [13],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_14": {
            "layers": [14],
            "layer_indices": [14],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          },
          "partition_15": {
            "layers": [15],
            "layer_indices": [15],
            "estimated_memory_gb": 9.5,
            "requires_optimization": true,
            "parameters": {
              "weight_size_bytes": 3750000000,
              "activation_size_bytes": 5242880000,
              "buffer_size_bytes": 500000000
            }
          }
        },
        "device_mapping": {
          "0": {"partition_id": 0, "layers": [0], "memory_optimization": "gradient_checkpointing"},
          "1": {"partition_id": 1, "layers": [1], "memory_optimization": "gradient_checkpointing"},
          "2": {"partition_id": 2, "layers": [2], "memory_optimization": "gradient_checkpointing"},
          "3": {"partition_id": 3, "layers": [3], "memory_optimization": "gradient_checkpointing"},
          "4": {"partition_id": 4, "layers": [4], "memory_optimization": "gradient_checkpointing"},
          "5": {"partition_id": 5, "layers": [5], "memory_optimization": "gradient_checkpointing"},
          "6": {"partition_id": 6, "layers": [6], "memory_optimization": "gradient_checkpointing"},
          "7": {"partition_id": 7, "layers": [7], "memory_optimization": "gradient_checkpointing"},
          "8": {"partition_id": 8, "layers": [8], "memory_optimization": "gradient_checkpointing"},
          "9": {"partition_id": 9, "layers": [9], "memory_optimization": "gradient_checkpointing"},
          "10": {"partition_id": 10, "layers": [10], "memory_optimization": "gradient_checkpointing"},
          "11": {"partition_id": 11, "layers": [11], "memory_optimization": "gradient_checkpointing"},
          "12": {"partition_id": 12, "layers": [12], "memory_optimization": "gradient_checkpointing"},
          "13": {"partition_id": 13, "layers": [13], "memory_optimization": "gradient_checkpointing"},
          "14": {"partition_id": 14, "layers": [14], "memory_optimization": "gradient_checkpointing"},
          "15": {"partition_id": 15, "layers": [15], "memory_optimization": "gradient_checkpointing"}
        },
        "optimization_strategies": {
          "activation_recomputation": true,
          "gradient_checkpointing": true,
          "batch_size_tuning": {
            "original": 128,
            "optimized": 8,
            "reduction_factor": 16
          },
          "memory_compression": {
            "quantization": "none",
            "pruning": "none"
          }
        },
        "communication_strategy": {
          "inter_partition": "direct_transfer",
          "buffer_size": "activation_size",
          "overlap_communication": true,
          "pipeline_schedule": "sequential"
        }
      }
    }
  }
}