<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline Pages: 1 -->
<svg width="609pt" height="3724pt"
 viewBox="0.00 0.00 609.04 3723.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3719.71)">
<title>baseline_tensor_pipeline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3719.71 605.04,-3719.71 605.04,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="87.52,-1944.55 87.52,-3611.55 513.52,-3611.55 513.52,-1944.55 87.52,-1944.55"/>
<text text-anchor="middle" x="300.52" y="-3596.35" font-family="Times,serif" font-size="14.00">Stage 0 &#45; GPUs 0&#45;7 (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="87.52,-124.17 87.52,-1791.17 513.52,-1791.17 513.52,-124.17 87.52,-124.17"/>
<text text-anchor="middle" x="300.52" y="-1775.97" font-family="Times,serif" font-size="14.00">Stage 1 &#45; GPUs 8&#45;15 (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="300.52" cy="-3667.63" rx="300.54" ry="48.17"/>
<text text-anchor="middle" x="300.52" y="-3686.43" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="300.52" y="-3671.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3656.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3641.43" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- layer0_mha -->
<g id="node2" class="node">
<title>layer0_mha</title>
<polygon fill="none" stroke="black" points="505.02,-3580.55 96.02,-3580.55 96.02,-3512.55 505.02,-3512.55 505.02,-3580.55"/>
<text text-anchor="middle" x="300.52" y="-3565.35" font-family="Times,serif" font-size="14.00">Layer 0 MHA</text>
<text text-anchor="middle" x="300.52" y="-3550.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-3535.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-3520.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;layer0_mha -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_mha</title>
<path fill="none" stroke="black" d="M300.52,-3619.22C300.52,-3609.89 300.52,-3600.15 300.52,-3590.95"/>
<polygon fill="black" stroke="black" points="304.02,-3590.86 300.52,-3580.86 297.02,-3590.86 304.02,-3590.86"/>
</g>
<!-- layer0_ffn -->
<g id="node3" class="node">
<title>layer0_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-3476.55 119.52,-3476.55 119.52,-3408.55 481.52,-3408.55 481.52,-3476.55"/>
<text text-anchor="middle" x="300.52" y="-3461.35" font-family="Times,serif" font-size="14.00">Layer 0 FFN</text>
<text text-anchor="middle" x="300.52" y="-3446.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3431.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3416.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_mha&#45;&gt;layer0_ffn -->
<g id="edge2" class="edge">
<title>layer0_mha&#45;&gt;layer0_ffn</title>
<path fill="none" stroke="black" d="M300.52,-3512.43C300.52,-3504.32 300.52,-3495.53 300.52,-3487.02"/>
<polygon fill="black" stroke="black" points="304.02,-3486.85 300.52,-3476.85 297.02,-3486.85 304.02,-3486.85"/>
</g>
<!-- layer1_mha -->
<g id="node4" class="node">
<title>layer1_mha</title>
<polygon fill="none" stroke="black" points="505.02,-3372.55 96.02,-3372.55 96.02,-3304.55 505.02,-3304.55 505.02,-3372.55"/>
<text text-anchor="middle" x="300.52" y="-3357.35" font-family="Times,serif" font-size="14.00">Layer 1 MHA</text>
<text text-anchor="middle" x="300.52" y="-3342.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-3327.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-3312.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_ffn&#45;&gt;layer1_mha -->
<g id="edge3" class="edge">
<title>layer0_ffn&#45;&gt;layer1_mha</title>
<path fill="none" stroke="black" d="M300.52,-3408.43C300.52,-3400.32 300.52,-3391.53 300.52,-3383.02"/>
<polygon fill="black" stroke="black" points="304.02,-3382.85 300.52,-3372.85 297.02,-3382.85 304.02,-3382.85"/>
</g>
<!-- layer1_ffn -->
<g id="node5" class="node">
<title>layer1_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-3268.55 119.52,-3268.55 119.52,-3200.55 481.52,-3200.55 481.52,-3268.55"/>
<text text-anchor="middle" x="300.52" y="-3253.35" font-family="Times,serif" font-size="14.00">Layer 1 FFN</text>
<text text-anchor="middle" x="300.52" y="-3238.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3223.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3208.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_mha&#45;&gt;layer1_ffn -->
<g id="edge4" class="edge">
<title>layer1_mha&#45;&gt;layer1_ffn</title>
<path fill="none" stroke="black" d="M300.52,-3304.43C300.52,-3296.32 300.52,-3287.53 300.52,-3279.02"/>
<polygon fill="black" stroke="black" points="304.02,-3278.85 300.52,-3268.85 297.02,-3278.85 304.02,-3278.85"/>
</g>
<!-- layer2_mha -->
<g id="node6" class="node">
<title>layer2_mha</title>
<polygon fill="none" stroke="black" points="505.02,-3164.55 96.02,-3164.55 96.02,-3096.55 505.02,-3096.55 505.02,-3164.55"/>
<text text-anchor="middle" x="300.52" y="-3149.35" font-family="Times,serif" font-size="14.00">Layer 2 MHA</text>
<text text-anchor="middle" x="300.52" y="-3134.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-3119.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-3104.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer1_ffn&#45;&gt;layer2_mha -->
<g id="edge5" class="edge">
<title>layer1_ffn&#45;&gt;layer2_mha</title>
<path fill="none" stroke="black" d="M300.52,-3200.43C300.52,-3192.32 300.52,-3183.53 300.52,-3175.02"/>
<polygon fill="black" stroke="black" points="304.02,-3174.85 300.52,-3164.85 297.02,-3174.85 304.02,-3174.85"/>
</g>
<!-- layer2_ffn -->
<g id="node7" class="node">
<title>layer2_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-3060.55 119.52,-3060.55 119.52,-2992.55 481.52,-2992.55 481.52,-3060.55"/>
<text text-anchor="middle" x="300.52" y="-3045.35" font-family="Times,serif" font-size="14.00">Layer 2 FFN</text>
<text text-anchor="middle" x="300.52" y="-3030.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3015.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-3000.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer2_mha&#45;&gt;layer2_ffn -->
<g id="edge6" class="edge">
<title>layer2_mha&#45;&gt;layer2_ffn</title>
<path fill="none" stroke="black" d="M300.52,-3096.43C300.52,-3088.32 300.52,-3079.53 300.52,-3071.02"/>
<polygon fill="black" stroke="black" points="304.02,-3070.85 300.52,-3060.85 297.02,-3070.85 304.02,-3070.85"/>
</g>
<!-- layer3_mha -->
<g id="node8" class="node">
<title>layer3_mha</title>
<polygon fill="none" stroke="black" points="505.02,-2956.55 96.02,-2956.55 96.02,-2888.55 505.02,-2888.55 505.02,-2956.55"/>
<text text-anchor="middle" x="300.52" y="-2941.35" font-family="Times,serif" font-size="14.00">Layer 3 MHA</text>
<text text-anchor="middle" x="300.52" y="-2926.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2911.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2896.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer2_ffn&#45;&gt;layer3_mha -->
<g id="edge7" class="edge">
<title>layer2_ffn&#45;&gt;layer3_mha</title>
<path fill="none" stroke="black" d="M300.52,-2992.43C300.52,-2984.32 300.52,-2975.53 300.52,-2967.02"/>
<polygon fill="black" stroke="black" points="304.02,-2966.85 300.52,-2956.85 297.02,-2966.85 304.02,-2966.85"/>
</g>
<!-- layer3_ffn -->
<g id="node9" class="node">
<title>layer3_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-2852.55 119.52,-2852.55 119.52,-2784.55 481.52,-2784.55 481.52,-2852.55"/>
<text text-anchor="middle" x="300.52" y="-2837.35" font-family="Times,serif" font-size="14.00">Layer 3 FFN</text>
<text text-anchor="middle" x="300.52" y="-2822.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2807.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2792.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer3_mha&#45;&gt;layer3_ffn -->
<g id="edge8" class="edge">
<title>layer3_mha&#45;&gt;layer3_ffn</title>
<path fill="none" stroke="black" d="M300.52,-2888.43C300.52,-2880.32 300.52,-2871.53 300.52,-2863.02"/>
<polygon fill="black" stroke="black" points="304.02,-2862.85 300.52,-2852.85 297.02,-2862.85 304.02,-2862.85"/>
</g>
<!-- layer4_mha -->
<g id="node10" class="node">
<title>layer4_mha</title>
<polygon fill="none" stroke="black" points="505.02,-2748.55 96.02,-2748.55 96.02,-2680.55 505.02,-2680.55 505.02,-2748.55"/>
<text text-anchor="middle" x="300.52" y="-2733.35" font-family="Times,serif" font-size="14.00">Layer 4 MHA</text>
<text text-anchor="middle" x="300.52" y="-2718.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2703.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2688.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer3_ffn&#45;&gt;layer4_mha -->
<g id="edge9" class="edge">
<title>layer3_ffn&#45;&gt;layer4_mha</title>
<path fill="none" stroke="black" d="M300.52,-2784.43C300.52,-2776.32 300.52,-2767.53 300.52,-2759.02"/>
<polygon fill="black" stroke="black" points="304.02,-2758.85 300.52,-2748.85 297.02,-2758.85 304.02,-2758.85"/>
</g>
<!-- layer4_ffn -->
<g id="node11" class="node">
<title>layer4_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-2644.55 119.52,-2644.55 119.52,-2576.55 481.52,-2576.55 481.52,-2644.55"/>
<text text-anchor="middle" x="300.52" y="-2629.35" font-family="Times,serif" font-size="14.00">Layer 4 FFN</text>
<text text-anchor="middle" x="300.52" y="-2614.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2599.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2584.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer4_mha&#45;&gt;layer4_ffn -->
<g id="edge10" class="edge">
<title>layer4_mha&#45;&gt;layer4_ffn</title>
<path fill="none" stroke="black" d="M300.52,-2680.43C300.52,-2672.32 300.52,-2663.53 300.52,-2655.02"/>
<polygon fill="black" stroke="black" points="304.02,-2654.85 300.52,-2644.85 297.02,-2654.85 304.02,-2654.85"/>
</g>
<!-- layer5_mha -->
<g id="node12" class="node">
<title>layer5_mha</title>
<polygon fill="none" stroke="black" points="505.02,-2540.55 96.02,-2540.55 96.02,-2472.55 505.02,-2472.55 505.02,-2540.55"/>
<text text-anchor="middle" x="300.52" y="-2525.35" font-family="Times,serif" font-size="14.00">Layer 5 MHA</text>
<text text-anchor="middle" x="300.52" y="-2510.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2495.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2480.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer4_ffn&#45;&gt;layer5_mha -->
<g id="edge11" class="edge">
<title>layer4_ffn&#45;&gt;layer5_mha</title>
<path fill="none" stroke="black" d="M300.52,-2576.43C300.52,-2568.32 300.52,-2559.53 300.52,-2551.02"/>
<polygon fill="black" stroke="black" points="304.02,-2550.85 300.52,-2540.85 297.02,-2550.85 304.02,-2550.85"/>
</g>
<!-- layer5_ffn -->
<g id="node13" class="node">
<title>layer5_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-2436.55 119.52,-2436.55 119.52,-2368.55 481.52,-2368.55 481.52,-2436.55"/>
<text text-anchor="middle" x="300.52" y="-2421.35" font-family="Times,serif" font-size="14.00">Layer 5 FFN</text>
<text text-anchor="middle" x="300.52" y="-2406.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2391.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2376.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer5_mha&#45;&gt;layer5_ffn -->
<g id="edge12" class="edge">
<title>layer5_mha&#45;&gt;layer5_ffn</title>
<path fill="none" stroke="black" d="M300.52,-2472.43C300.52,-2464.32 300.52,-2455.53 300.52,-2447.02"/>
<polygon fill="black" stroke="black" points="304.02,-2446.85 300.52,-2436.85 297.02,-2446.85 304.02,-2446.85"/>
</g>
<!-- layer6_mha -->
<g id="node14" class="node">
<title>layer6_mha</title>
<polygon fill="none" stroke="black" points="505.02,-2332.55 96.02,-2332.55 96.02,-2264.55 505.02,-2264.55 505.02,-2332.55"/>
<text text-anchor="middle" x="300.52" y="-2317.35" font-family="Times,serif" font-size="14.00">Layer 6 MHA</text>
<text text-anchor="middle" x="300.52" y="-2302.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2287.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2272.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer5_ffn&#45;&gt;layer6_mha -->
<g id="edge13" class="edge">
<title>layer5_ffn&#45;&gt;layer6_mha</title>
<path fill="none" stroke="black" d="M300.52,-2368.43C300.52,-2360.32 300.52,-2351.53 300.52,-2343.02"/>
<polygon fill="black" stroke="black" points="304.02,-2342.85 300.52,-2332.85 297.02,-2342.85 304.02,-2342.85"/>
</g>
<!-- layer6_ffn -->
<g id="node15" class="node">
<title>layer6_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-2228.55 119.52,-2228.55 119.52,-2160.55 481.52,-2160.55 481.52,-2228.55"/>
<text text-anchor="middle" x="300.52" y="-2213.35" font-family="Times,serif" font-size="14.00">Layer 6 FFN</text>
<text text-anchor="middle" x="300.52" y="-2198.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2183.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-2168.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer6_mha&#45;&gt;layer6_ffn -->
<g id="edge14" class="edge">
<title>layer6_mha&#45;&gt;layer6_ffn</title>
<path fill="none" stroke="black" d="M300.52,-2264.43C300.52,-2256.32 300.52,-2247.53 300.52,-2239.02"/>
<polygon fill="black" stroke="black" points="304.02,-2238.85 300.52,-2228.85 297.02,-2238.85 304.02,-2238.85"/>
</g>
<!-- layer7_mha -->
<g id="node16" class="node">
<title>layer7_mha</title>
<polygon fill="none" stroke="black" points="505.02,-2124.55 96.02,-2124.55 96.02,-2056.55 505.02,-2056.55 505.02,-2124.55"/>
<text text-anchor="middle" x="300.52" y="-2109.35" font-family="Times,serif" font-size="14.00">Layer 7 MHA</text>
<text text-anchor="middle" x="300.52" y="-2094.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2079.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-2064.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer6_ffn&#45;&gt;layer7_mha -->
<g id="edge15" class="edge">
<title>layer6_ffn&#45;&gt;layer7_mha</title>
<path fill="none" stroke="black" d="M300.52,-2160.43C300.52,-2152.32 300.52,-2143.53 300.52,-2135.02"/>
<polygon fill="black" stroke="black" points="304.02,-2134.85 300.52,-2124.85 297.02,-2134.85 304.02,-2134.85"/>
</g>
<!-- layer7_ffn -->
<g id="node17" class="node">
<title>layer7_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-2020.55 119.52,-2020.55 119.52,-1952.55 481.52,-1952.55 481.52,-2020.55"/>
<text text-anchor="middle" x="300.52" y="-2005.35" font-family="Times,serif" font-size="14.00">Layer 7 FFN</text>
<text text-anchor="middle" x="300.52" y="-1990.35" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1975.35" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1960.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer7_mha&#45;&gt;layer7_ffn -->
<g id="edge16" class="edge">
<title>layer7_mha&#45;&gt;layer7_ffn</title>
<path fill="none" stroke="black" d="M300.52,-2056.43C300.52,-2048.32 300.52,-2039.53 300.52,-2031.02"/>
<polygon fill="black" stroke="black" points="304.02,-2030.85 300.52,-2020.85 297.02,-2030.85 304.02,-2030.85"/>
</g>
<!-- comm_stage0_to_stage1 -->
<g id="node18" class="node">
<title>comm_stage0_to_stage1</title>
<ellipse fill="none" stroke="black" cx="300.52" cy="-1857.86" rx="255.95" ry="58.88"/>
<text text-anchor="middle" x="300.52" y="-1884.16" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="300.52" y="-1869.16" font-family="Times,serif" font-size="14.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="300.52" y="-1854.16" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1839.16" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1824.16" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 → 8&#45;15</text>
</g>
<!-- layer7_ffn&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge17" class="edge">
<title>layer7_ffn&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M300.52,-1952.26C300.52,-1944.46 300.52,-1935.87 300.52,-1927.16"/>
<polygon fill="black" stroke="black" points="304.02,-1926.91 300.52,-1916.91 297.02,-1926.91 304.02,-1926.91"/>
</g>
<!-- layer8_mha -->
<g id="node19" class="node">
<title>layer8_mha</title>
<polygon fill="none" stroke="black" points="505.02,-1760.17 96.02,-1760.17 96.02,-1692.17 505.02,-1692.17 505.02,-1760.17"/>
<text text-anchor="middle" x="300.52" y="-1744.97" font-family="Times,serif" font-size="14.00">Layer 8 MHA</text>
<text text-anchor="middle" x="300.52" y="-1729.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1714.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1699.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;layer8_mha -->
<g id="edge18" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;layer8_mha</title>
<path fill="none" stroke="black" d="M300.52,-1798.84C300.52,-1789.24 300.52,-1779.43 300.52,-1770.28"/>
<polygon fill="black" stroke="black" points="304.02,-1770.27 300.52,-1760.27 297.02,-1770.27 304.02,-1770.27"/>
</g>
<!-- layer8_ffn -->
<g id="node20" class="node">
<title>layer8_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-1656.17 119.52,-1656.17 119.52,-1588.17 481.52,-1588.17 481.52,-1656.17"/>
<text text-anchor="middle" x="300.52" y="-1640.97" font-family="Times,serif" font-size="14.00">Layer 8 FFN</text>
<text text-anchor="middle" x="300.52" y="-1625.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1610.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1595.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer8_mha&#45;&gt;layer8_ffn -->
<g id="edge19" class="edge">
<title>layer8_mha&#45;&gt;layer8_ffn</title>
<path fill="none" stroke="black" d="M300.52,-1692.05C300.52,-1683.94 300.52,-1675.15 300.52,-1666.64"/>
<polygon fill="black" stroke="black" points="304.02,-1666.47 300.52,-1656.47 297.02,-1666.47 304.02,-1666.47"/>
</g>
<!-- layer9_mha -->
<g id="node21" class="node">
<title>layer9_mha</title>
<polygon fill="none" stroke="black" points="505.02,-1552.17 96.02,-1552.17 96.02,-1484.17 505.02,-1484.17 505.02,-1552.17"/>
<text text-anchor="middle" x="300.52" y="-1536.97" font-family="Times,serif" font-size="14.00">Layer 9 MHA</text>
<text text-anchor="middle" x="300.52" y="-1521.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1506.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1491.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer8_ffn&#45;&gt;layer9_mha -->
<g id="edge20" class="edge">
<title>layer8_ffn&#45;&gt;layer9_mha</title>
<path fill="none" stroke="black" d="M300.52,-1588.05C300.52,-1579.94 300.52,-1571.15 300.52,-1562.64"/>
<polygon fill="black" stroke="black" points="304.02,-1562.47 300.52,-1552.47 297.02,-1562.47 304.02,-1562.47"/>
</g>
<!-- layer9_ffn -->
<g id="node22" class="node">
<title>layer9_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-1448.17 119.52,-1448.17 119.52,-1380.17 481.52,-1380.17 481.52,-1448.17"/>
<text text-anchor="middle" x="300.52" y="-1432.97" font-family="Times,serif" font-size="14.00">Layer 9 FFN</text>
<text text-anchor="middle" x="300.52" y="-1417.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1402.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1387.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer9_mha&#45;&gt;layer9_ffn -->
<g id="edge21" class="edge">
<title>layer9_mha&#45;&gt;layer9_ffn</title>
<path fill="none" stroke="black" d="M300.52,-1484.05C300.52,-1475.94 300.52,-1467.15 300.52,-1458.64"/>
<polygon fill="black" stroke="black" points="304.02,-1458.47 300.52,-1448.47 297.02,-1458.47 304.02,-1458.47"/>
</g>
<!-- layer10_mha -->
<g id="node23" class="node">
<title>layer10_mha</title>
<polygon fill="none" stroke="black" points="505.02,-1344.17 96.02,-1344.17 96.02,-1276.17 505.02,-1276.17 505.02,-1344.17"/>
<text text-anchor="middle" x="300.52" y="-1328.97" font-family="Times,serif" font-size="14.00">Layer 10 MHA</text>
<text text-anchor="middle" x="300.52" y="-1313.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1298.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1283.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer9_ffn&#45;&gt;layer10_mha -->
<g id="edge22" class="edge">
<title>layer9_ffn&#45;&gt;layer10_mha</title>
<path fill="none" stroke="black" d="M300.52,-1380.05C300.52,-1371.94 300.52,-1363.15 300.52,-1354.64"/>
<polygon fill="black" stroke="black" points="304.02,-1354.47 300.52,-1344.47 297.02,-1354.47 304.02,-1354.47"/>
</g>
<!-- layer10_ffn -->
<g id="node24" class="node">
<title>layer10_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-1240.17 119.52,-1240.17 119.52,-1172.17 481.52,-1172.17 481.52,-1240.17"/>
<text text-anchor="middle" x="300.52" y="-1224.97" font-family="Times,serif" font-size="14.00">Layer 10 FFN</text>
<text text-anchor="middle" x="300.52" y="-1209.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1194.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-1179.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer10_mha&#45;&gt;layer10_ffn -->
<g id="edge23" class="edge">
<title>layer10_mha&#45;&gt;layer10_ffn</title>
<path fill="none" stroke="black" d="M300.52,-1276.05C300.52,-1267.94 300.52,-1259.15 300.52,-1250.64"/>
<polygon fill="black" stroke="black" points="304.02,-1250.47 300.52,-1240.47 297.02,-1250.47 304.02,-1250.47"/>
</g>
<!-- layer11_mha -->
<g id="node25" class="node">
<title>layer11_mha</title>
<polygon fill="none" stroke="black" points="505.02,-1136.17 96.02,-1136.17 96.02,-1068.17 505.02,-1068.17 505.02,-1136.17"/>
<text text-anchor="middle" x="300.52" y="-1120.97" font-family="Times,serif" font-size="14.00">Layer 11 MHA</text>
<text text-anchor="middle" x="300.52" y="-1105.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1090.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-1075.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer10_ffn&#45;&gt;layer11_mha -->
<g id="edge24" class="edge">
<title>layer10_ffn&#45;&gt;layer11_mha</title>
<path fill="none" stroke="black" d="M300.52,-1172.05C300.52,-1163.94 300.52,-1155.15 300.52,-1146.64"/>
<polygon fill="black" stroke="black" points="304.02,-1146.47 300.52,-1136.47 297.02,-1146.47 304.02,-1146.47"/>
</g>
<!-- layer11_ffn -->
<g id="node26" class="node">
<title>layer11_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-1032.17 119.52,-1032.17 119.52,-964.17 481.52,-964.17 481.52,-1032.17"/>
<text text-anchor="middle" x="300.52" y="-1016.97" font-family="Times,serif" font-size="14.00">Layer 11 FFN</text>
<text text-anchor="middle" x="300.52" y="-1001.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-986.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-971.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer11_mha&#45;&gt;layer11_ffn -->
<g id="edge25" class="edge">
<title>layer11_mha&#45;&gt;layer11_ffn</title>
<path fill="none" stroke="black" d="M300.52,-1068.05C300.52,-1059.94 300.52,-1051.15 300.52,-1042.64"/>
<polygon fill="black" stroke="black" points="304.02,-1042.47 300.52,-1032.47 297.02,-1042.47 304.02,-1042.47"/>
</g>
<!-- layer12_mha -->
<g id="node27" class="node">
<title>layer12_mha</title>
<polygon fill="none" stroke="black" points="505.02,-928.17 96.02,-928.17 96.02,-860.17 505.02,-860.17 505.02,-928.17"/>
<text text-anchor="middle" x="300.52" y="-912.97" font-family="Times,serif" font-size="14.00">Layer 12 MHA</text>
<text text-anchor="middle" x="300.52" y="-897.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-882.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-867.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer11_ffn&#45;&gt;layer12_mha -->
<g id="edge26" class="edge">
<title>layer11_ffn&#45;&gt;layer12_mha</title>
<path fill="none" stroke="black" d="M300.52,-964.05C300.52,-955.94 300.52,-947.15 300.52,-938.64"/>
<polygon fill="black" stroke="black" points="304.02,-938.47 300.52,-928.47 297.02,-938.47 304.02,-938.47"/>
</g>
<!-- layer12_ffn -->
<g id="node28" class="node">
<title>layer12_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-824.17 119.52,-824.17 119.52,-756.17 481.52,-756.17 481.52,-824.17"/>
<text text-anchor="middle" x="300.52" y="-808.97" font-family="Times,serif" font-size="14.00">Layer 12 FFN</text>
<text text-anchor="middle" x="300.52" y="-793.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-778.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-763.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer12_mha&#45;&gt;layer12_ffn -->
<g id="edge27" class="edge">
<title>layer12_mha&#45;&gt;layer12_ffn</title>
<path fill="none" stroke="black" d="M300.52,-860.05C300.52,-851.94 300.52,-843.15 300.52,-834.64"/>
<polygon fill="black" stroke="black" points="304.02,-834.47 300.52,-824.47 297.02,-834.47 304.02,-834.47"/>
</g>
<!-- layer13_mha -->
<g id="node29" class="node">
<title>layer13_mha</title>
<polygon fill="none" stroke="black" points="505.02,-720.17 96.02,-720.17 96.02,-652.17 505.02,-652.17 505.02,-720.17"/>
<text text-anchor="middle" x="300.52" y="-704.97" font-family="Times,serif" font-size="14.00">Layer 13 MHA</text>
<text text-anchor="middle" x="300.52" y="-689.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-674.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-659.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer12_ffn&#45;&gt;layer13_mha -->
<g id="edge28" class="edge">
<title>layer12_ffn&#45;&gt;layer13_mha</title>
<path fill="none" stroke="black" d="M300.52,-756.05C300.52,-747.94 300.52,-739.15 300.52,-730.64"/>
<polygon fill="black" stroke="black" points="304.02,-730.47 300.52,-720.47 297.02,-730.47 304.02,-730.47"/>
</g>
<!-- layer13_ffn -->
<g id="node30" class="node">
<title>layer13_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-616.17 119.52,-616.17 119.52,-548.17 481.52,-548.17 481.52,-616.17"/>
<text text-anchor="middle" x="300.52" y="-600.97" font-family="Times,serif" font-size="14.00">Layer 13 FFN</text>
<text text-anchor="middle" x="300.52" y="-585.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-570.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-555.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer13_mha&#45;&gt;layer13_ffn -->
<g id="edge29" class="edge">
<title>layer13_mha&#45;&gt;layer13_ffn</title>
<path fill="none" stroke="black" d="M300.52,-652.05C300.52,-643.94 300.52,-635.15 300.52,-626.64"/>
<polygon fill="black" stroke="black" points="304.02,-626.47 300.52,-616.47 297.02,-626.47 304.02,-626.47"/>
</g>
<!-- layer14_mha -->
<g id="node31" class="node">
<title>layer14_mha</title>
<polygon fill="none" stroke="black" points="505.02,-512.17 96.02,-512.17 96.02,-444.17 505.02,-444.17 505.02,-512.17"/>
<text text-anchor="middle" x="300.52" y="-496.97" font-family="Times,serif" font-size="14.00">Layer 14 MHA</text>
<text text-anchor="middle" x="300.52" y="-481.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-466.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-451.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer13_ffn&#45;&gt;layer14_mha -->
<g id="edge30" class="edge">
<title>layer13_ffn&#45;&gt;layer14_mha</title>
<path fill="none" stroke="black" d="M300.52,-548.05C300.52,-539.94 300.52,-531.15 300.52,-522.64"/>
<polygon fill="black" stroke="black" points="304.02,-522.47 300.52,-512.47 297.02,-522.47 304.02,-522.47"/>
</g>
<!-- layer14_ffn -->
<g id="node32" class="node">
<title>layer14_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-408.17 119.52,-408.17 119.52,-340.17 481.52,-340.17 481.52,-408.17"/>
<text text-anchor="middle" x="300.52" y="-392.97" font-family="Times,serif" font-size="14.00">Layer 14 FFN</text>
<text text-anchor="middle" x="300.52" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer14_mha&#45;&gt;layer14_ffn -->
<g id="edge31" class="edge">
<title>layer14_mha&#45;&gt;layer14_ffn</title>
<path fill="none" stroke="black" d="M300.52,-444.05C300.52,-435.94 300.52,-427.15 300.52,-418.64"/>
<polygon fill="black" stroke="black" points="304.02,-418.47 300.52,-408.47 297.02,-418.47 304.02,-418.47"/>
</g>
<!-- layer15_mha -->
<g id="node33" class="node">
<title>layer15_mha</title>
<polygon fill="none" stroke="black" points="505.02,-304.17 96.02,-304.17 96.02,-236.17 505.02,-236.17 505.02,-304.17"/>
<text text-anchor="middle" x="300.52" y="-288.97" font-family="Times,serif" font-size="14.00">Layer 15 MHA</text>
<text text-anchor="middle" x="300.52" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="300.52" y="-243.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer14_ffn&#45;&gt;layer15_mha -->
<g id="edge32" class="edge">
<title>layer14_ffn&#45;&gt;layer15_mha</title>
<path fill="none" stroke="black" d="M300.52,-340.05C300.52,-331.94 300.52,-323.15 300.52,-314.64"/>
<polygon fill="black" stroke="black" points="304.02,-314.47 300.52,-304.47 297.02,-314.47 304.02,-314.47"/>
</g>
<!-- layer15_ffn -->
<g id="node34" class="node">
<title>layer15_ffn</title>
<polygon fill="none" stroke="black" points="481.52,-200.17 119.52,-200.17 119.52,-132.17 481.52,-132.17 481.52,-200.17"/>
<text text-anchor="middle" x="300.52" y="-184.97" font-family="Times,serif" font-size="14.00">Layer 15 FFN</text>
<text text-anchor="middle" x="300.52" y="-169.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer15_mha&#45;&gt;layer15_ffn -->
<g id="edge33" class="edge">
<title>layer15_mha&#45;&gt;layer15_ffn</title>
<path fill="none" stroke="black" d="M300.52,-236.05C300.52,-227.94 300.52,-219.15 300.52,-210.64"/>
<polygon fill="black" stroke="black" points="304.02,-210.47 300.52,-200.47 297.02,-210.47 304.02,-210.47"/>
</g>
<!-- output -->
<g id="node35" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="300.52" cy="-48.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="300.52" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="300.52" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="300.52" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer15_ffn&#45;&gt;output -->
<g id="edge34" class="edge">
<title>layer15_ffn&#45;&gt;output</title>
<path fill="none" stroke="black" d="M300.52,-131.9C300.52,-123.91 300.52,-115.14 300.52,-106.4"/>
<polygon fill="black" stroke="black" points="304.02,-106.19 300.52,-96.19 297.02,-106.19 304.02,-106.19"/>
</g>
</g>
</svg>
