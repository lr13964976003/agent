<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_deployment Pages: 1 -->
<svg width="720pt" height="2566pt"
 viewBox="0.00 0.00 720.00 2566.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2562.07)">
<title>baseline_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2562.07 716,-2562.07 716,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-1355.12 8,-2475.12 704,-2475.12 704,-1355.12 8,-1355.12"/>
<text text-anchor="middle" x="356" y="-2459.92" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="356" y="-2444.92" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;7</text>
<text text-anchor="middle" x="356" y="-2429.92" font-family="Times,serif" font-size="14.00">Tensor Parallel Size: 8</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-124.17 8,-1244.17 704,-1244.17 704,-124.17 8,-124.17"/>
<text text-anchor="middle" x="356" y="-1228.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="356" y="-1213.97" font-family="Times,serif" font-size="14.00">GPUs: 8&#45;15</text>
<text text-anchor="middle" x="356" y="-1198.97" font-family="Times,serif" font-size="14.00">Tensor Parallel Size: 8</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="lightblue" stroke="black" cx="356" cy="-2520.6" rx="316.15" ry="37.45"/>
<text text-anchor="middle" x="356" y="-2531.9" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="356" y="-2516.9" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
<text text-anchor="middle" x="356" y="-2501.9" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- Layer0_Attn_QKV -->
<g id="node2" class="node">
<title>Layer0_Attn_QKV</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-2414.12 254.5,-2414.12 254.5,-2346.12 457.5,-2346.12 457.5,-2414.12"/>
<text text-anchor="middle" x="356" y="-2398.92" font-family="Times,serif" font-size="14.00">Layer 0: QKV Linear</text>
<text text-anchor="middle" x="356" y="-2383.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-2368.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-2353.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Input&#45;&gt;Layer0_Attn_QKV -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Layer0_Attn_QKV</title>
<path fill="none" stroke="black" d="M356,-2482.85C356,-2464.87 356,-2443.1 356,-2424.33"/>
<polygon fill="black" stroke="black" points="359.5,-2424.25 356,-2414.25 352.5,-2424.25 359.5,-2424.25"/>
</g>
<!-- Layer0_Attn_Score -->
<g id="node3" class="node">
<title>Layer0_Attn_Score</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-2310.12 254.5,-2310.12 254.5,-2242.12 457.5,-2242.12 457.5,-2310.12"/>
<text text-anchor="middle" x="356" y="-2294.92" font-family="Times,serif" font-size="14.00">Layer 0: Attention Score</text>
<text text-anchor="middle" x="356" y="-2279.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-2264.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-2249.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer0_Attn_QKV&#45;&gt;Layer0_Attn_Score -->
<g id="edge2" class="edge">
<title>Layer0_Attn_QKV&#45;&gt;Layer0_Attn_Score</title>
<path fill="none" stroke="black" d="M356,-2346C356,-2337.9 356,-2329.1 356,-2320.59"/>
<polygon fill="black" stroke="black" points="359.5,-2320.42 356,-2310.42 352.5,-2320.42 359.5,-2320.42"/>
</g>
<!-- Layer0_Attn_Out -->
<g id="node4" class="node">
<title>Layer0_Attn_Out</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-2206.12 254.5,-2206.12 254.5,-2138.12 457.5,-2138.12 457.5,-2206.12"/>
<text text-anchor="middle" x="356" y="-2190.92" font-family="Times,serif" font-size="14.00">Layer 0: Output Linear</text>
<text text-anchor="middle" x="356" y="-2175.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-2160.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-2145.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer0_Attn_Score&#45;&gt;Layer0_Attn_Out -->
<g id="edge3" class="edge">
<title>Layer0_Attn_Score&#45;&gt;Layer0_Attn_Out</title>
<path fill="none" stroke="black" d="M356,-2242C356,-2233.9 356,-2225.1 356,-2216.59"/>
<polygon fill="black" stroke="black" points="359.5,-2216.42 356,-2206.42 352.5,-2216.42 359.5,-2216.42"/>
</g>
<!-- Layer0_Add1 -->
<g id="node5" class="node">
<title>Layer0_Add1</title>
<polygon fill="orange" stroke="black" points="696.11,-2102.12 155.07,-2102.12 15.89,-1966.12 556.93,-1966.12 696.11,-2102.12"/>
<text text-anchor="middle" x="356" y="-2052.92" font-family="Times,serif" font-size="14.00">Layer 0: Residual Add</text>
<text text-anchor="middle" x="356" y="-2037.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-2022.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-2007.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer0_Attn_Out&#45;&gt;Layer0_Add1 -->
<g id="edge4" class="edge">
<title>Layer0_Attn_Out&#45;&gt;Layer0_Add1</title>
<path fill="none" stroke="black" d="M356,-2137.85C356,-2130.02 356,-2121.36 356,-2112.47"/>
<polygon fill="black" stroke="black" points="359.5,-2112.38 356,-2102.38 352.5,-2112.38 359.5,-2112.38"/>
</g>
<!-- Layer0_MLP_Dense1 -->
<g id="node6" class="node">
<title>Layer0_MLP_Dense1</title>
<polygon fill="lightgreen" stroke="black" points="462,-1930.12 250,-1930.12 250,-1862.12 462,-1862.12 462,-1930.12"/>
<text text-anchor="middle" x="356" y="-1914.92" font-family="Times,serif" font-size="14.00">Layer 0: MLP Dense 1</text>
<text text-anchor="middle" x="356" y="-1899.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-1884.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-1869.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
</g>
<!-- Layer0_Add1&#45;&gt;Layer0_MLP_Dense1 -->
<g id="edge5" class="edge">
<title>Layer0_Add1&#45;&gt;Layer0_MLP_Dense1</title>
<path fill="none" stroke="black" d="M356,-1965.92C356,-1957.16 356,-1948.4 356,-1940.19"/>
<polygon fill="black" stroke="black" points="359.5,-1940.14 356,-1930.14 352.5,-1940.14 359.5,-1940.14"/>
</g>
<!-- Layer0_MLP_Activation -->
<g id="node7" class="node">
<title>Layer0_MLP_Activation</title>
<polygon fill="lightgreen" stroke="black" points="462,-1826.12 250,-1826.12 250,-1758.12 462,-1758.12 462,-1826.12"/>
<text text-anchor="middle" x="356" y="-1810.92" font-family="Times,serif" font-size="14.00">Layer 0: MLP GELU</text>
<text text-anchor="middle" x="356" y="-1795.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-1780.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="356" y="-1765.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
</g>
<!-- Layer0_MLP_Dense1&#45;&gt;Layer0_MLP_Activation -->
<g id="edge6" class="edge">
<title>Layer0_MLP_Dense1&#45;&gt;Layer0_MLP_Activation</title>
<path fill="none" stroke="black" d="M356,-1862C356,-1853.9 356,-1845.1 356,-1836.59"/>
<polygon fill="black" stroke="black" points="359.5,-1836.42 356,-1826.42 352.5,-1836.42 359.5,-1836.42"/>
</g>
<!-- Layer0_MLP_Dense2 -->
<g id="node8" class="node">
<title>Layer0_MLP_Dense2</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-1722.12 254.5,-1722.12 254.5,-1654.12 457.5,-1654.12 457.5,-1722.12"/>
<text text-anchor="middle" x="356" y="-1706.92" font-family="Times,serif" font-size="14.00">Layer 0: MLP Dense 2</text>
<text text-anchor="middle" x="356" y="-1691.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-1676.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="356" y="-1661.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer0_MLP_Activation&#45;&gt;Layer0_MLP_Dense2 -->
<g id="edge7" class="edge">
<title>Layer0_MLP_Activation&#45;&gt;Layer0_MLP_Dense2</title>
<path fill="none" stroke="black" d="M356,-1758C356,-1749.9 356,-1741.1 356,-1732.59"/>
<polygon fill="black" stroke="black" points="359.5,-1732.42 356,-1722.42 352.5,-1732.42 359.5,-1732.42"/>
</g>
<!-- Layer0_Add2 -->
<g id="node9" class="node">
<title>Layer0_Add2</title>
<polygon fill="orange" stroke="black" points="696.11,-1618.12 155.07,-1618.12 15.89,-1482.12 556.93,-1482.12 696.11,-1618.12"/>
<text text-anchor="middle" x="356" y="-1568.92" font-family="Times,serif" font-size="14.00">Layer 0: Residual Add</text>
<text text-anchor="middle" x="356" y="-1553.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-1538.92" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-1523.92" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer0_MLP_Dense2&#45;&gt;Layer0_Add2 -->
<g id="edge8" class="edge">
<title>Layer0_MLP_Dense2&#45;&gt;Layer0_Add2</title>
<path fill="none" stroke="black" d="M356,-1653.85C356,-1646.02 356,-1637.36 356,-1628.47"/>
<polygon fill="black" stroke="black" points="359.5,-1628.38 356,-1618.38 352.5,-1628.38 359.5,-1628.38"/>
</g>
<!-- Layer1 -->
<g id="node10" class="node">
<title>Layer1</title>
<polygon fill="lightcyan" stroke="black" points="459,-1446.12 253,-1446.12 253,-1363.12 459,-1363.12 459,-1446.12"/>
<text text-anchor="middle" x="356" y="-1430.92" font-family="Times,serif" font-size="14.00">Layers 1&#45;7</text>
<text text-anchor="middle" x="356" y="-1415.92" font-family="Times,serif" font-size="14.00">(8x Transformer Layers)</text>
<text text-anchor="middle" x="356" y="-1400.92" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
<text text-anchor="middle" x="356" y="-1385.92" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="356" y="-1370.92" font-family="Times,serif" font-size="14.00">x8 repetitions</text>
</g>
<!-- Layer0_Add2&#45;&gt;Layer1 -->
<g id="edge9" class="edge">
<title>Layer0_Add2&#45;&gt;Layer1</title>
<path fill="none" stroke="black" d="M356,-1481.99C356,-1473.37 356,-1464.67 356,-1456.37"/>
<polygon fill="black" stroke="black" points="359.5,-1456.12 356,-1446.12 352.5,-1456.12 359.5,-1456.12"/>
</g>
<!-- Stage0_to_Stage1 -->
<g id="node11" class="node">
<title>Stage0_to_Stage1</title>
<ellipse fill="red" stroke="black" cx="356" cy="-1289.64" rx="151.14" ry="37.45"/>
<text text-anchor="middle" x="356" y="-1300.94" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="356" y="-1285.94" font-family="Times,serif" font-size="14.00">Between GPU 7 and GPU 8</text>
<text text-anchor="middle" x="356" y="-1270.94" font-family="Times,serif" font-size="14.00">Transfer: [128,10000,4096]</text>
</g>
<!-- Layer1&#45;&gt;Stage0_to_Stage1 -->
<g id="edge10" class="edge">
<title>Layer1&#45;&gt;Stage0_to_Stage1</title>
<path fill="none" stroke="black" d="M356,-1362.83C356,-1354.56 356,-1345.81 356,-1337.36"/>
<polygon fill="black" stroke="black" points="359.5,-1337.25 356,-1327.25 352.5,-1337.25 359.5,-1337.25"/>
</g>
<!-- Layer8_Attn_QKV -->
<g id="node12" class="node">
<title>Layer8_Attn_QKV</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-1183.17 254.5,-1183.17 254.5,-1115.17 457.5,-1115.17 457.5,-1183.17"/>
<text text-anchor="middle" x="356" y="-1167.97" font-family="Times,serif" font-size="14.00">Layer 8: QKV Linear</text>
<text text-anchor="middle" x="356" y="-1152.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-1137.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-1122.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Stage0_to_Stage1&#45;&gt;Layer8_Attn_QKV -->
<g id="edge11" class="edge">
<title>Stage0_to_Stage1&#45;&gt;Layer8_Attn_QKV</title>
<path fill="none" stroke="black" d="M356,-1251.9C356,-1233.91 356,-1212.15 356,-1193.37"/>
<polygon fill="black" stroke="black" points="359.5,-1193.29 356,-1183.29 352.5,-1193.29 359.5,-1193.29"/>
</g>
<!-- Layer8_Attn_Score -->
<g id="node13" class="node">
<title>Layer8_Attn_Score</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-1079.17 254.5,-1079.17 254.5,-1011.17 457.5,-1011.17 457.5,-1079.17"/>
<text text-anchor="middle" x="356" y="-1063.97" font-family="Times,serif" font-size="14.00">Layer 8: Attention Score</text>
<text text-anchor="middle" x="356" y="-1048.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-1033.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-1018.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer8_Attn_QKV&#45;&gt;Layer8_Attn_Score -->
<g id="edge12" class="edge">
<title>Layer8_Attn_QKV&#45;&gt;Layer8_Attn_Score</title>
<path fill="none" stroke="black" d="M356,-1115.05C356,-1106.94 356,-1098.15 356,-1089.64"/>
<polygon fill="black" stroke="black" points="359.5,-1089.47 356,-1079.47 352.5,-1089.47 359.5,-1089.47"/>
</g>
<!-- Layer8_Attn_Out -->
<g id="node14" class="node">
<title>Layer8_Attn_Out</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-975.17 254.5,-975.17 254.5,-907.17 457.5,-907.17 457.5,-975.17"/>
<text text-anchor="middle" x="356" y="-959.97" font-family="Times,serif" font-size="14.00">Layer 8: Output Linear</text>
<text text-anchor="middle" x="356" y="-944.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-929.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-914.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer8_Attn_Score&#45;&gt;Layer8_Attn_Out -->
<g id="edge13" class="edge">
<title>Layer8_Attn_Score&#45;&gt;Layer8_Attn_Out</title>
<path fill="none" stroke="black" d="M356,-1011.05C356,-1002.94 356,-994.15 356,-985.64"/>
<polygon fill="black" stroke="black" points="359.5,-985.47 356,-975.47 352.5,-985.47 359.5,-985.47"/>
</g>
<!-- Layer8_Add1 -->
<g id="node15" class="node">
<title>Layer8_Add1</title>
<polygon fill="orange" stroke="black" points="696.11,-871.17 155.07,-871.17 15.89,-735.17 556.93,-735.17 696.11,-871.17"/>
<text text-anchor="middle" x="356" y="-821.97" font-family="Times,serif" font-size="14.00">Layer 8: Residual Add</text>
<text text-anchor="middle" x="356" y="-806.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-791.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-776.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer8_Attn_Out&#45;&gt;Layer8_Add1 -->
<g id="edge14" class="edge">
<title>Layer8_Attn_Out&#45;&gt;Layer8_Add1</title>
<path fill="none" stroke="black" d="M356,-906.9C356,-899.07 356,-890.4 356,-881.52"/>
<polygon fill="black" stroke="black" points="359.5,-881.43 356,-871.43 352.5,-881.43 359.5,-881.43"/>
</g>
<!-- Layer8_MLP_Dense1 -->
<g id="node16" class="node">
<title>Layer8_MLP_Dense1</title>
<polygon fill="lightgreen" stroke="black" points="462,-699.17 250,-699.17 250,-631.17 462,-631.17 462,-699.17"/>
<text text-anchor="middle" x="356" y="-683.97" font-family="Times,serif" font-size="14.00">Layer 8: MLP Dense 1</text>
<text text-anchor="middle" x="356" y="-668.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-653.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-638.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
</g>
<!-- Layer8_Add1&#45;&gt;Layer8_MLP_Dense1 -->
<g id="edge15" class="edge">
<title>Layer8_Add1&#45;&gt;Layer8_MLP_Dense1</title>
<path fill="none" stroke="black" d="M356,-734.96C356,-726.21 356,-717.44 356,-709.23"/>
<polygon fill="black" stroke="black" points="359.5,-709.18 356,-699.18 352.5,-709.18 359.5,-709.18"/>
</g>
<!-- Layer8_MLP_Activation -->
<g id="node17" class="node">
<title>Layer8_MLP_Activation</title>
<polygon fill="lightgreen" stroke="black" points="462,-595.17 250,-595.17 250,-527.17 462,-527.17 462,-595.17"/>
<text text-anchor="middle" x="356" y="-579.97" font-family="Times,serif" font-size="14.00">Layer 8: MLP GELU</text>
<text text-anchor="middle" x="356" y="-564.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-549.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="356" y="-534.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
</g>
<!-- Layer8_MLP_Dense1&#45;&gt;Layer8_MLP_Activation -->
<g id="edge16" class="edge">
<title>Layer8_MLP_Dense1&#45;&gt;Layer8_MLP_Activation</title>
<path fill="none" stroke="black" d="M356,-631.05C356,-622.94 356,-614.15 356,-605.64"/>
<polygon fill="black" stroke="black" points="359.5,-605.47 356,-595.47 352.5,-605.47 359.5,-605.47"/>
</g>
<!-- Layer8_MLP_Dense2 -->
<g id="node18" class="node">
<title>Layer8_MLP_Dense2</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-491.17 254.5,-491.17 254.5,-423.17 457.5,-423.17 457.5,-491.17"/>
<text text-anchor="middle" x="356" y="-475.97" font-family="Times,serif" font-size="14.00">Layer 8: MLP Dense 2</text>
<text text-anchor="middle" x="356" y="-460.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-445.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="356" y="-430.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer8_MLP_Activation&#45;&gt;Layer8_MLP_Dense2 -->
<g id="edge17" class="edge">
<title>Layer8_MLP_Activation&#45;&gt;Layer8_MLP_Dense2</title>
<path fill="none" stroke="black" d="M356,-527.05C356,-518.94 356,-510.15 356,-501.64"/>
<polygon fill="black" stroke="black" points="359.5,-501.47 356,-491.47 352.5,-501.47 359.5,-501.47"/>
</g>
<!-- Layer8_Add2 -->
<g id="node19" class="node">
<title>Layer8_Add2</title>
<polygon fill="orange" stroke="black" points="696.11,-387.17 155.07,-387.17 15.89,-251.17 556.93,-251.17 696.11,-387.17"/>
<text text-anchor="middle" x="356" y="-337.97" font-family="Times,serif" font-size="14.00">Layer 8: Residual Add</text>
<text text-anchor="middle" x="356" y="-322.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-307.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-292.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer8_MLP_Dense2&#45;&gt;Layer8_Add2 -->
<g id="edge18" class="edge">
<title>Layer8_MLP_Dense2&#45;&gt;Layer8_Add2</title>
<path fill="none" stroke="black" d="M356,-422.9C356,-415.07 356,-406.4 356,-397.52"/>
<polygon fill="black" stroke="black" points="359.5,-397.43 356,-387.43 352.5,-397.43 359.5,-397.43"/>
</g>
<!-- Layer9to15 -->
<g id="node20" class="node">
<title>Layer9to15</title>
<polygon fill="lightcyan" stroke="black" points="459,-215.17 253,-215.17 253,-132.17 459,-132.17 459,-215.17"/>
<text text-anchor="middle" x="356" y="-199.97" font-family="Times,serif" font-size="14.00">Layers 9&#45;15</text>
<text text-anchor="middle" x="356" y="-184.97" font-family="Times,serif" font-size="14.00">(7x Transformer Layers)</text>
<text text-anchor="middle" x="356" y="-169.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
<text text-anchor="middle" x="356" y="-154.97" font-family="Times,serif" font-size="14.00">Same structure as Layer 8</text>
<text text-anchor="middle" x="356" y="-139.97" font-family="Times,serif" font-size="14.00">x7 repetitions</text>
</g>
<!-- Layer8_Add2&#45;&gt;Layer9to15 -->
<g id="edge19" class="edge">
<title>Layer8_Add2&#45;&gt;Layer9to15</title>
<path fill="none" stroke="black" d="M356,-251.04C356,-242.42 356,-233.72 356,-225.42"/>
<polygon fill="black" stroke="black" points="359.5,-225.17 356,-215.17 352.5,-225.17 359.5,-225.17"/>
</g>
<!-- Output -->
<g id="node21" class="node">
<title>Output</title>
<ellipse fill="lightblue" stroke="black" cx="356" cy="-48.08" rx="143.59" ry="48.17"/>
<text text-anchor="middle" x="356" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="356" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: 15 (TP rank 7)</text>
<text text-anchor="middle" x="356" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="356" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- Layer9to15&#45;&gt;Output -->
<g id="edge20" class="edge">
<title>Layer9to15&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M356,-131.86C356,-123.67 356,-114.93 356,-106.3"/>
<polygon fill="black" stroke="black" points="359.5,-106.27 356,-96.27 352.5,-106.27 359.5,-106.27"/>
</g>
</g>
</svg>
